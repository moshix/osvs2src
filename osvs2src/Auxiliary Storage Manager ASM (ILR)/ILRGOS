         TITLE 'ILRGOS - GROUP OPERATIONS STARTER                      *00001000
                        '                                               00002000
ILRGOS   CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'ILRGOS    76.087'                                 0001 00009000
ILRFRELG DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP00711-ILRFRELG)                                   00013000
         ENTRY ILRFRELG                                                 00014000
         DROP  @15                                                      00015000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00016000
         BALR  @06,0                                               0001 00017000
@PSTART  DS    0H                                                  0001 00018000
         USING @PSTART,@06                                         0001 00019000
         AH    @15,4(,@15)                                         0001 00020000
         BR    @15                                                 0001 00021000
@EP00001 DS    0H                                                  0002 00022000
         USING     @DATD,WKSAV@                                         00023000
*   ACAPTR=R1;                      /* OBTAIN ADDRESSIBILITY TO THE     00024000
*                                      ACA                           */ 00025000
         LR    ACAPTR,R1                                           0058 00026000
*   RFY                                                            0059 00027000
*     R1 UNRSTD;                                                   0059 00028000
*   IF ACAASID^=PSAAOLD->ASCBASID THEN                             0060 00029000
         L     @14,PSAAOLD                                         0060 00030000
         LH    @14,ASCBASID(,@14)                                  0060 00031000
         N     @14,@CF01812                                        0060 00032000
         CH    @14,ACAASID(,ACAPTR)                                0060 00033000
         BE    @RF00060                                            0060 00034000
*     RETURN CODE(CODE04);          /* REQUEST NOT FOR THIS ADDRESS     00035000
*                                      SPACE, GET OUT IMMEDIATELY    */ 00036000
         LA    @15,4                                               0061 00037000
         L     @14,12(,@13)                                        0061 00038000
         LM    @00,@12,20(@13)                                     0061 00039000
         BR    @14                                                 0061 00040000
*   ASMVTPTR=CVTASMVT;              /* OBTAIN ADDRESS OF ASMVT       */ 00041000
@RF00060 L     @14,CVTPTR                                          0062 00042000
         L     ASMVTPTR,CVTASMVT(,@14)                             0062 00043000
*                                                                  0063 00044000
*   /*****************************************************************/ 00045000
*   /*                                                               */ 00046000
*   /* SAVE OR ACTIVATE REQUEST, LOCAL LOCK IS NOT HELD, GETMAIN     */ 00047000
*   /* WORK-SAVE AREA, AND ESTABLISH ESTAE RECOVERY                  */ 00048000
*   /*                                                               */ 00049000
*   /*****************************************************************/ 00050000
*                                                                  0063 00051000
*   IF ACAOP=ACESVLGN|ACAOP=ACEACT THEN                            0063 00052000
         CLI   ACAOP(ACAPTR),16                                    0063 00053000
         BE    @RT00063                                            0063 00054000
         CLI   ACAOP(ACAPTR),20                                    0063 00055000
         BNE   @RF00063                                            0063 00056000
@RT00063 DS    0H                                                  0064 00057000
*     DO;                           /* SAVE OR ACTIVATE REQ.         */ 00058000
*       IF ASMSTGXA=ZERO|(ACAOP=ACESVLGN&ASMNOSAV=ON) THEN         0065 00059000
         L     @14,ASMSTGXA(,ASMVTPTR)                             0065 00060000
         LTR   @14,@14                                             0065 00061000
         BZ    @RT00065                                            0065 00062000
         CLI   ACAOP(ACAPTR),16                                    0065 00063000
         BNE   @RF00065                                            0065 00064000
         TM    ASMNOSAV(ASMVTPTR),B'01000000'                      0065 00065000
         BNO   @RF00065                                            0065 00066000
@RT00065 DS    0H                                                  0066 00067000
*         RETURN CODE(CODE20);      /* NO ACB FOR STORAGE INDEX, OR     00068000
*                                      SAVE REQUEST AND STORAGE INDEX   00069000
*                                      UNAVAILABLE THEN CODE20,    0066 00070000
*                                      UNABLE TO USE STGINDEX        */ 00071000
*                                                                  0066 00072000
         LA    @15,20                                              0066 00073000
         L     @14,12(,@13)                                        0066 00074000
         LM    @00,@12,20(@13)                                     0066 00075000
         BR    @14                                                 0066 00076000
*       /*************************************************************/ 00077000
*       /*                                                           */ 00078000
*       /* OBTAIN A WORK-SAVE AREA, BUFFER CONTROL AREA, ATA AND     */ 00079000
*       /* EPATH                                                     */ 00080000
*       /*                                                           */ 00081000
*       /*************************************************************/ 00082000
*                                                                  0067 00083000
*       RFY                                                        0067 00084000
*        (R10,                                                     0067 00085000
*         R11,                                                     0067 00086000
*         R1AREA) RSTD;                                            0067 00087000
@RF00065 DS    0H                                                  0068 00088000
*       R10=LENGTH(WKAREA);         /* OBTAIN LENGTH TO BE GETMAINED */ 00089000
         LA    R10,256                                             0068 00090000
*       GEN SETS(R1AREA,R15) REFS(WKSAV@);                         0069 00091000
*                                  /* GET SQA SPACE FROM SUBPOOL 245*/  00092000
        GETMAIN RC,LV=(R10),SP=245                                      00093000
*       IF R15^=CODE00 THEN                                        0070 00094000
         LTR   R15,R15                                             0070 00095000
         BZ    @RF00070                                            0070 00096000
*         RETURN CODE(CODE28);      /* NO STORAGE AVAILABLE          */ 00097000
         LA    @15,28                                              0071 00098000
         L     @14,12(,@13)                                        0071 00099000
         LM    @00,@12,20(@13)                                     0071 00100000
         BR    @14                                                 0071 00101000
*       WKSAV@=R1AREA;              /* ADDRESSIBILITY TO WORK AREA   */ 00102000
@RF00070 LR    WKSAV@,R1AREA                                       0072 00103000
*       WKAREA=''B;                 /* CLEAR THE WORK-SAVE AREA      */ 00104000
         XC    WKAREA(256,WKSAV@),WKAREA(WKSAV@)                   0073 00105000
*       ATAPTR=ADDR(WKATA);         /* ATA IN WORK SAVE AREA ON    0074 00106000
*                                      UNLOCKED PATHS                */ 00107000
         LA    ATAPTR,WKATA                                        0074 00108000
*       R11=ADDR(ILRCGOSE);         /* ADDR ESTAE RECOVERY ROUTINE   */ 00109000
         L     R11,@CV01708                                        0075 00110000
*       GEN REFS(R11,ATAPTR);                                      0076 00111000
        ESTAE (11),PARAM=(4),MF=(E,ESTAELST),TERM=YES,PURGE=NONE,     **00112000
               ASYNCH=YES                                               00113000
*       IF R15^=CODE00 THEN                                        0077 00114000
         LTR   R15,R15                                             0077 00115000
         BZ    @RF00077                                            0077 00116000
*         DO;                       /* ESTAE ERROR                   */ 00117000
*           GEN REFS(R10,WKSAV@);                                  0079 00118000
*                     /* FREE WORK AREA JUST GETMAINED */               00119000
        FREEMAIN RC,LV=(R10),A=(WKSAV@),SP=245                          00120000
*           RETURN CODE(CODE44);    /* INDETERMINENT ERROR           */ 00121000
         LA    @15,44                                              0080 00122000
         L     @14,12(,@13)                                        0080 00123000
         LM    @00,@12,20(@13)                                     0080 00124000
         BR    @14                                                 0080 00125000
*         END;                      /* END ESTAE ERROR DO            */ 00126000
*       RFY                                                        0082 00127000
*        (R10,                                                     0082 00128000
*         R11,                                                     0082 00129000
*         R15) UNRSTD;                                             0082 00130000
@RF00077 DS    0H                                                  0083 00131000
*     END;                          /* END SAVE OR ACTIVATE DO       */ 00132000
*                                                                  0084 00133000
*   /*****************************************************************/ 00134000
*   /*                                                               */ 00135000
*   /* RELEASE OR ASSIGN REQUEST, LOCAL LOCK IS HELD, OBTAIN         */ 00136000
*   /* WORK-SAVE AREA VIA ILRGMA MACRO, AND ESTABLISH FRR RECOVERY   */ 00137000
*   /*                                                               */ 00138000
*   /*****************************************************************/ 00139000
*                                                                  0084 00140000
*   ELSE                                                           0084 00141000
*     DO;                           /* RELEASE OR ASSIGN REQUEST OR     00142000
*                                      INVALID OPERATION TYPE        */ 00143000
         B     @RC00063                                            0084 00144000
@RF00063 DS    0H                                                  0085 00145000
*       IF ACAOP^=ASSIGN&ACAOP^=ACERELLG THEN                      0085 00146000
         CLI   ACAOP(ACAPTR),8                                     0085 00147000
         BE    @RF00085                                            0085 00148000
         CLI   ACAOP(ACAPTR),12                                    0085 00149000
         BE    @RF00085                                            0085 00150000
*         RETURN CODE(CODE32);      /* INVALID OPERATION TYPE        */ 00151000
*                                                                  0086 00152000
         LA    @15,32                                              0086 00153000
         L     @14,12(,@13)                                        0086 00154000
         LM    @00,@12,20(@13)                                     0086 00155000
         BR    @14                                                 0086 00156000
*       /*************************************************************/ 00157000
*       /*                                                           */ 00158000
*       /* ASSIGN OR RELEASE REQUEST BEGIN ILRGMA MACRO EXPANSION    */ 00159000
*       /*                                                           */ 00160000
*       /*************************************************************/ 00161000
*                                                                  0087 00162000
*       DO;                         /* ILRGMA GET                  0087 00163000
*                                      CELL(BWK)WORKREGS(R11,R12)    */ 00164000
@RF00085 DS    0H                                                  0088 00165000
*         DECLARE                   /* ASMVT VECTOR TO ILRPEX        */ 00166000
*           ILRPEX ENTRY BASED(ASMPEX) VALRG(0);                   0088 00167000
*         DECLARE                   /* MAP FOR CELL CONTROL WORDS    */ 00168000
*           1 GMACELL BASED BDY(WORD),                             0089 00169000
*            2 GMANEXT PTR(31);     /* PTR NEXT FREE CELL            */ 00170000
*         RESPECIFY                                                0090 00171000
*          (R0,                                                    0090 00172000
*           R1,                                                    0090 00173000
*           R11,                                                   0090 00174000
*           R12,                                                   0090 00175000
*           R14,                                                   0090 00176000
*           R15) RESTRICTED;                                       0090 00177000
*         RESPECIFY                                                0091 00178000
*           ASMPOOLS BASED(R11);                                   0091 00179000
*         RESPECIFY                                                0092 00180000
*           GMACELL BASED(R14);                                    0092 00181000
*         R11=ADDR(ASMBWKPC);                                      0093 00182000
         LA    R11,ASMBWKPC(,ASMVTPTR)                             0093 00183000
*         LM(R14,R15,ASMCPAVQ);     /* GET ADDR OF 1ST CELL          */ 00184000
         LM    R14,R15,ASMCPAVQ(R11)                               0094 00185000
*GMA00010:                                                         0095 00186000
*         IF R14^=0 THEN            /* TEST CELL POOL                */ 00187000
GMA00010 LTR   R14,R14                                             0095 00188000
         BZ    @RF00095                                            0095 00189000
*           DO;                     /* CELL AVAILABLE, REMOVE CELL   */ 00190000
*             R0=GMANEXT;                                          0097 00191000
         L     R0,GMANEXT(,R14)                                    0097 00192000
*             R1=R15-1;                                            0098 00193000
         LR    R1,R15                                              0098 00194000
         BCTR  R1,0                                                0098 00195000
*             CDS(R14,R0,ASMCPAVQ);                                0099 00196000
         CDS   R14,R0,ASMCPAVQ(R11)                                0099 00197000
*             BC(7,GMA00010);                                      0100 00198000
         BC    7,GMA00010                                          0100 00199000
*             R1=R14;                                              0101 00200000
         LR    R1,R14                                              0101 00201000
*           END;                                                   0102 00202000
*         ELSE                                                     0103 00203000
*           DO;                     /* CELL POOL EMPTY               */ 00204000
         B     @RC00095                                            0103 00205000
@RF00095 DS    0H                                                  0104 00206000
*             R1=R11;               /* PREPARE TO CALL PEX           */ 00207000
         LR    R1,R11                                              0104 00208000
*             CALL ILRPEX;          /* EXTEND THE POOL               */ 00209000
         L     @15,ASMPEX(,ASMVTPTR)                               0105 00210000
         BALR  @14,@15                                             0105 00211000
*           END;                                                   0106 00212000
*         RESPECIFY                                                0107 00213000
*          (R0,                                                    0107 00214000
*           R1,                                                    0107 00215000
*           R11,                                                   0107 00216000
*           R12,                                                   0107 00217000
*           R14,                                                   0107 00218000
*           R15) UNRESTRICTED;                                     0107 00219000
@RC00095 DS    0H                                                  0108 00220000
*       END;                        /* ILRGMA GET                  0108 00221000
*                                      CELL(BWK)WORKREGS(R11,R12)    */ 00222000
*                                                                  0108 00223000
*       /*************************************************************/ 00224000
*       /*                                                           */ 00225000
*       /* END ILRGMA MACRO EXPANSION                                */ 00226000
*       /*                                                           */ 00227000
*       /*************************************************************/ 00228000
*                                                                  0109 00229000
*       IF R1AREA=ZERO THEN                                        0109 00230000
         LTR   R1AREA,R1AREA                                       0109 00231000
         BNZ   @RF00109                                            0109 00232000
*         RETURN CODE(CODE28);      /* GMA UNSUCCESSFUL, NOT ENOUGH     00233000
*                                      STORAGE                       */ 00234000
         LA    @15,28                                              0110 00235000
         L     @14,12(,@13)                                        0110 00236000
         LM    @00,@12,20(@13)                                     0110 00237000
         BR    @14                                                 0110 00238000
*       WKSAV@=R1AREA;              /* OBTAIN ADDRESSIBILITY TO WORK    00239000
*                                      AREA                          */ 00240000
@RF00109 LR    WKSAV@,R1AREA                                       0111 00241000
*       WKAREA=''B;                 /* CLEAR THE WORK-SAVE AREA      */ 00242000
         XC    WKAREA(256,WKSAV@),WKAREA(WKSAV@)                   0112 00243000
*       R1=ADDR(ILRGOS01);          /* OBTAIN FUNCTIONAL RECOVERY  0113 00244000
*                                      ROUTINE ADDR                  */ 00245000
         L     R1,@CV01709                                         0113 00246000
*       GEN REFS(R1) SETS(ATAPTR,R11,R12);                         0114 00247000
       SETFRR A,FRRAD=(R1),PARMAD=(ATAPTR),WRKREGS=(R11,R12),         **00248000
               RELATED=(SETFRR,ILRGOS)   ADD RECOVERY                   00249000
*     END;                          /* END ASSIGN, RELEASE, OR     0115 00250000
*                                      INVALID TYPE                  */ 00251000
*   RFY                                                            0116 00252000
*    (R1AREA,                                                      0116 00253000
*     R10) UNRSTD;                                                 0116 00254000
@RC00063 DS    0H                                                  0117 00255000
*                                                                  0117 00256000
*   /*****************************************************************/ 00257000
*   /*                                                               */ 00258000
*   /* COMMON PROCESSING FOR ALL REQUESTS DETERMINED TO BE VALID AND */ 00259000
*   /* FOR WHICH A WORK-SAVE AREA HAS BEEN OBTAINED AND A RECOVERY   */ 00260000
*   /* ROUTINE ESTABLISHED                                           */ 00261000
*   /*                                                               */ 00262000
*   /*****************************************************************/ 00263000
*                                                                  0117 00264000
*   GEN REFS(R13) SETS(R11);                                       0117 00265000
*                        /* SET SAVE AREA LINKAGE */                    00266000
       LA   R11,SAVAREA         GET ADDR OF SAVE AREA                   00267000
       ST   R13,4(R11)          STORE ADDR CALLERS SAVE AREA            00268000
       ST   R11,8(R13)          STORE ADDR GOS SAVE AREA                00269000
*   RFY                                                            0118 00270000
*     R13 UNRSTD;                                                  0118 00271000
*   ATAMODID=ATAMGOS;               /* RRR-SET MODID IN ATA-RRR      */ 00272000
         MVI   ATAMODID(ATAPTR),X'06'                              0119 00273000
*   ATAEPATH=ADDR(EPATH);           /* RRR-SET EPATH ADDR IN ATA-RRR */ 00274000
         LA    @12,EPATH                                           0120 00275000
         ST    @12,ATAEPATH(,ATAPTR)                               0120 00276000
*   ATAWORKA=WKSAV@;                /* RRR-SET WORK SAVE AREA ADDR IN   00277000
*                                      ATA-RRR                       */ 00278000
         ST    WKSAV@,ATAWORKA(,ATAPTR)                            0121 00279000
*   RSMHDPTR=PSAAOLD->ASCBRSM;      /* OBTAIN RSM HEADER ADDR WHICH     00280000
*                                      ALSO GIVES ADDRESSIBILITY TO     00281000
*                                      THE ASM HEADER                */ 00282000
         L     @12,PSAAOLD                                         0122 00283000
         L     RSMHDPTR,ASCBRSM(,@12)                              0122 00284000
*   RTNCODE=CODE00;                 /* CLEAR RETURN CODE             */ 00285000
         SLR   @12,@12                                             0123 00286000
         ST    @12,RTNCODE                                         0123 00287000
*                                                                  0124 00288000
*   /*****************************************************************/ 00289000
*   /*                                                               */ 00290000
*   /* ASSIGN REQUEST PROCESSING, DETERMINE THE SLOTS NEEDED TO BACK */ 00291000
*   /* THIS REQUEST AND CALL THE ASSIGN SUBROUTINE TO BUILD A LGE, AN*/ 00292000
*   /* ASPCT, AND OBTAIN A LGN. THE LGE IS THEN QUEUED TO THE ASM    */ 00293000
*   /* HEADER LGE Q.                                                 */ 00294000
*   /*                                                               */ 00295000
*   /*****************************************************************/ 00296000
*                                                                  0124 00297000
*   IF ACAOP=ASSIGN THEN                                           0124 00298000
         CLI   ACAOP(ACAPTR),8                                     0124 00299000
         BNE   @RF00124                                            0124 00300000
*     DO;                           /* ASSIGN REQUEST                */ 00301000
*       EPAACASR=ON;                /* RRR-INDICATE ASSIGN OR      0126 00302000
*                                      ACTIVATE REQUEST-RRR          */ 00303000
         OI    EPAACASR,B'00001000'                                0126 00304000
*       IF ACAMAXPN<INVLDRPN THEN                                  0127 00305000
         L     @15,ACAMAXPN(,ACAPTR)                               0127 00306000
         C     @15,@CF01675                                        0127 00307000
         BNL   @RF00127                                            0127 00308000
*         DO;                       /* PAGE NUMBER IS VALID          */ 00309000
*           IF SLOTV=ZERO THEN                                     0129 00310000
         L     @01,ASMSLOTV(,ASMVTPTR)                             0129 00311000
         C     @12,SLOTV(,@01)                                     0129 00312000
         BNE   @RF00129                                            0129 00313000
*             SLOTS=ACAMAXPN;       /* DEFAULTS SLOTS TO MAX. VALUE  */ 00314000
         ST    @15,SLOTS                                           0130 00315000
*           ELSE                                                   0131 00316000
*             SLOTS=ACAMAXPN/SLOTV; /* OBTAIN SLOTS NEEDED TO BACK 0131 00317000
*                                      THIS LG                       */ 00318000
         B     @RC00129                                            0131 00319000
@RF00129 L     @12,ASMSLOTV(,ASMVTPTR)                             0131 00320000
         L     @00,ACAMAXPN(,ACAPTR)                               0131 00321000
         SRDA  @00,32                                              0131 00322000
         D     @00,SLOTV(,@12)                                     0131 00323000
         ST    @01,SLOTS                                           0131 00324000
*           RFY                                                    0132 00325000
*            (R0,                                                  0132 00326000
*             R1) RSTD;                                            0132 00327000
@RC00129 DS    0H                                                  0133 00328000
*           R0=ASMBKSLT;            /* GET ASMVT BACKING SLOT COUNT  */ 00329000
         L     R0,ASMBKSLT(,ASMVTPTR)                              0133 00330000
*UPDATSLT:                                                         0134 00331000
*           IF R0>=SLOTS THEN                                      0134 00332000
UPDATSLT L     @12,SLOTS                                           0134 00333000
         CR    R0,@12                                              0134 00334000
         BL    @RF00134                                            0134 00335000
*             DO;                   /* ENOUGH SLOTS AVAILABLE        */ 00336000
*               R1=R0-SLOTS;        /* DECR COUNT                    */ 00337000
         LCR   @12,@12                                             0136 00338000
         ALR   @12,R0                                              0136 00339000
         LR    R1,@12                                              0136 00340000
*               CS(R0,R1,ASMBKSLT); /* PUT COUNT IN ASMVT            */ 00341000
         CS    R0,@01,ASMBKSLT(ASMVTPTR)                           0137 00342000
*               BC(NE,UPDATSLT);    /* NOT SUCCESSFUL, TRY AGAIN     */ 00343000
         BC    7,UPDATSLT                                          0138 00344000
*               RFY                                                0139 00345000
*                (R0,                                              0139 00346000
*                 R1) UNRSTD;                                      0139 00347000
*               EPABKSLT=SLOTS;     /* RRR-TRACK SLOTS NEEDED IN   0140 00348000
*                                      EPATH-RRR                     */ 00349000
         L     @12,SLOTS                                           0140 00350000
         ST    @12,EPABKSLT                                        0140 00351000
*               EPAASGN=ON;         /* RRR-INDICATE BACKING SLOTS HAS   00352000
*                                      BEEN UPDATED-RRR              */ 00353000
         OI    EPAASGN,B'00000100'                                 0141 00354000
*               REQASPCT=ON;        /* INDICATE ASPCT NEEDED         */ 00355000
         OI    REQASPCT,B'10000000'                                0142 00356000
*               CALL ASSIGNLG;      /* ASSIGN AN LGN AND BUILD A LGE    00357000
*                                      AND AN ASPCT                  */ 00358000
         BAL   @14,ASSIGNLG                                        0143 00359000
*               RFY                                                0144 00360000
*                 ASPCTPTR RSTD;                                   0144 00361000
*               IF RTNCODE=ZERO THEN                               0145 00362000
         L     @15,RTNCODE                                         0145 00363000
         LTR   @15,@15                                             0145 00364000
         BNZ   @RF00145                                            0145 00365000
*                 DO;               /* ASSIGN SUBROUTINE SUCCESSFUL  */ 00366000
*                   ASPCTPTR=SAVASPCT;/* RESTORE ASPCT ADDR OBTAINED    00367000
*                                      IN ASSIGN                     */ 00368000
         L     ASPCTPTR,SAVASPCT                                   0147 00369000
*                   ASPMAXPN=ACAMAXPN;/* SET MAX PG NUMBER IN ASPCT  */ 00370000
         L     @15,ACAMAXPN(,ACAPTR)                               0148 00371000
         ST    @15,ASPMAXPN(,ASPCTPTR)                             0148 00372000
*                   ASPBKSLT=SLOTS; /* SET NUMBER OF SLOTS REMOVED 0149 00373000
*                                      FOR THIS LG                   */ 00374000
         L     @15,SLOTS                                           0149 00375000
         ST    @15,ASPBKSLT(,ASPCTPTR)                             0149 00376000
*                   RFY                                            0150 00377000
*                     ASPCTPTR UNRSTD;                             0150 00378000
*                   ACALGID=LGELGID;/* LGN ASSIGNED IS RETURNED VIA     00379000
*                                      THE ACA                       */ 00380000
         L     @12,LGELGID(,LGEPTR)                                0151 00381000
         ST    @12,ACALGID(,ACAPTR)                                0151 00382000
*                 END;              /* END DO FOR SUCCESSFUL ASSIGN  */ 00383000
*               ELSE                                               0153 00384000
*                 DO;               /* ASSIGN SUBROUTINE           0153 00385000
*                                      UNSUCCESSFUL, NOT ENOUGH    0153 00386000
*                                      STORAGE AVAILABLE             */ 00387000
         B     @RC00145                                            0153 00388000
@RF00145 DS    0H                                                  0154 00389000
*                   RFY                                            0154 00390000
*                    (R0,                                          0154 00391000
*                     R1) RSTD;                                    0154 00392000
*                   R0=ASMBKSLT;    /* GET ASMVT BACKING SLOT COUNT  */ 00393000
         L     R0,ASMBKSLT(,ASMVTPTR)                              0155 00394000
*RESTRSLT:                                                         0156 00395000
*                   R1=R0+SLOTS;    /* RESTORE COUNT                 */ 00396000
RESTRSLT LR    R1,R0                                               0156 00397000
         AL    R1,SLOTS                                            0156 00398000
*                   CS(R0,R1,ASMBKSLT);/* PUT COUNT IN ASMVT         */ 00399000
         CS    R0,@01,ASMBKSLT(ASMVTPTR)                           0157 00400000
*                   BC(NE,RESTRSLT);/* NOT SUCCESSFUL, TRY AGAIN     */ 00401000
         BC    7,RESTRSLT                                          0158 00402000
*                   EPAASGN=OFF;    /* RRR-BACKING SLOTS HAS BEEN  0159 00403000
*                                      RESTORED-RRR                  */ 00404000
         NI    EPAASGN,B'11111011'                                 0159 00405000
*                   RFY                                            0160 00406000
*                    (R0,                                          0160 00407000
*                     R1) UNRSTD;                                  0160 00408000
*                 END;              /* END UNSUCCESSFUL ASSIGN       */ 00409000
*             END;                  /* END ENOUGH SLOTS AVAILABLE    */ 00410000
*           ELSE                                                   0163 00411000
*             RTNCODE=CODE28;       /* NOT ENOUGH STORAGE AVAILABLE  */ 00412000
         B     @RC00134                                            0163 00413000
@RF00134 MVC   RTNCODE(4),@CF00438                                 0163 00414000
*         END;                      /* END PROCESSING FOR VALID PAGE    00415000
*                                      NUMBER                        */ 00416000
*       ELSE                                                       0165 00417000
*         RTNCODE=CODE28;           /* MAX PAGE NUMBER IS TOO LARGE  */ 00418000
         B     @RC00127                                            0165 00419000
@RF00127 MVC   RTNCODE(4),@CF00438                                 0165 00420000
*     END;                          /* END ASSIGN PROCESSING         */ 00421000
*                                                                  0167 00422000
*   /*****************************************************************/ 00423000
*   /*                                                               */ 00424000
*   /* NOT AN ASSIGN REQUEST, OBTAIN AND INITIALIZE AN ACE           */ 00425000
*   /*                                                               */ 00426000
*   /*****************************************************************/ 00427000
*                                                                  0167 00428000
*   ELSE                                                           0167 00429000
*     DO;                           /* RELEASE, ACTIVATE, SAVE COMMON   00430000
*                                      PROCESSING                    */ 00431000
         B     @RC00124                                            0167 00432000
@RF00124 DS    0H                                                  0168 00433000
*       RFY                                                        0168 00434000
*         R1AREA RSTD;                                             0168 00435000
*                                                                  0168 00436000
*       /*************************************************************/ 00437000
*       /*                                                           */ 00438000
*       /* BEGIN ILRGMA MACRO EXPANSION                              */ 00439000
*       /*                                                           */ 00440000
*       /*************************************************************/ 00441000
*                                                                  0169 00442000
*       DO;                         /* ILRGMA GET                  0169 00443000
*                                      CELL(ACE)WORKREGS(R11,R12)    */ 00444000
*         RESPECIFY                                                0170 00445000
*          (R0,                                                    0170 00446000
*           R1,                                                    0170 00447000
*           R11,                                                   0170 00448000
*           R12,                                                   0170 00449000
*           R14,                                                   0170 00450000
*           R15) RESTRICTED;                                       0170 00451000
*         RESPECIFY                                                0171 00452000
*           ASMPOOLS BASED(R11);                                   0171 00453000
*         RESPECIFY                                                0172 00454000
*           GMACELL BASED(R14);                                    0172 00455000
*         R11=ADDR(ASMACEPC);                                      0173 00456000
         LA    R11,ASMACEPC(,ASMVTPTR)                             0173 00457000
*         LM(R14,R15,ASMCPAVQ);     /* GET ADDR OF 1ST CELL          */ 00458000
         LM    R14,R15,ASMCPAVQ(R11)                               0174 00459000
*GMA00020:                                                         0175 00460000
*         IF R14^=0 THEN            /* TEST CELL POOL                */ 00461000
GMA00020 LTR   R14,R14                                             0175 00462000
         BZ    @RF00175                                            0175 00463000
*           DO;                     /* CELL AVAILABLE, REMOVE CELL   */ 00464000
*             R0=GMANEXT;                                          0177 00465000
         L     R0,GMANEXT(,R14)                                    0177 00466000
*             R1=R15-1;                                            0178 00467000
         LR    R1,R15                                              0178 00468000
         BCTR  R1,0                                                0178 00469000
*             CDS(R14,R0,ASMCPAVQ);                                0179 00470000
         CDS   R14,R0,ASMCPAVQ(R11)                                0179 00471000
*             BC(7,GMA00020);                                      0180 00472000
         BC    7,GMA00020                                          0180 00473000
*             R1=R14;                                              0181 00474000
         LR    R1,R14                                              0181 00475000
*           END;                                                   0182 00476000
*         ELSE                                                     0183 00477000
*           DO;                     /* CELL POOL EMPTY               */ 00478000
         B     @RC00175                                            0183 00479000
@RF00175 DS    0H                                                  0184 00480000
*             R1=R11;               /* PREPARE TO CALL PEX           */ 00481000
         LR    R1,R11                                              0184 00482000
*             CALL ILRPEX;          /* EXTEND THE POOL               */ 00483000
         L     @15,ASMPEX(,ASMVTPTR)                               0185 00484000
         BALR  @14,@15                                             0185 00485000
*           END;                                                   0186 00486000
*         RESPECIFY                                                0187 00487000
*          (R0,                                                    0187 00488000
*           R1,                                                    0187 00489000
*           R11,                                                   0187 00490000
*           R12,                                                   0187 00491000
*           R14,                                                   0187 00492000
*           R15) UNRESTRICTED;                                     0187 00493000
@RC00175 DS    0H                                                  0188 00494000
*       END;                        /* ILRGMA GET                  0188 00495000
*                                      CELL(ACE)WORKREGS(R11,R12)    */ 00496000
*                                                                  0188 00497000
*       /*************************************************************/ 00498000
*       /*                                                           */ 00499000
*       /* END ILRGMA MACRO EXPANSION                                */ 00500000
*       /*                                                           */ 00501000
*       /*************************************************************/ 00502000
*                                                                  0189 00503000
*       IF R1AREA=ZERO THEN                                        0189 00504000
         LTR   R1AREA,R1AREA                                       0189 00505000
         BNZ   @RF00189                                            0189 00506000
*         RTNCODE=CODE28;           /* STORAGE UNAVAILABLE           */ 00507000
         MVC   RTNCODE(4),@CF00438                                 0190 00508000
*       ELSE                                                       0191 00509000
*         DO;                       /* ILRGMA GET SUCCESSFUL, CLEAR     00510000
*                                      AND INITALIZE THE ACE, PROCESS   00511000
*                                      THE REQUEST                   */ 00512000
         B     @RC00189                                            0191 00513000
@RF00189 DS    0H                                                  0192 00514000
*           ACEPTR=R1AREA;          /* OBTAIN ADDRESSIBILITY TO ACE  */ 00515000
         LR    ACEPTR,R1AREA                                       0192 00516000
*           ACE=''B;                /* CLEAR THE ACE                 */ 00517000
         XC    ACE(40,ACEPTR),ACE(ACEPTR)                          0193 00518000
*           EPAACE=ACEPTR;          /* RRR-CHECKPOINT THE ACE IN THE    00519000
*                                      EPATH-RRR                     */ 00520000
         ST    ACEPTR,EPAACE                                       0194 00521000
*           ACEOP=ACAOP;            /* PROPAGATE OP CODE             */ 00522000
         IC    @12,ACAOP(,ACAPTR)                                  0195 00523000
         STC   @12,ACEOP(,ACEPTR)                                  0195 00524000
*           ACELGN=ACALGN;          /* PROPAGATE THE LOGICAL GROUP 0196 00525000
*                                      NUMBER                        */ 00526000
         MVC   ACELGN(8,ACEPTR),ACALGN(ACAPTR)                     0196 00527000
*           ACESYM=ACASYM;          /* PROPAGATE THE 'S' SYMBOL      */ 00528000
         MVC   ACESYM(8,ACEPTR),ACASYM(ACAPTR)                     0197 00529000
*           ACEGRPRQ=ON;            /* INDICATE A GROUP OP REQUEST   */ 00530000
         OI    ACEGRPRQ(ACEPTR),B'10000000'                        0198 00531000
*           IF ACAOP=ACERELLG&ACAFSYM=ON THEN                      0199 00532000
         CLI   ACAOP(ACAPTR),12                                    0199 00533000
         BNE   @RF00199                                            0199 00534000
         TM    ACAFSYM(ACAPTR),B'00001000'                         0199 00535000
         BNO   @RF00199                                            0199 00536000
*             ACEUSYM=ON;           /* INDICATES 'S' SYMBOL        0200 00537000
*                                      IDENTIFIES THE LOGICAL GROUP     00538000
*                                      BEING RELEASED                */ 00539000
         OI    ACEUSYM(ACEPTR),B'10000000'                         0200 00540000
*                                                                  0201 00541000
*           /*********************************************************/ 00542000
*           /*                                                       */ 00543000
*           /* INPUT WAS DETERMINED TO BE A SAVE OR RELEASE REQUEST, */ 00544000
*           /* DETERMINES IF A RELEASE 'S' SYMBOL AND FINDS LGID IF  */ 00545000
*           /* ONE EXISTS FOR THIS REQUEST                           */ 00546000
*           /*                                                       */ 00547000
*           /*********************************************************/ 00548000
*                                                                  0201 00549000
*           IF ACEOP^=ACEACT THEN                                  0201 00550000
@RF00199 CLI   ACEOP(ACEPTR),20                                    0201 00551000
         BE    @RF00201                                            0201 00552000
*             DO;                   /* NOT AN ACTIVATE REQUEST,    0202 00553000
*                                      PROCESSING FOR SAVE AND     0202 00554000
*                                      RELEASE                       */ 00555000
*               CALL GETLOCK;       /* OBTAIN THE ASM CLASS LOCK     */ 00556000
         BAL   @14,GETLOCK                                         0203 00557000
*               IDEXISTS=ON;        /* INTERNAL FLAG, INITIALIZED ON    00558000
*                                      INDICATING THE LGID EXISTS FOR   00559000
*                                      THE REQUEST                   */ 00560000
         OI    IDEXISTS,B'01000000'                                0204 00561000
*               IF ACEUSYM=ON THEN                                 0205 00562000
         TM    ACEUSYM(ACEPTR),B'10000000'                         0205 00563000
         BNO   @RF00205                                            0205 00564000
*                 DO;               /* RELEASE 'S' SYMBOL            */ 00565000
*                   IDEXISTS=OFF;   /* TURN FLAG OFF UNTIL THE LGE IS   00566000
*                                      FOUND ON THE LGE Q            */ 00567000
         NI    IDEXISTS,B'10111111'                                0207 00568000
*                   IF ASHLGEQ^=ZERO THEN                          0208 00569000
         L     @12,ASHLGEQ(,RSMHDPTR)                              0208 00570000
         LTR   @12,@12                                             0208 00571000
         BZ    @RF00208                                            0208 00572000
*                     DO;           /* ASMH LGE Q IS NOT EMPTY       */ 00573000
*                       LGEPTR=ASHLGEQ;/* OBTAIN ADDR FIRST ELEMENT     00574000
*                                      ON Q                          */ 00575000
*                                                                  0210 00576000
         LR    LGEPTR,@12                                          0210 00577000
*                       /*********************************************/ 00578000
*                       /*                                           */ 00579000
*                       /* SEARCH THE LGE Q FOR THE LGE OF ASPCT WITH*/ 00580000
*                       /* 'S' SYMBOL TO BE RELEASED                 */ 00581000
*                       /*                                           */ 00582000
*                       /*********************************************/ 00583000
*                                                                  0211 00584000
*                       DO UNTIL LGEPTR=ZERO|IDEXISTS=ON;/* UNTIL  0211 00585000
*                                      THERE ARE NO MORE LGES OR THE    00586000
*                                      LGE WITH THE CORRECT 'S'    0211 00587000
*                                      SYMBOL HAS BEEN FOUND         */ 00588000
@DL00211 DS    0H                                                  0212 00589000
*                         IF LGEASPCT=ZERO|LGEASPCT->ASPSSYM^=ACESYM    00590000
*                           THEN                                   0212 00591000
         L     @12,LGEASPCT(,LGEPTR)                               0212 00592000
         LTR   @12,@12                                             0212 00593000
         BZ    @RT00212                                            0212 00594000
         CLC   ASPSSYM(8,@12),ACESYM(ACEPTR)                       0212 00595000
         BE    @RF00212                                            0212 00596000
@RT00212 DS    0H                                                  0213 00597000
*                           LGEPTR=LGENEXT;/* ASPCT DOES NOT EXIST OR   00598000
*                                      THE 'S' OF THE ASPCT IS NOT 0213 00599000
*                                      THE CORRECT ONE               */ 00600000
         L     LGEPTR,LGENEXT(,LGEPTR)                             0213 00601000
*                         ELSE                                     0214 00602000
*                           DO;     /* 'S' SYMBOL TO BE RELEASED WAS    00603000
*                                      FOUND                         */ 00604000
         B     @RC00212                                            0214 00605000
@RF00212 DS    0H                                                  0215 00606000
*                             ACELGID=LGELGID;/* MOVE THE LGID OF THE   00607000
*                                      LG TO BE RELEASED TO THE ACE  */ 00608000
         L     @12,LGELGID(,LGEPTR)                                0215 00609000
         ST    @12,ACELGID(,ACEPTR)                                0215 00610000
*                             IDEXISTS=ON;/* INDICATE LOOP TO END, LG   00611000
*                                      TO BE RELEASED WAS FOUND      */ 00612000
         OI    IDEXISTS,B'01000000'                                0216 00613000
*                           END;    /* END DO FOR 'S' FOUND          */ 00614000
*                       END;        /* END LOOP THRU LGES            */ 00615000
@RC00212 DS    0H                                                  0218 00616000
@DE00211 LTR   LGEPTR,LGEPTR                                       0218 00617000
         BZ    @DC00211                                            0218 00618000
         TM    IDEXISTS,B'01000000'                                0218 00619000
         BNO   @DL00211                                            0218 00620000
@DC00211 DS    0H                                                  0219 00621000
*                     END;          /* END DO FOR NON-EMPTY ASMH LGE    00622000
*                                      Q                             */ 00623000
*                 END;              /* END RELEASE 'S' REQUEST       */ 00624000
*                                                                  0221 00625000
*               /*****************************************************/ 00626000
*               /*                                                   */ 00627000
*               /* RELEASE LG AND SAVE REQUEST COMMON PROCESSING     */ 00628000
*               /* CHECKS FOR INVALID LGN AND INVALID IDENTIFIER     */ 00629000
*               /* TYPE, ACTIVATE AND RELEASE 'S' REQUESTS WILL NOT  */ 00630000
*               /* COME HERE                                         */ 00631000
*               /*                                                   */ 00632000
*               /*****************************************************/ 00633000
*                                                                  0221 00634000
*               ELSE                                               0221 00635000
*                 DO;               /* RELEASE LG OR SAVE REQUEST  0221 00636000
*                                      PROCESSING                    */ 00637000
         B     @RC00205                                            0221 00638000
@RF00205 DS    0H                                                  0222 00639000
*                   RFY                                            0222 00640000
*                     LGVTPTR RSTD;                                0222 00641000
*                   LGVTPTR=ASMLGVT;/* OBTAIN ADDR OF THE LGVT       */ 00642000
         L     LGVTPTR,ASMLGVT(,ASMVTPTR)                          0223 00643000
*                   IF ACELGID>LGVMAXLG THEN                       0224 00644000
         L     @12,ACELGID(,ACEPTR)                                0224 00645000
         C     @12,LGVMAXLG(,LGVTPTR)                              0224 00646000
         BNH   @RF00224                                            0224 00647000
*                     DO;           /* LGN VALUE NOT IN LGVT         */ 00648000
*                       RTNCODE=CODE04;/* LGN INVALID                */ 00649000
         MVC   RTNCODE(4),@CF00051                                 0226 00650000
*                       CALL FREELOCK;/* FREE THE ASM CLASS LOCK     */ 00651000
         BAL   @14,FREELOCK                                        0227 00652000
*                       GO TO FREEACE;/* GET OUT IMMEDIATELY         */ 00653000
         B     FREEACE                                             0228 00654000
*                     END;                                         0229 00655000
*                   RFY                                            0230 00656000
*                     LGVTEPTR RSTD;                               0230 00657000
@RF00224 DS    0H                                                  0231 00658000
*                   LGVTEPTR=ADDR(LGVENTRS(ACELGID+ONE));/* LGID   0231 00659000
*                                      GIVES OFFSET INTO LGVT ENTRIES   00660000
*                                      FOR PROPER LGVTE              */ 00661000
         L     @12,ACELGID(,ACEPTR)                                0231 00662000
         LR    @15,@12                                             0231 00663000
         SLA   @15,3                                               0231 00664000
         LA    LGVTEPTR,LGVENTRS(@15,LGVTPTR)                      0231 00665000
*                   IF LGVELGID=ACELGID THEN                       0232 00666000
         C     @12,LGVELGID(,LGVTEPTR)                             0232 00667000
         BNE   @RF00232                                            0232 00668000
*                     DO;           /* LGID NOT ASSIGNED             */ 00669000
*                       RTNCODE=CODE04;/* INVALID LGN                */ 00670000
         MVC   RTNCODE(4),@CF00051                                 0234 00671000
*                       CALL FREELOCK;/* FREE THE ASM CLASS LOCK     */ 00672000
         BAL   @14,FREELOCK                                        0235 00673000
*                       GO TO FREEACE;/* GET OUT IMMEDIATELY         */ 00674000
         B     FREEACE                                             0236 00675000
*                     END;                                         0237 00676000
*                   LGEPTR=LGVELGEP;/* OBTAIN LGE ADDR               */ 00677000
@RF00232 L     LGEPTR,LGVELGEP(,LGVTEPTR)                          0238 00678000
*                   RFY                                            0239 00679000
*                    (LGVTPTR,                                     0239 00680000
*                     LGVTEPTR) UNRSTD;                            0239 00681000
*                   IF ACEOP=ACERELLG&LGEASPCT->ASPSSYM^=DOUBLE00 THEN  00682000
         CLI   ACEOP(ACEPTR),12                                    0240 00683000
         BNE   @RF00240                                            0240 00684000
         L     @12,LGEASPCT(,LGEPTR)                               0240 00685000
         CLC   ASPSSYM(8,@12),@CB01681                             0240 00686000
         BE    @RF00240                                            0240 00687000
*                     DO;           /* RELEASE REQUESTED AND 'S'   0241 00688000
*                                      SYMBOL NEEDED BUT IT WAS NOT     00689000
*                                      SUPPLIED IN THE ACE AS      0241 00690000
*                                      INDICATED BY ACEUSYM          */ 00691000
*                       RTNCODE=CODE40;/* INVALID INDENTIFIER TYPE   */ 00692000
         MVC   RTNCODE(4),@CF00507                                 0242 00693000
*                       CALL FREELOCK;/* FREE THE ASM CLASS LOCK     */ 00694000
         BAL   @14,FREELOCK                                        0243 00695000
*                       GOTO FREEACE;/* GET OUT IMMEDITATELY         */ 00696000
         B     FREEACE                                             0244 00697000
*                     END;                                         0245 00698000
*                 END;              /* END RELEASE LG AND SAVE       */ 00699000
@RF00240 DS    0H                                                  0247 00700000
*                                                                  0247 00701000
*               /*****************************************************/ 00702000
*               /*                                                   */ 00703000
*               /* RELEASE 'S' SYMBOL PROCESSING FOR WHICH THE LGID  */ 00704000
*               /* HAS BEEN FOUND AND SAVE AND RELEASE LG PROCESSING */ 00705000
*               /* COMES HERE                                        */ 00706000
*               /*                                                   */ 00707000
*               /*****************************************************/ 00708000
*                                                                  0247 00709000
*               IF IDEXISTS=ON THEN                                0247 00710000
@RC00205 TM    IDEXISTS,B'01000000'                                0247 00711000
         BNO   @RF00247                                            0247 00712000
*                 DO;               /* SAVE & RELEASE PROCESSING FOR    00713000
*                                      EXISTING LG                   */ 00714000
*                   IF LGERELLG=ON THEN                            0249 00715000
         TM    LGERELLG(LGEPTR),B'00100000'                        0249 00716000
         BNO   @RF00249                                            0249 00717000
*                     DO;           /* RELEASE HAS ALREADY BEEN    0250 00718000
*                                      REQUESTED FOR THE LG          */ 00719000
*                       RTNCODE=CODE04;/* LGN NOT VALID FOR REQUEST  */ 00720000
         MVC   RTNCODE(4),@CF00051                                 0251 00721000
*                       CALL FREELOCK;/* FREE THE ASM CLASS LOCK     */ 00722000
         BAL   @14,FREELOCK                                        0252 00723000
*                       GOTO FREEACE;/* GET OUT IMMEDIATELY          */ 00724000
         B     FREEACE                                             0253 00725000
*                     END;                                         0254 00726000
*                   IF ACEOP=ACERELLG THEN                         0255 00727000
@RF00249 CLI   ACEOP(ACEPTR),12                                    0255 00728000
         BNE   @RF00255                                            0255 00729000
*                     LGERELLG=ON;  /* INIDCATE RELEASE REQUESTED FOR   00730000
*                                      LG                            */ 00731000
         OI    LGERELLG(LGEPTR),B'00100000'                        0256 00732000
*                   ELSE                                           0257 00733000
*                     DO;           /* SAVE REQUEST                  */ 00734000
         B     @RC00255                                            0257 00735000
@RF00255 DS    0H                                                  0258 00736000
*                       RFY                                        0258 00737000
*                         ASPCTPTR RSTD;                           0258 00738000
*                       ASPCTPTR=LGEASPCT;/* OBTAIN ADDR ASPCT       */ 00739000
         L     ASPCTPTR,LGEASPCT(,LGEPTR)                          0259 00740000
*                       IF ASPSSYM=DOUBLE00 THEN/* ASPCT HAS NOT BEEN   00741000
*                                      PREVIOUSLY SAVED              */ 00742000
         CLC   ASPSSYM(8,ASPCTPTR),@CB01681                        0260 00743000
         BNE   @RF00260                                            0260 00744000
*                         DO;       /* GENERATE 'S' SYMBOL FOR THE 0261 00745000
*                                      ASPCT, USE CS                 */ 00746000
*                           RFY                                    0262 00747000
*                            (R0,                                  0262 00748000
*                             R1,                                  0262 00749000
*                             R14,                                 0262 00750000
*                             R15) RSTD;                           0262 00751000
*                           LM(R14,R15,ASMLSAI);/* OBTAIN THE ASM  0263 00752000
*                                      LOCATOR SYMBOL                */ 00753000
         LM    R14,R15,ASMLSAI(ASMVTPTR)                           0263 00754000
*TRYAGAIN:                                                         0264 00755000
*                           R0=R14+ONE;/* INCR LOW PART OF LOC SYMBOL*/ 00756000
TRYAGAIN LA    R0,1                                                0264 00757000
         ALR   R0,R14                                              0264 00758000
*                           IF R0>ASMCINV THEN                     0265 00759000
         C     R0,ASMCINV(,ASMVTPTR)                               0265 00760000
         BNH   @RF00265                                            0265 00761000
*                             DO;   /* IF MAX. NUMBER CONTROL      0266 00762000
*                                      INTERVALS REACHED             */ 00763000
*                               R0=ZERO;/* RESET LOW PART OF LOC   0267 00764000
*                                      SYMBOL                        */ 00765000
         SLR   R0,R0                                               0267 00766000
*                               R1=R15-ONE;/* DECR HIGH PART OF LOC     00767000
*                                      SYMBOL                        */ 00768000
         LR    R1,R15                                              0268 00769000
         BCTR  R1,0                                                0268 00770000
*                             END;                                 0269 00771000
*                           ELSE                                   0270 00772000
*                             R1=R15;/* OBTAIN THE HIGH PART OF LOC     00773000
*                                      SYMBOL                        */ 00774000
         B     @RC00265                                            0270 00775000
@RF00265 LR    R1,R15                                              0270 00776000
*                           CDS(R14,R0,ASMLSAI);/* STORE LOC SYMBOL  */ 00777000
@RC00265 CDS   R14,R0,ASMLSAI(ASMVTPTR)                            0271 00778000
*                           BC(NE,TRYAGAIN);/* NOT SUCCESSFUL, TRY 0272 00779000
*                                      AGAIN                         */ 00780000
         BC    7,TRYAGAIN                                          0272 00781000
*                           STM(R0,R1,ASPSSYM);/* STORE SYMBOL     0273 00782000
*                                      ASSIGNED IN THE ASPCT         */ 00783000
         STM   R0,R1,ASPSSYM(ASPCTPTR)                             0273 00784000
*                           RFY                                    0274 00785000
*                            (ASPCTPTR,                            0274 00786000
*                             R0,                                  0274 00787000
*                             R1,                                  0274 00788000
*                             R14,                                 0274 00789000
*                             R15) UNRSTD;                         0274 00790000
*                         END;      /* END DO FOR ASSIGNING 'S'    0275 00791000
*                                      SYMBOL                        */ 00792000
*                     END;          /* END SAVE REQUEST              */ 00793000
*                 END;              /* END IDEXISTS DO               */ 00794000
*               ELSE                                               0278 00795000
*                 CALL FREELOCK;    /* RELEASE 'S' SYMBOL AND LGID 0278 00796000
*                                      NOT FOUND, RELEASE THE ASM  0278 00797000
*                                      CLASS LOCK                    */ 00798000
         B     @RC00247                                            0278 00799000
@RF00247 BAL   @14,FREELOCK                                        0278 00800000
*             END;                  /* END DO FOR NOT AN ACTIVATE  0279 00801000
*                                      REQUEST                       */ 00802000
*                                                                  0280 00803000
*           /*********************************************************/ 00804000
*           /*                                                       */ 00805000
*           /* RELEASE 'S' REQUESTS FOR WHICH THE LGID COULD NOT BE  */ 00806000
*           /* FOUND AND ACTIVATE REQUESTS ARE PROCESSED BY CALLING  */ 00807000
*           /* THE ASSIGN SUBROUTINE TO ASSIGN AN LG AND BUILD AN    */ 00808000
*           /* LGE, THE LGE IS THEN QUEUED TO THE ASM HEADER LGE     */ 00809000
*           /* QUEUE                                                 */ 00810000
*           /*                                                       */ 00811000
*           /*********************************************************/ 00812000
*                                                                  0280 00813000
*           ELSE                                                   0280 00814000
*             EPAACASR=ON;          /* RRR-INDICATE ASSIGN OR      0280 00815000
*                                      ACTIVATE PROCESSING-RRR       */ 00816000
         B     @RC00201                                            0280 00817000
@RF00201 OI    EPAACASR,B'00001000'                                0280 00818000
*           IF ACEOP=ACEACT|IDEXISTS=OFF THEN                      0281 00819000
@RC00201 CLI   ACEOP(ACEPTR),20                                    0281 00820000
         BE    @RT00281                                            0281 00821000
         TM    IDEXISTS,B'01000000'                                0281 00822000
         BNZ   @RF00281                                            0281 00823000
@RT00281 DS    0H                                                  0282 00824000
*             DO;                   /* ACTIVATE REQUEST OR LGID DOES    00825000
*                                      NOT EXIST                     */ 00826000
*               REQASPCT=OFF;       /* NO ASPCT NEEDED, TAKEN CARE OF   00827000
*                                      BY GROUP OPERATOR             */ 00828000
         NI    REQASPCT,B'01111111'                                0283 00829000
*               CALL ASSIGNLG;      /* BUILD LGE AND ASSIGN A LGN    */ 00830000
         BAL   @14,ASSIGNLG                                        0284 00831000
*               IF RTNCODE=ZERO THEN                               0285 00832000
         L     @12,RTNCODE                                         0285 00833000
         LTR   @12,@12                                             0285 00834000
         BNZ   @RF00285                                            0285 00835000
*                 DO;               /* ASSIGN SUBROUTINE SUCCESSFUL  */ 00836000
*                   RFY                                            0287 00837000
*                     R15 UNRSTD;                                  0287 00838000
*                   CALL GETLOCK;   /* OBTAIN THE ASM CLASS LOCK     */ 00839000
         BAL   @14,GETLOCK                                         0288 00840000
*                   ACELGID=LGELGID;/* PLACE THE LGN ASSIGNED IN THE    00841000
*                                      ACE                           */ 00842000
         L     @12,LGELGID(,LGEPTR)                                0289 00843000
         ST    @12,ACELGID(,ACEPTR)                                0289 00844000
*                   IF ACEOP=ACERELLG THEN                         0290 00845000
         CLI   ACEOP(ACEPTR),12                                    0290 00846000
         BNE   @RF00290                                            0290 00847000
*                     LGERELLG=ON;  /* INDICATE RELEASE REQUEST FOR     00848000
*                                      LG                            */ 00849000
         OI    LGERELLG(LGEPTR),B'00100000'                        0291 00850000
*                 END;              /* END SUCCESSFUL ASSIGN       0292 00851000
*                                      SUBROUTINE                    */ 00852000
*               ELSE                                               0293 00853000
*                 GOTO FREEACE;     /* ASSIGN UNSUCCESSFUL, RETURN 0293 00854000
*                                      ACE AND GET OUT IMMEDIATELY   */ 00855000
*             END;                  /* END ACTIVATE, LGID DOES NOT 0294 00856000
*                                      EXIST                         */ 00857000
@RC00285 DS    0H                                                  0295 00858000
*                                                                  0295 00859000
*           /*********************************************************/ 00860000
*           /*                                                       */ 00861000
*           /* QUEUE THE ACE TO THE LGE PROCESS Q, ALL VALID REQUESTS*/ 00862000
*           /* EXCEPT THAT FOR ASSIGN COME HERE                      */ 00863000
*           /*                                                       */ 00864000
*           /*********************************************************/ 00865000
*                                                                  0295 00866000
*           ACELGE=LGEPTR;          /* STORE THE LGE ADDR IN THE ACE */ 00867000
@RF00281 ST    LGEPTR,ACELGE(,ACEPTR)                              0295 00868000
*           IF LGEPROCF=ZERO THEN                                  0296 00869000
         L     @12,LGEPROCF(,LGEPTR)                               0296 00870000
         LTR   @12,@12                                             0296 00871000
         BNZ   @RF00296                                            0296 00872000
*             DO;                   /* NOTHING ON THE LGE PROCESS  0297 00873000
*                                      QUEUE                         */ 00874000
*               LGEPROCF=ACEPTR;    /* SET FIRST AND LAST QUEUE      */ 00875000
         ST    ACEPTR,LGEPROCF(,LGEPTR)                            0298 00876000
*               LGEPROCL=ACEPTR;    /* POINTERS TO ACE ADDR          */ 00877000
         ST    ACEPTR,LGEPROCL(,LGEPTR)                            0299 00878000
*               LGEGRINP=ON;        /* SET GROUP OP IN PROGRESS FLAG */ 00879000
         OI    LGEGRINP(LGEPTR),B'01000000'                        0300 00880000
*               CALL FREELOCK;      /* FREE THE ASM CLASS LOCK       */ 00881000
         BAL   @14,FREELOCK                                        0301 00882000
*               IF ACEOP=ACERELLG THEN                             0302 00883000
         CLI   ACEOP(ACEPTR),12                                    0302 00884000
         BNE   @RF00302                                            0302 00885000
*                 DO;               /* RELEASE REQUEST, Q EMPTY      */ 00886000
*                   LGESLTCT=ZERO;  /* CLEAR THE SLOT COUNT FOR    0304 00887000
*                                      RETURN BY RELEASE GROUP OP    */ 00888000
         SLR   @12,@12                                             0304 00889000
         STH   @12,LGESLTCT(,LGEPTR)                               0304 00890000
*                   RFY                                            0305 00891000
*                    (R1,                                          0305 00892000
*                     R15,                                         0305 00893000
*                     R13) RSTD;                                   0305 00894000
*                   R4SAVE=ATAPTR;  /* SAVE R4, GROUP OPERATOR CANNOT   00895000
*                                      USE ATA                       */ 00896000
         ST    ATAPTR,R4SAVE                                       0306 00897000
*                   R4=ADDR(EPATH); /* SET EPATH ADDR FOR GROUP    0307 00898000
*                                      OPERATOR                      */ 00899000
         LA    R4,EPATH                                            0307 00900000
*                   R13=ADDR(SAVAREA);/* ADDR SAVE AREA FOR RELEASE     00901000
*                                      GROUP OP                      */ 00902000
         LA    R13,SAVAREA                                         0308 00903000
*                   R1=ACEPTR;      /* ADDR ACE CONTAINING LGID TO BE   00904000
*                                      RELEASED                      */ 00905000
         LR    R1,ACEPTR                                           0309 00906000
*                   CALL ILRRLG;    /* RELEASE GROUP OPERATOR WILL 0310 00907000
*                                      RELEASE THE LG                */ 00908000
         L     @15,ASMPRLG(,ASMVTPTR)                              0310 00909000
         BALR  @14,@15                                             0310 00910000
*                   ATAPTR=R4SAVE;  /* RESTORE ATA ADDR              */ 00911000
         L     ATAPTR,R4SAVE                                       0311 00912000
*                   RTNCODE=R15;    /* SAVE THE RETURN CODE          */ 00913000
         ST    R15,RTNCODE                                         0312 00914000
*                   RFY                                            0313 00915000
*                    (R1,                                          0313 00916000
*                     R15,                                         0313 00917000
*                     R13) UNRSTD;                                 0313 00918000
*                 END;              /* END RELEASE REQUEST, Q EMPTY  */ 00919000
*             END;                  /* END LGE PROCESS Q EMPTY       */ 00920000
*           ELSE                                                   0316 00921000
*             DO;                   /* LGE PROCESS Q NOT EMPTY       */ 00922000
         B     @RC00296                                            0316 00923000
@RF00296 DS    0H                                                  0317 00924000
*               LGEPROCL->ACEFQPA=ACEPTR;/* Q ACE TO LAST ACE ON Q   */ 00925000
         L     @12,LGEPROCL(,LGEPTR)                               0317 00926000
         ST    ACEPTR,ACEFQPA(,@12)                                0317 00927000
*               ACEBQPA=LGEPROCL;   /* POINT BACK TO PREVIOUS ACE ON    00928000
*                                      Q                             */ 00929000
         ST    @12,ACEBQPA(,ACEPTR)                                0318 00930000
*               LGEPROCL=ACEPTR;    /* MAKE LAST Q ELEMENT THE ACE   */ 00931000
         ST    ACEPTR,LGEPROCL(,LGEPTR)                            0319 00932000
*               LGEWRKPD=ON;        /* WORK PENDING FOR THIS LG      */ 00933000
         OI    LGEWRKPD(LGEPTR),B'10000000'                        0320 00934000
*               CALL FREELOCK;      /* FREE THE ASM CLASS LOCK       */ 00935000
         BAL   @14,FREELOCK                                        0321 00936000
*                                                                  0322 00937000
*               /*****************************************************/ 00938000
*               /*                                                   */ 00939000
*               /* REQUEST MUST BE FOR SAVE OR RELEASE, SINCE AN LGE */ 00940000
*               /* HAS JUST BEEN ASSIGNED ON AN ACTIVATE REQUEST,    */ 00941000
*               /* THUS ITS PROCESS Q IS EMPTY                       */ 00942000
*               /*                                                   */ 00943000
*               /*****************************************************/ 00944000
*                                                                  0322 00945000
*               IF ACEOP=ACESVLGN THEN                             0322 00946000
         CLI   ACEOP(ACEPTR),16                                    0322 00947000
         BNE   @RF00322                                            0322 00948000
*                 DO;               /* SAVE REQUEST, Q NOT EMPTY     */ 00949000
*                   LGESAVRQ=ON;    /* SET SAVE REQUEST FLAG IN LGE  */ 00950000
         OI    LGESAVRQ(LGEPTR),B'00010000'                        0324 00951000
*                   RFY                                            0325 00952000
*                     ECBPTR RSTD;                                 0325 00953000
*                   ECBPTR=ADDR(ACEECB);/* ADDR ECB TO BE WAITED ON  */ 00954000
         LA    ECBPTR,ACEECB(,ACEPTR)                              0326 00955000
*                   GEN REFS(ECBPTR);                              0327 00956000
       WAIT ECB=(ECBPTR)   POSTED BY SRB CONTROLLER                     00957000
*                   RFY                                            0328 00958000
*                     ECBPTR UNRSTD;                               0328 00959000
*                   ACEECB=''B;     /* CLEAR THE ACEECB, POSTED BY 0329 00960000
*                                      SRBC                          */ 00961000
         SLR   @12,@12                                             0329 00962000
         ST    @12,ACEECB(,ACEPTR)                                 0329 00963000
*                 END;              /* END SAVE REQUEST, Q NOT EMPTY */ 00964000
*             END;                  /* LGE PROCESS Q NOT EMPTY       */ 00965000
@RF00322 DS    0H                                                  0332 00966000
*                                                                  0332 00967000
*           /*********************************************************/ 00968000
*           /*                                                       */ 00969000
*           /* ALL SAVE OR ACTIVATE REQUESTS COME HERE, THE ASMVT    */ 00970000
*           /* BUFFER COUNT IS DECREMENTED OR A BUFFER CONTROL BLOCK */ 00971000
*           /* IS BUILT AND QUEUED TO THE ASMVT VSAM BUFFER WAITING Q*/ 00972000
*           /*                                                       */ 00973000
*           /*********************************************************/ 00974000
*                                                                  0332 00975000
*           IF ACAOP^=ACERELLG THEN                                0332 00976000
@RC00296 CLI   ACAOP(ACAPTR),12                                    0332 00977000
         BE    @RF00332                                            0332 00978000
*             DO;                   /* SAVE OR ACTIVATE REQUEST      */ 00979000
*               RFY                                                0334 00980000
*                (R11,                                             0334 00981000
*                 R12) RSTD;                                       0334 00982000
*               R12=ASMREQCT;       /* OBTAIN VSAM BUFFER REQUEST  0335 00983000
*                                      COUNT                         */ 00984000
         L     R12,ASMREQCT(,ASMVTPTR)                             0335 00985000
*REDOIT:                                                           0336 00986000
*               IF R12=ZERO THEN                                   0336 00987000
REDOIT   LTR   R12,R12                                             0336 00988000
         BNZ   @RF00336                                            0336 00989000
*                 DO;               /* NO VSAM BUFFERS AVAILABLE     */ 00990000
*                   BUFPTR=ADDR(WKBUFCON);/* OBTAIN THE ADDR OF THE     00991000
*                                      BUFFER CONTROL BLOCK TO BE  0338 00992000
*                                      BUILT IN WORK-SAVE AREA       */ 00993000
         LA    BUFPTR,WKBUFCON                                     0338 00994000
*                   BUFASCB=PSAAOLD;/* PUT ADDR THIS ASCB IN CONTROL    00995000
*                                      BLOCK                         */ 00996000
         L     @10,PSAAOLD                                         0339 00997000
         ST    @10,BUFASCB(,BUFPTR)                                0339 00998000
*                   BUFACE=ACEPTR;  /* PUT ADDR THIS ACE IN CONTROL     00999000
*                                      BLOCK                         */ 01000000
         ST    ACEPTR,BUFACE(,BUFPTR)                              0340 01001000
*                   RFY                                            0341 01002000
*                     R0 RSTD;                                     0341 01003000
*                   R0=ASMGOSWT;    /* ADDR OF THE VSAM BUFFER     0342 01004000
*                                      WAITING Q                     */ 01005000
         L     R0,ASMGOSWT(,ASMVTPTR)                              0342 01006000
*AGAIN:                                                            0343 01007000
*                   BUFCHAIN=R0;    /* CHAIN WAITING Q TO THE CONTROL   01008000
*                                      BLOCK                         */ 01009000
AGAIN    ST    R0,BUFCHAIN(,BUFPTR)                                0343 01010000
*                   CS(R0,BUFPTR,ASMGOSWT);/* MAKE CONTROL BLOCK   0344 01011000
*                                      FIRST ELEMENT ON WAITING Q    */ 01012000
         CS    R0,@12,ASMGOSWT(ASMVTPTR)                           0344 01013000
*                   BC(NE,AGAIN);   /* NOT SUCCESSFUL, TRY AGAIN     */ 01014000
         BC    7,AGAIN                                             0345 01015000
*                   RFY                                            0346 01016000
*                     R0 UNRSTD;                                   0346 01017000
*                   RFY                                            0347 01018000
*                     ECBPTR RSTD;                                 0347 01019000
*                   ECBPTR=ADDR(ACEECB);/* ADDRESS ECB TO BE WAITED     01020000
*                                      ON                            */ 01021000
         LA    ECBPTR,ACEECB(,ACEPTR)                              0348 01022000
*                   GEN REFS(ECBPTR);                              0349 01023000
        WAIT ECB=(ECBPTR)   XMPOSTED BY GOS                             01024000
*                   ACEECB=''B;     /* CLEAR ACEECB POSTED BY GOS    */ 01025000
         SLR   @10,@10                                             0350 01026000
         ST    @10,ACEECB(,ACEPTR)                                 0350 01027000
*                 END;              /* NO VSAM BUFFER                */ 01028000
*               ELSE                                               0352 01029000
*                 DO;               /* VSAM BUFFERS AVAILABLE        */ 01030000
         B     @RC00336                                            0352 01031000
@RF00336 DS    0H                                                  0353 01032000
*                   R11=R12-ONE;    /* DECR VSAM BUFFER COUNT        */ 01033000
         LR    R11,R12                                             0353 01034000
         BCTR  R11,0                                               0353 01035000
*                   CS(R12,R11,ASMREQCT);/* STORE DECREMENTED COUNT,    01036000
*                                      IF POSSIBLE                   */ 01037000
         CS    R12,@11,ASMREQCT(ASMVTPTR)                          0354 01038000
*                   BC(NE,REDOIT);  /* NOT SUCCESSFUL, TRY AGAIN     */ 01039000
         BC    7,REDOIT                                            0355 01040000
*                   RFY                                            0356 01041000
*                    (R11,                                         0356 01042000
*                     R12) UNRSTD;                                 0356 01043000
*                 END;              /* VSAM BUFFERS AVAILABLE        */ 01044000
*                                                                  0358 01045000
*               /*****************************************************/ 01046000
*               /*                                                   */ 01047000
*               /* THE SLOT COUNT IS CLEARED, THE PROPER OPERATOR IS */ 01048000
*               /* CALLED, AND THE PROPER BUFFER CONTROL FUNCTIONS   */ 01049000
*               /* PERFORMED                                         */ 01050000
*               /*                                                   */ 01051000
*               /*****************************************************/ 01052000
*                                                                  0358 01053000
*               LGESLTCT=ZERO;      /* CLEAR THE SLOT COUNT FOR THE     01054000
*                                      GROUP OPERATOR                */ 01055000
@RC00336 SLR   @12,@12                                             0358 01056000
         STH   @12,LGESLTCT(,LGEPTR)                               0358 01057000
*               RFY                                                0359 01058000
*                (R1,                                              0359 01059000
*                 R13,                                             0359 01060000
*                 R15) RSTD;                                       0359 01061000
*               R4SAVE=ATAPTR;      /* SAVE R4, GROUP OPERATOR CANNOT   01062000
*                                      USE ATA                       */ 01063000
         ST    ATAPTR,R4SAVE                                       0360 01064000
*               R4=ADDR(EPATH);     /* SET EPATH ADDR FOR GROUP    0361 01065000
*                                      OPERATOR                      */ 01066000
         LA    R4,EPATH                                            0361 01067000
*               R13=ADDR(SAVAREA);  /* ADDR SAVE AREA FOR GROUP    0362 01068000
*                                      OPERATOR                      */ 01069000
         LA    R13,SAVAREA                                         0362 01070000
*               R1=ACEPTR;          /* ADDR ACE CONTAINING SAVE,   0363 01071000
*                                      ACTIVATE REQUEST              */ 01072000
         LR    R1,ACEPTR                                           0363 01073000
*               IF ACEOP=ACEACT THEN                               0364 01074000
         CLI   ACEOP(ACEPTR),20                                    0364 01075000
         BNE   @RF00364                                            0364 01076000
*                 CALL ILRACT;      /* ACTIVATE GROUP OPERATOR NEEDED*/ 01077000
         L     @15,ASMPACT(,ASMVTPTR)                              0365 01078000
         BALR  @14,@15                                             0365 01079000
*               ELSE                                               0366 01080000
*                 CALL ILRSAV;      /* SAVE GROUP OPERATOR NEEDED    */ 01081000
         B     @RC00364                                            0366 01082000
@RF00364 L     @15,ASMPSAV(,ASMVTPTR)                              0366 01083000
         BALR  @14,@15                                             0366 01084000
*               ATAPTR=R4SAVE;      /* RESTORE ATA ADDR              */ 01085000
@RC00364 L     ATAPTR,R4SAVE                                       0367 01086000
*               RTNCODE=R15;        /* SAVE GROUP OPERATOR           */ 01087000
         ST    R15,RTNCODE                                         0368 01088000
*               RFY                                                0369 01089000
*                 R13 UNRSTD;                                      0369 01090000
*               RFY                                                0370 01091000
*                (R0,                                              0370 01092000
*                 R11,                                             0370 01093000
*                 R12,                                             0370 01094000
*                 R14) RSTD;                                       0370 01095000
*LOOP:                                                             0371 01096000
*               LM(R14,R15,ASMGOSQS);/* OBTAIN THE WAITING AND WORK     01097000
*                                      QUEUES RESPECTIVELY           */ 01098000
LOOP     LM    R14,R15,ASMGOSQS(ASMVTPTR)                          0371 01099000
*REPEAT:                                                           0372 01100000
*               IF R15=ZERO&R14=ZERO THEN                          0372 01101000
REPEAT   SLR   @10,@10                                             0372 01102000
         CR    R15,@10                                             0372 01103000
         BNE   @RF00372                                            0372 01104000
         CR    R14,@10                                             0372 01105000
         BNE   @RF00372                                            0372 01106000
*                 DO;               /* VSAM BUFFER QUES EMPTY        */ 01107000
*                   RFY                                            0374 01108000
*                    (R11,                                         0374 01109000
*                     R12) RSTD;                                   0374 01110000
*                   R12=ASMREQCT;   /* VSAM BUFFER REQUEST COUNT     */ 01111000
         L     R12,ASMREQCT(,ASMVTPTR)                             0375 01112000
*                   R11=R12+ONE;    /* INCR REQUEST COUNT            */ 01113000
         LA    R11,1                                               0376 01114000
         ALR   R11,R12                                             0376 01115000
*                   CS(R12,R11,ASMREQCT);/* STORE INCREMENTED COUNT,    01116000
*                                      IF POSSIBLE                   */ 01117000
         CS    R12,@11,ASMREQCT(ASMVTPTR)                          0377 01118000
*                   BC(NE,LOOP);    /* NOT SUCCESSFUL, TRY AGAIN     */ 01119000
         BC    7,LOOP                                              0378 01120000
*                 END;              /* VSAM BUFFER Q'S EMPTY         */ 01121000
*               ELSE                                               0380 01122000
*                 DO;               /* BUFFER QUEUES NOT EMPTY       */ 01123000
         B     @RC00372                                            0380 01124000
@RF00372 DS    0H                                                  0381 01125000
*                   IF R15=ZERO THEN                               0381 01126000
         LTR   R15,R15                                             0381 01127000
         BNZ   @RF00381                                            0381 01128000
*                     DO;           /* WORK Q EMPTY, WAITING Q NOT 0382 01129000
*                                      EMPTY                         */ 01130000
*                                                                  0382 01131000
*                       /*********************************************/ 01132000
*                       /*                                           */ 01133000
*                       /* COMPARE AND SWAP THE BUFFER WAITING Q TO  */ 01134000
*                       /* THE BUFFER WORK Q                         */ 01135000
*                       /*                                           */ 01136000
*                       /*********************************************/ 01137000
*                                                                  0383 01138000
*                       RFY                                        0383 01139000
*                        (R0,                                      0383 01140000
*                         R14) RSTD;                               0383 01141000
*                       R1=R14;     /* TO MOVE WAITING Q TO WORK Q   */ 01142000
         LR    R1,R14                                              0384 01143000
*                       R0=ZERO;    /* TO ZERO THE WAITING Q         */ 01144000
         SLR   R0,R0                                               0385 01145000
*                       CDS(R14,R0,ASMGOSQS);/* MOVE WAITING Q TO  0386 01146000
*                                      WORK Q                        */ 01147000
         CDS   R14,R0,ASMGOSQS(ASMVTPTR)                           0386 01148000
*                       BC(NE,REPEAT);/* NOT SUCCESSFUL, TRY AGAIN   */ 01149000
         BC    7,REPEAT                                            0387 01150000
*                       R15=R1;     /* OBTAIN NEW WORK QUEUE ADDR    */ 01151000
         LR    R15,R1                                              0388 01152000
*                     END;          /* END WAITING Q TO WORK Q       */ 01153000
*                                                                  0389 01154000
*                   /*************************************************/ 01155000
*                   /*                                               */ 01156000
*                   /* COMPARE AND SWAP THE FIRST ELEMENT OFF THE    */ 01157000
*                   /* BUFFER WORK Q                                 */ 01158000
*                   /*                                               */ 01159000
*                   /*************************************************/ 01160000
*                                                                  0390 01161000
*                   BUFPTR=R15;     /* ADDR OF THE FIRST ELEMENT ON     01162000
*                                      THE VSAM BUFFER WORK Q        */ 01163000
@RF00381 LR    BUFPTR,R15                                          0390 01164000
*                   R0=BUFCHAIN;    /* OBTAIN NEXT BUFFER WORK Q   0391 01165000
*                                      ELEMENT                       */ 01166000
         L     R0,BUFCHAIN(,BUFPTR)                                0391 01167000
*                   CS(BUFPTR,R0,ASMGOSWK);/* UPDATE WORK Q TO NEXT     01168000
*                                      ELEMENT ON Q                  */ 01169000
         CS    BUFPTR,@00,ASMGOSWK(ASMVTPTR)                       0392 01170000
*                   BC(NE,LOOP);    /* NOT SUCCESSFUL, TRY AGAIN     */ 01171000
         BC    7,LOOP                                              0393 01172000
*                   RFY                                            0394 01173000
*                    (R0,                                          0394 01174000
*                     R1,                                          0394 01175000
*                     R14,                                         0394 01176000
*                     R15) UNRSTD;                                 0394 01177000
*                   RFY                                            0395 01178000
*                     ASCBPTR RSTD;                                0395 01179000
*                   ECBPTR=ADDR(BUFACE->ACEECB);/* OBTAIN ECB TO BE     01180000
*                                      POSTED                        */ 01181000
         L     ECBPTR,BUFACE(,BUFPTR)                              0396 01182000
         LA    ECBPTR,ACEECB(,ECBPTR)                              0396 01183000
*                   ASCBPTR=BUFASCB;/* OBTAIN ASCB OF WAITING ADDRESS   01184000
*                                      SPACE                         */ 01185000
         L     ASCBPTR,BUFASCB(,BUFPTR)                            0397 01186000
*                   R12=ADDR(CVTBRET);/* ADDR ROUTINE GIVEN CONTROL     01187000
*                                      ON POST ERROR                 */ 01188000
         L     R12,CVTPTR                                          0398 01189000
         LA    R12,CVTBRET(,R12)                                   0398 01190000
*                   GEN REFS(ASCBPTR,ECBPTR);                      0399 01191000
*                         /* POST ECB WAITED ON IN ANOTHER              01192000
*    ADDRESS SPACE, XMPOST THE ACEECB */                                01193000
         POST (ECBPTR),ASCB=(ASCBPTR),ERRET=(R12),MF=(E,POSTLIST)       01194000
*                   RFY                                            0400 01195000
*                    (R11,                                         0400 01196000
*                     ASCBPTR,                                     0400 01197000
*                     R12) UNRSTD;                                 0400 01198000
*                 END;              /* BUFFER QUEUES NOT EMPTY       */ 01199000
*             END;                  /* SAVE OR ACTIVATE REQUEST      */ 01200000
@RC00372 DS    0H                                                  0403 01201000
*                                                                  0403 01202000
*           /*********************************************************/ 01203000
*           /*                                                       */ 01204000
*           /* COMMON BACKEND PROCESSING FOR SAVE OR ACTIVATE        */ 01205000
*           /* REQUESTS, OR A RELEASE REQUEST WITH RETURN CODE OF 28 */ 01206000
*           /*                                                       */ 01207000
*           /*********************************************************/ 01208000
*                                                                  0403 01209000
*           IF ACAOP^=ACERELLG|RTNCODE=CODE28 THEN                 0403 01210000
@RF00332 CLI   ACAOP(ACAPTR),12                                    0403 01211000
         BNE   @RT00403                                            0403 01212000
         CLC   RTNCODE(4),@CF00438                                 0403 01213000
         BNE   @RF00403                                            0403 01214000
@RT00403 DS    0H                                                  0404 01215000
*             DO;                   /* SAVE OR ACTIVATE, OR RELEASE     01216000
*                                      CODE28 REQUESTS               */ 01217000
*               CALL GETLOCK;       /* OBTAIN THE ASM CLASS LOCK     */ 01218000
*                                                                  0405 01219000
         BAL   @14,GETLOCK                                         0405 01220000
*               /*****************************************************/ 01221000
*               /*                                                   */ 01222000
*               /* DEQUEUE THE ACE FROM THE LGE PROCESS QUEUE        */ 01223000
*               /*                                                   */ 01224000
*               /*****************************************************/ 01225000
*                                                                  0406 01226000
*               IF ACEPTR=LGEPROCF&ACEPTR=LGEPROCL THEN            0406 01227000
         C     ACEPTR,LGEPROCF(,LGEPTR)                            0406 01228000
         BNE   @RF00406                                            0406 01229000
         C     ACEPTR,LGEPROCL(,LGEPTR)                            0406 01230000
         BNE   @RF00406                                            0406 01231000
*                 DO;               /* ACE IS BOTH FIRST AND LAST ON    01232000
*                                      THE QUEUE                     */ 01233000
*                   LGEPROCF=ZERO;  /* ZERO FIRST ACE ADDR           */ 01234000
         SLR   @12,@12                                             0408 01235000
         ST    @12,LGEPROCF(,LGEPTR)                               0408 01236000
*                   LGEPROCL=ZERO;  /* ZERO LAST ACE ADDR            */ 01237000
         ST    @12,LGEPROCL(,LGEPTR)                               0409 01238000
*                 END;                                             0410 01239000
*               ELSE                                               0411 01240000
*                 IF ACEPTR=LGEPROCF THEN                          0411 01241000
         B     @RC00406                                            0411 01242000
@RF00406 C     ACEPTR,LGEPROCF(,LGEPTR)                            0411 01243000
         BNE   @RF00411                                            0411 01244000
*                   DO;             /* ACE IS FIRST ON Q BUT NOT THE    01245000
*                                      ONLY QUEUE ELEMENT            */ 01246000
*                     LGEPROCF=ACEFQPA;/* SET FIRST ACE ADDR TO NEXT    01247000
*                                      ACE ON QUEUE                  */ 01248000
         L     @12,ACEFQPA(,ACEPTR)                                0413 01249000
         ST    @12,LGEPROCF(,LGEPTR)                               0413 01250000
*                     ACEFQPA->ACEBQPA=ZERO;/* CLEAR BACK POINTER OF    01251000
*                                      NEXT ACE                      */ 01252000
         SLR   @10,@10                                             0414 01253000
         ST    @10,ACEBQPA(,@12)                                   0414 01254000
*                   END;                                           0415 01255000
*                 ELSE                                             0416 01256000
*                   DO;             /* ACE WAS NOT FIRST             */ 01257000
*                                                                  0416 01258000
         B     @RC00411                                            0416 01259000
@RF00411 DS    0H                                                  0417 01260000
*                     /***********************************************/ 01261000
*                     /*                                             */ 01262000
*                     /* AN IMPOSSIBLE SITUATION EXISTS, ERROR MUST  */ 01263000
*                     /* BE RECORDED, ACE POINTER CLEARED, AND RETURN*/ 01264000
*                     /* CODE SET                                    */ 01265000
*                     /*                                             */ 01266000
*                     /***********************************************/ 01267000
*                                                                  0417 01268000
*                     CALL FREELOCK;/* FREE THE ASM CLASS LOCK       */ 01269000
         BAL   @14,FREELOCK                                        0417 01270000
*                     ATARCODE=REACOD12;/* REASON CODE FOR C0D ABEND */ 01271000
         MVI   ATARCODE(ATAPTR),X'0C'                              0418 01272000
*                     EPARTYRG=ADDR(RTRYRGSV);/* ADDR RETRY REGISTERS*/ 01273000
         LA    @12,RTRYRGSV                                        0419 01274000
         ST    @12,EPARTYRG                                        0419 01275000
*                     STM(R0,R14,RTRYRGSV);/* SAVE RETRY REGS        */ 01276000
         STM   R0,R14,RTRYRGSV                                     0420 01277000
*                     GEN(ABEND    X'C0D',,,SYSTEM);/* ISSUE C0D   0421 01278000
*                                      RECORD ONLY ABEND             */ 01279000
         ABEND    X'C0D',,,SYSTEM                                       01280000
*                     ACEPTR=ZERO;  /* CLEAR THE ACE POINTER         */ 01281000
         SLR   ACEPTR,ACEPTR                                       0422 01282000
*                     RTNCODE=CODE44;/* INDETERMINENT ERROR, ACE NOT    01283000
*                                      FIRST ON Q                    */ 01284000
         MVC   RTNCODE(4),@CF01405                                 0423 01285000
*                     GO TO FREEWK; /* FREE THE WORK-SAVE AREA AND 0424 01286000
*                                      GET OUT IMMEDIATELY           */ 01287000
         B     FREEWK                                              0424 01288000
*                   END;            /* ACE WAS NOT FIRST             */ 01289000
*                                                                  0426 01290000
*               /*****************************************************/ 01291000
*               /*                                                   */ 01292000
*               /* PROCESSING FOR A RELEASE REQUEST FOR WHICH ILRRLG */ 01293000
*               /* HAS RETURNED WITH A CODE28, NO STORAGE AVAILABLE. */ 01294000
*               /* THE LGE IS FREED IF THERE IS NO ASPCT, ELSE PROPER*/ 01295000
*               /* LGE FLAGS ARE RESET.                              */ 01296000
*               /*                                                   */ 01297000
*               /*****************************************************/ 01298000
*                                                                  0426 01299000
*               IF ACEOP=ACERELLG THEN                             0426 01300000
@RC00411 DS    0H                                                  0426 01301000
@RC00406 CLI   ACEOP(ACEPTR),12                                    0426 01302000
         BNE   @RF00426                                            0426 01303000
*                 DO;               /* RELEASE, CODE28               */ 01304000
*                   IF LGEASPCT=ZERO THEN/* AN ASPCT DOES NOT EXIST     01305000
*                                      FOR THIS LG                   */ 01306000
*                                                                  0428 01307000
         L     @12,LGEASPCT(,LGEPTR)                               0428 01308000
         LTR   @12,@12                                             0428 01309000
         BNZ   @RF00428                                            0428 01310000
*                     /***********************************************/ 01311000
*                     /*                                             */ 01312000
*                     /* THE ADDR OF THE LGE TO BE FREED IS IN       */ 01313000
*                     /* LGEPTR. FRELG WILL RELEASE THE ASM CLASS    */ 01314000
*                     /* LOCK.                                       */ 01315000
*                     /*                                             */ 01316000
*                     /***********************************************/ 01317000
*                                                                  0429 01318000
*                     CALL FRELG;   /* DEQUEUES AND FREES THE LGE, 0429 01319000
*                                      AND PUTS THE LGVTE BACK ON THE   01320000
*                                      AVAILABLE QUEUE               */ 01321000
         BAL   @14,FRELG                                           0429 01322000
*                   ELSE                                           0430 01323000
*                     DO;           /* ASPCT DOES EXIST              */ 01324000
         B     @RC00428                                            0430 01325000
@RF00428 DS    0H                                                  0431 01326000
*                       LGERELLG=OFF;/* RESET RELEASE LG REQUEST FLAG*/ 01327000
*                       LGEGRINP=OFF;/* RESET GROUP OP IN PROGRESS 0432 01328000
*                                      FLAG                          */ 01329000
         NI    LGERELLG(LGEPTR),B'10011111'                        0432 01330000
*                       CALL FREELOCK;/* FREE THE ASM CLASS LOCK     */ 01331000
         BAL   @14,FREELOCK                                        0433 01332000
*                     END;          /* ASPCT DOES EXIST              */ 01333000
*                 END;              /* RELEASE, CODE28               */ 01334000
*                                                                  0436 01335000
*               /*****************************************************/ 01336000
*               /*                                                   */ 01337000
*               /* PROCESSING FOR SAVES AND ACTIVATES, THE VIO SLOT  */ 01338000
*               /* COUNT IS UPDATED, GROUP OP IN PROGRESS FLAG RESET,*/ 01339000
*               /* AND THE SRB CONTROLLER SCHEDULED IF WORK IS       */ 01340000
*               /* PENDING. ALSO, FOR SAVES, THE SAVE REQUEST FLAG IS*/ 01341000
*               /* RESET IF NO OTHER SAVE REQUESTS ARE ON THE QUEUE. */ 01342000
*               /*                                                   */ 01343000
*               /*****************************************************/ 01344000
*                                                                  0436 01345000
*               ELSE                                               0436 01346000
*                 DO;               /* SAVE OR ACTIVATE BACKEND      */ 01347000
         B     @RC00426                                            0436 01348000
@RF00426 DS    0H                                                  0437 01349000
*                   IF ACEOP=ACESVLGN THEN                         0437 01350000
         CLI   ACEOP(ACEPTR),16                                    0437 01351000
         BNE   @RF00437                                            0437 01352000
*                     DO;           /* SAVE LGN REQUEST              */ 01353000
*                       LGESAVRQ=OFF;/* RESET SAVE REQUEST FLAG      */ 01354000
         NI    LGESAVRQ(LGEPTR),B'11101111'                        0439 01355000
*                       RFY                                        0440 01356000
*                         FOUNDACE RSTD;                           0440 01357000
*                       FOUNDACE=LGEPROCF;/* OBTAIN ADDR FIRST ACE ON   01358000
*                                      PROCESS Q                     */ 01359000
         L     FOUNDACE,LGEPROCF(,LGEPTR)                          0441 01360000
*                       DO WHILE FOUNDACE^=ZERO&FOUNDACE->ACEOP^=  0442 01361000
*                             ACESVLGN;/* SEARCH FOR A SAVE REQUEST     01362000
*                                      ACE                           */ 01363000
         B     @DE00442                                            0442 01364000
@DL00442 DS    0H                                                  0443 01365000
*                         FOUNDACE=FOUNDACE->ACEFQPA;/* OBTAIN ADDR     01366000
*                                      NEXT ACE ON PROCESS QUEUE     */ 01367000
         L     FOUNDACE,ACEFQPA(,FOUNDACE)                         0443 01368000
*                       END;                                       0444 01369000
@DE00442 LTR   FOUNDACE,FOUNDACE                                   0444 01370000
         BZ    @DC00442                                            0444 01371000
         CLI   ACEOP(FOUNDACE),16                                  0444 01372000
         BNE   @DL00442                                            0444 01373000
@DC00442 DS    0H                                                  0445 01374000
*                       IF FOUNDACE^=ZERO THEN                     0445 01375000
         LTR   FOUNDACE,FOUNDACE                                   0445 01376000
         BZ    @RF00445                                            0445 01377000
*                         LGESAVRQ=ON;/* IF A SAVE REQUEST ACE IS  0446 01378000
*                                      FOUND TURN THE FLAG BACK ON   */ 01379000
         OI    LGESAVRQ(LGEPTR),B'00010000'                        0446 01380000
*                       RFY                                        0447 01381000
*                         FOUNDACE UNRSTD;                         0447 01382000
@RF00445 DS    0H                                                  0448 01383000
*                     END;          /* SAVE LGN REQUEST              */ 01384000
*                   LGEGRINP=OFF;   /* RESET GROUP-OP IN PROGRESS  0449 01385000
*                                      FLAG                          */ 01386000
@RF00437 NI    LGEGRINP(LGEPTR),B'10111111'                        0449 01387000
*                   IF LGEWRKPD=ON THEN                            0450 01388000
         TM    LGEWRKPD(LGEPTR),B'10000000'                        0450 01389000
         BNO   @RF00450                                            0450 01390000
*                     IF ASHSCHED=OFF THEN                         0451 01391000
         TM    ASHSCHED(RSMHDPTR),B'10000000'                      0451 01392000
         BNZ   @RF00451                                            0451 01393000
*                       DO;         /* SCHEDULE THE SRB CONTROLLER 0452 01394000
*                                      SINCE WORK IS PENDING AND SRBC   01395000
*                                      HAS NOT BEEN SCHEDULED        */ 01396000
*                         RFY                                      0453 01397000
*                           R10 RSTD;                              0453 01398000
*                         R10=ASHVSRBP;/* ADDR SRB TO BE SCHEDULED   */ 01399000
         L     R10,ASHVSRBP(,RSMHDPTR)                             0454 01400000
*                         GEN REFS(R10);                           0455 01401000
      SCHEDULE SRB=(10),SCOPE=GLOBAL    SCHEDULES SRB CONTROLLER        01402000
*                         ASHSCHED=ON;/* SET SRB SCHEDULED FLAG      */ 01403000
         OI    ASHSCHED(RSMHDPTR),B'10000000'                      0456 01404000
*                       END;        /* END SCHEDULE SRBC             */ 01405000
*                   ASCBPTR=PSAAOLD;/* OBTAIN ADDR ASCB              */ 01406000
@RF00451 DS    0H                                                  0458 01407000
@RF00450 L     ASCBPTR,PSAAOLD                                     0458 01408000
*                   ASCBVSC=ASCBVSC+LGESLTCT;/* UPDATE THE VIO SLOT     01409000
*                                      COUNT BY THE SLOT COUNT     0459 01410000
*                                      RETURNED BY THE GROUP OPERATOR*/ 01411000
         LH    @12,ASCBVSC(,ASCBPTR)                               0459 01412000
         AH    @12,LGESLTCT(,LGEPTR)                               0459 01413000
         STH   @12,ASCBVSC(,ASCBPTR)                               0459 01414000
*                   RFY                                            0460 01415000
*                     R10 UNRSTD;                                  0460 01416000
*                   IF RTNCODE=CODE00 THEN                         0461 01417000
         L     @12,RTNCODE                                         0461 01418000
         LTR   @12,@12                                             0461 01419000
         BNZ   @RF00461                                            0461 01420000
*                     CALL FREELOCK;/* GOOD RETURN FROM SAVE OR    0462 01421000
*                                      ACTIVATE, FREE THE ASM CLASS     01422000
*                                      LOCK                          */ 01423000
         BAL   @14,FREELOCK                                        0462 01424000
*                   ELSE                                           0463 01425000
*                     DO;           /* ERROR RETURN FROM SAVE OR   0463 01426000
*                                      ACTIVATE                      */ 01427000
         B     @RC00461                                            0463 01428000
@RF00461 DS    0H                                                  0464 01429000
*                       IF ACEOP=ACEACT THEN                       0464 01430000
         CLI   ACEOP(ACEPTR),20                                    0464 01431000
         BNE   @RF00464                                            0464 01432000
*                         DO;       /* ACTIVATE ERROR                */ 01433000
*                           ACELGID=FOXES;/* INVALIDATE THE LGID FOR    01434000
*                                      VBP                           */ 01435000
         MVC   ACELGID(4,ACEPTR),@CF01677                          0466 01436000
*                           EPALGEP=ZERO;/* RRR-STOP TRACKING LGE TO    01437000
*                                      BE FREED-RRR                  */ 01438000
*                                                                  0467 01439000
         SLR   @12,@12                                             0467 01440000
         ST    @12,EPALGEP                                         0467 01441000
*                           /*****************************************/ 01442000
*                           /*                                       */ 01443000
*                           /* THE ADDR OF THE LGE TO BE FREED IS IN */ 01444000
*                           /* LGEPTR. FRELG WILL RELEASE THE ASM    */ 01445000
*                           /* CLASS LOCK.                           */ 01446000
*                           /*                                       */ 01447000
*                           /*****************************************/ 01448000
*                                                                  0468 01449000
*                           CALL FRELG;/* DEQUEUE AND FREE THE LGE,     01450000
*                                      MAKE LGVTE AVAILIABLE         */ 01451000
         BAL   @14,FRELG                                           0468 01452000
*                         END;      /* ACTIVATE ERROR                */ 01453000
*                       ELSE                                       0470 01454000
*                         DO;       /* SAVE ERROR                    */ 01455000
         B     @RC00464                                            0470 01456000
@RF00464 DS    0H                                                  0471 01457000
*                           LGEASPCT->ASPSSYM=''B;/* CLEAR 'S' SYMBOL   01458000
*                                      IN ASPCT                      */ 01459000
         L     @12,LGEASPCT(,LGEPTR)                               0471 01460000
         XC    ASPSSYM(8,@12),ASPSSYM(@12)                         0471 01461000
*                           ACESYM=''B;/* CLEAR 'S' SYMBOL IN ACE    */ 01462000
         XC    ACESYM(8,ACEPTR),ACESYM(ACEPTR)                     0472 01463000
*                           CALL FREELOCK;/* FREE THE ASM CLASS LOCK */ 01464000
         BAL   @14,FREELOCK                                        0473 01465000
*                         END;      /* END SAVE ERROR                */ 01466000
*                     END;          /* END ERROR RETURN FROM SAVE OR    01467000
*                                      ACTIVATE                      */ 01468000
*                                                                  0475 01469000
@RC00464 DS    0H                                                  0476 01470000
*                   /*************************************************/ 01471000
*                   /*                                               */ 01472000
*                   /* THE ACA IS IN USER'S STORAGE AND THUS MAY BE  */ 01473000
*                   /* PAGEABLE SO THE ACA CANNOT BE REFERENCED WHILE*/ 01474000
*                   /* HOLDING THE ASM CLASS LOCK                    */ 01475000
*                   /*                                               */ 01476000
*                   /*************************************************/ 01477000
*                                                                  0476 01478000
*                   IF ACEOP=ACEACT THEN                           0476 01479000
@RC00461 CLI   ACEOP(ACEPTR),20                                    0476 01480000
         BNE   @RF00476                                            0476 01481000
*                     ACALGN=ACELGN;/* ACTIVATE, MOVE THE LGN TO THE    01482000
*                                      ACA                           */ 01483000
         MVC   ACALGN(8,ACAPTR),ACELGN(ACEPTR)                     0477 01484000
*                   ELSE                                           0478 01485000
*                     ACASYM=ACESYM;/* SAVE, MOVE THE 'S' SYMBOL TO     01486000
*                                      THE ACA                       */ 01487000
         B     @RC00476                                            0478 01488000
@RF00476 MVC   ACASYM(8,ACAPTR),ACESYM(ACEPTR)                     0478 01489000
*                 END;              /* SAVE OR ACTIVATE BACKEND      */ 01490000
@RC00476 DS    0H                                                  0480 01491000
*                                                                  0480 01492000
*               /*****************************************************/ 01493000
*               /*                                                   */ 01494000
*               /* AT THIS POINT THE ACE IS FREED VIA THE ILRGMA     */ 01495000
*               /* MACRO. ALL REQUESTS FOR WHICH AN ACE WAS OBTAINED */ 01496000
*               /* COME HERE, EXCEPT A VALID RELEASE REQUEST FOR     */ 01497000
*               /* WHICH THE RELEASE GROUP OPERATOR WAS NOT CALLED OR*/ 01498000
*               /* FOR WHICH THE RELEASE GROUP OPERATOR WAS CALLED   */ 01499000
*               /* AND A RETURN CODE OF 28 WAS NOT RECEIVED.         */ 01500000
*               /*                                                   */ 01501000
*               /*****************************************************/ 01502000
*                                                                  0480 01503000
*               RFY                                                0480 01504000
*                 R1AREA RSTD;                                     0480 01505000
@RC00426 DS    0H                                                  0481 01506000
*FREEACE:                                                          0481 01507000
*               R1AREA=ACEPTR;      /* OBTAIN ADDR ACE TO BE FREED   */ 01508000
FREEACE  LR    R1AREA,ACEPTR                                       0481 01509000
*               EPAACE=ZERO;        /* RRR-CLEAR THE ACE ADDR TRACKED   01510000
*                                      IN EPATH-RRR                  */ 01511000
*                                                                  0482 01512000
         SLR   @12,@12                                             0482 01513000
         ST    @12,EPAACE                                          0482 01514000
*               /*****************************************************/ 01515000
*               /*                                                   */ 01516000
*               /* BEGIN ILRGMA MACRO EXPANSION                      */ 01517000
*               /*                                                   */ 01518000
*               /*****************************************************/ 01519000
*                                                                  0483 01520000
*               DO;                 /* ILRGMA FREE                 0483 01521000
*                                      CELL(ACE)WORKREGS(R11,R12)    */ 01522000
*                 RESPECIFY                                        0484 01523000
*                  (R0,                                            0484 01524000
*                   R1,                                            0484 01525000
*                   R11,                                           0484 01526000
*                   R12,                                           0484 01527000
*                   R14,                                           0484 01528000
*                   R15) RESTRICTED;                               0484 01529000
*                 RESPECIFY                                        0485 01530000
*                   ASMPOOLS BASED(R11);                           0485 01531000
*                 RESPECIFY                                        0486 01532000
*                   GMACELL BASED(R1);                             0486 01533000
*                 R11=ADDR(ASMACEPC);                              0487 01534000
         LA    R11,ASMACEPC(,ASMVTPTR)                             0487 01535000
*                 LM(R14,R15,ASMCPRSQ);/* GET CONTENTS OF Q          */ 01536000
         LM    R14,R15,ASMCPRSQ(R11)                               0488 01537000
*GMA00031:                                                         0489 01538000
*                 IF R14^=0 THEN    /* TEST RESERVE Q                */ 01539000
GMA00031 LTR   R14,R14                                             0489 01540000
         BZ    @RF00489                                            0489 01541000
*                   DO;             /* REPLENISH ACE RESERVE Q       */ 01542000
*                     R0=R14-1;     /* SET UP FOR COMPARE AND SWAP   */ 01543000
         LR    R0,R14                                              0491 01544000
         BCTR  R0,0                                                0491 01545000
*                     GMANEXT=R15;  /* CELL TO FREE IN R1            */ 01546000
         ST    R15,GMANEXT(,R1)                                    0492 01547000
*                     CDS(R14,R0,ASMCPRSQ);/* ADD CELL TO RESERVE Q  */ 01548000
         CDS   R14,R0,ASMCPRSQ(R11)                                0493 01549000
*                     BC(7,GMA00031);                              0494 01550000
         BC    7,GMA00031                                          0494 01551000
*                   END;                                           0495 01552000
*                 ELSE                                             0496 01553000
*                   DO;             /* RETURN ACE TO NORMAL Q        */ 01554000
         B     @RC00489                                            0496 01555000
@RF00489 DS    0H                                                  0497 01556000
*                     R14=ASMCPAVL;                                0497 01557000
         L     R14,ASMCPAVL(,R11)                                  0497 01558000
*GMA00032:                                                         0498 01559000
*                     GMANEXT=R14;  /* PUT ADDR CURRENT FIRST IN   0498 01560000
*                                      INPUT CELL                    */ 01561000
GMA00032 ST    R14,GMANEXT(,R1)                                    0498 01562000
*                     CS(R14,R1,ASMCPAVL);/* ADD INPUT CELL TO POOL  */ 01563000
         CS    R14,@01,ASMCPAVL(R11)                               0499 01564000
*                     BC(7,GMA00032);                              0500 01565000
         BC    7,GMA00032                                          0500 01566000
*                   END;            /* ACE RETURNED TO NORMAL Q      */ 01567000
*                 RESPECIFY                                        0502 01568000
*                  (R0,                                            0502 01569000
*                   R1,                                            0502 01570000
*                   R11,                                           0502 01571000
*                   R12,                                           0502 01572000
*                   R14,                                           0502 01573000
*                   R15) UNRESTRICTED;                             0502 01574000
@RC00489 DS    0H                                                  0503 01575000
*               END;                /* ILRGMA FREE                 0503 01576000
*                                      CELL(ACE)WORKREGS(R11,R12)    */ 01577000
*                                                                  0503 01578000
*               /*****************************************************/ 01579000
*               /*                                                   */ 01580000
*               /* END ILRGMA MACRO EXPANSION                        */ 01581000
*               /*                                                   */ 01582000
*               /*****************************************************/ 01583000
*                                                                  0504 01584000
*             END;                  /* SAVE OR ACTIVATE, OR RELEASE     01585000
*                                      CODE 28 REQUESTS              */ 01586000
*         END;                      /* ILRGMA GET SUCCESSFUL         */ 01587000
@RF00403 DS    0H                                                  0506 01588000
*     END;                          /* RELEASE, ACTIVATE, SAVE     0506 01589000
*                                      PROCESSING                    */ 01590000
@RC00189 DS    0H                                                  0507 01591000
*                                                                  0507 01592000
*   /*****************************************************************/ 01593000
*   /*                                                               */ 01594000
*   /* ALL PROCESSING FOR WHICH A WORK-SAVE AREA WAS OBTAINED COMES  */ 01595000
*   /* HERE, EXCEPT FOR AN ESTAE ERROR IN WHICH CASE THE WORK-SAVE   */ 01596000
*   /* AREA HAS ALREADY BEEN DELETED.                                */ 01597000
*   /*                                                               */ 01598000
*   /*****************************************************************/ 01599000
*                                                                  0507 01600000
*   RFY                                                            0507 01601000
*     R13 RSTD;                                                    0507 01602000
@RC00124 DS    0H                                                  0508 01603000
*FREEWK:                                                           0508 01604000
*   GEN SETS(R11,R13);                                             0508 01605000
FREEWK   DS    0H                                                  0508 01606000
*                          /* RESTORE THE CALLERS SAVE AREA ADDR */     01607000
       LA    R11,SAVAREA        ADDR SAVE AREA                          01608000
       L     R13,4(R11)         RESTORE ADDR CALLERS SAVE AREA          01609000
       MVC   16(4,R13),RTNCODE  SET RETURN CODE IN CALLERS SAVE AREA    01610000
*   IF ACAOP=ASSIGN|ACAOP=ACERELLG THEN                            0509 01611000
         CLI   ACAOP(ACAPTR),8                                     0509 01612000
         BE    @RT00509                                            0509 01613000
         CLI   ACAOP(ACAPTR),12                                    0509 01614000
         BNE   @RF00509                                            0509 01615000
@RT00509 DS    0H                                                  0510 01616000
*     DO;                           /* DELETE RECOVERY AND FREE    0510 01617000
*                                      WORK-SAVE AREA FOR LOCKED   0510 01618000
*                                      PATHS                         */ 01619000
*       GEN REFS(R11,R12);                                         0511 01620000
     SETFRR D,WRKREGS=(R11,R12),RELATED=(SETFRR,ILRGOS)                 01621000
*       R1AREA=WKSAV@;              /* OBTAIN ADDR WORK AREA TO BE 0512 01622000
*                                      FREED                         */ 01623000
*                                                                  0512 01624000
         LR    R1AREA,WKSAV@                                       0512 01625000
*       /*************************************************************/ 01626000
*       /*                                                           */ 01627000
*       /* BEGIN ILRGMA MACRO EXPANSION                              */ 01628000
*       /*                                                           */ 01629000
*       /*************************************************************/ 01630000
*                                                                  0513 01631000
*       DO;                         /* ILRGMA FREE                 0513 01632000
*                                      CELL(BWK)WORKREGS(R11,R12)    */ 01633000
*         RESPECIFY                                                0514 01634000
*          (R0,                                                    0514 01635000
*           R1,                                                    0514 01636000
*           R11,                                                   0514 01637000
*           R12,                                                   0514 01638000
*           R14,                                                   0514 01639000
*           R15) RESTRICTED;                                       0514 01640000
*         RESPECIFY                                                0515 01641000
*           ASMPOOLS BASED(R11);                                   0515 01642000
*         RESPECIFY                                                0516 01643000
*           GMACELL BASED(R1);                                     0516 01644000
*         R11=ADDR(ASMBWKPC);                                      0517 01645000
         LA    R11,ASMBWKPC(,ASMVTPTR)                             0517 01646000
*         R14=ASMCPAVL;                                            0518 01647000
         L     R14,ASMCPAVL(,R11)                                  0518 01648000
*GMA00042:                                                         0519 01649000
*         GMANEXT=R14;              /* PUT ADDR CURRENT FIRST IN   0519 01650000
*                                      INPUT CELL                    */ 01651000
GMA00042 ST    R14,GMANEXT(,R1)                                    0519 01652000
*         CS(R14,R1,ASMCPAVL);      /* ADD INPUT CELL TO POOL        */ 01653000
         CS    R14,@01,ASMCPAVL(R11)                               0520 01654000
*         BC(7,GMA00042);                                          0521 01655000
         BC    7,GMA00042                                          0521 01656000
*         RESPECIFY                                                0522 01657000
*          (R0,                                                    0522 01658000
*           R1,                                                    0522 01659000
*           R11,                                                   0522 01660000
*           R12,                                                   0522 01661000
*           R14,                                                   0522 01662000
*           R15) UNRESTRICTED;                                     0522 01663000
*       END;                        /* ILRGMA FREE                 0523 01664000
*                                      CELL(BWK)WORKREGS(R11,R12)    */ 01665000
*                                                                  0523 01666000
*       /*************************************************************/ 01667000
*       /*                                                           */ 01668000
*       /* END ILRGMA MACRO EXPANSION                                */ 01669000
*       /*                                                           */ 01670000
*       /*************************************************************/ 01671000
*                                                                  0524 01672000
*     END;                          /* END LOCKED PATHS EXITING      */ 01673000
*   ELSE                                                           0525 01674000
*     DO;                           /* DELETE REOCVERY AND FREE    0525 01675000
*                                      WORK-SAVE AREA FOR UNLOCKED 0525 01676000
*                                      PATHS                         */ 01677000
         B     @RC00509                                            0525 01678000
@RF00509 DS    0H                                                  0526 01679000
*       RFY                                                        0526 01680000
*         R11 RSTD;                                                0526 01681000
*       R11=LENGTH(WKAREA);         /* OBTAIN LENGTH AREA TO BE FREED*/ 01682000
         LA    R11,256                                             0527 01683000
*       GEN REFS(R11,WKSAV@) SETS(R1);                             0528 01684000
*                              /* CANCEL ESTAE AND FREE WORK AREA */    01685000
         ESTAE 0        CANCEL ESTAE                                    01686000
         FREEMAIN  RC,LV=(R11),A=(WKSAV@),SP=245                        01687000
*     END;                          /* END UNLOCKED PATHS EXITING    */ 01688000
*GOSEND:                                                           0530 01689000
*   RETURN;                         /* RESTORE REGS AND RETURN TO  0530 01690000
*                                      CALLER                        */ 01691000
@EL00001 DS    0H                                                  0530 01692000
@EF00001 DS    0H                                                  0530 01693000
@ER00001 LM    @14,@12,12(@13)                                     0530 01694000
         BR    @14                                                 0530 01695000
*                                                                  0531 01696000
*   /*****************************************************************/ 01697000
*   /*                                                               */ 01698000
*   /* GETLOCK WILL OBTAIN THE ASM CLASS LOCK UNCONDITIONALLY.       */ 01699000
*   /* REGISTERS R2-R4 ARE STANDARD AS UNDER MAPPING MACRO POINTERS. */ 01700000
*   /* R14 CONTAINS THE RETURN ADDR.                                 */ 01701000
*   /*                                                               */ 01702000
*   /*****************************************************************/ 01703000
*                                                                  0531 01704000
*GETLOCK:                                                          0531 01705000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0531 01706000
GETLOCK  DS    0H                                                  0532 01707000
*   RFY                                                            0532 01708000
*    (R11,                                                         0532 01709000
*     R10,                                                         0532 01710000
*     R14) RSTD;                                                   0532 01711000
*   R10=R14;                        /* MAINTAIN RETURN ADDR          */ 01712000
         LR    R10,R14                                             0533 01713000
*   R11=ADDR(ASHLOCK);              /* OBTAIN ADDR ASM LOCKWORD      */ 01714000
         LA    R11,ASHLOCK(,RSMHDPTR)                              0534 01715000
*   GEN REFS(R11);                                                 0535 01716000
GETASM1  SETLOCK OBTAIN,TYPE=ASM,ADDR=(11),MODE=UNCOND,               **01717000
               RELATED=(VIO,ILRGOS(FREASM1))                            01718000
*   R14=R10;                        /* RESTORE RETURN ADDR           */ 01719000
         LR    R14,R10                                             0536 01720000
*   RFY                                                            0537 01721000
*    (R11,                                                         0537 01722000
*     R10) UNRSTD;                                                 0537 01723000
*   END GETLOCK;                                                   0538 01724000
@EL00002 DS    0H                                                  0538 01725000
@EF00002 DS    0H                                                  0538 01726000
@ER00002 BR    @14                                                 0538 01727000
*                                                                  0539 01728000
*   /*****************************************************************/ 01729000
*   /*                                                               */ 01730000
*   /* FREELOCK WILL FREE THE ASM CLASS LOCK. REGISTERS R2-R4 ARE    */ 01731000
*   /* STANDARD AS UNDER MAPPING MACRO POINTERS. R14 CONTAINS THE    */ 01732000
*   /* RETURN ADDR.                                                  */ 01733000
*   /*                                                               */ 01734000
*   /*****************************************************************/ 01735000
*                                                                  0539 01736000
*FREELOCK:                                                         0539 01737000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0539 01738000
FREELOCK DS    0H                                                  0540 01739000
*   RFY                                                            0540 01740000
*    (R11,                                                         0540 01741000
*     R10,                                                         0540 01742000
*     R14) RSTD;                                                   0540 01743000
*   R10=R14;                        /* MAINTAIN RETURN ADDR          */ 01744000
         LR    R10,R14                                             0541 01745000
*   R11=ADDR(ASHLOCK);              /* OBTAIN ADDR ASM LOCKWORD      */ 01746000
         LA    R11,ASHLOCK(,RSMHDPTR)                              0542 01747000
*   GEN REFS(R11);                                                 0543 01748000
FREASM1  SETLOCK RELEASE,TYPE=ASM,ADDR=(11),                          **01749000
               RELATED=(VIO,ILRGOS(GETASM1))                            01750000
*   R14=R10;                        /* RESTORE RETURN ADDR           */ 01751000
         LR    R14,R10                                             0544 01752000
*   RFY                                                            0545 01753000
*    (R11,                                                         0545 01754000
*     R10) UNRSTD;                                                 0545 01755000
*   END FREELOCK;                                                  0546 01756000
@EL00003 DS    0H                                                  0546 01757000
@EF00003 DS    0H                                                  0546 01758000
@ER00003 BR    @14                                                 0546 01759000
*ASSIGNLG:                                                         0547 01760000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0547 01761000
*                                                                  0547 01762000
ASSIGNLG DS    0H                                                  0548 01763000
*/********************************************************************/ 01764000
*/*                                                                  */ 01765000
*/* THE ASSIGNLG ROUTINE WILL OBTAIN STORAGE FOR AND BUILD AN LGE    */ 01766000
*/* AND ASSIGN AN LGID. IT WILL ALSO OBTAIN STORAGE FOR AND BUILD A  */ 01767000
*/* LGVT IF NEEDED AND AN ASPCT IF REQUESTED. ALSO IF AN SRB DOES    */ 01768000
*/* NOT EXIST FOR THIS ADDRESS SPACE, IT WILL BUILD ONE.             */ 01769000
*/*                                                                  */ 01770000
*/* INPUT: R2 THRU R4 STANDARD, REQASPCT TO INDICATE WHETHER AN ASPCT*/ 01771000
*/*        SHOULD BE BUILT OR NOT.                                   */ 01772000
*/*                                                                  */ 01773000
*/* OUTPUT: THE PROPER CONTROL BLOCKS ARE BUILT AND INITIALIZED AS   */ 01774000
*/*         DESCRIBED ABOVE. THE LGID ASSIGNED IS PLACED IN THE      */ 01775000
*/*         LGELGID AND THE LGE IS RETURNED TO THE MAINLINE OF GOS.  */ 01776000
*/*                                                                  */ 01777000
*/********************************************************************/ 01778000
*/********************************************************************/ 01779000
*/*ASSIGNLG: CHART (AREF)                                            */ 01780000
*/*        HEADER                                                  0548 01781000
*/*        ILRGOS                                                  0548 01782000
*/* ASSIGNLG - ASSIGN LGN, BUILD LGE ROUTINE                         */ 01783000
*/*ASSIGNLG: E ENTRY                                                 */ 01784000
*/*        P SAVE RETURN ADDRESS                                     */ 01785000
*/*        P MAINTAIN ASMVT PTR AND ASM HDR PTR                      */ 01786000
*/*        L SETLOCK:   UNCONDITIONAL OBTAIN SALLOC LOCK             */ 01787000
*/*        P INITIALIZE GETMAIN SIZE TO THE LGE LENGTH               */ 01788000
*/*        D (N,,Y,%GOS62) ANY AVAILIABLE LGVT ENTRIES               */ 01789000
*/*        P INCR GET MAIN SIZE BY LGVSIZE + EXPANSION INCR          */ 01790000
*/*%GOS62: D (N,,Y,%GOS63) SRB EXISTS (ASHSRBP)                      */ 01791000
*/*        P INCREMENT GETMAIN SIZE BY SRB LENGTH                    */ 01792000
*/*%GOS63: P INITIALIZE REGS FOR GETMAIN                             */ 01793000
*/*        L GETMAIN: OBTAIN SQA SPACE FOR LGE, SRB AND LGVT         */ 01794000
*/*        D (N,,Y,%GOS65) RETURN CODE = 0                           */ 01795000
*/*        P (,%GOS73) SAVE RETURN CODE                              */ 01796000
*/*%GOS65: P CHECKPOINT CONTROL BLOCKS IN EPATH                      */ 01797000
*/*        P SAVE ADDR SPACE OBTAINED IN SQALEFT                     */ 01798000
*/*        P ZERO SQA SPACE                                          */ 01799000
*/*        D (Y,,N,%GOS67) ASPCT REQUIRED (REQASPCT)                 */ 01800000
*/*        P INITIALIZE REGS FOR GETMAIN                             */ 01801000
*/*        L GETMAIN: OBTAIN LSQA SPACE FOR ASPCT                    */ 01802000
*/*        D (N,,Y,%GOS66) RETURN CODE = 0                           */ 01803000
*/*        P SAVE RETURN CODE                                        */ 01804000
*/*        P INITIALIZE REGS FOR FREEMAIN                            */ 01805000
*/*        L (,%GOS73) FREEMAIN: FREE SQA SPACE OBTAINED EARLIER     */ 01806000
*/*%GOS66: P ZERO LSQA SPACE                                         */ 01807000
*/*        P ASPCT PTR = ADDR LSQA SPACE                             */ 01808000
*/*%GOS67: D (Y,,N,%GOS70) LGVT TO BE EXPANDED (LGVLGVEP)            */ 01809000
*/*        P MOVE LGVT INTO SQA SPACE OBTAINED                       */ 01810000
*/*        P FIRST AVAILABLE LGVTE (LGVLGVEP) = LGVT ADDR + LGVSIZE  */ 01811000
*/*        P LGVTE ADDR = FIRST AVAILABLE LGVTE                      */ 01812000
*/*        P LGVTE LGID (LGVELGID) = MAX LGN (LGVMAXLG) + 1          */ 01813000
*/*%GOS68: D (Y,,N,%GOS69) LGID < NUMBER LGVTES IN EXPANDED LGVT     */ 01814000
*/*        P LGVENEXT = LGVTE ADDR + LGVTE LENGTH                    */ 01815000
*/*        P INCR LGVELGID IN LGVENEXT                               */ 01816000
*/*        P (,%GOS68) LGVTE ADDR = LGVENEXT                         */ 01817000
*/*%GOS69: P LGVENEXT = 0, INDICATES LAST LGVTE                      */ 01818000
*/*        P INCR MAX LGN (LGVMAXLG) BY NUMBER LGVTES IN AN EXPANSION*/ 01819000
*/*        P INCR LGVT SIZE (LGVSIZE) BY EXPANSION SIZE              */ 01820000
*/*        P LGVT ADDR (ASMLGVTP) = ADDR SQA GETMAINED               */ 01821000
*/*        P INITIALIZE REGS. FOR FREEMAIN                           */ 01822000
*/*        P ZERO LGVT PTR, E PATH, IN ATA                           */ 01823000
*/*        L FREEMAIN: FREE OLD LGVT                                 */ 01824000
*/*        P INCR SQALEFT BY LGVT SIZE (LGVSIZE)                     */ 01825000
*/*%GOS70: P SET LGVTE ADDR = FIRST AVAILABLE LGVTE (LGVLGVEP)       */ 01826000
*/*        P FIRST AVAILABLE LGVTE = NEXT LGVTE (LGVNEXT)            */ 01827000
*/*        D (N,,Y,%GOS71) SRB EXISTS (ASHSRBP)                      */ 01828000
*/*        P SRBPTR = SQALEFT + LENGTH OF THE LGE                    */ 01829000
*/*        P INITIALIZE SRB FIELDS: ASCB, ASID, EP, ID, RTMR         */ 01830000
*/*        P ADDR SRB (ASHVSRBP) = SRBPTR                            */ 01831000
*/*%GOS71: D (Y,,N,%GOS72) ASPCT REQUIRED (REQASPCT)                 */ 01832000
*/*        P INITIALIZE ASPCT FIELDS: IDENT, LGID, LGE, ASCB         */ 01833000
*/*        P LGEASPCT = ASPCT PTR                                    */ 01834000
*/*%GOS72: L SETLOCK: UNCONDITIONAL OBTAIN ASM LOCK                  */ 01835000
*/*        P LGEPTR = SQALEFT                                        */ 01836000
*/*        P LGELGID = LGVELGID                                      */ 01837000
*/*        P LGVTE LGE PTR (LGVELGEP) = LGE PTR                      */ 01838000
*/*        P LGVEASCB = CURRENT ASCB                                 */ 01839000
*/*        N Q THE LGE TO THE ASMHD LGE Q                            */ 01840000
*/*        P LGENEXT = ASHLGEQ                                       */ 01841000
*/*        P ASHLGEQ = ADDR LGE OBTAINED                             */ 01842000
*/*        L SETLOCK: RELEASE THE ASM CLASS LOCK                     */ 01843000
*/*%GOS73: L SETLOCK: RELEASE THE SALLOC LOCK                        */ 01844000
*/*        R RETURN                                                  */ 01845000
*/*ASSIGNLG: END                                                     */ 01846000
*/********************************************************************/ 01847000
*                                                                  0548 01848000
*                                                                  0548 01849000
*   /*****************************************************************/ 01850000
*   /*                                                               */ 01851000
*   /* THE SALLOC LOCK IS OBTAINED, SQA CONTROL BLOCKS NEEDED ARE    */ 01852000
*   /* DETERMINED, THE GETMAIN SIZE IS SET ACCORDINGLY, AND THE      */ 01853000
*   /* STORAGE OBTAINED                                              */ 01854000
*   /*                                                               */ 01855000
*   /*****************************************************************/ 01856000
*                                                                  0548 01857000
*   RFY                                                            0548 01858000
*     R14 RSTD;                                                    0548 01859000
*   RTNADDR=R14;                    /* MAINTAIN THE RETURN ADDR      */ 01860000
         ST    R14,RTNADDR                                         0549 01861000
*   RFY                                                            0550 01862000
*     R14 UNRSTD;                                                  0550 01863000
*   GEN;                                                           0551 01864000
*    /* OBTAIN THE SALLOC LOCK */                                       01865000
GETSAL1   SETLOCK  OBTAIN,TYPE=SALLOC,MODE=UNCOND,                    **01866000
               RELATED=(VIO,ILRGOS(FRESAL1))                            01867000
*   RFY                                                            0552 01868000
*     GETSIZE RSTD;                                                0552 01869000
*   GETSIZE=LENGTH(LGE);            /* INITIALIZED TO LGE LENGTH     */ 01870000
         LA    GETSIZE,24                                          0553 01871000
*   RFY                                                            0554 01872000
*     LGVTPTR RSTD;                                                0554 01873000
*   LGVTPTR=ASMLGVT;                /* OBTAIN ADDR OF THE LGVT       */ 01874000
         L     LGVTPTR,ASMLGVT(,ASMVTPTR)                          0555 01875000
*   IF LGVLGVEP=ZERO THEN                                          0556 01876000
         L     @10,LGVLGVEP(,LGVTPTR)                              0556 01877000
         LTR   @10,@10                                             0556 01878000
         BNZ   @RF00556                                            0556 01879000
*     GETSIZE=GETSIZE+LGVSIZE+EXPSIZE;/* IF NO AVAILABLE LGVTES INCR    01880000
*                                      SIZE BY CURRENT LGVT SIZE AND    01881000
*                                      EXPANSION INCREMENT           */ 01882000
         LR    @10,GETSIZE                                         0557 01883000
         AL    @10,LGVSIZE(,LGVTPTR)                               0557 01884000
         AL    @10,@CF01282                                        0557 01885000
         LR    GETSIZE,@10                                         0557 01886000
*   IF ASHVSRBP=ZERO THEN                                          0558 01887000
@RF00556 L     @10,ASHVSRBP(,RSMHDPTR)                             0558 01888000
         LTR   @10,@10                                             0558 01889000
         BNZ   @RF00558                                            0558 01890000
*     GETSIZE=GETSIZE+LENGTH(SRB);  /* INCR SIZE BY THE SRB SIZE, NO    01891000
*                                      SRB FOR THIS ADDRESS SPACE    */ 01892000
         AL    GETSIZE,@CF01405                                    0559 01893000
*   R4SAVE=R4;                      /* STORE R4, DESTROYED IN GETMAIN*/ 01894000
@RF00558 ST    R4,R4SAVE                                           0560 01895000
*   RFY                                                            0561 01896000
*    (R15,                                                         0561 01897000
*     R1AREA) RSTD;                                                0561 01898000
*   GEN REFS(GETSIZE,R3,R4) SETS(R1AREA,R15);                      0562 01899000
*                                         /* OBTAIN SPACE FOR           01900000
*      LGE AND/OR SRB, LGVT */                                          01901000
       GETMAIN  RC,LV=(GETSIZE),SP=245,BRANCH=(YES,GLOBAL)              01902000
*   ASMVTPTR=CVTASMVT;              /* RESTORE R3, DESTROYED IN    0563 01903000
*                                      GETMAIN                       */ 01904000
         L     @14,CVTPTR                                          0563 01905000
         L     ASMVTPTR,CVTASMVT(,@14)                             0563 01906000
*   R4=R4SAVE;                      /* RESTORE R4, DESTROYED IN    0564 01907000
*                                      GETMAIN                       */ 01908000
         L     R4,R4SAVE                                           0564 01909000
*   IF R15^=ZERO THEN                                              0565 01910000
         LTR   R15,R15                                             0565 01911000
         BZ    @RF00565                                            0565 01912000
*     DO;                           /* GETMAIN UNSUCCESSFUL, RETURN     01913000
*                                      TO CALLER                     */ 01914000
*       RTNCODE=CODE28;             /* INDICATE NOT ENOUGH STORAGE   */ 01915000
         MVC   RTNCODE(4),@CF00438                                 0567 01916000
*       RFY                                                        0568 01917000
*         R15 UNRSTD;                                              0568 01918000
*     END;                          /* UNSUCCESSFUL SQA GETMAIN      */ 01919000
*                                                                  0570 01920000
*   /*****************************************************************/ 01921000
*   /*                                                               */ 01922000
*   /* GETMAIN SUCCESSFUL, CLEAR THE STORAGE OBTAINED, DETERMINE IF  */ 01923000
*   /* AN ASPCT NEEDED AND OBTAIN AND CLEAR ITS STORAGE IF NECESSARY.*/ 01924000
*   /* ALSO CHEKPOINT CONTROL BLOCKS AND THEIR LENGTHS IN THE EPATH  */ 01925000
*   /* IF NEEDED.                                                    */ 01926000
*   /*                                                               */ 01927000
*   /*****************************************************************/ 01928000
*                                                                  0570 01929000
*   ELSE                                                           0570 01930000
*     DO;                           /* SQA GETMAIN SUCCESSFUL        */ 01931000
         B     @RC00565                                            0570 01932000
@RF00565 DS    0H                                                  0571 01933000
*       IF LGVLGVEP=ZERO THEN                                      0571 01934000
         L     @10,LGVLGVEP(,LGVTPTR)                              0571 01935000
         LTR   @10,@10                                             0571 01936000
         BNZ   @RF00571                                            0571 01937000
*         DO;                       /* CHECKPOINT NEW LGVT, ITS SIZE    01938000
*                                      AND THE LGE IN EPATH          */ 01939000
*           EPALGVTP=R1AREA;        /* RRR-CHECKPOINT LGVT-RRR       */ 01940000
         ST    R1AREA,EPALGVTP                                     0573 01941000
*           EPALSIZE=LGVSIZE+EXPSIZE;/* RRR-CHECKPOINT LGVT SIZE-RRR */ 01942000
         LA    @10,512                                             0574 01943000
         AL    @10,LGVSIZE(,LGVTPTR)                               0574 01944000
         STH   @10,EPALSIZE                                        0574 01945000
*           EPALGEP=R1AREA+EPALSIZE;/* RRR-CHECKPOINT LGE-RRR        */ 01946000
         ALR   @10,R1AREA                                          0575 01947000
         ST    @10,EPALGEP                                         0575 01948000
*         END;                                                     0576 01949000
*       ELSE                                                       0577 01950000
*         EPALGEP=R1AREA;           /* RRR-CHECKPOINT LGE, NO LGVT 0577 01951000
*                                      NEEDED-RRR                    */ 01952000
         B     @RC00571                                            0577 01953000
@RF00571 ST    R1AREA,EPALGEP                                      0577 01954000
*       IF ASHVSRBP=ZERO THEN                                      0578 01955000
@RC00571 L     @10,ASHVSRBP(,RSMHDPTR)                             0578 01956000
         LTR   @10,@10                                             0578 01957000
         BNZ   @RF00578                                            0578 01958000
*         EPASRB=EPALGEP+LENGTH(LGE);/* RRR-CHECK POINT THE SRB ADDR    01959000
*                                      IN THE EPATH-RRR              */ 01960000
         LA    @10,24                                              0579 01961000
         AL    @10,EPALGEP                                         0579 01962000
         ST    @10,EPASRB                                          0579 01963000
*       SQALEFT=R1AREA;             /* SAVE ADDR OF SQA SPACE      0580 01964000
*                                      OBTAINED                      */ 01965000
*                                                                  0580 01966000
@RF00578 ST    R1AREA,SQALEFT                                      0580 01967000
*       /*************************************************************/ 01968000
*       /*                                                           */ 01969000
*       /* CLEAR THE SQA SPACE OBTAINED                              */ 01970000
*       /*                                                           */ 01971000
*       /*************************************************************/ 01972000
*                                                                  0581 01973000
*       RFY                                                        0581 01974000
*        (R0,                                                      0581 01975000
*         R14,                                                     0581 01976000
*         R15) RSTD;                                               0581 01977000
*       R0=R1AREA;                  /* ADDR AREA TO BE CLEARED       */ 01978000
         LR    R0,R1AREA                                           0582 01979000
*       R1=GETSIZE;                 /* LENGTH AREA TO BE CLEARED     */ 01980000
         LR    R1,GETSIZE                                          0583 01981000
*       R15=ZERO;                   /* ZERO PADDING CHARACTER AND  0584 01982000
*                                      FROM LENGTH                   */ 01983000
         SLR   R15,R15                                             0584 01984000
*       MVCL(R0,R14);               /* CLEAR THE SQA SPACE OBTAINED  */ 01985000
         MVCL  R0,R14                                              0585 01986000
*       RFY                                                        0586 01987000
*        (R14,                                                     0586 01988000
*         R0) UNRSTD;                                              0586 01989000
*                                                                  0587 01990000
*       /*************************************************************/ 01991000
*       /*                                                           */ 01992000
*       /* AN ASPCT WAS REQUESTED OBTAIN AND CLEAR LSQA STORAGE FOR  */ 01993000
*       /* IT                                                        */ 01994000
*       /*                                                           */ 01995000
*       /*************************************************************/ 01996000
*                                                                  0587 01997000
*       IF REQASPCT=ON THEN                                        0587 01998000
         TM    REQASPCT,B'10000000'                                0587 01999000
         BNO   @RF00587                                            0587 02000000
*         DO;                       /* STORAGE FOR AN ASPCT IS NEEDED*/ 02001000
*           RFY                                                    0589 02002000
*             R10 RSTD;                                            0589 02003000
*           R10=LENGTH(ASPCT);      /* OBTAIN THE LENGTH FOR GETMAIN */ 02004000
         LA    R10,1088                                            0590 02005000
*           R4SAVE=R4;              /* STORE R4, USED IN GETMAIN     */ 02006000
         ST    R4,R4SAVE                                           0591 02007000
*           R7SAVE=R7;              /* STORE R7, USED IN GETMAIN     */ 02008000
         ST    R7,R7SAVE                                           0592 02009000
*           R4=PSATOLD;             /* LOAD TCB ADDR                 */ 02010000
         L     R4,PSATOLD                                          0593 02011000
*           R7=PSAAOLD;             /* LOAD ASCB ADDR                */ 02012000
         L     R7,PSAAOLD                                          0594 02013000
*           GEN REFS(R10,R4,R7) SETS(R1AREA,R15,R3);               0595 02014000
*                                         /* OBTAIN SPACE FOR ASPCT */  02015000
    GETMAIN RC,LV=(R10),SP=255,BRANCH=YES     GET LSQA SPACE            02016000
*           ASMVTPTR=CVTASMVT;      /* RESTORE R3, DESTROYED IN    0596 02017000
*                                      GETMAIN                       */ 02018000
         L     @14,CVTPTR                                          0596 02019000
         L     ASMVTPTR,CVTASMVT(,@14)                             0596 02020000
*           R4=R4SAVE;              /* RESTORE R4, DESTROYED IN    0597 02021000
*                                      GETMAIN                       */ 02022000
         L     R4,R4SAVE                                           0597 02023000
*           R7=R7SAVE;              /* RESTORE R7, DESTROYED IN    0598 02024000
*                                      GETMAIN                       */ 02025000
         L     R7,R7SAVE                                           0598 02026000
*           IF R15^=ZERO THEN                                      0599 02027000
         SLR   @14,@14                                             0599 02028000
         CR    R15,@14                                             0599 02029000
         BE    @RF00599                                            0599 02030000
*             DO;                   /* GETMAIN UNSUCCESSFUL, FREE SQA   02031000
*                                      AND RETURN                    */ 02032000
*               RTNCODE=CODE28;     /* INDICATE NOT ENOUGH STORAGE   */ 02033000
         MVC   RTNCODE(4),@CF00438                                 0601 02034000
*               R1AREA=SQALEFT;     /* ADDRESS AREA TO BE FREED      */ 02035000
         L     R1AREA,SQALEFT                                      0602 02036000
*               R4SAVE=R4;          /* STORE R4, DESTROYED IN      0603 02037000
*                                      FREEMAIN                      */ 02038000
         ST    R4,R4SAVE                                           0603 02039000
*               EPASRB=ZERO;        /* RRR-STOP TRACKING SRB ADDR IN    02040000
*                                      EPATH-RRR                     */ 02041000
         ST    @14,EPASRB                                          0604 02042000
*               EPALGVTP=ZERO;      /* RRR-CLEAR LGVT ADDR IN      0605 02043000
*                                      EPATH-RRR                     */ 02044000
         ST    @14,EPALGVTP                                        0605 02045000
*               EPALSIZE=ZERO;      /* RRR-CLEAR LGVT SIZE IN      0606 02046000
*                                      EPATH-RRR                     */ 02047000
         STH   @14,EPALSIZE                                        0606 02048000
*               EPALGEP=ZERO;       /* RRR-CLEAR LGE ADDR IN       0607 02049000
*                                      EPATH-RRR                     */ 02050000
         ST    @14,EPALGEP                                         0607 02051000
*               GEN REFS(GETSIZE,R1AREA);                          0608 02052000
*                         /* FREE SQA OBTAINED EARLIER */               02053000
       FREEMAIN  RC,LV=(GETSIZE),SP=245,A=(R1AREA),BRANCH=(YES,GLOBAL)  02054000
*               RFY                                                0609 02055000
*                 GETSIZE UNRSTD;                                  0609 02056000
*               ASMVTPTR=CVTASMVT;  /* RESTORE R3, DESTROYED IN    0610 02057000
*                                      FREEMAIN                      */ 02058000
         L     @14,CVTPTR                                          0610 02059000
         L     ASMVTPTR,CVTASMVT(,@14)                             0610 02060000
*               R4=R4SAVE;          /* RESTORE R4, DESTROYED IN    0611 02061000
*                                      FREEMAIN                      */ 02062000
         L     R4,R4SAVE                                           0611 02063000
*             END;                  /* LSQA GETMAIN UNSUCCESSFUL     */ 02064000
*           ELSE                                                   0613 02065000
*             DO;                   /* LSQA GETMAIN SUCCESSFUL       */ 02066000
         B     @RC00599                                            0613 02067000
@RF00599 DS    0H                                                  0614 02068000
*               EPARBASP=R1AREA;    /* RRR-TRACK ASPCT IN EPATH-RRR  */ 02069000
         ST    R1AREA,EPARBASP                                     0614 02070000
*               EPARSIZE=LENGTH(ASPCT);/* RRR-TRACK ASPCT SIZE IN  0615 02071000
*                                      EPATH-RRR                     */ 02072000
         MVC   EPARSIZE(2),@CH01810                                0615 02073000
*               SAVASPCT=R1AREA;    /* SAVE ADDR ASPCT TO BE BUILT   */ 02074000
         ST    R1AREA,SAVASPCT                                     0616 02075000
*               RFY                                                0617 02076000
*                (R0,                                              0617 02077000
*                 R14) RSTD;                                       0617 02078000
*               R0=R1AREA;          /* ADDR AREA TO BE CLEARED       */ 02079000
         LR    R0,R1AREA                                           0618 02080000
*               R1=R10;             /* LENGTH AREA TO BE CLEARED     */ 02081000
         LR    R1,R10                                              0619 02082000
*               R15=ZERO;           /* ZERO PADDING CHARACTER AND  0620 02083000
*                                      FROM LENGTH                   */ 02084000
         SLR   R15,R15                                             0620 02085000
*               MVCL(R0,R14);       /* CLEAR THE LSQA OBTAINED       */ 02086000
         MVCL  R0,R14                                              0621 02087000
*               RFY                                                0622 02088000
*                (R0,                                              0622 02089000
*                 R1,                                              0622 02090000
*                 R14,                                             0622 02091000
*                 R15) UNRSTD;                                     0622 02092000
*             END;                  /* LSQA GETMAIN SUCCESSFUL       */ 02093000
*         END;                      /* ASPCT NEEDED                  */ 02094000
@RC00599 DS    0H                                                  0625 02095000
*     END;                          /* SQA GETMAIN SUCCESSFUL        */ 02096000
@RF00587 DS    0H                                                  0626 02097000
*                                                                  0626 02098000
*   /*****************************************************************/ 02099000
*   /*                                                               */ 02100000
*   /* IF GETMAIN(S) ARE SUCCESSFUL PROCESSING COMES HERE WHERE THE  */ 02101000
*   /* LGVT IS EXPANDED IF NECESSARY AND A LGVTE OBTAINED            */ 02102000
*   /*                                                               */ 02103000
*   /*****************************************************************/ 02104000
*                                                                  0626 02105000
*   IF RTNCODE=ZERO THEN                                           0626 02106000
@RC00565 SLR   @12,@12                                             0626 02107000
         C     @12,RTNCODE                                         0626 02108000
         BNE   @RF00626                                            0626 02109000
*     DO;                           /* NO GETMAIN ERRORS             */ 02110000
*       IF LGVLGVEP=ZERO THEN                                      0628 02111000
         C     @12,LGVLGVEP(,LGVTPTR)                              0628 02112000
         BNE   @RF00628                                            0628 02113000
*         DO;                       /* EXPAND THE LGVT               */ 02114000
*           RFY                                                    0630 02115000
*            (R0,                                                  0630 02116000
*             R1,                                                  0630 02117000
*             R14,                                                 0630 02118000
*             R15) RSTD;                                           0630 02119000
*           R0=SQALEFT;             /* MOVE TO ADDR                  */ 02120000
         L     R0,SQALEFT                                          0631 02121000
*           R1=LGVSIZE;             /* MOVE TO LENGTH                */ 02122000
         L     @12,LGVSIZE(,LGVTPTR)                               0632 02123000
         LR    R1,@12                                              0632 02124000
*           R14=LGVTPTR;            /* MOVE FROM ADDR                */ 02125000
         LR    R14,LGVTPTR                                         0633 02126000
*           R15=LGVSIZE;            /* MOVE FROM LENGTH              */ 02127000
         LR    R15,@12                                             0634 02128000
*           MVCL(R0,R14);           /* MOVE THE LGVT TO NEW AREA   0635 02129000
*                                      GETMAINED                     */ 02130000
         MVCL  R0,R14                                              0635 02131000
*           RFY                                                    0636 02132000
*            (R0,                                                  0636 02133000
*             R1,                                                  0636 02134000
*             R14,                                                 0636 02135000
*             R15) UNRSTD;                                         0636 02136000
*           LGVTPTR=SQALEFT;        /* ADDR NEW LGVT                 */ 02137000
         L     LGVTPTR,SQALEFT                                     0637 02138000
*           LGVLGVEP=LGVTPTR+LGVSIZE;/* SET FIRST AVAILABLE LGVTE  0638 02139000
*                                      ADDR IN LGVT AVAILABLE QUEUE  */ 02140000
         LR    @12,LGVTPTR                                         0638 02141000
         AL    @12,LGVSIZE(,LGVTPTR)                               0638 02142000
         ST    @12,LGVLGVEP(,LGVTPTR)                              0638 02143000
*           RFY                                                    0639 02144000
*             LGVTEPTR RSTD;                                       0639 02145000
*           LGVTEPTR=LGVLGVEP;      /* OBTAIN ADDRESSIBILITY TO FIRST   02146000
*                                      LGVTE                         */ 02147000
         LR    LGVTEPTR,@12                                        0640 02148000
*           RFY                                                    0641 02149000
*             ENTRYCNT RSTD;                                       0641 02150000
*           ENTRYCNT=ONE;           /* COUNT OF LGVT ENTRIES QUEUED  */ 02151000
*                                                                  0642 02152000
         LA    ENTRYCNT,1                                          0642 02153000
*           /*********************************************************/ 02154000
*           /*                                                       */ 02155000
*           /* SET THE LGID IN EACH LGVTE AND CHAIN THE ENTRIES      */ 02156000
*           /* TOGETHER FOR THE AVAILABLE QUEUE                      */ 02157000
*           /*                                                       */ 02158000
*           /*********************************************************/ 02159000
*                                                                  0643 02160000
*           DO WHILE ENTRYCNT<EXPENTRS;/* FOR EVERY LGVTE EXCEPT THE    02161000
*                                      LAST                          */ 02162000
         B     @DE00643                                            0643 02163000
@DL00643 DS    0H                                                  0644 02164000
*             LGVENEXT=LGVTEPTR+LENGTH(LGVTE);/* Q NEXT LGVTE TO   0644 02165000
*                                      AVAILABLE QUEUE               */ 02166000
         LA    @00,8                                               0644 02167000
         ALR   @00,LGVTEPTR                                        0644 02168000
         ST    @00,LGVENEXT(,LGVTEPTR)                             0644 02169000
*             LGVELGID=LGVMAXLG+ENTRYCNT;/* INCR LGID IN NEXT LGVTE  */ 02170000
         LR    @15,ENTRYCNT                                        0645 02171000
         AL    @15,LGVMAXLG(,LGVTPTR)                              0645 02172000
         ST    @15,LGVELGID(,LGVTEPTR)                             0645 02173000
*             LGVTEPTR=LGVENEXT;    /* UPDATE THE LGVTE ADDR         */ 02174000
         LR    LGVTEPTR,@00                                        0646 02175000
*             ENTRYCNT=ENTRYCNT+ONE;/* INCR COUNT OF LGVTES QUEUED   */ 02176000
         AL    ENTRYCNT,@CF00040                                   0647 02177000
*           END;                    /* END DO FOR LGVTES             */ 02178000
@DE00643 LA    @15,64                                              0648 02179000
         CR    ENTRYCNT,@15                                        0648 02180000
         BL    @DL00643                                            0648 02181000
*           LGVELGID=LGVMAXLG+ENTRYCNT;/* SET LGID FOR LAST LGVTE, 0649 02182000
*                                      THE NEXT FIELD IS LEFT TO ZERO   02183000
*                                      INDICATING THE LAST LGVTE     */ 02184000
         L     @14,LGVMAXLG(,LGVTPTR)                              0649 02185000
         LR    @00,ENTRYCNT                                        0649 02186000
         ALR   @00,@14                                             0649 02187000
         ST    @00,LGVELGID(,LGVTEPTR)                             0649 02188000
*           RFY                                                    0650 02189000
*             ENTRYCNT UNRSTD;                                     0650 02190000
*           LGVMAXLG=LGVMAXLG+EXPENTRS;/* INCR MAX LGID              */ 02191000
         ALR   @14,@15                                             0651 02192000
         ST    @14,LGVMAXLG(,LGVTPTR)                              0651 02193000
*           R10=LGVSIZE;            /* SAVE SIZE OLD LGVT FOR      0652 02194000
*                                      FREEMAIN                      */ 02195000
         L     @12,LGVSIZE(,LGVTPTR)                               0652 02196000
         LR    R10,@12                                             0652 02197000
*           LGVSIZE=LGVSIZE+EXPSIZE;/* INCR LGVT SIZE                */ 02198000
         AL    @12,@CF01282                                        0653 02199000
         ST    @12,LGVSIZE(,LGVTPTR)                               0653 02200000
*           RFY                                                    0654 02201000
*             R1AREA RSTD;                                         0654 02202000
*           R1AREA=ASMLGVT;         /* SAVE ADDR OLD LGVT FOR      0655 02203000
*                                      FREEMAIN                      */ 02204000
         L     R1AREA,ASMLGVT(,ASMVTPTR)                           0655 02205000
*           EPALGVTP=ZERO;          /* RRR-STOP TRACKING LGVT-RRR    */ 02206000
         SLR   @12,@12                                             0656 02207000
         ST    @12,EPALGVTP                                        0656 02208000
*           EPALSIZE=ZERO;          /* RRR-STOP TRACKING LGVT      0657 02209000
*                                      SIZE-RRR                      */ 02210000
         STH   @12,EPALSIZE                                        0657 02211000
*           ASMLGVT=LGVTPTR;        /* STORE ADDR NEW LGVT IN ASMVT  */ 02212000
         ST    LGVTPTR,ASMLGVT(,ASMVTPTR)                          0658 02213000
*           R4SAVE=R4;              /* SAVE R4, DESTROYED IN FREEMAIN*/ 02214000
         ST    R4,R4SAVE                                           0659 02215000
*           GEN REFS(R1AREA,R10,R3,R4);                            0660 02216000
*                           /* FREE OLD LGVT */                         02217000
       FREEMAIN  RC,LV=(R10),SP=245,A=(R1AREA),BRANCH=(YES,GLOBAL)      02218000
*           ASMVTPTR=CVTASMVT;      /* RESTORE R3, DESTROYED IN    0661 02219000
*                                      GETMAIN                       */ 02220000
         L     @12,CVTPTR                                          0661 02221000
         L     ASMVTPTR,CVTASMVT(,@12)                             0661 02222000
*           R4=R4SAVE;              /* RESTORE R4, DESTROYED IN    0662 02223000
*                                      FREEMAIN                      */ 02224000
         L     R4,R4SAVE                                           0662 02225000
*           SQALEFT=SQALEFT+LGVSIZE;/* ADDR NEXT CONTROL BLOCK TO BE    02226000
*                                      BUILT                         */ 02227000
         L     @12,SQALEFT                                         0663 02228000
         AL    @12,LGVSIZE(,LGVTPTR)                               0663 02229000
         ST    @12,SQALEFT                                         0663 02230000
*         END;                      /* END EXPAND LGVT               */ 02231000
*                                                                  0664 02232000
*       /*************************************************************/ 02233000
*       /*                                                           */ 02234000
*       /* THE FIRST AVAILABLE LGVTE IS NOW OBTAINED                 */ 02235000
*       /*                                                           */ 02236000
*       /*************************************************************/ 02237000
*                                                                  0665 02238000
*       LGVTEPTR=LGVLGVEP;          /* OBTAIN ADDR FIRST AVAILABLE 0665 02239000
*                                      LGVTE                         */ 02240000
@RF00628 L     LGVTEPTR,LGVLGVEP(,LGVTPTR)                         0665 02241000
*       LGVLGVEP=LGVENEXT;          /* MAKE THE FIRST AVAILABLE LGVTE   02242000
*                                      THE NEXT LGVTE                */ 02243000
         L     @12,LGVENEXT(,LGVTEPTR)                             0666 02244000
         ST    @12,LGVLGVEP(,LGVTPTR)                              0666 02245000
*                                                                  0667 02246000
*       /*************************************************************/ 02247000
*       /*                                                           */ 02248000
*       /* A SRB IS CREATED IF THERE IS NONE, THE LGE IS INITIALIZED */ 02249000
*       /* AND AN ASPCT IS CREATED IF REQUESTED                      */ 02250000
*       /*                                                           */ 02251000
*       /*************************************************************/ 02252000
*                                                                  0667 02253000
*       IF ASHVSRBP=ZERO THEN                                      0667 02254000
         SLR   @12,@12                                             0667 02255000
         C     @12,ASHVSRBP(,RSMHDPTR)                             0667 02256000
         BNE   @RF00667                                            0667 02257000
*         DO;                       /* NO SRB FOR THIS ADDRESS SPACE */ 02258000
*           RFY                                                    0669 02259000
*             SRBPTR RSTD;                                         0669 02260000
*           SRBPTR=SQALEFT+LENGTH(LGE);/* OBTAIN ADDRESS OF THE SRB  */ 02261000
         LA    SRBPTR,24                                           0670 02262000
         AL    SRBPTR,SQALEFT                                      0670 02263000
*           SRBASCB=PSAAOLD;        /* STORE ASCB ADDR IN ASPCT      */ 02264000
         L     @15,PSAAOLD                                         0671 02265000
         ST    @15,SRBASCB(,SRBPTR)                                0671 02266000
*           SRBPASID=PSAAOLD->ASCBASID;/* ASID OF SRBRMTR            */ 02267000
         LH    @00,ASCBASID(,@15)                                  0672 02268000
         N     @00,@CF01812                                        0672 02269000
         STH   @00,SRBPASID(,SRBPTR)                               0672 02270000
*           SRBEP=ASMPSRBC;         /* ADDR SRB CONTROLLER, GIVEN  0673 02271000
*                                      CONTROL WHEN SRB SCHEDULED    */ 02272000
         L     @00,ASMPSRBC(,ASMVTPTR)                             0673 02273000
         ST    @00,SRBEP(,SRBPTR)                                  0673 02274000
*           SRBID=SRBK;             /* SET SRB ID IN SRB             */ 02275000
         MVC   SRBID(4,SRBPTR),@CC01689                            0674 02276000
*           SRBRMTR=ASMVRMTR;       /* ADDR VIO RESOURCE MANAGER   0675 02277000
*                                      TERMINATION ROUTINE           */ 02278000
         L     @00,ASMVRMTR(,ASMVTPTR)                             0675 02279000
         ST    @00,SRBRMTR(,SRBPTR)                                0675 02280000
*           SRBPRIOR=NONQ;          /* MAKE SRB PRIORITY           0676 02281000
*                                      NON-QUIESCENT                 */ 02282000
         MVI   SRBPRIOR(SRBPTR),X'04'                              0676 02283000
*           EPASRB=ZERO;            /* RRR-STOP TRACKING SRB ADDR IN    02284000
*                                      EPATH-RRR                     */ 02285000
         ST    @12,EPASRB                                          0677 02286000
*           ASHVSRBP=SRBPTR;        /* PUT SRB ADDR IN THE ASM HEADER*/ 02287000
         ST    SRBPTR,ASHVSRBP(,RSMHDPTR)                          0678 02288000
*           RFY                                                    0679 02289000
*             SRBPTR UNRSTD;                                       0679 02290000
*         END;                      /* NO SRB                        */ 02291000
*       LGEPTR=SQALEFT;             /* OBTAIN ADDR OF THE LGE        */ 02292000
@RF00667 L     LGEPTR,SQALEFT                                      0681 02293000
*       IF REQASPCT=ON THEN                                        0682 02294000
         TM    REQASPCT,B'10000000'                                0682 02295000
         BNO   @RF00682                                            0682 02296000
*         DO;                       /* ASPCT NEEDED                  */ 02297000
*           RFY                                                    0684 02298000
*             ASPCTPTR RSTD;                                       0684 02299000
*           ASPCTPTR=SAVASPCT;      /* OBTAIN ASPCT TO BE INITIALIZED*/ 02300000
         L     ASPCTPTR,SAVASPCT                                   0685 02301000
*           ASPIDENT=ASPC;          /* PLACE ID IN ASPCT             */ 02302000
         MVC   ASPIDENT(4,ASPCTPTR),@CC01687                       0686 02303000
*           ASPLGID=LGVELGID;       /* STORE LGID IN ASPCT           */ 02304000
         L     @00,LGVELGID(,LGVTEPTR)                             0687 02305000
         ST    @00,ASPLGID(,ASPCTPTR)                              0687 02306000
*           ASPLGE=LGEPTR;          /* STORE LGE ADDR IN ASPCT       */ 02307000
         ST    LGEPTR,ASPLGE(,ASPCTPTR)                            0688 02308000
*           ASPASCB=PSAAOLD;        /* STORE ASCB ADDR IN ASPCT      */ 02309000
         L     @00,PSAAOLD                                         0689 02310000
         ST    @00,ASPASCB(,ASPCTPTR)                              0689 02311000
*           EPARBASP=ZERO;          /* RRR-STOP TRACKING THE       0690 02312000
*                                      ASPCT-RRR                     */ 02313000
         SLR   @15,@15                                             0690 02314000
         ST    @15,EPARBASP                                        0690 02315000
*           EPARSIZE=ZERO;          /* RRR-STOP TRACKING ASPCT     0691 02316000
*                                      SIZE-RRR                      */ 02317000
         STH   @15,EPARSIZE                                        0691 02318000
*           LGEASPCT=ASPCTPTR;      /* STORE ASPCT ADDR IN THE LGE   */ 02319000
         ST    ASPCTPTR,LGEASPCT(,LGEPTR)                          0692 02320000
*         END;                      /* ASPCT NEEDED                  */ 02321000
*       SAVLGVTE=LGVTEPTR;          /* STORE ADDR OF THE LGVTE ACROSS   02322000
*                                      GETLOCK                       */ 02323000
@RF00682 ST    LGVTEPTR,SAVLGVTE                                   0694 02324000
*       CALL GETLOCK;               /* GET THE ASM CLASS LOCK        */ 02325000
         BAL   @14,GETLOCK                                         0695 02326000
*       LGVTEPTR=SAVLGVTE;          /* RESTORE THE ADDR OF THE LGVTE */ 02327000
         L     LGVTEPTR,SAVLGVTE                                   0696 02328000
*       LGELGID=LGVELGID;           /* STORE THE LGID IN LGE         */ 02329000
         L     @00,LGVELGID(,LGVTEPTR)                             0697 02330000
         ST    @00,LGELGID(,LGEPTR)                                0697 02331000
*       LGVELGEP=LGEPTR;            /* STORE LGE ADDR IN LGVTE       */ 02332000
         ST    LGEPTR,LGVELGEP(,LGVTEPTR)                          0698 02333000
*       LGVEASCB=PSAAOLD;           /* STORE ASCB ADDR IN LGVTE,   0699 02334000
*                                      VALIDATES THE LGVTE           */ 02335000
         L     @00,PSAAOLD                                         0699 02336000
         ST    @00,LGVEASCB(,LGVTEPTR)                             0699 02337000
*       IF EPAACASR=OFF THEN                                       0700 02338000
         TM    EPAACASR,B'00001000'                                0700 02339000
         BNZ   @RF00700                                            0700 02340000
*         EPALGEP=ZERO;             /* RRR-CLEAR LGE ADDR IN EPATH ON   02341000
*                                      A RELEASE REQUEST-RRR         */ 02342000
         SLR   @00,@00                                             0701 02343000
         ST    @00,EPALGEP                                         0701 02344000
*                                                                  0702 02345000
*       /*************************************************************/ 02346000
*       /*                                                           */ 02347000
*       /* QUEUE THE LGE TO THE ASM HEADER LGE QUEUE, RELEASE THE ASM*/ 02348000
*       /* AND SALLOC LOCKS, AND RETURN TO THE CALLER                */ 02349000
*       /*                                                           */ 02350000
*       /*************************************************************/ 02351000
*                                                                  0702 02352000
*       LGENEXT=ASHLGEQ;            /* Q LGE Q TO LGE JUST OBTAINED  */ 02353000
@RF00700 L     @00,ASHLGEQ(,RSMHDPTR)                              0702 02354000
         ST    @00,LGENEXT(,LGEPTR)                                0702 02355000
*       ASHLGEQ=LGEPTR;             /* MAKE LGE FIRST ELEMENT ON   0703 02356000
*                                      QUEUE                         */ 02357000
         ST    LGEPTR,ASHLGEQ(,RSMHDPTR)                           0703 02358000
*       RFY                                                        0704 02359000
*        (LGVTPTR,                                                 0704 02360000
*         ASPCTPTR,                                                0704 02361000
*         LGVTEPTR) UNRSTD;                                        0704 02362000
*       CALL FREELOCK;              /* FREE THE ASM CLASS LOCK       */ 02363000
         BAL   @14,FREELOCK                                        0705 02364000
*     END;                          /* NO GETMAIN ERRORS             */ 02365000
*   GEN;                                                           0707 02366000
@RF00626 DS    0H                                                  0707 02367000
*    /* RELEASE THE SALLOC LOCK */                                      02368000
FRESAL1   SETLOCK  RELEASE,TYPE=SALLOC,RELATED=(VIO,ILRGOS(GETSAL1))    02369000
*   RFY                                                            0708 02370000
*     R14 RSTD;                                                    0708 02371000
*   R14=RTNADDR;                    /* RESTORE RETURN ADDR           */ 02372000
         L     R14,RTNADDR                                         0709 02373000
*   END ASSIGNLG;                                                  0710 02374000
@EL00004 DS    0H                                                  0710 02375000
@EF00004 DS    0H                                                  0710 02376000
@ER00004 BR    @14                                                 0710 02377000
*ILRFRELG:                                                         0711 02378000
*   ENTRY;                                                         0711 02379000
*                                                                  0711 02380000
@EP00711 DS    0H                                                  0712 02381000
*/********************************************************************/ 02382000
*/*                                                                  */ 02383000
*/* FUNCTION: TO DEQUEUE THE LGE FROM THE ASM HEADER LGE QUEUE, FREE */ 02384000
*/*           THE LGE, AND MAKE THE LGVTE AVAILABLE AGAIN. TO UPDATE */ 02385000
*/*           THE ASCB VIO COUNT.                                    */ 02386000
*/*                                                                  */ 02387000
*/* INPUT: R1 - ADDR LGE TO BE FREED                                 */ 02388000
*/*        R3 - ASMVT ADDR                                           */ 02389000
*/*        R13 - ADDR CALLER'S SAVE AREA                             */ 02390000
*/*                                                                  */ 02391000
*/* OUTPUT: ASCBVSC UPDATED BY LGESLTCT                              */ 02392000
*/*         LGVTE AVAILABLE Q ANCHOR (LGVLGVEP) AND LGVENEXT RESET   */ 02393000
*/*                                                                  */ 02394000
*/********************************************************************/ 02395000
*/********************************************************************/ 02396000
*/*ILRFRELG: CHART (AREF)                                            */ 02397000
*/*        HEADER                                                  0712 02398000
*/*        ILRGOS                                                  0712 02399000
*/* ILRFRELG - ROUTINE TO DEQUEUE AND FREE A LGE                     */ 02400000
*/*ILRFRELG: E EXTERNAL ENTRY                                        */ 02401000
*/*        P SAVE CALLER'S REGS                                      */ 02402000
*/*        P ESTABLISH ADDRESSIBILITY                                */ 02403000
*/*        P MAINTAIN ASMHD PTR, ASMVT PTR, AND LGE PTR              */ 02404000
*/*        L SETLOCK: UNCONDITIONAL OBTAIN ASM CLASS LOCK            */ 02405000
*/*        P (,%GOS48) INCR ASCBVSC BY LGESLTCT                      */ 02406000
*/*FRELG:  E INTERNAL ENTRY                                          */ 02407000
*/*%GOS48: P SAVE RETURN ADDR                                        */ 02408000
*/*        N DEQUEUE THE LGE                                         */ 02409000
*/*        D (Y,,N,%GOS74) LGE TO BE FREED IS FIRST ON Q             */ 02410000
*/*        P (,%GOS49) LGE Q (ASHLGEQ) = NEXT LGE (LGENEXT)          */ 02411000
*/*%GOS74: P SEARCH LGE Q FOR LGE TO BE FREED (LGEPTR)               */ 02412000
*/*        P SAVE PREVIOUS LGE ADDR DURING SEARCH                    */ 02413000
*/*        D (Y,,N,%GOS76) LGE TO BE FREED WAS FOUND                 */ 02414000
*/*        P LGENEXT OF PREVIOUS LGE = LGENEXT OF LGEPTR             */ 02415000
*/*%GOS49: P CLEAR FIRST AND LAST AIA/ACE PTRS                       */ 02416000
*/*        L SETLOCK: UNCONDITIONAL RELEASE ASM CLASS LOCK           */ 02417000
*/*        L SETLOCK: UNCONDITIONAL OBTAIN SALLOC LOCK               */ 02418000
*/*        P CALCULATE THE LGVTE ADDR                                */ 02419000
*/*        P LGVELGID = LGELGID                                      */ 02420000
*/*        P LGVENEXT = FIRST AVAILABLE LGVTE (LGVLGVEP)             */ 02421000
*/*        P FIRST AVAILABLE LGVTE = LGVTE ADDR                      */ 02422000
*/*        P INITIALIZE REGS FOR FREEMAIN                            */ 02423000
*/*        L FREEMAIN: FREE SQA SPACE CONTAINING THE LGE             */ 02424000
*/*        L (,%GOS77) SETLOCK: RELEASE THE SALLOC LOCK              */ 02425000
*/*%GOS76: P SET RTN CODE = '04', INVALID LGN                        */ 02426000
*/*        L SETLOCK: UNCONDITIONAL RELEASE ASM CLASS LOCK           */ 02427000
*/*%GOS77: D (N,,Y,%GOS50) INTERNAL ENTRY                            */ 02428000
*/*        P RESTORE CALLER'S REGS                                   */ 02429000
*/*        R RETURN TO ILRRLG                                        */ 02430000
*/*%GOS50: P RESTORE RETURN ADDRESS                                  */ 02431000
*/*        R RETURN                                                  */ 02432000
*/*ILRFRELG: END                                                     */ 02433000
*/********************************************************************/ 02434000
*                                                                  0712 02435000
*                                                                  0712 02436000
*   /*****************************************************************/ 02437000
*   /*                                                               */ 02438000
*   /* ILRFRELG IS CALLED BY ILRRLG AND ILRGOS01. THE ASM CLASS LOCK */ 02439000
*   /* IS OBTAINED AND THE VIO SLOT COUNT UPDATED BY THE AMOUNT      */ 02440000
*   /* SPECIFIED BY THE CALLING ROUTINE. FRELG IS THEN CALLED TO     */ 02441000
*   /* PERFORM THE ACTUAL PROCESSING. SINCE ILRFRELG IS AN EXTERNAL  */ 02442000
*   /* ENTRY NEITHER IT OR THE SUBROUTINE FRELG CAN USE ILRGOS       */ 02443000
*   /* WORK-SAVE AREA.                                               */ 02444000
*   /*                                                               */ 02445000
*   /*****************************************************************/ 02446000
*                                                                  0712 02447000
*   RFY                                                            0712 02448000
*    (R1,                                                          0712 02449000
*     R11,                                                         0712 02450000
*     R13) RSTD;                                                   0712 02451000
*   R8=R13;                         /* SAVE ADDR CALLERS SAVE AREA   */ 02452000
         LR    R8,R13                                              0713 02453000
*   LGEPTR=R1;                      /* OBTAIN THE ADDR OF THE LGE TO    02454000
*                                      BE FREED                      */ 02455000
         LR    LGEPTR,R1                                           0714 02456000
*   RFY                                                            0715 02457000
*     ASCBPTR RSTD;                                                0715 02458000
*   ASCBPTR=PSAAOLD;                /* OBTAIN ADDR ASCB              */ 02459000
         L     ASCBPTR,PSAAOLD                                     0716 02460000
*   RSMHDPTR=ASCBRSM;               /* OBTAIN ADDR RSM HEADER        */ 02461000
         L     RSMHDPTR,ASCBRSM(,ASCBPTR)                          0717 02462000
*   R11=ADDR(ASHLOCK);              /* OBTAIN ASM LOCKWORD           */ 02463000
         LA    R11,ASHLOCK(,RSMHDPTR)                              0718 02464000
*   GEN REFS(R11);                                                 0719 02465000
*              /* OBTAIN THE ASM CLASS LOCK */                          02466000
GETASM2  SETLOCK  OBTAIN,TYPE=ASM,ADDR=(11),MODE=UNCOND,              **02467000
               RELATED=(VIO,ILRGOS(FREASM2/3))                          02468000
*   RFY                                                            0720 02469000
*     R11 UNRSTD;                                                  0720 02470000
*   ASCBVSC=ASCBVSC+LGESLTCT;       /* UPDATE THE VIO SLOT COUNT BY     02471000
*                                      COUNT RETURNED BY THE RELEASE    02472000
*                                      GROUP OPERATOR                */ 02473000
         LH    @15,ASCBVSC(,ASCBPTR)                               0721 02474000
         AH    @15,LGESLTCT(,LGEPTR)                               0721 02475000
         STH   @15,ASCBVSC(,ASCBPTR)                               0721 02476000
*   RFY                                                            0722 02477000
*     ASCBPTR UNRSTD;                                              0722 02478000
*   CALL FRELG;                     /* TO PREFORM ACTUAL FREE      0723 02479000
*                                      PROCESSING                    */ 02480000
         BAL   @14,FRELG                                           0723 02481000
*FRELGEND:                                                         0724 02482000
*   R13=R8;                         /* RESTORE CALLERS SAVE AREA ADDR*/ 02483000
FRELGEND LR    R13,R8                                              0724 02484000
*   RFY                                                            0725 02485000
*     R15 RSTD;                                                    0725 02486000
*   RETURN CODE(R15);               /* RESTORE REGS AND RETURN TO  0726 02487000
*                                      CALLER                        */ 02488000
         L     @14,12(,@13)                                        0726 02489000
         LM    @00,@12,20(@13)                                     0726 02490000
         BR    @14                                                 0726 02491000
*   RFY                                                            0727 02492000
*     R15 UNRSTD;                                                  0727 02493000
*                                                                  0728 02494000
*   /*****************************************************************/ 02495000
*   /*                                                               */ 02496000
*   /* FRELG IS CALLED BY THE MAINLINE OF GOS AND ILRFRELG TO DEQUEUE*/ 02497000
*   /* AND FREE AN LGE AND TO REINITIALIZE THE LGVTE AND PUT IT BACK */ 02498000
*   /* ON THE AVAILABLE QUEUE.                                       */ 02499000
*   /*                                                               */ 02500000
*   /*****************************************************************/ 02501000
*                                                                  0728 02502000
*FRELG:                                                            0728 02503000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0728 02504000
FRELG    DS    0H                                                  0729 02505000
*   RFY                                                            0729 02506000
*    (R14,                                                         0729 02507000
*     R15,                                                         0729 02508000
*     R10) RSTD;                                                   0729 02509000
*   R10=R14;                        /* SAVE RETURN ADDR              */ 02510000
         LR    R10,R14                                             0730 02511000
*   IF ASHLGEQ=ZERO THEN                                           0731 02512000
         L     @12,ASHLGEQ(,RSMHDPTR)                              0731 02513000
         LTR   @12,@12                                             0731 02514000
         BNZ   @RF00731                                            0731 02515000
*     R15=CODE04;                   /* ASMHD LGE QUEUE EMPTY         */ 02516000
         LA    R15,4                                               0732 02517000
*   ELSE                                                           0733 02518000
*     DO;                           /* ASMHD LGE Q IS NOT EMPTY      */ 02519000
         B     @RC00731                                            0733 02520000
@RF00731 DS    0H                                                  0734 02521000
*       R15=CODE00;                 /* INTIALIZE RETURN CODE TO ZERO */ 02522000
         SLR   R15,R15                                             0734 02523000
*       IF ASHLGEQ=LGEPTR THEN                                     0735 02524000
         C     LGEPTR,ASHLGEQ(,RSMHDPTR)                           0735 02525000
         BNE   @RF00735                                            0735 02526000
*         ASHLGEQ=LGENEXT;          /* IF THE LGE IS THE FIRST ON THE   02527000
*                                      Q SET THE Q ANCHOR TO THE NEXT   02528000
*                                      LGE                           */ 02529000
*                                                                  0736 02530000
         L     @12,LGENEXT(,LGEPTR)                                0736 02531000
         ST    @12,ASHLGEQ(,RSMHDPTR)                              0736 02532000
*       /*************************************************************/ 02533000
*       /*                                                           */ 02534000
*       /* SEARCH THE ASM HEADER QUEUE FOR THE LGE TO BE FREED       */ 02535000
*       /*                                                           */ 02536000
*       /*************************************************************/ 02537000
*                                                                  0737 02538000
*       ELSE                                                       0737 02539000
*         DO;                       /* LGE NOT FIRST ON Q            */ 02540000
         B     @RC00735                                            0737 02541000
@RF00735 DS    0H                                                  0738 02542000
*           RFY                                                    0738 02543000
*             FOUNDLGE RSTD;                                       0738 02544000
*           RFY                                                    0739 02545000
*             LGE BASED(FOUNDLGE);                                 0739 02546000
*           FOUNDLGE=ASHLGEQ;       /* OBTAIN ADDR FIRST ELEMENT ON Q*/ 02547000
         L     FOUNDLGE,ASHLGEQ(,RSMHDPTR)                         0740 02548000
*           DO WHILE LGENEXT^=LGEPTR&LGENEXT^=ZERO;/* LOOP THRU THE     02549000
*                                      LGES UNTIL THE ONE TO BE    0741 02550000
*                                      RELEASED IS FOUND OR NONE ARE    02551000
*                                      LEFT                          */ 02552000
         B     @DE00741                                            0741 02553000
@DL00741 DS    0H                                                  0742 02554000
*             FOUNDLGE=LGENEXT;     /* OBTAIN ADDR NEXT LGE          */ 02555000
         L     FOUNDLGE,LGENEXT(,FOUNDLGE)                         0742 02556000
*           END;                    /* LOOP THRU LGES                */ 02557000
@DE00741 L     @00,LGENEXT(,FOUNDLGE)                              0743 02558000
         CR    @00,LGEPTR                                          0743 02559000
         BE    @DC00741                                            0743 02560000
         LTR   @00,@00                                             0743 02561000
         BNZ   @DL00741                                            0743 02562000
@DC00741 DS    0H                                                  0744 02563000
*           IF LGENEXT^=ZERO THEN                                  0744 02564000
         L     @00,LGENEXT(,FOUNDLGE)                              0744 02565000
         LTR   @00,@00                                             0744 02566000
         BZ    @RF00744                                            0744 02567000
*             LGENEXT=LGEPTR->LGENEXT;/* DEQUEUES THE LGE, SETS NEXT    02568000
*                                      OF PREVIOUS LGE TO NEXT OF LGE*/ 02569000
         L     @00,LGENEXT(,LGEPTR)                                0745 02570000
         ST    @00,LGENEXT(,FOUNDLGE)                              0745 02571000
*           ELSE                                                   0746 02572000
*             R15=CODE04;           /* LGE NOT FOUND                 */ 02573000
         B     @RC00744                                            0746 02574000
@RF00744 LA    R15,4                                               0746 02575000
*           RFY                                                    0747 02576000
*             FOUNDLGE UNRSTD;                                     0747 02577000
@RC00744 DS    0H                                                  0748 02578000
*         END;                      /* LGE NOT FIRST ON Q            */ 02579000
*     END;                          /* ASMHD LGE Q IS NOT EMPTY      */ 02580000
@RC00735 DS    0H                                                  0750 02581000
*   IF R15=CODE04 THEN                                             0750 02582000
@RC00731 C     R15,@CF00051                                        0750 02583000
         BNE   @RF00750                                            0750 02584000
*     DO;                           /* LGE NOT FOUND OR Q IS EMPTY   */ 02585000
*       RFY                                                        0752 02586000
*         R11 RSTD;                                                0752 02587000
*       R11=ADDR(ASHLOCK);          /* OBTAIN ASM LOCKWORD           */ 02588000
         LA    R11,ASHLOCK(,RSMHDPTR)                              0753 02589000
*       GEN REFS(R11);                                             0754 02590000
*              /* FREE THE ASM CLASS LOCK */                            02591000
FREASM2  SETLOCK  RELEASE,TYPE=ASM,ADDR=(11),                         **02592000
               RELATED=(VIO,ILRGOS(GETASM1/2))                          02593000
*       RFY                                                        0755 02594000
*         R11 UNRSTD;                                              0755 02595000
*     END;                          /* END LGE NOT FOUND OR Q IS   0756 02596000
*                                      EMPTY                         */ 02597000
*                                                                  0757 02598000
*   /*****************************************************************/ 02599000
*   /*                                                               */ 02600000
*   /* THE LGE WAS FOUND AND DEQUEUED. THE SALLOC LOCK IS OBTAINED.  */ 02601000
*   /* THE LGVTE IS DETERMINED AND RESTORED TO THE LGVT AVAILABLE    */ 02602000
*   /* QUEUE. THE LGE IS THEN FREED.                                 */ 02603000
*   /*                                                               */ 02604000
*   /*****************************************************************/ 02605000
*                                                                  0757 02606000
*   ELSE                                                           0757 02607000
*     DO;                           /* LGE WAS FOUND                 */ 02608000
         B     @RC00750                                            0757 02609000
@RF00750 DS    0H                                                  0758 02610000
*       RFY                                                        0758 02611000
*         LGE BASED(LGEPTR);                                       0758 02612000
*       LGEPROCF=ZERO;              /* CLEAR THE FIRST AND           */ 02613000
         SLR   @12,@12                                             0759 02614000
         ST    @12,LGEPROCF(,LGEPTR)                               0759 02615000
*       LGEPROCL=ZERO;              /* LAST AIA POINTERS OF THE LGE  */ 02616000
*                                                                  0760 02617000
         ST    @12,LGEPROCL(,LGEPTR)                               0760 02618000
*       /*************************************************************/ 02619000
*       /*                                                           */ 02620000
*       /* RELEASE THE ASM LOCK AND OBTAIN THE SALLOC LOCK. R13 WILL */ 02621000
*       /* INDICATE WHETHER THE SALLOC LOCK WAS OBTAINED HERE, OR    */ 02622000
*       /* HELD BY THE CALLER AS WHEN RECOVERY INVOKES THIS ROUTINE. */ 02623000
*       /*                                                           */ 02624000
*       /*************************************************************/ 02625000
*                                                                  0761 02626000
*       RFY                                                        0761 02627000
*        (R11,                                                     0761 02628000
*         R13) RSTD;                                               0761 02629000
*       R11=ADDR(ASHLOCK);          /* OBTAIN ADDR ASM LOCKWORD      */ 02630000
         LA    R11,ASHLOCK(,RSMHDPTR)                              0762 02631000
*       GEN REFS(R11);                                             0763 02632000
*              /* RELEASE ASM LOCK OBTAIN SALLOC LOCK */                02633000
FREASM3  SETLOCK  RELEASE,TYPE=ASM,ADDR=(11),                         **02634000
               RELATED=(VIO,ILRGOS(GETASM1/2))                          02635000
GETSAL2  SETLOCK  OBTAIN,TYPE=SALLOC,MODE=UNCOND,                     **02636000
               RELATED=(VIO,ILRGOS(FRESAL2))                            02637000
*       R14=R10;                    /* RESTORE RETURN ADDR           */ 02638000
         LR    R14,R10                                             0764 02639000
*       RFY                                                        0765 02640000
*        (LGVTPTR,                                                 0765 02641000
*         LGVTEPTR) RSTD;                                          0765 02642000
*                                                                  0765 02643000
*       /*************************************************************/ 02644000
*       /*                                                           */ 02645000
*       /* INITIALIZE THE LGVTE AND MAKE IT AVAILABLE AGAIN. FREE THE*/ 02646000
*       /* LGE AND RETURN TO THE CALLER.                             */ 02647000
*       /*                                                           */ 02648000
*       /*************************************************************/ 02649000
*                                                                  0766 02650000
*       LGVTPTR=ASMLGVT;            /* OBTAIN ADDR LGVT              */ 02651000
         L     LGVTPTR,ASMLGVT(,ASMVTPTR)                          0766 02652000
*       LGVTEPTR=ADDR(LGVENTRS(LGELGID+ONE));/* LGID GIVES OFFSET  0767 02653000
*                                      INTO LGVT                     */ 02654000
         L     @12,LGELGID(,LGEPTR)                                0767 02655000
         LR    @00,@12                                             0767 02656000
         SLA   @00,3                                               0767 02657000
         LR    LGVTEPTR,@00                                        0767 02658000
         LA    LGVTEPTR,LGVENTRS(LGVTEPTR,LGVTPTR)                 0767 02659000
*       LGVELGID=LGELGID;           /* PUT THE LGID IN THE LGVTE     */ 02660000
         ST    @12,LGVELGID(,LGVTEPTR)                             0768 02661000
*       LGVENEXT=LGVLGVEP;          /* Q THE AVAILABLE Q TO THE LGVTE*/ 02662000
         L     @12,LGVLGVEP(,LGVTPTR)                              0769 02663000
         ST    @12,LGVENEXT(,LGVTEPTR)                             0769 02664000
*       LGVLGVEP=LGVTEPTR;          /* MAKE THE LGVTE THE FIRST    0770 02665000
*                                      ELEMENT ON THE AVAILABLE QUEUE*/ 02666000
         ST    LGVTEPTR,LGVLGVEP(,LGVTPTR)                         0770 02667000
*       RFY                                                        0771 02668000
*        (LGVTPTR,                                                 0771 02669000
*         LGVTEPTR) UNRSTD;                                        0771 02670000
*       RFY                                                        0772 02671000
*        (R1AREA,                                                  0772 02672000
*         R12) RSTD;                                               0772 02673000
*       R1AREA=LGEPTR;              /* ADDR AREA TO BE FREED         */ 02674000
         LR    R1AREA,LGEPTR                                       0773 02675000
*       R12=LENGTH(LGE);            /* OBTAIN LENGTH AREA TO BE FREED*/ 02676000
         LA    R12,24                                              0774 02677000
*       R10=R14;                    /* STORE RETURN ADDR ACROSS    0775 02678000
*                                      SETLOCK                       */ 02679000
         LR    R10,R14                                             0775 02680000
*       R11=R4;                     /* STORE R4, DESTROYED IN      0776 02681000
*                                      FREEMAIN                      */ 02682000
         LR    R11,R4                                              0776 02683000
*       GEN REFS(R1AREA,R12,R13) SETS(R3,R4);                      0777 02684000
*                                     /* FREE LGE AND RELEASE SALLOC *  02685000
         FREEMAIN RC,LV=(R12),A=(R1AREA),SP=245,BRANCH=(YES,GLOBAL)     02686000
         LR       R4,R11   RESTORE R4, DESTROYED IN FREEMAIN            02687000
         LTR      R13,R13  THE SALLOC LOCK IS ONLY RELEASED IF IT WAS   02688000
         BNZ      SKIPREL  OBTAINED IN THIS ROUTINE, INDICATED BY R13   02689000
FRESAL2  SETLOCK  RELEASE,TYPE=SALLOC,RELATED=(VIO,ILRGOS(GETSAL2))     02690000
SKIPREL  DS       0H                                                    02691000
*       RFY                                                        0778 02692000
*        (R1AREA,                                                  0778 02693000
*         R12,                                                     0778 02694000
*         R13) UNRSTD;                                             0778 02695000
*       ASMVTPTR=CVTASMVT;          /* RESTORE R3, DESTROYED IN    0779 02696000
*                                      FREEMAIN                      */ 02697000
         L     @12,CVTPTR                                          0779 02698000
         L     ASMVTPTR,CVTASMVT(,@12)                             0779 02699000
*       R15=CODE00;                 /* ZERO RETURN CODE              */ 02700000
         SLR   R15,R15                                             0780 02701000
*     END;                          /* LGE WAS FOUND                 */ 02702000
*   RFY                                                            0782 02703000
*     R14 RSTD;                                                    0782 02704000
@RC00750 DS    0H                                                  0783 02705000
*   R14=R10;                        /* RESTORE THE RETURN ADDR       */ 02706000
         LR    R14,R10                                             0783 02707000
*   END FRELG;                                                     0784 02708000
@EL00005 DS    0H                                                  0784 02709000
@EF00005 DS    0H                                                  0784 02710000
@ER00005 BR    @14                                                 0784 02711000
*   END ILRGOS                                                     0785 02712000
*                                                                  0785 02713000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02714000
*/*%INCLUDE SYSLIB  (ILRACA  )                                       */ 02715000
*/*%INCLUDE SYSLIB  (ILRACE  )                                       */ 02716000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 02717000
*/*%INCLUDE SYSLIB  (IHARSMHD)                                       */ 02718000
*/*%INCLUDE SYSLIB  (ILRASMHD)                                       */ 02719000
*/*%INCLUDE SYSLIB  (ILRASMVT)                                       */ 02720000
*/*%INCLUDE SYSLIB  (ILRASPCT)                                       */ 02721000
*/*%INCLUDE SYSLIB  (ILRATA  )                                       */ 02722000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 02723000
*/*%INCLUDE SYSLIB  (ILREPATH)                                       */ 02724000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 02725000
*/*%INCLUDE SYSLIB  (ILRLGE  )                                       */ 02726000
*/*%INCLUDE SYSLIB  (ILRLGVT )                                       */ 02727000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 02728000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 02729000
*/*%INCLUDE SYSLIB  (IHAWSAVT)                                       */ 02730000
*                                                                  0785 02731000
*       ;                                                          0785 02732000
         B     @EL00001                                            0785 02733000
@DATA    DS    0H                                                       02734000
@CH01810 DC    H'1088'                                                  02735000
@DATD    DSECT                                                          02736000
         DS    0F                                                       02737000
ILRGOS   CSECT                                                          02738000
         DS    0F                                                       02739000
@CF00040 DC    F'1'                                                     02740000
@CF00051 DC    F'4'                                                     02741000
@CF00438 DC    F'28'                                                    02742000
@CF00507 DC    F'40'                                                    02743000
@CF01405 DC    F'44'                                                    02744000
@CF01282 DC    F'512'                                                   02745000
@CF01675 DC    XL4'00040000'                                            02746000
@CF01677 DC    XL4'FFFFFFFF'                                            02747000
@CF01812 DC    XL4'0000FFFF'                                            02748000
@DATD    DSECT                                                          02749000
         DS    0D                                                       02750000
SLOTS    DS    F                                                        02751000
RTNADDR  DS    A                                                        02752000
RTNCODE  DS    F                                                        02753000
SAVASPCT DS    A                                                        02754000
SAVLGVTE DS    A                                                        02755000
SQALEFT  DS    A                                                        02756000
R4SAVE   DS    F                                                        02757000
R7SAVE   DS    F                                                        02758000
EPATH    DS    CL52                                                     02759000
         ORG   EPATH                                                    02760000
EPAVSAM  DS    CL52                                                     02761000
         ORG   EPAVSAM                                                  02762000
EPAOWKA  DS    AL4                                                      02763000
EPAVWKA  DS    AL4                                                      02764000
         ORG   EPAVWKA                                                  02765000
EPATMWKA DS    AL4                                                      02766000
         ORG   EPATMWKA                                                 02767000
EPASWKA  DS    AL4                                                      02768000
         ORG   EPAVSAM+8                                                02769000
EPAAASP  DS    AL4                                                      02770000
         ORG   EPAAASP                                                  02771000
EPADSLST DS    AL4                                                      02772000
         ORG   EPAVSAM+12                                               02773000
EPABASP  DS    AL4                                                      02774000
         ORG   EPABASP                                                  02775000
EPATMIBA DS    AL4                                                      02776000
         ORG   EPAVSAM+16                                               02777000
EPARASP  DS    AL4                                                      02778000
         ORG   EPARASP                                                  02779000
EPATMACB DS    AL4                                                      02780000
         ORG   EPAVSAM+20                                               02781000
EPARTYRG DS    AL4                                                      02782000
         ORG   EPARTYRG                                                 02783000
EPABKSLT DS    FL4                                                      02784000
         ORG   EPABKSLT                                                 02785000
EPATMISV DS    AL4                                                      02786000
         ORG   EPAVSAM+24                                               02787000
EPAFLAG1 DS    BL1                                                      02788000
         ORG   EPAFLAG1                                                 02789000
EPAVSAMI DS    BL1                                                      02790000
EPAGRPOP EQU   EPAFLAG1+0                                               02791000
         ORG   EPAGRPOP                                                 02792000
EPARLG   EQU   EPAGRPOP+0                                               02793000
EPASAVE  EQU   EPAGRPOP+0                                               02794000
EPAACT   EQU   EPAGRPOP+0                                               02795000
         ORG   EPAFLAG1+0                                               02796000
EPAACASR EQU   EPAFLAG1+0                                               02797000
EPAASGN  EQU   EPAFLAG1+0                                               02798000
EPAUNSAV EQU   EPAFLAG1+0                                               02799000
EPARPLB  EQU   EPAFLAG1+0                                               02800000
         ORG   EPAVSAM+25                                               02801000
EPAFLAG2 DS    BL1                                                      02802000
         ORG   EPAFLAG2                                                 02803000
EPATMXIT DS    BL1                                                      02804000
EPAWARM  EQU   EPAFLAG2+0                                               02805000
EPACOLD  EQU   EPAFLAG2+0                                               02806000
EPABUILD EQU   EPAFLAG2+0                                               02807000
EPAMAST  EQU   EPAFLAG2+0                                               02808000
EPATMI   EQU   EPAFLAG2+0                                               02809000
EPARECUR EQU   EPAFLAG2+0                                               02810000
@NM00019 EQU   EPAFLAG2+0                                               02811000
         ORG   EPAVSAM+26                                               02812000
EPALSIZE DS    FL2                                                      02813000
EPALGVTP DS    AL4                                                      02814000
EPALGEP  DS    AL4                                                      02815000
EPASRB   DS    AL4                                                      02816000
EPAACE   DS    AL4                                                      02817000
EPARBASP DS    AL4                                                      02818000
EPARSIZE DS    FL2                                                      02819000
@NM00020 DS    FL2                                                      02820000
         ORG   EPATH+52                                                 02821000
SAVAREA  DS    CL72                                                     02822000
WKATA    DS    CL24                                                     02823000
WKBUFCON DS    CL12                                                     02824000
INTFLAG  DS    CL1                                                      02825000
         ORG   INTFLAG                                                  02826000
REQASPCT DS    BL1                                                      02827000
IDEXISTS EQU   INTFLAG+0                                                02828000
@NM00051 EQU   INTFLAG+0                                                02829000
         ORG   INTFLAG+1                                                02830000
ILRGOS   CSECT                                                          02831000
         NOPR  ((@ENDDATD-@DATD)/257*16)                                02832000
         DS    0F                                                       02833000
@SIZDATD DC    AL1(0)                                                   02834000
         DC    AL3(@ENDDATD-@DATD)                                      02835000
@CV01708 DC    V(ILRCGOSE)                                              02836000
@CV01709 DC    V(ILRGOS01)                                              02837000
         DS    0D                                                       02838000
@CC01687 DC    C'ASPC'                                                  02839000
@CC01689 DC    C'SRB '                                                  02840000
@CB01681 DC    X'0000000000000000'                                      02841000
@DATD    DSECT                                                          02842000
ESTAELST ESTAE MF=L            LIST FORM OF ESTAE                       02843000
POSTLIST POST  MF=L            LIST FORM OF POST                        02844000
@DATD    DSECT                                                          02845000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02846000
@ENDDATD EQU   *                                                        02847000
ILRGOS   CSECT                                                          02848000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02849000
@01      EQU   01                                                       02850000
@02      EQU   02                                                       02851000
@03      EQU   03                                                       02852000
@04      EQU   04                                                       02853000
@05      EQU   05                                                       02854000
@06      EQU   06                                                       02855000
@07      EQU   07                                                       02856000
@08      EQU   08                                                       02857000
@09      EQU   09                                                       02858000
@10      EQU   10                                                       02859000
@11      EQU   11                                                       02860000
@12      EQU   12                                                       02861000
@13      EQU   13                                                       02862000
@14      EQU   14                                                       02863000
@15      EQU   15                                                       02864000
ACAPTR   EQU   @09                                                      02865000
ACEPTR   EQU   @07                                                      02866000
ASCBPTR  EQU   @10                                                      02867000
RSMHDPTR EQU   @02                                                      02868000
ASMVTPTR EQU   @03                                                      02869000
ASPCTPTR EQU   @12                                                      02870000
ATAPTR   EQU   @04                                                      02871000
LGEPTR   EQU   @05                                                      02872000
LGVTPTR  EQU   @11                                                      02873000
LGVTEPTR EQU   @10                                                      02874000
SRBPTR   EQU   @11                                                      02875000
R6BASE   EQU   @06                                                      02876000
WKSAV@   EQU   @08                                                      02877000
BUFPTR   EQU   @12                                                      02878000
GETSIZE  EQU   @12                                                      02879000
ECBPTR   EQU   @11                                                      02880000
ENTRYCNT EQU   @12                                                      02881000
FOUNDLGE EQU   @12                                                      02882000
FOUNDACE EQU   @10                                                      02883000
R1AREA   EQU   @01                                                      02884000
R0       EQU   @00                                                      02885000
R1       EQU   @01                                                      02886000
R3       EQU   @03                                                      02887000
R4       EQU   @04                                                      02888000
R7       EQU   @07                                                      02889000
R8       EQU   @08                                                      02890000
R10      EQU   @10                                                      02891000
R11      EQU   @11                                                      02892000
R12      EQU   @12                                                      02893000
R13      EQU   @13                                                      02894000
R14      EQU   @14                                                      02895000
R15      EQU   @15                                                      02896000
R2       EQU   @02                                                      02897000
R5       EQU   @05                                                      02898000
R6       EQU   @06                                                      02899000
R9       EQU   @09                                                      02900000
PSA      EQU   0                                                        02901000
FLCRNPSW EQU   PSA                                                      02902000
FLCROPSW EQU   PSA+8                                                    02903000
FLCICCW2 EQU   PSA+16                                                   02904000
FLCCVT   EQU   FLCICCW2                                                 02905000
PSAEEPSW EQU   PSA+132                                                  02906000
PSAESPSW EQU   PSA+136                                                  02907000
FLCSVILC EQU   PSAESPSW+1                                               02908000
PSAEPPSW EQU   PSA+140                                                  02909000
FLCPIILC EQU   PSAEPPSW+1                                               02910000
FLCPICOD EQU   PSAEPPSW+2                                               02911000
PSAPICOD EQU   FLCPICOD+1                                               02912000
FLCTEA   EQU   PSAEPPSW+4                                               02913000
FLCPER   EQU   PSA+152                                                  02914000
FLCMCLA  EQU   PSA+168                                                  02915000
FLCIOEL  EQU   FLCMCLA+4                                                02916000
FLCIOA   EQU   FLCMCLA+16                                               02917000
FLCFSA   EQU   FLCMCLA+80                                               02918000
PSATOLD  EQU   PSA+540                                                  02919000
PSAAOLD  EQU   PSA+548                                                  02920000
PSASUPER EQU   PSA+552                                                  02921000
PSASUP1  EQU   PSASUPER                                                 02922000
PSASUP2  EQU   PSASUPER+1                                               02923000
PSASUP3  EQU   PSASUPER+2                                               02924000
PSASUP4  EQU   PSASUPER+3                                               02925000
PSACLHT  EQU   PSA+640                                                  02926000
PSALKSA  EQU   PSA+696                                                  02927000
PSAHLHI  EQU   PSA+760                                                  02928000
PSADSSFL EQU   PSA+836                                                  02929000
PSADSSF1 EQU   PSADSSFL                                                 02930000
PSADSSF3 EQU   PSADSSFL+2                                               02931000
PSADSSF4 EQU   PSADSSFL+3                                               02932000
PSARSVT  EQU   PSA+896                                                  02933000
ACA      EQU   0                                                        02934000
ACAOP    EQU   ACA                                                      02935000
ACAFLG1  EQU   ACA+1                                                    02936000
ACAFSYM  EQU   ACAFLG1                                                  02937000
ACAASID  EQU   ACA+2                                                    02938000
ACALGN   EQU   ACA+8                                                    02939000
ACALPID  EQU   ACALGN                                                   02940000
ACALGID  EQU   ACALPID                                                  02941000
ACARPN   EQU   ACALPID+4                                                02942000
ACASYM   EQU   ACA+16                                                   02943000
ACATOLP  EQU   ACASYM                                                   02944000
ACATOLGI EQU   ACATOLP                                                  02945000
ACAMAXPN EQU   ACATOLGI                                                 02946000
ACE      EQU   0                                                        02947000
ACEFQPA  EQU   ACE                                                      02948000
ACEBQPA  EQU   ACE+4                                                    02949000
ACEOP    EQU   ACE+8                                                    02950000
ACEFLG1  EQU   ACE+9                                                    02951000
ACEUSYM  EQU   ACEFLG1                                                  02952000
ACEFLG3  EQU   ACE+11                                                   02953000
ACEGRPRQ EQU   ACEFLG3                                                  02954000
ACELGE   EQU   ACE+12                                                   02955000
ACELGN   EQU   ACE+16                                                   02956000
ACELGID  EQU   ACELGN                                                   02957000
ACERPN   EQU   ACELGN+4                                                 02958000
ACESYM   EQU   ACE+24                                                   02959000
ACESRCID EQU   ACESYM                                                   02960000
ACEECB   EQU   ACE+32                                                   02961000
ASCB     EQU   0                                                        02962000
ASCBSUPC EQU   ASCB+16                                                  02963000
ASCBASID EQU   ASCB+36                                                  02964000
ASCBRSM  EQU   ASCB+52                                                  02965000
ASCBFW1  EQU   ASCB+100                                                 02966000
ASCBRCTF EQU   ASCBFW1+2                                                02967000
ASCBFLG1 EQU   ASCBFW1+3                                                02968000
ASCBDSP1 EQU   ASCB+114                                                 02969000
ASCBFLG2 EQU   ASCB+115                                                 02970000
ASCBVSC  EQU   ASCB+120                                                 02971000
ASCBLKGP EQU   ASCB+128                                                 02972000
ASCBSRQ  EQU   ASCB+180                                                 02973000
ASCBSRQ1 EQU   ASCBSRQ                                                  02974000
ASCBSRQ2 EQU   ASCBSRQ+1                                                02975000
ASCBSRQ3 EQU   ASCBSRQ+2                                                02976000
ASCBSRQ4 EQU   ASCBSRQ+3                                                02977000
RSMHD    EQU   0                                                        02978000
RSMFLG1  EQU   RSMHD+12                                                 02979000
RSMQS    EQU   RSMHD+20                                                 02980000
RSMLFQ   EQU   RSMQS                                                    02981000
RSMLSQA  EQU   RSMQS+4                                                  02982000
RSMLIOQ  EQU   RSMQS+8                                                  02983000
RSMASMHD EQU   RSMHD+40                                                 02984000
ASMVT    EQU   0                                                        02985000
ASMFLAG1 EQU   ASMVT                                                    02986000
ASMFLAG2 EQU   ASMVT+1                                                  02987000
ASMNOSAV EQU   ASMFLAG2                                                 02988000
ASMSTAGQ EQU   ASMVT+32                                                 02989000
ASMPCCWQ EQU   ASMVT+64                                                 02990000
ASMBKSLT EQU   ASMVT+108                                                02991000
ASMSLOTV EQU   ASMVT+128                                                02992000
ASMLGVT  EQU   ASMVT+132                                                02993000
ASMSTGXA EQU   ASMVT+136                                                02994000
ASMCINV  EQU   ASMVT+140                                                02995000
ASMLSAI  EQU   ASMVT+144                                                02996000
ASMGOSQS EQU   ASMVT+152                                                02997000
ASMGOSWT EQU   ASMGOSQS                                                 02998000
ASMGOSWK EQU   ASMGOSQS+4                                               02999000
ASMREQCT EQU   ASMVT+160                                                03000000
ASMPSRBC EQU   ASMVT+216                                                03001000
ASMVRMTR EQU   ASMVT+220                                                03002000
ASMPEX   EQU   ASMVT+224                                                03003000
ASMPSAV  EQU   ASMVT+244                                                03004000
ASMPACT  EQU   ASMVT+248                                                03005000
ASMPRLG  EQU   ASMVT+252                                                03006000
ASMBWKPC EQU   ASMVT+312                                                03007000
ASMACEPC EQU   ASMVT+344                                                03008000
ASMWKSA1 EQU   ASMVT+368                                                03009000
ASMWKSA2 EQU   ASMVT+448                                                03010000
ASMWKSA3 EQU   ASMVT+528                                                03011000
ASMWKSA4 EQU   ASMVT+608                                                03012000
ASMWKSA5 EQU   ASMVT+688                                                03013000
ASMPOOLS EQU   0                                                        03014000
ASMCPAVQ EQU   ASMPOOLS+8                                               03015000
ASMCPAVL EQU   ASMCPAVQ                                                 03016000
ASMCPRSQ EQU   ASMPOOLS+16                                              03017000
ASPCT    EQU   0                                                        03018000
ASPHDR   EQU   ASPCT                                                    03019000
ASPIDENT EQU   ASPHDR                                                   03020000
ASPLGID  EQU   ASPHDR+4                                                 03021000
ASPBKEY  EQU   ASPHDR+8                                                 03022000
ASPSSYM  EQU   ASPBKEY                                                  03023000
ASPASCB  EQU   ASPHDR+20                                                03024000
ASPLGE   EQU   ASPHDR+24                                                03025000
ASPFLAG  EQU   ASPHDR+28                                                03026000
ASPMAXPN EQU   ASPHDR+32                                                03027000
ASPBKSLT EQU   ASPHDR+36                                                03028000
ASPEXTSN EQU   0                                                        03029000
ASPEHDR  EQU   ASPEXTSN                                                 03030000
ASPEXKEY EQU   ASPEHDR+8                                                03031000
ASPSECTA EQU   ASPEXTSN+64                                              03032000
ASPEXPTR EQU   0                                                        03033000
ASPLPME  EQU   0                                                        03034000
ASPLPFLG EQU   ASPLPME                                                  03035000
ASPVLSID EQU   ASPLPME+1                                                03036000
LPMEPTR  EQU   0                                                        03037000
ATA      EQU   0                                                        03038000
ATAMODID EQU   ATA                                                      03039000
ATASFLGS EQU   ATA+1                                                    03040000
ATARFLGS EQU   ATA+4                                                    03041000
ATARCRSN EQU   ATA+6                                                    03042000
ATARCODE EQU   ATA+7                                                    03043000
ATACLEAR EQU   ATA+8                                                    03044000
ATAWORKA EQU   ATACLEAR                                                 03045000
ATAEPATH EQU   ATACLEAR+4                                               03046000
CVTMAP   EQU   0                                                        03047000
CVTDAR   EQU   CVTMAP+72                                                03048000
CVTFLGS1 EQU   CVTDAR                                                   03049000
CVTBRET  EQU   CVTMAP+82                                                03050000
CVTDCB   EQU   CVTMAP+116                                               03051000
CVTIERLC EQU   CVTMAP+144                                               03052000
CVTOPTA  EQU   CVTMAP+182                                               03053000
CVTOPTB  EQU   CVTMAP+183                                               03054000
CVTGTF   EQU   CVTMAP+236                                               03055000
CVTGTFST EQU   CVTGTF                                                   03056000
CVTGTFS  EQU   CVTGTFST                                                 03057000
CVTSTATE EQU   CVTGTFST                                                 03058000
CVTTMODE EQU   CVTGTFST                                                 03059000
CVTFORM  EQU   CVTGTFST                                                 03060000
CVTAQAVT EQU   CVTMAP+240                                               03061000
CVTTCMFG EQU   CVTAQAVT                                                 03062000
CVTVOLM2 EQU   CVTMAP+244                                               03063000
CVTTATA  EQU   CVTVOLM2                                                 03064000
CVTTSKS  EQU   CVTTATA                                                  03065000
CVTVOLF2 EQU   CVTTSKS                                                  03066000
CVTTAT   EQU   CVTTATA+1                                                03067000
CVTATER  EQU   CVTMAP+248                                               03068000
CVTEXT1  EQU   CVTMAP+252                                               03069000
CVTPURG  EQU   CVTMAP+260                                               03070000
CVTQMSG  EQU   CVTMAP+268                                               03071000
CVTDMSR  EQU   CVTMAP+272                                               03072000
CVTRSV37 EQU   CVTDMSR                                                  03073000
CVTDMSRF EQU   CVTRSV37                                                 03074000
CVTERPV  EQU   CVTMAP+316                                               03075000
CVTINTLA EQU   CVTMAP+320                                               03076000
CVTAPF   EQU   CVTMAP+324                                               03077000
CVTEXT2  EQU   CVTMAP+328                                               03078000
CVTHJES  EQU   CVTMAP+332                                               03079000
CVTPGSIA EQU   CVTMAP+348                                               03080000
CVTA1F1  EQU   CVTMAP+356                                               03081000
CVTSYSK  EQU   CVTMAP+357                                               03082000
CVTVOLM1 EQU   CVTMAP+380                                               03083000
CVTVOLF1 EQU   CVTVOLM1                                                 03084000
CVTATMCT EQU   CVTMAP+388                                               03085000
CVTXTNT1 EQU   0                                                        03086000
CVTXTNT2 EQU   0                                                        03087000
CVTDSSV  EQU   CVTXTNT2                                                 03088000
CVTFLGBT EQU   CVTXTNT2+5                                               03089000
CVTQID   EQU   CVTXTNT2+24                                              03090000
CVTRV400 EQU   CVTXTNT2+52                                              03091000
CVTRV409 EQU   CVTXTNT2+53                                              03092000
CVTATCVT EQU   CVTXTNT2+64                                              03093000
CVTRV429 EQU   CVTXTNT2+84                                              03094000
CVTRV438 EQU   CVTXTNT2+85                                              03095000
CVTRV457 EQU   CVTXTNT2+112                                             03096000
CVTRV466 EQU   CVTXTNT2+113                                             03097000
CVTFIX   EQU   0                                                        03098000
CVTRELNO EQU   CVTFIX+252                                               03099000
FRRS     EQU   0                                                        03100000
FRRSHEAD EQU   FRRS                                                     03101000
FRRSPTR  EQU   0                                                        03102000
FRRSENTR EQU   0                                                        03103000
FRRSFLGS EQU   FRRSENTR+4                                               03104000
FRRSFLG1 EQU   FRRSFLGS                                                 03105000
FRREPTR  EQU   0                                                        03106000
LGE      EQU   0                                                        03107000
LGEPROCQ EQU   LGE                                                      03108000
LGEPROCF EQU   LGEPROCQ                                                 03109000
LGEPROCL EQU   LGEPROCQ+4                                               03110000
LGEFLAG1 EQU   LGE+8                                                    03111000
LGEWRKPD EQU   LGEFLAG1                                                 03112000
LGEGRINP EQU   LGEFLAG1                                                 03113000
LGERELLG EQU   LGEFLAG1                                                 03114000
LGESAVRQ EQU   LGEFLAG1                                                 03115000
LGESLTCT EQU   LGE+10                                                   03116000
LGEASPCT EQU   LGE+12                                                   03117000
LGENEXT  EQU   LGE+16                                                   03118000
LGELGID  EQU   LGE+20                                                   03119000
LGVT     EQU   0                                                        03120000
LGVLGVEP EQU   LGVT+4                                                   03121000
LGVMAXLG EQU   LGVT+8                                                   03122000
LGVSIZE  EQU   LGVT+12                                                  03123000
LGVENTRS EQU   LGVT+16                                                  03124000
LGVTE    EQU   0                                                        03125000
LGVLGVTE EQU   LGVTE                                                    03126000
LGVELGEP EQU   LGVLGVTE                                                 03127000
LGVENEXT EQU   LGVELGEP                                                 03128000
LGVEASCB EQU   LGVLGVTE+4                                               03129000
LGVELGID EQU   LGVEASCB                                                 03130000
SRBSECT  EQU   0                                                        03131000
SRB      EQU   SRBSECT                                                  03132000
SRBID    EQU   SRB                                                      03133000
SRBASCB  EQU   SRB+8                                                    03134000
SRBFLC   EQU   SRB+12                                                   03135000
SRBPASID EQU   SRBFLC+2                                                 03136000
SRBEP    EQU   SRB+20                                                   03137000
SRBRMTR  EQU   SRB+24                                                   03138000
SRBPRIOR EQU   SRB+37                                                   03139000
WSAG     EQU   0                                                        03140000
ILRSAV   EQU   0                                                        03141000
ILRACT   EQU   0                                                        03142000
ILRRLG   EQU   0                                                        03143000
WKAREA   EQU   0                                                        03144000
BUFCONBK EQU   0                                                        03145000
BUFCHAIN EQU   BUFCONBK                                                 03146000
BUFASCB  EQU   BUFCONBK+4                                               03147000
BUFACE   EQU   BUFCONBK+8                                               03148000
SLOTV    EQU   0                                                        03149000
ILRPEX   EQU   0                                                        03150000
GMACELL  EQU   0                                                        03151000
GMANEXT  EQU   GMACELL                                                  03152000
DUMMY    EQU   RSMASMHD                                                 03153000
ASMHD    EQU   DUMMY                                                    03154000
ASHFLAG1 EQU   ASMHD                                                    03155000
ASHFLAG2 EQU   ASMHD+1                                                  03156000
ASHSCHED EQU   ASHFLAG2                                                 03157000
ASHLOCK  EQU   ASMHD+20                                                 03158000
ASHVSRBP EQU   ASMHD+24                                                 03159000
ASHLGEQ  EQU   ASMHD+28                                                 03160000
ASM1WKSV EQU   ASMWKSA1                                                 03161000
ASM1RGSV EQU   ASM1WKSV                                                 03162000
ASM1WRKA EQU   ASM1WKSV+60                                              03163000
ASM2WKSV EQU   ASMWKSA2                                                 03164000
ASM2WRKA EQU   ASM2WKSV+52                                              03165000
ASM2FLGS EQU   ASM2WRKA+12                                              03166000
ASM3WKSV EQU   ASMWKSA3                                                 03167000
ASM4WKSV EQU   ASMWKSA4                                                 03168000
ASM4RGSV EQU   ASM4WKSV                                                 03169000
ASM5WKSV EQU   ASMWKSA5                                                 03170000
ASM5RGSV EQU   ASM5WKSV                                                 03171000
ASPASST  EQU   ASPSECTA                                                 03172000
CVTPTR   EQU   FLCCVT                                                   03173000
CVTS01   EQU   CVTPGSIA                                                 03174000
CVTLPDIA EQU   CVTS01+12                                                03175000
CVTDIRST EQU   CVTLPDIA                                                 03176000
CVTSLIDA EQU   CVTS01+24                                                03177000
CVTCTLFG EQU   CVTS01+50                                                03178000
CVTSPSA  EQU   CVTS01+336                                               03179000
CVTASMVT EQU   CVTS01+356                                               03180000
CVTRV210 EQU   CVTS01+424                                               03181000
CVTRV219 EQU   CVTS01+425                                               03182000
CVTRV228 EQU   CVTS01+426                                               03183000
CVTRV237 EQU   CVTS01+427                                               03184000
CVTMFRTR EQU   CVTS01+452                                               03185000
CVTRV262 EQU   CVTS01+468                                               03186000
CVTRV271 EQU   CVTS01+469                                               03187000
CVTRV280 EQU   CVTS01+470                                               03188000
CVTRV289 EQU   CVTS01+471                                               03189000
CVTGSDA  EQU   CVTS01+600                                               03190000
PSARSVTE EQU   PSARSVT                                                  03191000
RTRYRGSV EQU   SAVAREA+12                                               03192000
ASPLPMEE EQU   ASPSECTA                                                 03193000
FLC      EQU   PSA                                                      03194000
*                                      START UNREFERENCED COMPONENTS    03195000
PSARSAV  EQU   PSARSVTE+60                                              03196000
PSARSTK  EQU   PSARSVTE+56                                              03197000
PSAESAV3 EQU   PSARSVTE+52                                              03198000
PSAESTK3 EQU   PSARSVTE+48                                              03199000
PSAESAV2 EQU   PSARSVTE+44                                              03200000
PSAESTK2 EQU   PSARSVTE+40                                              03201000
PSAESAV1 EQU   PSARSVTE+36                                              03202000
PSAESTK1 EQU   PSARSVTE+32                                              03203000
PSAPSAV  EQU   PSARSVTE+28                                              03204000
PSAPSTK  EQU   PSARSVTE+24                                              03205000
PSAMSAV  EQU   PSARSVTE+20                                              03206000
PSAMSTK  EQU   PSARSVTE+16                                              03207000
PSASSAV  EQU   PSARSVTE+12                                              03208000
PSASSTK  EQU   PSARSVTE+8                                               03209000
PSANSTK  EQU   PSARSVTE+4                                               03210000
PSACSTK  EQU   PSARSVTE                                                 03211000
CVTRV628 EQU   CVTS01+728                                               03212000
CVTRV627 EQU   CVTS01+724                                               03213000
CVTRV626 EQU   CVTS01+720                                               03214000
CVTRV625 EQU   CVTS01+716                                               03215000
CVTRV624 EQU   CVTS01+712                                               03216000
CVTRV623 EQU   CVTS01+708                                               03217000
CVTRV622 EQU   CVTS01+704                                               03218000
CVTRV621 EQU   CVTS01+700                                               03219000
CVTIHASU EQU   CVTS01+696                                               03220000
CVTSUSP  EQU   CVTS01+692                                               03221000
CVTT6SVC EQU   CVTS01+688                                               03222000
CVTCDAL  EQU   CVTS01+684                                               03223000
CVTTCTL  EQU   CVTS01+680                                               03224000
CVTRSUME EQU   CVTS01+676                                               03225000
CVTJTERM EQU   CVTS01+672                                               03226000
CVTASMRM EQU   CVTS01+668                                               03227000
CVTTCASP EQU   CVTS01+664                                               03228000
CVT0PT03 EQU   CVTS01+660                                               03229000
CVT0PT0E EQU   CVTS01+656                                               03230000
CVTRV609 EQU   CVTS01+652                                               03231000
CVTCGK   EQU   CVTS01+648                                               03232000
CVTRAC   EQU   CVTS01+644                                               03233000
CVTRV606 EQU   CVTS01+640                                               03234000
CVTRV605 EQU   CVTS01+636                                               03235000
CVTRV604 EQU   CVTS01+632                                               03236000
CVTEFF02 EQU   CVTS01+628                                               03237000
CVTCBBR  EQU   CVTS01+624                                               03238000
CVTSSCR  EQU   CVTS01+620                                               03239000
CVTEVENT EQU   CVTS01+616                                               03240000
CVTCRCA  EQU   CVTS01+612                                               03241000
CVTTPIO  EQU   CVTS01+608                                               03242000
CVTADV   EQU   CVTS01+604                                               03243000
CVTGSDAB EQU   CVTGSDA                                                  03244000
CVTQV3   EQU   CVTS01+596                                               03245000
CVTQV2   EQU   CVTS01+592                                               03246000
CVTQV1   EQU   CVTS01+588                                               03247000
CVTRPT   EQU   CVTS01+584                                               03248000
CVTSSRB  EQU   CVTS01+580                                               03249000
CVTCSDRL EQU   CVTS01+576                                               03250000
CVTEXP1  EQU   CVTS01+572                                               03251000
CVTRMPMT EQU   CVTS01+568                                               03252000
CVTRMPTT EQU   CVTS01+564                                               03253000
CVTVPSA  EQU   CVTS01+560                                               03254000
CVTVSTOP EQU   CVTS01+556                                               03255000
CVTGTFR8 EQU   CVTS01+552                                               03256000
CVTQUIT  EQU   CVTS01+548                                               03257000
CVTVACR  EQU   CVTS01+544                                               03258000
CVTWTCB  EQU   CVTS01+540                                               03259000
CVTSTPRS EQU   CVTS01+536                                               03260000
CVT0PT02 EQU   CVTS01+532                                               03261000
CVTDARCM EQU   CVTS01+528                                               03262000
CVTIRECM EQU   CVTS01+524                                               03263000
CVTJRECM EQU   CVTS01+520                                               03264000
CVTVEMS0 EQU   CVTS01+516                                               03265000
CVTSPFRR EQU   CVTS01+512                                               03266000
CVTRLSTG EQU   CVTS01+508                                               03267000
CVT0TC0A EQU   CVTS01+504                                               03268000
CVTGMBR  EQU   CVTS01+500                                               03269000
CVTLFRM  EQU   CVTS01+496                                               03270000
CVTRMBR  EQU   CVTS01+492                                               03271000
CVTVIOP  EQU   CVTS01+488                                               03272000
CVTRV307 EQU   CVTS01+486                                               03273000
CVTRV306 EQU   CVTS01+484                                               03274000
CVTRV305 EQU   CVTS01+482                                               03275000
CVTRV304 EQU   CVTS01+480                                               03276000
CVTRV303 EQU   CVTS01+478                                               03277000
CVTRV302 EQU   CVTS01+476                                               03278000
CVTTRCA  EQU   CVTS01+472                                               03279000
CVTRV297 EQU   CVTRV289                                                 03280000
CVTRV296 EQU   CVTRV289                                                 03281000
CVTRV295 EQU   CVTRV289                                                 03282000
CVTRV294 EQU   CVTRV289                                                 03283000
CVTRV293 EQU   CVTRV289                                                 03284000
CVTRV292 EQU   CVTRV289                                                 03285000
CVTRV291 EQU   CVTRV289                                                 03286000
CVTRV290 EQU   CVTRV289                                                 03287000
CVTRV288 EQU   CVTRV280                                                 03288000
CVTRV287 EQU   CVTRV280                                                 03289000
CVTRV286 EQU   CVTRV280                                                 03290000
CVTRV285 EQU   CVTRV280                                                 03291000
CVTRV284 EQU   CVTRV280                                                 03292000
CVTRV283 EQU   CVTRV280                                                 03293000
CVTRV282 EQU   CVTRV280                                                 03294000
CVTRV281 EQU   CVTRV280                                                 03295000
CVTRV279 EQU   CVTRV271                                                 03296000
CVTRV278 EQU   CVTRV271                                                 03297000
CVTRV277 EQU   CVTRV271                                                 03298000
CVTRV276 EQU   CVTRV271                                                 03299000
CVTRV275 EQU   CVTRV271                                                 03300000
CVTRV274 EQU   CVTRV271                                                 03301000
CVTRV273 EQU   CVTRV271                                                 03302000
CVTRV272 EQU   CVTRV271                                                 03303000
CVTRV270 EQU   CVTRV262                                                 03304000
CVTRV269 EQU   CVTRV262                                                 03305000
CVTRV268 EQU   CVTRV262                                                 03306000
CVTRV267 EQU   CVTRV262                                                 03307000
CVTRV266 EQU   CVTRV262                                                 03308000
CVTRV265 EQU   CVTRV262                                                 03309000
CVTRV264 EQU   CVTRV262                                                 03310000
CVTRV263 EQU   CVTRV262                                                 03311000
CVTVFP   EQU   CVTS01+464                                               03312000
CVTVSI   EQU   CVTS01+460                                               03313000
CVTVPSIB EQU   CVTS01+456                                               03314000
CVTMFACT EQU   CVTMFRTR                                                 03315000
CVTMFCTL EQU   CVTS01+448                                               03316000
CVTPVBP  EQU   CVTS01+444                                               03317000
CVTPWI   EQU   CVTS01+440                                               03318000
CVTRV254 EQU   CVTS01+438                                               03319000
CVTRV253 EQU   CVTS01+436                                               03320000
CVTRV252 EQU   CVTS01+434                                               03321000
CVTRV251 EQU   CVTS01+433                                               03322000
CVTRV250 EQU   CVTS01+432                                               03323000
CVTRV249 EQU   CVTS01+431                                               03324000
CVTRV248 EQU   CVTS01+430                                               03325000
CVTRV247 EQU   CVTS01+429                                               03326000
CVTRV246 EQU   CVTS01+428                                               03327000
CVTRV245 EQU   CVTRV237                                                 03328000
CVTRV244 EQU   CVTRV237                                                 03329000
CVTRV243 EQU   CVTRV237                                                 03330000
CVTRV242 EQU   CVTRV237                                                 03331000
CVTRV241 EQU   CVTRV237                                                 03332000
CVTRV240 EQU   CVTRV237                                                 03333000
CVTRV239 EQU   CVTRV237                                                 03334000
CVTRV238 EQU   CVTRV237                                                 03335000
CVTRV236 EQU   CVTRV228                                                 03336000
CVTRV235 EQU   CVTRV228                                                 03337000
CVTRV234 EQU   CVTRV228                                                 03338000
CVTRV233 EQU   CVTRV228                                                 03339000
CVTRV232 EQU   CVTRV228                                                 03340000
CVTRV231 EQU   CVTRV228                                                 03341000
CVTRV230 EQU   CVTRV228                                                 03342000
CVTRV229 EQU   CVTRV228                                                 03343000
CVTRV227 EQU   CVTRV219                                                 03344000
CVTRV226 EQU   CVTRV219                                                 03345000
CVTRV225 EQU   CVTRV219                                                 03346000
CVTRV224 EQU   CVTRV219                                                 03347000
CVTRV223 EQU   CVTRV219                                                 03348000
CVTRV222 EQU   CVTRV219                                                 03349000
CVTRV221 EQU   CVTRV219                                                 03350000
CVTRV220 EQU   CVTRV219                                                 03351000
CVTRV218 EQU   CVTRV210                                                 03352000
CVTRV217 EQU   CVTRV210                                                 03353000
CVTRV216 EQU   CVTRV210                                                 03354000
CVTRV215 EQU   CVTRV210                                                 03355000
CVTRV214 EQU   CVTRV210                                                 03356000
CVTRV213 EQU   CVTRV210                                                 03357000
CVTRV212 EQU   CVTRV210                                                 03358000
CVTRV211 EQU   CVTRV210                                                 03359000
CVTLCCAT EQU   CVTS01+420                                               03360000
CVTPCCAT EQU   CVTS01+416                                               03361000
CVTIPCRP EQU   CVTS01+412                                               03362000
CVTIPCRI EQU   CVTS01+408                                               03363000
CVTIPCDS EQU   CVTS01+404                                               03364000
CVTAIDVT EQU   CVTS01+400                                               03365000
CVTSSAP  EQU   CVTS01+396                                               03366000
CVTEHCIR EQU   CVTS01+392                                               03367000
CVTEHDEF EQU   CVTS01+388                                               03368000
CVTDAIR  EQU   CVTS01+384                                               03369000
CVTPERFM EQU   CVTS01+380                                               03370000
CVT044R2 EQU   CVTS01+376                                               03371000
CVTFETCH EQU   CVTS01+372                                               03372000
CVTRSTWD EQU   CVTS01+368                                               03373000
CVTSPOST EQU   CVTS01+364                                               03374000
CVTIOBP  EQU   CVTS01+360                                               03375000
CVTRECRQ EQU   CVTS01+352                                               03376000
CVTWSAC  EQU   CVTS01+348                                               03377000
CVTRV149 EQU   CVTS01+344                                               03378000
CVTWSAL  EQU   CVTS01+340                                               03379000
CVTGLMN  EQU   CVTS01+332                                               03380000
CVTVEAC0 EQU   CVTS01+328                                               03381000
CVT062R1 EQU   CVTS01+324                                               03382000
CVTRPOST EQU   CVTS01+320                                               03383000
CVTDQIQE EQU   CVTS01+316                                               03384000
CVTCSD   EQU   CVTS01+312                                               03385000
CVTLKRMA EQU   CVTS01+308                                               03386000
CVTRSPIE EQU   CVTS01+304                                               03387000
CVTRENQ  EQU   CVTS01+300                                               03388000
CVTLQCB  EQU   CVTS01+296                                               03389000
CVTFQCB  EQU   CVTS01+292                                               03390000
CVTQCS01 EQU   CVTS01+288                                               03391000
CVTAPFT  EQU   CVTS01+284                                               03392000
CVTPARRL EQU   CVTS01+280                                               03393000
CVTVWAIT EQU   CVTS01+276                                               03394000
CVTGSPL  EQU   CVTS01+272                                               03395000
CVTLSMQ  EQU   CVTS01+268                                               03396000
CVTGSMQ  EQU   CVTS01+264                                               03397000
CVTEXPRO EQU   CVTS01+260                                               03398000
CVTOPCTP EQU   CVTS01+256                                               03399000
CVTSIC   EQU   CVTS01+252                                               03400000
CVTTPIOS EQU   CVTS01+248                                               03401000
CVTRTMS  EQU   CVTS01+244                                               03402000
CVTSDBF  EQU   CVTS01+240                                               03403000
CVTSCBP  EQU   CVTS01+236                                               03404000
CVTSDMP  EQU   CVTS01+232                                               03405000
CVTSV60  EQU   CVTS01+228                                               03406000
CVTRTMCT EQU   CVTS01+224                                               03407000
CVTASCBL EQU   CVTS01+220                                               03408000
CVTASCBH EQU   CVTS01+216                                               03409000
CVTGDA   EQU   CVTS01+212                                               03410000
CVTASVT  EQU   CVTS01+208                                               03411000
CVTVVMDI EQU   CVTS01+204                                               03412000
CVTAQTOP EQU   CVTS01+200                                               03413000
CVTIOSCS EQU   CVTS01+196                                               03414000
CVTSDRM  EQU   CVTS01+192                                               03415000
CVTOPTE  EQU   CVTS01+188                                               03416000
CVTSTXU  EQU   CVTS01+184                                               03417000
CVTQUIS  EQU   CVTS01+180                                               03418000
CVTPARS  EQU   CVTS01+176                                               03419000
CVTS1EE  EQU   CVTS01+172                                               03420000
CVTFRAS  EQU   CVTS01+168                                               03421000
CVTQSAS  EQU   CVTS01+164                                               03422000
CVTCRAS  EQU   CVTS01+160                                               03423000
CVTCRMN  EQU   CVTS01+156                                               03424000
CVTDELCP EQU   CVTS01+152                                               03425000
CVTFRECL EQU   CVTS01+148                                               03426000
CVTGETCL EQU   CVTS01+144                                               03427000
CVTBLDCP EQU   CVTS01+140                                               03428000
CVTAUTHL EQU   CVTS01+136                                               03429000
CVTSCAN  EQU   CVTS01+132                                               03430000
CVTRV144 EQU   CVTS01+130                                               03431000
CVTMAXMP EQU   CVTS01+128                                               03432000
CVTSTCK  EQU   CVTS01+124                                               03433000
CVTRV139 EQU   CVTS01+123                                               03434000
CVTDSSAC EQU   CVTS01+122                                               03435000
CVTRV513 EQU   CVTS01+121                                               03436000
CVTIOSPL EQU   CVTS01+120                                               03437000
CVTPTGT  EQU   CVTS01+116                                               03438000
CVTCSPIE EQU   CVTS01+112                                               03439000
CVTSMFEX EQU   CVTS01+108                                               03440000
CVTOLT0A EQU   CVTS01+104                                               03441000
CVTSRBRT EQU   CVTS01+100                                               03442000
CVTPUTL  EQU   CVTS01+96                                                03443000
CVTASCRL EQU   CVTS01+92                                                03444000
CVTASCRF EQU   CVTS01+88                                                03445000
CVTRV326 EQU   CVTS01+84                                                03446000
CVTRV325 EQU   CVTS01+80                                                03447000
CVTRV324 EQU   CVTS01+76                                                03448000
CVT0VL01 EQU   CVTS01+72                                                03449000
CVTSHRVM EQU   CVTS01+68                                                03450000
CVTRV332 EQU   CVTS01+64                                                03451000
CVTTAS   EQU   CVTS01+60                                                03452000
CVTRSCN  EQU   CVTS01+56                                                03453000
CVTTRAC2 EQU   CVTS01+54                                                03454000
CVTTRACE EQU   CVTS01+52                                                03455000
CVTAPG   EQU   CVTS01+51                                                03456000
CVTSDTRC EQU   CVTCTLFG                                                 03457000
CVTGTRCE EQU   CVTCTLFG                                                 03458000
CVTNOMP  EQU   CVTCTLFG                                                 03459000
CVTRSV79 EQU   CVTCTLFG                                                 03460000
CVTDSTAT EQU   CVTCTLFG                                                 03461000
CVTRSV78 EQU   CVTCTLFG                                                 03462000
CVTRV333 EQU   CVTCTLFG                                                 03463000
CVTRV323 EQU   CVTCTLFG                                                 03464000
CVTSPVLK EQU   CVTS01+49                                                03465000
CVTRSV77 EQU   CVTS01+48                                                03466000
CVTRV331 EQU   CVTS01+44                                                03467000
CVTRV330 EQU   CVTS01+40                                                03468000
CVTRV329 EQU   CVTS01+36                                                03469000
CVTRV328 EQU   CVTS01+32                                                03470000
CVTRV322 EQU   CVTS01+28                                                03471000
CVTSLID  EQU   CVTSLIDA+1                                               03472000
CVTSYLK  EQU   CVTSLIDA                                                 03473000
CVTRV321 EQU   CVTS01+20                                                03474000
CVTRV320 EQU   CVTS01+16                                                03475000
CVTLPDIR EQU   CVTLPDIA+1                                               03476000
CVTRSV69 EQU   CVTDIRST                                                 03477000
CVTRSV68 EQU   CVTDIRST                                                 03478000
CVTRSV67 EQU   CVTDIRST                                                 03479000
CVTRSV66 EQU   CVTDIRST                                                 03480000
CVTRSV65 EQU   CVTDIRST                                                 03481000
CVTRSV64 EQU   CVTDIRST                                                 03482000
CVTRSV63 EQU   CVTDIRST                                                 03483000
CVTDICOM EQU   CVTDIRST                                                 03484000
CVTPVTP  EQU   CVTS01+8                                                 03485000
CVTLPDSR EQU   CVTS01+4                                                 03486000
CVTGETL  EQU   CVTS01                                                   03487000
ASPASSTE EQU   ASPASST                                                  03488000
ASM5FLGS EQU   ASM5WKSV+64                                              03489000
ASM5AIA  EQU   ASM5WKSV+60                                              03490000
ASM5GCTR EQU   ASM5WKSV+56                                              03491000
ASM5SR14 EQU   ASM5WKSV+52                                              03492000
@NM00007 EQU   ASM5RGSV+4                                               03493000
ASM5RG2  EQU   ASM5RGSV                                                 03494000
@NM00006 EQU   ASM4RGSV+4                                               03495000
ASM4RG2  EQU   ASM4RGSV                                                 03496000
ASM3SR13 EQU   ASM3WKSV+28                                              03497000
ASM3R14B EQU   ASM3WKSV+24                                              03498000
ASM3R14A EQU   ASM3WKSV+20                                              03499000
ASM3GRPA EQU   ASM3WKSV+16                                              03500000
ASM3TMPA EQU   ASM3WKSV+12                                              03501000
ASM3PIOP EQU   ASM3WKSV+8                                               03502000
ASM3GENQ EQU   ASM3WKSV+4                                               03503000
ASM3SWPQ EQU   ASM3WKSV                                                 03504000
ASM2SR14 EQU   ASM2WRKA+16                                              03505000
@NM00005 EQU   ASM2WRKA+13                                              03506000
ASM2WFLG EQU   ASM2FLGS                                                 03507000
ASM2RFLG EQU   ASM2FLGS                                                 03508000
ASM2DUPQ EQU   ASM2WRKA+8                                               03509000
ASM2CAQ  EQU   ASM2WRKA+4                                               03510000
ASM2PAQ  EQU   ASM2WRKA                                                 03511000
ASM2RGSV EQU   ASM2WKSV                                                 03512000
ASM1NXTA EQU   ASM1WRKA+4                                               03513000
ASM1ASCB EQU   ASM1WRKA                                                 03514000
ASM1RG15 EQU   ASM1RGSV+56                                              03515000
@NM00004 EQU   ASM1RGSV+4                                               03516000
ASM1RG1  EQU   ASM1RGSV                                                 03517000
ASHCAPQ  EQU   ASMHD+16                                                 03518000
ASHSWAPQ EQU   ASMHD+12                                                 03519000
ASHIOCNT EQU   ASMHD+8                                                  03520000
ASHBKSLT EQU   ASMHD+4                                                  03521000
ASHSWPCT EQU   ASMHD+2                                                  03522000
ASHRSV12 EQU   ASHFLAG2                                                 03523000
ASHRSV11 EQU   ASHFLAG2                                                 03524000
ASHRSV10 EQU   ASHFLAG2                                                 03525000
ASHRSV9  EQU   ASHFLAG2                                                 03526000
ASHRSV8  EQU   ASHFLAG2                                                 03527000
ASHRSV7  EQU   ASHFLAG2                                                 03528000
ASHRSV13 EQU   ASHFLAG2                                                 03529000
ASHRSV6  EQU   ASHFLAG1                                                 03530000
ASHRSV5  EQU   ASHFLAG1                                                 03531000
ASHRSV4  EQU   ASHFLAG1                                                 03532000
ASHRSV3  EQU   ASHFLAG1                                                 03533000
ASHRSV2  EQU   ASHFLAG1                                                 03534000
ASHPERME EQU   ASHFLAG1                                                 03535000
ASHCAPER EQU   ASHFLAG1                                                 03536000
ASHSWPOT EQU   ASHFLAG1                                                 03537000
WSAGSCHE EQU   WSAG+40                                                  03538000
WSAGREST EQU   WSAG+36                                                  03539000
WSAGNQDQ EQU   WSAG+32                                                  03540000
WSAGMEMT EQU   WSAG+28                                                  03541000
WSAGOPTM EQU   WSAG+24                                                  03542000
WSAGSTAT EQU   WSAG+20                                                  03543000
WSAGEMS0 EQU   WSAG+16                                                  03544000
WSAGSSRS EQU   WSAG+12                                                  03545000
WSAGRSM  EQU   WSAG+8                                                   03546000
WSAGGMFM EQU   WSAG+4                                                   03547000
WSAGPGIO EQU   WSAG                                                     03548000
@NM00050 EQU   SRB+40                                                   03549000
@NM00049 EQU   SRB+38                                                   03550000
SRBPKF   EQU   SRB+36                                                   03551000
SRBSAVE  EQU   SRB+32                                                   03552000
SRBPARM  EQU   SRB+28                                                   03553000
SRBPTCB  EQU   SRBFLC+4                                                 03554000
SRBCPAFF EQU   SRBFLC                                                   03555000
SRBFLNK  EQU   SRB+4                                                    03556000
LGVIDENT EQU   LGVT                                                     03557000
@NM00024 EQU   LGE+24                                                   03558000
@NM00023 EQU   LGE+9                                                    03559000
LGERSV5  EQU   LGEFLAG1                                                 03560000
LGERSV4  EQU   LGEFLAG1                                                 03561000
LGERSV3  EQU   LGEFLAG1                                                 03562000
LGERSV2  EQU   LGEFLAG1                                                 03563000
FRRSPARM EQU   FRRSENTR+8                                               03564000
@NM00022 EQU   FRRSFLGS+1                                               03565000
@NM00021 EQU   FRRSFLG1                                                 03566000
FRRSNEST EQU   FRRSFLG1                                                 03567000
FRRSRCUR EQU   FRRSFLG1                                                 03568000
FRRSFRRA EQU   FRRSENTR                                                 03569000
FRRSENTS EQU   FRRS+84                                                  03570000
FRRSRTMW EQU   FRRS+16                                                  03571000
FRRSCURR EQU   FRRSHEAD+12                                              03572000
FRRSELEN EQU   FRRSHEAD+8                                               03573000
FRRSLAST EQU   FRRSHEAD+4                                               03574000
FRRSEMP  EQU   FRRSHEAD                                                 03575000
CVTLEVL  EQU   CVTRELNO+2                                               03576000
CVTNUMB  EQU   CVTRELNO                                                 03577000
CVTMDL   EQU   CVTFIX+250                                               03578000
@NM00018 EQU   CVTFIX+248                                               03579000
@NM00017 EQU   CVTFIX                                                   03580000
CVTRV482 EQU   CVTXTNT2+128                                             03581000
CVTRV481 EQU   CVTXTNT2+124                                             03582000
CVTRV480 EQU   CVTXTNT2+120                                             03583000
CVTRV479 EQU   CVTXTNT2+118                                             03584000
CVTRV478 EQU   CVTXTNT2+117                                             03585000
CVTRV477 EQU   CVTXTNT2+116                                             03586000
CVTRV476 EQU   CVTXTNT2+115                                             03587000
CVTRV475 EQU   CVTXTNT2+114                                             03588000
CVTRV474 EQU   CVTRV466                                                 03589000
CVTRV473 EQU   CVTRV466                                                 03590000
CVTRV472 EQU   CVTRV466                                                 03591000
CVTRV471 EQU   CVTRV466                                                 03592000
CVTRV470 EQU   CVTRV466                                                 03593000
CVTRV469 EQU   CVTRV466                                                 03594000
CVTRV468 EQU   CVTRV466                                                 03595000
CVTRV467 EQU   CVTRV466                                                 03596000
CVTRV465 EQU   CVTRV457                                                 03597000
CVTRV464 EQU   CVTRV457                                                 03598000
CVTRV463 EQU   CVTRV457                                                 03599000
CVTRV462 EQU   CVTRV457                                                 03600000
CVTRV461 EQU   CVTRV457                                                 03601000
CVTRV460 EQU   CVTRV457                                                 03602000
CVTRV459 EQU   CVTRV457                                                 03603000
CVTRV458 EQU   CVTRV457                                                 03604000
CVTRV456 EQU   CVTXTNT2+108                                             03605000
CVTRV455 EQU   CVTXTNT2+104                                             03606000
CVTRV454 EQU   CVTXTNT2+100                                             03607000
CVTRV453 EQU   CVTXTNT2+96                                              03608000
CVTRV452 EQU   CVTXTNT2+94                                              03609000
CVTRV451 EQU   CVTXTNT2+92                                              03610000
CVTRV450 EQU   CVTXTNT2+90                                              03611000
CVTRV449 EQU   CVTXTNT2+88                                              03612000
CVTRV448 EQU   CVTXTNT2+87                                              03613000
CVTRV447 EQU   CVTXTNT2+86                                              03614000
CVTRV446 EQU   CVTRV438                                                 03615000
CVTRV445 EQU   CVTRV438                                                 03616000
CVTRV444 EQU   CVTRV438                                                 03617000
CVTRV443 EQU   CVTRV438                                                 03618000
CVTRV442 EQU   CVTRV438                                                 03619000
CVTRV441 EQU   CVTRV438                                                 03620000
CVTRV440 EQU   CVTRV438                                                 03621000
CVTRV439 EQU   CVTRV438                                                 03622000
CVTRV437 EQU   CVTRV429                                                 03623000
CVTRV436 EQU   CVTRV429                                                 03624000
CVTRV435 EQU   CVTRV429                                                 03625000
CVTRV434 EQU   CVTRV429                                                 03626000
CVTRV433 EQU   CVTRV429                                                 03627000
CVTRV432 EQU   CVTRV429                                                 03628000
CVTRV431 EQU   CVTRV429                                                 03629000
CVTRV430 EQU   CVTRV429                                                 03630000
CVTRV428 EQU   CVTXTNT2+80                                              03631000
CVTRV427 EQU   CVTXTNT2+76                                              03632000
CVTRV426 EQU   CVTXTNT2+72                                              03633000
CVTRV425 EQU   CVTXTNT2+68                                              03634000
CVTATACT EQU   CVTATCVT                                                 03635000
CVTRV423 EQU   CVTXTNT2+62                                              03636000
CVTRV422 EQU   CVTXTNT2+60                                              03637000
CVTRV421 EQU   CVTXTNT2+58                                              03638000
CVTRV420 EQU   CVTXTNT2+56                                              03639000
CVTRV419 EQU   CVTXTNT2+55                                              03640000
CVTRV418 EQU   CVTXTNT2+54                                              03641000
CVTRV417 EQU   CVTRV409                                                 03642000
CVTRV416 EQU   CVTRV409                                                 03643000
CVTRV415 EQU   CVTRV409                                                 03644000
CVTRV414 EQU   CVTRV409                                                 03645000
CVTRV413 EQU   CVTRV409                                                 03646000
CVTRV412 EQU   CVTRV409                                                 03647000
CVTRV411 EQU   CVTRV409                                                 03648000
CVTRV410 EQU   CVTRV409                                                 03649000
CVTRV408 EQU   CVTRV400                                                 03650000
CVTRV407 EQU   CVTRV400                                                 03651000
CVTRV406 EQU   CVTRV400                                                 03652000
CVTRV405 EQU   CVTRV400                                                 03653000
CVTRV404 EQU   CVTRV400                                                 03654000
CVTRV403 EQU   CVTRV400                                                 03655000
CVTRV402 EQU   CVTRV400                                                 03656000
CVTRV401 EQU   CVTRV400                                                 03657000
CVTICB   EQU   CVTXTNT2+48                                              03658000
CVTSKTA  EQU   CVTXTNT2+44                                              03659000
CVTRSV99 EQU   CVTXTNT2+40                                              03660000
CVTRSV98 EQU   CVTXTNT2+36                                              03661000
CVTRSV97 EQU   CVTXTNT2+34                                              03662000
CVTRSV96 EQU   CVTXTNT2+32                                              03663000
CVTOLTEP EQU   CVTXTNT2+28                                              03664000
CVTQIDA  EQU   CVTQID+1                                                 03665000
CVTRSV95 EQU   CVTQID                                                   03666000
CVTRSV94 EQU   CVTXTNT2+20                                              03667000
CVTRSV93 EQU   CVTXTNT2+16                                              03668000
CVTRSV92 EQU   CVTXTNT2+12                                              03669000
CVTDEBVR EQU   CVTXTNT2+8                                               03670000
CVTRSV91 EQU   CVTXTNT2+6                                               03671000
CVTRSV9H EQU   CVTFLGBT                                                 03672000
CVTRSV9G EQU   CVTFLGBT                                                 03673000
CVTRSV9F EQU   CVTFLGBT                                                 03674000
CVTRSV9E EQU   CVTFLGBT                                                 03675000
CVTRSV9D EQU   CVTFLGBT                                                 03676000
CVTRSV9C EQU   CVTFLGBT                                                 03677000
CVTVME   EQU   CVTFLGBT                                                 03678000
CVTNPE   EQU   CVTFLGBT                                                 03679000
CVTNUCLS EQU   CVTXTNT2+4                                               03680000
CVTDSSVA EQU   CVTDSSV+1                                                03681000
CVTRSV89 EQU   CVTDSSV                                                  03682000
CVTRSV88 EQU   CVTXTNT1+8                                               03683000
CVTRSV87 EQU   CVTXTNT1+4                                               03684000
CVTFACHN EQU   CVTXTNT1                                                 03685000
CVTRV488 EQU   CVTMAP+412                                               03686000
CVTRV487 EQU   CVTMAP+408                                               03687000
CVTRV486 EQU   CVTMAP+404                                               03688000
CVTRV485 EQU   CVTMAP+400                                               03689000
CVTACTAP EQU   CVTMAP+396                                               03690000
CVTAUTH  EQU   CVTMAP+392                                               03691000
CVTATMCA EQU   CVTATMCT+1                                               03692000
CVTATMST EQU   CVTATMCT                                                 03693000
CVTRSV61 EQU   CVTMAP+384                                               03694000
CVTVOLT1 EQU   CVTVOLM1+1                                               03695000
CVTVOLI1 EQU   CVTVOLF1                                                 03696000
CVTSTOA  EQU   CVTMAP+376                                               03697000
CVTRSV58 EQU   CVTMAP+374                                               03698000
CVTRSV57 EQU   CVTMAP+372                                               03699000
CVTDDCE  EQU   CVTMAP+368                                               03700000
CVTPNWFR EQU   CVTMAP+364                                               03701000
CVTSMF   EQU   CVTMAP+360                                               03702000
CVTSULK  EQU   CVTMAP+358                                               03703000
CVTSLKO  EQU   CVTSYSK                                                  03704000
CVTSLKP  EQU   CVTSYSK                                                  03705000
CVTSLKQ  EQU   CVTSYSK                                                  03706000
CVTSLKR  EQU   CVTSYSK                                                  03707000
CVTRSV56 EQU   CVTSYSK                                                  03708000
CVTRSV55 EQU   CVTSYSK                                                  03709000
CVTRSV54 EQU   CVTSYSK                                                  03710000
CVTRSV53 EQU   CVTSYSK                                                  03711000
CVTRSV52 EQU   CVTA1F1                                                  03712000
CVTRSV51 EQU   CVTA1F1                                                  03713000
CVTRSV50 EQU   CVTA1F1                                                  03714000
CVTRSV49 EQU   CVTA1F1                                                  03715000
CVTRSV48 EQU   CVTA1F1                                                  03716000
CVTRSV47 EQU   CVTA1F1                                                  03717000
CVTSRSW  EQU   CVTA1F1                                                  03718000
CVTPFSW  EQU   CVTA1F1                                                  03719000
CVTPCVT  EQU   CVTMAP+352                                               03720000
CVTRSV46 EQU   CVTMAP+344                                               03721000
CVTRSV45 EQU   CVTMAP+340                                               03722000
CVTRSV44 EQU   CVTMAP+338                                               03723000
CVTRSV43 EQU   CVTMAP+336                                               03724000
CVTHJESA EQU   CVTHJES+1                                                03725000
CVTRSV42 EQU   CVTHJES                                                  03726000
CVTEXT2A EQU   CVTEXT2+1                                                03727000
CVTRSV41 EQU   CVTEXT2                                                  03728000
CVTAPFA  EQU   CVTAPF+1                                                 03729000
CVTRSV40 EQU   CVTAPF                                                   03730000
CVTRV518 EQU   CVTINTLA                                                 03731000
CVTRV517 EQU   CVTERPV                                                  03732000
CVTEORM  EQU   CVTMAP+312                                               03733000
CVTMCHPR EQU   CVTMAP+308                                               03734000
CVTTZ    EQU   CVTMAP+304                                               03735000
CVTJEPS  EQU   CVTMAP+300                                               03736000
CVTJESCT EQU   CVTMAP+296                                               03737000
CVTMODE  EQU   CVTMAP+292                                               03738000
CVTPTRV  EQU   CVTMAP+288                                               03739000
CVTREAL  EQU   CVTMAP+284                                               03740000
CVTRSV39 EQU   CVTMAP+280                                               03741000
CVTRSV38 EQU   CVTMAP+276                                               03742000
CVTDMSRA EQU   CVTDMSR+1                                                03743000
CVTRV634 EQU   CVTDMSRF                                                 03744000
CVTRV633 EQU   CVTDMSRF                                                 03745000
CVTRV632 EQU   CVTDMSRF                                                 03746000
CVTRV631 EQU   CVTDMSRF                                                 03747000
CVTRV630 EQU   CVTDMSRF                                                 03748000
CVTRV629 EQU   CVTDMSRF                                                 03749000
CVTUDUMP EQU   CVTDMSRF                                                 03750000
CVTSDUMP EQU   CVTDMSRF                                                 03751000
CVTQMSGA EQU   CVTQMSG+1                                                03752000
CVTRSV36 EQU   CVTQMSG                                                  03753000
CVTAMFF  EQU   CVTMAP+264                                               03754000
CVTPURGA EQU   CVTPURG+1                                                03755000
CVTRSV35 EQU   CVTPURG                                                  03756000
CVTCBSP  EQU   CVTMAP+256                                               03757000
CVTATERA EQU   CVTATER+1                                                03758000
CVTSYST  EQU   CVTATER                                                  03759000
CVTVOLT2 EQU   CVTTAT                                                   03760000
CVTVOLI2 EQU   CVTVOLF2                                                 03761000
CVTAQAVB EQU   CVTAQAVT+1                                               03762000
CVTRSV34 EQU   CVTTCMFG                                                 03763000
CVTRSV33 EQU   CVTTCMFG                                                 03764000
CVTRSV32 EQU   CVTTCMFG                                                 03765000
CVTRSV31 EQU   CVTTCMFG                                                 03766000
CVTRSV30 EQU   CVTTCMFG                                                 03767000
CVTRSV29 EQU   CVTTCMFG                                                 03768000
CVTRSV28 EQU   CVTTCMFG                                                 03769000
CVTTCRDY EQU   CVTTCMFG                                                 03770000
CVTGTFA  EQU   CVTGTF+1                                                 03771000
CVTRSV27 EQU   CVTGTFST                                                 03772000
CVTRNIO  EQU   CVTGTFST                                                 03773000
CVTUSR   EQU   CVTGTFST                                                 03774000
CVTRV318 EQU   CVTFORM                                                  03775000
CVTRV317 EQU   CVTTMODE                                                 03776000
CVTRV316 EQU   CVTSTATE                                                 03777000
CVTRV315 EQU   CVTGTFS                                                  03778000
CVTGTFAV EQU   CVTGTFS                                                  03779000
CVT0SCR1 EQU   CVTMAP+232                                               03780000
CVTRV515 EQU   CVTMAP+228                                               03781000
CVTRMS   EQU   CVTMAP+224                                               03782000
CVTPATCH EQU   CVTMAP+220                                               03783000
CVTTSCE  EQU   CVTMAP+216                                               03784000
CVTLNKSC EQU   CVTMAP+214                                               03785000
CVTQABST EQU   CVTMAP+212                                               03786000
CVTMDLDS EQU   CVTMAP+208                                               03787000
CVTUSER  EQU   CVTMAP+204                                               03788000
CVTABEND EQU   CVTMAP+200                                               03789000
CVTSMCA  EQU   CVTMAP+196                                               03790000
CVTRSV18 EQU   CVTMAP+192                                               03791000
CVTQLPAQ EQU   CVTMAP+188                                               03792000
CVTQCDSR EQU   CVTMAP+184                                               03793000
CVTRSV17 EQU   CVTOPTB                                                  03794000
CVTRSV16 EQU   CVTOPTB                                                  03795000
CVTFP    EQU   CVTOPTB                                                  03796000
CVTAPTHR EQU   CVTOPTB                                                  03797000
CVTNLOG  EQU   CVTOPTB                                                  03798000
CVTTOD   EQU   CVTOPTB                                                  03799000
CVTCTIMS EQU   CVTOPTB                                                  03800000
CVTPROT  EQU   CVTOPTB                                                  03801000
CVTXPFP  EQU   CVTOPTA                                                  03802000
CVTASCII EQU   CVTOPTA                                                  03803000
CVTRSV13 EQU   CVTOPTA                                                  03804000
CVTRSV12 EQU   CVTOPTA                                                  03805000
CVTNIP   EQU   CVTOPTA                                                  03806000
CVTDDR   EQU   CVTOPTA                                                  03807000
CVTAPR   EQU   CVTOPTA                                                  03808000
CVTCCH   EQU   CVTOPTA                                                  03809000
CVTSNCTR EQU   CVTMAP+180                                               03810000
CVTQMWR  EQU   CVTMAP+176                                               03811000
CVTQOCR  EQU   CVTMAP+172                                               03812000
CVT1EF00 EQU   CVTMAP+168                                               03813000
CVTMZ00  EQU   CVTMAP+164                                               03814000
CVTHEAD  EQU   CVTMAP+160                                               03815000
CVTRSV11 EQU   CVTMAP+156                                               03816000
CVT0PT01 EQU   CVTMAP+152                                               03817000
CVTMSER  EQU   CVTMAP+148                                               03818000
CVTRV516 EQU   CVTIERLC                                                 03819000
CVTILCH  EQU   CVTMAP+140                                               03820000
CVT0DS   EQU   CVTMAP+136                                               03821000
CVTFBOSV EQU   CVTMAP+132                                               03822000
CVTNUCB  EQU   CVTMAP+128                                               03823000
CVTIXAVL EQU   CVTMAP+124                                               03824000
CVTIOQET EQU   CVTMAP+120                                               03825000
CVTDCBA  EQU   CVTMAP+117                                               03826000
CVTMVS2  EQU   CVTDCB                                                   03827000
CVT6DAT  EQU   CVTDCB                                                   03828000
CVT4MPS  EQU   CVTDCB                                                   03829000
CVTRSV09 EQU   CVTDCB                                                   03830000
CVT4MS1  EQU   CVTDCB                                                   03831000
CVT2SPS  EQU   CVTDCB                                                   03832000
CVT1SSS  EQU   CVTDCB                                                   03833000
CVTRSV08 EQU   CVTDCB                                                   03834000
CVTSTB   EQU   CVTMAP+112                                               03835000
CVTQTD00 EQU   CVTMAP+108                                               03836000
CVTQTE00 EQU   CVTMAP+104                                               03837000
CVTCUCB  EQU   CVTMAP+100                                               03838000
CVTSJQ   EQU   CVTMAP+96                                                03839000
CVTPBLDL EQU   CVTMAP+92                                                03840000
CVTTPC   EQU   CVTMAP+88                                                03841000
CVTSVDCB EQU   CVTMAP+84                                                03842000
CVTEXIT  EQU   CVTMAP+80                                                03843000
CVT0FN00 EQU   CVTMAP+76                                                03844000
CVTDARA  EQU   CVTDAR+1                                                 03845000
CVTRSV07 EQU   CVTFLGS1                                                 03846000
CVTRSV06 EQU   CVTFLGS1                                                 03847000
CVTRSV05 EQU   CVTFLGS1                                                 03848000
CVTRSV04 EQU   CVTFLGS1                                                 03849000
CVTRSV03 EQU   CVTFLGS1                                                 03850000
CVTRSV02 EQU   CVTFLGS1                                                 03851000
CVTRSV01 EQU   CVTFLGS1                                                 03852000
CVTDMPLK EQU   CVTFLGS1                                                 03853000
CVTXITP  EQU   CVTMAP+68                                                03854000
CVTZDTAB EQU   CVTMAP+64                                                03855000
CVTMSLT  EQU   CVTMAP+60                                                03856000
CVTDATE  EQU   CVTMAP+56                                                03857000
CVTBTERM EQU   CVTMAP+52                                                03858000
CVTSYSAD EQU   CVTMAP+48                                                03859000
CVTXTLER EQU   CVTMAP+44                                                03860000
CVTILK2  EQU   CVTMAP+40                                                03861000
CVTILK1  EQU   CVTMAP+36                                                03862000
CVTPRLTV EQU   CVTMAP+32                                                03863000
CVTPCNVT EQU   CVTMAP+28                                                03864000
CVT0VL00 EQU   CVTMAP+24                                                03865000
CVTXAPG  EQU   CVTMAP+20                                                03866000
CVTBUF   EQU   CVTMAP+16                                                03867000
CVTJOB   EQU   CVTMAP+12                                                03868000
CVTLINK  EQU   CVTMAP+8                                                 03869000
CVT0EF00 EQU   CVTMAP+4                                                 03870000
CVTTCBP  EQU   CVTMAP                                                   03871000
CVT      EQU   CVTMAP                                                   03872000
ATAWORD2 EQU   ATACLEAR+12                                              03873000
ATAWORD1 EQU   ATACLEAR+8                                               03874000
ATARCRF8 EQU   ATARCRSN                                                 03875000
ATARCRF7 EQU   ATARCRSN                                                 03876000
ATARCRF6 EQU   ATARCRSN                                                 03877000
ATARCRF5 EQU   ATARCRSN                                                 03878000
ATARCRF4 EQU   ATARCRSN                                                 03879000
ATARCRF3 EQU   ATARCRSN                                                 03880000
ATARCRF2 EQU   ATARCRSN                                                 03881000
ATARCRF1 EQU   ATARCRSN                                                 03882000
ATARSV2  EQU   ATARFLGS                                                 03883000
ATABADPK EQU   ATARFLGS                                                 03884000
ATASCCWP EQU   ATARFLGS                                                 03885000
ATASGNST EQU   ATARFLGS                                                 03886000
ATARSV1  EQU   ATASFLGS+1                                               03887000
ATASRT   EQU   ATASFLGS+1                                               03888000
ATASWPDR EQU   ATASFLGS+1                                               03889000
ATATRPAG EQU   ATASFLGS+1                                               03890000
ATASWAP  EQU   ATASFLGS+1                                               03891000
ATAPAGCM EQU   ATASFLGS                                                 03892000
ATAPAGIO EQU   ATASFLGS                                                 03893000
ATAPOS   EQU   ATASFLGS                                                 03894000
ATAPCOMP EQU   ATASFLGS                                                 03895000
ATAVIOCM EQU   ATASFLGS                                                 03896000
ATASCOMP EQU   ATASFLGS                                                 03897000
ATASLSQA EQU   ATASFLGS                                                 03898000
ATAQIOE  EQU   ATASFLGS                                                 03899000
ASPSLOT  EQU   ASPVLSID+1                                               03900000
ASPPRTNN EQU   ASPVLSID                                                 03901000
@NM00016 EQU   ASPLPFLG                                                 03902000
ASPLSVRP EQU   ASPLPFLG                                                 03903000
ASPLIOER EQU   ASPLPFLG                                                 03904000
ASPLOPIN EQU   ASPLPFLG                                                 03905000
ASPLSAVE EQU   ASPLPFLG                                                 03906000
ASPLVALD EQU   ASPLPFLG                                                 03907000
@NM00015 EQU   ASPEXTSN+1088                                            03908000
@NM00014 EQU   ASPEHDR+24                                               03909000
ASPASSTI EQU   ASPEHDR+22                                               03910000
@NM00013 EQU   ASPEHDR+21                                               03911000
ASPASSTN EQU   ASPEHDR+20                                               03912000
ASPEXTNM EQU   ASPEXKEY+8                                               03913000
ASPESSYM EQU   ASPEXKEY                                                 03914000
@NM00012 EQU   ASPEHDR+4                                                03915000
ASPEIDNT EQU   ASPEHDR                                                  03916000
@NM00011 EQU   ASPCT+1088                                               03917000
ASPLPMES EQU   ASPCT+64                                                 03918000
ASPASSTP EQU   ASPCT+48                                                 03919000
ASPAEXCT EQU   ASPHDR+46                                                03920000
ASPLEXCT EQU   ASPHDR+44                                                03921000
ASPSAVCT EQU   ASPHDR+40                                                03922000
@NM00010 EQU   ASPHDR+29                                                03923000
@NM00009 EQU   ASPFLAG                                                  03924000
ASPSAVRP EQU   ASPFLAG                                                  03925000
ASPSAVED EQU   ASPFLAG                                                  03926000
@NM00008 EQU   ASPBKEY+8                                                03927000
ASMCPRES EQU   ASMCPRSQ+4                                               03928000
ASMCPTAK EQU   ASMCPRSQ                                                 03929000
ASMCPCNT EQU   ASMCPAVQ+4                                               03930000
ASMCPEXT EQU   ASMPOOLS+6                                               03931000
ASMCPSIZ EQU   ASMPOOLS+4                                               03932000
ASMCPID  EQU   ASMPOOLS                                                 03933000
ASMRSV12 EQU   ASMVT+1000                                               03934000
ASMSAVE  EQU   ASMVT+928                                                03935000
ASMWKSA7 EQU   ASMVT+848                                                03936000
ASMWKSA6 EQU   ASMVT+768                                                03937000
ASMSWKPC EQU   ASMVT+328                                                03938000
ASMIOEPC EQU   ASMVT+296                                                03939000
ASMRSV10 EQU   ASMVT+280                                                03940000
ASMPVACE EQU   ASMVT+276                                                03941000
ASMPIOFR EQU   ASMVT+272                                                03942000
ASMPVACQ EQU   ASMVT+268                                                03943000
ASMPMSGS EQU   ASMVT+264                                                03944000
ASMPMSG0 EQU   ASMVT+260                                                03945000
ASMPFRLG EQU   ASMVT+256                                                03946000
ASMPCMP  EQU   ASMVT+240                                                03947000
ASMPCMPA EQU   ASMVT+236                                                03948000
ASMPCMPN EQU   ASMVT+232                                                03949000
ASMPCMPD EQU   ASMVT+228                                                03950000
ASMPSRMT EQU   ASMVT+212                                                03951000
ASMPSWPD EQU   ASMVT+208                                                03952000
ASMPTM   EQU   ASMVT+204                                                03953000
ASMPFRSW EQU   ASMVT+200                                                03954000
ASMPFRSL EQU   ASMVT+196                                                03955000
ASMPQIOE EQU   ASMVT+192                                                03956000
ASMRSV8  EQU   ASMVT+184                                                03957000
ASMTASCB EQU   ASMVT+180                                                03958000
ASMRLGWQ EQU   ASMVT+176                                                03959000
ASMRLGRQ EQU   ASMVT+172                                                03960000
ASMTMECB EQU   ASMVT+168                                                03961000
ASMTCBPT EQU   ASMVT+164                                                03962000
ASMLSAIH EQU   ASMLSAI+4                                                03963000
ASMLSAIL EQU   ASMLSAI                                                  03964000
ASMERRS  EQU   ASMVT+124                                                03965000
ASMNVSC  EQU   ASMVT+120                                                03966000
ASMVSC   EQU   ASMVT+116                                                03967000
ASMSLOTS EQU   ASMVT+112                                                03968000
ASMRSV7  EQU   ASMVT+92                                                 03969000
ASMPSRB  EQU   ASMVT+88                                                 03970000
ASMSRBCT EQU   ASMVT+84                                                 03971000
ASMIOCNT EQU   ASMVT+80                                                 03972000
ASMBURST EQU   ASMVT+76                                                 03973000
ASMPCCWN EQU   ASMVT+72                                                 03974000
ASMPCCWC EQU   ASMPCCWQ+4                                               03975000
ASMPCCWA EQU   ASMPCCWQ                                                 03976000
ASMRSV6  EQU   ASMVT+48                                                 03977000
ASMIORQC EQU   ASMVT+44                                                 03978000
ASMIORQR EQU   ASMVT+40                                                 03979000
ASMSTAGL EQU   ASMSTAGQ+4                                               03980000
ASMSTAGF EQU   ASMSTAGQ                                                 03981000
ASMRSV5  EQU   ASMVT+28                                                 03982000
ASMMSGBF EQU   ASMVT+24                                                 03983000
ASMEREC  EQU   ASMVT+20                                                 03984000
ASMTRPAG EQU   ASMVT+16                                                 03985000
ASMGOS   EQU   ASMVT+12                                                 03986000
ASMPART  EQU   ASMVT+8                                                  03987000
ASMSART  EQU   ASMVT+4                                                  03988000
ASMRSV4  EQU   ASMVT+2                                                  03989000
ASMWARM  EQU   ASMFLAG2                                                 03990000
ASMQUICK EQU   ASMFLAG2                                                 03991000
ASMNOTPT EQU   ASMFLAG2                                                 03992000
ASMNOTMR EQU   ASMFLAG2                                                 03993000
ASMCALLQ EQU   ASMFLAG2                                                 03994000
ASMPLPAS EQU   ASMFLAG1                                                 03995000
ASMCOMMF EQU   ASMFLAG1                                                 03996000
ASMPLPAF EQU   ASMFLAG1                                                 03997000
ASMNODPX EQU   ASMFLAG1                                                 03998000
ASMRSV1  EQU   ASMFLAG1                                                 03999000
ASMNOLCL EQU   ASMFLAG1                                                 04000000
ASMNOCWQ EQU   ASMFLAG1                                                 04001000
ASMDUPLX EQU   ASMFLAG1                                                 04002000
RSMFOEQ  EQU   RSMHD+36                                                 04003000
RSMLIOQL EQU   RSMLIOQ+4                                                04004000
RSMLIOQF EQU   RSMLIOQ                                                  04005000
RSMLSQAL EQU   RSMLSQA+2                                                04006000
RSMLSQAF EQU   RSMLSQA                                                  04007000
RSMLFQL  EQU   RSMLFQ+2                                                 04008000
RSMLFQF  EQU   RSMLFQ                                                   04009000
RSMRSV2  EQU   RSMHD+16                                                 04010000
RSMCNTFX EQU   RSMHD+14                                                 04011000
RSMRSV1  EQU   RSMHD+13                                                 04012000
@NM00003 EQU   RSMFLG1                                                  04013000
RSMFAIL  EQU   RSMFLG1                                                  04014000
RSMGFADD EQU   RSMFLG1                                                  04015000
RSMCPNC  EQU   RSMFLG1                                                  04016000
RSMCPNU  EQU   RSMFLG1                                                  04017000
RSMGFAD  EQU   RSMFLG1                                                  04018000
RSMIOCPC EQU   RSMFLG1                                                  04019000
RSMIOCPU EQU   RSMFLG1                                                  04020000
RSMASCB  EQU   RSMHD+8                                                  04021000
RSMSPCT  EQU   RSMHD+4                                                  04022000
RSMVSTO  EQU   RSMHD                                                    04023000
ASCBEND  EQU   ASCB+208                                                 04024000
ASCBSRBT EQU   ASCB+200                                                 04025000
ASCBSWTL EQU   ASCB+196                                                 04026000
ASCBRS14 EQU   ASCB+195                                                 04027000
ASCBSMCT EQU   ASCB+194                                                 04028000
ASCBRS12 EQU   ASCB+192                                                 04029000
ASCBPCTT EQU   ASCB+188                                                 04030000
ASCBVGTT EQU   ASCB+184                                                 04031000
ASCBRV43 EQU   ASCBSRQ4                                                 04032000
ASCBRV42 EQU   ASCBSRQ4                                                 04033000
ASCBRV41 EQU   ASCBSRQ4                                                 04034000
ASCBRV40 EQU   ASCBSRQ4                                                 04035000
ASCBRV39 EQU   ASCBSRQ4                                                 04036000
ASCBRV38 EQU   ASCBSRQ4                                                 04037000
ASCBRV37 EQU   ASCBSRQ4                                                 04038000
ASCBRV36 EQU   ASCBSRQ4                                                 04039000
ASCBRV35 EQU   ASCBSRQ3                                                 04040000
ASCBRV34 EQU   ASCBSRQ3                                                 04041000
ASCBRV33 EQU   ASCBSRQ3                                                 04042000
ASCBRV32 EQU   ASCBSRQ3                                                 04043000
ASCBRV31 EQU   ASCBSRQ3                                                 04044000
ASCBRV30 EQU   ASCBSRQ3                                                 04045000
ASCBRV29 EQU   ASCBSRQ3                                                 04046000
ASCBRV28 EQU   ASCBSRQ3                                                 04047000
ASCBRV27 EQU   ASCBSRQ2                                                 04048000
ASCBRV26 EQU   ASCBSRQ2                                                 04049000
ASCBRV25 EQU   ASCBSRQ2                                                 04050000
ASCBRV24 EQU   ASCBSRQ2                                                 04051000
ASCBRV23 EQU   ASCBSRQ2                                                 04052000
ASCBRV22 EQU   ASCBSRQ2                                                 04053000
ASCBRV21 EQU   ASCBSRQ2                                                 04054000
ASCBRV20 EQU   ASCBSRQ2                                                 04055000
ASCBRV19 EQU   ASCBSRQ1                                                 04056000
ASCBRV18 EQU   ASCBSRQ1                                                 04057000
ASCBRV17 EQU   ASCBSRQ1                                                 04058000
ASCBRV16 EQU   ASCBSRQ1                                                 04059000
ASCBRV15 EQU   ASCBSRQ1                                                 04060000
ASCBRV14 EQU   ASCBSRQ1                                                 04061000
ASCBRV13 EQU   ASCBSRQ1                                                 04062000
ASCBSTA  EQU   ASCBSRQ1                                                 04063000
ASCBJBNS EQU   ASCB+176                                                 04064000
ASCBJBNI EQU   ASCB+172                                                 04065000
ASCBMCC  EQU   ASCB+168                                                 04066000
ASCBRTWA EQU   ASCB+164                                                 04067000
ASCBIQEA EQU   ASCB+160                                                 04068000
ASCBXMPQ EQU   ASCB+156                                                 04069000
ASCBRS01 EQU   ASCB+154                                                 04070000
ASCBFMCT EQU   ASCB+152                                                 04071000
ASCBOUXB EQU   ASCB+148                                                 04072000
ASCBOUCB EQU   ASCB+144                                                 04073000
ASCBMECB EQU   ASCB+140                                                 04074000
ASCBQECB EQU   ASCB+136                                                 04075000
ASCBLSQH EQU   ASCBLKGP+4                                               04076000
ASCBLOCK EQU   ASCBLKGP                                                 04077000
ASCBTCBS EQU   ASCB+124                                                 04078000
ASCBNVSC EQU   ASCB+122                                                 04079000
ASCBSRBS EQU   ASCB+118                                                 04080000
ASCBSSRB EQU   ASCB+116                                                 04081000
ASCBRV06 EQU   ASCBFLG2                                                 04082000
ASCBRV05 EQU   ASCBFLG2                                                 04083000
ASCBRV04 EQU   ASCBFLG2                                                 04084000
ASCBSNQS EQU   ASCBFLG2                                                 04085000
ASCBS2S  EQU   ASCBFLG2                                                 04086000
ASCBCEXT EQU   ASCBFLG2                                                 04087000
ASCBPXMT EQU   ASCBFLG2                                                 04088000
ASCBXMPT EQU   ASCBFLG2                                                 04089000
ASCBRF07 EQU   ASCBDSP1                                                 04090000
ASCBRF06 EQU   ASCBDSP1                                                 04091000
ASCBRF05 EQU   ASCBDSP1                                                 04092000
ASCBRF04 EQU   ASCBDSP1                                                 04093000
ASCBRF03 EQU   ASCBDSP1                                                 04094000
ASCBRF02 EQU   ASCBDSP1                                                 04095000
ASCBFAIL EQU   ASCBDSP1                                                 04096000
ASCBNOQ  EQU   ASCBDSP1                                                 04097000
ASCBSWCT EQU   ASCB+112                                                 04098000
ASCBASXB EQU   ASCB+108                                                 04099000
ASCBTMCH EQU   ASCB+104                                                 04100000
ASCBNSWP EQU   ASCBFLG1                                                 04101000
ASCBTYP1 EQU   ASCBFLG1                                                 04102000
ASCBSTND EQU   ASCBFLG1                                                 04103000
ASCBABNT EQU   ASCBFLG1                                                 04104000
ASCBTERM EQU   ASCBFLG1                                                 04105000
ASCBS3S  EQU   ASCBFLG1                                                 04106000
ASCBCMSH EQU   ASCBFLG1                                                 04107000
ASCBTOFF EQU   ASCBFLG1                                                 04108000
ASCBRF01 EQU   ASCBRCTF                                                 04109000
ASCBTMLW EQU   ASCBRCTF                                                 04110000
ASCBOUT  EQU   ASCBRCTF                                                 04111000
ASCBWAIT EQU   ASCBRCTF                                                 04112000
ASCBRV08 EQU   ASCBRCTF                                                 04113000
ASCBFQU  EQU   ASCBRCTF                                                 04114000
ASCBFRS  EQU   ASCBRCTF                                                 04115000
ASCBTMNO EQU   ASCBRCTF                                                 04116000
ASCBAFFN EQU   ASCBFW1                                                  04117000
ASCBDUMP EQU   ASCB+96                                                  04118000
ASCBRV44 EQU   ASCB+92                                                  04119000
ASCBUBET EQU   ASCB+88                                                  04120000
ASCBECB  EQU   ASCB+84                                                  04121000
ASCBJSTL EQU   ASCB+80                                                  04122000
ASCBEWST EQU   ASCB+72                                                  04123000
ASCBEJST EQU   ASCB+64                                                  04124000
ASCBTSB  EQU   ASCB+60                                                  04125000
ASCBCSCB EQU   ASCB+56                                                  04126000
ASCBLDA  EQU   ASCB+48                                                  04127000
ASCBSTOR EQU   ASCB+44                                                  04128000
ASCBDP   EQU   ASCB+43                                                  04129000
ASCBRV07 EQU   ASCB+42                                                  04130000
ASCBIOSM EQU   ASCB+40                                                  04131000
ASCBSEQN EQU   ASCB+38                                                  04132000
ASCBCPUS EQU   ASCB+32                                                  04133000
ASCBSPL  EQU   ASCB+28                                                  04134000
ASCBIOSP EQU   ASCB+24                                                  04135000
ASCBSYNC EQU   ASCBSUPC+4                                               04136000
ASCBSVRB EQU   ASCBSUPC                                                 04137000
ASCBCMSF EQU   ASCB+12                                                  04138000
ASCBBWDP EQU   ASCB+8                                                   04139000
ASCBFWDP EQU   ASCB+4                                                   04140000
ASCBASCB EQU   ASCB                                                     04141000
ASCBEGIN EQU   ASCB                                                     04142000
@NM00002 EQU   ACE+40                                                   04143000
ACESRBWK EQU   ACE+36                                                   04144000
ACEAIAPT EQU   ACESYM+4                                                 04145000
ACEVLSID EQU   ACESRCID+1                                               04146000
@NM00001 EQU   ACESRCID                                                 04147000
ACETLPME EQU   ACERPN                                                   04148000
ACERSV10 EQU   ACEFLG3                                                  04149000
ACERSV9  EQU   ACEFLG3                                                  04150000
ACERSV8  EQU   ACEFLG3                                                  04151000
ACELPMEC EQU   ACEFLG3                                                  04152000
ACERSV7  EQU   ACEFLG3                                                  04153000
ACERSV6  EQU   ACEFLG3                                                  04154000
ACEPRINO EQU   ACEFLG3                                                  04155000
ACEFLG2  EQU   ACE+10                                                   04156000
ACERSV5  EQU   ACEFLG1                                                  04157000
ACERSV4  EQU   ACEFLG1                                                  04158000
ACERSV3  EQU   ACEFLG1                                                  04159000
ACERSV2  EQU   ACEFLG1                                                  04160000
ACENOACT EQU   ACEFLG1                                                  04161000
ACEOVRID EQU   ACEFLG1                                                  04162000
ACETRPWT EQU   ACEFLG1                                                  04163000
ACATORPN EQU   ACATOLP+4                                                04164000
ACAAIAP  EQU   ACARPN                                                   04165000
ACAFLSID EQU   ACALGID                                                  04166000
ACARSV4  EQU   ACA+4                                                    04167000
ACARSV3  EQU   ACAFLG1                                                  04168000
ACARSV2  EQU   ACAFLG1                                                  04169000
ACARSV1  EQU   ACAFLG1                                                  04170000
ACAFSPL  EQU   ACAFLG1                                                  04171000
ACAFFIX  EQU   ACAFLG1                                                  04172000
ACARSV5  EQU   ACAFLG1                                                  04173000
ACAFMEM  EQU   ACAFLG1                                                  04174000
@NM00048 EQU   PSA+3668                                                 04175000
PSASTAK  EQU   PSA+3072                                                 04176000
@NM00047 EQU   PSA+1048                                                 04177000
PSAUSEND EQU   PSA+1048                                                 04178000
PSARV062 EQU   PSA+1044                                                 04179000
PSACDAL  EQU   PSA+1040                                                 04180000
PSAWTCOD EQU   PSA+1036                                                 04181000
PSAATCVT EQU   PSA+1032                                                 04182000
PSAPCPSW EQU   PSA+1024                                                 04183000
PSAPIR2  EQU   PSA+1020                                                 04184000
PSARV059 EQU   PSA+1018                                                 04185000
PSASVC13 EQU   PSA+1016                                                 04186000
PSALSFCC EQU   PSA+1012                                                 04187000
PSASFACC EQU   PSA+1008                                                 04188000
PSASTOP  EQU   PSA+992                                                  04189000
PSASTART EQU   PSA+976                                                  04190000
PSARSPSW EQU   PSA+968                                                  04191000
PSASRPSW EQU   PSA+960                                                  04192000
PSARV045 EQU   PSA+892                                                  04193000
PSARV044 EQU   PSA+888                                                  04194000
PSARV043 EQU   PSA+884                                                  04195000
PSARV042 EQU   PSA+880                                                  04196000
PSARV041 EQU   PSA+876                                                  04197000
PSARV040 EQU   PSA+872                                                  04198000
PSARV025 EQU   PSA+868                                                  04199000
PSADSSED EQU   PSA+868                                                  04200000
PSADSSPR EQU   PSA+864                                                  04201000
PSADSSFW EQU   PSA+860                                                  04202000
PSADSS14 EQU   PSA+856                                                  04203000
PSADSSPP EQU   PSA+848                                                  04204000
PSADSSRP EQU   PSA+840                                                  04205000
PSADSS05 EQU   PSADSSF4                                                 04206000
PSADSS10 EQU   PSADSSF4                                                 04207000
PSADSSVE EQU   PSADSSF4                                                 04208000
PSADSSDE EQU   PSADSSF4                                                 04209000
PSADSSC0 EQU   PSADSSF4                                                 04210000
PSADSSIE EQU   PSADSSF4                                                 04211000
PSADSS12 EQU   PSADSSF4                                                 04212000
PSADSSRC EQU   PSADSSF4                                                 04213000
PSARV057 EQU   PSADSSF3                                                 04214000
PSARV056 EQU   PSADSSF3                                                 04215000
PSARV055 EQU   PSADSSF3                                                 04216000
PSADSSMC EQU   PSADSSF3                                                 04217000
PSADSSRW EQU   PSADSSF3                                                 04218000
PSADSSNM EQU   PSADSSF3                                                 04219000
PSADSSES EQU   PSADSSF3                                                 04220000
PSADSSGP EQU   PSADSSF3                                                 04221000
PSADSSF2 EQU   PSADSSFL+1                                               04222000
PSADSSPI EQU   PSADSSF1                                                 04223000
PSADSSOI EQU   PSADSSF1                                                 04224000
PSADSSSP EQU   PSADSSF1                                                 04225000
PSADSSTP EQU   PSADSSF1                                                 04226000
PSADSSDW EQU   PSADSSF1                                                 04227000
PSADSSDD EQU   PSADSSF1                                                 04228000
PSADSSDM EQU   PSADSSF1                                                 04229000
PSADSSMV EQU   PSADSSF1                                                 04230000
PSADSSTS EQU   PSA+816                                                  04231000
PSADSSWK EQU   PSA+812                                                  04232000
PSADSSR3 EQU   PSA+808                                                  04233000
PSADSSR2 EQU   PSA+804                                                  04234000
PSADSSRS EQU   PSA+800                                                  04235000
PSASTOR  EQU   PSA+796                                                  04236000
PSACPUSA EQU   PSA+794                                                  04237000
PSAVSTAP EQU   PSA+792                                                  04238000
PSAWKVAP EQU   PSA+788                                                  04239000
PSAWKRAP EQU   PSA+784                                                  04240000
PSAMCHIC EQU   PSA+783                                                  04241000
PSARV061 EQU   PSA+782                                                  04242000
PSASYMSK EQU   PSA+781                                                  04243000
PSAMCHFL EQU   PSA+780                                                  04244000
PSACR0   EQU   PSA+776                                                  04245000
PSAPSWSV EQU   PSA+768                                                  04246000
PSALITA  EQU   PSA+764                                                  04247000
PSACLHS  EQU   PSAHLHI                                                  04248000
PSALKR15 EQU   PSALKSA+60                                               04249000
PSALKR14 EQU   PSALKSA+56                                               04250000
PSALKR13 EQU   PSALKSA+52                                               04251000
PSALKR12 EQU   PSALKSA+48                                               04252000
PSALKR11 EQU   PSALKSA+44                                               04253000
PSALKR10 EQU   PSALKSA+40                                               04254000
PSALKR9  EQU   PSALKSA+36                                               04255000
PSALKR8  EQU   PSALKSA+32                                               04256000
PSALKR7  EQU   PSALKSA+28                                               04257000
PSALKR6  EQU   PSALKSA+24                                               04258000
PSALKR5  EQU   PSALKSA+20                                               04259000
PSALKR4  EQU   PSALKSA+16                                               04260000
PSALKR3  EQU   PSALKSA+12                                               04261000
PSALKR2  EQU   PSALKSA+8                                                04262000
PSALKR1  EQU   PSALKSA+4                                                04263000
PSALKR0  EQU   PSALKSA                                                  04264000
PSARV023 EQU   PSACLHT+52                                               04265000
PSALOCAL EQU   PSACLHT+48                                               04266000
PSACMSL  EQU   PSACLHT+44                                               04267000
PSAOPTL  EQU   PSACLHT+40                                               04268000
PSATPACL EQU   PSACLHT+36                                               04269000
PSATPDNL EQU   PSACLHT+32                                               04270000
PSATPNCL EQU   PSACLHT+28                                               04271000
PSAIOSLL EQU   PSACLHT+24                                               04272000
PSAIOSUL EQU   PSACLHT+20                                               04273000
PSAIOSCL EQU   PSACLHT+16                                               04274000
PSAIOSSL EQU   PSACLHT+12                                               04275000
PSASALCL EQU   PSACLHT+8                                                04276000
PSAASML  EQU   PSACLHT+4                                                04277000
PSADISPL EQU   PSACLHT                                                  04278000
PSASRSA  EQU   PSA+636                                                  04279000
PSARV050 EQU   PSA+634                                                  04280000
PSADSSGO EQU   PSA+633                                                  04281000
PSARECUR EQU   PSA+632                                                  04282000
PSAHLHIS EQU   PSA+628                                                  04283000
PSAIPCSA EQU   PSA+624                                                  04284000
@NM00046 EQU   PSA+621                                                  04285000
PSAIPCDM EQU   PSA+620                                                  04286000
PSAIPCD  EQU   PSA+616                                                  04287000
@NM00045 EQU   PSA+613                                                  04288000
PSAIPCRM EQU   PSA+612                                                  04289000
PSAIPCR  EQU   PSA+608                                                  04290000
PSAMCHEX EQU   PSA+600                                                  04291000
PSAMPSW  EQU   PSA+592                                                  04292000
PSAEXPS2 EQU   PSA+584                                                  04293000
PSAEXPS1 EQU   PSA+576                                                  04294000
PSAPIREG EQU   PSA+572                                                  04295000
PSARSREG EQU   PSA+568                                                  04296000
PSAGPREG EQU   PSA+556                                                  04297000
PSARV022 EQU   PSASUP4                                                  04298000
PSARV021 EQU   PSASUP4                                                  04299000
PSARV020 EQU   PSASUP4                                                  04300000
PSARV019 EQU   PSASUP4                                                  04301000
PSARV018 EQU   PSASUP4                                                  04302000
PSARV017 EQU   PSASUP4                                                  04303000
PSARV016 EQU   PSASUP4                                                  04304000
PSARV015 EQU   PSASUP4                                                  04305000
PSARV014 EQU   PSASUP3                                                  04306000
PSARV013 EQU   PSASUP3                                                  04307000
PSARV012 EQU   PSASUP3                                                  04308000
PSAESTA  EQU   PSASUP3                                                  04309000
PSASPR   EQU   PSASUP3                                                  04310000
PSAPSREG EQU   PSASUP3                                                  04311000
PSAPI2   EQU   PSASUP3                                                  04312000
PSAIOSUP EQU   PSASUP3                                                  04313000
PSALCR   EQU   PSASUP2                                                  04314000
PSARTM   EQU   PSASUP2                                                  04315000
PSAACR   EQU   PSASUP2                                                  04316000
PSAIPCE2 EQU   PSASUP2                                                  04317000
PSAIPCES EQU   PSASUP2                                                  04318000
PSAIPCEC EQU   PSASUP2                                                  04319000
PSAGTF   EQU   PSASUP2                                                  04320000
PSAIPCRI EQU   PSASUP2                                                  04321000
PSATYPE6 EQU   PSASUP1                                                  04322000
PSATCTL  EQU   PSASUP1                                                  04323000
PSADISP  EQU   PSASUP1                                                  04324000
PSALOCK  EQU   PSASUP1                                                  04325000
PSAPI    EQU   PSASUP1                                                  04326000
PSAEXT   EQU   PSASUP1                                                  04327000
PSASVC   EQU   PSASUP1                                                  04328000
PSAIO    EQU   PSASUP1                                                  04329000
PSAANEW  EQU   PSA+544                                                  04330000
PSATNEW  EQU   PSA+536                                                  04331000
PSALCCAR EQU   PSA+532                                                  04332000
PSALCCAV EQU   PSA+528                                                  04333000
PSAPCCAR EQU   PSA+524                                                  04334000
PSAPCCAV EQU   PSA+520                                                  04335000
PSACPULA EQU   PSA+518                                                  04336000
PSACPUPA EQU   PSA+516                                                  04337000
PSAPSA   EQU   PSA+512                                                  04338000
FLCHDEND EQU   PSA+512                                                  04339000
FLCCRSAV EQU   FLCMCLA+280                                              04340000
FLCGRSAV EQU   FLCMCLA+216                                              04341000
FLCFPSAV EQU   FLCMCLA+184                                              04342000
FLCFLA   EQU   FLCMCLA+88                                               04343000
FLCRGNCD EQU   FLCMCLA+84                                               04344000
FLCFSAA  EQU   FLCFSA+1                                                 04345000
@NM00044 EQU   FLCFSA                                                   04346000
@NM00043 EQU   FLCMCLA+72                                               04347000
FLCMCIC  EQU   FLCMCLA+64                                               04348000
@NM00042 EQU   FLCMCLA+20                                               04349000
FLCIOAA  EQU   FLCIOA+1                                                 04350000
@NM00041 EQU   FLCIOA                                                   04351000
@NM00040 EQU   FLCMCLA+15                                               04352000
@NM00039 EQU   FLCMCLA+14                                               04353000
@NM00038 EQU   FLCMCLA+12                                               04354000
FLCLCL   EQU   FLCMCLA+8                                                04355000
FLCIOELA EQU   FLCIOEL+1                                                04356000
@NM00037 EQU   FLCIOEL                                                  04357000
FLCCHNID EQU   FLCMCLA                                                  04358000
@NM00036 EQU   PSA+160                                                  04359000
FLCMTRCD EQU   PSA+157                                                  04360000
@NM00035 EQU   PSA+156                                                  04361000
FLCPERA  EQU   FLCPER+1                                                 04362000
@NM00034 EQU   FLCPER                                                   04363000
@NM00033 EQU   PSA+151                                                  04364000
FLCPERCD EQU   PSA+150                                                  04365000
FLCMCNUM EQU   PSA+149                                                  04366000
@NM00032 EQU   PSA+148                                                  04367000
FLCTEAA  EQU   FLCTEA+1                                                 04368000
@NM00031 EQU   FLCTEA                                                   04369000
PSAPIPC  EQU   PSAPICOD                                                 04370000
PSAPIMC  EQU   PSAPICOD                                                 04371000
PSAPIPER EQU   PSAPICOD                                                 04372000
PSARV049 EQU   FLCPICOD                                                 04373000
FLCPILCB EQU   FLCPIILC                                                 04374000
@NM00030 EQU   FLCPIILC                                                 04375000
@NM00029 EQU   PSAEPPSW                                                 04376000
FLCSVCN  EQU   PSAESPSW+2                                               04377000
FLCSILCB EQU   FLCSVILC                                                 04378000
@NM00028 EQU   FLCSVILC                                                 04379000
@NM00027 EQU   PSAESPSW                                                 04380000
FLCEICOD EQU   PSAEEPSW+2                                               04381000
PSASPAD  EQU   PSAEEPSW                                                 04382000
@NM00026 EQU   PSA+128                                                  04383000
FLCINPSW EQU   PSA+120                                                  04384000
FLCMNPSW EQU   PSA+112                                                  04385000
FLCPNPSW EQU   PSA+104                                                  04386000
FLCSNPSW EQU   PSA+96                                                   04387000
FLCENPSW EQU   PSA+88                                                   04388000
FLCTRACE EQU   PSA+84                                                   04389000
FLCTIMER EQU   PSA+80                                                   04390000
FLCCVT2  EQU   PSA+76                                                   04391000
FLCCAW   EQU   PSA+72                                                   04392000
FLCCSW   EQU   PSA+64                                                   04393000
FLCIOPSW EQU   PSA+56                                                   04394000
FLCMOPSW EQU   PSA+48                                                   04395000
FLCPOPSW EQU   PSA+40                                                   04396000
FLCSOPSW EQU   PSA+32                                                   04397000
FLCEOPSW EQU   PSA+24                                                   04398000
@NM00025 EQU   FLCICCW2+4                                               04399000
FLCICCW1 EQU   FLCROPSW                                                 04400000
FLCIPPSW EQU   FLCRNPSW                                                 04401000
*                                      END UNREFERENCED COMPONENTS      04402000
@RC00127 EQU   @RC00124                                                 04403000
@RF00208 EQU   @RC00205                                                 04404000
@RC00247 EQU   @RC00201                                                 04405000
@RF00290 EQU   @RC00285                                                 04406000
@RF00285 EQU   FREEACE                                                  04407000
@RF00302 EQU   @RC00296                                                 04408000
@RC00428 EQU   @RC00426                                                 04409000
@RC00509 EQU   @EL00001                                                 04410000
GOSEND   EQU   @EL00001                                                 04411000
@RC00134 EQU   @RC00127                                                 04412000
@RC00255 EQU   @RC00247                                                 04413000
@RF00260 EQU   @RC00247                                                 04414000
@RC00145 EQU   @RC00134                                                 04415000
@ENDDATA EQU   *                                                        04416000
         END   ILRGOS,(C'PLS1220',0701,76087)                           04417000
