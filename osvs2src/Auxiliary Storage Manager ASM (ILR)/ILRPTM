         TITLE 'ILRPTM, ASM PART MONITOR                               *00001000
                        '                                               00002000
ILRPTM   CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ILRPTM    76.114'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @10,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@10                                         0001 00012000
*                                                                  0088 00013000
*/********************************************************************/ 00014000
*/*                                                                  */ 00015000
*/* ILRPTM: DECIDES WHEN TO SLOT SORT PAGES FOR A PAGING DATA SET    */ 00016000
*/*                                                                  */ 00017000
*/* INPUT:    SEE MODULE PROLOGUE                                    */ 00018000
*/*                                                                  */ 00019000
*/* PROCESS:  ILRPTM CHECKS EACH DATA SET (REPRESENTED BY A PART     */ 00020000
*/*           ENTRY) FOR A NON-ZERO READ OR WRITE QUEUE.  IF THERE   */ 00021000
*/*           IS WORK FOR THAT DATA SET AND AN IORB IS FREE, THE     */ 00022000
*/*           PART ENTRY IS LOCKED AND SLOT SORT IS CALLED TO GET    */ 00023000
*/*           I/O STARTED.                                           */ 00024000
*/*                                                                  */ 00025000
*/*            NOTE:  THE 'CPU ID' IS INITIALIZED TO ZERO BY ASM'S   */ 00026000
*/*            RIM .  'CPU ID' ID IS A COUNTER USED TO IDENTIFY      */ 00027000
*/*            A SPECIFIC SRB.                                       */ 00028000
*/*                                                                  */ 00029000
*/*  OUTPUT:  NONE                                                   */ 00030000
*/*                                                                  */ 00031000
*/********************************************************************/ 00032000
*                                                                  0088 00033000
*   /*****************************************************************/ 00034000
*   /*                                                               */ 00035000
*   /* RESET COUNT OF PTMS SCHEDULED- SPECIFICALLY DONE HERE FOR     */ 00036000
*   /* RECOVERY                                                      */ 00037000
*   /*                                                               */ 00038000
*   /*****************************************************************/ 00039000
*                                                                  0088 00040000
*   ASMVTPTR=CVTASMVT;              /* SET ASMVT BASE                */ 00041000
         L     @12,CVTPTR                                          0088 00042000
         L     ASMVTPTR,CVTASMVT(,@12)                             0088 00043000
*   RFY                                                            0089 00044000
*    (R6,                                                          0089 00045000
*     R7) RSTD;                                                    0089 00046000
*   R7=ASMSRBCT;                    /* GET CURRENT SRB COUNT         */ 00047000
         L     R7,ASMSRBCT(,ASMVTPTR)                              0090 00048000
*   R6=0;                           /* RESET VALUE                   */ 00049000
         SLR   R6,R6                                               0091 00050000
*RETRYP1:                                                          0092 00051000
*   CS(R7,R6,ASMSRBCT);             /* REPLACE WITH 0                */ 00052000
RETRYP1  CS    R7,@06,ASMSRBCT(ASMVTPTR)                           0092 00053000
*   BC(NE,RETRYP1);                                                0093 00054000
         BC    7,RETRYP1                                           0093 00055000
*   RFY                                                            0094 00056000
*    (R6,                                                          0094 00057000
*     R7) UNRSTD;                                                  0094 00058000
*                                                                  0094 00059000
*   /*****************************************************************/ 00060000
*   /*                                                               */ 00061000
*   /* ESTABLISH RECOVERY ENVIRONMENT                                */ 00062000
*   /*                                                               */ 00063000
*   /*****************************************************************/ 00064000
*                                                                  0095 00065000
*   RFY                                                            0095 00066000
*    (R1,                                                          0095 00067000
*     R4,                                                          0095 00068000
*     R6,                                                          0095 00069000
*     R7) RSTD;                                                    0095 00070000
*   R1=ADDR(ILRSRT01);              /* GET RECOVERY RTN ADDRESS      */ 00071000
         L     R1,@CV01756                                         0096 00072000
*PTMARCV1:                                                         0097 00073000
*   GEN REFS(R1,R4,R6,R7,PSACSTK,FRRSCURR,FRRSLAST,FRRS,FRRSENTR,  0097 00074000
*       FRRSPARM,PSALSFCC,FRRSELEN,FRRSFRRA);                      0097 00075000
PTMARCV1 DS    0H                                                  0097 00076000
         SETFRR A,FRRAD=(R1),PARMAD=(R4),WRKREGS=(R6,R7),              *00077000
               RELATED=(PAGE,ILRPTM(PTMDRCV1))                          00078000
*   RFY                                                            0098 00079000
*    (R1,                                                          0098 00080000
*     R6,                                                          0098 00081000
*     R7) UNRSTD;                                                  0098 00082000
*   ATAMODID=ATAMPTM;               /* TELL RECOVERY WHO WE ARE      */ 00083000
         MVI   ATAMODID(ATAPTR),X'07'                              0099 00084000
*   R9=WSACASMS;                    /* SET ADDRESSABILITY TO WORKAREA*/ 00085000
         L     @12,LCCAPTR                                         0100 00086000
         L     @12,LCCACPUS(,@12)                                  0100 00087000
         L     R9,WSACASMS(,@12)                                   0100 00088000
*   GEN REFS(R9)(USING @DATD,R9);                                  0101 00089000
         USING @DATD,R9                                                 00090000
*   ZEROWORK=''B;                   /* ZERO ENTIRE PTM WORKAREA      */ 00091000
         XC    ZEROWORK(256,R9),ZEROWORK(R9)                       0102 00092000
*   ATAWORKA=R9;                    /* LET RECOVERY KNOW WHERE ITS AT*/ 00093000
         ST    R9,ATAWORKA(,ATAPTR)                                0103 00094000
*   ATAEPATH=ADDR(EPATH);           /* SET EPATH ADDRESS IN ATA      */ 00095000
         LA    @12,EPATH                                           0104 00096000
         ST    @12,ATAEPATH(,ATAPTR)                               0104 00097000
*   EPAPARM=ADDR(PARMLIST);         /* SET ADDR OF PTM/SRT PLIST FOR    00098000
*                                      RECOVERY                      */ 00099000
         LA    @12,PARMLIST                                        0105 00100000
         ST    @12,EPAPARM                                         0105 00101000
*   SRTWORK=R9+LENGTH(ZEROWORK);    /* SAVE ADDRESS OF SRT WORKAREA     00102000
*                                      IN PLIST                      */ 00103000
*                                                                  0106 00104000
         LA    @12,256                                             0106 00105000
         ALR   @12,R9                                              0106 00106000
         ST    @12,SRTWORK                                         0106 00107000
*   /*****************************************************************/ 00108000
*   /*                                                               */ 00109000
*   /* FRR ESTABLISHED, BOTH WORKAREAS ADDRESSED, ATA + EPATH + PLIST*/ 00110000
*   /* PRELIMINARY INITIALIZATION DONE- CAN START MAIN LINE PROCESS  */ 00111000
*   /*                                                               */ 00112000
*   /*****************************************************************/ 00113000
*                                                                  0107 00114000
*   PARTPTR=ASMPART;                /* SET PART BASE                 */ 00115000
         L     @12,ASMPART(,ASMVTPTR)                              0107 00116000
         ST    @12,PARTPTR                                         0107 00117000
*   RFY                                                            0108 00118000
*    (R0,                                                          0108 00119000
*     R1) RSTD;                                                    0108 00120000
*   R1=PARTLKUP;                    /* GET IN PROCESS FLAG AND CPU CT*/ 00121000
         L     R1,PARTLKUP(,@12)                                   0109 00122000
*RETRYP2:                                                          0110 00123000
*   R0=R1+ONE;                      /* UP CPU CT BY 1                */ 00124000
RETRYP2  LA    R0,1                                                0110 00125000
         ALR   R0,R1                                               0110 00126000
*   CS(R1,R0,PARTLKUP);             /* REPLACE VIA CS                */ 00127000
         L     @12,PARTPTR                                         0111 00128000
         CS    R1,@00,PARTLKUP(@12)                                0111 00129000
*   BC(NE,RETRYP2);                                                0112 00130000
         BC    7,RETRYP2                                           0112 00131000
*   EPACPUID=R0;                    /* SAVE FOR RECOVERY             */ 00132000
         STH   R0,EPACPUID                                         0113 00133000
*   RFY                                                            0114 00134000
*    (R0,                                                          0114 00135000
*     R1) UNRSTD;                                                  0114 00136000
*                                                                  0115 00137000
*   /*****************************************************************/ 00138000
*   /*                                                               */ 00139000
*   /* SET UP FOR LOOP THRU PARTES. LASTPARE IS ALREADY INIT TO ZERO */ 00140000
*   /* TO STOP PLPA/COMM/DPLX PARTE LOOP. QPARE ALREADY INIT TO PLPAQ*/ 00141000
*   /* (0) TO INDICATE PROCESSING PLPA/COMM/DPLX Q                   */ 00142000
*   /*                                                               */ 00143000
*   /*****************************************************************/ 00144000
*                                                                  0115 00145000
*   PAREPTR=ADDR(PARTENTS(PARTPLPN+1));/* PICK UP PTR TO PLPA PARTE  */ 00146000
*                                                                  0115 00147000
         L     @12,PARTPTR                                         0115 00148000
         LA    @12,PARTENTS(,@12)                                  0115 00149000
         ST    @12,PAREPTR                                         0115 00150000
*   /*****************************************************************/ 00151000
*   /*                                                               */ 00152000
*   /* PROCESS THE THREE QUEUES OF PART ENTRIES: PLPA, COMMON, AND   */ 00153000
*   /* DUPLEX QUEUE (A STRAIGHT QUEUE- LAST CHAIN FIELD = ZERO) THEN */ 00154000
*   /* THE FIXED HEAD AND THEN THE MOVABLE HEAD DEVICE QUEUES (BOTH  */ 00155000
*   /* ARE CIRCULAR QUEUES WITH A MOVABLE ANCHOR ALWAYS SET TO FIRST */ 00156000
*   /* PARTE IN CIRCLE FOR WHICH WE HAD NO WRITES FOR EACH CALL OF   */ 00157000
*   /* PART MONITOR. THIS WILL BE THE STARTING POINT NEXT TIME THRU  */ 00158000
*   /* TO MORE EVENLY DISTRIBUTE WRITES.)                            */ 00159000
*   /*                                                               */ 00160000
*   /*****************************************************************/ 00161000
*                                                                  0116 00162000
*   DO UNTIL QPARE=DONE;            /* PROCESS PARTE QUEUES          */ 00163000
*                                                                  0116 00164000
@DL00116 DS    0H                                                  0117 00165000
*     /***************************************************************/ 00166000
*     /*                                                             */ 00167000
*     /* LOOP THROUGH ALL PARTES FOR THIS PARTE QUEUE. CALL SLOTSORT */ 00168000
*     /* TO PROCESS PAGE REQUESTS FOR EACH PARTE                     */ 00169000
*     /*                                                             */ 00170000
*     /***************************************************************/ 00171000
*                                                                  0117 00172000
*     DO UNTIL PAREPTR=LASTPARE;    /* PROCESS ALL PARTES THIS QUEUE */ 00173000
@DL00117 DS    0H                                                  0118 00174000
*       CURQ=PAREWTQE;              /* GET THIS PARTES WRITE Q PTR   */ 00175000
         L     @12,PAREPTR                                         0118 00176000
         L     @12,PAREWTQE(,@12)                                  0118 00177000
         ST    @12,CURQ                                            0118 00178000
*       CALL GETWRTQ;               /* REMOVE WRITES & PLACE IN    0119 00179000
*                                      PARMLIST                      */ 00180000
         BAL   @14,GETWRTQ                                         0119 00181000
*       IF WRTIOEQ=0 THEN           /* ANY WRITES TO PROCESS THIS  0120 00182000
*                                      PARTE?                        */ 00183000
         SLR   @12,@12                                             0120 00184000
         C     @12,WRTIOEQ                                         0120 00185000
         BNE   @RF00120                                            0120 00186000
*/* IN CASE WE ARE PROCESSING A CIRCULAR Q, IF CIRC Q ANCHOR NOT   0121 00187000
*   ALREADY SET FOR MOVE, INDICATE SO NOW SINCE THIS IS FIRST PARTE     00188000
*   FOR WHICH WE HAD NO WRITES. NEXT TIME AROUND WE WILL START WITH     00189000
*   THIS PARTE                                                       */ 00190000
*                                                                  0121 00191000
*         IF CIRCUPDT=0 THEN                                       0121 00192000
         C     @12,CIRCUPDT                                        0121 00193000
         BNE   @RF00121                                            0121 00194000
*           CIRCUPDT=PAREPTR;                                      0122 00195000
         L     @12,PAREPTR                                         0122 00196000
         ST    @12,CIRCUPDT                                        0122 00197000
*         ELSE                                                     0123 00198000
*           ;                                                      0123 00199000
@RF00121 DS    0H                                                  0124 00200000
*       ELSE                                                       0124 00201000
*         ;                         /* THERE ARE WRITES TO PROCESS-     00202000
*                                      THIS PARTE                    */ 00203000
@RF00120 DS    0H                                                  0125 00204000
*/* DETERMINE WHETHER WE HAVE WORK FOR THIS PARTE BEFORE GO ON       */ 00205000
*                                                                  0125 00206000
*       IF WRTIOEQ^=0|              /* ANY WRITES?                   */ 00207000
*           PAREIOEQ^=0|            /* ANY UNSORTED READS?           */ 00208000
*           PARENODE^=0 THEN        /* ANY SORTED READS?             */ 00209000
         SLR   @12,@12                                             0125 00210000
         C     @12,WRTIOEQ                                         0125 00211000
         BNE   @RT00125                                            0125 00212000
         L     @11,PAREPTR                                         0125 00213000
         C     @12,PAREIOEQ(,@11)                                  0125 00214000
         BNE   @RT00125                                            0125 00215000
         C     @12,PARENODE(,@11)                                  0125 00216000
         BE    @RF00125                                            0125 00217000
@RT00125 DS    0H                                                  0126 00218000
*         DO;                       /* WORK TO DO                    */ 00219000
*                                                                  0126 00220000
*           /*********************************************************/ 00221000
*           /*                                                       */ 00222000
*           /* AT THIS POINT, WEVE GOT WORK TO DO- EITHER WRITES OR  */ 00223000
*           /* READS OR BOTH SERIALIZE USAGE OF THE PARTE ENTRY      */ 00224000
*           /*                                                       */ 00225000
*           /*********************************************************/ 00226000
*                                                                  0127 00227000
*           RFY                                                    0127 00228000
*            (R0,                                                  0127 00229000
*             R1) RSTD;                                            0127 00230000
*           R1=PARELKUP;            /* LOAD ENTRY FLAGS              */ 00231000
         L     @12,PAREPTR                                         0128 00232000
         L     R1,PARELKUP(,@12)                                   0128 00233000
*RETRYLK:                                                          0129 00234000
*           IF PAREFSIP^=ON THEN    /* ALREADY LOCKED?               */ 00235000
RETRYLK  L     @12,PAREPTR                                         0129 00236000
         TM    PAREFSIP(@12),B'10000000'                           0129 00237000
         BO    @RF00129                                            0129 00238000
*             DO;                   /* NO- GRAB IT                   */ 00239000
*               R0=R1|PAREFSPC;     /* OR ON FSIP BIT LOCK PARTE     */ 00240000
         LR    R0,R1                                               0131 00241000
         O     R0,@CF01247                                         0131 00242000
*               GEN REFS(R0,EPACPUID)(ICM R0,3,EPACPUID);/* SET NEW     00243000
*                                      CPU COUNT                     */ 00244000
         ICM R0,3,EPACPUID                                              00245000
*               CS(R1,R0,PARELKUP); /* ATTEMPT TO LOCK PARTE         */ 00246000
         L     @12,PAREPTR                                         0133 00247000
         CS    R1,@00,PARELKUP(@12)                                0133 00248000
*               BC(NE,RETRYLK);                                    0134 00249000
         BC    7,RETRYLK                                           0134 00250000
*               RFY                                                0135 00251000
*                (R0,                                              0135 00252000
*                 R1) UNRSTD;                                      0135 00253000
*                                                                  0135 00254000
*               /*****************************************************/ 00255000
*               /*                                                   */ 00256000
*               /* PARTE IS LOCKED. GET REQUIRED RESOURCES TO PROCESS*/ 00257000
*               /* PARTE                                             */ 00258000
*               /*                                                   */ 00259000
*               /*****************************************************/ 00260000
*                                                                  0136 00261000
*               IF PAREIORB=0 THEN  /* THIS PARTE HAVE NO IORBS?     */ 00262000
         L     @12,PAREPTR                                         0136 00263000
         L     @12,PAREIORB(,@12)                                  0136 00264000
         LTR   @12,@12                                             0136 00265000
         BNZ   @RF00136                                            0136 00266000
*                 DO;                                              0137 00267000
*                   ATARCODE=NOIORB;/* SET REASON FOR ABEND CODE     */ 00268000
         MVI   ATARCODE(ATAPTR),X'0C'                              0138 00269000
*                   RFY                                            0139 00270000
*                     R1 RSTD;                                     0139 00271000
*                   GEN EXIT NOSEQFLOW(ABEND X'084',,,SYSTEM);/* WAKE   00272000
*                                      UP FRR- FRR DOES NOT RETURN,     00273000
*                                      BUT RESCHEDULES PTM           */ 00274000
         ABEND X'084',,,SYSTEM                                          00275000
*                   RFY                                            0141 00276000
*                     R1 UNRSTD;                                   0141 00277000
*                 END;                                             0142 00278000
*               ELSE                                               0143 00279000
*                 ;                 /* PARTE HAS AT LEAST 1 IORB     */ 00280000
@RF00136 DS    0H                                                  0144 00281000
*               PTRIORB=PAREIORB;                                  0144 00282000
         L     @12,PAREPTR                                         0144 00283000
         L     PTRIORB,PAREIORB(,@12)                              0144 00284000
*               DO WHILE PTRIORB^=0;/* LOOP THRU IORBS TIL ONE     0145 00285000
*                                      AVAILABLE                     */ 00286000
         B     @DE00145                                            0145 00287000
@DL00145 DS    0H                                                  0146 00288000
*                 IF PTRIORB->IORFUSE^=ON THEN/* AVAILABLE?          */ 00289000
         TM    IORFUSE(PTRIORB),B'10000000'                        0146 00290000
         BO    @RF00146                                            0146 00291000
*                   DO;             /* YES- GRAB IT                  */ 00292000
*                     IORBPTR=PTRIORB;/* SET PLIST IORB ADDRESS      */ 00293000
         ST    PTRIORB,IORBPTR                                     0148 00294000
*                     PTRIORB->IORFUSE=ON;/* MARK IN USE             */ 00295000
*                                                                  0149 00296000
         OI    IORFUSE(PTRIORB),B'10000000'                        0149 00297000
*                     /***********************************************/ 00298000
*                     /*                                             */ 00299000
*                     /* GET A PCCW, IF DONT ALREADY HAVE ONE        */ 00300000
*                     /*                                             */ 00301000
*                     /***********************************************/ 00302000
*                                                                  0150 00303000
*                     IF PCCWPTR=0 THEN/* NEED ONE?                  */ 00304000
         L     @12,PCCWPTR                                         0150 00305000
         LTR   @12,@12                                             0150 00306000
         BNZ   @RF00150                                            0150 00307000
*                       DO;         /* YES                           */ 00308000
*                         RFY                                      0152 00309000
*                          (R0,                                    0152 00310000
*                           R1,                                    0152 00311000
*                           R14,                                   0152 00312000
*                           R15) RSTD;                             0152 00313000
*                         LM(R14,R15,ASMPCCWQ);/* GET PTR TO FIRST 0153 00314000
*                                      PCCW + SYNCH COUNT            */ 00315000
         LM    R14,R15,ASMPCCWQ(ASMVTPTR)                          0153 00316000
*PCCWRETR:                                                         0154 00317000
*                         IF R14^=0 THEN/* ARE THERE ANY THERE?      */ 00318000
PCCWRETR LTR   R14,R14                                             0154 00319000
         BZ    @RF00154                                            0154 00320000
*                           DO;     /* AT LEAST ONE THERE NOW        */ 00321000
*                             R0=R14->PCCWPCCW;/* PTR TO NEXT TO   0156 00322000
*                                      UPDATE AVAIL Q                */ 00323000
         L     R0,PCCWPCCW(,R14)                                   0156 00324000
*                             R1=R15-ONE;/* DECR SYNCH CT            */ 00325000
         LR    R1,R15                                              0157 00326000
         BCTR  R1,0                                                0157 00327000
*                             CDS(R14,R0,ASMPCCWQ);/* UPDATE AVAIL Q */ 00328000
         CDS   R14,R0,ASMPCCWQ(ASMVTPTR)                           0158 00329000
*                             BC(NE,PCCWRETR);/* TRY AGAIN, IF MISSED*/ 00330000
         BC    7,PCCWRETR                                          0159 00331000
*                             PCCWPTR=R14;/* PUT IN PLIST FOR SRT AND   00332000
*                                      ALSO BASE MAPPING             */ 00333000
         ST    R14,PCCWPTR                                         0160 00334000
*                             PCCWPCCW=0;/* INDICATE ONLY 1 ON PLIST */ 00335000
         L     @12,PCCWPTR                                         0161 00336000
         SLR   @11,@11                                             0161 00337000
         ST    @11,PCCWPCCW(,@12)                                  0161 00338000
*                           END;                                   0162 00339000
*                                                                  0162 00340000
*                         /*******************************************/ 00341000
*                         /*                                         */ 00342000
*                         /* WE COULDNT GET A PCCW- FREE UP ALREADY  */ 00343000
*                         /* OBTAINED RESOURCES AND GET OUT OF PART  */ 00344000
*                         /* MONITOR- IOC WILL RESCHED US            */ 00345000
*                         /*                                         */ 00346000
*                         /*******************************************/ 00347000
*                                                                  0163 00348000
*                         ELSE      /* WERENT ANY ON AVAIL QUEUE     */ 00349000
*                           DO;                                    0163 00350000
         B     @RC00154                                            0163 00351000
@RF00154 DS    0H                                                  0164 00352000
*                             IORFUSE=OFF;/* MAKE IORB AVAILABLE     */ 00353000
         L     @12,IORBPTR                                         0164 00354000
         NI    IORFUSE(@12),B'01111111'                            0164 00355000
*                             IORBPTR=0;/* MAKE SURE RECOVERY KNOWS     00356000
*                                      WHATS WHAT                    */ 00357000
         SLR   @12,@12                                             0165 00358000
         ST    @12,IORBPTR                                         0165 00359000
*                             RFY                                  0166 00360000
*                              (R0,                                0166 00361000
*                               R1) RSTD;                          0166 00362000
*                             R1=PARELKUP;/* LOAD FLAG WORD          */ 00363000
         L     @12,PAREPTR                                         0167 00364000
         L     R1,PARELKUP(,@12)                                   0167 00365000
*RETRYSET:                                                         0168 00366000
*                             R0=R1&PAREMASK;/* TURN OFF LOCK BIT    */ 00367000
RETRYSET LR    R0,R1                                               0168 00368000
         N     R0,@CF01723                                         0168 00369000
*                             CS(R1,R0,PARELKUP);/* UNLOCK PARTE     */ 00370000
         L     @12,PAREPTR                                         0169 00371000
         CS    R1,@00,PARELKUP(@12)                                0169 00372000
*                             BC(NE,RETRYSET);                     0170 00373000
         BC    7,RETRYSET                                          0170 00374000
*                             RFY                                  0171 00375000
*                              (R0,                                0171 00376000
*                               R1) UNRSTD;                        0171 00377000
*                             GOTO PTMXIT;/* CLEANUP + GET OUT       */ 00378000
         B     PTMXIT                                              0172 00379000
*                           END;                                   0173 00380000
*                         RFY                                      0174 00381000
*                          (R0,                                    0174 00382000
*                           R1,                                    0174 00383000
*                           R14,                                   0174 00384000
*                           R15) UNRSTD;                           0174 00385000
@RC00154 DS    0H                                                  0175 00386000
*                       END;        /* END NEEDED A PCCW             */ 00387000
*                     ELSE                                         0176 00388000
*                       ;           /* ALREADY HAD A PCCW            */ 00389000
@RF00150 DS    0H                                                  0177 00390000
*                     IORPCCW=PCCWPTR;/* ADDRESS PCCW FROM IORB      */ 00391000
         L     @12,PCCWPTR                                         0177 00392000
         L     @11,IORBPTR                                         0177 00393000
         ST    @12,IORPCCW(,@11)                                   0177 00394000
*                                                                  0178 00395000
*                     /***********************************************/ 00396000
*                     /*                                             */ 00397000
*                     /* AGAIN, IT IS NECESSARY TO INSURE WORK       */ 00398000
*                     /* REMAINS. COULD HAVE BEEN GRABBED BY PTM ON  */ 00399000
*                     /* ANOTHER CPU WHILE WE WERE LOCKING PARTE.    */ 00400000
*                     /*                                             */ 00401000
*                     /***********************************************/ 00402000
*                                                                  0178 00403000
*                     IF PAREIOEQ^=0 THEN/* ANY UNSORTED READS?      */ 00404000
         L     @12,PAREPTR                                         0178 00405000
         L     @12,PAREIOEQ(,@12)                                  0178 00406000
         LTR   @12,@12                                             0178 00407000
         BZ    @RF00178                                            0178 00408000
*                       CALL SORTREAD;/* SORT THE READS AND PUT ON 0179 00409000
*                                      PARENODE                      */ 00410000
         BAL   @14,SORTREAD                                        0179 00411000
*                     ELSE                                         0180 00412000
*                       ;           /* WERENT ANY UNSORTED READS     */ 00413000
@RF00178 DS    0H                                                  0181 00414000
*                     IF PARENODE^=0|/* IF THERE ARE SORTED READS    */ 00415000
*                         (WRTIOEQ^=0&PARESLTA^=0) THEN/* OR WRITES     00416000
*                                      WITH ROOM ON DS               */ 00417000
         SLR   @12,@12                                             0181 00418000
         L     @11,PAREPTR                                         0181 00419000
         C     @12,PARENODE(,@11)                                  0181 00420000
         BNE   @RT00181                                            0181 00421000
         C     @12,WRTIOEQ                                         0181 00422000
         BE    @RF00181                                            0181 00423000
         C     @12,PARESLTA(,@11)                                  0181 00424000
         BE    @RF00181                                            0181 00425000
@RT00181 DS    0H                                                  0182 00426000
*                       DO;                                        0182 00427000
*                                                                  0182 00428000
*                         /*******************************************/ 00429000
*                         /*                                         */ 00430000
*                         /* CALL SLOT SORT TO PROCESS WORK FOR THIS */ 00431000
*                         /* PARTE. R4 ALREADY POINTS TO ATA. SET R1 */ 00432000
*                         /* TO ADDRESS PARM LIST AND R13 TO ADDR OF */ 00433000
*                         /* SAVEAREA.                               */ 00434000
*                         /*                                         */ 00435000
*                         /*******************************************/ 00436000
*                                                                  0183 00437000
*                         RFY                                      0183 00438000
*                          (R1,                                    0183 00439000
*                           R13) RSTD;                             0183 00440000
*                         R1=ADDR(PARMLIST);                       0184 00441000
         LA    R1,PARMLIST                                         0184 00442000
*                         R13=ADDR(PTMSAVE);/* SAVEAREA              */ 00443000
         LA    R13,PTMSAVE                                         0185 00444000
*                         CALL ILRSRT;                             0186 00445000
         L     @15,@CV01757                                        0186 00446000
         BALR  @14,@15                                             0186 00447000
*                         RFY                                      0187 00448000
*                          (R1,                                    0187 00449000
*                           R13) UNRSTD;                           0187 00450000
*                                                                  0187 00451000
*                         /*******************************************/ 00452000
*                         /*                                         */ 00453000
*                         /* CHECK RETURN CODE FROM SLOT SORT. GO    */ 00454000
*                         /* BACK IF MORE WORK AND ANOTHER IORB      */ 00455000
*                         /* AVAILABLE.                              */ 00456000
*                         /*                                         */ 00457000
*                         /*******************************************/ 00458000
*                                                                  0188 00459000
*                         RFY                                      0188 00460000
*                           R15 RSTD;                              0188 00461000
*                         IF R15=0 THEN/* ALL OK- NO WORK REMAINS?   */ 00462000
         LTR   R15,R15                                             0189 00463000
         BNZ   @RF00189                                            0189 00464000
*                           DO;                                    0190 00465000
*                             PTRIORB=0;/* ZERO TO STOP LOOP- NO MORE   00466000
*                                      WORK THIS PARTE               */ 00467000
         SLR   PTRIORB,PTRIORB                                     0191 00468000
*                             MOREWORK=OFF;/* NO WORK REMAINS        */ 00469000
         NI    MOREWORK,B'10111111'                                0192 00470000
*                           END;                                   0193 00471000
*                         ELSE                                     0194 00472000
*                           DO;                                    0194 00473000
         B     @RC00189                                            0194 00474000
@RF00189 DS    0H                                                  0195 00475000
*                             MOREWORK=ON;/* WORK MAY REMAIN         */ 00476000
         OI    MOREWORK,B'01000000'                                0195 00477000
*                             IF R15=RCSRT4 THEN/* ALL OK WITH WORK     00478000
*                                      REMAINING?                    */ 00479000
         C     R15,@CF00117                                        0196 00480000
         BNE   @RF00196                                            0196 00481000
*                               PTRIORB=PTRIORB->IORIORB;/* GET NEXT    00482000
*                                      IORB FOR LOOP- CONTINUE       */ 00483000
         L     PTRIORB,IORIORB(,PTRIORB)                           0197 00484000
*                             ELSE                                 0198 00485000
*                               DO;                                0198 00486000
*                                                                  0198 00487000
         B     @RC00196                                            0198 00488000
@RF00196 DS    0H                                                  0199 00489000
*                                 /***********************************/ 00490000
*                                 /*                                 */ 00491000
*                                 /* AT THIS POINT WE KNOW DS WAS    */ 00492000
*                                 /* FULL- IF NOT A LOCAL DS, CALL   */ 00493000
*                                 /* DSFULL RTN TO EXAMINE SITUATION.*/ 00494000
*                                 /* IF GET CONTROL BACK FROM DSFULL */ 00495000
*                                 /* (CONTINUING), GET NEXT IORB IF  */ 00496000
*                                 /* ANY & GO BACK FOR SAME PARTE IF */ 00497000
*                                 /* THERE WERE STILL MORE READS TO  */ 00498000
*                                 /* DO WHEN DS FILLED UP            */ 00499000
*                                 /*                                 */ 00500000
*                                 /***********************************/ 00501000
*                                                                  0199 00502000
*                                 SRTCODSV=R15;/* SAVE RET CODE    0199 00503000
*                                      ACROSS DSFULL SUBRTN          */ 00504000
         ST    R15,SRTCODSV                                        0199 00505000
*                                 IF PARELOCL=OFF THEN/* THIS PARTE     00506000
*                                      JUST A LOCAL?                 */ 00507000
         L     @14,PAREPTR                                         0200 00508000
         TM    PARELOCL(@14),B'00010000'                           0200 00509000
         BNZ   @RF00200                                            0200 00510000
*                                   CALL DSFULL;/* NO- PLPA, COMM, OR   00511000
*                                      DUPLX- LET DSFULL SEE WHATS 0201 00512000
*                                      WHAT                          */ 00513000
         BAL   @14,DSFULL                                          0201 00514000
*                                 ELSE                             0202 00515000
*                                   ;/* WAS A LOCAL                  */ 00516000
*                                                                  0202 00517000
@RF00200 DS    0H                                                  0203 00518000
*                                 /***********************************/ 00519000
*                                 /*                                 */ 00520000
*                                 /* STILL HERE- CONTINUE WITH READS,*/ 00521000
*                                 /* IF ANY                          */ 00522000
*                                 /*                                 */ 00523000
*                                 /***********************************/ 00524000
*                                                                  0203 00525000
*                                 IF SRTCODSV=RCSRTC THEN/* DS FULL     00526000
*                                      WITH READS LEFT?              */ 00527000
         CLC   SRTCODSV(4),@CF00267                                0203 00528000
         BNE   @RF00203                                            0203 00529000
*                                   PTRIORB=PTRIORB->IORIORB;/* YES,    00530000
*                                      GET NEXT IORB FOR LOOP        */ 00531000
         L     PTRIORB,IORIORB(,PTRIORB)                           0204 00532000
*                                 ELSE/* NO READS REMAINING          */ 00533000
*                                   PTRIORB=0;/* ZERO TO STOP LOOP   */ 00534000
         B     @RC00203                                            0205 00535000
@RF00203 SLR   PTRIORB,PTRIORB                                     0205 00536000
*                               END;/* END DATA SET FULL             */ 00537000
@RC00203 DS    0H                                                  0207 00538000
*                           END;    /* END NOT RC 0                  */ 00539000
@RC00196 DS    0H                                                  0208 00540000
*                         RFY                                      0208 00541000
*                           R15 UNRSTD;                            0208 00542000
@RC00189 DS    0H                                                  0209 00543000
*                       END;        /* END WORK TO DO                */ 00544000
*                                                                  0210 00545000
*                     /***********************************************/ 00546000
*                     /*                                             */ 00547000
*                     /* AT THIS POINT WE KNOW WE DIDNT HAVE ANY     */ 00548000
*                     /* READS FOR THIS PARTE. ALSO, WE EITHER HAD NO*/ 00549000
*                     /* WRITES OR WE HAD WRITES BUT NO AVAILABLE    */ 00550000
*                     /* SLOTS.                                      */ 00551000
*                     /*                                             */ 00552000
*                     /***********************************************/ 00553000
*                                                                  0210 00554000
*                     ELSE                                         0210 00555000
*                       DO;                                        0210 00556000
         B     @RC00181                                            0210 00557000
@RF00181 DS    0H                                                  0211 00558000
*                         IF WRTIOEQ^=0 THEN/* DID WE HAVE WRITES TO    00559000
*                                      DO?                           */ 00560000
         L     @12,WRTIOEQ                                         0211 00561000
         LTR   @12,@12                                             0211 00562000
         BZ    @RF00211                                            0211 00563000
*/*  YES- SINCE WE KNOW WE DIDNT HAVE READS, DS WAS FULL             */ 00564000
*                                                                  0212 00565000
*                           IF PARELOCL=OFF THEN/* JUST LOCAL DS?    */ 00566000
         L     @12,PAREPTR                                         0212 00567000
         TM    PARELOCL(@12),B'00010000'                           0212 00568000
         BNZ   @RF00212                                            0212 00569000
*                             CALL DSFULL;/* NOPE- CHECK IT OUT      */ 00570000
         BAL   @14,DSFULL                                          0213 00571000
*                           ELSE                                   0214 00572000
*                             ;     /* LOCAL DS- SKIP DSFULL         */ 00573000
@RF00212 DS    0H                                                  0215 00574000
*                         ELSE                                     0215 00575000
*                           ;       /* HAD NO WRITES EITHER- WORKED     00576000
*                                      SNATCHED BEFORE WE LOCKED     */ 00577000
@RF00211 DS    0H                                                  0216 00578000
*/* IN BOTH CASES, FREE RESOURCES AND TRY NEXT PARTE                 */ 00579000
*                                                                  0216 00580000
*                         IORPCCW=0;/* ZERO PCCW PTR IN IORB         */ 00581000
         SLR   @12,@12                                             0216 00582000
         L     @11,IORBPTR                                         0216 00583000
         ST    @12,IORPCCW(,@11)                                   0216 00584000
*                         IORFUSE=OFF;/* FREE THE IORB               */ 00585000
         NI    IORFUSE(@11),B'01111111'                            0217 00586000
*                         IORBPTR=0;/* INDICATE FOR RECOVERY         */ 00587000
         ST    @12,IORBPTR                                         0218 00588000
*                         PTRIORB=0;/* STOP THE LOOP                 */ 00589000
         SLR   PTRIORB,PTRIORB                                     0219 00590000
*                       END;        /* END NO WORK OR JUST WRITES  0220 00591000
*                                      WITH DS FULL                  */ 00592000
*                   END;            /* END- THIS IORB IS AVAILABLE   */ 00593000
*                 ELSE              /* IORB WAS IN USE               */ 00594000
*                   PTRIORB=PTRIORB->IORIORB;/* GET NEXT IORB        */ 00595000
         B     @RC00146                                            0222 00596000
@RF00146 L     PTRIORB,IORIORB(,PTRIORB)                           0222 00597000
*               END;                /* END DO WHILE WEVE GOT IORBS 0223 00598000
*                                      THIS PARTE                    */ 00599000
@RC00146 DS    0H                                                  0223 00600000
@DE00145 SLR   @12,@12                                             0223 00601000
         CR    PTRIORB,@12                                         0223 00602000
         BNE   @DL00145                                            0223 00603000
*                                                                  0224 00604000
*               /*****************************************************/ 00605000
*               /*                                                   */ 00606000
*               /* EITHER FINISHED WITH THIS PARTE OR HAD LOCKED IT  */ 00607000
*               /* AND COULDNT USE IT- UNLOCK                        */ 00608000
*               /*                                                   */ 00609000
*               /*****************************************************/ 00610000
*                                                                  0224 00611000
*               IF MOREWORK=ON&ASMIOCNT=0 THEN/* WORK REMAINING WITH    00612000
*                                      NO OTHER MEANS OF REDRIVE?    */ 00613000
         TM    MOREWORK,B'01000000'                                0224 00614000
         BNO   @RF00224                                            0224 00615000
         C     @12,ASMIOCNT(,ASMVTPTR)                             0224 00616000
         BNE   @RF00224                                            0224 00617000
*                 PRESCHED=ON;      /* INSURE THIS WORK GETS       0225 00618000
*                                      PROCESSED                     */ 00619000
         OI    PRESCHED,B'00100000'                                0225 00620000
*               ELSE                                               0226 00621000
*                 ;                                                0226 00622000
@RF00224 DS    0H                                                  0227 00623000
*               IORBPTR=0;          /* MAKE SURE PLIST IORB ADDR ZERO   00624000
*                                      FOR RECOVERY                  */ 00625000
         SLR   @12,@12                                             0227 00626000
         ST    @12,IORBPTR                                         0227 00627000
*               RFY                                                0228 00628000
*                (R0,                                              0228 00629000
*                 R1) RSTD;                                        0228 00630000
*               R1=PARELKUP;        /* LOAD FLAG WORD                */ 00631000
         L     @12,PAREPTR                                         0229 00632000
         L     R1,PARELKUP(,@12)                                   0229 00633000
*RETRYST1:                                                         0230 00634000
*               R0=R1&PAREMASK;     /* TURN OFF LOCK BIT             */ 00635000
RETRYST1 LR    R0,R1                                               0230 00636000
         N     R0,@CF01723                                         0230 00637000
*               CS(R1,R0,PARELKUP); /* UNLOCK PARTE                  */ 00638000
         L     @12,PAREPTR                                         0231 00639000
         CS    R1,@00,PARELKUP(@12)                                0231 00640000
*               BC(NE,RETRYST1);                                   0232 00641000
         BC    7,RETRYST1                                          0232 00642000
*               RFY                                                0233 00643000
*                (R0,                                              0233 00644000
*                 R1) UNRSTD;                                      0233 00645000
*             END;                  /* END PARTE NOT ALREADY LOCKED  */ 00646000
*           ELSE                                                   0235 00647000
*             ;                     /* PARTE WAS LOCKED BY ANOTHER 0235 00648000
*                                      CPU                           */ 00649000
@RF00129 DS    0H                                                  0236 00650000
*         END;                      /* END OF WORK TO DO FOR THIS  0236 00651000
*                                      PARTE                         */ 00652000
*       ELSE                                                       0237 00653000
*         ;                         /* NO WORK TO DO FOR THIS PARTE  */ 00654000
*                                                                  0237 00655000
@RF00125 DS    0H                                                  0238 00656000
*       /*************************************************************/ 00657000
*       /*                                                           */ 00658000
*       /* PICK UP NEXT PARTE IN THIS PARTE CHAIN AND CONTINUE       */ 00659000
*       /*                                                           */ 00660000
*       /*************************************************************/ 00661000
*                                                                  0238 00662000
*       PAREPTR=PAREPARE;                                          0238 00663000
         L     @12,PAREPTR                                         0238 00664000
         L     @12,PAREPARE(,@12)                                  0238 00665000
         ST    @12,PAREPTR                                         0238 00666000
*     END;                          /* END DO UNTIL ALL PARTES THIS     00667000
*                                      CHAIN PROCESSED               */ 00668000
@DE00117 CLC   PAREPTR(4),LASTPARE                                 0239 00669000
         BNE   @DL00117                                            0239 00670000
*                                                                  0240 00671000
*     /***************************************************************/ 00672000
*     /*                                                             */ 00673000
*     /* DETERMINE WHICH QUEUE OF PARTES WEVE JUST PROCESSED. UPDATE */ 00674000
*     /* CIRCULAR QUEUE ANCHORS IF NECESSARY AND SET UP TO PROCESS   */ 00675000
*     /* NEXT QUEUE OF PARTES                                        */ 00676000
*     /*                                                             */ 00677000
*     /***************************************************************/ 00678000
*                                                                  0240 00679000
*     IF QPARE=PLPAQ THEN           /* JUST FINISH PLPA, COMM, &   0240 00680000
*                                      DUPLX QUEUE?                  */ 00681000
         SLR   @12,@12                                             0240 00682000
         C     @12,QPARE                                           0240 00683000
         BNE   @RF00240                                            0240 00684000
*       DO;                         /* YES-                          */ 00685000
*                                                                  0241 00686000
*         /***********************************************************/ 00687000
*         /*                                                         */ 00688000
*         /* INITIALIZE FOR PROCESS OF FIXED HEAD QUEUE              */ 00689000
*         /*                                                         */ 00690000
*         /***********************************************************/ 00691000
*                                                                  0242 00692000
*         QPARE=FIXEDQ;             /* FIXED HEAD CIRCULAR Q IS NEXT */ 00693000
         MVC   QPARE(4),@CF00117                                   0242 00694000
*         CIRCUPDT=0;               /* INITIALIZE CIRCULAR QUEUE   0243 00695000
*                                      ANCHOR PLACE HOLDER           */ 00696000
         ST    @12,CIRCUPDT                                        0243 00697000
*/* MAKE SURE WEVE GOT PAGE SPACES ON THE FIXED HEAD QUEUE           */ 00698000
*                                                                  0244 00699000
*         IF PARTCIR1^=0 THEN       /* QUEUE EXIST?                  */ 00700000
         L     @11,PARTPTR                                         0244 00701000
         L     @11,PARTCIR1(,@11)                                  0244 00702000
         CR    @11,@12                                             0244 00703000
         BE    @RF00244                                            0244 00704000
*           DO;                     /* YES                           */ 00705000
*             PAREPTR=PARTCIR1;     /* SET LOOP INDEX VARIABLE       */ 00706000
         ST    @11,PAREPTR                                         0246 00707000
*             LASTPARE=PARTCIR1;    /* AND LOOP STOPPER              */ 00708000
         ST    @11,LASTPARE                                        0247 00709000
*             GOTO NXTQUE;          /* CONTINUE                      */ 00710000
         B     NXTQUE                                              0248 00711000
*           END;                                                   0249 00712000
*         ELSE                                                     0250 00713000
*           ;                       /* NOTHING ON FIXED HEAD QUEUE-     00714000
*                                      SKIP IT                       */ 00715000
@RF00244 DS    0H                                                  0251 00716000
*       END;                        /* END PLPA/COMM/DPLX            */ 00717000
*     ELSE                                                         0252 00718000
*       ;                           /* NOT PLPA/COMM/DPLX - CHEC   0252 00719000
*                                      CIRCS                         */ 00720000
@RF00240 DS    0H                                                  0253 00721000
*     IF QPARE=FIXEDQ THEN          /* JUST FINISH FIXED HEAD Q?     */ 00722000
         CLC   QPARE(4),@CF00117                                   0253 00723000
         BNE   @RF00253                                            0253 00724000
*       DO;                                                        0254 00725000
*                                                                  0254 00726000
*         /***********************************************************/ 00727000
*         /*                                                         */ 00728000
*         /* INITIALIZE FOR PROCESS OF MOVABLE HEAD Q                */ 00729000
*         /*                                                         */ 00730000
*         /***********************************************************/ 00731000
*                                                                  0255 00732000
*         QPARE=MOVABLQ;                                           0255 00733000
*                                                                  0255 00734000
         MVC   QPARE(4),@CF00040                                   0255 00735000
*/* UPDATE FIXED HEAD QUEUE ANCHOR IF NECESSARY                      */ 00736000
*                                                                  0256 00737000
*         IF CIRCUPDT^=0 THEN       /* HAD WE RUN OUT OF WRITES WHILE   00738000
*                                      CIRCLING?                     */ 00739000
         L     @12,CIRCUPDT                                        0256 00740000
         SLR   @11,@11                                             0256 00741000
         CR    @12,@11                                             0256 00742000
         BE    @RF00256                                            0256 00743000
*           DO;                     /* YES                           */ 00744000
*             PARTCIR1=CIRCUPDT;                                   0258 00745000
         L     @08,PARTPTR                                         0258 00746000
         ST    @12,PARTCIR1(,@08)                                  0258 00747000
*             CIRCUPDT=0;           /* REINIT ANCHOR PLACEHOLDER     */ 00748000
         ST    @11,CIRCUPDT                                        0259 00749000
*           END;                                                   0260 00750000
*         ELSE                                                     0261 00751000
*           ;                       /* NO- LEAVE QUEUE ANCHOR        */ 00752000
@RF00256 DS    0H                                                  0262 00753000
*/* MAKE SURE WEVE GOT PAGE SPACES ON THE MOVABLE HEAD QUEUE         */ 00754000
*                                                                  0262 00755000
*         IF PARTCIR2^=0 THEN       /* QUEUE EXIST?                  */ 00756000
         L     @12,PARTPTR                                         0262 00757000
         L     @12,PARTCIR2(,@12)                                  0262 00758000
         LTR   @12,@12                                             0262 00759000
         BZ    @RF00262                                            0262 00760000
*           DO;                     /* YES                           */ 00761000
*             PAREPTR=PARTCIR2;                                    0264 00762000
         ST    @12,PAREPTR                                         0264 00763000
*             LASTPARE=PARTCIR2;                                   0265 00764000
         ST    @12,LASTPARE                                        0265 00765000
*             GOTO NXTQUE;          /* CONTINUE                      */ 00766000
         B     NXTQUE                                              0266 00767000
*           END;                                                   0267 00768000
*         ELSE                                                     0268 00769000
*           ;                       /* NOTHING ON MOVABLE HEAD QUEUE-   00770000
*                                      SKIP IT                       */ 00771000
@RF00262 DS    0H                                                  0269 00772000
*       END;                        /* END FIXED QUEUE               */ 00773000
*     ELSE                                                         0270 00774000
*       ;                           /* WASNT FIXED-                  */ 00775000
*                                                                  0270 00776000
@RF00253 DS    0H                                                  0271 00777000
*     /***************************************************************/ 00778000
*     /*                                                             */ 00779000
*     /* HAD TO HAVE JUST FINISHED THE MOVABLE QUEUE. SET UP TO KICK */ 00780000
*     /* OUT OF PARTE QUEUE LOOP                                     */ 00781000
*     /*                                                             */ 00782000
*     /***************************************************************/ 00783000
*                                                                  0271 00784000
*     QPARE=DONE;                   /* FINI                          */ 00785000
         MVC   QPARE(4),@CF00267                                   0271 00786000
*/* UPDATE MOVABLE HEAD QUEUE ANCHOR IF NECESSARY                    */ 00787000
*                                                                  0272 00788000
*     IF CIRCUPDT^=0 THEN           /* HAD WE RUN OUT OF WRITES WHILE   00789000
*                                      CIRCLING?                     */ 00790000
         L     @12,CIRCUPDT                                        0272 00791000
         SLR   @11,@11                                             0272 00792000
         CR    @12,@11                                             0272 00793000
         BE    @RF00272                                            0272 00794000
*       DO;                         /* YES                           */ 00795000
*         PARTCIR2=CIRCUPDT;                                       0274 00796000
         L     @08,PARTPTR                                         0274 00797000
         ST    @12,PARTCIR2(,@08)                                  0274 00798000
*         CIRCUPDT=0;                                              0275 00799000
         ST    @11,CIRCUPDT                                        0275 00800000
*       END;                                                       0276 00801000
*     ELSE                                                         0277 00802000
*       ;                           /* NO- LEAVE QUEUE ANCHOR        */ 00803000
*                                                                  0277 00804000
@RF00272 DS    0H                                                  0278 00805000
*     /***************************************************************/ 00806000
*     /*                                                             */ 00807000
*     /* END OF PARTE QUEUE LOOP. GO BACK AND PROCESS NEXT QUEUE OF  */ 00808000
*     /* PARTES UNTIL ALL THREE QUEUES ARE PROCESSED.                */ 00809000
*     /*                                                             */ 00810000
*     /***************************************************************/ 00811000
*                                                                  0278 00812000
*NXTQUE:                                                           0278 00813000
*     ;                                                            0278 00814000
NXTQUE   DS    0H                                                  0279 00815000
*   END;                            /* END PROCESS PARTE QUEUES      */ 00816000
@DE00116 CLC   QPARE(4),@CF00267                                   0279 00817000
         BNE   @DL00116                                            0279 00818000
*                                                                  0280 00819000
*   /*****************************************************************/ 00820000
*   /*                                                               */ 00821000
*   /* PART MONITOR EXIT PROCESSING. REPLACE PCCW ON AVAILABLE QUEUE,*/ 00822000
*   /* REPLACE ANY WRITES ON PART WRITE QUEUE. POST PAGE COMPLETION  */ 00823000
*   /* WITH ANY AIAS ON PART AIA ERROR QUEUE DELETE RECOVERY AND     */ 00824000
*   /* EXIT.                                                         */ 00825000
*   /*                                                               */ 00826000
*   /*****************************************************************/ 00827000
*                                                                  0280 00828000
*PTMXIT:                                                           0280 00829000
*   IF PCCWPTR^=0 THEN              /* A PCCW TO RETURN?             */ 00830000
PTMXIT   L     @12,PCCWPTR                                         0280 00831000
         SLR   @11,@11                                             0280 00832000
         CR    @12,@11                                             0280 00833000
         BE    @RF00280                                            0280 00834000
*     DO;                           /* YES-                          */ 00835000
*       RFY                                                        0282 00836000
*        (R0,                                                      0282 00837000
*         R1) RSTD;                                                0282 00838000
*       R1=PCCWPTR;                                                0283 00839000
         LR    R1,@12                                              0283 00840000
*       PCCWAIA=0;                  /* MAKE SURE AIA PTR IS ZERO     */ 00841000
         ST    @11,PCCWAIA(,@12)                                   0284 00842000
*       R0=ASMPCCWA;                /* GET HEAD OF AVAILABLE QUEUE   */ 00843000
         L     R0,ASMPCCWA(,ASMVTPTR)                              0285 00844000
*       PCCWPTR=0;                  /* ZERO FOR RECOVERY             */ 00845000
         ST    @11,PCCWPTR                                         0286 00846000
*REPPCCW:                                                          0287 00847000
*       R1->PCCWPCCW=R0;            /* CHAIN IN EXISTING PCCWS       */ 00848000
REPPCCW  ST    R0,PCCWPCCW(,R1)                                    0287 00849000
*       CS(R0,R1,ASMPCCWA);         /* UPDATE AVAILABLE QUEUE        */ 00850000
         CS    R0,@01,ASMPCCWA(ASMVTPTR)                           0288 00851000
*       BC(NE,REPPCCW);                                            0289 00852000
         BC    7,REPPCCW                                           0289 00853000
*       RFY                                                        0290 00854000
*        (R0,                                                      0290 00855000
*         R1) UNRSTD;                                              0290 00856000
*     END;                          /* END-REPLACE PCCW              */ 00857000
*   ELSE                                                           0292 00858000
*     ;                             /* NO PCCW TO RETURN             */ 00859000
@RF00280 DS    0H                                                  0293 00860000
*   IF WRTIOEQ^=0 THEN              /* ANY WRITES TO RETURN?         */ 00861000
         L     @12,WRTIOEQ                                         0293 00862000
         LTR   @12,@12                                             0293 00863000
         BZ    @RF00293                                            0293 00864000
*     DO;                           /* YES-                          */ 00865000
*       CALL GETLOCK;               /* LOCK THE PARTE WRITE QUEUES   */ 00866000
         BAL   @14,GETLOCK                                         0295 00867000
*       IOEPTR=WRTIOEQ;             /* SET INDEX PTR                 */ 00868000
         L     IOEPTR,WRTIOEQ                                      0296 00869000
*       DO WHILE(IOENXT^=0);        /* LOOP THRU IOES ON WRTIOEQ TO     00870000
*                                      FIND LAST                     */ 00871000
         B     @DE00297                                            0297 00872000
@DL00297 DS    0H                                                  0298 00873000
*         IOEPTR=IOENXT;            /* GET NEXT ONE                  */ 00874000
         L     IOEPTR,IOENXT(,IOEPTR)                              0298 00875000
*       END;                        /* IOEPTR NOW PTS TO LAST IOE    */ 00876000
@DE00297 SLR   @12,@12                                             0299 00877000
         C     @12,IOENXT(,IOEPTR)                                 0299 00878000
         BNE   @DL00297                                            0299 00879000
*       IOENXT=CURQ->WRITEQUE;      /* CHAIN EXISTING WRITES TO LAST */ 00880000
         L     @11,CURQ                                            0300 00881000
         L     @08,WRITEQUE(,@11)                                  0300 00882000
         ST    @08,IOENXT(,IOEPTR)                                 0300 00883000
*       CURQ->WRITEQUE=WRTIOEQ;     /* RETURN THESE TO TOP           */ 00884000
         L     @08,WRTIOEQ                                         0301 00885000
         ST    @08,WRITEQUE(,@11)                                  0301 00886000
*       WRTIOEQ=0;                  /* ZERO FOR RECOVERY             */ 00887000
         ST    @12,WRTIOEQ                                         0302 00888000
*       IF CURQ->WRITEQUL=0 THEN    /* WERE THERE ANY THERE?         */ 00889000
         C     @12,WRITEQUL(,@11)                                  0303 00890000
         BNE   @RF00303                                            0303 00891000
*         CURQ->WRITEQUL=IOEPTR;    /* NO- USE OUR LAST              */ 00892000
         ST    IOEPTR,WRITEQUL(,@11)                               0304 00893000
*       ELSE                                                       0305 00894000
*         ;                         /* YES- KEEP OLD LAST, WE ADDED     00895000
*                                      TO FRONT OF QUEUE             */ 00896000
@RF00303 DS    0H                                                  0306 00897000
*       CALL RELLOCK;               /* UNLOCK THE PART WRITE QUEUES  */ 00898000
         BAL   @14,RELLOCK                                         0306 00899000
*     END;                          /* END- RETURN WRITES            */ 00900000
*   ELSE                                                           0308 00901000
*     ;                             /* NO WRITES TO RETURN           */ 00902000
@RF00293 DS    0H                                                  0309 00903000
*   IF PARTAIAE^=0 THEN             /* ANYTHING ON ERROR QUEUE?      */ 00904000
         L     @12,PARTPTR                                         0309 00905000
         L     @12,PARTAIAE(,@12)                                  0309 00906000
         LTR   @12,@12                                             0309 00907000
         BZ    @RF00309                                            0309 00908000
*     DO;                           /* YES- RETURN TO PAGE COMPLETION*/ 00909000
*       RFY                                                        0311 00910000
*        (R0,                                                      0311 00911000
*         R1) RSTD;                                                0311 00912000
*       R1=PARTAIAE;                /* GET 1ST ELEMENT               */ 00913000
         LR    R1,@12                                              0312 00914000
*       R0=0;                       /* UPDATE VALUE                  */ 00915000
         SLR   R0,R0                                               0313 00916000
*RETRYAIA:                                                         0314 00917000
*       CS(R1,R0,PARTAIAE);         /* REMOVE QUEUE + UPDATE HEADER  */ 00918000
RETRYAIA L     @12,PARTPTR                                         0314 00919000
         CS    R1,@00,PARTAIAE(@12)                                0314 00920000
*       BC(NE,RETRYAIA);                                           0315 00921000
         BC    7,RETRYAIA                                          0315 00922000
*       RFY                                                        0316 00923000
*         R13 RSTD;                                                0316 00924000
*       R13=ADDR(PTMSAVE);          /* PROVIDE SAVEAREA              */ 00925000
         LA    R13,PTMSAVE                                         0317 00926000
*       CALL ILRPAGCM;              /* POST BACK BAD AIAS            */ 00927000
         L     @15,@CV01758                                        0318 00928000
         BALR  @14,@15                                             0318 00929000
*       RFY                                                        0319 00930000
*        (R0,                                                      0319 00931000
*         R1,                                                      0319 00932000
*         R13) UNRSTD;                                             0319 00933000
*     END;                          /* END POST BACK AIAS            */ 00934000
*   ELSE                                                           0321 00935000
*     ;                                                            0321 00936000
*                                                                  0321 00937000
@RF00309 DS    0H                                                  0322 00938000
*   /*****************************************************************/ 00939000
*   /*                                                               */ 00940000
*   /* FINAL CLEANUP AND EXIT PROCESSING. MAY NEED TO RESCHEDULE     */ 00941000
*   /* OURSELVES IF HAD TO USE SPILL QUEUE OR IF WORK TO DO WITH NO  */ 00942000
*   /* OTHER MEANS OF REDRIVE. DELETE RECOVERY RTN AND EXIT TO       */ 00943000
*   /* DISPATCHER                                                    */ 00944000
*   /*                                                               */ 00945000
*   /*****************************************************************/ 00946000
*                                                                  0322 00947000
*   IF PRESCHED=ON THEN             /* RESCHED PTM INDICATED?        */ 00948000
         TM    PRESCHED,B'00100000'                                0322 00949000
         BNO   @RF00322                                            0322 00950000
*     DO;                           /* YES                           */ 00951000
*       RFY                                                        0324 00952000
*        (R0,                                                      0324 00953000
*         R1) RSTD;                                                0324 00954000
*       R0=ONE;                     /* VALUE TO REPLACE IF WE CAN  0325 00955000
*                                      SCHEDULE                      */ 00956000
         LA    R0,1                                                0325 00957000
*       R1=0;                       /* VALUE TO CHECK TO ALLOW A   0326 00958000
*                                      SCHEDULE                      */ 00959000
         SLR   R1,R1                                               0326 00960000
*       CS(R1,R0,ASMSRBCT);                                        0327 00961000
         CS    R1,@00,ASMSRBCT(ASMVTPTR)                           0327 00962000
*       BC(NE,PTMNOSCH);            /* IF ALREADY ONE OUT- CANT    0328 00963000
*                                      SCHEDULE                      */ 00964000
         BC    7,PTMNOSCH                                          0328 00965000
*/* CAN SCHEDULE- DO IT                                              */ 00966000
*                                                                  0329 00967000
*       R1=ASMPSRB;                 /* PICK UP PTM SRB ADDR          */ 00968000
         L     R1,ASMPSRB(,ASMVTPTR)                               0329 00969000
*       RFY                                                        0330 00970000
*         R15 RSTD;                                                0330 00971000
*       GEN REFS(R1)(SCHEDULE SRB=(1),SCOPE=GLOBAL);               0331 00972000
         SCHEDULE SRB=(1),SCOPE=GLOBAL                                  00973000
*PTMNOSCH:                                                         0332 00974000
*       RFY                                                        0332 00975000
*        (R0,                                                      0332 00976000
*         R1,                                                      0332 00977000
*         R2,                                                      0332 00978000
*         R15) UNRSTD;                                             0332 00979000
PTMNOSCH DS    0H                                                  0333 00980000
*     END;                          /* END RESCHED PTM               */ 00981000
*   ELSE                                                           0334 00982000
*     ;                             /* RESCHED NOT INDICATED         */ 00983000
@RF00322 DS    0H                                                  0335 00984000
*/* REMOVE RECOVERY                                                  */ 00985000
*                                                                  0335 00986000
*   RFY                                                            0335 00987000
*    (R6,                                                          0335 00988000
*     R7) RSTD;                                                    0335 00989000
*PTMDRCV1:                                                         0336 00990000
*   GEN REFS(R6,R7,PSACSTK,FRRSCURR,FRRS,FRRSEMP,FRRSELEN,PSA);    0336 00991000
PTMDRCV1 DS    0H                                                  0336 00992000
         SETFRR D,WRKREGS=(R6,R7),RELATED=(PAGE,ILRPTM(PTMARCV1))       00993000
*   RFY                                                            0337 00994000
*    (R6,                                                          0337 00995000
*     R7) UNRSTD;                                                  0337 00996000
*   RFY                                                            0338 00997000
*     R14 RSTD;                                                    0338 00998000
*   R14=CVTSRBRT;                   /* GET RETURN ADDR               */ 00999000
         L     @12,CVTPTR                                          0339 01000000
         L     R14,CVTSRBRT(,@12)                                  0339 01001000
*   RFY                                                            0340 01002000
*     R14 UNRSTD;                                                  0340 01003000
*   RETURN;                         /* EXIT                          */ 01004000
@EL00001 DS    0H                                                  0341 01005000
@EF00001 DS    0H                                                  0341 01006000
@ER00001 BR    @14                                                 0341 01007000
*                                                                  0342 01008000
*/********************************************************************/ 01009000
*/*                                                                  */ 01010000
*/* GETWRTQ: REMOVE IOES FROM APPROPRIATE WRITE QUEUE                */ 01011000
*/*                                                                  */ 01012000
*/* INPUT: WRTIOEQ - CONTAINS PTR TO A CHAIN OF IOES IF PREVIOUS     */ 01013000
*/*                  CALL TO SLOT SORT DID NOT PROCESS ALL REQUESTS  */ 01014000
*/*                  OR CONTAINS ZERO.                               */ 01015000
*/*        CURQ    - CONTAINS A PTR TO THE WRITE QUE FOR THIS CALL   */ 01016000
*/*        EPAWRTQ - CONTAINS A PTR TO THE WRITE QUE USED BY THE     */ 01017000
*/*                  LAST PART ENTRY OR ZERO.                        */ 01018000
*/*                                                                  */ 01019000
*/* PROCESS: IF THE PREVIOUS PART ENTRY DOES NOT SHARE THE SAME      */ 01020000
*/*          WRITE QUEUE AS THE CURRENT ENTRY, ANY WRITES ON THE     */ 01021000
*/*          PLIST WRTIOEQ ARE RETURNED TO THEIR PART WRITE QUEUE.   */ 01022000
*/*          WRITE IOES ARE THEN PICKED UP FROM THE CURRENT PART     */ 01023000
*/*          WRITE QUEUE AND PLACED ON WRTIOEQ. IF CURRENT AND PREV  */ 01024000
*/*          SHARE THE SAME PART WRITE QUEUE, WRITES ARE MOVED TO    */ 01025000
*/*          WRTIOEQ ONLY IF THERE ARE NONE LEFT ON WRTIOEQ FROM     */ 01026000
*/*          PREVIOUS PROCESSING. CHECKS ARE MADE FOR CURQ = ZERO    */ 01027000
*/*          WHICH INDICATES TO PART MONITOR THAT THIS PARTE HAS     */ 01028000
*/*          NO WRITE QUEUE. THE ASM CLASS LOCK IS HELD WHILE        */ 01029000
*/*          MANIPULATING THE PART WRITE QUEUES.                     */ 01030000
*/*                                                                  */ 01031000
*/* OUTPUT: WRTIOEQ - WILL CONTAIN A PTR TO THE IOE CHAIN FOR THE    */ 01032000
*/*                   CURRENT PART ENTRY BEING PROCESSED OR ZERO.    */ 01033000
*/*         EPAWRTQ - WILL BE UPDATED TO POINT TO THE CURRENT WRITE  */ 01034000
*/*                   QUEUE.                                         */ 01035000
*/*                                                                  */ 01036000
*/********************************************************************/ 01037000
*                                                                  0342 01038000
*GETWRTQ:                                                          0342 01039000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0342 01040000
GETWRTQ  DS    0H                                                  0343 01041000
*   RFY                                                            0343 01042000
*     R14 RSTD;                                                    0343 01043000
*   RETADDR1=R14;                   /* SAVE RETURN ADDRESS           */ 01044000
         ST    R14,RETADDR1                                        0344 01045000
*   RFY                                                            0345 01046000
*     R14 UNRSTD;                                                  0345 01047000
*   IF CURQ^=EPAWRTQ THEN           /* NEW PARTE HAVE DIFFERENT WRITE   01048000
*                                      QUE?                          */ 01049000
         CLC   CURQ(4),EPAWRTQ                                     0346 01050000
         BE    @RF00346                                            0346 01051000
*     DO;                           /* YES - RETURN ANY WRITES AND 0347 01052000
*                                      SET EPAWRTQ = CURQ            */ 01053000
*       IF WRTIOEQ^=0 THEN          /* ANY WRITES REMAIN ON PLIST?   */ 01054000
         L     @12,WRTIOEQ                                         0348 01055000
         LTR   @12,@12                                             0348 01056000
         BZ    @RF00348                                            0348 01057000
*         DO;                       /* YES- RETURN WRITE IOES TO PREV   01058000
*                                      PARTES PART WRITE QUEUE       */ 01059000
*           CALL GETLOCK;           /* LOCK PART WRITE QUEUES        */ 01060000
         BAL   @14,GETLOCK                                         0350 01061000
*           WRTLOCKD=ON;            /* INDICATE LOCKED               */ 01062000
         OI    WRTLOCKD,B'10000000'                                0351 01063000
*           IOEPTR=WRTIOEQ;         /* SET INDEX PTR                 */ 01064000
         L     IOEPTR,WRTIOEQ                                      0352 01065000
*           DO WHILE(IOENXT^=0);    /* LOOP THRU IOES ON WRTIOEQ TO     01066000
*                                      FIND LAST                     */ 01067000
         B     @DE00353                                            0353 01068000
@DL00353 DS    0H                                                  0354 01069000
*             IOEPTR=IOENXT;        /* GET NEXT                      */ 01070000
         L     IOEPTR,IOENXT(,IOEPTR)                              0354 01071000
*           END;                    /* IOEPTR NOW POINTS TO LAST IOE */ 01072000
@DE00353 SLR   @12,@12                                             0355 01073000
         C     @12,IOENXT(,IOEPTR)                                 0355 01074000
         BNE   @DL00353                                            0355 01075000
*           IOENXT=EPAWRTQ->WRITEQUE;/* CHAIN EXISTING WRITES FOR  0356 01076000
*                                      PREV PARTE ONTO LAST PLIST IOE*/ 01077000
         L     @11,EPAWRTQ                                         0356 01078000
         L     @08,WRITEQUE(,@11)                                  0356 01079000
         ST    @08,IOENXT(,IOEPTR)                                 0356 01080000
*           EPAWRTQ->WRITEQUE=WRTIOEQ;/* RETURN PLIST IOES TO TOP OF    01081000
*                                      PREVIOUS WRITE QUEUE          */ 01082000
         L     @08,WRTIOEQ                                         0357 01083000
         ST    @08,WRITEQUE(,@11)                                  0357 01084000
*           WRTIOEQ=0;              /* OFF OF PLIST WRITE QUEUE      */ 01085000
         ST    @12,WRTIOEQ                                         0358 01086000
*           IF EPAWRTQ->WRITEQUL=0 THEN/* WERE THERE SOME THERE?     */ 01087000
         C     @12,WRITEQUL(,@11)                                  0359 01088000
         BNE   @RF00359                                            0359 01089000
*             EPAWRTQ->WRITEQUL=IOEPTR;/* NO- USE OUR LAST           */ 01090000
         ST    IOEPTR,WRITEQUL(,@11)                               0360 01091000
*           ELSE                                                   0361 01092000
*             ;                     /* YES- KEEP OLD TAIL PTR, WE  0361 01093000
*                                      ADDED TO FRONT                */ 01094000
@RF00359 DS    0H                                                  0362 01095000
*         END;                      /* END WRITES REMAIN ON PLIST TO    01096000
*                                      RETURN                        */ 01097000
*       ELSE                                                       0363 01098000
*         ;                         /* NO WRITES TO RETURN           */ 01099000
@RF00348 DS    0H                                                  0364 01100000
*       EPAWRTQ=CURQ;               /* UPDATE TO CURRENT PARTE PART     01101000
*                                      WRITE QUEUE PTR               */ 01102000
         L     @12,CURQ                                            0364 01103000
         ST    @12,EPAWRTQ                                         0364 01104000
*     END;                          /* END CURQ ^= PREVIOUS QUEUE    */ 01105000
*   ELSE                                                           0366 01106000
*     ;                             /* CURQ WAS EQUAL TO PREVIOUS  0366 01107000
*                                      QUEUE                         */ 01108000
@RF00346 DS    0H                                                  0367 01109000
*   IF WRTIOEQ=0&                   /* NO WRITES THERE FROM PREV   0367 01110000
*                                      PROCESSING? AND               */ 01111000
*       CURQ^=0&                    /* THIS PARTE HAS A WRITE QUE  0367 01112000
*                                      PTR? AND                      */ 01113000
*       CURQ->WRITEQUE^=0 THEN      /* ARE THERE IOES ON IT?         */ 01114000
         SLR   @12,@12                                             0367 01115000
         C     @12,WRTIOEQ                                         0367 01116000
         BNE   @RF00367                                            0367 01117000
         L     @11,CURQ                                            0367 01118000
         CR    @11,@12                                             0367 01119000
         BE    @RF00367                                            0367 01120000
         C     @12,WRITEQUE(,@11)                                  0367 01121000
         BE    @RF00367                                            0367 01122000
*     DO;                           /* YES- GET WRITES               */ 01123000
*       IF WRTLOCKD=OFF THEN        /* WRITE QUEUES ALREADY LOCKED?  */ 01124000
         TM    WRTLOCKD,B'10000000'                                0369 01125000
         BNZ   @RF00369                                            0369 01126000
*         DO;                       /* NO- GET LOCK                  */ 01127000
*           CALL GETLOCK;                                          0371 01128000
         BAL   @14,GETLOCK                                         0371 01129000
*           WRTLOCKD=ON;            /* INDICATE LOCKED               */ 01130000
         OI    WRTLOCKD,B'10000000'                                0372 01131000
*         END;                                                     0373 01132000
*       ELSE                                                       0374 01133000
*         ;                         /* ALREADY LOCKED                */ 01134000
@RF00369 DS    0H                                                  0375 01135000
*       WRTIOEQ=CURQ->WRITEQUE;     /* QUEUE IOES TO PLIST           */ 01136000
         L     @12,CURQ                                            0375 01137000
         L     @11,WRITEQUE(,@12)                                  0375 01138000
         ST    @11,WRTIOEQ                                         0375 01139000
*       CURQ->WRITEQUE=0;           /* ZERO PART WRITE QUEUE HEAD AND*/ 01140000
         SLR   @11,@11                                             0376 01141000
         ST    @11,WRITEQUE(,@12)                                  0376 01142000
*       CURQ->WRITEQUL=0;           /* TAIL PTRS                     */ 01143000
         ST    @11,WRITEQUL(,@12)                                  0377 01144000
*     END;                                                         0378 01145000
*   ELSE                                                           0379 01146000
*     ;                             /* WRITES LEFT OR NO NEW WRITES  */ 01147000
@RF00367 DS    0H                                                  0380 01148000
*   IF WRTLOCKD=ON THEN             /* LOCK HELD?                    */ 01149000
         TM    WRTLOCKD,B'10000000'                                0380 01150000
         BNO   @RF00380                                            0380 01151000
*     DO;                           /* YES- RELEASE IT               */ 01152000
*       CALL RELLOCK;                                              0382 01153000
         BAL   @14,RELLOCK                                         0382 01154000
*       WRTLOCKD=OFF;               /* INDICATE LOCK RELEASED        */ 01155000
         NI    WRTLOCKD,B'01111111'                                0383 01156000
*     END;                                                         0384 01157000
*   RFY                                                            0385 01158000
*     R14 RSTD;                                                    0385 01159000
@RF00380 DS    0H                                                  0386 01160000
*   R14=RETADDR1;                   /* RESTORE RETURN ADDRESS        */ 01161000
         L     R14,RETADDR1                                        0386 01162000
*   RFY                                                            0387 01163000
*     R14 UNRSTD;                                                  0387 01164000
*   END GETWRTQ;                                                   0388 01165000
@EL00002 DS    0H                                                  0388 01166000
@EF00002 DS    0H                                                  0388 01167000
@ER00002 BR    @14                                                 0388 01168000
*                                                                  0389 01169000
*/********************************************************************/ 01170000
*/*                                                                  */ 01171000
*/* GETLOCK: OBTAIN ASM CLASS LOCK FOR PART WRITE QUEUES             */ 01172000
*/*                                                                  */ 01173000
*/* INPUT: NONE                                                      */ 01174000
*/*                                                                  */ 01175000
*/* PROCESS: USE SETLOCK TO OBTAIN THE ASM CLASS LOCK TO SERIALIZE   */ 01176000
*/*          USE OF THE PART WRITE QUEUES.                           */ 01177000
*/*                                                                  */ 01178000
*/* OUTPUT: NONE                                                     */ 01179000
*/*                                                                  */ 01180000
*/****************************************************************** */ 01181000
*                                                                  0389 01182000
*GETLOCK:                                                          0389 01183000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0389 01184000
GETLOCK  DS    0H                                                  0390 01185000
*   RFY                                                            0390 01186000
*    (R11,                                                         0390 01187000
*     R12,                                                         0390 01188000
*     R13,                                                         0390 01189000
*     R14) RSTD;                                                   0390 01190000
*   RETADDR2=R14;                   /* SAVE RETURN ADDRESS           */ 01191000
         ST    R14,RETADDR2                                        0391 01192000
*   R11=ADDR(PARTLOCK);             /* SET LOCKWORD ADDRESS          */ 01193000
         L     R11,PARTPTR                                         0392 01194000
         LA    R11,PARTLOCK(,R11)                                  0392 01195000
*PTMLK1:                                                           0393 01196000
*   GEN REFS(R11,R12,R13,R14,PSALITA,FLC);                         0393 01197000
PTMLK1   DS    0H                                                  0393 01198000
         SETLOCK OBTAIN,TYPE=ASM,ADDR=(11),MODE=UNCOND,                *01199000
               RELATED=(PART,ILRPTM(PTMUNLK1))                          01200000
*   R14=RETADDR2;                   /* RESTORE RETURN ADDRESS        */ 01201000
         L     R14,RETADDR2                                        0394 01202000
*   RFY                                                            0395 01203000
*    (R11,                                                         0395 01204000
*     R12,                                                         0395 01205000
*     R13,                                                         0395 01206000
*     R14) UNRSTD;                                                 0395 01207000
*   END GETLOCK;                                                   0396 01208000
@EL00003 DS    0H                                                  0396 01209000
@EF00003 DS    0H                                                  0396 01210000
@ER00003 BR    @14                                                 0396 01211000
*                                                                  0397 01212000
*/********************************************************************/ 01213000
*/*                                                                  */ 01214000
*/* RELLOCK: RELEASE ASM CLASS LOCK                                  */ 01215000
*/*                                                                  */ 01216000
*/* INPUT: NONE                                                      */ 01217000
*/*                                                                  */ 01218000
*/* PROCESS: USE SETLOCK TO RELEASE THE ASM CLASS LOCK               */ 01219000
*/*                                                                  */ 01220000
*/* OUTPUT: NONE                                                     */ 01221000
*/*                                                                  */ 01222000
*/********************************************************************/ 01223000
*                                                                  0397 01224000
*RELLOCK:                                                          0397 01225000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0397 01226000
RELLOCK  DS    0H                                                  0398 01227000
*   RFY                                                            0398 01228000
*    (R11,                                                         0398 01229000
*     R12,                                                         0398 01230000
*     R13,                                                         0398 01231000
*     R14) RSTD;                                                   0398 01232000
*   RETADDR2=R14;                   /* SAVE RETURN ADDRESS           */ 01233000
         ST    R14,RETADDR2                                        0399 01234000
*   R11=ADDR(PARTLOCK);             /* SET LOCKWORD ADDRESS          */ 01235000
         L     R11,PARTPTR                                         0400 01236000
         LA    R11,PARTLOCK(,R11)                                  0400 01237000
*PTMUNLK1:                                                         0401 01238000
*   GEN REFS(R11,R12,R13,R14,PSALITA,FLC);                         0401 01239000
PTMUNLK1 DS    0H                                                  0401 01240000
         SETLOCK RELEASE,TYPE=ASM,ADDR=(11),                           *01241000
               RELATED=(PART,ILRPTM(PTMLK1))                            01242000
*   R14=RETADDR2;                   /* RESTORE RETURN ADDRESS        */ 01243000
         L     R14,RETADDR2                                        0402 01244000
*   RFY                                                            0403 01245000
*    (R11,                                                         0403 01246000
*     R12,                                                         0403 01247000
*     R13,                                                         0403 01248000
*     R14) UNRSTD;                                                 0403 01249000
*   END RELLOCK;                                                   0404 01250000
@EL00004 DS    0H                                                  0404 01251000
@EF00004 DS    0H                                                  0404 01252000
@ER00004 BR    @14                                                 0404 01253000
*                                                                  0405 01254000
*/********************************************************************/ 01255000
*/*                                                                  */ 01256000
*/* DSFULL: PLPA/COMMON/DUPLEX DATA SET FULL SUBROUTINE              */ 01257000
*/*                                                                  */ 01258000
*/* INPUT: NONE                                                      */ 01259000
*/*                                                                  */ 01260000
*/* PROCESS: OBTAIN THE SALLOC LOCK TO SERIALIZE SETTING OF ASMVT    */ 01261000
*/*          FULL INDICATORS. DETERMINE WHICH DATA SET FILLED AND    */ 01262000
*/*          SET UP FOR CALL TO ILRMSG00 TO ISSUE APPROPRIATE MESSAGE*/ 01263000
*/*          AND POSSIBLY TERMINATE THE SYSTEM IF A CRITICAL RESOURCE*/ 01264000
*/*          HAS BEEN LOST. CHECKS ARE MADE TO INSURE THAT THE       */ 01265000
*/*          MESSAGES INDICATING A FILLED DATA SET ARE ISSUED ONLY   */ 01266000
*/*          ONCE.                                                   */ 01267000
*/*                                                                  */ 01268000
*/* OUTPUT: FOR PLPA FULL AND COMMON OK, PLPAS WRITE QUEUE PTR (TO   */ 01269000
*/*         THE COMMON PART WRITE QUEUE) IS ZEROED AND COMMONS       */ 01270000
*/*         WRITE QUE PTR (WHICH WAS ZERO) IS SET TO ADDRESS THE     */ 01271000
*/*         COMMON PART WRITE QUEUE.                                 */ 01272000
*/*         FOR COMMON FULL AND PLPA OK, THE WRITE IOES ON           */ 01273000
*/*         THE COMMON PART WRITE QUE ARE MOVED TO THE PLPA SPILL QUE*/ 01274000
*/*         AND RESCHEDULE OF PART MONITOR IS INDICATED. COMMONS     */ 01275000
*/*         WRITE QUEUE PTR IS NOT ZEROED (AS WAS PLPAS ABOVE)       */ 01276000
*/*         BECAUSE COMMON MAY FREE UP SOME SLOTS LATER WHEREAS      */ 01277000
*/*         PLPA NEVER WOULD HAVE.                                   */ 01278000
*/*         IF EITHER OF THE ABOVE CANNOT BE HANDLED BY THE OTHER    */ 01279000
*/*         AND DUPLX IS ACTIVE, THE ASSOC AIAS ARE MARKED LSID 0    */ 01280000
*/*         AND PUT ON THE PART ERROR QUEUE - IOES FREED. IF DUPLEX  */ 01281000
*/*         NOT ACTIVE IN THIS CASE, SYSTEM WILL TERMINATE AFTER CALL*/ 01282000
*/*         TO MSG00. IF DUPLEX FILLED AND WE ARE NOT DEPENDING ON   */ 01283000
*/*         DUPLEXING, THE ASSOCIATED AIAS ARE MARKED SECONDARY ERROR*/ 01284000
*/*         AND PUT ON THE PART ERROR QUEUE - IOES FREED. IF DEPEND  */ 01285000
*/*         ON DUPLEX, SYSTEM WILL BE TERMINATED.                    */ 01286000
*/*                                                                  */ 01287000
*/********************************************************************/ 01288000
*                                                                  0405 01289000
*DSFULL:                                                           0405 01290000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0405 01291000
DSFULL   DS    0H                                                  0406 01292000
*   RFY                                                            0406 01293000
*     R14 RSTD;                                                    0406 01294000
*   RETADDR1=R14;                   /* SAVE RETURN ADDRESS           */ 01295000
         ST    R14,RETADDR1                                        0407 01296000
*   RFY                                                            0408 01297000
*    (R11,                                                         0408 01298000
*     R12,                                                         0408 01299000
*     R13,                                                         0408 01300000
*     R14) RSTD;                                                   0408 01301000
*PTMLK2:                                                           0409 01302000
*   GEN REFS(R12,R13,R14,PSALITA,FLC);                             0409 01303000
PTMLK2   DS    0H                                                  0409 01304000
         SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,                       *01305000
               RELATED=(ASMVT,ILRPTM(PTMUNLK2))                         01306000
*   RFY                                                            0410 01307000
*    (R11,                                                         0410 01308000
*     R12,                                                         0410 01309000
*     R13,                                                         0410 01310000
*     R14) UNRSTD;                                                 0410 01311000
*   MSGPLIST=''B;                   /* INITIAL MSG00 PLIST SETUP     */ 01312000
         XC    MSGPLIST(8),MSGPLIST                                0411 01313000
*   MSGCBADR=PAREPTR;               /* PARTE ADDRESS                 */ 01314000
         L     @12,PAREPTR                                         0412 01315000
         ST    @12,MSGCBADR                                        0412 01316000
*   EPAMSPAD=0;                     /* INITIALLY INDICATE NO MSG REQD*/ 01317000
         SLR   @11,@11                                             0413 01318000
         ST    @11,EPAMSPAD                                        0413 01319000
*   IF PAREPLPA=ON THEN             /* FILL UP PLPA D.S.?            */ 01320000
         TM    PAREPLPA(@12),B'10000000'                           0414 01321000
         BNO   @RF00414                                            0414 01322000
*     DO;                           /* YES-                          */ 01323000
*                                                                  0415 01324000
*       /*************************************************************/ 01325000
*       /*                                                           */ 01326000
*       /* FILLED THE PLPA DATA SET                                  */ 01327000
*       /*                                                           */ 01328000
*       /*************************************************************/ 01329000
*                                                                  0416 01330000
*       IF ASMPLPAF=OFF THEN        /* MSG NOT ISSUED BEFORE?        */ 01331000
         TM    ASMPLPAF(ASMVTPTR),B'00000100'                      0416 01332000
         BNZ   @RF00416                                            0416 01333000
*         DO;                       /* YES- INDICATE NEED TO ISSUE   */ 01334000
*           MSGNUM=MSGFIVE;         /* SET MSG NUMBER                */ 01335000
         MVC   MSGNUM(2),@CH01299                                  0418 01336000
*           EPAMSPAD=ADDR(MSGPLIST);/* NON ZERO ADDR INDICATES MSG 0419 01337000
*                                      REQD TO US AND RECOVERY       */ 01338000
         LA    @12,MSGPLIST                                        0419 01339000
         ST    @12,EPAMSPAD                                        0419 01340000
*         END;                                                     0420 01341000
*       ELSE                                                       0421 01342000
*         ;                         /* MSG ALREADY ISSUED            */ 01343000
@RF00416 DS    0H                                                  0422 01344000
*       IF ASMCOMMF=ON|             /* COMMON FULL TOO OR            */ 01345000
*           ADDR(PARTENTS(PARTCOMN+1))->PAREDSBD=ON THEN/* BAD?      */ 01346000
         TM    ASMCOMMF(ASMVTPTR),B'00000010'                      0422 01347000
         BO    @RT00422                                            0422 01348000
         L     @12,PARTPTR                                         0422 01349000
         LA    @12,PARTENTS+64(,@12)                               0422 01350000
         TM    PAREDSBD(@12),B'01000000'                           0422 01351000
         BNO   @RF00422                                            0422 01352000
@RT00422 DS    0H                                                  0423 01353000
*         DO;                       /* YES- CANT FORCE TO COMMON.  0423 01354000
*                                      CHECK TO SEE IF WE CAN RELY ON   01355000
*                                      DUPLEX                @Z40WPWP*/ 01356000
*           IF ASMDUPLX=ON THEN     /* DUPLEXING ACTIVE?     @Z40WPWP*/ 01357000
         TM    ASMDUPLX(ASMVTPTR),B'10000000'                      0424 01358000
         BNO   @RF00424                                            0424 01359000
*             DO;                   /* YES- MARK AIAS AS LSID = 0, 0425 01360000
*                                      FREE IOES + ISSUE MSG 10      */ 01361000
*               IF ASMPLPAF=OFF THEN/* 1ST INDICATION THAT PLPA    0426 01362000
*                                      FILLED?               @Z40WPWP*/ 01363000
         TM    ASMPLPAF(ASMVTPTR),B'00000100'                      0426 01364000
         BNZ   @RF00426                                            0426 01365000
*                 DO;               /* YES, ISSUE MESSAGE ILR010I  0427 01366000
*                                                            @Z40WPWP*/ 01367000
*                   MSGNUM=MSGTEN;  /* SET MSG NUMBER        @Z40WPWP*/ 01368000
         MVC   MSGNUM(2),@CH00033                                  0428 01369000
*                   EPAMSPAD=ADDR(MSGPLIST);/* INDICATE MSG REQD   0429 01370000
*                                                            @Z40WPWP*/ 01371000
         LA    @12,MSGPLIST                                        0429 01372000
         ST    @12,EPAMSPAD                                        0429 01373000
*                 END;              /* FOR ISSUE MSG 10I     @Z40WPWP*/ 01374000
*               ELSE                                               0431 01375000
*                 ;                 /* NOW STOP ANY WRITES FOR THIS     01376000
*                                      PARTE                 @Z40WPWP*/ 01377000
@RF00426 DS    0H                                                  0432 01378000
*               CALL STOPWRT;       /* MARK AIAS AS LSID 0 AND FREE     01379000
*                                      IOES                  @Z40WPWP*/ 01380000
         BAL   @14,STOPWRT                                         0432 01381000
*             END;                  /* END DUPLEXING ACTIVE  @Z40WPWP*/ 01382000
*           ELSE                    /* DUPLEXING NOT ACTIVE- @Z40WPWP*/ 01383000
*             DO;                   /* CAN NOT KEEP THE SYSTEM GOING    01384000
*                                                            @Z40WPWP*/ 01385000
         B     @RC00424                                            0434 01386000
@RF00424 DS    0H                                                  0435 01387000
*               MSGNUM=MSGEIGHT;    /* TERMINATION MSG       @Z40WPWP*/ 01388000
         MVC   MSGNUM(2),@CH00040                                  0435 01389000
*               EPAMSPAD=ADDR(MSGPLIST);/* INDICATE MSG REQD @Z40WPWP*/ 01390000
         LA    @12,MSGPLIST                                        0436 01391000
         ST    @12,EPAMSPAD                                        0436 01392000
*             END;                  /*                       @Z40WPWP*/ 01393000
*         END;                      /* FOR CAN WE RELY ON DUPLEX   0438 01394000
*                                                            @Z40WPWP*/ 01395000
*       ELSE                        /* COMMON OK-                    */ 01396000
*         DO;                       /* FORCE WRITES TO COMMON BY     */ 01397000
         B     @RC00422                                            0439 01398000
@RF00422 DS    0H                                                  0440 01399000
*           PAREWTQE=0;             /* ZEROING PLPAS PART WRITE QUEUE   01400000
*                                      PTR AND                       */ 01401000
         L     @12,PAREPTR                                         0440 01402000
         SLR   @11,@11                                             0440 01403000
         ST    @11,PAREWTQE(,@12)                                  0440 01404000
*           ADDR(PARTENTS(PARTCOMN+1))->PAREWTQE=ADDR(PARTCOMQ);/* 0441 01405000
*                                      POINTING COMMON PARTE TO    0441 01406000
*                                      COMMON PART WRITE QUEUE.      */ 01407000
         L     @12,PARTPTR                                         0441 01408000
         LA    @11,PARTENTS+64(,@12)                               0441 01409000
         LA    @12,PARTCOMQ(,@12)                                  0441 01410000
         ST    @12,PAREWTQE(,@11)                                  0441 01411000
*         END;                      /* END FORCE WRITES TO COMMON    */ 01412000
*       ASMPLPAF=ON;                /* INDICATE PLPA FILLED  @Z40WPWP*/ 01413000
@RC00422 OI    ASMPLPAF(ASMVTPTR),B'00000100'                      0443 01414000
*     END;                          /* END PLPA FILLED               */ 01415000
*   ELSE                            /* NOT PLPA-                     */ 01416000
*     IF PARECOMM=ON THEN           /* FILL UP COMMON D.S.?          */ 01417000
         B     @RC00414                                            0445 01418000
@RF00414 L     @12,PAREPTR                                         0445 01419000
         TM    PARECOMM(@12),B'01000000'                           0445 01420000
         BNO   @RF00445                                            0445 01421000
*       DO;                                                        0446 01422000
*                                                                  0446 01423000
*         /***********************************************************/ 01424000
*         /*                                                         */ 01425000
*         /* FILLED THE COMMON DATA SET                              */ 01426000
*         /*                                                         */ 01427000
*         /***********************************************************/ 01428000
*                                                                  0447 01429000
*         IF ASMCOMMF=OFF THEN      /* MSG NOT ISSUED BEFORE?        */ 01430000
         TM    ASMCOMMF(ASMVTPTR),B'00000010'                      0447 01431000
         BNZ   @RF00447                                            0447 01432000
*           DO;                     /* YES-                          */ 01433000
*             MSGNUM=MSGSIX;        /* SET MSG NUMBER                */ 01434000
         MVC   MSGNUM(2),@CH00986                                  0449 01435000
*             EPAMSPAD=ADDR(MSGPLIST);/* INDICATE NEED TO ISSUE      */ 01436000
         LA    @12,MSGPLIST                                        0450 01437000
         ST    @12,EPAMSPAD                                        0450 01438000
*           END;                                                   0451 01439000
*         ELSE                                                     0452 01440000
*           ;                       /* MSG ALREADY ISSUED            */ 01441000
@RF00447 DS    0H                                                  0453 01442000
*         IF ASMPLPAF=ON|           /* PLPA FULL TOO OR              */ 01443000
*             ADDR(PARTENTS(PARTPLPN+1))->PAREDSBD=ON THEN/* BAD?    */ 01444000
         TM    ASMPLPAF(ASMVTPTR),B'00000100'                      0453 01445000
         BO    @RT00453                                            0453 01446000
         L     @12,PARTPTR                                         0453 01447000
         LA    @12,PARTENTS(,@12)                                  0453 01448000
         TM    PAREDSBD(@12),B'01000000'                           0453 01449000
         BNO   @RF00453                                            0453 01450000
@RT00453 DS    0H                                                  0454 01451000
*           DO;                     /* SEE IF WE CAN RELY ON DUPLEX  */ 01452000
*             IF ASMDUPLX=ON THEN   /* DUPLEXING ACTIVE?             */ 01453000
         TM    ASMDUPLX(ASMVTPTR),B'10000000'                      0455 01454000
         BNO   @RF00455                                            0455 01455000
*               DO;                 /* YES- MARK AIAS AS LSID = 0, 0456 01456000
*                                      FREE IOES + ISSUE MSG 10      */ 01457000
*                 IF ASMCOMMF=OFF THEN/* 1ST INDICATION THAT COMMON     01458000
*                                      FILLED?               @Z40WPWP*/ 01459000
         TM    ASMCOMMF(ASMVTPTR),B'00000010'                      0457 01460000
         BNZ   @RF00457                                            0457 01461000
*                   DO;             /* YES, ISSUE MESSAGE ILR010I  0458 01462000
*                                                            @Z40WPWP*/ 01463000
*                     MSGNUM=MSGTEN;/* SET MSG NUMBER                */ 01464000
         MVC   MSGNUM(2),@CH00033                                  0459 01465000
*                     EPAMSPAD=ADDR(MSGPLIST);/* INDICATE MSG REQD   */ 01466000
         LA    @12,MSGPLIST                                        0460 01467000
         ST    @12,EPAMSPAD                                        0460 01468000
*                   END;            /* FOR ISSUE MSG 10I     @Z40WPWP*/ 01469000
*                 ELSE                                             0462 01470000
*                   ;               /* NOW STOP ANY WRITES FOR THIS     01471000
*                                      PARTE                 @Z40WPWP*/ 01472000
@RF00457 DS    0H                                                  0463 01473000
*                 CALL STOPWRT;     /* MARK AIAS AS LSID 0 AND FREE     01474000
*                                      IOES                          */ 01475000
         BAL   @14,STOPWRT                                         0463 01476000
*               END;                /* END DUPLEXING ACTIVE          */ 01477000
*             ELSE                  /* DUPLEXING NOT ACTIVE-         */ 01478000
*               DO;                 /* TIME TO GO WEST               */ 01479000
         B     @RC00455                                            0465 01480000
@RF00455 DS    0H                                                  0466 01481000
*                 MSGNUM=MSGEIGHT;  /* TERMINATION MSG               */ 01482000
         MVC   MSGNUM(2),@CH00040                                  0466 01483000
*                 EPAMSPAD=ADDR(MSGPLIST);/* INDICATE MSG REQD       */ 01484000
         LA    @12,MSGPLIST                                        0467 01485000
         ST    @12,EPAMSPAD                                        0467 01486000
*               END;                                               0468 01487000
*           END;                    /* FOR CAN WE RELY ON DUPLEX   0469 01488000
*                                                            @Z40WPWP*/ 01489000
*         ELSE                      /* PLPA STILL OK- FORCE WRITES TO   01490000
*                                      IT                            */ 01491000
*           DO;                                                    0470 01492000
         B     @RC00453                                            0470 01493000
@RF00453 DS    0H                                                  0471 01494000
*             IOEPTR=WRTIOEQ;       /* SET INDEX PTR                 */ 01495000
         L     IOEPTR,WRTIOEQ                                      0471 01496000
*             DO WHILE(IOENXT^=0);  /* FIND LAST IOE ON PLIST        */ 01497000
         B     @DE00472                                            0472 01498000
@DL00472 DS    0H                                                  0473 01499000
*               IOEPTR=IOENXT;      /* GET NEXT                      */ 01500000
         L     IOEPTR,IOENXT(,IOEPTR)                              0473 01501000
*             END;                                                 0474 01502000
@DE00472 SLR   @12,@12                                             0474 01503000
         C     @12,IOENXT(,IOEPTR)                                 0474 01504000
         BNE   @DL00472                                            0474 01505000
*             IOEHOLDR=WRTIOEQ;     /* REMOVE WRITES INTO PLACEHOLDER   01506000
*                                      AND                           */ 01507000
         L     IOEHOLDR,WRTIOEQ                                    0475 01508000
*             WRTIOEQ=0;            /* ZERO FOR RECOVERY BEFORE PUT     01509000
*                                      ON SPILL QUEUE                */ 01510000
         ST    @12,WRTIOEQ                                         0476 01511000
*             IF PARTSPLL^=0 THEN   /* SOME ALREADY THERE?           */ 01512000
         L     @11,PARTPTR                                         0477 01513000
         L     @11,PARTSPLL(,@11)                                  0477 01514000
         CR    @11,@12                                             0477 01515000
         BE    @RF00477                                            0477 01516000
*               PARTSPLL->IOENXT=IOEHOLDR;/* CHAIN PLIST WRITES TO 0478 01517000
*                                      END                           */ 01518000
         ST    IOEHOLDR,IOENXT(,@11)                               0478 01519000
*             ELSE                  /* NO-                           */ 01520000
*               PARTSPLF=IOEHOLDR;  /* THESE ARE THE FIRST           */ 01521000
         B     @RC00477                                            0479 01522000
@RF00477 L     @12,PARTPTR                                         0479 01523000
         ST    IOEHOLDR,PARTSPLF(,@12)                             0479 01524000
*             PARTSPLL=IOEPTR;      /* RESET SPILL QUEUE LAST PTR    */ 01525000
@RC00477 L     @12,PARTPTR                                         0480 01526000
         ST    IOEPTR,PARTSPLL(,@12)                               0480 01527000
*             PRESCHED=ON;          /* INDICATE RESCHED REQD         */ 01528000
         OI    PRESCHED,B'00100000'                                0481 01529000
*           END;                    /* END PLPA OK- FORCING WRITES TO   01530000
*                                      SPILL QUEUE                   */ 01531000
*         ASMCOMMF=ON;              /* INDICATE COMMON FILLED      0483 01532000
*                                                            @Z40WPWP*/ 01533000
@RC00453 OI    ASMCOMMF(ASMVTPTR),B'00000010'                      0483 01534000
*       END;                        /* END COMMON FILLED             */ 01535000
*                                                                  0485 01536000
*   /*****************************************************************/ 01537000
*   /*                                                               */ 01538000
*   /* FILLED THE DUPLEX DATA SET. IF WE WERE DEPENDING ON DUPLEXING,*/ 01539000
*   /* GOTO ILRMSG00 WITH MSG ILR0008W WHICH WILL TERMINATE THE      */ 01540000
*   /* SYSTEM. OTHERWISE, SUSPEND DUPLEXING AND MARK EACH AIA AS     */ 01541000
*   /* SECONDARY ERROR AND GOTO ILRMSG00 WITH MSG ILR0007I.          */ 01542000
*   /*                                                               */ 01543000
*   /*****************************************************************/ 01544000
*                                                                  0485 01545000
*     ELSE                          /* NOT COMMON- MUST BE DUPLEX  0485 01546000
*                                      THAT FILLED                   */ 01547000
*       IF ASMNOCWQ=ON|             /* NO COMMON WRITE QUEUE OR      */ 01548000
*           (ASMPLPAF=ON&ASMCOMMF=ON) THEN/* BOTH PLPA & COMM FULL 0485 01549000
*                                      INDICATES DEPEND ON DUPLEX    */ 01550000
         B     @RC00445                                            0485 01551000
@RF00445 TM    ASMNOCWQ(ASMVTPTR),B'01000000'                      0485 01552000
         BO    @RT00485                                            0485 01553000
         TM    ASMPLPAF(ASMVTPTR),B'00000110'                      0485 01554000
         BNO   @RF00485                                            0485 01555000
@RT00485 DS    0H                                                  0486 01556000
*         DO;                       /* TROUBLE- SET UP FOR         0486 01557000
*                                      TERMINATION MSG               */ 01558000
*           MSGNUM=MSGEIGHT;        /* SET MSG NUMBER                */ 01559000
         MVC   MSGNUM(2),@CH00040                                  0487 01560000
*           EPAMSPAD=ADDR(MSGPLIST);/* INDICATE NEED TO ISSUE MSG    */ 01561000
         LA    @12,MSGPLIST                                        0488 01562000
         ST    @12,EPAMSPAD                                        0488 01563000
*         END;                      /* END DEPENDING ON DUPLEX       */ 01564000
*       ELSE                        /* NOT DEPENDING ON DUPLEX-      */ 01565000
*         DO;                       /* CAN CONTINUE WITHOUT IT       */ 01566000
         B     @RC00485                                            0490 01567000
@RF00485 DS    0H                                                  0491 01568000
*           IF ASMNODPX=OFF&ASMDUPLX=ON THEN/* MSG NOT ISSUED BEFORE?*/ 01569000
         TM    ASMDUPLX(ASMVTPTR),B'10000000'                      0491 01570000
         BNO   @RF00491                                            0491 01571000
         TM    ASMNODPX(ASMVTPTR),B'00001000'                      0491 01572000
         BNZ   @RF00491                                            0491 01573000
*             DO;                   /* YES- SET UP TO ISSUE          */ 01574000
*               MSGNUM=MSGSEVEN;    /* MESSAGE ILR0007I              */ 01575000
         MVC   MSGNUM(2),@CH01285                                  0493 01576000
*               EPAMSPAD=ADDR(MSGPLIST);/* MSG REQD                  */ 01577000
         LA    @12,MSGPLIST                                        0494 01578000
         ST    @12,EPAMSPAD                                        0494 01579000
*               ASMNODPX=ON;        /* INDICATE DUPLEXING HAS        */ 01580000
*               ASMDUPLX=OFF;       /* BEEN SUSPENDED                */ 01581000
         OI    ASMNODPX(ASMVTPTR),B'00001000'                      0496 01582000
         NI    ASMDUPLX(ASMVTPTR),B'01111111'                      0496 01583000
*             END;                  /* END MSG NOT ISSUED BEFORE     */ 01584000
*           ELSE                                                   0498 01585000
*             ;                     /* MSG ISSUED BEFORE             */ 01586000
*                                                                  0498 01587000
@RF00491 DS    0H                                                  0499 01588000
*           /*********************************************************/ 01589000
*           /*                                                       */ 01590000
*           /* MARK EACH AIA SECONDARY ERROR, QUEUE TO PARTAIAE      */ 01591000
*           /* QUEUE, AND FREE EACH IOE.                             */ 01592000
*           /*                                                       */ 01593000
*           /*********************************************************/ 01594000
*                                                                  0499 01595000
*           CALL STOPWRT;           /* MARK AIAS AS SECONDARY ERROR     01596000
*                                      AND FREE IOES                 */ 01597000
         BAL   @14,STOPWRT                                         0499 01598000
*         END;                      /* END NOT DEPEND ON DUPLEX &  0500 01599000
*                                      CONTINUING WITHOUT            */ 01600000
*                                                                  0501 01601000
*   /*****************************************************************/ 01602000
*   /*                                                               */ 01603000
*   /* DETERMINE IF IT IS NECESSARY TO CALL ILRMSG00. IF CALL        */ 01604000
*   /* ILRMSG00, MAY NOT GET CONTROL BACK- SYSTEM MAY BE TERMINATED. */ 01605000
*   /* IF CONTROL IS RETURNED, FREE SALLOC AND RETURN TO MAINLINE.   */ 01606000
*   /*                                                               */ 01607000
*   /*****************************************************************/ 01608000
*                                                                  0501 01609000
*   IF EPAMSPAD^=0 THEN             /* MSG REQD?                     */ 01610000
@RC00485 DS    0H                                                  0501 01611000
@RC00445 DS    0H                                                  0501 01612000
@RC00414 L     @12,EPAMSPAD                                        0501 01613000
         LTR   @12,@12                                             0501 01614000
         BZ    @RF00501                                            0501 01615000
*     DO;                                                          0502 01616000
*       RFY                                                        0503 01617000
*        (R1,                                                      0503 01618000
*         R13) RSTD;                                               0503 01619000
*       R13=ADDR(PTMSAVE);          /* SAVE AREA                     */ 01620000
         LA    R13,PTMSAVE                                         0504 01621000
*       R1=EPAMSPAD;                /* SET INTERFACE TO MSG00        */ 01622000
         LR    R1,@12                                              0505 01623000
*       CALL ILRMSG00;                                             0506 01624000
         L     @15,@CV01759                                        0506 01625000
         BALR  @14,@15                                             0506 01626000
*       EPAMSPAD=0;                 /* ZERO FOR RECOVERY             */ 01627000
         SLR   @12,@12                                             0507 01628000
         ST    @12,EPAMSPAD                                        0507 01629000
*       RFY                                                        0508 01630000
*        (R1,                                                      0508 01631000
*         R13) UNRSTD;                                             0508 01632000
*     END;                                                         0509 01633000
*   ELSE                                                           0510 01634000
*     ;                             /* MSG NOT REQD                  */ 01635000
@RF00501 DS    0H                                                  0511 01636000
*   RFY                                                            0511 01637000
*    (R11,                                                         0511 01638000
*     R12,                                                         0511 01639000
*     R13,                                                         0511 01640000
*     R14) RSTD;                                                   0511 01641000
*PTMUNLK2:                                                         0512 01642000
*   GEN REFS(R12,R13,R14,PSALITA,FLC);                             0512 01643000
PTMUNLK2 DS    0H                                                  0512 01644000
         SETLOCK RELEASE,TYPE=SALLOC,RELATED=(ASMVT,ILRPTM(PTMLK2))     01645000
*   RFY                                                            0513 01646000
*    (R11,                                                         0513 01647000
*     R12,                                                         0513 01648000
*     R13) UNRSTD;                                                 0513 01649000
*   R14=RETADDR1;                   /* RESTORE RETURN ADDRESS        */ 01650000
         L     R14,RETADDR1                                        0514 01651000
*   RFY                                                            0515 01652000
*     R14 UNRSTD;                                                  0515 01653000
*   END DSFULL;                                                    0516 01654000
@EL00005 DS    0H                                                  0516 01655000
@EF00005 DS    0H                                                  0516 01656000
@ER00005 BR    @14                                                 0516 01657000
*                                                                  0517 01658000
*/********************************************************************/ 01659000
*/*                                                                  */ 01660000
*/* STOPWRT: MARK AIAS AND FREE IOES                                 */ 01661000
*/*                                                                  */ 01662000
*/* INPUT: IOEPTR ADDRESSES ONE OR MORE WRITE IOES                   */ 01663000
*/*                                                                  */ 01664000
*/* PROCESS: USE ASMDUPLX FLAG TO DETERMINE CALLER OF STOPWRT.       */ 01665000
*/*          IF ON, WE HAD FILLED PLPA OR COMMON DS AND ARE          */ 01666000
*/*          RELYING ON DUPLX. THEREFORE THE AIALSID FIELD IS        */ 01667000
*/*          SET TO ZERO. OTHERWISE (ASMDUPLX IS OFF) WE HAD         */ 01668000
*/*          FILLED DUPLEX BUT WE ARE NOT DEPENDING ON IT TO         */ 01669000
*/*          CONTINUE SO THE AIASECER BIT IS SET.  EITHER WAY,       */ 01670000
*/*          IF THE AIADPXCT IS NOT EQUAL T0 TWO THEN                */ 01671000
*/*          EACH AIA IS PLACED ON THE PARTAIAE ERROR QUEUE          */ 01672000
*/*          USING C+S AND EACH IOE IS FREED USING ILRGMA.           */ 01673000
*/*                                                                  */ 01674000
*/* OUTPUT: PARTAIAE CONTAINS AIAS MARKED ACCORDINGLY.               */ 01675000
*/*                                                                  */ 01676000
*/* NOTE: THIS ROUTINE IS ONLY CALLED IF THE SYSTEM WAS DUPLEXING    */ 01677000
*/*                                                                  */ 01678000
*/********************************************************************/ 01679000
*                                                                  0517 01680000
*STOPWRT:                                                          0517 01681000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0517 01682000
STOPWRT  DS    0H                                                  0518 01683000
*   RFY                                                            0518 01684000
*     R14 RSTD;                                                    0518 01685000
*   RETADDR2=R14;                   /* SAVE RETURN ADDRESS           */ 01686000
         ST    R14,RETADDR2                                        0519 01687000
*   RFY                                                            0520 01688000
*     R14 UNRSTD;                                                  0520 01689000
*   IOEPTR=WRTIOEQ;                 /* REMOVE IOES FROM PLIST      0521 01690000
*                                                            @Z40WPWP*/ 01691000
         L     IOEPTR,WRTIOEQ                                      0521 01692000
*   WRTIOEQ=0;                      /*                       @Z40WPWP*/ 01693000
         SLR   @12,@12                                             0522 01694000
         ST    @12,WRTIOEQ                                         0522 01695000
*   DO WHILE(IOEPTR^=0);            /* LOOP THRU IOES FOR THIS D.S.  */ 01696000
         B     @DE00523                                            0523 01697000
@DL00523 DS    0H                                                  0524 01698000
*     IF ASMDUPLX=ON THEN           /* USING DUPLEX- PLPA OR COMM  0524 01699000
*                                      FILLED?                       */ 01700000
         TM    ASMDUPLX(ASMVTPTR),B'10000000'                      0524 01701000
         BNO   @RF00524                                            0524 01702000
*       IOEAIA->AIALSID=0;          /* TELL PAGCM WHAT HAPPENED      */ 01703000
         L     @12,IOEAIA(,IOEPTR)                                 0525 01704000
         SLR   @11,@11                                             0525 01705000
         ST    @11,AIALSID(,@12)                                   0525 01706000
*     ELSE                          /* NO- DUPLEX FILLED BUT NOT   0526 01707000
*                                      DEPENDING ON IT               */ 01708000
*       IOEAIA->AIASECER=ON;        /* TELL PAGCM WHAT HAPPENED      */ 01709000
         B     @RC00524                                            0526 01710000
@RF00524 L     @12,IOEAIA(,IOEPTR)                                 0526 01711000
         OI    AIASECER(@12),B'00000100'                           0526 01712000
*     IF IOEAIA->AIADPXCT=2 THEN    /* 2 REQUESTS OUTSTANDING      0527 01713000
*                                                            @Z40WPWP*/ 01714000
@RC00524 L     @12,IOEAIA(,IOEPTR)                                 0527 01715000
         L     @11,AIADPXCT(,@12)                                  0527 01716000
         C     @11,@CF00082                                        0527 01717000
         BNE   @RF00527                                            0527 01718000
*       IOEAIA->AIADPXCT=IOEAIA->AIADPXCT-1;/* LET PAGCM KNOW THAT 0528 01719000
*                                      ONLY ONE REQUEST IS LEFT AND     01720000
*                                      DO NOT PUT ON PARTAIAE      0528 01721000
*                                                            @Z40WPWP*/ 01722000
         BCTR  @11,0                                               0528 01723000
         ST    @11,AIADPXCT(,@12)                                  0528 01724000
*     ELSE                                                         0529 01725000
*       DO;                         /* PUT THE AIA ON THE PARTAIAE 0529 01726000
*                                      QUEUE                 @Z40WPWP*/ 01727000
         B     @RC00527                                            0529 01728000
@RF00527 DS    0H                                                  0530 01729000
*         RFY                                                      0530 01730000
*          (R0,                                                    0530 01731000
*           R1) RSTD;                                              0530 01732000
*         R1=IOEAIA;                /* GET THIS IOES AIA             */ 01733000
         L     R1,IOEAIA(,IOEPTR)                                  0531 01734000
*         IOEAIA=0;                 /* REMOVE FROM IOE               */ 01735000
         SLR   @12,@12                                             0532 01736000
         ST    @12,IOEAIA(,IOEPTR)                                 0532 01737000
*         R0=PARTAIAE;              /* GET HEAD OF ERROR QUEUE       */ 01738000
         L     @12,PARTPTR                                         0533 01739000
         L     R0,PARTAIAE(,@12)                                   0533 01740000
*RETRYAI1:                                                         0534 01741000
*         R1->AIANXAIA=R0;          /* CHAIN IN EXISTING AIA'S       */ 01742000
RETRYAI1 ST    R0,AIANXAIA(,R1)                                    0534 01743000
*         CS(R0,R1,PARTAIAE);       /* UPDATE THE QUEUE              */ 01744000
         L     @12,PARTPTR                                         0535 01745000
         CS    R0,@01,PARTAIAE(@12)                                0535 01746000
*         BC(NE,RETRYAI1);                                         0536 01747000
         BC    7,RETRYAI1                                          0536 01748000
*         RFY                                                      0537 01749000
*           R0 UNRSTD;                                             0537 01750000
*       END;                        /* FOR PUT AIA ON PARTAIAE QUEUE    01751000
*                                                            @Z40WPWP*/ 01752000
*     R1=IOEPTR;                    /* SET UP TO FREE THIS IOE       */ 01753000
@RC00527 LR    R1,IOEPTR                                           0539 01754000
*     IOEPTR=IOENXT;                /* GET NEXT IOE                  */ 01755000
*                                                                  0540 01756000
         L     IOEPTR,IOENXT(,IOEPTR)                              0540 01757000
*     /***************************************************************/ 01758000
*     /*                                                             */ 01759000
*     /* BEGIN ILRGMA MACRO EXPANSION                                */ 01760000
*     /*                                                             */ 01761000
*     /***************************************************************/ 01762000
*                                                                  0541 01763000
*     DO;                           /* ILRGMA FREE                 0541 01764000
*                                      CELL(IOE)WORKREGS(R11,R12)    */ 01765000
*       DECLARE                     /* ASMVT VECTOR TO ILRPEX        */ 01766000
*         ILRPEX ENTRY BASED(ASMPEX) VALRG(0);                     0542 01767000
*       DECLARE                     /* MAP FOR CELL CONTROL WORDS    */ 01768000
*         1 GMACELL BASED BDY(WORD),                               0543 01769000
*          2 GMANEXT PTR(31);       /* PTR NEXT FREE CELL            */ 01770000
*       RESPECIFY                                                  0544 01771000
*        (R0,                                                      0544 01772000
*         R1,                                                      0544 01773000
*         R11,                                                     0544 01774000
*         R12,                                                     0544 01775000
*         R14,                                                     0544 01776000
*         R15) RESTRICTED;                                         0544 01777000
*       RESPECIFY                                                  0545 01778000
*         ASMPOOLS BASED(R11);                                     0545 01779000
*       RESPECIFY                                                  0546 01780000
*         GMACELL BASED(R1);                                       0546 01781000
*       R11=ADDR(ASMIOEPC);                                        0547 01782000
         LA    R11,ASMIOEPC(,ASMVTPTR)                             0547 01783000
*       R14=ASMCPAVL;                                              0548 01784000
         L     R14,ASMCPAVL(,R11)                                  0548 01785000
*GMA00012:                                                         0549 01786000
*       GMANEXT=R14;                /* PUT ADDR CURRENT FIRST IN   0549 01787000
*                                      INPUT CELL                    */ 01788000
GMA00012 ST    R14,GMANEXT(,R1)                                    0549 01789000
*       CS(R14,R1,ASMCPAVL);        /* ADD INPUT CELL TO POOL        */ 01790000
         CS    R14,@01,ASMCPAVL(R11)                               0550 01791000
*       BC(7,GMA00012);                                            0551 01792000
         BC    7,GMA00012                                          0551 01793000
*       RESPECIFY                                                  0552 01794000
*        (R0,                                                      0552 01795000
*         R1,                                                      0552 01796000
*         R11,                                                     0552 01797000
*         R12,                                                     0552 01798000
*         R14,                                                     0552 01799000
*         R15) UNRESTRICTED;                                       0552 01800000
*     END;                          /* ILRGMA FREE                 0553 01801000
*                                      CELL(IOE)WORKREGS(R11,R12)    */ 01802000
*                                                                  0553 01803000
*     /***************************************************************/ 01804000
*     /*                                                             */ 01805000
*     /* END ILRGMA MACRO EXPANSION                                  */ 01806000
*     /*                                                             */ 01807000
*     /***************************************************************/ 01808000
*                                                                  0554 01809000
*     RFY                                                          0554 01810000
*       R1 UNRSTD;                                                 0554 01811000
*   END;                            /* END DO WHILE IOES             */ 01812000
@DE00523 LTR   IOEPTR,IOEPTR                                       0555 01813000
         BNZ   @DL00523                                            0555 01814000
*   RFY                                                            0556 01815000
*     R14 RSTD;                                                    0556 01816000
*   R14=RETADDR2;                   /* RESTORE RETURN ADDRESS        */ 01817000
         L     R14,RETADDR2                                        0557 01818000
*   RFY                                                            0558 01819000
*     R14 UNRSTD;                                                  0558 01820000
*   END STOPWRT;                                                   0559 01821000
@EL00006 DS    0H                                                  0559 01822000
@EF00006 DS    0H                                                  0559 01823000
@ER00006 BR    @14                                                 0559 01824000
*                                                                  0560 01825000
*/********************************************************************/ 01826000
*/*                                                                  */ 01827000
*/*      SORTREAD: SORT ANY NEW READ REQUESTS, IF ANY                */ 01828000
*/*                                                                  */ 01829000
*/*      INPUT: ADDR OF FIRST READ IOE IN PARTE LIFO QUEUE           */ 01830000
*/*             PART ENTRY                                           */ 01831000
*/*                                                                  */ 01832000
*/*      PROCESS: THE ENTIRE QUEUE OF READ IOES IS REMOVED FROM THE  */ 01833000
*/*               PART ENTRY VIA C&S. THE SPECIFIC INTENT OF THIS    */ 01834000
*/*               ROUTINE IS TO ADD EACH IOE FROM THE QUEUE TO ITS   */ 01835000
*/*               APPROPRIATE PLACE ON A TWO DIRECTION (<= AND >)    */ 01836000
*/*               TREE.  THE FIRST IOE ON THE TREE IS ANCHORED IN THE*/ 01837000
*/*               PART ENTRY.  EACH SUCCESSIVE IOE IS ADDED ON THE   */ 01838000
*/*               END OF A "LEG" OF THE TREE IF POSSIBLE. HOWEVER,   */ 01839000
*/*               IN ORDER TO GROUP IOES REPRESENTING READ REQUESTS  */ 01840000
*/*               FROM THE SAME RELATIVE CYLINDER OF THE PAGING SPACE*/ 01841000
*/*               AN INSERTION OF AN IOE IS SOMETIMES NECESSARY IN   */ 01842000
*/*               THE MIDDLE OF A 'LEG'. WITH THIS EXCEPTION, SORTING*/ 01843000
*/*               IS PERFORMED BY RELATIVE SLOT NUMBER (CONTAINED IN */ 01844000
*/*               THE AIA ADDRESSED FROM THE IOE).                   */ 01845000
*/*                                                                  */ 01846000
*/*               FOR EACH IOE, THE RELATIVE SLOT NUMBER IN THE      */ 01847000
*/*               CORRESPONDING AIA IS TRANSLATED INTO A RELATIVE    */ 01848000
*/*               CYLINDER VALUE AND A RELATIVE SLOT WITHIN THE      */ 01849000
*/*               CYLINDER.  THESE VALUES ARE SOTRED IN THE AIA AND  */ 01850000
*/*               ARE USED ELSEWHERE IN THE MODULE WHEN HANDLING READ*/ 01851000
*/*               IOES ON THE TREE.                                  */ 01852000
*/*                                                                  */ 01853000
*/*               SPECIAL CASE: IF THERE IS ONLY ONE IOE ON THE PART */ 01854000
*/*               ENTRY READ QUEUE AND NO IOES ALREADY EXIST ON THE  */ 01855000
*/*               TREE AND NO WRITE REQUESTS ARE PRESENT, THEN THE   */ 01856000
*/*               ONE READ REQUEST IS PROCESSED VIA A FAST PATH THRU */ 01857000
*/*               SLOT SORT.  INSTEAD OF ADDING THE REQUEST TO THE   */ 01858000
*/*               TREE, THE ELEMENT ADDRESS IS COMPLIMENTED AND      */ 01859000
*/*               PLACED ON PARENODE.  SLOT SORT RECOGNIZES THIS     */ 01860000
*/*               AND WILL USE A QUICK PATH TO PROCESS THIS IOE.     */ 01861000
*/*                                                                  */ 01862000
*/*      OUTPUT:  ALWAYS - RELATIVE CYLINDER AND SLOT IN CYLINDER    */ 01863000
*/*                        VALUES STORED IN EACH AIA ADDRESSED BY    */ 01864000
*/*                        EACH IOE.                                 */ 01865000
*/*               ORDINARY - UPDATED TREE HANGING FROM PART ENTRY    */ 01866000
*/*               SPECIAL CASE - COMPLIMENTED IOE ADDRESS ON         */ 01867000
*/*                              PARENODE.                           */ 01868000
*/*                                                                  */ 01869000
*/*                                                                  */ 01870000
*/********************************************************************/ 01871000
*                                                                  0560 01872000
*SORTREAD:                                                         0560 01873000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0560 01874000
SORTREAD DS    0H                                                  0561 01875000
*   RFY                                                            0561 01876000
*     R14 RSTD;                                                    0561 01877000
*   RETADDR1=R14;                   /* SAVE RETURN ADDRESS           */ 01878000
         ST    R14,RETADDR1                                        0562 01879000
*   RFY                                                            0563 01880000
*     R14 UNRSTD;                                                  0563 01881000
*                                                                  0563 01882000
*   /*****************************************************************/ 01883000
*   /*                                                               */ 01884000
*   /* GET READ REQUESTS FROM PART ENTRY, USING COMPARE AND SWAP     */ 01885000
*   /*                                                               */ 01886000
*   /*****************************************************************/ 01887000
*                                                                  0564 01888000
*   IOEPTR=PAREIOEQ;                /* GET CURRENT UNSORTED READ QUE    01889000
*                                      CONTENTS                      */ 01890000
         L     @12,PAREPTR                                         0564 01891000
         L     IOEPTR,PAREIOEQ(,@12)                               0564 01892000
*   RFY                                                            0565 01893000
*     R0 RSTD;                                                     0565 01894000
*   R0=ZERO;                        /* TO SET PARTE FIELD TO ZERO    */ 01895000
         SLR   R0,R0                                               0566 01896000
*READLOOP:                                                         0567 01897000
*   CS(IOEPTR,R0,PAREIOEQ);         /* ATTEMPT TO OBTAIN READS       */ 01898000
READLOOP L     @12,PAREPTR                                         0567 01899000
         CS    IOEPTR,@00,PAREIOEQ(@12)                            0567 01900000
*   BC(NE,READLOOP);                /* UNSUCCESSFUL, TRY AGAIN       */ 01901000
         BC    7,READLOOP                                          0568 01902000
*   RFY                                                            0569 01903000
*     R0 UNRSTD;                                                   0569 01904000
*   EPAIOEQP=IOEPTR;                /* SET FOR RECOVERY              */ 01905000
*                                                                  0570 01906000
         ST    IOEPTR,EPAIOEQP                                     0570 01907000
*   /*****************************************************************/ 01908000
*   /*                                                               */ 01909000
*   /* ------ LOOP UNTIL ALL THE READ REQUEST IOES HAVE BEEN SORTED  */ 01910000
*   /*                                                               */ 01911000
*   /*****************************************************************/ 01912000
*                                                                  0571 01913000
*   DO WHILE IOEPTR^=ZERO;                                         0571 01914000
         B     @DE00571                                            0571 01915000
@DL00571 DS    0H                                                  0572 01916000
*     AIAPTR=IOEAIA;                /* GET PTR TO AIA                */ 01917000
*                                                                  0572 01918000
         L     AIAPTR,IOEAIA(,IOEPTR)                              0572 01919000
*     /***************************************************************/ 01920000
*     /*                                                             */ 01921000
*     /* OBTAIN THE RELATIVE SLOT NUMBER OF THIS READ REQUEST FROM   */ 01922000
*     /* THE AIA... CALCULATE THE RELATIVE CYLINDER WHERE IT IS IN   */ 01923000
*     /* THE PAGING SPACE AND ITS RELATIVE SLOT NUMBER WITHIN THE    */ 01924000
*     /* CYLINDER...                                                 */ 01925000
*     /*                                                             */ 01926000
*     /***************************************************************/ 01927000
*                                                                  0573 01928000
*     TSLOTNBR=AIASLOT;             /* GET REL. SLOT# FOR REQ        */ 01929000
         LH    TSLOTNBR,AIASLOT(,AIAPTR)                           0573 01930000
         N     TSLOTNBR,@CF01849                                   0573 01931000
*     RFY                                                          0574 01932000
*      (R0,                                                        0574 01933000
*       R1) RSTD;                                                  0574 01934000
*     R1=TSLOTNBR;                  /* RELATIVE SLOT# IN PGG SPACE   */ 01935000
         LR    R1,TSLOTNBR                                         0575 01936000
*     R0=ZERO;                      /* ZERO EVEN REG OF PAIR         */ 01937000
         SLR   R0,R0                                               0576 01938000
*     CYLSLOTS=PATCYLSZ;            /* NBR SLOTS PER CYLINDER        */ 01939000
         L     @08,PAREPTR                                         0577 01940000
         L     @08,PATPTR(,@08)                                    0577 01941000
         LH    @08,PATCYLSZ(,@08)                                  0577 01942000
         ST    @08,CYLSLOTS                                        0577 01943000
*     GEN(D     R0,CYLSLOTS)        /* DIVIDE FOR DESIRED VALUES     */ 01944000
*     REFS(CYLSLOTS);                                              0578 01945000
         D     R0,CYLSLOTS                                              01946000
*     AIARCSN=R0;                   /* REMAINDER: REL SLOT# IN CYL   */ 01947000
         STH   R0,AIARCSN(,AIAPTR)                                 0579 01948000
*     AIACYL=R1;                    /* QUOTIENT: RELATIVE CYL NBR    */ 01949000
         STH   R1,AIACYL(,AIAPTR)                                  0580 01950000
*     THISCYL=R1;                   /* REL CYL NBR TO WRK VBL        */ 01951000
         LR    THISCYL,R1                                          0581 01952000
*     RFY                                                          0582 01953000
*      (R0,                                                        0582 01954000
*       R1) UNRSTD;                                                0582 01955000
*                                                                  0582 01956000
*     /***************************************************************/ 01957000
*     /*                                                             */ 01958000
*     /* PROCEED TO ADD IOE TO THE SORTED READ REQUEST TREE          */ 01959000
*     /*                                                             */ 01960000
*     /***************************************************************/ 01961000
*                                                                  0583 01962000
*     THISNODE=PARENODE;            /* INITLZ CURRENT NODE ADDR      */ 01963000
         L     @08,PAREPTR                                         0583 01964000
         L     THISNODE,PARENODE(,@08)                             0583 01965000
*     EPAIOEQP=IOENXT;              /* SET FOR RECOVERY              */ 01966000
         L     @05,IOENXT(,IOEPTR)                                 0584 01967000
         ST    @05,EPAIOEQP                                        0584 01968000
*     EPAIOEIP=IOEPTR;              /* SET FOR RECOVERY              */ 01969000
         ST    IOEPTR,EPAIOEIP                                     0585 01970000
*     IOENXTLE=ZERO;                /* ZERO LE LEG PTR               */ 01971000
         SLR   @15,@15                                             0586 01972000
         ST    @15,IOENXTLE(,IOEPTR)                               0586 01973000
*     IOENXTGT=ZERO;                /* ZERO GT LEG PTR               */ 01974000
*                                                                  0587 01975000
         ST    @15,IOENXTGT(,IOEPTR)                               0587 01976000
*     /***************************************************************/ 01977000
*     /*                                                             */ 01978000
*     /* IF NO READ IOES ARE CURRENTLY ON THE TREE AND ONLY ONE      */ 01979000
*     /* EXISTS ON THE CURRENT QUEUE AND NO WRITES EXIST THEN SPECIAL*/ 01980000
*     /* CASE THIS ONE READ AND SKIP OVERHEAD BY COMPLIMENTING THE   */ 01981000
*     /* IOE ADDR AND PLACE ON PARENODE FOR SLOT SORT. IF THE LATTER */ 01982000
*     /* CONDITIONS ARE NOT TRUE THEN ADD THIS CURRENT IOE FIRST ON  */ 01983000
*     /* THE TREE.                                                   */ 01984000
*     /*                                                             */ 01985000
*     /***************************************************************/ 01986000
*                                                                  0588 01987000
*     IF THISNODE=ZERO THEN         /* NO IOES ALREADY ON TREE ?     */ 01988000
         CR    THISNODE,@15                                        0588 01989000
         BNE   @RF00588                                            0588 01990000
*       IF EPAIOEQP=ZERO&           /* NO SECOND IOE ? -AND-         */ 01991000
*           WRTIOEQ=ZERO THEN       /* NO WRITE IOES ?               */ 01992000
         CR    @05,@15                                             0589 01993000
         BNE   @RF00589                                            0589 01994000
         C     @15,WRTIOEQ                                         0589 01995000
         BNE   @RF00589                                            0589 01996000
*         PARENODE=-IOEPTR;         /* COMPLIMENT ADDRESS FOR SLOT 0590 01997000
*                                      SORT                          */ 01998000
         LCR   @12,IOEPTR                                          0590 01999000
         ST    @12,PARENODE(,@08)                                  0590 02000000
*       ELSE                        /* NO SPECIAL CASE ?             */ 02001000
*         DO;                                                      0591 02002000
*                                                                  0591 02003000
         B     @RC00589                                            0591 02004000
@RF00589 DS    0H                                                  0592 02005000
*           /*********************************************************/ 02006000
*           /*                                                       */ 02007000
*           /* TO ADD FIRST IOE (OR NODE) TO TREE, SET THE PART ENTRY*/ 02008000
*           /* ANCHOR PTR TO THE IOE AND ZERO THE BACKWARD LEG PTR IN*/ 02009000
*           /* THE IOE                                               */ 02010000
*           /*                                                       */ 02011000
*           /*********************************************************/ 02012000
*                                                                  0592 02013000
*           PARENODE=IOEPTR;        /* PUT FIRST IOE ON TREE         */ 02014000
         L     @12,PAREPTR                                         0592 02015000
         ST    IOEPTR,PARENODE(,@12)                               0592 02016000
*           IOEBKPTR=ZERO;          /* ZERO BACKWARD LEG PTR         */ 02017000
         SLR   @12,@12                                             0593 02018000
         ST    @12,IOEBKPTR(,IOEPTR)                               0593 02019000
*         END;                                                     0594 02020000
*     ELSE                          /* AT LEAST ONE IOE ON TREE ?    */ 02021000
*                                                                  0595 02022000
*       /*************************************************************/ 02023000
*       /*                                                           */ 02024000
*       /* IF IOES ARE ALREADY HUNG ON THE TREE, INVOKE ADRTTREE TO  */ 02025000
*       /* ADD (SORT) THIS IOE TO ITS APPROPRIATE PLACE ON THE TREE  */ 02026000
*       /*                                                           */ 02027000
*       /*************************************************************/ 02028000
*                                                                  0595 02029000
*       CALL ADRTTREE;              /* CHAIN NEW IOE TO TREE         */ 02030000
*                                                                  0595 02031000
         B     @RC00588                                            0595 02032000
@RF00588 BAL   @14,ADRTTREE                                        0595 02033000
*     /***************************************************************/ 02034000
*     /*                                                             */ 02035000
*     /* GET ADDRESS OF NEXT IOE ON QUEUE FOR NEXT LOOP ITERATION    */ 02036000
*     /*                                                             */ 02037000
*     /***************************************************************/ 02038000
*                                                                  0596 02039000
*     IOEPTR=EPAIOEQP;              /* GET NEXT READ REQUEST         */ 02040000
@RC00588 L     IOEPTR,EPAIOEQP                                     0596 02041000
*   END;                            /* END LOOP TO SORT READS        */ 02042000
@DE00571 LTR   IOEPTR,IOEPTR                                       0597 02043000
         BNZ   @DL00571                                            0597 02044000
*   RFY                                                            0598 02045000
*     R14 RSTD;                                                    0598 02046000
*   R14=RETADDR1;                   /* RESTORE RETURN ADDRESS        */ 02047000
         L     R14,RETADDR1                                        0599 02048000
*   RFY                                                            0600 02049000
*     R14 UNRSTD;                                                  0600 02050000
*   END SORTREAD;                   /* END SUBROUTINE SORTREAD       */ 02051000
@EL00007 DS    0H                                                  0601 02052000
@EF00007 DS    0H                                                  0601 02053000
@ER00007 BR    @14                                                 0601 02054000
*                                                                  0602 02055000
*/********************************************************************/ 02056000
*/*                                                                  */ 02057000
*/*      ADRTTREE: SORT AN IOE TO THE TREE                           */ 02058000
*/*                                                                  */ 02059000
*/*      INPUT: ADDRESS OF TOP NODE (READ IOE) IN TREE               */ 02060000
*/*             ADDRESS OF IOE (NEW NODE) TO BE ADDED TO TREE        */ 02061000
*/*             RELATIVE SLOT NUMBER ASSOCIATED WITH NEW NODE        */ 02062000
*/*                                                                  */ 02063000
*/*      PROCESS: (SEE ALSO PROLOG FOR SUBROUTINE SORTREAD ABOVE)    */ 02064000
*/*               A LOOP IS EXECUTED TO MOVE DOWN THE TREE ONE NODE  */ 02065000
*/*               AT A TIME IN ORDER TO FIND THE APPROPRIATE NODE TO */ 02066000
*/*               WHICH THE NEW NODE IS TO BE CHAINED.  DECISION AS  */ 02067000
*/*               TO WHICH LEG TO MOVE DOWN THE TREE IS BASED ON THE */ 02068000
*/*               RESULT OF A COMPARE BETWEEN THE SLOT NUMBER ASSOC- */ 02069000
*/*               IATED WITH THE NEW NODE AND THAT OF THE CURRENT    */ 02070000
*/*               NODE ON THE TREE (EITHER GT (>) OR LE (<=)). IF    */ 02071000
*/*               IN MOVING DOWN THE TREE A NODE IS FOUND WHICH      */ 02072000
*/*               CORRESPONDS TO A READ REQUEST FOR THE SAME CYLINDER*/ 02073000
*/*               AS THE NEW NODE AND THE NEXT NODE DOWN THE APPRO-  */ 02074000
*/*               PRIATE LEG CORRESPONDS TO A REQUEST ON A DIFFERENT */ 02075000
*/*               CYLINDER, THEN THE NEW NODE IS INSERTED BETWEEN THE*/ 02076000
*/*               TWO LATTER NODES. OTHERWISE THE NEW NODE IS CHAINED*/ 02077000
*/*               ON THE END OF WHICHEVER LEG THE LOOP FINDS.        */ 02078000
*/*                                                                  */ 02079000
*/*      OUTPUT: NEW NODE ADDED TO TREE                              */ 02080000
*/*              NODE FIELDS ALTERED:                                */ 02081000
*/*               GIVEN X IS THE NEW NODE                            */ 02082000
*/*                     A IS NODE TO WHICH NEW NODE IS CHAINED       */ 02083000
*/*                     D IS NODE WHICH WAS PREVIOUSLY CHAINED TO A  */ 02084000
*/*                      (INSERTION CASE ONLY)                       */ 02085000
*/*               CASE 1. NEW NODE ADDED TO END OF LEG               */ 02086000
*/*                    -ADDR OF X IN APPROPRIATE LEG PTR OF A        */ 02087000
*/*                    -ADDR OF A IN BACKWARD POINTER OF X           */ 02088000
*/*               CASE 2. NEW NODE INSERTED                          */ 02089000
*/*                    -ALL OF CASE 1 PLUS                           */ 02090000
*/*                    -ADDR OF D IN APPROPRIATE LEG PTR OF X        */ 02091000
*/*                    -ADDR OF X IN BACKWARD POINTER OF D           */ 02092000
*/*                                                                  */ 02093000
*/********************************************************************/ 02094000
*                                                                  0602 02095000
*ADRTTREE:                                                         0602 02096000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0602 02097000
ADRTTREE DS    0H                                                  0603 02098000
*   RFY                                                            0603 02099000
*     R14 RSTD;                     /* RESTRICT RETURN REGISTER      */ 02100000
*                                                                  0603 02101000
*   /*****************************************************************/ 02102000
*   /*                                                               */ 02103000
*   /* LOOP, MOVING DOWN THE TREE ONE NODE WITH EACH ITERATION, UNTIL*/ 02104000
*   /* INPUT IOE HAS BEEN ADDED TO THE TREE                          */ 02105000
*   /*                                                               */ 02106000
*   /*****************************************************************/ 02107000
*                                                                  0604 02108000
*   EPAIOEIP=ZERO;                  /* SET FOR RECOVERY              */ 02109000
         SLR   @15,@15                                             0604 02110000
         ST    @15,EPAIOEIP                                        0604 02111000
*   DO WHILE THISNODE^=ZERO;                                       0605 02112000
*                                                                  0605 02113000
         B     @DE00605                                            0605 02114000
@DL00605 DS    0H                                                  0606 02115000
*     /***************************************************************/ 02116000
*     /*                                                             */ 02117000
*     /* DETERMINE WHICH WAY TO MOVE DOWN THE TREE----               */ 02118000
*     /*                                                             */ 02119000
*     /***************************************************************/ 02120000
*                                                                  0606 02121000
*     IF TSLOTNBR>                  /* WHICH WAY DOWN TREE ?         */ 02122000
*         THISNODE->IOEAIA->AIASLOT THEN                           0606 02123000
         L     @15,IOEAIA(,THISNODE)                               0606 02124000
         LH    @15,AIASLOT(,@15)                                   0606 02125000
         N     @15,@CF01849                                        0606 02126000
         CR    TSLOTNBR,@15                                        0606 02127000
         BNH   @RF00606                                            0606 02128000
*       DO;                                                        0607 02129000
*                                                                  0607 02130000
*         /***********************************************************/ 02131000
*         /*                                                         */ 02132000
*         /* IF THE NEW IOE REPRESENTS A REQUEST FROM A RELATIVE SLOT*/ 02133000
*         /* NUMBER GREATER THAN THAT OF THE CURRENT NODE BEING      */ 02134000
*         /* EXAMINED, THEN MOVE DOWN THE TREE ON THE GT LEG         */ 02135000
*         /*                                                         */ 02136000
*         /***********************************************************/ 02137000
*                                                                  0608 02138000
*         LASTNODE=THISNODE;        /* SAVE PREV NODE ADDRESS        */ 02139000
         LR    LASTNODE,THISNODE                                   0608 02140000
*         THISNODE=THISNODE->IOENXTGT;/* DOWN GT PATH                */ 02141000
*                                                                  0609 02142000
         L     THISNODE,IOENXTGT(,THISNODE)                        0609 02143000
*         /***********************************************************/ 02144000
*         /*                                                         */ 02145000
*         /* ADD THE IOE TO THE TREE IF WE ARE AT THE END OF THE GT  */ 02146000
*         /* LEG ----OR---- AN INSERTION IS NECESSARY. AN INSERTION  */ 02147000
*         /* IS NECESSARY WHEN IT IS APPARENT THAT NORMAL SORTING    */ 02148000
*         /* WOULD SEPARATE TWO NODES ASSOCIATED WITH REQUESTS FOR   */ 02149000
*         /* THE SAME CYLINDER WITH A NODE FOR A DIFFERENT CYLINDER  */ 02150000
*         /* REQUEST IN BETWEEN... IE. WHEN LASTNODE REPRESENTS A    */ 02151000
*         /* REQUEST FOR CYLINDER X, THE SAME AS THE NEW IOE, BUT    */ 02152000
*         /* THISNODE REPRESENTS A REQUEST FOR CYLINDER Y (>X)       */ 02153000
*         /*                                                         */ 02154000
*         /***********************************************************/ 02155000
*                                                                  0610 02156000
*         IF THISNODE=ZERO|         /* AT END OF LEG -OR-            */ 02157000
*             (THISCYL<THISNODE->IOEAIA->AIACYL&/* INSERTION         */ 02158000
*             THISCYL=LASTNODE->IOEAIA->AIACYL) THEN/* NECESSARY?    */ 02159000
         LTR   THISNODE,THISNODE                                   0610 02160000
         BZ    @RT00610                                            0610 02161000
         L     @15,IOEAIA(,THISNODE)                               0610 02162000
         CH    THISCYL,AIACYL(,@15)                                0610 02163000
         BNL   @RF00610                                            0610 02164000
         L     @15,IOEAIA(,LASTNODE)                               0610 02165000
         CH    THISCYL,AIACYL(,@15)                                0610 02166000
         BNE   @RF00610                                            0610 02167000
@RT00610 DS    0H                                                  0611 02168000
*           DO;                                                    0611 02169000
*                                                                  0611 02170000
*             /*******************************************************/ 02171000
*             /*                                                     */ 02172000
*             /* PROCESSING COMMON TO END-OF-LEG-ADDITION OR         */ 02173000
*             /* INSERTION...                                        */ 02174000
*             /*                                                     */ 02175000
*             /*******************************************************/ 02176000
*                                                                  0612 02177000
*             IOEBKPTR=LASTNODE;                                   0612 02178000
         ST    LASTNODE,IOEBKPTR(,IOEPTR)                          0612 02179000
*             LASTNODE->IOENXTGT=IOEPTR;                           0613 02180000
*                                                                  0613 02181000
         ST    IOEPTR,IOENXTGT(,LASTNODE)                          0613 02182000
*             /*******************************************************/ 02183000
*             /*                                                     */ 02184000
*             /* INSERT THE IOE, IF NECESSARY                        */ 02185000
*             /*                                                     */ 02186000
*             /*******************************************************/ 02187000
*                                                                  0614 02188000
*             IF THISNODE^=ZERO THEN/* NEW NODE TO BE INSERTED ?     */ 02189000
         LTR   THISNODE,THISNODE                                   0614 02190000
         BZ    @RF00614                                            0614 02191000
*               DO;                                                0615 02192000
*                 IOENXTGT=THISNODE;/* RECHAIN OLD GT NODE TO NEW    */ 02193000
         ST    THISNODE,IOENXTGT(,IOEPTR)                          0616 02194000
*                 THISNODE->IOEBKPTR=IOEPTR;/* RESET BWD PTR IN OLD     02195000
*                                      GT NODE                       */ 02196000
         ST    IOEPTR,IOEBKPTR(,THISNODE)                          0617 02197000
*                 THISNODE=ZERO;    /* SET CTL TO GET OUT OF LOOP    */ 02198000
         SLR   THISNODE,THISNODE                                   0618 02199000
*               END;                                               0619 02200000
*             ELSE                                                 0620 02201000
*               ;                                                  0620 02202000
@RF00614 DS    0H                                                  0621 02203000
*           END;                    /* END ADD-NODE-TO-GT-LEG        */ 02204000
*         ELSE                                                     0622 02205000
*           ;                                                      0622 02206000
@RF00610 DS    0H                                                  0623 02207000
*       END;                        /* END MOVE-DOWN-GT-LEG          */ 02208000
*     ELSE                                                         0624 02209000
*       DO;                                                        0624 02210000
*                                                                  0624 02211000
         B     @RC00606                                            0624 02212000
@RF00606 DS    0H                                                  0625 02213000
*         /***********************************************************/ 02214000
*         /*                                                         */ 02215000
*         /* IF THE NEW IOE REPRESENTS A REQUEST FROM A RELATIVE SLOT*/ 02216000
*         /* NUMBER LESS THAN OR EQUAL THAT OF THE CURRENT NODE BEING*/ 02217000
*         /* EXAMINED, THEN MOVE DOWN THE TREE ON THE LE LEG         */ 02218000
*         /*                                                         */ 02219000
*         /***********************************************************/ 02220000
*                                                                  0625 02221000
*         LASTNODE=THISNODE;        /* SAVE PREV NODE ADDRESS        */ 02222000
         LR    LASTNODE,THISNODE                                   0625 02223000
*         THISNODE=THISNODE->IOENXTLE;/* DOWN LE PATH                */ 02224000
*                                                                  0626 02225000
         L     THISNODE,IOENXTLE(,THISNODE)                        0626 02226000
*         /***********************************************************/ 02227000
*         /*                                                         */ 02228000
*         /* ADD THE IOE TO THE TREE IF WE ARE AT THE END OF THE LE  */ 02229000
*         /* LEG ----OR---- AN INSERTION IS NECESSARY. AN INSERTION  */ 02230000
*         /* IS NECESSARY WHEN IT IS APPARENT THAT NORMAL SORTING    */ 02231000
*         /* WOULD SEPARATE TWO NODES ASSOCIATED WITH REQUESTS FOR   */ 02232000
*         /* THE SAME CYLINDER WITH A NODE FOR A DIFFERENT CYLINDER  */ 02233000
*         /* REQUEST IN BETWEEN... IE. WHEN LASTNODE REPRESENTS A    */ 02234000
*         /* REQUEST FOR CYLINDER X, THE SAME AS THE NEW IOE, BUT    */ 02235000
*         /* THISNODE REPRESENTS A REQUEST FOR CYLINDER Y (<X)       */ 02236000
*         /*                                                         */ 02237000
*         /***********************************************************/ 02238000
*                                                                  0627 02239000
*         IF THISNODE=ZERO|         /* AT END OF LEG -OR-            */ 02240000
*             (THISCYL>THISNODE->IOEAIA->AIACYL&/* INSERTION         */ 02241000
*             THISCYL=LASTNODE->IOEAIA->AIACYL) THEN/* NECESSARY?    */ 02242000
         LTR   THISNODE,THISNODE                                   0627 02243000
         BZ    @RT00627                                            0627 02244000
         L     @15,IOEAIA(,THISNODE)                               0627 02245000
         CH    THISCYL,AIACYL(,@15)                                0627 02246000
         BNH   @RF00627                                            0627 02247000
         L     @15,IOEAIA(,LASTNODE)                               0627 02248000
         CH    THISCYL,AIACYL(,@15)                                0627 02249000
         BNE   @RF00627                                            0627 02250000
@RT00627 DS    0H                                                  0628 02251000
*           DO;                                                    0628 02252000
*                                                                  0628 02253000
*             /*******************************************************/ 02254000
*             /*                                                     */ 02255000
*             /* PROCESSING COMMON TO END-OF-LEG-ADDITION OR         */ 02256000
*             /* INSERTION...                                        */ 02257000
*             /*                                                     */ 02258000
*             /*******************************************************/ 02259000
*                                                                  0629 02260000
*             IOEBKPTR=LASTNODE;                                   0629 02261000
         ST    LASTNODE,IOEBKPTR(,IOEPTR)                          0629 02262000
*             LASTNODE->IOENXTLE=IOEPTR;                           0630 02263000
*                                                                  0630 02264000
         ST    IOEPTR,IOENXTLE(,LASTNODE)                          0630 02265000
*             /*******************************************************/ 02266000
*             /*                                                     */ 02267000
*             /* INSERT THE IOE, IF NECESSARY                        */ 02268000
*             /*                                                     */ 02269000
*             /*******************************************************/ 02270000
*                                                                  0631 02271000
*             IF THISNODE^=ZERO THEN/* NEW NODE TO BE INSERTED ?     */ 02272000
         LTR   THISNODE,THISNODE                                   0631 02273000
         BZ    @RF00631                                            0631 02274000
*               DO;                                                0632 02275000
*                 IOENXTLE=THISNODE;/* RECHAIN OLD LE NODE TO NEW    */ 02276000
         ST    THISNODE,IOENXTLE(,IOEPTR)                          0633 02277000
*                 THISNODE->IOEBKPTR=IOEPTR;/* RESET BWD PTR IN OLD     02278000
*                                      LE NODE                       */ 02279000
         ST    IOEPTR,IOEBKPTR(,THISNODE)                          0634 02280000
*                 THISNODE=ZERO;    /* SET CTL TO GET OUT OF LOOP    */ 02281000
         SLR   THISNODE,THISNODE                                   0635 02282000
*               END;                                               0636 02283000
*             ELSE                                                 0637 02284000
*               ;                                                  0637 02285000
@RF00631 DS    0H                                                  0638 02286000
*           END;                    /* END ADD-NODE-TO-LE-LEG        */ 02287000
*         ELSE                                                     0639 02288000
*           ;                                                      0639 02289000
@RF00627 DS    0H                                                  0640 02290000
*       END;                        /* END MOVE-DOWN-LE-LEG          */ 02291000
*   END;                            /* END LOOP TO FIND CHAIN NODE   */ 02292000
@RC00606 DS    0H                                                  0641 02293000
@DE00605 LTR   THISNODE,THISNODE                                   0641 02294000
         BNZ   @DL00605                                            0641 02295000
*   RFY                                                            0642 02296000
*     R14 UNRSTD;                   /* RELEASE RETURN REGISTER       */ 02297000
*   END ADRTTREE;                   /* END SUBROUTINE ADRTTREE       */ 02298000
@EL00008 DS    0H                                                  0643 02299000
@EF00008 DS    0H                                                  0643 02300000
@ER00008 BR    @14                                                 0643 02301000
*   END ILRPTM                                                     0644 02302000
*                                                                  0644 02303000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02304000
*/*%INCLUDE SYSLIB  (ILRAIA  )                                       */ 02305000
*/*%INCLUDE SYSLIB  (ILRASMVT)                                       */ 02306000
*/*%INCLUDE SYSLIB  (ILRATA  )                                       */ 02307000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 02308000
*/*%INCLUDE SYSLIB  (ILREPATH)                                       */ 02309000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 02310000
*/*%INCLUDE SYSLIB  (ILRIOE  )                                       */ 02311000
*/*%INCLUDE SYSLIB  (ILRIORB )                                       */ 02312000
*/*%INCLUDE SYSLIB  (IHALCCA )                                       */ 02313000
*/*%INCLUDE SYSLIB  (ILRPAT  )                                       */ 02314000
*/*%INCLUDE SYSLIB  (ILRPART )                                       */ 02315000
*/*%INCLUDE SYSLIB  (ILRPCCW )                                       */ 02316000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 02317000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 02318000
*/*%INCLUDE SYSLIB  (IHAWSAVT)                                       */ 02319000
*                                                                  0644 02320000
*       ;                                                          0644 02321000
@DATA    DS    0H                                                       02322000
@CH01299 DC    H'5'                                                     02323000
@CH00986 DC    H'6'                                                     02324000
@CH01285 DC    H'7'                                                     02325000
@CH00033 DC    H'10'                                                    02326000
@DATD    DSECT                                                          02327000
         DS    0F                                                       02328000
ILRPTM   CSECT                                                          02329000
         DS    0F                                                       02330000
@CF00082 DC    F'2'                                                     02331000
@CF00117 DC    F'4'                                                     02332000
@CF00040 DC    F'8'                                                     02333000
@CH00040 EQU   @CF00040+2                                               02334000
@CF00267 DC    F'12'                                                    02335000
@CF01247 DC    XL4'80000000'                                            02336000
@CF01723 DC    XL4'7FFFFFFF'                                            02337000
@CF01849 DC    XL4'0000FFFF'                                            02338000
@DATD    DSECT                                                          02339000
         DS    0D                                                       02340000
PARTPTR  DS    A                                                        02341000
CURQ     DS    A                                                        02342000
RETADDR1 DS    A                                                        02343000
RETADDR2 DS    A                                                        02344000
SRTCODSV DS    F                                                        02345000
CYLSLOTS DS    F                                                        02346000
EPATH    DS    CL40                                                     02347000
         ORG   EPATH                                                    02348000
EPAPARM  DS    AL4                                                      02349000
EPAIOEIP DS    AL4                                                      02350000
EPAIOEQP DS    AL4                                                      02351000
EPAFFIOE DS    AL4                                                      02352000
EPALFIOE DS    AL4                                                      02353000
EPAWRTQ  DS    AL4                                                      02354000
EPAWTPAT DS    AL4                                                      02355000
EPACYLA  DS    AL4                                                      02356000
EPAMSPAD DS    AL4                                                      02357000
EPAWRTCT DS    FL2                                                      02358000
EPACPUID DS    FL2                                                      02359000
         ORG   EPATH+40                                                 02360000
PARMLIST DS    CL20                                                     02361000
         ORG   PARMLIST                                                 02362000
IORBPTR  DS    AL4                                                      02363000
PAREPTR  DS    AL4                                                      02364000
PCCWPTR  DS    AL4                                                      02365000
WRTIOEQ  DS    AL4                                                      02366000
SRTWORK  DS    AL4                                                      02367000
         ORG   PARMLIST+20                                              02368000
@NM00048 DS    CL12                                                     02369000
         ORG   @NM00048                                                 02370000
LASTPARE DS    AL4                                                      02371000
QPARE    DS    AL4                                                      02372000
CIRCUPDT DS    AL4                                                      02373000
         ORG   @NM00048+12                                              02374000
MSGPLIST DS    CL8                                                      02375000
         ORG   MSGPLIST                                                 02376000
MSGNUM   DS    FL2                                                      02377000
MSGTYPE  DS    FL2                                                      02378000
MSGCBADR DS    AL4                                                      02379000
         ORG   MSGPLIST+8                                               02380000
PTMFLAGS DS    CL1                                                      02381000
         ORG   PTMFLAGS                                                 02382000
WRTLOCKD DS    BL1                                                      02383000
MOREWORK EQU   PTMFLAGS+0                                               02384000
PRESCHED EQU   PTMFLAGS+0                                               02385000
@NM00049 EQU   PTMFLAGS+0                                               02386000
         ORG   PTMFLAGS+1                                               02387000
         DS    CL3                                                      02388000
PTMSAVE  DS    18A                                                      02389000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02390000
@ENDDATD EQU   *                                                        02391000
ILRPTM   CSECT                                                          02392000
         NOPR  ((@ENDDATD-@DATD)/257*16)                                02393000
         DS    0F                                                       02394000
@SIZDATD DC    AL1(0)                                                   02395000
         DC    AL3(@ENDDATD-@DATD)                                      02396000
@CV01756 DC    V(ILRSRT01)                                              02397000
@CV01757 DC    V(ILRSRT)                                                02398000
@CV01758 DC    V(ILRPAGCM)                                              02399000
@CV01759 DC    V(ILRMSG00)                                              02400000
         DS    0D                                                       02401000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02402000
@01      EQU   01                                                       02403000
@02      EQU   02                                                       02404000
@03      EQU   03                                                       02405000
@04      EQU   04                                                       02406000
@05      EQU   05                                                       02407000
@06      EQU   06                                                       02408000
@07      EQU   07                                                       02409000
@08      EQU   08                                                       02410000
@09      EQU   09                                                       02411000
@10      EQU   10                                                       02412000
@11      EQU   11                                                       02413000
@12      EQU   12                                                       02414000
@13      EQU   13                                                       02415000
@14      EQU   14                                                       02416000
@15      EQU   15                                                       02417000
TSLOTNBR EQU   @11                                                      02418000
THISNODE EQU   @02                                                      02419000
LASTNODE EQU   @05                                                      02420000
PTRIORB  EQU   @07                                                      02421000
THISCYL  EQU   @12                                                      02422000
IOEHOLDR EQU   @02                                                      02423000
IOEPTR   EQU   @06                                                      02424000
AIAPTR   EQU   @02                                                      02425000
ASMVTPTR EQU   @03                                                      02426000
ATAPTR   EQU   @04                                                      02427000
R0       EQU   @00                                                      02428000
R1       EQU   @01                                                      02429000
R2       EQU   @02                                                      02430000
R4       EQU   @04                                                      02431000
R6       EQU   @06                                                      02432000
R7       EQU   @07                                                      02433000
R9       EQU   @09                                                      02434000
R11      EQU   @11                                                      02435000
R12      EQU   @12                                                      02436000
R13      EQU   @13                                                      02437000
R14      EQU   @14                                                      02438000
R15      EQU   @15                                                      02439000
R10      EQU   @10                                                      02440000
R3       EQU   @03                                                      02441000
R5       EQU   @05                                                      02442000
R8       EQU   @08                                                      02443000
PSA      EQU   0                                                        02444000
FLCRNPSW EQU   PSA                                                      02445000
FLCROPSW EQU   PSA+8                                                    02446000
FLCICCW2 EQU   PSA+16                                                   02447000
FLCCVT   EQU   FLCICCW2                                                 02448000
PSAEEPSW EQU   PSA+132                                                  02449000
PSAESPSW EQU   PSA+136                                                  02450000
FLCSVILC EQU   PSAESPSW+1                                               02451000
PSAEPPSW EQU   PSA+140                                                  02452000
FLCPIILC EQU   PSAEPPSW+1                                               02453000
FLCPICOD EQU   PSAEPPSW+2                                               02454000
PSAPICOD EQU   FLCPICOD+1                                               02455000
FLCTEA   EQU   PSAEPPSW+4                                               02456000
FLCPER   EQU   PSA+152                                                  02457000
FLCMCLA  EQU   PSA+168                                                  02458000
FLCIOEL  EQU   FLCMCLA+4                                                02459000
FLCIOA   EQU   FLCMCLA+16                                               02460000
FLCFSA   EQU   FLCMCLA+80                                               02461000
PSALCCAV EQU   PSA+528                                                  02462000
PSASUPER EQU   PSA+552                                                  02463000
PSASUP1  EQU   PSASUPER                                                 02464000
PSASUP2  EQU   PSASUPER+1                                               02465000
PSASUP3  EQU   PSASUPER+2                                               02466000
PSASUP4  EQU   PSASUPER+3                                               02467000
PSACLHT  EQU   PSA+640                                                  02468000
PSALKSA  EQU   PSA+696                                                  02469000
PSAHLHI  EQU   PSA+760                                                  02470000
PSALITA  EQU   PSA+764                                                  02471000
PSADSSFL EQU   PSA+836                                                  02472000
PSADSSF1 EQU   PSADSSFL                                                 02473000
PSADSSF3 EQU   PSADSSFL+2                                               02474000
PSADSSF4 EQU   PSADSSFL+3                                               02475000
PSARSVT  EQU   PSA+896                                                  02476000
PSALSFCC EQU   PSA+1012                                                 02477000
AIA      EQU   0                                                        02478000
AIAFLG1  EQU   AIA+9                                                    02479000
AIAFLG2  EQU   AIA+10                                                   02480000
AIASECER EQU   AIAFLG2                                                  02481000
AIAFLG3  EQU   AIA+11                                                   02482000
AIANXAIA EQU   AIA+12                                                   02483000
AIACYL   EQU   AIANXAIA                                                 02484000
AIARCSN  EQU   AIANXAIA+2                                               02485000
AIAID    EQU   AIA+16                                                   02486000
AIALPID  EQU   AIAID                                                    02487000
AIALGID  EQU   AIALPID                                                  02488000
AIALSID  EQU   AIALGID                                                  02489000
AIASSID  EQU   AIALSID+1                                                02490000
AIASLOT  EQU   AIASSID+1                                                02491000
AIARPN   EQU   AIALPID+4                                                02492000
AIALSID2 EQU   AIARPN                                                   02493000
AIALPMEP EQU   AIALSID2                                                 02494000
AIAGRPSZ EQU   AIA+24                                                   02495000
AIALGE   EQU   AIAGRPSZ                                                 02496000
AIADPXCT EQU   AIALGE                                                   02497000
ASMVT    EQU   0                                                        02498000
ASMFLAG1 EQU   ASMVT                                                    02499000
ASMDUPLX EQU   ASMFLAG1                                                 02500000
ASMNOCWQ EQU   ASMFLAG1                                                 02501000
ASMNODPX EQU   ASMFLAG1                                                 02502000
ASMPLPAF EQU   ASMFLAG1                                                 02503000
ASMCOMMF EQU   ASMFLAG1                                                 02504000
ASMFLAG2 EQU   ASMVT+1                                                  02505000
ASMPART  EQU   ASMVT+8                                                  02506000
ASMSTAGQ EQU   ASMVT+32                                                 02507000
ASMPCCWQ EQU   ASMVT+64                                                 02508000
ASMPCCWA EQU   ASMPCCWQ                                                 02509000
ASMIOCNT EQU   ASMVT+80                                                 02510000
ASMSRBCT EQU   ASMVT+84                                                 02511000
ASMPSRB  EQU   ASMVT+88                                                 02512000
ASMLSAI  EQU   ASMVT+144                                                02513000
ASMGOSQS EQU   ASMVT+152                                                02514000
ASMPEX   EQU   ASMVT+224                                                02515000
ASMIOEPC EQU   ASMVT+296                                                02516000
ASMWKSA1 EQU   ASMVT+368                                                02517000
ASMWKSA2 EQU   ASMVT+448                                                02518000
ASMWKSA3 EQU   ASMVT+528                                                02519000
ASMWKSA4 EQU   ASMVT+608                                                02520000
ASMWKSA5 EQU   ASMVT+688                                                02521000
ASMPOOLS EQU   0                                                        02522000
ASMCPAVQ EQU   ASMPOOLS+8                                               02523000
ASMCPAVL EQU   ASMCPAVQ                                                 02524000
ASMCPRSQ EQU   ASMPOOLS+16                                              02525000
ATA      EQU   0                                                        02526000
ATAMODID EQU   ATA                                                      02527000
ATASFLGS EQU   ATA+1                                                    02528000
ATARFLGS EQU   ATA+4                                                    02529000
ATARCRSN EQU   ATA+6                                                    02530000
ATARCODE EQU   ATA+7                                                    02531000
ATACLEAR EQU   ATA+8                                                    02532000
ATAWORKA EQU   ATACLEAR                                                 02533000
ATAEPATH EQU   ATACLEAR+4                                               02534000
CVTMAP   EQU   0                                                        02535000
CVTDAR   EQU   CVTMAP+72                                                02536000
CVTFLGS1 EQU   CVTDAR                                                   02537000
CVTDCB   EQU   CVTMAP+116                                               02538000
CVTIERLC EQU   CVTMAP+144                                               02539000
CVTOPTA  EQU   CVTMAP+182                                               02540000
CVTOPTB  EQU   CVTMAP+183                                               02541000
CVTGTF   EQU   CVTMAP+236                                               02542000
CVTGTFST EQU   CVTGTF                                                   02543000
CVTGTFS  EQU   CVTGTFST                                                 02544000
CVTSTATE EQU   CVTGTFST                                                 02545000
CVTTMODE EQU   CVTGTFST                                                 02546000
CVTFORM  EQU   CVTGTFST                                                 02547000
CVTAQAVT EQU   CVTMAP+240                                               02548000
CVTTCMFG EQU   CVTAQAVT                                                 02549000
CVTVOLM2 EQU   CVTMAP+244                                               02550000
CVTTATA  EQU   CVTVOLM2                                                 02551000
CVTTSKS  EQU   CVTTATA                                                  02552000
CVTVOLF2 EQU   CVTTSKS                                                  02553000
CVTTAT   EQU   CVTTATA+1                                                02554000
CVTATER  EQU   CVTMAP+248                                               02555000
CVTEXT1  EQU   CVTMAP+252                                               02556000
CVTPURG  EQU   CVTMAP+260                                               02557000
CVTQMSG  EQU   CVTMAP+268                                               02558000
CVTDMSR  EQU   CVTMAP+272                                               02559000
CVTRSV37 EQU   CVTDMSR                                                  02560000
CVTDMSRF EQU   CVTRSV37                                                 02561000
CVTERPV  EQU   CVTMAP+316                                               02562000
CVTINTLA EQU   CVTMAP+320                                               02563000
CVTAPF   EQU   CVTMAP+324                                               02564000
CVTEXT2  EQU   CVTMAP+328                                               02565000
CVTHJES  EQU   CVTMAP+332                                               02566000
CVTPGSIA EQU   CVTMAP+348                                               02567000
CVTA1F1  EQU   CVTMAP+356                                               02568000
CVTSYSK  EQU   CVTMAP+357                                               02569000
CVTVOLM1 EQU   CVTMAP+380                                               02570000
CVTVOLF1 EQU   CVTVOLM1                                                 02571000
CVTATMCT EQU   CVTMAP+388                                               02572000
CVTXTNT1 EQU   0                                                        02573000
CVTXTNT2 EQU   0                                                        02574000
CVTDSSV  EQU   CVTXTNT2                                                 02575000
CVTFLGBT EQU   CVTXTNT2+5                                               02576000
CVTQID   EQU   CVTXTNT2+24                                              02577000
CVTRV400 EQU   CVTXTNT2+52                                              02578000
CVTRV409 EQU   CVTXTNT2+53                                              02579000
CVTATCVT EQU   CVTXTNT2+64                                              02580000
CVTRV429 EQU   CVTXTNT2+84                                              02581000
CVTRV438 EQU   CVTXTNT2+85                                              02582000
CVTRV457 EQU   CVTXTNT2+112                                             02583000
CVTRV466 EQU   CVTXTNT2+113                                             02584000
CVTFIX   EQU   0                                                        02585000
CVTRELNO EQU   CVTFIX+252                                               02586000
FRRS     EQU   0                                                        02587000
FRRSHEAD EQU   FRRS                                                     02588000
FRRSEMP  EQU   FRRSHEAD                                                 02589000
FRRSLAST EQU   FRRSHEAD+4                                               02590000
FRRSELEN EQU   FRRSHEAD+8                                               02591000
FRRSCURR EQU   FRRSHEAD+12                                              02592000
FRRSENTR EQU   0                                                        02593000
FRRSFRRA EQU   FRRSENTR                                                 02594000
FRRSFLGS EQU   FRRSENTR+4                                               02595000
FRRSFLG1 EQU   FRRSFLGS                                                 02596000
FRRSPARM EQU   FRRSENTR+8                                               02597000
IOE      EQU   0                                                        02598000
IOENXT   EQU   IOE                                                      02599000
IOENXTLE EQU   IOENXT                                                   02600000
IOELSIDA EQU   IOE+4                                                    02601000
IOENXTGT EQU   IOELSIDA                                                 02602000
IOEAIA   EQU   IOE+8                                                    02603000
IOEWORK  EQU   IOE+12                                                   02604000
IOEBKPTR EQU   IOEWORK                                                  02605000
IORB     EQU   0                                                        02606000
IORFLGS  EQU   IORB+3                                                   02607000
IORFUSE  EQU   IORFLGS                                                  02608000
IORAPND  EQU   IORFLGS                                                  02609000
IORIORB  EQU   IORB+4                                                   02610000
IORPCCW  EQU   IORB+8                                                   02611000
LCCA     EQU   0                                                        02612000
LCCAIHRC EQU   LCCA+520                                                 02613000
LCCAIHR1 EQU   LCCAIHRC                                                 02614000
LCCAIHR2 EQU   LCCAIHRC+1                                               02615000
LCCAIHR3 EQU   LCCAIHRC+2                                               02616000
LCCAIHR4 EQU   LCCAIHRC+3                                               02617000
LCCASPIN EQU   LCCA+524                                                 02618000
LCCASPN1 EQU   LCCASPIN                                                 02619000
LCCASPN2 EQU   LCCASPIN+1                                               02620000
LCCASPN3 EQU   LCCASPIN+2                                               02621000
LCCASPN4 EQU   LCCASPIN+3                                               02622000
LCCACPUS EQU   LCCA+536                                                 02623000
LCCADSF1 EQU   LCCA+540                                                 02624000
LCCADSF2 EQU   LCCA+541                                                 02625000
LCCASPSA EQU   LCCA+544                                                 02626000
LCCACRFL EQU   LCCA+692                                                 02627000
LCCACREX EQU   LCCA+693                                                 02628000
LCCALKFG EQU   LCCA+694                                                 02629000
LCCASRBF EQU   LCCA+720                                                 02630000
PAT      EQU   0                                                        02631000
PATHDR   EQU   PAT                                                      02632000
PATCYLSZ EQU   PATHDR+10                                                02633000
PATMAP   EQU   PAT+16                                                   02634000
PART     EQU   0                                                        02635000
PARTHDR  EQU   PART                                                     02636000
PARTAIAE EQU   PARTHDR+12                                               02637000
PARTCIR1 EQU   PARTHDR+16                                               02638000
PARTCIR2 EQU   PARTHDR+20                                               02639000
PARTTPAR EQU   PARTHDR+24                                               02640000
PARTLKUP EQU   PARTHDR+40                                               02641000
PARTLOCK EQU   PARTHDR+44                                               02642000
PARTCOMQ EQU   PARTHDR+48                                               02643000
PARTSPLQ EQU   PARTHDR+56                                               02644000
PARTSPLF EQU   PARTSPLQ                                                 02645000
PARTSPLL EQU   PARTSPLQ+4                                               02646000
PARTDUPQ EQU   PARTHDR+64                                               02647000
PARTLOCQ EQU   PARTHDR+72                                               02648000
PARTENTS EQU   PART+80                                                  02649000
PARTENT  EQU   0                                                        02650000
PAREPARE EQU   PARTENT                                                  02651000
PARELKUP EQU   PARTENT+4                                                02652000
PARELKFL EQU   PARELKUP                                                 02653000
PAREFSIP EQU   PARELKFL                                                 02654000
PARETYPE EQU   PARTENT+8                                                02655000
PAREPLPA EQU   PARETYPE                                                 02656000
PARECOMM EQU   PARETYPE                                                 02657000
PARELOCL EQU   PARETYPE                                                 02658000
PAREFLG1 EQU   PARTENT+9                                                02659000
PAREDSBD EQU   PAREFLG1                                                 02660000
PAREIOEQ EQU   PARTENT+12                                               02661000
PARESLTA EQU   PARTENT+20                                               02662000
PAREIORB EQU   PARTENT+28                                               02663000
PAREPATP EQU   PARTENT+32                                               02664000
PARENODE EQU   PARTENT+48                                               02665000
PAREWTQE EQU   PARTENT+52                                               02666000
PCCW     EQU   0                                                        02667000
PCCWFLGS EQU   PCCW+2                                                   02668000
PCCWPCCW EQU   PCCW+4                                                   02669000
PCCWAIA  EQU   PCCW+8                                                   02670000
PCCWCHHR EQU   PCCW+16                                                  02671000
PCCWSEEK EQU   PCCW+24                                                  02672000
PCCWSSEC EQU   PCCW+32                                                  02673000
PCCWSRCH EQU   PCCW+40                                                  02674000
PCCWTIC  EQU   PCCW+48                                                  02675000
PCCWRW   EQU   PCCW+56                                                  02676000
PCCWNOP  EQU   PCCW+64                                                  02677000
SRBSECT  EQU   0                                                        02678000
SRB      EQU   SRBSECT                                                  02679000
SRBFLC   EQU   SRB+12                                                   02680000
SRBPTR   EQU   0                                                        02681000
WSAC     EQU   0                                                        02682000
WSACASMS EQU   WSAC+60                                                  02683000
ZEROWORK EQU   0                                                        02684000
WRITEQ   EQU   0                                                        02685000
WRITEQUE EQU   WRITEQ                                                   02686000
WRITEQUL EQU   WRITEQ+4                                                 02687000
GMACELL  EQU   0                                                        02688000
GMANEXT  EQU   GMACELL                                                  02689000
ILRPEX   EQU   0                                                        02690000
PATCYL   EQU   0                                                        02691000
PATCYLMP EQU   0                                                        02692000
ASM1WKSV EQU   ASMWKSA1                                                 02693000
ASM1RGSV EQU   ASM1WKSV                                                 02694000
ASM1WRKA EQU   ASM1WKSV+60                                              02695000
ASM2WKSV EQU   ASMWKSA2                                                 02696000
ASM2WRKA EQU   ASM2WKSV+52                                              02697000
ASM2FLGS EQU   ASM2WRKA+12                                              02698000
ASM3WKSV EQU   ASMWKSA3                                                 02699000
ASM4WKSV EQU   ASMWKSA4                                                 02700000
ASM4RGSV EQU   ASM4WKSV                                                 02701000
ASM5WKSV EQU   ASMWKSA5                                                 02702000
ASM5RGSV EQU   ASM5WKSV                                                 02703000
CVTPTR   EQU   FLCCVT                                                   02704000
CVTS01   EQU   CVTPGSIA                                                 02705000
CVTLPDIA EQU   CVTS01+12                                                02706000
CVTDIRST EQU   CVTLPDIA                                                 02707000
CVTSLIDA EQU   CVTS01+24                                                02708000
CVTCTLFG EQU   CVTS01+50                                                02709000
CVTSRBRT EQU   CVTS01+100                                               02710000
CVTASMVT EQU   CVTS01+356                                               02711000
CVTRV210 EQU   CVTS01+424                                               02712000
CVTRV219 EQU   CVTS01+425                                               02713000
CVTRV228 EQU   CVTS01+426                                               02714000
CVTRV237 EQU   CVTS01+427                                               02715000
CVTMFRTR EQU   CVTS01+452                                               02716000
CVTRV262 EQU   CVTS01+468                                               02717000
CVTRV271 EQU   CVTS01+469                                               02718000
CVTRV280 EQU   CVTS01+470                                               02719000
CVTRV289 EQU   CVTS01+471                                               02720000
CVTGSDA  EQU   CVTS01+600                                               02721000
LCCAPTR  EQU   PSALCCAV                                                 02722000
PATPTR   EQU   PAREPATP                                                 02723000
FLC      EQU   PSA                                                      02724000
PSARSVTE EQU   PSARSVT                                                  02725000
PSACSTK  EQU   PSARSVTE                                                 02726000
*                                      START UNREFERENCED COMPONENTS    02727000
PSARSAV  EQU   PSARSVTE+60                                              02728000
PSARSTK  EQU   PSARSVTE+56                                              02729000
PSAESAV3 EQU   PSARSVTE+52                                              02730000
PSAESTK3 EQU   PSARSVTE+48                                              02731000
PSAESAV2 EQU   PSARSVTE+44                                              02732000
PSAESTK2 EQU   PSARSVTE+40                                              02733000
PSAESAV1 EQU   PSARSVTE+36                                              02734000
PSAESTK1 EQU   PSARSVTE+32                                              02735000
PSAPSAV  EQU   PSARSVTE+28                                              02736000
PSAPSTK  EQU   PSARSVTE+24                                              02737000
PSAMSAV  EQU   PSARSVTE+20                                              02738000
PSAMSTK  EQU   PSARSVTE+16                                              02739000
PSASSAV  EQU   PSARSVTE+12                                              02740000
PSASSTK  EQU   PSARSVTE+8                                               02741000
PSANSTK  EQU   PSARSVTE+4                                               02742000
CVTRV628 EQU   CVTS01+728                                               02743000
CVTRV627 EQU   CVTS01+724                                               02744000
CVTRV626 EQU   CVTS01+720                                               02745000
CVTRV625 EQU   CVTS01+716                                               02746000
CVTRV624 EQU   CVTS01+712                                               02747000
CVTRV623 EQU   CVTS01+708                                               02748000
CVTRV622 EQU   CVTS01+704                                               02749000
CVTRV621 EQU   CVTS01+700                                               02750000
CVTIHASU EQU   CVTS01+696                                               02751000
CVTSUSP  EQU   CVTS01+692                                               02752000
CVTT6SVC EQU   CVTS01+688                                               02753000
CVTCDAL  EQU   CVTS01+684                                               02754000
CVTTCTL  EQU   CVTS01+680                                               02755000
CVTRSUME EQU   CVTS01+676                                               02756000
CVTJTERM EQU   CVTS01+672                                               02757000
CVTASMRM EQU   CVTS01+668                                               02758000
CVTTCASP EQU   CVTS01+664                                               02759000
CVT0PT03 EQU   CVTS01+660                                               02760000
CVT0PT0E EQU   CVTS01+656                                               02761000
CVTRV609 EQU   CVTS01+652                                               02762000
CVTCGK   EQU   CVTS01+648                                               02763000
CVTRAC   EQU   CVTS01+644                                               02764000
CVTRV606 EQU   CVTS01+640                                               02765000
CVTRV605 EQU   CVTS01+636                                               02766000
CVTRV604 EQU   CVTS01+632                                               02767000
CVTEFF02 EQU   CVTS01+628                                               02768000
CVTCBBR  EQU   CVTS01+624                                               02769000
CVTSSCR  EQU   CVTS01+620                                               02770000
CVTEVENT EQU   CVTS01+616                                               02771000
CVTCRCA  EQU   CVTS01+612                                               02772000
CVTTPIO  EQU   CVTS01+608                                               02773000
CVTADV   EQU   CVTS01+604                                               02774000
CVTGSDAB EQU   CVTGSDA                                                  02775000
CVTQV3   EQU   CVTS01+596                                               02776000
CVTQV2   EQU   CVTS01+592                                               02777000
CVTQV1   EQU   CVTS01+588                                               02778000
CVTRPT   EQU   CVTS01+584                                               02779000
CVTSSRB  EQU   CVTS01+580                                               02780000
CVTCSDRL EQU   CVTS01+576                                               02781000
CVTEXP1  EQU   CVTS01+572                                               02782000
CVTRMPMT EQU   CVTS01+568                                               02783000
CVTRMPTT EQU   CVTS01+564                                               02784000
CVTVPSA  EQU   CVTS01+560                                               02785000
CVTVSTOP EQU   CVTS01+556                                               02786000
CVTGTFR8 EQU   CVTS01+552                                               02787000
CVTQUIT  EQU   CVTS01+548                                               02788000
CVTVACR  EQU   CVTS01+544                                               02789000
CVTWTCB  EQU   CVTS01+540                                               02790000
CVTSTPRS EQU   CVTS01+536                                               02791000
CVT0PT02 EQU   CVTS01+532                                               02792000
CVTDARCM EQU   CVTS01+528                                               02793000
CVTIRECM EQU   CVTS01+524                                               02794000
CVTJRECM EQU   CVTS01+520                                               02795000
CVTVEMS0 EQU   CVTS01+516                                               02796000
CVTSPFRR EQU   CVTS01+512                                               02797000
CVTRLSTG EQU   CVTS01+508                                               02798000
CVT0TC0A EQU   CVTS01+504                                               02799000
CVTGMBR  EQU   CVTS01+500                                               02800000
CVTLFRM  EQU   CVTS01+496                                               02801000
CVTRMBR  EQU   CVTS01+492                                               02802000
CVTVIOP  EQU   CVTS01+488                                               02803000
CVTRV307 EQU   CVTS01+486                                               02804000
CVTRV306 EQU   CVTS01+484                                               02805000
CVTRV305 EQU   CVTS01+482                                               02806000
CVTRV304 EQU   CVTS01+480                                               02807000
CVTRV303 EQU   CVTS01+478                                               02808000
CVTRV302 EQU   CVTS01+476                                               02809000
CVTTRCA  EQU   CVTS01+472                                               02810000
CVTRV297 EQU   CVTRV289                                                 02811000
CVTRV296 EQU   CVTRV289                                                 02812000
CVTRV295 EQU   CVTRV289                                                 02813000
CVTRV294 EQU   CVTRV289                                                 02814000
CVTRV293 EQU   CVTRV289                                                 02815000
CVTRV292 EQU   CVTRV289                                                 02816000
CVTRV291 EQU   CVTRV289                                                 02817000
CVTRV290 EQU   CVTRV289                                                 02818000
CVTRV288 EQU   CVTRV280                                                 02819000
CVTRV287 EQU   CVTRV280                                                 02820000
CVTRV286 EQU   CVTRV280                                                 02821000
CVTRV285 EQU   CVTRV280                                                 02822000
CVTRV284 EQU   CVTRV280                                                 02823000
CVTRV283 EQU   CVTRV280                                                 02824000
CVTRV282 EQU   CVTRV280                                                 02825000
CVTRV281 EQU   CVTRV280                                                 02826000
CVTRV279 EQU   CVTRV271                                                 02827000
CVTRV278 EQU   CVTRV271                                                 02828000
CVTRV277 EQU   CVTRV271                                                 02829000
CVTRV276 EQU   CVTRV271                                                 02830000
CVTRV275 EQU   CVTRV271                                                 02831000
CVTRV274 EQU   CVTRV271                                                 02832000
CVTRV273 EQU   CVTRV271                                                 02833000
CVTRV272 EQU   CVTRV271                                                 02834000
CVTRV270 EQU   CVTRV262                                                 02835000
CVTRV269 EQU   CVTRV262                                                 02836000
CVTRV268 EQU   CVTRV262                                                 02837000
CVTRV267 EQU   CVTRV262                                                 02838000
CVTRV266 EQU   CVTRV262                                                 02839000
CVTRV265 EQU   CVTRV262                                                 02840000
CVTRV264 EQU   CVTRV262                                                 02841000
CVTRV263 EQU   CVTRV262                                                 02842000
CVTVFP   EQU   CVTS01+464                                               02843000
CVTVSI   EQU   CVTS01+460                                               02844000
CVTVPSIB EQU   CVTS01+456                                               02845000
CVTMFACT EQU   CVTMFRTR                                                 02846000
CVTMFCTL EQU   CVTS01+448                                               02847000
CVTPVBP  EQU   CVTS01+444                                               02848000
CVTPWI   EQU   CVTS01+440                                               02849000
CVTRV254 EQU   CVTS01+438                                               02850000
CVTRV253 EQU   CVTS01+436                                               02851000
CVTRV252 EQU   CVTS01+434                                               02852000
CVTRV251 EQU   CVTS01+433                                               02853000
CVTRV250 EQU   CVTS01+432                                               02854000
CVTRV249 EQU   CVTS01+431                                               02855000
CVTRV248 EQU   CVTS01+430                                               02856000
CVTRV247 EQU   CVTS01+429                                               02857000
CVTRV246 EQU   CVTS01+428                                               02858000
CVTRV245 EQU   CVTRV237                                                 02859000
CVTRV244 EQU   CVTRV237                                                 02860000
CVTRV243 EQU   CVTRV237                                                 02861000
CVTRV242 EQU   CVTRV237                                                 02862000
CVTRV241 EQU   CVTRV237                                                 02863000
CVTRV240 EQU   CVTRV237                                                 02864000
CVTRV239 EQU   CVTRV237                                                 02865000
CVTRV238 EQU   CVTRV237                                                 02866000
CVTRV236 EQU   CVTRV228                                                 02867000
CVTRV235 EQU   CVTRV228                                                 02868000
CVTRV234 EQU   CVTRV228                                                 02869000
CVTRV233 EQU   CVTRV228                                                 02870000
CVTRV232 EQU   CVTRV228                                                 02871000
CVTRV231 EQU   CVTRV228                                                 02872000
CVTRV230 EQU   CVTRV228                                                 02873000
CVTRV229 EQU   CVTRV228                                                 02874000
CVTRV227 EQU   CVTRV219                                                 02875000
CVTRV226 EQU   CVTRV219                                                 02876000
CVTRV225 EQU   CVTRV219                                                 02877000
CVTRV224 EQU   CVTRV219                                                 02878000
CVTRV223 EQU   CVTRV219                                                 02879000
CVTRV222 EQU   CVTRV219                                                 02880000
CVTRV221 EQU   CVTRV219                                                 02881000
CVTRV220 EQU   CVTRV219                                                 02882000
CVTRV218 EQU   CVTRV210                                                 02883000
CVTRV217 EQU   CVTRV210                                                 02884000
CVTRV216 EQU   CVTRV210                                                 02885000
CVTRV215 EQU   CVTRV210                                                 02886000
CVTRV214 EQU   CVTRV210                                                 02887000
CVTRV213 EQU   CVTRV210                                                 02888000
CVTRV212 EQU   CVTRV210                                                 02889000
CVTRV211 EQU   CVTRV210                                                 02890000
CVTLCCAT EQU   CVTS01+420                                               02891000
CVTPCCAT EQU   CVTS01+416                                               02892000
CVTIPCRP EQU   CVTS01+412                                               02893000
CVTIPCRI EQU   CVTS01+408                                               02894000
CVTIPCDS EQU   CVTS01+404                                               02895000
CVTAIDVT EQU   CVTS01+400                                               02896000
CVTSSAP  EQU   CVTS01+396                                               02897000
CVTEHCIR EQU   CVTS01+392                                               02898000
CVTEHDEF EQU   CVTS01+388                                               02899000
CVTDAIR  EQU   CVTS01+384                                               02900000
CVTPERFM EQU   CVTS01+380                                               02901000
CVT044R2 EQU   CVTS01+376                                               02902000
CVTFETCH EQU   CVTS01+372                                               02903000
CVTRSTWD EQU   CVTS01+368                                               02904000
CVTSPOST EQU   CVTS01+364                                               02905000
CVTIOBP  EQU   CVTS01+360                                               02906000
CVTRECRQ EQU   CVTS01+352                                               02907000
CVTWSAC  EQU   CVTS01+348                                               02908000
CVTRV149 EQU   CVTS01+344                                               02909000
CVTWSAL  EQU   CVTS01+340                                               02910000
CVTSPSA  EQU   CVTS01+336                                               02911000
CVTGLMN  EQU   CVTS01+332                                               02912000
CVTVEAC0 EQU   CVTS01+328                                               02913000
CVT062R1 EQU   CVTS01+324                                               02914000
CVTRPOST EQU   CVTS01+320                                               02915000
CVTDQIQE EQU   CVTS01+316                                               02916000
CVTCSD   EQU   CVTS01+312                                               02917000
CVTLKRMA EQU   CVTS01+308                                               02918000
CVTRSPIE EQU   CVTS01+304                                               02919000
CVTRENQ  EQU   CVTS01+300                                               02920000
CVTLQCB  EQU   CVTS01+296                                               02921000
CVTFQCB  EQU   CVTS01+292                                               02922000
CVTQCS01 EQU   CVTS01+288                                               02923000
CVTAPFT  EQU   CVTS01+284                                               02924000
CVTPARRL EQU   CVTS01+280                                               02925000
CVTVWAIT EQU   CVTS01+276                                               02926000
CVTGSPL  EQU   CVTS01+272                                               02927000
CVTLSMQ  EQU   CVTS01+268                                               02928000
CVTGSMQ  EQU   CVTS01+264                                               02929000
CVTEXPRO EQU   CVTS01+260                                               02930000
CVTOPCTP EQU   CVTS01+256                                               02931000
CVTSIC   EQU   CVTS01+252                                               02932000
CVTTPIOS EQU   CVTS01+248                                               02933000
CVTRTMS  EQU   CVTS01+244                                               02934000
CVTSDBF  EQU   CVTS01+240                                               02935000
CVTSCBP  EQU   CVTS01+236                                               02936000
CVTSDMP  EQU   CVTS01+232                                               02937000
CVTSV60  EQU   CVTS01+228                                               02938000
CVTRTMCT EQU   CVTS01+224                                               02939000
CVTASCBL EQU   CVTS01+220                                               02940000
CVTASCBH EQU   CVTS01+216                                               02941000
CVTGDA   EQU   CVTS01+212                                               02942000
CVTASVT  EQU   CVTS01+208                                               02943000
CVTVVMDI EQU   CVTS01+204                                               02944000
CVTAQTOP EQU   CVTS01+200                                               02945000
CVTIOSCS EQU   CVTS01+196                                               02946000
CVTSDRM  EQU   CVTS01+192                                               02947000
CVTOPTE  EQU   CVTS01+188                                               02948000
CVTSTXU  EQU   CVTS01+184                                               02949000
CVTQUIS  EQU   CVTS01+180                                               02950000
CVTPARS  EQU   CVTS01+176                                               02951000
CVTS1EE  EQU   CVTS01+172                                               02952000
CVTFRAS  EQU   CVTS01+168                                               02953000
CVTQSAS  EQU   CVTS01+164                                               02954000
CVTCRAS  EQU   CVTS01+160                                               02955000
CVTCRMN  EQU   CVTS01+156                                               02956000
CVTDELCP EQU   CVTS01+152                                               02957000
CVTFRECL EQU   CVTS01+148                                               02958000
CVTGETCL EQU   CVTS01+144                                               02959000
CVTBLDCP EQU   CVTS01+140                                               02960000
CVTAUTHL EQU   CVTS01+136                                               02961000
CVTSCAN  EQU   CVTS01+132                                               02962000
CVTRV144 EQU   CVTS01+130                                               02963000
CVTMAXMP EQU   CVTS01+128                                               02964000
CVTSTCK  EQU   CVTS01+124                                               02965000
CVTRV139 EQU   CVTS01+123                                               02966000
CVTDSSAC EQU   CVTS01+122                                               02967000
CVTRV513 EQU   CVTS01+121                                               02968000
CVTIOSPL EQU   CVTS01+120                                               02969000
CVTPTGT  EQU   CVTS01+116                                               02970000
CVTCSPIE EQU   CVTS01+112                                               02971000
CVTSMFEX EQU   CVTS01+108                                               02972000
CVTOLT0A EQU   CVTS01+104                                               02973000
CVTPUTL  EQU   CVTS01+96                                                02974000
CVTASCRL EQU   CVTS01+92                                                02975000
CVTASCRF EQU   CVTS01+88                                                02976000
CVTRV326 EQU   CVTS01+84                                                02977000
CVTRV325 EQU   CVTS01+80                                                02978000
CVTRV324 EQU   CVTS01+76                                                02979000
CVT0VL01 EQU   CVTS01+72                                                02980000
CVTSHRVM EQU   CVTS01+68                                                02981000
CVTRV332 EQU   CVTS01+64                                                02982000
CVTTAS   EQU   CVTS01+60                                                02983000
CVTRSCN  EQU   CVTS01+56                                                02984000
CVTTRAC2 EQU   CVTS01+54                                                02985000
CVTTRACE EQU   CVTS01+52                                                02986000
CVTAPG   EQU   CVTS01+51                                                02987000
CVTSDTRC EQU   CVTCTLFG                                                 02988000
CVTGTRCE EQU   CVTCTLFG                                                 02989000
CVTNOMP  EQU   CVTCTLFG                                                 02990000
CVTRSV79 EQU   CVTCTLFG                                                 02991000
CVTDSTAT EQU   CVTCTLFG                                                 02992000
CVTRSV78 EQU   CVTCTLFG                                                 02993000
CVTRV333 EQU   CVTCTLFG                                                 02994000
CVTRV323 EQU   CVTCTLFG                                                 02995000
CVTSPVLK EQU   CVTS01+49                                                02996000
CVTRSV77 EQU   CVTS01+48                                                02997000
CVTRV331 EQU   CVTS01+44                                                02998000
CVTRV330 EQU   CVTS01+40                                                02999000
CVTRV329 EQU   CVTS01+36                                                03000000
CVTRV328 EQU   CVTS01+32                                                03001000
CVTRV322 EQU   CVTS01+28                                                03002000
CVTSLID  EQU   CVTSLIDA+1                                               03003000
CVTSYLK  EQU   CVTSLIDA                                                 03004000
CVTRV321 EQU   CVTS01+20                                                03005000
CVTRV320 EQU   CVTS01+16                                                03006000
CVTLPDIR EQU   CVTLPDIA+1                                               03007000
CVTRSV69 EQU   CVTDIRST                                                 03008000
CVTRSV68 EQU   CVTDIRST                                                 03009000
CVTRSV67 EQU   CVTDIRST                                                 03010000
CVTRSV66 EQU   CVTDIRST                                                 03011000
CVTRSV65 EQU   CVTDIRST                                                 03012000
CVTRSV64 EQU   CVTDIRST                                                 03013000
CVTRSV63 EQU   CVTDIRST                                                 03014000
CVTDICOM EQU   CVTDIRST                                                 03015000
CVTPVTP  EQU   CVTS01+8                                                 03016000
CVTLPDSR EQU   CVTS01+4                                                 03017000
CVTGETL  EQU   CVTS01                                                   03018000
ASM5FLGS EQU   ASM5WKSV+64                                              03019000
ASM5AIA  EQU   ASM5WKSV+60                                              03020000
ASM5GCTR EQU   ASM5WKSV+56                                              03021000
ASM5SR14 EQU   ASM5WKSV+52                                              03022000
@NM00006 EQU   ASM5RGSV+4                                               03023000
ASM5RG2  EQU   ASM5RGSV                                                 03024000
@NM00005 EQU   ASM4RGSV+4                                               03025000
ASM4RG2  EQU   ASM4RGSV                                                 03026000
ASM3SR13 EQU   ASM3WKSV+28                                              03027000
ASM3R14B EQU   ASM3WKSV+24                                              03028000
ASM3R14A EQU   ASM3WKSV+20                                              03029000
ASM3GRPA EQU   ASM3WKSV+16                                              03030000
ASM3TMPA EQU   ASM3WKSV+12                                              03031000
ASM3PIOP EQU   ASM3WKSV+8                                               03032000
ASM3GENQ EQU   ASM3WKSV+4                                               03033000
ASM3SWPQ EQU   ASM3WKSV                                                 03034000
ASM2SR14 EQU   ASM2WRKA+16                                              03035000
@NM00004 EQU   ASM2WRKA+13                                              03036000
ASM2WFLG EQU   ASM2FLGS                                                 03037000
ASM2RFLG EQU   ASM2FLGS                                                 03038000
ASM2DUPQ EQU   ASM2WRKA+8                                               03039000
ASM2CAQ  EQU   ASM2WRKA+4                                               03040000
ASM2PAQ  EQU   ASM2WRKA                                                 03041000
ASM2RGSV EQU   ASM2WKSV                                                 03042000
ASM1NXTA EQU   ASM1WRKA+4                                               03043000
ASM1ASCB EQU   ASM1WRKA                                                 03044000
ASM1RG15 EQU   ASM1RGSV+56                                              03045000
@NM00003 EQU   ASM1RGSV+4                                               03046000
ASM1RG1  EQU   ASM1RGSV                                                 03047000
WSACASMD EQU   WSAC+56                                                  03048000
WSACCCH  EQU   WSAC+52                                                  03049000
WSACRRSA EQU   WSAC+48                                                  03050000
WSACREST EQU   WSAC+44                                                  03051000
WSACRSTI EQU   WSAC+40                                                  03052000
WSACABTM EQU   WSAC+36                                                  03053000
WSACMF1  EQU   WSAC+32                                                  03054000
WSACEDS0 EQU   WSAC+28                                                  03055000
WSACIOS  EQU   WSAC+24                                                  03056000
WSACRTMK EQU   WSAC+20                                                  03057000
WSACACR  EQU   WSAC+16                                                  03058000
WSACTIME EQU   WSAC+12                                                  03059000
WSACOPTM EQU   WSAC+8                                                   03060000
WSACGTF  EQU   WSAC+4                                                   03061000
WSACCWSA EQU   WSAC                                                     03062000
@NM00047 EQU   SRB+40                                                   03063000
@NM00046 EQU   SRB+38                                                   03064000
SRBPRIOR EQU   SRB+37                                                   03065000
SRBPKF   EQU   SRB+36                                                   03066000
SRBSAVE  EQU   SRB+32                                                   03067000
SRBPARM  EQU   SRB+28                                                   03068000
SRBRMTR  EQU   SRB+24                                                   03069000
SRBEP    EQU   SRB+20                                                   03070000
SRBPTCB  EQU   SRBFLC+4                                                 03071000
SRBPASID EQU   SRBFLC+2                                                 03072000
SRBCPAFF EQU   SRBFLC                                                   03073000
SRBASCB  EQU   SRB+8                                                    03074000
SRBFLNK  EQU   SRB+4                                                    03075000
SRBID    EQU   SRB                                                      03076000
@NM00021 EQU   PCCW+72                                                  03077000
PCCWNCT  EQU   PCCWNOP+6                                                03078000
PCCWNFG  EQU   PCCWNOP+4                                                03079000
PCCWNAD  EQU   PCCWNOP+1                                                03080000
PCCWN    EQU   PCCWNOP                                                  03081000
PCCWCNT  EQU   PCCWRW+6                                                 03082000
PCCWRWFG EQU   PCCWRW+4                                                 03083000
PCCWADDR EQU   PCCWRW+1                                                 03084000
PCCWRDWT EQU   PCCWRW                                                   03085000
PCCWTCT  EQU   PCCWTIC+6                                                03086000
PCCWTFG  EQU   PCCWTIC+4                                                03087000
PCCWTAD  EQU   PCCWTIC+1                                                03088000
PCCWT    EQU   PCCWTIC                                                  03089000
PCCWSICT EQU   PCCWSRCH+6                                               03090000
PCCWSIFG EQU   PCCWSRCH+4                                               03091000
PCCWSIAD EQU   PCCWSRCH+1                                               03092000
PCCWSIDE EQU   PCCWSRCH                                                 03093000
PCCWSSCT EQU   PCCWSSEC+6                                               03094000
PCCWSSFG EQU   PCCWSSEC+4                                               03095000
PCCWSSAD EQU   PCCWSSEC+1                                               03096000
PCCWSS   EQU   PCCWSSEC                                                 03097000
PCCWSKCT EQU   PCCWSEEK+6                                               03098000
PCCWSKFG EQU   PCCWSEEK+4                                               03099000
PCCWSKAD EQU   PCCWSEEK+1                                               03100000
PCCWSK   EQU   PCCWSEEK                                                 03101000
PCCWR    EQU   PCCWCHHR+7                                               03102000
PCCWHH   EQU   PCCWCHHR+5                                               03103000
PCCWCC   EQU   PCCWCHHR+3                                               03104000
PCCWBB   EQU   PCCWCHHR+1                                               03105000
PCCWM    EQU   PCCWCHHR                                                 03106000
PCCWIORB EQU   PCCW+12                                                  03107000
@NM00020 EQU   PCCW+3                                                   03108000
@NM00019 EQU   PCCWFLGS                                                 03109000
PCCWFERR EQU   PCCWFLGS                                                 03110000
PCCWSECT EQU   PCCW+1                                                   03111000
PCCWID   EQU   PCCW                                                     03112000
@NM00018 EQU   PARTENT+62                                               03113000
PARELCYL EQU   PARTENT+60                                               03114000
PARERQTM EQU   PARTENT+56                                               03115000
PAREUCBP EQU   PARTENT+44                                               03116000
PAREEDBP EQU   PARTENT+40                                               03117000
PAREPCTP EQU   PARTENT+36                                               03118000
PARERRCT EQU   PARTENT+24                                               03119000
PARESZSL EQU   PARTENT+16                                               03120000
PARENN   EQU   PARTENT+10                                               03121000
@NM00017 EQU   PAREFLG1                                                 03122000
PAREINCP EQU   PAREFLG1                                                 03123000
PARENUSE EQU   PAREFLG1                                                 03124000
@NM00016 EQU   PARETYPE                                                 03125000
PAREDPLX EQU   PARETYPE                                                 03126000
PARECPCT EQU   PARELKUP+2                                               03127000
PAREIORN EQU   PARELKUP+1                                               03128000
@NM00015 EQU   PARELKFL                                                 03129000
PARTLOCL EQU   PARTLOCQ+4                                               03130000
PARTLOCF EQU   PARTLOCQ                                                 03131000
PARTDUPL EQU   PARTDUPQ+4                                               03132000
PARTDUPF EQU   PARTDUPQ                                                 03133000
PARTCOML EQU   PARTCOMQ+4                                               03134000
PARTCOMF EQU   PARTCOMQ                                                 03135000
@NM00014 EQU   PARTHDR+34                                               03136000
PARTLCNT EQU   PARTHDR+32                                               03137000
PARTPCTQ EQU   PARTHDR+28                                               03138000
PARTDSNL EQU   PARTTPAR                                                 03139000
PARTEUSE EQU   PARTHDR+8                                                03140000
PARTSIZE EQU   PARTHDR+4                                                03141000
PARTIDEN EQU   PARTHDR                                                  03142000
PATCYLS  EQU   PATMAP                                                   03143000
PATRSV1  EQU   PATHDR+14                                                03144000
PATCYLMW EQU   PATHDR+12                                                03145000
PATCYLNO EQU   PATHDR+8                                                 03146000
PATPART  EQU   PATHDR+4                                                 03147000
PATIDENT EQU   PATHDR                                                   03148000
LCCAR125 EQU   LCCA+964                                                 03149000
LCCAR124 EQU   LCCA+960                                                 03150000
LCCASGPR EQU   LCCA+896                                                 03151000
LCCADRT2 EQU   LCCA+888                                                 03152000
LCCADRT1 EQU   LCCA+880                                                 03153000
LCCAR103 EQU   LCCA+876                                                 03154000
LCCAESS2 EQU   LCCA+872                                                 03155000
LCCASPLJ EQU   LCCA+868                                                 03156000
LCCASMQJ EQU   LCCA+864                                                 03157000
LCCAIRT  EQU   LCCA+736                                                 03158000
LCCAASID EQU   LCCA+732                                                 03159000
LCCARV89 EQU   LCCA+728                                                 03160000
LCCAPGTA EQU   LCCASRBF+2                                               03161000
LCCASAFN EQU   LCCASRBF                                                 03162000
LCCAECSA EQU   LCCA+716                                                 03163000
LCCAICR0 EQU   LCCA+712                                                 03164000
LCCALWTM EQU   LCCA+704                                                 03165000
LCCARV78 EQU   LCCA+700                                                 03166000
LCCAPINV EQU   LCCA+696                                                 03167000
LCCARV88 EQU   LCCA+695                                                 03168000
LCCARV87 EQU   LCCALKFG                                                 03169000
LCCARV86 EQU   LCCALKFG                                                 03170000
LCCARV85 EQU   LCCALKFG                                                 03171000
LCCARV84 EQU   LCCALKFG                                                 03172000
LCCALKRD EQU   LCCALKFG                                                 03173000
LCCALKAQ EQU   LCCALKFG                                                 03174000
LCCALKSA EQU   LCCALKFG                                                 03175000
LCCALKDP EQU   LCCALKFG                                                 03176000
LCCACRST EQU   LCCACREX                                                 03177000
LCCACRDP EQU   LCCACREX                                                 03178000
LCCACRLM EQU   LCCACREX                                                 03179000
LCCACRIN EQU   LCCACREX                                                 03180000
LCCACRRT EQU   LCCACREX                                                 03181000
LCCACRLE EQU   LCCACREX                                                 03182000
LCCACRRM EQU   LCCACREX                                                 03183000
LCCACREF EQU   LCCACREX                                                 03184000
LCCAVARY EQU   LCCACRFL                                                 03185000
LCCARV73 EQU   LCCACRFL                                                 03186000
LCCARV72 EQU   LCCACRFL                                                 03187000
LCCARV71 EQU   LCCACRFL                                                 03188000
LCCARV70 EQU   LCCACRFL                                                 03189000
LCCARV69 EQU   LCCACRFL                                                 03190000
LCCACLMS EQU   LCCACRFL                                                 03191000
LCCACRTM EQU   LCCACRFL                                                 03192000
LCCALCR0 EQU   LCCA+688                                                 03193000
LCCACRLC EQU   LCCA+684                                                 03194000
LCCARCPU EQU   LCCA+680                                                 03195000
LCCADCPU EQU   LCCA+676                                                 03196000
LCCASRBJ EQU   LCCA+672                                                 03197000
LCCADSSR EQU   LCCA+668                                                 03198000
LCCADSSC EQU   LCCA+660                                                 03199000
LCCADSS3 EQU   LCCA+648                                                 03200000
LCCADSS2 EQU   LCCA+636                                                 03201000
LCCADSS1 EQU   LCCA+624                                                 03202000
LCCAWTIM EQU   LCCA+616                                                 03203000
LCCAITOD EQU   LCCA+608                                                 03204000
LCCADTOD EQU   LCCA+600                                                 03205000
LCCASTOD EQU   LCCA+592                                                 03206000
LCCARIR5 EQU   LCCASPSA+44                                              03207000
LCCARIR4 EQU   LCCASPSA+40                                              03208000
LCCARIR3 EQU   LCCASPSA+36                                              03209000
LCCARIR2 EQU   LCCASPSA+32                                              03210000
LCCARPR5 EQU   LCCASPSA+28                                              03211000
LCCARPR4 EQU   LCCASPSA+24                                              03212000
LCCARPR3 EQU   LCCASPSA+20                                              03213000
LCCARPR2 EQU   LCCASPSA+16                                              03214000
LCCADSR5 EQU   LCCASPSA+12                                              03215000
LCCADSR4 EQU   LCCASPSA+8                                               03216000
LCCADSR3 EQU   LCCASPSA+4                                               03217000
LCCADSR2 EQU   LCCASPSA                                                 03218000
LCCARV68 EQU   LCCA+543                                                 03219000
LCCAPSMK EQU   LCCA+542                                                 03220000
LCCARV67 EQU   LCCADSF2                                                 03221000
LCCARV66 EQU   LCCADSF2                                                 03222000
LCCARV65 EQU   LCCADSF2                                                 03223000
LCCARV64 EQU   LCCADSF2                                                 03224000
LCCADSRW EQU   LCCADSF2                                                 03225000
LCCADSPL EQU   LCCADSF2                                                 03226000
LCCAGSRB EQU   LCCADSF2                                                 03227000
LCCASRBM EQU   LCCADSF2                                                 03228000
LCCARV61 EQU   LCCADSF1                                                 03229000
LCCARV60 EQU   LCCADSF1                                                 03230000
LCCARV59 EQU   LCCADSF1                                                 03231000
LCCARV58 EQU   LCCADSF1                                                 03232000
LCCATIMR EQU   LCCADSF1                                                 03233000
LCCADSS  EQU   LCCADSF1                                                 03234000
LCCAVCPU EQU   LCCADSF1                                                 03235000
LCCAACR  EQU   LCCADSF1                                                 03236000
LCCAASCP EQU   LCCA+532                                                 03237000
LCCAESSA EQU   LCCA+528                                                 03238000
LCCARV55 EQU   LCCASPN4                                                 03239000
LCCARV54 EQU   LCCASPN4                                                 03240000
LCCARV53 EQU   LCCASPN4                                                 03241000
LCCARV52 EQU   LCCASPN4                                                 03242000
LCCARV51 EQU   LCCASPN4                                                 03243000
LCCARV50 EQU   LCCASPN4                                                 03244000
LCCARV49 EQU   LCCASPN4                                                 03245000
LCCARV48 EQU   LCCASPN4                                                 03246000
LCCARV47 EQU   LCCASPN3                                                 03247000
LCCARV46 EQU   LCCASPN3                                                 03248000
LCCARV45 EQU   LCCASPN3                                                 03249000
LCCARV44 EQU   LCCASPN3                                                 03250000
LCCARV43 EQU   LCCASPN3                                                 03251000
LCCARV42 EQU   LCCASPN3                                                 03252000
LCCARV41 EQU   LCCASPN3                                                 03253000
LCCARV40 EQU   LCCASPN3                                                 03254000
LCCARV39 EQU   LCCASPN2                                                 03255000
LCCARV38 EQU   LCCASPN2                                                 03256000
LCCARV37 EQU   LCCASPN2                                                 03257000
LCCARV36 EQU   LCCASPN2                                                 03258000
LCCARV35 EQU   LCCASPN2                                                 03259000
LCCARV34 EQU   LCCASPN2                                                 03260000
LCCARV33 EQU   LCCASPN2                                                 03261000
LCCARV32 EQU   LCCASPN2                                                 03262000
LCCARV31 EQU   LCCASPN1                                                 03263000
LCCARV30 EQU   LCCASPN1                                                 03264000
LCCAMFIO EQU   LCCASPN1                                                 03265000
LCCARSTR EQU   LCCASPN1                                                 03266000
LCCATSPN EQU   LCCASPN1                                                 03267000
LCCALOCK EQU   LCCASPN1                                                 03268000
LCCASIGP EQU   LCCASPN1                                                 03269000
LCCAPTLB EQU   LCCASPN1                                                 03270000
LCCARV27 EQU   LCCAIHR4                                                 03271000
LCCARV26 EQU   LCCAIHR4                                                 03272000
LCCARV25 EQU   LCCAIHR4                                                 03273000
LCCARV24 EQU   LCCAIHR4                                                 03274000
LCCARV23 EQU   LCCAIHR4                                                 03275000
LCCARV22 EQU   LCCAIHR4                                                 03276000
LCCARV21 EQU   LCCAIHR4                                                 03277000
LCCARV20 EQU   LCCAIHR4                                                 03278000
LCCARV19 EQU   LCCAIHR3                                                 03279000
LCCARV18 EQU   LCCAIHR3                                                 03280000
LCCARV17 EQU   LCCAIHR3                                                 03281000
LCCARV16 EQU   LCCAIHR3                                                 03282000
LCCARV15 EQU   LCCAIHR3                                                 03283000
LCCARV14 EQU   LCCAIHR3                                                 03284000
LCCARV13 EQU   LCCAIHR3                                                 03285000
LCCARV12 EQU   LCCAIHR3                                                 03286000
LCCARV11 EQU   LCCAIHR2                                                 03287000
LCCARV10 EQU   LCCAIHR2                                                 03288000
LCCARV09 EQU   LCCAIHR2                                                 03289000
LCCARV08 EQU   LCCAIHR2                                                 03290000
LCCARV07 EQU   LCCAIHR2                                                 03291000
LCCARV06 EQU   LCCAIHR2                                                 03292000
LCCARV05 EQU   LCCAIHR2                                                 03293000
LCCARV04 EQU   LCCAIHR2                                                 03294000
LCCARV03 EQU   LCCAIHR1                                                 03295000
LCCARV02 EQU   LCCAIHR1                                                 03296000
LCCARV01 EQU   LCCAIHR1                                                 03297000
LCCAPPIE EQU   LCCAIHR1                                                 03298000
LCCAPSG1 EQU   LCCAIHR1                                                 03299000
LCCAPDAT EQU   LCCAIHR1                                                 03300000
LCCAXRC2 EQU   LCCAIHR1                                                 03301000
LCCAXRC1 EQU   LCCAIHR1                                                 03302000
LCCAIOPS EQU   LCCA+512                                                 03303000
LCCAGPGR EQU   LCCA+448                                                 03304000
LCCAR133 EQU   LCCA+444                                                 03305000
LCCAR132 EQU   LCCA+440                                                 03306000
LCCAR131 EQU   LCCA+436                                                 03307000
LCCAR130 EQU   LCCA+432                                                 03308000
LCCAR129 EQU   LCCA+428                                                 03309000
LCCAR128 EQU   LCCA+424                                                 03310000
LCCAR127 EQU   LCCA+420                                                 03311000
LCCAR126 EQU   LCCA+416                                                 03312000
LCCARSGR EQU   LCCA+352                                                 03313000
LCCAXGR3 EQU   LCCA+288                                                 03314000
LCCAXGR2 EQU   LCCA+224                                                 03315000
LCCAXGR1 EQU   LCCA+160                                                 03316000
LCCACR0  EQU   LCCA+156                                                 03317000
LCCAMCR1 EQU   LCCA+152                                                 03318000
LCCAPVAD EQU   LCCA+148                                                 03319000
LCCAPINT EQU   LCCA+144                                                 03320000
LCCAPPSW EQU   LCCA+136                                                 03321000
LCCAPGR2 EQU   LCCA+72                                                  03322000
LCCAPGR1 EQU   LCCA+8                                                   03323000
LCCARV77 EQU   LCCA+6                                                   03324000
LCCACPUA EQU   LCCA+4                                                   03325000
LCCALCCA EQU   LCCA                                                     03326000
@NM00013 EQU   IORB+40                                                  03327000
IORRSV   EQU   IORB+36                                                  03328000
IORPARTE EQU   IORB+32                                                  03329000
IORTSMP  EQU   IORB+24                                                  03330000
IORERR   EQU   IORB+20                                                  03331000
IORSAVE  EQU   IORB+16                                                  03332000
IORIOSB  EQU   IORB+12                                                  03333000
IORSCCW  EQU   IORPCCW                                                  03334000
IORFAE   EQU   IORAPND                                                  03335000
IORFNE   EQU   IORAPND                                                  03336000
IORFDI   EQU   IORAPND                                                  03337000
IORSWAP  EQU   IORFLGS                                                  03338000
@NM00012 EQU   IORFLGS                                                  03339000
IORFRPS  EQU   IORFLGS                                                  03340000
IORRQSZ  EQU   IORB+2                                                   03341000
IORNUM   EQU   IORB+1                                                   03342000
IORID    EQU   IORB                                                     03343000
@NM00011 EQU   IOE+16                                                   03344000
@NM00010 EQU   FRRSFLGS+1                                               03345000
@NM00009 EQU   FRRSFLG1                                                 03346000
FRRSNEST EQU   FRRSFLG1                                                 03347000
FRRSRCUR EQU   FRRSFLG1                                                 03348000
FRRSENTS EQU   FRRS+84                                                  03349000
FRRSRTMW EQU   FRRS+16                                                  03350000
CVTLEVL  EQU   CVTRELNO+2                                               03351000
CVTNUMB  EQU   CVTRELNO                                                 03352000
CVTMDL   EQU   CVTFIX+250                                               03353000
@NM00008 EQU   CVTFIX+248                                               03354000
@NM00007 EQU   CVTFIX                                                   03355000
CVTRV482 EQU   CVTXTNT2+128                                             03356000
CVTRV481 EQU   CVTXTNT2+124                                             03357000
CVTRV480 EQU   CVTXTNT2+120                                             03358000
CVTRV479 EQU   CVTXTNT2+118                                             03359000
CVTRV478 EQU   CVTXTNT2+117                                             03360000
CVTRV477 EQU   CVTXTNT2+116                                             03361000
CVTRV476 EQU   CVTXTNT2+115                                             03362000
CVTRV475 EQU   CVTXTNT2+114                                             03363000
CVTRV474 EQU   CVTRV466                                                 03364000
CVTRV473 EQU   CVTRV466                                                 03365000
CVTRV472 EQU   CVTRV466                                                 03366000
CVTRV471 EQU   CVTRV466                                                 03367000
CVTRV470 EQU   CVTRV466                                                 03368000
CVTRV469 EQU   CVTRV466                                                 03369000
CVTRV468 EQU   CVTRV466                                                 03370000
CVTRV467 EQU   CVTRV466                                                 03371000
CVTRV465 EQU   CVTRV457                                                 03372000
CVTRV464 EQU   CVTRV457                                                 03373000
CVTRV463 EQU   CVTRV457                                                 03374000
CVTRV462 EQU   CVTRV457                                                 03375000
CVTRV461 EQU   CVTRV457                                                 03376000
CVTRV460 EQU   CVTRV457                                                 03377000
CVTRV459 EQU   CVTRV457                                                 03378000
CVTRV458 EQU   CVTRV457                                                 03379000
CVTRV456 EQU   CVTXTNT2+108                                             03380000
CVTRV455 EQU   CVTXTNT2+104                                             03381000
CVTRV454 EQU   CVTXTNT2+100                                             03382000
CVTRV453 EQU   CVTXTNT2+96                                              03383000
CVTRV452 EQU   CVTXTNT2+94                                              03384000
CVTRV451 EQU   CVTXTNT2+92                                              03385000
CVTRV450 EQU   CVTXTNT2+90                                              03386000
CVTRV449 EQU   CVTXTNT2+88                                              03387000
CVTRV448 EQU   CVTXTNT2+87                                              03388000
CVTRV447 EQU   CVTXTNT2+86                                              03389000
CVTRV446 EQU   CVTRV438                                                 03390000
CVTRV445 EQU   CVTRV438                                                 03391000
CVTRV444 EQU   CVTRV438                                                 03392000
CVTRV443 EQU   CVTRV438                                                 03393000
CVTRV442 EQU   CVTRV438                                                 03394000
CVTRV441 EQU   CVTRV438                                                 03395000
CVTRV440 EQU   CVTRV438                                                 03396000
CVTRV439 EQU   CVTRV438                                                 03397000
CVTRV437 EQU   CVTRV429                                                 03398000
CVTRV436 EQU   CVTRV429                                                 03399000
CVTRV435 EQU   CVTRV429                                                 03400000
CVTRV434 EQU   CVTRV429                                                 03401000
CVTRV433 EQU   CVTRV429                                                 03402000
CVTRV432 EQU   CVTRV429                                                 03403000
CVTRV431 EQU   CVTRV429                                                 03404000
CVTRV430 EQU   CVTRV429                                                 03405000
CVTRV428 EQU   CVTXTNT2+80                                              03406000
CVTRV427 EQU   CVTXTNT2+76                                              03407000
CVTRV426 EQU   CVTXTNT2+72                                              03408000
CVTRV425 EQU   CVTXTNT2+68                                              03409000
CVTATACT EQU   CVTATCVT                                                 03410000
CVTRV423 EQU   CVTXTNT2+62                                              03411000
CVTRV422 EQU   CVTXTNT2+60                                              03412000
CVTRV421 EQU   CVTXTNT2+58                                              03413000
CVTRV420 EQU   CVTXTNT2+56                                              03414000
CVTRV419 EQU   CVTXTNT2+55                                              03415000
CVTRV418 EQU   CVTXTNT2+54                                              03416000
CVTRV417 EQU   CVTRV409                                                 03417000
CVTRV416 EQU   CVTRV409                                                 03418000
CVTRV415 EQU   CVTRV409                                                 03419000
CVTRV414 EQU   CVTRV409                                                 03420000
CVTRV413 EQU   CVTRV409                                                 03421000
CVTRV412 EQU   CVTRV409                                                 03422000
CVTRV411 EQU   CVTRV409                                                 03423000
CVTRV410 EQU   CVTRV409                                                 03424000
CVTRV408 EQU   CVTRV400                                                 03425000
CVTRV407 EQU   CVTRV400                                                 03426000
CVTRV406 EQU   CVTRV400                                                 03427000
CVTRV405 EQU   CVTRV400                                                 03428000
CVTRV404 EQU   CVTRV400                                                 03429000
CVTRV403 EQU   CVTRV400                                                 03430000
CVTRV402 EQU   CVTRV400                                                 03431000
CVTRV401 EQU   CVTRV400                                                 03432000
CVTICB   EQU   CVTXTNT2+48                                              03433000
CVTSKTA  EQU   CVTXTNT2+44                                              03434000
CVTRSV99 EQU   CVTXTNT2+40                                              03435000
CVTRSV98 EQU   CVTXTNT2+36                                              03436000
CVTRSV97 EQU   CVTXTNT2+34                                              03437000
CVTRSV96 EQU   CVTXTNT2+32                                              03438000
CVTOLTEP EQU   CVTXTNT2+28                                              03439000
CVTQIDA  EQU   CVTQID+1                                                 03440000
CVTRSV95 EQU   CVTQID                                                   03441000
CVTRSV94 EQU   CVTXTNT2+20                                              03442000
CVTRSV93 EQU   CVTXTNT2+16                                              03443000
CVTRSV92 EQU   CVTXTNT2+12                                              03444000
CVTDEBVR EQU   CVTXTNT2+8                                               03445000
CVTRSV91 EQU   CVTXTNT2+6                                               03446000
CVTRSV9H EQU   CVTFLGBT                                                 03447000
CVTRSV9G EQU   CVTFLGBT                                                 03448000
CVTRSV9F EQU   CVTFLGBT                                                 03449000
CVTRSV9E EQU   CVTFLGBT                                                 03450000
CVTRSV9D EQU   CVTFLGBT                                                 03451000
CVTRSV9C EQU   CVTFLGBT                                                 03452000
CVTVME   EQU   CVTFLGBT                                                 03453000
CVTNPE   EQU   CVTFLGBT                                                 03454000
CVTNUCLS EQU   CVTXTNT2+4                                               03455000
CVTDSSVA EQU   CVTDSSV+1                                                03456000
CVTRSV89 EQU   CVTDSSV                                                  03457000
CVTRSV88 EQU   CVTXTNT1+8                                               03458000
CVTRSV87 EQU   CVTXTNT1+4                                               03459000
CVTFACHN EQU   CVTXTNT1                                                 03460000
CVTRV488 EQU   CVTMAP+412                                               03461000
CVTRV487 EQU   CVTMAP+408                                               03462000
CVTRV486 EQU   CVTMAP+404                                               03463000
CVTRV485 EQU   CVTMAP+400                                               03464000
CVTACTAP EQU   CVTMAP+396                                               03465000
CVTAUTH  EQU   CVTMAP+392                                               03466000
CVTATMCA EQU   CVTATMCT+1                                               03467000
CVTATMST EQU   CVTATMCT                                                 03468000
CVTRSV61 EQU   CVTMAP+384                                               03469000
CVTVOLT1 EQU   CVTVOLM1+1                                               03470000
CVTVOLI1 EQU   CVTVOLF1                                                 03471000
CVTSTOA  EQU   CVTMAP+376                                               03472000
CVTRSV58 EQU   CVTMAP+374                                               03473000
CVTRSV57 EQU   CVTMAP+372                                               03474000
CVTDDCE  EQU   CVTMAP+368                                               03475000
CVTPNWFR EQU   CVTMAP+364                                               03476000
CVTSMF   EQU   CVTMAP+360                                               03477000
CVTSULK  EQU   CVTMAP+358                                               03478000
CVTSLKO  EQU   CVTSYSK                                                  03479000
CVTSLKP  EQU   CVTSYSK                                                  03480000
CVTSLKQ  EQU   CVTSYSK                                                  03481000
CVTSLKR  EQU   CVTSYSK                                                  03482000
CVTRSV56 EQU   CVTSYSK                                                  03483000
CVTRSV55 EQU   CVTSYSK                                                  03484000
CVTRSV54 EQU   CVTSYSK                                                  03485000
CVTRSV53 EQU   CVTSYSK                                                  03486000
CVTRSV52 EQU   CVTA1F1                                                  03487000
CVTRSV51 EQU   CVTA1F1                                                  03488000
CVTRSV50 EQU   CVTA1F1                                                  03489000
CVTRSV49 EQU   CVTA1F1                                                  03490000
CVTRSV48 EQU   CVTA1F1                                                  03491000
CVTRSV47 EQU   CVTA1F1                                                  03492000
CVTSRSW  EQU   CVTA1F1                                                  03493000
CVTPFSW  EQU   CVTA1F1                                                  03494000
CVTPCVT  EQU   CVTMAP+352                                               03495000
CVTRSV46 EQU   CVTMAP+344                                               03496000
CVTRSV45 EQU   CVTMAP+340                                               03497000
CVTRSV44 EQU   CVTMAP+338                                               03498000
CVTRSV43 EQU   CVTMAP+336                                               03499000
CVTHJESA EQU   CVTHJES+1                                                03500000
CVTRSV42 EQU   CVTHJES                                                  03501000
CVTEXT2A EQU   CVTEXT2+1                                                03502000
CVTRSV41 EQU   CVTEXT2                                                  03503000
CVTAPFA  EQU   CVTAPF+1                                                 03504000
CVTRSV40 EQU   CVTAPF                                                   03505000
CVTRV518 EQU   CVTINTLA                                                 03506000
CVTRV517 EQU   CVTERPV                                                  03507000
CVTEORM  EQU   CVTMAP+312                                               03508000
CVTMCHPR EQU   CVTMAP+308                                               03509000
CVTTZ    EQU   CVTMAP+304                                               03510000
CVTJEPS  EQU   CVTMAP+300                                               03511000
CVTJESCT EQU   CVTMAP+296                                               03512000
CVTMODE  EQU   CVTMAP+292                                               03513000
CVTPTRV  EQU   CVTMAP+288                                               03514000
CVTREAL  EQU   CVTMAP+284                                               03515000
CVTRSV39 EQU   CVTMAP+280                                               03516000
CVTRSV38 EQU   CVTMAP+276                                               03517000
CVTDMSRA EQU   CVTDMSR+1                                                03518000
CVTRV634 EQU   CVTDMSRF                                                 03519000
CVTRV633 EQU   CVTDMSRF                                                 03520000
CVTRV632 EQU   CVTDMSRF                                                 03521000
CVTRV631 EQU   CVTDMSRF                                                 03522000
CVTRV630 EQU   CVTDMSRF                                                 03523000
CVTRV629 EQU   CVTDMSRF                                                 03524000
CVTUDUMP EQU   CVTDMSRF                                                 03525000
CVTSDUMP EQU   CVTDMSRF                                                 03526000
CVTQMSGA EQU   CVTQMSG+1                                                03527000
CVTRSV36 EQU   CVTQMSG                                                  03528000
CVTAMFF  EQU   CVTMAP+264                                               03529000
CVTPURGA EQU   CVTPURG+1                                                03530000
CVTRSV35 EQU   CVTPURG                                                  03531000
CVTCBSP  EQU   CVTMAP+256                                               03532000
CVTATERA EQU   CVTATER+1                                                03533000
CVTSYST  EQU   CVTATER                                                  03534000
CVTVOLT2 EQU   CVTTAT                                                   03535000
CVTVOLI2 EQU   CVTVOLF2                                                 03536000
CVTAQAVB EQU   CVTAQAVT+1                                               03537000
CVTRSV34 EQU   CVTTCMFG                                                 03538000
CVTRSV33 EQU   CVTTCMFG                                                 03539000
CVTRSV32 EQU   CVTTCMFG                                                 03540000
CVTRSV31 EQU   CVTTCMFG                                                 03541000
CVTRSV30 EQU   CVTTCMFG                                                 03542000
CVTRSV29 EQU   CVTTCMFG                                                 03543000
CVTLDEV  EQU   CVTTCMFG                                                 03544000
CVTTCRDY EQU   CVTTCMFG                                                 03545000
CVTGTFA  EQU   CVTGTF+1                                                 03546000
CVTRSV27 EQU   CVTGTFST                                                 03547000
CVTRNIO  EQU   CVTGTFST                                                 03548000
CVTUSR   EQU   CVTGTFST                                                 03549000
CVTRV318 EQU   CVTFORM                                                  03550000
CVTRV317 EQU   CVTTMODE                                                 03551000
CVTRV316 EQU   CVTSTATE                                                 03552000
CVTRV315 EQU   CVTGTFS                                                  03553000
CVTGTFAV EQU   CVTGTFS                                                  03554000
CVT0SCR1 EQU   CVTMAP+232                                               03555000
CVTRV515 EQU   CVTMAP+228                                               03556000
CVTRMS   EQU   CVTMAP+224                                               03557000
CVTPATCH EQU   CVTMAP+220                                               03558000
CVTTSCE  EQU   CVTMAP+216                                               03559000
CVTLNKSC EQU   CVTMAP+214                                               03560000
CVTQABST EQU   CVTMAP+212                                               03561000
CVTMDLDS EQU   CVTMAP+208                                               03562000
CVTUSER  EQU   CVTMAP+204                                               03563000
CVTABEND EQU   CVTMAP+200                                               03564000
CVTSMCA  EQU   CVTMAP+196                                               03565000
CVTRSV18 EQU   CVTMAP+192                                               03566000
CVTQLPAQ EQU   CVTMAP+188                                               03567000
CVTQCDSR EQU   CVTMAP+184                                               03568000
CVTRSV17 EQU   CVTOPTB                                                  03569000
CVTRSV16 EQU   CVTOPTB                                                  03570000
CVTFP    EQU   CVTOPTB                                                  03571000
CVTAPTHR EQU   CVTOPTB                                                  03572000
CVTNLOG  EQU   CVTOPTB                                                  03573000
CVTTOD   EQU   CVTOPTB                                                  03574000
CVTCTIMS EQU   CVTOPTB                                                  03575000
CVTPROT  EQU   CVTOPTB                                                  03576000
CVTXPFP  EQU   CVTOPTA                                                  03577000
CVTASCII EQU   CVTOPTA                                                  03578000
CVTRSV13 EQU   CVTOPTA                                                  03579000
CVTRSV12 EQU   CVTOPTA                                                  03580000
CVTNIP   EQU   CVTOPTA                                                  03581000
CVTDDR   EQU   CVTOPTA                                                  03582000
CVTAPR   EQU   CVTOPTA                                                  03583000
CVTCCH   EQU   CVTOPTA                                                  03584000
CVTSNCTR EQU   CVTMAP+180                                               03585000
CVTQMWR  EQU   CVTMAP+176                                               03586000
CVTQOCR  EQU   CVTMAP+172                                               03587000
CVT1EF00 EQU   CVTMAP+168                                               03588000
CVTMZ00  EQU   CVTMAP+164                                               03589000
CVTHEAD  EQU   CVTMAP+160                                               03590000
CVTRSV11 EQU   CVTMAP+156                                               03591000
CVT0PT01 EQU   CVTMAP+152                                               03592000
CVTMSER  EQU   CVTMAP+148                                               03593000
CVTRV516 EQU   CVTIERLC                                                 03594000
CVTILCH  EQU   CVTMAP+140                                               03595000
CVT0DS   EQU   CVTMAP+136                                               03596000
CVTFBOSV EQU   CVTMAP+132                                               03597000
CVTNUCB  EQU   CVTMAP+128                                               03598000
CVTIXAVL EQU   CVTMAP+124                                               03599000
CVTIOQET EQU   CVTMAP+120                                               03600000
CVTDCBA  EQU   CVTMAP+117                                               03601000
CVTMVS2  EQU   CVTDCB                                                   03602000
CVT6DAT  EQU   CVTDCB                                                   03603000
CVT4MPS  EQU   CVTDCB                                                   03604000
CVTRSV09 EQU   CVTDCB                                                   03605000
CVT4MS1  EQU   CVTDCB                                                   03606000
CVT2SPS  EQU   CVTDCB                                                   03607000
CVT1SSS  EQU   CVTDCB                                                   03608000
CVTRSV08 EQU   CVTDCB                                                   03609000
CVTSTB   EQU   CVTMAP+112                                               03610000
CVTQTD00 EQU   CVTMAP+108                                               03611000
CVTQTE00 EQU   CVTMAP+104                                               03612000
CVTCUCB  EQU   CVTMAP+100                                               03613000
CVTSJQ   EQU   CVTMAP+96                                                03614000
CVTPBLDL EQU   CVTMAP+92                                                03615000
CVTTPC   EQU   CVTMAP+88                                                03616000
CVTSVDCB EQU   CVTMAP+84                                                03617000
CVTBRET  EQU   CVTMAP+82                                                03618000
CVTEXIT  EQU   CVTMAP+80                                                03619000
CVT0FN00 EQU   CVTMAP+76                                                03620000
CVTDARA  EQU   CVTDAR+1                                                 03621000
CVTRSV07 EQU   CVTFLGS1                                                 03622000
CVTRSV06 EQU   CVTFLGS1                                                 03623000
CVTRSV05 EQU   CVTFLGS1                                                 03624000
CVTRSV04 EQU   CVTFLGS1                                                 03625000
CVTRSV03 EQU   CVTFLGS1                                                 03626000
CVTRSV02 EQU   CVTFLGS1                                                 03627000
CVTRSV01 EQU   CVTFLGS1                                                 03628000
CVTDMPLK EQU   CVTFLGS1                                                 03629000
CVTXITP  EQU   CVTMAP+68                                                03630000
CVTZDTAB EQU   CVTMAP+64                                                03631000
CVTMSLT  EQU   CVTMAP+60                                                03632000
CVTDATE  EQU   CVTMAP+56                                                03633000
CVTBTERM EQU   CVTMAP+52                                                03634000
CVTSYSAD EQU   CVTMAP+48                                                03635000
CVTXTLER EQU   CVTMAP+44                                                03636000
CVTILK2  EQU   CVTMAP+40                                                03637000
CVTILK1  EQU   CVTMAP+36                                                03638000
CVTPRLTV EQU   CVTMAP+32                                                03639000
CVTPCNVT EQU   CVTMAP+28                                                03640000
CVT0VL00 EQU   CVTMAP+24                                                03641000
CVTXAPG  EQU   CVTMAP+20                                                03642000
CVTBUF   EQU   CVTMAP+16                                                03643000
CVTJOB   EQU   CVTMAP+12                                                03644000
CVTLINK  EQU   CVTMAP+8                                                 03645000
CVT0EF00 EQU   CVTMAP+4                                                 03646000
CVTTCBP  EQU   CVTMAP                                                   03647000
CVT      EQU   CVTMAP                                                   03648000
ATARCRF8 EQU   ATARCRSN                                                 03649000
ATARCRF7 EQU   ATARCRSN                                                 03650000
ATARCRF6 EQU   ATARCRSN                                                 03651000
ATARCRF5 EQU   ATARCRSN                                                 03652000
ATARCRF4 EQU   ATARCRSN                                                 03653000
ATARCRF3 EQU   ATARCRSN                                                 03654000
ATARCRF2 EQU   ATARCRSN                                                 03655000
ATARCRF1 EQU   ATARCRSN                                                 03656000
ATARSV2  EQU   ATARFLGS                                                 03657000
ATABADPK EQU   ATARFLGS                                                 03658000
ATASCCWP EQU   ATARFLGS                                                 03659000
ATASGNST EQU   ATARFLGS                                                 03660000
ATARSV1  EQU   ATASFLGS+1                                               03661000
ATASRT   EQU   ATASFLGS+1                                               03662000
ATASWPDR EQU   ATASFLGS+1                                               03663000
ATATRPAG EQU   ATASFLGS+1                                               03664000
ATASWAP  EQU   ATASFLGS+1                                               03665000
ATAPAGCM EQU   ATASFLGS                                                 03666000
ATAPAGIO EQU   ATASFLGS                                                 03667000
ATAPOS   EQU   ATASFLGS                                                 03668000
ATAPCOMP EQU   ATASFLGS                                                 03669000
ATAVIOCM EQU   ATASFLGS                                                 03670000
ATASCOMP EQU   ATASFLGS                                                 03671000
ATASLSQA EQU   ATASFLGS                                                 03672000
ATAQIOE  EQU   ATASFLGS                                                 03673000
ASMCPRES EQU   ASMCPRSQ+4                                               03674000
ASMCPTAK EQU   ASMCPRSQ                                                 03675000
ASMCPCNT EQU   ASMCPAVQ+4                                               03676000
ASMCPEXT EQU   ASMPOOLS+6                                               03677000
ASMCPSIZ EQU   ASMPOOLS+4                                               03678000
ASMCPID  EQU   ASMPOOLS                                                 03679000
ASMRSV12 EQU   ASMVT+1000                                               03680000
ASMSAVE  EQU   ASMVT+928                                                03681000
ASMWKSA7 EQU   ASMVT+848                                                03682000
ASMWKSA6 EQU   ASMVT+768                                                03683000
ASMACEPC EQU   ASMVT+344                                                03684000
ASMSWKPC EQU   ASMVT+328                                                03685000
ASMBWKPC EQU   ASMVT+312                                                03686000
ASMRSV10 EQU   ASMVT+280                                                03687000
ASMPVACE EQU   ASMVT+276                                                03688000
ASMPIOFR EQU   ASMVT+272                                                03689000
ASMPVACQ EQU   ASMVT+268                                                03690000
ASMPMSGS EQU   ASMVT+264                                                03691000
ASMPMSG0 EQU   ASMVT+260                                                03692000
ASMPFRLG EQU   ASMVT+256                                                03693000
ASMPRLG  EQU   ASMVT+252                                                03694000
ASMPACT  EQU   ASMVT+248                                                03695000
ASMPSAV  EQU   ASMVT+244                                                03696000
ASMPCMP  EQU   ASMVT+240                                                03697000
ASMPCMPA EQU   ASMVT+236                                                03698000
ASMPCMPN EQU   ASMVT+232                                                03699000
ASMPCMPD EQU   ASMVT+228                                                03700000
ASMVRMTR EQU   ASMVT+220                                                03701000
ASMPSRBC EQU   ASMVT+216                                                03702000
ASMPSRMT EQU   ASMVT+212                                                03703000
ASMPSWPD EQU   ASMVT+208                                                03704000
ASMPTM   EQU   ASMVT+204                                                03705000
ASMPFRSW EQU   ASMVT+200                                                03706000
ASMPFRSL EQU   ASMVT+196                                                03707000
ASMPQIOE EQU   ASMVT+192                                                03708000
ASMRSV8  EQU   ASMVT+184                                                03709000
ASMTASCB EQU   ASMVT+180                                                03710000
ASMRLGWQ EQU   ASMVT+176                                                03711000
ASMRLGRQ EQU   ASMVT+172                                                03712000
ASMTMECB EQU   ASMVT+168                                                03713000
ASMTCBPT EQU   ASMVT+164                                                03714000
ASMREQCT EQU   ASMVT+160                                                03715000
ASMGOSWK EQU   ASMGOSQS+4                                               03716000
ASMGOSWT EQU   ASMGOSQS                                                 03717000
ASMLSAIH EQU   ASMLSAI+4                                                03718000
ASMLSAIL EQU   ASMLSAI                                                  03719000
ASMCINV  EQU   ASMVT+140                                                03720000
ASMSTGXA EQU   ASMVT+136                                                03721000
ASMLGVT  EQU   ASMVT+132                                                03722000
ASMSLOTV EQU   ASMVT+128                                                03723000
ASMERRS  EQU   ASMVT+124                                                03724000
ASMNVSC  EQU   ASMVT+120                                                03725000
ASMVSC   EQU   ASMVT+116                                                03726000
ASMSLOTS EQU   ASMVT+112                                                03727000
ASMBKSLT EQU   ASMVT+108                                                03728000
ASMRSV7  EQU   ASMVT+92                                                 03729000
ASMBURST EQU   ASMVT+76                                                 03730000
ASMPCCWN EQU   ASMVT+72                                                 03731000
ASMPCCWC EQU   ASMPCCWQ+4                                               03732000
ASMRSV6  EQU   ASMVT+48                                                 03733000
ASMIORQC EQU   ASMVT+44                                                 03734000
ASMIORQR EQU   ASMVT+40                                                 03735000
ASMSTAGL EQU   ASMSTAGQ+4                                               03736000
ASMSTAGF EQU   ASMSTAGQ                                                 03737000
ASMRSV5  EQU   ASMVT+28                                                 03738000
ASMMSGBF EQU   ASMVT+24                                                 03739000
ASMEREC  EQU   ASMVT+20                                                 03740000
ASMTRPAG EQU   ASMVT+16                                                 03741000
ASMGOS   EQU   ASMVT+12                                                 03742000
ASMSART  EQU   ASMVT+4                                                  03743000
ASMRSV4  EQU   ASMVT+2                                                  03744000
ASMWARM  EQU   ASMFLAG2                                                 03745000
ASMQUICK EQU   ASMFLAG2                                                 03746000
ASMNOTPT EQU   ASMFLAG2                                                 03747000
ASMNOTMR EQU   ASMFLAG2                                                 03748000
ASMNOSAV EQU   ASMFLAG2                                                 03749000
ASMCALLQ EQU   ASMFLAG2                                                 03750000
ASMPLPAS EQU   ASMFLAG1                                                 03751000
ASMRSV1  EQU   ASMFLAG1                                                 03752000
ASMNOLCL EQU   ASMFLAG1                                                 03753000
AIACEPTR EQU   AIALPMEP                                                 03754000
@NM00002 EQU   AIASSID                                                  03755000
@NM00001 EQU   AIALSID                                                  03756000
AIARSV9  EQU   AIAFLG3                                                  03757000
AIARSV8  EQU   AIAFLG3                                                  03758000
AIARSV7  EQU   AIAFLG3                                                  03759000
AIALPMEC EQU   AIAFLG3                                                  03760000
AIARSV6  EQU   AIAFLG3                                                  03761000
AIATRPSP EQU   AIAFLG3                                                  03762000
AIAPRINO EQU   AIAFLG3                                                  03763000
AIARSV5  EQU   AIAFLG3                                                  03764000
AIABADID EQU   AIAFLG2                                                  03765000
AIAERROR EQU   AIAFLG2                                                  03766000
AIAPRIER EQU   AIAFLG2                                                  03767000
AIARSV4  EQU   AIAFLG2                                                  03768000
AIAIORTY EQU   AIAFLG2                                                  03769000
AIATERMR EQU   AIAFLG2                                                  03770000
AIAFRAUX EQU   AIAFLG2                                                  03771000
AIARSV1  EQU   AIAFLG1                                                  03772000
AIASWPFX EQU   AIAFLG1                                                  03773000
AIAPAGDS EQU   AIAFLG1                                                  03774000
AIALSQA  EQU   AIAFLG1                                                  03775000
AIADUPLX EQU   AIAFLG1                                                  03776000
AIAVIO   EQU   AIAFLG1                                                  03777000
AIAPRIV  EQU   AIAFLG1                                                  03778000
AIAWRITE EQU   AIAFLG1                                                  03779000
AIAOP    EQU   AIA+8                                                    03780000
AIABQPA  EQU   AIA+4                                                    03781000
AIAFQPA  EQU   AIA                                                      03782000
@NM00045 EQU   PSA+3668                                                 03783000
PSASTAK  EQU   PSA+3072                                                 03784000
@NM00044 EQU   PSA+1048                                                 03785000
PSAUSEND EQU   PSA+1048                                                 03786000
PSARV062 EQU   PSA+1044                                                 03787000
PSACDAL  EQU   PSA+1040                                                 03788000
PSAWTCOD EQU   PSA+1036                                                 03789000
PSAATCVT EQU   PSA+1032                                                 03790000
PSAPCPSW EQU   PSA+1024                                                 03791000
PSAPIR2  EQU   PSA+1020                                                 03792000
PSARV059 EQU   PSA+1018                                                 03793000
PSASVC13 EQU   PSA+1016                                                 03794000
PSASFACC EQU   PSA+1008                                                 03795000
PSASTOP  EQU   PSA+992                                                  03796000
PSASTART EQU   PSA+976                                                  03797000
PSARSPSW EQU   PSA+968                                                  03798000
PSASRPSW EQU   PSA+960                                                  03799000
PSARV045 EQU   PSA+892                                                  03800000
PSARV044 EQU   PSA+888                                                  03801000
PSARV043 EQU   PSA+884                                                  03802000
PSARV042 EQU   PSA+880                                                  03803000
PSARV041 EQU   PSA+876                                                  03804000
PSARV040 EQU   PSA+872                                                  03805000
PSARV025 EQU   PSA+868                                                  03806000
PSADSSED EQU   PSA+868                                                  03807000
PSADSSPR EQU   PSA+864                                                  03808000
PSADSSFW EQU   PSA+860                                                  03809000
PSADSS14 EQU   PSA+856                                                  03810000
PSADSSPP EQU   PSA+848                                                  03811000
PSADSSRP EQU   PSA+840                                                  03812000
PSADSS05 EQU   PSADSSF4                                                 03813000
PSADSS10 EQU   PSADSSF4                                                 03814000
PSADSSVE EQU   PSADSSF4                                                 03815000
PSADSSDE EQU   PSADSSF4                                                 03816000
PSADSSC0 EQU   PSADSSF4                                                 03817000
PSADSSIE EQU   PSADSSF4                                                 03818000
PSADSS12 EQU   PSADSSF4                                                 03819000
PSADSSRC EQU   PSADSSF4                                                 03820000
PSARV057 EQU   PSADSSF3                                                 03821000
PSARV056 EQU   PSADSSF3                                                 03822000
PSARV055 EQU   PSADSSF3                                                 03823000
PSADSSMC EQU   PSADSSF3                                                 03824000
PSADSSRW EQU   PSADSSF3                                                 03825000
PSADSSNM EQU   PSADSSF3                                                 03826000
PSADSSES EQU   PSADSSF3                                                 03827000
PSADSSGP EQU   PSADSSF3                                                 03828000
PSADSSF2 EQU   PSADSSFL+1                                               03829000
PSADSSPI EQU   PSADSSF1                                                 03830000
PSADSSOI EQU   PSADSSF1                                                 03831000
PSADSSSP EQU   PSADSSF1                                                 03832000
PSADSSTP EQU   PSADSSF1                                                 03833000
PSADSSDW EQU   PSADSSF1                                                 03834000
PSADSSDD EQU   PSADSSF1                                                 03835000
PSADSSDM EQU   PSADSSF1                                                 03836000
PSADSSMV EQU   PSADSSF1                                                 03837000
PSADSSTS EQU   PSA+816                                                  03838000
PSADSSWK EQU   PSA+812                                                  03839000
PSADSSR3 EQU   PSA+808                                                  03840000
PSADSSR2 EQU   PSA+804                                                  03841000
PSADSSRS EQU   PSA+800                                                  03842000
PSASTOR  EQU   PSA+796                                                  03843000
PSACPUSA EQU   PSA+794                                                  03844000
PSAVSTAP EQU   PSA+792                                                  03845000
PSAWKVAP EQU   PSA+788                                                  03846000
PSAWKRAP EQU   PSA+784                                                  03847000
PSAMCHIC EQU   PSA+783                                                  03848000
PSARV061 EQU   PSA+782                                                  03849000
PSASYMSK EQU   PSA+781                                                  03850000
PSAMCHFL EQU   PSA+780                                                  03851000
PSACR0   EQU   PSA+776                                                  03852000
PSAPSWSV EQU   PSA+768                                                  03853000
PSACLHS  EQU   PSAHLHI                                                  03854000
PSALKR15 EQU   PSALKSA+60                                               03855000
PSALKR14 EQU   PSALKSA+56                                               03856000
PSALKR13 EQU   PSALKSA+52                                               03857000
PSALKR12 EQU   PSALKSA+48                                               03858000
PSALKR11 EQU   PSALKSA+44                                               03859000
PSALKR10 EQU   PSALKSA+40                                               03860000
PSALKR9  EQU   PSALKSA+36                                               03861000
PSALKR8  EQU   PSALKSA+32                                               03862000
PSALKR7  EQU   PSALKSA+28                                               03863000
PSALKR6  EQU   PSALKSA+24                                               03864000
PSALKR5  EQU   PSALKSA+20                                               03865000
PSALKR4  EQU   PSALKSA+16                                               03866000
PSALKR3  EQU   PSALKSA+12                                               03867000
PSALKR2  EQU   PSALKSA+8                                                03868000
PSALKR1  EQU   PSALKSA+4                                                03869000
PSALKR0  EQU   PSALKSA                                                  03870000
PSARV023 EQU   PSACLHT+52                                               03871000
PSALOCAL EQU   PSACLHT+48                                               03872000
PSACMSL  EQU   PSACLHT+44                                               03873000
PSAOPTL  EQU   PSACLHT+40                                               03874000
PSATPACL EQU   PSACLHT+36                                               03875000
PSATPDNL EQU   PSACLHT+32                                               03876000
PSATPNCL EQU   PSACLHT+28                                               03877000
PSAIOSLL EQU   PSACLHT+24                                               03878000
PSAIOSUL EQU   PSACLHT+20                                               03879000
PSAIOSCL EQU   PSACLHT+16                                               03880000
PSAIOSSL EQU   PSACLHT+12                                               03881000
PSASALCL EQU   PSACLHT+8                                                03882000
PSAASML  EQU   PSACLHT+4                                                03883000
PSADISPL EQU   PSACLHT                                                  03884000
PSASRSA  EQU   PSA+636                                                  03885000
PSARV050 EQU   PSA+634                                                  03886000
PSADSSGO EQU   PSA+633                                                  03887000
PSARECUR EQU   PSA+632                                                  03888000
PSAHLHIS EQU   PSA+628                                                  03889000
PSAIPCSA EQU   PSA+624                                                  03890000
@NM00043 EQU   PSA+621                                                  03891000
PSAIPCDM EQU   PSA+620                                                  03892000
PSAIPCD  EQU   PSA+616                                                  03893000
@NM00042 EQU   PSA+613                                                  03894000
PSAIPCRM EQU   PSA+612                                                  03895000
PSAIPCR  EQU   PSA+608                                                  03896000
PSAMCHEX EQU   PSA+600                                                  03897000
PSAMPSW  EQU   PSA+592                                                  03898000
PSAEXPS2 EQU   PSA+584                                                  03899000
PSAEXPS1 EQU   PSA+576                                                  03900000
PSAPIREG EQU   PSA+572                                                  03901000
PSARSREG EQU   PSA+568                                                  03902000
PSAGPREG EQU   PSA+556                                                  03903000
PSARV022 EQU   PSASUP4                                                  03904000
PSARV021 EQU   PSASUP4                                                  03905000
PSARV020 EQU   PSASUP4                                                  03906000
PSARV019 EQU   PSASUP4                                                  03907000
PSARV018 EQU   PSASUP4                                                  03908000
PSARV017 EQU   PSASUP4                                                  03909000
PSARV016 EQU   PSASUP4                                                  03910000
PSARV015 EQU   PSASUP4                                                  03911000
PSARV014 EQU   PSASUP3                                                  03912000
PSARV013 EQU   PSASUP3                                                  03913000
PSARV012 EQU   PSASUP3                                                  03914000
PSAESTA  EQU   PSASUP3                                                  03915000
PSASPR   EQU   PSASUP3                                                  03916000
PSAPSREG EQU   PSASUP3                                                  03917000
PSAPI2   EQU   PSASUP3                                                  03918000
PSAIOSUP EQU   PSASUP3                                                  03919000
PSALCR   EQU   PSASUP2                                                  03920000
PSARTM   EQU   PSASUP2                                                  03921000
PSAACR   EQU   PSASUP2                                                  03922000
PSAIPCE2 EQU   PSASUP2                                                  03923000
PSAIPCES EQU   PSASUP2                                                  03924000
PSAIPCEC EQU   PSASUP2                                                  03925000
PSAGTF   EQU   PSASUP2                                                  03926000
PSAIPCRI EQU   PSASUP2                                                  03927000
PSATYPE6 EQU   PSASUP1                                                  03928000
PSATCTL  EQU   PSASUP1                                                  03929000
PSADISP  EQU   PSASUP1                                                  03930000
PSALOCK  EQU   PSASUP1                                                  03931000
PSAPI    EQU   PSASUP1                                                  03932000
PSAEXT   EQU   PSASUP1                                                  03933000
PSASVC   EQU   PSASUP1                                                  03934000
PSAIO    EQU   PSASUP1                                                  03935000
PSAAOLD  EQU   PSA+548                                                  03936000
PSAANEW  EQU   PSA+544                                                  03937000
PSATOLD  EQU   PSA+540                                                  03938000
PSATNEW  EQU   PSA+536                                                  03939000
PSALCCAR EQU   PSA+532                                                  03940000
PSAPCCAR EQU   PSA+524                                                  03941000
PSAPCCAV EQU   PSA+520                                                  03942000
PSACPULA EQU   PSA+518                                                  03943000
PSACPUPA EQU   PSA+516                                                  03944000
PSAPSA   EQU   PSA+512                                                  03945000
FLCHDEND EQU   PSA+512                                                  03946000
FLCCRSAV EQU   FLCMCLA+280                                              03947000
FLCGRSAV EQU   FLCMCLA+216                                              03948000
FLCFPSAV EQU   FLCMCLA+184                                              03949000
FLCFLA   EQU   FLCMCLA+88                                               03950000
FLCRGNCD EQU   FLCMCLA+84                                               03951000
FLCFSAA  EQU   FLCFSA+1                                                 03952000
@NM00041 EQU   FLCFSA                                                   03953000
@NM00040 EQU   FLCMCLA+72                                               03954000
FLCMCIC  EQU   FLCMCLA+64                                               03955000
@NM00039 EQU   FLCMCLA+20                                               03956000
FLCIOAA  EQU   FLCIOA+1                                                 03957000
@NM00038 EQU   FLCIOA                                                   03958000
@NM00037 EQU   FLCMCLA+15                                               03959000
@NM00036 EQU   FLCMCLA+14                                               03960000
@NM00035 EQU   FLCMCLA+12                                               03961000
FLCLCL   EQU   FLCMCLA+8                                                03962000
FLCIOELA EQU   FLCIOEL+1                                                03963000
@NM00034 EQU   FLCIOEL                                                  03964000
FLCCHNID EQU   FLCMCLA                                                  03965000
@NM00033 EQU   PSA+160                                                  03966000
FLCMTRCD EQU   PSA+157                                                  03967000
@NM00032 EQU   PSA+156                                                  03968000
FLCPERA  EQU   FLCPER+1                                                 03969000
@NM00031 EQU   FLCPER                                                   03970000
@NM00030 EQU   PSA+151                                                  03971000
FLCPERCD EQU   PSA+150                                                  03972000
FLCMCNUM EQU   PSA+149                                                  03973000
@NM00029 EQU   PSA+148                                                  03974000
FLCTEAA  EQU   FLCTEA+1                                                 03975000
@NM00028 EQU   FLCTEA                                                   03976000
PSAPIPC  EQU   PSAPICOD                                                 03977000
PSAPIMC  EQU   PSAPICOD                                                 03978000
PSAPIPER EQU   PSAPICOD                                                 03979000
PSARV049 EQU   FLCPICOD                                                 03980000
FLCPILCB EQU   FLCPIILC                                                 03981000
@NM00027 EQU   FLCPIILC                                                 03982000
@NM00026 EQU   PSAEPPSW                                                 03983000
FLCSVCN  EQU   PSAESPSW+2                                               03984000
FLCSILCB EQU   FLCSVILC                                                 03985000
@NM00025 EQU   FLCSVILC                                                 03986000
@NM00024 EQU   PSAESPSW                                                 03987000
FLCEICOD EQU   PSAEEPSW+2                                               03988000
PSASPAD  EQU   PSAEEPSW                                                 03989000
@NM00023 EQU   PSA+128                                                  03990000
FLCINPSW EQU   PSA+120                                                  03991000
FLCMNPSW EQU   PSA+112                                                  03992000
FLCPNPSW EQU   PSA+104                                                  03993000
FLCSNPSW EQU   PSA+96                                                   03994000
FLCENPSW EQU   PSA+88                                                   03995000
FLCTRACE EQU   PSA+84                                                   03996000
FLCTIMER EQU   PSA+80                                                   03997000
FLCCVT2  EQU   PSA+76                                                   03998000
FLCCAW   EQU   PSA+72                                                   03999000
FLCCSW   EQU   PSA+64                                                   04000000
FLCIOPSW EQU   PSA+56                                                   04001000
FLCMOPSW EQU   PSA+48                                                   04002000
FLCPOPSW EQU   PSA+40                                                   04003000
FLCSOPSW EQU   PSA+32                                                   04004000
FLCEOPSW EQU   PSA+24                                                   04005000
@NM00022 EQU   FLCICCW2+4                                               04006000
FLCICCW1 EQU   FLCROPSW                                                 04007000
FLCIPPSW EQU   FLCRNPSW                                                 04008000
*                                      END UNREFERENCED COMPONENTS      04009000
@RC00181 EQU   @RC00146                                                 04010000
@RC00424 EQU   @RC00422                                                 04011000
@RC00455 EQU   @RC00453                                                 04012000
@RC00589 EQU   @RC00588                                                 04013000
@ENDDATA EQU   *                                                        04014000
         END   ILRPTM,(C'PLS2045',0701,76114)                           04015000
