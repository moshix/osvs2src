         TITLE 'ILRSRT, ASM SLOT SORT                                  *00001000
                        '                                               00002000
ILRSRT   CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(22)                                             0001 00007000
         DC    C'ILRSRT 78110  UZ16491 '                           0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @08,0                                               0001 00011000
@PSTART  LA    @10,4095(,@08)                                      0001 00012000
         USING @PSTART,@08                                         0001 00013000
         USING @PSTART+4095,@10                                    0001 00014000
*   R9=R1->PTRWORK;                 /* SET SRT WORKAREA BASE         */ 00015000
         L     R9,PTRWORK(,R1)                                     0111 00016000
*   GEN REFS(R9) SETS(R13,R15);                                    0112 00017000
      USING @DATD,R9                                                    00018000
      LA    R15,SRTSA                 PUT ADDR OF MY S.A. INTO REG 15   00019000
      ST    R13,4(R15)                CHAIN BACKWARD TO CALLERS S.A.    00020000
      ST    R15,8(R13)                CHAIN FORWARD IN CALLERS S.A.     00021000
      LR    R13,R15                   PUT ADDR OF MY S.A. INTO REG 13   00022000
*   ATAPTR=R4;                      /* PICK UP ATA BASE- PTM PASSED  */ 00023000
         ST    R4,ATAPTR                                           0113 00024000
*   EPAPTR=ATAEPATH;                /* RESET REG 4 TO EPATH FOR SRT  */ 00025000
         L     @14,ATAPTR                                          0114 00026000
         L     EPAPTR,ATAEPATH(,@14)                               0114 00027000
*   RFY                                                            0115 00028000
*     R15 UNRSTD;                                                  0115 00029000
*                                                                  0115 00030000
*/*           P **** FRR **** INDICATE SRT IN CONTROL                */ 00031000
*                                                                  0116 00032000
*   ATASRT=ON;                      /* INDICATE SRT RUNNING          */ 00033000
         OI    ATASRT(@14),B'00010000'                             0116 00034000
*   PRMLADDR=R1;                    /* SAVE ADDRESS OF PARM LIST     */ 00035000
         ST    R1,PRMLADDR                                         0117 00036000
*   RFY                                                            0118 00037000
*     R1 UNRSTD;                                                   0118 00038000
*                                                                  0118 00039000
*   /*****************************************************************/ 00040000
*   /*                                                               */ 00041000
*   /* INITIALIZE WORKING VARIABLES, ESTABLISH CONTROL BLOCK POINTERS*/ 00042000
*   /*                                                               */ 00043000
*   /*****************************************************************/ 00044000
*                                                                  0119 00045000
*/*           S INITLZ: INITLZ WORK VBLS, CONTROL BLOCK PTRS         */ 00046000
*                                                                  0119 00047000
*   CALL INITLZ;                                                   0119 00048000
*                                                                  0119 00049000
         BAL   @14,INITLZ                                          0119 00050000
*/*  D (YES,,NO,%SRT20) 1 READ & NO WRITES? PARENODE                 */ 00051000
*/*           P RE- COMPLIMENT ADDR TO MAKE POSITIVE                 */ 00052000
*/*           P REMOVE IOE FROM QUE (PARENODE)                       */ 00053000
*/*           P SETUP FOR CALL TO PROCHIT                            */ 00054000
*/*  S (,%SRT60) PROCHIT: INIT & CHAIN PCCW, SAVE IOE FOR LATER FREE */ 00055000
*                                                                  0120 00056000
*   IF PNODETST<0 THEN              /* SPECIAL INTERFACE FROM PTM  0120 00057000
*                                      INDICATING ONE READ AND NO  0120 00058000
*                                      WRITES?                       */ 00059000
         SLR   @12,@12                                             0120 00060000
         L     @11,PAREPTR                                         0120 00061000
         L     @05,PNODETST(,@11)                                  0120 00062000
         CR    @05,@12                                             0120 00063000
         BNL   @RF00120                                            0120 00064000
*     DO;                           /* YES-                          */ 00065000
*       PNODETST=ABS(PNODETST);     /* RESTORE ACTUAL ADDRESS OF READ   00066000
*                                      IOE                           */ 00067000
         L     @02,PAREPTR                                         0122 00068000
         L     @02,PNODETST(,@02)                                  0122 00069000
         LPR   @02,@02                                             0122 00070000
         ST    @02,PNODETST(,@11)                                  0122 00071000
*       IOEPTR=PARENODE;            /* GET READ IOE                  */ 00072000
         L     IOEPTR,PARENODE(,@11)                               0123 00073000
*       PARENODE=0;                 /* REMOVE SINGLE ELEMENT FROM  0124 00074000
*                                      TREE                          */ 00075000
         SLR   @02,@02                                             0124 00076000
         ST    @02,PARENODE(,@11)                                  0124 00077000
*       AIAPTR=IOEAIA;              /* PICK UP AIA BASE              */ 00078000
         L     AIAPTR,IOEAIA(,IOEPTR)                              0125 00079000
*       TSLOTNBR=AIASLOT;           /* REL SLOT NBR FOR REQUEST      */ 00080000
         LH    @02,AIASLOT(,AIAPTR)                                0126 00081000
         N     @02,@CF02144                                        0126 00082000
         ST    @02,TSLOTNBR                                        0126 00083000
*       PARELCYL=AIACYL;            /* SET UP FOR CALL TO            */ 00084000
         LH    @02,AIACYL(,AIAPTR)                                 0127 00085000
         STH   @02,PARELCYL(,@11)                                  0127 00086000
*       SSLOT=AIARCSN;              /* PROCHIT SUBROUTINE            */ 00087000
         LH    @11,AIARCSN(,AIAPTR)                                0128 00088000
         ST    @11,SSLOT                                           0128 00089000
*       CALL PROCHIT;               /* INITIALIZE READ I/O REQUEST   */ 00090000
         BAL   @14,PROCHIT                                         0129 00091000
*     END;                          /* END SPECIAL INTERFACE         */ 00092000
*                                                                  0130 00093000
*   /*****************************************************************/ 00094000
*   /*                                                               */ 00095000
*   /* LOOP TO CHAIN REQUESTS ON THE IORB BY CYLINDER BY BEST        */ 00096000
*   /* POSSIBLE SLOT POSITION WITHIN THE CYLINDER. CONTINUE CHAINING */ 00097000
*   /* REQUESTS UNTIL ONE OF THE FOLLOWING CONDITIONS ARE            */ 00098000
*   /* ENCOUNTERED... 1) SERVICE BURST QUOTA IS MET, 2) NO PCCWS ARE */ 00099000
*   /* AVAILABLE, ---- OR ---- 3) NO MORE REQUESTS TO PROCESS,       */ 00100000
*   /*                                                               */ 00101000
*   /*****************************************************************/ 00102000
*                                                                  0131 00103000
*/*%SRT20:    N LOOP: ONE ITERATION PROCESSES REQUESTS FOR ONE CYL   */ 00104000
*/*           D (NO,,YES,%SRT60) OUT OF RESOURCES OR IOES ?          */ 00105000
*                                                                  0131 00106000
*   ELSE                            /* NO- NOT SPECIAL INTERFACE FROM   00107000
*                                      PTM                           */ 00108000
*     DO WHILE STOP=NO;                                            0131 00109000
*                                                                  0131 00110000
         B     @RC00120                                            0131 00111000
@RF00120 B     @DE00131                                            0131 00112000
@DL00131 DS    0H                                                  0132 00113000
*       /*************************************************************/ 00114000
*       /*                                                           */ 00115000
*       /* PERFORM CIRCULAR SCAN(C-SCAN) FROM THE CYLINDER LAST      */ 00116000
*       /* PROCESSED IN THE PAGING DATASET TO FIND THE NEXT          */ 00117000
*       /* CYLINDER... READ, WRITE, OR READ&WRITE... TO PROCESS      */ 00118000
*       /* REQUESTS                                                  */ 00119000
*       /*                                                           */ 00120000
*       /*************************************************************/ 00121000
*                                                                  0132 00122000
*/*           S CSCANCYL: EMPLOY C-SCAN TO FIND NEXT CYL TO PROCESS  */ 00123000
*                                                                  0132 00124000
*       CALL CSCANCYL;                                             0132 00125000
*                                                                  0132 00126000
         BAL   @14,CSCANCYL                                        0132 00127000
*       /*************************************************************/ 00128000
*       /*                                                           */ 00129000
*       /* IF A CYLINDER IS SUCCESSFULLY CHOSEN THEN PROCREQS WILL   */ 00130000
*       /* BUILD AN I/O REQUEST FOR EVERY USABLE SLOT, SO LONG AS    */ 00131000
*       /* RESOURCES AND SLOTS REMAIN AVAILABLE...                   */ 00132000
*       /*                                                           */ 00133000
*       /*************************************************************/ 00134000
*                                                                  0133 00135000
*/*           D (YES,,NO,%SRT50) CYLINDER OBTAINED ?                 */ 00136000
*/*           S PROCREQS: BUILD PCCWS FOR REQUESTS ON THIS CYLINDER  */ 00137000
*                                                                  0133 00138000
*       IF STOP=NO THEN                                            0133 00139000
         TM    STOP,B'10000000'                                    0133 00140000
         BNZ   @RF00133                                            0133 00141000
*         CALL PROCREQS;                                           0134 00142000
         BAL   @14,PROCREQS                                        0134 00143000
*       ELSE                                                       0135 00144000
*         ;                                                        0135 00145000
*                                                                  0135 00146000
@RF00133 DS    0H                                                  0136 00147000
*/*%SRT50:    N END CYLINDER PROCESS LOOP                            */ 00148000
*                                                                  0136 00149000
*     END;                          /* END LOOP TO CHAIN I/O REQS    */ 00150000
*                                                                  0136 00151000
@DE00131 TM    STOP,B'10000000'                                    0136 00152000
         BZ    @DL00131                                            0136 00153000
*   /*****************************************************************/ 00154000
*   /*                                                               */ 00155000
*   /* PCCWS TO READ OR WRITE PAGES ALL CHAINED UP ????... THEN      */ 00156000
*   /* FINISH UP THE I/O REQUEST CHAIN AND INVOKE IOS TO PERFORM THE */ 00157000
*   /* I/O                                                           */ 00158000
*   /*                                                               */ 00159000
*   /*****************************************************************/ 00160000
*                                                                  0137 00161000
*/*%SRT60:    S IO: COMPLETE I/O REQUEST CHAIN, STARTIO              */ 00162000
*                                                                  0137 00163000
*   CALL IO;                                                       0137 00164000
*                                                                  0137 00165000
@RC00120 BAL   @14,IO                                              0137 00166000
*   /*****************************************************************/ 00167000
*   /*                                                               */ 00168000
*   /* PERFORM NECESSARY CLEAN UP FUNCTIONS BEFORE RETURNING TO THE  */ 00169000
*   /* CALLER                                                        */ 00170000
*   /*                                                               */ 00171000
*   /*****************************************************************/ 00172000
*                                                                  0138 00173000
*/*           S CLEANUP: MISC CLEAN UP FUNCTIONS                     */ 00174000
*                                                                  0138 00175000
*   CALL CLEANUP;                                                  0138 00176000
         BAL   @14,CLEANUP                                         0138 00177000
*   ATASRT=OFF;                     /* RESET SRT IN PROCESS FLAG     */ 00178000
         L     @12,ATAPTR                                          0139 00179000
         NI    ATASRT(@12),B'11101111'                             0139 00180000
*/* REG 4 WHICH WAS CHANGED BY SRT TO BE EPATH PTR INSTEAD OF ATA  0140 00181000
*    PTR WILL BE RESTORED FOR PTM BEFORE RETURN BY LM ON EXIT.       */ 00182000
*/*          R RETURN TO CALLER                                      */ 00183000
*                                                                  0140 00184000
*   RETURN;                                                        0140 00185000
*                                                                  0140 00186000
@EL00001 DS    0H                                                  0140 00187000
@EF00001 DS    0H                                                  0140 00188000
@ER00001 LM    @14,@12,12(@13)                                     0140 00189000
         BR    @14                                                 0140 00190000
*/*ILRSRT:  END                                                      */ 00191000
*                                                                  0141 00192000
*                                                                  0141 00193000
*/*INITLZ: CHART                                                     */ 00194000
*/* HEADING                                                        0141 00195000
*/* ILRSRT - ASM SLOT SORT                                         0141 00196000
*/*                    ILRSRT INITIALIZATION                         */ 00197000
*/********************************************************************/ 00198000
*/*                                                                  */ 00199000
*/*      INITLZ: ILRSRT INITIALIZATION                               */ 00200000
*/*                                                                  */ 00201000
*/*      INPUT: INPUT PARAMETER LIST FROM ILRPTM                     */ 00202000
*/*                                                                  */ 00203000
*/*      PROCESS: VARIOUS VALUES USED THROUGHOUT SLOT SORT ARE       */ 00204000
*/*               OBTAINED AND/OR COMPUTED.  WORK VARIABLES ARE      */ 00205000
*/*               INITIALIZED.                                       */ 00206000
*/*                                                                  */ 00207000
*/*      OUTPUT: PART CYLINDER MAP INFORMATION                       */ 00208000
*/*              ADDR OF PART ENTRY                                  */ 00209000
*/*              ADDR OF APPROPRIATE DEVICE DEPENDENT FINDSLOT       */ 00210000
*/*               ROUTINE                                            */ 00211000
*/*              ZERO WORK VARIABLES                                 */ 00212000
*/*              COMPUTED SERVICE BURST REQUEST QUOTA                */ 00213000
*/*                                                                  */ 00214000
*/*                                                                  */ 00215000
*/********************************************************************/ 00216000
*/*INITLZ:   E ILRSRT INITIALIZATION                                 */ 00217000
*                                                                  0141 00218000
*INITLZ:                                                           0141 00219000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0141 00220000
INITLZ   DS    0H                                                  0142 00221000
*   RFY                                                            0142 00222000
*     R14 RSTD;                     /* RESTRICT RETURN REG           */ 00223000
*/*           M OBTAIN ADDRESS OF PART ENTRY FROM INPUT PARM LIST    */ 00224000
*                                                                  0143 00225000
*   PAREPTR=PTRPARE;                /* ADDR OF PART ENTRY            */ 00226000
         L     @15,PRMLADDR                                        0143 00227000
         L     @12,PTRPARE(,@15)                                   0143 00228000
         ST    @12,PAREPTR                                         0143 00229000
*   WRITEQUE=PTRWRITE;              /* SET UP WRITE QUEUE PTR        */ 00230000
         L     @15,PTRWRITE(,@15)                                  0144 00231000
         ST    @15,WRITEQUE                                        0144 00232000
*   RESPECIFY                                                      0145 00233000
*     PAT BASED(PAREPATP);                                         0145 00234000
*                                                                  0145 00235000
*/*           M GET PAT DATA: MAP ADDR, WORDS/ CYL-MAP, SLOTS/CYL    */ 00236000
*                                                                  0146 00237000
*   CYLMPWDS=PATCYLMW;              /* NBR WORDS/PER PAT CYL MAP     */ 00238000
         L     @15,PAREPATP(,@12)                                  0146 00239000
         LH    @11,PATCYLMW(,@15)                                  0146 00240000
         ST    @11,CYLMPWDS                                        0146 00241000
*   CYLSLOTS=PATCYLSZ;              /* NBR SLOTS PER CYLINDER        */ 00242000
*                                                                  0147 00243000
         LH    @15,PATCYLSZ(,@15)                                  0147 00244000
         ST    @15,CYLSLOTS                                        0147 00245000
*   /*****************************************************************/ 00246000
*   /*                                                               */ 00247000
*   /* DETERMINE DEVICE-DEPENDENT FINDSLOT ROUTINE ADDRESS USING THE */ 00248000
*   /* LAST BYTE OF THE HEX DEVICE TYPE CODE AS AN INDEX INTO AN     */ 00249000
*   /* ADDRESS TABLE                                                 */ 00250000
*   /*                                                               */ 00251000
*   /*****************************************************************/ 00252000
*                                                                  0148 00253000
*   RESPECIFY                                                      0148 00254000
*     PCT BASED(PAREPCTP);                                         0148 00255000
*                                                                  0148 00256000
*/*           M GET DEV DEPENDENT FINDSLOT RTN ADDR                  */ 00257000
*/*           N USE HEX DEVTYPE CODE AS INDEX INTO ADDRESS TABLE     */ 00258000
*                                                                  0149 00259000
*   FSRTNPTR=DEVDFSRT(DEVDTABX);    /* GET DEVICE-DEPENDENT        0149 00260000
*                                      ADDRESS-TABLE ENTRY           */ 00261000
         L     @15,PAREPCTP(,@12)                                  0149 00262000
         SLR   @11,@11                                             0149 00263000
         IC    @11,DEVDTABX(,@15)                                  0149 00264000
         SLA   @11,2                                               0149 00265000
         L     @15,DEVDFSRT-4(@11)                                 0149 00266000
         ST    @15,FSRTNPTR                                        0149 00267000
*/*           N ZERO VARIOUS WORK VARIABLES                          */ 00268000
*/*           M ZERO LAST CHOSEN SLOT NBR IN FINDSLOT PARM LIST      */ 00269000
*/*           M INITLZ ALL SLOT FLAGS OFF IN FINDSLOT PARM LIST      */ 00270000
*/*           M ZERO READ CYL VAL (MEANS READ CYL TO BE FOUND)       */ 00271000
*/*           M INITLZ ALL INTERNAL FLAGS OFF                        */ 00272000
*/*           M ZERO RETURN CODE                                     */ 00273000
*                                                                  0150 00274000
*   ZEROLIST=''B;                   /* ZERO WORK VARIABLES           */ 00275000
*                                                                  0150 00276000
         XC    ZEROLIST(58),ZEROLIST                               0150 00277000
*   /*****************************************************************/ 00278000
*   /*                                                               */ 00279000
*   /* COMPUTE THE NUMBER OF REQUESTS THAT CAN BE PROCESSED IN ONE   */ 00280000
*   /* SERVICE BURST FOR THIS DEVICE.                                */ 00281000
*   /*                                                               */ 00282000
*   /*****************************************************************/ 00283000
*                                                                  0151 00284000
*/*%INI30:    P COMPUTE NUMBER OF POTENTIAL REQUESTS TO PROCESS      */ 00285000
*                                                                  0151 00286000
*   REQNEED=TWO+ASMBURST/PARERQTM;                                 0151 00287000
*                                                                  0151 00288000
         L     @00,ASMBURST(,ASMVTPTR)                             0151 00289000
         SRDA  @00,32                                              0151 00290000
         D     @00,PARERQTM(,@12)                                  0151 00291000
         AL    @01,@CF00084                                        0151 00292000
         ST    @01,REQNEED                                         0151 00293000
*/*           R RETURN                                               */ 00294000
*                                                                  0152 00295000
*   RFY                                                            0152 00296000
*     R14 UNRSTD;                   /* RELEASE RETURN REG            */ 00297000
*   END INITLZ;                     /* END OF SUBROUTINE INITLZ      */ 00298000
@EL00002 DS    0H                                                  0153 00299000
@EF00002 DS    0H                                                  0153 00300000
@ER00002 BR    @14                                                 0153 00301000
*/*INITLZ:   END                                                     */ 00302000
*                                                                  0154 00303000
*                                                                  0154 00304000
*/*SORTTREE:   CHART (FMODE)                                         */ 00305000
*/* HEADING                                                        0154 00306000
*/* ILRSRT - ASM SLOT SORT                                         0154 00307000
*/*         READ REQUEST TREE STRUCTURE DIAGRAM                      */ 00308000
*/*A1 COMMENT (15,50)           THE DIAGRAM BELOW SHOWS THE          */ 00309000
*/*   COMMENT (16,45)      --READ REQUEST TREE SORT STRUCTURE--      */ 00310000
*/*                                                                  */ 00311000
*/*   COMMENT (26,20) REQUESTS (IOES) SORTED BY THE                  */ 00312000
*/*   COMMENT (27,20) RELATIVE SLOT NUMBER STORED IN                 */ 00313000
*/*   COMMENT (28,20) THE AIA ADDRESSED FROM THE IOE                 */ 00314000
*/*                                                                  */ 00315000
*/*   COMMENT (21,30)  PART ENTRY                                    */ 00316000
*/*   COMMENT (22,35)       +-----+--  ---  --+--------+-----+       */ 00317000
*/*   COMMENT (23,35)       |     |    ...    |PARENODE|     |       */ 00318000
*/*   COMMENT (24,35)       +-----+--  ---  --+--------+-----+       */ 00319000
*/*                                            /                     */ 00320000
*/*                                          /                       */ 00321000
*/*                                        /                         */ 00322000
*/*                                      /                           */ 00323000
*/*                                    /                             */ 00324000
*/*                                  /                               */ 00325000
*/*                                /                                 */ 00326000
*/*                              /                                   */ 00327000
*/*   COMMENT (25,57)           |                                    */ 00328000
*/*   COMMENT (26,57)           |                                    */ 00329000
*/*   COMMENT (27,57)           |                                    */ 00330000
*/*   COMMENT (28,57)           +---->+-------+                      */ 00331000
*/*   COMMENT (29,60)              +- | ERL   |                      */ 00332000
*/*   COMMENT (30,60)              |  |       |                      */ 00333000
*/*   COMMENT (31,51)     LE (<=)  |  |       | -+  GT (>)           */ 00334000
*/*   COMMENT (32,53)       LEG    |  +-------+  |   LEG             */ 00335000
*/*   COMMENT (33,60)              |             |                   */ 00336000
*/*   COMMENT (34,60)              |             |                   */ 00337000
*/*   COMMENT (35,48)  +-------+<--+             +-->+-------+       */ 00338000
*/*   COMMENT (36,48)  | SGC   |                  +- | AWN   |       */ 00339000
*/*   COMMENT (37,48)  |       |                  |  |       |       */ 00340000
*/*   COMMENT (38,48)  |       | -+            LE |  |       | -+    */ 00341000
*/*   COMMENT (39,48)  +-------+  | GT            |  +-------+  | GT */ 00342000
*/*   COMMENT (40,59)             |               |             |    */ 00343000
*/*   COMMENT (41,59)             V               V             V    */ 00344000
*/*   COMMENT (42,55)         +-------+      +-------+      +-------+*/ 00345000
*/*   COMMENT (43,55)         | ETC   |      | ETAL  |      | VEJH  |*/ 00346000
*/*   COMMENT (44,55)         |       |      |       |      |       |*/ 00347000
*/*   COMMENT (45,55)         |       |      |       |      |       |*/ 00348000
*/*   COMMENT (46,55)         +-------+      +-------+      +-------+*/ 00349000
*/*                                                                  */ 00350000
*/*                                                                  */ 00351000
*/*   COMMENT (52,20) CLOSE-UP OF A TYPICAL NODE (READ IOE)          */ 00352000
*/*                                                                  */ 00353000
*/*   COMMENT (55,21)  0 +-----------------+                         */ 00354000
*/*   COMMENT (56,23)    | IOENXTLE        | LE LEG NODE ADDRESS     */ 00355000
*/*   COMMENT (57,21)  4 +-----------------+                         */ 00356000
*/*   COMMENT (58,23)    | IOENXTGT        | GT LEG NODE ADDRESS     */ 00357000
*/*   COMMENT (59,21)  8 +-----------------+                         */ 00358000
*/*   COMMENT (60,23)    | IOEAIA          | PTR TO AIA              */ 00359000
*/*   COMMENT (61,20) 12 +-----------------+                         */ 00360000
*/*   COMMENT (62,23)    | IOEBKPTR        | BACKCHAIN NODE ADDRESS  */ 00361000
*/*   COMMENT (63,23)    +-----------------+                         */ 00362000
*/*SORTTREE:  END                                                    */ 00363000
*                                                                  0154 00364000
*                                                                  0154 00365000
*/*CSCANCYL: CHART                                                   */ 00366000
*/* HEADING                                                        0154 00367000
*/* ILRSRT - ASM SLOT SORT                  CSCANCYL: FIND NEXT US 0154 00368000
*/*ABLE CYLINDER FROM LAST USED CYLINDER (CIRCULAR SCAN)             */ 00369000
*/********************************************************************/ 00370000
*/*                                                                  */ 00371000
*/*      CSCANCYL:  EMPLOY CIRCULAR-SCAN TECHNIQUE TO FIND           */ 00372000
*/*                  NEXT USABLE CYLINDER FROM LAST USED CYLINDER    */ 00373000
*/*                                                                  */ 00374000
*/*      INPUT: PAT                                                  */ 00375000
*/*             PART ENTRY                                           */ 00376000
*/*             CURRENT READ CYL VALUE - PRESET BY INITLZ TO ZERO    */ 00377000
*/*                                                                  */ 00378000
*/*      PROCESS: THE FOLLOWING DONE UP TO 2 TIMES. ONCE FOR EACH    */ 00379000
*/*               SCAN DESCRIBED IN THE OBJECT PARAGRAPH ABOVE.      */ 00380000
*/*                                                                  */ 00381000
*/*               IF NO READS EXIST FOR THE PAGING SPACE THEN SCAN   */ 00382000
*/*               FOR A POTENTIAL WRITE CYLINDER FROM THE CURRENTLY  */ 00383000
*/*               DEFINED STARTING POINT (CYL ZERO OR LAST USED CYL  */ 00384000
*/*               VALUE) TO THE CURRENTLY DEFINED END POINT (CYL N+1 */ 00385000
*/*               WHERE N IS THE LAST CYLINDER IN THE PAGING SPACE   */ 00386000
*/*               OR THE PREVIOUS SCANS STARTING POINT)              */ 00387000
*/*                                                                  */ 00388000
*/*               IF AT LEAST ONE READ REQUEST EXISTS THEN FIND THE  */ 00389000
*/*               NEAREST "READ" CYLINDER TO CURRENTLY DEFINED START-*/ 00390000
*/*               ING POINT IF NOT ALREADY PREVIOUSLY FOUND.  IF ONE */ 00391000
*/*               EXISTS BETWEEN THE CURRENT STARTING AND ENDING     */ 00392000
*/*               POINTS REDEFINE THE CURRENT ENDING POINT TO        */ 00393000
*/*               THIS CYLINDER VALUE. IN ANY EVENT IF WRITES EXIST, */ 00394000
*/*               SCAN FOR A 'WRITE' CYLINDER BETWEEN THE CURRENT    */ 00395000
*/*               STARTING POINT AND ENDING POINTS.                  */ 00396000
*/*               IF NO CYLINDER IS FOUND THEN THE DATA SET FULL     */ 00397000
*/*               CONDITION IS SET AND SLOT SORT PROCESSING CEASES.  */ 00398000
*/*                                                                  */ 00399000
*/*               IF A CYLINDER IS CHOSEN AND IT HAS READ REQUESTS   */ 00400000
*/*               FOR IT THEN A CYLINDER MAP MASK IS BUILT WITH A BIT*/ 00401000
*/*               SET ON FOR EACH READ REQUEST ON THE CYLINDER.      */ 00402000
*/*                                                                  */ 00403000
*/*      OUTPUT: -NUMBER OF CYLINDER TO PROCESS (IF FOUND)           */ 00404000
*/*              -READ CYLINDER VALUE SET (IF FOUND)                 */ 00405000
*/*              -CYLINDER MAP READ MASK BUILT (IF READ CYLINDER     */ 00406000
*/*               CHOSEN TO PROCESS)                                 */ 00407000
*/*              -DATA SET FULL RETURN CODE IF NO CYLINDER FOUND     */ 00408000
*/*              -INDICATION TO STOP PROCESSING REQUESTS IF NO       */ 00409000
*/*               CYLINDER FOUND                                     */ 00410000
*/*                                                                  */ 00411000
*/*                                                                  */ 00412000
*/********************************************************************/ 00413000
*/*CSCANCYL: E  C-SCAN FOR NEXT USABLE CYLINDER                      */ 00414000
*                                                                  0154 00415000
*CSCANCYL:                                                         0154 00416000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0154 00417000
CSCANCYL DS    0H                                                  0155 00418000
*   RFY                                                            0155 00419000
*     R14 RSTD;                                                    0155 00420000
*   RETADDR1=R14;                   /* SAVE RETURN ADDR              */ 00421000
         ST    R14,RETADDR1                                        0156 00422000
*   RFY                                                            0157 00423000
*     R14 UNRSTD;                                                  0157 00424000
*                                                                  0157 00425000
*   /*****************************************************************/ 00426000
*   /*                                                               */ 00427000
*   /* EACH TIME CSCANCYL IS INVOKED, IT IS TO FIND A CYLINDER ON    */ 00428000
*   /* WHICH I/O REQUESTS CAN BE MADE. THE FIRST THING TO DO THEN,   */ 00429000
*   /* NATURALLY, IS TO INITIALIZE ANY VARIABLES ASSOCIATED WITH     */ 00430000
*   /* PROCESSING A SPECIFIC CYLINDER                                */ 00431000
*   /*                                                               */ 00432000
*   /*****************************************************************/ 00433000
*                                                                  0158 00434000
*/*           M ZERO THE READ CYLINDER MAP MASK                      */ 00435000
*                                                                  0158 00436000
*   SCYLREAD=''B;                   /* ZERO READ CYLINDER MAP MASK   */ 00437000
         XC    SCYLREAD(8),SCYLREAD                                0158 00438000
*   EPAWTPAT=ADDR(SCYLWRT);         /* SET FOR RECOVERY              */ 00439000
*                                                                  0159 00440000
         LA    @12,SCYLWRT                                         0159 00441000
         ST    @12,EPAWTPAT(,EPAPTR)                               0159 00442000
*   /*****************************************************************/ 00443000
*   /*                                                               */ 00444000
*   /* NEXT WE WANT TO LOOP UP TO TWO TIMES IN OUR ATTEMPT TO FIND A */ 00445000
*   /* CYLINDER FOR I/O. ONCE TO FIND A CYLINDER BETWEEN WHERE WE    */ 00446000
*   /* LAST LEFT OFF AND THE END OF THE PAGING SPACE. IF THAT ATTEMPT*/ 00447000
*   /* FAILS, THEN ONCE AGAIN BETWEEN THE BEGINNING OF THE PAGING    */ 00448000
*   /* SPACE AND OUR PREVIOUS STARTING POINT.                        */ 00449000
*   /*                                                               */ 00450000
*   /*****************************************************************/ 00451000
*                                                                  0160 00452000
*/*           N LOOP UNTIL CYL FOUND OR NO I/O POSSIBLE DETERMINED   */ 00453000
*/*           M PRESET END POINT OF SCAN PAST END OF PAGING SPACE    */ 00454000
*                                                                  0160 00455000
*   ENDCYL=PATCYLNO;                /* PRESET END CYL NBR PAST END OF   00456000
*                                      DATA SET                      */ 00457000
         L     @12,PAREPTR                                         0160 00458000
         L     @11,PAREPATP(,@12)                                  0160 00459000
         LH    @11,PATCYLNO(,@11)                                  0160 00460000
         ST    @11,ENDCYL                                          0160 00461000
*/*           M PRESET START POINT AT LAST PROCESSED CYLINDER        */ 00462000
*                                                                  0161 00463000
*   STRTCYL=PARELCYL;               /* REMEMBER LAST CYL USED AS   0161 00464000
*                                      CSCAN STARTING POINTING       */ 00465000
         LH    STRTCYL,PARELCYL(,@12)                              0161 00466000
*/*           M PRESET GOTCHA CYL VALUE AS LOOP CTL                  */ 00467000
*                                                                  0162 00468000
*   THISCYL=ENDCYL;                 /* INITLZ WORK CYL NBR VBL       */ 00469000
         ST    @11,THISCYL                                         0162 00470000
*/*%CSN10:    D (YES,,NO,%CSN90) CYL FOUND OR NO POSSIBLE I/O ?      */ 00471000
*                                                                  0163 00472000
*   DO WHILE THISCYL=ENDCYL;                                       0163 00473000
*                                                                  0163 00474000
         B     @DE00163                                            0163 00475000
@DL00163 DS    0H                                                  0164 00476000
*     /***************************************************************/ 00477000
*     /*                                                             */ 00478000
*     /* IF READ REQUESTS EXIST THEN FIRST FIND A CYLINDER FOR SOME  */ 00479000
*     /* READS, THEN SEE IF A CYLINDER FOR WRITES EXISTS BETWEEN THE */ 00480000
*     /* STARTING POINT OF THE SCAN AND THE READ CYLINDER            */ 00481000
*     /*                                                             */ 00482000
*     /***************************************************************/ 00483000
*                                                                  0164 00484000
*/*           D (YES,,NO,%CSN40) READ REQUESTS EXIST ?               */ 00485000
*                                                                  0164 00486000
*     IF PARENODE^=ZERO THEN        /* ANY READS ON TREE ?           */ 00487000
         SLR   @12,@12                                             0164 00488000
         L     @11,PAREPTR                                         0164 00489000
         C     @12,PARENODE(,@11)                                  0164 00490000
         BE    @RF00164                                            0164 00491000
*       DO;                                                        0165 00492000
*                                                                  0165 00493000
*         /***********************************************************/ 00494000
*         /*                                                         */ 00495000
*         /* IF THIS IS THE FIRST TIME TO CSCANCYL FOR THIS EXECUTION*/ 00496000
*         /* OF SLOT-SORT OR IF A NEW READ CYL MUST BE DETERMINED    */ 00497000
*         /* THEN ATTEMPT TO FIND A READ CYLINDER IN THE PAGING SPACE*/ 00498000
*         /* BETWEEN THE CYLINDERS DEFINED BY STRTCYL & ENDCYL       */ 00499000
*         /*                                                         */ 00500000
*         /***********************************************************/ 00501000
*                                                                  0166 00502000
*/*           D (YES,,NO,%CSN15) OBTAIN NEW READ CYL ?               */ 00503000
*/*           S GETRDCYL: FIND READ CYL IN PRESET SCAN AREA          */ 00504000
*                                                                  0166 00505000
*         IF READCYL=ZERO THEN      /* MUST A NEW READ CYL BE FOUND  */ 00506000
         C     @12,READCYL                                         0166 00507000
         BNE   @RF00166                                            0166 00508000
*           CALL GETRDCYL;                                         0167 00509000
         BAL   @14,GETRDCYL                                        0167 00510000
*         ELSE                                                     0168 00511000
*                                                                  0168 00512000
*           /*********************************************************/ 00513000
*           /*                                                       */ 00514000
*           /* IF A READ CYLINDER HAS ALREADY BEEN FOUND THEN RESET  */ 00515000
*           /* CYL NUMBER VALUE IDENTIFYING THE CYLINDER TO PROCESS  */ 00516000
*           /*                                                       */ 00517000
*           /*********************************************************/ 00518000
*                                                                  0168 00519000
*/*%CSN15:   N READ CYLINDER ALREADY KNOWN ?                         */ 00520000
*/*          P RESET PROCESS CYL VALUE                               */ 00521000
*                                                                  0168 00522000
*           THISCYL=READCYL;                                       0168 00523000
*                                                                  0168 00524000
         B     @RC00166                                            0168 00525000
@RF00166 L     @12,READCYL                                         0168 00526000
         ST    @12,THISCYL                                         0168 00527000
*         /***********************************************************/ 00528000
*         /*                                                         */ 00529000
*         /* IF NO READ CYLINDER WAS FOUND, OR IF ONE WAS FOUND AND  */ 00530000
*         /* IT IS NOT THE SAME AS THE STARTING POINT VALUE ---AND---*/ 00531000
*         /* WRITE REQUESTS ARE POSSIBLE FOR THIS PAGING SPACE, THEN */ 00532000
*         /* SEE IF A WRITE CYLINDER EXISTS BETWEEN THE LAST         */ 00533000
*         /* PROCESSED CYLINDER AND THE CURRENT RECOGNIZED END       */ 00534000
*         /* CYLINDER                                                */ 00535000
*         /*                                                         */ 00536000
*         /***********************************************************/ 00537000
*                                                                  0169 00538000
*/*%CSN20:    D (NO,,YES,%CSN30) GOTCHA CYL = LAST USED CYL ?        */ 00539000
*/*           D (YES,,NO,%CSN30) WRITE REQS OK FOR PGG SPACE ?       */ 00540000
*/*           N SCAN FROM START POINT TO END POINT TO FIND CYL     0169 00541000
*/*             FOR WRITE REQS                                       */ 00542000
*/*           S GETWCYL: SCAN FOR WRITE CYLINDER                     */ 00543000
*                                                                  0169 00544000
*         IF THISCYL^=STRTCYL THEN                                 0169 00545000
@RC00166 C     STRTCYL,THISCYL                                     0169 00546000
         BE    @RF00169                                            0169 00547000
*           IF WRITEQUE^=ZERO THEN  /* WRITES EXIST                  */ 00548000
         L     @12,WRITEQUE                                        0170 00549000
         LTR   @12,@12                                             0170 00550000
         BZ    @RF00170                                            0170 00551000
*             CALL GETWCYL;         /* TRY TO FIND WRITE CYL         */ 00552000
         BAL   @14,GETWCYL                                         0171 00553000
*           ELSE                                                   0172 00554000
*             ;                                                    0172 00555000
@RF00170 DS    0H                                                  0173 00556000
*         ELSE                                                     0173 00557000
*           ;                                                      0173 00558000
*                                                                  0173 00559000
@RF00169 DS    0H                                                  0174 00560000
*         /***********************************************************/ 00561000
*         /*                                                         */ 00562000
*         /* IF THE READ CYLINDER EXISTS AND IS SELECTED, THEN BUILD */ 00563000
*         /* A READ-MASK FOR IT...                                   */ 00564000
*         /*                                                         */ 00565000
*         /***********************************************************/ 00566000
*                                                                  0174 00567000
*/*%CSN30:    D (NO,,YES,%CSN60) READ CYL FOUND & SELECTED ?         */ 00568000
*/*           S BRDMASK: BUILD THE READ CYL MAP MASK                 */ 00569000
*/*           P (,%CSN60) INDICATE NEW READ CYL MUST BE FOUND        */ 00570000
*                                                                  0174 00571000
*         IF THISCYL=READCYL THEN                                  0174 00572000
         CLC   THISCYL(4),READCYL                                  0174 00573000
         BNE   @RF00174                                            0174 00574000
*           DO;                                                    0175 00575000
*             CALL BRDMASK;         /* BUILD THE READ MASK           */ 00576000
         BAL   @14,BRDMASK                                         0176 00577000
*             READCYL=ZERO;         /* INDICATE NEW READ CYL MUST BE    00578000
*                                      FOUND                         */ 00579000
         SLR   @12,@12                                             0177 00580000
         ST    @12,READCYL                                         0177 00581000
*           END;                                                   0178 00582000
*         ELSE                                                     0179 00583000
*           ;                                                      0179 00584000
@RF00174 DS    0H                                                  0180 00585000
*       END;                        /* END READS EXIST ON TREE       */ 00586000
*     ELSE                                                         0181 00587000
*                                                                  0181 00588000
*       /*************************************************************/ 00589000
*       /*                                                           */ 00590000
*       /* NO READS ON THE TREE ?... THEN FIND THE NEXT WRITE        */ 00591000
*       /* CYLINDER                                                  */ 00592000
*       /*                                                           */ 00593000
*       /*************************************************************/ 00594000
*                                                                  0181 00595000
*/*%CSN40:    S GETWCYL: TRY TO FIND CYL FOR WRITES                  */ 00596000
*                                                                  0181 00597000
*       CALL GETWCYL;                                              0181 00598000
*                                                                  0181 00599000
         B     @RC00164                                            0181 00600000
@RF00164 BAL   @14,GETWCYL                                         0181 00601000
*     /***************************************************************/ 00602000
*     /*                                                             */ 00603000
*     /* IF NO AVAILABLE CYLINDERS BETWEEN CYLINDER LAST PROCESSED   */ 00604000
*     /* AND THE END OF THE PAGING SPACE, THEN TRY FROM THE START OF */ 00605000
*     /* THE PAGING SPACE                                            */ 00606000
*     /*                                                             */ 00607000
*     /***************************************************************/ 00608000
*                                                                  0182 00609000
*/*%CSN60:    D (NO,,YES,%CSN80) CYLINDER FOUND                      */ 00610000
*/*           D (NO,,YES,%CSN70) ENTIRE PGG SPACE SCANNED ?          */ 00611000
*/*           P RESET END POINT TO PREVIOUS START POINT              */ 00612000
*/*           P (,%CSN80) RESET START POINT TO START OF PAGING SPACE */ 00613000
*                                                                  0182 00614000
*     IF THISCYL=ENDCYL THEN        /* NO CYLINDER FOUND ?           */ 00615000
@RC00164 CLC   THISCYL(4),ENDCYL                                   0182 00616000
         BNE   @RF00182                                            0182 00617000
*       IF STRTCYL^=ZERO THEN       /* NOT YET CHECKED FROM START OF    00618000
*                                      PAGING SPACE                  */ 00619000
         LTR   STRTCYL,STRTCYL                                     0183 00620000
         BZ    @RF00183                                            0183 00621000
*         DO;                                                      0184 00622000
*           ENDCYL=STRTCYL;         /* RESET END POINT               */ 00623000
         ST    STRTCYL,ENDCYL                                      0185 00624000
*           THISCYL=STRTCYL;        /* RESET PROCESS CYL VALUE       */ 00625000
         ST    STRTCYL,THISCYL                                     0186 00626000
*           STRTCYL=ZERO;           /* RESET START POINT             */ 00627000
         SLR   STRTCYL,STRTCYL                                     0187 00628000
*         END;                                                     0188 00629000
*       ELSE                        /* NO CYLINDERS AVAILABLE        */ 00630000
*                                                                  0189 00631000
*         /***********************************************************/ 00632000
*         /*                                                         */ 00633000
*         /* IF NO CYLINDER HAS BEEN SELECTED AND THE ENTIRE PAGING  */ 00634000
*         /* SPACE HAS BEEN SCANNED, THEN IT IS ASSUMED THE PAGING   */ 00635000
*         /* SPACE IS FULL AND NO READS EXIST. THEREFORE, I/O REQUEST*/ 00636000
*         /* (PCCW) BUILDING MUST CEASE                              */ 00637000
*         /*                                                         */ 00638000
*         /***********************************************************/ 00639000
*                                                                  0189 00640000
*/*%CSN70:    P SET FLAG TO STOP PROCESSING REQUESTS                 */ 00641000
*/*           P 'OR' DS FULL CODE INTO RETURN CODE FIELD             */ 00642000
*                                                                  0189 00643000
*         DO;                                                      0189 00644000
         B     @RC00183                                            0189 00645000
@RF00183 DS    0H                                                  0190 00646000
*           STOP=YES;               /* INDICATE TIME TO CUT OUT      */ 00647000
         OI    STOP,B'10000000'                                    0190 00648000
*           RETCODE=RETCODE|IOFULL; /* OR IN DS FULL CODE            */ 00649000
         L     @12,RETCODE                                         0191 00650000
         O     @12,@CF00032                                        0191 00651000
         ST    @12,RETCODE                                         0191 00652000
*           THISCYL=ZERO;           /* GET OUT OF LOOP               */ 00653000
         SLR   @12,@12                                             0192 00654000
         ST    @12,THISCYL                                         0192 00655000
*         END;                                                     0193 00656000
*     ELSE                                                         0194 00657000
*       ;                                                          0194 00658000
*                                                                  0194 00659000
@RF00182 DS    0H                                                  0195 00660000
*/*%CSN80:    N (,%CSN10) END LOOP TO GET CYL FOR I/O REQS           */ 00661000
*                                                                  0195 00662000
*   END;                            /* END LOOP TO FIND CYLINDER TO     00663000
*                                      PROCESS                       */ 00664000
@RC00182 DS    0H                                                  0195 00665000
@DE00163 CLC   THISCYL(4),ENDCYL                                   0195 00666000
         BE    @DL00163                                            0195 00667000
*/*%CSN90:    R RETURN                                               */ 00668000
*                                                                  0196 00669000
*   RFY                                                            0196 00670000
*     R14 RSTD;                                                    0196 00671000
*   R14=RETADDR1;                   /* RESTORE RETURN ADDRESS        */ 00672000
         L     R14,RETADDR1                                        0197 00673000
*   RFY                                                            0198 00674000
*     R14 UNRSTD;                                                  0198 00675000
*   END CSCANCYL;                   /* END SUBROUTINE CSCANCYL       */ 00676000
@EL00003 DS    0H                                                  0199 00677000
@EF00003 DS    0H                                                  0199 00678000
@ER00003 BR    @14                                                 0199 00679000
*/*CSCANCYL: END                                                     */ 00680000
*                                                                  0200 00681000
*                                                                  0200 00682000
*/*GETRDCYL: CHART                                                   */ 00683000
*/* HEADING                                                        0200 00684000
*/* ILRSRT - ASM SLOT SORT                                         0200 00685000
*/*GETRDCYL:  FIND NEXT READ CYLINDER FROM LAST PROCESSED            */ 00686000
*/********************************************************************/ 00687000
*/*                                                                  */ 00688000
*/*      GETRDCYL:  FIND NEXT READ CYLINDER FROM LAST PROCESSED      */ 00689000
*/*                                                                  */ 00690000
*/*      INPUT: LAST PROCESSED CYLINDER VALUE (STARTING POINT OF     */ 00691000
*/*               SCAN)                                              */ 00692000
*/*             PART ENTRY                                           */ 00693000
*/*             CURRENT CYLINDER TO PROCESS VALUE (PRESET HIGH)      */ 00694000
*/*                                                                  */ 00695000
*/*      PROCESS: THE TREE IS EXAMINED, MOVING DOWN ONE NODE AT A    */ 00696000
*/*               TIME ALONG THE APPROPRIATE LEG (THIS TIME KEYING ON*/ 00697000
*/*               THE CYLINDER VALUE ASSOCIATED WITH EACH IOE IN THE */ 00698000
*/*               AIA) IN SEARCH OF ONE OR MORE IOES REPRESENTING    */ 00699000
*/*               REQUESTS FOR THE NEAREST CYLINDER FORM THE LAST    */ 00700000
*/*               USED CYLINDER (CURRENT C-SCAN STARTING POINT)      */ 00701000
*/*                                                                  */ 00702000
*/*               WHENEVER AN IOE IS FOUND FOR A UNIQUE CYLINDER     */ 00703000
*/*               BETWEEN TWO CURRENT C-SCAN END POINTS ITS ADDRESS  */ 00704000
*/*               AMD ASSOCIATED CYLINDER VALUE IS SAVED AND PROCESS-*/ 00705000
*/*               ING CONTINUES TO FIND AN IOE FOR A CYLINDER NEARER */ 00706000
*/*               YET TO THE C-SCAN STARTING POINT. THE SERACH       */ 00707000
*/*               TERMINATES WHEN THE LEG OF THE TREE IT IS SCANNING */ 00708000
*/*               ENDS OR WHEN AN IOE IS FOUND REPRESENTING A REQUEST*/ 00709000
*/*               FOR THE SAME CYLINDER AS THE CURRENT C-SCAN START- */ 00710000
*/*               ING POINT. IF NO READ CYLINDER IS FOUND BETWEEN THE*/ 00711000
*/*               CURRENT C-SCAN END POINTS, NO C-SCAN WORK VARIABLES*/ 00712000
*/*               ARE ALTERED.                                       */ 00713000
*/*                                                                  */ 00714000
*/*      OUTPUT: IF READ CYLINDER IS FOUND-                          */ 00715000
*/*                -ADDRESS OF FIRST IOE ENCOUNTERED REPRESENTING    */ 00716000
*/*                 A REQUEST ON THE READ CYLINDER                   */ 00717000
*/*                -READ CYLINDER VALUE SET                          */ 00718000
*/*                -CURRENT CYLINDER TO PROCESS VALUE RESET (THIS    */ 00719000
*/*                 VALUE ALSO REPRESENTS THE CURRENT C-SCAN ENDING  */ 00720000
*/*                 POINT)                                           */ 00721000
*/*                                                                  */ 00722000
*/*                                                                  */ 00723000
*/********************************************************************/ 00724000
*/*GETRDCYL:  E FIND NEXT READ CYL FROM LAST USED                    */ 00725000
*                                                                  0200 00726000
*GETRDCYL:                                                         0200 00727000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0200 00728000
GETRDCYL DS    0H                                                  0201 00729000
*   RFY                                                            0201 00730000
*     R14 RSTD;                     /* RESTRICT RETURN REG           */ 00731000
*                                                                  0201 00732000
*   /*****************************************************************/ 00733000
*   /*                                                               */ 00734000
*   /* THE OBJECT OF THIS SUBROUTINE IS TO START AT THE TOP OF THE   */ 00735000
*   /* READ REQUEST TREE AND FIND THE NEAREST CYLINDER GREATER THAN  */ 00736000
*   /* OR EQUAL THE SCAN START POINT VALUE FOR WHICH A READ REQUEST  */ 00737000
*   /* NODE EXISTS --------------------------------------------- TO  */ 00738000
*   /* START AT THE TOP OF THE TREE... REMEMBER TOP NODE ADDRESS AS  */ 00739000
*   /* POTENTIAL TOP 'READ' CYLINDER NODE                            */ 00740000
*   /*                                                               */ 00741000
*   /*****************************************************************/ 00742000
*                                                                  0202 00743000
*/*           M SET UP TO SCAN DOWN TREE                             */ 00744000
*/*           P SAVE TOP NODE ADDR AS POTENTIAL READ CYL NODE ADDR   */ 00745000
*/*           M PRESET WORK CYL VALUE VERY LARGE                     */ 00746000
*                                                                  0202 00747000
*   THISNODE=PARENODE;              /* GET FIRST NODE OF TREE        */ 00748000
         L     @15,PAREPTR                                         0202 00749000
         L     THISNODE,PARENODE(,@15)                             0202 00750000
*   TOPRDIOE=THISNODE;              /* PRESET TOP NODE FOR READS FROM   00751000
*                                      A SPECIFIC CYLINDER           */ 00752000
*                                                                  0203 00753000
         ST    THISNODE,TOPRDIOE                                   0203 00754000
*   /*****************************************************************/ 00755000
*   /*                                                               */ 00756000
*   /* MOVE DOWN TREE ATTEMPTING TO FIND A READ REQUEST ON THE       */ 00757000
*   /* NEAREST HIGHER NUMBERED CYLINDER FROM THE LAST PROCESSED      */ 00758000
*   /* (INCLUDING THE LAST PROCESSED).                               */ 00759000
*   /*                                                               */ 00760000
*   /*****************************************************************/ 00761000
*                                                                  0204 00762000
*/*           N LOOP, MOVING DOWN TREE ONE NODE WITH EACH ITERATION  */ 00763000
*/*%GRC10:    D (YES,,NO,%GRC90) YET ANOTHER NODE ?                  */ 00764000
*                                                                  0204 00765000
*   DO WHILE THISNODE^=ZERO;                                       0204 00766000
*                                                                  0204 00767000
         B     @DE00204                                            0204 00768000
@DL00204 DS    0H                                                  0205 00769000
*     /***************************************************************/ 00770000
*     /*                                                             */ 00771000
*     /* IF CURRENT NODE (IOE) IS FOR A READ FROM A CYLINDER LOWER   */ 00772000
*     /* NUMBERED THAN THE LAST PROCESSED CYLINDER, THEN MOVE DOWN   */ 00773000
*     /* THE GREATER-THAN (GT) LEG OF THE TREE                       */ 00774000
*     /*                                                             */ 00775000
*     /***************************************************************/ 00776000
*                                                                  0205 00777000
*/*           D (YES,,NO,%GRC20) THIS REQ CYL < START POINT ?        */ 00778000
*/*           P (,%GRC80) MOVE DOWN GT LEG ONE NODE                  */ 00779000
*                                                                  0205 00780000
*     IF STRTCYL>THISNODE->IOEAIA->AIACYL THEN                     0205 00781000
         L     @15,IOEAIA(,THISNODE)                               0205 00782000
         CH    STRTCYL,AIACYL(,@15)                                0205 00783000
         BNH   @RF00205                                            0205 00784000
*       THISNODE=THISNODE->IOENXTGT;                               0206 00785000
         L     THISNODE,IOENXTGT(,THISNODE)                        0206 00786000
*     ELSE                                                         0207 00787000
*                                                                  0207 00788000
*       /*************************************************************/ 00789000
*       /*                                                           */ 00790000
*       /* IF THE CURRENT NODE IS FOR A READ FROM A CYLINDER HIGHER  */ 00791000
*       /* NUMBERED THAN THE LAST PROCESSED CYLINDER BUT LOWER THAN  */ 00792000
*       /* THE CURRENT NEAREST CYLINDER, THEN RESET THE CURRENT      */ 00793000
*       /* NEAREST VALUES TO THIS CYLINDER AND THIS NODE...          */ 00794000
*       /*                                                           */ 00795000
*       /*************************************************************/ 00796000
*                                                                  0207 00797000
*/*%GRC20:    D (YES,,NO,%GRC40) THIS REQ CYL NEAREST SO FAR ?       */ 00798000
*/*           P SAVE CYL VALUE AS NEAREST SO FAR                     */ 00799000
*/*           P SAVE NODE ADDR AS POTENTIAL READ CYL NODE ADDR       */ 00800000
*                                                                  0207 00801000
*       IF THISCYL>THISNODE->IOEAIA->AIACYL THEN                   0207 00802000
         B     @RC00205                                            0207 00803000
@RF00205 L     @15,IOEAIA(,THISNODE)                               0207 00804000
         LH    @15,AIACYL(,@15)                                    0207 00805000
         C     @15,THISCYL                                         0207 00806000
         BNL   @RF00207                                            0207 00807000
*         DO;                                                      0208 00808000
*           THISCYL=THISNODE->IOEAIA->AIACYL;/* RESET NEAREST CYL VAL*/ 00809000
         ST    @15,THISCYL                                         0209 00810000
*           TOPRDIOE=THISNODE;                                     0210 00811000
*                                                                  0210 00812000
         ST    THISNODE,TOPRDIOE                                   0210 00813000
*/*           P SAVE POTENTIAL READ CYL VALUE                        */ 00814000
*                                                                  0211 00815000
*           READCYL=THISCYL;                                       0211 00816000
*                                                                  0211 00817000
         ST    @15,READCYL                                         0211 00818000
*           /*********************************************************/ 00819000
*           /*                                                       */ 00820000
*           /* IF THE NEW CYLINDER VALUE EQUALS THE LAST PROCESSED   */ 00821000
*           /* VALUE THEN SET UP TO GET OUT OF LOOP IMMEDIATELY      */ 00822000
*           /*                                                       */ 00823000
*           /*********************************************************/ 00824000
*                                                                  0212 00825000
*/*           D (YES,,NO,%GRC30) THIS CYL = START POINT ?            */ 00826000
*/*           P (,%GRC80) INDICATE NO MORE NODES TO SCAN             */ 00827000
*                                                                  0212 00828000
*           IF THISCYL=STRTCYL THEN                                0212 00829000
         CR    @15,STRTCYL                                         0212 00830000
         BNE   @RF00212                                            0212 00831000
*             THISNODE=ZERO;                                       0213 00832000
         SLR   THISNODE,THISNODE                                   0213 00833000
*           ELSE                                                   0214 00834000
*                                                                  0214 00835000
*             /*******************************************************/ 00836000
*             /*                                                     */ 00837000
*             /* OTHERWISE, SEE IF THERE IS ANOTHER READ REQUEST ON  */ 00838000
*             /* YET A NEARER CYLINDER                               */ 00839000
*             /*                                                     */ 00840000
*             /*******************************************************/ 00841000
*                                                                  0214 00842000
*/*%GRC30:    P (,%GRC80) MOVE DOWN LE LEG ONE NODE                  */ 00843000
*                                                                  0214 00844000
*             THISNODE=THISNODE->IOENXTLE;                         0214 00845000
         B     @RC00212                                            0214 00846000
@RF00212 L     THISNODE,IOENXTLE(,THISNODE)                        0214 00847000
*         END;                                                     0215 00848000
*       ELSE                                                       0216 00849000
*                                                                  0216 00850000
*         /***********************************************************/ 00851000
*         /*                                                         */ 00852000
*         /* IF THE CURRENT CYL VALUE IS NOT THE NEAREST OR EQUALS   */ 00853000
*         /* THE NEAREST, THEN MOVE DOWN THE TREE'S                  */ 00854000
*         /* LESS-THAN-OR-EQUAL (LE) PATH...                         */ 00855000
*         /*                                                         */ 00856000
*         /***********************************************************/ 00857000
*                                                                  0216 00858000
*/*%GRC40:    P MOVE DOWN LE LEG ONE NODE                            */ 00859000
*                                                                  0216 00860000
*         THISNODE=THISNODE->IOENXTLE;                             0216 00861000
*                                                                  0216 00862000
         B     @RC00207                                            0216 00863000
@RF00207 L     THISNODE,IOENXTLE(,THISNODE)                        0216 00864000
*/*%GRC80:    N (,%GRC10) END LOOP TO MOVE DOWN TREE ONE NODE AT A 0217 00865000
*/*                       TIME                                       */ 00866000
*                                                                  0217 00867000
*   END;                            /* END LOOP TO FIND READ CYL   0217 00868000
*                                      NEAREST LAST PROCESSED CYL    */ 00869000
*                                                                  0217 00870000
@RC00207 DS    0H                                                  0217 00871000
@RC00205 DS    0H                                                  0217 00872000
@DE00204 LTR   THISNODE,THISNODE                                   0217 00873000
         BNZ   @DL00204                                            0217 00874000
*   /*****************************************************************/ 00875000
*   /*                                                               */ 00876000
*   /* SET THE BEST READ CYLINDER VALUE FOUND... NOTE: THIS VALUE MAY*/ 00877000
*   /* BE MERELY THE CYLINDER FIRST REPRESENTED ON THE TREE IF NO    */ 00878000
*   /* READ REQUESTS EXIST FOR A CYLINDER WITH A HIGHER NUMBER THAN  */ 00879000
*   /* THE LAST PROCESSED CYLINDER                                   */ 00880000
*   /*                                                               */ 00881000
*   /*****************************************************************/ 00882000
*                                                                  0218 00883000
*/*%GRC90:    R RETURN                                               */ 00884000
*                                                                  0218 00885000
*   RFY                                                            0218 00886000
*     R14 UNRSTD;                   /* RELEASE RETURN REG            */ 00887000
*   END GETRDCYL;                   /* END OF SUBROUTINE GETRDCYL    */ 00888000
@EL00004 DS    0H                                                  0219 00889000
@EF00004 DS    0H                                                  0219 00890000
@ER00004 BR    @14                                                 0219 00891000
*/*GETRDCYL: END                                                     */ 00892000
*                                                                  0220 00893000
*                                                                  0220 00894000
*/*GETWCYL: CHART                                                    */ 00895000
*/* HEADING                                                        0220 00896000
*/* ILRSRT - ASM SLOT SORT                                         0220 00897000
*/*GETWCYL:  FIND NEXT WRITE CYLINDER FROM LAST PROCESSED            */ 00898000
*/********************************************************************/ 00899000
*/*                                                                  */ 00900000
*/*      GETWCYL:  FIND NEXT WRITE CYLINDER FROM LAST PROCESSED      */ 00901000
*/*                                                                  */ 00902000
*/*      INPUT: CURRENT C-SCAN END POINTS                            */ 00903000
*/*             ADDRESS OF PART BIT MAP                              */ 00904000
*/*             NUMBER OF WORDS REQUIRED TO MAP ONE CULINDER         */ 00905000
*/*                                                                  */ 00906000
*/*      PROCESS: THE CURRENT C-SCAN END POINT VALUES ARE TRANSLATED */ 00907000
*/*               INTO THE BEGIN POINT ADDRESS AND LENGTH OF A PAT   */ 00908000
*/*               MAP SCAN FOR A NON-'FF' BYTE. THE SACN IS VIA      */ 00909000
*/*               COMPARE-LOGICAL-CHARACTERS-LONG.  IF A BIT IS FOUND*/ 00910000
*/*               THE CYLINDER MAP IT IS IN IS ISOLATED AND THE      */ 00911000
*/*               CORRESPONDING CYLINDER VLAUE IS DETERMINED. THIS   */ 00912000
*/*               CYLINDER VALUE WILL BE THE NEXT RELATIVE CYLINDER  */ 00913000
*/*               IN THE PAGING SPACE TO BE USED.                    */ 00914000
*/*                                                                  */ 00915000
*/*      OUTPUT: IF A HIT IS FOUND, THE RELATIVE CYLINDER NUMBER OF  */ 00916000
*/*              THE WRITE CYLINDER.                                 */ 00917000
*/*                                                                  */ 00918000
*/*                                                                  */ 00919000
*/********************************************************************/ 00920000
*/*GETWCYL:  E FIND NEXT WRITE CYL FROM LAST USED                    */ 00921000
*                                                                  0220 00922000
*GETWCYL:                                                          0220 00923000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0220 00924000
GETWCYL  DS    0H                                                  0221 00925000
*   RFY                                                            0221 00926000
*     R14 RSTD;                                                    0221 00927000
*   RETADDR2=R14;                   /* SAVE RETURN ADDRESS           */ 00928000
*                                                                  0222 00929000
         ST    R14,RETADDR2                                        0222 00930000
*   /*****************************************************************/ 00931000
*   /*                                                               */ 00932000
*   /* USING THE SCAN STARTING AND ENDING POINT CYL VALUES, COMPUTE  */ 00933000
*   /* THE BEGIN POINT SCAN ADDRESS AND THE SCAN LENGTH TO PERFORM A */ 00934000
*   /* COMPARE LOGICAL CHARACTER LONG OPERATION TO FIND A BYTE WITH A*/ 00935000
*   /* BIT OFF.                                                      */ 00936000
*   /*                                                               */ 00937000
*   /*****************************************************************/ 00938000
*                                                                  0223 00939000
*/*           M COMPUTE SCAN STARTING POINT ADDRESS                  */ 00940000
*/*           M COMPUTE LENGTH OF SCAN                               */ 00941000
*/*           M SET 'FF'X COMPARE CHARACTER                          */ 00942000
*/*           P SCAN FOR NON-'FF'X BYTE (CLCL)                       */ 00943000
*                                                                  0223 00944000
*   RFY                                                            0223 00945000
*    (R1) RSTD;                                                    0223 00946000
*                                                                  0223 00947000
*   /*****************************************************************/ 00948000
*   /*                                                               */ 00949000
*   /* OBTAIN SCAN STARTING ADDRESS                                  */ 00950000
*   /*                                                               */ 00951000
*   /*****************************************************************/ 00952000
*                                                                  0224 00953000
*   R14=STRTCYL;                    /* GET SCAN START CYL VALUE      */ 00954000
         LR    R14,STRTCYL                                         0224 00955000
*   R1=CYLMPWDS;                    /* NBR WORDS IN CYL MAP          */ 00956000
         L     R1,CYLMPWDS                                         0225 00957000
*   GEN(SLL    R14,1(R1));          /* OFFSET INTO PAT MAP           */ 00958000
         SLL    R14,1(R1)                                               00959000
*   R14=R14+ADDR(PATMAP);           /* ADDR OF START CYL MAP         */ 00960000
*                                                                  0227 00961000
         L     @15,PAREPTR                                         0227 00962000
         L     @15,PAREPATP(,@15)                                  0227 00963000
         LA    @15,PATMAP(,@15)                                    0227 00964000
         ALR   R14,@15                                             0227 00965000
*   /*****************************************************************/ 00966000
*   /*                                                               */ 00967000
*   /* OBTAIN LENGTH OF SCAN TO CURRENT 'END' CYLINDER               */ 00968000
*   /*                                                               */ 00969000
*   /*****************************************************************/ 00970000
*                                                                  0228 00971000
*   RFY                                                            0228 00972000
*     R15 RSTD;                                                    0228 00973000
*   R15=THISCYL-STRTCYL;            /* NBR CYL MAPS TO SCAN          */ 00974000
         L     R15,THISCYL                                         0229 00975000
         SLR   R15,STRTCYL                                         0229 00976000
*   GEN(SLL   R15,1(R1));           /* NBR OF BYTES TO SCAN          */ 00977000
*                                                                  0230 00978000
         SLL   R15,1(R1)                                                00979000
*   /*****************************************************************/ 00980000
*   /*                                                               */ 00981000
*   /* SET 'FF'X PADDING CHARACTER FOR CLCL INSTRUCTION              */ 00982000
*   /*                                                               */ 00983000
*   /*****************************************************************/ 00984000
*                                                                  0231 00985000
*   R1=FFCMPARE;                    /* SET COMPARAND ('FF'X)         */ 00986000
         L     R1,FFCMPARE                                         0231 00987000
*   GEN(CLCL R14,R0);               /* SCAN FOR NON-ONE BIT          */ 00988000
         CLCL R14,R0                                                    00989000
*   RFY                                                            0233 00990000
*    (R1) UNRSTD;                                                  0233 00991000
*                                                                  0233 00992000
*   /*****************************************************************/ 00993000
*   /*                                                               */ 00994000
*   /* IF THE SCAN IS SUCCESSFUL IN FINDING A BYTE WITH AT LEAST ONE */ 00995000
*   /* BIT OFF THEN COMPUTE THE CYL REPRESENTED                      */ 00996000
*   /*                                                               */ 00997000
*   /*****************************************************************/ 00998000
*                                                                  0234 00999000
*/*           D (YES,,NO,%GWC20) NON-'FF'X BYTE FOUND ?              */ 01000000
*/*           P COMPUTE WRITE CYL VALUE REPRESENTED                  */ 01001000
*                                                                  0234 01002000
*   IF R15>ZERO THEN                /* CYL WITH AVAILABLE SLOT FOUND    01003000
*                                      ?                             */ 01004000
         LTR   R15,R15                                             0234 01005000
         BNP   @RF00234                                            0234 01006000
*     DO;                                                          0235 01007000
*       RFY                                                        0236 01008000
*         R14 RSTD;                                                0236 01009000
*       R14=R14-ADDR(PATMAP);       /* OFFSET OF BYTE IN PAT MAP     */ 01010000
         L     @12,PAREPTR                                         0237 01011000
         L     @12,PAREPATP(,@12)                                  0237 01012000
         LA    @12,PATMAP(,@12)                                    0237 01013000
         SLR   R14,@12                                             0237 01014000
*       R15=CYLMPWDS;               /* NBR WORDS IN CYL MAP          */ 01015000
         L     R15,CYLMPWDS                                        0238 01016000
*       GEN(SRL R14,1(R15));        /* CYL VALUE OF MAP BYTE IS IN   */ 01017000
         SRL R14,1(R15)                                                 01018000
*       THISCYL=R14;                /* GET WRITE CYLINDER VALUE      */ 01019000
         ST    R14,THISCYL                                         0240 01020000
*       RFY                                                        0241 01021000
*         R15 UNRSTD;                                              0241 01022000
*     END;                                                         0242 01023000
*   ELSE                                                           0243 01024000
*     ;                                                            0243 01025000
*                                                                  0243 01026000
@RF00234 DS    0H                                                  0244 01027000
*/*%GWC20:    R RETURN                                               */ 01028000
*                                                                  0244 01029000
*   R14=RETADDR2;                   /* RESTORE RETURN ADDRESS        */ 01030000
         L     R14,RETADDR2                                        0244 01031000
*   RFY                                                            0245 01032000
*     R14 UNRSTD;                                                  0245 01033000
*   END GETWCYL;                    /* END SUBROUTINE GETWCYL        */ 01034000
@EL00005 DS    0H                                                  0246 01035000
@EF00005 DS    0H                                                  0246 01036000
@ER00005 BR    @14                                                 0246 01037000
*/*GETWCYL: END                                                      */ 01038000
*                                                                  0247 01039000
*                                                                  0247 01040000
*/*PROCREQS: CHART                                                   */ 01041000
*/* HEADING                                                        0247 01042000
*/* ILRSRT - ASM SLOT SORT                                         0247 01043000
*/*PROCREQS:  PROCESS REQUESTS FOR A SPECIFIC CYLINDER               */ 01044000
*/********************************************************************/ 01045000
*/*                                                                  */ 01046000
*/*      PROCREQS: PROCESS REQUESTS FOR A SPECIFIC CYLINDER          */ 01047000
*/*                                                                  */ 01048000
*/*      INPUT: RELATIVE CYLINDER NUMBER FOUND BY CSCANCYL           */ 01049000
*/*             PART ENTRY                                           */ 01050000
*/*             ADDRESS OF APPROPRIATE FINDSLOT ROUTINE              */ 01051000
*/*                                                                  */ 01052000
*/*      PROCESS: THE READ WRITE CYLINDER MAP IS BUILT. THEN THE     */ 01053000
*/*               FINDSLOT AND PROCHIT SUBROUTINES ARE REPEATEDLY    */ 01054000
*/*               CALLED TO FIRST CHOOSE A SLOT VIA THE READ-WRITE   */ 01055000
*/*               MASK (THEREBY CHOOSING EITHER A READ OR WRITE      */ 01056000
*/*               REQUEST) AND THE LATTER TO PREPARE A PCCW FOR THAT */ 01057000
*/*               REQUEST.  THE LOOP TERMINATES WHEN RESOURCES (EG   */ 01058000
*/*               PCCWS) ARE EXHAUSTED, THE SERVICE BURST QUOTA IS   */ 01059000
*/*               MET OR NO MORE REQUESTS CAN BE CHOSEN FOR THIS     */ 01060000
*/*               PARTICULAR CYLINDER.  AT THAT TIME, IF ANY WRITE   */ 01061000
*/*               REQUESTS WERE PREPARED THEN WRTUPDTE IS INVOKED    */ 01062000
*/*               TO UPDATE THE PAT BIT MAP AND THE PART ENTRY SLOT  */ 01063000
*/*               SLOT AVAILABLE COUNT.                              */ 01064000
*/*                                                                  */ 01065000
*/*      OUTPUT: PART ENTRY LAST USED CYLINDER VALUE UPDATED         */ 01066000
*/*              INITIALIZED PCCW FOR EACH I/O REQUEST               */ 01067000
*/*              UPDATED PAT BIT MAP IF WRITE REQUESTS PROCESSED     */ 01068000
*/*              UPDATED PART ENTRY SLOT AVAILABLE COUNT IF WRITE    */ 01069000
*/*                REQUESTS PROCESSED                                */ 01070000
*/*                                                                  */ 01071000
*/********************************************************************/ 01072000
*/*PROCREQS: E  PROCESS REQUESTS ON CYLINDER                         */ 01073000
*                                                                  0247 01074000
*PROCREQS:                                                         0247 01075000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0247 01076000
PROCREQS DS    0H                                                  0248 01077000
*   RFY                                                            0248 01078000
*     R14 RSTD;                                                    0248 01079000
*   RETADDR1=R14;                   /* SAVE RETURN ADDR              */ 01080000
         ST    R14,RETADDR1                                        0249 01081000
*   RFY                                                            0250 01082000
*     R14 UNRSTD;                                                  0250 01083000
*                                                                  0250 01084000
*/*           P RESET LAST USED CYL VALUE IN PART ENTRY              */ 01085000
*                                                                  0251 01086000
*   PARELCYL=THISCYL;               /* SAVE CYLINDER NBR FOR NEXT  0251 01087000
*                                      C-SCAN                        */ 01088000
*                                                                  0251 01089000
         L     @12,THISCYL                                         0251 01090000
         L     @11,PAREPTR                                         0251 01091000
         STH   @12,PARELCYL(,@11)                                  0251 01092000
*   /*****************************************************************/ 01093000
*   /*                                                               */ 01094000
*   /* FINISH BUILDING THE CYLINDER MAP MASKS TO BE USED IN          */ 01095000
*   /* PROCESSING REQUESTS ON THIS CYLINDER                          */ 01096000
*   /*                                                               */ 01097000
*   /*****************************************************************/ 01098000
*                                                                  0252 01099000
*/*           S BILDMSKS: COMPLETE CYL MAP WORK MASKS                */ 01100000
*                                                                  0252 01101000
*   CALL BILDMSKS;                                                 0252 01102000
*                                                                  0252 01103000
         BAL   @14,BILDMSKS                                        0252 01104000
*   /*****************************************************************/ 01105000
*   /*                                                               */ 01106000
*   /* LOOP ONCE FOR EVERY SLOT USED, STOPPING ONLY WHEN NO MORE     */ 01107000
*   /* POSSIBILITIES EXIST FOR THE CYLINDER OR A RESOURCE HAS RUN OUT*/ 01108000
*   /* (E.G. PCCWS), OR THE REQUEST QUOTA HAS BEEN MET               */ 01109000
*   /*                                                               */ 01110000
*   /*****************************************************************/ 01111000
*                                                                  0253 01112000
*/*           N LOOP, FINDING & PROCESSING ONE SLOT EACH ITERATION   */ 01113000
*/*%PRQ10:    D (YES,,NO,%PRQ70) SLOTS & RESOURCES AVAIL ?           */ 01114000
*                                                                  0253 01115000
*   DO WHILE STOP=NO&(SCYLRDWT(1:4)|SCYLRDWT(5:8))^=ZERO;          0253 01116000
*                                                                  0253 01117000
         B     @DE00253                                            0253 01118000
@DL00253 DS    0H                                                  0254 01119000
*     /***************************************************************/ 01120000
*     /*                                                             */ 01121000
*     /* FINDSLOT IS A DEVICE-DEPENDENT SUBROUTINE ADDRESSED VIA AN  */ 01122000
*     /* INTERNAL SLOT-SORT POINTER WHICH WHEN GIVEN A PARAMETER LIST*/ 01123000
*     /* SPECIFYING THE LAST USED SLOT NUMBER, RETURNS THE NEXT BEST */ 01124000
*     /* SLOT TO BE USED.                                            */ 01125000
*     /*                                                             */ 01126000
*     /***************************************************************/ 01127000
*                                                                  0254 01128000
*/*           S FINDSLOT: OBTAIN NEXT SLOT ON CYL FOR I/O REQ        */ 01129000
*                                                                  0254 01130000
*     GEN(STM   R2,R7,28(R13));     /* SAVE REGS USED BY FINDSLOT    */ 01131000
         STM   R2,R7,28(R13)                                            01132000
*     CALL FINDSLOT;                                               0255 01133000
*                                                                  0255 01134000
         L     @15,FSRTNPTR                                        0255 01135000
         BALR  @14,@15                                             0255 01136000
*     /***************************************************************/ 01137000
*     /*                                                             */ 01138000
*     /* SINCE THE FINDSLOT ROUTINES DIRECTLY INVOKE GETREAD OR      */ 01139000
*     /* SETWRITE VIA ASSEMBLER BRANCH, THE FOLLOWING STATEMENTS     */ 01140000
*     /* 'INFORM' PLS OF THE FACT AND ENABLE THE COMPILER TO RESOLVE */ 01141000
*     /* VARIABLE USAGES.                                            */ 01142000
*     /*                                                             */ 01143000
*     /***************************************************************/ 01144000
*                                                                  0256 01145000
*     GEN(B     SKIPCALL);                                         0256 01146000
         B     SKIPCALL                                                 01147000
*     RFY                                                          0257 01148000
*       R15 RSTD;                                                  0257 01149000
*     IF R15=ZERO THEN                                             0258 01150000
         LTR   R15,R15                                             0258 01151000
         BNZ   @RF00258                                            0258 01152000
*       CALL GETREAD;                                              0259 01153000
         BAL   @14,GETREAD                                         0259 01154000
*     ELSE                                                         0260 01155000
*       CALL SETWRITE;                                             0260 01156000
         B     @RC00258                                            0260 01157000
@RF00258 BAL   @14,SETWRITE                                        0260 01158000
*     RFY                                                          0261 01159000
*       R15 UNRSTD;                                                0261 01160000
@RC00258 DS    0H                                                  0262 01161000
*SKIPCALL:                                                         0262 01162000
*                                                                  0262 01163000
*     /***************************************************************/ 01164000
*     /*                                                             */ 01165000
*     /* WHEN A SLOT IS RETURNED, PROCHIT IS INVOKED TO CARRY ON FROM*/ 01166000
*     /* THERE.                                                      */ 01167000
*     /*                                                             */ 01168000
*     /***************************************************************/ 01169000
*                                                                  0262 01170000
*/*           S PROCHIT: BUILD PCCW FOR REQUEST FOR THIS SLOT        */ 01171000
*                                                                  0262 01172000
*     CALL PROCHIT;                                                0262 01173000
*                                                                  0262 01174000
SKIPCALL BAL   @14,PROCHIT                                         0262 01175000
*/*           N (,%PRQ10) END LOOP TO PROCESS CYL SLOTS              */ 01176000
*                                                                  0263 01177000
*   END;                                                           0263 01178000
*                                                                  0263 01179000
@DE00253 TM    STOP,B'10000000'                                    0263 01180000
         BNZ   @DC00253                                            0263 01181000
         ICM   @12,15,SCYLRDWT                                     0263 01182000
         ICM   @11,15,SCYLRDWT+4                                   0263 01183000
         OR    @12,@11                                             0263 01184000
         LTR   @12,@12                                             0263 01185000
         BNZ   @DL00253                                            0263 01186000
@DC00253 DS    0H                                                  0264 01187000
*   /*****************************************************************/ 01188000
*   /*                                                               */ 01189000
*   /* INVOKE WRTUPDTE TO UPDATE THE PAT CYLINDER MAP AND TO UPDATE  */ 01190000
*   /* THE PART ENTRY SLOTS-AVAILABLE COUNT... IF SOME WRITE REQUESTS*/ 01191000
*   /* WERE PREPARED.                                                */ 01192000
*   /*                                                               */ 01193000
*   /*****************************************************************/ 01194000
*                                                                  0264 01195000
*/*%PRQ70:     D (YES,,NO,%PRQ80) ANY WRITES PREPARED ?              */ 01196000
*/*           S WRTUPDTE: WRITE RELATED UPDATES, IF ANY              */ 01197000
*                                                                  0264 01198000
*   IF EPAWRTCT>ZERO THEN           /* ANY WRITE PCCWS PREPARED ?    */ 01199000
         LH    @12,EPAWRTCT(,EPAPTR)                               0264 01200000
         LTR   @12,@12                                             0264 01201000
         BNP   @RF00264                                            0264 01202000
*     CALL WRTUPDTE;                                               0265 01203000
         BAL   @14,WRTUPDTE                                        0265 01204000
*   ELSE                                                           0266 01205000
*     ;                                                            0266 01206000
@RF00264 DS    0H                                                  0267 01207000
*   RFY                                                            0267 01208000
*     R14 RSTD;                                                    0267 01209000
*                                                                  0267 01210000
*/*%PRQ80:    R RETURN                                               */ 01211000
*                                                                  0268 01212000
*   R14=RETADDR1;                   /* RESTORE RETURN ADDRESS        */ 01213000
         L     R14,RETADDR1                                        0268 01214000
*   RFY                                                            0269 01215000
*     R14 UNRSTD;                                                  0269 01216000
*   END PROCREQS;                   /* END SUBROUTINE PROCREQS       */ 01217000
@EL00006 DS    0H                                                  0270 01218000
@EF00006 DS    0H                                                  0270 01219000
@ER00006 BR    @14                                                 0270 01220000
*/*PROCREQS: END                                                     */ 01221000
*                                                                  0271 01222000
*                                                                  0271 01223000
*/*BILDMSKS: CHART                                                   */ 01224000
*/* HEADING                                                        0271 01225000
*/* ILRSRT - ASM SLOT SORT                                         0271 01226000
*/* BILDMSKS:  BUILD PAT CYLINDER MAP READ/WRITE MASKS               */ 01227000
*/********************************************************************/ 01228000
*/*                                                                  */ 01229000
*/*      BILDMSKS: BUILD PAT CYLINDER MAP READ/WRITE MASKS           */ 01230000
*/*                                                                  */ 01231000
*/*      INPUT: NUMBER OF WORDS REQUIRED TO MAP ONE CYLINDER'S SLOTS */ 01232000
*/*             PAT                                                  */ 01233000
*/*             CYLINDER MAP READ MASK IF CURRENT PORCESS CYLINDER   */ 01234000
*/*               HAS PENDING READ REQUESTS                          */ 01235000
*/*                                                                  */ 01236000
*/*      PROCESS: IF NO WRITES EXIST TO PROCESS THEN THE READ/WRITE  */ 01237000
*/*               MASK IS AUTOMATICALLY A COPY OF THE READ MASK.     */ 01238000
*/*               OTHERWISE THE WRITE POSSIBILITIES ARE THE ZERO     */ 01239000
*/*               BITS IN THE PAT CYLINDER MAP.  THE READ MASK BITS  */ 01240000
*/*               ARE THEN ADDED TO BUILD THE READ/WRITE MASK.       */ 01241000
*/*                                                                  */ 01242000
*/*      OUTPUT: READ/WRITE MASK                                     */ 01243000
*/*              COPY OF PAT CYLINDER MAP                            */ 01244000
*/*                                                                  */ 01245000
*/*                                                                  */ 01246000
*/********************************************************************/ 01247000
*/*BILDMSKS:  E BUILD PAT CYL MAP WORK MASKS                         */ 01248000
*                                                                  0271 01249000
*BILDMSKS:                                                         0271 01250000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0271 01251000
BILDMSKS DS    0H                                                  0272 01252000
*   RFY                                                            0272 01253000
*     R14 RSTD;                     /* RESTRICT THE RETURN REG       */ 01254000
*                                                                  0272 01255000
*   /*****************************************************************/ 01256000
*   /*                                                               */ 01257000
*   /* OBTAIN CYLINDER MAP COPY FROM THE PAT AND BUILD THE READ/WRITE*/ 01258000
*   /* CYLINDER MAP MASK... ACCORDING TO SIZE OF CYLINDER MAP        */ 01259000
*   /*                                                               */ 01260000
*   /*****************************************************************/ 01261000
*                                                                  0273 01262000
*   PMAPADDR=ADDR(PATMAP);          /* ADDRESS OF PATCYL             */ 01263000
         L     @15,PAREPTR                                         0273 01264000
         L     PMAPADDR,PAREPATP(,@15)                             0273 01265000
         LA    PMAPADDR,PATMAP(,PMAPADDR)                          0273 01266000
*   IF CYLMPWDS=TWO THEN            /* TWO WORD CYL MAP              */ 01267000
         CLC   CYLMPWDS(4),@CF00084                                0274 01268000
         BNE   @RF00274                                            0274 01269000
*     DO;                                                          0275 01270000
*                                                                  0275 01271000
*       /*************************************************************/ 01272000
*       /*                                                           */ 01273000
*       /* COMPUTE THE ADDRESS OF THE PAT CYLINDER MAP CORRESPONDING */ 01274000
*       /* TO THE CYL CHOSEN FOR PROCESSING I/O REQUESTS             */ 01275000
*       /*                                                           */ 01276000
*       /*************************************************************/ 01277000
*                                                                  0276 01278000
*/*           N BUILD TWO-WORD CYL MAP READ/WRITE MASK               */ 01279000
*/*           P COMPUTE PAT CYLINDER MAP ADDRESS FOR CYL CHOSEN      */ 01280000
*                                                                  0276 01281000
*       EPACYLA=ADDR(PATCYL(THISCYL*TWO+ONE));/* ADDR PAT CYL MAP    */ 01282000
         L     @15,THISCYL                                         0276 01283000
         SLA   @15,3                                               0276 01284000
         LA    @15,PATCYL(@15,PMAPADDR)                            0276 01285000
         ST    @15,EPACYLA(,EPAPTR)                                0276 01286000
*/*           P OBTAIN COPY OF PAT CYLINDER MAP                      */ 01287000
*                                                                  0277 01288000
*       SCYLCOPY=PATCYLMP;          /* GET COPY OF PAT CYL MAP       */ 01289000
*                                                                  0277 01290000
         MVC   SCYLCOPY(8),PATCYLMP(@15)                           0277 01291000
*       /*************************************************************/ 01292000
*       /*                                                           */ 01293000
*       /* IF WRITE REQUESTS EXIST THEN PREPARE THE READ/WRITE MASK  */ 01294000
*       /* ACCORDINGLY. OTHERWISE SET IT EQUAL TO THE READ MASK.     */ 01295000
*       /*                                                           */ 01296000
*       /*************************************************************/ 01297000
*                                                                  0278 01298000
*/*           D (YES,,NO,%BMK20) WRITES POSSIBLE ?                   */ 01299000
*/*           P PRESET READ/WRITE CYL MAP WITH POTENTIAL WRITE HITS  */ 01300000
*/*           N -(EXCLUSIVE PAT CYL MAP WITH FF'S)-                  */ 01301000
*/*           P (,%BMK90) 'OR' IN READ HITS INTO READ/WRITE MASK     */ 01302000
*/*%BMK20:    P (,%BMK90) SET READ/WRITE MASK EQUAL READ MASK        */ 01303000
*                                                                  0278 01304000
*       IF WRITEQUE^=ZERO THEN      /* ANY WRITES TO PROCESS ?       */ 01305000
         L     @15,WRITEQUE                                        0278 01306000
         LTR   @15,@15                                             0278 01307000
         BZ    @RF00278                                            0278 01308000
*         DO;                       /* NO, THEN                      */ 01309000
*           SCYLRDWT=ALLFFSTR&&SCYLCOPY;/* PRESET READ/WRITE MASK  0280 01310000
*                                      WITH WRITE POSSIBILITIES ONLY */ 01311000
         MVC   SCYLRDWT(8),ALLFFSTR                                0280 01312000
         XC    SCYLRDWT(8),SCYLCOPY                                0280 01313000
*           SCYLRDWT=SCYLRDWT|SCYLREAD;/* GET CYL MAP READ/WRT MASK  */ 01314000
         OC    SCYLRDWT(8),SCYLREAD                                0281 01315000
*         END;                                                     0282 01316000
*       ELSE                                                       0283 01317000
*         SCYLRDWT=SCYLREAD;        /* GET CYL MAP READ/WRT MASK     */ 01318000
         B     @RC00278                                            0283 01319000
@RF00278 MVC   SCYLRDWT(8),SCYLREAD                                0283 01320000
*     END;                          /* END TWO WORD CYL MAP          */ 01321000
*   ELSE                            /* ONE WORD CYL MAP              */ 01322000
*     DO;                                                          0285 01323000
*                                                                  0285 01324000
         B     @RC00274                                            0285 01325000
@RF00274 DS    0H                                                  0286 01326000
*       /*************************************************************/ 01327000
*       /*                                                           */ 01328000
*       /* COMPUTE THE ADDRESS OF THE PAT CYLINDER MAP CORRESPONDING */ 01329000
*       /* TO THE CYL CHOSEN FOR PROCESSING I/O REQUESTS             */ 01330000
*       /*                                                           */ 01331000
*       /*************************************************************/ 01332000
*                                                                  0286 01333000
*/*%BMK50:    N OBTAIN ONE-WORD CYL MAP READ/WRITE MASK              */ 01334000
*/*           P COMPUTE PAT CYLINDER MAP ADDRESS FOR CYL CHOSEN      */ 01335000
*                                                                  0286 01336000
*       EPACYLA=ADDR(PATCYL(THISCYL+ONE));/* ADDR PAT CYL MAP        */ 01337000
         L     @15,THISCYL                                         0286 01338000
         SLA   @15,2                                               0286 01339000
         LA    @15,PATCYL(@15,PMAPADDR)                            0286 01340000
         ST    @15,EPACYLA(,EPAPTR)                                0286 01341000
*/*           P OBTAIN COPY OF PAT CYLINDER MAP                      */ 01342000
*                                                                  0287 01343000
*       SCYLCOPY(1:4)=PATCYLMP;     /* GET COPY OF PAT CYL MAP       */ 01344000
*                                                                  0287 01345000
         MVC   SCYLCOPY(4),PATCYLMP(@15)                           0287 01346000
*       /*************************************************************/ 01347000
*       /*                                                           */ 01348000
*       /* IF WRITE REQUESTS EXIST THEN PREPARE THE READ/WRITE MASK  */ 01349000
*       /* ACCORDINGLY. OTHERWISE SET IT EQUAL TO THE READ MASK.     */ 01350000
*       /*                                                           */ 01351000
*       /*************************************************************/ 01352000
*                                                                  0288 01353000
*/*           D (YES,,NO,%BMK60) WRITES POSSIBLE ?                   */ 01354000
*/*           P PRESET READ/WRITE CYL MAP WITH POTENTIAL WRITE HITS  */ 01355000
*/*           N -(EXCLUSIVE OR PAT CYL MAP WITH FF'S)-               */ 01356000
*/*           P (,%BMK90) 'OR' IN READ HITS INTO READ/WRITE MASK     */ 01357000
*/*%BMK60:    P SET READ/WRITE MASK EQUAL READ MASK                  */ 01358000
*                                                                  0288 01359000
*       IF WRITEQUE^=ZERO THEN      /* ANY WRITES TO PROCESS ?       */ 01360000
         L     @15,WRITEQUE                                        0288 01361000
         LTR   @15,@15                                             0288 01362000
         BZ    @RF00288                                            0288 01363000
*         DO;                       /* NO, THEN                      */ 01364000
*           SCYLRDWT(1:4)=ALLFFSTR&&SCYLCOPY;/* PRESET R/W MASK WITH    01365000
*                                      WRITE POSSIBILITIES           */ 01366000
         MVC   SCYLRDWT(4),ALLFFSTR                                0290 01367000
         XC    SCYLRDWT(4),SCYLCOPY                                0290 01368000
*           SCYLRDWT(1:4)=SCYLRDWT(1:4)|SCYLREAD(1:4);/* GET CYL MAP    01369000
*                                      R/W MASK                      */ 01370000
         OC    SCYLRDWT(4),SCYLREAD                                0291 01371000
*         END;                                                     0292 01372000
*       ELSE                                                       0293 01373000
*         SCYLRDWT(1:4)=SCYLREAD;   /* GET CYL MAP READ/WRT MASK     */ 01374000
         B     @RC00288                                            0293 01375000
@RF00288 MVC   SCYLRDWT(4),SCYLREAD                                0293 01376000
*     END;                          /* END ONE WORD CYL MAP          */ 01377000
*/*%BMK90:    R RETURN                                               */ 01378000
*                                                                  0295 01379000
*   RFY                                                            0295 01380000
*     R14 UNRSTD;                   /* RELEASE THE RETURN REG        */ 01381000
*   END BILDMSKS;                   /* END SUBROUTINE BILDMSKS       */ 01382000
@EL00007 DS    0H                                                  0296 01383000
@EF00007 DS    0H                                                  0296 01384000
@ER00007 BR    @14                                                 0296 01385000
*/*BILDMSKS: END                                                     */ 01386000
*                                                                  0297 01387000
*                                                                  0297 01388000
*/*BRDMASK: CHART                                                    */ 01389000
*/* HEADING                                                        0297 01390000
*/* ILRSRT - ASM SLOT SORT                                         0297 01391000
*/*BRDMASK:  BUILD THE CYLINDER MAP READ MASK                        */ 01392000
*/********************************************************************/ 01393000
*/*                                                                  */ 01394000
*/*      BRDMASK: BUILD THE CYLINDER MAP READ MASK                   */ 01395000
*/*                                                                  */ 01396000
*/*      INPUT: ADDRESS OF FIRST IOE ON TREE FOR SPECIFIC CYLINDER   */ 01397000
*/*               READ REQUEST                                       */ 01398000
*/*             VALUE OF CURRENT READ CYLINDER TO BE PROCESSED       */ 01399000
*/*                                                                  */ 01400000
*/*      PROCESS:EACH IOE ON THE TREE FROM THE FIRST (INPUT) FOR A   */ 01401000
*/*              SPECIFIC CYLINDER IS OBTAINED. (CYLINDER VALUE      */ 01402000
*/*              FOUND IN AIA ADDRESSED FROM THE IOE). THE REALTIVE  */ 01403000
*/*              SLOT WITHIN THE CYLINDER VALUE IS THEN USED TO BUILD*/ 01404000
*/*              A MASK TO SET THE APPROPRIATE BIT IN THE READ MASK  */ 01405000
*/*                                                                  */ 01406000
*/*      OUTPUT: READ AMSK                                           */ 01407000
*/*                                                                  */ 01408000
*/********************************************************************/ 01409000
*/*BRDMASK:  E BUILD THE CYL MAP READ MASK                           */ 01410000
*                                                                  0297 01411000
*BRDMASK:                                                          0297 01412000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0297 01413000
BRDMASK  DS    0H                                                  0298 01414000
*   RFY                                                            0298 01415000
*     R14 RSTD;                                                    0298 01416000
*   RETADDR3=R14;                   /* SAVE RETURN ADDR TO MAINLINE  */ 01417000
         ST    R14,RETADDR3                                        0299 01418000
*   RFY                                                            0300 01419000
*     R14 UNRSTD;                                                  0300 01420000
*                                                                  0300 01421000
*   /*****************************************************************/ 01422000
*   /*                                                               */ 01423000
*   /* FIND ALL NODES ON TREE CORRESPONDING TO READ REQUESTS ON A    */ 01424000
*   /* SPECIFIC CYLINDER --- THE READ CYLINDER FOUND BY GETRDCYL --- */ 01425000
*   /* THE ADDRESS OF THE FIRST NODE REQUIRED TO SCAN THRU THESE READ*/ 01426000
*   /* REQUESTS WAS PREVIOUSLY SAVED                                 */ 01427000
*   /*                                                               */ 01428000
*   /*****************************************************************/ 01429000
*                                                                  0301 01430000
*/*           M OBTAIN THE TOP NODE FOR THIS CYL FOR READ SCAN       */ 01431000
*                                                                  0301 01432000
*   THISNODE=TOPRDIOE;                                             0301 01433000
*                                                                  0301 01434000
         L     THISNODE,TOPRDIOE                                   0301 01435000
*   /*****************************************************************/ 01436000
*   /*                                                               */ 01437000
*   /* BELOW, SUBROUTINE GETLOLEC WILL FIND THE NODE REPRESENTING THE*/ 01438000
*   /* READ REQUEST FOR THE LOWEST RELATIVE SLOT NUMBER IN THE       */ 01439000
*   /* CYLINDER                                                      */ 01440000
*   /*                                                               */ 01441000
*   /*****************************************************************/ 01442000
*                                                                  0302 01443000
*/*           S GETLOLEC: GET LOW LE NODE FOR THIS CYL ON THIS LEG   */ 01444000
*                                                                  0302 01445000
*   CALL GETLOLEC;                  /* GET LOW LE NODE FOR READ CYL     01446000
*                                      ON THIS LEG                   */ 01447000
*                                                                  0302 01448000
         BAL   @14,GETLOLEC                                        0302 01449000
*   /*****************************************************************/ 01450000
*   /*                                                               */ 01451000
*   /* PROCESSING DURING EACH ITERATION OF THE FOLLOWING LOOP FINDS A*/ 01452000
*   /* READ REQUEST FOR A SLOT ON THE CURRENT READ CYLINDER --OR--   */ 01453000
*   /* DETERMINES THAT NO MORE REQUESTS EXIST FOR THE CYLINDER. FOR  */ 01454000
*   /* EACH SLOT FOUND ITS CORRESPONDING READ CYL MAP MASK BIT IS SET*/ 01455000
*   /* ON. PROCESSING IN THIS LOOP IS SUCH THAT THE SLOT REQUESTS ARE*/ 01456000
*   /* FOUND IN ASCENDING ORDER RELATIVE TO THE CYLINDER             */ 01457000
*   /*                                                               */ 01458000
*   /*****************************************************************/ 01459000
*                                                                  0303 01460000
*/*           N LOOP, ONCE FOR EACH READ REQUEST FOR CYLINDER        */ 01461000
*/*%BRD10:    D (NO,,YES,%BRD90) LAST READ REQ FOUND ?               */ 01462000
*                                                                  0303 01463000
*   DO WHILE THISNODE^=ZERO&        /* LOOP CTL SAYS CONTINUE        */ 01464000
*         THISCYL=THISNODE->IOEAIA->AIACYL;/* -AND- SAME CYL NUMBER  */ 01465000
*                                                                  0303 01466000
         B     @DE00303                                            0303 01467000
@DL00303 DS    0H                                                  0304 01468000
*     /***************************************************************/ 01469000
*     /*                                                             */ 01470000
*     /* TURN BIT ON IN READ MASK CORRESPONDING TO REL. CYL SLOT NBR */ 01471000
*     /*                                                             */ 01472000
*     /***************************************************************/ 01473000
*                                                                  0304 01474000
*     RFY                                                          0304 01475000
*       R1 RSTD;                                                   0304 01476000
*                                                                  0304 01477000
*/*           P GET THE RELATIVE SLOT NBR WITHIN CYL FOR THIS REQ    */ 01478000
*                                                                  0305 01479000
*     R1=THISNODE->IOEAIA->AIARCSN; /* OBTAIN REL. CYL SLOT NUMBER   */ 01480000
         L     @12,IOEAIA(,THISNODE)                               0305 01481000
         LH    R1,AIARCSN(,@12)                                    0305 01482000
*/*           P BUILD MASK, TURN BIT ON IN CYL MAP READ MASK         */ 01483000
*                                                                  0306 01484000
*     RFY                                                          0306 01485000
*      (R14,                                                       0306 01486000
*       R15) RSTD;                                                 0306 01487000
*     R14=HIORDER8;                 /* SET HI ORDER BIT IN REG       */ 01488000
         L     R14,HIORDER8                                        0307 01489000
*     R15=ZERO;                     /* ZERO ODD REG OF PAIR          */ 01490000
         SLR   R15,R15                                             0308 01491000
*     GEN(SRDL  R14,0(R1));         /* BUILD MASK                    */ 01492000
         SRDL  R14,0(R1)                                                01493000
*     R14=R14|SCYLREAD(1:4);        /* SET BIT IF IN WORD ONE        */ 01494000
         ICM   @12,15,SCYLREAD                                     0310 01495000
         OR    R14,@12                                             0310 01496000
*     R15=R15|SCYLREAD(5:8);        /* SET BIT IF IN WORD TWO        */ 01497000
         ICM   @12,15,SCYLREAD+4                                   0311 01498000
         OR    R15,@12                                             0311 01499000
*     STM(R14,R15,SCYLREAD);        /* STORE RESULTING READ MASK     */ 01500000
         STM   R14,R15,SCYLREAD                                    0312 01501000
*     RFY                                                          0313 01502000
*      (R1,                                                        0313 01503000
*       R14,                                                       0313 01504000
*       R15) UNRSTD;                                               0313 01505000
*                                                                  0313 01506000
*     /***************************************************************/ 01507000
*     /*                                                             */ 01508000
*     /* ONCE A CERTAIN NODES CORRESPONDING SLOT HAS BEEN MARKED IN  */ 01509000
*     /* THE BIT MASK, THE OBJECT IS TO FIND THE NODE ASSOCIATED WITH*/ 01510000
*     /* THE NEXT LOWEST SLOT NBR (RELATIVE TO THE CYL). ----------- */ 01511000
*     /* FIRST, SEE IF A NODE IS HUNG FROM THE CURRENT NODE ON THE GT*/ 01512000
*     /* LEG. IF THERE IS NONE THEN WE MUST MOVE UP THE TREE ON AN LE*/ 01513000
*     /* LEG TO FIND THE NEXT NODE FOR THIS CYLINDER. IF THE CURRENT */ 01514000
*     /* NODE IS HUNG ON THE GT LEG OF THE NODE ABOVE OR IF WE ARE   */ 01515000
*     /* ALREADY AT THE TOP OF THE TREE, IT MAY BE SAFELY ASSUMED    */ 01516000
*     /* THERE ARE NO MORE REQUESTS FOR THE CURRENT CYLINDER.        */ 01517000
*     /*                                                             */ 01518000
*     /***************************************************************/ 01519000
*                                                                  0314 01520000
*/*           P GET ADDRESS OF NEXT NODE DOWN GT LEG                 */ 01521000
*/*           D (NO,,YES,%BRD40) ANOTHER NODE ON GT LEG ?            */ 01522000
*/*           D (YES,,NO,%BRD20) NODE ABOVE ON LE LEG ?              */ 01523000
*/*           P (,%BRD80) MOVE UP TREE ONE NODE: LE LEG              */ 01524000
*/*%BRD20:    P (,%BRD80) INDICATE TIME TO GET OUT OF LOOP           */ 01525000
*                                                                  0314 01526000
*     IF THISNODE->IOENXTGT=ZERO THEN/* NO NEXT NODE ON GT PATH?     */ 01527000
         SLR   @12,@12                                             0314 01528000
         C     @12,IOENXTGT(,THISNODE)                             0314 01529000
         BNE   @RF00314                                            0314 01530000
*       IF THISNODE->IOEBKPTR^=ZERO&/* NOT AT TOP OF TREE ?          */ 01531000
*           THISNODE->IOEBKPTR->IOENXTLE=THISNODE THEN/* ON LE LEG ? */ 01532000
         L     @11,IOEBKPTR(,THISNODE)                             0315 01533000
         CR    @11,@12                                             0315 01534000
         BE    @RF00315                                            0315 01535000
         C     THISNODE,IOENXTLE(,@11)                             0315 01536000
         BNE   @RF00315                                            0315 01537000
*         THISNODE=THISNODE->IOEBKPTR;/* MOVE UP TREE LEPATH         */ 01538000
         LR    THISNODE,@11                                        0316 01539000
*       ELSE                                                       0317 01540000
*         THISNODE=ZERO;            /* GET OUT OF LOOP               */ 01541000
         B     @RC00315                                            0317 01542000
@RF00315 SLR   THISNODE,THISNODE                                   0317 01543000
*     ELSE                                                         0318 01544000
*                                                                  0318 01545000
*       /*************************************************************/ 01546000
*       /*                                                           */ 01547000
*       /* NOW IF THERE IS A NODE HANGING ON THE GT LEG FROM THE     */ 01548000
*       /* CURRENT NODE, THEN PROCEED TO FIND THE LOWEST NODE ON THE */ 01549000
*       /* LE LEG STILL REPRESENTING A REQUEST FOR THE CURRENT READ  */ 01550000
*       /* CYLINDER... THAT NODE WILL BE A REQUEST FOR THE NEXT      */ 01551000
*       /* LOWEST SLOT ON THE CYLINDER.                              */ 01552000
*       /*                                                           */ 01553000
*       /*************************************************************/ 01554000
*                                                                  0318 01555000
*/*%BRD40:    S (,%BRD80) GETLOLEC: GET LOW LE NODE FOR CYL ON THIS     01556000
*/*                       LEG                                        */ 01557000
*                                                                  0318 01558000
*       DO;                                                        0318 01559000
         B     @RC00314                                            0318 01560000
@RF00314 DS    0H                                                  0319 01561000
*         THISNODE=THISNODE->IOENXTGT;/* RESET CURRENT NODE PTR      */ 01562000
         L     THISNODE,IOENXTGT(,THISNODE)                        0319 01563000
*         CALL GETLOLEC;            /* GET LOW LE NODE FOR READ CYL     01564000
*                                      ON THIS LEG                   */ 01565000
         BAL   @14,GETLOLEC                                        0320 01566000
*       END;                                                       0321 01567000
*                                                                  0321 01568000
*/*%BRD80:    N (,%BRD10) END LOOP TO FIND READS ON CURRENT READ CYL */ 01569000
*                                                                  0322 01570000
*   END;                            /* END LOOP TO BUILD READ MASK   */ 01571000
@RC00314 DS    0H                                                  0322 01572000
@DE00303 LTR   THISNODE,THISNODE                                   0322 01573000
         BZ    @DC00303                                            0322 01574000
         L     @12,IOEAIA(,THISNODE)                               0322 01575000
         L     @11,THISCYL                                         0322 01576000
         CH    @11,AIACYL(,@12)                                    0322 01577000
         BE    @DL00303                                            0322 01578000
@DC00303 DS    0H                                                  0323 01579000
*/*%BRD90:    R RETURN                                               */ 01580000
*                                                                  0323 01581000
*   RFY                                                            0323 01582000
*     R14 RSTD;                                                    0323 01583000
*   R14=RETADDR3;                   /* RESTORE RETURN ADDRESS        */ 01584000
         L     R14,RETADDR3                                        0324 01585000
*   RFY                                                            0325 01586000
*     R14 UNRSTD;                                                  0325 01587000
*   END BRDMASK;                    /* END SUBROUTINE BRDMASK        */ 01588000
@EL00008 DS    0H                                                  0326 01589000
@EF00008 DS    0H                                                  0326 01590000
@ER00008 BR    @14                                                 0326 01591000
*/*BRDMASK: END                                                      */ 01592000
*                                                                  0327 01593000
*                                                                  0327 01594000
*/*GETLOLEC: CHART                                                   */ 01595000
*/* HEADING                                                        0327 01596000
*/* ILRSRT - ASM SLOT SORT                   GETLOLEC:  GET LOW LE 0327 01597000
*/* NODE REPRESENTING SPECIFIC CYLINDER REQUEST ON LEG OF THE TREE   */ 01598000
*/********************************************************************/ 01599000
*/*                                                                  */ 01600000
*/*        GETLOLEC:  GET LOWEST NODE ON LE LEG OF TREE STILL        */ 01601000
*/*                   REPRESENTING A READ REQUEST FROM A SPECIFIC    */ 01602000
*/*                   CYLINDER OF THE PAGING SPACE                   */ 01603000
*/*                                                                  */ 01604000
*/*      INPUT: ADDR OF LATEST IOE ON TREE EXAMINED BY BRDMASK       */ 01605000
*/*             VALUE OF CURRENT READ CYLINDER TO BE PROCESSED       */ 01606000
*/*                                                                  */ 01607000
*/*      PROCESS: MOVE DOWN LE LEG FROM INPUT IOE UNTIL LEG ENDS OR  */ 01608000
*/*               AN IOE FOR A READ REQUEST ON A DIFFERENT CYLINDER  */ 01609000
*/*               IS FOUND                                           */ 01610000
*/*                                                                  */ 01611000
*/*      OUTPUT: ADDRESS OF LAST IOE ON LE LEG (FROM INPUT IOE)      */ 01612000
*/*              WHICH IS A READ REQUEST FOR THE SAME CYLINDER AS    */ 01613000
*/*              THE CURRENT READ CYLINDER.                          */ 01614000
*/*                                                                  */ 01615000
*/*                                                                  */ 01616000
*/********************************************************************/ 01617000
*/*GETLOLEC:   E GET LOW LE NODE FOR CERTAIN CYL                     */ 01618000
*                                                                  0327 01619000
*GETLOLEC:                                                         0327 01620000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0327 01621000
GETLOLEC DS    0H                                                  0328 01622000
*   RFY                                                            0328 01623000
*     R14 RSTD;                     /* RESTRICT RETURN REGISTER      */ 01624000
*                                                                  0328 01625000
*   /*****************************************************************/ 01626000
*   /*                                                               */ 01627000
*   /* LOOP: EACH ITERATION MOVING DOWN AN LE LEG OF THE TREE UNTIL  */ 01628000
*   /* THE END OF THE LEG IS FOUND, OR A NODE REPRESENTING A READ    */ 01629000
*   /* FROM A DIFFERENT CYLINDER IS FOUND.                           */ 01630000
*   /*                                                               */ 01631000
*   /*****************************************************************/ 01632000
*                                                                  0329 01633000
*/*           N LOOP DOWN LE PATH UNTIL LEG END OR CYL CHANGE        */ 01634000
*/*%GLC10:    D (NO,,YES,%GLC90) LAST NODE FOR CYL REACHED ON LEG ?  */ 01635000
*                                                                  0329 01636000
*   DO WHILE THISNODE->IOENXTLE^=ZERO&THISNODE->IOENXTLE->IOEAIA-> 0329 01637000
*         AIACYL=THISCYL;                                          0329 01638000
*                                                                  0329 01639000
         B     @DE00329                                            0329 01640000
@DL00329 DS    0H                                                  0330 01641000
*/*           P MOVE DOWN TREE ONE NODE, GET NEXT NODE ON LE LEG     */ 01642000
*                                                                  0330 01643000
*     THISNODE=THISNODE->IOENXTLE;                                 0330 01644000
*                                                                  0330 01645000
         L     THISNODE,IOENXTLE(,THISNODE)                        0330 01646000
*/*%GLC60:    N (,%GLC10) END LOOP TO FIND LOWEST LE NODE FOR SPECIFIC  01647000
*/*                       CYL                                        */ 01648000
*                                                                  0331 01649000
*   END;                            /* END LOOP TO FIND LOW SLOT FOR    01650000
*                                      THIS CYL ON THIS LE LEG       */ 01651000
@DE00329 L     @15,IOENXTLE(,THISNODE)                             0331 01652000
         LTR   @15,@15                                             0331 01653000
         BZ    @DC00329                                            0331 01654000
         L     @15,IOEAIA(,@15)                                    0331 01655000
         LH    @15,AIACYL(,@15)                                    0331 01656000
         C     @15,THISCYL                                         0331 01657000
         BE    @DL00329                                            0331 01658000
@DC00329 DS    0H                                                  0332 01659000
*/*%GLC90:    R RETURN                                               */ 01660000
*                                                                  0332 01661000
*   RFY                                                            0332 01662000
*     R14 UNRSTD;                   /* RELEASE RETURN REGISTER       */ 01663000
*   END GETLOLEC;                   /* END SUBROUTINE GETLOLEC       */ 01664000
@EL00009 DS    0H                                                  0333 01665000
@EF00009 DS    0H                                                  0333 01666000
@ER00009 BR    @14                                                 0333 01667000
*/*GETLOLEC: END                                                     */ 01668000
*                                                                  0334 01669000
*                                                                  0334 01670000
*/*PROCHIT: CHART                                                    */ 01671000
*/* HEADING                                                        0334 01672000
*/* ILRSRT - ASM SLOT SORT                                         0334 01673000
*/*PROCHIT: ASGN I/O TO SLOT FOUND VIA FINDSLOT ROUTINE              */ 01674000
*/********************************************************************/ 01675000
*/*                                                                  */ 01676000
*/*      PROCHIT: ASGN I/O TO SLOT FOUND VIA FINDSLOT ROUTINE        */ 01677000
*/*                                                                  */ 01678000
*/*      INPUT: 1) ADDRESS OF IOE                                    */ 01679000
*/*             2) NUMBER OF REQUEST YET TO PROCESS (SERVICE BURST)  */ 01680000
*/*             3) PART ENTRY                                        */ 01681000
*/*             4) INPUT PARAMETER LIST FORM ILRPTM                  */ 01682000
*/*                                                                  */ 01683000
*/*      PROCESS: AN I/O REQUEST (PCCW) IS BUILT AND CHAINED TO THE  */ 01684000
*/*              IORB. THE IOE IS FREED. IF MORE REQUESTS MAY BE     */ 01685000
*/*              PROCESSED AN ADDITIONAL PCCW IS OBTAINED FROM THE   */ 01686000
*/*              ASMVT AVAILABLE QUEUE.                              */ 01687000
*/*                                                                  */ 01688000
*/*      OUTPUT: - INITIALZED PCCW CHAINED TO IORB                   */ 01689000
*/*              - IOE ADDED TO AVAILABLE QUEUE                      */ 01690000
*/*              - NEW PCCW ADDRESSED IN PART MONITOR PARM LIST      */ 01691000
*/*              - "STOP" INDICATOR SET IF NO MORE REQUESTS MAY BE   */ 01692000
*/*                PROCESSED OR RESOURCES UNAVAILABLE                */ 01693000
*/*                                                                  */ 01694000
*/*                                                                  */ 01695000
*/********************************************************************/ 01696000
*/*PROCHIT:  E ASGN I/O TO SLOT FOUND VIA FINDSLOT                   */ 01697000
*                                                                  0334 01698000
*PROCHIT:                                                          0334 01699000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0334 01700000
PROCHIT  DS    0H                                                  0335 01701000
*   RFY                                                            0335 01702000
*     R14 RSTD;                                                    0335 01703000
*   RETADDR2=R14;                   /* SAVE RETURN ADDRESS           */ 01704000
         ST    R14,RETADDR2                                        0336 01705000
*   RFY                                                            0337 01706000
*     R14 UNRSTD;                                                  0337 01707000
*                                                                  0337 01708000
*   /*****************************************************************/ 01709000
*   /*                                                               */ 01710000
*   /* IOCHAIN INITIALIZES THE PCCW AND CHAINS THE PCCW TO THE IORB. */ 01711000
*   /*                                                               */ 01712000
*   /*****************************************************************/ 01713000
*                                                                  0338 01714000
*/*           S IOCHAIN: CHAIN PCCW TO IORB                          */ 01715000
*                                                                  0338 01716000
*   CALL IOCHAIN;                   /* CHAIN PCCW TO IORB            */ 01717000
         BAL   @14,IOCHAIN                                         0338 01718000
*/* D (YES,,NO,%F01) ANYTHING ON INTERNAL Q?                         */ 01719000
*/* P (,%F02) QUEUE IOE TO LAST ONE ON Q TAIL->IOENXT                */ 01720000
*/*%F01: P PLACE IOE ON QUEUE                                        */ 01721000
*/*%F02: P UPDATE TAIL PTR TO THIS IOE                               */ 01722000
*/* P TAIL->IOENXT=0                                                 */ 01723000
*                                                                  0339 01724000
*   /*****************************************************************/ 01725000
*   /*                                                               */ 01726000
*   /* PUT USED IOE ON INTERNAL QUEUE TO BE FREED BEFORE RETURN TO   */ 01727000
*   /* PART MONITOR ALL AT ONCE BY 1 COMPARE AND SWAP.               */ 01728000
*   /*                                                               */ 01729000
*   /*****************************************************************/ 01730000
*                                                                  0339 01731000
*   EPAIOEIP=0;                     /* ZERO FOR RECOVERY             */ 01732000
         SLR   @11,@11                                             0339 01733000
         ST    @11,EPAIOEIP(,EPAPTR)                               0339 01734000
*   IF EPAFFIOE=0 THEN              /* ANYTHING ON INTERNAL FREE   0340 01735000
*                                      QUEUE YET                     */ 01736000
         C     @11,EPAFFIOE(,EPAPTR)                               0340 01737000
         BNE   @RF00340                                            0340 01738000
*     EPAFFIOE=IOEPTR;              /* NO- PUT ON AS FIRST           */ 01739000
         ST    IOEPTR,EPAFFIOE(,EPAPTR)                            0341 01740000
*   ELSE                            /* ELEMENTS THERE ALREADY        */ 01741000
*     EPALFIOE->IOENXT=IOEPTR;      /* PUT ON END                    */ 01742000
         B     @RC00340                                            0342 01743000
@RF00340 L     @11,EPALFIOE(,EPAPTR)                               0342 01744000
         ST    IOEPTR,IOENXT(,@11)                                 0342 01745000
*   EPALFIOE=IOEPTR;                /* REGARDLESS, THIS ONE IS LAST  */ 01746000
@RC00340 ST    IOEPTR,EPALFIOE(,EPAPTR)                            0343 01747000
*   IOENXT=0;                       /* SO, MAKE SURE ITS CHAIN PTR IS   01748000
*                                      ZERO                          */ 01749000
         SLR   @11,@11                                             0344 01750000
         ST    @11,IOENXT(,IOEPTR)                                 0344 01751000
*   IOEPTR=0;                       /* DONE WITH THIS ONE            */ 01752000
*                                                                  0345 01753000
         SLR   IOEPTR,IOEPTR                                       0345 01754000
*   /*****************************************************************/ 01755000
*   /*                                                               */ 01756000
*   /* DETERMINE NOW IF ANY MORE REQUESTS NEED BE PROCESSED ...      */ 01757000
*   /* CONTINUE AND ATTEMPT TO OBTAIN ANOTHER PCCW IF THE SERVICE    */ 01758000
*   /* BURST REQUEST QUOTA HAS NOT BEEN MET AND MORE POTENTIAL I/O   */ 01759000
*   /* REQUESTS ARE POSSIBLE ON THIS PAGING SPACE.                   */ 01760000
*   /*                                                               */ 01761000
*   /*****************************************************************/ 01762000
*                                                                  0346 01763000
*/*           D (YES,,NO,%PRH40) PROCESS MORE REQUESTS ?             */ 01764000
*/*           P DECREMENT SERVICE BURST REQUEST QUOTA BY ONE         */ 01765000
*/*           S (,%PRH50) GETPCCW: TRY TO GET ANOTHER PCCW           */ 01766000
*/*%PRH40:    P INDICATE TIME TO STOP BUILDING PCCWS                 */ 01767000
*                                                                  0346 01768000
*   IF REQNEED>ONE&                 /* REQUEST QUOTA NOT YET MET?    */ 01769000
*       (WRITEQUE^=ZERO|PARENODE^=ZERO) THEN/* -AND- MORE REQUESTS ? */ 01770000
         L     @12,REQNEED                                         0346 01771000
         C     @12,@CF00045                                        0346 01772000
         BNH   @RF00346                                            0346 01773000
         C     @11,WRITEQUE                                        0346 01774000
         BNE   @RT00346                                            0346 01775000
         L     @12,PAREPTR                                         0346 01776000
         C     @11,PARENODE(,@12)                                  0346 01777000
         BE    @RF00346                                            0346 01778000
@RT00346 DS    0H                                                  0347 01779000
*     DO;                                                          0347 01780000
*       REQNEED=REQNEED-ONE;        /* DECR REQUEST QUOTA CTR        */ 01781000
         L     @12,REQNEED                                         0348 01782000
         BCTR  @12,0                                               0348 01783000
         ST    @12,REQNEED                                         0348 01784000
*       CALL GETPCCW;               /* GET PCCW FOR NEXT REQ         */ 01785000
         BAL   @14,GETPCCW                                         0349 01786000
*     END;                                                         0350 01787000
*   ELSE                                                           0351 01788000
*     STOP=YES;                     /* INDICATE TIME TO STOP SORTING    01789000
*                                      AND GET I/O GOING             */ 01790000
         B     @RC00346                                            0351 01791000
@RF00346 OI    STOP,B'10000000'                                    0351 01792000
*/*%PRH50:    R RETURN                                               */ 01793000
*                                                                  0352 01794000
*   RFY                                                            0352 01795000
*     R14 RSTD;                                                    0352 01796000
@RC00346 DS    0H                                                  0353 01797000
*   R14=RETADDR2;                   /* RESTORE RETURN REGISTER       */ 01798000
         L     R14,RETADDR2                                        0353 01799000
*   RFY                                                            0354 01800000
*     R14 UNRSTD;                                                  0354 01801000
*   END PROCHIT;                    /* END SUBROUTINE PROCHIT        */ 01802000
@EL00010 DS    0H                                                  0355 01803000
@EF00010 DS    0H                                                  0355 01804000
@ER00010 BR    @14                                                 0355 01805000
*/*PROCHIT: END                                                      */ 01806000
*                                                                  0356 01807000
*                                                                  0356 01808000
*/*SETWRITE: CHART                                                   */ 01809000
*/* HEADING                                                        0356 01810000
*/* ILRSRT - ASM SLOT SORT                                         0356 01811000
*/*SETWRITE: SET UP FOR A WRITE REQUEST                              */ 01812000
*/********************************************************************/ 01813000
*/*                                                                  */ 01814000
*/*      SETWRITE: SET UP FOR A WRITE REQUEST                        */ 01815000
*/*                                                                  */ 01816000
*/*      INPUT: - SLOT VALUE FOUND BY FINDSLOT ROUTINE               */ 01817000
*/*             - VALUE OF CYLINDER CURRENTLY BEING PROCESSED        */ 01818000
*/*             - NUMBER OF SLOTS PER CYLINDER                       */ 01819000
*/*             - PART MONITOR PARAMETER LIST                        */ 01820000
*/*             - CURRENT COUNTS OF WRITES PROCESSED                 */ 01821000
*/*             - COPY OF PAT CYLINDER BIT MAP FOR CURRENT CYLINDER  */ 01822000
*/*                                                                  */ 01823000
*/*      PROCESS: THE RELATIVE NUMBER OF THE SLOT FOUND BY THE FIND- */ 01824000
*/*               SLOT ROUTINE IS COMPUTED. AN IOE IS OBTAINED FROM  */ 01825000
*/*               THE WRITE QUEUE PASSED BY PART MONITOR.  IF NO MORE*/ 01826000
*/*               WRITE REQUESTS EXIST ON THE QUEUE THEN THE READ/   */ 01827000
*/*               WRITE MASK IS UPDATED SO THAT SETWRITE WILL NO     */ 01828000
*/*               LONGER BE CALLED FROM THE FINDSLOT ROUTINE.  THE   */ 01829000
*/*               COUNT OF WRITE REQUESTS CHOSEN FOR THE CURRENT     */ 01830000
*/*               CYLINDER IS INCREMENTED. THE PART ENTRY INDEX VALUE*/ 01831000
*/*               AND THE RSN ARE STORED IN THE LSID FIELD OF THE AIA*/ 01832000
*/*               ADDRESSED FROM THE IOE.                            */ 01833000
*/*                                                                  */ 01834000
*/*      OUTPUT:  - UPDATED READ/WRITE MASK (MAYBE)                  */ 01835000
*/*               - UPDATED WRITE COUNT                              */ 01836000
*/*               - UPDATED AIA                                      */ 01837000
*/*               - UPDATED WRITE QUEUE ANCHOR                       */ 01838000
*/*               - IOE FOR WRITE REQUEST                            */ 01839000
*/*               - RSN OF SLOT TO BE WRITTEN                        */ 01840000
*/*                                                                  */ 01841000
*/********************************************************************/ 01842000
*/*SETWRITE:  E INITLZ, CHAIN A PCCW FOR A WRITE REQ                 */ 01843000
*                                                                  0356 01844000
*SETWRITE:                                                         0356 01845000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0356 01846000
SETWRITE DS    0H                                                  0357 01847000
*   RFY                                                            0357 01848000
*     R14 RSTD;                                                    0357 01849000
*   RETADDR2=R14;                   /* SAVE RETURN ADDRESS           */ 01850000
         ST    R14,RETADDR2                                        0358 01851000
*   RFY                                                            0359 01852000
*     R14 UNRSTD;                                                  0359 01853000
*   GEN(LM    R2,R7,28(R13));       /* RESTORE FINDSLOT REGS         */ 01854000
*                                                                  0360 01855000
         LM    R2,R7,28(R13)                                            01856000
*   /*****************************************************************/ 01857000
*   /*                                                               */ 01858000
*   /* COMPUTE THE PAGING SPACE RELATIVE SLOT NUMBER REPRESENTED BY  */ 01859000
*   /* THE BIT FOUND VIA THE FINDSLOT ROUTINE                        */ 01860000
*   /*                                                               */ 01861000
*   /*****************************************************************/ 01862000
*                                                                  0361 01863000
*/*           P COMPUTE RSN OF SLOT FOUND BY FINDSLOT RTN            */ 01864000
*                                                                  0361 01865000
*   TSLOTNBR=THISCYL*CYLSLOTS+SSLOT;/* GET REL SLOT NBR              */ 01866000
*                                                                  0361 01867000
         L     @01,THISCYL                                         0361 01868000
         M     @00,CYLSLOTS                                        0361 01869000
         AL    @01,SSLOT                                           0361 01870000
         ST    @01,TSLOTNBR                                        0361 01871000
*   /*****************************************************************/ 01872000
*   /*                                                               */ 01873000
*   /* OBTAIN IOE FROM WRITE QUEUE, FROM IT OBTAIN THE ADDRESS OF THE*/ 01874000
*   /* AIA...                                                        */ 01875000
*   /*                                                               */ 01876000
*   /*****************************************************************/ 01877000
*                                                                  0362 01878000
*/*           P OBTAIN FIRST IOE ON WRITE QUEUE                      */ 01879000
*/*           P GET ADDRESS OF AIA FROM IOE                          */ 01880000
*                                                                  0362 01881000
*   IOEPTR=WRITEQUE;                /* GET ADDR 1ST WRITE ON QUEUE   */ 01882000
         L     IOEPTR,WRITEQUE                                     0362 01883000
*   WRITEQUE=IOENXT;                /* RESET WRITE QUEUE ANCHOR      */ 01884000
         L     @11,IOENXT(,IOEPTR)                                 0363 01885000
         ST    @11,WRITEQUE                                        0363 01886000
*   PTRWRITE=WRITEQUE;              /* RESET PARM AREA FOR REMAINING    01887000
*                                      WRITES REQUIRED BY RECOVERY 0364 01888000
*                                                            @ZA28762*/ 01889000
         L     @05,PRMLADDR                                        0364 01890000
         ST    @11,PTRWRITE(,@05)                                  0364 01891000
*   EPAIOEIP=IOEPTR;                /* TELL RECOV IOE CURRENTLY BEING   01892000
*                                      PROCESSED                     */ 01893000
*                                                                  0365 01894000
         ST    IOEPTR,EPAIOEIP(,EPAPTR)                            0365 01895000
*   /*****************************************************************/ 01896000
*   /*                                                               */ 01897000
*   /* ----- IF THE WRITE QUEUE IS EMPTY, RESET THE CURRENT          */ 01898000
*   /* READ/WRITE MASK SO THAT NO MORE WRITE HITS MAY BE RETURNED BY */ 01899000
*   /* THE FINDSLOT ROUTINE                                          */ 01900000
*   /*                                                               */ 01901000
*   /*****************************************************************/ 01902000
*                                                                  0366 01903000
*/*           D (YES,,NO,%STW10) WRITE QUEUE EMPTY ?                 */ 01904000
*/*           P SET REMAINING POTENTIAL WRITE HITS OFF IN R/W MASK   */ 01905000
*                                                                  0366 01906000
*   IF WRITEQUE=ZERO THEN           /* NO MORE WRITE REQUESTS ?      */ 01907000
         LTR   @11,@11                                             0366 01908000
         BNZ   @RF00366                                            0366 01909000
*     SCYLRDWT=SCYLRDWT&SCYLCOPY;   /* TURN OFF REMAINING WRITE    0367 01910000
*                                      POSSIBILITIES IN R/W MASK     */ 01911000
         NC    SCYLRDWT(8),SCYLCOPY                                0367 01912000
*   ELSE                                                           0368 01913000
*     ;                                                            0368 01914000
*                                                                  0368 01915000
@RF00366 DS    0H                                                  0369 01916000
*/*%STW10:    P INCR WRITES- PROCESSED CTR TO LATER UPDATE PARTE CTR */ 01917000
*                                                                  0369 01918000
*   EPAWRTCT=EPAWRTCT+ONE;          /* INCREMENT COUNT OF WRITE    0369 01919000
*                                      REQUESTS PREPARED             */ 01920000
*                                                                  0369 01921000
         LA    @11,1                                               0369 01922000
         AH    @11,EPAWRTCT(,EPAPTR)                               0369 01923000
         STH   @11,EPAWRTCT(,EPAPTR)                               0369 01924000
*   /*****************************************************************/ 01925000
*   /*                                                               */ 01926000
*   /* FROM THE IOE OBTAINED ABOVE OBTAIN THE ADDRESS OF THE AIA...  */ 01927000
*   /* STORE THE RELATIVE SLOT NUMBER AND PART ENTRY NN INDEX VALUE  */ 01928000
*   /* INTO THE AIA                                                  */ 01929000
*   /*                                                               */ 01930000
*   /*****************************************************************/ 01931000
*                                                                  0370 01932000
*/*           P GET ADDRESS OF AIA FROM IOE                          */ 01933000
*/*           P STORE RSN AND PARTE NN INDEX INTO AIA LSID FIELD     */ 01934000
*                                                                  0370 01935000
*   AIAPTR=IOEAIA;                  /* GET AIA ADDRESS               */ 01936000
         L     AIAPTR,IOEAIA(,IOEPTR)                              0370 01937000
*   IF AIADUPLX=ON THEN             /* DUPLEX WRITE OPERATION?       */ 01938000
         TM    AIADUPLX(AIAPTR),B'00010000'                        0371 01939000
         BNO   @RF00371                                            0371 01940000
*     LSIDPTR=IOELSIDA;             /* USE IOE TO FIND PROPER LSID 0372 01941000
*                                      FIELD TO USE                  */ 01942000
         L     LSIDPTR,IOELSIDA(,IOEPTR)                           0372 01943000
*   ELSE                            /* OTHERWISE                     */ 01944000
*     LSIDPTR=ADDR(AIALSID);        /* ITS ALWAYS THIS FIELD         */ 01945000
         B     @RC00371                                            0373 01946000
@RF00371 LA    LSIDPTR,AIALSID(,AIAPTR)                            0373 01947000
*   PRTNN=PARENN;                   /* STORE PART ENTRY INDEX IN LSID*/ 01948000
@RC00371 L     @11,PAREPTR                                         0374 01949000
         LH    @11,PARENN(,@11)                                    0374 01950000
         STC   @11,PRTNN(,LSIDPTR)                                 0374 01951000
*   SLOT=TSLOTNBR;                  /* STORE RSN IN LSID             */ 01952000
         MVC   SLOT(2,LSIDPTR),TSLOTNBR+2                          0375 01953000
*/*           R RETURN                                               */ 01954000
*                                                                  0376 01955000
*   RFY                                                            0376 01956000
*     R14 RSTD;                                                    0376 01957000
*   R14=RETADDR2;                   /* RESTORE RETURN REGISTER       */ 01958000
         L     R14,RETADDR2                                        0377 01959000
*   RFY                                                            0378 01960000
*     R14 UNRSTD;                                                  0378 01961000
*   END SETWRITE;                   /* END SUBROUTINE SETWRITE       */ 01962000
@EL00011 DS    0H                                                  0379 01963000
@EF00011 DS    0H                                                  0379 01964000
@ER00011 BR    @14                                                 0379 01965000
*/*SETWRITE: END                                                     */ 01966000
*                                                                  0380 01967000
*                                                                  0380 01968000
*/*GETREAD: CHART                                                    */ 01969000
*/* HEADING                                                        0380 01970000
*/* ILRSRT - ASM SLOT SORT                                         0380 01971000
*/*GETREAD: GET IOE FOR READ REQUEST                                 */ 01972000
*/********************************************************************/ 01973000
*/*                                                                  */ 01974000
*/*      GETREAD:  GET IOE FOR READ REQUEST                          */ 01975000
*/*                                                                  */ 01976000
*/*      INPUT: - SLOT VALUE FOUND BY FIND SLOT ROUTINE              */ 01977000
*/*             - VALUE OF CYLINDER CURRENTLY BEING PROCESSED        */ 01978000
*/*             - NUBMER OF SLOTS PER CYLINDER                       */ 01979000
*/*             - PART ENTRY                                         */ 01980000
*/*             - ADDRESS OF FIRST IOE ON TREE OF READ CYL GROUP     */ 01981000
*/*                                                                  */ 01982000
*/*      PROCESS: THE REALTIVE SLOT NUMBER OF THE SLOT FOUND BY THE  */ 01983000
*/*               FINDSLOT ROUTINE IS COMPUTED. THE IOE CORRESPONDING*/ 01984000
*/*               TO A REQUEST FOR THAT SLOT IS FOUND AND REMOVED    */ 01985000
*/*               FROM THE TREE                                      */ 01986000
*/*                                                                  */ 01987000
*/*      OUTPUT: - IOE FOR READ REQUEST                              */ 01988000
*/*              - RSN OF SLOT TO BE READ                            */ 01989000
*/*                                                                  */ 01990000
*/********************************************************************/ 01991000
*/*GETREAD: E GET IOE FOR READ REQUEST                               */ 01992000
*                                                                  0380 01993000
*GETREAD:                                                          0380 01994000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0380 01995000
GETREAD  DS    0H                                                  0381 01996000
*   RFY                                                            0381 01997000
*     R14 RSTD;                                                    0381 01998000
*   RETADDR2=R14;                   /* SAVE RETURN ADDRESS           */ 01999000
         ST    R14,RETADDR2                                        0382 02000000
*   RFY                                                            0383 02001000
*     R14 UNRSTD;                                                  0383 02002000
*   GEN(LM    R2,R7,28(R13));       /* RESTORE FINDSLOT REGS         */ 02003000
*                                                                  0384 02004000
         LM    R2,R7,28(R13)                                            02005000
*   /*****************************************************************/ 02006000
*   /*                                                               */ 02007000
*   /* COMPUTE THE PAGING SPACE RELATIVE SLOT NUMBER REPRESENTED BY  */ 02008000
*   /* THE BIT FOUND VIA THE FINDSLOT ROUTINE                        */ 02009000
*   /*                                                               */ 02010000
*   /*****************************************************************/ 02011000
*                                                                  0385 02012000
*/*           P COMPUTE RSN OF SLOT FOUND BY FINDSLOT RTN            */ 02013000
*                                                                  0385 02014000
*   TSLOTNBR=THISCYL*CYLSLOTS+SSLOT;/* GET REL SLOT NBR              */ 02015000
*                                                                  0385 02016000
         L     @01,THISCYL                                         0385 02017000
         M     @00,CYLSLOTS                                        0385 02018000
         AL    @01,SSLOT                                           0385 02019000
         ST    @01,TSLOTNBR                                        0385 02020000
*   /*****************************************************************/ 02021000
*   /*                                                               */ 02022000
*   /* FIND READ REQUEST ON TREE CORRESPONDING TO THE SLOT FOUND BY  */ 02023000
*   /* THE FINDSLOT ROUTINE                                          */ 02024000
*   /*                                                               */ 02025000
*   /*****************************************************************/ 02026000
*                                                                  0386 02027000
*/*           P SET UP NODE ADDRS TO SCAN TREE FOR NODE USING SLOT 0386 02028000
*/*             FOUND                                                */ 02029000
*                                                                  0386 02030000
*   THISNODE=TOPRDIOE;              /* GET FIRST READ IOE ON TREE FOR   02031000
*                                      CURRENT CYL                   */ 02032000
         L     THISNODE,TOPRDIOE                                   0386 02033000
*/*           N LOOP MOVING DOWN TREE ONE NODE AT A TIME             */ 02034000
*/*%GTR10:    D (NO,,YES,%GTR60) NODE FOUND ?                        */ 02035000
*                                                                  0387 02036000
*   DO WHILE TSLOTNBR^=THISNODE->IOEAIA->AIASLOT;/* FIND IOE         */ 02037000
*                                                                  0387 02038000
         B     @DE00387                                            0387 02039000
@DL00387 DS    0H                                                  0388 02040000
*     /***************************************************************/ 02041000
*     /*                                                             */ 02042000
*     /* WHICH WAY TO MOVE DOWN TREE ---- DEPENDS ON THE SLOT NUMBER */ 02043000
*     /* REPRESENTED BY THE CURRENT NODE WE ARE EXAMINING            */ 02044000
*     /*                                                             */ 02045000
*     /***************************************************************/ 02046000
*                                                                  0388 02047000
*/*           D (YES,,NO,%GTR20) THIS NODE SLOT# > SRCH SLOT# ?      */ 02048000
*/*           P (,%GTR50) MOVE DOWN TREE ONE NODE: LE PATH           */ 02049000
*/*%GTR20:    P MOVE DOWN TREE ONE NODE: GT PATH                     */ 02050000
*                                                                  0388 02051000
*     IF THISNODE->IOEAIA->AIASLOT> /* THIS IOE FOR SLOT NBR         */ 02052000
*         TSLOTNBR THEN             /* GREATER THAN ONE TO FIND ?    */ 02053000
         L     @12,IOEAIA(,THISNODE)                               0388 02054000
         LH    @12,AIASLOT(,@12)                                   0388 02055000
         N     @12,@CF02144                                        0388 02056000
         C     @12,TSLOTNBR                                        0388 02057000
         BNH   @RF00388                                            0388 02058000
*       THISNODE=THISNODE->IOENXTLE;/* MOVE DOWN LE LEG OF TREE      */ 02059000
         L     THISNODE,IOENXTLE(,THISNODE)                        0389 02060000
*     ELSE                          /* THIS IOE SLOT NBR LE ?        */ 02061000
*       THISNODE=THISNODE->IOENXTGT;/* MOVE DOWN GT LEG OF TREE      */ 02062000
         B     @RC00388                                            0390 02063000
@RF00388 L     THISNODE,IOENXTGT(,THISNODE)                        0390 02064000
*/*%GTR50:    N (,%GTR10) END LOOP TO FIND READ REQUEST ON TREE      */ 02065000
*                                                                  0391 02066000
*   END;                                                           0391 02067000
*                                                                  0391 02068000
@RC00388 DS    0H                                                  0391 02069000
@DE00387 L     @12,IOEAIA(,THISNODE)                               0391 02070000
         LH    @12,AIASLOT(,@12)                                   0391 02071000
         N     @12,@CF02144                                        0391 02072000
         C     @12,TSLOTNBR                                        0391 02073000
         BNE   @DL00387                                            0391 02074000
*   /*****************************************************************/ 02075000
*   /*                                                               */ 02076000
*   /* CALL REMVNODE TO REMOVE NODE (IOE) FROM THE TREE              */ 02077000
*   /*                                                               */ 02078000
*   /*****************************************************************/ 02079000
*                                                                  0392 02080000
*/*%GTR60:    S REMVNODE: REMOVE NODE FROM TREE                      */ 02081000
*                                                                  0392 02082000
*   CALL REMVNODE;                  /* REMOVE IOE FROM TREE          */ 02083000
         BAL   @14,REMVNODE                                        0392 02084000
*/*           R RETURN                                               */ 02085000
*                                                                  0393 02086000
*   RFY                                                            0393 02087000
*     R14 RSTD;                                                    0393 02088000
*   R14=RETADDR2;                   /* RESTORE RETURN REGISTER       */ 02089000
         L     R14,RETADDR2                                        0394 02090000
*   RFY                                                            0395 02091000
*     R14 UNRSTD;                                                  0395 02092000
*   END GETREAD;                    /* END SUBROUTINE GETREAD        */ 02093000
@EL00012 DS    0H                                                  0396 02094000
@EF00012 DS    0H                                                  0396 02095000
@ER00012 BR    @14                                                 0396 02096000
*/*GETREAD: END                                                      */ 02097000
*                                                                  0397 02098000
*                                                                  0397 02099000
*/*REMVNODE: CHART                                                   */ 02100000
*/* HEADING                                                        0397 02101000
*/* ILRSRT - ASM SLOT SORT                                         0397 02102000
*/*REMVNODE: REMOVE NODE (READ REQUEST) FROM TREE                    */ 02103000
*/********************************************************************/ 02104000
*/*                                                                  */ 02105000
*/*      REMVNODE:   REMOVE NODE (READ REQUEST) FROM TREE            */ 02106000
*/*                                                                  */ 02107000
*/*      INPUT: - ADDRESS OF IOE TO BE REMOVED FROM TREE             */ 02108000
*/*             - PART ENTRY                                         */ 02109000
*/*                                                                  */ 02110000
*/*      PROCESS: IN SHORT THE ROUTINE REMOVES THE IOE FROM THE TREE */ 02111000
*/*               BY RECHAINING THOSE NODES HANGING FROM IT TO NEW   */ 02112000
*/*               LOCATIONS IN THE TREE.                             */ 02113000
*/*                                                                  */ 02114000
*/*               RULES:                                             */ 02115000
*/*               1) IF NO NODES HANG FROM THE TARGET NODE, THE      */ 02116000
*/*                  PROCEDURE SIMPLY ZEROS THE APPROPRIATE LEG      */ 02117000
*/*                  POINTER IN THE TARGET ANCESTOR NODE.            */ 02118000
*/*                                                                  */ 02119000
*/*               2) IF ONLY ONE LEG OF NODES HANG FROM THE TARGET   */ 02120000
*/*                  NODE THEN THE LEG IS RECHAINED TO THE TARGET    */ 02121000
*/*                  ANCESTOR NODE VIA THE SAME POINTER THAT ONCE    */ 02122000
*/*                  ADDRESSED THE TARGET NODE.                      */ 02123000
*/*                                                                  */ 02124000
*/*               3) IF TWO LEGS OF NODES HANG FROM THE TARGET NODE  */ 02125000
*/*                  THE PROCEDURE IS MORE COMPLEX. IF THE TARGET    */ 02126000
*/*                  NODE HANGS ON ITS ANCESTORS GT LEG THEN ITS LE  */ 02127000
*/*                  LEG IS RECHAINED VIA THE ANCESTOR GT LEG POINTER*/ 02128000
*/*                  THE GT LEG OFF THE TARGET IS RECHAINED TO THE   */ 02129000
*/*                  LAST NODE ON THE GT LEG HANGING OFF THE FIRST   */ 02130000
*/*                  NODE NEWLY CHAINED (SEE ABOVE SENTENCE) TO THE  */ 02131000
*/*                  TARGET ANCESTOR. THE PROCEDURE IS EXACTLY       */ 02132000
*/*                  REVERSED (IE REPALCE GT WITH LE AND LE WITH GT) */ 02133000
*/*                  IF THE TARGET NODE IS HANGING ON ITS ANCESTORS  */ 02134000
*/*                  LE LEG.                                         */ 02135000
*/*                                                                  */ 02136000
*/*               4) IF THE TARGET NODE IS THE TOP NODE ON THE TREE  */ 02137000
*/*                  THE RECHAINING IS DONE AS ABOVE. THE PROCEDURE  */ 02138000
*/*                  OPERATES AS IF THE TARGET IS CHAINED ON THE GT  */ 02139000
*/*                  LEG OF IT ANCESTOR.                             */ 02140000
*/*                                                                  */ 02141000
*/*               5) IF THE TARGET NODE IS THE ONLY NODE ON THE TREE */ 02142000
*/*                  THE TREE ANCHOR IN THE PART ENTRY IS ZEROED.    */ 02143000
*/*                                                                  */ 02144000
*/*               6) COMPLETE RECHAINING OF ALL NODES INCLUDES  RE-  */ 02145000
*/*                  SETTING THE BACKWARD POINTER IN THE FIRST NODE  */ 02146000
*/*                  OF A RECHAINED LEG.                             */ 02147000
*/*                                                                  */ 02148000
*/*      OUTPUT: - IOE FREED FORM TREE                               */ 02149000
*/*              - RESET POINTERS IN NODES AFFECTED BY RECHAINING    */ 02150000
*/*                                                                  */ 02151000
*/********************************************************************/ 02152000
*/*REMVNODE:  E REMOVE READ REQ FROM TREE                            */ 02153000
*                                                                  0397 02154000
*REMVNODE:                                                         0397 02155000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0397 02156000
REMVNODE DS    0H                                                  0398 02157000
*   RFY                                                            0398 02158000
*     R14 RSTD;                                                    0398 02159000
*   RETADDR3=R14;                   /* SAVE RETURN ADDRESS           */ 02160000
         ST    R14,RETADDR3                                        0399 02161000
*   RFY                                                            0400 02162000
*     R14 UNRSTD;                                                  0400 02163000
*                                                                  0400 02164000
*   /*****************************************************************/ 02165000
*   /*                                                               */ 02166000
*   /* OBJECT: TO REMOVE A NODE FROM THE TREE AND TO RECHAIN ANY     */ 02167000
*   /* NODES HANGING FROM IT. ---------- FIRST OBTAIN ADDRESSES OF   */ 02168000
*   /* THE TARGET NODE AND THE TWO POSSIBLE NODES HANGING FROM IT    */ 02169000
*   /*                                                               */ 02170000
*   /*****************************************************************/ 02171000
*                                                                  0401 02172000
*/*           M OBTAIN ADDRS OF NODES HANGING FROM TARGET            */ 02173000
*                                                                  0401 02174000
*   IOEPTR=THISNODE;                /* SET IOE ADDRESS               */ 02175000
         LR    IOEPTR,THISNODE                                     0401 02176000
*   NEXTGT=IOENXTGT;                /* GET NEXT NODE DOWN GT PATH    */ 02177000
         L     NEXTGT,IOENXTGT(,IOEPTR)                            0402 02178000
*   NEXTLE=IOENXTLE;                /* GET NEXT NODE DOWN LE PATH    */ 02179000
         L     NEXTLE,IOENXTLE(,IOEPTR)                            0403 02180000
*/*           P OBTAIN ADDRESS OF NODE TO WHICH TARGET IS CHAINED    */ 02181000
*                                                                  0404 02182000
*   LASTNODE=IOEBKPTR;                                             0404 02183000
*                                                                  0404 02184000
         L     LASTNODE,IOEBKPTR(,IOEPTR)                          0404 02185000
*   /*****************************************************************/ 02186000
*   /*                                                               */ 02187000
*   /* IF THE TARGET NODE IS CHAINED TO ITS ANCESTOR ON THE GT LEG,  */ 02188000
*   /* --- OR --- THE TARGET NODE IS THE TOP NODE IN THE TREE, THEN  */ 02189000
*   /* THE PROCEDURE IS TO CHAIN THE NODE ON THE TARGET'S LE LEG     */ 02190000
*   /* (DAUGHTER-LE-NODE) TO THE TARGET ANCESTOR, THEN TO RECHAIN THE*/ 02191000
*   /* NODE ON THE TARGET'S GT LEG (DAUGHTER-GT-NODE) TO THE LAST    */ 02192000
*   /* NODE ON THE DAUGHTER-LE-NODE'S GT LEG. THIS PROCEDURE IS      */ 02193000
*   /* EXACTLY REVERSED IF THE TARGET IS CHAINED TO ITS ANCESTOR VIA */ 02194000
*   /* THE LE LEG. THIS TENDS TO MOVE THE NODES FROM THE INNER PART  */ 02195000
*   /* OF THE TREE TO THE OUTER LEGS AND GUARANTEES THAT NODES       */ 02196000
*   /* REPRESENTING REQUESTS FOR THE SAME CYLINDER WILL REMAIN       */ 02197000
*   /* ADJACENT TO EACH OTHER. (ADJACENCY PREVIOUSLY GUARANTEED BY   */ 02198000
*   /* THE SORTING TECHNIQUE EMPLOYED IN SUBROUTINES SORTREAD AND    */ 02199000
*   /* ADRTTREE).                                                    */ 02200000
*   /*                                                               */ 02201000
*   /*****************************************************************/ 02202000
*                                                                  0405 02203000
*/*           D (YES,,NO,%RMN50) TARGET NODE ON ANCESTOR GT LEG ?    */ 02204000
*/*           N ABOVE DECISION INCLUDES CASE WHERE TARGET IS TOP   0405 02205000
*/*             NODE ON THE TREE                                     */ 02206000
*                                                                  0405 02207000
*   IF LASTNODE=ZERO|               /* TARGET ON TOP OF TREE ? OR    */ 02208000
*       LASTNODE->IOENXTGT=IOEPTR THEN/* IOE HUNG ON GT LEG ?        */ 02209000
         LTR   LASTNODE,LASTNODE                                   0405 02210000
         BZ    @RT00405                                            0405 02211000
         C     IOEPTR,IOENXTGT(,LASTNODE)                          0405 02212000
         BNE   @RF00405                                            0405 02213000
@RT00405 DS    0H                                                  0406 02214000
*     DO;                                                          0406 02215000
*                                                                  0406 02216000
*/*           D (YES,,NO,%RMN30) LE NODE HANGING FROM TARGET ?       */ 02217000
*                                                                  0407 02218000
*       IF NEXTLE^=ZERO THEN        /* NODE EXISTS DOWN LE PATH ?    */ 02219000
         LTR   NEXTLE,NEXTLE                                       0407 02220000
         BZ    @RF00407                                            0407 02221000
*         DO;                                                      0408 02222000
*                                                                  0408 02223000
*           /*********************************************************/ 02224000
*           /*                                                       */ 02225000
*           /* RECHAIN EXISTING DAUGHTER-LE-NODE TO TARGET'S ANCESTOR*/ 02226000
*           /*                                                       */ 02227000
*           /*********************************************************/ 02228000
*                                                                  0409 02229000
*/*           N RCHAINUP CHAINS DAUGHTER LE NODE TO TARGET ANCESTOR  */ 02230000
*/*           S RCHAINUP: RECHAIN DAUGHTER LE NODE                   */ 02231000
*                                                                  0409 02232000
*           NEXTNODE=NEXTLE;        /* PRESET NEXTNODE FOR REMOVE    */ 02233000
         LR    NEXTNODE,NEXTLE                                     0409 02234000
*           CALL RCHAINUP;          /* REMOVE NODE, RECHAIN LE LEG   */ 02235000
         BAL   @14,RCHAINUP                                        0410 02236000
*/*           D (YES,,NO,%RMN80) GT NODE HANGING FROM TARGET ?       */ 02237000
*                                                                  0411 02238000
*           IF NEXTGT^=ZERO THEN    /* NODE ALSO EXISTS DOWN GT PATH    02239000
*                                      ?                             */ 02240000
         LTR   NEXTGT,NEXTGT                                       0411 02241000
         BZ    @RF00411                                            0411 02242000
*             DO;                                                  0412 02243000
*                                                                  0412 02244000
*               /*****************************************************/ 02245000
*               /*                                                   */ 02246000
*               /* OBTAIN ADDRESS OF LAST NODE ON THE                */ 02247000
*               /* DAUGHTER-LE-NODE GT LEG AND CHAIN THE             */ 02248000
*               /* DAUGHTER-GT-NODE TO IT                            */ 02249000
*               /*                                                   */ 02250000
*               /*****************************************************/ 02251000
*                                                                  0413 02252000
*/*           N GET ADDR OF LAST NODE ON DAUGHTER LE NODE'S GT LEG   */ 02253000
*/*%RMN10:    D (YES,,NO,%RMN15) ANOTHER NODE DOWN GT LEG ?          */ 02254000
*/*           P MOVE DOWN GT LEG ONE NODE                            */ 02255000
*/*           N (,%RMN10) END LOOP TO MOVE DOWN TO END OF GT LEG     */ 02256000
*                                                                  0413 02257000
*               THISNODE=NEXTLE;    /* RESET THISNODE FOR GT SCAN    */ 02258000
         LR    THISNODE,NEXTLE                                     0413 02259000
*               DO WHILE THISNODE->IOENXTGT^=ZERO;/* GO TO LAST NODE */ 02260000
         B     @DE00414                                            0414 02261000
@DL00414 DS    0H                                                  0415 02262000
*                 THISNODE=THISNODE->IOENXTGT;/* DOWN GT PATH 1 NODE */ 02263000
         L     THISNODE,IOENXTGT(,THISNODE)                        0415 02264000
*               END;                                               0416 02265000
*                                                                  0416 02266000
@DE00414 L     @11,IOENXTGT(,THISNODE)                             0416 02267000
         LTR   @11,@11                                             0416 02268000
         BNZ   @DL00414                                            0416 02269000
*/*%RMN15:    P (,%RMN80) RECHAIN DAUGHTER GT NODE TO LAST NODE ON GT   02270000
*/*                       LEG                                        */ 02271000
*                                                                  0417 02272000
*               THISNODE->IOENXTGT=NEXTGT;/* RESET END NODE GT LEG   */ 02273000
         ST    NEXTGT,IOENXTGT(,THISNODE)                          0417 02274000
*               NEXTGT->IOEBKPTR=THISNODE;/* RESET BACKWARD PTR      */ 02275000
         ST    THISNODE,IOEBKPTR(,NEXTGT)                          0418 02276000
*             END;                  /* END NODE-DOWN-LE-&-GT-PATHS   */ 02277000
*           ELSE                                                   0420 02278000
*             ;                     /* NODE DOWN LE BUT NOT GT ?     */ 02279000
@RF00411 DS    0H                                                  0421 02280000
*         END;                      /* END NODE-DOWN-LE-PATH         */ 02281000
*       ELSE                        /* NO NODE DOWN LE PATH ?        */ 02282000
*                                                                  0422 02283000
*         /***********************************************************/ 02284000
*         /*                                                         */ 02285000
*         /* IF NO NODE IS HANGING ON THE LE LEG FROM THE TARGET NODE*/ 02286000
*         /* THEN SIMPLY RECHAIN THE NODE HANGING ON THE GT PATH, IF */ 02287000
*         /* ANY, TO THE TARGET'S ANCESTOR                           */ 02288000
*         /*                                                         */ 02289000
*         /***********************************************************/ 02290000
*                                                                  0422 02291000
*/*%RMN30:    N RCHAINUP CHAINS DAUGHTER GT NODE TO TARGET ANCESTOR  */ 02292000
*/*           S (,%RMN80) RCHAINUP: RECHAIN DAUGHTER GT NODE         */ 02293000
*                                                                  0422 02294000
*         DO;                                                      0422 02295000
         B     @RC00407                                            0422 02296000
@RF00407 DS    0H                                                  0423 02297000
*           NEXTNODE=NEXTGT;        /* PRESET NEXTNODE FOR REMOVE    */ 02298000
         LR    NEXTNODE,NEXTGT                                     0423 02299000
*           CALL RCHAINUP;          /* REMOVE NODE, RECHAIN GT LEG   */ 02300000
         BAL   @14,RCHAINUP                                        0424 02301000
*         END;                      /* END NODE-DOWN-GT-BUT-NOT-LE   */ 02302000
*     END;                          /* END IOE-HUNG-ON-GT-PATH       */ 02303000
*   ELSE                            /* IOE HUNG ON LE PATH ?         */ 02304000
*                                                                  0427 02305000
*     /***************************************************************/ 02306000
*     /*                                                             */ 02307000
*     /* -------------------- BELOW IS THE SAME PROCEDURE AS ABOVE;  */ 02308000
*     /* ONLY THIS TIME, THE TARGET NODE IS HANGING ON ITS ANCESTORS */ 02309000
*     /* LE LEG. (SEE ABOVE)                                         */ 02310000
*     /*                                                             */ 02311000
*     /***************************************************************/ 02312000
*                                                                  0427 02313000
*/*%RMN50:    D (YES,,NO,%RMN80) TARGET NODE ON ANCESTOR LE LEG ?    */ 02314000
*                                                                  0427 02315000
*     DO;                                                          0427 02316000
*                                                                  0427 02317000
         B     @RC00405                                            0427 02318000
@RF00405 DS    0H                                                  0428 02319000
*/*           D (YES,,NO,%RMN70) GT NODE HANGING FROM TARGET ?       */ 02320000
*                                                                  0428 02321000
*       IF NEXTGT^=ZERO THEN        /* NODE EXISTS DOWN GT PATH ?    */ 02322000
         LTR   NEXTGT,NEXTGT                                       0428 02323000
         BZ    @RF00428                                            0428 02324000
*         DO;                                                      0429 02325000
*                                                                  0429 02326000
*           /*********************************************************/ 02327000
*           /*                                                       */ 02328000
*           /* RECHAIN EXISTING DAUGHTER-GT-NODE TO TARGET'S ANCESTOR*/ 02329000
*           /*                                                       */ 02330000
*           /*********************************************************/ 02331000
*                                                                  0430 02332000
*/*           N RCHAINUP CHAINS DAUGHTER GT NODE TO TARGET ANCESTOR  */ 02333000
*/*           S RCHAINUP: RECHAIN DAUGHTER GT NODE                   */ 02334000
*                                                                  0430 02335000
*           NEXTNODE=NEXTGT;        /* PRESET NEXTNODE FOR REMOVE    */ 02336000
         LR    NEXTNODE,NEXTGT                                     0430 02337000
*           CALL RCHAINUP;          /* REMOVE NODE, RECHAIN GT LEG   */ 02338000
         BAL   @14,RCHAINUP                                        0431 02339000
*/*           D (YES,,NO,%RMN80) LE NODE HANGING FROM TARGET ?       */ 02340000
*                                                                  0432 02341000
*           IF NEXTLE^=ZERO THEN    /* NODE ALSO EXISTS DOWN LE PATH    02342000
*                                      ?                             */ 02343000
         LTR   NEXTLE,NEXTLE                                       0432 02344000
         BZ    @RF00432                                            0432 02345000
*             DO;                                                  0433 02346000
*                                                                  0433 02347000
*               /*****************************************************/ 02348000
*               /*                                                   */ 02349000
*               /* OBTAIN ADDRESS OF LAST NODE ON THE                */ 02350000
*               /* DAUGHTER-GT-NODE LE LEG AND CHAIN THE             */ 02351000
*               /* DAUGHTER-LE-NODE TO IT                            */ 02352000
*               /*                                                   */ 02353000
*               /*****************************************************/ 02354000
*                                                                  0434 02355000
*/*           N GET ADDR OF LAST NODE ON DAUGHTER GT NODE'S LE LEG   */ 02356000
*/*%RMN55:    D (YES,,NO,%RMN60) ANOTHER NODE DOWN LE LEG ?          */ 02357000
*/*           P MOVE DOWN LE LEG ONE NODE                            */ 02358000
*/*           N (,%RMN55) END LOOP TO MOVE DOWN TO END OF LE LEG     */ 02359000
*                                                                  0434 02360000
*               THISNODE=NEXTGT;    /* RESET THISNODE FOR LE SCAN    */ 02361000
         LR    THISNODE,NEXTGT                                     0434 02362000
*               DO WHILE THISNODE->IOENXTLE^=ZERO;/* GO TO LAST NODE */ 02363000
         B     @DE00435                                            0435 02364000
@DL00435 DS    0H                                                  0436 02365000
*                 THISNODE=THISNODE->IOENXTLE;/* DOWN LE PATH 1 NODE */ 02366000
         L     THISNODE,IOENXTLE(,THISNODE)                        0436 02367000
*               END;                                               0437 02368000
*                                                                  0437 02369000
@DE00435 L     @11,IOENXTLE(,THISNODE)                             0437 02370000
         LTR   @11,@11                                             0437 02371000
         BNZ   @DL00435                                            0437 02372000
*/*%RMN60:    P (,%RMN80) RECHAIN DAUGHTER LE NODE TO LAST NODE ON LE   02373000
*/*                       LEG                                        */ 02374000
*                                                                  0438 02375000
*               THISNODE->IOENXTLE=NEXTLE;/* RESET END NODE LE LEG   */ 02376000
         ST    NEXTLE,IOENXTLE(,THISNODE)                          0438 02377000
*               NEXTLE->IOEBKPTR=THISNODE;/* RESET BACKWARD PTR      */ 02378000
         ST    THISNODE,IOEBKPTR(,NEXTLE)                          0439 02379000
*             END;                  /* END NODE-DOWN-LE-&-GT-PATHS   */ 02380000
*           ELSE                                                   0441 02381000
*             ;                     /* NODE DOWN GT BUT NOT LE ?     */ 02382000
@RF00432 DS    0H                                                  0442 02383000
*         END;                      /* END NODE-DOWN-GT-PATH         */ 02384000
*       ELSE                        /* NO NODE DOWN GT PATH ?        */ 02385000
*                                                                  0443 02386000
*         /***********************************************************/ 02387000
*         /*                                                         */ 02388000
*         /* IF NO NODE IS HANGING ON THE GT LEG FROM THE TARGET NODE*/ 02389000
*         /* THEN SIMPLY RECHAIN THE NODE HANGING ON THE LE PATH, IF */ 02390000
*         /* ANY, TO THE TARGET'S ANCESTOR                           */ 02391000
*         /*                                                         */ 02392000
*         /***********************************************************/ 02393000
*                                                                  0443 02394000
*/*%RMN70:    N RCHAINUP CHAINS DAUGHTER LE NODE TO TARGET ANCESTOR  */ 02395000
*/*           S (,%RMN80) RCHAINUP: RECHAIN DAUGHTER LE NODE         */ 02396000
*                                                                  0443 02397000
*         DO;                                                      0443 02398000
         B     @RC00428                                            0443 02399000
@RF00428 DS    0H                                                  0444 02400000
*           NEXTNODE=NEXTLE;        /* PRESET NEXTNODE FOR REMOVE    */ 02401000
         LR    NEXTNODE,NEXTLE                                     0444 02402000
*           CALL RCHAINUP;          /* REMOVE NODE, RECHAIN LE LEG   */ 02403000
         BAL   @14,RCHAINUP                                        0445 02404000
*         END;                      /* END NODE-DOWN-LE-BUT-NOT-GT   */ 02405000
*     END;                          /* END IOE-HUNG-ON-LE-PATH       */ 02406000
@RC00428 DS    0H                                                  0448 02407000
*/*%RMN80:    R RETURN                                               */ 02408000
*                                                                  0448 02409000
*   RFY                                                            0448 02410000
*     R14 RSTD;                                                    0448 02411000
@RC00405 DS    0H                                                  0449 02412000
*   R14=RETADDR3;                   /* RESTORE RETURN ADDRESS        */ 02413000
         L     R14,RETADDR3                                        0449 02414000
*   RFY                                                            0450 02415000
*     R14 UNRSTD;                                                  0450 02416000
*   END REMVNODE;                   /* END SUBROUTINE REMVNODE       */ 02417000
@EL00013 DS    0H                                                  0451 02418000
@EF00013 DS    0H                                                  0451 02419000
@ER00013 BR    @14                                                 0451 02420000
*/*REMVNODE: END                                                     */ 02421000
*                                                                  0452 02422000
*                                                                  0452 02423000
*/*RCHAINUP: CHART                                                   */ 02424000
*/* HEADING                                                        0452 02425000
*/* ILRSRT - ASM SLOT SORT                                         0452 02426000
*/*RCHAINUP: RECHAIN NODE UPWARD ONE NODE IN TREE                    */ 02427000
*/********************************************************************/ 02428000
*/*                                                                  */ 02429000
*/*      RCHAINUP:  RECHAIN NODE, WHOSE ANCESTOR IS BEING REMOVED    */ 02430000
*/*                 FROM THE TREE, TO ITS ANCESTOR'S ANCESTOR        */ 02431000
*/*                                                                  */ 02432000
*/*      INPUT: - ADDRESS OF NODE TO BE RECHAINED                    */ 02433000
*/*             - ADDRESS OF NODE TO WHICH IT IS TO BE CHAINED       */ 02434000
*/*             - PART ENTRY                                         */ 02435000
*/*                                                                  */ 02436000
*/*      PROCESS: THE ADDRESS OF THE NODE TO BE RECHAINED IS PLACED  */ 02437000
*/*               INTO THE APPROPRIATE LEG POINTER OF THE NEW ANCES- */ 02438000
*/*               TOR NODE. IF THE NEW ANCESTOR IS NON-EXISTANT, IE. */ 02439000
*/*               THIS NODE WILL BECOME THE NEW TOP NODE IN THE TREE,*/ 02440000
*/*               THE PART ENTRY TREE ANCHOR POINTER IS RESET. THE   */ 02441000
*/*               BACKWARD POINTER IN THE NODE TO BE RECHAINED IS    */ 02442000
*/*               SET TO ADDRESS THE NEW ANCESTOR (SET TO ZERO IF    */ 02443000
*/*               NO ANCESTOR EXISTS). IF THE TARGET NODE THAT IS    */ 02444000
*/*               BEING REMOVED FROM THE TREE WAS THE TOP NODE OF A  */ 02445000
*/*               READ CYLINDER GROUP THE TOP NODE POINTER IS RESET  */ 02446000
*/*               TO ADDRESS THIS NODE BEING RECHAINED.              */ 02447000
*/*                                                                  */ 02448000
*/*      OUTPUT: - UPDATED POINTERS IN RECHAINED NODE AND IT NEW     */ 02449000
*/*                ANCESOTR                                          */ 02450000
*/*              - UPDATED PART ENTRY TREE ANCHOR POINTER IN SOME    */ 02451000
*/*               CASES                                              */ 02452000
*/*              - UPDATED TOP NODE IN READ CYLINDER GROUP POINTER IN*/ 02453000
*/*                SOME CASES                                        */ 02454000
*/*                                                                  */ 02455000
*/********************************************************************/ 02456000
*/*RCHAINUP: E RECHAIN NODE UP IN TREE                               */ 02457000
*                                                                  0452 02458000
*RCHAINUP:                                                         0452 02459000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0452 02460000
RCHAINUP DS    0H                                                  0453 02461000
*   RFY                                                            0453 02462000
*     R14 RSTD;                     /* RESTRICT RETURN REGISTER      */ 02463000
*                                                                  0453 02464000
*   /*****************************************************************/ 02465000
*   /*                                                               */ 02466000
*   /* IF THE TARGET NODE BEING REMOVED FROM THE TREE IS THE TOP NODE*/ 02467000
*   /* OF THE TREE, SIMPLY RESET THE PART ENTRY ANCHOR POINTER TO THE*/ 02468000
*   /* NEXT NODE CHOSEN BY REMVNODE. OTHERWISE, CHAIN THE NEXT NODE  */ 02469000
*   /* TO THE APPROPRIATE LEG OF THE TARGET NODE'S ANCESTOR          */ 02470000
*   /*                                                               */ 02471000
*   /*****************************************************************/ 02472000
*                                                                  0454 02473000
*/*           D (NO,,YES,%RCU40) TARGET IOE AT TOP OF TREE ?         */ 02474000
*                                                                  0454 02475000
*   IF LASTNODE^=ZERO THEN          /* NOT AT TOP OF TREE ?          */ 02476000
         LTR   LASTNODE,LASTNODE                                   0454 02477000
         BZ    @RF00454                                            0454 02478000
*     DO;                                                          0455 02479000
*                                                                  0455 02480000
*/*           D (YES,,NO,%RCU20) TARGET IOE ON ANCESTORS GT LEG ?    */ 02481000
*                                                                  0456 02482000
*       IF LASTNODE->IOENXTGT=IOEPTR THEN/* IOE HUNG ON GT LEG ?     */ 02483000
         C     IOEPTR,IOENXTGT(,LASTNODE)                          0456 02484000
         BNE   @RF00456                                            0456 02485000
*/*        P (,%RCU40) RECHAIN NEXT NODE TO TARGET ANCESTORS GT LEG  */ 02486000
*                                                                  0457 02487000
*         LASTNODE->IOENXTGT=NEXTNODE;/* RESET NEXTNODE GT LEG       */ 02488000
         ST    NEXTNODE,IOENXTGT(,LASTNODE)                        0457 02489000
*       ELSE                        /* IOE HUNG ON LE LEG ?          */ 02490000
*/*%RCU20: P (,%RCU40) RECHAIN NEXT NODE TO TARGET ANCESTORS LE LEG  */ 02491000
*                                                                  0458 02492000
*         LASTNODE->IOENXTLE=NEXTNODE;/* RESET NEXTNODE LE LEG       */ 02493000
         B     @RC00456                                            0458 02494000
@RF00456 ST    NEXTNODE,IOENXTLE(,LASTNODE)                        0458 02495000
*     END;                                                         0459 02496000
*   ELSE                            /* AT TOP OF TREE ?              */ 02497000
*/*%RCU30:    P RECHAIN NEXT NODE TO PART ENTRY TREE ANCHOR          */ 02498000
*                                                                  0460 02499000
*     PARENODE=NEXTNODE;            /* RESET TREE ANCHOR             */ 02500000
*                                                                  0460 02501000
         B     @RC00454                                            0460 02502000
@RF00454 L     @15,PAREPTR                                         0460 02503000
         ST    NEXTNODE,PARENODE(,@15)                             0460 02504000
*   /*****************************************************************/ 02505000
*   /*                                                               */ 02506000
*   /* IF THE NEXT NODE ACTUALLY EXISTS (THE POINTER MAY BE ZERO)    */ 02507000
*   /* THEN RESET ITS BACKWARD POINTER                               */ 02508000
*   /*                                                               */ 02509000
*   /*****************************************************************/ 02510000
*                                                                  0461 02511000
*/*%RCU40:    D (NO,,YES,%RCU50) NEXT NODE POINTER ZERO ?            */ 02512000
*                                                                  0461 02513000
*   IF NEXTNODE^=ZERO THEN                                         0461 02514000
*                                                                  0461 02515000
@RC00454 LTR   NEXTNODE,NEXTNODE                                   0461 02516000
         BZ    @RF00461                                            0461 02517000
*/*           P RESET BACKWARD POINTER IN NEXT NODE TO NEW ANCESTOR  */ 02518000
*                                                                  0462 02519000
*     NEXTNODE->IOEBKPTR=LASTNODE;  /* RE-BACKWARD CHAIN NEXTNODE    */ 02520000
         ST    LASTNODE,IOEBKPTR(,NEXTNODE)                        0462 02521000
*   ELSE                                                           0463 02522000
*     ;                                                            0463 02523000
*                                                                  0463 02524000
@RF00461 DS    0H                                                  0464 02525000
*   /*****************************************************************/ 02526000
*   /*                                                               */ 02527000
*   /* IF THE IOE JUST REMOVED FROM THE TREE IS THE FIRST IOE IN A   */ 02528000
*   /* GROUP (1 OR MORE) OF IOES FOR READS FROM A SPECIFIC CYLINDER, */ 02529000
*   /* THEN RESET THE TOP-READ-IOE PTR FOR THE GROUP                 */ 02530000
*   /*                                                               */ 02531000
*   /*****************************************************************/ 02532000
*                                                                  0464 02533000
*/*%RCU50:    D (YES,,NO,%RCU80) TARGET IOE TOP READ FOR CYL ?       */ 02534000
*/*           P RESET TOP READ-CYL IOE POINTER TO THE NEXT NODE      */ 02535000
*                                                                  0464 02536000
*   IF IOEPTR=TOPRDIOE THEN         /* JUST REMOVED TOP READ REQ FROM   02537000
*                                      TREE FOR CURRENT CYL ?        */ 02538000
         C     IOEPTR,TOPRDIOE                                     0464 02539000
         BNE   @RF00464                                            0464 02540000
*     TOPRDIOE=NEXTNODE;            /* RESET PTR TO TOP READ IOE     */ 02541000
         ST    NEXTNODE,TOPRDIOE                                   0465 02542000
*   ELSE                                                           0466 02543000
*     ;                                                            0466 02544000
*                                                                  0466 02545000
@RF00464 DS    0H                                                  0467 02546000
*/*           L **** FRR **** IOE BEING REMOVED FROM TREE            */ 02547000
*                                                                  0467 02548000
*   EPAIOEIP=IOEPTR;                /* TELL RECOV CURRENT IOE        */ 02549000
         ST    IOEPTR,EPAIOEIP(,EPAPTR)                            0467 02550000
*/*%RCU80:    R RETURN                                               */ 02551000
*                                                                  0468 02552000
*   RFY                                                            0468 02553000
*     R14 UNRSTD;                   /* RELEASE RETURN REGISTER       */ 02554000
*   END RCHAINUP;                   /* END SUBROUTINE RCHAINUP       */ 02555000
@EL00014 DS    0H                                                  0469 02556000
@EF00014 DS    0H                                                  0469 02557000
@ER00014 BR    @14                                                 0469 02558000
*/*RCHAINUP: END                                                     */ 02559000
*                                                                  0470 02560000
*                                                                  0470 02561000
*/*GETPCCW: CHART                                                    */ 02562000
*/* HEADING                                                        0470 02563000
*/* ILRSRT - ASM SLOT SORT                                         0470 02564000
*/*                             GET A PCCW FROM ASMVT QUEUE          */ 02565000
*/********************************************************************/ 02566000
*/*                                                                  */ 02567000
*/*      GETPCCW:  GET A PCCW FROM THE ASMVT QUEUE                   */ 02568000
*/*                                                                  */ 02569000
*/*      INPUT: - PARAMETER LIST FROM ILRPMT00                       */ 02570000
*/*             - ASMVT                                              */ 02571000
*/*                                                                  */ 02572000
*/*      PROCESS: VIA C&S A PCCW IS REMOVED FROM THE ASMVT PCCW      */ 02573000
*/*               AVAILABLE QUEUE AND ITS ADDRESS STORED IN THE PART */ 02574000
*/*               MONITOR PARAMETER LIST                             */ 02575000
*/*                                                                  */ 02576000
*/*      OUTPUT: - UPDATED PART MONITOR PARAMETER LIST               */ 02577000
*/*              - PCCW IF ANY AVAILABLE                             */ 02578000
*/*              - STOP INDICATOR SET IF NO PCCW AVAILABLE           */ 02579000
*/*                                                                  */ 02580000
*/********************************************************************/ 02581000
*/*GETPCCW:   E GET A PCCW FROM THE ASMVT QUEUE                      */ 02582000
*                                                                  0470 02583000
*GETPCCW:                                                          0470 02584000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0470 02585000
GETPCCW  DS    0H                                                  0471 02586000
*   RFY                                                            0471 02587000
*     R14 RSTD;                                                    0471 02588000
*   RETADDR3=R14;                   /* SAVE RETURN ADDR TO MAINLINE  */ 02589000
         ST    R14,RETADDR3                                        0472 02590000
*/*           P SET POINTER TO NEXT PCCW ON ASMVT QUEUE              */ 02591000
*                                                                  0473 02592000
*   RFY                                                            0473 02593000
*    (R15) RSTD;                                                   0473 02594000
*   LM(R14,R15,ASMPCCWQ);                                          0474 02595000
*                                                                  0474 02596000
         LM    R14,R15,ASMPCCWQ(ASMVTPTR)                          0474 02597000
*/*IBCLOOP:   D (YES,,NO,%GBC70) ANY MORE PCCWS ?                    */ 02598000
*                                                                  0475 02599000
*IBCLOOP:                                                          0475 02600000
*   IF R14^=ZERO THEN                                              0475 02601000
IBCLOOP  LTR   R14,R14                                             0475 02602000
         BZ    @RF00475                                            0475 02603000
*     DO;                                                          0476 02604000
*                                                                  0476 02605000
*/*           P REMOVE A PCCW FROM QUEUE (C&S)                       */ 02606000
*                                                                  0477 02607000
*       RFY                                                        0477 02608000
*        (R0,                                                      0477 02609000
*         R1) RSTD;                                                0477 02610000
*       R0=R14->PCCWPCCW;           /* SET PTR TO NEXT PCCW          */ 02611000
         L     R0,PCCWPCCW(,R14)                                   0478 02612000
*       R1=R15-ONE;                 /* DECREMENT PCCW QUEUE CNT      */ 02613000
         LR    R1,R15                                              0479 02614000
         BCTR  R1,0                                                0479 02615000
*       CDS(R14,R0,ASMPCCWQ);       /* REMOVE A PCCW FROM QUEUE      */ 02616000
         CDS   R14,R0,ASMPCCWQ(ASMVTPTR)                           0480 02617000
*/*           D (YES,%GBC90,NO,IBCLOOP) SUCCESSFUL ?                 */ 02618000
*                                                                  0481 02619000
*       BC(NE,IBCLOOP);             /* IF UNSUCCESSFUL, TRY AGAIN    */ 02620000
         BC    7,IBCLOOP                                           0481 02621000
*       PTRPCCW=R14;                /* SAVE PTR TO NEXT PCCW         */ 02622000
         L     @12,PRMLADDR                                        0482 02623000
         ST    R14,PTRPCCW(,@12)                                   0482 02624000
*     END;                                                         0483 02625000
*   ELSE                                                           0484 02626000
*                                                                  0484 02627000
*/*%GBC70:    P  SET FLAG TO STOP PROCESSING REQUESTS                */ 02628000
*                                                                  0484 02629000
*     STOP=YES;                     /* NO MORE REQUESTS MAY BE     0484 02630000
*                                      PROCESSED                     */ 02631000
         B     @RC00475                                            0484 02632000
@RF00475 OI    STOP,B'10000000'                                    0484 02633000
*   RFY                                                            0485 02634000
*    (R0,                                                          0485 02635000
*     R1,                                                          0485 02636000
*     R15) UNRSTD;                                                 0485 02637000
*                                                                  0485 02638000
@RC00475 DS    0H                                                  0486 02639000
*/*%GBC90:   R RETURN                                                */ 02640000
*                                                                  0486 02641000
*   R14=RETADDR3;                   /* RESTORE RETURN ADDRESS        */ 02642000
         L     R14,RETADDR3                                        0486 02643000
*   RFY                                                            0487 02644000
*     R14 UNRSTD;                                                  0487 02645000
*   END GETPCCW;                                                   0488 02646000
*                                                                  0488 02647000
@EL00015 DS    0H                                                  0488 02648000
@EF00015 DS    0H                                                  0488 02649000
@ER00015 BR    @14                                                 0488 02650000
*/*GETPCCW: END                                                      */ 02651000
*                                                                  0489 02652000
*                                                                  0489 02653000
*/*IOCHAIN:   CHART                                                  */ 02654000
*/* HEADING                                                        0489 02655000
*/* ILRSRT - ASM SLOT SORT                                         0489 02656000
*/*                     IOCHAIN ROUTINE - MOVE REQUEST TO IORB CHAIN */ 02657000
*/********************************************************************/ 02658000
*/*                                                                  */ 02659000
*/*      IOCHAIN: CHAIN PCCW TO IORB I/O REQUEST QUEUE               */ 02660000
*/*                                                                  */ 02661000
*/*      INPUT: PCCWPTR POINTING TO REQUEST SELECTED,                */ 02662000
*/*                LASTP POINTING TO LAST PCCW CHAINED TO IORB       */ 02663000
*/*                                                                  */ 02664000
*/*      PROCESS: PCCW FOR THE REQUEST IS PLACED ON THE CHAIN FROM   */ 02665000
*/*               IORB. THE ADDRESS OF THE PCCW IS SAVED SO THAT     */ 02666000
*/*               ANY FURTHER PCCWS MAY BE CHAINED TO IT.            */ 02667000
*/*               PCCW INITIALIZED AND CHAINED TO PREVIOUS PCCW      */ 02668000
*/*                                                                  */ 02669000
*/*      OUTPUT: - PCCW CHAINED TO IORB                              */ 02670000
*/*              - PCCW INITIALIZED FOR READ/WRITE                   */ 02671000
*/*              - ADDRESS OF LAST CHAINED PCCW SAVED                */ 02672000
*/*                                                                  */ 02673000
*/********************************************************************/ 02674000
*/*IOCHAIN:   E INIT + CHAIN PCCW TO IORB                            */ 02675000
*                                                                  0489 02676000
*IOCHAIN:                                                          0489 02677000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0489 02678000
IOCHAIN  DS    0H                                                  0490 02679000
*   RFY                                                            0490 02680000
*     R14 RSTD;                     /* RESTRICT RETURN REG           */ 02681000
*   RETADDR3=R14;                   /* SAVE RETURN ADDRESS           */ 02682000
         ST    R14,RETADDR3                                        0491 02683000
*   RFY                                                            0492 02684000
*     R14 UNRSTD;                                                  0492 02685000
*                                                                  0492 02686000
*/*INITPCCW:  N INITIALIZE A PCCW                                    */ 02687000
*/* P SET IORB ADDR                                                  */ 02688000
*/* P TURN OFF ERROR FLAGS                                           */ 02689000
*/* P INIT BUFFER ADDRESS                                            */ 02690000
*/* P INITIALIZE AIA PTR                                             */ 02691000
*/*%IBC10: D (NO,,YES,%IBC40) READ REQUEST?                          */ 02692000
*/*%IBC60: P (,%IBC90) SET WRITE INDICATOR                           */ 02693000
*/*%IBC40: P SET READ FLAG                                           */ 02694000
*/*%IBC90:   N INITPCCW COMPLETE                                     */ 02695000
*/* P ZERO NEXT-PCCW PTR IN CURRENT PCCW FOR RECOVERY                */ 02696000
*/* P UPDATE NUMBER OF PCCWS                                         */ 02697000
*/* P SET UP FOR ILRCNVRT MACRO                                      */ 02698000
*/* S ILRCNVRT: CONVERT RBA TO MBBCCHHR                              */ 02699000
*/* D (YES,,NO,%IBC200) CONVERT OK?                                  */ 02700000
*/* D (YES,,NO,%IBC50) FIRST PCCW?                                   */ 02701000
*/* P SET UP IOSB FIELDS- IOSEEK IOSRST IOSVST IOSEEKA               */ 02702000
*/* P INDICATE SKIP SEEK                                             */ 02703000
*/* D (YES,%IBC70,NO,) RPS DEVICE?                                   */ 02704000
*/* P (,%IBC66) INDICATE SKIP SET SECTOR IOSRST                      */ 02705000
*/*%IBC70: P INDICATE DO SET SECTOR IOSRST                           */ 02706000
*/* P SET UP SECTOR VALUE                                            */ 02707000
*/*%IBC66: P SET IOSVST TO IOSRST                                    */ 02708000
*/*%IBC99:  P SET UP PREV CYL, TRK, REC                              */ 02709000
*/*%IBC100: R RETURN                                                 */ 02710000
*/*%IBC50: P CHAIN PCCW TO PREVIOUS PCCW                             */ 02711000
*/* D (YES,,NO,%IBC52) SAME CYLINDER AS LAST TIME?                   */ 02712000
*/* D (YES,,NO,%IBC53) SAME TRACK AS LAST TIME?                      */ 02713000
*/* P INDICATE SKIP SEEK                                             */ 02714000
*/*%IBC55: D (YES,,NO,%IBC57) RPS DEVICE?                            */ 02715000
*/* D (YES,,NO,%IBC57) CAN WE DO SET SECTOR?                         */ 02716000
*/* P SET UP SET SECTOR CCW                                          */ 02717000
*/* P (,%IBC99) INDICATE DOING SET SECTOR                            */ 02718000
*/*%IBC52: P (,%IBC69) SET UP SEEK CYLINDER                          */ 02719000
*/*%IBC57: P (,%IBC99) CHANGE SET SECTOR TO TIC                      */ 02720000
*/*%IBC69: D (YES,,NO,%IBC55) RPS DEVICE?                            */ 02721000
*/* P  (,%IBC55) INDICATE DOING SET SECTOR                           */ 02722000
*/*%IBC53: P (,%IBC55) SET UP SEEK HEAD                              */ 02723000
*/*%IBC200: R ABEND X'083'                                           */ 02724000
*/*IOCHAIN:   END                                                    */ 02725000
*                                                                  0493 02726000
*   AIAPTR=IOEAIA;                  /* GET ADDRESS OF AIA            */ 02727000
         L     AIAPTR,IOEAIA(,IOEPTR)                              0493 02728000
*   IORBPTR=PTRIORB;                /* ADDR OF IORB                  */ 02729000
         L     @11,PRMLADDR                                        0494 02730000
         L     @07,PTRIORB(,@11)                                   0494 02731000
         ST    @07,IORBPTR                                         0494 02732000
*   RESPECIFY                                                      0495 02733000
*     IORB BASED(IORBPTR);                                         0495 02734000
*   PCCWPTR=PTRPCCW;                /* WORK WITH NEW PCCW            */ 02735000
         L     PCCWPTR,PTRPCCW(,@11)                               0496 02736000
*   IOEAIA=0;                       /* ZERO FOR RECOVERY     @ZA28762*/ 02737000
         SLR   @11,@11                                             0497 02738000
         ST    @11,IOEAIA(,IOEPTR)                                 0497 02739000
*   PCCWAIA=AIAPTR;                 /* STORE ADDRESS OF AIA  @ZA28762*/ 02740000
         ST    AIAPTR,PCCWAIA(,PCCWPTR)                            0498 02741000
*   PCCWIORB=IORBPTR;               /* ADDRESS OF ASSOCIATED IORB    */ 02742000
         ST    @07,PCCWIORB(,PCCWPTR)                              0499 02743000
*   PCCWFERR=BITOFF;                /* INDICATE NO ERROR             */ 02744000
         NI    PCCWFERR(PCCWPTR),B'01111111'                       0500 02745000
*   PCBPTR=AIAPTR-(LENGTH(PCB)-LENGTH(AIA));/* ADDRESS PAGE CONTROL     02746000
*                                      BLOCK                         */ 02747000
         LR    PCBPTR,AIAPTR                                       0501 02748000
         SL    PCBPTR,@CF01189                                     0501 02749000
*   RFY                                                            0502 02750000
*     R7 RSTD;                                                     0502 02751000
*   R7=PCBRBN;                      /* STORE REAL BLK NBR            */ 02752000
         LH    R7,PCBRBN(,PCBPTR)                                  0503 02753000
         N     R7,@CF02144                                         0503 02754000
*   SLL(R7,8);                      /* CONVERT RBN TO REAL ADDRESS   */ 02755000
         SLL   R7,8                                                0504 02756000
*   PCCWADDR=R7;                    /* PLACE IN PCCW                 */ 02757000
         STCM  R7,7,PCCWADDR(PCCWPTR)                              0505 02758000
*   RFY                                                            0506 02759000
*     R7 UNRSTD;                                                   0506 02760000
*   IF AIAWRITE=OFF THEN            /* READ REQUEST ?                */ 02761000
         TM    AIAWRITE(AIAPTR),B'10000000'                        0507 02762000
         BNZ   @RF00507                                            0507 02763000
*     PCCWRDWT=READOP;              /* INDICATE READ REQUEST         */ 02764000
         MVI   PCCWRDWT(PCCWPTR),X'06'                             0508 02765000
*   ELSE                            /* NOT READ                      */ 02766000
*     PCCWRDWT=WRITEOP;             /* INDICATE WRITE REQUESTED      */ 02767000
         B     @RC00507                                            0509 02768000
@RF00507 MVI   PCCWRDWT(PCCWPTR),X'05'                             0509 02769000
*   PCCWPCCW=ZERO;                  /* SET END OF CHAIN FOR RECOVERY */ 02770000
@RC00507 SLR   @11,@11                                             0510 02771000
         ST    @11,PCCWPCCW(,PCCWPTR)                              0510 02772000
*   RFY                                                            0511 02773000
*    (R0,                                                          0511 02774000
*     R1,                                                          0511 02775000
*     R15) RSTD;                                                   0511 02776000
*   R0=PAREEDBP;                    /* SET EDB HEADER ADDRESS        */ 02777000
         L     @14,PAREPTR                                         0512 02778000
         L     R0,PAREEDBP(,@14)                                   0512 02779000
*   PCCWCHHR(1:4)=TSLOTNBR*PAGESZ;  /* SET UP RBA FOR CNVT           */ 02780000
         L     @14,TSLOTNBR                                        0513 02781000
         SLA   @14,12                                              0513 02782000
         STCM  @14,15,PCCWCHHR(PCCWPTR)                            0513 02783000
*   R1=ADDR(PCCWCHHR);              /* AREA TO CONVERT INTO          */ 02784000
         LA    R1,PCCWCHHR(,PCCWPTR)                               0514 02785000
*   CALL ILRCNVRT;                  /* CONVERT THE RBA               */ 02786000
         BAL   @14,ILRCNVRT                                        0515 02787000
*   IF R15^=ZERO                    /* CONVERT GO OK?                */ 02788000
*     THEN                                                         0516 02789000
         LTR   R15,R15                                             0516 02790000
         BZ    @RF00516                                            0516 02791000
*     DO;                           /* NO, ISSUE ABEND               */ 02792000
*       RFY                                                        0518 02793000
*         R1 RSTD;                                                 0518 02794000
*       GEN( ABEND X'083',,,SYSTEM);/* EDB ERROR                     */ 02795000
          ABEND X'083',,,SYSTEM                                         02796000
*       RFY                                                        0520 02797000
*         R1 UNRSTD;                                               0520 02798000
*     END;                                                         0521 02799000
*                                                                  0521 02800000
*   /*****************************************************************/ 02801000
*   /*                                                               */ 02802000
*   /* CONVERT DONE SUCCESSFULLY                                     */ 02803000
*   /*                                                               */ 02804000
*   /*****************************************************************/ 02805000
*                                                                  0522 02806000
*   RFY                                                            0522 02807000
*    (R0,                                                          0522 02808000
*     R1,                                                          0522 02809000
*     R15) UNRSTD;                                                 0522 02810000
@RF00516 DS    0H                                                  0523 02811000
*   PCTPTR=PAREPCTP;                /* ADDR OF PCT                   */ 02812000
         L     @01,PAREPTR                                         0523 02813000
         L     PCTPTR,PAREPCTP(,@01)                               0523 02814000
*   RESPECIFY                                                      0524 02815000
*     PCT BASED(PCTPTR);                                           0524 02816000
*   IORBPTR=PTRIORB;                /* ADDR OF IORB                  */ 02817000
         L     @01,PRMLADDR                                        0525 02818000
         L     @15,PTRIORB(,@01)                                   0525 02819000
         ST    @15,IORBPTR                                         0525 02820000
*   RESPECIFY                                                      0526 02821000
*     IORB BASED(IORBPTR);                                         0526 02822000
*   IOSBPTR=IORIOSB;                /* ADDR OF IOSB                  */ 02823000
         L     IOSBPTR,IORIOSB(,@15)                               0527 02824000
*   RESPECIFY                                                      0528 02825000
*     IOSB BASED(IOSBPTR);                                         0528 02826000
*   SSECN=SSLOT//PCTSSECN;          /* UNIQUE RELATIVE SLOT NUM      */ 02827000
         L     @00,SSLOT                                           0529 02828000
         SRDA  @00,32                                              0529 02829000
         LH    @14,PCTSSECN(,PCTPTR)                               0529 02830000
         DR    @00,@14                                             0529 02831000
         ST    @00,SSECN                                           0529 02832000
*   NUMREQS=NUMREQS+ONE;            /* UPDATE NUMBER PCCWS           */ 02833000
         LA    @14,1                                               0530 02834000
         AL    @14,NUMREQS                                         0530 02835000
         ST    @14,NUMREQS                                         0530 02836000
*   SEEK=BITOFF;                    /* INITIALIZE SEEK IND           */ 02837000
*   SETSEC=BITOFF;                  /* INITIALIZE SET SECTOR IND     */ 02838000
         NI    SEEK,B'10011111'                                    0532 02839000
*   IF LASTP=ZERO                   /* FIRST PCCW?                   */ 02840000
*     THEN                                                         0533 02841000
         L     @14,LASTP                                           0533 02842000
         LTR   @14,@14                                             0533 02843000
         BNZ   @RF00533                                            0533 02844000
*     DO;                           /* YES                           */ 02845000
*       IOSEEK=PCCWCHHR;            /* SET UP SEEK ADDR              */ 02846000
         MVC   IOSEEK(8,IOSBPTR),PCCWCHHR(PCCWPTR)                 0535 02847000
*       IOSEEKA=IOSEEK;                                            0536 02848000
         MVC   IOSEEKA(8,IOSBPTR),IOSEEK(IOSBPTR)                  0536 02849000
*       IF IORFRPS=BITOFF           /* RPS DEVICE?                   */ 02850000
*         THEN                                                     0537 02851000
         TM    IORFRPS(@15),B'01000000'                            0537 02852000
         BNZ   @RF00537                                            0537 02853000
*         DO;                       /* NO                            */ 02854000
*           IOSRST=ADDR(PCCWSRCH);  /* SKIP SET SECTOR               */ 02855000
         LA    @15,PCCWSRCH(,PCCWPTR)                              0539 02856000
         ST    @15,IOSRST(,IOSBPTR)                                0539 02857000
*         END;                                                     0540 02858000
*       ELSE                                                       0541 02859000
*         DO;                       /* YES RPS                       */ 02860000
         B     @RC00537                                            0541 02861000
@RF00537 DS    0H                                                  0542 02862000
*           IOSRST=ADDR(PCCWSSEC);  /* START WITH SET SECTOR         */ 02863000
         LA    @15,PCCWSSEC(,PCCWPTR)                              0542 02864000
         ST    @15,IOSRST(,IOSBPTR)                                0542 02865000
*           PCCWSECT=PCTSECNM(SSECN+1);                            0543 02866000
*                                                                  0543 02867000
         L     @15,SSECN                                           0543 02868000
         SLA   @15,2                                               0543 02869000
         SLR   @14,@14                                             0543 02870000
         IC    @14,PCTSECNM(@15,PCTPTR)                            0543 02871000
         STC   @14,PCCWSECT(,PCCWPTR)                              0543 02872000
*           /*********************************************************/ 02873000
*           /*                                                       */ 02874000
*           /* SET UP SECTOR NUMBER                                  */ 02875000
*           /*                                                       */ 02876000
*           /*********************************************************/ 02877000
*                                                                  0544 02878000
*           PCCWSSAD=ADDR(PCCWSECT);/* ADDR OF SEC NUM               */ 02879000
         LA    @15,PCCWSECT(,PCCWPTR)                              0544 02880000
         STCM  @15,7,PCCWSSAD(PCCWPTR)                             0544 02881000
*           PCCWSS=SETSECOP;        /* SET SECTOR OP CODE            */ 02882000
         MVI   PCCWSS(PCCWPTR),X'23'                               0545 02883000
*         END;                                                     0546 02884000
*       IOSVST=IOSRST;              /* V=R STORAGE                   */ 02885000
@RC00537 L     @15,IOSRST(,IOSBPTR)                                0547 02886000
         ST    @15,IOSVST(,IOSBPTR)                                0547 02887000
*     END;                                                         0548 02888000
*   ELSE                                                           0549 02889000
*     DO;                           /* NOT FIRST PCCW                */ 02890000
         B     @RC00533                                            0549 02891000
@RF00533 DS    0H                                                  0550 02892000
*       LASTP->PCCWPCCW=PCCWPTR;    /* CHAIN PCCWS                   */ 02893000
         L     @05,LASTP                                           0550 02894000
         ST    PCCWPTR,PCCWPCCW(,@05)                              0550 02895000
*       IF LASTCYL^=PCCWCC          /* SAME CYLINDER AS LAST?        */ 02896000
*         THEN                                                     0551 02897000
         L     @05,LASTCYL                                         0551 02898000
         SLR   @15,@15                                             0551 02899000
         ICM   @15,3,PCCWCC(PCCWPTR)                               0551 02900000
         CR    @05,@15                                             0551 02901000
         BE    @RF00551                                            0551 02902000
*         DO;                       /* NO,                           */ 02903000
*           PCCWSK=SEEKCYL;         /* SET UP SEEK CYL               */ 02904000
         MVI   PCCWSK(PCCWPTR),X'0B'                               0553 02905000
*           SEEK=BITON;             /* INDICATE DOING SEEK           */ 02906000
         OI    SEEK,B'01000000'                                    0554 02907000
*           IF IORFRPS=BITON THEN   /* FOR RPS DEVICES               */ 02908000
         L     @05,IORBPTR                                         0555 02909000
         TM    IORFRPS(@05),B'01000000'                            0555 02910000
         BNO   @RF00555                                            0555 02911000
*             SETSEC=BITON;         /* ALWAYS DO SET SECTOR IF SEEK     02912000
*                                      CYL                           */ 02913000
         OI    SETSEC,B'00100000'                                  0556 02914000
*         END;                                                     0557 02915000
*       ELSE                                                       0558 02916000
*         IF LASTTRK^=PCCWHH        /* SAME TRACK AS LAST?           */ 02917000
*           THEN                                                   0558 02918000
         B     @RC00551                                            0558 02919000
@RF00551 L     @05,LASTTRK                                         0558 02920000
         SLR   @15,@15                                             0558 02921000
         ICM   @15,3,PCCWHH(PCCWPTR)                               0558 02922000
         CR    @05,@15                                             0558 02923000
         BE    @RF00558                                            0558 02924000
*           DO;                     /* NO,                           */ 02925000
*             PCCWSK=SEEKHD;        /* SET UP SEEK HEAD              */ 02926000
         MVI   PCCWSK(PCCWPTR),X'1B'                               0560 02927000
*             SEEK=BITON;           /* INDICATE DOING SEEK           */ 02928000
         OI    SEEK,B'01000000'                                    0561 02929000
*           END;                                                   0562 02930000
*         ELSE                                                     0563 02931000
*           ;                       /* NOT DOING SEEK                */ 02932000
@RF00558 DS    0H                                                  0564 02933000
*       IF IORFRPS=BITON            /* RPS DEVICE?                   */ 02934000
*         THEN                                                     0564 02935000
@RC00551 L     @05,IORBPTR                                         0564 02936000
         TM    IORFRPS(@05),B'01000000'                            0564 02937000
         BNO   @RF00564                                            0564 02938000
*         DO;                       /* YES, RPS DEVICE               */ 02939000
*           TORBA=PCTTRBA(SSECN+1); /* REL TRK POS OF SLOT           */ 02940000
         L     @15,SSECN                                           0566 02941000
         SLA   @15,2                                               0566 02942000
         ALR   @15,PCTPTR                                          0566 02943000
         SLR   TORBA,TORBA                                         0566 02944000
         ICM   TORBA,3,PCTTRBA(@15)                                0566 02945000
*           CURRBA=PCTTRBA(LASTSLOT+1);/* REL TRK POS OF ARM         */ 02946000
*                                                                  0567 02947000
         L     @07,LASTSLOT                                        0567 02948000
         SLA   @07,2                                               0567 02949000
         ALR   @07,PCTPTR                                          0567 02950000
         SLR   CURRBA,CURRBA                                       0567 02951000
         ICM   CURRBA,3,PCTTRBA(@07)                               0567 02952000
*           /*********************************************************/ 02953000
*           /*                                                       */ 02954000
*           /* IS THIS SLOT PAST THE PREVIOUS SLOT??                 */ 02955000
*           /*                                                       */ 02956000
*           /*********************************************************/ 02957000
*                                                                  0568 02958000
*           IF TORBA>=CURRBA                                       0568 02959000
*                                                                  0568 02960000
*           /*********************************************************/ 02961000
*           /*                                                       */ 02962000
*           /* YES, THEN CALCULATE RELATIVE TRACK POSITION           */ 02963000
*           /*                                                       */ 02964000
*           /*********************************************************/ 02965000
*                                                                  0568 02966000
*             THEN                                                 0568 02967000
         CR    TORBA,CURRBA                                        0568 02968000
         BL    @RF00568                                            0568 02969000
*             RELPOS=TORBA-CURRBA;                                 0569 02970000
*                                                                  0569 02971000
         LR    RELPOS,TORBA                                        0569 02972000
         SLR   RELPOS,CURRBA                                       0569 02973000
*           /*********************************************************/ 02974000
*           /*                                                       */ 02975000
*           /* NO, THEN CALCULATE DISTANCE AROUND THE TRACK          */ 02976000
*           /*                                                       */ 02977000
*           /*********************************************************/ 02978000
*                                                                  0570 02979000
*           ELSE                                                   0570 02980000
*             RELPOS=PCTMAXTK-TORBA+CURRBA;                        0570 02981000
         B     @RC00568                                            0570 02982000
@RF00568 LH    RELPOS,PCTMAXTK(,PCTPTR)                            0570 02983000
         N     RELPOS,@CF02144                                     0570 02984000
         SLR   RELPOS,TORBA                                        0570 02985000
         ALR   RELPOS,CURRBA                                       0570 02986000
*           IF SETSEC=BITON|        /* SET SECTOR FORCED OR          */ 02987000
*               RELPOS>PCTMSSB      /* ENOUGH TIME TO DO SET SECTOR ?*/ 02988000
*             THEN                                                 0571 02989000
@RC00568 TM    SETSEC,B'00100000'                                  0571 02990000
         BO    @RT00571                                            0571 02991000
         LH    @06,PCTMSSB(,PCTPTR)                                0571 02992000
         N     @06,@CF02144                                        0571 02993000
         CR    RELPOS,@06                                          0571 02994000
         BNH   @RF00571                                            0571 02995000
@RT00571 DS    0H                                                  0572 02996000
*             DO;                   /* YES, SHOULD DO SET SECTOR     */ 02997000
*               PCCWSECT=PCTSECNM(SSECN+1);                        0573 02998000
*                                                                  0573 02999000
         L     @05,SSECN                                           0573 03000000
         SLA   @05,2                                               0573 03001000
         SLR   @15,@15                                             0573 03002000
         IC    @15,PCTSECNM(@05,PCTPTR)                            0573 03003000
         STC   @15,PCCWSECT(,PCCWPTR)                              0573 03004000
*               /*****************************************************/ 03005000
*               /*                                                   */ 03006000
*               /* SET UP SECTOR NUMBER                              */ 03007000
*               /*                                                   */ 03008000
*               /*****************************************************/ 03009000
*                                                                  0574 03010000
*               PCCWSSAD=ADDR(PCCWSECT);/* ADDR OF SEC NUM           */ 03011000
         LA    @05,PCCWSECT(,PCCWPTR)                              0574 03012000
         STCM  @05,7,PCCWSSAD(PCCWPTR)                             0574 03013000
*               PCCWSS=SETSECOP;    /* SET SECTOR OP CODE            */ 03014000
         MVI   PCCWSS(PCCWPTR),X'23'                               0575 03015000
*               SETSEC=BITON;       /* INDICATE DOING SET SECTOR     */ 03016000
         OI    SETSEC,B'00100000'                                  0576 03017000
*             END;                                                 0577 03018000
*           ELSE                                                   0578 03019000
*             ;                     /* NO, NO SET SECTOR             */ 03020000
@RF00571 DS    0H                                                  0579 03021000
*         END;                                                     0579 03022000
*       ELSE                                                       0580 03023000
*         ;                         /* NOT DOING SET SECTOR          */ 03024000
@RF00564 DS    0H                                                  0581 03025000
*       LASTP->PCCWN=TICOP;         /* SET UP TIC IN PREVIOUS CCW  0581 03026000
*                                      STRING                        */ 03027000
         L     @05,LASTP                                           0581 03028000
         MVI   PCCWN(@05),X'08'                                    0581 03029000
*       IF SEEK=BITOFF              /* NEED SEEK CCW?                */ 03030000
*         THEN                      /* NO SEEK CCW NEEDED            */ 03031000
         TM    SEEK,B'01000000'                                    0582 03032000
         BNZ   @RF00582                                            0582 03033000
*         IF SETSEC=BITOFF          /* NEED SET SECTOR?              */ 03034000
*                                                                  0583 03035000
*         /***********************************************************/ 03036000
*         /*                                                         */ 03037000
*         /* IF NO SEEK & NO SET SECTOR NEEDED, CHAIN TO SEARCH      */ 03038000
*         /*                                                         */ 03039000
*         /***********************************************************/ 03040000
*                                                                  0583 03041000
*           THEN                                                   0583 03042000
         TM    SETSEC,B'00100000'                                  0583 03043000
         BNZ   @RF00583                                            0583 03044000
*           LASTP->PCCWNAD=ADDR(PCCWSRCH);                         0584 03045000
         LA    @15,PCCWSRCH(,PCCWPTR)                              0584 03046000
         STCM  @15,7,PCCWNAD(@05)                                  0584 03047000
*         ELSE                      /* NO SEEK BUT SET SECTOR        */ 03048000
*                                                                  0585 03049000
*           /*********************************************************/ 03050000
*           /*                                                       */ 03051000
*           /* IF NO SEEK BUT SET SECTOR, CHAIN TO SET SECTOR        */ 03052000
*           /*                                                       */ 03053000
*           /*********************************************************/ 03054000
*                                                                  0585 03055000
*           LASTP->PCCWNAD=ADDR(PCCWSSEC);                         0585 03056000
         B     @RC00583                                            0585 03057000
@RF00583 LA    @05,PCCWSSEC(,PCCWPTR)                              0585 03058000
         L     @01,LASTP                                           0585 03059000
         STCM  @05,7,PCCWNAD(@01)                                  0585 03060000
*       ELSE                                                       0586 03061000
*         DO;                       /* DOING SEEK                    */ 03062000
*                                                                  0586 03063000
         B     @RC00582                                            0586 03064000
@RF00582 DS    0H                                                  0587 03065000
*           /*********************************************************/ 03066000
*           /*                                                       */ 03067000
*           /* CHAIN PREVIOUS SET OF CCWS TO THIS SEEK               */ 03068000
*           /*                                                       */ 03069000
*           /*********************************************************/ 03070000
*                                                                  0587 03071000
*           LASTP->PCCWNAD=ADDR(PCCWSEEK);                         0587 03072000
         LA    @05,PCCWSEEK(,PCCWPTR)                              0587 03073000
         L     @01,LASTP                                           0587 03074000
         STCM  @05,7,PCCWNAD(@01)                                  0587 03075000
*           IF SETSEC=BITOFF        /* SEEK BUT NO SET SECTOR        */ 03076000
*             THEN                                                 0588 03077000
         TM    SETSEC,B'00100000'                                  0588 03078000
         BNZ   @RF00588                                            0588 03079000
*             DO;                                                  0589 03080000
*                                                                  0589 03081000
*               /*****************************************************/ 03082000
*               /*                                                   */ 03083000
*               /* IF SEEK & NO SET SECTOR, CHANGE SET SECTOR TO TIC */ 03084000
*               /*                                                   */ 03085000
*               /*****************************************************/ 03086000
*                                                                  0590 03087000
*               PCCWSS=TICOP;       /* CHANGE OP CODE TO TIC         */ 03088000
         MVI   PCCWSS(PCCWPTR),X'08'                               0590 03089000
*               PCCWSSAD=ADDR(PCCWSRCH);/* TIC TO SEARCH             */ 03090000
         LA    @05,PCCWSRCH(,PCCWPTR)                              0591 03091000
         STCM  @05,7,PCCWSSAD(PCCWPTR)                             0591 03092000
*             END;                                                 0592 03093000
*         END;                                                     0593 03094000
@RF00588 DS    0H                                                  0594 03095000
*     END;                                                         0594 03096000
@RC00582 DS    0H                                                  0595 03097000
*   LASTCYL=PCCWCC;                 /* REMEMBER LAST CYL USED        */ 03098000
@RC00533 SLR   @05,@05                                             0595 03099000
         ICM   @05,3,PCCWCC(PCCWPTR)                               0595 03100000
         ST    @05,LASTCYL                                         0595 03101000
*   IF PCTFOVFL(SSECN+1)=BITON      /* OVERFLOW RECORD?              */ 03102000
*                                                                  0596 03103000
*   /*****************************************************************/ 03104000
*   /*                                                               */ 03105000
*   /* IF OVERFLOW RECORD, NOW ON NEXT TRACK                         */ 03106000
*   /*                                                               */ 03107000
*   /*****************************************************************/ 03108000
*                                                                  0596 03109000
*     THEN                                                         0596 03110000
         L     @05,SSECN                                           0596 03111000
         SLA   @05,2                                               0596 03112000
         ALR   @05,PCTPTR                                          0596 03113000
         TM    PCTFOVFL(@05),B'10000000'                           0596 03114000
         BNO   @RF00596                                            0596 03115000
*     LASTTRK=PCCWHH+1;             /* INDICATE ON NEXT TRACK        */ 03116000
         LA    @05,1                                               0597 03117000
         SLR   @15,@15                                             0597 03118000
         ICM   @15,3,PCCWHH(PCCWPTR)                               0597 03119000
         ALR   @05,@15                                             0597 03120000
         ST    @05,LASTTRK                                         0597 03121000
*   ELSE                                                           0598 03122000
*     LASTTRK=PCCWHH;               /* NO, INDICATE ON CURRENT TRACK */ 03123000
         B     @RC00596                                            0598 03124000
@RF00596 SLR   @05,@05                                             0598 03125000
         ICM   @05,3,PCCWHH(PCCWPTR)                               0598 03126000
         ST    @05,LASTTRK                                         0598 03127000
*   LASTSLOT=(SSLOT+1)//PCTSSECN;   /* AT START OF NEXT SLOT         */ 03128000
@RC00596 LA    @05,1                                               0599 03129000
         AL    @05,SSLOT                                           0599 03130000
         LR    @00,@05                                             0599 03131000
         SRDA  @00,32                                              0599 03132000
         LH    @05,PCTSSECN(,PCTPTR)                               0599 03133000
         DR    @00,@05                                             0599 03134000
         ST    @00,LASTSLOT                                        0599 03135000
*   LASTP=PCCWPTR;                  /* UPDATE LAST PCCW ON IORB PTR  */ 03136000
         ST    PCCWPTR,LASTP                                       0600 03137000
*   PTRPCCW=ZERO;                   /* INDICATE NO EXTRA PCCW        */ 03138000
         L     @11,PRMLADDR                                        0601 03139000
         SLR   @05,@05                                             0601 03140000
         ST    @05,PTRPCCW(,@11)                                   0601 03141000
*   RFY                                                            0602 03142000
*     R14 RSTD;                                                    0602 03143000
*   R14=RETADDR3;                   /* RESET RETURN ADDRESS          */ 03144000
         L     R14,RETADDR3                                        0603 03145000
*   END IOCHAIN;                                                   0604 03146000
@EL00016 DS    0H                                                  0604 03147000
@EF00016 DS    0H                                                  0604 03148000
@ER00016 BR    @14                                                 0604 03149000
*   RFY                                                            0605 03150000
*     R14 UNRSTD;                                                  0605 03151000
*                                                                  0606 03152000
*/*IO:        CHART                                                  */ 03153000
*/* HEADING                                                        0606 03154000
*/* ILRSRT - ASM SLOT SORT                                         0606 03155000
*/*                     FINALIZE I/O PREPARATIONS -- GO TO IOS       */ 03156000
*/********************************************************************/ 03157000
*/*                                                                  */ 03158000
*/*      IO: FINALIZE I/O PREPARATIONS -- GO TO IOS                  */ 03159000
*/*                                                                  */ 03160000
*/*      INPUT: - ADDRESS OF LAST PCCW INITIALIZED                   */ 03161000
*/*             - PARAMETER LIST FROM ILRPTM                         */ 03162000
*/*             - ASMVT                                              */ 03163000
*/*                                                                  */ 03164000
*/*      PROCESS: IF AT LEAST ONE I/O REQUEST WAS PREPARED THE       */ 03165000
*/*               PCCW CHAIN IS FINALIZED FOR I/O. LAST CCW IS       */ 03166000
*/*               CHANGED TO NOP CCW. FIELDS IN THE IORB             */ 03167000
*/*               AND IOSB ARE SET. THE SRB IS PREPARED. THE ASMVT   */ 03168000
*/*               I/O COUNT IS INCREMENTED(C&S) AND THE TOD IS STORED*/ 03169000
*/*               IN THE IORB FOR ILRCMP'S REQUEST TIME CALCULATION  */ 03170000
*/*               LATER. IOS IS INVOKED TO DO THE I/O.               */ 03171000
*/*                                                                  */ 03172000
*/*      OUTPUT: IF I/O: COMPLETED IORB-IOSB-SRB STRING              */ 03173000
*/*                      UPDATED ASMVT I/O COUNT                     */ 03174000
*/*                      TOD STORED IN IORB                          */ 03175000
*/*                                                                  */ 03176000
*/********************************************************************/ 03177000
*/*IO:        E FINAL SETUP, GO TO IOS                               */ 03178000
*                                                                  0606 03179000
*IO:                                                               0606 03180000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0606 03181000
IO       DS    0H                                                  0607 03182000
*   RFY                                                            0607 03183000
*     R14 RSTD;                     /* RESTRICT RETURN REG           */ 03184000
*   IORBPTR=PTRIORB;                /* ADDR OF IORB                  */ 03185000
         L     @15,PRMLADDR                                        0608 03186000
         L     @15,PTRIORB(,@15)                                   0608 03187000
         ST    @15,IORBPTR                                         0608 03188000
*   RESPECIFY                                                      0609 03189000
*     IORB BASED(IORBPTR);                                         0609 03190000
*                                                                  0609 03191000
*   /*****************************************************************/ 03192000
*   /*                                                               */ 03193000
*   /* IF AT LEAST ONE PCCW FOR I/O WAS PREPARED AND CHAINED TO THE  */ 03194000
*   /* IORB, THEN COMPLETE THE IORB, IOSB, SRB CHAIN AND GO TO IOS TO*/ 03195000
*   /* PROCESS THE REQUESTS                                          */ 03196000
*   /*                                                               */ 03197000
*   /*****************************************************************/ 03198000
*                                                                  0610 03199000
*/*          D (YES,,NO,%SRTSN) AT LEAST 1 I/O REQUEST ?             */ 03200000
*/* P SET LAST CCW TO NOP CCW                                        */ 03201000
*                                                                  0610 03202000
*   IF LASTP^=ZERO THEN             /* IS THERE AN I/O REQUEST ?     */ 03203000
         L     @12,LASTP                                           0610 03204000
         SLR   @11,@11                                             0610 03205000
         CR    @12,@11                                             0610 03206000
         BE    @RF00610                                            0610 03207000
*     DO;                                                          0611 03208000
*       LASTP->PCCWN=NOP;           /* SET UP LAST CCW               */ 03209000
         MVI   PCCWN(@12),X'03'                                    0612 03210000
*       LASTP->PCCWNFG(1)=NOPFLG;   /* END OF CHAIN                  */ 03211000
         MVI   PCCWNFG(@12),X'20'                                  0613 03212000
*/*          P COMPLETE THE IORB, IOSB, AND SRB                      */ 03213000
*                                                                  0614 03214000
*       IOSBPTR=IORIOSB;            /* ADDR OF IOSB                  */ 03215000
         L     IOSBPTR,IORIOSB(,@15)                               0614 03216000
*       RESPECIFY                                                  0615 03217000
*         IOSB BASED(IOSBPTR);                                     0615 03218000
*       IORAPND=''B;                /* CLEAR APPENDAGE FLAGS         */ 03219000
         NI    IORAPND(@15),B'11111000'                            0616 03220000
*       IORRQSZ=NUMREQS;            /* SET NUMBER REQUESTS           */ 03221000
         L     @12,NUMREQS                                         0617 03222000
         STC   @12,IORRQSZ(,@15)                                   0617 03223000
*       IOSUCB=PAREUCBP;            /* ADDR UCB IN IOSB              */ 03224000
         L     @15,PAREPTR                                         0618 03225000
         L     @15,PAREUCBP(,@15)                                  0618 03226000
         ST    @15,IOSUCB(,IOSBPTR)                                0618 03227000
*       IOSFLA=FLAINIT;             /* COMMAND AND DATA CHAINING     */ 03228000
         MVI   IOSFLA(IOSBPTR),X'C0'                               0619 03229000
*       IOSPROC=ZERO;               /* MUST BE ZEROED BY DRV         */ 03230000
         MVI   IOSPROC(IOSBPTR),X'00'                              0620 03231000
*       IOSERP=ZERO;                /* MUST BE ZEROED BY DRV         */ 03232000
         ST    @11,IOSERP(,IOSBPTR)                                0621 03233000
*       IOSIPIB=ZERO;               /* MUST BE ZEROED BY DRV         */ 03234000
         ST    @11,IOSIPIB(,IOSBPTR)                               0622 03235000
*/*SRTINCR:   P INCREMENT COUNT OF SRBS DESTINED FOR ILRCMP (C&S)    */ 03236000
*                                                                  0623 03237000
*       RFY                                                        0623 03238000
*        (R0,                                                      0623 03239000
*         R1) RSTD;                                                0623 03240000
*       R0=ASMIOCNT;                                               0624 03241000
         L     R0,ASMIOCNT(,ASMVTPTR)                              0624 03242000
*SRTINCR:                                                          0625 03243000
*       R1=R0+ONE;                                                 0625 03244000
SRTINCR  LA    R1,1                                                0625 03245000
         ALR   R1,R0                                               0625 03246000
*       CS(R0,R1,ASMIOCNT);                                        0626 03247000
*                                                                  0626 03248000
         CS    R0,@01,ASMIOCNT(ASMVTPTR)                           0626 03249000
*/*           D (YES,,NO,SRTINCR) SUCCESSFUL ?                       */ 03250000
*                                                                  0627 03251000
*       BC(NE,SRTINCR);                                            0627 03252000
*                                                                  0627 03253000
         BC    7,SRTINCR                                           0627 03254000
*       /*************************************************************/ 03255000
*       /*                                                           */ 03256000
*       /* SAVE TIME OF DAY IN THE IORB PRIOR TO CALLING IOS. THE    */ 03257000
*       /* TIME OF DAY IS USED IN THE SERVICE BURST CALCULATION.     */ 03258000
*       /*                                                           */ 03259000
*       /*************************************************************/ 03260000
*                                                                  0628 03261000
*/*           P SAVE TIME OF DAY IN IORB (SERVICE BURST INFO)        */ 03262000
*                                                                  0628 03263000
*       RFY                                                        0628 03264000
*        (R0,                                                      0628 03265000
*         R2) UNRSTD;                                              0628 03266000
*       IF REQNEED=ONE THEN                                        0629 03267000
         CLC   REQNEED(4),@CF00045                                 0629 03268000
         BNE   @RF00629                                            0629 03269000
*         DO;                       /* ONLY STCK IF BURST FULL       */ 03270000
*           RFY                                                    0631 03271000
*             R15 RSTD;             /* RESTRICT USE OF REG           */ 03272000
*           R15=IORBPTR;            /* GET ADDRESS OF IORB           */ 03273000
         L     R15,IORBPTR                                         0632 03274000
*           GEN(STCK  IORTSMP(R15));/* STORE TOD                     */ 03275000
         STCK  IORTSMP(R15)                                             03276000
*           BC(BZ,GOODTIME);        /* TIME STORED SUCCESSFULLY ?    */ 03277000
         BC    8,GOODTIME                                          0634 03278000
*           RFY                                                    0635 03279000
*             R15 UNRSTD;           /* RELEASE REG FOR USE           */ 03280000
*         END;                                                     0636 03281000
*       IORTSMP=''B;                /* NO, ZERO TIME FIELD           */ 03282000
*                                                                  0637 03283000
@RF00629 L     @15,IORBPTR                                         0637 03284000
         XC    IORTSMP(8,@15),IORTSMP(@15)                         0637 03285000
*       /*************************************************************/ 03286000
*       /*                                                           */ 03287000
*       /* INVOKE IOS TO PROCESS THE I/O REQUESTS                    */ 03288000
*       /*                                                           */ 03289000
*       /*************************************************************/ 03290000
*                                                                  0638 03291000
*GOODTIME:                                                         0638 03292000
*       PTRIORB=0;                  /* ZERO PTM/SRT PLIST COPY OF  0638 03293000
*                                      IORB PTR SO RECOVERY KNOWS  0638 03294000
*                                      WHERE WE ARE                  */ 03295000
GOODTIME L     @15,PRMLADDR                                        0638 03296000
         SLR   @12,@12                                             0638 03297000
         ST    @12,PTRIORB(,@15)                                   0638 03298000
*/*GOODTIME: P *** RECOV *** ZERO PLIST IORB PTR                     */ 03299000
*/*           S (,%IOEXIT) IOS: ISSUE STARTIO MACRO                  */ 03300000
*                                                                  0639 03301000
*       R1=IOSSRB;                  /* POINT TO SRB                  */ 03302000
         L     R1,IOSSRB(,IOSBPTR)                                 0639 03303000
*       GEN REFS(CVTPTR,CVTMAP,CVTIXAVL,IOCOM,IOCSTIO,R1,R14,R12,R13);  03304000
        STM   R14,R12,12(R13)       SAVE REGS                           03305000
        STARTIO SRB=(1)                                                 03306000
        LM    R14,R12,12(R13)     RESTORE REGS                          03307000
*     END;                                                         0641 03308000
*                                                                  0641 03309000
*/*%SRTSN:  P MAKE IORB AVAILABLE                                    */ 03310000
*                                                                  0642 03311000
*   ELSE                                                           0642 03312000
*     IORFUSE=OFF;                  /* MAKE IORB AVAILABLE IF NOT  0642 03313000
*                                      USED                          */ 03314000
         B     @RC00610                                            0642 03315000
@RF00610 L     @15,IORBPTR                                         0642 03316000
         NI    IORFUSE(@15),B'01111111'                            0642 03317000
*/*%IOEXIT:   R RETURN                                               */ 03318000
*                                                                  0643 03319000
*   RFY                                                            0643 03320000
*     R14 UNRSTD;                   /* RELEASE RETURN REG            */ 03321000
*   END IO;                         /* END SUBROUTINE IO             */ 03322000
@EL00017 DS    0H                                                  0644 03323000
@EF00017 DS    0H                                                  0644 03324000
@ER00017 BR    @14                                                 0644 03325000
*/*IO:          END                                                  */ 03326000
*                                                                  0645 03327000
*                                                                  0645 03328000
*/*WRTUPDTE: CHART                                                   */ 03329000
*/* HEADING                                                        0645 03330000
*/* ILRSRT - ASM SLOT SORT                                         0645 03331000
*/*WRTUPDTE:  WRITE REQUEST EFFECTED UPDATES                         */ 03332000
*/********************************************************************/ 03333000
*/*                                                                  */ 03334000
*/*      WRTUPDTE:  WRITE REQUEST EFFECTED UPDATES                   */ 03335000
*/*                                                                  */ 03336000
*/*      INPUT: ADDRESS OF PAT CYLINDER MAP FOR CYLINDER FROM WHICH  */ 03337000
*/*              AT LEAST ONE WRITE REQUEST WAS CHOSEN               */ 03338000
*/*             COUNT OF WRITE REQUESTS PREPARED FOR THE CURRENT     */ 03339000
*/*               CYLINDER                                           */ 03340000
*/*             PART ENTRY                                           */ 03341000
*/*                                                                  */ 03342000
*/*      PROCESS: THE PAT CYLINDER MAP AND THE PART ENTRY SLOTS      */ 03343000
*/*               AVAILABLE COUNTER ARE UPDATED VIA COMPARE AND SWAP */ 03344000
*/*               TO REFLECT WRTIES SELECTED FOR PAGING SPACE.       */ 03345000
*/*                                                                  */ 03346000
*/*      OUTPUT: UPDATED PAT CYLINDER MAP AND PART ENTRY SLOTS       */ 03347000
*/*              AVAILABLE COUNTER                                   */ 03348000
*/*                                                                  */ 03349000
*/*                                                                  */ 03350000
*/********************************************************************/ 03351000
*/*WRTUPDTE: E WRITE REQUEST EFFECTED UPDATES                        */ 03352000
*                                                                  0645 03353000
*WRTUPDTE:                                                         0645 03354000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0645 03355000
WRTUPDTE DS    0H                                                  0646 03356000
*   RFY                                                            0646 03357000
*     R14 RSTD;                                                    0646 03358000
*   RETADDR2=R14;                   /* SAVE RETURN ADDR              */ 03359000
         ST    R14,RETADDR2                                        0647 03360000
*   RFY                                                            0648 03361000
*     R14 UNRSTD;                                                  0648 03362000
*                                                                  0648 03363000
*   /*****************************************************************/ 03364000
*   /*                                                               */ 03365000
*   /* UPDATE THE PAT CYLINDER MAP WITH THE MASK GENERATED BY        */ 03366000
*   /* SUCCESSIVE INVOCATIONS OF A FINDSLOT ROUTINE. UPDATE DEPENDS  */ 03367000
*   /* ON WHETHER THE PAT CYLINDER MAP IS ONE WORD IN LENGTH OR TWO  */ 03368000
*   /*                                                               */ 03369000
*   /*****************************************************************/ 03370000
*                                                                  0649 03371000
*/*           P OBTAIN ADDRESS OF PAT CYLINDER MAP                   */ 03372000
*/*           D (YES,,NO,%WTU20) CYL MAP ONE WORD IN LENGTH ?        */ 03373000
*                                                                  0649 03374000
*   RFY                                                            0649 03375000
*    (R0,                                                          0649 03376000
*     R1,                                                          0649 03377000
*     R2,                                                          0649 03378000
*     R14,                                                         0649 03379000
*     R15) RSTD;                                                   0649 03380000
*   R2=EPACYLA;                     /* GET CYL MAP ADDR              */ 03381000
         L     R2,EPACYLA(,EPAPTR)                                 0650 03382000
*   IF CYLMPWDS=ONE THEN            /* ONE WORD CYL MAP ?            */ 03383000
         CLC   CYLMPWDS(4),@CF00045                                0651 03384000
         BNE   @RF00651                                            0651 03385000
*     DO;                                                          0652 03386000
*                                                                  0652 03387000
*/*           P (,%WTU30) 'OR' FINDSLOT RTN WRITE MASK INTO PAT CYL     03388000
*/*                       MAP (C&S)                                  */ 03389000
*                                                                  0653 03390000
*       R0=R2->PATCYLMP(1:4);       /* GET CURRENT PAT CYL MAP       */ 03391000
         ICM   R0,15,PATCYLMP(R2)                                  0653 03392000
*SET1WCYL:                                                         0654 03393000
*       R1=R0|SCYLWRT(1:4);         /* ADD WRITE HITS                */ 03394000
SET1WCYL LR    R1,R0                                               0654 03395000
         ICM   @12,15,SCYLWRT                                      0654 03396000
         OR    R1,@12                                              0654 03397000
*       CS(R0,R1,R2->PATCYLMP(1:4));/* ATTEMPT UPDATE                */ 03398000
         CS    R0,@01,PATCYLMP(R2)                                 0655 03399000
*       BC(NE,SET1WCYL);            /* UNSUCCESSFUL, TRY AGAIN       */ 03400000
         BC    7,SET1WCYL                                          0656 03401000
*     END;                                                         0657 03402000
*   ELSE                            /* TWO WORD PAT CYL MAP ?        */ 03403000
*/*%WTU20:    P 'OR' FINDSLOT RTN WRITE MASK INTO PAT CYL MAP (CDS)  */ 03404000
*                                                                  0658 03405000
*     DO;                                                          0658 03406000
         B     @RC00651                                            0658 03407000
@RF00651 DS    0H                                                  0659 03408000
*       LM(R0,R1,R2->PATCYLMP);     /* GET CURRENT PAT CYL MAP       */ 03409000
         LM    R0,R1,PATCYLMP(R2)                                  0659 03410000
*SET2WCYL:                                                         0660 03411000
*       R14=R0|SCYLWRT(1:4);        /* ADD WRITE HITS: FIRST WORD    */ 03412000
SET2WCYL LR    R14,R0                                              0660 03413000
         ICM   @12,15,SCYLWRT                                      0660 03414000
         OR    R14,@12                                             0660 03415000
*       R15=R1|SCYLWRT(5:8);        /* ADD WRITE HITS: 2ND WORD      */ 03416000
         LR    R15,R1                                              0661 03417000
         ICM   @12,15,SCYLWRT+4                                    0661 03418000
         OR    R15,@12                                             0661 03419000
*       CDS(R0,R14,R2->PATCYLMP);   /* ATTEMPT UPDATE                */ 03420000
         CDS   R0,R14,PATCYLMP(R2)                                 0662 03421000
*       BC(NE,SET2WCYL);            /* UNSUCCESSFUL, TRY AGAIN       */ 03422000
         BC    7,SET2WCYL                                          0663 03423000
*     END;                                                         0664 03424000
*   RFY                                                            0665 03425000
*    (R2,                                                          0665 03426000
*     R14,                                                         0665 03427000
*     R15) UNRSTD;                                                 0665 03428000
*                                                                  0665 03429000
@RC00651 DS    0H                                                  0666 03430000
*   /*****************************************************************/ 03431000
*   /*                                                               */ 03432000
*   /* UPDATE THE SLOTS-AVAILABLE COUNT IN THE PART ENTRY            */ 03433000
*   /*                                                               */ 03434000
*   /*****************************************************************/ 03435000
*                                                                  0666 03436000
*/*%WTU30:    P UPDATE SLOTS AVAILABLE CTR IN PART ENTRY (C&S)       */ 03437000
*                                                                  0666 03438000
*   R0=PARESLTA;                    /* GET CURRENT COUNT             */ 03439000
         L     @12,PAREPTR                                         0666 03440000
         L     R0,PARESLTA(,@12)                                   0666 03441000
*DECRSLTA:                                                         0667 03442000
*   R1=R0-EPAWRTCT;                 /* DECREMENT COUNT               */ 03443000
DECRSLTA LR    R1,R0                                               0667 03444000
         SH    R1,EPAWRTCT(,EPAPTR)                                0667 03445000
*   CS(R0,R1,PARESLTA);             /* ATTEMPT REPLACE               */ 03446000
         L     @12,PAREPTR                                         0668 03447000
         CS    R0,@01,PARESLTA(@12)                                0668 03448000
*   BC(NE,DECRSLTA);                /* UNSUCCESSFUL, TRY AGAIN       */ 03449000
         BC    7,DECRSLTA                                          0669 03450000
*   RFY                                                            0670 03451000
*    (R0,                                                          0670 03452000
*     R1) UNRSTD;                                                  0670 03453000
*                                                                  0670 03454000
*/*           M ZERO COUNT OF WRITE REQUESTS FOR CYLINDER            */ 03455000
*                                                                  0671 03456000
*   EPAWRTCT=ZERO;                  /* ZERO COUNT OF WRITE REQUESTS     03457000
*                                      PREPARED                      */ 03458000
         SLR   @12,@12                                             0671 03459000
         STH   @12,EPAWRTCT(,EPAPTR)                               0671 03460000
*   RFY                                                            0672 03461000
*     R14 RSTD;                                                    0672 03462000
*                                                                  0672 03463000
*/*           R RETURN                                               */ 03464000
*                                                                  0673 03465000
*   R14=RETADDR2;                   /* RESTORE RETURN REGISTER       */ 03466000
         L     R14,RETADDR2                                        0673 03467000
*   RFY                                                            0674 03468000
*     R14 UNRSTD;                                                  0674 03469000
*   END WRTUPDTE;                   /* END SUBROUTINE WRTUPDTE       */ 03470000
@EL00018 DS    0H                                                  0675 03471000
@EF00018 DS    0H                                                  0675 03472000
@ER00018 BR    @14                                                 0675 03473000
*/*WRTUPDTE: END                                                     */ 03474000
*                                                                  0676 03475000
*                                                                  0676 03476000
*/*CLEANUP:  CHART                                                   */ 03477000
*/* HEADING                                                        0676 03478000
*/* ILRSRT - ASM SLOT SORT                                         0676 03479000
*/*CLEANUP: FINAL ACTIONS BEFORE RETURNING TO CALLER                 */ 03480000
*/********************************************************************/ 03481000
*/*                                                                  */ 03482000
*/*      CLEANUP: FINAL ACTIONS BEFORE RETURNING TO CALLER           */ 03483000
*/*                                                                  */ 03484000
*/*      INPUT: REGISTER 13                                          */ 03485000
*/*                                                                  */ 03486000
*/*      PROCESS: THE CALLERS SAVEAREA IS RELOADED INTO REG 13.      */ 03487000
*/*               THE RETURN CODE IS STORED IN CALLERS REGISTER 15   */ 03488000
*/*               SAVE AREA FIELD.                                   */ 03489000
*/*                                                                  */ 03490000
*/*      OUTPUT: UPDATED SAVEAREA POINTER                            */ 03491000
*/*              UPDATED REGISTER 15 FIELD IN CALLERS SAVEAREA       */ 03492000
*/*                                                                  */ 03493000
*/*                                                                  */ 03494000
*/********************************************************************/ 03495000
*/*CLEANUP: E FINAL CLEAN UP ACTIONS                                 */ 03496000
*                                                                  0676 03497000
*CLEANUP:                                                          0676 03498000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0676 03499000
CLEANUP  DS    0H                                                  0677 03500000
*   RFY                                                            0677 03501000
*     R14 RSTD;                     /* RESTRICT RETURN ADDRESS REG   */ 03502000
*/* D (YES,,NO,%F02) ANY IOES ON INTERNAL FREE Q?                    */ 03503000
*/* P GET PTR TO 1ST IOE ON Q                                        */ 03504000
*/* P ZERO INTERNAL Q PTRS                                           */ 03505000
*/* P RETURN IOES TO AVAIL Q (C&S)                                   */ 03506000
*                                                                  0678 03507000
*   RFY                                                            0678 03508000
*    (R0,                                                          0678 03509000
*     R1,                                                          0678 03510000
*     R2,                                                          0678 03511000
*     R5) RSTD;                                                    0678 03512000
*   RFY                                                            0679 03513000
*     ASMPOOLS BASED(R5);                                          0679 03514000
*   R5=ADDR(ASMIOEPC);                                             0680 03515000
         LA    R5,ASMIOEPC(,ASMVTPTR)                              0680 03516000
*   R1=EPAFFIOE;                    /* PICK UP FIRST AND             */ 03517000
         L     R1,EPAFFIOE(,EPAPTR)                                0681 03518000
*   R2=EPALFIOE;                    /* LAST INTERNAL FREE QUEUE PTRS */ 03519000
         L     R2,EPALFIOE(,EPAPTR)                                0682 03520000
*   EPAFFIOE=0;                     /* ZERO FOR RECOVERY             */ 03521000
         SLR   @15,@15                                             0683 03522000
         ST    @15,EPAFFIOE(,EPAPTR)                               0683 03523000
*   EPALFIOE=0;                     /* LIKEWISE                      */ 03524000
         ST    @15,EPALFIOE(,EPAPTR)                               0684 03525000
*   R0=ASMCPAVL;                    /* CURRENT CONTENTS OF AVAIL Q   */ 03526000
         L     R0,ASMCPAVL(,R5)                                    0685 03527000
*RETRY1:                                                           0686 03528000
*   R2->IOENXT=R0;                  /* CHAIN IN EXISTING             */ 03529000
RETRY1   ST    R0,IOENXT(,R2)                                      0686 03530000
*   CS(R0,R1,ASMCPAVL);             /* UPDATE AVAIL Q                */ 03531000
         CS    R0,@01,ASMCPAVL(R5)                                 0687 03532000
*   BC(NE,RETRY1);                  /* TRY AGAIN IF MISS             */ 03533000
         BC    7,RETRY1                                            0688 03534000
*   RFY                                                            0689 03535000
*    (R0,                                                          0689 03536000
*     R1,                                                          0689 03537000
*     R2,                                                          0689 03538000
*     R5) UNRSTD;                                                  0689 03539000
*                                                                  0689 03540000
*/*%F02:      P RESTORE CALLER'S SAVEAREA REG                        */ 03541000
*                                                                  0690 03542000
*   R13=CALLR13;                    /* GET CALLER'S SVAREA ADDR      */ 03543000
         L     R13,CALLR13                                         0690 03544000
*/* D (YES,%T1,OR,) DS NOT FULL + MORE WRITES?                       */ 03545000
*/* D (YES,,NO,%F1) MORE READS?                                      */ 03546000
*/*%T1: P OR ON MORE WORK BIT IN RETCODE                             */ 03547000
*/*%F1:       P STORE RETURN CODE IN CALLERS SAVEAREA (R15)          */ 03548000
*                                                                  0691 03549000
*   IF((RETCODE=0&WRITEQUE^=0)|     /* IF NOT FULL + MORE WRITES     */ 03550000
*       PAREIOEQ^=0|                /* IF UNSORTED OR                */ 03551000
*       PARENODE^=0) THEN           /* SORTED READS REGARDLESS OF  0691 03552000
*                                      FULL CONDITION                */ 03553000
         SLR   @15,@15                                             0691 03554000
         C     @15,RETCODE                                         0691 03555000
         BNE   @GL00010                                            0691 03556000
         C     @15,WRITEQUE                                        0691 03557000
         BNE   @RT00691                                            0691 03558000
@GL00010 SLR   @15,@15                                             0691 03559000
         L     @12,PAREPTR                                         0691 03560000
         C     @15,PAREIOEQ(,@12)                                  0691 03561000
         BNE   @RT00691                                            0691 03562000
         C     @15,PARENODE(,@12)                                  0691 03563000
         BE    @RF00691                                            0691 03564000
@RT00691 DS    0H                                                  0692 03565000
*     RETCODE=RETCODE|IOOKMORE;     /* INDICATE MORE WORK            */ 03566000
         L     @15,RETCODE                                         0692 03567000
         O     @15,@CF00119                                        0692 03568000
         ST    @15,RETCODE                                         0692 03569000
*   ELSE                                                           0693 03570000
*     ;                             /* OTHERWISE LEAVE ALONE         */ 03571000
@RF00691 DS    0H                                                  0694 03572000
*   R13->CALLR15=RETCODE;           /* RET CODE TO CALLER SVAREA     */ 03573000
         L     @15,RETCODE                                         0694 03574000
         ST    @15,CALLR15(,R13)                                   0694 03575000
*   PTRWRITE=WRITEQUE;              /* RESET PARM AREA FOR WRITES  0695 03576000
*                                      REMAINING                     */ 03577000
         L     @15,WRITEQUE                                        0695 03578000
         L     @12,PRMLADDR                                        0695 03579000
         ST    @15,PTRWRITE(,@12)                                  0695 03580000
*/*           R RETURN                                               */ 03581000
*                                                                  0696 03582000
*   RFY                                                            0696 03583000
*     R14 UNRSTD;                   /* RELEASE RETURN ADDRESS REG    */ 03584000
*   END CLEANUP;                    /* END SUBROUTINE CLEANUP        */ 03585000
@EL00019 DS    0H                                                  0697 03586000
@EF00019 DS    0H                                                  0697 03587000
@ER00019 BR    @14                                                 0697 03588000
*/*CLEANUP:   END                                                    */ 03589000
*                                                                  0698 03590000
*FSRTNS:                                                           0698 03591000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0698 03592000
*                                                                  0698 03593000
FSRTNS   DS    0H                                                  0699 03594000
*   /*****************************************************************/ 03595000
*   /*                                                               */ 03596000
*   /* FIND-SLOT-ROUTINE MASKS                                       */ 03597000
*   /*                                                               */ 03598000
*   /*****************************************************************/ 03599000
*                                                                  0699 03600000
*   DCL                                                            0699 03601000
*     FSLOBIT1 FIXED(32) INIT('00000000000000000000000000000001'B),     03602000
*     FSLOBIT4 FIXED(32) INIT('00000000000000000000000000001000'B),     03603000
*     FSHIBIT3 FIXED(32) INIT('00100000000000000000000000000000'B),     03604000
*     FS3COLR3 FIXED(32) INIT('00000000000000000000000001001001'B),     03605000
*     FS3COLR5 FIXED(32) INIT('00000000000000000001001001001001'B),     03606000
*     FS3COLR9 FIXED(32) INIT('00000001001001001001001001001001'B),     03607000
*     FS3COLRB FIXED(32) INIT('01001001001001001001001001001001'B),     03608000
*     FS3COLLB FIXED(32) INIT('10010010010010010010010010010010'B),     03609000
*     FS3COLL5 FIXED(32) INIT('10010010010010000000000000000000'B),     03610000
*     FS3COLL3 FIXED(32) INIT('10010010000000000000000000000000'B),     03611000
*     FS4COLL6 FIXED(32) INIT('10001000100010001000100000000000'B),     03612000
*     FS4COLL3 FIXED(32) INIT('10001000100000000000000000000000'B),     03613000
*     FSDCOLL2 FIXED(32) INIT('10000000000001000000000000000000'B);     03614000
*                                                                  0699 03615000
*   /*****************************************************************/ 03616000
*   /*                                                               */ 03617000
*   /* FIND-SLOT-ROUTINE CONSTANT VALUES                             */ 03618000
*   /*                                                               */ 03619000
*   /*****************************************************************/ 03620000
*                                                                  0700 03621000
*   DCL                                                            0700 03622000
*     FSF1 FIXED(31) DEF(FSLOBIT1),                                0700 03623000
*     FSF3 FIXED(31) INIT(3),                                      0700 03624000
*     FSF4 FIXED(31) INIT(4),                                      0700 03625000
*     FSF9 FIXED(31) INIT(9),                                      0700 03626000
*     FSF12 FIXED(31) INIT(12),                                    0700 03627000
*     FSF13 FIXED(31) INIT(13),                                    0700 03628000
*     FSF15 FIXED(31) INIT(15),                                    0700 03629000
*     FSF33 FIXED(31) INIT(33);                                    0700 03630000
*                                                                  0700 03631000
*/********************************************************************/ 03632000
*/*                                                                  */ 03633000
*/*      F2314S: FIND NEXT BEST SLOT ON A 2314 CYLINDER              */ 03634000
*/*                                                                  */ 03635000
*/*      INPUT: - LAST SLOT CHOSEN IN CYLINDER                       */ 03636000
*/*             - READ/WRITE CYLINDER MAP MASK                       */ 03637000
*/*             - READ CYLINDER MAP MASK                             */ 03638000
*/*             - NUMBER SLOTS/CYLINDER                              */ 03639000
*/*                                                                  */ 03640000
*/*      PROCESS: THE NEXT BEST SLOT IS DETERMINED AND TESTED. IF    */ 03641000
*/*               NO REQUEST MAY BE PROCESSED FOR IT THEN THE READ/  */ 03642000
*/*               WRITE MASK IS TESTED, ONE CYLINDER COLUMN AT A     */ 03643000
*/*               TIME (SEE DIAGRAM) UNTIL A COLUMN WITH A HIT IS    */ 03644000
*/*               FOUND. A BIT IN THE COLUMN IS FOUND AND A REQUEST  */ 03645000
*/*               FOR THE SLOT REPRESENTED IS OBTAINED. THE READ/    */ 03646000
*/*               WRITE MASK IS UPDATED SO THAT THE SLOT WILL NOT BE */ 03647000
*/*               CHOSEN AGAIN. IF A WRITE REQUEST WAS SELECTED THE  */ 03648000
*/*               APPROPRIATE BIT IS SET IN THE READ MASK.  THIS     */ 03649000
*/*               MASK MAY BE LATER USED TO UPDATE THE PAT CYLINDER  */ 03650000
*/*               MAP.                                               */ 03651000
*/*                                                                  */ 03652000
*/*      OUTPUT: - UPDATED SLOT VALUE                                */ 03653000
*/*              - UPDATED READ/WRITE MASK                           */ 03654000
*/*              - UPDATED READ (WRITE) MASK IF WRITE SLOT SELECTED  */ 03655000
*/*              - IOE (VIA GETREAD OR SETWRITE)                     */ 03656000
*/*                                                                  */ 03657000
*/********************************************************************/ 03658000
*                                                                  0701 03659000
*F2314S:                                                           0701 03660000
*   GEN;                                                           0701 03661000
F2314S   DS    0H                                                  0701 03662000
*       /*                                                              03663000
*                                                                       03664000
*     2314 CYLINDER RELATIVE SLOT DIAGRAM                               03665000
*                                                                       03666000
*    TRK ___________________________                                    03667000
*      0 |_______0________|_____1__|                                    03668000
*      1 |________|______2_________|                                    03669000
*      2 |_______3________|_____4__|                                    03670000
*      3 |________|______5_________|                                    03671000
*      4 |_______6________|_____7__|                                    03672000
*      5 |________|______8_________|                                    03673000
*      6 |_______9________|____10__|                                    03674000
*      7 |________|_____11_________|                                    03675000
*      8 |______12________|____13__|                                    03676000
*      9 |________|_____14_________|                                    03677000
*     10 |______15________|____16__|                                    03678000
*     11 |________|_____17_________|                                    03679000
*     12 |______18________|____19__|                                    03680000
*     13 |________|_____20_________|                                    03681000
*     14 |______21________|____22__|                                    03682000
*     15 |________|_____23_________|                                    03683000
*     16 |______24________|____25__|                                    03684000
*     17 |________|_____26_________|                                    03685000
*     18 |______27________|____28__|                                    03686000
*     19 |________|_____29_________|                                    03687000
*                                                                       03688000
*                                                                       03689000
* USING LAST SLOT FOUND, NOW FIND NEXT BEST POSSIBLE SLOT TO            03690000
* PROCESS AND COLUMN IT IS IN.                                          03691000
         L     R2,SCYLRDWT             GET READ/WRITE MASK              03692000
         L     R5,SSLOT                OBTAIN PREVIOUS SLOT NBR         03693000
         A     R5,FSF1                 INCR SLOT NBR TO NEXT SEQ        03694000
         LR    R0,R5                   SAVE NEXT SLOT NBR               03695000
*                                                                       03696000
         SLR   R4,R4                   ZERO ODD REG OF PAIR             03697000
         D     R4,FSF3                 DETERMINE TEST 'COLUMN'          03698000
         LTR   R5,R4                   CHECK FOR COL ZERO               03699000
         BNZ   B2314NXT                NO, CONTINUE NEXT SLOT TEST      03700000
         LTR   R2,R2                   TEST IF ZERO BIT ON              03701000
         BM    HIT2314                 IF HIT, THEN PROCESS             03702000
         B     T2314                   IF NO HIT, GET NEXT COL AND    **03703000
                                       CONTINUE                         03704000
*                                                                       03705000
*  TEST NEXT BEST SLOT                                                  03706000
*                                                                       03707000
B2314NXT LR    R5,R0                   RESTORE SLOT NBR                 03708000
         L     R0,HIORDER8             SET HI ORDER BIT IN REG          03709000
         SRL   R0,0(R5)                BUILD MASK TO TEST NEXT SEQ    **03710000
                                       SLOT                             03711000
         NR    R0,R2                   TEST FOR HIT                     03712000
         BNZ   M2314SET                IF HIT, PREPARE TO GET OUT       03713000
         LR    R5,R4                   GET COLUMN NUMBER                03714000
*                                                                       03715000
*                                                                       03716000
*  FIND COLUMN WITH AT LEAST ONE HIT                                    03717000
*                                                                       03718000
T2314    IC    R5,COL2314(R5)          GET TEST 'COLUMN'                03719000
         LR    R1,R2                   GET SCYLRDWT MASK COPY           03720000
         SLL   R1,0(R5)                SHIFT COPY FOR CORRECT COLUMN  **03721000
                                       TEST                             03722000
         N     R1,FS3COLLB             ANY BITS ON....                  03723000
         BZ    T2314                   IF NOT, LOOP & GET NEXT COLUMN   03724000
*                                                                       03725000
*  FIND SLOT IN COLUMN                                                  03726000
*                                                                       03727000
*  TEST FIRST FIVE CHOICES                                              03728000
*                                                                       03729000
B2314T5  L     R0,FS3COLL5             GET MASK TO TEST 5 BITS          03730000
         NR    R0,R1                   TEST FOR HIT                     03731000
         BNZ   B2314T3                 HIT EXISTS IN FIRST 5 BITS       03732000
         SLL   R1,15                   SHIFT OFF 5 BAD POSSIBILITIES    03733000
         A     R5,FSF15                GET SLOT NBR NEXT POSSIBILITY    03734000
*                                                                       03735000
*  TEST THREE OF FIVE CHOICES                                           03736000
*                                                                       03737000
B2314T3  L     R0,FS3COLL3             GET MASK TO TEST 3 BITS          03738000
         NR    R0,R1                   TEST FOR HIT                     03739000
         BNZ   B2314T1                 HIT EXISTS IN THE 3 BITS         03740000
         SLL   R1,9                    SHIFT OFF 3 BAD POSSIBILITIES    03741000
         A     R5,FSF9                 GET SLOT NBR NEXT POSSIBILITY    03742000
*                                                                       03743000
*  TEST ONE OF THREE (OR TWO) CHOICES                                   03744000
*                                                                       03745000
B2314T1  ALR   R1,R1                   SHIFT ONE LEFT, SET            **03746000
                                       CONDITION CODE IF CARRY          03747000
         BC    3,HIT2314               GOT A SLOT IF CARRY              03748000
         A     R5,FSF3                 IF NO SLOT, INCREMENT SLOT NBR   03749000
         N     R1,FSHIBIT3             TEST NEXT BEST POSSIBILITY       03750000
         BNZ   HIT2314                 HIT... THEN BRANCH               03751000
         A     R5,FSF3                 IF NO SLOT, INCREMENT SLOT NBR   03752000
*                                                                       03753000
*  SLOT FOUND: UPDATE MASKS                                             03754000
*     GET IOE FOR REQUEST                                               03755000
*                                                                       03756000
HIT2314  L     R0,HIORDER8             SET HI ORDER BIT IN REG          03757000
         SRL   R0,0(R5)                BUILD MASK TO SLOT NBR           03758000
M2314SET ST    R5,SSLOT                SAVE SLOT NUMBER IN PARMLIST     03759000
         XR    R2,R0                   TURN BIT OFF IN SCYLRDWT         03760000
         ST    R2,SCYLRDWT                                              03761000
         O     R0,SCYLREAD             GET READ MASK                    03762000
         C     R0,SCYLREAD             SEE IF BIT ALREADY ON          **03763000
                                       (DETERMINE IF READ-SLOT)         03764000
         BE    GETREAD                 GET READ REQUEST FOUND           03765000
         ST    R0,SCYLWRT              STORE NEW READ (WRITE) MASK      03766000
         B     SETWRITE                GET WRITE REQUEST FOUND          03767000
COL2314  DC    XL3'020001'             NEXT BEST SLOT COLUMN ARRAY      03768000
*                                                                  0702 03769000
*/********************************************************************/ 03770000
*/*                                                                  */ 03771000
*/*      F3340S: FIND NEXT BEST SLOT ON A 3340 CYLINDER              */ 03772000
*/*                                                                  */ 03773000
*/*      INPUT: - LAST SLOT CHOSEN IN CYLINDER                       */ 03774000
*/*             - READ/WRITE CYLINDER MAP MASK                       */ 03775000
*/*             - READ CYLINDER MAP MASK                             */ 03776000
*/*             - NUMBER SLOTS/CYLINDER                              */ 03777000
*/*                                                                  */ 03778000
*/*      PROCESS: THE NEXT BEST SLOT IS DETERMINED AND TESTED. IF    */ 03779000
*/*               NO REQUEST MAY BE PROCESSED FOR IT THEN THE READ/  */ 03780000
*/*               WRITE MASK IS TESTED, ONE CYLINDER COLUMN AT A     */ 03781000
*/*               TIME (SEE DIAGRAM) UNTIL A COLUMN WITH A HIT IS    */ 03782000
*/*               FOUND. A BIT IN THE COLUMN IS FOUND AND A REQUEST  */ 03783000
*/*               FOR THE SLOT REPRESENTED IS OBTAINED. THE READ/    */ 03784000
*/*               WRITE MASK IS UPDATED SO THAT THE SLOT WILL NOT BE */ 03785000
*/*               CHOSEN AGAIN. IF A WRITE REQUEST WAS SELECTED THE  */ 03786000
*/*               APPROPRIATE BIT IS SET IN THE READ MASK.  THIS     */ 03787000
*/*               MASK MAY BE LATER USED TO UPDATE THE PAT CYLINDER  */ 03788000
*/*               MAP.                                               */ 03789000
*/*                                                                  */ 03790000
*/*      OUTPUT: - UPDATED SLOT VALUE                                */ 03791000
*/*              - UPDATED READ/WRITE MASK                           */ 03792000
*/*              - UPDATED READ (WRITE) MASK IF WRITE SLOT SELECTED  */ 03793000
*/*              - IOE (VIA GETREAD OR SETWRITE)                     */ 03794000
*/*                                                                  */ 03795000
*/********************************************************************/ 03796000
*                                                                  0702 03797000
*F3340S:                                                           0702 03798000
*   GEN;                                                           0702 03799000
F3340S   DS    0H                                                  0702 03800000
*       /*                                                              03801000
*                                                                       03802000
*          3340 CYLINDER RELATIVE SLOT DIAGRAM                          03803000
*                                                                       03804000
*   TRK _________________________________________                       03805000
*     0 |____0____|____1____|____2____|____3____|                       03806000
*     1 |____4____|____5____|____6____|____7____|                       03807000
*     2 |____8____|____9____|___10____|___11____|                       03808000
*     3 |___12____|___13____|___14____|___15____|                       03809000
*     4 |___16____|___17____|___18____|___19____|                       03810000
*     5 |___20____|___21____|___22____|___23____|                       03811000
*                                                                       03812000
*                                                                       03813000
         L     R15,FSF4                PRESET WORK REG                  03814000
*                                                                       03815000
         L     R5,SSLOT                OBTAIN PREVIOUS SLOT NBR         03816000
         A     R5,FSF1                 INCR SLOT NBR TO NEXT SEQ        03817000
         LR    R4,R5                   OBTAIN NEXT SEQ SLOT NBR         03818000
         N     R4,FSF3                 GET COLUMN NUMBER                03819000
         BNZ   B3340NXT                IF NOT COL 0, TEST BIT           03820000
         SR    R5,R15                  GET NEXT SEQ SLOT THIS TRK       03821000
B3340NXT L     R2,SCYLRDWT             GET READ/WRITE MASK              03822000
         L     R0,HIORDER8             SET HI ORDER BIT IN REG          03823000
         SRL   R0,0(R5)                BUILD MASK TO TEST NEXT SEQ    **03824000
                                       SLOT                             03825000
         NR    R0,R2                   TEST FOR HIT                     03826000
         BNZ   M3340SET                IF HIT, PREPARE TO GET OUT       03827000
*                                                                       03828000
         LR    R5,R4                   GET COLUMN NUMBER                03829000
*                                                                       03830000
*                                                                       03831000
T3340    IC    R5,COL3340(R5)          GET TEST 'COLUMN'                03832000
         LR    R1,R2                   GET SCYLRDWT MASK COPY           03833000
         SLL   R1,0(R5)                SHIFT COPY FOR CORRECT COLUMN  **03834000
                                       TEST                             03835000
         N     R1,FS4COLL6             ANY BITS ON....                  03836000
         BZ    T3340                   IF NOT, LOOP & GET NEXT COLUMN   03837000
*                                                                       03838000
B3340T3  L     R0,FS4COLL3             GET MASK TO TEST 3 BITS          03839000
         NR    R0,R1                   TEST FOR HIT                     03840000
         BNZ   B3340T1                 HIT EXISTS IN FIRST 3 BITS       03841000
         SLL   R1,12                   SHIFT OFF 3 BAD POSSIBILITIES    03842000
         A     R5,FSF12                GET SLOT NBR NEXT POSSIBILITY    03843000
*                                                                       03844000
B3340T1  ALR   R1,R1                   SHIFT ONE LEFT, SET            **03845000
                                       CONDITION CODE IF CARRY          03846000
         BC    3,HIT3340               GOT A SLOT IF CARRY              03847000
         ALR   R5,R15                  IF NO SLOT, INCREMENT SLOT NBR   03848000
         N     R1,FS3COLL3             TEST NEXT BEST POSSIBILITY       03849000
         BNZ   HIT3340                 HIT... THEN BRANCH               03850000
         ALR   R5,R15                  IF NO SLOT, INCREMENT SLOT NBR   03851000
*                                                                       03852000
*                                                                       03853000
HIT3340  L     R0,HIORDER8             SET HI ORDER BIT IN REG          03854000
         SRL   R0,0(R5)                BUILD MASK TO SLOT NBR           03855000
M3340SET ST    R5,SSLOT                SAVE SLOT NUMBER IN PARMLIST     03856000
         XR    R2,R0                   TURN BIT OFF IN SCYLRDWT         03857000
         ST    R2,SCYLRDWT                                              03858000
         O     R0,SCYLREAD             GET READ MASK                    03859000
         C     R0,SCYLREAD             SEE IF BIT ALREADY ON          **03860000
                                       (DETERMINE IF READ-SLOT)         03861000
         BE    GETREAD                 GET READ REQUEST FOUND           03862000
         ST    R0,SCYLWRT              STORE NEW READ (WRITE) MASK      03863000
         B     SETWRITE                GET WRITE REQUEST FOUND          03864000
COL3340  DC    XL4'01020300'           NEXT BEST SLOT COLUMN ARRAY      03865000
*                                                                  0703 03866000
*/********************************************************************/ 03867000
*/*                                                                  */ 03868000
*/*      F3330S: FIND NEXT BEST SLOT ON A 3330 OR 3330-1 CYLINDER    */ 03869000
*/*                                                                  */ 03870000
*/*      INPUT: - LAST SLOT CHOSEN IN CYLINDER                       */ 03871000
*/*             - READ/WRITE CYLINDER MAP MASK                       */ 03872000
*/*             - READ CYLINDER MAP MASK                             */ 03873000
*/*             - NUMBER SLOTS/CYLINDER                              */ 03874000
*/*                                                                  */ 03875000
*/*      PROCESS: THE NEXT BEST SLOT IS DETERMINED AND TESTED. IF    */ 03876000
*/*               NO REQUEST MAY BE PROCESSED FOR IT THEN THE READ/  */ 03877000
*/*               WRITE MASK IS TESTED, ONE CYLINDER COLUMN AT A     */ 03878000
*/*               TIME (SEE DIAGRAM) UNTIL A COLUMN WITH A HIT IS    */ 03879000
*/*               FOUND. A BIT IN THE COLUMN IS FOUND AND A REQUEST  */ 03880000
*/*               FOR THE SLOT REPRESENTED IS OBTAINED. THE READ/    */ 03881000
*/*               WRITE MASK IS UPDATED SO THAT THE SLOT WILL NOT BE */ 03882000
*/*               CHOSEN AGAIN. IF A WRITE REQUEST WAS SELECTED THE  */ 03883000
*/*               APPROPRIATE BIT IS SET IN THE READ MASK.  THIS     */ 03884000
*/*               MASK MAY BE LATER USED TO UPDATE THE PAT CYLINDER  */ 03885000
*/*               MAP.                                               */ 03886000
*/*               NOTE: THE COLUMNS ARE STAGGERED, TWO WORDS ARE     */ 03887000
*/*                     NEEDED TO MAP A CYLINDER (THUS TWO REGS FOR  */ 03888000
*/*                     FOR THE MASK), AND PARTIAL COLUMNS ARE TESTED*/ 03889000
*/*                     SINCE MORE THAN ONE NEXT BEST SLOT EXIST.    */ 03890000
*/*                                                                  */ 03891000
*/*      OUTPUT: - UPDATED SLOT VALUE                                */ 03892000
*/*              - UPDATED READ/WRITE MASK                           */ 03893000
*/*              - UPDATED READ (WRITE) MASK IF WRITE SLOT SELECTED  */ 03894000
*/*              - IOE (VIA GETREAD OR SETWRITE)                     */ 03895000
*/*                                                                  */ 03896000
*/********************************************************************/ 03897000
*                                                                  0703 03898000
*F3330S:                                                           0703 03899000
*   GEN;                                                           0703 03900000
F3330S   DS    0H                                                  0703 03901000
*       /*                                                              03902000
*                                                                       03903000
*     3330 & 3330-1 CYLINDER RELATIVE SLOT DIAGRAM                      03904000
*                                                                       03905000
* TRK _______________________________________________________________   03906000
*   0 |_________0_________|_________1_________|_________2_________|_|   03907000
*   1 |________3_________|_________4_________|_________5_________|__|   03908000
*   2 |________6________|_________7_________|_________8_________|_9_|   03909000
*   3 |_______9________|________10_________|________11_________|_12_|   03910000
*   4 |______12_______|________13_________|________14_________|_15__|   03911000
*   5 |_____15_______|________16_________|________17_________|__18__|   03912000
*   6 |_____18______|________19_________|________20_________|__21___|   03913000
*   7 |____21______|________22_________|________23_________|___24___|   03914000
*   8 |____24_____|________25_________|________26_________|___27____|   03915000
*   9 |____27____|________28_________|________29_________|____30____|   03916000
*  10 |___30____|________31_________|________32_________|_____33____|   03917000
*  11 |___33___|________34_________|________35_________|_____36_____|   03918000
*  12 |__36___|________37_________|________38_________|______39_____|   03919000
*  13 |__39__|________40_________|________41_________|______42______|   03920000
*  14 |_42__|________43_________|________44_________|_______45______|   03921000
*  15 |_45_|________46_________|________47_________|_______48_______|   03922000
*  16 |___|________49_________|________50_________|________51_______|   03923000
*  17 |__|________52_________|________53_________|________54________|   03924000
*  18 |_|________55_________|________56_________|_________57________|   03925000
*                                                                       03926000
*                                                                       03927000
         LM    R2,R3,SCYLRDWT          GET READ/WRITE MASK              03928000
         L     R5,SSLOT                OBTAIN PREVIOUS SLOT NBR         03929000
         A     R5,FSF1                 INCR SLOT NBR TO NEXT SEQ        03930000
         C     R5,CYLSLOTS             PAST LAST SLOT IN CYL...         03931000
         BL    B3330NXT                NO, CONTINUE PARTIAL COL TEST    03932000
         SLR   R5,R5                   ZERO SLOT NBR                    03933000
         LTR   R2,R2                   TEST IF ZERO BIT ON              03934000
         BM    HIT3330                 IF HIT, THEN PROCESS             03935000
         B     T3330MW2                IF NO HIT, GET NEXT COL AND    **03936000
                                       CONTINUE                         03937000
B3330NXT LR    R6,R2                   COPY 1ST WORD OF CYL R/W MASK    03938000
         LR    R7,R3                   COPY 2ND WORD OF CYL R/W MASK    03939000
         LCR   R4,R5                   GET NEGATIVE OF SLOT NBR         03940000
         SRDL  R6,57+6(R4)             SHIFT BITS TO TEST TO RIGHT    **03941000
                                       SIDE OF REG PAIR                 03942000
T3330PW2 N     R7,FS3COLRB             TEST FOR ANY HITS IN REST OF   **03943000
                                       CYL 'COLUMN' (HI SLOT NBRS)      03944000
         BZ    T3330PW1                IF NONE, TEST LOWER SLOT NBRS  **03945000
                                       IN CYL 'COLUMN'                  03946000
*                                                                       03947000
         B     B3330T5                 GO FIND FIRST 'ON' BIT           03948000
*                                                                       03949000
T3330PW1 N     R6,FS3COLLB             TEST OF ANY HITS IN REST OF    **03950000
                                       CYL 'COLUMN' (LO SLOT NBRS)      03951000
         BZ    G3330COL                NO HIT, THEN PREPARE TO TEST   **03952000
                                       NEXT COLUMN                      03953000
         S     R5,FSF33                RESET SLOT NBR TO HIGHEST      **03954000
                                       POSSIBLE IN CYL COL LEFT         03955000
         SRDL  R6,33                   SET REG FOR BIT TESTS BELOW      03956000
         B     B3330T5                 GO FIND FIRST 'ON' BIT           03957000
*                                                                       03958000
*                                                                       03959000
G3330COL SLR   R4,R4                   ZERO ODD REG OF PAIR             03960000
         D     R4,FSF3                 DETERMINE LAST SLOT 'COLUMN'     03961000
         LR    R5,R4                   GET COLUMN NUMBER                03962000
*                                                                       03963000
*                                                                       03964000
T3330MW2 IC    R5,COL3330(R5)          GET TEST 'COLUMN'                03965000
         LR    R6,R2                   GET READ/WRITE MASK(WRD1)        03966000
         LR    R7,R3                   GET READ/WRITE MASK(WRD2)        03967000
         SLDL  R6,0(R5)                SHIFT COPY FOR CORRECT COLUMN  **03968000
                                       TEST                             03969000
         N     R7,FS3COLRB             ANY BITS ON (HIGHER SLOT NBRS)   03970000
         BZ    T3330MW1                IF NOT, TEST 1ST WORD OF MASK  **03971000
                                       (LOWER SLOT NBRS)                03972000
         SRL   R7,6                    SHIFT OFF WASTED BITS            03973000
         LA    R5,57(R5)               GET MAX SLOT NBR FOR COLUMN      03974000
         B     B3330T5                 DETERMINE SLOT NBR               03975000
*                                                                       03976000
*                                                                       03977000
T3330MW1 N     R6,FS3COLLB             ANY BITS ON (LOWER SLOT NBRS)    03978000
         BZ    T3330MW2                IF NOT, LOOP & TEST NEXT COL     03979000
         SRDL  R6,33                   SET REG FOR BIT TESTS BELOW      03980000
         LA    R5,30(R5)               GET MAX SLOT NBR FOR MASK WRD    03981000
*                                                                       03982000
*                                                                       03983000
B3330T5  L     R0,FS3COLR5             GET MASK TO TEST 5 BITS          03984000
         NR    R0,R7                   TEST FOR HIT                     03985000
         BNZ   B3330T3                 HIT EXISTS IN BEST 5 BITS        03986000
         SRL   R7,15                   SHIFT OFF 5 BAD POSSIBILITIES    03987000
         S     R5,FSF15                GET SLOT NBR NEXT POSSIBILITY    03988000
B3330T3  L     R0,FS3COLR3             GET MASK TO TEST 3 BITS          03989000
         NR    R0,R7                   TEST FOR HIT                     03990000
         BNZ   B3330T1                 HIT EXISTS IN THE 3 BITS         03991000
         SRL   R7,9                    SHIFT OFF 3 BAD POSSIBILITIES    03992000
         S     R5,FSF9                 GET SLOT NBR NEXT POSSIBILITY    03993000
B3330T1  LR    R6,R7                   SAVE COPY OF MASK                03994000
         N     R7,FSLOBIT1             TEST BEST POSSIBILITY            03995000
         BNZ   HIT3330                 HIT...                           03996000
         S     R5,FSF3                 GET SLOT NBR NEXT POSSIBILITY    03997000
         N     R6,FSLOBIT4             TEST NEXT BEST POSSIBILITY       03998000
         BNZ   HIT3330                 HIT...                           03999000
         S     R5,FSF3                 GET SLOT NBR OF LAST CHOICE      04000000
*                                                                       04001000
*                                                                       04002000
HIT3330  L     R6,HIORDER8             SET HI ORDER BIT IN REG          04003000
         SRDL  R6,0(R5)                BUILD MASK TO SLOT NBR           04004000
M3330SET ST    R5,SSLOT                SAVE SLOT NUMBER IN PARMLIST     04005000
         LTR   R6,R6                   TEST FOR ZERO MASK               04006000
         BZ    IN2NDWRD                IF ZERO, BIT IN 2ND WORD         04007000
         XR    R2,R6                   TURN BIT OFF IN SCYLRDWT         04008000
         ST    R2,SCYLRDWT                                              04009000
         O     R6,SCYLREAD             GET READ MASK                    04010000
         C     R6,SCYLREAD             SEE IF BIT ALREADY ON          **04011000
                                       (DETERMINE IF READ-SLOT)         04012000
         BE    GETREAD                 GET READ REQUEST FOUND           04013000
         ST    R6,SCYLWRT              STORE NEW READ (WRITE) MASK      04014000
         B     SETWRITE                GET WRITE REQUEST FOUND          04015000
IN2NDWRD XR    R3,R7                                                    04016000
         ST    R3,SCYLRDWT+4                                            04017000
         O     R7,SCYLREAD+4           GET READ MASK                    04018000
         C     R7,SCYLREAD+4           SEE IF BIT ALREADY ON          **04019000
                                       (DETERMINE IF READ-SLOT)         04020000
         BE    GETREAD                 GET READ REQUEST FOUND           04021000
         ST    R7,SCYLWRT+4            STORE NEW READ (WRITE) MASK      04022000
         B     SETWRITE                GET WRITE REQUEST FOUND          04023000
COL3330  DC    XL3'010200'             NEXT BEST SLOT COLUMN ARRAY      04024000
*                                                                  0704 04025000
*/***********************************************************        */ 04026000
*/*                                                                  */ 04027000
*/*       F3350S: FIND NEXT BEST SLOT ON A 3350 SUBCYLINDER          */ 04028000
*/*                                                                  */ 04029000
*/*       INPUT: - LAST SLOT CHOSEN IN SUBCYLINDER                   */ 04030000
*/*              - READ/WRITE SUBCYLINDER MAP MASK                   */ 04031000
*/*              - READ SUBCYLINDER MAP MASK                         */ 04032000
*/*              - NUMBER SLOTS/SUBCYLINDER                          */ 04033000
*/*                                                                  */ 04034000
*/*       PROCESS: THE NEXT BEST SLOT IS DETERMINED AND              */ 04035000
*/*                TESTED. IF NO REQUEST MAY BE PROCESSED            */ 04036000
*/*                FOR IT, THEN THE VERY-NEXT-COLUMN IS              */ 04037000
*/*                FOUND AND TESTED FOR ZERO (HEAD SWITCHING         */ 04038000
*/*                TO THE VERY-NEXT-COLUMN IS POSSIBLE ONLY          */ 04039000
*/*                ACROSS THE PHYSICAL DISK INDEX).                  */ 04040000
*/*                IF COLUMN ZERO IS NEXT, BEGIN THE                 */ 04041000
*/*                COLUMN SCAN THERE. OTHERWISE, GET THE             */ 04042000
*/*                NEXT COLUMN WHICH PERMITS HEAD SWITCHING.         */ 04043000
*/*                SCAN ONE COLUMN AT A TIME (SEE DIAGRAM)           */ 04044000
*/*                UNTIL A COLUMN WITH A HIT IS FOUND. A BIT         */ 04045000
*/*                IN THE COLUMN IS FOUND AND A REQUEST FOR          */ 04046000
*/*                THE SLOT REPRESENTED IS OBTAINED. THE             */ 04047000
*/*                READ/WRITE MASK IS UPDATED SO THAT THE            */ 04048000
*/*                SLOT WILL NOT BE CHOSEN AGAIN. IF A WRITE         */ 04049000
*/*                REQUEST WAS SELECTED, THE APPROPRIATE BIT         */ 04050000
*/*                IS SET IN THE READ MASK. THIS MASK MAY BE         */ 04051000
*/*                USED LATER TO UPDATE THE PAT SUBCYLINDER          */ 04052000
*/*                MAP.                                              */ 04053000
*/*                                                                  */ 04054000
*/*       OUTPUT: - UPDATED SLOT VALUE                               */ 04055000
*/*               - UPDATED READ/WRITE MASK                          */ 04056000
*/*               - UPDATED READ (WRITE) MASK IF WRITE SLOT          */ 04057000
*/*                 SELECTED                                         */ 04058000
*/*               - IOE (VIA GETREAD OR SETWRITE)                    */ 04059000
*/*                                                                  */ 04060000
*/*         NOTE - THE 3350 CYLINDER WITH A CAPACITY OF 130          */ 04061000
*/*                SLOTS HAS BEEN BROKEN INTO 5 SUBCYLINDERS         */ 04062000
*/*                OF 26 SLOTS EACH.                                 */ 04063000
*/*                                                                  */ 04064000
*/***********************************************************        */ 04065000
*                                                                  0704 04066000
         EJECT                                                          04067000
*F3350S:                                                           0704 04068000
*   GEN;                                                           0704 04069000
F3350S   DS    0H                                                  0704 04070000
*      /*                                                               04071000
*                                                                       04072000
* 3350 SUBCYLINDER RELATIVE SLOT DIAGRAM                                04073000
*                                                                       04074000
*   COLUMN ->                                                           04075000
*   0            1            2            3            4               04076000
*   |        5   |        6   |        7   |        8   |               04077000
*   |    9   |   |   10   |   |   11   |   |   12   |   |               04078000
*TRK|    |   |   |    |   |   |    |   |   |    |   |   |               04079000
*   V____V___V___V____V___V___V____V___V___V____V___V___V____|          04080000
* 0 |_____00_____|_____01_____|_____02_____|_____03_____|_04_|          04081000
* 1 |________|_____05_____|_____06_____|_____07_____|___08___|          04082000
* 2 |____|_____09_____|_____10_____|_____11_____|_____12_____|          04083000
* 3 |_____13_____|_____14_____|_____15_____|_____16_____|_17_|          04084000
* 4 |________|_____18_____|_____19_____|_____20_____|___21___|          04085000
* 5 |____|_____22_____|_____23_____|_____24_____|_____25_____|          04086000
*                                                                       04087000
*                                                                       04088000
* GET THE PREVIOUS SLOT NUMBER AND SEE IF THE VERY-NEXT-SLOT            04089000
* IS AVAILABLE. IF AVAILABLE, GO PROCESS IT. OTHERWISE, SCAN            04090000
* THE COLUMNS ONE BY ONE.                                               04091000
*                                                                       04092000
        LA    R7,COL3350          GET ADDRESS OF TEST COLUMN            04093000
        B     COMSLT26            BRANCH TO COMMON FINDSLOT RTN         04094000
*                                                                  0705 04095000
*/********************************************************************/ 04096000
*/*                                                                  */ 04097000
*/*      F23052S: FIND NEXT BEST SLOT ON A 2305-2 CYLINDER           */ 04098000
*/*                                                                  */ 04099000
*/*      INPUT: - LAST SLOT CHOSEN IN CYLINDER                       */ 04100000
*/*             - READ/WRITE CYLINDER MAP MASK                       */ 04101000
*/*             - READ CYLINDER MAP MASK                             */ 04102000
*/*             - NUMBER SLOTS/CYLINDER                              */ 04103000
*/*                                                                  */ 04104000
*/*      PROCESS: THE NEXT BEST SLOT IS DETERMINED AND TESTED. IF    */ 04105000
*/*               NO REQUEST MAY BE PROCESSED FOR IT THEN THE READ/  */ 04106000
*/*               WRITE MASK IS TESTED, ONE CYLINDER COLUMN AT A     */ 04107000
*/*               TIME (SEE DIAGRAM) UNTIL A COLUMN WITH A HIT IS    */ 04108000
*/*               FOUND. A BIT IN THE COLUMN IS FOUND AND A REQUEST  */ 04109000
*/*               FOR THE SLOT REPRESENTED IS OBTAINED. THE READ/    */ 04110000
*/*               WRITE MASK IS UPDATED SO THAT THE SLOT WILL NOT BE */ 04111000
*/*               CHOSEN AGAIN. IF A WRITE REQUEST WAS SELECTED THE  */ 04112000
*/*               APPROPRIATE BIT IS SET IN THE READ MASK.  THIS     */ 04113000
*/*               MASK MAY BE LATER USED TO UPDATE THE PAT CYLINDER  */ 04114000
*/*               MAP.                                               */ 04115000
*/*               EXAMPLE 1. SUPPOSE 4 WAS LAST SLOT CHOSEN. THEN    */ 04116000
*/*                          5 IS NEXT BEST. THEN COLUMN TESTS GO AS */ 04117000
*/*                          FOLLOWS: 6-19,3-16,10-23,7-20,4-17,     */ 04118000
*/*                          1-14, ETC. IF A HIT IS FOUND TEST ONE   */ 04119000
*/*                          BIT IN COLUMN. IF NOT THAT ON, HIT IS   */ 04120000
*/*                          OTHER BIT.                              */ 04121000
*/*               EXAMPLE 2. SPECIAL CASE.                           */ 04122000
*/*                          IF 12 OR 25 WAS LAST SLOT CHOSEN THEN   */ 04123000
*/*                          TWO NEXT BEST POSSIBILITIES ACTUALLY    */ 04124000
*/*                          EXIST: 0 AND 13. THIS SPECIAL CASE IS   */ 04125000
*/*                          TESTED EXPLICITLY. IF NEITHER ARE GOOD, */ 04126000
*/*                          THEN PROCESSING TESTS COLUMNS: 10-23,   */ 04127000
*/*                          7-20,4-17,1-14,11-24,8-21,ETC.          */ 04128000
*/*                                                                  */ 04129000
*/*      OUTPUT: - UPDATED SLOT VALUE                                */ 04130000
*/*              - UPDATED READ/WRITE MASK                           */ 04131000
*/*              - UPDATED READ (WRITE) MASK IF WRITE SLOT SELECTED  */ 04132000
*/*              - IOE (VIA GETREAD OR SETWRITE)                     */ 04133000
*/*                                                                  */ 04134000
*/*                                                                  */ 04135000
*/********************************************************************/ 04136000
*                                                                  0705 04137000
*F23052S:                                                          0705 04138000
*   GEN;                                                           0705 04139000
F23052S  DS    0H                                                  0705 04140000
*       /*                                                              04141000
*                                                                       04142000
*     2305-2 CYLINDER RELATIVE SLOT DIAGRAM                             04143000
*                                                                       04144000
* TRK ___________________________________________                       04145000
*   0 |_____0______|_____1______|_____2_____|_3_|                       04146000
*   1 |____3____|_____4______|_____5_____|__6___|                       04147000
*   2 |___6__|_____7______|_____8_____|____9____|                       04148000
*   3 |_9_|_____10_____|____11_____|____12______|                       04149000
*   4 |____13______|____14______|____15_____|___|                       04150000
*   5 |___16____|____17______|____18_____|__19__|                       04151000
*   6 |__19__|____20______|____21_____|___22____|                       04152000
*   7 |___|_____23_____|____24_____|____25______|                       04153000
*                                                                       04154000
*                                                                       04155000
         LA    R7,COL23052             GET ADDRESS OF TEST COLUMN       04156000
COMSLT26  DS    0H                      COMMON RTN FOR 2305-2 & 3350    04157000
         L     R2,SCYLRDWT             GET READ/WRITE MASK              04158000
         L     R5,SSLOT                OBTAIN PREVIOUS SLOT NBR         04159000
         A     R5,FSF1                 INCR SLOT NBR TO NEXT SEQ        04160000
         C     R5,CYLSLOTS             PAST LAST SLOT IN CYL...         04161000
         BL    B2352NXT                NO, CONTINUE NEXT SLOT TEST      04162000
         SLR   R4,R4                   ZERO SLOT NBR                    04163000
         B     T23052S                 TEST COLUMN ZERO SPECIALLY       04164000
*                                                                       04165000
B2352NXT LR    R4,R5                   OBTAIN NEXT SEQ SLOT NBR         04166000
         S     R4,FSF13                OBTAIN COLUMN NUMBER (MAYBE)     04167000
         BZ    T23052S                 TEST COLUMN ZERO SPECIALLY       04168000
         BP    T2352NXT                BRANCH IF VALID COLUMN NUMBER    04169000
         LR    R4,R5                   RESET VALID COLUMN NUMBER        04170000
T2352NXT L     R0,HIORDER8             SET HI ORDER BIT IN REG          04171000
         SRL   R0,0(R5)                BUILD MASK TO TEST NEXT SEQ    **04172000
                                       SLOT                             04173000
         NR    R0,R2                   TEST FOR HIT                     04174000
         BNZ   M2352SET                IF HIT, PREPARE TO GET OUT       04175000
*                                                                       04176000
*                                                                       04177000
*                                                                       04178000
T23052   IC    R4,0(R4,R7)             GET TEST 'COLUMN'                04179000
T23052S  LR    R0,R2                   GET SCYLRDWT MASK COPY           04180000
         SLL   R0,0(R4)                SHIFT COPY FOR CORRECT COLUMN  **04181000
                                       TEST                             04182000
         N     R0,FSDCOLL2             ANY BITS ON....                  04183000
         BZ    T23052                  IF NOT, LOOP & GET NEXT COLUMN   04184000
         LR    R5,R4                   GET COLUMN NBR                   04185000
*                                                                       04186000
*                                                                       04187000
B23052   ALR   R0,R0                   SHIFT ONE LEFT, SET            **04188000
                                       CONDITION CODE IF CARRY          04189000
         BC    3,HIT23052              GOT A SLOT IF CARRY              04190000
         A     R5,FSF13                IF NO SLOT, INCREMENT SLOT NBR **04191000
                                       TO ONLY OTHER POSSIBLE SLOT      04192000
*                                                                       04193000
*                                                                       04194000
HIT23052 L     R0,HIORDER8             SET HI ORDER BIT IN REG          04195000
         SRL   R0,0(R5)                BUILD MASK TO SLOT NBR           04196000
M2352SET ST    R5,SSLOT                SAVE SLOT NUMBER IN PARMLIST     04197000
         XR    R2,R0                   TURN BIT OFF IN SCYLRDWT         04198000
         ST    R2,SCYLRDWT                                              04199000
         O     R0,SCYLREAD             GET READ MASK                    04200000
         C     R0,SCYLREAD             SEE IF BIT ALREADY ON          **04201000
                                       (DETERMINE IF READ-SLOT)         04202000
         BE    GETREAD                 GET READ REQUEST FOUND           04203000
         ST    R0,SCYLWRT              STORE NEW READ (WRITE) MASK      04204000
         B     SETWRITE                GET WRITE REQUEST FOUND          04205000
COL23052 DC    XL13'0A0B0C00010203040506070809' NEXT BEST SLOT COLUMN **04206000
                                                ARRAY                   04207000
COL3350  DC    X'090A0B0C000102030405060708' NEXT COLUMN ARRAY          04208000
*                                                                  0706 04209000
*/********************************************************************/ 04210000
*/*                                                                  */ 04211000
*/*      F23051S: FIND NEXT BEST SLOT ON A 2305-1 CYLINDER           */ 04212000
*/*                                                                  */ 04213000
*/*      INPUT: - LAST SLOT CHOSEN IN CYLINDER                       */ 04214000
*/*             - READ/WRITE CYLINDER MAP MASK                       */ 04215000
*/*             - READ CYLINDER MAP MASK                             */ 04216000
*/*             - NUMBER SLOTS/CYLINDER                              */ 04217000
*/*                                                                  */ 04218000
*/*      PROCESS: THE NEXT BEST SLOT IS DETERMINED AND TESTED. IF    */ 04219000
*/*               NO REQUEST MAY BE PROCESSED FOR IT THEN THE READ/  */ 04220000
*/*               WRITE MASK IS TESTED, ONE CYLINDER COLUMN AT A     */ 04221000
*/*               TIME (SEE DIAGRAM) UNTIL A COLUMN WITH A HIT IS    */ 04222000
*/*               FOUND. A BIT IN THE COLUMN IS FOUND AND A REQUEST  */ 04223000
*/*               FOR THE SLOT REPRESENTED IS OBTAINED. THE READ/    */ 04224000
*/*               WRITE MASK IS UPDATED SO THAT THE SLOT WILL NOT BE */ 04225000
*/*               CHOSEN AGAIN. IF A WRITE REQUEST WAS SELECTED THE  */ 04226000
*/*               APPROPRIATE BIT IS SET IN THE READ MASK.  THIS     */ 04227000
*/*               MASK MAY BE LATER USED TO UPDATE THE PAT CYLINDER  */ 04228000
*/*               MAP.                                               */ 04229000
*/*                                                                  */ 04230000
*/*      OUTPUT: - UPDATED SLOT VALUE                                */ 04231000
*/*              - UPDATED READ/WRITE MASK                           */ 04232000
*/*              - UPDATED READ (WRITE) MASK IF WRITE SLOT SELECTED  */ 04233000
*/*              - IOE (VIA GETREAD OR SETWRITE)                     */ 04234000
*/*                                                                  */ 04235000
*/********************************************************************/ 04236000
*                                                                  0706 04237000
*F23051S:                                                          0706 04238000
*   GEN;                                                           0706 04239000
F23051S  DS    0H                                                  0706 04240000
*       /*                                                              04241000
*                                                                       04242000
*     2305-1 CYLINDER RELATIVE SLOT DIAGRAM                             04243000
*                                                                       04244000
* TRK ______________________________                                    04245000
*   0 |____0___|____1___|____2___|_|                                    04246000
*   1 |___3___|____4___|____5___|__|                                    04247000
*   2 |__6___|____7___|____8___|___|                                    04248000
*   3 |__9__|___10___|___11___|_12_|                                    04249000
*   4 |_12_|___13___|___14___|_15__|                                    04250000
*   5 |___|___16___|___17___|__18__|                                    04251000
*   6 |__|___19___|___20___|__21___|                                    04252000
*   7 |_|___22___|___23___|___24___|                                    04253000
*                                                                       04254000
*                                                                       04255000
         L     R2,SCYLRDWT             GET READ/WRITE MASK              04256000
         L     R5,SSLOT                OBTAIN PREVIOUS SLOT NBR         04257000
         A     R5,FSF1                 INCR SLOT NBR TO NEXT SEQ        04258000
         C     R5,CYLSLOTS             PAST LAST SLOT IN CYL...         04259000
         BL    B2351NXT                NO, CONTINUE PARTIAL COL TEST    04260000
         SLR   R5,R5                   ZERO SLOT NBR                    04261000
         LTR   R2,R2                   TEST IF ZERO BIT ON              04262000
         BM    HIT23051                IF HIT, THEN PROCESS             04263000
         B     T23051                  IF NO HIT, GET NEXT COL AND    **04264000
                                       CONTINUE                         04265000
B2351NXT LR    R7,R2                   COPY READ/WRITE MASK             04266000
         SLR   R6,R6                   ZERO EVEN REG OF PAIR            04267000
         SLDL  R6,1(R5)                SHIFT ONLY POTENTIAL HITS FOR  **04268000
                                       CURRENT (FIRST) COLUMN           04269000
         N     R6,FS3COLRB             TEST FOR HIT                     04270000
         BNZ   B23051T3                IF HIT, GO DETERMINE WHICH       04271000
*                                                                       04272000
G2351COL SLR   R4,R4                   ZERO ODD REG OF PAIR             04273000
         D     R4,FSF3                 DETERMINE SLOT 'COLUMN'          04274000
         LR    R5,R4                   GET COLUMN NUMBER                04275000
*                                                                       04276000
*                                                                       04277000
T23051   IC    R5,COL23051(R5)         GET TEST 'COLUMN'                04278000
         LR    R6,R2                   GET SCYLRDWT MASK COPY           04279000
         SLL   R6,0(R5)                SHIFT COPY FOR CORRECT COLUMN  **04280000
                                       TEST                             04281000
         N     R6,FS3COLLB             ANY BITS ON....                  04282000
         BZ    T23051                  IF NOT, LOOP & GET NEXT COLUMN   04283000
*                                                                       04284000
*                                                                       04285000
         SRL   R6,7                    SHIFT OFF MEANINGLESS BITS       04286000
         LA    R5,24(R5)               GET MAX SLOT NUMBER FOR COLUMN   04287000
B23051T3 L     R0,FS3COLR3             GET MASK TO TEST 3 BITS          04288000
         NR    R0,R6                   TEST FIRST 3 BITS                04289000
         BNZ   B23051T1                BRANCH IF AT LEAST ONE BIT ON    04290000
         SRL   R6,9                    SHIFT OFF 3 BAD POSSIBILITIES    04291000
         S     R5,FSF9                 GET SLOT NBR NEXT POSSIBILITY    04292000
         L     R0,FS3COLR3             GET MASK TO TEST 3 MORE BITS     04293000
         NR    R0,R6                   TEST NEXT 3 BITS                 04294000
         BNZ   B23051T1                BRANCH IF AT LEAST ONE BIT ON    04295000
         SRL   R6,9                    SHIFT OFF 3 BAD POSSIBILITIES    04296000
         S     R5,FSF9                 GET SLOT NBR NEXT POSSIBILITY    04297000
*                                                                       04298000
B23051T1 LR    R7,R6                   SAVE COPY OF MASK                04299000
         N     R6,FSLOBIT1             TEST BEST POSSIBILITY            04300000
         BNZ   HIT23051                HIT...                           04301000
         S     R5,FSF3                 GET SLOT NBR NEXT POSSIBILITY    04302000
         N     R7,FSLOBIT4             TEST NEXT BEST POSSIBILITY       04303000
         BNZ   HIT23051                HIT...                           04304000
         S     R5,FSF3                 GET SLOT NBR OF CHOICE           04305000
*                                                                       04306000
*                                                                       04307000
HIT23051 L     R0,HIORDER8             SET HI ORDER BIT IN REG          04308000
         SRL   R0,0(R5)                BUILD MASK TO SLOT NBR           04309000
M2351SET ST    R5,SSLOT                SAVE SLOT NUMBER IN PARMLIST     04310000
         XR    R2,R0                   TURN BIT OFF IN SCYLRDWT         04311000
         ST    R2,SCYLRDWT                                              04312000
         O     R0,SCYLREAD             GET READ MASK                    04313000
         C     R0,SCYLREAD             SEE IF BIT ALREADY ON          **04314000
                                       (DETERMINE IF READ-SLOT)         04315000
         BE    GETREAD                 GET READ REQUEST FOUND           04316000
         ST    R0,SCYLWRT              STORE NEW READ (WRITE) MASK      04317000
         B     SETWRITE                GET WRITE REQUEST FOUND          04318000
COL23051 DC    XL3'010200'             NEXT BEST SLOT COLUMN ARRAY      04319000
*   END FSRTNS;                                                    0707 04320000
*                                                                  0707 04321000
@EL00020 DS    0H                                                  0707 04322000
@EF00020 DS    0H                                                  0707 04323000
@ER00020 BR    @14                                                 0707 04324000
*/* MACCOMP Y-4SCICW/PZD81                                           */ 04325000
*/* MACSTAT Y-475152/415304                                          */ 04326000
*/*A 000000-999999                                           @Z40WPWF*/ 04327000
*/********************************************************************/ 04328000
*/*                                                                  */ 04329000
*/* NAME: ILRCNVRT                                                   */ 04330000
*/*                                                                  */ 04331000
*/* STATUS: OS/VS2 RELEASE 4.1, LEVEL 0                              */ 04332000
*/*                                                                  */ 04333000
*/* ENTRY POINT: ILRCNVRT                                            */ 04334000
*/*                                                                  */ 04335000
*/* FUNCTION: CONVERT AN RBA TO A FULL SEEK ADDRESS- MBBCCHHR        */ 04336000
*/*                                                                  */ 04337000
*/* INPUT: R0- EDB HEADER ADDRESS                                    */ 04338000
*/*        R1- POINTER TO 8 BYTE AREA TO STORE SEEK ADDRESS          */ 04339000
*/*            WORD 1- RBA TO BE CONVERTED                           */ 04340000
*/*        R13- SAVE AREA POINTER                                    */ 04341000
*/*        R14- RETURN ADDRESS                                       */ 04342000
*/*                                                                  */ 04343000
*/* PROCESS: CONVERTS AN RBA TO MBBCCHHR USING THE EDB AND LPMB.     */ 04344000
*/*                                                                  */ 04345000
*/* OUTPUT: MBBCCHHR IN 8 BYTE AREA POINTED TO BY REG 1              */ 04346000
*/*         R15- RETURN CODE                                         */ 04347000
*/*              0 - CONVERSION OK                                   */ 04348000
*/*              4- EDB NOT FOUND FOR THIS RBA                       */ 04349000
*/*                                                                  */ 04350000
*/* EXIT-NORMAL: RETURN TO CALLER                                    */ 04351000
*/*              R15= 0                                              */ 04352000
*/*                                                                  */ 04353000
*/* EXIT-ERROR: RETURN TO CALLER                                     */ 04354000
*/*              R15= 4                                              */ 04355000
*/*                                                                  */ 04356000
*/* EXTERNAL REFERENCES: NONE                                        */ 04357000
*/*                                                                  */ 04358000
*/* REGISTERS CLOBBERED: REGISTERS SAVED UPON ENTRY                  */ 04359000
*/*                      THEN REGS 0-5 USED FOR PROCESSING           */ 04360000
*/*                      UPON RETURN, ALL REGS RESTORED EXCEPT       */ 04361000
*/*                      R15 WHICH CONTAINS THE RETURN CODE          */ 04362000
*/*                                                                  */ 04363000
*/* MAPPING MACROS USED:  IDAEDB                                     */ 04364000
*/*                       IDALPMB                                    */ 04365000
*/*                                                                  */ 04366000
*/* NOTES: THE CALLING MODULE MUST INCLUDE THE MAPPING MACROS LISTED */ 04367000
*/*        ABOVE. ADDRESSABILITY FOR THESE MACROS WILL BE SET UP IN  */ 04368000
*/*        THIS ROUTINE.                                             */ 04369000
*/*        ALL LABELS AND DATA AREAS CREATED BY THIS ROUTINE BEGIN   */ 04370000
*/*        WITH THE FIVE CHARACTERS 'CNVRT'.                         */ 04371000
*/*        THIS ROUTINE REQUIRES THAT THE CALLING MODULE DECLARE     */ 04372000
*/*        REGISTERS AS R0-R15.                                      */ 04373000
*/*                                                                  */ 04374000
*/********************************************************************/ 04375000
*                                                                  0708 04376000
*                                                                  0708 04377000
*/*ILRCNVRT: CHART                                                   */ 04378000
*/* HEADER                                                         0708 04379000
*/*  ILRCNVRT:  ASM CONVERT ROUTINE                                  */ 04380000
*/*ILRCNVRT:  E CONVERT RBA TO SEEK ADDR                             */ 04381000
*/* P SET UP PTR TO EDB HDR                                          */ 04382000
*/* P SET UP PTR TO 1ST EDB ENTRY                                    */ 04383000
*/* P PICK UP RBA FROM INPUT PARMS                                   */ 04384000
*/* P INITIALIZE RETURN CODE TO 4                                    */ 04385000
*/* N LOOP WHILE R15 = 4                                             */ 04386000
*/*%CNV1: D (NO,,YES,%CNV4) ALL EDB ENTRIES TRIED?                   */ 04387000
*/*       D (YES,,NO,%CNV4) RETURN CODE STILL 4?                     */ 04388000
*/*       D (YES,,NO,%CNV2) RBA IN THIS EDB ENTRY                    */ 04389000
*/* P (,%CNV1) SET RETURN CODE TO ZERO                               */ 04390000
*/*%CNV2: P (,%CNV1) UPDATE TO NEXT EDB ENTRY                        */ 04391000
*/* N END OF LOOP                                                    */ 04392000
*/*%CNV4: D (YES,,NO,%CNVEXT)  EDB ENTRY FOUND?                      */ 04393000
*/* P GET LPMB ADDRESS                                               */ 04394000
*/* P ZERO 8 BYTE OUTPUT AREA                                        */ 04395000
*/* P GET RELATIVE RBA PER THIS EXTENT                               */ 04396000
*/* P SET UP EXTENT NUMBER- M                                        */ 04397000
*/* P CALCULATE RELATIVE CYLINDER FOR DATA SET                       */ 04398000
*/* P CALCULATE RELATIVE TRACK FOR DATA SET                          */ 04399000
*/* P CALCULATE RECORD NUMBER- R                                     */ 04400000
*/* P CALCULATE ACTUAL CYLINDER FOR DEVICE                           */ 04401000
*/* P CALCULATE ACTUAL TRACK FOR DEVICE                              */ 04402000
*/*%CNVEXT: R RETURN TO CALLER                                       */ 04403000
*/*ILRCNVRT: END                                                     */ 04404000
*                                                                  0708 04405000
*ILRCNVRT:                                                         0708 04406000
*   PROC OPTIONS(NOSAVEAREA);                                      0708 04407000
ILRCNVRT STM   @14,@12,12(@13)                                     0708 04408000
*   DCL                                                            0709 04409000
*     1 CNVRTSKA CHAR(8) BASED(R1)  /* FULL SEEK ADDRESS             */ 04410000
*           BDY(DWORD),                                            0709 04411000
*      2 CNVRTM CHAR(1),            /* EXTENT NUMBER                 */ 04412000
*      2 * CHAR(2),                 /* BIN NUMBER                    */ 04413000
*      2 CNVRTCC CHAR(2),           /* CYLINDER NUMBER               */ 04414000
*      2 CNVRTHH CHAR(2),           /* TRACK (HEAD) NUMBER           */ 04415000
*      2 CNVRTR CHAR(1);            /* RECORD NUMBER                 */ 04416000
*   DCL                                                            0710 04417000
*     CNVRTBAD FIXED(31) CONSTANT(4);/* BAD RETURN CODE              */ 04418000
*   DCL                                                            0711 04419000
*     CNVRTOK FIXED(31) CONSTANT(0);/* GOOD RETURN CODE              */ 04420000
*   DCL                                                            0712 04421000
*     CNVRTRBA FIXED(31) DEFINED(CNVRTSKA);                        0712 04422000
*   DCL                                                            0713 04423000
*     CNVRTONE FIXED(31) CONSTANT(1);/* CONSTANT OF ONE              */ 04424000
*   RFY                                                            0714 04425000
*    (R0,                                                          0714 04426000
*     R1,                                                          0714 04427000
*     R2) RSTD;                     /* SAVE PARM REGISTERS           */ 04428000
*   R2=R0;                          /* SET UP EDBHDPTR IN REG2       */ 04429000
         LR    R2,R0                                               0715 04430000
*   RFY                                                            0716 04431000
*     R0 UNRSTD;                    /* NO NEED FOR R0                */ 04432000
*   RFY                                                            0717 04433000
*     R3 RSTD;                                                     0717 04434000
*   R3=R2+LENGTH(IDAEDBHD);         /* POINT R3 TO FIRST EDB ENTRY   */ 04435000
         LA    R3,8                                                0718 04436000
         ALR   R3,R2                                               0718 04437000
*   RFY                                                            0719 04438000
*     R5 RSTD;                                                     0719 04439000
*   R5=CNVRTRBA;                    /* RBA TO BE CONVERTED           */ 04440000
         L     R5,CNVRTRBA(,R1)                                    0720 04441000
*   RFY                                                            0721 04442000
*    (R4,                                                          0721 04443000
*     R15) RSTD;                                                   0721 04444000
*   R15=CNVRTBAD;                   /* INITIALIZE RETURN CODE        */ 04445000
         LA    R15,4                                               0722 04446000
*   DO R4=R2->EDBNO TO 1 BY-1       /* LOOP THROUGH EDB ENTRIES      */ 04447000
*         WHILE R15=CNVRTBAD;                                      0723 04448000
         SLR   R4,R4                                               0723 04449000
         IC    R4,EDBNO(,R2)                                       0723 04450000
         B     @DE00723                                            0723 04451000
@DL00723 C     R15,@CF00119                                        0723 04452000
         BNE   @DC00723                                            0723 04453000
*     IF R5=>R3->EDBLORBA&          /* IF RBA IN THIS EXTENT         */ 04454000
*         R5<=R3->EDBHIRBA THEN     /* THEN RESET RETURN CODE        */ 04455000
         CL    R5,EDBLORBA(,R3)                                    0724 04456000
         BL    @RF00724                                            0724 04457000
         CL    R5,EDBHIRBA(,R3)                                    0724 04458000
         BH    @RF00724                                            0724 04459000
*       R15=CNVRTOK;                                               0725 04460000
         SLR   R15,R15                                             0725 04461000
*     ELSE                          /* ELSE, CHECK NEXT ENTRY        */ 04462000
*       R3=R3+R2->EDBLEN;                                          0726 04463000
         B     @RC00724                                            0726 04464000
@RF00724 AH    R3,EDBLEN(,R2)                                      0726 04465000
*   END;                                                           0727 04466000
@RC00724 BCTR  R4,0                                                0727 04467000
@DE00723 LTR   R4,R4                                               0727 04468000
         BP    @DL00723                                            0727 04469000
@DC00723 DS    0H                                                  0728 04470000
*   IF R15=CNVRTOK                  /* IF FOUND EDB ENTRY,           */ 04471000
*     THEN                                                         0728 04472000
         LTR   R15,R15                                             0728 04473000
         BNZ   @RF00728                                            0728 04474000
*     DO;                           /* THEN DO CONVERSION            */ 04475000
*/*                                                                  */ 04476000
*/*                 FOUND EDB ENTRY                                  */ 04477000
*/*                                                                  */ 04478000
*                                                                  0730 04479000
*       R2=R3->EDBLPMBA;            /* GET LPMB ADDRESS              */ 04480000
         L     R2,EDBLPMBA(,R3)                                    0730 04481000
*       CNVRTSKA=''B;               /* ZERO FULL SEEK ADDRESS        */ 04482000
         XC    CNVRTSKA(8,R1),CNVRTSKA(R1)                         0731 04483000
*       R5=R5-R3->EDBLORBA;         /* RELATIVE RBA THIS EXTENT      */ 04484000
         SL    R5,EDBLORBA(,R3)                                    0732 04485000
*       CNVRTM=R3->EDBM;            /* SET UP EXTENT NUMBER          */ 04486000
         IC    @14,EDBM(,R3)                                       0733 04487000
         STC   @14,CNVRTM(,R1)                                     0733 04488000
*/*                                                                  */ 04489000
*/*          OPTIMIZE CODE BY USING ASSEMBLER FOR DIVISION           */ 04490000
*/*                                                                  */ 04491000
*                                                                  0734 04492000
*       GENERATE REFS(LPMAUSZ,LPMBPTRK,LPMBLKSZ,R2,R4,R5,CNVRTCC,  0734 04493000
*           CNVRTHH);                                              0734 04494000
*                                                                       04495000
*           CNVRTCC = REL RBA / BYTES PER ALLOCATION UNIT               04496000
*           R5= R5 / LPMAUSZ                                            04497000
*           R4= R5 // LPMAUSZ                                           04498000
*                                                                       04499000
            SR   R4,R4                 ZERO EVEN REGISTER               04500000
            D    R4,LPMAUSZ(,R2)       RBA / BYTES PER ALLOC UNIT       04501000
            STCM R5,3,CNVRTCC(R1)      RELATIVE CYL VALVE               04502000
            LR   R5,R4                 REMAINDER= RELATIVE TRACK        04503000
*                                                                       04504000
*           CNVRTHH = RELATIVE TRACK / BYTES PER TRACK                  04505000
*           R5= R5 / LPMBPTRK                                           04506000
*           R4= R5 // LPMBPTRK                                          04507000
*                                                                       04508000
            SR   R4,R4                 ZERO EVEN REGISTER               04509000
            D    R4,LPMBPTRK(,R2)      REL TRACK / BYTES PER TRACK      04510000
            STCM R5,3,CNVRTHH(R1)      RELATIVE TRACK VALVE             04511000
*                                                                       04512000
*           CNVRTR= (( RELATIVE RECORD + BLOCKSIZE -1) / BLOCKSIZE)+1   04513000
*                R7= ( R6 + LPMBLKSZ - 1 ) / LPMBLKSZ                   04514000
*                                                                       04515000
            A    R4,LPMBLKSZ(,R2)      ADD PHYSICAL BLOCKSIZE           04516000
            BCTR R4,0                  SUBTRACT 1 FOR ROUNDING          04517000
            LR   R5,R4                 SET UP FOR DIVISION              04518000
            SR   R4,R4                 ZERO EVEN REGISTER               04519000
            D    R4,LPMBLKSZ(,R2)      DIVIDE BY BLOCKSIZE              04520000
*       CNVRTR=R5+CNVRTONE;         /* RECORD NUMBER                 */ 04521000
         LA    @14,1                                               0735 04522000
         ALR   @14,R5                                              0735 04523000
         STC   @14,CNVRTR(,R1)                                     0735 04524000
*/*                                                                  */ 04525000
*/*      CNVRTCC=(CNVRTCC * LPMTRKAU + CNVRTHH + EDBSTTRK)/ LPMTPC   */ 04526000
*/*      CNVRTHH=(CNVRTCC * LPMTRKAU + CNVRTHH + EDBSTTRK)// LPMTPC  */ 04527000
*/*                                                                  */ 04528000
*                                                                  0736 04529000
*       R5=CNVRTCC*(R2->LPMTRKAU)+CNVRTHH+(R3->EDBSTTRK);          0736 04530000
         SLR   R5,R5                                               0736 04531000
         ICM   R5,3,CNVRTCC(R1)                                    0736 04532000
         MH    R5,LPMTRKAU(,R2)                                    0736 04533000
         SLR   @14,@14                                             0736 04534000
         ICM   @14,3,CNVRTHH(R1)                                   0736 04535000
         ALR   R5,@14                                              0736 04536000
         AL    R5,EDBSTTRK(,R3)                                    0736 04537000
*       GENERATE REFS(LPMTPC,R3,R4,R5,R2,R1,CNVRTCC,CNVRTHH);      0737 04538000
*                                                                       04539000
*           CNVRTCC= R5 / LPMTPC                                        04540000
*           CNVRTHH= R5 // LPMTPC                                       04541000
*                                                                       04542000
            SR    R4,R4                ZERO EVEN REGISTER               04543000
            LH    R3,LPMTPC(,R2)       PICK UP TRACKS PER CYLINDER      04544000
            DR   R4,R3                 R5 / LPMTPC                      04545000
            STCM R5,3,CNVRTCC(R1)      ACTUAL CYLINDER ADDRESS          04546000
            STCM R4,3,CNVRTHH(R1)      ACTUAL HEAD ADDRESS              04547000
*     END;                          /* END OF CONVERSION PROCESS     */ 04548000
*   RETURN CODE(R15);               /* RETURN TO CALLER              */ 04549000
@RF00728 L     @14,12(,@13)                                        0739 04550000
         LM    @00,@12,20(@13)                                     0739 04551000
         BR    @14                                                 0739 04552000
*   END ILRCNVRT;                                                  0740 04553000
*   RFY                                                            0741 04554000
*    (R1,                                                          0741 04555000
*     R2,                                                          0741 04556000
*     R3,                                                          0741 04557000
*     R4,                                                          0741 04558000
*     R5,                                                          0741 04559000
*     R15) UNRSTD;                                                 0741 04560000
*   END ILRSRT                                                     0742 04561000
*                                                                  0742 04562000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04563000
*/*%INCLUDE SYSLIB  (ILRAIA  )                                       */ 04564000
*/*%INCLUDE SYSLIB  (ILRASMVT)                                       */ 04565000
*/*%INCLUDE SYSLIB  (ILRATA  )                                       */ 04566000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 04567000
*/*%INCLUDE SYSLIB  (IDAEDB  )                                       */ 04568000
*/*%INCLUDE SYSLIB  (ILREPATH)                                       */ 04569000
*/*%INCLUDE SYSLIB  (IECDIOCM)                                       */ 04570000
*/*%INCLUDE SYSLIB  (ILRIOE  )                                       */ 04571000
*/*%INCLUDE SYSLIB  (ILRIORB )                                       */ 04572000
*/*%INCLUDE SYSLIB  (IECDIOSB)                                       */ 04573000
*/*%INCLUDE SYSLIB  (IDALPMB )                                       */ 04574000
*/*%INCLUDE SYSLIB  (ILRPART )                                       */ 04575000
*/*%INCLUDE SYSLIB  (ILRPAT  )                                       */ 04576000
*/*%INCLUDE SYSLIB  (IHAPCB  )                                       */ 04577000
*/*%INCLUDE SYSLIB  (ILRPCCW )                                       */ 04578000
*/*%INCLUDE SYSLIB  (ILRPCT  )                                       */ 04579000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 04580000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 04581000
*/*%INCLUDE SYSLIB  (ILRCNVRT)                                       */ 04582000
*                                                                  0742 04583000
*       ;                                                          0742 04584000
@DATA    DS    0H                                                       04585000
@DATD    DSECT                                                          04586000
         DS    0F                                                       04587000
ILRSRT   CSECT                                                          04588000
         DS    0F                                                       04589000
@CF00045 DC    F'1'                                                     04590000
@CF00084 DC    F'2'                                                     04591000
@CF00119 DC    F'4'                                                     04592000
@CF00032 DC    F'8'                                                     04593000
@CF01189 DC    F'36'                                                    04594000
@CF02144 DC    XL4'0000FFFF'                                            04595000
@DATD    DSECT                                                          04596000
         DS    0D                                                       04597000
ATAPTR   DS    A                                                        04598000
IORBPTR  DS    A                                                        04599000
PAREPTR  DS    A                                                        04600000
CYLMPWDS DS    F                                                        04601000
CYLSLOTS DS    F                                                        04602000
ENDCYL   DS    F                                                        04603000
FSRTNPTR DS    A                                                        04604000
PRMLADDR DS    A                                                        04605000
RETADDR1 DS    A                                                        04606000
RETADDR2 DS    A                                                        04607000
RETADDR3 DS    A                                                        04608000
REQNEED  DS    F                                                        04609000
SSECN    DS    F                                                        04610000
THISCYL  DS    F                                                        04611000
TSLOTNBR DS    F                                                        04612000
TOPRDIOE DS    A                                                        04613000
WRITEQUE DS    A                                                        04614000
ZEROLIST DS    CL58                                                     04615000
         ORG   ZEROLIST                                                 04616000
RETCODE  DS    FL4                                                      04617000
LASTSLOT DS    FL4                                                      04618000
LASTP    DS    AL4                                                      04619000
LASTTRK  DS    FL4                                                      04620000
LASTCYL  DS    FL4                                                      04621000
NUMREQS  DS    FL4                                                      04622000
READCYL  DS    FL4                                                      04623000
SCYLINFO DS    CL29                                                     04624000
         ORG   SCYLINFO                                                 04625000
SCYLCOPY DS    CL8                                                      04626000
SCYLREAD DS    CL8                                                      04627000
         ORG   SCYLREAD                                                 04628000
SCYLWRT  DS    CL8                                                      04629000
         ORG   SCYLINFO+16                                              04630000
SCYLRDWT DS    CL8                                                      04631000
SSLOT    DS    FL4                                                      04632000
SCYLFLGS DS    BL1                                                      04633000
         ORG   ZEROLIST+57                                              04634000
SRTFLGS  DS    BL1                                                      04635000
         ORG   SRTFLGS                                                  04636000
STOP     DS    BL1                                                      04637000
SEEK     EQU   SRTFLGS+0                                                04638000
SETSEC   EQU   SRTFLGS+0                                                04639000
DPFLG    EQU   SRTFLGS+0                                                04640000
         ORG   ZEROLIST+58                                              04641000
         DS    CL2                                                      04642000
SRTSA    DS    CL72                                                     04643000
         ORG   SRTSA                                                    04644000
@NM00061 DS    CL4                                                      04645000
CALLR13  DS    AL4                                                      04646000
@NM00062 DS    CL4                                                      04647000
SRTR14   DS    AL4                                                      04648000
SRTR15   DS    AL4                                                      04649000
SRTR0    DS    FL4                                                      04650000
SRTR1    DS    AL4                                                      04651000
SRTR2    DS    AL4                                                      04652000
         ORG   SRTSA+72                                                 04653000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04654000
@ENDDATD EQU   *                                                        04655000
ILRSRT   CSECT                                                          04656000
         NOPR  ((@ENDDATD-@DATD)/257*16)                                04657000
         DS    0F                                                       04658000
@SIZDATD DC    AL1(0)                                                   04659000
         DC    AL3(@ENDDATD-@DATD)                                      04660000
         DS    0D                                                       04661000
FSLOBIT1 DC    BL4'00000000000000000000000000000001'                    04662000
FSLOBIT4 DC    BL4'00000000000000000000000000001000'                    04663000
FSHIBIT3 DC    BL4'00100000000000000000000000000000'                    04664000
FS3COLR3 DC    BL4'00000000000000000000000001001001'                    04665000
FS3COLR5 DC    BL4'00000000000000000001001001001001'                    04666000
FS3COLR9 DC    BL4'00000001001001001001001001001001'                    04667000
FS3COLRB DC    BL4'01001001001001001001001001001001'                    04668000
FS3COLLB DC    BL4'10010010010010010010010010010010'                    04669000
FS3COLL5 DC    BL4'10010010010010000000000000000000'                    04670000
FS3COLL3 DC    BL4'10010010000000000000000000000000'                    04671000
FS4COLL6 DC    BL4'10001000100010001000100000000000'                    04672000
FS4COLL3 DC    BL4'10001000100000000000000000000000'                    04673000
FSDCOLL2 DC    BL4'10000000000001000000000000000000'                    04674000
FSF3     DC    F'3'                                                     04675000
FSF4     DC    F'4'                                                     04676000
FSF9     DC    F'9'                                                     04677000
FSF12    DC    F'12'                                                    04678000
FSF13    DC    F'13'                                                    04679000
FSF15    DC    F'15'                                                    04680000
FSF33    DC    F'33'                                                    04681000
ALLFFSTR DC    X'FFFFFFFFFFFFFFFF'                                      04682000
FFCMPARE DC    X'FF000000'                                              04683000
HIORDER8 DC    X'80000000'                                              04684000
DEVDTABL DS    CL4                                                      04685000
         ORG   DEVDTABL+0                                               04686000
DEVDFSRT DC    A(0)                                                     04687000
         ORG   DEVDTABL+4                                               04688000
         ORG   DEVDTABL+4                                               04689000
         DC    A(0)                                                     04690000
         ORG   DEVDTABL+8                                               04691000
         ORG   DEVDTABL+8                                               04692000
         DC    A(0)                                                     04693000
         ORG   DEVDTABL+12                                              04694000
         ORG   DEVDTABL+12                                              04695000
         DC    A(0)                                                     04696000
         ORG   DEVDTABL+16                                              04697000
         ORG   DEVDTABL+16                                              04698000
         DC    A(0)                                                     04699000
         ORG   DEVDTABL+20                                              04700000
         ORG   DEVDTABL+20                                              04701000
         DC    AL4(F23051S)                                             04702000
         ORG   DEVDTABL+24                                              04703000
         ORG   DEVDTABL+24                                              04704000
         DC    AL4(F23052S)                                             04705000
         ORG   DEVDTABL+28                                              04706000
         ORG   DEVDTABL+28                                              04707000
         DC    AL4(F2314S)                                              04708000
         ORG   DEVDTABL+32                                              04709000
         ORG   DEVDTABL+32                                              04710000
         DC    AL4(F3330S)                                              04711000
         ORG   DEVDTABL+36                                              04712000
         ORG   DEVDTABL+36                                              04713000
         DC    AL4(F3340S)                                              04714000
         ORG   DEVDTABL+40                                              04715000
         ORG   DEVDTABL+40                                              04716000
         DC    AL4(F3350S)                                              04717000
         ORG   DEVDTABL+44                                              04718000
         ORG   DEVDTABL+44                                              04719000
         DC    A(0)                                                     04720000
         ORG   DEVDTABL+48                                              04721000
         ORG   DEVDTABL+48                                              04722000
         DC    AL4(F3330S)                                              04723000
         ORG   DEVDTABL+52                                              04724000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04725000
@01      EQU   01                                                       04726000
@02      EQU   02                                                       04727000
@03      EQU   03                                                       04728000
@04      EQU   04                                                       04729000
@05      EQU   05                                                       04730000
@06      EQU   06                                                       04731000
@07      EQU   07                                                       04732000
@08      EQU   08                                                       04733000
@09      EQU   09                                                       04734000
@10      EQU   10                                                       04735000
@11      EQU   11                                                       04736000
@12      EQU   12                                                       04737000
@13      EQU   13                                                       04738000
@14      EQU   14                                                       04739000
@15      EQU   15                                                       04740000
TORBA    EQU   @06                                                      04741000
THISNODE EQU   @02                                                      04742000
STRTCYL  EQU   @05                                                      04743000
RELPOS   EQU   @07                                                      04744000
NEXTNODE EQU   @02                                                      04745000
NEXTLE   EQU   @05                                                      04746000
NEXTGT   EQU   @07                                                      04747000
LSIDPTR  EQU   @02                                                      04748000
LASTNODE EQU   @06                                                      04749000
CURRBA   EQU   @05                                                      04750000
PMAPADDR EQU   @02                                                      04751000
PCTPTR   EQU   @11                                                      04752000
PCCWPTR  EQU   @02                                                      04753000
PCBPTR   EQU   @06                                                      04754000
IOSBPTR  EQU   @05                                                      04755000
IOEPTR   EQU   @12                                                      04756000
AIAPTR   EQU   @05                                                      04757000
ASMVTPTR EQU   @03                                                      04758000
EPAPTR   EQU   @04                                                      04759000
R0       EQU   @00                                                      04760000
R1       EQU   @01                                                      04761000
R2       EQU   @02                                                      04762000
R3       EQU   @03                                                      04763000
R4       EQU   @04                                                      04764000
R5       EQU   @05                                                      04765000
R7       EQU   @07                                                      04766000
R9       EQU   @09                                                      04767000
R12      EQU   @12                                                      04768000
R13      EQU   @13                                                      04769000
R14      EQU   @14                                                      04770000
R15      EQU   @15                                                      04771000
R10      EQU   @10                                                      04772000
R11      EQU   @11                                                      04773000
R6       EQU   @06                                                      04774000
R8       EQU   @08                                                      04775000
PSA      EQU   0                                                        04776000
FLCRNPSW EQU   PSA                                                      04777000
FLCROPSW EQU   PSA+8                                                    04778000
FLCICCW2 EQU   PSA+16                                                   04779000
FLCCVT   EQU   FLCICCW2                                                 04780000
PSAEEPSW EQU   PSA+132                                                  04781000
PSAESPSW EQU   PSA+136                                                  04782000
FLCSVILC EQU   PSAESPSW+1                                               04783000
PSAEPPSW EQU   PSA+140                                                  04784000
FLCPIILC EQU   PSAEPPSW+1                                               04785000
FLCPICOD EQU   PSAEPPSW+2                                               04786000
PSAPICOD EQU   FLCPICOD+1                                               04787000
FLCTEA   EQU   PSAEPPSW+4                                               04788000
FLCPER   EQU   PSA+152                                                  04789000
FLCMCLA  EQU   PSA+168                                                  04790000
FLCIOEL  EQU   FLCMCLA+4                                                04791000
FLCIOA   EQU   FLCMCLA+16                                               04792000
FLCFSA   EQU   FLCMCLA+80                                               04793000
PSASUPER EQU   PSA+552                                                  04794000
PSASUP1  EQU   PSASUPER                                                 04795000
PSASUP2  EQU   PSASUPER+1                                               04796000
PSASUP3  EQU   PSASUPER+2                                               04797000
PSASUP4  EQU   PSASUPER+3                                               04798000
PSACLHT  EQU   PSA+640                                                  04799000
PSALKSA  EQU   PSA+696                                                  04800000
PSAHLHI  EQU   PSA+760                                                  04801000
PSADSSFL EQU   PSA+836                                                  04802000
PSADSSF1 EQU   PSADSSFL                                                 04803000
PSADSSF3 EQU   PSADSSFL+2                                               04804000
PSADSSF4 EQU   PSADSSFL+3                                               04805000
PSARSVT  EQU   PSA+896                                                  04806000
AIA      EQU   0                                                        04807000
AIAFLG1  EQU   AIA+9                                                    04808000
AIAWRITE EQU   AIAFLG1                                                  04809000
AIADUPLX EQU   AIAFLG1                                                  04810000
AIAFLG2  EQU   AIA+10                                                   04811000
AIAFLG3  EQU   AIA+11                                                   04812000
AIANXAIA EQU   AIA+12                                                   04813000
AIACYL   EQU   AIANXAIA                                                 04814000
AIARCSN  EQU   AIANXAIA+2                                               04815000
AIAID    EQU   AIA+16                                                   04816000
AIALPID  EQU   AIAID                                                    04817000
AIALGID  EQU   AIALPID                                                  04818000
AIALSID  EQU   AIALGID                                                  04819000
AIASSID  EQU   AIALSID+1                                                04820000
AIASLOT  EQU   AIASSID+1                                                04821000
AIARPN   EQU   AIALPID+4                                                04822000
AIALSID2 EQU   AIARPN                                                   04823000
AIALPMEP EQU   AIALSID2                                                 04824000
AIAGRPSZ EQU   AIA+24                                                   04825000
AIALGE   EQU   AIAGRPSZ                                                 04826000
ASMVT    EQU   0                                                        04827000
ASMFLAG1 EQU   ASMVT                                                    04828000
ASMFLAG2 EQU   ASMVT+1                                                  04829000
ASMPART  EQU   ASMVT+8                                                  04830000
ASMSTAGQ EQU   ASMVT+32                                                 04831000
ASMPCCWQ EQU   ASMVT+64                                                 04832000
ASMBURST EQU   ASMVT+76                                                 04833000
ASMIOCNT EQU   ASMVT+80                                                 04834000
ASMLSAI  EQU   ASMVT+144                                                04835000
ASMGOSQS EQU   ASMVT+152                                                04836000
ASMIOEPC EQU   ASMVT+296                                                04837000
ASMWKSA1 EQU   ASMVT+368                                                04838000
ASMWKSA2 EQU   ASMVT+448                                                04839000
ASMWKSA3 EQU   ASMVT+528                                                04840000
ASMWKSA4 EQU   ASMVT+608                                                04841000
ASMWKSA5 EQU   ASMVT+688                                                04842000
ASMPOOLS EQU   0                                                        04843000
ASMCPAVQ EQU   ASMPOOLS+8                                               04844000
ASMCPAVL EQU   ASMCPAVQ                                                 04845000
ASMCPRSQ EQU   ASMPOOLS+16                                              04846000
ATA      EQU   0                                                        04847000
ATASFLGS EQU   ATA+1                                                    04848000
ATASRT   EQU   ATASFLGS+1                                               04849000
ATARFLGS EQU   ATA+4                                                    04850000
ATARCRSN EQU   ATA+6                                                    04851000
ATACLEAR EQU   ATA+8                                                    04852000
ATAEPATH EQU   ATACLEAR+4                                               04853000
CVTMAP   EQU   0                                                        04854000
CVTDAR   EQU   CVTMAP+72                                                04855000
CVTFLGS1 EQU   CVTDAR                                                   04856000
CVTDCB   EQU   CVTMAP+116                                               04857000
CVTIOQET EQU   CVTMAP+120                                               04858000
CVTIXAVL EQU   CVTMAP+124                                               04859000
CVTIERLC EQU   CVTMAP+144                                               04860000
CVTHEAD  EQU   CVTMAP+160                                               04861000
CVTSV76C EQU   CVTHEAD                                                  04862000
CVTOPTA  EQU   CVTMAP+182                                               04863000
CVTOPTB  EQU   CVTMAP+183                                               04864000
CVTGTF   EQU   CVTMAP+236                                               04865000
CVTGTFST EQU   CVTGTF                                                   04866000
CVTGTFS  EQU   CVTGTFST                                                 04867000
CVTSTATE EQU   CVTGTFST                                                 04868000
CVTTMODE EQU   CVTGTFST                                                 04869000
CVTFORM  EQU   CVTGTFST                                                 04870000
CVTAQAVT EQU   CVTMAP+240                                               04871000
CVTTCMFG EQU   CVTAQAVT                                                 04872000
CVTVOLM2 EQU   CVTMAP+244                                               04873000
CVTTATA  EQU   CVTVOLM2                                                 04874000
CVTTSKS  EQU   CVTTATA                                                  04875000
CVTVOLF2 EQU   CVTTSKS                                                  04876000
CVTTAT   EQU   CVTTATA+1                                                04877000
CVTATER  EQU   CVTMAP+248                                               04878000
CVTEXT1  EQU   CVTMAP+252                                               04879000
CVTPURG  EQU   CVTMAP+260                                               04880000
CVTQMSG  EQU   CVTMAP+268                                               04881000
CVTDMSR  EQU   CVTMAP+272                                               04882000
CVTRSV37 EQU   CVTDMSR                                                  04883000
CVTDMSRF EQU   CVTRSV37                                                 04884000
CVTERPV  EQU   CVTMAP+316                                               04885000
CVTINTLA EQU   CVTMAP+320                                               04886000
CVTAPF   EQU   CVTMAP+324                                               04887000
CVTEXT2  EQU   CVTMAP+328                                               04888000
CVTHJES  EQU   CVTMAP+332                                               04889000
CVTPGSIA EQU   CVTMAP+348                                               04890000
CVTA1F1  EQU   CVTMAP+356                                               04891000
CVTSYSK  EQU   CVTMAP+357                                               04892000
CVTVOLM1 EQU   CVTMAP+380                                               04893000
CVTVOLF1 EQU   CVTVOLM1                                                 04894000
CVTATMCT EQU   CVTMAP+388                                               04895000
CVTXTNT1 EQU   0                                                        04896000
CVTXTNT2 EQU   0                                                        04897000
CVTDSSV  EQU   CVTXTNT2                                                 04898000
CVTFLGBT EQU   CVTXTNT2+5                                               04899000
CVTQID   EQU   CVTXTNT2+24                                              04900000
CVTRV400 EQU   CVTXTNT2+52                                              04901000
CVTRV409 EQU   CVTXTNT2+53                                              04902000
CVTATCVT EQU   CVTXTNT2+64                                              04903000
CVTRV429 EQU   CVTXTNT2+84                                              04904000
CVTRV438 EQU   CVTXTNT2+85                                              04905000
CVTRV457 EQU   CVTXTNT2+112                                             04906000
CVTRV466 EQU   CVTXTNT2+113                                             04907000
CVTFIX   EQU   0                                                        04908000
CVTRELNO EQU   CVTFIX+252                                               04909000
IDAEDBHD EQU   0                                                        04910000
EDBNO    EQU   IDAEDBHD+1                                               04911000
EDBLEN   EQU   IDAEDBHD+2                                               04912000
IDAEDB   EQU   0                                                        04913000
EDBFLG1  EQU   IDAEDB+2                                                 04914000
EDBM     EQU   IDAEDB+3                                                 04915000
EDBLPMBA EQU   IDAEDB+4                                                 04916000
EDBSTTRK EQU   IDAEDB+8                                                 04917000
EDBLORBA EQU   IDAEDB+12                                                04918000
EDBHIRBA EQU   IDAEDB+16                                                04919000
EPATH    EQU   0                                                        04920000
EPAIOEIP EQU   EPATH+4                                                  04921000
EPAFFIOE EQU   EPATH+12                                                 04922000
EPALFIOE EQU   EPATH+16                                                 04923000
EPAWTPAT EQU   EPATH+24                                                 04924000
EPACYLA  EQU   EPATH+28                                                 04925000
EPAWRTCT EQU   EPATH+36                                                 04926000
IOCOM    EQU   0                                                        04927000
IOCSTIO  EQU   IOCOM+28                                                 04928000
IOCOMPTR EQU   0                                                        04929000
IOE      EQU   0                                                        04930000
IOENXT   EQU   IOE                                                      04931000
IOENXTLE EQU   IOENXT                                                   04932000
IOELSIDA EQU   IOE+4                                                    04933000
IOENXTGT EQU   IOELSIDA                                                 04934000
IOEAIA   EQU   IOE+8                                                    04935000
IOEWORK  EQU   IOE+12                                                   04936000
IOEBKPTR EQU   IOEWORK                                                  04937000
IORB     EQU   0                                                        04938000
IORRQSZ  EQU   IORB+2                                                   04939000
IORFLGS  EQU   IORB+3                                                   04940000
IORFUSE  EQU   IORFLGS                                                  04941000
IORFRPS  EQU   IORFLGS                                                  04942000
IORAPND  EQU   IORFLGS                                                  04943000
IORPCCW  EQU   IORB+8                                                   04944000
IORIOSB  EQU   IORB+12                                                  04945000
IORTSMP  EQU   IORB+24                                                  04946000
IOSB     EQU   0                                                        04947000
IOSFLA   EQU   IOSB                                                     04948000
IOSACHN  EQU   IOSFLA                                                   04949000
IOSFLB   EQU   IOSB+1                                                   04950000
IOSFLC   EQU   IOSB+2                                                   04951000
IOSDVALT EQU   IOSFLC                                                   04952000
IOSPROC  EQU   IOSB+3                                                   04953000
IOSPKEY  EQU   IOSB+12                                                  04954000
IOSOPT   EQU   IOSB+14                                                  04955000
IOSOPT2  EQU   IOSB+15                                                  04956000
IOSUCB   EQU   IOSB+16                                                  04957000
@NM00015 EQU   IOSB+20                                                  04958000
IOSCSW   EQU   @NM00015+1                                               04959000
IOSTATUS EQU   IOSCSW+3                                                 04960000
IOSSRB   EQU   IOSB+28                                                  04961000
IOSIPIB  EQU   IOSB+44                                                  04962000
IOSERP   EQU   IOSB+52                                                  04963000
IOSRST   EQU   IOSB+72                                                  04964000
IOSVST   EQU   IOSB+76                                                  04965000
IOSPATH  EQU   IOSB+86                                                  04966000
IOSCHN   EQU   IOSPATH                                                  04967000
IOSCKEY  EQU   IOSB+89                                                  04968000
IOSEEK   EQU   IOSB+92                                                  04969000
IOSEEKA  EQU   IOSB+100                                                 04970000
IOSCCHH  EQU   IOSEEKA+3                                                04971000
IOSSKHH  EQU   IOSCCHH+2                                                04972000
IDALPMB  EQU   0                                                        04973000
LPMBFLGS EQU   IDALPMB+1                                                04974000
LPMAUSZ  EQU   IDALPMB+4                                                04975000
LPMBPTRK EQU   IDALPMB+8                                                04976000
LPMBLKSZ EQU   IDALPMB+12                                               04977000
LPMTRKAU EQU   IDALPMB+16                                               04978000
LPMTPC   EQU   IDALPMB+18                                               04979000
PART     EQU   0                                                        04980000
PARTHDR  EQU   PART                                                     04981000
PARTTPAR EQU   PARTHDR+24                                               04982000
PARTCOMQ EQU   PARTHDR+48                                               04983000
PARTSPLQ EQU   PARTHDR+56                                               04984000
PARTDUPQ EQU   PARTHDR+64                                               04985000
PARTLOCQ EQU   PARTHDR+72                                               04986000
PARTENT  EQU   0                                                        04987000
PARELKUP EQU   PARTENT+4                                                04988000
PARELKFL EQU   PARELKUP                                                 04989000
PARETYPE EQU   PARTENT+8                                                04990000
PAREFLG1 EQU   PARTENT+9                                                04991000
PARENN   EQU   PARTENT+10                                               04992000
PAREIOEQ EQU   PARTENT+12                                               04993000
PARESLTA EQU   PARTENT+20                                               04994000
PAREPATP EQU   PARTENT+32                                               04995000
PAREPCTP EQU   PARTENT+36                                               04996000
PAREEDBP EQU   PARTENT+40                                               04997000
PAREUCBP EQU   PARTENT+44                                               04998000
PARENODE EQU   PARTENT+48                                               04999000
PARERQTM EQU   PARTENT+56                                               05000000
PARELCYL EQU   PARTENT+60                                               05001000
PAT      EQU   0                                                        05002000
PATHDR   EQU   PAT                                                      05003000
PATCYLNO EQU   PATHDR+8                                                 05004000
PATCYLSZ EQU   PATHDR+10                                                05005000
PATCYLMW EQU   PATHDR+12                                                05006000
PATMAP   EQU   PAT+16                                                   05007000
PATCYL   EQU   0                                                        05008000
PATCYLMP EQU   0                                                        05009000
PCB      EQU   0                                                        05010000
PCBFQP   EQU   PCB                                                      05011000
PCBBQP   EQU   PCB+4                                                    05012000
PCBRTP   EQU   PCB+8                                                    05013000
PCBFL1   EQU   PCBRTP                                                   05014000
PCBRLP   EQU   PCB+12                                                   05015000
PCBXPT   EQU   PCB+16                                                   05016000
PCBFL2   EQU   PCBXPT                                                   05017000
PCBPGT   EQU   PCB+20                                                   05018000
PCBFL3   EQU   PCBPGT                                                   05019000
PCBRBN   EQU   PCB+24                                                   05020000
PCBBLOCK EQU   PCB+28                                                   05021000
PCBSRB   EQU   PCBBLOCK                                                 05022000
PCBRB    EQU   PCBSRB                                                   05023000
PCCW     EQU   0                                                        05024000
PCCWSECT EQU   PCCW+1                                                   05025000
PCCWFLGS EQU   PCCW+2                                                   05026000
PCCWFERR EQU   PCCWFLGS                                                 05027000
PCCWPCCW EQU   PCCW+4                                                   05028000
PCCWAIA  EQU   PCCW+8                                                   05029000
PCCWIORB EQU   PCCW+12                                                  05030000
PCCWCHHR EQU   PCCW+16                                                  05031000
PCCWCC   EQU   PCCWCHHR+3                                               05032000
PCCWHH   EQU   PCCWCHHR+5                                               05033000
PCCWSEEK EQU   PCCW+24                                                  05034000
PCCWSK   EQU   PCCWSEEK                                                 05035000
PCCWSSEC EQU   PCCW+32                                                  05036000
PCCWSS   EQU   PCCWSSEC                                                 05037000
PCCWSSAD EQU   PCCWSSEC+1                                               05038000
PCCWSRCH EQU   PCCW+40                                                  05039000
PCCWTIC  EQU   PCCW+48                                                  05040000
PCCWRW   EQU   PCCW+56                                                  05041000
PCCWRDWT EQU   PCCWRW                                                   05042000
PCCWADDR EQU   PCCWRW+1                                                 05043000
PCCWNOP  EQU   PCCW+64                                                  05044000
PCCWN    EQU   PCCWNOP                                                  05045000
PCCWNAD  EQU   PCCWNOP+1                                                05046000
PCCWNFG  EQU   PCCWNOP+4                                                05047000
PCT      EQU   0                                                        05048000
PCTDTYPX EQU   PCT+12                                                   05049000
PCTSSECN EQU   PCT+30                                                   05050000
PCTMAXTK EQU   PCT+36                                                   05051000
PCTMSSB  EQU   PCT+38                                                   05052000
PCTABLE  EQU   PCT+40                                                   05053000
PCTSECT  EQU   PCTABLE                                                  05054000
PCTSLTNM EQU   PCTSECT                                                  05055000
PCTFOVFL EQU   PCTSLTNM                                                 05056000
PCTSECNM EQU   PCTSECT+1                                                05057000
PCTTRBA  EQU   PCTSECT+2                                                05058000
SRBSECT  EQU   0                                                        05059000
SRB      EQU   SRBSECT                                                  05060000
SRBFLC   EQU   SRB+12                                                   05061000
CALLSA   EQU   0                                                        05062000
CALLR15  EQU   CALLSA+16                                                05063000
PARMLIST EQU   0                                                        05064000
PTRIORB  EQU   PARMLIST                                                 05065000
PTRPARE  EQU   PARMLIST+4                                               05066000
PTRPCCW  EQU   PARMLIST+8                                               05067000
PTRWRITE EQU   PARMLIST+12                                              05068000
PTRWORK  EQU   PARMLIST+16                                              05069000
GOODLSID EQU   0                                                        05070000
PRTNN    EQU   GOODLSID+1                                               05071000
SLOT     EQU   GOODLSID+2                                               05072000
FINDSLOT EQU   0                                                        05073000
CNVRTSKA EQU   0                                                        05074000
CNVRTM   EQU   CNVRTSKA                                                 05075000
CNVRTCC  EQU   CNVRTSKA+3                                               05076000
CNVRTHH  EQU   CNVRTSKA+5                                               05077000
CNVRTR   EQU   CNVRTSKA+7                                               05078000
ASM1WKSV EQU   ASMWKSA1                                                 05079000
ASM1RGSV EQU   ASM1WKSV                                                 05080000
ASM1WRKA EQU   ASM1WKSV+60                                              05081000
ASM2WKSV EQU   ASMWKSA2                                                 05082000
ASM2WRKA EQU   ASM2WKSV+52                                              05083000
ASM2FLGS EQU   ASM2WRKA+12                                              05084000
ASM3WKSV EQU   ASMWKSA3                                                 05085000
ASM4WKSV EQU   ASMWKSA4                                                 05086000
ASM4RGSV EQU   ASM4WKSV                                                 05087000
ASM5WKSV EQU   ASMWKSA5                                                 05088000
ASM5RGSV EQU   ASM5WKSV                                                 05089000
CVTPTR   EQU   FLCCVT                                                   05090000
CVTS01   EQU   CVTPGSIA                                                 05091000
CVTLPDIA EQU   CVTS01+12                                                05092000
CVTDIRST EQU   CVTLPDIA                                                 05093000
CVTSLIDA EQU   CVTS01+24                                                05094000
CVTCTLFG EQU   CVTS01+50                                                05095000
CVTRV210 EQU   CVTS01+424                                               05096000
CVTRV219 EQU   CVTS01+425                                               05097000
CVTRV228 EQU   CVTS01+426                                               05098000
CVTRV237 EQU   CVTS01+427                                               05099000
CVTMFRTR EQU   CVTS01+452                                               05100000
CVTRV262 EQU   CVTS01+468                                               05101000
CVTRV271 EQU   CVTS01+469                                               05102000
CVTRV280 EQU   CVTS01+470                                               05103000
CVTRV289 EQU   CVTS01+471                                               05104000
CVTGSDA  EQU   CVTS01+600                                               05105000
IOSATTSC EQU   IOSIPIB                                                  05106000
IOSWTOWA EQU   IOSIPIB                                                  05107000
IOSPCISC EQU   IOSIPIB                                                  05108000
PARTPTR  EQU   ASMPART                                                  05109000
PATPTR   EQU   PAREPATP                                                 05110000
PSARSVTE EQU   PSARSVT                                                  05111000
SRBPTR   EQU   IOSSRB                                                   05112000
PNODETST EQU   PARENODE                                                 05113000
DEVDTABX EQU   PCTDTYPX+1                                               05114000
CNVRTRBA EQU   CNVRTSKA                                                 05115000
FLC      EQU   PSA                                                      05116000
FSF1     EQU   FSLOBIT1                                                 05117000
*                                      START UNREFERENCED COMPONENTS    05118000
PSARSAV  EQU   PSARSVTE+60                                              05119000
PSARSTK  EQU   PSARSVTE+56                                              05120000
PSAESAV3 EQU   PSARSVTE+52                                              05121000
PSAESTK3 EQU   PSARSVTE+48                                              05122000
PSAESAV2 EQU   PSARSVTE+44                                              05123000
PSAESTK2 EQU   PSARSVTE+40                                              05124000
PSAESAV1 EQU   PSARSVTE+36                                              05125000
PSAESTK1 EQU   PSARSVTE+32                                              05126000
PSAPSAV  EQU   PSARSVTE+28                                              05127000
PSAPSTK  EQU   PSARSVTE+24                                              05128000
PSAMSAV  EQU   PSARSVTE+20                                              05129000
PSAMSTK  EQU   PSARSVTE+16                                              05130000
PSASSAV  EQU   PSARSVTE+12                                              05131000
PSASSTK  EQU   PSARSVTE+8                                               05132000
PSANSTK  EQU   PSARSVTE+4                                               05133000
PSACSTK  EQU   PSARSVTE                                                 05134000
IOSPCIWA EQU   IOSPCISC+44                                              05135000
IOSPCIRS EQU   IOSPCISC+8                                               05136000
@NM00020 EQU   IOSPCISC+4                                               05137000
@NM00019 EQU   IOSPCISC                                                 05138000
IOSWRNDR EQU   IOSWTOWA+4                                               05139000
IOSWTOPT EQU   IOSWTOWA+3                                               05140000
IOSWTOCP EQU   IOSWTOWA+2                                               05141000
IOSWTOCH EQU   IOSWTOWA                                                 05142000
IOSATTWA EQU   IOSATTSC+40                                              05143000
@NM00018 EQU   IOSATTSC+24                                              05144000
IOSATTSN EQU   IOSATTSC                                                 05145000
CVTRV628 EQU   CVTS01+728                                               05146000
CVTRV627 EQU   CVTS01+724                                               05147000
CVTRV626 EQU   CVTS01+720                                               05148000
CVTRV625 EQU   CVTS01+716                                               05149000
CVTRV624 EQU   CVTS01+712                                               05150000
CVTRV623 EQU   CVTS01+708                                               05151000
CVTRV622 EQU   CVTS01+704                                               05152000
CVTRV621 EQU   CVTS01+700                                               05153000
CVTIHASU EQU   CVTS01+696                                               05154000
CVTSUSP  EQU   CVTS01+692                                               05155000
CVTT6SVC EQU   CVTS01+688                                               05156000
CVTCDAL  EQU   CVTS01+684                                               05157000
CVTTCTL  EQU   CVTS01+680                                               05158000
CVTRSUME EQU   CVTS01+676                                               05159000
CVTJTERM EQU   CVTS01+672                                               05160000
CVTASMRM EQU   CVTS01+668                                               05161000
CVTTCASP EQU   CVTS01+664                                               05162000
CVT0PT03 EQU   CVTS01+660                                               05163000
CVT0PT0E EQU   CVTS01+656                                               05164000
CVTRV609 EQU   CVTS01+652                                               05165000
CVTCGK   EQU   CVTS01+648                                               05166000
CVTRAC   EQU   CVTS01+644                                               05167000
CVTHSM   EQU   CVTS01+640                                               05168000
CVTRV605 EQU   CVTS01+636                                               05169000
CVTRV604 EQU   CVTS01+632                                               05170000
CVTEFF02 EQU   CVTS01+628                                               05171000
CVTCBBR  EQU   CVTS01+624                                               05172000
CVTSSCR  EQU   CVTS01+620                                               05173000
CVTEVENT EQU   CVTS01+616                                               05174000
CVTCRCA  EQU   CVTS01+612                                               05175000
CVTTPIO  EQU   CVTS01+608                                               05176000
CVTADV   EQU   CVTS01+604                                               05177000
CVTGSDAB EQU   CVTGSDA                                                  05178000
CVTQV3   EQU   CVTS01+596                                               05179000
CVTQV2   EQU   CVTS01+592                                               05180000
CVTQV1   EQU   CVTS01+588                                               05181000
CVTRPT   EQU   CVTS01+584                                               05182000
CVTSSRB  EQU   CVTS01+580                                               05183000
CVTCSDRL EQU   CVTS01+576                                               05184000
CVTEXP1  EQU   CVTS01+572                                               05185000
CVTRMPMT EQU   CVTS01+568                                               05186000
CVTRMPTT EQU   CVTS01+564                                               05187000
CVTVPSA  EQU   CVTS01+560                                               05188000
CVTVSTOP EQU   CVTS01+556                                               05189000
CVTGTFR8 EQU   CVTS01+552                                               05190000
CVTQUIT  EQU   CVTS01+548                                               05191000
CVTVACR  EQU   CVTS01+544                                               05192000
CVTWTCB  EQU   CVTS01+540                                               05193000
CVTSTPRS EQU   CVTS01+536                                               05194000
CVT0PT02 EQU   CVTS01+532                                               05195000
CVTDARCM EQU   CVTS01+528                                               05196000
CVTIRECM EQU   CVTS01+524                                               05197000
CVTJRECM EQU   CVTS01+520                                               05198000
CVTVEMS0 EQU   CVTS01+516                                               05199000
CVTSPFRR EQU   CVTS01+512                                               05200000
CVTRLSTG EQU   CVTS01+508                                               05201000
CVT0TC0A EQU   CVTS01+504                                               05202000
CVTGMBR  EQU   CVTS01+500                                               05203000
CVTLFRM  EQU   CVTS01+496                                               05204000
CVTRMBR  EQU   CVTS01+492                                               05205000
CVTVIOP  EQU   CVTS01+488                                               05206000
CVTRV307 EQU   CVTS01+486                                               05207000
CVTRV306 EQU   CVTS01+484                                               05208000
CVTRV305 EQU   CVTS01+482                                               05209000
CVTRV304 EQU   CVTS01+480                                               05210000
CVTRV303 EQU   CVTS01+478                                               05211000
CVTRV302 EQU   CVTS01+476                                               05212000
CVTTRCA  EQU   CVTS01+472                                               05213000
CVTRV297 EQU   CVTRV289                                                 05214000
CVTRV296 EQU   CVTRV289                                                 05215000
CVTRV295 EQU   CVTRV289                                                 05216000
CVTRV294 EQU   CVTRV289                                                 05217000
CVTRV293 EQU   CVTRV289                                                 05218000
CVTRV292 EQU   CVTRV289                                                 05219000
CVTRV291 EQU   CVTRV289                                                 05220000
CVTRV290 EQU   CVTRV289                                                 05221000
CVTRV288 EQU   CVTRV280                                                 05222000
CVTRV287 EQU   CVTRV280                                                 05223000
CVTRV286 EQU   CVTRV280                                                 05224000
CVTRV285 EQU   CVTRV280                                                 05225000
CVTRV284 EQU   CVTRV280                                                 05226000
CVTRV283 EQU   CVTRV280                                                 05227000
CVTRV282 EQU   CVTRV280                                                 05228000
CVTRV281 EQU   CVTRV280                                                 05229000
CVTRV279 EQU   CVTRV271                                                 05230000
CVTRV278 EQU   CVTRV271                                                 05231000
CVTRV277 EQU   CVTRV271                                                 05232000
CVTRV276 EQU   CVTRV271                                                 05233000
CVTRV275 EQU   CVTRV271                                                 05234000
CVTRV274 EQU   CVTRV271                                                 05235000
CVTRV273 EQU   CVTRV271                                                 05236000
CVTRV272 EQU   CVTRV271                                                 05237000
CVTRV270 EQU   CVTRV262                                                 05238000
CVTRV269 EQU   CVTRV262                                                 05239000
CVTRV268 EQU   CVTRV262                                                 05240000
CVTRV267 EQU   CVTRV262                                                 05241000
CVTRV266 EQU   CVTRV262                                                 05242000
CVTRV265 EQU   CVTRV262                                                 05243000
CVTRV264 EQU   CVTRV262                                                 05244000
CVTRV263 EQU   CVTRV262                                                 05245000
CVTVFP   EQU   CVTS01+464                                               05246000
CVTVSI   EQU   CVTS01+460                                               05247000
CVTVPSIB EQU   CVTS01+456                                               05248000
CVTMFACT EQU   CVTMFRTR                                                 05249000
CVTMFCTL EQU   CVTS01+448                                               05250000
CVTPVBP  EQU   CVTS01+444                                               05251000
CVTPWI   EQU   CVTS01+440                                               05252000
CVTRV254 EQU   CVTS01+438                                               05253000
CVTRV253 EQU   CVTS01+436                                               05254000
CVTRV252 EQU   CVTS01+434                                               05255000
CVTRV251 EQU   CVTS01+433                                               05256000
CVTRV250 EQU   CVTS01+432                                               05257000
CVTRV249 EQU   CVTS01+431                                               05258000
CVTRV248 EQU   CVTS01+430                                               05259000
CVTRV247 EQU   CVTS01+429                                               05260000
CVTRV246 EQU   CVTS01+428                                               05261000
CVTRV245 EQU   CVTRV237                                                 05262000
CVTRV244 EQU   CVTRV237                                                 05263000
CVTRV243 EQU   CVTRV237                                                 05264000
CVTRV242 EQU   CVTRV237                                                 05265000
CVTRV241 EQU   CVTRV237                                                 05266000
CVTRV240 EQU   CVTRV237                                                 05267000
CVTRV239 EQU   CVTRV237                                                 05268000
CVTRV238 EQU   CVTRV237                                                 05269000
CVTRV236 EQU   CVTRV228                                                 05270000
CVTRV235 EQU   CVTRV228                                                 05271000
CVTRV234 EQU   CVTRV228                                                 05272000
CVTRV233 EQU   CVTRV228                                                 05273000
CVTRV232 EQU   CVTRV228                                                 05274000
CVTRV231 EQU   CVTRV228                                                 05275000
CVTRV230 EQU   CVTRV228                                                 05276000
CVTRV229 EQU   CVTRV228                                                 05277000
CVTRV227 EQU   CVTRV219                                                 05278000
CVTRV226 EQU   CVTRV219                                                 05279000
CVTRV225 EQU   CVTRV219                                                 05280000
CVTRV224 EQU   CVTRV219                                                 05281000
CVTRV223 EQU   CVTRV219                                                 05282000
CVTRV222 EQU   CVTRV219                                                 05283000
CVTRV221 EQU   CVTRV219                                                 05284000
CVTRV220 EQU   CVTRV219                                                 05285000
CVTRV218 EQU   CVTRV210                                                 05286000
CVTRV217 EQU   CVTRV210                                                 05287000
CVTRV216 EQU   CVTRV210                                                 05288000
CVTRV215 EQU   CVTRV210                                                 05289000
CVTRV214 EQU   CVTRV210                                                 05290000
CVTRV213 EQU   CVTRV210                                                 05291000
CVTRV212 EQU   CVTRV210                                                 05292000
CVTRV211 EQU   CVTRV210                                                 05293000
CVTLCCAT EQU   CVTS01+420                                               05294000
CVTPCCAT EQU   CVTS01+416                                               05295000
CVTIPCRP EQU   CVTS01+412                                               05296000
CVTIPCRI EQU   CVTS01+408                                               05297000
CVTIPCDS EQU   CVTS01+404                                               05298000
CVTAIDVT EQU   CVTS01+400                                               05299000
CVTSSAP  EQU   CVTS01+396                                               05300000
CVTEHCIR EQU   CVTS01+392                                               05301000
CVTEHDEF EQU   CVTS01+388                                               05302000
CVTDAIR  EQU   CVTS01+384                                               05303000
CVTPERFM EQU   CVTS01+380                                               05304000
CVT044R2 EQU   CVTS01+376                                               05305000
CVTFETCH EQU   CVTS01+372                                               05306000
CVTRSTWD EQU   CVTS01+368                                               05307000
CVTSPOST EQU   CVTS01+364                                               05308000
CVTIOBP  EQU   CVTS01+360                                               05309000
CVTASMVT EQU   CVTS01+356                                               05310000
CVTRECRQ EQU   CVTS01+352                                               05311000
CVTWSAC  EQU   CVTS01+348                                               05312000
CVTRV149 EQU   CVTS01+344                                               05313000
CVTWSAL  EQU   CVTS01+340                                               05314000
CVTSPSA  EQU   CVTS01+336                                               05315000
CVTGLMN  EQU   CVTS01+332                                               05316000
CVTVEAC0 EQU   CVTS01+328                                               05317000
CVT062R1 EQU   CVTS01+324                                               05318000
CVTRPOST EQU   CVTS01+320                                               05319000
CVTDQIQE EQU   CVTS01+316                                               05320000
CVTCSD   EQU   CVTS01+312                                               05321000
CVTLKRMA EQU   CVTS01+308                                               05322000
CVTRSPIE EQU   CVTS01+304                                               05323000
CVTRENQ  EQU   CVTS01+300                                               05324000
CVTLQCB  EQU   CVTS01+296                                               05325000
CVTFQCB  EQU   CVTS01+292                                               05326000
CVTQCS01 EQU   CVTS01+288                                               05327000
CVTAPFT  EQU   CVTS01+284                                               05328000
CVTPARRL EQU   CVTS01+280                                               05329000
CVTVWAIT EQU   CVTS01+276                                               05330000
CVTGSPL  EQU   CVTS01+272                                               05331000
CVTLSMQ  EQU   CVTS01+268                                               05332000
CVTGSMQ  EQU   CVTS01+264                                               05333000
CVTEXPRO EQU   CVTS01+260                                               05334000
CVTOPCTP EQU   CVTS01+256                                               05335000
CVTSIC   EQU   CVTS01+252                                               05336000
CVTTPIOS EQU   CVTS01+248                                               05337000
CVTRTMS  EQU   CVTS01+244                                               05338000
CVTSDBF  EQU   CVTS01+240                                               05339000
CVTSCBP  EQU   CVTS01+236                                               05340000
CVTSDMP  EQU   CVTS01+232                                               05341000
CVTSV60  EQU   CVTS01+228                                               05342000
CVTRTMCT EQU   CVTS01+224                                               05343000
CVTASCBL EQU   CVTS01+220                                               05344000
CVTASCBH EQU   CVTS01+216                                               05345000
CVTGDA   EQU   CVTS01+212                                               05346000
CVTASVT  EQU   CVTS01+208                                               05347000
CVTVVMDI EQU   CVTS01+204                                               05348000
CVTAQTOP EQU   CVTS01+200                                               05349000
CVTIOSCS EQU   CVTS01+196                                               05350000
CVTSDRM  EQU   CVTS01+192                                               05351000
CVTOPTE  EQU   CVTS01+188                                               05352000
CVTSTXU  EQU   CVTS01+184                                               05353000
CVTQUIS  EQU   CVTS01+180                                               05354000
CVTPARS  EQU   CVTS01+176                                               05355000
CVTS1EE  EQU   CVTS01+172                                               05356000
CVTFRAS  EQU   CVTS01+168                                               05357000
CVTQSAS  EQU   CVTS01+164                                               05358000
CVTCRAS  EQU   CVTS01+160                                               05359000
CVTCRMN  EQU   CVTS01+156                                               05360000
CVTDELCP EQU   CVTS01+152                                               05361000
CVTFRECL EQU   CVTS01+148                                               05362000
CVTGETCL EQU   CVTS01+144                                               05363000
CVTBLDCP EQU   CVTS01+140                                               05364000
CVTAUTHL EQU   CVTS01+136                                               05365000
CVTSCAN  EQU   CVTS01+132                                               05366000
CVTRV144 EQU   CVTS01+130                                               05367000
CVTMAXMP EQU   CVTS01+128                                               05368000
CVTSTCK  EQU   CVTS01+124                                               05369000
CVTRV139 EQU   CVTS01+123                                               05370000
CVTDSSAC EQU   CVTS01+122                                               05371000
CVTRV513 EQU   CVTS01+121                                               05372000
CVTIOSPL EQU   CVTS01+120                                               05373000
CVTPTGT  EQU   CVTS01+116                                               05374000
CVTCSPIE EQU   CVTS01+112                                               05375000
CVTSMFEX EQU   CVTS01+108                                               05376000
CVTOLT0A EQU   CVTS01+104                                               05377000
CVTSRBRT EQU   CVTS01+100                                               05378000
CVTPUTL  EQU   CVTS01+96                                                05379000
CVTASCRL EQU   CVTS01+92                                                05380000
CVTASCRF EQU   CVTS01+88                                                05381000
CVTRV326 EQU   CVTS01+84                                                05382000
CVTRV325 EQU   CVTS01+80                                                05383000
CVTRV324 EQU   CVTS01+76                                                05384000
CVT0VL01 EQU   CVTS01+72                                                05385000
CVTSHRVM EQU   CVTS01+68                                                05386000
CVTRV332 EQU   CVTS01+64                                                05387000
CVTTAS   EQU   CVTS01+60                                                05388000
CVTRSCN  EQU   CVTS01+56                                                05389000
CVTTRAC2 EQU   CVTS01+54                                                05390000
CVTTRACE EQU   CVTS01+52                                                05391000
CVTAPG   EQU   CVTS01+51                                                05392000
CVTSDTRC EQU   CVTCTLFG                                                 05393000
CVTGTRCE EQU   CVTCTLFG                                                 05394000
CVTNOMP  EQU   CVTCTLFG                                                 05395000
CVTRSV79 EQU   CVTCTLFG                                                 05396000
CVTDSTAT EQU   CVTCTLFG                                                 05397000
CVTRSV78 EQU   CVTCTLFG                                                 05398000
CVTRV333 EQU   CVTCTLFG                                                 05399000
CVTRV323 EQU   CVTCTLFG                                                 05400000
CVTSPVLK EQU   CVTS01+49                                                05401000
CVTRSV77 EQU   CVTS01+48                                                05402000
CVTRV331 EQU   CVTS01+44                                                05403000
CVTRV330 EQU   CVTS01+40                                                05404000
CVTRV329 EQU   CVTS01+36                                                05405000
CVTRV328 EQU   CVTS01+32                                                05406000
CVTRV322 EQU   CVTS01+28                                                05407000
CVTSLID  EQU   CVTSLIDA+1                                               05408000
CVTSYLK  EQU   CVTSLIDA                                                 05409000
CVTRV321 EQU   CVTS01+20                                                05410000
CVTRV320 EQU   CVTS01+16                                                05411000
CVTLPDIR EQU   CVTLPDIA+1                                               05412000
CVTRSV69 EQU   CVTDIRST                                                 05413000
CVTRSV68 EQU   CVTDIRST                                                 05414000
CVTRSV67 EQU   CVTDIRST                                                 05415000
CVTRSV66 EQU   CVTDIRST                                                 05416000
CVTRSV65 EQU   CVTDIRST                                                 05417000
CVTRSV64 EQU   CVTDIRST                                                 05418000
CVTRSV63 EQU   CVTDIRST                                                 05419000
CVTDICOM EQU   CVTDIRST                                                 05420000
CVTPVTP  EQU   CVTS01+8                                                 05421000
CVTLPDSR EQU   CVTS01+4                                                 05422000
CVTGETL  EQU   CVTS01                                                   05423000
ASM5FLGS EQU   ASM5WKSV+64                                              05424000
ASM5AIA  EQU   ASM5WKSV+60                                              05425000
ASM5GCTR EQU   ASM5WKSV+56                                              05426000
ASM5SR14 EQU   ASM5WKSV+52                                              05427000
@NM00006 EQU   ASM5RGSV+4                                               05428000
ASM5RG2  EQU   ASM5RGSV                                                 05429000
@NM00005 EQU   ASM4RGSV+4                                               05430000
ASM4RG2  EQU   ASM4RGSV                                                 05431000
ASM3SR13 EQU   ASM3WKSV+28                                              05432000
ASM3R14B EQU   ASM3WKSV+24                                              05433000
ASM3R14A EQU   ASM3WKSV+20                                              05434000
ASM3GRPA EQU   ASM3WKSV+16                                              05435000
ASM3TMPA EQU   ASM3WKSV+12                                              05436000
ASM3PIOP EQU   ASM3WKSV+8                                               05437000
ASM3GENQ EQU   ASM3WKSV+4                                               05438000
ASM3SWPQ EQU   ASM3WKSV                                                 05439000
ASM2SR14 EQU   ASM2WRKA+16                                              05440000
@NM00004 EQU   ASM2WRKA+13                                              05441000
ASM2WFLG EQU   ASM2FLGS                                                 05442000
ASM2RFLG EQU   ASM2FLGS                                                 05443000
ASM2DUPQ EQU   ASM2WRKA+8                                               05444000
ASM2CAQ  EQU   ASM2WRKA+4                                               05445000
ASM2PAQ  EQU   ASM2WRKA                                                 05446000
ASM2RGSV EQU   ASM2WKSV                                                 05447000
ASM1NXTA EQU   ASM1WRKA+4                                               05448000
ASM1ASCB EQU   ASM1WRKA                                                 05449000
ASM1RG15 EQU   ASM1RGSV+56                                              05450000
@NM00003 EQU   ASM1RGSV+4                                               05451000
ASM1RG1  EQU   ASM1RGSV                                                 05452000
@NM00065 EQU   CNVRTSKA+1                                               05453000
@NM00064 EQU   GOODLSID                                                 05454000
CALLR1   EQU   CALLSA+24                                                05455000
CALLR0   EQU   CALLSA+20                                                05456000
CALLR14  EQU   CALLSA+12                                                05457000
@NM00063 EQU   CALLSA                                                   05458000
@NM00060 EQU   SRB+40                                                   05459000
@NM00059 EQU   SRB+38                                                   05460000
SRBPRIOR EQU   SRB+37                                                   05461000
SRBPKF   EQU   SRB+36                                                   05462000
SRBSAVE  EQU   SRB+32                                                   05463000
SRBPARM  EQU   SRB+28                                                   05464000
SRBRMTR  EQU   SRB+24                                                   05465000
SRBEP    EQU   SRB+20                                                   05466000
SRBPTCB  EQU   SRBFLC+4                                                 05467000
SRBPASID EQU   SRBFLC+2                                                 05468000
SRBCPAFF EQU   SRBFLC                                                   05469000
SRBASCB  EQU   SRB+8                                                    05470000
SRBFLNK  EQU   SRB+4                                                    05471000
SRBID    EQU   SRB                                                      05472000
PCTSLOT  EQU   PCTSLTNM                                                 05473000
PCTRQTIM EQU   PCT+32                                                   05474000
PCTDPGWT EQU   PCT+28                                                   05475000
PCTDMASK EQU   PCT+20                                                   05476000
PCTNEXT  EQU   PCT+16                                                   05477000
PCTCYLSZ EQU   PCT+14                                                   05478000
PCTSMAX  EQU   PCT+10                                                   05479000
PCTDTYPE EQU   PCT+4                                                    05480000
PCTID    EQU   PCT                                                      05481000
@NM00034 EQU   PCCW+72                                                  05482000
PCCWNCT  EQU   PCCWNOP+6                                                05483000
PCCWCNT  EQU   PCCWRW+6                                                 05484000
PCCWRWFG EQU   PCCWRW+4                                                 05485000
PCCWTCT  EQU   PCCWTIC+6                                                05486000
PCCWTFG  EQU   PCCWTIC+4                                                05487000
PCCWTAD  EQU   PCCWTIC+1                                                05488000
PCCWT    EQU   PCCWTIC                                                  05489000
PCCWSICT EQU   PCCWSRCH+6                                               05490000
PCCWSIFG EQU   PCCWSRCH+4                                               05491000
PCCWSIAD EQU   PCCWSRCH+1                                               05492000
PCCWSIDE EQU   PCCWSRCH                                                 05493000
PCCWSSCT EQU   PCCWSSEC+6                                               05494000
PCCWSSFG EQU   PCCWSSEC+4                                               05495000
PCCWSKCT EQU   PCCWSEEK+6                                               05496000
PCCWSKFG EQU   PCCWSEEK+4                                               05497000
PCCWSKAD EQU   PCCWSEEK+1                                               05498000
PCCWR    EQU   PCCWCHHR+7                                               05499000
PCCWBB   EQU   PCCWCHHR+1                                               05500000
PCCWM    EQU   PCCWCHHR                                                 05501000
@NM00033 EQU   PCCW+3                                                   05502000
@NM00032 EQU   PCCWFLGS                                                 05503000
PCCWID   EQU   PCCW                                                     05504000
PCBEND   EQU   PCB+64                                                   05505000
PCBAIA   EQU   PCB+36                                                   05506000
PCBASCB  EQU   PCB+32                                                   05507000
PCBSPCTE EQU   PCBRB                                                    05508000
PCBVBN   EQU   PCB+26                                                   05509000
PCBPGTA  EQU   PCBPGT+1                                                 05510000
PCBSWPS2 EQU   PCBFL3                                                   05511000
@NM00031 EQU   PCBFL3                                                   05512000
PCBNOREC EQU   PCBFL3                                                   05513000
PCBDFRLS EQU   PCBFL3                                                   05514000
PCBSWPLS EQU   PCBFL3                                                   05515000
PCBSWPS1 EQU   PCBFL3                                                   05516000
PCBSWPIN EQU   PCBFL3                                                   05517000
PCBSWPOT EQU   PCBFL3                                                   05518000
PCBXPTA  EQU   PCBXPT+1                                                 05519000
@NM00030 EQU   PCBFL2                                                   05520000
@NM00029 EQU   PCBFL2                                                   05521000
PCBVIO   EQU   PCBFL2                                                   05522000
PCBSUPRS EQU   PCBFL2                                                   05523000
PCBRESET EQU   PCBFL2                                                   05524000
PCBIOERR EQU   PCBFL2                                                   05525000
PCBGFAD  EQU   PCBFL2                                                   05526000
PCBFREAL EQU   PCBFL2                                                   05527000
PCBRLPA  EQU   PCBRLP+1                                                 05528000
PCBFXC   EQU   PCBRLP                                                   05529000
PCBRTPA  EQU   PCBRTP+1                                                 05530000
PCBIOCMP EQU   PCBFL1                                                   05531000
PCBIOI   EQU   PCBFL1                                                   05532000
PCBROOT  EQU   PCBFL1                                                   05533000
PCBLFR   EQU   PCBFL1                                                   05534000
PCBLLHLD EQU   PCBFL1                                                   05535000
PCBSRBMD EQU   PCBFL1                                                   05536000
PCBPEX   EQU   PCBFL1                                                   05537000
@NM00028 EQU   PCBFL1                                                   05538000
PCBBQPA  EQU   PCBBQP                                                   05539000
PCBFQPA  EQU   PCBFQP+1                                                 05540000
PCBCQN   EQU   PCBFQP                                                   05541000
PATCYLS  EQU   PATMAP                                                   05542000
PATRSV1  EQU   PATHDR+14                                                05543000
PATPART  EQU   PATHDR+4                                                 05544000
PATIDENT EQU   PATHDR                                                   05545000
@NM00027 EQU   PARTENT+62                                               05546000
PAREWTQE EQU   PARTENT+52                                               05547000
PAREIORB EQU   PARTENT+28                                               05548000
PARERRCT EQU   PARTENT+24                                               05549000
PARESZSL EQU   PARTENT+16                                               05550000
@NM00026 EQU   PAREFLG1                                                 05551000
PAREINCP EQU   PAREFLG1                                                 05552000
PAREDSBD EQU   PAREFLG1                                                 05553000
PARENUSE EQU   PAREFLG1                                                 05554000
@NM00025 EQU   PARETYPE                                                 05555000
PARELOCL EQU   PARETYPE                                                 05556000
PAREDPLX EQU   PARETYPE                                                 05557000
PARECOMM EQU   PARETYPE                                                 05558000
PAREPLPA EQU   PARETYPE                                                 05559000
PARECPCT EQU   PARELKUP+2                                               05560000
PAREIORN EQU   PARELKUP+1                                               05561000
@NM00024 EQU   PARELKFL                                                 05562000
PAREFSIP EQU   PARELKFL                                                 05563000
PAREPARE EQU   PARTENT                                                  05564000
PARTENTS EQU   PART+80                                                  05565000
PARTLOCL EQU   PARTLOCQ+4                                               05566000
PARTLOCF EQU   PARTLOCQ                                                 05567000
PARTDUPL EQU   PARTDUPQ+4                                               05568000
PARTDUPF EQU   PARTDUPQ                                                 05569000
PARTSPLL EQU   PARTSPLQ+4                                               05570000
PARTSPLF EQU   PARTSPLQ                                                 05571000
PARTCOML EQU   PARTCOMQ+4                                               05572000
PARTCOMF EQU   PARTCOMQ                                                 05573000
PARTLOCK EQU   PARTHDR+44                                               05574000
PARTLKUP EQU   PARTHDR+40                                               05575000
@NM00023 EQU   PARTHDR+34                                               05576000
PARTLCNT EQU   PARTHDR+32                                               05577000
PARTPCTQ EQU   PARTHDR+28                                               05578000
PARTDSNL EQU   PARTTPAR                                                 05579000
PARTCIR2 EQU   PARTHDR+20                                               05580000
PARTCIR1 EQU   PARTHDR+16                                               05581000
PARTAIAE EQU   PARTHDR+12                                               05582000
PARTEUSE EQU   PARTHDR+8                                                05583000
PARTSIZE EQU   PARTHDR+4                                                05584000
PARTIDEN EQU   PARTHDR                                                  05585000
LPMBSST  EQU   IDALPMB+28                                               05586000
LPMBEXT  EQU   IDALPMB+24                                               05587000
@NM00022 EQU   IDALPMB+22                                               05588000
LPMBLKTR EQU   IDALPMB+20                                               05589000
LPMBLEN  EQU   IDALPMB+2                                                05590000
@NM00021 EQU   LPMBFLGS                                                 05591000
LPMBSSTH EQU   LPMBFLGS                                                 05592000
LPMBTOFL EQU   LPMBFLGS                                                 05593000
LPMSS    EQU   LPMBFLGS                                                 05594000
LPMREPL  EQU   LPMBFLGS                                                 05595000
LPMBRPS  EQU   LPMBFLGS                                                 05596000
LPMBID   EQU   IDALPMB                                                  05597000
IOSEND   EQU   IOSB+108                                                 05598000
IOSSKR   EQU   IOSEEKA+7                                                05599000
IOSSKH2  EQU   IOSSKHH+1                                                05600000
IOSSKH1  EQU   IOSSKHH                                                  05601000
IOSSKCC  EQU   IOSCCHH                                                  05602000
IOSSKBB  EQU   IOSEEKA+1                                                05603000
IOSSKM   EQU   IOSEEKA                                                  05604000
IOSMDM   EQU   IOSB+91                                                  05605000
IOSMDB   EQU   IOSB+90                                                  05606000
IOSCKEY7 EQU   IOSCKEY                                                  05607000
IOSCKEY6 EQU   IOSCKEY                                                  05608000
IOSCKEY5 EQU   IOSCKEY                                                  05609000
IOSCKEY4 EQU   IOSCKEY                                                  05610000
@NM00017 EQU   IOSCKEY                                                  05611000
IOSFMSK  EQU   IOSB+88                                                  05612000
IOSCUDEV EQU   IOSPATH+1                                                05613000
@NM00016 EQU   IOSCHN                                                   05614000
IOSPATH3 EQU   IOSCHN                                                   05615000
IOSPATH2 EQU   IOSCHN                                                   05616000
IOSEXP   EQU   IOSCHN                                                   05617000
IOSGDP   EQU   IOSCHN                                                   05618000
IOSAFF   EQU   IOSB+85                                                  05619000
IOSRSS1B EQU   IOSB+84                                                  05620000
IOSDSID  EQU   IOSB+80                                                  05621000
IOSDIE   EQU   IOSB+68                                                  05622000
IOSABN   EQU   IOSB+64                                                  05623000
IOSNRM   EQU   IOSB+60                                                  05624000
IOSPCI   EQU   IOSB+56                                                  05625000
IOSPCHN  EQU   IOSB+48                                                  05626000
IOSSNS   EQU   IOSB+42                                                  05627000
IOSAPMSK EQU   IOSB+40                                                  05628000
IOSRES4A EQU   IOSB+36                                                  05629000
IOSUSE   EQU   IOSB+32                                                  05630000
IOSCSWRC EQU   IOSCSW+5                                                 05631000
IOSTSB   EQU   IOSTATUS+1                                               05632000
IOSTSA   EQU   IOSTATUS                                                 05633000
IOSCSWCA EQU   IOSCSW                                                   05634000
IOSCC    EQU   @NM00015                                                 05635000
IOSOPT2X EQU   IOSOPT2                                                  05636000
IOSIGP   EQU   IOSOPT2                                                  05637000
IOSHTP   EQU   IOSOPT2                                                  05638000
IOSRELSE EQU   IOSOPT                                                   05639000
IOSAPR   EQU   IOSOPT                                                   05640000
IOSTSLL  EQU   IOSOPT                                                   05641000
IOSNERP  EQU   IOSOPT                                                   05642000
IOSPSLL  EQU   IOSOPT                                                   05643000
IOSQISCE EQU   IOSOPT                                                   05644000
IOSDEP   EQU   IOSOPT                                                   05645000
IOSBYP   EQU   IOSOPT                                                   05646000
IOSCOD   EQU   IOSB+13                                                  05647000
IOSPKY7  EQU   IOSPKEY                                                  05648000
IOSPGDPX EQU   IOSPKEY                                                  05649000
IOSIDR   EQU   IOSPKEY                                                  05650000
IOSLCL   EQU   IOSPKEY                                                  05651000
@NM00014 EQU   IOSPKEY                                                  05652000
IOSPGAD  EQU   IOSB+8                                                   05653000
IOSASID  EQU   IOSB+6                                                   05654000
IOSPRLVL EQU   IOSB+5                                                   05655000
IOSDVRID EQU   IOSB+4                                                   05656000
IOSFLC7  EQU   IOSFLC                                                   05657000
IOSCTCNR EQU   IOSFLC                                                   05658000
IOSRWAIT EQU   IOSFLC                                                   05659000
IOSTP    EQU   IOSFLC                                                   05660000
IOSCC3WE EQU   IOSFLC                                                   05661000
IOSVERIF EQU   IOSDVALT                                                 05662000
IOSDVMNT EQU   IOSFLC                                                   05663000
IOSLOG   EQU   IOSFLB                                                   05664000
IOSBDCST EQU   IOSFLB                                                   05665000
IOSMSG   EQU   IOSFLB                                                   05666000
IOSFLB4  EQU   IOSFLB                                                   05667000
IOSFLB3  EQU   IOSFLB                                                   05668000
IOSNOTRS EQU   IOSFLB                                                   05669000
IOSSDR   EQU   IOSFLB                                                   05670000
IOSDIESE EQU   IOSFLB                                                   05671000
IOSIOSB  EQU   IOSFLA                                                   05672000
IOSDOM   EQU   IOSFLA                                                   05673000
IOSEX    EQU   IOSFLA                                                   05674000
IOSSMDB  EQU   IOSFLA                                                   05675000
IOSSMDA  EQU   IOSFLA                                                   05676000
IOSERR   EQU   IOSFLA                                                   05677000
IOSCCHN  EQU   IOSACHN                                                  05678000
IOSDCHN  EQU   IOSACHN                                                  05679000
@NM00013 EQU   IORB+40                                                  05680000
IORRSV   EQU   IORB+36                                                  05681000
IORPARTE EQU   IORB+32                                                  05682000
IORERR   EQU   IORB+20                                                  05683000
IORSAVE  EQU   IORB+16                                                  05684000
IORSCCW  EQU   IORPCCW                                                  05685000
IORIORB  EQU   IORB+4                                                   05686000
IORFAE   EQU   IORAPND                                                  05687000
IORFNE   EQU   IORAPND                                                  05688000
IORFDI   EQU   IORAPND                                                  05689000
IORSWAP  EQU   IORFLGS                                                  05690000
@NM00012 EQU   IORFLGS                                                  05691000
IORNUM   EQU   IORB+1                                                   05692000
IORID    EQU   IORB                                                     05693000
@NM00011 EQU   IOE+16                                                   05694000
IOCOEND  EQU   IOCOM+128                                                05695000
IOCPATCH EQU   IOCOM+124                                                05696000
IOCUCBBM EQU   IOCOM+120                                                05697000
IOCQCNT  EQU   IOCOM+116                                                05698000
IOCIOSDQ EQU   IOCOM+112                                                05699000
IOCIOSEQ EQU   IOCOM+108                                                05700000
IOCSVCF  EQU   IOCOM+104                                                05701000
IOCTCCW  EQU   IOCOM+100                                                05702000
IOCRSVTB EQU   IOCOM+96                                                 05703000
IOCMFCNT EQU   IOCOM+92                                                 05704000
IOCMFHK  EQU   IOCOM+88                                                 05705000
IOCGENA  EQU   IOCOM+84                                                 05706000
IOCCCH   EQU   IOCOM+80                                                 05707000
IOCASYNQ EQU   IOCOM+76                                                 05708000
IOCLCHTB EQU   IOCOM+72                                                 05709000
IOCATTBL EQU   IOCOM+68                                                 05710000
IOCOMEX  EQU   IOCOM+64                                                 05711000
IOCSYNCH EQU   IOCOM+56                                                 05712000
IOCCATLK EQU   IOCOM+48                                                 05713000
IOCPRGID EQU   IOCOM+44                                                 05714000
IOCIOSCP EQU   IOCOM+40                                                 05715000
IOCORMGT EQU   IOCOM+36                                                 05716000
IOCVOID  EQU   IOCOM+32                                                 05717000
IOCSCOMP EQU   IOCOM+24                                                 05718000
IOCHD160 EQU   IOCOM+20                                                 05719000
IOCINT   EQU   IOCOM+16                                                 05720000
IOCCTBL  EQU   IOCOM+12                                                 05721000
IOCHIO   EQU   IOCOM+8                                                  05722000
IOCPST   EQU   IOCOM+4                                                  05723000
IOCPGCT  EQU   IOCOM+2                                                  05724000
IOCVOICT EQU   IOCOM                                                    05725000
EPACPUID EQU   EPATH+38                                                 05726000
EPAMSPAD EQU   EPATH+32                                                 05727000
EPAWRTQ  EQU   EPATH+20                                                 05728000
EPAIOEQP EQU   EPATH+8                                                  05729000
EPAPARM  EQU   EPATH                                                    05730000
EDBTKBAL EQU   IDAEDB+20                                                05731000
@NM00010 EQU   EDBFLG1                                                  05732000
EDBPSDS  EQU   EDBFLG1                                                  05733000
EDBTOFLW EQU   EDBFLG1                                                  05734000
EDBLKR   EQU   EDBFLG1                                                  05735000
@NM00009 EQU   IDAEDB                                                   05736000
EDBLPMBC EQU   IDAEDBHD+4                                               05737000
EDBID    EQU   IDAEDBHD                                                 05738000
CVTLEVL  EQU   CVTRELNO+2                                               05739000
CVTNUMB  EQU   CVTRELNO                                                 05740000
CVTMDL   EQU   CVTFIX+250                                               05741000
@NM00008 EQU   CVTFIX+248                                               05742000
@NM00007 EQU   CVTFIX                                                   05743000
CVTRV482 EQU   CVTXTNT2+128                                             05744000
CVTRV481 EQU   CVTXTNT2+124                                             05745000
CVTRV480 EQU   CVTXTNT2+120                                             05746000
CVTRV479 EQU   CVTXTNT2+118                                             05747000
CVTRV478 EQU   CVTXTNT2+117                                             05748000
CVTRV477 EQU   CVTXTNT2+116                                             05749000
CVTRV476 EQU   CVTXTNT2+115                                             05750000
CVTRV475 EQU   CVTXTNT2+114                                             05751000
CVTRV474 EQU   CVTRV466                                                 05752000
CVTRV473 EQU   CVTRV466                                                 05753000
CVTRV472 EQU   CVTRV466                                                 05754000
CVTRV471 EQU   CVTRV466                                                 05755000
CVTRV470 EQU   CVTRV466                                                 05756000
CVTRV469 EQU   CVTRV466                                                 05757000
CVTRV468 EQU   CVTRV466                                                 05758000
CVTRV467 EQU   CVTRV466                                                 05759000
CVTRV465 EQU   CVTRV457                                                 05760000
CVTRV464 EQU   CVTRV457                                                 05761000
CVTRV463 EQU   CVTRV457                                                 05762000
CVTRV462 EQU   CVTRV457                                                 05763000
CVTRV461 EQU   CVTRV457                                                 05764000
CVTRV460 EQU   CVTRV457                                                 05765000
CVTRV459 EQU   CVTRV457                                                 05766000
CVTRV458 EQU   CVTRV457                                                 05767000
CVTRV456 EQU   CVTXTNT2+108                                             05768000
CVTRV455 EQU   CVTXTNT2+104                                             05769000
CVTRV454 EQU   CVTXTNT2+100                                             05770000
CVTRV453 EQU   CVTXTNT2+96                                              05771000
CVTRV452 EQU   CVTXTNT2+94                                              05772000
CVTRV451 EQU   CVTXTNT2+92                                              05773000
CVTRV450 EQU   CVTXTNT2+90                                              05774000
CVTRV449 EQU   CVTXTNT2+88                                              05775000
CVTRV448 EQU   CVTXTNT2+87                                              05776000
CVTRV447 EQU   CVTXTNT2+86                                              05777000
CVTRV446 EQU   CVTRV438                                                 05778000
CVTRV445 EQU   CVTRV438                                                 05779000
CVTRV444 EQU   CVTRV438                                                 05780000
CVTRV443 EQU   CVTRV438                                                 05781000
CVTRV442 EQU   CVTRV438                                                 05782000
CVTRV441 EQU   CVTRV438                                                 05783000
CVTRV440 EQU   CVTRV438                                                 05784000
CVTRV439 EQU   CVTRV438                                                 05785000
CVTRV437 EQU   CVTRV429                                                 05786000
CVTRV436 EQU   CVTRV429                                                 05787000
CVTRV435 EQU   CVTRV429                                                 05788000
CVTRV434 EQU   CVTRV429                                                 05789000
CVTRV433 EQU   CVTRV429                                                 05790000
CVTRV432 EQU   CVTRV429                                                 05791000
CVTRV431 EQU   CVTRV429                                                 05792000
CVTRV430 EQU   CVTRV429                                                 05793000
CVTRV428 EQU   CVTXTNT2+80                                              05794000
CVTRV427 EQU   CVTXTNT2+76                                              05795000
CVTRV426 EQU   CVTXTNT2+72                                              05796000
CVTRV425 EQU   CVTXTNT2+68                                              05797000
CVTATACT EQU   CVTATCVT                                                 05798000
CVTRV423 EQU   CVTXTNT2+62                                              05799000
CVTRV422 EQU   CVTXTNT2+60                                              05800000
CVTRV421 EQU   CVTXTNT2+58                                              05801000
CVTRV420 EQU   CVTXTNT2+56                                              05802000
CVTRV419 EQU   CVTXTNT2+55                                              05803000
CVTRV418 EQU   CVTXTNT2+54                                              05804000
CVTRV417 EQU   CVTRV409                                                 05805000
CVTRV416 EQU   CVTRV409                                                 05806000
CVTRV415 EQU   CVTRV409                                                 05807000
CVTRV414 EQU   CVTRV409                                                 05808000
CVTRV413 EQU   CVTRV409                                                 05809000
CVTRV412 EQU   CVTRV409                                                 05810000
CVTRV411 EQU   CVTRV409                                                 05811000
CVTRV410 EQU   CVTRV409                                                 05812000
CVTRV408 EQU   CVTRV400                                                 05813000
CVTRV407 EQU   CVTRV400                                                 05814000
CVTRV406 EQU   CVTRV400                                                 05815000
CVTRV405 EQU   CVTRV400                                                 05816000
CVTRV404 EQU   CVTRV400                                                 05817000
CVTRV403 EQU   CVTRV400                                                 05818000
CVTRV402 EQU   CVTRV400                                                 05819000
CVTRV401 EQU   CVTRV400                                                 05820000
CVTICB   EQU   CVTXTNT2+48                                              05821000
CVTSKTA  EQU   CVTXTNT2+44                                              05822000
CVTCCVT  EQU   CVTXTNT2+40                                              05823000
CVTRSV98 EQU   CVTXTNT2+36                                              05824000
CVTRSV97 EQU   CVTXTNT2+34                                              05825000
CVTRSV96 EQU   CVTXTNT2+32                                              05826000
CVTOLTEP EQU   CVTXTNT2+28                                              05827000
CVTQIDA  EQU   CVTQID+1                                                 05828000
CVTRSV95 EQU   CVTQID                                                   05829000
CVTRSV94 EQU   CVTXTNT2+20                                              05830000
CVTRSV93 EQU   CVTXTNT2+16                                              05831000
CVTRSV92 EQU   CVTXTNT2+12                                              05832000
CVTDEBVR EQU   CVTXTNT2+8                                               05833000
CVTRSV91 EQU   CVTXTNT2+6                                               05834000
CVTRSV9H EQU   CVTFLGBT                                                 05835000
CVTRSV9G EQU   CVTFLGBT                                                 05836000
CVTRSV9F EQU   CVTFLGBT                                                 05837000
CVTRSV9E EQU   CVTFLGBT                                                 05838000
CVTRSV9D EQU   CVTFLGBT                                                 05839000
CVTRSV9C EQU   CVTFLGBT                                                 05840000
CVTVME   EQU   CVTFLGBT                                                 05841000
CVTNPE   EQU   CVTFLGBT                                                 05842000
CVTNUCLS EQU   CVTXTNT2+4                                               05843000
CVTDSSVA EQU   CVTDSSV+1                                                05844000
CVTRSV89 EQU   CVTDSSV                                                  05845000
CVTRSV88 EQU   CVTXTNT1+8                                               05846000
CVTRSV87 EQU   CVTXTNT1+4                                               05847000
CVTFACHN EQU   CVTXTNT1                                                 05848000
CVTRV488 EQU   CVTMAP+412                                               05849000
CVTRV487 EQU   CVTMAP+408                                               05850000
CVTRV486 EQU   CVTMAP+404                                               05851000
CVTRV485 EQU   CVTMAP+400                                               05852000
CVTACTAP EQU   CVTMAP+396                                               05853000
CVTAUTH  EQU   CVTMAP+392                                               05854000
CVTATMCA EQU   CVTATMCT+1                                               05855000
CVTATMST EQU   CVTATMCT                                                 05856000
CVTRSV61 EQU   CVTMAP+384                                               05857000
CVTVOLT1 EQU   CVTVOLM1+1                                               05858000
CVTVOLI1 EQU   CVTVOLF1                                                 05859000
CVTSTOA  EQU   CVTMAP+376                                               05860000
CVTRSV58 EQU   CVTMAP+374                                               05861000
CVTRSV57 EQU   CVTMAP+372                                               05862000
CVTDDCE  EQU   CVTMAP+368                                               05863000
CVTPNWFR EQU   CVTMAP+364                                               05864000
CVTSMF   EQU   CVTMAP+360                                               05865000
CVTSULK  EQU   CVTMAP+358                                               05866000
CVTSLKO  EQU   CVTSYSK                                                  05867000
CVTSLKP  EQU   CVTSYSK                                                  05868000
CVTSLKQ  EQU   CVTSYSK                                                  05869000
CVTSLKR  EQU   CVTSYSK                                                  05870000
CVTRSV56 EQU   CVTSYSK                                                  05871000
CVTRSV55 EQU   CVTSYSK                                                  05872000
CVTRSV54 EQU   CVTSYSK                                                  05873000
CVTRSV53 EQU   CVTSYSK                                                  05874000
CVTRSV52 EQU   CVTA1F1                                                  05875000
CVTRSV51 EQU   CVTA1F1                                                  05876000
CVTRSV50 EQU   CVTA1F1                                                  05877000
CVTRSV49 EQU   CVTA1F1                                                  05878000
CVTRSV48 EQU   CVTA1F1                                                  05879000
CVTRSV47 EQU   CVTA1F1                                                  05880000
CVTSRSW  EQU   CVTA1F1                                                  05881000
CVTPFSW  EQU   CVTA1F1                                                  05882000
CVTPCVT  EQU   CVTMAP+352                                               05883000
CVTRSV46 EQU   CVTMAP+344                                               05884000
CVTRSV45 EQU   CVTMAP+340                                               05885000
CVTRSV44 EQU   CVTMAP+338                                               05886000
CVTRSV43 EQU   CVTMAP+336                                               05887000
CVTHJESA EQU   CVTHJES+1                                                05888000
CVTRSV42 EQU   CVTHJES                                                  05889000
CVTEXT2A EQU   CVTEXT2+1                                                05890000
CVTRSV41 EQU   CVTEXT2                                                  05891000
CVTAPFA  EQU   CVTAPF+1                                                 05892000
CVTRSV40 EQU   CVTAPF                                                   05893000
CVTRV518 EQU   CVTINTLA                                                 05894000
CVTRV517 EQU   CVTERPV                                                  05895000
CVTEORM  EQU   CVTMAP+312                                               05896000
CVTMCHPR EQU   CVTMAP+308                                               05897000
CVTTZ    EQU   CVTMAP+304                                               05898000
CVTJEPS  EQU   CVTMAP+300                                               05899000
CVTJESCT EQU   CVTMAP+296                                               05900000
CVTMODE  EQU   CVTMAP+292                                               05901000
CVTPTRV  EQU   CVTMAP+288                                               05902000
CVTREAL  EQU   CVTMAP+284                                               05903000
CVTRSV39 EQU   CVTMAP+280                                               05904000
CVTRSV38 EQU   CVTMAP+276                                               05905000
CVTDMSRA EQU   CVTDMSR+1                                                05906000
CVTRV634 EQU   CVTDMSRF                                                 05907000
CVTRV633 EQU   CVTDMSRF                                                 05908000
CVTRV632 EQU   CVTDMSRF                                                 05909000
CVTRV631 EQU   CVTDMSRF                                                 05910000
CVTRV630 EQU   CVTDMSRF                                                 05911000
CVTRV629 EQU   CVTDMSRF                                                 05912000
CVTUDUMP EQU   CVTDMSRF                                                 05913000
CVTSDUMP EQU   CVTDMSRF                                                 05914000
CVTQMSGA EQU   CVTQMSG+1                                                05915000
CVTRSV36 EQU   CVTQMSG                                                  05916000
CVTAMFF  EQU   CVTMAP+264                                               05917000
CVTPURGA EQU   CVTPURG+1                                                05918000
CVTRSV35 EQU   CVTPURG                                                  05919000
CVTCBSP  EQU   CVTMAP+256                                               05920000
CVTATERA EQU   CVTATER+1                                                05921000
CVTSYST  EQU   CVTATER                                                  05922000
CVTVOLT2 EQU   CVTTAT                                                   05923000
CVTVOLI2 EQU   CVTVOLF2                                                 05924000
CVTAQAVB EQU   CVTAQAVT+1                                               05925000
CVTRSV34 EQU   CVTTCMFG                                                 05926000
CVTRSV33 EQU   CVTTCMFG                                                 05927000
CVTRSV32 EQU   CVTTCMFG                                                 05928000
CVTRSV31 EQU   CVTTCMFG                                                 05929000
CVTRSV30 EQU   CVTTCMFG                                                 05930000
CVTRSV29 EQU   CVTTCMFG                                                 05931000
CVTLDEV  EQU   CVTTCMFG                                                 05932000
CVTTCRDY EQU   CVTTCMFG                                                 05933000
CVTGTFA  EQU   CVTGTF+1                                                 05934000
CVTRSV27 EQU   CVTGTFST                                                 05935000
CVTRNIO  EQU   CVTGTFST                                                 05936000
CVTUSR   EQU   CVTGTFST                                                 05937000
CVTRV318 EQU   CVTFORM                                                  05938000
CVTRV317 EQU   CVTTMODE                                                 05939000
CVTRV316 EQU   CVTSTATE                                                 05940000
CVTRV315 EQU   CVTGTFS                                                  05941000
CVTGTFAV EQU   CVTGTFS                                                  05942000
CVT0SCR1 EQU   CVTMAP+232                                               05943000
CVTRV515 EQU   CVTMAP+228                                               05944000
CVTRMS   EQU   CVTMAP+224                                               05945000
CVTPATCH EQU   CVTMAP+220                                               05946000
CVTTSCE  EQU   CVTMAP+216                                               05947000
CVTLNKSC EQU   CVTMAP+214                                               05948000
CVTQABST EQU   CVTMAP+212                                               05949000
CVTMDLDS EQU   CVTMAP+208                                               05950000
CVTUSER  EQU   CVTMAP+204                                               05951000
CVTABEND EQU   CVTMAP+200                                               05952000
CVTSMCA  EQU   CVTMAP+196                                               05953000
CVTRSV18 EQU   CVTMAP+192                                               05954000
CVTQLPAQ EQU   CVTMAP+188                                               05955000
CVTQCDSR EQU   CVTMAP+184                                               05956000
CVTRSV17 EQU   CVTOPTB                                                  05957000
CVTRSV16 EQU   CVTOPTB                                                  05958000
CVTFP    EQU   CVTOPTB                                                  05959000
CVTAPTHR EQU   CVTOPTB                                                  05960000
CVTNLOG  EQU   CVTOPTB                                                  05961000
CVTTOD   EQU   CVTOPTB                                                  05962000
CVTCTIMS EQU   CVTOPTB                                                  05963000
CVTPROT  EQU   CVTOPTB                                                  05964000
CVTXPFP  EQU   CVTOPTA                                                  05965000
CVTASCII EQU   CVTOPTA                                                  05966000
CVTRSV13 EQU   CVTOPTA                                                  05967000
CVTRSV12 EQU   CVTOPTA                                                  05968000
CVTNIP   EQU   CVTOPTA                                                  05969000
CVTDDR   EQU   CVTOPTA                                                  05970000
CVTAPR   EQU   CVTOPTA                                                  05971000
CVTCCH   EQU   CVTOPTA                                                  05972000
CVTSNCTR EQU   CVTMAP+180                                               05973000
CVTQMWR  EQU   CVTMAP+176                                               05974000
CVTQOCR  EQU   CVTMAP+172                                               05975000
CVT1EF00 EQU   CVTMAP+168                                               05976000
CVTMZ00  EQU   CVTMAP+164                                               05977000
CVTSV76Q EQU   CVTSV76C                                                 05978000
CVTRSV11 EQU   CVTMAP+156                                               05979000
CVT0PT01 EQU   CVTMAP+152                                               05980000
CVTMSER  EQU   CVTMAP+148                                               05981000
CVTRV516 EQU   CVTIERLC                                                 05982000
CVTILCH  EQU   CVTMAP+140                                               05983000
CVT0DS   EQU   CVTMAP+136                                               05984000
CVTFBOSV EQU   CVTMAP+132                                               05985000
CVTNUCB  EQU   CVTMAP+128                                               05986000
CVTSV76M EQU   CVTIOQET                                                 05987000
CVTDCBA  EQU   CVTMAP+117                                               05988000
CVTMVS2  EQU   CVTDCB                                                   05989000
CVT6DAT  EQU   CVTDCB                                                   05990000
CVT4MPS  EQU   CVTDCB                                                   05991000
CVTRSV09 EQU   CVTDCB                                                   05992000
CVT4MS1  EQU   CVTDCB                                                   05993000
CVT2SPS  EQU   CVTDCB                                                   05994000
CVT1SSS  EQU   CVTDCB                                                   05995000
CVTRSV08 EQU   CVTDCB                                                   05996000
CVTSTB   EQU   CVTMAP+112                                               05997000
CVTQTD00 EQU   CVTMAP+108                                               05998000
CVTQTE00 EQU   CVTMAP+104                                               05999000
CVTCUCB  EQU   CVTMAP+100                                               06000000
CVTSJQ   EQU   CVTMAP+96                                                06001000
CVTPBLDL EQU   CVTMAP+92                                                06002000
CVTTPC   EQU   CVTMAP+88                                                06003000
CVTSVDCB EQU   CVTMAP+84                                                06004000
CVTBRET  EQU   CVTMAP+82                                                06005000
CVTEXIT  EQU   CVTMAP+80                                                06006000
CVT0FN00 EQU   CVTMAP+76                                                06007000
CVTDARA  EQU   CVTDAR+1                                                 06008000
CVTRSV07 EQU   CVTFLGS1                                                 06009000
CVTRSV06 EQU   CVTFLGS1                                                 06010000
CVTRSV05 EQU   CVTFLGS1                                                 06011000
CVTRSV04 EQU   CVTFLGS1                                                 06012000
CVTRSV03 EQU   CVTFLGS1                                                 06013000
CVTRSV02 EQU   CVTFLGS1                                                 06014000
CVTRSV01 EQU   CVTFLGS1                                                 06015000
CVTDMPLK EQU   CVTFLGS1                                                 06016000
CVTXITP  EQU   CVTMAP+68                                                06017000
CVTZDTAB EQU   CVTMAP+64                                                06018000
CVTMSLT  EQU   CVTMAP+60                                                06019000
CVTDATE  EQU   CVTMAP+56                                                06020000
CVTBTERM EQU   CVTMAP+52                                                06021000
CVTSYSAD EQU   CVTMAP+48                                                06022000
CVTXTLER EQU   CVTMAP+44                                                06023000
CVTILK2  EQU   CVTMAP+40                                                06024000
CVTILK1  EQU   CVTMAP+36                                                06025000
CVTPRLTV EQU   CVTMAP+32                                                06026000
CVTPCNVT EQU   CVTMAP+28                                                06027000
CVT0VL00 EQU   CVTMAP+24                                                06028000
CVTXAPG  EQU   CVTMAP+20                                                06029000
CVTBUF   EQU   CVTMAP+16                                                06030000
CVTJOB   EQU   CVTMAP+12                                                06031000
CVTLINK  EQU   CVTMAP+8                                                 06032000
CVT0EF00 EQU   CVTMAP+4                                                 06033000
CVTTCBP  EQU   CVTMAP                                                   06034000
CVT      EQU   CVTMAP                                                   06035000
ATAWORKA EQU   ATACLEAR                                                 06036000
ATARCODE EQU   ATA+7                                                    06037000
ATARCRF8 EQU   ATARCRSN                                                 06038000
ATARCRF7 EQU   ATARCRSN                                                 06039000
ATARCRF6 EQU   ATARCRSN                                                 06040000
ATARCRF5 EQU   ATARCRSN                                                 06041000
ATARCRF4 EQU   ATARCRSN                                                 06042000
ATARCRF3 EQU   ATARCRSN                                                 06043000
ATARCRF2 EQU   ATARCRSN                                                 06044000
ATARCRF1 EQU   ATARCRSN                                                 06045000
ATARSV2  EQU   ATARFLGS                                                 06046000
ATABADPK EQU   ATARFLGS                                                 06047000
ATASCCWP EQU   ATARFLGS                                                 06048000
ATASGNST EQU   ATARFLGS                                                 06049000
ATARSV1  EQU   ATASFLGS+1                                               06050000
ATASWPDR EQU   ATASFLGS+1                                               06051000
ATATRPAG EQU   ATASFLGS+1                                               06052000
ATASWAP  EQU   ATASFLGS+1                                               06053000
ATAPAGCM EQU   ATASFLGS                                                 06054000
ATAPAGIO EQU   ATASFLGS                                                 06055000
ATAPOS   EQU   ATASFLGS                                                 06056000
ATAPCOMP EQU   ATASFLGS                                                 06057000
ATAVIOCM EQU   ATASFLGS                                                 06058000
ATASCOMP EQU   ATASFLGS                                                 06059000
ATASLSQA EQU   ATASFLGS                                                 06060000
ATAQIOE  EQU   ATASFLGS                                                 06061000
ATAMODID EQU   ATA                                                      06062000
ASMCPRES EQU   ASMCPRSQ+4                                               06063000
ASMCPTAK EQU   ASMCPRSQ                                                 06064000
ASMCPCNT EQU   ASMCPAVQ+4                                               06065000
ASMCPEXT EQU   ASMPOOLS+6                                               06066000
ASMCPSIZ EQU   ASMPOOLS+4                                               06067000
ASMCPID  EQU   ASMPOOLS                                                 06068000
ASMRSV12 EQU   ASMVT+1000                                               06069000
ASMSAVE  EQU   ASMVT+928                                                06070000
ASMWKSA7 EQU   ASMVT+848                                                06071000
ASMWKSA6 EQU   ASMVT+768                                                06072000
ASMACEPC EQU   ASMVT+344                                                06073000
ASMSWKPC EQU   ASMVT+328                                                06074000
ASMBWKPC EQU   ASMVT+312                                                06075000
ASMRSV10 EQU   ASMVT+280                                                06076000
ASMPVACE EQU   ASMVT+276                                                06077000
ASMPIOFR EQU   ASMVT+272                                                06078000
ASMPVACQ EQU   ASMVT+268                                                06079000
ASMPMSGS EQU   ASMVT+264                                                06080000
ASMPMSG0 EQU   ASMVT+260                                                06081000
ASMPFRLG EQU   ASMVT+256                                                06082000
ASMPRLG  EQU   ASMVT+252                                                06083000
ASMPACT  EQU   ASMVT+248                                                06084000
ASMPSAV  EQU   ASMVT+244                                                06085000
ASMPCMP  EQU   ASMVT+240                                                06086000
ASMPCMPA EQU   ASMVT+236                                                06087000
ASMPCMPN EQU   ASMVT+232                                                06088000
ASMPCMPD EQU   ASMVT+228                                                06089000
ASMPEX   EQU   ASMVT+224                                                06090000
ASMVRMTR EQU   ASMVT+220                                                06091000
ASMPSRBC EQU   ASMVT+216                                                06092000
ASMPSRMT EQU   ASMVT+212                                                06093000
ASMPSWPD EQU   ASMVT+208                                                06094000
ASMPTM   EQU   ASMVT+204                                                06095000
ASMPFRSW EQU   ASMVT+200                                                06096000
ASMPFRSL EQU   ASMVT+196                                                06097000
ASMPQIOE EQU   ASMVT+192                                                06098000
ASMRSV8  EQU   ASMVT+188                                                06099000
ASMVSAMW EQU   ASMVT+184                                                06100000
ASMTASCB EQU   ASMVT+180                                                06101000
ASMRLGWQ EQU   ASMVT+176                                                06102000
ASMRLGRQ EQU   ASMVT+172                                                06103000
ASMTMECB EQU   ASMVT+168                                                06104000
ASMTCBPT EQU   ASMVT+164                                                06105000
ASMREQCT EQU   ASMVT+160                                                06106000
ASMGOSWK EQU   ASMGOSQS+4                                               06107000
ASMGOSWT EQU   ASMGOSQS                                                 06108000
ASMLSAIH EQU   ASMLSAI+4                                                06109000
ASMLSAIL EQU   ASMLSAI                                                  06110000
ASMCINV  EQU   ASMVT+140                                                06111000
ASMSTGXA EQU   ASMVT+136                                                06112000
ASMLGVT  EQU   ASMVT+132                                                06113000
ASMSLOTV EQU   ASMVT+128                                                06114000
ASMERRS  EQU   ASMVT+124                                                06115000
ASMNVSC  EQU   ASMVT+120                                                06116000
ASMVSC   EQU   ASMVT+116                                                06117000
ASMSLOTS EQU   ASMVT+112                                                06118000
ASMBKSLT EQU   ASMVT+108                                                06119000
ASMRSV7  EQU   ASMVT+92                                                 06120000
ASMPSRB  EQU   ASMVT+88                                                 06121000
ASMSRBCT EQU   ASMVT+84                                                 06122000
ASMPCCWN EQU   ASMVT+72                                                 06123000
ASMPCCWC EQU   ASMPCCWQ+4                                               06124000
ASMPCCWA EQU   ASMPCCWQ                                                 06125000
ASMRSV6  EQU   ASMVT+48                                                 06126000
ASMIORQC EQU   ASMVT+44                                                 06127000
ASMIORQR EQU   ASMVT+40                                                 06128000
ASMSTAGL EQU   ASMSTAGQ+4                                               06129000
ASMSTAGF EQU   ASMSTAGQ                                                 06130000
ASMRSV5  EQU   ASMVT+28                                                 06131000
ASMMSGBF EQU   ASMVT+24                                                 06132000
ASMEREC  EQU   ASMVT+20                                                 06133000
ASMTRPAG EQU   ASMVT+16                                                 06134000
ASMGOS   EQU   ASMVT+12                                                 06135000
ASMSART  EQU   ASMVT+4                                                  06136000
ASMDSSFS EQU   ASMVT+2                                                  06137000
ASMWARM  EQU   ASMFLAG2                                                 06138000
ASMQUICK EQU   ASMFLAG2                                                 06139000
ASMNOTPT EQU   ASMFLAG2                                                 06140000
ASMNOTMR EQU   ASMFLAG2                                                 06141000
ASMNOSAV EQU   ASMFLAG2                                                 06142000
ASMCALLQ EQU   ASMFLAG2                                                 06143000
ASMPLPAS EQU   ASMFLAG1                                                 06144000
ASMCOMMF EQU   ASMFLAG1                                                 06145000
ASMPLPAF EQU   ASMFLAG1                                                 06146000
ASMNODPX EQU   ASMFLAG1                                                 06147000
ASMRSV1  EQU   ASMFLAG1                                                 06148000
ASMNOLCL EQU   ASMFLAG1                                                 06149000
ASMNOCWQ EQU   ASMFLAG1                                                 06150000
ASMDUPLX EQU   ASMFLAG1                                                 06151000
AIADPXCT EQU   AIALGE                                                   06152000
AIACEPTR EQU   AIALPMEP                                                 06153000
@NM00002 EQU   AIASSID                                                  06154000
@NM00001 EQU   AIALSID                                                  06155000
AIARSV9  EQU   AIAFLG3                                                  06156000
AIARSV8  EQU   AIAFLG3                                                  06157000
AIARSV7  EQU   AIAFLG3                                                  06158000
AIALPMEC EQU   AIAFLG3                                                  06159000
AIARSV6  EQU   AIAFLG3                                                  06160000
AIATRPSP EQU   AIAFLG3                                                  06161000
AIAPRINO EQU   AIAFLG3                                                  06162000
AIARSV5  EQU   AIAFLG3                                                  06163000
AIABADID EQU   AIAFLG2                                                  06164000
AIAERROR EQU   AIAFLG2                                                  06165000
AIASECER EQU   AIAFLG2                                                  06166000
AIAPRIER EQU   AIAFLG2                                                  06167000
AIARSV4  EQU   AIAFLG2                                                  06168000
AIAIORTY EQU   AIAFLG2                                                  06169000
AIATERMR EQU   AIAFLG2                                                  06170000
AIAFRAUX EQU   AIAFLG2                                                  06171000
AIARSV1  EQU   AIAFLG1                                                  06172000
AIASWPFX EQU   AIAFLG1                                                  06173000
AIAPAGDS EQU   AIAFLG1                                                  06174000
AIALSQA  EQU   AIAFLG1                                                  06175000
AIAVIO   EQU   AIAFLG1                                                  06176000
AIAPRIV  EQU   AIAFLG1                                                  06177000
AIAOP    EQU   AIA+8                                                    06178000
AIABQPA  EQU   AIA+4                                                    06179000
AIAFQPA  EQU   AIA                                                      06180000
@NM00058 EQU   PSA+3668                                                 06181000
PSASTAK  EQU   PSA+3072                                                 06182000
@NM00057 EQU   PSA+1048                                                 06183000
PSAUSEND EQU   PSA+1048                                                 06184000
PSARV062 EQU   PSA+1044                                                 06185000
PSACDAL  EQU   PSA+1040                                                 06186000
PSAWTCOD EQU   PSA+1036                                                 06187000
PSAATCVT EQU   PSA+1032                                                 06188000
PSAPCPSW EQU   PSA+1024                                                 06189000
PSAPIR2  EQU   PSA+1020                                                 06190000
PSARV059 EQU   PSA+1018                                                 06191000
PSASVC13 EQU   PSA+1016                                                 06192000
PSALSFCC EQU   PSA+1012                                                 06193000
PSASFACC EQU   PSA+1008                                                 06194000
PSASTOP  EQU   PSA+992                                                  06195000
PSASTART EQU   PSA+976                                                  06196000
PSARSPSW EQU   PSA+968                                                  06197000
PSASRPSW EQU   PSA+960                                                  06198000
PSARV045 EQU   PSA+892                                                  06199000
PSARV044 EQU   PSA+888                                                  06200000
PSARV043 EQU   PSA+884                                                  06201000
PSARV042 EQU   PSA+880                                                  06202000
PSARV041 EQU   PSA+876                                                  06203000
PSARV040 EQU   PSA+872                                                  06204000
PSARV025 EQU   PSA+868                                                  06205000
PSADSSED EQU   PSA+868                                                  06206000
PSADSSPR EQU   PSA+864                                                  06207000
PSADSSFW EQU   PSA+860                                                  06208000
PSADSS14 EQU   PSA+856                                                  06209000
PSADSSPP EQU   PSA+848                                                  06210000
PSADSSRP EQU   PSA+840                                                  06211000
PSADSS05 EQU   PSADSSF4                                                 06212000
PSADSS10 EQU   PSADSSF4                                                 06213000
PSADSSVE EQU   PSADSSF4                                                 06214000
PSADSSDE EQU   PSADSSF4                                                 06215000
PSADSSC0 EQU   PSADSSF4                                                 06216000
PSADSSIE EQU   PSADSSF4                                                 06217000
PSADSS12 EQU   PSADSSF4                                                 06218000
PSADSSRC EQU   PSADSSF4                                                 06219000
PSARV057 EQU   PSADSSF3                                                 06220000
PSARV056 EQU   PSADSSF3                                                 06221000
PSARV055 EQU   PSADSSF3                                                 06222000
PSADSSMC EQU   PSADSSF3                                                 06223000
PSADSSRW EQU   PSADSSF3                                                 06224000
PSADSSNM EQU   PSADSSF3                                                 06225000
PSADSSES EQU   PSADSSF3                                                 06226000
PSADSSGP EQU   PSADSSF3                                                 06227000
PSADSSF2 EQU   PSADSSFL+1                                               06228000
PSADSSPI EQU   PSADSSF1                                                 06229000
PSADSSOI EQU   PSADSSF1                                                 06230000
PSADSSSP EQU   PSADSSF1                                                 06231000
PSADSSTP EQU   PSADSSF1                                                 06232000
PSADSSDW EQU   PSADSSF1                                                 06233000
PSADSSDD EQU   PSADSSF1                                                 06234000
PSADSSDM EQU   PSADSSF1                                                 06235000
PSADSSMV EQU   PSADSSF1                                                 06236000
PSADSSTS EQU   PSA+816                                                  06237000
PSADSSWK EQU   PSA+812                                                  06238000
PSADSSR3 EQU   PSA+808                                                  06239000
PSADSSR2 EQU   PSA+804                                                  06240000
PSADSSRS EQU   PSA+800                                                  06241000
PSASTOR  EQU   PSA+796                                                  06242000
PSACPUSA EQU   PSA+794                                                  06243000
PSAVSTAP EQU   PSA+792                                                  06244000
PSAWKVAP EQU   PSA+788                                                  06245000
PSAWKRAP EQU   PSA+784                                                  06246000
PSAMCHIC EQU   PSA+783                                                  06247000
PSARV061 EQU   PSA+782                                                  06248000
PSASYMSK EQU   PSA+781                                                  06249000
PSAMCHFL EQU   PSA+780                                                  06250000
PSACR0   EQU   PSA+776                                                  06251000
PSAPSWSV EQU   PSA+768                                                  06252000
PSALITA  EQU   PSA+764                                                  06253000
PSACLHS  EQU   PSAHLHI                                                  06254000
PSALKR15 EQU   PSALKSA+60                                               06255000
PSALKR14 EQU   PSALKSA+56                                               06256000
PSALKR13 EQU   PSALKSA+52                                               06257000
PSALKR12 EQU   PSALKSA+48                                               06258000
PSALKR11 EQU   PSALKSA+44                                               06259000
PSALKR10 EQU   PSALKSA+40                                               06260000
PSALKR9  EQU   PSALKSA+36                                               06261000
PSALKR8  EQU   PSALKSA+32                                               06262000
PSALKR7  EQU   PSALKSA+28                                               06263000
PSALKR6  EQU   PSALKSA+24                                               06264000
PSALKR5  EQU   PSALKSA+20                                               06265000
PSALKR4  EQU   PSALKSA+16                                               06266000
PSALKR3  EQU   PSALKSA+12                                               06267000
PSALKR2  EQU   PSALKSA+8                                                06268000
PSALKR1  EQU   PSALKSA+4                                                06269000
PSALKR0  EQU   PSALKSA                                                  06270000
PSARV023 EQU   PSACLHT+52                                               06271000
PSALOCAL EQU   PSACLHT+48                                               06272000
PSACMSL  EQU   PSACLHT+44                                               06273000
PSAOPTL  EQU   PSACLHT+40                                               06274000
PSATPACL EQU   PSACLHT+36                                               06275000
PSATPDNL EQU   PSACLHT+32                                               06276000
PSATPNCL EQU   PSACLHT+28                                               06277000
PSAIOSLL EQU   PSACLHT+24                                               06278000
PSAIOSUL EQU   PSACLHT+20                                               06279000
PSAIOSCL EQU   PSACLHT+16                                               06280000
PSAIOSSL EQU   PSACLHT+12                                               06281000
PSASALCL EQU   PSACLHT+8                                                06282000
PSAASML  EQU   PSACLHT+4                                                06283000
PSADISPL EQU   PSACLHT                                                  06284000
PSASRSA  EQU   PSA+636                                                  06285000
PSARV050 EQU   PSA+634                                                  06286000
PSADSSGO EQU   PSA+633                                                  06287000
PSARECUR EQU   PSA+632                                                  06288000
PSAHLHIS EQU   PSA+628                                                  06289000
PSAIPCSA EQU   PSA+624                                                  06290000
@NM00056 EQU   PSA+621                                                  06291000
PSAIPCDM EQU   PSA+620                                                  06292000
PSAIPCD  EQU   PSA+616                                                  06293000
@NM00055 EQU   PSA+613                                                  06294000
PSAIPCRM EQU   PSA+612                                                  06295000
PSAIPCR  EQU   PSA+608                                                  06296000
PSAMCHEX EQU   PSA+600                                                  06297000
PSAMPSW  EQU   PSA+592                                                  06298000
PSAEXPS2 EQU   PSA+584                                                  06299000
PSAEXPS1 EQU   PSA+576                                                  06300000
PSAPIREG EQU   PSA+572                                                  06301000
PSARSREG EQU   PSA+568                                                  06302000
PSAGPREG EQU   PSA+556                                                  06303000
PSARV022 EQU   PSASUP4                                                  06304000
PSARV021 EQU   PSASUP4                                                  06305000
PSARV020 EQU   PSASUP4                                                  06306000
PSARV019 EQU   PSASUP4                                                  06307000
PSARV018 EQU   PSASUP4                                                  06308000
PSARV017 EQU   PSASUP4                                                  06309000
PSARV016 EQU   PSASUP4                                                  06310000
PSARV015 EQU   PSASUP4                                                  06311000
PSARV014 EQU   PSASUP3                                                  06312000
PSAULCMS EQU   PSASUP3                                                  06313000
PSARV012 EQU   PSASUP3                                                  06314000
PSAESTA  EQU   PSASUP3                                                  06315000
PSASPR   EQU   PSASUP3                                                  06316000
PSAPSREG EQU   PSASUP3                                                  06317000
PSAPI2   EQU   PSASUP3                                                  06318000
PSAIOSUP EQU   PSASUP3                                                  06319000
PSALCR   EQU   PSASUP2                                                  06320000
PSARTM   EQU   PSASUP2                                                  06321000
PSAACR   EQU   PSASUP2                                                  06322000
PSAIPCE2 EQU   PSASUP2                                                  06323000
PSAIPCES EQU   PSASUP2                                                  06324000
PSAIPCEC EQU   PSASUP2                                                  06325000
PSAGTF   EQU   PSASUP2                                                  06326000
PSAIPCRI EQU   PSASUP2                                                  06327000
PSATYPE6 EQU   PSASUP1                                                  06328000
PSATCTL  EQU   PSASUP1                                                  06329000
PSADISP  EQU   PSASUP1                                                  06330000
PSALOCK  EQU   PSASUP1                                                  06331000
PSAPI    EQU   PSASUP1                                                  06332000
PSAEXT   EQU   PSASUP1                                                  06333000
PSASVC   EQU   PSASUP1                                                  06334000
PSAIO    EQU   PSASUP1                                                  06335000
PSAAOLD  EQU   PSA+548                                                  06336000
PSAANEW  EQU   PSA+544                                                  06337000
PSATOLD  EQU   PSA+540                                                  06338000
PSATNEW  EQU   PSA+536                                                  06339000
PSALCCAR EQU   PSA+532                                                  06340000
PSALCCAV EQU   PSA+528                                                  06341000
PSAPCCAR EQU   PSA+524                                                  06342000
PSAPCCAV EQU   PSA+520                                                  06343000
PSACPULA EQU   PSA+518                                                  06344000
PSACPUPA EQU   PSA+516                                                  06345000
PSAPSA   EQU   PSA+512                                                  06346000
FLCHDEND EQU   PSA+512                                                  06347000
FLCCRSAV EQU   FLCMCLA+280                                              06348000
FLCGRSAV EQU   FLCMCLA+216                                              06349000
FLCFPSAV EQU   FLCMCLA+184                                              06350000
FLCFLA   EQU   FLCMCLA+88                                               06351000
FLCRGNCD EQU   FLCMCLA+84                                               06352000
FLCFSAA  EQU   FLCFSA+1                                                 06353000
@NM00054 EQU   FLCFSA                                                   06354000
@NM00053 EQU   FLCMCLA+72                                               06355000
FLCMCIC  EQU   FLCMCLA+64                                               06356000
@NM00052 EQU   FLCMCLA+20                                               06357000
FLCIOAA  EQU   FLCIOA+1                                                 06358000
@NM00051 EQU   FLCIOA                                                   06359000
@NM00050 EQU   FLCMCLA+15                                               06360000
@NM00049 EQU   FLCMCLA+14                                               06361000
@NM00048 EQU   FLCMCLA+12                                               06362000
FLCLCL   EQU   FLCMCLA+8                                                06363000
FLCIOELA EQU   FLCIOEL+1                                                06364000
@NM00047 EQU   FLCIOEL                                                  06365000
FLCCHNID EQU   FLCMCLA                                                  06366000
@NM00046 EQU   PSA+160                                                  06367000
FLCMTRCD EQU   PSA+157                                                  06368000
@NM00045 EQU   PSA+156                                                  06369000
FLCPERA  EQU   FLCPER+1                                                 06370000
@NM00044 EQU   FLCPER                                                   06371000
@NM00043 EQU   PSA+151                                                  06372000
FLCPERCD EQU   PSA+150                                                  06373000
FLCMCNUM EQU   PSA+149                                                  06374000
@NM00042 EQU   PSA+148                                                  06375000
FLCTEAA  EQU   FLCTEA+1                                                 06376000
@NM00041 EQU   FLCTEA                                                   06377000
PSAPIPC  EQU   PSAPICOD                                                 06378000
PSAPIMC  EQU   PSAPICOD                                                 06379000
PSAPIPER EQU   PSAPICOD                                                 06380000
PSARV049 EQU   FLCPICOD                                                 06381000
FLCPILCB EQU   FLCPIILC                                                 06382000
@NM00040 EQU   FLCPIILC                                                 06383000
@NM00039 EQU   PSAEPPSW                                                 06384000
FLCSVCN  EQU   PSAESPSW+2                                               06385000
FLCSILCB EQU   FLCSVILC                                                 06386000
@NM00038 EQU   FLCSVILC                                                 06387000
@NM00037 EQU   PSAESPSW                                                 06388000
FLCEICOD EQU   PSAEEPSW+2                                               06389000
PSASPAD  EQU   PSAEEPSW                                                 06390000
@NM00036 EQU   PSA+128                                                  06391000
FLCINPSW EQU   PSA+120                                                  06392000
FLCMNPSW EQU   PSA+112                                                  06393000
FLCPNPSW EQU   PSA+104                                                  06394000
FLCSNPSW EQU   PSA+96                                                   06395000
FLCENPSW EQU   PSA+88                                                   06396000
FLCTRACE EQU   PSA+84                                                   06397000
FLCTIMER EQU   PSA+80                                                   06398000
FLCCVT2  EQU   PSA+76                                                   06399000
FLCCAW   EQU   PSA+72                                                   06400000
FLCCSW   EQU   PSA+64                                                   06401000
FLCIOPSW EQU   PSA+56                                                   06402000
FLCMOPSW EQU   PSA+48                                                   06403000
FLCPOPSW EQU   PSA+40                                                   06404000
FLCSOPSW EQU   PSA+32                                                   06405000
FLCEOPSW EQU   PSA+24                                                   06406000
@NM00035 EQU   FLCICCW2+4                                               06407000
FLCICCW1 EQU   FLCROPSW                                                 06408000
FLCIPPSW EQU   FLCRNPSW                                                 06409000
*                                      END UNREFERENCED COMPONENTS      06410000
@RC00183 EQU   @RC00182                                                 06411000
@RC00212 EQU   @RC00207                                                 06412000
@RC00274 EQU   @EL00007                                                 06413000
@RC00288 EQU   @EL00007                                                 06414000
@RC00315 EQU   @RC00314                                                 06415000
@RC00407 EQU   @RC00405                                                 06416000
@RC00456 EQU   @RC00454                                                 06417000
@RF00555 EQU   @RC00551                                                 06418000
@RC00583 EQU   @RC00582                                                 06419000
@RC00610 EQU   @EL00017                                                 06420000
@RC00278 EQU   @RC00274                                                 06421000
@ENDDATA EQU   *                                                        06422000
         END   ILRSRT,(C'PLS1734',0701,78110)                           06423000
