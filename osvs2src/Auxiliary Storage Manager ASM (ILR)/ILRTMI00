         TITLE 'ILRTMI00 - TASK MODE INITIALIZATION                    *00001000
                        '                                               00002000
ILRTMI00 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ILRTMI00  77.325'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  LA    @12,4095(,@11)                                      0001 00012000
         USING @PSTART,@11                                         0001 00013000
         USING @PSTART+4095,@12                                    0001 00014000
         ST    @13,@SA00001+4                                      0001 00015000
         LA    @14,@SA00001                                        0001 00016000
         ST    @14,8(,@13)                                         0001 00017000
         LR    @13,@14                                             0001 00018000
STRTPGM@ EQU   @PSTART                                                  00019000
*                                      CHARS. TO EBCDIC      @ZA26483*/ 00020000
         EJECT                                                          00021000
*                                                                  0128 00022000
*/********************************************************************/ 00023000
*/********************************************************************/ 00024000
*/*  MISCELLANEOUS INITIALIZATION                                    */ 00025000
*/********************************************************************/ 00026000
*/********************************************************************/ 00027000
*                                                                  0128 00028000
*   /*****************************************************************/ 00029000
*   /*                                                               */ 00030000
*   /* RECORD RECOVERY INFORMATION IN THE EPATH.                     */ 00031000
*   /*                                                               */ 00032000
*   /*****************************************************************/ 00033000
*                                                                  0128 00034000
*   EPATMI=ON;                      /* TURN ON THE TMI FLAG IN THE 0128 00035000
*                                      EPATH TO INDICATE THAT      0128 00036000
*                                      ILRTMI00 IS CURRENTLY       0128 00037000
*                                      PROCESSING - RRR              */ 00038000
         OI    EPATMI(EPAPTR),B'00000100'                          0128 00039000
*   EPATMIBA=ADDR(STRTPGM@);        /* RECORD BASE REGISTER VALUE FOR   00040000
*                                      ILRTMI00 IN EPATH - RRR       */ 00041000
         LA    @10,STRTPGM@                                        0129 00042000
         ST    @10,EPATMIBA(,EPAPTR)                               0129 00043000
*   EPATMISV=R13;                   /* RECORD ADDRESS OF ILRTMI00'S     00044000
*                                      SAVE AREA IN EPATH            */ 00045000
*                                                                  0130 00046000
         ST    R13,EPATMISV(,EPAPTR)                               0130 00047000
*   /*****************************************************************/ 00048000
*   /*                                                               */ 00049000
*   /* SAVE POINTER TO TEMPORARY PAGE ADDRESS REFERENCE TABLE        */ 00050000
*   /* (TPARTBLE) - RRR                                              */ 00051000
*   /*                                                               */ 00052000
*   /*****************************************************************/ 00053000
*                                                                  0131 00054000
*   TPARPTR=PARTTPAR;               /* SAVE POINTER TO TPARTBLE      */ 00055000
         L     @10,PARTPTR(,ASMVTPTR)                              0131 00056000
         L     @10,PARTTPAR(,@10)                                  0131 00057000
         ST    @10,TPARPTR                                         0131 00058000
*   EPATPART=TPARPTR;               /* RECORD POINTER TO TPARTBLE IN    00059000
*                                      EPATH - RRR                   */ 00060000
*                                                                  0132 00061000
         ST    @10,EPATPART(,EPAPTR)                               0132 00062000
*   /*****************************************************************/ 00063000
*   /*                                                               */ 00064000
*   /* INITIALIZE INTERNAL RETURN CODE                               */ 00065000
*   /*                                                               */ 00066000
*   /*****************************************************************/ 00067000
*                                                                  0133 00068000
*   INTRTCD=ZERO;                   /* SET INTERNAL RETURN CODE TO 0133 00069000
*                                      ZERO                          */ 00070000
         SLR   @10,@10                                             0133 00071000
         ST    @10,INTRTCD                                         0133 00072000
         EJECT                                                          00073000
*                                                                  0134 00074000
*/********************************************************************/ 00075000
*/********************************************************************/ 00076000
*/*   CREATE I/O BUFFER AND RPL BUILD AREA                           */ 00077000
*/********************************************************************/ 00078000
*/********************************************************************/ 00079000
*                                                                  0134 00080000
*   /*****************************************************************/ 00081000
*   /*                                                               */ 00082000
*   /* OBTAIN STORAGE FROM CSA (SUBPOOL 241) FOR I/O BUFFER AND RPL  */ 00083000
*   /* BUILD AREA VIA GETMAIN                                        */ 00084000
*   /*                                                               */ 00085000
*   /*****************************************************************/ 00086000
*                                                                  0134 00087000
*   RFY                                                            0134 00088000
*    (R1) RSTD;                                                    0134 00089000
*   DO;                             /* GETMAIN (RU) LV(LENGTH(IOBUFFE   00090000
*                                      R)+LENGTH(RPLBAREA)) SP(241)  */ 00091000
*     RESPECIFY                                                    0136 00092000
*      (GPR01F,                                                    0136 00093000
*       GPR15F,                                                    0136 00094000
*       GPR00F) RESTRICTED;                                        0136 00095000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 00096000
         SLR   GPR01F,GPR01F                                       0137 00097000
*     GPR15F=2;                     /* RU-TYPE GETMAIN               */ 00098000
         LA    GPR15F,2                                            0138 00099000
*     GPR00F=LENGTH(IOBUFFER)+LENGTH(RPLBAREA);/* LENGTH REQUESTED   */ 00100000
         LA    GPR00F,2124                                         0139 00101000
*     GPR15F=GPR15F|((241)*256);    /* SP IN BYTE 2                  */ 00102000
         O     GPR15F,@CF01651                                     0140 00103000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 00104000
         SVC   120                                                 0141 00105000
*     RESPECIFY                                                    0142 00106000
*      (GPR01F,                                                    0142 00107000
*       GPR15F,                                                    0142 00108000
*       GPR00F) UNRESTRICTED;                                      0142 00109000
*   END;                            /* GETMAIN (RU) LV(LENGTH(IOBUFFE   00110000
*                                      R)+LENGTH(RPLBAREA)) SP(241)     00111000
*                                      OBTAIN THE NEEDED STORAGE     */ 00112000
*   GETAREA@=R1;                    /* SAVE POINTER TO GETMAINED AREA   00113000
*                                      IN GETAREA@                   */ 00114000
         ST    R1,GETAREA@                                         0144 00115000
*   EPATMWKA=GETAREA@;              /* RECORD ADDRESS OF THE       0145 00116000
*                                      GETMAINED AREA CONTAINING THE    00117000
*                                      I/O BUFFER AND RPL BUILD AREA    00118000
*                                      IN THE EPATH - RRR            */ 00119000
         L     @10,GETAREA@                                        0145 00120000
         ST    @10,EPATMWKA(,EPAPTR)                               0145 00121000
*   RFY                                                            0146 00122000
*    (R1) UNRSTD;                                                  0146 00123000
*                                                                  0146 00124000
*   /*****************************************************************/ 00125000
*   /*                                                               */ 00126000
*   /* OBTAIN POINTERS TO I/O BUFFER AND RPL BUILD AREA. CLEAR I/O   */ 00127000
*   /* BUFFER AND RPL BUILD AREA. NOTE THAT RECOVERY EXPECTS THE RPL */ 00128000
*   /* BUILD AREA TO BE AT THE BEGINNING OF THE GETMAINED AREA       */ 00129000
*   /*                                                               */ 00130000
*   /*****************************************************************/ 00131000
*                                                                  0147 00132000
*   RFY                                                            0147 00133000
*    (IOBUFPTR,                                                    0147 00134000
*     RPLAREA@) RSTD;                                              0147 00135000
*   IOBUFPTR=GETAREA@+LENGTH(RPLBAREA);/* OBTAIN POINTER TO I/O    0148 00136000
*                                      BUFFER                        */ 00137000
         LA    IOBUFPTR,76                                         0148 00138000
         ALR   IOBUFPTR,@10                                        0148 00139000
*   RPLAREA@=GETAREA@;              /* OBTAIN POINTER TO RPL BUILD 0149 00140000
*                                      AREA                          */ 00141000
         LR    RPLAREA@,@10                                        0149 00142000
*   RFY                                                            0150 00143000
*     IFGRPL BASED(RPLAREA@);                                      0150 00144000
*   RFY                                                            0151 00145000
*    (RECADDR,                                                     0151 00146000
*     RECLEN,                                                      0151 00147000
*     SRCADDR,                                                     0151 00148000
*     SRCLEN) RSTD;                                                0151 00149000
*   RECADDR=GETAREA@;               /* SET RECEIVER ADDRESS TO     0152 00150000
*                                      BEGINNING OF THE GETMAINED  0152 00151000
*                                      AREA                          */ 00152000
         LR    RECADDR,@10                                         0152 00153000
*   RECLEN=LENGTH(IOBUFFER)+LENGTH(RPLBAREA);/* SET RECEIVER LENGTH     00154000
*                                      TO THAT OF I/O BUFFER AND RPL    00155000
*                                      BUILD AREA                    */ 00156000
         LA    RECLEN,2124                                         0153 00157000
*   SRCLEN=PADZERO;                 /* SET PADDING CHARACTER TO ZERO    00158000
*                                      AND SOURCE LENGTH TO ZERO     */ 00159000
         SLR   SRCLEN,SRCLEN                                       0154 00160000
*   MVCL(RECADDR,SRCADDR);          /* CLEAR THE I/O BUFFER AND RPL     00161000
*                                      BUILD AREA                    */ 00162000
         MVCL  RECADDR,SRCADDR                                     0155 00163000
*   RFY                                                            0156 00164000
*    (RECADDR,                                                     0156 00165000
*     RECLEN,                                                      0156 00166000
*     SRCADDR,                                                     0156 00167000
*     SRCLEN) UNRSTD;                                              0156 00168000
         EJECT                                                          00169000
*                                                                  0157 00170000
*/********************************************************************/ 00171000
*/********************************************************************/ 00172000
*/*   CREATE ACB BUILD AREA                                          */ 00173000
*/********************************************************************/ 00174000
*/********************************************************************/ 00175000
*                                                                  0157 00176000
*   /*****************************************************************/ 00177000
*   /*                                                               */ 00178000
*   /* OBTAIN STORAGE FROM SQA (SUBPOOL 245) FOR ACB BUILD AREA VIA  */ 00179000
*   /* GETMAIN                                                       */ 00180000
*   /*                                                               */ 00181000
*   /*****************************************************************/ 00182000
*                                                                  0157 00183000
*   RFY                                                            0157 00184000
*    (R1,                                                          0157 00185000
*     ACBAREA@) RSTD;                                              0157 00186000
*   DO;                             /* GETMAIN (RU)                0158 00187000
*                                      LV(LENGTH(ACBBAREA)) SP(245)  */ 00188000
*     RESPECIFY                                                    0159 00189000
*      (GPR01F,                                                    0159 00190000
*       GPR15F,                                                    0159 00191000
*       GPR00F) RESTRICTED;                                        0159 00192000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 00193000
         SLR   GPR01F,GPR01F                                       0160 00194000
*     GPR15F=2;                     /* RU-TYPE GETMAIN               */ 00195000
         LA    GPR15F,2                                            0161 00196000
*     GPR00F=LENGTH(ACBBAREA);      /* LENGTH REQUESTED              */ 00197000
         LA    GPR00F,76                                           0162 00198000
*     GPR15F=GPR15F|((245)*256);    /* SP IN BYTE 2                  */ 00199000
         O     GPR15F,@CF01652                                     0163 00200000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 00201000
         SVC   120                                                 0164 00202000
*     RESPECIFY                                                    0165 00203000
*      (GPR01F,                                                    0165 00204000
*       GPR15F,                                                    0165 00205000
*       GPR00F) UNRESTRICTED;                                      0165 00206000
*   END;                            /* GETMAIN (RU)                0166 00207000
*                                      LV(LENGTH(ACBBAREA)) SP(245)     00208000
*                                      OBTAIN THE NEEDED STORAGE     */ 00209000
*   ACBAREA@=R1;                    /* SAVE POINTER GETMAINED AREA IN   00210000
*                                      ACBAREA@                      */ 00211000
         LR    ACBAREA@,R1                                         0167 00212000
*   EPATMACB=ACBAREA@;              /* RECORD ADDRESS OF ACB BUILD 0168 00213000
*                                      AREA IN THE EPATH - RRR       */ 00214000
         ST    ACBAREA@,EPATMACB(,EPAPTR)                          0168 00215000
*   RFY                                                            0169 00216000
*    (R1) UNRSTD;                                                  0169 00217000
*   RFY                                                            0170 00218000
*     IFGACB BASED(ACBAREA@);                                      0170 00219000
*   ACBBAREA=ACBBAREA&&ACBBAREA;    /* CLEAR ACB BUILD AREA          */ 00220000
*                                                                  0171 00221000
         XC    ACBBAREA(76,ACBAREA@),ACBBAREA(ACBAREA@)            0171 00222000
*   /*****************************************************************/ 00223000
*   /*                                                               */ 00224000
*   /* SET UP ADDRESSABILITY TO THE ARDB ( ACB -> AMBL -> AMB ->     */ 00225000
*   /* AMDSB -> ARDB )                                               */ 00226000
*   /*                                                               */ 00227000
*   /*****************************************************************/ 00228000
*                                                                  0172 00229000
*   RFY                                                            0172 00230000
*     IDAAMBL BASED(AMBLPTR);                                      0172 00231000
*   RFY                                                            0173 00232000
*     IDAAMB BASED(AMBPTR);                                        0173 00233000
*   RFY                                                            0174 00234000
*     IDAAMDSB BASED(AMDSBPTR);                                    0174 00235000
*   RFY                                                            0175 00236000
*     IDAARDB BASED(ARDBPTR);                                      0175 00237000
         EJECT                                                          00238000
*                                                                  0176 00239000
*/********************************************************************/ 00240000
*/********************************************************************/ 00241000
*/*   BUILD CONTROL BLOCKS FOR DYNAMIC ALLOCATION REQUEST            */ 00242000
*/********************************************************************/ 00243000
*/********************************************************************/ 00244000
*                                                                  0176 00245000
*   /*****************************************************************/ 00246000
*   /*                                                               */ 00247000
*   /* BUILD THE DYNAMIC ALLOCATION REQUEST BLOCK POINTER AS WELL AS */ 00248000
*   /* THE DYNAMIC ALLOCATION REQUEST BLOCK                          */ 00249000
*   /*                                                               */ 00250000
*   /*****************************************************************/ 00251000
*                                                                  0176 00252000
*   S99RBPTR=ADDR(S99RB);           /* SET DYNAMIC ALLOCATION REQUEST   00253000
*                                      BLOCK POINTER                 */ 00254000
         LA    @10,S99RB                                           0176 00255000
         ST    @10,S99RBPTR                                        0176 00256000
*   S99RBPND=ON;                    /* TURN ON LAST INDICATOR        */ 00257000
         OI    S99RBPND,B'10000000'                                0177 00258000
*   S99RB=''B;                      /* INITIALIZE DYNAMIC ALLOCATION    00259000
*                                      REQUEST BLOCK                 */ 00260000
         XC    S99RB(20),S99RB                                     0178 00261000
*   S99RBLN=LENGTH(S99RB);          /* SET REQUEST BLOCK LENGTH      */ 00262000
         MVI   S99RBLN,X'14'                                       0179 00263000
*   S99VERB=S99VRBAL;               /* SET VERB CODE FOR ALLOCATION  */ 00264000
         MVI   S99VERB,X'01'                                       0180 00265000
*   S99TXTPP=ADDR(DATUPTRS);        /* SET ADDRESS OF THE LIST OF  0181 00266000
*                                      TEXT UNIT POINTERS            */ 00267000
         LA    @10,DATUPTRS                                        0181 00268000
         ST    @10,S99TXTPP                                        0181 00269000
*   S99NORES=ON;                    /* SET NO DATA SET RESERVATION 0182 00270000
*                                      FLAG ON                       */ 00271000
*                                                                  0182 00272000
         OI    S99NORES,B'00100000'                                0182 00273000
*   /*****************************************************************/ 00274000
*   /*                                                               */ 00275000
*   /* BUILD THE DYNAMIC ALLOCATION TEXT UNIT FOR DDNAME = STGINDEX. */ 00276000
*   /*                                                               */ 00277000
*   /*****************************************************************/ 00278000
*                                                                  0183 00279000
*   RFY                                                            0183 00280000
*     S99TUNIT BASED(ADDR(DATUDDN));                               0183 00281000
*   S99TUKEY=DALDDNAM;              /* SET KEY FOR DDNAME            */ 00282000
         LA    @10,DATUDDN                                         0184 00283000
         MVC   S99TUKEY(2,@10),@CB01067                            0184 00284000
*   S99TUNUM=ONE;                   /* SET NUMBER OF PARAMETERS      */ 00285000
         LA    @02,1                                               0185 00286000
         STCM  @02,3,S99TUNUM(@10)                                 0185 00287000
*   S99TULNG=LENGTH(DDNAME);        /* SET LENGTH OF PARAMETERS      */ 00288000
         MVC   S99TULNG(2,@10),@CH00037                            0186 00289000
*   S99TUPAR(ONE:LENGTH(DDNAME))=DDNAME;/* SET PARAMETER             */ 00290000
*                                                                  0187 00291000
         MVC   S99TUPAR(8,@10),@CC01347                            0187 00292000
*   /*****************************************************************/ 00293000
*   /*                                                               */ 00294000
*   /* BUILD THE DYNAMIC ALLOCATION TEXT UNIT FOR DSNAME =           */ 00295000
*   /* SYS1.STGINDEX                                                 */ 00296000
*   /*                                                               */ 00297000
*   /*****************************************************************/ 00298000
*                                                                  0188 00299000
*   RFY                                                            0188 00300000
*     S99TUNIT BASED(ADDR(DATUDSN));                               0188 00301000
*   S99TUKEY=DALDSNAM;              /* SET KEY FOR DSNAME            */ 00302000
         LA    @10,DATUDSN                                         0189 00303000
         MVC   S99TUKEY(2,@10),@CB01069                            0189 00304000
*   S99TUNUM=ONE;                   /* SET NUMBER OF PARAMETERS      */ 00305000
         STCM  @02,3,S99TUNUM(@10)                                 0190 00306000
*   S99TULNG=LENGTH(DSNAME);        /* SET LENGTH OF PARAMETERS      */ 00307000
         MVC   S99TULNG(2,@10),@CH00904                            0191 00308000
*   S99TUPAR(ONE:LENGTH(DSNAME))=DSNAME;/* SET PARAMETER             */ 00309000
*                                                                  0192 00310000
         MVC   S99TUPAR(13,@10),@CC01351                           0192 00311000
*   /*****************************************************************/ 00312000
*   /*                                                               */ 00313000
*   /* BUILD THE DYNAMIC ALLOCATION TEXT UNIT FOR DSORG = VSAM       */ 00314000
*   /*                                                               */ 00315000
*   /*****************************************************************/ 00316000
*                                                                  0193 00317000
*   RFY                                                            0193 00318000
*     S99TUNIT BASED(ADDR(DATUDSRG));                              0193 00319000
*   S99TUKEY=DALRTORG;              /* SET KEY FOR RETURN DATA SET 0194 00320000
*                                      ORGANIZATION                  */ 00321000
         LA    @10,DATUDSRG                                        0194 00322000
         MVC   S99TUKEY(2,@10),@CB01239                            0194 00323000
*   S99TUNUM=ONE;                   /* SET NUMBER OF PARAMETERS      */ 00324000
         STCM  @02,3,S99TUNUM(@10)                                 0195 00325000
*   S99TULNG=LENGTH(DSORG)/ONEBYTE; /* SET LENGTH OF PARAMETERS      */ 00326000
         MVC   S99TULNG(2,@10),@CH00092                            0196 00327000
*   S99TUPAR(ONE:LENGTH(DSORG)/ONEBYTE)=DSORG;/* SET PARAMETER       */ 00328000
*                                                                  0197 00329000
         MVC   S99TUPAR(2,@10),@CB01097                            0197 00330000
*   /*****************************************************************/ 00331000
*   /*                                                               */ 00332000
*   /* BUILD THE DYNAMIC ALLOCATION TEXT UNIT FOR STATUS = OLD       */ 00333000
*   /*                                                               */ 00334000
*   /*****************************************************************/ 00335000
*                                                                  0198 00336000
*   RFY                                                            0198 00337000
*     S99TUNIT BASED(ADDR(DATUSTAT));                              0198 00338000
*   S99TUKEY=DALSTATS;              /* SET KEY FOR DATA SET STATUS   */ 00339000
         LA    @10,DATUSTAT                                        0199 00340000
         MVC   S99TUKEY(2,@10),@CB01073                            0199 00341000
*   S99TUNUM=ONE;                   /* SET NUMBER OF PARAMETERS      */ 00342000
         STCM  @02,3,S99TUNUM(@10)                                 0200 00343000
*   S99TULNG=LENGTH(STATOLD)/ONEBYTE;/* SET LENGTH OF PARAMETERS     */ 00344000
         STCM  @02,3,S99TULNG(@10)                                 0201 00345000
*   S99TUPAR(ONE:LENGTH(STATOLD)/ONEBYTE)=STATOLD;/* SET PARAMETER   */ 00346000
*                                                                  0202 00347000
         MVI   S99TUPAR(@10),X'01'                                 0202 00348000
*   /*****************************************************************/ 00349000
*   /*                                                               */ 00350000
*   /* BUILD THE DYNAMIC ALLOCATION TEXT UNIT FOR DISP = KEEP        */ 00351000
*   /*                                                               */ 00352000
*   /*****************************************************************/ 00353000
*                                                                  0203 00354000
*   RFY                                                            0203 00355000
*     S99TUNIT BASED(ADDR(DATUDISP));                              0203 00356000
*   S99TUKEY=DALNDISP;              /* SET KEY FOR DATA SET        0204 00357000
*                                      DISPOSITION                   */ 00358000
         LA    @10,DATUDISP                                        0204 00359000
         MVC   S99TUKEY(2,@10),@CB01075                            0204 00360000
*   S99TUNUM=ONE;                   /* SET NUMBER OF PARAMETERS      */ 00361000
         STCM  @02,3,S99TUNUM(@10)                                 0205 00362000
*   S99TULNG=LENGTH(DISPKEEP)/ONEBYTE;/* SET LENGTH OF PARAMETERS    */ 00363000
         STCM  @02,3,S99TULNG(@10)                                 0206 00364000
*   S99TUPAR(ONE:LENGTH(DISPKEEP)/ONEBYTE)=DISPKEEP;/* SET PARAMETER */ 00365000
         MVI   S99TUPAR(@10),X'08'                                 0207 00366000
         EJECT                                                          00367000
*                                                                  0208 00368000
*/********************************************************************/ 00369000
*/********************************************************************/ 00370000
*/*   ISSUE A DYNAMIC ALLOCATION REQUEST FOR SYS1.STGINDEX           */ 00371000
*/********************************************************************/ 00372000
*/********************************************************************/ 00373000
*                                                                  0208 00374000
*   /*****************************************************************/ 00375000
*   /*                                                               */ 00376000
*   /* ISSUE A DYNAMIC ALLOCATION REQUEST FOR SYS1.STGINDEX          */ 00377000
*   /*                                                               */ 00378000
*   /*****************************************************************/ 00379000
*                                                                  0208 00380000
*   RFY                                                            0208 00381000
*    (R1,                                                          0208 00382000
*     DYNARTCD) RSTD;                                              0208 00383000
*   R1=ADDR(S99RBPTR);              /* SET REG 1 TO ADDRESS OF     0209 00384000
*                                      DYNAMIC ALLOCATION REQUEST  0209 00385000
*                                      BLOCK POINTER                 */ 00386000
         LA    R1,S99RBPTR                                         0209 00387000
*   SVC(99);                        /* DYNAMIC ALLOCATION REQUEST    */ 00388000
         SVC   99                                                  0210 00389000
*   RFY                                                            0211 00390000
*    (R1) UNRSTD;                                                  0211 00391000
*                                                                  0211 00392000
*   /*****************************************************************/ 00393000
*   /*                                                               */ 00394000
*   /* IF THE DYNAMIC ALLOCATION REQUEST FOR SYS1.STGINDEX WAS       */ 00395000
*   /* UNSUCCESSFUL, THEN ASK THE OPERATOR IF IT IS O.K. TO CONTINUE */ 00396000
*   /* WITHOUT VIO JOURNALING AND WAIT FOR OPERATOR'S RESPONSE. IF   */ 00397000
*   /* THE OPERATOR RESPONDS, THEN CONTINUE WITH THE BUILDING OF THE */ 00398000
*   /* DATA SET NAME LIST. IF THE DYNAMIC ALLOCATION REQUEST FOR     */ 00399000
*   /* SYS1.STGINDEX WAS SUCCESSFUL, THEN INITIALIZE SYS1.STGINDEX   */ 00400000
*   /* FOR VIO JOURNALING AFTER WHICH THE DATA SET NAME LIST IS      */ 00401000
*   /* BUILT.                                                        */ 00402000
*   /*                                                               */ 00403000
*   /*****************************************************************/ 00404000
*                                                                  0212 00405000
*   IF DYNARTCD^=ZERO THEN                                         0212 00406000
         LTR   DYNARTCD,DYNARTCD                                   0212 00407000
         BZ    @RF00212                                            0212 00408000
*     DO;                                                          0213 00409000
*       RFY                                                        0214 00410000
*        (DYNARTCD) UNRSTD;                                        0214 00411000
*                                                                  0214 00412000
*       /*************************************************************/ 00413000
*       /*                                                           */ 00414000
*       /* TELL OPERATOR THAT SYS1.STGINDEX COULD NOT BE INITIALIZED.*/ 00415000
*       /* ASK THE OPERATOR IF IT IS O.K. TO CONTINUE WITHOUT VIO    */ 00416000
*       /* JOURNALING AND THEN WAIT FOR OPERATOR'S RESPONSE.         */ 00417000
*       /*                                                           */ 00418000
*       /*************************************************************/ 00419000
*                                                                  0215 00420000
*       RC(3:4)=S99ERROR;           /* GIVE THE XXXX PORTION OF    0215 00421000
*                                                            @ZA26483*/ 00422000
         MVC   RC+2(2),S99ERROR                                    0215 00423000
*       SLL(RC,FOURBYTE);           /* WTO01M ITS DYNAMIC ALLO-    0216 00424000
*                                                            @ZA26483*/ 00425000
         ICM   @10,15,RC                                           0216 00426000
         SLL   @10,4                                               0216 00427000
         STCM  @10,15,RC                                           0216 00428000
*       UNPK(RTNCODE,RC);           /* CATION ERROR CODE. NEXT,    0217 00429000
*                                                            @ZA26483*/ 00430000
         UNPK  RTNCODE(4),RC(4)                                    0217 00431000
*       RTNCODE=RTNCODE&STRIP;      /* CONVERT THE ERROR CODE      0218 00432000
*                                                            @ZA26483*/ 00433000
         NC    RTNCODE(4),STRIP                                    0218 00434000
*       TR(RTNCODE,CONVERT);        /* TO A PRINTABLE FORM.  @ZA26483*/ 00435000
         TR    RTNCODE(4),CONVERT                                  0219 00436000
*       DO;                         /* WTOP MF(E,WTO01M)             */ 00437000
*         RFY                                                      0221 00438000
*           GPR01P RSTD;            /* RESTRICT REG 1                */ 00439000
*         GPR01P=ADDR(WTO01M);      /* ADDRESS CONTROL PROGRAM LIST  */ 00440000
         LA    GPR01P,WTO01M                                       0222 00441000
*         SVC(35);                  /* ISSUE WTO SVC                 */ 00442000
         SVC   35                                                  0223 00443000
*         RFY                                                      0224 00444000
*           GPR01P UNRSTD;          /* RELEASE REG 1                 */ 00445000
*       END;                        /* WTOP MF(E,WTO01M) TELL      0225 00446000
*                                      OPERATOR THAT SYS1.STGINDEX 0225 00447000
*                                      COULD NOT BE INITIALIZED AND     00448000
*                                      THAT THERE WILL BE NO VIO   0225 00449000
*                                      JOURNALING                    */ 00450000
*       WTORECB=ZERO;               /* ZERO OUT WTORECB              */ 00451000
         SLR   @10,@10                                             0226 00452000
         ST    @10,WTORECB                                         0226 00453000
*       DO;                         /* WTORP MF(E,WTO22M)            */ 00454000
*         RFY                                                      0228 00455000
*           GPR01P RSTD;            /* RESTRICT REG 1                */ 00456000
*         GPR01P=ADDR(WTO22M);      /* ADDRESS CONTROL PROGRAM LIST  */ 00457000
         LA    GPR01P,WTO22M                                       0229 00458000
*         SVC(35);                  /* ISSUE WTOR SVC                */ 00459000
         SVC   35                                                  0230 00460000
*         RFY                                                      0231 00461000
*           GPR01P UNRSTD;          /* RELEASE REG 1                 */ 00462000
*       END;                        /* WTORP MF(E,WTO22M) REQUEST A     00463000
*                                      DECISION FROM OPERATOR ON   0232 00464000
*                                      WHETHER TO CONTINUE WITHOUT 0232 00465000
*                                      VIO JOURNALING                */ 00466000
*       DO;                         /* WAIT ECB(WTORECB)             */ 00467000
*         RESPECIFY                                                0234 00468000
*          (GPR00P,                                                0234 00469000
*           GPR01P) RESTRICTED;                                    0234 00470000
*         GPR00P=1;                 /* LOAD WAIT COUNT               */ 00471000
         LA    GPR00P,1                                            0235 00472000
*         GPR01P=ADDR(WTORECB);     /* ADDRESS OF ECB                */ 00473000
         LA    GPR01P,WTORECB                                      0236 00474000
*         SVC(1);                   /* WAIT SVC                      */ 00475000
         SVC   1                                                   0237 00476000
*         RESPECIFY                                                0238 00477000
*          (GPR00P,                                                0238 00478000
*           GPR01P) UNRESTRICTED;                                  0238 00479000
*       END;                        /* WAIT ECB(WTORECB) WAIT FOR  0239 00480000
*                                      OPERATOR REPLY                */ 00481000
*       ASMSTGXA=ZERO;              /* ZER0 ASMVT POINTER TO ACB FOR    00482000
*                                      SYS1.STGINDEX                 */ 00483000
         SLR   @10,@10                                             0240 00484000
         ST    @10,ASMSTGXA(,ASMVTPTR)                             0240 00485000
*       INTRTCD=RTCD0004;           /* SET INTERNAL RETURN CODE 4    */ 00486000
         MVC   INTRTCD(4),@CF00095                                 0241 00487000
*     END;                                                         0242 00488000
         EJECT                                                          00489000
*                                                                  0243 00490000
*/********************************************************************/ 00491000
*/********************************************************************/ 00492000
*/*   COLD/QUICK START VERSUS WARM START                             */ 00493000
*/********************************************************************/ 00494000
*/********************************************************************/ 00495000
*                                                                  0243 00496000
*   ELSE                                                           0243 00497000
*     DO;                                                          0243 00498000
*                                                                  0243 00499000
         B     @RC00212                                            0243 00500000
@RF00212 DS    0H                                                  0244 00501000
*       /*************************************************************/ 00502000
*       /*                                                           */ 00503000
*       /* INITIALIZE THE 'S' SYMBOL GENERATOR VALUE IN THE ASMVT    */ 00504000
*       /*                                                           */ 00505000
*       /*************************************************************/ 00506000
*                                                                  0244 00507000
*       ASMLSAIL=ZERO;              /* INITIALIZE LOW WORD OF 'S'  0244 00508000
*                                      SYMBOL GENERATOR VALUE TO ZERO*/ 00509000
         SLR   @10,@10                                             0244 00510000
         ST    @10,ASMLSAIL(,ASMVTPTR)                             0244 00511000
*       ASMLSAIH=-ONE;              /* INITIALIZE HIGH WORD OF 'S' 0245 00512000
*                                      SYMBOL GENERATOR VALUE TO   0245 00513000
*                                      MINUS ONE                     */ 00514000
*                                                                  0245 00515000
         MVC   ASMLSAIH(4,ASMVTPTR),@CF01653                       0245 00516000
*       /*************************************************************/ 00517000
*       /*                                                           */ 00518000
*       /* DETERMINE THE TYPE OF IPL. IF A COLD/QUICK START IS       */ 00519000
*       /* REQUESTED, CALL CVIOSTRT TO CLEAR SYS1.STGINDEX. IF A WARM*/ 00520000
*       /* START IS REQUESTED, CALL WARMSTRT TO RESTORE VIO DATA SET */ 00521000
*       /* PAGES. IF WARM START FAILED, THEN PROCEED WITH A COLD     */ 00522000
*       /* START BY CALLING CVIOSTRT TO CLEAR SYS1.STGINDEX.         */ 00523000
*       /*                                                           */ 00524000
*       /*************************************************************/ 00525000
*                                                                  0246 00526000
*       IF TPARWARM=ON THEN                                        0246 00527000
         L     @10,TPARPTR                                         0246 00528000
         TM    TPARWARM(@10),B'10000000'                           0246 00529000
         BNO   @RF00246                                            0246 00530000
*         DO;                                                      0247 00531000
*           RFY                                                    0248 00532000
*            (WARMRTCD) RSTD;                                      0248 00533000
*           CALL WARMSTRT;          /* RESTORE VIO DATA SET PAGES    */ 00534000
         BAL   @14,WARMSTRT                                        0249 00535000
*           EPAWARM=OFF;            /* TURN OFF THE WARM START FLAG     00536000
*                                      IN THE EPATH TO INDICATE THAT    00537000
*                                      ILRTMI00 IS NO LONGER IN    0250 00538000
*                                      WARMSTRT - RRR                */ 00539000
         NI    EPAWARM(EPAPTR),B'10111111'                         0250 00540000
*           IF WARMRTCD^=ZERO THEN                                 0251 00541000
         LTR   WARMRTCD,WARMRTCD                                   0251 00542000
         BZ    @RF00251                                            0251 00543000
*             CALL CVIOSTRT;        /* CLEAR SYS1.STGINDEX           */ 00544000
         BAL   @14,CVIOSTRT                                        0252 00545000
*           RFY                                                    0253 00546000
*            (WARMRTCD) UNRSTD;                                    0253 00547000
@RF00251 DS    0H                                                  0254 00548000
*         END;                                                     0254 00549000
*       ELSE                                                       0255 00550000
*         CALL CVIOSTRT;            /* CLEAR SYS1.STGINDEX           */ 00551000
         B     @RC00246                                            0255 00552000
@RF00246 BAL   @14,CVIOSTRT                                        0255 00553000
*       EPACOLD=OFF;                /* TURN OFF THE COLD START FLAG     00554000
*                                      IN THE EPATH TO INDICATE THAT    00555000
*                                      ILRTMI00 IS NO LONGER IN    0256 00556000
*                                      CVIOSTRT - RRR                */ 00557000
@RC00246 NI    EPACOLD(EPAPTR),B'11011111'                         0256 00558000
*       RFY                                                        0257 00559000
*        (RPLAREA@,                                                0257 00560000
*         IOBUFPTR) UNRSTD;                                        0257 00561000
         EJECT                                                          00562000
*                                                                  0258 00563000
*/********************************************************************/ 00564000
*/********************************************************************/ 00565000
*/*   ENQUEUE ON SYS1.STGINDEX                                       */ 00566000
*/********************************************************************/ 00567000
*/********************************************************************/ 00568000
*                                                                  0258 00569000
*       /*************************************************************/ 00570000
*       /*                                                           */ 00571000
*       /* IF SYS1.STGINDEX IS OPEN, THEN ISSUE AN ENQUEUE ON        */ 00572000
*       /* SYS1.STGINDEX FOR EXCLUSIVE USE. IF ENQUEUE FAILED, TELL  */ 00573000
*       /* THE OPERATOR AND THEN ASK THE OPERATOR WHETHER TO CONTINUE*/ 00574000
*       /* WITHOUT VIO JOURNALING. IF THE OPERATOR DECIDES TO        */ 00575000
*       /* CONTINUE, ZERO OUT THE ASMVT POINTER TO THE ACB FOR       */ 00576000
*       /* SYS1.STGINDEX. IF THE ENQUEUE IS SUCCESSFUL, SET THE ASMVT*/ 00577000
*       /* CONTROL INTERVAL FIELD AND THE ASMVT REQUEST COUNT FIELD. */ 00578000
*       /*                                                           */ 00579000
*       /*************************************************************/ 00580000
*                                                                  0258 00581000
*       IF ASMSTGXA^=ZERO THEN                                     0258 00582000
         L     @10,ASMSTGXA(,ASMVTPTR)                             0258 00583000
         LTR   @10,@10                                             0258 00584000
         BZ    @RF00258                                            0258 00585000
*         DO;                                                      0259 00586000
*           RFY                                                    0260 00587000
*            (ENQRTCD) RSTD;                                       0260 00588000
*           DO;                     /* ENQ MF(E,ENQLST)              */ 00589000
*             RESPECIFY                                            0262 00590000
*              (GPR01P) RESTRICTED;                                0262 00591000
*             GPR01P=ADDR(ENQLST02);/* LOAD LIST ADDRESS             */ 00592000
         LA    GPR01P,ENQLST02                                     0263 00593000
*             SVC(56);              /* ISSUE ENQ SVC                 */ 00594000
         SVC   56                                                  0264 00595000
*             RESPECIFY                                            0265 00596000
*              (GPR01P) UNRESTRICTED;                              0265 00597000
*           END;                    /* ENQ MF(E,ENQLST)              */ 00598000
*           IF ENQRTCD^=ZERO THEN                                  0267 00599000
         LTR   ENQRTCD,ENQRTCD                                     0267 00600000
         BZ    @RF00267                                            0267 00601000
*             DO;                                                  0268 00602000
*               RFY                                                0269 00603000
*                (ENQRTCD) UNRSTD;                                 0269 00604000
*               DO;                 /* WTOP MF(E,WTO20M)             */ 00605000
*                 RFY                                              0271 00606000
*                   GPR01P RSTD;    /* RESTRICT REG 1                */ 00607000
*                 GPR01P=ADDR(WTO20M);/* ADDRESS CONTROL PROGRAM LIST*/ 00608000
         LA    GPR01P,WTO20M                                       0272 00609000
*                 SVC(35);          /* ISSUE WTO SVC                 */ 00610000
         SVC   35                                                  0273 00611000
*                 RFY                                              0274 00612000
*                   GPR01P UNRSTD;  /* RELEASE REG 1                 */ 00613000
*               END;                /* WTOP MF(E,WTO20M) TELL      0275 00614000
*                                      OPERATOR THAT ENQUEUE FAILED     00615000
*                                      FOR SYS1.STGINDEX             */ 00616000
*               WTORECB=ZERO;       /* ZERO OUT WTORECB              */ 00617000
         SLR   @10,@10                                             0276 00618000
         ST    @10,WTORECB                                         0276 00619000
*               DO;                 /* WTORP MF(E,WTO22M)            */ 00620000
*                 RFY                                              0278 00621000
*                   GPR01P RSTD;    /* RESTRICT REG 1                */ 00622000
*                 GPR01P=ADDR(WTO22M);/* ADDRESS CONTROL PROGRAM LIST*/ 00623000
         LA    GPR01P,WTO22M                                       0279 00624000
*                 SVC(35);          /* ISSUE WTOR SVC                */ 00625000
         SVC   35                                                  0280 00626000
*                 RFY                                              0281 00627000
*                   GPR01P UNRSTD;  /* RELEASE REG 1                 */ 00628000
*               END;                /* WTORP MF(E,WTO22M) REQUEST A     00629000
*                                      DECISION FROM OPERATOR ON   0282 00630000
*                                      WHETHER TO CONTINUE WITHOUT 0282 00631000
*                                      VIO JOURNALING                */ 00632000
*               DO;                 /* WAIT ECB(WTORECB)             */ 00633000
*                 RESPECIFY                                        0284 00634000
*                  (GPR00P,                                        0284 00635000
*                   GPR01P) RESTRICTED;                            0284 00636000
*                 GPR00P=1;         /* LOAD WAIT COUNT               */ 00637000
         LA    GPR00P,1                                            0285 00638000
*                 GPR01P=ADDR(WTORECB);/* ADDRESS OF ECB             */ 00639000
         LA    GPR01P,WTORECB                                      0286 00640000
*                 SVC(1);           /* WAIT SVC                      */ 00641000
         SVC   1                                                   0287 00642000
*                 RESPECIFY                                        0288 00643000
*                  (GPR00P,                                        0288 00644000
*                   GPR01P) UNRESTRICTED;                          0288 00645000
*               END;                /* WAIT ECB(WTORECB) WAIT FOR  0289 00646000
*                                      OPERATOR REPLY                */ 00647000
*               ASMSTGXA=ZERO;      /* ZERO ASMVT POINTER TO ACB FOR    00648000
*                                      SYS1.STGINDEX                 */ 00649000
         SLR   @10,@10                                             0290 00650000
         ST    @10,ASMSTGXA(,ASMVTPTR)                             0290 00651000
*               INTRTCD=INTRTCD|RTCD0032;/* ADJUST INTERNAL RETURN 0291 00652000
*                                      CODE                          */ 00653000
         L     @10,INTRTCD                                         0291 00654000
         O     @10,@CF00340                                        0291 00655000
         ST    @10,INTRTCD                                         0291 00656000
*             END;                                                 0292 00657000
*           ELSE                                                   0293 00658000
*             DO;                                                  0293 00659000
         B     @RC00267                                            0293 00660000
@RF00267 DS    0H                                                  0294 00661000
*               ASMCINV=ARDERBA/(TWO*TWOK);/* SET THE NUMBER OF    0294 00662000
*                                      CONTROL INTERVALS IN        0294 00663000
*                                      SYS1.STGINDEX EQUAL TO HALF 0294 00664000
*                                      THE MAXIMUM NUMBER OF RECORDS    00665000
*                                      ALLOWED IN SYS1.STGINDEX    0294 00666000
*                                                            @ZA25814*/ 00667000
         L     @10,AMBLPTR(,ACBAREA@)                              0294 00668000
         L     @10,AMBPTR(,@10)                                    0294 00669000
         L     @10,AMDSBPTR(,@10)                                  0294 00670000
         L     @10,ARDBPTR(,@10)                                   0294 00671000
         L     @10,ARDERBA(,@10)                                   0294 00672000
         SRL   @10,12                                              0294 00673000
         ST    @10,ASMCINV(,ASMVTPTR)                              0294 00674000
*               ASMREQCT=TWO;       /* SET NUMBER OF SIMULTANEOUS  0295 00675000
*                                      REQUESTS THAT ILRGOS00 CAN  0295 00676000
*                                      MAKE TO VSAM TO TWO (I.E., ONE   00677000
*                                      LESS THAN THE STRING NUMBER 0295 00678000
*                                      PARAMETER (STRNO) ON THE    0295 00679000
*                                      PERMANENT OPEN FOR          0295 00680000
*                                      SYS1.STGINDEX DONE BY EITHER     00681000
*                                      WARMSTRT OR CVIOSTRT)         */ 00682000
         MVC   ASMREQCT(4,ASMVTPTR),@CF00092                       0295 00683000
*             END;                                                 0296 00684000
*         END;                                                     0297 00685000
@RC00267 DS    0H                                                  0298 00686000
*     END;                                                         0298 00687000
@RF00258 DS    0H                                                  0299 00688000
         EJECT                                                          00689000
*                                                                  0299 00690000
*/********************************************************************/ 00691000
*/********************************************************************/ 00692000
*/*   BUILD DATA SET NAME LIST                                       */ 00693000
*/********************************************************************/ 00694000
*/********************************************************************/ 00695000
*                                                                  0299 00696000
*   /*****************************************************************/ 00697000
*   /*                                                               */ 00698000
*   /* BUILD A LIST OF ALL PAGE AND SWAP DATA SET NAMES              */ 00699000
*   /*                                                               */ 00700000
*   /*****************************************************************/ 00701000
*                                                                  0299 00702000
*ILRCRTM3:                          /* RECOVERY RETRY POINT -- USED     00703000
*                                      SHOULD CVIOSTRT FAIL - RRR    */ 00704000
*   CALL BUILDSNL;                  /* BUILD DATA SET NAME LIST      */ 00705000
@RC00212 DS    0H                                                  0299 00706000
ILRCRTM3 BAL   @14,BUILDSNL                                        0299 00707000
*   EPABUILD=OFF;                   /* TURN OFF THE BUILD DSN FLAG IN   00708000
*                                      THE EPATH TO INDICATE THAT  0300 00709000
*                                      ILRTMI00 IS NO LONGER IN    0300 00710000
*                                      BUILDSNL - RRR                */ 00711000
         NI    EPABUILD(EPAPTR),B'11101111'                        0300 00712000
*   EPADSLST=ZERO;                  /* ZERO THE EPATH POINTER TO THE    00713000
*                                      DATA SET NAME LIST - RRR      */ 00714000
         SLR   @10,@10                                             0301 00715000
         ST    @10,EPADSLST(,EPAPTR)                               0301 00716000
         EJECT                                                          00717000
*                                                                  0302 00718000
*/********************************************************************/ 00719000
*/********************************************************************/ 00720000
*/*   MISCELLANEOUS DUTIES                                           */ 00721000
*/********************************************************************/ 00722000
*/********************************************************************/ 00723000
*                                                                  0302 00724000
*   /*****************************************************************/ 00725000
*   /*                                                               */ 00726000
*   /* DECREMENT THE ASMVT UNRESERVED SLOT COUNTER BY THE NUMBER OF  */ 00727000
*   /* SLOTS NEEDED TO BACK THE MASTER SCHEDULER'S MEMORY USING      */ 00728000
*   /* COMPARE & SWAP LOGIC                                          */ 00729000
*   /*                                                               */ 00730000
*   /*****************************************************************/ 00731000
*                                                                  0302 00732000
*ILRCRTM4:                          /* RECOVERY RETRY POINT -- USED     00733000
*                                      SHOULD BUILDSNL FAIL - RRR    */ 00734000
*   RFY                                                            0302 00735000
*    (R0,                                                          0302 00736000
*     R1) RSTD;                                                    0302 00737000
ILRCRTM4 DS    0H                                                  0303 00738000
*   R0=ASMBKSLT;                    /* OBTAIN ASMVT UNRESERVED SLOT     00739000
*                                      COUNTER                       */ 00740000
         L     R0,ASMBKSLT(,ASMVTPTR)                              0303 00741000
*STBKSLT1:                                                         0304 00742000
*   R1=R0-MSIBKSLT;                 /* DECREMENT COUNTER BY THE    0304 00743000
*                                      NUMBER OF SLOTS NEEDED TO BACK   00744000
*                                      UP THE MASTER SCHEDULER'S   0304 00745000
*                                      MEMORY                        */ 00746000
STBKSLT1 LR    R1,R0                                               0304 00747000
         SL    R1,@CF00546                                         0304 00748000
*   CS(R0,R1,ASMBKSLT);             /* UPDATE ASMVT UNRESERVED SLOT     00749000
*                                      COUNT                         */ 00750000
         CS    R0,@01,ASMBKSLT(ASMVTPTR)                           0305 00751000
*   BC(NE,STBKSLT1);                /* IF UNSUCCESSFUL, TRY AGAIN    */ 00752000
         BC    7,STBKSLT1                                          0306 00753000
*   RFY                                                            0307 00754000
*    (R0,                                                          0307 00755000
*     R1) UNRSTD;                                                  0307 00756000
*                                                                  0307 00757000
*   /*****************************************************************/ 00758000
*   /*                                                               */ 00759000
*   /* MAKE LOCAL PAGE DATA SETS AVAILABLE FOR SLOT ALLOCATION       */ 00760000
*   /*                                                               */ 00761000
*   /*****************************************************************/ 00762000
*                                                                  0308 00763000
*   ASMNOLCL=OFF;                   /* BY NOW VIO SLOTS HAVE BEEN  0308 00764000
*                                      MARKED UNAVAILABLE, THEREFORE    00765000
*                                      TURN OFF THE NO LOCAL DATA  0308 00766000
*                                      PAGING FLAG -- THUS ALLOWING     00767000
*                                      SLOTS TO BE ALLOCATED TO LOCAL   00768000
*                                      PAGE DATA SETS.               */ 00769000
*                                                                  0308 00770000
         NI    ASMNOLCL(ASMVTPTR),B'11011111'                      0308 00771000
*   /*****************************************************************/ 00772000
*   /*                                                               */ 00773000
*   /* WRITE TO THE OPERATOR THOSE MESSAGES, IF ANY, CONCERNING THE  */ 00774000
*   /* STATUS OF THE PLPA, COMMON, OR DUPLEX PAGE DATA SETS.         */ 00775000
*   /*                                                               */ 00776000
*   /*****************************************************************/ 00777000
*                                                                  0309 00778000
*   CALL ILRMSGSP;                  /* WRITE INITIALIZATION MESSAGES */ 00779000
         L     @15,ASMPMSGS(,ASMVTPTR)                             0309 00780000
         BALR  @14,@15                                             0309 00781000
         EJECT                                                          00782000
*                                                                  0310 00783000
*/********************************************************************/ 00784000
*/********************************************************************/ 00785000
*/*   FREE TPARTBLE                                                  */ 00786000
*/********************************************************************/ 00787000
*/********************************************************************/ 00788000
*                                                                  0310 00789000
*   /*****************************************************************/ 00790000
*   /*                                                               */ 00791000
*   /* RETURN THE STORAGE ASSOCIATED WITH THE TPARTBLE TO SQA        */ 00792000
*   /* (SUBPOOL 245) VIA FREEMAIN.                                   */ 00793000
*   /*                                                               */ 00794000
*   /*****************************************************************/ 00795000
*                                                                  0310 00796000
*   RFY                                                            0310 00797000
*     FRMNRTCD RSTD;                                               0310 00798000
*   EPATPART=ZERO;                  /* ZERO THE EPATH POINTER TO THE    00799000
*                                      TPARTBLE - RRR                */ 00800000
         SLR   @14,@14                                             0311 00801000
         ST    @14,EPATPART(,EPAPTR)                               0311 00802000
*   DO;                             /* FREEMAIN(RC) LV(LENGTH(TPARTBL   00803000
*                                      E))A(TPARTBLE) SP(245)        */ 00804000
*     RESPECIFY                                                    0313 00805000
*      (GPR01F,                                                    0313 00806000
*       GPR15F,                                                    0313 00807000
*       GPR00F) RESTRICTED;                                        0313 00808000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 00809000
         SLR   GPR01F,GPR01F                                       0314 00810000
*     GPR15F=1;                     /* SET TYPE                      */ 00811000
         LA    GPR15F,1                                            0315 00812000
*     GPR00F=LENGTH(TPARTBLE);      /* LENGTH REQUESTED              */ 00813000
         L     GPR00F,@CF01655                                     0316 00814000
*     GPR01F=ADDR(TPARTBLE);        /* SET REGISTER ONE              */ 00815000
         L     GPR01F,TPARPTR                                      0317 00816000
*     GPR15F=GPR15F+((245)*256);    /* SUBPOOL VALUE                 */ 00817000
         AL    GPR15F,@CF01652                                     0318 00818000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 00819000
         SVC   120                                                 0319 00820000
*     RESPECIFY                                                    0320 00821000
*      (GPR01F,                                                    0320 00822000
*       GPR15F,                                                    0320 00823000
*       GPR00F) UNRESTRICTED;                                      0320 00824000
*   END;                            /* FREEMAIN(RC) LV(LENGTH(TPARTBL   00825000
*                                      E))A(TPARTBLE) SP(245) FREE 0321 00826000
*                                      TPARTBLE                      */ 00827000
*   IF FRMNRTCD^=ZERO THEN                                         0322 00828000
         LTR   FRMNRTCD,FRMNRTCD                                   0322 00829000
         BZ    @RF00322                                            0322 00830000
*     INTRTCD=INTRTCD|RTCD0128;     /* ADJUST INTERNAL RETURN CODE   */ 00831000
         L     @14,INTRTCD                                         0323 00832000
         O     @14,@CF01383                                        0323 00833000
         ST    @14,INTRTCD                                         0323 00834000
         EJECT                                                          00835000
*                                                                  0324 00836000
*/********************************************************************/ 00837000
*/********************************************************************/ 00838000
*/*   FREE ACB BUILD AREA                                            */ 00839000
*/********************************************************************/ 00840000
*/********************************************************************/ 00841000
*                                                                  0324 00842000
*   /*****************************************************************/ 00843000
*   /*                                                               */ 00844000
*   /* IF SYS1.STGINDEX WAS NOT OPENED, RETURN THE STORAGE ASSOCIATED*/ 00845000
*   /* WITH THE ACB BUILD AREA TO SQA (SUBPOOL 245) VIA FREEMAIN.    */ 00846000
*   /* SINCE NO VIO JOURNALING IS POSSIBLE, THE ASMVT NO ILRTMRLG    */ 00847000
*   /* FLAG IS TURNED ON.                                            */ 00848000
*   /*                                                               */ 00849000
*   /*****************************************************************/ 00850000
*                                                                  0324 00851000
*   EPATMACB=ZERO;                  /* ZERO THE EPATH POINTER TO THE    00852000
*                                      ACB BUILD AREA - RRR          */ 00853000
@RF00322 SLR   @14,@14                                             0324 00854000
         ST    @14,EPATMACB(,EPAPTR)                               0324 00855000
*   IF ASMSTGXA=ZERO THEN                                          0325 00856000
         C     @14,ASMSTGXA(,ASMVTPTR)                             0325 00857000
         BNE   @RF00325                                            0325 00858000
*     DO;                                                          0326 00859000
*       DO;                         /* FREEMAIN(RC) LV(LENGTH(ACBBARE   00860000
*                                      A))A(ACBBAREA) SP(245)        */ 00861000
*         RESPECIFY                                                0328 00862000
*          (GPR01F,                                                0328 00863000
*           GPR15F,                                                0328 00864000
*           GPR00F) RESTRICTED;                                    0328 00865000
*         GPR01F=0;                 /* REG 1 MUST BE ZERO            */ 00866000
         SLR   GPR01F,GPR01F                                       0329 00867000
*         GPR15F=1;                 /* SET TYPE                      */ 00868000
         LA    GPR15F,1                                            0330 00869000
*         GPR00F=LENGTH(ACBBAREA);  /* LENGTH REQUESTED              */ 00870000
         LA    GPR00F,76                                           0331 00871000
*         GPR01F=ADDR(ACBBAREA);    /* SET REGISTER ONE              */ 00872000
         LR    GPR01F,ACBAREA@                                     0332 00873000
*         GPR15F=GPR15F+((245)*256);/* SUBPOOL VALUE                 */ 00874000
         AL    GPR15F,@CF01652                                     0333 00875000
*         SVC(120);                 /* RC/RU-FORM OF GETMAIN         */ 00876000
         SVC   120                                                 0334 00877000
*         RESPECIFY                                                0335 00878000
*          (GPR01F,                                                0335 00879000
*           GPR15F,                                                0335 00880000
*           GPR00F) UNRESTRICTED;                                  0335 00881000
*       END;                        /* FREEMAIN(RC) LV(LENGTH(ACBBARE   00882000
*                                      A))A(ACBBAREA) SP(245) FREE 0336 00883000
*                                      ACB BUILD AREA                */ 00884000
*       IF FRMNRTCD^=ZERO THEN                                     0337 00885000
         LTR   FRMNRTCD,FRMNRTCD                                   0337 00886000
         BZ    @RF00337                                            0337 00887000
*         INTRTCD=INTRTCD|RTCD0128; /* ADJUST INTERNAL RETURN CODE   */ 00888000
         L     @14,INTRTCD                                         0338 00889000
         O     @14,@CF01383                                        0338 00890000
         ST    @14,INTRTCD                                         0338 00891000
*       ASMNOTMR=ON;                /* TURN ON THE NO TASK MODE    0339 00892000
*                                      RELEASE FLAG IN THE ASMVT SO     00893000
*                                      THAT ITS ECB WILL NOT BE    0339 00894000
*                                      POSTED                        */ 00895000
@RF00337 OI    ASMNOTMR(ASMVTPTR),B'00100000'                      0339 00896000
*     END;                                                         0340 00897000
*   RFY                                                            0341 00898000
*     ACBAREA@ UNRSTD;                                             0341 00899000
@RF00325 DS    0H                                                  0342 00900000
         EJECT                                                          00901000
*                                                                  0342 00902000
*/********************************************************************/ 00903000
*/********************************************************************/ 00904000
*/*   FREE I/O BUFFER AND RPL BUILD AREA                             */ 00905000
*/********************************************************************/ 00906000
*/********************************************************************/ 00907000
*                                                                  0342 00908000
*   /*****************************************************************/ 00909000
*   /*                                                               */ 00910000
*   /* RETURN THE STORAGE USED FOR THE I/O BUFFER AND THE RPL BUILD  */ 00911000
*   /* AREA TO CSA (SUBPOOL 241) VIA FREEMAIN.                       */ 00912000
*   /*                                                               */ 00913000
*   /*****************************************************************/ 00914000
*                                                                  0342 00915000
*   EPATMWKA=ZERO;                  /* ZERO THE EPATH POINTER TO THE    00916000
*                                      GETMAINED AREA CONTAINING THE    00917000
*                                      I/O BUFFER AND RPL BUILD AREA    00918000
*                                      - RRR                         */ 00919000
         SLR   @14,@14                                             0342 00920000
         ST    @14,EPATMWKA(,EPAPTR)                               0342 00921000
*   DO;                             /* FREEMAIN(RC) LV(LENGTH(IOBUFFE   00922000
*                                      R)+LENGTH(RPLBAREA))A(GTMNAREA   00923000
*                                      ) SP(241)                     */ 00924000
*     RESPECIFY                                                    0344 00925000
*      (GPR01F,                                                    0344 00926000
*       GPR15F,                                                    0344 00927000
*       GPR00F) RESTRICTED;                                        0344 00928000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 00929000
         SLR   GPR01F,GPR01F                                       0345 00930000
*     GPR15F=1;                     /* SET TYPE                      */ 00931000
         LA    GPR15F,1                                            0346 00932000
*     GPR00F=LENGTH(IOBUFFER)+LENGTH(RPLBAREA);/* LENGTH REQUESTED   */ 00933000
         LA    GPR00F,2124                                         0347 00934000
*     GPR01F=ADDR(GTMNAREA);        /* SET REGISTER ONE              */ 00935000
         L     GPR01F,GETAREA@                                     0348 00936000
*     GPR15F=GPR15F+((241)*256);    /* SUBPOOL VALUE                 */ 00937000
         AL    GPR15F,@CF01651                                     0349 00938000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 00939000
         SVC   120                                                 0350 00940000
*     RESPECIFY                                                    0351 00941000
*      (GPR01F,                                                    0351 00942000
*       GPR15F,                                                    0351 00943000
*       GPR00F) UNRESTRICTED;                                      0351 00944000
*   END;                            /* FREEMAIN(RC) LV(LENGTH(IOBUFFE   00945000
*                                      R)+LENGTH(RPLBAREA))A(GTMNAREA   00946000
*                                      ) SP(241) RETURN STORAGE      */ 00947000
*   IF FRMNRTCD^=ZERO THEN                                         0353 00948000
         LTR   FRMNRTCD,FRMNRTCD                                   0353 00949000
         BZ    @RF00353                                            0353 00950000
*     INTRTCD=INTRTCD|RTCD0128;     /* ADJUST INTERNAL RETURN CODE   */ 00951000
         L     @14,INTRTCD                                         0354 00952000
         O     @14,@CF01383                                        0354 00953000
         ST    @14,INTRTCD                                         0354 00954000
*   RFY                                                            0355 00955000
*     FRMNRTCD UNRSTD;                                             0355 00956000
@RF00353 DS    0H                                                  0356 00957000
*   EPATMIBA=ZERO;                  /* ZERO THE BASE REGISTER VALUE     00958000
*                                      FOR ILRTMI00 THAT IS IN THE 0356 00959000
*                                      EPATH - RRR                   */ 00960000
         SLR   @10,@10                                             0356 00961000
         ST    @10,EPATMIBA(,EPAPTR)                               0356 00962000
*   EPATMI=OFF;                     /* TURN OFF THE TMI FLAG IN THE     00963000
*                                      EPATH TO INDICATE THAT      0357 00964000
*                                      ILRTMI00 IS NO LONGER       0357 00965000
*                                      PROCESSING - RRR              */ 00966000
         NI    EPATMI(EPAPTR),B'11111011'                          0357 00967000
*   RETURN CODE(INTRTCD);           /* RETURN TO ILRTMRLG            */ 00968000
         L     @15,INTRTCD                                         0358 00969000
         L     @13,4(,@13)                                         0358 00970000
         L     @14,12(,@13)                                        0358 00971000
         LM    @00,@12,20(@13)                                     0358 00972000
         BR    @14                                                 0358 00973000
         EJECT                                                          00974000
*                                                                  0359 00975000
*/********************************************************************/ 00976000
*/*                                                                  */ 00977000
*/*   WARMSTRT:  WARM START PROCESSING OF SYS1.STGINDEX.             */ 00978000
*/*                                                                  */ 00979000
*/*   PROCESS:   GENCB IS ISSUED TO BUILD AN ACB FOR SYS1.STGINDEX.  */ 00980000
*/*              SYS1.STGINDEX IS OPENED FOR UPDATE. A GENCB IS      */ 00981000
*/*              ISSUED TO BUILD AN RPL AND THEN A VERIFY IS ISSUED  */ 00982000
*/*              TO UPDATE THE CATALOG. A MODCB IS ISSUED TO CHANGE  */ 00983000
*/*              THE RPL SO THAT KEYED ACCESS PROCESSING OF          */ 00984000
*/*              SYS1.STGINDEX CAN TAKE PLACE. A GET IS ISSUSED      */ 00985000
*/*              TO READ THE TIME STAMP RECORD (KEY ZERO) FROM       */ 00986000
*/*              SYS1.STGINDEX. IF THE TIME STAMP FROM SYS1.STGINDEX */ 00987000
*/*              AND THE TIME STAMP IN THE TPARTBLE DO NOT MATCH,    */ 00988000
*/*              ASK THE OPERATOR WHETHER IT IS O.K. TO SWITCH TO    */ 00989000
*/*              CVIO PROCESSING. IF THE OPERATOR DECIDES THAT IT    */ 00990000
*/*              IS O.K., THEN FLOW EVENTUALLY CONINUES WITH         */ 00991000
*/*              CVIOSTRT. IF THE TIME STAMPS DO MATCH, THEN A       */ 00992000
*/*              MODCB IS ISSUED TO CHANGE THE RPL SO THAT ADDRESSED */ 00993000
*/*              ACCESS PROCESSING OF SYS1.STGINDEX CAN TAKE PLACE.  */ 00994000
*/*              A LOOP IS STARTED IN WHICH EACH RECORD IS READ IN   */ 00995000
*/*              FROM SYS1.STGINDEX. FOR EACH SAVED ASPCT BASE, THE  */ 00996000
*/*              INTERNAL BACKSLOT COUNTER AND SAVESLOT COUNTER ARE  */ 00997000
*/*              INCREMENTED. FOR EACH ASPCT BASE AND LPME EXTENSION */ 00998000
*/*              UPDTPATS IS CALLED TO UPDATE PAT MAPS FOR EACH      */ 00999000
*/*              SAVED LSID.  IF A READ FROM SYS1.STGINDEX IS NOT    */ 01000000
*/*              SUCCESSFUL OR IF A PAT POINTER CAN NOT BE FOUND FOR */ 01001000
*/*              ONE OF THE LOCAL PART ENTRIES, ASK THE OPERATOR     */ 01002000
*/*              WHETHER IT IS O.K. TO SWITCH TO CVIO PROCESSING.    */ 01003000
*/*              IF THE OPERATOR DECIDES THAT IT IS O.K., THEN       */ 01004000
*/*              BACKOUT IS CALLED TO RESET THE PAT MAPS AND FLOW    */ 01005000
*/*              EVENTUALLY CONTINUES WITH CVIOSTRT. IF ALL READS    */ 01006000
*/*              ARE SUCCESSFUL, THE INTERNAL BACKSLOT COUNTER IS    */ 01007000
*/*              USED TO DECREMENT THE AVAILABLE SLOT COUNT IN THE   */ 01008000
*/*              ASMVT AND THE INTERNAL SAVESLOT COUNTER IS USED TO  */ 01009000
*/*              INCREMENT THE VIO SLOT COUNT IN THE ASMVT.          */ 01010000
*/*              PROCESSING THEN CONTINUES BACK IN THE MAINLINE.     */ 01011000
*/*                                                                  */ 01012000
*/********************************************************************/ 01013000
*                                                                  0359 01014000
*WARMSTRT:                                                         0359 01015000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0359 01016000
WARMSTRT DS    0H                                                  0360 01017000
         EJECT                                                          01018000
*                                                                  0360 01019000
*/********************************************************************/ 01020000
*/********************************************************************/ 01021000
*/*   OPEN SYS1.STGINDEX                                             */ 01022000
*/********************************************************************/ 01023000
*/********************************************************************/ 01024000
*                                                                  0360 01025000
*   RFY                                                            0360 01026000
*    (ACBAREA@,                                                    0360 01027000
*     IOBUFPTR,                                                    0360 01028000
*     RPLAREA@) RSTD;                                              0360 01029000
*   RFY                                                            0361 01030000
*     R14 RSTD;                                                    0361 01031000
*   SAVRET1=R14;                    /* SAVE RETURN ADDRESS           */ 01032000
         ST    R14,SAVRET1                                         0362 01033000
*   RFY                                                            0363 01034000
*     R14 UNRSTD;                                                  0363 01035000
*   EPATMIRT=ADDR(ILRCRTM2);        /* SET CURRENT RETRY ADDRESS IN     01036000
*                                      EPATH - RRR                   */ 01037000
         LA    @10,ILRCRTM2                                        0364 01038000
         ST    @10,EPATMIRT(,EPAPTR)                               0364 01039000
*   EPAWARM=ON;                     /* TURN ON THE WARM START FLAG IN   01040000
*                                      THE EPATH TO INDICATE THAT  0365 01041000
*                                      ILRTMI00 IS IN WARMSTRT - RRR */ 01042000
         OI    EPAWARM(EPAPTR),B'01000000'                         0365 01043000
*   RESETFLG=OFF;                   /* TURN OFF RESET FLAG INDICATING   01044000
*                                      THAT THE LOCAL PAT MAPS NEED     01045000
*                                      NOT BE RESET SHOULD AN ERROR     01046000
*                                      OCCUR                         */ 01047000
*                                                                  0366 01048000
         MVI   RESETFLG,X'00'                                      0366 01049000
*   /*****************************************************************/ 01050000
*   /*                                                               */ 01051000
*   /* BUILD AN ACB FOR SYS1.STGINDEX. THIS ACB WILL BE USED TO OPEN */ 01052000
*   /* SYS1.STGINDEX WITH ADDRESSED ACCESS, CONTROL-INTERVAL ACCESS, */ 01053000
*   /* AND KEYED ACCESS OPTIONS.                                     */ 01054000
*   /*                                                               */ 01055000
*   /*****************************************************************/ 01056000
*                                                                  0367 01057000
*   RFY                                                            0367 01058000
*    (R0,                                                          0367 01059000
*     ACBPTR,                                                      0367 01060000
*     GENRTCD) RSTD;                                               0367 01061000
*   R0=LENGTH(ACBBAREA);                                           0368 01062000
         LA    R0,76                                               0368 01063000
*   GEN REFS(R0,ACBAREA@);                                         0369 01064000
         GENCB BLK=ACB,AM=VSAM,BUFND=4,BUFNI=3,BUFSP=6*2048,          XX01065000
               CATALOG=YES,DDNAME=STGINDEX,LENGTH=(R0),               XX01066000
               MACRF=(ADR,CNV,KEY,NFX,DDN,NDF,DIR,SEQ,NCI,OUT,NIS,    XX01067000
               NRM,NRS,NSR,NUB),STRNO=3,WAREA=(ACBAREA@)                01068000
*   IF GENRTCD^=ZERO THEN                                          0370 01069000
         LTR   GENRTCD,GENRTCD                                     0370 01070000
         BNZ   @RT00370                                            0370 01071000
*     GO TO WARMERR;                /* BRANCH TO COMMON ERROR CODE 0371 01072000
*                                      FOR WARMSTRT                  */ 01073000
*   RFY                                                            0372 01074000
*    (R0,                                                          0372 01075000
*     GENRTCD) UNRSTD;                                             0372 01076000
*   ACBSDS=ON;                      /* TURN ON THE APPROPRIATE FLAG     01077000
*                                      IN THE ACB SO THAT          0373 01078000
*                                      SYS1.STGINDEX IS OPENED AS A     01079000
*                                      SYSTEM DATA SET -- NO KEYWORD    01080000
*                                      PROVIDED FOR IN GENCB         */ 01081000
*                                                                  0373 01082000
         OI    ACBSDS(ACBAREA@),B'00000010'                        0373 01083000
*   /*****************************************************************/ 01084000
*   /*                                                               */ 01085000
*   /* OPEN SYS1.STGINDEX WITH ADDRESSED ACCESS, CONTROL-INTERVAL    */ 01086000
*   /* ACCESS, AND KEYED ACCESS OPTIONS. IF OPEN IS NOT SUCCESSFUL,  */ 01087000
*   /* ISSUE A SHOWCB TO DETERMINE THE TYPE OF ERROR. IF RETRY IS    */ 01088000
*   /* POSSIBLE, ISSUE ANOTHER OPEN FOR SYS1.STGINDEX. IF RETRY IS   */ 01089000
*   /* NOT POSSIBLE, PERFORM COMMON ERROR CODE FOR WARMSTRT AND      */ 01090000
*   /* RETURN TO MAINLINE.                                           */ 01091000
*   /*                                                               */ 01092000
*   /*****************************************************************/ 01093000
*                                                                  0374 01094000
*   RETRYCNT=ZERO;                  /* INITIALIZE RETRY COUNT TO ZERO*/ 01095000
         SLR   RETRYCNT,RETRYCNT                                   0374 01096000
*   RETRYFLG=ON;                    /* SET RETRY FLAG ON             */ 01097000
         LA    RETRYFLG,1                                          0375 01098000
*   DO WHILE(RETRYFLG=ON);                                         0376 01099000
         B     @DE00376                                            0376 01100000
@DL00376 DS    0H                                                  0377 01101000
*     RETRYCNT=RETRYCNT+ONE;        /* INCREMENT RETRY COUNT BY ONE  */ 01102000
         AL    RETRYCNT,@CF00052                                   0377 01103000
*     RETRYFLG=OFF;                 /* FORCE END OF RETRY LOOP       */ 01104000
         SLR   RETRYFLG,RETRYFLG                                   0378 01105000
*     RFY                                                          0379 01106000
*      (OPENRTCD) RSTD;                                            0379 01107000
*     GEN REFS(ACBPTR) SETS(OPENRTCD);                             0380 01108000
*                                                                  0380 01109000
         OPEN  ((ACBPTR))      /* OPEN SYS1.STGINDEX WITH ADDRESSED   XX01110000
                                  ACCESS, CONTROL-INTERVAL ACCESS,    XX01111000
                                  AND KEYED ACCESS OPTIONS          */  01112000
*     /***************************************************************/ 01113000
*     /*                                                             */ 01114000
*     /* IF OPEN WAS UNSUCCESSFUL, ISSUE A SHOWCB TO OBTAIN THE CODE */ 01115000
*     /* RETURNED FROM VSAM. THIS RETURN CODE IS USED TO DETERMINE   */ 01116000
*     /* WHETHER RETRY IS POSSIBLE. IF OPEN WAS SUCCESSFUL, FALL THRU*/ 01117000
*     /* THE RETRY LOOP.                                             */ 01118000
*     /*                                                             */ 01119000
*     /***************************************************************/ 01120000
*                                                                  0381 01121000
*     IF OPENRTCD>RTCD0004 THEN                                    0381 01122000
         LA    @14,4                                               0381 01123000
         CR    OPENRTCD,@14                                        0381 01124000
         BNH   @RF00381                                            0381 01125000
*       DO;                                                        0382 01126000
*         RFY                                                      0383 01127000
*          (OPENRTCD) UNRSTD;                                      0383 01128000
*         RFY                                                      0384 01129000
*          (R0,                                                    0384 01130000
*           R1) RSTD;                                              0384 01131000
*         R0=LENGTH(VSAMRTCD);                                     0385 01132000
         LR    R0,@14                                              0385 01133000
*         R1=ADDR(VSAMRTCD);                                       0386 01134000
         LA    R1,VSAMRTCD                                         0386 01135000
*         GEN REFS(R0,R1,ACBPTR) SETS(VSAMRTCD);                   0387 01136000
         SHOWCB ACB=(ACBPTR),AREA=(R1),LENGTH=(R0),FIELDS=ERROR         01137000
*         RFY                                                      0388 01138000
*          (R0,                                                    0388 01139000
*           R1) UNRSTD;                                            0388 01140000
*                                                                  0388 01141000
*         /***********************************************************/ 01142000
*         /*                                                         */ 01143000
*         /* IF THE MAXIMUM NUMBER OF RETRIES HAS NOT BEEN REACHED OR*/ 01144000
*         /* A RETRYABLE RETURN CODE IS RECEIVED FROM VSAM, TURN     */ 01145000
*         /* RETRY FLAG ON IN ORDER TO RETRY OPEN. IF RETRY IS NOT   */ 01146000
*         /* POSSIBLE, BRANCH TO COMMON ERROR CODE FOR WARMSTRT.     */ 01147000
*         /*                                                         */ 01148000
*         /***********************************************************/ 01149000
*                                                                  0389 01150000
*         IF(RETRYCNT<=RETRYMAX)&(VSAMRTCD=RTCD0136|VSAMRTCD=RTCD0148|  01151000
*             VSAMRTCD=RTCD0176|VSAMRTCD=RTCD0236|VSAMRTCD=RTCD0244)    01152000
*           THEN                                                   0389 01153000
         C     RETRYCNT,@CF00291                                   0389 01154000
         BH    @RF00389                                            0389 01155000
         L     @10,VSAMRTCD                                        0389 01156000
         C     @10,@CF01385                                        0389 01157000
         BE    @RT00389                                            0389 01158000
         C     @10,@CF01387                                        0389 01159000
         BE    @RT00389                                            0389 01160000
         C     @10,@CF01389                                        0389 01161000
         BE    @RT00389                                            0389 01162000
         C     @10,@CF01391                                        0389 01163000
         BE    @RT00389                                            0389 01164000
         C     @10,@CF01393                                        0389 01165000
         BNE   @RF00389                                            0389 01166000
@RT00389 DS    0H                                                  0390 01167000
*           RETRYFLG=ON;            /* FORCE RETRY LOOP              */ 01168000
         LA    RETRYFLG,1                                          0390 01169000
*         ELSE                                                     0391 01170000
*           GO TO WARMERR;          /* BRANCH TO COMMON ERROR CODE 0391 01171000
*                                      FOR WARMSTRT                  */ 01172000
*       END;                                                       0392 01173000
*   END;                            /* END OF RETRY LOOP             */ 01174000
@RF00381 DS    0H                                                  0393 01175000
@DE00376 C     RETRYFLG,@CF00236                                   0393 01176000
         BE    @DL00376                                            0393 01177000
*   ASMSTGXA=ACBPTR;                /* PLACE POINTER TO ACB FOR    0394 01178000
*                                      SYS1.STGINDEX INTO THE ASMVT  */ 01179000
         ST    ACBPTR,ASMSTGXA(,ASMVTPTR)                          0394 01180000
         EJECT                                                          01181000
*                                                                  0395 01182000
*/********************************************************************/ 01183000
*/********************************************************************/ 01184000
*/*   VERIFY SYS1.STGINDEX                                           */ 01185000
*/********************************************************************/ 01186000
*/********************************************************************/ 01187000
*                                                                  0395 01188000
*   /*****************************************************************/ 01189000
*   /*                                                               */ 01190000
*   /* BUILD AN RPL FOR VERIFYING SYS1.STGINDEX.                     */ 01191000
*   /*                                                               */ 01192000
*   /*****************************************************************/ 01193000
*                                                                  0395 01194000
*   RFY                                                            0395 01195000
*    (R0,                                                          0395 01196000
*     R1,                                                          0395 01197000
*     GENRTCD) RSTD;                                               0395 01198000
*   R0=LENGTH(RPLBAREA);                                           0396 01199000
         LA    R0,76                                               0396 01200000
*   R1=ADDR(VSAMKEY);                                              0397 01201000
         LA    R1,VSAMKEY                                          0397 01202000
*   GEN REFS(R0,R1,ACBPTR,IOBUFPTR,RPLAREA@);                      0398 01203000
         GENCB BLK=RPL,ACB=(ACBPTR),AM=VSAM,AREA=(IOBUFPTR),          XX01204000
               AREALEN=2048,ARG=(R1),COPIES=1,LENGTH=(R0),            XX01205000
               OPTCD=(CNV,DIR,ARD,FWD,SYN,NUP,FKS,MVE),               XX01206000
               RECLEN=2041,WAREA=(RPLAREA@)                             01207000
*   IF GENRTCD^=ZERO THEN                                          0399 01208000
         LTR   GENRTCD,GENRTCD                                     0399 01209000
         BNZ   @RT00399                                            0399 01210000
*     GO TO WARMERR;                /* BRANCH TO COMMON ERROR CODE 0400 01211000
*                                      FOR WARMSTRT                  */ 01212000
*   RFY                                                            0401 01213000
*    (R0,                                                          0401 01214000
*     R1,                                                          0401 01215000
*     GENRTCD) UNRSTD;                                             0401 01216000
*                                                                  0401 01217000
*   /*****************************************************************/ 01218000
*   /*                                                               */ 01219000
*   /* UPDATE CATALOG INFORMATION ABOUT SYS1.STGINDEX VIA VERIFY.    */ 01220000
*   /*                                                               */ 01221000
*   /*****************************************************************/ 01222000
*                                                                  0402 01223000
*   RFY                                                            0402 01224000
*    (VERFRTCD) RSTD;                                              0402 01225000
*   GEN REFS(RPLPTR) SETS(VERFRTCD);                               0403 01226000
         VERIFY RPL=(RPLPTR)                                            01227000
*   IF VERFRTCD^=ZERO THEN                                         0404 01228000
         LTR   VERFRTCD,VERFRTCD                                   0404 01229000
         BNZ   @RT00404                                            0404 01230000
*     GO TO WARMERR;                /* BRANCH TO COMMON ERROR CODE 0405 01231000
*                                      FOR WARMSTRT                  */ 01232000
*   RFY                                                            0406 01233000
*    (VERFRTCD) UNRSTD;                                            0406 01234000
         EJECT                                                          01235000
*                                                                  0407 01236000
*/********************************************************************/ 01237000
*/********************************************************************/ 01238000
*/*   READ AND PROCESS TIME STAMP RECORD                             */ 01239000
*/********************************************************************/ 01240000
*/********************************************************************/ 01241000
*                                                                  0407 01242000
*   /*****************************************************************/ 01243000
*   /*                                                               */ 01244000
*   /* MODIFY THE RPL FOR SYS1.STGINDEX SO THAT KEYS ARE USED AS     */ 01245000
*   /* SEARCH ARGUMENTS IN READING SYS1.STGINDEX.                    */ 01246000
*   /*                                                               */ 01247000
*   /*****************************************************************/ 01248000
*                                                                  0407 01249000
*   RFY                                                            0407 01250000
*    (MODRTCD) RSTD;                                               0407 01251000
*   GEN REFS(RPLPTR) SETS(MODRTCD);                                0408 01252000
         MODCB RPL=(RPLPTR),OPTCD=(KEY)                                 01253000
*   IF MODRTCD^=ZERO THEN                                          0409 01254000
         LTR   MODRTCD,MODRTCD                                     0409 01255000
         BNZ   @RT00409                                            0409 01256000
*     GO TO WARMERR;                /* BRANCH TO COMMON ERROR CODE 0410 01257000
*                                      FOR WARMSTRT                  */ 01258000
*   RFY                                                            0411 01259000
*    (MODRTCD) UNRSTD;                                             0411 01260000
*                                                                  0411 01261000
*   /*****************************************************************/ 01262000
*   /*                                                               */ 01263000
*   /* READ IN THE TIME STAMP RECORD (KEY ZERO) FROM SYS1.STGINDEX.  */ 01264000
*   /* IF GET IS NOT SUCCESSFUL, ISSUE A SHOWCB TO DETERMINE THE TYPE*/ 01265000
*   /* OF ERROR. IF RETRY IS POSSIBLE, ISSUE ANOTHER GET. IF RETRY IS*/ 01266000
*   /* NOT POSSIBLE, PERFORM COMMON ERROR CODE FOR WARMSTRT.         */ 01267000
*   /*                                                               */ 01268000
*   /*****************************************************************/ 01269000
*                                                                  0412 01270000
*   VSAMKEY=KEYZERO;                /* SET VSAM KEY TO KEY ZERO      */ 01271000
         MVC   VSAMKEY(12),@CB01358                                0412 01272000
*   RETRYCNT=ZERO;                  /* INITIALIZE RETRY COUNT TO ZERO*/ 01273000
         SLR   RETRYCNT,RETRYCNT                                   0413 01274000
*   RETRYFLG=ON;                    /* SET RETRY FLAG ON             */ 01275000
         LA    RETRYFLG,1                                          0414 01276000
*   DO WHILE(RETRYFLG=ON);                                         0415 01277000
         B     @DE00415                                            0415 01278000
@DL00415 DS    0H                                                  0416 01279000
*     RETRYCNT=RETRYCNT+ONE;        /* INCREMENT RETRY COUNT BY ONE  */ 01280000
         AL    RETRYCNT,@CF00052                                   0416 01281000
*     RETRYFLG=OFF;                 /* FORCE END OF RETRY LOOP       */ 01282000
         SLR   RETRYFLG,RETRYFLG                                   0417 01283000
*     RFY                                                          0418 01284000
*      (GETRTCD) RSTD;                                             0418 01285000
*     GEN REFS(RPLPTR) SETS(GETRTCD);                              0419 01286000
*                                                                  0419 01287000
         GET   RPL=(RPLPTR)      /* READ TIME STAMP RECORD */           01288000
*     /***************************************************************/ 01289000
*     /*                                                             */ 01290000
*     /* IF GET WAS UNSUCCESSFUL BECAUSE OF A LOGICAL ERROR (RETURN  */ 01291000
*     /* CODE 8), THEN ISSUE A SHOWCB TO OBTAIN THE FEEDBACK CODE    */ 01292000
*     /* FROM VSAM TO DETERMINE IF RETRY IS POSSIBLE. IF GET WAS     */ 01293000
*     /* UNSUCCESSFUL BECAUSE OF A PHYSICAL ERROR (RETURN CODE 4) OR */ 01294000
*     /* BECAUSE THE RPL WAS ACTIVE FOR ANOTHER REQUEST (RETURN CODE */ 01295000
*     /* 12), THEN BRANCH TO COMMON ERROR CODE FOR WARMSTRT. IF GET  */ 01296000
*     /* WAS SUCCESSFUL, FALL THRU RETRY LOOP.                       */ 01297000
*     /*                                                             */ 01298000
*     /***************************************************************/ 01299000
*                                                                  0420 01300000
*     IF GETRTCD>=RTCD0004 THEN                                    0420 01301000
         LA    @14,4                                               0420 01302000
         CR    GETRTCD,@14                                         0420 01303000
         BL    @RF00420                                            0420 01304000
*       DO;                                                        0421 01305000
*         IF GETRTCD^=RTCD0008 THEN                                0422 01306000
         C     GETRTCD,@CF00037                                    0422 01307000
         BNE   @RT00422                                            0422 01308000
*           GO TO WARMERR;          /* BRANCH TO COMMON ERROR CODE 0423 01309000
*                                      FOR WARMSTRT                  */ 01310000
*         RFY                                                      0424 01311000
*          (GETRTCD) UNRSTD;                                       0424 01312000
*         RFY                                                      0425 01313000
*          (R0,                                                    0425 01314000
*           R1) RSTD;                                              0425 01315000
*         R0=LENGTH(FDBKCODE);                                     0426 01316000
         LR    R0,@14                                              0426 01317000
*         R1=ADDR(FDBKCODE);                                       0427 01318000
         LA    R1,FDBKCODE                                         0427 01319000
*         GEN REFS(R0,R1,ACBPTR) SETS(FDBKCODE);                   0428 01320000
         SHOWCB RPL=(RPLPTR),AREA=(R1),LENGTH=(R0),FIELDS=FDBK          01321000
*         RFY                                                      0429 01322000
*          (R0,                                                    0429 01323000
*           R1) UNRSTD;                                            0429 01324000
*                                                                  0429 01325000
*         /***********************************************************/ 01326000
*         /*                                                         */ 01327000
*         /* IF THE MAXIMUM NUMBER OF RETRIES HAS NOT BEEN REACHED   */ 01328000
*         /* AND A RETRYABLE RETURN CODE IS RECEIVED FROM VSAM, TURN */ 01329000
*         /* THE RETRY FLAG ON IN ORDER TO RETRY GET. IF RETRY IS NOT*/ 01330000
*         /* POSSIBLE, BRANCH TO COMMON ERROR CODE FOR WARMSTRT.     */ 01331000
*         /*                                                         */ 01332000
*         /***********************************************************/ 01333000
*                                                                  0430 01334000
*         IF(RETRYCNT<=RETRYMAX)&(FDBKCODE=INSUFSTG|FDBKCODE=TOOMANY)   01335000
*           THEN                                                   0430 01336000
         C     RETRYCNT,@CF00291                                   0430 01337000
         BH    @RF00430                                            0430 01338000
         L     @10,FDBKCODE                                        0430 01339000
         C     @10,@CF00585                                        0430 01340000
         BE    @RT00430                                            0430 01341000
         C     @10,@CF00575                                        0430 01342000
         BNE   @RF00430                                            0430 01343000
@RT00430 DS    0H                                                  0431 01344000
*           RETRYFLG=ON;            /* FORCE RETRY LOOP              */ 01345000
         LA    RETRYFLG,1                                          0431 01346000
*         ELSE                                                     0432 01347000
*           GO TO WARMERR;          /* BRANCH TO COMMON CODE FOR   0432 01348000
*                                      WARMSTRT                      */ 01349000
*       END;                                                       0433 01350000
*   END;                            /* END OF RETRY LOOP             */ 01351000
*                                                                  0434 01352000
@RF00420 DS    0H                                                  0434 01353000
@DE00415 C     RETRYFLG,@CF00236                                   0434 01354000
         BE    @DL00415                                            0434 01355000
*   /*****************************************************************/ 01356000
*   /*                                                               */ 01357000
*   /* IF THE TIME STAMP IN THE TPARTBLE DOES NOT MATCH THAT IN THE  */ 01358000
*   /* TIME STAMP RECORD, THEN PERFORM THE COMMON ERROR CODE FOR     */ 01359000
*   /* WARMSTRT. IF THEY DO MATCH, THEN READ IN ALL SAVED ASPCT'S AND*/ 01360000
*   /* UPDATE THE PAT MAPS AS WELL AS THE AVAILABLE SLOT COUNT IN    */ 01361000
*   /* EACH PART ENTRY. THE ASMVT UNRESERVED SLOT COUNTER AND THE    */ 01362000
*   /* ASMVT VIO COUNT ARE ALSO UPDATED.                             */ 01363000
*   /*                                                               */ 01364000
*   /*****************************************************************/ 01365000
*                                                                  0435 01366000
*   IF TPARTIME^=IOBTIME THEN                                      0435 01367000
         L     @10,TPARPTR                                         0435 01368000
         CLC   TPARTIME(8,@10),IOBTIME(IOBUFPTR)                   0435 01369000
         BNE   @RT00435                                            0435 01370000
*     GO TO WARMERR;                /* BRANCH TO COMMON ERROR CODE 0436 01371000
*                                      FOR WARMSTRT                  */ 01372000
         EJECT                                                          01373000
*                                                                  0437 01374000
*/********************************************************************/ 01375000
*/********************************************************************/ 01376000
*/*   PREPARE FOR SEQUENTIAL READ OF SYS1.STGINDEX                   */ 01377000
*/********************************************************************/ 01378000
*/********************************************************************/ 01379000
*                                                                  0437 01380000
*   /*****************************************************************/ 01381000
*   /*                                                               */ 01382000
*   /* MODIFY THE RPL FOR SYS1.STGINDEX SO THAT RBA'S ARE USED AS    */ 01383000
*   /* SEARCH ARGUMENTS IN READING SYS1.STGINDEX.                    */ 01384000
*   /*                                                               */ 01385000
*   /*****************************************************************/ 01386000
*                                                                  0437 01387000
*   RFY                                                            0437 01388000
*    (R1,                                                          0437 01389000
*     MODRTCD) RSTD;                                               0437 01390000
*   R1=ADDR(RBA);                                                  0438 01391000
         LA    R1,RBA                                              0438 01392000
*   GEN REFS(RPLPTR) SETS(MODRTCD);                                0439 01393000
         MODCB RPL=(RPLPTR),ARG=(R1),OPTCD=(ADR)                        01394000
*   RFY                                                            0440 01395000
*    (R1) UNRSTD;                                                  0440 01396000
*   IF MODRTCD^=ZERO THEN                                          0441 01397000
         SLR   @14,@14                                             0441 01398000
         CR    MODRTCD,@14                                         0441 01399000
         BNE   @RT00441                                            0441 01400000
*     GO TO WARMERR;                /* BRANCH TO COMMON ERROR CODE 0442 01401000
*                                      FOR WARMSTRT                  */ 01402000
*   RFY                                                            0443 01403000
*    (MODRTCD) UNRSTD;                                             0443 01404000
*                                                                  0443 01405000
*   /*****************************************************************/ 01406000
*   /*                                                               */ 01407000
*   /* SET SLOTV TO THE ILRSLOTV CONSTANT. IF THE CONSTANT IS ZERO,  */ 01408000
*   /* THEN SET SLOTV TO ONE.                                        */ 01409000
*   /*                                                               */ 01410000
*   /*****************************************************************/ 01411000
*                                                                  0444 01412000
*   SLOTV=ILRSLOTV;                 /* SET SLOTV TO THE VALUE OF   0444 01413000
*                                      ILRSLOTV                      */ 01414000
         L     @10,ASMSLOTV(,ASMVTPTR)                             0444 01415000
         L     @10,ILRSLOTV(,@10)                                  0444 01416000
         ST    @10,SLOTV                                           0444 01417000
*   IF SLOTV=ZERO THEN                                             0445 01418000
         CR    @10,@14                                             0445 01419000
         BNE   @RF00445                                            0445 01420000
*     SLOTV=ONE;                    /* SET SLOTV TO ONE              */ 01421000
*                                                                  0446 01422000
         MVC   SLOTV(4),@CF00052                                   0446 01423000
*   /*****************************************************************/ 01424000
*   /*                                                               */ 01425000
*   /* INITIALIZE BACKLSOT COUNTER AND SAVSLOT COUNTER TO ZERO. TURN */ 01426000
*   /* RESET FLAG ON.                                                */ 01427000
*   /*                                                               */ 01428000
*   /*****************************************************************/ 01429000
*                                                                  0447 01430000
*   BACKSLOT=ZERO;                  /* INITIALIZE BACKSLOT COUNTER TO   01431000
*                                      ZERO                          */ 01432000
@RF00445 SLR   @10,@10                                             0447 01433000
         ST    @10,BACKSLOT                                        0447 01434000
*   SAVESLOT=ZERO;                  /* INITIALIZE SAVESLOT COUNTER TO   01435000
*                                      ZERO                          */ 01436000
         ST    @10,SAVESLOT                                        0448 01437000
*   RESETFLG=ON;                    /* TURN ON RESET FLAG INDICATING    01438000
*                                      THAT ALL LOCAL PAT MAPS NEED     01439000
*                                      TO BE RESET SHOULD AN ERROR 0449 01440000
*                                      OCCUR WHILE READING A SAVED 0449 01441000
*                                      ASPCT FROM SYS1.STGINDEX OR 0449 01442000
*                                      SHOULD A PAT POINTER NOT BE 0449 01443000
*                                      FOUND FOR ONE OF THE LOCAL  0449 01444000
*                                      PART ENTRIES BY UPDTPATS      */ 01445000
         MVI   RESETFLG,X'01'                                      0449 01446000
         EJECT                                                          01447000
*                                                                  0450 01448000
*/********************************************************************/ 01449000
*/********************************************************************/ 01450000
*/*   READ ALL RECORDS OUT ON SYS1.STGINDEX                          */ 01451000
*/********************************************************************/ 01452000
*/********************************************************************/ 01453000
*                                                                  0450 01454000
*   RFY                                                            0450 01455000
*    (ASPCTPTR,                                                    0450 01456000
*     ASPEXPTR) RSTD;                                              0450 01457000
*                                                                  0450 01458000
*   /*****************************************************************/ 01459000
*   /*                                                               */ 01460000
*   /* READ IN EACH RECORD THAT IS OUT ON SYS1.STGINDEX.             */ 01461000
*   /*                                                               */ 01462000
*   /*****************************************************************/ 01463000
*                                                                  0451 01464000
*   MAXRBA=ARDERBA;                 /* OBTAIN THE HIGH ALLOCATED RBA    01465000
*                                      FROM THE ARDB FOR           0451 01466000
*                                      SYS1.STGINDEX                 */ 01467000
         L     @10,AMBLPTR(,ACBAREA@)                              0451 01468000
         L     @10,AMBPTR(,@10)                                    0451 01469000
         L     @10,AMDSBPTR(,@10)                                  0451 01470000
         L     @10,ARDBPTR(,@10)                                   0451 01471000
         L     @10,ARDERBA(,@10)                                   0451 01472000
         ST    @10,MAXRBA                                          0451 01473000
*   DO RBA=TWOK BY TWOK TO MAXRBA;                                 0452 01474000
*                                                                  0452 01475000
         LA    @10,2048                                            0452 01476000
         ST    @10,RBA                                             0452 01477000
         B     @DE00452                                            0452 01478000
@DL00452 DS    0H                                                  0453 01479000
*     /***************************************************************/ 01480000
*     /*                                                             */ 01481000
*     /* READ IN NEXT SEQUENTIAL RECORD FROM SYS1.STGINDEX. IF GET IS*/ 01482000
*     /* NOT SUCCESSFUL, ISSUE A SHOWCB TO DETERMINE THE TYPE OF     */ 01483000
*     /* ERROR. IF RETRY IS POSSIBLE, ISSUE ANOTHER GET. IF RETRY IS */ 01484000
*     /* NOT POSSIBLE, PERFORM COMMON ERROR CODE FOR WARMSTRT.       */ 01485000
*     /*                                                             */ 01486000
*     /***************************************************************/ 01487000
*                                                                  0453 01488000
*     ASPIDENT=ZERO;                /* MAKE SURE THAT THE CONTENTS OF   01489000
*                                      THE I/O BUFFER WILL NOT BE  0453 01490000
*                                      MISTAKEN FOR AN ASPCT BASE OR    01491000
*                                      AN LPME EXTENSION             */ 01492000
         SLR   @10,@10                                             0453 01493000
         ST    @10,ASPIDENT(,ASPCTPTR)                             0453 01494000
*     RETRYCNT=ZERO;                /* INITIALIZE RETRY COUNT TO ZERO*/ 01495000
         SLR   RETRYCNT,RETRYCNT                                   0454 01496000
*     RETRYFLG=ON;                  /* SET RETRY FLAG ON             */ 01497000
         LA    RETRYFLG,1                                          0455 01498000
*     DO WHILE(RETRYFLG=ON);                                       0456 01499000
         B     @DE00456                                            0456 01500000
@DL00456 DS    0H                                                  0457 01501000
*       RETRYCNT=RETRYCNT+ONE;      /* INCREMENT RETRY COUNT BY ONE  */ 01502000
         AL    RETRYCNT,@CF00052                                   0457 01503000
*       RETRYFLG=OFF;               /* FORCE END OF RETRY LOOP       */ 01504000
         SLR   RETRYFLG,RETRYFLG                                   0458 01505000
*       RFY                                                        0459 01506000
*        (GETRTCD) RSTD;                                           0459 01507000
*       GEN REFS(RPLPTR) SETS(GETRTCD);                            0460 01508000
*                                                                  0460 01509000
        GET RPL=(RPLPTR)   /* READ NEXT RECORD FROM SYS1.STGINDEX */    01510000
*       /*************************************************************/ 01511000
*       /*                                                           */ 01512000
*       /* IF GET WAS UNSUCCESSFUL BECAUSE OF A LOGICAL ERROR (RETURN*/ 01513000
*       /* CODE 8), THEN ISSUE A SHOWCB TO OBTAIN THE FEEDBACK CODE  */ 01514000
*       /* FROM VSAM TO DETERMINE IF RETRY IS POSSIBLE. IF GET WAS   */ 01515000
*       /* UNSUCCESSFUL BECAUSE OF A PHSICAL ERROR (RETURN CODE 4) OR*/ 01516000
*       /* BECAUSE THE RPL WAS ACTIVE FOR ANOTHER REQUEST (RETURN    */ 01517000
*       /* CODE 12), THEN BRANCH TO COMMON ERROR CODE FOR WARMSTRT.  */ 01518000
*       /* IF GET WAS SUCCESSFUL, FALL THRU RETRY LOOP.              */ 01519000
*       /*                                                           */ 01520000
*       /*************************************************************/ 01521000
*                                                                  0461 01522000
*       IF GETRTCD>=RTCD0004 THEN                                  0461 01523000
         LA    @14,4                                               0461 01524000
         CR    GETRTCD,@14                                         0461 01525000
         BL    @RF00461                                            0461 01526000
*         DO;                                                      0462 01527000
*           IF GETRTCD^=RTCD0008 THEN                              0463 01528000
         C     GETRTCD,@CF00037                                    0463 01529000
         BNE   @RT00463                                            0463 01530000
*             GO TO WARMERR;        /* BRANCH TO COMMON ERROR CODE 0464 01531000
*                                      FOR WARMSTRT                  */ 01532000
*           RFY                                                    0465 01533000
*            (GETRTCD) UNRSTD;                                     0465 01534000
*           RFY                                                    0466 01535000
*            (R0,                                                  0466 01536000
*             R1) RSTD;                                            0466 01537000
*           R0=LENGTH(FDBKCODE);                                   0467 01538000
         LR    R0,@14                                              0467 01539000
*           R1=ADDR(FDBKCODE);                                     0468 01540000
         LA    R1,FDBKCODE                                         0468 01541000
*           GEN REFS(R0,R1,RPLPTR) SETS(FDBKCODE);                 0469 01542000
         SHOWCB RPL=(RPLPTR),AREA=(R1),LENGTH=(R0),FIELDS=FDBK          01543000
*           RFY                                                    0470 01544000
*            (R0,                                                  0470 01545000
*             R1) UNRSTD;                                          0470 01546000
*                                                                  0470 01547000
*           /*********************************************************/ 01548000
*           /*                                                       */ 01549000
*           /* IF THE END OF DATA RETURN CODE IS RECEIVED FROM VSAM, */ 01550000
*           /* THEN BRANCH TO UPDATE THE UNRESERVED SLOT COUNT AND   */ 01551000
*           /* THE VIO COUNT IN THE ASMVT.                           */ 01552000
*           /*                                                       */ 01553000
*           /*********************************************************/ 01554000
*                                                                  0471 01555000
*           IF FDBKCODE=ENDDATA THEN                               0471 01556000
         L     @10,FDBKCODE                                        0471 01557000
         C     @10,@CF00095                                        0471 01558000
         BE    @RT00471                                            0471 01559000
*             GO TO UPDTCNTS;       /* BRANCH TO UPDATE COUNTERS IN     01560000
*                                      THE ASMVT                     */ 01561000
*                                                                  0472 01562000
*           /*********************************************************/ 01563000
*           /*                                                       */ 01564000
*           /* IF THE RBA DOES NOT GIVE THE ADDRESS OF ANY RECORD IN */ 01565000
*           /* THE DATA SET, THEN LEAVE THE RETRY LOOP AND ATTEMPT TO*/ 01566000
*           /* READ THE NEXT SEQUENTIAL RECORD FROM SYS1.STGINDEX.   */ 01567000
*           /*                                                       */ 01568000
*           /*********************************************************/ 01569000
*                                                                  0473 01570000
*           IF FDBKCODE^=NORECORD THEN                             0473 01571000
         C     @10,@CF00340                                        0473 01572000
         BE    @RF00473                                            0473 01573000
*             DO;                                                  0474 01574000
*                                                                  0474 01575000
*               /*****************************************************/ 01576000
*               /*                                                   */ 01577000
*               /* IF THE MAXIMUM NUMBER OF RETRIES HAS NOT BEEN     */ 01578000
*               /* REACHED AND A RETRYABLE RETURN CODE IS RECEIVED   */ 01579000
*               /* FROM VSAM, TURN THE RETRY FLAG ON IN ORDER TO     */ 01580000
*               /* RETRY GET. IF RETRY IS NOT POSSIBLE, THEN BRANCH  */ 01581000
*               /* TO COMMON ERROR CODE FOR WARMSTRT.                */ 01582000
*               /*                                                   */ 01583000
*               /*****************************************************/ 01584000
*                                                                  0475 01585000
*               IF(RETRYCNT<=RETRYMAX)&(FDBKCODE=INSUFSTG|FDBKCODE=     01586000
*                   TOOMANY) THEN                                  0475 01587000
         C     RETRYCNT,@CF00291                                   0475 01588000
         BH    @RF00475                                            0475 01589000
         C     @10,@CF00585                                        0475 01590000
         BE    @RT00475                                            0475 01591000
         C     @10,@CF00575                                        0475 01592000
         BNE   @RF00475                                            0475 01593000
@RT00475 DS    0H                                                  0476 01594000
*                 RETRYFLG=ON;      /* FORCE RETRY LOOP              */ 01595000
         LA    RETRYFLG,1                                          0476 01596000
*               ELSE                                               0477 01597000
*                 GO TO WARMERR;    /* BRANCH TO COMMON ERROR CODE 0477 01598000
*                                      FOR WARMSTRT                  */ 01599000
*             END;                                                 0478 01600000
*         END;                                                     0479 01601000
@RF00473 DS    0H                                                  0480 01602000
*     END;                          /* END OF RETRY LOOP             */ 01603000
@RF00461 DS    0H                                                  0480 01604000
@DE00456 C     RETRYFLG,@CF00236                                   0480 01605000
         BE    @DL00456                                            0480 01606000
         EJECT                                                          01607000
*                                                                  0481 01608000
*/********************************************************************/ 01609000
*/********************************************************************/ 01610000
*/*   UPDATE COUNTERS, 'S' SYMBOL GENERATOR, AND PAT MAPS            */ 01611000
*/********************************************************************/ 01612000
*/********************************************************************/ 01613000
*                                                                  0481 01614000
*     /***************************************************************/ 01615000
*     /*                                                             */ 01616000
*     /* IF THE RECORD CONTAINS AN ASPCT BASE, THEN UPDATE THE       */ 01617000
*     /* BACKSLOT COUNTER BY THE NUMBER OF SLOTS NEEDED TO BACK UP   */ 01618000
*     /* THIS LOGICAL GROUP (ASPMAXPN/SLOTV), UPDATE THE SAVESLOT    */ 01619000
*     /* COUNTER BY THE SAVE COUNT IN THE ASPCT (ASPSAVCT), UPDATE   */ 01620000
*     /* THE 'S' SYMBOL IN THE ASMVT BY THE 'S' SYMBOL CONTAINED IN  */ 01621000
*     /* THE ASPCT IF THE 'S' SYMBOL IN THE ASPCT IS GREATER THAN    */ 01622000
*     /* THAT IN THE ASMVT AND LASTLY UPDATE THE PAT MAPS AS WELL AS */ 01623000
*     /* DECREMENT THE AVAILABLE SLOT COUNT IN EACH PART ENTRY. IF   */ 01624000
*     /* THE RECORD CONTAINS AN LPME EXTENSION, THEN JUST SIMPLY     */ 01625000
*     /* UPDATE THE PAT MAPS AND DECREMENT THE AVAILABLE SLOT COUNT  */ 01626000
*     /* IN EACH PART ENTRY.                                         */ 01627000
*     /*                                                             */ 01628000
*     /***************************************************************/ 01629000
*                                                                  0481 01630000
*     IF ASPIDENT=ASPCTID|ASPEIDNT=LPMEXTID THEN                   0481 01631000
         CLC   ASPIDENT(4,ASPCTPTR),@CC01345                       0481 01632000
         BE    @RT00481                                            0481 01633000
         CLC   ASPEIDNT(4,ASPEXPTR),@CC01361                       0481 01634000
         BNE   @RF00481                                            0481 01635000
@RT00481 DS    0H                                                  0482 01636000
*       DO;                                                        0482 01637000
*         IF ASPIDENT=ASPCTID THEN                                 0483 01638000
         CLC   ASPIDENT(4,ASPCTPTR),@CC01345                       0483 01639000
         BNE   @RF00483                                            0483 01640000
*           DO;                                                    0484 01641000
*             BACKSLOT=BACKSLOT+(ASPMAXPN/SLOTV);/* UPDATE BACKSLOT     01642000
*                                      COUNTER BY THE NUMBER OF SLOTS   01643000
*                                      NEEDED TO BACK UP THIS LOGICAL   01644000
*                                      GROUP                         */ 01645000
         L     @01,ASPMAXPN(,ASPCTPTR)                             0485 01646000
         SLR   @00,@00                                             0485 01647000
         D     @00,SLOTV                                           0485 01648000
         AL    @01,BACKSLOT                                        0485 01649000
         ST    @01,BACKSLOT                                        0485 01650000
*             SAVESLOT=SAVESLOT+ASPSAVCT;/* UPDATE SAVESLOT COUNTER     01651000
*                                      BY THE SAVE COUNT IN THIS   0486 01652000
*                                      ASPCT                         */ 01653000
*                                                                  0486 01654000
         L     @10,SAVESLOT                                        0486 01655000
         AL    @10,ASPSAVCT(,ASPCTPTR)                             0486 01656000
         ST    @10,SAVESLOT                                        0486 01657000
*             /*******************************************************/ 01658000
*             /*                                                     */ 01659000
*             /* IF THE LOW WORD OF THE 'S' SYMBOL IN THE ASPCT BASE */ 01660000
*             /* IS GREATER THAN THAT IN THE ASMVT, THEN REPLACE THE */ 01661000
*             /* LOW WORD OF THE 'S' SYMBOL IN THE ASMVT WITH THAT IN*/ 01662000
*             /* THE ASPCT BASE. IF THE HIGH WORD OF THE 'S' SUMBOL  */ 01663000
*             /* IN THE ASPCT BASE IS LESS THAN THAT IN THE ASMVT,   */ 01664000
*             /* THEN REPLACE THE HIGH WORD OF THE 'S' SYMBOL IN THE */ 01665000
*             /* ASMVT WITH THAT IN THE ASPCT BASE.                  */ 01666000
*             /*                                                     */ 01667000
*             /*******************************************************/ 01668000
*                                                                  0487 01669000
*             IF ASPSSYM(1:4)>ASMLSAI(1:4) THEN                    0487 01670000
         CLC   ASPSSYM(4,ASPCTPTR),ASMLSAI(ASMVTPTR)               0487 01671000
         BNH   @RF00487                                            0487 01672000
*               ASMLSAI(1:4)=ASPSSYM(1:4);                         0488 01673000
         MVC   ASMLSAI(4,ASMVTPTR),ASPSSYM(ASPCTPTR)               0488 01674000
*             IF ASPSSYM(5:8)<ASMLSAI(5:8) THEN                    0489 01675000
@RF00487 CLC   ASPSSYM+4(4,ASPCTPTR),ASMLSAI+4(ASMVTPTR)           0489 01676000
         BNL   @RF00489                                            0489 01677000
*               ASMLSAI(5:8)=ASPSSYM(5:8);                         0490 01678000
         MVC   ASMLSAI+4(4,ASMVTPTR),ASPSSYM+4(ASPCTPTR)           0490 01679000
*           END;                                                   0491 01680000
*                                                                  0491 01681000
@RF00489 DS    0H                                                  0492 01682000
*         /***********************************************************/ 01683000
*         /*                                                         */ 01684000
*         /* UPDATE THE PAT MAPS AND THE AVAILABLE SLOT COUNT IN EACH*/ 01685000
*         /* PART ENTRY. IF UPDTPATS IS UNSUCCESSFUL, THEN BRANCH TO */ 01686000
*         /* COMMON ERROR CODE FOR WARMSTRT.                         */ 01687000
*         /*                                                         */ 01688000
*         /***********************************************************/ 01689000
*                                                                  0492 01690000
*         RFY                                                      0492 01691000
*          (UPDTRTCD) RSTD;                                        0492 01692000
@RF00483 DS    0H                                                  0493 01693000
*         CALL UPDTPATS;                                           0493 01694000
         BAL   @14,UPDTPATS                                        0493 01695000
*         IF UPDTRTCD^=ZERO THEN                                   0494 01696000
         LTR   UPDTRTCD,UPDTRTCD                                   0494 01697000
         BNZ   @RT00494                                            0494 01698000
*           GO TO WARMERR;          /* BRANCH TO COMMON ERROR CODE 0495 01699000
*                                      FOR WARMSTRT                  */ 01700000
*         RFY                                                      0496 01701000
*          (UPDTRTCD) UNRSTD;                                      0496 01702000
*       END;                                                       0497 01703000
*   END;                            /* ANY MORE RECORDS IN         0498 01704000
*                                      SYS1.STGINDEX ?               */ 01705000
@RF00481 LA    @10,2048                                            0498 01706000
         AL    @10,RBA                                             0498 01707000
         ST    @10,RBA                                             0498 01708000
@DE00452 C     @10,MAXRBA                                          0498 01709000
         BNH   @DL00452                                            0498 01710000
*   RFY                                                            0499 01711000
*    (ASPCTPTR,                                                    0499 01712000
*     ASPEXPTR) UNRSTD;                                            0499 01713000
         EJECT                                                          01714000
*                                                                  0500 01715000
*/********************************************************************/ 01716000
*/********************************************************************/ 01717000
*/*   UPDATE UNRESERVED SLOT COUNT AND VIO COUNT IN ASMVT            */ 01718000
*/********************************************************************/ 01719000
*/********************************************************************/ 01720000
*                                                                  0500 01721000
*   /*****************************************************************/ 01722000
*   /*                                                               */ 01723000
*   /* USE COMPARE AND SWAP LOGIC TO DECREMENT THE ASMVT UNRESERVED  */ 01724000
*   /* SLOT COUNT BY THE BACKSLOT COUNTER AND TO INCREMENT THE ASMVT */ 01725000
*   /* VIO COUNT BY THE SAVESLOT COUNTER.                            */ 01726000
*   /*                                                               */ 01727000
*   /*****************************************************************/ 01728000
*                                                                  0500 01729000
*   RFY                                                            0500 01730000
*    (R0,                                                          0500 01731000
*     R1) RSTD;                                                    0500 01732000
*UPDTCNTS:                                                         0501 01733000
*   R0=ASMBKSLT;                    /* OBTAIN THE ASMVT UNRESERVED 0501 01734000
*                                      SLOT COUNT                    */ 01735000
UPDTCNTS L     R0,ASMBKSLT(,ASMVTPTR)                              0501 01736000
*STBKSLT2:                                                         0502 01737000
*   R1=R0-BACKSLOT;                 /* DECRMENT COUNT                */ 01738000
STBKSLT2 LR    R1,R0                                               0502 01739000
         SL    R1,BACKSLOT                                         0502 01740000
*   CS(R0,R1,ASMBKSLT);             /* UPDATE ASMVT UNRESRVED SLOT 0503 01741000
*                                      COUNT FIELD                   */ 01742000
         CS    R0,@01,ASMBKSLT(ASMVTPTR)                           0503 01743000
*   BC(NE,STBKSLT2);                /* IF UNSUCCESSFUL, TRY AGAIN    */ 01744000
         BC    7,STBKSLT2                                          0504 01745000
*   R0=ASMVSC;                      /* OBTAIN THE ASMVT VIO COUNT    */ 01746000
         L     R0,ASMVSC(,ASMVTPTR)                                0505 01747000
*SETVSC:                                                           0506 01748000
*   R1=R0+SAVESLOT;                 /* INCREMENT COUNT               */ 01749000
SETVSC   LR    R1,R0                                               0506 01750000
         AL    R1,SAVESLOT                                         0506 01751000
*   CS(R0,R1,ASMVSC);               /* UPDATE ASMVT VIO COUNT FIELD  */ 01752000
         CS    R0,@01,ASMVSC(ASMVTPTR)                             0507 01753000
*   BC(NE,SETVSC);                  /* IF UNSUCCESSFUL, TRY AGAIN    */ 01754000
         BC    7,SETVSC                                            0508 01755000
*   RFY                                                            0509 01756000
*    (R14,                                                         0509 01757000
*     RETCODE) RSTD;                                               0509 01758000
*   RETCODE=RTCD0000;               /* SET RETURN CODE TO 0          */ 01759000
         SLR   RETCODE,RETCODE                                     0510 01760000
*   R14=SAVRET1;                    /* RESTORE REG 14 WITH RETURN  0511 01761000
*                                      ADDRESS                       */ 01762000
         L     R14,SAVRET1                                         0511 01763000
*   RETURN;                         /* RETURN TO MAINLINE            */ 01764000
@EL00002 DS    0H                                                  0512 01765000
@EF00002 DS    0H                                                  0512 01766000
@ER00002 BR    @14                                                 0512 01767000
*   RFY                                                            0513 01768000
*    (R0,                                                          0513 01769000
*     R1,                                                          0513 01770000
*     R14,                                                         0513 01771000
*     RETCODE) UNRSTD;                                             0513 01772000
*   RFY                                                            0514 01773000
*     RPLPTR UNRSTD;                                               0514 01774000
         EJECT                                                          01775000
*                                                                  0515 01776000
*/********************************************************************/ 01777000
*/********************************************************************/ 01778000
*/*   COMMON ERROR CODE FOR WARMSTRT                                 */ 01779000
*/********************************************************************/ 01780000
*/********************************************************************/ 01781000
*                                                                  0515 01782000
*ILRCRTM2:                          /* RECOVERY RETRY POINT -- USED     01783000
*                                      SHOULD WARMSTRT FAIL - RRR    */ 01784000
*WARMERR:                                                          0515 01785000
*   DO;                                                            0515 01786000
*                                                                  0515 01787000
ILRCRTM2 DS    0H                                                  0515 01788000
WARMERR  DS    0H                                                  0516 01789000
*     /***************************************************************/ 01790000
*     /*                                                             */ 01791000
*     /* ASK THE OPERATOR IF IT IS O.K. TO SWITCH TO CVIO PROCESSING */ 01792000
*     /* AND WAIT FOR OPERATOR'S RESPONSE.                           */ 01793000
*     /*                                                             */ 01794000
*     /***************************************************************/ 01795000
*                                                                  0516 01796000
*     TPARWARM=OFF;                 /* TURN WARM START FLAG OFF IN 0516 01797000
*                                      TPARTBLE - RRR                */ 01798000
         L     @10,TPARPTR                                         0516 01799000
         NI    TPARWARM(@10),B'01111111'                           0516 01800000
*     ASMWARM=OFF;                  /* TURN WARM START FLAG OFF IN 0517 01801000
*                                      ASMVT                         */ 01802000
         NI    ASMWARM(ASMVTPTR),B'11111011'                       0517 01803000
*     WTORECB=ZERO;                 /* ZERO OUT WTORECB              */ 01804000
         SLR   @10,@10                                             0518 01805000
         ST    @10,WTORECB                                         0518 01806000
*     DO;                           /* WTORP MF(E,WTO03M)            */ 01807000
*       RFY                                                        0520 01808000
*         GPR01P RSTD;              /* RESTRICT REG 1                */ 01809000
*       GPR01P=ADDR(WTO03M);        /* ADDRESS CONTROL PROGRAM LIST  */ 01810000
         LA    GPR01P,WTO03M                                       0521 01811000
*       SVC(35);                    /* ISSUE WTOR SVC                */ 01812000
         SVC   35                                                  0522 01813000
*       RFY                                                        0523 01814000
*         GPR01P UNRSTD;            /* RELEASE REG 1                 */ 01815000
*     END;                          /* WTORP MF(E,WTO03M) REQUEST A     01816000
*                                      DECISION FROM OPERATOR ON   0524 01817000
*                                      WHETHER IT IS O.K. TO SWITCH     01818000
*                                      TO CVIO PROCESSING            */ 01819000
*     DO;                           /* WAIT ECB(WTORECB)             */ 01820000
*       RESPECIFY                                                  0526 01821000
*        (GPR00P,                                                  0526 01822000
*         GPR01P) RESTRICTED;                                      0526 01823000
*       GPR00P=1;                   /* LOAD WAIT COUNT               */ 01824000
         LA    GPR00P,1                                            0527 01825000
*       GPR01P=ADDR(WTORECB);       /* ADDRESS OF ECB                */ 01826000
         LA    GPR01P,WTORECB                                      0528 01827000
*       SVC(1);                     /* WAIT SVC                      */ 01828000
         SVC   1                                                   0529 01829000
*       RESPECIFY                                                  0530 01830000
*        (GPR00P,                                                  0530 01831000
*         GPR01P) UNRESTRICTED;                                    0530 01832000
*     END;                          /* WAIT ECB(WTORECB) WAIT FOR  0531 01833000
*                                      OPERATOR'S REPLY              */ 01834000
*     INTRTCD=INTRTCD|RTCD0008;     /* ADJUST INTERNAL RETURN CODE   */ 01835000
*                                                                  0532 01836000
         L     @10,INTRTCD                                         0532 01837000
         O     @10,@CF00037                                        0532 01838000
         ST    @10,INTRTCD                                         0532 01839000
*     /***************************************************************/ 01840000
*     /*                                                             */ 01841000
*     /* IF SYS1.STGINDEX IS OPEN, ZERO OUT THE ASMVT POINTER TO THE */ 01842000
*     /* ACB FOR SYS1.STGINDEX AND THEN CLOSE SYS1.STGINDEX.         */ 01843000
*     /*                                                             */ 01844000
*     /***************************************************************/ 01845000
*                                                                  0533 01846000
*     IF ASMSTGXA^=ZERO THEN                                       0533 01847000
         SLR   @10,@10                                             0533 01848000
         C     @10,ASMSTGXA(,ASMVTPTR)                             0533 01849000
         BE    @RF00533                                            0533 01850000
*       DO;                                                        0534 01851000
*         ASMSTGXA=ZERO;            /* ZERO ASMVT POINTER TO ACB FOR    01852000
*                                      SYS1.STGINDEX                 */ 01853000
         ST    @10,ASMSTGXA(,ASMVTPTR)                             0535 01854000
*         GEN REFS(ACBPTR)( CLOSE ((ACBPTR)) );/* CLOSE SYS1.STGINDEX*/ 01855000
          CLOSE ((ACBPTR))                                              01856000
*       END;                                                       0537 01857000
*                                                                  0537 01858000
*     /***************************************************************/ 01859000
*     /*                                                             */ 01860000
*     /* IF AN ERROR OCCURRED WHILE READING A RECORD FROM            */ 01861000
*     /* SYS1.STGINDEX OR IF A PAT POINTER COULD NOT BE FOUND FOR ONE*/ 01862000
*     /* OF THE LOCAL PART ENTRIES BY UPDTPATS, THEN CALL BACKOUT TO */ 01863000
*     /* REINITIALIZE ALL THE LOCAL PAT MAPS.                        */ 01864000
*     /*                                                             */ 01865000
*     /***************************************************************/ 01866000
*                                                                  0538 01867000
*     IF RESETFLG=ON THEN                                          0538 01868000
@RF00533 CLI   RESETFLG,1                                          0538 01869000
         BNE   @RF00538                                            0538 01870000
*       CALL BACKOUT;               /* RESET ALL LOCAL PAT MAPS      */ 01871000
         BAL   @14,BACKOUT                                         0539 01872000
         EJECT                                                          01873000
*                                                                  0540 01874000
*/********************************************************************/ 01875000
*/********************************************************************/ 01876000
*/*   REPLACE PLPA COPY OF TPARTBLE WITH STORAGE COPY                */ 01877000
*/********************************************************************/ 01878000
*/********************************************************************/ 01879000
*                                                                  0540 01880000
*     /***************************************************************/ 01881000
*     /*                                                             */ 01882000
*     /* UPDATE THE TIME STAMP IN THE STORAGE COPY OF THE TPARTBLE.  */ 01883000
*     /* IF TPARTBLE COPY ON PLPA DATA SET IS GOOD, WRITE THE STORAGE*/ 01884000
*     /* COPY OF TPARTBLE OUT TO THE PLPA DATA SET. OTHERWISE, RETURN*/ 01885000
*     /* TO MAINLINE.                                                */ 01886000
*     /*                                                             */ 01887000
*     /***************************************************************/ 01888000
*                                                                  0540 01889000
*     RFY                                                          0540 01890000
*      (R1) RSTD;                                                  0540 01891000
@RF00538 DS    0H                                                  0541 01892000
*     GEN REFS(TPARPTR) SETS(R1,TPARTIME);                         0541 01893000
         L     R1,TPARPTR           /* OBTAIN POINTER TO TPARTBLE   */  01894000
         STCK  TPARTIME(R1)         /* STORE TOD CLOCK INTO           XX01895000
                                       TPARTABLE                    */  01896000
*     RFY                                                          0542 01897000
*      (R1) UNRSTD;                                                0542 01898000
*     IF ASMNOTPT=OFF THEN                                         0543 01899000
         TM    ASMNOTPT(ASMVTPTR),B'00010000'                      0543 01900000
         BNZ   @RF00543                                            0543 01901000
*       DO;                                                        0544 01902000
*                                                                  0544 01903000
*         /***********************************************************/ 01904000
*         /*                                                         */ 01905000
*         /* LOAD ILRPREAD. USE ILRPREAD TO WRITE OUT NEW TPARTBLE   */ 01906000
*         /* HEADER TO THE PLPA DATA SET.                            */ 01907000
*         /*                                                         */ 01908000
*         /***********************************************************/ 01909000
*                                                                  0545 01910000
*         RFY                                                      0545 01911000
*          (R0) RSTD;                                              0545 01912000
*         DO;                       /* LOAD EP('ILRPREAD')           */ 01913000
*           RESPECIFY                                              0547 01914000
*            (GPR00P,                                              0547 01915000
*             GPR01P) RESTRICTED;                                  0547 01916000
*           GPR00P=ADDR('ILRPREAD');/* LOAD ENTRY POINT NAME ADDRESS */ 01917000
         LA    GPR00P,@CC01626                                     0548 01918000
*           GPR01P=0;               /* JOBLIB OR LINKLIB DCB         */ 01919000
         SLR   GPR01P,GPR01P                                       0549 01920000
*           SVC(8);                 /* ISSUE LOAD SVC                */ 01921000
         SVC   8                                                   0550 01922000
*           RESPECIFY                                              0551 01923000
*            (GPR00P,                                              0551 01924000
*             GPR01P) UNRESTRICTED;                                0551 01925000
*         END;                      /* LOAD EP('ILRPREAD') LOAD    0552 01926000
*                                      ILRPREAD                      */ 01927000
*                                                                  0552 01928000
*         /***********************************************************/ 01929000
*         /*                                                         */ 01930000
*         /* FILL IN PARAMETER LIST FOR ILRPREAD AND THEN CALL       */ 01931000
*         /* ILRPREAD.                                               */ 01932000
*         /*                                                         */ 01933000
*         /***********************************************************/ 01934000
*                                                                  0553 01935000
*         PARMRDWT=ON;              /* REQUEST A WRITE OPERATION FROM   01936000
*                                      ILRPREAD                      */ 01937000
*         PARMTPAR=OFF;             /* INDICATE THAT THE PART IS IN     01938000
*                                      USE                           */ 01939000
         OI    PARMRDWT,B'10000000'                                0554 01940000
         NI    PARMTPAR,B'10111111'                                0554 01941000
*         PARMTOT=ONE;              /* INDICATE THAT ONLY ONE SLOT IS   01942000
*                                      TO BE WRITTEN                 */ 01943000
         MVI   PARMTOT,X'01'                                       0555 01944000
*         PARMFRST=ZERO;            /* INDICATE THAT THE FIRST SLOT     01945000
*                                      NUMBER IS ZERO (I.E., THE   0556 01946000
*                                      TPARTBLE HEADER ON THE PLPA 0556 01947000
*                                      DATA SET)                     */ 01948000
         SLR   @10,@10                                             0556 01949000
         STH   @10,PARMFRST                                        0556 01950000
*         PARMBUFP=TPARPTR;         /* SET THE BUFFER POINTER TO THE    01951000
*                                      STORAGE COPY OF TPARTBLE      */ 01952000
         L     @10,TPARPTR                                         0557 01953000
         ST    @10,PARMBUFP                                        0557 01954000
*         PARMENTP=ADDR(PARTENTS);  /* SET PART ENTRY POINTER TO PLPA   01955000
*                                      PART ENTRY                    */ 01956000
         L     @01,PARTPTR(,ASMVTPTR)                              0558 01957000
         LA    @10,PARTENTS(,@01)                                  0558 01958000
         ST    @10,PARMENTP                                        0558 01959000
*         RFY                                                      0559 01960000
*          (R1,                                                    0559 01961000
*           PRDRTCD) RSTD;                                         0559 01962000
*         R1=ADDR(PARMLIST);        /* PLACE ADDRESS OF PARAMETER  0560 01963000
*                                      LIST INTO REG 1               */ 01964000
         LA    R1,PARMLIST                                         0560 01965000
*         CALL ILRPREAD;            /* WRITE OUT TPARTBLE HEADER TO     01966000
*                                      PLPA DATA SET                 */ 01967000
         LR    @15,R0                                              0561 01968000
         BALR  @14,@15                                             0561 01969000
*         RFY                                                      0562 01970000
*          (R0,                                                    0562 01971000
*           R1) UNRSTD;                                            0562 01972000
*                                                                  0562 01973000
*         /***********************************************************/ 01974000
*         /*                                                         */ 01975000
*         /* IF THE WRITE IS UNSUCCESSFUL, THEN TURN ON THE TPARTBLE */ 01976000
*         /* NO GOOD FLAG IN THE ASMVT, UPDATE THE TIME STAMP IN THE */ 01977000
*         /* STORAGE COPY OF TPARTBLE AGAIN, DELETE ILPREAD AND      */ 01978000
*         /* RETURN TO MAINLINE. IF THE WRITE IS SUCCESSFUL, THEN    */ 01979000
*         /* DELETE ILRPREAD AND RETURN TO MAINLINE.                 */ 01980000
*         /*                                                         */ 01981000
*         /***********************************************************/ 01982000
*                                                                  0563 01983000
*         IF PRDRTCD^=ZERO THEN                                    0563 01984000
         LTR   PRDRTCD,PRDRTCD                                     0563 01985000
         BZ    @RF00563                                            0563 01986000
*           DO;                                                    0564 01987000
*             RFY                                                  0565 01988000
*              (PRDRTCD) UNRSTD;                                   0565 01989000
*             ASMNOTPT=ON;          /* TURN ON TPARTBLE NO GOOD FLAG    01990000
*                                      IN ASMVT                      */ 01991000
         OI    ASMNOTPT(ASMVTPTR),B'00010000'                      0566 01992000
*             RFY                                                  0567 01993000
*              (R1) RSTD;                                          0567 01994000
*             GEN REFS(TPARPTR) SETS(R1,TPARTIME);                 0568 01995000
         L     R1,TPARPTR           /* OBTAIN POINTER TO TPARTBLE   */  01996000
         STCK  TPARTIME(R1)         /* STORE TOD CLOCK INTO           XX01997000
                                       TPARTBLE                     */  01998000
*             RFY                                                  0569 01999000
*              (R1) UNRSTD;                                        0569 02000000
*           END;                                                   0570 02001000
*         DO;                       /* DELETE EP('ILRPREAD')         */ 02002000
@RF00563 DS    0H                                                  0572 02003000
*           RESPECIFY                                              0572 02004000
*            (GPR00P) RESTRICTED;                                  0572 02005000
*           GPR00P=ADDR('ILRPREAD');/* ->ENTRY NAME                  */ 02006000
         LA    GPR00P,@CC01626                                     0573 02007000
*           SVC(9);                 /* DELETE SVC                    */ 02008000
         SVC   9                                                   0574 02009000
*           RESPECIFY                                              0575 02010000
*            (GPR00P) UNRESTRICTED;                                0575 02011000
*         END;                      /* DELETE EP('ILRPREAD') DELETE     02012000
*                                      ILRPREAD                      */ 02013000
*       END;                                                       0577 02014000
*     RFY                                                          0578 02015000
*      (R14,                                                       0578 02016000
*       RETCODE) RSTD;                                             0578 02017000
@RF00543 DS    0H                                                  0579 02018000
*     RETCODE=RTCD0004;             /* SET RETURN CODE TO 4          */ 02019000
         LA    RETCODE,4                                           0579 02020000
*     R14=SAVRET1;                  /* RESTORE REG 14 WITH RETURN  0580 02021000
*                                      ADDRESS                       */ 02022000
         L     R14,SAVRET1                                         0580 02023000
*     RETURN;                       /* RETURN TO MAINLINE            */ 02024000
         B     @EL00002                                            0581 02025000
*     RFY                                                          0582 02026000
*      (R14,                                                       0582 02027000
*       RETCODE) UNRSTD;                                           0582 02028000
*   END WARMERR;                                                   0583 02029000
*   RFY                                                            0584 02030000
*    (ACBAREA@,                                                    0584 02031000
*     IOBUFPTR,                                                    0584 02032000
*     RPLAREA@) UNRSTD;                                            0584 02033000
*   END WARMSTRT;                                                  0585 02034000
         EJECT                                                          02035000
*                                                                  0586 02036000
*/********************************************************************/ 02037000
*/*                                                                  */ 02038000
*/*   UPDTPATS:  UPDATE THE PAT MAPS FROM THE SAVED LSIDS.           */ 02039000
*/*                                                                  */ 02040000
*/*   PROCESS:   SAVE THE RETURN ADDRESS. GET THE POINTER TO THE     */ 02041000
*/*              FIRST LPME. LOOP THROUGH THE ARRAY OF LPMES UNTIL   */ 02042000
*/*              EITHER THERE ARE NO MORE VALID LPMES OR THE END     */ 02043000
*/*              OF THE ARRAY IS REACHED.  FROM EACH LPME OBTAIN     */ 02044000
*/*              THE LSID. SHIFT OFF THE NN PORTION OF THE LSID      */ 02045000
*/*              FOR INDEXING THE PART.  GET THE POINTER TO THE      */ 02046000
*/*              PROPER PART ENTRY AND TEST TO SEE IF THERE IS A     */ 02047000
*/*              PAT POINTER. IF THERE IS NO PAT POINTER, RETURN     */ 02048000
*/*              TO THE CALLER WITH A RETURN CODE OF 4. IF THERE IS  */ 02049000
*/*              A PAT POINTER, SHIFT OFF THE QQQQ PORTION OF THE    */ 02050000
*/*              LSID AND USE IT TO CALCULATE THE ADDRESS OF THE     */ 02051000
*/*              PROPER PAT MAP. USE ILRBITMM TO TURN ON THE         */ 02052000
*/*              APPROPRIATE BIT IN THAT PAT MAP TO INDICATE THAT    */ 02053000
*/*              THE SLOT IS IN USE. DECREMENT THE SLOT AVAILABLE    */ 02054000
*/*              COUNT IN THE PART ENTRY. ONCE ALL LPMES HAVE BEEN   */ 02055000
*/*              PROCESSED, RETURN TO THE CALLER.                    */ 02056000
*/*                                                                  */ 02057000
*/********************************************************************/ 02058000
*                                                                  0586 02059000
*UPDTPATS:                                                         0586 02060000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0586 02061000
UPDTPATS DS    0H                                                  0587 02062000
         EJECT                                                          02063000
*                                                                  0587 02064000
*/********************************************************************/ 02065000
*/********************************************************************/ 02066000
*/*   OBTAIN PAT POINTER                                             */ 02067000
*/********************************************************************/ 02068000
*/********************************************************************/ 02069000
*                                                                  0587 02070000
*   RFY                                                            0587 02071000
*    (ACBAREA@,                                                    0587 02072000
*     ACBPTR,                                                      0587 02073000
*     ASPCTPTR,                                                    0587 02074000
*     ASPEXPTR,                                                    0587 02075000
*     IOBUFPTR,                                                    0587 02076000
*     RPLAREA@,                                                    0587 02077000
*     RPLPTR) RSTD;                                                0587 02078000
*   RFY                                                            0588 02079000
*    (R14) RSTD;                                                   0588 02080000
*   SAVRET2=R14;                    /* SAVE RETURN ADDRESS           */ 02081000
         ST    R14,SAVRET2                                         0589 02082000
*   RFY                                                            0590 02083000
*    (R14) UNRSTD;                                                 0590 02084000
*   LPMEPTR=ADDR(ASPLPMES);         /* INITIALIZE LPME POINTER TO  0591 02085000
*                                      FIRST LPME                    */ 02086000
*                                                                  0591 02087000
         LA    @10,ASPLPMES(,ASPCTPTR)                             0591 02088000
         ST    @10,LPMEPTR                                         0591 02089000
*   /*****************************************************************/ 02090000
*   /*                                                               */ 02091000
*   /* FOR EACH SAVED LSID (I.E., FOR EACH NONZERO LPME): (1)        */ 02092000
*   /* CALCULATE THE PART ENTRY POINTER FROM THE PART NUMBER PORTION */ 02093000
*   /* OF THE LSID, (2) OBTAIN THE PAT POINTER FROM THE PART ENTRY,  */ 02094000
*   /* (3) IF THE PAT POINTER EXISTS, THEN UPDATE THE PROPER PAT MAP */ 02095000
*   /* AND DECREMENT THE AVAILABLE SLOT COUNT OF THE PART ENTRY.     */ 02096000
*   /*                                                               */ 02097000
*   /*****************************************************************/ 02098000
*                                                                  0592 02099000
*   DO LPMEINDX=ONE TO ASPNLPME;                                   0592 02100000
         LA    @10,1                                               0592 02101000
         ST    @10,LPMEINDX                                        0592 02102000
@DL00592 DS    0H                                                  0593 02103000
*     IF ASPLPME^=ZERO THEN                                        0593 02104000
         SLR   @10,@10                                             0593 02105000
         L     @02,LPMEPTR                                         0593 02106000
         CL    @10,ASPLPME(,@02)                                   0593 02107000
         BE    @RF00593                                            0593 02108000
*       DO;                                                        0594 02109000
*                                                                  0594 02110000
*         /***********************************************************/ 02111000
*         /*                                                         */ 02112000
*         /* CALCULATE THE PART ENTRY POINTER FROM THE PART NUMBER   */ 02113000
*         /* PORTION OF THE LSID                                     */ 02114000
*         /*                                                         */ 02115000
*         /***********************************************************/ 02116000
*                                                                  0595 02117000
*         RFY                                                      0595 02118000
*          (R14,                                                   0595 02119000
*           R15,                                                   0595 02120000
*           PARTNUM,                                               0595 02121000
*           RSLOTNUM) RSTD;                                        0595 02122000
*         R14=ASPVLSID;             /* OBTAIN THE LSID               */ 02123000
         L     R14,ASPVLSID-1(,@02)                                0596 02124000
         LA    R14,0(,R14)                                         0596 02125000
*         SRDL(R14,TWOBYTES);       /* ISOLATE THE PART NUMBER (NN)     02126000
*                                      PORTION OF THE LSID           */ 02127000
         SRDL  R14,16                                              0597 02128000
*         SRL(R15,TWOBYTES);        /* ADJUST THE RELATIVE SLOT    0598 02129000
*                                      NUMBER (QQQQ) PORTION OF THE     02130000
*                                      LSID                          */ 02131000
         SRL   R15,16                                              0598 02132000
*         RFY                                                      0599 02133000
*          (R14,                                                   0599 02134000
*           R15) UNRSTD;                                           0599 02135000
*         PAREPTR=ADDR(PARTENTS)+(PARTNUM*LENGTH(PARTENT));/* OBTAIN    02136000
*                                      PART ENTRY POINTER FOR THIS 0600 02137000
*                                      LSID                          */ 02138000
         L     @02,PARTPTR(,ASMVTPTR)                              0600 02139000
         LA    @02,PARTENTS(,@02)                                  0600 02140000
         LR    @09,PARTNUM                                         0600 02141000
         SLA   @09,6                                               0600 02142000
         ALR   @02,@09                                             0600 02143000
         ST    @02,PAREPTR                                         0600 02144000
*         RFY                                                      0601 02145000
*           PARTNUM UNRSTD;                                        0601 02146000
*                                                                  0601 02147000
*         /***********************************************************/ 02148000
*         /*                                                         */ 02149000
*         /* IF A PAT POINTER DOES NOT EXIST IN THE PART ENTRY,      */ 02150000
*         /* RETURN TO CALLER WITH A RETURN CODE OF FOUR.            */ 02151000
*         /*                                                         */ 02152000
*         /***********************************************************/ 02153000
*                                                                  0602 02154000
*         IF PAREPATP=ZERO THEN                                    0602 02155000
         C     @10,PAREPATP(,@02)                                  0602 02156000
         BNE   @RF00602                                            0602 02157000
*           DO;                                                    0603 02158000
*             RFY                                                  0604 02159000
*              (R14,                                               0604 02160000
*               RETCODE) RSTD;                                     0604 02161000
*             RETCODE=RTCD0004;     /* SET RETURN CODE TO 4          */ 02162000
         LA    RETCODE,4                                           0605 02163000
*             R14=SAVRET2;          /* RESTORE REG 14 WITH RETURN  0606 02164000
*                                      ADDRESS                       */ 02165000
         L     R14,SAVRET2                                         0606 02166000
*             RETURN;               /* RETURN TO CALLER              */ 02167000
@EL00003 DS    0H                                                  0607 02168000
@EF00003 DS    0H                                                  0607 02169000
@ER00003 BR    @14                                                 0607 02170000
*             RFY                                                  0608 02171000
*              (R14,                                               0608 02172000
*               RETCODE) UNRSTD;                                   0608 02173000
*           END;                                                   0609 02174000
*         PATPTR=PAREPATP;          /* OBTAIN POINTER TO PAT         */ 02175000
@RF00602 L     @14,PAREPTR                                         0610 02176000
         L     PATPTR,PAREPATP(,@14)                               0610 02177000
         EJECT                                                          02178000
*                                                                  0611 02179000
*/********************************************************************/ 02180000
*/********************************************************************/ 02181000
*/*   UPDATE PAT MAP                                                 */ 02182000
*/********************************************************************/ 02183000
*/********************************************************************/ 02184000
*                                                                  0611 02185000
*         /***********************************************************/ 02186000
*         /*                                                         */ 02187000
*         /* OBTAIN THE CYLINDER NUMBER, THE ADDRESS OF THE          */ 02188000
*         /* APPRORPRIATE CYLINDER MAP, AND THE BIT INDEX INTO THAT  */ 02189000
*         /* CYLINDER MAP. IF NECESSARY, ADJUST THE BIT INDEX AND THE*/ 02190000
*         /* CYLINDER MAP ADDRESS FOR A TWO WORD CYLINDER MAP.       */ 02191000
*         /*                                                         */ 02192000
*         /***********************************************************/ 02193000
*                                                                  0611 02194000
*         RFY                                                      0611 02195000
*          (BITINDEX,                                              0611 02196000
*           CYLNUM,                                                0611 02197000
*           CYLSIZE,                                               0611 02198000
*           REMAIN) RSTD;                                          0611 02199000
*         CYLSIZE=PATCYLSZ;         /* OBTAIN NUMBER OF SLOTS IN A 0612 02200000
*                                      CYLINDER                      */ 02201000
         LH    CYLSIZE,PATCYLSZ(,PATPTR)                           0612 02202000
*         GEN REFS(RSLOTNUM,CYLSIZE) SETS(BITINDEX,CYLNUM,REMAIN); 0613 02203000
         SLR   REMAIN,REMAIN      /* SET UP FOR DIVIDE              */  02204000
         DR    RSLOTNUM-1,CYLSIZE /* DIVIDE THE RELATIVE SLOT NUMBER    02205000
*                                    BY THE NUMBER OF SLOTS IN A        02206000
*                                    CYLINDER IN ORDER TO OBTAIN THE    02207000
*                                    CYLINDER NUMBER (QUOTIENT) AND     02208000
*                                    THE BIT INDEX (REMAINDER)      */  02209000
         LR    BITINDEX,REMAIN    /* OBTAIN THE BIT INDEX           */  02210000
*         RFY                                                      0614 02211000
*          (REMAIN,                                                0614 02212000
*           CYLSIZE,                                               0614 02213000
*           RSLOTNUM) UNRSTD;                                      0614 02214000
*         PATCYLA=ADDR(PATCYLS(CYLNUM*PATCYLMW+1));/* CALCULATE THE     02215000
*                                      ADDRESS OF THE APPROPRIATE  0615 02216000
*                                      CYLINDER MAP                  */ 02217000
         LR    @14,CYLNUM                                          0615 02218000
         MH    @14,PATCYLMW(,PATPTR)                               0615 02219000
         SLA   @14,2                                               0615 02220000
         LA    @14,PATCYLS(@14,PATPTR)                             0615 02221000
         ST    @14,PATCYLA                                         0615 02222000
*         RFY                                                      0616 02223000
*           CYLNUM UNRSTD;                                         0616 02224000
*         IF BITINDEX>=WORDSIZE THEN                               0617 02225000
         LA    @10,32                                              0617 02226000
         CR    BITINDEX,@10                                        0617 02227000
         BL    @RF00617                                            0617 02228000
*           DO;                                                    0618 02229000
*             BITINDEX=BITINDEX-WORDSIZE;/* DECREMENT BIT INDEX BY 32*/ 02230000
         SLR   BITINDEX,@10                                        0619 02231000
*             PATCYLA=PATCYLA+FOURBYTE;/* ADJUST CYLINDER MAP ADDRESS   02232000
*                                      BY FOUR BYTES                 */ 02233000
         AL    @14,@CF00095                                        0620 02234000
         ST    @14,PATCYLA                                         0620 02235000
*           END;                                                   0621 02236000
*                                                                  0621 02237000
*         /***********************************************************/ 02238000
*         /*                                                         */ 02239000
*         /* TURN ON THE APPROPRIATE BIT IN THE PAT MAP INDICATING   */ 02240000
*         /* THAT THE SLOT IS IN USE. DECREMENT THE AVAILABLE SLOT   */ 02241000
*         /* COUNT IN THE PART ENTRY.                                */ 02242000
*         /*                                                         */ 02243000
*         /***********************************************************/ 02244000
*                                                                  0622 02245000
*/*  ILRBITMM INVOCATION                                           0622 02246000
*      BITMAP(PATCYLA,ONEWORD)BIT(BITINDEX)SET(ON,MP)                */ 02247000
*                                                                  0622 02248000
*         DCL                                                      0622 02249000
*           BITMMCB1 BIT(32) CONSTANT('80000000'X);                0622 02250000
@RF00617 DS    0H                                                  0623 02251000
*         DCL                                                      0623 02252000
*           BITMMWRD FIXED(31) BDY(WORD) BASED(R1);                0623 02253000
*         DCL                                                      0624 02254000
*           BITMSK31 FIXED(8) CONSTANT(31);                        0624 02255000
*         DCL                                                      0625 02256000
*           BITMMC32 FIXED(8) CONSTANT(32);                        0625 02257000
*         DO;                                                      0626 02258000
*           RFY                                                    0627 02259000
*            (R0,                                                  0627 02260000
*             R1,                                                  0627 02261000
*             R2,                                                  0627 02262000
*             R14,                                                 0627 02263000
*             R15) RSTD;            /* RESTRICT WORK REGS    @Z40WPWG*/ 02264000
*           R15=BITINDEX;           /* PUT BIT# IN WRK REG           */ 02265000
         LR    R15,BITINDEX                                        0628 02266000
*           R1=PATCYLA;             /* BITMAP ADDR TO REG1           */ 02267000
         L     R1,PATCYLA                                          0629 02268000
*           R14=BITMMCB1;           /* BUILD MASK                    */ 02269000
         L     R14,@CF00650                                        0630 02270000
*           GEN(SRL   R14,0(R15));                                 0631 02271000
         SRL   R14,0(R15)                                               02272000
*           R0=BITMMWRD;            /* MAP WRD TO REG                */ 02273000
         L     R0,BITMMWRD(,R1)                                    0632 02274000
*           DO WHILE((R0&R14)=0);   /* LOOP UNTIL BIT SET            */ 02275000
         B     @DE00633                                            0633 02276000
@DL00633 DS    0H                                                  0634 02277000
*             R15=R0|R14;           /* TURN BIT ON                   */ 02278000
         LR    R15,R0                                              0634 02279000
         OR    R15,R14                                             0634 02280000
*             CS(R0,R15,BITMMWRD);  /* TRY TO SET BIT IN STG         */ 02281000
         CS    R0,@15,BITMMWRD(R1)                                 0635 02282000
*             BC(8,BITMMX48);       /* BRANCH ON CS SUCCESS          */ 02283000
         BC    8,BITMMX48                                          0636 02284000
*           END;                    /* END LOOP TO SET BIT           */ 02285000
@DE00633 LR    @10,R0                                              0637 02286000
         NR    @10,R14                                             0637 02287000
         LTR   @10,@10                                             0637 02288000
         BZ    @DL00633                                            0637 02289000
*BITMMX48:                                                         0638 02290000
*           RFY                                                    0638 02291000
*            (R0,                                                  0638 02292000
*             R1,                                                  0638 02293000
*             R2,                                                  0638 02294000
*             R14,                                                 0638 02295000
*             R15) UNRSTD;          /* RELEASE WRK REGS      @Z40WPWG*/ 02296000
BITMMX48 DS    0H                                                  0639 02297000
*         END;                      /* END OF ILRBITMM PROCESSING    */ 02298000
*         RFY                                                      0640 02299000
*           BITINDEX UNRSTD;                                       0640 02300000
*         PARESLTA=PARESLTA-ONE;    /* DECREMENT THE SLOT AVAILABLE     02301000
*                                      FOR ALLOCATION COUNT IN THE 0641 02302000
*                                      PART ENTRY                    */ 02303000
         L     @10,PAREPTR                                         0641 02304000
         L     @02,PARESLTA(,@10)                                  0641 02305000
         BCTR  @02,0                                               0641 02306000
         ST    @02,PARESLTA(,@10)                                  0641 02307000
*       END;                        /* END OF PROCESSING A NONZERO 0642 02308000
*                                      LPME                          */ 02309000
*     LPMEPTR=LPMEPTR+LENGTH(ASPLPME);/* SET LPME POINTER TO NEXT  0643 02310000
*                                      LPME                          */ 02311000
@RF00593 LA    @10,4                                               0643 02312000
         AL    @10,LPMEPTR                                         0643 02313000
         ST    @10,LPMEPTR                                         0643 02314000
*   END;                            /* MORE LPMES ?                  */ 02315000
         LA    @10,1                                               0644 02316000
         AL    @10,LPMEINDX                                        0644 02317000
         ST    @10,LPMEINDX                                        0644 02318000
         C     @10,@CF00546                                        0644 02319000
         BNH   @DL00592                                            0644 02320000
*   RFY                                                            0645 02321000
*    (R14,                                                         0645 02322000
*     RETCODE) RSTD;                                               0645 02323000
*   RETCODE=RTCD0000;               /* SET RETURN CODE TO 0          */ 02324000
         SLR   RETCODE,RETCODE                                     0646 02325000
*   R14=SAVRET2;                    /* RESTORE REG 14 WITH RETURN  0647 02326000
*                                      ADDRESS                       */ 02327000
         L     R14,SAVRET2                                         0647 02328000
*   RETURN;                         /* RETURN TO CALLER              */ 02329000
         B     @EL00003                                            0648 02330000
*   RFY                                                            0649 02331000
*    (R14,                                                         0649 02332000
*     RETCODE) UNRSTD;                                             0649 02333000
*   RFY                                                            0650 02334000
*    (ACBAREA@,                                                    0650 02335000
*     ACBPTR,                                                      0650 02336000
*     ASPCTPTR,                                                    0650 02337000
*     ASPEXPTR,                                                    0650 02338000
*     IOBUFPTR,                                                    0650 02339000
*     RPLAREA@,                                                    0650 02340000
*     RPLPTR) UNRSTD;                                              0650 02341000
*   END UPDTPATS;                                                  0651 02342000
         EJECT                                                          02343000
*                                                                  0652 02344000
*/********************************************************************/ 02345000
*/*                                                                  */ 02346000
*/*   BACKOUT:   REINITIALIZE THE LOCAL PAT MAPS.                    */ 02347000
*/*                                                                  */ 02348000
*/*   PROCESS:   SAVE THE RETURN ADDRESS.  GET THE POINTER TO THE    */ 02349000
*/*              FIRST LOCAL PART ENTRY.  LOOP THROUGH THE LOCAL     */ 02350000
*/*              PART ENTRIES UPDATING THE SLOT AVAILABLE COUNT AND  */ 02351000
*/*              COPYING THE PAT MAP MASK FROM THE PCT TO EACH PAT   */ 02352000
*/*              MAP IN THE PAT.  ONCE ALL PART ENTRIES HAVE BEEN    */ 02353000
*/*              PROCESSED, RETURN TO THE CALLER.                    */ 02354000
*/*                                                                  */ 02355000
*/********************************************************************/ 02356000
*                                                                  0652 02357000
*BACKOUT:                                                          0652 02358000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0652 02359000
BACKOUT  DS    0H                                                  0653 02360000
         EJECT                                                          02361000
*                                                                  0653 02362000
*/********************************************************************/ 02363000
*/********************************************************************/ 02364000
*/*   RESET PAT MAPS                                                 */ 02365000
*/********************************************************************/ 02366000
*/********************************************************************/ 02367000
*                                                                  0653 02368000
*   RFY                                                            0653 02369000
*    (ACBAREA@,                                                    0653 02370000
*     IOBUFPTR,                                                    0653 02371000
*     RPLAREA@) RSTD;                                              0653 02372000
*   RFY                                                            0654 02373000
*    (R14) RSTD;                                                   0654 02374000
*   SAVRET2=R14;                    /* SAVE RETURN ADDRESS           */ 02375000
         ST    R14,SAVRET2                                         0655 02376000
*   RFY                                                            0656 02377000
*    (R14) UNRSTD;                                                 0656 02378000
*   PAREPTR=ADDR(PARTENTS(PARTLOCN+ONE));/* INITIALIZE PART ENTRY  0657 02379000
*                                      POINTER TO FIRST LOCAL PART 0657 02380000
*                                      ENTRY (I.E. SKIP OVER THE PART   02381000
*                                      ENTRY FOR THE PLPA DATA SET,     02382000
*                                      THE COMMON DATA SET AND THE 0657 02383000
*                                      DUPLEX DATA SET)              */ 02384000
*                                                                  0657 02385000
         L     @10,PARTPTR(,ASMVTPTR)                              0657 02386000
         LA    @10,PARTENTS+192(,@10)                              0657 02387000
         ST    @10,PAREPTR                                         0657 02388000
*   /*****************************************************************/ 02389000
*   /*                                                               */ 02390000
*   /* FOR EACH LOCAL PAGE DATA SET (I.E., FOR EACH LOCAL PART       */ 02391000
*   /* ENTRY): (1) RESET SLOT AVAILABLE COUNT, (2) OBTAIN THE POINTER*/ 02392000
*   /* TO THE PAT AND TO THE PCT FOR THAT PAGE DATA SET, AND (3)     */ 02393000
*   /* RESET ALL THE CYLINDER MAPS IN THE PAT TO THE EIGHT BYTE MASK */ 02394000
*   /* CONTAINED IN THE PCT.                                         */ 02395000
*   /*                                                               */ 02396000
*   /*****************************************************************/ 02397000
*                                                                  0658 02398000
*   DO LOCALCNT=PARTLOCN+ONE BY ONE TO PARTEUSE;                   0658 02399000
         LA    LOCALCNT,4                                          0658 02400000
         B     @DE00658                                            0658 02401000
@DL00658 DS    0H                                                  0659 02402000
*     PARESLTA=PARESZSL;            /* RESET THE SLOT AVAILABLE FOR     02403000
*                                      ALLOCATION COUNT IN THE PART     02404000
*                                      ENTRY                         */ 02405000
         L     @15,PAREPTR                                         0659 02406000
         L     @14,PARESZSL(,@15)                                  0659 02407000
         ST    @14,PARESLTA(,@15)                                  0659 02408000
*     PATPTR=PAREPATP;              /* OBTAIN POINTER TO PAT         */ 02409000
         L     PATPTR,PAREPATP(,@15)                               0660 02410000
*     PCTPTR=PAREPCTP;              /* OBTAIN POINTER TO PCT         */ 02411000
         L     PCTPTR,PAREPCTP(,@15)                               0661 02412000
*     ENDPAT=PATPTR+LENGTH(PATHDR)+(PATCYLNO*(FOURBYTE*PATCYLMW));/*    02413000
*                                      CALCULATE END OF PAT          */ 02414000
*                                                                  0662 02415000
         LA    ENDPAT,16                                           0662 02416000
         ALR   ENDPAT,PATPTR                                       0662 02417000
         LH    @15,PATCYLMW(,PATPTR)                               0662 02418000
         SLA   @15,2                                               0662 02419000
         MH    @15,PATCYLNO(,PATPTR)                               0662 02420000
         ALR   ENDPAT,@15                                          0662 02421000
*     /***************************************************************/ 02422000
*     /*                                                             */ 02423000
*     /* RESET EACH CYLINDER MAP IN THE PAT TO THE EIGHT BYTE MASK   */ 02424000
*     /* CONTAINED IN THE PCT                                        */ 02425000
*     /*                                                             */ 02426000
*     /***************************************************************/ 02427000
*                                                                  0663 02428000
*     RFY                                                          0663 02429000
*       PATCYLMP BASED(PATCYLA);                                   0663 02430000
*     DO PATCYLA=ADDR(PATCYLS(1)) BY LENGTH(PATCYLMP) TO ENDPAT;   0664 02431000
         LA    @15,PATCYLS(,PATPTR)                                0664 02432000
         ST    @15,PATCYLA                                         0664 02433000
         B     @DE00664                                            0664 02434000
@DL00664 DS    0H                                                  0665 02435000
*       PATCYLMP=PCTDMASK;          /* COPY IN 8 BYTE MASK FOR THE 0665 02436000
*                                      DEVICE ON WHICH THE PAGE DATA    02437000
*                                      SET RESIDES                   */ 02438000
         MVC   PATCYLMP(8,@15),PCTDMASK(PCTPTR)                    0665 02439000
*     END;                          /* MORE CYLINDER MAPS ?          */ 02440000
         AL    @15,@CF00037                                        0666 02441000
         ST    @15,PATCYLA                                         0666 02442000
@DE00664 CR    @15,ENDPAT                                          0666 02443000
         BNH   @DL00664                                            0666 02444000
*     PAREPTR=PAREPTR+LENGTH(PARTENT);/* SET PART ENTRY POINTER TO 0667 02445000
*                                      NEXT LOCAL PART ENTRY         */ 02446000
         LA    @10,64                                              0667 02447000
         AL    @10,PAREPTR                                         0667 02448000
         ST    @10,PAREPTR                                         0667 02449000
*   END;                            /* MORE PART ENTRIES ?           */ 02450000
         AL    LOCALCNT,@CF00052                                   0668 02451000
@DE00658 L     @10,PARTPTR(,ASMVTPTR)                              0668 02452000
         C     LOCALCNT,PARTEUSE(,@10)                             0668 02453000
         BNH   @DL00658                                            0668 02454000
*   RFY                                                            0669 02455000
*    (R14) RSTD;                                                   0669 02456000
*   R14=SAVRET2;                    /* RESTORE REG 14 WITH RETURN  0670 02457000
*                                      ADDRESS                       */ 02458000
         L     R14,SAVRET2                                         0670 02459000
*   RETURN;                         /* RETURN TO CALLER              */ 02460000
@EL00004 DS    0H                                                  0671 02461000
@EF00004 DS    0H                                                  0671 02462000
@ER00004 BR    @14                                                 0671 02463000
*   RFY                                                            0672 02464000
*    (R14) UNRSTD;                                                 0672 02465000
*   RFY                                                            0673 02466000
*    (ACBAREA@,                                                    0673 02467000
*     IOBUFPTR,                                                    0673 02468000
*     RPLAREA@) UNRSTD;                                            0673 02469000
*   END BACKOUT;                                                   0674 02470000
         EJECT                                                          02471000
*                                                                  0675 02472000
*/********************************************************************/ 02473000
*/*                                                                  */ 02474000
*/*   CVIOSTRT:  COLD/QUICK START PROCESSING OF SYS1.STGINDEX.       */ 02475000
*/*                                                                  */ 02476000
*/*   PROCESS:   A GENCB IS ISSUED TO BUILD AN ACB FOR SYS1.STGINDEX.*/ 02477000
*/*              AN OPEN WITH THE REUSE OPTION IS ISSUED TO OPEN     */ 02478000
*/*              AND REALLOCATE SYS1.STGINDEX.  ONCE SYS1.STGINDEX   */ 02479000
*/*              IS OPENED, THE TIME STAMP IN THE TPARTBLE IS COPIED */ 02480000
*/*              TO THE I/O BUFFER AND THE I/O BUFFER IS THEN        */ 02481000
*/*              WRITTEN TO KEY ZERO OF SYS1.STGINDEX. ONCE THE      */ 02482000
*/*              RECORD HAS BEEN WRITTEN, SYS1.STGINDEX IS CLOSED    */ 02483000
*/*              AND THEN REOPENED WITH THE UPDATE OPTION.           */ 02484000
*/*              PROCESSING THEN CONTINUES BACK IN THE MAINLINE.     */ 02485000
*/*                                                                  */ 02486000
*/********************************************************************/ 02487000
*                                                                  0675 02488000
*CVIOSTRT:                                                         0675 02489000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0675 02490000
CVIOSTRT DS    0H                                                  0676 02491000
         EJECT                                                          02492000
*                                                                  0676 02493000
*/********************************************************************/ 02494000
*/********************************************************************/ 02495000
*/*   OPEN SYS1.STGINDEX WITH REUSE OPTION                           */ 02496000
*/********************************************************************/ 02497000
*/********************************************************************/ 02498000
*                                                                  0676 02499000
*   RFY                                                            0676 02500000
*    (ACBAREA@,                                                    0676 02501000
*     IOBUFPTR,                                                    0676 02502000
*     RPLAREA@) RSTD;                                              0676 02503000
*   RFY                                                            0677 02504000
*     R14 RSTD;                                                    0677 02505000
*   SAVRET1=R14;                    /* SAVE RETURN ADDRESS           */ 02506000
         ST    R14,SAVRET1                                         0678 02507000
*   RFY                                                            0679 02508000
*     R14 UNRSTD;                                                  0679 02509000
*   EPATMIRT=ADDR(ILRCRTM3);        /* SET CURRENT RETRY ADDRESS IN     02510000
*                                      EPATH - RRR                   */ 02511000
         LA    @10,ILRCRTM3                                        0680 02512000
         ST    @10,EPATMIRT(,EPAPTR)                               0680 02513000
*   EPACOLD=ON;                     /* TURN ON THE COLD START FLAG IN   02514000
*                                      THE EPATH TO INDICATE THAT  0681 02515000
*                                      ILRTMI00 IS IN CVIOSTRT - RRR */ 02516000
*                                                                  0681 02517000
         OI    EPACOLD(EPAPTR),B'00100000'                         0681 02518000
*   /*****************************************************************/ 02519000
*   /*                                                               */ 02520000
*   /* BUILD AN ACB FOR SYS1.STGINDEX. THIS ACB WILL BE USED TO OPEN */ 02521000
*   /* SYS1.STGINDEX WITH REUSE OPTION                               */ 02522000
*   /*                                                               */ 02523000
*   /*****************************************************************/ 02524000
*                                                                  0682 02525000
*   RFY                                                            0682 02526000
*    (R0,                                                          0682 02527000
*     ACBPTR,                                                      0682 02528000
*     GENRTCD) RSTD;                                               0682 02529000
*   R0=LENGTH(ACBBAREA);                                           0683 02530000
         LA    R0,76                                               0683 02531000
*   GEN REFS(R0,ACBAREA@);                                         0684 02532000
         GENCB BLK=ACB,AM=VSAM,BUFND=2,BUFNI=1,BUFSP=6*2048,          XX02533000
               CATALOG=YES,DDNAME=STGINDEX,LENGTH=(R0),               XX02534000
               MACRF=(KEY,NFX,DDN,NDF,DIR,SEQ,NCI,OUT,NIS,NRM,RST,    XX02535000
               NSR,NUB),STRNO=1,WAREA=(ACBAREA@)                        02536000
*   IF GENRTCD^=ZERO THEN                                          0685 02537000
         LTR   GENRTCD,GENRTCD                                     0685 02538000
         BNZ   @RT00685                                            0685 02539000
*     GO TO CVIOERR;                /* BRANCH TO COMMON ERROR CODE 0686 02540000
*                                      FOR CVIOSTRT                  */ 02541000
*   RFY                                                            0687 02542000
*    (R0,                                                          0687 02543000
*     GENRTCD) UNRSTD;                                             0687 02544000
*   ACBSDS=ON;                      /* TURN ON THE APPROPRIATE FLAG     02545000
*                                      IN THE ACB SO THAT          0688 02546000
*                                      SYS1.STGINDEX IS OPENED AS A     02547000
*                                      SYSTEM DATA SET -- NO KEYWORD    02548000
*                                      PROVIDED FOR IN GENCB         */ 02549000
*                                                                  0688 02550000
         OI    ACBSDS(ACBAREA@),B'00000010'                        0688 02551000
*   /*****************************************************************/ 02552000
*   /*                                                               */ 02553000
*   /* OPEN SYS1.STGINDEX WITH REUSE OPTION. IF OPEN IS NOT          */ 02554000
*   /* SUCCESSFUL, ISSUE A SHOWCB TO DETERMINE THE TYPE OF ERROR. IF */ 02555000
*   /* RETRY IS POSSIBLE, ISSUE ANOTHER OPEN FOR SYS1.STGINDEX. IF   */ 02556000
*   /* RETRY IS NOT POSSIBLE, PERFORM COMMON ERROR CODE FOR CVIOSTRT */ 02557000
*   /* AND RETURN TO MAINLINE.                                       */ 02558000
*   /*                                                               */ 02559000
*   /*****************************************************************/ 02560000
*                                                                  0689 02561000
*   RETRYCNT=ZERO;                  /* INITIALIZE RETRY COUNT TO ZERO*/ 02562000
         SLR   RETRYCNT,RETRYCNT                                   0689 02563000
*   RETRYFLG=ON;                    /* SET RETRY FLAG ON             */ 02564000
         LA    RETRYFLG,1                                          0690 02565000
*   DO WHILE(RETRYFLG=ON);                                         0691 02566000
         B     @DE00691                                            0691 02567000
@DL00691 DS    0H                                                  0692 02568000
*     RETRYCNT=RETRYCNT+ONE;        /* INCREMENT RETRY COUNT BY ONE  */ 02569000
         AL    RETRYCNT,@CF00052                                   0692 02570000
*     RETRYFLG=OFF;                 /* FORCE END OF RETRY LOOP       */ 02571000
         SLR   RETRYFLG,RETRYFLG                                   0693 02572000
*     RFY                                                          0694 02573000
*      (OPENRTCD) RSTD;                                            0694 02574000
*     GEN REFS(ACBPTR) SETS(OPENRTCD);                             0695 02575000
*                                                                  0695 02576000
         OPEN  ((ACBPTR))      /* OPEN SYS1.STGINDEX WITH REUSE       XX02577000
                                  OPTION                            */  02578000
*     /***************************************************************/ 02579000
*     /*                                                             */ 02580000
*     /* IF OPEN WAS UNSUCCESSFUL, ISSUE A SHOWCB TO OBTAIN THE CODE */ 02581000
*     /* RETURNED FROM VSAM. THIS RETURN CODE IS USED TO DETERMINE   */ 02582000
*     /* WHETHER RETRY IS POSSIBLE. IF OPEN WAS SUCCESSFUL, FALL THRU*/ 02583000
*     /* THE RETRY LOOP.                                             */ 02584000
*     /*                                                             */ 02585000
*     /***************************************************************/ 02586000
*                                                                  0696 02587000
*     IF OPENRTCD>RTCD0004 THEN                                    0696 02588000
         LA    @14,4                                               0696 02589000
         CR    OPENRTCD,@14                                        0696 02590000
         BNH   @RF00696                                            0696 02591000
*       DO;                                                        0697 02592000
*         RFY                                                      0698 02593000
*          (OPENRTCD) UNRSTD;                                      0698 02594000
*         RFY                                                      0699 02595000
*          (R0,                                                    0699 02596000
*           R1) RSTD;                                              0699 02597000
*         R0=LENGTH(VSAMRTCD);                                     0700 02598000
         LR    R0,@14                                              0700 02599000
*         R1=ADDR(VSAMRTCD);                                       0701 02600000
         LA    R1,VSAMRTCD                                         0701 02601000
*         GEN REFS(R0,R1,ACBPTR) SETS(VSAMRTCD);                   0702 02602000
         SHOWCB ACB=(ACBPTR),AREA=(R1),LENGTH=(R0),FIELDS=ERROR         02603000
*         RFY                                                      0703 02604000
*          (R0,                                                    0703 02605000
*           R1) UNRSTD;                                            0703 02606000
*                                                                  0703 02607000
*         /***********************************************************/ 02608000
*         /*                                                         */ 02609000
*         /* IF THE MAXIMUM NUMBER OF RETRIES HAS NOT BEEN REACHED   */ 02610000
*         /* AND A RETRYABLE RETURN CODE IS RECEIVED FROM VSAM, TURN */ 02611000
*         /* THE RETRY FLAG ON IN ORDER TO RETRY OPEN. IF RETRY IS   */ 02612000
*         /* NOT POSSIBLE, BRANCH TO COMMON ERROR CODE FOR CVIOSTRT. */ 02613000
*         /*                                                         */ 02614000
*         /***********************************************************/ 02615000
*                                                                  0704 02616000
*         IF(RETRYCNT<=RETRYMAX)&(VSAMRTCD=RTCD0136|VSAMRTCD=RTCD0148|  02617000
*             VSAMRTCD=RTCD0176|VSAMRTCD=RTCD0236|VSAMRTCD=RTCD0244)    02618000
*           THEN                                                   0704 02619000
         C     RETRYCNT,@CF00291                                   0704 02620000
         BH    @RF00704                                            0704 02621000
         L     @10,VSAMRTCD                                        0704 02622000
         C     @10,@CF01385                                        0704 02623000
         BE    @RT00704                                            0704 02624000
         C     @10,@CF01387                                        0704 02625000
         BE    @RT00704                                            0704 02626000
         C     @10,@CF01389                                        0704 02627000
         BE    @RT00704                                            0704 02628000
         C     @10,@CF01391                                        0704 02629000
         BE    @RT00704                                            0704 02630000
         C     @10,@CF01393                                        0704 02631000
         BNE   @RF00704                                            0704 02632000
@RT00704 DS    0H                                                  0705 02633000
*           RETRYFLG=ON;            /* FORCE RETRY LOOP              */ 02634000
         LA    RETRYFLG,1                                          0705 02635000
*         ELSE                                                     0706 02636000
*           GO TO CVIOERR;          /* BRANCH TO COMMON ERROR CODE 0706 02637000
*                                      FOR CVIOSTRT                  */ 02638000
*       END;                                                       0707 02639000
*   END;                            /* END OF RETRY LOOP             */ 02640000
@RF00696 DS    0H                                                  0708 02641000
@DE00691 C     RETRYFLG,@CF00236                                   0708 02642000
         BE    @DL00691                                            0708 02643000
*   ASMSTGXA=ACBPTR;                /* PLACE POINTER TO ACB INTO   0709 02644000
*                                      ASMVT                         */ 02645000
         ST    ACBPTR,ASMSTGXA(,ASMVTPTR)                          0709 02646000
         EJECT                                                          02647000
*                                                                  0710 02648000
*/********************************************************************/ 02649000
*/********************************************************************/ 02650000
*/*   WRITE UPDATED TIME STAMP RECORD OUT TO SYS1.STGINDEX           */ 02651000
*/********************************************************************/ 02652000
*/********************************************************************/ 02653000
*                                                                  0710 02654000
*   /*****************************************************************/ 02655000
*   /*                                                               */ 02656000
*   /* PREPARE I/O BUFFER AS THE TIME STAMP RECORD.                  */ 02657000
*   /*                                                               */ 02658000
*   /*****************************************************************/ 02659000
*                                                                  0710 02660000
*   IOBKEY=KEYZERO;                 /* SET RECORD KEY IN BUFFER TO 0710 02661000
*                                      ZERO                          */ 02662000
         MVC   IOBKEY(12,IOBUFPTR),@CB01358                        0710 02663000
*   IOBTIME=TPARTIME;               /* COPY TIME STAMP FROM TPARTBLE    02664000
*                                      TO BUFFER                     */ 02665000
*                                                                  0711 02666000
         L     @10,TPARPTR                                         0711 02667000
         MVC   IOBTIME(8,IOBUFPTR),TPARTIME(@10)                   0711 02668000
*   /*****************************************************************/ 02669000
*   /*                                                               */ 02670000
*   /* BUILD AN RPL FOR WRITING THE TIME STAMP RECORD OUT TO         */ 02671000
*   /* SYS1.STGINDEX.                                                */ 02672000
*   /*                                                               */ 02673000
*   /*****************************************************************/ 02674000
*                                                                  0712 02675000
*   RFY                                                            0712 02676000
*    (R0,                                                          0712 02677000
*     R1,                                                          0712 02678000
*     GENRTCD,                                                     0712 02679000
*     RPLPTR) RSTD;                                                0712 02680000
*   R0=LENGTH(RPLBAREA);                                           0713 02681000
         LA    R0,76                                               0713 02682000
*   R1=ADDR(VSAMKEY);                                              0714 02683000
         LA    R1,VSAMKEY                                          0714 02684000
*   GEN REFS(R0,R1,ACBPTR,IOBUFPTR,RPLAREA@);                      0715 02685000
         GENCB BLK=RPL,ACB=(ACBPTR),AM=VSAM,AREA=(IOBUFPTR),          XX02686000
               AREALEN=2048,ARG=(R1),COPIES=1,LENGTH=(R0),            XX02687000
               OPTCD=(KEY,SEQ,ARD,FWD,SYN,NUP,FKS,MVE),               XX02688000
               RECLEN=2041,WAREA=(RPLAREA@)                             02689000
*   IF GENRTCD^=ZERO THEN                                          0716 02690000
         LTR   GENRTCD,GENRTCD                                     0716 02691000
         BNZ   @RT00716                                            0716 02692000
*     GO TO CVIOERR;                /* BRANCH TO COMMON ERROR CODE 0717 02693000
*                                      FOR CVIOSTRT                  */ 02694000
*   RFY                                                            0718 02695000
*    (R0,                                                          0718 02696000
*     R1,                                                          0718 02697000
*     GENRTCD) UNRSTD;                                             0718 02698000
*                                                                  0718 02699000
*   /*****************************************************************/ 02700000
*   /*                                                               */ 02701000
*   /* WRITE THE TIME STAMP RECORD (KEY ZERO) OUT TO SYS1.STGINDEX.  */ 02702000
*   /* IF PUT IS NOT SUCCESSFUL, ISSUE A SHOWCB TO DETERMINE THE TYPE*/ 02703000
*   /* OF ERROR. IF RETRY IS POSSIBLE, ISSUE ANOTHER PUT. IF RETRY IS*/ 02704000
*   /* NOT POSSIBLE, PERFORM COMMON ERROR CODE FOR CVIOSTRT AND      */ 02705000
*   /* RETURN TO MAINLINE                                            */ 02706000
*   /*                                                               */ 02707000
*   /*****************************************************************/ 02708000
*                                                                  0719 02709000
*   VSAMKEY=KEYZERO;                /* SET VSAM KEY TO KEY ZERO      */ 02710000
         MVC   VSAMKEY(12),@CB01358                                0719 02711000
*   RETRYCNT=ZERO;                  /* INITIALIZE RETRY COUNT TO ZERO*/ 02712000
         SLR   RETRYCNT,RETRYCNT                                   0720 02713000
*   RETRYFLG=ON;                    /* SET RETRY FLAG ON             */ 02714000
         LA    RETRYFLG,1                                          0721 02715000
*   DO WHILE(RETRYFLG=ON);                                         0722 02716000
         B     @DE00722                                            0722 02717000
@DL00722 DS    0H                                                  0723 02718000
*     RETRYCNT=RETRYCNT+ONE;        /* INCREMENT RETRY COUNT BY ONE  */ 02719000
         AL    RETRYCNT,@CF00052                                   0723 02720000
*     RETRYFLG=OFF;                 /* FORCE END OF RETRY LOOP       */ 02721000
         SLR   RETRYFLG,RETRYFLG                                   0724 02722000
*     RFY                                                          0725 02723000
*      (PUTRTCD) RSTD;                                             0725 02724000
*     GEN REFS(RPLPTR) SETS(PUTRTCD);                              0726 02725000
*                                                                  0726 02726000
         PUT RPL=(RPLPTR)      /* WRITE I/O BUFFER OUT TO RECORD      XX02727000
                                  ZERO                              */  02728000
*     /***************************************************************/ 02729000
*     /*                                                             */ 02730000
*     /* IF PUT WAS UNSUCCESSFUL BECAUSE OF A LOGICAL ERROR (RETURN  */ 02731000
*     /* CODE 8), THEN ISSUE A SHOWCB TO OBTAIN THE FEEDBACK CODE    */ 02732000
*     /* FROM VSAM TO DETERMINE IF RETRY IS POSSIBLE. IF PUT WAS     */ 02733000
*     /* UNSUCCESSFUL BECAUSE OF A PHYSICAL ERROR (RETURN CODE 4) OR */ 02734000
*     /* BECAUSE THE RPL WAS ACTIVE FOR ANOTHER REQUEST (RETURN CODE */ 02735000
*     /* 12), THEN BRANCH TO COMMON ERROR CODE FOR CVIOSTRT. IF PUT  */ 02736000
*     /* WAS SUCCESSFUL, FALL THRU THE RETRY LOOP.                   */ 02737000
*     /*                                                             */ 02738000
*     /***************************************************************/ 02739000
*                                                                  0727 02740000
*     IF PUTRTCD>=RTCD0004 THEN                                    0727 02741000
         LA    @14,4                                               0727 02742000
         CR    PUTRTCD,@14                                         0727 02743000
         BL    @RF00727                                            0727 02744000
*       DO;                                                        0728 02745000
*         IF PUTRTCD^=RTCD0008 THEN                                0729 02746000
         C     PUTRTCD,@CF00037                                    0729 02747000
         BNE   @RT00729                                            0729 02748000
*           GO TO CVIOERR;          /* BRANCH TO COMMON ERROR CODE 0730 02749000
*                                      FOR CVIOSTRT                  */ 02750000
*         RFY                                                      0731 02751000
*          (PUTRTCD) UNRSTD;                                       0731 02752000
*         RFY                                                      0732 02753000
*          (R0,                                                    0732 02754000
*           R1) RSTD;                                              0732 02755000
*         R0=LENGTH(FDBKCODE);                                     0733 02756000
         LR    R0,@14                                              0733 02757000
*         R1=ADDR(FDBKCODE);                                       0734 02758000
         LA    R1,FDBKCODE                                         0734 02759000
*         GEN REFS(R0,R1,RPLPTR) SETS(FDBKCODE);                   0735 02760000
         SHOWCB RPL=(RPLPTR),AREA=(R1),LENGTH=(R0),FIELDS=FDBK          02761000
*         RFY                                                      0736 02762000
*          (R0,                                                    0736 02763000
*           R1) UNRSTD;                                            0736 02764000
*                                                                  0736 02765000
*         /***********************************************************/ 02766000
*         /*                                                         */ 02767000
*         /* IF THE MAXIMUM NUMBER OF RETRIES HAS NOT BEEN REACHED   */ 02768000
*         /* AND A RETRYABLE RETURN CODE IS RECEIVED FROM VSAM, TURN */ 02769000
*         /* THE RETRY FLAG ON IN ORDER TO RETRY PUT. IF RETRY IS NOT*/ 02770000
*         /* POSSIBLE, BRANCH TO COMMON ERROR CODE FOR CVIOSTRT.     */ 02771000
*         /*                                                         */ 02772000
*         /***********************************************************/ 02773000
*                                                                  0737 02774000
*         IF(RETRYCNT<=RETRYMAX)&(FDBKCODE=INSUFSTG|FDBKCODE=TOOMANY)   02775000
*           THEN                                                   0737 02776000
         C     RETRYCNT,@CF00291                                   0737 02777000
         BH    @RF00737                                            0737 02778000
         L     @10,FDBKCODE                                        0737 02779000
         C     @10,@CF00585                                        0737 02780000
         BE    @RT00737                                            0737 02781000
         C     @10,@CF00575                                        0737 02782000
         BNE   @RF00737                                            0737 02783000
@RT00737 DS    0H                                                  0738 02784000
*           RETRYFLG=ON;            /* FORCE RETRY LOOP              */ 02785000
         LA    RETRYFLG,1                                          0738 02786000
*         ELSE                                                     0739 02787000
*           GO TO CVIOERR;          /* BRANCH TO COMMON ERROR CODE 0739 02788000
*                                      FOR CVIOSTRT                  */ 02789000
*       END;                                                       0740 02790000
*   END;                            /* END OF RETRY LOOP             */ 02791000
@RF00727 DS    0H                                                  0741 02792000
@DE00722 LA    @10,1                                               0741 02793000
         CR    RETRYFLG,@10                                        0741 02794000
         BE    @DL00722                                            0741 02795000
*   RFY                                                            0742 02796000
*     RPLPTR UNRSTD;                                               0742 02797000
         EJECT                                                          02798000
*                                                                  0743 02799000
*/********************************************************************/ 02800000
*/********************************************************************/ 02801000
*/*   CLOSE SYS1.STGINDEX                                            */ 02802000
*/********************************************************************/ 02803000
*/********************************************************************/ 02804000
*                                                                  0743 02805000
*   /*****************************************************************/ 02806000
*   /*                                                               */ 02807000
*   /* CLOSE SYS1.STGINDEX. IF CLOSE IS NOT SUCCESSFUL, ISSUE A      */ 02808000
*   /* SHOWCB TO DETERMINE THE TYPE OF ERROR. IF RETRY IS POSSIBLE,  */ 02809000
*   /* ISSUE ANOTHER CLOSE FOR SYS1.STGINDEX. IF RETRY IS NOT        */ 02810000
*   /* POSSIBLE, PERFORM COMMON ERROR CODE FOR CVIOSTRT AND RETURN TO*/ 02811000
*   /* MAINLINE.                                                     */ 02812000
*   /*                                                               */ 02813000
*   /*****************************************************************/ 02814000
*                                                                  0743 02815000
*   RETRYCNT=ZERO;                  /* INITIALIZE RETRY COUNT TO ZERO*/ 02816000
         SLR   RETRYCNT,RETRYCNT                                   0743 02817000
*   RETRYFLG=ON;                    /* SET RETRY FLAG ON             */ 02818000
         LR    RETRYFLG,@10                                        0744 02819000
*   DO WHILE(RETRYFLG=ON);                                         0745 02820000
         B     @DE00745                                            0745 02821000
@DL00745 DS    0H                                                  0746 02822000
*     RETRYCNT=RETRYCNT+ONE;        /* INCREMENT RETRY COUNT BY ONE  */ 02823000
         AL    RETRYCNT,@CF00052                                   0746 02824000
*     RETRYFLG=OFF;                 /* FORCE END OF RETRY LOOP       */ 02825000
         SLR   RETRYFLG,RETRYFLG                                   0747 02826000
*     RFY                                                          0748 02827000
*      (CLOSRTCD) RSTD;                                            0748 02828000
*     GEN REFS(ACBPTR) SETS(CLOSRTCD);                             0749 02829000
*                                                                  0749 02830000
         CLOSE ((ACBPTR))      /* CLOSE SYS1.STGINDEX               */  02831000
*     /***************************************************************/ 02832000
*     /*                                                             */ 02833000
*     /* IF CLOSE WAS UNSUCCESSFUL, ISSUE A SHOWCB TO OBTAIN THE CODE*/ 02834000
*     /* RETURNED FROM VSAM. THIS RETURN CODE IS USED TO DETERMINE   */ 02835000
*     /* WHETHER RETRY IS POSSIBLE. IF CLOSE WAS SUCCESSFUL, FALL    */ 02836000
*     /* THRU THE RETRY LOOP.                                        */ 02837000
*     /*                                                             */ 02838000
*     /***************************************************************/ 02839000
*                                                                  0750 02840000
*     IF CLOSRTCD>=RTCD0004 THEN                                   0750 02841000
         LA    @14,4                                               0750 02842000
         CR    CLOSRTCD,@14                                        0750 02843000
         BL    @RF00750                                            0750 02844000
*       DO;                                                        0751 02845000
*         RFY                                                      0752 02846000
*          (CLOSRTCD) UNRSTD;                                      0752 02847000
*         RFY                                                      0753 02848000
*          (R0,                                                    0753 02849000
*           R1) RSTD;                                              0753 02850000
*         R0=LENGTH(VSAMRTCD);                                     0754 02851000
         LR    R0,@14                                              0754 02852000
*         R1=ADDR(VSAMRTCD);                                       0755 02853000
         LA    R1,VSAMRTCD                                         0755 02854000
*         GEN REFS(R0,R1,ACBPTR) SETS(VSAMRTCD);                   0756 02855000
         SHOWCB ACB=(ACBPTR),AREA=(R1),LENGTH=(R0),FIELDS=ERROR         02856000
*         RFY                                                      0757 02857000
*          (R0,                                                    0757 02858000
*           R1) UNRSTD;                                            0757 02859000
*                                                                  0757 02860000
*         /***********************************************************/ 02861000
*         /*                                                         */ 02862000
*         /* IF THE MAXIMUM NUMBER OF RETRIES HAS NOT BEEN REACHED   */ 02863000
*         /* AND A RETRYABLE RETURN CODE IS RECEIVED FROM VSAM, TURN */ 02864000
*         /* THE RETRY FLAG ON IN ORDER TO RETRY CLOSE. IF RETRY IS  */ 02865000
*         /* NOT POSSIBLE, BRANCH TO COMMON ERROR CODE FOR CVIOSTRT. */ 02866000
*         /*                                                         */ 02867000
*         /***********************************************************/ 02868000
*                                                                  0758 02869000
*         IF(RETRYCNT<=RETRYMAX)&(VSAMRTCD=RTCD0136) THEN          0758 02870000
         C     RETRYCNT,@CF00291                                   0758 02871000
         BH    @RF00758                                            0758 02872000
         CLC   VSAMRTCD(4),@CF01385                                0758 02873000
         BNE   @RF00758                                            0758 02874000
*           RETRYFLG=ON;            /* FORCE RETRY LOOP              */ 02875000
         LA    RETRYFLG,1                                          0759 02876000
*         ELSE                                                     0760 02877000
*           GO TO CVIOERR;          /* BRANCH TO COMMON ERROR CODE 0760 02878000
*                                      FOR CVIOSTRT                  */ 02879000
*       END;                                                       0761 02880000
*   END;                            /* END OF RETRY LOOP             */ 02881000
@RF00750 DS    0H                                                  0762 02882000
@DE00745 C     RETRYFLG,@CF00236                                   0762 02883000
         BE    @DL00745                                            0762 02884000
         EJECT                                                          02885000
*                                                                  0763 02886000
*/********************************************************************/ 02887000
*/********************************************************************/ 02888000
*/*   OPEN SYS1.STGINDEX WITH UPDATE OPTION                          */ 02889000
*/********************************************************************/ 02890000
*/********************************************************************/ 02891000
*                                                                  0763 02892000
*   /*****************************************************************/ 02893000
*   /*                                                               */ 02894000
*   /* MODIFY THE ACB FOR SYS1.STGINDEX SO THAT SYS1.STGINDEX CAN BE */ 02895000
*   /* OPENED WITH THE UPDATE OPTION INSTEAD OF REUSE OPTION. IF     */ 02896000
*   /* MODCB IS UNSUCCESSFUL, THEN PERFORM COMMON ERROR CODE FOR     */ 02897000
*   /* CVIOSTRT AND RETURN TO MAINLINE.                              */ 02898000
*   /*                                                               */ 02899000
*   /*****************************************************************/ 02900000
*                                                                  0763 02901000
*   RFY                                                            0763 02902000
*    (MODRTCD) RSTD;                                               0763 02903000
*   GEN REFS(ACBPTR) SETS(MODRTCD);                                0764 02904000
         MODCB ACB=(ACBPTR),BUFND=4,BUFNI=3,MACRF=(NRS),STRNO=3         02905000
*   IF MODRTCD^=ZERO THEN                                          0765 02906000
         LTR   MODRTCD,MODRTCD                                     0765 02907000
         BNZ   @RT00765                                            0765 02908000
*     GO TO CVIOERR;                /* BRANCH TO COMMON ERROR CODE 0766 02909000
*                                      FOR CVIOSTRT                  */ 02910000
*   RFY                                                            0767 02911000
*    (MODRTCD) UNRSTD;                                             0767 02912000
*   RETRYCNT=ZERO;                  /* INITIALIZE RETRY COUNT TO ZERO*/ 02913000
         SLR   RETRYCNT,RETRYCNT                                   0768 02914000
*   RETRYFLG=ON;                    /* SET RETRY FLAG ON             */ 02915000
         LA    RETRYFLG,1                                          0769 02916000
*   DO WHILE(RETRYFLG=ON);                                         0770 02917000
         B     @DE00770                                            0770 02918000
@DL00770 DS    0H                                                  0771 02919000
*     RETRYCNT=RETRYCNT+ONE;        /* INCREMENT RETRY COUNT BY ONE  */ 02920000
         AL    RETRYCNT,@CF00052                                   0771 02921000
*     RETRYFLG=OFF;                 /* FORCE END OF RETRY LOOP       */ 02922000
         SLR   RETRYFLG,RETRYFLG                                   0772 02923000
*     RFY                                                          0773 02924000
*      (OPENRTCD) RSTD;                                            0773 02925000
*     GEN REFS(ACBPTR) SETS(OPENRTCD);                             0774 02926000
*                                                                  0774 02927000
         OPEN  ((ACBPTR))      /* OPEN SYS1.STGINDEX WITH UPDATE      XX02928000
                                  OPTION                            */  02929000
*     /***************************************************************/ 02930000
*     /*                                                             */ 02931000
*     /* IF OPEN WAS UNSUCCESSFUL, ISSUE A SHOWCB TO OBTAIN THE CODE */ 02932000
*     /* RETURNED FROM VSAM. THIS RETURN CODE IS USED TO DETERMINE   */ 02933000
*     /* WHETHER RETRY IS POSSIBLE. IF OPEN WAS SUCCESSFUL, FALL THRU*/ 02934000
*     /* THE RETRY LOOP.                                             */ 02935000
*     /*                                                             */ 02936000
*     /***************************************************************/ 02937000
*                                                                  0775 02938000
*     IF OPENRTCD>RTCD0004 THEN                                    0775 02939000
         LA    @14,4                                               0775 02940000
         CR    OPENRTCD,@14                                        0775 02941000
         BNH   @RF00775                                            0775 02942000
*       DO;                                                        0776 02943000
*         RFY                                                      0777 02944000
*          (OPENRTCD) UNRSTD;                                      0777 02945000
*         RFY                                                      0778 02946000
*          (R0,                                                    0778 02947000
*           R1) RSTD;                                              0778 02948000
*         R0=LENGTH(VSAMRTCD);                                     0779 02949000
         LR    R0,@14                                              0779 02950000
*         R1=ADDR(VSAMRTCD);                                       0780 02951000
         LA    R1,VSAMRTCD                                         0780 02952000
*         GEN REFS(R0,R1,ACBPTR) SETS(VSAMRTCD);                   0781 02953000
         SHOWCB ACB=(ACBPTR),AREA=(R1),LENGTH=(R0),FIELDS=ERROR         02954000
*         RFY                                                      0782 02955000
*          (R0,                                                    0782 02956000
*           R1) UNRSTD;                                            0782 02957000
*                                                                  0782 02958000
*         /***********************************************************/ 02959000
*         /*                                                         */ 02960000
*         /* IF THE MAXIMUM NUMBER OF RETRIES HAS NOT BEEN REACHED   */ 02961000
*         /* AND A RETRYABLE RETURN CODE IS RECEIVED FROM VSAM, TURN */ 02962000
*         /* THE RETRY FLAG ON IN ORDER TO RETRY OPEN. IF RETRY IS   */ 02963000
*         /* NOT POSSIBLE, BRANCH TO COMMON ERROR CODE FOR CVIOSTRT. */ 02964000
*         /*                                                         */ 02965000
*         /***********************************************************/ 02966000
*                                                                  0783 02967000
*         IF(RETRYCNT<=RETRYMAX)&(VSAMRTCD=RTCD0136|VSAMRTCD=RTCD0148|  02968000
*             VSAMRTCD=RTCD0176|VSAMRTCD=RTCD0236|VSAMRTCD=RTCD0244)    02969000
*           THEN                                                   0783 02970000
         C     RETRYCNT,@CF00291                                   0783 02971000
         BH    @RF00783                                            0783 02972000
         L     @10,VSAMRTCD                                        0783 02973000
         C     @10,@CF01385                                        0783 02974000
         BE    @RT00783                                            0783 02975000
         C     @10,@CF01387                                        0783 02976000
         BE    @RT00783                                            0783 02977000
         C     @10,@CF01389                                        0783 02978000
         BE    @RT00783                                            0783 02979000
         C     @10,@CF01391                                        0783 02980000
         BE    @RT00783                                            0783 02981000
         C     @10,@CF01393                                        0783 02982000
         BNE   @RF00783                                            0783 02983000
@RT00783 DS    0H                                                  0784 02984000
*           RETRYFLG=ON;            /* FORCE RETRY LOOP              */ 02985000
         LA    RETRYFLG,1                                          0784 02986000
*         ELSE                                                     0785 02987000
*           GO TO CVIOERR;          /* BRANCH TO COMMON ERROR CODE 0785 02988000
*                                      FOR CVIOSTRT                  */ 02989000
*       END;                                                       0786 02990000
*   END;                            /* END OF RETRY LOOP             */ 02991000
@RF00775 DS    0H                                                  0787 02992000
@DE00770 C     RETRYFLG,@CF00236                                   0787 02993000
         BE    @DL00770                                            0787 02994000
*   RFY                                                            0788 02995000
*     R14 RSTD;                                                    0788 02996000
*   R14=SAVRET1;                    /* RESTORE REG 14 WITH RETURN  0789 02997000
*                                      ADDRESS                       */ 02998000
         L     R14,SAVRET1                                         0789 02999000
*   RETURN;                         /* RETURN TO MAINLINE            */ 03000000
@EL00005 DS    0H                                                  0790 03001000
@EF00005 DS    0H                                                  0790 03002000
@ER00005 BR    @14                                                 0790 03003000
*   RFY                                                            0791 03004000
*     R14 UNRSTD;                                                  0791 03005000
*   RFY                                                            0792 03006000
*     ACBPTR UNRSTD;                                               0792 03007000
         EJECT                                                          03008000
*                                                                  0793 03009000
*/********************************************************************/ 03010000
*/********************************************************************/ 03011000
*/*   COMMON ERROR CODE FOR CVIOSTRT                                 */ 03012000
*/********************************************************************/ 03013000
*/********************************************************************/ 03014000
*                                                                  0793 03015000
*CVIOERR:                                                          0793 03016000
*   DO;                                                            0793 03017000
*                                                                  0793 03018000
CVIOERR  DS    0H                                                  0794 03019000
*     /***************************************************************/ 03020000
*     /*                                                             */ 03021000
*     /* TELL OPERATOR THAT SYS1.STGINDEX COULD NOT BE INITIALIZED.  */ 03022000
*     /* ASK THE OPERATOR IF IT IS O.K. TO CONTINUE WITHOUT VIO      */ 03023000
*     /* JOURNALING AND THEN WAIT FOR OPERATOR'S RESPONSE.           */ 03024000
*     /*                                                             */ 03025000
*     /***************************************************************/ 03026000
*                                                                  0794 03027000
*     DO;                           /* WTOP MF(E,WTO02M)             */ 03028000
*       RFY                                                        0795 03029000
*         GPR01P RSTD;              /* RESTRICT REG 1                */ 03030000
*       GPR01P=ADDR(WTO02M);        /* ADDRESS CONTROL PROGRAM LIST  */ 03031000
         LA    GPR01P,WTO02M                                       0796 03032000
*       SVC(35);                    /* ISSUE WTO SVC                 */ 03033000
         SVC   35                                                  0797 03034000
*       RFY                                                        0798 03035000
*         GPR01P UNRSTD;            /* RELEASE REG 1                 */ 03036000
*     END;                          /* WTOP MF(E,WTO02M) TELL      0799 03037000
*                                      OPERATOR THAT SYS1.STGINDEX 0799 03038000
*                                      COULD NOT BE INITIALIZED AND     03039000
*                                      THAT THERE WILL BE NO VIO   0799 03040000
*                                      JOURNALING                    */ 03041000
*     WTORECB=ZERO;                 /* ZERO OUT WTORECB              */ 03042000
         SLR   @10,@10                                             0800 03043000
         ST    @10,WTORECB                                         0800 03044000
*     DO;                           /* WTORP MF(E,WTO22M)            */ 03045000
*       RFY                                                        0802 03046000
*         GPR01P RSTD;              /* RESTRICT REG 1                */ 03047000
*       GPR01P=ADDR(WTO22M);        /* ADDRESS CONTROL PROGRAM LIST  */ 03048000
         LA    GPR01P,WTO22M                                       0803 03049000
*       SVC(35);                    /* ISSUE WTOR SVC                */ 03050000
         SVC   35                                                  0804 03051000
*       RFY                                                        0805 03052000
*         GPR01P UNRSTD;            /* RELEASE REG 1                 */ 03053000
*     END;                          /* WTORP MF(E,WTO22M) REQUEST A     03054000
*                                      DECISION FROM OPERATOR ON   0806 03055000
*                                      WHETHER TO CONTINUE WITHOUT 0806 03056000
*                                      VIO JOURNALING                */ 03057000
*     DO;                           /* WAIT ECB(WTORECB)             */ 03058000
*       RESPECIFY                                                  0808 03059000
*        (GPR00P,                                                  0808 03060000
*         GPR01P) RESTRICTED;                                      0808 03061000
*       GPR00P=1;                   /* LOAD WAIT COUNT               */ 03062000
         LA    GPR00P,1                                            0809 03063000
*       GPR01P=ADDR(WTORECB);       /* ADDRESS OF ECB                */ 03064000
         LA    GPR01P,WTORECB                                      0810 03065000
*       SVC(1);                     /* WAIT SVC                      */ 03066000
         SVC   1                                                   0811 03067000
*       RESPECIFY                                                  0812 03068000
*        (GPR00P,                                                  0812 03069000
*         GPR01P) UNRESTRICTED;                                    0812 03070000
*     END;                          /* WAIT ECB(WTORECB) WAIT FOR  0813 03071000
*                                      OPERATOR REPLY                */ 03072000
*                                                                  0813 03073000
*     /***************************************************************/ 03074000
*     /*                                                             */ 03075000
*     /* IF SYS1.STGINDEX IS OPEN, ZERO OUT THE ASMVT POINTER TO THE */ 03076000
*     /* ACB FOR SYS1.STGINDEX AND THEN CLOSE SYS1.STGINDEX.         */ 03077000
*     /*                                                             */ 03078000
*     /***************************************************************/ 03079000
*                                                                  0814 03080000
*     IF ASMSTGXA^=ZERO THEN                                       0814 03081000
         SLR   @10,@10                                             0814 03082000
         C     @10,ASMSTGXA(,ASMVTPTR)                             0814 03083000
         BE    @RF00814                                            0814 03084000
*       DO;                                                        0815 03085000
*         ASMSTGXA=ZERO;            /* ZERO ASMVT POINTER TO ACB FOR    03086000
*                                      SYS1.STGINDEX                 */ 03087000
         ST    @10,ASMSTGXA(,ASMVTPTR)                             0816 03088000
*         GEN REFS(ACBPTR)( CLOSE ((ACBPTR)) );/* CLOSE SYS1.STGINDEX*/ 03089000
          CLOSE ((ACBPTR))                                              03090000
*       END;                                                       0818 03091000
*     INTRTCD=INTRTCD|RTCD0016;     /* ADJUST INTERNAL RETURN CODE   */ 03092000
@RF00814 L     @10,INTRTCD                                         0819 03093000
         O     @10,@CF00049                                        0819 03094000
         ST    @10,INTRTCD                                         0819 03095000
*     RFY                                                          0820 03096000
*       R14 RSTD;                                                  0820 03097000
*     R14=SAVRET1;                  /* RESTORE REG 14 WITH RETURN  0821 03098000
*                                      ADDRESS                       */ 03099000
         L     R14,SAVRET1                                         0821 03100000
*     RETURN;                       /* RETURN TO MAINLINE            */ 03101000
         B     @EL00005                                            0822 03102000
*     RFY                                                          0823 03103000
*       R14 UNRSTD;                                                0823 03104000
*   END CVIOERR;                                                   0824 03105000
*   RFY                                                            0825 03106000
*    (ACBAREA@,                                                    0825 03107000
*     IOBUFPTR,                                                    0825 03108000
*     RPLAREA@) UNRSTD;                                            0825 03109000
*   END CVIOSTRT;                                                  0826 03110000
         EJECT                                                          03111000
*                                                                  0827 03112000
*/********************************************************************/ 03113000
*/*                                                                  */ 03114000
*/*   BUILDSNL:  BUILD LIST OF ALL PAGE AND SWAP DATA SET NAMES.     */ 03115000
*/*                                                                  */ 03116000
*/*   PROCESS:   A CONDITIONAL GETMAIN IS ISSUED FOR THE DATA        */ 03117000
*/*              SET NAME LIST.  IF GETMAIN IS UNSUCCESSFUL,         */ 03118000
*/*              INFORM THE OPERATOR THAT PAGEADD COMMAND WILL NOT   */ 03119000
*/*              WORK. PROCESSING THEN CONTINUES BACK IN MAINLINE.   */ 03120000
*/*              IF GETMAIN WAS SUCCESSFUL, STORE THE POINTER TO     */ 03121000
*/*              THE DATA SET NAME LIST IN THE PART AND COPY THE     */ 03122000
*/*              DATA SET NAME FROM EACH PAGING DATA SET ENTRY       */ 03123000
*/*              IN THE TPARTBLE INTO THE DATA SET NAME LIST. IF     */ 03124000
*/*              THERE ARE ANY SWAP DATA SETS IN USE, STORE THE      */ 03125000
*/*              POINTER TO THE (PARTSIZE +1) ENTRY OF THE DATA SET  */ 03126000
*/*              NAME LIST INTO THE SART AND COPY THE DATA SET NAME  */ 03127000
*/*              FROM EACH SWAP DATA SET ENTRY IN THE TPARTBLE       */ 03128000
*/*              INTO THE DATA SET NAME LIST.  ONCE ALL SWAP DATA    */ 03129000
*/*              SETS NAMES HAVE BEEN COPIED, PROCESSING CONTINUES   */ 03130000
*/*              BACK IN THE MAINLINE.                               */ 03131000
*/*                                                                  */ 03132000
*/********************************************************************/ 03133000
*                                                                  0827 03134000
*BUILDSNL:                                                         0827 03135000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0827 03136000
BUILDSNL DS    0H                                                  0828 03137000
         EJECT                                                          03138000
*                                                                  0828 03139000
*/********************************************************************/ 03140000
*/********************************************************************/ 03141000
*/*   CREATE DATA SET NAME LIST BUILD AREA                           */ 03142000
*/********************************************************************/ 03143000
*/********************************************************************/ 03144000
*                                                                  0828 03145000
*   RFY                                                            0828 03146000
*    (ACBAREA@) RSTD;                                              0828 03147000
*   RFY                                                            0829 03148000
*    (R14) RSTD;                                                   0829 03149000
*   SAVRET1=R14;                    /* SAVE RETURN ADDRESS           */ 03150000
         ST    R14,SAVRET1                                         0830 03151000
*   RFY                                                            0831 03152000
*    (R14) UNRSTD;                                                 0831 03153000
*   EPATMIRT=ADDR(ILRCRTM4);        /* SET CURRENT RETRY ADDRESS IN     03154000
*                                      EPATH - RRR                   */ 03155000
         LA    @10,ILRCRTM4                                        0832 03156000
         ST    @10,EPATMIRT(,EPAPTR)                               0832 03157000
*   EPABUILD=ON;                    /* TURN ON THE BUILD DSN FLAG IN    03158000
*                                      THE EPATH TO INDICATE THAT  0833 03159000
*                                      ILRTMI00 IS IN BUILDSNL - RRR */ 03160000
*                                                                  0833 03161000
         OI    EPABUILD(EPAPTR),B'00010000'                        0833 03162000
*   /*****************************************************************/ 03163000
*   /*                                                               */ 03164000
*   /* OBTAIN STORAGE FROM CSA (SUBPOOL 241) FOR DATA SET NAME LIST  */ 03165000
*   /* VIA GETMAIN                                                   */ 03166000
*   /*                                                               */ 03167000
*   /*****************************************************************/ 03168000
*                                                                  0834 03169000
*   DSNTOTAL=PARTSIZE+SARSIZE;      /* GET TOTAL NUMBER OF PAGE    0834 03170000
*                                      ENTRIES AND SWAP ENTRIES    0834 03171000
*                                      (I.E., TOTAL NUMBER OF DATA 0834 03172000
*                                      SET NAMES                     */ 03173000
         L     @10,PARTPTR(,ASMVTPTR)                              0834 03174000
         L     @01,SARTPTR(,ASMVTPTR)                              0834 03175000
         L     DSNTOTAL,PARTSIZE(,@10)                             0834 03176000
         AL    DSNTOTAL,SARSIZE(,@01)                              0834 03177000
*   RFY                                                            0835 03178000
*    (R1,                                                          0835 03179000
*     GTMNRTCD) RSTD;                                              0835 03180000
*   DO;                             /* GETMAIN (RC)                0836 03181000
*                                      LV(DSNTOTAL*LENGTH(TPAEDSN))     03182000
*                                      SP(241)                       */ 03183000
*     RESPECIFY                                                    0837 03184000
*      (GPR01F,                                                    0837 03185000
*       GPR15F,                                                    0837 03186000
*       GPR00F) RESTRICTED;                                        0837 03187000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 03188000
         SLR   GPR01F,GPR01F                                       0838 03189000
*     GPR15F=0;                     /* RC-TYPE GETMAIN               */ 03190000
         SLR   GPR15F,GPR15F                                       0839 03191000
*     GPR00F=DSNTOTAL*LENGTH(TPAEDSN);/* LENGTH REQUESTED            */ 03192000
         LR    GPR00F,DSNTOTAL                                     0840 03193000
         MH    GPR00F,@CH00991                                     0840 03194000
*     GPR15F=GPR15F|((241)*256);    /* SP IN BYTE 2                  */ 03195000
         O     GPR15F,@CF01651                                     0841 03196000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 03197000
         SVC   120                                                 0842 03198000
*     RESPECIFY                                                    0843 03199000
*      (GPR01F,                                                    0843 03200000
*       GPR15F,                                                    0843 03201000
*       GPR00F) UNRESTRICTED;                                      0843 03202000
*   END;                            /* GETMAIN (RC)                0844 03203000
*                                      LV(DSNTOTAL*LENGTH(TPAEDSN))     03204000
*                                      SP(241) OBTAIN THE NEEDED   0844 03205000
*                                      STORAGE                       */ 03206000
*                                                                  0844 03207000
*   /*****************************************************************/ 03208000
*   /*                                                               */ 03209000
*   /* IF STORAGE WAS OBTAINED, THEN BUILD DATA SET NAME LIST.       */ 03210000
*   /* OTHERWISE, TELL OPERATOR PAGE ADD WILL NOT WORK AND RETURN TO */ 03211000
*   /* MAINLINE                                                      */ 03212000
*   /*                                                               */ 03213000
*   /*****************************************************************/ 03214000
*                                                                  0845 03215000
*   IF GTMNRTCD=ZERO THEN                                          0845 03216000
         LTR   GTMNRTCD,GTMNRTCD                                   0845 03217000
         BNZ   @RF00845                                            0845 03218000
*     DO;                                                          0846 03219000
*       RFY                                                        0847 03220000
*        (GTMNRTCD) UNRSTD;                                        0847 03221000
*       DSNLPTR=R1;                 /* SAVE POINTER TO DATA SET NAME    03222000
*                                      LIST BUILD AREA               */ 03223000
         LR    DSNLPTR,R1                                          0848 03224000
*       EPADSLST=DSNLPTR;           /* RECORD POINTER TO DATA SET  0849 03225000
*                                      NAME LIST BUILD AREA - RRR    */ 03226000
         ST    DSNLPTR,EPADSLST(,EPAPTR)                           0849 03227000
*       RFY                                                        0850 03228000
*        (R1) UNRSTD;                                              0850 03229000
*       RFY                                                        0851 03230000
*        (RECADDR,                                                 0851 03231000
*         RECLEN,                                                  0851 03232000
*         SRCADDR,                                                 0851 03233000
*         SRCLEN) RSTD;                                            0851 03234000
*       RECADDR=DSNLPTR;            /* SET RECEIVER ADDRESS TO     0852 03235000
*                                      BEGINNING OF DATA SET NAME  0852 03236000
*                                      LIST BUILD AREA               */ 03237000
         LR    RECADDR,DSNLPTR                                     0852 03238000
*       RECLEN=DSNTOTAL*LENGTH(TPAEDSN);/* SET RECEIVER LENGTH TO  0853 03239000
*                                      THAT OF THE DATA SET NAME LIST   03240000
*                                      BUILD AREA                    */ 03241000
         LR    RECLEN,DSNTOTAL                                     0853 03242000
         MH    RECLEN,@CH00991                                     0853 03243000
*       SRCLEN=PADBLANK;            /* SET PADDING CHARACTER TO BLANK   03244000
*                                      AND SOURCE LENGTH TO ZERO     */ 03245000
         L     SRCLEN,@CF01373                                     0854 03246000
*       MVCL(RECADDR,SRCADDR);      /* INITIALIZE THE DATA SET NAME     03247000
*                                      LIST BUILD AREA TO BLANKS     */ 03248000
         MVCL  RECADDR,SRCADDR                                     0855 03249000
*       RFY                                                        0856 03250000
*        (RECADDR,                                                 0856 03251000
*         RECLEN,                                                  0856 03252000
*         SRCADDR,                                                 0856 03253000
*         SRCLEN) UNRSTD;                                          0856 03254000
         EJECT                                                          03255000
*                                                                  0857 03256000
*/********************************************************************/ 03257000
*/********************************************************************/ 03258000
*/*   BUILD PAGE PORTION OF DATA SET NAME LIST                       */ 03259000
*/********************************************************************/ 03260000
*/********************************************************************/ 03261000
*                                                                  0857 03262000
*       /*************************************************************/ 03263000
*       /*                                                           */ 03264000
*       /* BUILD THE PAGE PORTION OF THE DATA SET NAME LIST BY       */ 03265000
*       /* COPYING THE PAGE DATA SET NAME FROM EACH PAGE DATA SET    */ 03266000
*       /* ENTRY IN THE TPARTBLE INTO AN ENTRY IN THE DATA SET NAME  */ 03267000
*       /* LIST                                                      */ 03268000
*       /*                                                           */ 03269000
*       /*************************************************************/ 03270000
*                                                                  0857 03271000
*       PARTDSNL=DSNLPTR;           /* STORE POINTER TO PAGE PORTION    03272000
*                                      OF THE DATA SET NAME LIST IN     03273000
*                                      THE PART                      */ 03274000
         L     @10,PARTPTR(,ASMVTPTR)                              0857 03275000
         ST    DSNLPTR,PARTDSNL(,@10)                              0857 03276000
*       DSNEPTR=DSNLPTR;            /* SET DATA SET NAME ENTRY     0858 03277000
*                                      POINTER TO BEGINNING OF PAGE     03278000
*                                      PORTION OF THE DATA SET NAME     03279000
*                                      LIST                          */ 03280000
         LR    DSNEPTR,DSNLPTR                                     0858 03281000
*       TPAEPTR=ADDR(TPARPENT);     /* SET PAGE ENTRY POINTER TO   0859 03282000
*                                      BEGINNING OF PAGE DATA SET  0859 03283000
*                                      ENTRY SECTION OF TPARTBLE     */ 03284000
         L     TPAEPTR,TPARPTR                                     0859 03285000
         LA    TPAEPTR,TPARPENT(,TPAEPTR)                          0859 03286000
*       DO DSNCNT=PARTEUSE BY-ONE TO ONE;                          0860 03287000
         L     DSNCNT,PARTEUSE(,@10)                               0860 03288000
         B     @DE00860                                            0860 03289000
@DL00860 DS    0H                                                  0861 03290000
*         IF TPAESKIP=OFF THEN                                     0861 03291000
         TM    TPAESKIP(TPAEPTR),B'00010000'                       0861 03292000
         BNZ   @RF00861                                            0861 03293000
*           DSNENTRY=TPAEDSN;       /* COPY PAGE DATA SET NAME FROM     03294000
*                                      TPARTBLE TO DATA SET NAME LIST*/ 03295000
         MVC   DSNENTRY(44,DSNEPTR),TPAEDSN(TPAEPTR)               0862 03296000
*         DSNEPTR=DSNEPTR+LENGTH(TPAEDSN);/* OBTAIN ADDRESS OF THE 0863 03297000
*                                      NEXT DATA SET NAME ENTRY      */ 03298000
@RF00861 AL    DSNEPTR,@CF00991                                    0863 03299000
*         TPAEPTR=TPAEPTR+LENGTH(TPARPENT);/* OBTAIN ADDRESS OF THE     03300000
*                                      NEXT PAGE DATA SET ENTRY IN 0864 03301000
*                                      THE TPARTBLE                  */ 03302000
         AL    TPAEPTR,@CF00966                                    0864 03303000
*       END;                        /* ANY MORE PAGE DATA SET ENTRIES   03304000
*                                      FOR THIS IPL                  */ 03305000
         BCTR  DSNCNT,0                                            0865 03306000
@DE00860 LTR   DSNCNT,DSNCNT                                       0865 03307000
         BP    @DL00860                                            0865 03308000
         EJECT                                                          03309000
*                                                                  0866 03310000
*/********************************************************************/ 03311000
*/********************************************************************/ 03312000
*/*   BUILD SWAP PORTION OF DATA SET NAME LIST                       */ 03313000
*/********************************************************************/ 03314000
*/********************************************************************/ 03315000
*                                                                  0866 03316000
*       /*************************************************************/ 03317000
*       /*                                                           */ 03318000
*       /* IF THERE ARE ANY SWAP DATA SET ENTRIES IN USE THEN BUILD  */ 03319000
*       /* THE SWAP PORTION OF THE DATA SET NAME LIST BY COPYING THE */ 03320000
*       /* SWAP DATA SET NAME FROM EACH SWAP DATA SET ENTRY IN THE   */ 03321000
*       /* TPARTBLE INTO AN ENTRY IN THE DATA SET NAME LIST.         */ 03322000
*       /*                                                           */ 03323000
*       /*************************************************************/ 03324000
*                                                                  0866 03325000
*       SARDSNL=DSNLPTR+(PARTSIZE*LENGTH(DSNENTRY));/* STORE POINTER    03326000
*                                      TO SWAP PORTION OF THE DATA 0866 03327000
*                                      SET NAME LIST IN SART         */ 03328000
         L     @10,SARTPTR(,ASMVTPTR)                              0866 03329000
         L     @06,PARTPTR(,ASMVTPTR)                              0866 03330000
         L     @06,PARTSIZE(,@06)                                  0866 03331000
         MH    @06,@CH00991                                        0866 03332000
         ALR   @06,DSNLPTR                                         0866 03333000
         ST    @06,SARDSNL(,@10)                                   0866 03334000
*       IF SARUSE^=ZERO THEN                                       0867 03335000
         L     @10,SARUSE(,@10)                                    0867 03336000
         LTR   @10,@10                                             0867 03337000
         BZ    @RF00867                                            0867 03338000
*         DO;                                                      0868 03339000
         ST    @06,@TF00001                                        0868 03340000
*           DSNEPTR=SARDSNL;        /* SET DATA SET NAME ENTRY     0869 03341000
*                                      POINTER TO BEGINNING OF SWAP     03342000
*                                      PORTION OF DATA SET NAME LIST */ 03343000
         L     DSNEPTR,@TF00001                                    0869 03344000
*           TPASPTR=ADDR(TPARSENT); /* SET SWAP ENTRY POINTER TO   0870 03345000
*                                      BEGINNING OF SWAP DATA SET  0870 03346000
*                                      ENTRY SECTION OF TPARTBLE     */ 03347000
         L     TPASPTR,TPARPTR                                     0870 03348000
         AL    TPASPTR,@CF01667                                    0870 03349000
*           DO DSNCNT=SARUSE BY-ONE TO ONE;                        0871 03350000
         LR    DSNCNT,@10                                          0871 03351000
         B     @DE00871                                            0871 03352000
@DL00871 DS    0H                                                  0872 03353000
*             DSNENTRY=TPASDSN;     /* COPY SWAP DATA SET NAME FROM     03354000
*                                      TPARTBLE TO DATA SET NAME LIST*/ 03355000
         MVC   DSNENTRY(44,DSNEPTR),TPASDSN(TPASPTR)               0872 03356000
*             DSNEPTR=DSNEPTR+LENGTH(TPASDSN);/* OBTAIN ADDRESS OF 0873 03357000
*                                      THE NEXT DATA SET NAME ENTRY  */ 03358000
         AL    DSNEPTR,@CF00991                                    0873 03359000
*             TPASPTR=TPASPTR+LENGTH(TPARSENT);/* OBTAIN ADDRESS OF     03360000
*                                      THE NEXT SWAP DATA SET ENTRY     03361000
*                                      IN THE TPARTBLE               */ 03362000
         AL    TPASPTR,@CF00536                                    0874 03363000
*           END;                    /* ANY MORE SWAP DATA SET ENTRIES   03364000
*                                      FOR THIS IPL ?                */ 03365000
         BCTR  DSNCNT,0                                            0875 03366000
@DE00871 LTR   DSNCNT,DSNCNT                                       0875 03367000
         BP    @DL00871                                            0875 03368000
*         END;                                                     0876 03369000
*     END;                                                         0877 03370000
         EJECT                                                          03371000
*                                                                  0878 03372000
*/********************************************************************/ 03373000
*/********************************************************************/ 03374000
*/*   STORAGE NOT AVAILABLE FOR DATA SET NAME LIST                   */ 03375000
*/********************************************************************/ 03376000
*/********************************************************************/ 03377000
*                                                                  0878 03378000
*   /*****************************************************************/ 03379000
*   /*                                                               */ 03380000
*   /* IF STORAGE FOR DATA SET NAME LIST WAS NOT OBTAINABLE, THEN    */ 03381000
*   /* ZERO THE PART POINTER TO THE PAGE PORTION OF DSN LIST AND THE */ 03382000
*   /* SART POINTER TO THE SWAP PORTION OF DSN LIST. TELL OPERATOR   */ 03383000
*   /* THAT PAGE ADD WILL NOT WORK AND RETURN TO CALLER.             */ 03384000
*   /*                                                               */ 03385000
*   /*****************************************************************/ 03386000
*                                                                  0878 03387000
*   ELSE                                                           0878 03388000
*     DO;                                                          0878 03389000
         B     @RC00845                                            0878 03390000
@RF00845 DS    0H                                                  0879 03391000
*       PARTDSNL=ZERO;              /* ZERO PART POINTER TO THE PAGE    03392000
*                                      PORTION OF THE DATA SET NAME     03393000
*                                      LIST                          */ 03394000
         SLR   @10,@10                                             0879 03395000
         L     @02,PARTPTR(,ASMVTPTR)                              0879 03396000
         ST    @10,PARTDSNL(,@02)                                  0879 03397000
*       SARDSNL=ZERO;               /* ZERO SART POINTER TO THE SWAP    03398000
*                                      PORTION OF THE DATA SET NAME     03399000
*                                      LIST                          */ 03400000
         L     @02,SARTPTR(,ASMVTPTR)                              0880 03401000
         ST    @10,SARDSNL(,@02)                                   0880 03402000
*       DO;                         /* WTOP MF(E,WTO04M)             */ 03403000
*         RFY                                                      0882 03404000
*           GPR01P RSTD;            /* RESTRICT REG 1                */ 03405000
*         GPR01P=ADDR(WTO04M);      /* ADDRESS CONTROL PROGRAM LIST  */ 03406000
         LA    GPR01P,WTO04M                                       0883 03407000
*         SVC(35);                  /* ISSUE WTO SVC                 */ 03408000
         SVC   35                                                  0884 03409000
*         RFY                                                      0885 03410000
*           GPR01P UNRSTD;          /* RELEASE REG 1                 */ 03411000
*       END;                        /* WTOP MF(E,WTO04M) TELL      0886 03412000
*                                      OPERATOR THAT PAGE ADD WILL 0886 03413000
*                                      NOT WORK                      */ 03414000
*       INTRTCD=INTRTCD|RTCD0064;   /* ADJUST INTERNAL RETURN CODE   */ 03415000
         L     @10,INTRTCD                                         0887 03416000
         O     @10,@CF00575                                        0887 03417000
         ST    @10,INTRTCD                                         0887 03418000
*     END;                                                         0888 03419000
*   RFY                                                            0889 03420000
*    (R14) RSTD;                                                   0889 03421000
@RC00845 DS    0H                                                  0890 03422000
*   R14=SAVRET1;                    /* RESTORE REG 14 WITH RETURN  0890 03423000
*                                      ADDRESS                       */ 03424000
         L     R14,SAVRET1                                         0890 03425000
*   RFY                                                            0891 03426000
*    (R14) UNRSTD;                                                 0891 03427000
*   RFY                                                            0892 03428000
*    (ACBAREA@) UNRSTD;                                            0892 03429000
*   END BUILDSNL;                                                  0893 03430000
@EL00006 DS    0H                                                  0893 03431000
@EF00006 DS    0H                                                  0893 03432000
@ER00006 BR    @14                                                 0893 03433000
*   END ILRTMI00                                                   0894 03434000
*                                                                  0894 03435000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 03436000
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */ 03437000
*/*%INCLUDE SYSLIB  (IDAAMB  )                                       */ 03438000
*/*%INCLUDE SYSLIB  (IDAAMBL )                                       */ 03439000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                       */ 03440000
*/*%INCLUDE SYSLIB  (IDAARDB )                                       */ 03441000
*/*%INCLUDE SYSLIB  (ILRASMVT)                                       */ 03442000
*/*%INCLUDE SYSLIB  (ILRASPCT)                                       */ 03443000
*/*%INCLUDE SYSLIB  (ILREPATH)                                       */ 03444000
*/*%INCLUDE SYSLIB  (ILRPART )                                       */ 03445000
*/*%INCLUDE SYSLIB  (ILRPAT  )                                       */ 03446000
*/*%INCLUDE SYSLIB  (ILRPCT  )                                       */ 03447000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 03448000
*/*%INCLUDE SYSLIB  (ILRSART )                                       */ 03449000
*/*%INCLUDE SYSLIB  (ILRTPARB)                                       */ 03450000
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                       */ 03451000
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                       */ 03452000
*                                                                  0894 03453000
*       ;                                                          0894 03454000
@DATA    DS    0H                                                       03455000
@CH00904 DC    H'13'                                                    03456000
         DS    0F                                                       03457000
@SA00001 DS    18F                                                      03458000
@TF00001 DS    F                                                        03459000
         DS    0F                                                       03460000
@CF00052 DC    F'1'                                                     03461000
@CF00092 DC    F'2'                                                     03462000
@CH00092 EQU   @CF00092+2                                               03463000
@CF00095 DC    F'4'                                                     03464000
@CF00291 DC    F'5'                                                     03465000
@CF00037 DC    F'8'                                                     03466000
@CH00037 EQU   @CF00037+2                                               03467000
@CF00049 DC    F'16'                                                    03468000
@CF00340 DC    F'32'                                                    03469000
@CF00585 DC    F'40'                                                    03470000
@CF00991 DC    F'44'                                                    03471000
@CH00991 EQU   @CF00991+2                                               03472000
@CF00536 DC    F'48'                                                    03473000
@CF00575 DC    F'64'                                                    03474000
@CF00966 DC    F'96'                                                    03475000
@CF01383 DC    F'128'                                                   03476000
@CF01385 DC    F'136'                                                   03477000
@CF01387 DC    F'148'                                                   03478000
@CF01389 DC    F'176'                                                   03479000
@CF01391 DC    F'236'                                                   03480000
@CF01393 DC    F'244'                                                   03481000
@CF00546 DC    F'256'                                                   03482000
@CF01667 DC    F'6208'                                                  03483000
@CF01655 DC    F'8192'                                                  03484000
@CF01651 DC    F'61696'                                                 03485000
@CF01652 DC    F'62720'                                                 03486000
@CF01653 DC    F'-1'                                                    03487000
@CF00650 DC    XL4'80000000'                                            03488000
@CF01373 DC    XL4'40000000'                                            03489000
@CF00236 DC    BL4'1'                                                   03490000
         DS    0D                                                       03491000
LPMEPTR  DS    A                                                        03492000
PAREPTR  DS    A                                                        03493000
SAREPTR  DS    A                                                        03494000
TPARPTR  DS    A                                                        03495000
S99RBPTR DS    AL4                                                      03496000
         ORG   S99RBPTR                                                 03497000
S99RBPND DS    BL1                                                      03498000
         ORG   S99RBPTR+4                                               03499000
S99TUFP  DS    A                                                        03500000
GETAREA@ DS    A                                                        03501000
PATCYLA  DS    A                                                        03502000
BACKSLOT DS    F                                                        03503000
FDBKCODE DS    F                                                        03504000
INTRTCD  DS    F                                                        03505000
LPMEINDX DS    F                                                        03506000
MAXRBA   DS    F                                                        03507000
RBA      DS    F                                                        03508000
SAVESLOT DS    F                                                        03509000
SAVRET1  DS    F                                                        03510000
SAVRET2  DS    F                                                        03511000
SLOTV    DS    F                                                        03512000
VSAMRTCD DS    F                                                        03513000
WTORECB  DS    F                                                        03514000
RESETFLG DS    FL1                                                      03515000
@CC01351 DC    C'SYS1.STGINDEX'                                         03516000
@CC01347 DC    C'STGINDEX'                                              03517000
@CC01363 DC    C'SYSDSN  '                                              03518000
@CC01626 DC    C'ILRPREAD'                                              03519000
@CC01345 DC    C'ASPC'                                                  03520000
@CC01361 DC    C'LPME'                                                  03521000
@CB01358 DC    X'00000000FFFFFFFF00000000'                              03522000
@CB01067 DC    X'0001'                                                  03523000
@CB01069 DC    X'0002'                                                  03524000
@CB01073 DC    X'0004'                                                  03525000
@CB01075 DC    X'0005'                                                  03526000
@CB01097 DC    X'0010'                                                  03527000
@CB01239 DC    X'0057'                                                  03528000
         DS    CL2                                                      03529000
S99RB    DS    CL20                                                     03530000
         ORG   S99RB                                                    03531000
S99RBLN  DS    CL1                                                      03532000
S99VERB  DS    CL1                                                      03533000
S99FLAG1 DS    CL2                                                      03534000
         ORG   S99FLAG1                                                 03535000
S99FLG11 DS    CL1                                                      03536000
         ORG   S99FLG11                                                 03537000
S99ONCNV DS    BL1                                                      03538000
S99NOCNV EQU   S99FLG11+0                                               03539000
S99NOMNT EQU   S99FLG11+0                                               03540000
S99JBSYS EQU   S99FLG11+0                                               03541000
         ORG   S99FLAG1+1                                               03542000
S99FLG12 DS    CL1                                                      03543000
         ORG   S99RB+4                                                  03544000
S99RSC   DS    CL4                                                      03545000
         ORG   S99RSC                                                   03546000
S99ERROR DS    CL2                                                      03547000
S99INFO  DS    CL2                                                      03548000
         ORG   S99RB+8                                                  03549000
S99TXTPP DS    AL4                                                      03550000
S99RSV01 DS    FL4                                                      03551000
S99FLAG2 DS    CL4                                                      03552000
         ORG   S99FLAG2                                                 03553000
S99FLG21 DS    CL1                                                      03554000
         ORG   S99FLG21                                                 03555000
S99WTVOL DS    BL1                                                      03556000
S99WTDSN EQU   S99FLG21+0                                               03557000
S99NORES EQU   S99FLG21+0                                               03558000
S99WTUNT EQU   S99FLG21+0                                               03559000
S99OFFLN EQU   S99FLG21+0                                               03560000
S99TIONQ EQU   S99FLG21+0                                               03561000
S99CATLG EQU   S99FLG21+0                                               03562000
S99MOUNT EQU   S99FLG21+0                                               03563000
         ORG   S99FLAG2+1                                               03564000
S99FLG22 DS    CL1                                                      03565000
         ORG   S99FLG22                                                 03566000
S99UDEVT DS    BL1                                                      03567000
S99PCINT EQU   S99FLG22+0                                               03568000
         ORG   S99FLAG2+2                                               03569000
S99FLG23 DS    CL1                                                      03570000
S99FLG24 DS    CL1                                                      03571000
         ORG   S99RB+20                                                 03572000
PARMLIST DS    CL12                                                     03573000
         ORG   PARMLIST                                                 03574000
PARMFLAG DS    BL1                                                      03575000
         ORG   PARMFLAG                                                 03576000
PARMRDWT DS    BL1                                                      03577000
PARMTPAR EQU   PARMFLAG+0                                               03578000
@NM00075 EQU   PARMFLAG+0                                               03579000
         ORG   PARMLIST+1                                               03580000
PARMTOT  DS    FL1                                                      03581000
PARMFRST DS    FL2                                                      03582000
PARMENTP DS    AL4                                                      03583000
PARMBUFP DS    AL4                                                      03584000
         ORG   PARMLIST+12                                              03585000
REPLY    DS    CL1                                                      03586000
VSAMKEY  DS    CL12                                                     03587000
         DS    CL3                                                      03588000
DATUPTRS DS    CL20                                                     03589000
         ORG   DATUPTRS                                                 03590000
@NM00076 DC    AL4(DATUDDN)                                             03591000
@NM00077 DC    AL4(DATUDSN)                                             03592000
@NM00078 DC    AL4(DATUDSRG)                                            03593000
@NM00079 DC    AL4(DATUSTAT)                                            03594000
@NM00080 DC    X'80'                                                    03595000
@NM00081 DC    AL3(DATUDISP)                                            03596000
         ORG   DATUPTRS+20                                              03597000
DATUDDN  DS    CL14                                                     03598000
         DS    CL2                                                      03599000
DATUDSN  DS    CL19                                                     03600000
         DS    CL1                                                      03601000
DATUDSRG DS    CL8                                                      03602000
DATUSTAT DS    CL7                                                      03603000
         DS    CL1                                                      03604000
DATUDISP DS    CL7                                                      03605000
         DS    CL1                                                      03606000
ENQLST   DS    CL16                                                     03607000
         ORG   ENQLST                                                   03608000
ENQLST01 DC    A(0)                                                     03609000
ENQLST02 DS    CL12                                                     03610000
         ORG   ENQLST02+0                                               03611000
ENQLST03 DC    B'11000000'                                              03612000
ENQLST04 DC    AL1(13)                                                  03613000
ENQLST05 DC    B'01001011'                                              03614000
ENQLST55 DS    CL1                                                      03615000
ENQLST06 DC    AL4(@CC01363)                                            03616000
ENQLST07 DC    AL4(@CC01351)                                            03617000
         ORG   ENQLST+16                                                03618000
WTO01M   DS    CL84                                                     03619000
         ORG   WTO01M                                                   03620000
WTO01M01 DC    H'80'                                                    03621000
WTO01M02 DC    B'1000000000000000'                                      03622000
WTO01M03 DC    CL76'ILR001I XXXX - DYNAMIC ALLOCATION OF SYS1.STGINDEX C03623000
               FAILED, NO VIO JOURNALING'                               03624000
WTO01M04 DC    B'0001000000000000'                                      03625000
WTO01M05 DC    B'0100000001000000'                                      03626000
         ORG   WTO01M+84                                                03627000
WTO02M   DS    CL73                                                     03628000
         ORG   WTO02M                                                   03629000
WTO02M01 DC    H'69'                                                    03630000
WTO02M02 DC    B'1000000000000000'                                      03631000
WTO02M03 DC    CL65'ILR002I INITIALIZATION OF SYS1.STGINDEX FAILED, NO C03632000
               VIO JOURNALING'                                          03633000
WTO02M04 DC    B'0001000000000000'                                      03634000
WTO02M05 DC    B'0100000001000000'                                      03635000
         ORG   WTO02M+73                                                03636000
         DS    CL3                                                      03637000
WTO03M   DS    CL88                                                     03638000
         ORG   WTO03M                                                   03639000
WTO03M01 DC    AL1(1)                                                   03640000
WTO03M02 DC    AL3(REPLY)                                               03641000
WTO03M03 DC    AL4(WTORECB)                                             03642000
WTO03M04 DC    H'76'                                                    03643000
WTO03M05 DC    B'1000000000000000'                                      03644000
WTO03M06 DC    CL72'ILR003A WARM START FOR VIO FAILED. REPLY ''U'' TO IC03645000
               NVOKE CVIO PROCESSING'                                   03646000
WTO03M07 DC    B'1000000000000000'                                      03647000
WTO03M08 DC    B'1000000001000000'                                      03648000
         ORG   WTO03M+88                                                03649000
WTO04M   DS    CL80                                                     03650000
         ORG   WTO04M                                                   03651000
WTO04M01 DC    H'76'                                                    03652000
WTO04M02 DC    B'1000000000000000'                                      03653000
WTO04M03 DC    CL72'ILR004I ASM UNABLE TO BUILD DATA SET NAME LIST, PAGC03654000
               EADD COMMAND UNUSABLE'                                   03655000
WTO04M04 DC    B'0001000000000000'                                      03656000
WTO04M05 DC    B'0100000001000000'                                      03657000
         ORG   WTO04M+80                                                03658000
WTO20M   DS    CL72                                                     03659000
         ORG   WTO20M                                                   03660000
WTO20M01 DC    H'68'                                                    03661000
WTO20M02 DC    B'1000000000000000'                                      03662000
WTO20M03 DC    CL64'ILR020I ASM ENQ FOR SYS1.STGINDEX FAILED. CVIO REQUC03663000
               IRED NEXT IPL'                                           03664000
WTO20M04 DC    B'0001000000000000'                                      03665000
WTO20M05 DC    B'0100000001000000'                                      03666000
         ORG   WTO20M+72                                                03667000
WTO22M   DS    CL70                                                     03668000
         ORG   WTO22M                                                   03669000
WTO22M01 DC    AL1(1)                                                   03670000
WTO22M02 DC    AL3(REPLY)                                               03671000
WTO22M03 DC    AL4(WTORECB)                                             03672000
WTO22M04 DC    H'58'                                                    03673000
WTO22M05 DC    B'1000000000000000'                                      03674000
WTO22M06 DC    CL54'ILR022A REPLY ''U'' TO CONTINUE WITHOUT VIO JOURNALC03675000
               ING'                                                     03676000
WTO22M07 DC    B'1000000000000000'                                      03677000
WTO22M08 DC    B'1000000001000000'                                      03678000
         ORG   WTO22M+70                                                03679000
RC       DS    CL4                                                      03680000
STRIP    DC    X'0F0F0F0F'                                              03681000
CONVERT  DC    CL16'0123456789ABCDEF'                                   03682000
ILRTMI00 CSECT                                                          03683000
TMIPATCH DC    ((@DATA-@MAINENT)/19)X'00'                               03684000
         ORG   TMIPATCH                                                 03685000
         DC    C'MAINTENANCE AREA'                                      03686000
         DC    34X'00'                                                  03687000
         ORG                                                            03688000
ILRTMI00 CSECT                                                          03689000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03690000
@01      EQU   01                                                       03691000
@02      EQU   02                                                       03692000
@03      EQU   03                                                       03693000
@04      EQU   04                                                       03694000
@05      EQU   05                                                       03695000
@06      EQU   06                                                       03696000
@07      EQU   07                                                       03697000
@08      EQU   08                                                       03698000
@09      EQU   09                                                       03699000
@10      EQU   10                                                       03700000
@11      EQU   11                                                       03701000
@12      EQU   12                                                       03702000
@13      EQU   13                                                       03703000
@14      EQU   14                                                       03704000
@15      EQU   15                                                       03705000
RETRYFLG EQU   @02                                                      03706000
RETRYCNT EQU   @08                                                      03707000
LOCALCNT EQU   @09                                                      03708000
ENDPAT   EQU   @08                                                      03709000
DSNTOTAL EQU   @02                                                      03710000
DSNCNT   EQU   @08                                                      03711000
DSNLPTR  EQU   @07                                                      03712000
DSNEPTR  EQU   @06                                                      03713000
TPASPTR  EQU   @02                                                      03714000
TPAEPTR  EQU   @02                                                      03715000
PCTPTR   EQU   @10                                                      03716000
PATPTR   EQU   @02                                                      03717000
ASMVTPTR EQU   @03                                                      03718000
ASPCTPTR EQU   @07                                                      03719000
ASPEXPTR EQU   @07                                                      03720000
EPAPTR   EQU   @04                                                      03721000
ACBPTR   EQU   @05                                                      03722000
RPLPTR   EQU   @06                                                      03723000
ACBAREA@ EQU   @05                                                      03724000
IOBUFPTR EQU   @07                                                      03725000
RPLAREA@ EQU   @06                                                      03726000
BITINDEX EQU   @08                                                      03727000
CYLNUM   EQU   @15                                                      03728000
CYLSIZE  EQU   @00                                                      03729000
CLOSRTCD EQU   @15                                                      03730000
DYNARTCD EQU   @15                                                      03731000
ENQRTCD  EQU   @15                                                      03732000
FRMNRTCD EQU   @15                                                      03733000
GENRTCD  EQU   @15                                                      03734000
GETRTCD  EQU   @15                                                      03735000
GTMNRTCD EQU   @15                                                      03736000
MODRTCD  EQU   @15                                                      03737000
OPENRTCD EQU   @15                                                      03738000
PARTNUM  EQU   @14                                                      03739000
PRDRTCD  EQU   @15                                                      03740000
PUTRTCD  EQU   @15                                                      03741000
RECADDR  EQU   @14                                                      03742000
RECLEN   EQU   @15                                                      03743000
REMAIN   EQU   @14                                                      03744000
RETCODE  EQU   @15                                                      03745000
RSLOTNUM EQU   @15                                                      03746000
SRCADDR  EQU   @00                                                      03747000
SRCLEN   EQU   @01                                                      03748000
UPDTRTCD EQU   @15                                                      03749000
VERFRTCD EQU   @15                                                      03750000
WARMRTCD EQU   @15                                                      03751000
GPR00F   EQU   @00                                                      03752000
GPR01F   EQU   @01                                                      03753000
GPR15F   EQU   @15                                                      03754000
GPR00P   EQU   @00                                                      03755000
GPR01P   EQU   @01                                                      03756000
R0       EQU   @00                                                      03757000
R1       EQU   @01                                                      03758000
R2       EQU   @02                                                      03759000
R13      EQU   @13                                                      03760000
R14      EQU   @14                                                      03761000
R15      EQU   @15                                                      03762000
R10      EQU   @10                                                      03763000
R11      EQU   @11                                                      03764000
R12      EQU   @12                                                      03765000
R3       EQU   @03                                                      03766000
R4       EQU   @04                                                      03767000
R5       EQU   @05                                                      03768000
R6       EQU   @06                                                      03769000
R7       EQU   @07                                                      03770000
R8       EQU   @08                                                      03771000
R9       EQU   @09                                                      03772000
         ENTRY ILRCRTM2                                                 03773000
         ENTRY ILRCRTM3                                                 03774000
         ENTRY ILRCRTM4                                                 03775000
IFGACB   EQU   0                                                        03776000
ACBCOMN  EQU   IFGACB                                                   03777000
ACBLENG  EQU   ACBCOMN+2                                                03778000
ACBLENG2 EQU   ACBLENG                                                  03779000
ACBAMBL  EQU   ACBCOMN+4                                                03780000
ACBJWA   EQU   ACBAMBL                                                  03781000
ACBMACRF EQU   ACBCOMN+12                                               03782000
ACBMACR1 EQU   ACBMACRF                                                 03783000
ACBADR   EQU   ACBMACR1                                                 03784000
ACBCNV   EQU   ACBMACR1                                                 03785000
ACBMACR2 EQU   ACBMACRF+1                                               03786000
ACBBUFPL EQU   ACBCOMN+20                                               03787000
ACBMACR3 EQU   ACBBUFPL                                                 03788000
ACBRECFM EQU   ACBCOMN+24                                               03789000
ACBCCTYP EQU   ACBCOMN+25                                               03790000
ACBOPT   EQU   ACBCOMN+26                                               03791000
ACBDSORG EQU   ACBOPT                                                   03792000
ACBCROPS EQU   ACBDSORG                                                 03793000
ACBDVIND EQU   ACBDSORG                                                 03794000
ACBEXLST EQU   ACBCOMN+36                                               03795000
ACBDDNM  EQU   ACBCOMN+40                                               03796000
ACBAMETH EQU   ACBDDNM+3                                                03797000
ACBOFLGS EQU   ACBCOMN+48                                               03798000
ACBEXFG  EQU   ACBOFLGS                                                 03799000
ACBIOSFG EQU   ACBOFLGS                                                 03800000
ACBINFLG EQU   ACBCOMN+50                                               03801000
ACBVVIC  EQU   ACBINFLG                                                 03802000
ACBSDS   EQU   ACBVVIC                                                  03803000
ACBUJFCB EQU   ACBCOMN+52                                               03804000
ACBBLKSZ EQU   ACBCOMN+60                                               03805000
IDAAMB   EQU   0                                                        03806000
AMBDSB   EQU   IDAAMB+20                                                03807000
AMBEOVR  EQU   IDAAMB+24                                                03808000
AMBFLG0  EQU   AMBEOVR                                                  03809000
AMBFLG1  EQU   IDAAMB+25                                                03810000
AMBDSORG EQU   IDAAMB+26                                                03811000
AMBIOBAD EQU   IDAAMB+28                                                03812000
AMBINFL  EQU   IDAAMB+42                                                03813000
AMBDEBPT EQU   IDAAMB+44                                                03814000
AMBOFLGS EQU   IDAAMB+48                                                03815000
AMBFLG2  EQU   IDAAMB+49                                                03816000
AMBEOVPT EQU   IDAAMB+56                                                03817000
AMBCSWD1 EQU   IDAAMB+84                                                03818000
AMBAFLG  EQU   AMBCSWD1                                                 03819000
IDAAMBL  EQU   0                                                        03820000
AMBLEOV  EQU   IDAAMBL+12                                               03821000
AMBLEFLG EQU   AMBLEOV                                                  03822000
AMBLDDNM EQU   IDAAMBL+16                                               03823000
AMBLIDF  EQU   AMBLDDNM                                                 03824000
AMBLQ    EQU   AMBLIDF+7                                                03825000
AMBLVC   EQU   IDAAMBL+28                                               03826000
AMBLTYPE EQU   IDAAMBL+30                                               03827000
AMBLSHAR EQU   IDAAMBL+33                                               03828000
AMBLFLG1 EQU   IDAAMBL+35                                               03829000
AMBLVVIC EQU   AMBLFLG1                                                 03830000
AMBLFLG2 EQU   IDAAMBL+36                                               03831000
AMBLDTA  EQU   IDAAMBL+52                                               03832000
IDAAMDSB EQU   0                                                        03833000
AMDATTR  EQU   IDAAMDSB+1                                               03834000
AMDNEST  EQU   IDAAMDSB+4                                               03835000
AMDHLRBA EQU   IDAAMDSB+28                                              03836000
AMDSSRBA EQU   IDAAMDSB+32                                              03837000
AMDPARDB EQU   IDAAMDSB+36                                              03838000
AMDATTR3 EQU   IDAAMDSB+40                                              03839000
AMDSTAT  EQU   IDAAMDSB+48                                              03840000
IDAARDB  EQU   0                                                        03841000
ARDTYPE  EQU   IDAARDB+1                                                03842000
ARDERBA  EQU   IDAARDB+16                                               03843000
ARDPRF   EQU   IDAARDB+28                                               03844000
ASMVT    EQU   0                                                        03845000
ASMFLAG1 EQU   ASMVT                                                    03846000
ASMNOLCL EQU   ASMFLAG1                                                 03847000
ASMFLAG2 EQU   ASMVT+1                                                  03848000
ASMNOTMR EQU   ASMFLAG2                                                 03849000
ASMNOTPT EQU   ASMFLAG2                                                 03850000
ASMWARM  EQU   ASMFLAG2                                                 03851000
ASMSART  EQU   ASMVT+4                                                  03852000
ASMPART  EQU   ASMVT+8                                                  03853000
ASMSTAGQ EQU   ASMVT+32                                                 03854000
ASMPCCWQ EQU   ASMVT+64                                                 03855000
ASMBKSLT EQU   ASMVT+108                                                03856000
ASMVSC   EQU   ASMVT+116                                                03857000
ASMSLOTV EQU   ASMVT+128                                                03858000
ASMSTGXA EQU   ASMVT+136                                                03859000
ASMCINV  EQU   ASMVT+140                                                03860000
ASMLSAI  EQU   ASMVT+144                                                03861000
ASMLSAIL EQU   ASMLSAI                                                  03862000
ASMLSAIH EQU   ASMLSAI+4                                                03863000
ASMGOSQS EQU   ASMVT+152                                                03864000
ASMREQCT EQU   ASMVT+160                                                03865000
ASMPMSGS EQU   ASMVT+264                                                03866000
ASMWKSA1 EQU   ASMVT+368                                                03867000
ASMWKSA2 EQU   ASMVT+448                                                03868000
ASMWKSA3 EQU   ASMVT+528                                                03869000
ASMWKSA4 EQU   ASMVT+608                                                03870000
ASMWKSA5 EQU   ASMVT+688                                                03871000
ASMPOOLS EQU   0                                                        03872000
ASMCPAVQ EQU   ASMPOOLS+8                                               03873000
ASMCPRSQ EQU   ASMPOOLS+16                                              03874000
ASPCT    EQU   0                                                        03875000
ASPHDR   EQU   ASPCT                                                    03876000
ASPIDENT EQU   ASPHDR                                                   03877000
ASPBKEY  EQU   ASPHDR+8                                                 03878000
ASPSSYM  EQU   ASPBKEY                                                  03879000
ASPFLAG  EQU   ASPHDR+28                                                03880000
ASPMAXPN EQU   ASPHDR+32                                                03881000
ASPSAVCT EQU   ASPHDR+40                                                03882000
ASPLPMES EQU   ASPCT+64                                                 03883000
ASPEXTSN EQU   0                                                        03884000
ASPEHDR  EQU   ASPEXTSN                                                 03885000
ASPEIDNT EQU   ASPEHDR                                                  03886000
ASPEXKEY EQU   ASPEHDR+8                                                03887000
ASPSECTA EQU   ASPEXTSN+64                                              03888000
ASPLPME  EQU   0                                                        03889000
ASPLPFLG EQU   ASPLPME                                                  03890000
ASPVLSID EQU   ASPLPME+1                                                03891000
EPATH    EQU   0                                                        03892000
EPAVSAM  EQU   EPATH                                                    03893000
EPAVWKA  EQU   EPAVSAM+4                                                03894000
EPATMWKA EQU   EPAVWKA                                                  03895000
EPAAASP  EQU   EPAVSAM+8                                                03896000
EPADSLST EQU   EPAAASP                                                  03897000
EPABASP  EQU   EPAVSAM+12                                               03898000
EPATMIBA EQU   EPABASP                                                  03899000
EPARASP  EQU   EPAVSAM+16                                               03900000
EPATMACB EQU   EPARASP                                                  03901000
EPARTYRG EQU   EPAVSAM+20                                               03902000
EPABKSLT EQU   EPARTYRG                                                 03903000
EPATMISV EQU   EPABKSLT                                                 03904000
EPAFLAG1 EQU   EPAVSAM+24                                               03905000
EPAGRPOP EQU   EPAFLAG1                                                 03906000
EPAFLAG2 EQU   EPAVSAM+25                                               03907000
EPAWARM  EQU   EPAFLAG2                                                 03908000
EPACOLD  EQU   EPAFLAG2                                                 03909000
EPABUILD EQU   EPAFLAG2                                                 03910000
EPATMI   EQU   EPAFLAG2                                                 03911000
EPAACE   EQU   EPAVSAM+28                                               03912000
EPAABEND EQU   EPAVSAM+36                                               03913000
EPATMIRT EQU   EPAABEND                                                 03914000
EPATPART EQU   EPAVSAM+40                                               03915000
PART     EQU   0                                                        03916000
PARTHDR  EQU   PART                                                     03917000
PARTSIZE EQU   PARTHDR+4                                                03918000
PARTEUSE EQU   PARTHDR+8                                                03919000
PARTTPAR EQU   PARTHDR+24                                               03920000
PARTDSNL EQU   PARTTPAR                                                 03921000
PARTCOMQ EQU   PARTHDR+48                                               03922000
PARTSPLQ EQU   PARTHDR+56                                               03923000
PARTDUPQ EQU   PARTHDR+64                                               03924000
PARTLOCQ EQU   PARTHDR+72                                               03925000
PARTENTS EQU   PART+80                                                  03926000
PARTENT  EQU   0                                                        03927000
PARELKUP EQU   PARTENT+4                                                03928000
PARELKFL EQU   PARELKUP                                                 03929000
PARETYPE EQU   PARTENT+8                                                03930000
PAREFLG1 EQU   PARTENT+9                                                03931000
PARESZSL EQU   PARTENT+16                                               03932000
PARESLTA EQU   PARTENT+20                                               03933000
PAREPATP EQU   PARTENT+32                                               03934000
PAREPCTP EQU   PARTENT+36                                               03935000
PAT      EQU   0                                                        03936000
PATHDR   EQU   PAT                                                      03937000
PATCYLNO EQU   PATHDR+8                                                 03938000
PATCYLSZ EQU   PATHDR+10                                                03939000
PATCYLMW EQU   PATHDR+12                                                03940000
PATMAP   EQU   PAT+16                                                   03941000
PATCYLS  EQU   PATMAP                                                   03942000
PATCYLMP EQU   0                                                        03943000
PCT      EQU   0                                                        03944000
PCTDMASK EQU   PCT+20                                                   03945000
PCTABLE  EQU   PCT+40                                                   03946000
PCTSECT  EQU   PCTABLE                                                  03947000
PCTSLTNM EQU   PCTSECT                                                  03948000
IFGRPL   EQU   0                                                        03949000
RPLCOMN  EQU   IFGRPL                                                   03950000
RPLIDWD  EQU   RPLCOMN                                                  03951000
RPLLEN   EQU   RPLIDWD+3                                                03952000
RPLECB   EQU   RPLCOMN+8                                                03953000
RPLFDBWD EQU   RPLCOMN+12                                               03954000
RPLFDBK  EQU   RPLFDBWD+1                                               03955000
RPLRTNCD EQU   RPLFDBK                                                  03956000
RPLCNDCD EQU   RPLFDBK+1                                                03957000
RPLCMPON EQU   RPLCNDCD                                                 03958000
RPLFDB2  EQU   RPLCMPON                                                 03959000
RPLERRCD EQU   RPLCNDCD+1                                               03960000
RPLFDB3  EQU   RPLERRCD                                                 03961000
RPLKEYLE EQU   RPLCOMN+16                                               03962000
RPLARG   EQU   RPLCOMN+36                                               03963000
RPLOPTCD EQU   RPLCOMN+40                                               03964000
RPLOPT1  EQU   RPLOPTCD                                                 03965000
RPLECBSW EQU   RPLOPT1                                                  03966000
RPLOPT2  EQU   RPLOPTCD+1                                               03967000
RPLADR   EQU   RPLOPT2                                                  03968000
RPLOPT3  EQU   RPLOPTCD+2                                               03969000
RPLNXTRP EQU   RPLCOMN+44                                               03970000
RPLOPTC2 EQU   RPLCOMN+56                                               03971000
RPLOPT5  EQU   RPLOPTC2                                                 03972000
RPLWRTYP EQU   RPLOPT5                                                  03973000
RPLOPT6  EQU   RPLOPTC2+1                                               03974000
RPLUNTYP EQU   RPLOPT6                                                  03975000
RPLOPT7  EQU   RPLOPTC2+2                                               03976000
RPLCNOPT EQU   RPLOPT7                                                  03977000
RPLOPT8  EQU   RPLOPTC2+3                                               03978000
RPLRBAR  EQU   RPLCOMN+60                                               03979000
RPLAIXID EQU   RPLRBAR+2                                                03980000
RPLEXTDS EQU   RPLCOMN+68                                               03981000
RPLEXTD1 EQU   RPLEXTDS                                                 03982000
SART     EQU   0                                                        03983000
SARTHDR  EQU   SART                                                     03984000
SARSIZE  EQU   SARTHDR+4                                                03985000
SARUSE   EQU   SARTHDR+8                                                03986000
SARDSNL  EQU   SARTHDR+24                                               03987000
SARWAITQ EQU   SARTHDR+40                                               03988000
SARTE    EQU   0                                                        03989000
SREFLG   EQU   SARTE+9                                                  03990000
TPARTBLE EQU   0                                                        03991000
TPARHEAD EQU   TPARTBLE                                                 03992000
TPARFLAG EQU   TPARHEAD+8                                               03993000
TPARWARM EQU   TPARFLAG                                                 03994000
TPARTIME EQU   TPARHEAD+32                                              03995000
TPARPENT EQU   TPARTBLE+64                                              03996000
TPARSENT EQU   TPARTBLE+6208                                            03997000
TPARENT  EQU   0                                                        03998000
TPAESTAT EQU   TPARENT+2                                                03999000
TPAESKIP EQU   TPAESTAT                                                 04000000
TPAECLAS EQU   TPARENT+3                                                04001000
TPAEDSN  EQU   TPARENT+8                                                04002000
TPASENT  EQU   0                                                        04003000
TPASDSN  EQU   TPASENT+4                                                04004000
S99TUPL  EQU   0                                                        04005000
S99TUPTR EQU   S99TUPL                                                  04006000
S99TUP   EQU   0                                                        04007000
S99TUNIT EQU   0                                                        04008000
S99TUKEY EQU   S99TUNIT                                                 04009000
S99TUNUM EQU   S99TUNIT+2                                               04010000
S99TUENT EQU   S99TUNIT+4                                               04011000
S99TULNG EQU   S99TUENT                                                 04012000
S99TUPAR EQU   S99TUENT+2                                               04013000
S99TUFLD EQU   0                                                        04014000
DSNENTRY EQU   0                                                        04015000
GTMNAREA EQU   0                                                        04016000
ILRSLOTV EQU   0                                                        04017000
IOBUFFER EQU   0                                                        04018000
IOBTIME  EQU   IOBUFFER                                                 04019000
IOBKEY   EQU   IOBUFFER+8                                               04020000
ILRMSGSP EQU   0                                                        04021000
ILRPREAD EQU   0                                                        04022000
BITMMWRD EQU   0                                                        04023000
DSNLIST  EQU   0                                                        04024000
PATCYL   EQU   0                                                        04025000
ASM1WKSV EQU   ASMWKSA1                                                 04026000
ASM1RGSV EQU   ASM1WKSV                                                 04027000
ASM1WRKA EQU   ASM1WKSV+60                                              04028000
ASM2WKSV EQU   ASMWKSA2                                                 04029000
ASM2WRKA EQU   ASM2WKSV+52                                              04030000
ASM2FLGS EQU   ASM2WRKA+12                                              04031000
ASM3WKSV EQU   ASMWKSA3                                                 04032000
ASM4WKSV EQU   ASMWKSA4                                                 04033000
ASM4RGSV EQU   ASM4WKSV                                                 04034000
ASM5WKSV EQU   ASMWKSA5                                                 04035000
ASM5RGSV EQU   ASM5WKSV                                                 04036000
ASPASST  EQU   ASPSECTA                                                 04037000
PARTPTR  EQU   ASMPART                                                  04038000
SARTPTR  EQU   ASMSART                                                  04039000
AMBPTR   EQU   AMBLDTA                                                  04040000
AMBLPTR  EQU   ACBAMBL                                                  04041000
AMDSBPTR EQU   AMBDSB                                                   04042000
ARDBPTR  EQU   AMDPARDB                                                 04043000
ACBBAREA EQU   IFGACB                                                   04044000
RPLBAREA EQU   IFGRPL                                                   04045000
MSG01    EQU   WTO01M                                                   04046000
RTNCODE  EQU   MSG01+12                                                 04047000
ASPLPMEE EQU   ASPSECTA                                                 04048000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    04049000
@NM00083 EQU   MSG01+16                                                 04050000
@NM00082 EQU   MSG01                                                    04051000
ASPASSTE EQU   ASPASST                                                  04052000
ASM5FLGS EQU   ASM5WKSV+64                                              04053000
ASM5AIA  EQU   ASM5WKSV+60                                              04054000
ASM5GCTR EQU   ASM5WKSV+56                                              04055000
ASM5SR14 EQU   ASM5WKSV+52                                              04056000
@NM00038 EQU   ASM5RGSV+4                                               04057000
ASM5RG2  EQU   ASM5RGSV                                                 04058000
@NM00037 EQU   ASM4RGSV+4                                               04059000
ASM4RG2  EQU   ASM4RGSV                                                 04060000
ASM3SR13 EQU   ASM3WKSV+28                                              04061000
ASM3R14B EQU   ASM3WKSV+24                                              04062000
ASM3R14A EQU   ASM3WKSV+20                                              04063000
ASM3GRPA EQU   ASM3WKSV+16                                              04064000
ASM3TMPA EQU   ASM3WKSV+12                                              04065000
ASM3PIOP EQU   ASM3WKSV+8                                               04066000
ASM3GENQ EQU   ASM3WKSV+4                                               04067000
ASM3SWPQ EQU   ASM3WKSV                                                 04068000
ASM2SR14 EQU   ASM2WRKA+16                                              04069000
@NM00036 EQU   ASM2WRKA+13                                              04070000
ASM2WFLG EQU   ASM2FLGS                                                 04071000
ASM2RFLG EQU   ASM2FLGS                                                 04072000
ASM2DUPQ EQU   ASM2WRKA+8                                               04073000
ASM2CAQ  EQU   ASM2WRKA+4                                               04074000
ASM2PAQ  EQU   ASM2WRKA                                                 04075000
ASM2RGSV EQU   ASM2WKSV                                                 04076000
ASM1NXTA EQU   ASM1WRKA+4                                               04077000
ASM1ASCB EQU   ASM1WRKA                                                 04078000
ASM1RG15 EQU   ASM1RGSV+56                                              04079000
@NM00035 EQU   ASM1RGSV+4                                               04080000
ASM1RG1  EQU   ASM1RGSV                                                 04081000
@NM00074 EQU   IOBUFFER+20                                              04082000
S99TUPRM EQU   S99TUFLD+2                                               04083000
S99TULEN EQU   S99TUFLD                                                 04084000
S99TUPND EQU   S99TUP                                                   04085000
S99TUPLN EQU   S99TUPTR                                                 04086000
@NM00073 EQU   TPASENT+1                                                04087000
TPASFLAG EQU   TPASENT                                                  04088000
@NM00072 EQU   TPARENT+80                                               04089000
TPAEIORB EQU   TPARENT+76                                               04090000
TPAEPATP EQU   TPARENT+72                                               04091000
TPAEPATB EQU   TPARENT+68                                               04092000
TPAESZSL EQU   TPARENT+64                                               04093000
TPAEPCT  EQU   TPARENT+60                                               04094000
TPAEUCB  EQU   TPARENT+56                                               04095000
TPAEEDB  EQU   TPARENT+52                                               04096000
@NM00071 EQU   TPARENT+5                                                04097000
TPAEDSNL EQU   TPARENT+4                                                04098000
@NM00070 EQU   TPAECLAS                                                 04099000
TPAELOCL EQU   TPAECLAS                                                 04100000
TPAEDPLX EQU   TPAECLAS                                                 04101000
TPAECOMM EQU   TPAECLAS                                                 04102000
TPAEPLPA EQU   TPAECLAS                                                 04103000
@NM00069 EQU   TPAESTAT                                                 04104000
TPAEVALD EQU   TPAESTAT                                                 04105000
TPAEXPND EQU   TPAESTAT                                                 04106000
TPAEPRVI EQU   TPAESTAT                                                 04107000
TPAEPARM EQU   TPAESTAT                                                 04108000
TPAETYPE EQU   TPARENT                                                  04109000
@NM00068 EQU   TPARTBLE+8192                                            04110000
@NM00067 EQU   TPARTBLE+7408                                            04111000
@NM00066 EQU   TPARHEAD+40                                              04112000
@NM00065 EQU   TPARHEAD+28                                              04113000
TPARPCTQ EQU   TPARHEAD+24                                              04114000
TPAREXPD EQU   TPARHEAD+20                                              04115000
TPARNPGS EQU   TPARHEAD+16                                              04116000
TPARUSE  EQU   TPARHEAD+12                                              04117000
@NM00064 EQU   TPARHEAD+9                                               04118000
@NM00063 EQU   TPARFLAG                                                 04119000
TPARIDNT EQU   TPARHEAD                                                 04120000
SREUCB   EQU   SARTE+44                                                 04121000
SREEDB   EQU   SARTE+40                                                 04122000
SRESDCTE EQU   SARTE+36                                                 04123000
SRESAT   EQU   SARTE+32                                                 04124000
SREIORB  EQU   SARTE+28                                                 04125000
SRERRCNT EQU   SARTE+24                                                 04126000
SREAVLSL EQU   SARTE+20                                                 04127000
SRETOTSL EQU   SARTE+16                                                 04128000
SRESCCW  EQU   SARTE+12                                                 04129000
SRENN    EQU   SARTE+10                                                 04130000
@NM00062 EQU   SREFLG                                                   04131000
SREFIXED EQU   SREFLG                                                   04132000
SREDRIVE EQU   SREFLG                                                   04133000
SREDSBD  EQU   SREFLG                                                   04134000
SRENUSE  EQU   SREFLG                                                   04135000
@NM00061 EQU   SARTE+8                                                  04136000
SRELOCK  EQU   SARTE+4                                                  04137000
SRENEXT  EQU   SARTE                                                    04138000
SARENTS  EQU   SART+80                                                  04139000
@NM00060 EQU   SARTHDR+60                                               04140000
SARSETSZ EQU   SARTHDR+56                                               04141000
SARSRBCT EQU   SARTHDR+52                                               04142000
SARSRBP  EQU   SARTHDR+48                                               04143000
SARWAITL EQU   SARWAITQ+4                                               04144000
SARWAITF EQU   SARWAITQ                                                 04145000
SARSETCT EQU   SARTHDR+36                                               04146000
SARSCCWQ EQU   SARTHDR+32                                               04147000
SARSDCT  EQU   SARTHDR+28                                               04148000
SARMOVNX EQU   SARTHDR+20                                               04149000
SARFXDNX EQU   SARTHDR+16                                               04150000
@NM00059 EQU   SARTHDR+12                                               04151000
SARID    EQU   SARTHDR                                                  04152000
RPLERMSA EQU   RPLCOMN+72                                               04153000
RPLEMLEN EQU   RPLCOMN+70                                               04154000
RPLACTIV EQU   RPLCOMN+69                                               04155000
RPLBRANC EQU   RPLEXTD1                                                 04156000
RPLNIB   EQU   RPLEXTD1                                                 04157000
@NM00058 EQU   RPLEXTD1                                                 04158000
RPLEXIT  EQU   RPLEXTD1                                                 04159000
RPLNEXIT EQU   RPLEXTD1                                                 04160000
RPLEXSCH EQU   RPLEXTD1                                                 04161000
RPLDDDD  EQU   RPLRBAR+4                                                04162000
@NM00057 EQU   RPLRBAR+3                                                04163000
@NM00056 EQU   RPLAIXID                                                 04164000
RPLAXPKP EQU   RPLAIXID                                                 04165000
RPLAIXPC EQU   RPLRBAR                                                  04166000
RPLRSV88 EQU   RPLOPT8                                                  04167000
RPLUNCON EQU   RPLOPT8                                                  04168000
RPLACTV  EQU   RPLOPT8                                                  04169000
RPLSESS  EQU   RPLOPT8                                                  04170000
RPLPEND  EQU   RPLOPT8                                                  04171000
RPLODPRM EQU   RPLOPT8                                                  04172000
RPLODACP EQU   RPLOPT8                                                  04173000
RPLODACQ EQU   RPLOPT8                                                  04174000
RPLRSV78 EQU   RPLOPT7                                                  04175000
RPLRSV77 EQU   RPLOPT7                                                  04176000
RPLRLSOP EQU   RPLOPT7                                                  04177000
RPLTPOST EQU   RPLOPT7                                                  04178000
RPLQOPT  EQU   RPLOPT7                                                  04179000
RPLCNIMM EQU   RPLCNOPT                                                 04180000
RPLCNANY EQU   RPLCNOPT                                                 04181000
RPLCNALL EQU   RPLCNOPT                                                 04182000
RPLRSV68 EQU   RPLOPT6                                                  04183000
RPLRSV67 EQU   RPLOPT6                                                  04184000
RPLLOCK  EQU   RPLOPT6                                                  04185000
RPLNCOND EQU   RPLOPT6                                                  04186000
RPLCOND  EQU   RPLOPT6                                                  04187000
RPLEOT   EQU   RPLUNTYP                                                 04188000
RPLEOM   EQU   RPLUNTYP                                                 04189000
RPLEOB   EQU   RPLUNTYP                                                 04190000
RPLWROPT EQU   RPLOPT5                                                  04191000
RPLNODE  EQU   RPLOPT5                                                  04192000
RPLERACE EQU   RPLWRTYP                                                 04193000
RPLEAU   EQU   RPLWRTYP                                                 04194000
RPLNERAS EQU   RPLWRTYP                                                 04195000
RPLPSOPT EQU   RPLOPT5                                                  04196000
RPLSSNIN EQU   RPLOPT5                                                  04197000
RPLDLGIN EQU   RPLOPT5                                                  04198000
RPLBUFL  EQU   RPLCOMN+52                                               04199000
RPLRLEN  EQU   RPLCOMN+48                                               04200000
RPLCHAIN EQU   RPLNXTRP                                                 04201000
RPLOPT4  EQU   RPLOPTCD+3                                               04202000
RPLALIGN EQU   RPLOPT3                                                  04203000
RPLFMT   EQU   RPLOPT3                                                  04204000
RPLFLD   EQU   RPLOPT3                                                  04205000
RPLVFY   EQU   RPLOPT3                                                  04206000
RPLBLK   EQU   RPLOPT3                                                  04207000
RPLSFORM EQU   RPLOPT3                                                  04208000
RPLEODS  EQU   RPLOPT3                                                  04209000
RPLNSP   EQU   RPLOPT2                                                  04210000
RPLUPD   EQU   RPLOPT2                                                  04211000
@NM00055 EQU   RPLOPT2                                                  04212000
RPLLRD   EQU   RPLOPT2                                                  04213000
RPLBWD   EQU   RPLOPT2                                                  04214000
RPLCNV   EQU   RPLOPT2                                                  04215000
RPLADD   EQU   RPLADR                                                   04216000
RPLKEY   EQU   RPLOPT2                                                  04217000
RPLECBIN EQU   RPLECBSW                                                 04218000
RPLGEN   EQU   RPLOPT1                                                  04219000
RPLKGE   EQU   RPLOPT1                                                  04220000
RPLASY   EQU   RPLOPT1                                                  04221000
RPLSKP   EQU   RPLOPT1                                                  04222000
RPLSEQ   EQU   RPLOPT1                                                  04223000
RPLDIR   EQU   RPLOPT1                                                  04224000
RPLLOC   EQU   RPLOPT1                                                  04225000
RPLDAF   EQU   RPLARG+2                                                 04226000
RPLSAF   EQU   RPLARG                                                   04227000
RPLAREA  EQU   RPLCOMN+32                                               04228000
RPLTCBPT EQU   RPLCOMN+28                                               04229000
RPLDACB  EQU   RPLCOMN+24                                               04230000
RPLCCHAR EQU   RPLCOMN+20                                               04231000
RPLSTRID EQU   RPLCOMN+18                                               04232000
RPLKEYL  EQU   RPLKEYLE                                                 04233000
RPLRDSOH EQU   RPLFDB3                                                  04234000
RPLRLG   EQU   RPLFDB3                                                  04235000
RPLLGFRC EQU   RPLFDB3                                                  04236000
RPLREOT  EQU   RPLFDB3                                                  04237000
RPLREOM  EQU   RPLFDB3                                                  04238000
RPLREOB  EQU   RPLFDB3                                                  04239000
RPLSV32  EQU   RPLFDB3                                                  04240000
RPLUINPT EQU   RPLFDB3                                                  04241000
RPLSTSAV EQU   RPLFDB2                                                  04242000
RPLCUERR EQU   RPLFDB2                                                  04243000
RPLDLGFL EQU   RPLFDB2                                                  04244000
RPLIOERR EQU   RPLFDB2                                                  04245000
RPLDVUNS EQU   RPLFDB2                                                  04246000
RPLATND  EQU   RPLFDB2                                                  04247000
RPLRVID  EQU   RPLFDB2                                                  04248000
RPLERLK  EQU   RPLFDB2                                                  04249000
RPLERREG EQU   RPLRTNCD                                                 04250000
RPLSTAT  EQU   RPLFDBWD                                                 04251000
RPLPOST  EQU   RPLECB                                                   04252000
RPLWAIT  EQU   RPLECB                                                   04253000
RPLPLHPT EQU   RPLCOMN+4                                                04254000
RPLLEN2  EQU   RPLLEN                                                   04255000
RPLREQ   EQU   RPLIDWD+2                                                04256000
RPLSTYP  EQU   RPLIDWD+1                                                04257000
RPLID    EQU   RPLIDWD                                                  04258000
PCTTRBA  EQU   PCTSECT+2                                                04259000
PCTSECNM EQU   PCTSECT+1                                                04260000
PCTSLOT  EQU   PCTSLTNM                                                 04261000
PCTFOVFL EQU   PCTSLTNM                                                 04262000
PCTMSSB  EQU   PCT+38                                                   04263000
PCTMAXTK EQU   PCT+36                                                   04264000
PCTRQTIM EQU   PCT+32                                                   04265000
PCTSSECN EQU   PCT+30                                                   04266000
PCTDPGWT EQU   PCT+28                                                   04267000
PCTNEXT  EQU   PCT+16                                                   04268000
PCTCYLSZ EQU   PCT+14                                                   04269000
PCTDTYPX EQU   PCT+12                                                   04270000
PCTSMAX  EQU   PCT+10                                                   04271000
PCTDTYPE EQU   PCT+4                                                    04272000
PCTID    EQU   PCT                                                      04273000
PATRSV1  EQU   PATHDR+14                                                04274000
PATPART  EQU   PATHDR+4                                                 04275000
PATIDENT EQU   PATHDR                                                   04276000
@NM00054 EQU   PARTENT+62                                               04277000
PARELCYL EQU   PARTENT+60                                               04278000
PARERQTM EQU   PARTENT+56                                               04279000
PAREWTQE EQU   PARTENT+52                                               04280000
PARENODE EQU   PARTENT+48                                               04281000
PAREUCBP EQU   PARTENT+44                                               04282000
PAREEDBP EQU   PARTENT+40                                               04283000
PAREIORB EQU   PARTENT+28                                               04284000
PARERRCT EQU   PARTENT+24                                               04285000
PAREIOEQ EQU   PARTENT+12                                               04286000
PARENN   EQU   PARTENT+10                                               04287000
@NM00053 EQU   PAREFLG1                                                 04288000
PAREINCP EQU   PAREFLG1                                                 04289000
PAREDSBD EQU   PAREFLG1                                                 04290000
PARENUSE EQU   PAREFLG1                                                 04291000
@NM00052 EQU   PARETYPE                                                 04292000
PARELOCL EQU   PARETYPE                                                 04293000
PAREDPLX EQU   PARETYPE                                                 04294000
PARECOMM EQU   PARETYPE                                                 04295000
PAREPLPA EQU   PARETYPE                                                 04296000
PARECPCT EQU   PARELKUP+2                                               04297000
PAREIORN EQU   PARELKUP+1                                               04298000
@NM00051 EQU   PARELKFL                                                 04299000
PAREFSIP EQU   PARELKFL                                                 04300000
PAREPARE EQU   PARTENT                                                  04301000
PARTLOCL EQU   PARTLOCQ+4                                               04302000
PARTLOCF EQU   PARTLOCQ                                                 04303000
PARTDUPL EQU   PARTDUPQ+4                                               04304000
PARTDUPF EQU   PARTDUPQ                                                 04305000
PARTSPLL EQU   PARTSPLQ+4                                               04306000
PARTSPLF EQU   PARTSPLQ                                                 04307000
PARTCOML EQU   PARTCOMQ+4                                               04308000
PARTCOMF EQU   PARTCOMQ                                                 04309000
PARTLOCK EQU   PARTHDR+44                                               04310000
PARTLKUP EQU   PARTHDR+40                                               04311000
@NM00050 EQU   PARTHDR+34                                               04312000
PARTLCNT EQU   PARTHDR+32                                               04313000
PARTPCTQ EQU   PARTHDR+28                                               04314000
PARTCIR2 EQU   PARTHDR+20                                               04315000
PARTCIR1 EQU   PARTHDR+16                                               04316000
PARTAIAE EQU   PARTHDR+12                                               04317000
PARTIDEN EQU   PARTHDR                                                  04318000
EPATMRSV EQU   EPAVSAM+32                                               04319000
EPAMSECB EQU   EPAACE                                                   04320000
@NM00049 EQU   EPAVSAM+26                                               04321000
@NM00048 EQU   EPAFLAG2                                                 04322000
EPARECUR EQU   EPAFLAG2                                                 04323000
EPAMAST  EQU   EPAFLAG2                                                 04324000
EPATMXIT EQU   EPAFLAG2                                                 04325000
EPARPLB  EQU   EPAFLAG1                                                 04326000
EPAUNSAV EQU   EPAFLAG1                                                 04327000
EPAASGN  EQU   EPAFLAG1                                                 04328000
EPAACASR EQU   EPAFLAG1                                                 04329000
EPAACT   EQU   EPAGRPOP                                                 04330000
EPASAVE  EQU   EPAGRPOP                                                 04331000
EPARLG   EQU   EPAGRPOP                                                 04332000
EPAVSAMI EQU   EPAFLAG1                                                 04333000
EPASWKA  EQU   EPATMWKA                                                 04334000
EPAOWKA  EQU   EPAVSAM                                                  04335000
ASPSLOT  EQU   ASPVLSID+1                                               04336000
ASPPRTNN EQU   ASPVLSID                                                 04337000
@NM00047 EQU   ASPLPFLG                                                 04338000
ASPLSVRP EQU   ASPLPFLG                                                 04339000
ASPLIOER EQU   ASPLPFLG                                                 04340000
ASPLOPIN EQU   ASPLPFLG                                                 04341000
ASPLSAVE EQU   ASPLPFLG                                                 04342000
ASPLVALD EQU   ASPLPFLG                                                 04343000
@NM00046 EQU   ASPEXTSN+1088                                            04344000
@NM00045 EQU   ASPEHDR+24                                               04345000
ASPASSTI EQU   ASPEHDR+22                                               04346000
@NM00044 EQU   ASPEHDR+21                                               04347000
ASPASSTN EQU   ASPEHDR+20                                               04348000
ASPEXTNM EQU   ASPEXKEY+8                                               04349000
ASPESSYM EQU   ASPEXKEY                                                 04350000
@NM00043 EQU   ASPEHDR+4                                                04351000
@NM00042 EQU   ASPCT+1088                                               04352000
ASPASSTP EQU   ASPCT+48                                                 04353000
ASPAEXCT EQU   ASPHDR+46                                                04354000
ASPLEXCT EQU   ASPHDR+44                                                04355000
ASPBKSLT EQU   ASPHDR+36                                                04356000
@NM00041 EQU   ASPHDR+29                                                04357000
@NM00040 EQU   ASPFLAG                                                  04358000
ASPSAVRP EQU   ASPFLAG                                                  04359000
ASPSAVED EQU   ASPFLAG                                                  04360000
ASPLGE   EQU   ASPHDR+24                                                04361000
ASPASCB  EQU   ASPHDR+20                                                04362000
@NM00039 EQU   ASPBKEY+8                                                04363000
ASPLGID  EQU   ASPHDR+4                                                 04364000
ASMCPRES EQU   ASMCPRSQ+4                                               04365000
ASMCPTAK EQU   ASMCPRSQ                                                 04366000
ASMCPCNT EQU   ASMCPAVQ+4                                               04367000
ASMCPAVL EQU   ASMCPAVQ                                                 04368000
ASMCPEXT EQU   ASMPOOLS+6                                               04369000
ASMCPSIZ EQU   ASMPOOLS+4                                               04370000
ASMCPID  EQU   ASMPOOLS                                                 04371000
ASMRSV12 EQU   ASMVT+1000                                               04372000
ASMSAVE  EQU   ASMVT+928                                                04373000
ASMWKSA7 EQU   ASMVT+848                                                04374000
ASMWKSA6 EQU   ASMVT+768                                                04375000
ASMACEPC EQU   ASMVT+344                                                04376000
ASMSWKPC EQU   ASMVT+328                                                04377000
ASMBWKPC EQU   ASMVT+312                                                04378000
ASMIOEPC EQU   ASMVT+296                                                04379000
ASMRSV10 EQU   ASMVT+280                                                04380000
ASMPVACE EQU   ASMVT+276                                                04381000
ASMPIOFR EQU   ASMVT+272                                                04382000
ASMPVACQ EQU   ASMVT+268                                                04383000
ASMPMSG0 EQU   ASMVT+260                                                04384000
ASMPFRLG EQU   ASMVT+256                                                04385000
ASMPRLG  EQU   ASMVT+252                                                04386000
ASMPACT  EQU   ASMVT+248                                                04387000
ASMPSAV  EQU   ASMVT+244                                                04388000
ASMPCMP  EQU   ASMVT+240                                                04389000
ASMPCMPA EQU   ASMVT+236                                                04390000
ASMPCMPN EQU   ASMVT+232                                                04391000
ASMPCMPD EQU   ASMVT+228                                                04392000
ASMPEX   EQU   ASMVT+224                                                04393000
ASMVRMTR EQU   ASMVT+220                                                04394000
ASMPSRBC EQU   ASMVT+216                                                04395000
ASMPSRMT EQU   ASMVT+212                                                04396000
ASMPSWPD EQU   ASMVT+208                                                04397000
ASMPTM   EQU   ASMVT+204                                                04398000
ASMPFRSW EQU   ASMVT+200                                                04399000
ASMPFRSL EQU   ASMVT+196                                                04400000
ASMPQIOE EQU   ASMVT+192                                                04401000
ASMRSV8  EQU   ASMVT+188                                                04402000
ASMVSAMW EQU   ASMVT+184                                                04403000
ASMTASCB EQU   ASMVT+180                                                04404000
ASMRLGWQ EQU   ASMVT+176                                                04405000
ASMRLGRQ EQU   ASMVT+172                                                04406000
ASMTMECB EQU   ASMVT+168                                                04407000
ASMTCBPT EQU   ASMVT+164                                                04408000
ASMGOSWK EQU   ASMGOSQS+4                                               04409000
ASMGOSWT EQU   ASMGOSQS                                                 04410000
ASMLGVT  EQU   ASMVT+132                                                04411000
ASMERRS  EQU   ASMVT+124                                                04412000
ASMNVSC  EQU   ASMVT+120                                                04413000
ASMSLOTS EQU   ASMVT+112                                                04414000
ASMRSV7  EQU   ASMVT+92                                                 04415000
ASMPSRB  EQU   ASMVT+88                                                 04416000
ASMSRBCT EQU   ASMVT+84                                                 04417000
ASMIOCNT EQU   ASMVT+80                                                 04418000
ASMBURST EQU   ASMVT+76                                                 04419000
ASMPCCWN EQU   ASMVT+72                                                 04420000
ASMPCCWC EQU   ASMPCCWQ+4                                               04421000
ASMPCCWA EQU   ASMPCCWQ                                                 04422000
ASMRSV6  EQU   ASMVT+48                                                 04423000
ASMIORQC EQU   ASMVT+44                                                 04424000
ASMIORQR EQU   ASMVT+40                                                 04425000
ASMSTAGL EQU   ASMSTAGQ+4                                               04426000
ASMSTAGF EQU   ASMSTAGQ                                                 04427000
ASMRSV5  EQU   ASMVT+28                                                 04428000
ASMMSGBF EQU   ASMVT+24                                                 04429000
ASMEREC  EQU   ASMVT+20                                                 04430000
ASMTRPAG EQU   ASMVT+16                                                 04431000
ASMGOS   EQU   ASMVT+12                                                 04432000
ASMDSSFS EQU   ASMVT+2                                                  04433000
ASMQUICK EQU   ASMFLAG2                                                 04434000
ASMNOSAV EQU   ASMFLAG2                                                 04435000
ASMCALLQ EQU   ASMFLAG2                                                 04436000
ASMPLPAS EQU   ASMFLAG1                                                 04437000
ASMCOMMF EQU   ASMFLAG1                                                 04438000
ASMPLPAF EQU   ASMFLAG1                                                 04439000
ASMNODPX EQU   ASMFLAG1                                                 04440000
ASMRSV1  EQU   ASMFLAG1                                                 04441000
ASMNOCWQ EQU   ASMFLAG1                                                 04442000
ASMDUPLX EQU   ASMFLAG1                                                 04443000
ARDKEYS  EQU   IDAARDB+29                                               04444000
@NM00034 EQU   ARDPRF                                                   04445000
ARDPRFMT EQU   ARDPRF                                                   04446000
ARDPRSS  EQU   ARDPRF                                                   04447000
ARDRELNO EQU   IDAARDB+26                                               04448000
ARDVOLSR EQU   IDAARDB+20                                               04449000
ARDHRBA  EQU   IDAARDB+12                                               04450000
ARDHKRBA EQU   IDAARDB+8                                                04451000
ARDNPTR  EQU   IDAARDB+4                                                04452000
ARDLEN   EQU   IDAARDB+2                                                04453000
ARDUSED  EQU   ARDTYPE                                                  04454000
ARDEOD   EQU   ARDTYPE                                                  04455000
ARDUOVFL EQU   ARDTYPE                                                  04456000
ARDSS    EQU   ARDTYPE                                                  04457000
ARDHLI   EQU   ARDTYPE                                                  04458000
ARDKR    EQU   ARDTYPE                                                  04459000
ARDID    EQU   IDAARDB                                                  04460000
AMDEXCP  EQU   AMDSTAT+44                                               04461000
AMDNCAS  EQU   AMDSTAT+40                                               04462000
AMDNCIS  EQU   AMDSTAT+36                                               04463000
AMDASPA  EQU   AMDSTAT+32                                               04464000
AMDRETR  EQU   AMDSTAT+28                                               04465000
AMDUPR   EQU   AMDSTAT+24                                               04466000
AMDIREC  EQU   AMDSTAT+20                                               04467000
AMDDELR  EQU   AMDSTAT+16                                               04468000
AMDNLR   EQU   AMDSTAT+12                                               04469000
AMDNEXT  EQU   AMDSTAT+10                                               04470000
AMDNIL   EQU   AMDSTAT+8                                                04471000
AMDSTSP  EQU   AMDSTAT                                                  04472000
@NM00033 EQU   IDAAMDSB+41                                              04473000
@NM00032 EQU   AMDATTR3                                                 04474000
AMDLM    EQU   AMDATTR3                                                 04475000
AMDWAIT  EQU   AMDATTR3                                                 04476000
AMDBIND  EQU   AMDATTR3                                                 04477000
AMDFAULT EQU   AMDATTR3                                                 04478000
AMDUNQ   EQU   AMDATTR3                                                 04479000
AMDMAXRR EQU   AMDSSRBA                                                 04480000
AMDNSLOT EQU   AMDHLRBA                                                 04481000
AMDLRECL EQU   IDAAMDSB+24                                              04482000
AMDCINV  EQU   IDAAMDSB+20                                              04483000
AMDFSCI  EQU   IDAAMDSB+16                                              04484000
AMDFSCA  EQU   IDAAMDSB+14                                              04485000
AMDCIPCA EQU   IDAAMDSB+12                                              04486000
AMDPCTCI EQU   IDAAMDSB+11                                              04487000
AMDPCTCA EQU   IDAAMDSB+10                                              04488000
AMDKEYLN EQU   IDAAMDSB+8                                               04489000
AMDRKP   EQU   IDAAMDSB+6                                               04490000
AMDAXRKP EQU   AMDNEST                                                  04491000
AMDLEN   EQU   IDAAMDSB+2                                               04492000
AMDSPAN  EQU   AMDATTR                                                  04493000
AMDRRDS  EQU   AMDATTR                                                  04494000
AMDRANGE EQU   AMDATTR                                                  04495000
AMDORDER EQU   AMDATTR                                                  04496000
AMDREPL  EQU   AMDATTR                                                  04497000
AMDSDT   EQU   AMDATTR                                                  04498000
AMDWCK   EQU   AMDATTR                                                  04499000
AMDDST   EQU   AMDATTR                                                  04500000
AMDSBID  EQU   IDAAMDSB                                                 04501000
AMBLCMB  EQU   IDAAMBL+64                                               04502000
AMBLBIB  EQU   IDAAMBL+60                                               04503000
AMBLIX   EQU   IDAAMBL+56                                               04504000
AMBLMIDS EQU   IDAAMBL+42                                               04505000
AMBLNIDS EQU   IDAAMBL+41                                               04506000
@NM00031 EQU   IDAAMBL+40                                               04507000
AMBLNUM  EQU   IDAAMBL+38                                               04508000
AMBLNST  EQU   IDAAMBL+37                                               04509000
@NM00030 EQU   AMBLFLG2                                                 04510000
AMBLSTAG EQU   AMBLFLG2                                                 04511000
@NM00029 EQU   AMBLFLG2                                                 04512000
AMBLDUMY EQU   AMBLFLG1                                                 04513000
AMBLCAT  EQU   AMBLFLG1                                                 04514000
AMBLUCRA EQU   AMBLFLG1                                                 04515000
AMBLSCRA EQU   AMBLFLG1                                                 04516000
AMBLSDS  EQU   AMBLVVIC                                                 04517000
AMBLUPD  EQU   AMBLFLG1                                                 04518000
AMBLCINV EQU   AMBLFLG1                                                 04519000
AMBLFULL EQU   AMBLFLG1                                                 04520000
AMBLLEN  EQU   IDAAMBL+34                                               04521000
@NM00028 EQU   AMBLSHAR                                                 04522000
AMBLWRIT EQU   AMBLSHAR                                                 04523000
AMBLCATO EQU   AMBLSHAR                                                 04524000
AMBLPRIM EQU   AMBLSHAR                                                 04525000
AMBLID   EQU   IDAAMBL+32                                               04526000
@NM00027 EQU   IDAAMBL+31                                               04527000
@NM00026 EQU   AMBLTYPE                                                 04528000
AMBLFIX  EQU   AMBLTYPE                                                 04529000
AMBLBASE EQU   AMBLTYPE                                                 04530000
AMBLAIX  EQU   AMBLTYPE                                                 04531000
AMBLUPGR EQU   AMBLTYPE                                                 04532000
AMBLPATH EQU   AMBLTYPE                                                 04533000
AMBLENO  EQU   AMBLVC+1                                                 04534000
AMBLVRT  EQU   AMBLVC                                                   04535000
AMBLXPT  EQU   IDAAMBL+24                                               04536000
AMBLDFR  EQU   AMBLQ                                                    04537000
AMBLESDS EQU   AMBLQ                                                    04538000
AMBLKSDS EQU   AMBLQ                                                    04539000
AMBLUBF  EQU   AMBLQ                                                    04540000
AMBLFSTP EQU   AMBLQ                                                    04541000
AMBLLSR  EQU   AMBLQ                                                    04542000
AMBLGSR  EQU   AMBLQ                                                    04543000
AMBLDDC  EQU   AMBLQ                                                    04544000
AMBLDCI  EQU   AMBLIDF+4                                                04545000
AMBLCACB EQU   AMBLIDF                                                  04546000
@NM00025 EQU   AMBLEOV+2                                                04547000
AMBLCOMP EQU   AMBLEOV+1                                                04548000
AMBLESET EQU   AMBLEFLG                                                 04549000
AMBLWAIT EQU   AMBLEFLG                                                 04550000
AMBLACB  EQU   IDAAMBL+8                                                04551000
AMBLSCHN EQU   IDAAMBL+4                                                04552000
AMBLPCHN EQU   IDAAMBL                                                  04553000
AMBVIOT  EQU   IDAAMB+116                                               04554000
AMBSZCP  EQU   IDAAMB+114                                               04555000
AMBSZFW  EQU   IDAAMB+112                                               04556000
AMBSZWR  EQU   IDAAMB+110                                               04557000
AMBSZRD  EQU   IDAAMB+108                                               04558000
AMBEXEX  EQU   IDAAMB+100                                               04559000
AMBWSHD  EQU   IDAAMB+96                                                04560000
AMBCPA   EQU   IDAAMB+92                                                04561000
AMBBM2SH EQU   IDAAMB+88                                                04562000
AMBRDCNT EQU   AMBCSWD1+2                                               04563000
@NM00024 EQU   AMBCSWD1+1                                               04564000
@NM00023 EQU   AMBAFLG                                                  04565000
AMBCFX   EQU   AMBAFLG                                                  04566000
AMBSIS   EQU   AMBAFLG                                                  04567000
AMBDFR   EQU   AMBAFLG                                                  04568000
AMBICI   EQU   AMBAFLG                                                  04569000
AMBGSR   EQU   AMBAFLG                                                  04570000
AMBLSR   EQU   AMBAFLG                                                  04571000
@NM00022 EQU   AMBAFLG                                                  04572000
AMBUPLH  EQU   IDAAMB+80                                                04573000
AMBPAMBL EQU   IDAAMB+76                                                04574000
AMBPIXP  EQU   IDAAMB+72                                                04575000
@NM00021 EQU   IDAAMB+68                                                04576000
AMBIWA   EQU   IDAAMB+64                                                04577000
AMBWKA   EQU   IDAAMB+60                                                04578000
AMBAMBXN EQU   AMBEOVPT                                                 04579000
AMBEDB   EQU   IDAAMB+52                                                04580000
AMBRPT   EQU   IDAAMB+50                                                04581000
AMBPUG   EQU   AMBFLG2                                                  04582000
AMBBUSY  EQU   AMBOFLGS                                                 04583000
AMBEXFG  EQU   AMBOFLGS                                                 04584000
@NM00020 EQU   AMBOFLGS                                                 04585000
AMBOPEN  EQU   AMBOFLGS                                                 04586000
@NM00019 EQU   AMBOFLGS                                                 04587000
AMBDEBAD EQU   AMBDEBPT+1                                               04588000
AMBIFLGS EQU   AMBDEBPT                                                 04589000
AMBAMETH EQU   IDAAMB+43                                                04590000
AMBSDS   EQU   AMBINFL                                                  04591000
AMBUPX   EQU   AMBINFL                                                  04592000
AMBUCRA  EQU   AMBINFL                                                  04593000
AMBSCRA  EQU   AMBINFL                                                  04594000
AMBCAT   EQU   AMBINFL                                                  04595000
@NM00018 EQU   AMBINFL                                                  04596000
@NM00017 EQU   AMBINFL                                                  04597000
AMBTIOT  EQU   IDAAMB+40                                                04598000
@NM00016 EQU   IDAAMB+38                                                04599000
AMBDDSN  EQU   IDAAMB+35                                                04600000
AMBCDSN  EQU   IDAAMB+32                                                04601000
AMBIOMB  EQU   AMBIOBAD                                                 04602000
@NM00015 EQU   AMBDSORG+1                                               04603000
AMBDORGA EQU   AMBDSORG+1                                               04604000
@NM00014 EQU   AMBDSORG                                                 04605000
AMBINBUF EQU   AMBFLG1                                                  04606000
AMBJRN   EQU   AMBFLG1                                                  04607000
AMBUBF   EQU   AMBFLG1                                                  04608000
AMBSPEED EQU   AMBFLG1                                                  04609000
AMBPCAT  EQU   AMBFLG1                                                  04610000
AMBMCAT  EQU   AMBFLG1                                                  04611000
AMBTYPE  EQU   AMBFLG1                                                  04612000
AMBCREAT EQU   AMBFLG1                                                  04613000
@NM00013 EQU   AMBFLG0                                                  04614000
AMBSWSP  EQU   AMBFLG0                                                  04615000
AMBPSDS  EQU   AMBFLG0                                                  04616000
AMBCACB  EQU   IDAAMB+16                                                04617000
AMBPH    EQU   IDAAMB+12                                                04618000
AMBBUFC  EQU   IDAAMB+8                                                 04619000
AMBLINK  EQU   IDAAMB+4                                                 04620000
AMBLEN   EQU   IDAAMB+2                                                 04621000
AMBRSC   EQU   IDAAMB+1                                                 04622000
AMBID    EQU   IDAAMB                                                   04623000
ACBAPID  EQU   ACBCOMN+72                                               04624000
ACBCBMWA EQU   ACBCOMN+68                                               04625000
ACBUAPTR EQU   ACBCOMN+64                                               04626000
ACBLRECL EQU   ACBCOMN+62                                               04627000
ACBMSGLN EQU   ACBBLKSZ                                                 04628000
ACBBUFSP EQU   ACBCOMN+56                                               04629000
@NM00012 EQU   ACBUJFCB+1                                               04630000
ACBOPTN  EQU   ACBUJFCB                                                 04631000
@NM00011 EQU   ACBINFLG+1                                               04632000
ACBBYPSS EQU   ACBINFLG                                                 04633000
ACBUCRA  EQU   ACBINFLG                                                 04634000
ACBSCRA  EQU   ACBINFLG                                                 04635000
ACBCAT   EQU   ACBINFLG                                                 04636000
ACBIJRQE EQU   ACBINFLG                                                 04637000
ACBJEPS  EQU   ACBINFLG                                                 04638000
@NM00010 EQU   ACBINFLG                                                 04639000
ACBERFLG EQU   ACBCOMN+49                                               04640000
ACBBUSY  EQU   ACBIOSFG                                                 04641000
ACBLOCK  EQU   ACBEXFG                                                  04642000
@NM00009 EQU   ACBOFLGS                                                 04643000
ACBDSERR EQU   ACBOFLGS                                                 04644000
ACBOPEN  EQU   ACBOFLGS                                                 04645000
ACBEOV   EQU   ACBOFLGS                                                 04646000
@NM00008 EQU   ACBOFLGS                                                 04647000
ACBDEB   EQU   ACBDDNM+5                                                04648000
ACBERFL  EQU   ACBDDNM+4                                                04649000
ACBAM    EQU   ACBAMETH                                                 04650000
ACBINFL  EQU   ACBDDNM+2                                                04651000
ACBTIOT  EQU   ACBDDNM                                                  04652000
ACBUEL   EQU   ACBEXLST                                                 04653000
ACBPASSW EQU   ACBCOMN+32                                               04654000
ACBMSGAR EQU   ACBCOMN+28                                               04655000
@NM00007 EQU   ACBDSORG+1                                               04656000
ACBDORGA EQU   ACBDSORG+1                                               04657000
@NM00006 EQU   ACBDSORG                                                 04658000
ACBOPTJ  EQU   ACBDVIND                                                 04659000
ACBCRNRE EQU   ACBCROPS                                                 04660000
ACBCRNCK EQU   ACBCROPS                                                 04661000
ACBASA   EQU   ACBCCTYP                                                 04662000
@NM00005 EQU   ACBCCTYP                                                 04663000
ACBTRCID EQU   ACBCCTYP                                                 04664000
@NM00004 EQU   ACBRECFM                                                 04665000
ACBRECAF EQU   ACBRECFM                                                 04666000
ACBJBUF  EQU   ACBBUFPL+2                                               04667000
ACBMACR4 EQU   ACBBUFPL+1                                               04668000
@NM00003 EQU   ACBMACR3                                                 04669000
ACBNCFX  EQU   ACBMACR3                                                 04670000
ACBSIS   EQU   ACBMACR3                                                 04671000
ACBDFR   EQU   ACBMACR3                                                 04672000
ACBICI   EQU   ACBMACR3                                                 04673000
ACBGSR   EQU   ACBMACR3                                                 04674000
ACBLSR   EQU   ACBMACR3                                                 04675000
@NM00002 EQU   ACBMACR3                                                 04676000
ACBBUFNI EQU   ACBCOMN+18                                               04677000
ACBBUFND EQU   ACBCOMN+16                                               04678000
ACBSTRNO EQU   ACBCOMN+15                                               04679000
ACBBSTNO EQU   ACBCOMN+14                                               04680000
ACBAIX   EQU   ACBMACR2                                                 04681000
ACBDSN   EQU   ACBMACR2                                                 04682000
ACBRST   EQU   ACBMACR2                                                 04683000
ACBLOGON EQU   ACBMACR2                                                 04684000
ACBSKP   EQU   ACBMACR2                                                 04685000
@NM00001 EQU   ACBMACR2                                                 04686000
ACBUBF   EQU   ACBMACR1                                                 04687000
ACBOUT   EQU   ACBMACR1                                                 04688000
ACBIN    EQU   ACBMACR1                                                 04689000
ACBDIR   EQU   ACBMACR1                                                 04690000
ACBSEQ   EQU   ACBMACR1                                                 04691000
ACBBLK   EQU   ACBCNV                                                   04692000
ACBADD   EQU   ACBADR                                                   04693000
ACBKEY   EQU   ACBMACR1                                                 04694000
ACBINRTN EQU   ACBCOMN+8                                                04695000
ACBIBCT  EQU   ACBJWA                                                   04696000
ACBLEN2  EQU   ACBLENG2                                                 04697000
ACBSTYP  EQU   ACBCOMN+1                                                04698000
ACBID    EQU   ACBCOMN                                                  04699000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04700000
@RT00370 EQU   WARMERR                                                  04701000
@RF00389 EQU   WARMERR                                                  04702000
@RT00399 EQU   WARMERR                                                  04703000
@RT00404 EQU   WARMERR                                                  04704000
@RT00409 EQU   WARMERR                                                  04705000
@RT00422 EQU   WARMERR                                                  04706000
@RF00430 EQU   WARMERR                                                  04707000
@RT00435 EQU   WARMERR                                                  04708000
@RT00441 EQU   WARMERR                                                  04709000
@RT00463 EQU   WARMERR                                                  04710000
@RT00471 EQU   UPDTCNTS                                                 04711000
@RF00475 EQU   WARMERR                                                  04712000
@RT00494 EQU   WARMERR                                                  04713000
@RT00685 EQU   CVIOERR                                                  04714000
@RF00704 EQU   CVIOERR                                                  04715000
@RT00716 EQU   CVIOERR                                                  04716000
@RT00729 EQU   CVIOERR                                                  04717000
@RF00737 EQU   CVIOERR                                                  04718000
@RF00758 EQU   CVIOERR                                                  04719000
@RT00765 EQU   CVIOERR                                                  04720000
@RF00783 EQU   CVIOERR                                                  04721000
@RF00867 EQU   @RC00845                                                 04722000
@ENDDATA EQU   *                                                        04723000
         END   ILRTMI00,(C'PLS0933',0701,77325)                         04724000
