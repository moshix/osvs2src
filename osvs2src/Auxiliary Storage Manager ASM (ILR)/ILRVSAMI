         TITLE 'ILRVSAMI, VSAM INTERFACE                               *00001000
                        '                                               00002000
ILRVSAMI CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ILRVSAMI  76.087'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @10,0                                               0001 00011000
@PSTART  LA    @06,4095(,@10)                                      0001 00012000
         USING @PSTART,@10                                         0001 00013000
         USING @PSTART+4095,@06                                    0001 00014000
         EJECT                                                          00015000
*                                                                  0059 00016000
*/*ILRVSAMI: CHART (AREF,SEQ)                                        */ 00017000
*/*HEADER                                                          0059 00018000
*/*            ILRVSAMI - VSAM INTERFACE ROUTINE                     */ 00019000
*/*ILRVSAMI: E ENTRY                                                 */ 00020000
*/*         P  SAVE CALLER'S REGISTERS                               */ 00021000
*/*         S  ILRGMA: GET A WORKAREA                                */ 00022000
*/*         D  (YES,%VSM01,NO,) RETURN CODE ZERO?                    */ 00023000
*/*          D  (YES,%VSM01,NO,) RETURN CODE ZERO?                   */ 00024000
*/*         P  SET RETURN CODE TO 28                                 */ 00025000
*/*         R  RETURN                                                */ 00026000
*/*%VSM01:  P  SAVE PTR TO WORKAREA                                  */ 00027000
*/*         P  GET PTR TO PARMLIST FROM INPUT REG 1                  */ 00028000
*/*         P  GET PTR TO EPATH FROM PARM LIST                       */ 00029000
*/*         P  RECORD ENTRY IN EPATH                                 */ 00030000
*/*         P  RECORD PTR TO WORKAREA IN EPATH                       */ 00031000
*/*         P  GET ADDRESS OF SUBROUTINE BASED ON OP-CODE            */ 00032000
*/*         N  01=GETASPCT, 02=PUTASPCT, 03&04=RETERASE              */ 00033000
*/*         S  CALL: SUBROUTINE                                      */ 00034000
*/*         D  (YES,%VSM02,NO,) ZERO RETURN CODE?                    */ 00035000
*/*         S  ABEND: 086                                            */ 00036000
*/*%VSM02:  P  ZERO THE PTR TO WORKAREA IN EPATH                     */ 00037000
*/*         P  SAVE RETURN CODE IN REGISTER                          */ 00038000
*/*         S  ILRGMA: FREE THE WORKAREA                             */ 00039000
*/*         P  ZERO ENTRY INFO IN EPATH                              */ 00040000
*/*         P  LOAD REG 15 WITH RETURN CODE                          */ 00041000
*/*         R  RETURN TO CALLER                                      */ 00042000
*/*ILRVSAMI: END                                                     */ 00043000
*                                                                  0059 00044000
         EJECT                                                          00045000
*                                                                  0059 00046000
*   /*****************************************************************/ 00047000
*   /*                                                               */ 00048000
*   /* BEGIN ILRGMA MACRO EXPANSION                                  */ 00049000
*   /*                                                               */ 00050000
*   /*****************************************************************/ 00051000
*                                                                  0059 00052000
*   DO;                             /* ILRGMA GET                  0059 00053000
*                                      CELL(SWK)WORKREGS(R11,R12)    */ 00054000
*     DECLARE                       /* ASMVT VECTOR TO ILRPEX        */ 00055000
*       ILRPEX ENTRY BASED(ASMPEX) VALRG(0);                       0060 00056000
*     DECLARE                       /* MAP FOR CELL CONTROL WORDS    */ 00057000
*       1 GMACELL BASED BDY(WORD),                                 0061 00058000
*        2 GMANEXT PTR(31);         /* PTR NEXT FREE CELL            */ 00059000
*     RESPECIFY                                                    0062 00060000
*      (R0,                                                        0062 00061000
*       R1,                                                        0062 00062000
*       R11,                                                       0062 00063000
*       R12,                                                       0062 00064000
*       R14,                                                       0062 00065000
*       R15) RESTRICTED;                                           0062 00066000
*     RESPECIFY                                                    0063 00067000
*       ASMPOOLS BASED(R11);                                       0063 00068000
*     RESPECIFY                                                    0064 00069000
*       GMACELL BASED(R14);                                        0064 00070000
*     R11=ADDR(ASMSWKPC);                                          0065 00071000
         LA    R11,ASMSWKPC(,ASMVTPTR)                             0065 00072000
*     LM(R14,R15,ASMCPAVQ);         /* GET ADDR OF 1ST CELL          */ 00073000
         LM    R14,R15,ASMCPAVQ(R11)                               0066 00074000
*GMA00010:                                                         0067 00075000
*     IF R14^=0 THEN                /* TEST CELL POOL                */ 00076000
GMA00010 LTR   R14,R14                                             0067 00077000
         BZ    @RF00067                                            0067 00078000
*       DO;                         /* CELL AVAILABLE, REMOVE CELL   */ 00079000
*         R0=GMANEXT;                                              0069 00080000
         L     R0,GMANEXT(,R14)                                    0069 00081000
*         R1=R15-1;                                                0070 00082000
         LR    R1,R15                                              0070 00083000
         BCTR  R1,0                                                0070 00084000
*         CDS(R14,R0,ASMCPAVQ);                                    0071 00085000
         CDS   R14,R0,ASMCPAVQ(R11)                                0071 00086000
*         BC(7,GMA00010);                                          0072 00087000
         BC    7,GMA00010                                          0072 00088000
*         R1=R14;                                                  0073 00089000
         LR    R1,R14                                              0073 00090000
*       END;                                                       0074 00091000
*     ELSE                                                         0075 00092000
*       DO;                         /* CELL POOL EMPTY               */ 00093000
         B     @RC00067                                            0075 00094000
@RF00067 DS    0H                                                  0076 00095000
*         R1=R11;                   /* PREPARE TO CALL PEX           */ 00096000
         LR    R1,R11                                              0076 00097000
*         CALL ILRPEX;              /* EXTEND THE POOL               */ 00098000
         L     @15,ASMPEX(,ASMVTPTR)                               0077 00099000
         BALR  @14,@15                                             0077 00100000
*       END;                                                       0078 00101000
*     RESPECIFY                                                    0079 00102000
*      (R0,                                                        0079 00103000
*       R1,                                                        0079 00104000
*       R11,                                                       0079 00105000
*       R12,                                                       0079 00106000
*       R14,                                                       0079 00107000
*       R15) UNRESTRICTED;                                         0079 00108000
@RC00067 DS    0H                                                  0080 00109000
*   END;                            /* ILRGMA GET                  0080 00110000
*                                      CELL(SWK)WORKREGS(R11,R12)    */ 00111000
*                                                                  0080 00112000
*   /*****************************************************************/ 00113000
*   /*                                                               */ 00114000
*   /* END ILRGMA MACRO EXPANSION                                    */ 00115000
*   /*                                                               */ 00116000
*   /*****************************************************************/ 00117000
*                                                                  0081 00118000
         EJECT                                                          00119000
*                                                                  0081 00120000
*/********************************************************************/ 00121000
*/* IF ILRGMA WAS UNSUCCESSFUL, RETURN TO CALLER INDICATING WE COULD */ 00122000
*/* NOT OBTAIN STORAGE.                                              */ 00123000
*/* IF ILRGMA IS SUCCESSFUL, ESTABLISH ADDRESSABILITY TO THE WORK    */ 00124000
*/* AREA AND INITIALIZE WORKAREA FIELDS.                             */ 00125000
*/********************************************************************/ 00126000
*                                                                  0081 00127000
*   RFY                                                            0081 00128000
*     R1 RSTD;                                                     0081 00129000
*   IF R1=ZERO                      /* DID WE OBTAIN A WORKAREA?     */ 00130000
*     THEN                          /* NO, RETURN TO CALLER          */ 00131000
         LTR   R1,R1                                               0082 00132000
         BNZ   @RF00082                                            0082 00133000
*     RETURN CODE(STORAGE);         /* INDICATING WE COULD NOT OBTAIN   00134000
*                                      STORAGE                       */ 00135000
         LA    @15,28                                              0083 00136000
         L     @14,12(,@13)                                        0083 00137000
         LM    @00,@12,20(@13)                                     0083 00138000
         BR    @14                                                 0083 00139000
*   ELSE                                                           0084 00140000
*     DO;                           /* YES, ESTABLISH WORKAREA     0084 00141000
*                                      ADDRESSABILITY                */ 00142000
@RF00082 DS    0H                                                  0085 00143000
*       RFY                                                        0085 00144000
*         R8 RSTD;                                                 0085 00145000
*       R8=R1;                      /* GET ADDR OF RPL BUILD AREA    */ 00146000
         LR    R8,R1                                               0086 00147000
*       R9=R8+LENGTH(IFGRPL);       /* GET ADDRESS OF WORKAREA       */ 00148000
         LA    R9,76                                               0087 00149000
         ALR   R9,R8                                               0087 00150000
*       RFY                                                        0088 00151000
*         R8 UNRSTD;                                               0088 00152000
*       GENERATE REFS(R1,R13) SETS(R1,R8,R9,R13,RPLPTR);           0089 00153000
         USING @DATD,R9                                                 00154000
         ST    R8,RPLPTR                  SAVE PTR TO RPL BUILD AREA    00155000
         LA    R8,SAVEREGA                GET ADDRESS OF SAVEAREA       00156000
         ST    R13,4(R8)                  STORE BACKWARD POINTER        00157000
         ST    R8,8(R13)                  STORE FORWARD POINTER         00158000
         L     R1,24(R13)                 GET PTR TO INPUT PARM LIST    00159000
         LR    R13,R8                     SET R13 TO OUR SAVEAREA       00160000
*     END;                                                         0090 00161000
*   PARMPTR=R1;                     /* SAVE PTR TO INPUT PARMLIST    */ 00162000
         ST    R1,PARMPTR                                          0091 00163000
*   EPAPTR=EPATHPTR;                /* SAVE PTR TO EPATH             */ 00164000
         L     @12,PARMPTR                                         0092 00165000
         L     @11,EPATHPTR(,@12)                                  0092 00166000
         ST    @11,EPAPTR                                          0092 00167000
*   EPAVSAMI=ON;                    /* RECORD ENTRY                  */ 00168000
         OI    EPAVSAMI(@11),B'10000000'                           0093 00169000
*   EPAVWKA=RPLPTR;                 /* REC PTR TO BEGINNING OF WKA   */ 00170000
         L     @08,RPLPTR                                          0094 00171000
         ST    @08,EPAVWKA(,@11)                                   0094 00172000
*   ASMVTWPT=ASMVTPTR;              /* SAVE PTR TO ASMVT             */ 00173000
         ST    ASMVTPTR,ASMVTWPT                                   0095 00174000
*   EPARTYRG=ADDR(SAVREGSA);        /* RECORD REG SAVEAREA ADDR      */ 00175000
         LA    @07,SAVREGSA                                        0096 00176000
         ST    @07,EPARTYRG(,@11)                                  0096 00177000
*   RFY                                                            0097 00178000
*    (R1,                                                          0097 00179000
*     ASMVTPTR) UNRSTD;                                            0097 00180000
*   RFY                                                            0098 00181000
*     ASMVT BASED(ASMVTWPT);                                       0098 00182000
*   FBCODE=ZERO;                    /* ZERO SHOWCB FEEDBACK FIELD    */ 00183000
         SLR   @11,@11                                             0099 00184000
         ST    @11,FBCODE                                          0099 00185000
*   RETCODE=ZERO;                   /* ZERO INTERNAL RETURN CODE     */ 00186000
         ST    @11,RETCODE                                         0100 00187000
*   RETASPCT=ZERO;                  /* ZERO PTR TO RETRIEVED ASPCT   */ 00188000
         ST    @11,RETASPCT                                        0101 00189000
*   RFY                                                            0102 00190000
*     IFGRPL BASED(RPLPTR);                                        0102 00191000
*   RPL=RPL&&RPL;                   /* ZERO THE RPL BUILD AREA       */ 00192000
         XC    RPL(76,@08),RPL(@08)                                0103 00193000
         EJECT                                                          00194000
*                                                                  0104 00195000
*/********************************************************************/ 00196000
*/* CALL THE APPROPRIATE SUBROUTINE BASED ON THE CALLER'S REQUEST    */ 00197000
*/* OPCODE IN THE PARAMETER LIST. IF THE SUBROUTINE WAS UNSUCCESSFUL */ 00198000
*/* ISSUE AN 086 ABEND FOR RECORDING.                                */ 00199000
*/* RETURN THE WORKAREA TO ITS POOL AND RETURN TO CALLER.            */ 00200000
*/********************************************************************/ 00201000
*                                                                  0104 00202000
*   OPCPTR=PTRS(OPCODE);            /* GET PTR TO INTERNAL SUBROUTINE   00203000
*                                      BASED ON THE INPUT REQUEST  0104 00204000
*                                      OP-CODE. 01 = GETASPCT 02 = 0104 00205000
*                                      PUTASPCT 03 & 04 = RETERASE   */ 00206000
         SLR   @11,@11                                             0104 00207000
         IC    @11,OPCODE(,@12)                                    0104 00208000
         SLA   @11,2                                               0104 00209000
         L     OPCPTR,PTRS-4(@11)                                  0104 00210000
*   CALL ROUTINE;                   /* CALL THE APPROPRIATE        0105 00211000
*                                      SUBROUTINE TO PROCESS THE   0105 00212000
*                                      REQUEST                       */ 00213000
         LR    @15,OPCPTR                                          0105 00214000
         BALR  @14,@15                                             0105 00215000
*   RFY                                                            0106 00216000
*     R15 RSTD;                                                    0106 00217000
*   IF R15^=ZERO                    /* WAS SUBROUTINE SUCCESSFUL?    */ 00218000
*     THEN                                                         0107 00219000
         LTR   R15,R15                                             0107 00220000
         BZ    @RF00107                                            0107 00221000
*     DO;                           /* NO                            */ 00222000
*       IF R15=TWENTY               /* I/O ERROR?                    */ 00223000
*         THEN                                                     0109 00224000
         C     R15,@CF00120                                        0109 00225000
         BNE   @RF00109                                            0109 00226000
*         DO;                       /* YES, RECORD ERROR             */ 00227000
*           STM(R0,R14,SAVREGSA);   /* SAVE REGS FOR RECOVERY        */ 00228000
         STM   R0,R14,SAVREGSA                                     0111 00229000
*           GEN(ABEND X'86',,,SYSTEM);/* RECORD THE ERROR            */ 00230000
         ABEND X'86',,,SYSTEM                                           00231000
*         END;                                                     0113 00232000
*       IF OPCODE=REL               /* IS THIS A RELEASE REQ?        */ 00233000
*         THEN                                                     0114 00234000
@RF00109 L     @14,PARMPTR                                         0114 00235000
         CLI   OPCODE(@14),4                                       0114 00236000
         BNE   @RF00114                                            0114 00237000
*         IF RETASPCT^=ZERO         /* WAS THE BASE RETRIEVED?       */ 00238000
*           THEN                    /* YES                           */ 00239000
         L     @14,RETASPCT                                        0115 00240000
         LTR   @14,@14                                             0115 00241000
         BZ    @RF00115                                            0115 00242000
*           R15=PARTIAL;            /* SET PARTIAL RETRIEVAL RC      */ 00243000
         LA    R15,48                                              0116 00244000
*     END;                                                         0117 00245000
@RF00115 DS    0H                                                  0117 00246000
@RF00114 DS    0H                                                  0118 00247000
*   EPARPLB=OFF;                    /* RESET RPL BUILT FLAG          */ 00248000
@RF00107 L     @14,EPAPTR                                          0118 00249000
         NI    EPARPLB(@14),B'11111110'                            0118 00250000
*   EPARTYRG=ZERO;                  /* ZERO REG SAVEAREA PTR         */ 00251000
         SLR   @12,@12                                             0119 00252000
         ST    @12,EPARTYRG(,@14)                                  0119 00253000
*   EPAVWKA=ZERO;                   /* ZERO RECOVERY'S PTR TO WKA    */ 00254000
         ST    @12,EPAVWKA(,@14)                                   0120 00255000
*   EPAVSAMI=OFF;                   /* ZERO ENTRY FLAG               */ 00256000
         NI    EPAVSAMI(@14),B'01111111'                           0121 00257000
*   GENERATE REFS(R13,R15) SETS(R13);                              0122 00258000
         L     R13,4(R13)                 GET ADDR OF CALLERS SAVEAREA  00259000
         MVC   16(4,R13),RETCODE          STORE RET CODE IN CALLERS R15 00260000
         MVC   24(4,R13),RETASPCT         STORE PTR TO RET ASPCT        00261000
         L     R1,RPLPTR                  GET PTR TO BEGINNING OF WKA   00262000
*   RFY                                                            0123 00263000
*     R15 UNRSTD;                                                  0123 00264000
         EJECT                                                          00265000
*                                                                  0124 00266000
*   /*****************************************************************/ 00267000
*   /*                                                               */ 00268000
*   /* BEGIN ILRGMA MACRO EXPANSION                                  */ 00269000
*   /*                                                               */ 00270000
*   /*****************************************************************/ 00271000
*                                                                  0124 00272000
*   DO;                             /* ILRGMA FREE                 0124 00273000
*                                      CELL(SWK)WORKREGS(R11,R12)    */ 00274000
*     RESPECIFY                                                    0125 00275000
*      (R0,                                                        0125 00276000
*       R1,                                                        0125 00277000
*       R11,                                                       0125 00278000
*       R12,                                                       0125 00279000
*       R14,                                                       0125 00280000
*       R15) RESTRICTED;                                           0125 00281000
*     RESPECIFY                                                    0126 00282000
*       ASMPOOLS BASED(R11);                                       0126 00283000
*     RESPECIFY                                                    0127 00284000
*       GMACELL BASED(R1);                                         0127 00285000
*     R11=ADDR(ASMSWKPC);                                          0128 00286000
         L     R11,ASMVTWPT                                        0128 00287000
         LA    R11,ASMSWKPC(,R11)                                  0128 00288000
*     R14=ASMCPAVL;                                                0129 00289000
         L     R14,ASMCPAVL(,R11)                                  0129 00290000
*GMA00022:                                                         0130 00291000
*     GMANEXT=R14;                  /* PUT ADDR CURRENT FIRST IN   0130 00292000
*                                      INPUT CELL                    */ 00293000
GMA00022 ST    R14,GMANEXT(,R1)                                    0130 00294000
*     CS(R14,R1,ASMCPAVL);          /* ADD INPUT CELL TO POOL        */ 00295000
         CS    R14,@01,ASMCPAVL(R11)                               0131 00296000
*     BC(7,GMA00022);                                              0132 00297000
         BC    7,GMA00022                                          0132 00298000
*     RESPECIFY                                                    0133 00299000
*      (R0,                                                        0133 00300000
*       R1,                                                        0133 00301000
*       R11,                                                       0133 00302000
*       R12,                                                       0133 00303000
*       R14,                                                       0133 00304000
*       R15) UNRESTRICTED;                                         0133 00305000
*   END;                            /* ILRGMA FREE                 0134 00306000
*                                      CELL(SWK)WORKREGS(R11,R12)    */ 00307000
*                                                                  0134 00308000
*   /*****************************************************************/ 00309000
*   /*                                                               */ 00310000
*   /* END ILRGMA MACRO EXPANSION                                    */ 00311000
*   /*                                                               */ 00312000
*   /*****************************************************************/ 00313000
*                                                                  0135 00314000
*                                   /* RETURN THE WORKAREA           */ 00315000
*   RETURN;                         /* RETURN TO CALLER              */ 00316000
@EL00001 DS    0H                                                  0135 00317000
@EF00001 DS    0H                                                  0135 00318000
@ER00001 LM    @14,@12,12(@13)                                     0135 00319000
         BR    @14                                                 0135 00320000
         EJECT                                                          00321000
*                                                                  0136 00322000
*/********************************************************************/ 00323000
*/*                                                                  */ 00324000
*/*  GETASPCT: RETRIEVE AN ASPCT                                     */ 00325000
*/*                                                                  */ 00326000
*/*  INPUT:    THE INPUT PARAMETER LIST                              */ 00327000
*/*              WORD 1 = 01 OP-CODE                                 */ 00328000
*/*              WORD 2 = PTR TO 8-BYTE 'S' SYMBOL                   */ 00329000
*/*              WORD 3 = PTR TO THE EPATH                           */ 00330000
*/*                                                                  */ 00331000
*/*  PROCESS:  SAVE THE RETURN ADDRESS. COPY THE 'S' SYMBOL TO THE   */ 00332000
*/*            WORKAREA KEY. CALL GETONE TO RETRIEVE THE ASPCT BASE  */ 00333000
*/*            FROM STGINDEX. IF THERE ARE NO EXTENSIONS, RETURN TO  */ 00334000
*/*            MAINLINE.                                             */ 00335000
*/*            SAVE THE NUMBER OF LPME EXTENSIONS AND ASST           */ 00336000
*/*            EXTENSIONS. ZERO THESE COUNTS AND THE POINTERS TO THE */ 00337000
*/*            ASST EXTENSIONS IN THE RETRIEVED ASPCT BASE. RECORD   */ 00338000
*/*            POINTER TO RETRIEVED BASE. INCREMENT THE WORKAREA KEY */ 00339000
*/*            FOR AN ASST EXTENSION. CALL GETONE TO RETRIEVE AN     */ 00340000
*/*            ASST EXTENSION. ZERO THE POINTERS TO THE LPME EXT.    */ 00341000
*/*            IN THE ASST EXT. STORE THE POINTER TO THE ASST EXT.   */ 00342000
*/*            IN THE BASE. NOW LOOP THROUGH RETRIEVING THE LPME     */ 00343000
*/*            EXT. FOR THIS ASST EXT. GETONE IS CALLED FOR EACH     */ 00344000
*/*            LPME EXT. THE LPME EXT. ARE ANCHORED IN THE ASST EXT. */ 00345000
*/*            ONCE WE HAVE RETRIEVED ALL THE LPME EXT. FOR THIS     */ 00346000
*/*            ASST EXT. WE LOOP BACK AND RETRIEVE THE NEXT ASST     */ 00347000
*/*            EXT. ONCE ALL EXT. HAVE BEEN RETRIEVED, RETURN TO     */ 00348000
*/*            MAINLINE.                                             */ 00349000
*/*            IF ONE OF THE EXTENSIONS COULD NOT BE RETRIEVED, ALL  */ 00350000
*/*            THE STORAGE USED FOR THE ASPCT BASE AND THOSE         */ 00351000
*/*            EXTENSIONS RETRIEVED, IS FREED, AND THE POINTER       */ 00352000
*/*            TO THE RETRIEVED ASPCT IS ZEROED.                     */ 00353000
*/*                                                                  */ 00354000
*/*  OUTPUT:   THE ASPCT BASE AND ALL OF ITS EXTENSIONS HAVE BEEN    */ 00355000
*/*            RETRIEVED FROM SYS1.STGINDEX AND ARE RECHAINED IN     */ 00356000
*/*            2K PAGEABLE BUFFERS.                                  */ 00357000
*/*                                                                  */ 00358000
*/********************************************************************/ 00359000
*/*GETASPCT: CHART (AREF,SEQ)                                        */ 00360000
*/*HEADER                                                          0136 00361000
*/* GETASPCT: GET AN ASPCT FROM SYS1.STGINDEX                        */ 00362000
*/*GETASPCT: E ENTRY                                                 */ 00363000
*/*         P  SAVE THE RETURN ADDRESS                               */ 00364000
*/*         P  SET THE WKA KEY FOR ASPCT BASE                        */ 00365000
*/*         S  GETONE: GET THE ASPCT BASE FROM STGINDEX              */ 00366000
*/*         D  (YES,%VSM04,NO,) ZERO RETURN CODE?                    */ 00367000
*/*         P  SAVE THE RETURN CODE                                  */ 00368000
*/*         D  (YES,,NO,%VSM03) STORAGE OBTAINED?                    */ 00369000
*/*         L  SETLOCK: UNCOND OBTAIN LOCAL LOCK                     */ 00370000
*/*         P  ZERO THE EPATH PTR TO I/O BUFFER                      */ 00371000
*/*         P  LOAD REGISTERS FOR FREEMAIN                           */ 00372000
*/*         S  FREEMAIN: FREE THE BUFFER USED FOR BASE               */ 00373000
*/*         L  SETLOCK: UNCOND RELEASE LOCAL LOCK                    */ 00374000
*/*%VSM03:  R  RETURN TO MAINLINE                                    */ 00375000
*/*%VSM04:  D  (YES,,NO,%VSM03) ANY EXTENSIONS?                      */ 00376000
*/*         P  SAVE THE NUMBER OF LPME EXTENSIONS (ASPLEXCT)         */ 00377000
*/*         P  SAVE THE NUMBER OF ASST EXTENSIONS (ASPAEXCT)         */ 00378000
*/*         P  ZERO THE LPME EXT COUNT IN ASPCT (ASPLEXCT)           */ 00379000
*/*         P  ZERO THE ASST EXT COUNT IN ASPCT (ASPAEXCT)           */ 00380000
*/*         P  ZERO THE ASST EXT PTRS IN ASPCT (ASPASSTP)            */ 00381000
*/*         P  RECORD PTR TO BUFFER IN EPATH                         */ 00382000
*/*         P  ZERO THE EPATH PTR TO THE I/O BUFFER                  */ 00383000
*/*%VSM05:  P  SET WKA KEY TO ASST EXTENSION                         */ 00384000
*/*         S  GETONE: GET AN ASST EXT FROM STGINDEX                 */ 00385000
*/*         D  (YES,%VSM08,NO,) ZERO RETURN CODE?                    */ 00386000
*/*         L  SETLOCK: UNCOND OBTAIN LOCAL LOCK                     */ 00387000
*/*         D  (YES,,NO,%VSM06) STORAGE OBTAINED?                    */ 00388000
*/*         P  ZERO INDIVIDUAL BUFFER PTR IN EPATH                   */ 00389000
*/*         P  LOAD REGISTERS FOR FREEMAIN                           */ 00390000
*/*         S  FREEMAIN: FREE THE I/O BUFFER                         */ 00391000
*/*%VSM06:  P  ZERO PTR TO BUFFER IN EPATH                           */ 00392000
*/*         P  LOAD REG 1 WITH PTR TO BASE BUFFER                    */ 00393000
*/*         P  SET REG 0 TO LENGTH OF BUFFER                         */ 00394000
*/*         S  ILRAFS00: FREE THE BUFFERS                            */ 00395000
*/*         P  SAVE THE RETURN CODE                                  */ 00396000
*/*         L  SETLOCK: UNCOND RELEASE LOCAL LOCK                    */ 00397000
*/*         D  (YES,%VSM07,NO,) ZERO RETURN CODE?                    */ 00398000
*/*         S  ABEND: 087                                            */ 00399000
*/*%VSM07:  P  LOAD INTERNAL RETURN CODE                             */ 00400000
*/*         R  RETURN TO MAINLINE                                    */ 00401000
*/*%VSM08:  P  ZERO THE PTRS TO THE LPME EXTS                        */ 00402000
*/*         P  STORE PTR TO ASST EXT IN BASE                         */ 00403000
*/*         P  ZERO THE I/O BUFFER PTR IN EPATH                      */ 00404000
*/*         P  INCREMENT ASST EXT COUNTER IN BASE                    */ 00405000
*/*         P  DECREMENT INTERNAL ASST COUNTER                       */ 00406000
*/*%VSM09:  P  SET THE WORKAREA KEY FOR LPME EXT                     */ 00407000
*/*         S  GETONE : GET AN LPME EXT FROM STGINDEX                */ 00408000
*/*         D  (YES,%VSM09A,NO,) ZERO RETURN CODE?                   */ 00409000
*/*         L  SETLOCK: UNCOND OBTAIN LOCAL LOCK                     */ 00410000
*/*         D  (YES,,NO,%VSM06) STORAGE OBTAINED?                    */ 00411000
*/*         P  STORE PTR TO LPME EXT IN ASST EXT                     */ 00412000
*/*         P  INCREMENT THE LPME EXT COUNT IN BASE                  */ 00413000
*/*         P  (,%VSM06) ZERO EPATH PTR TO I/O BUFFER                */ 00414000
*/*%VSM09A: P  STORE PTR TO LPME EXT IN ASST EXT                     */ 00415000
*/*         P  ZERO EPATH PTR TO I/O BUFFER                          */ 00416000
*/*         P  INCREMENT LPME EXT COUNTER IN BASE                    */ 00417000
*/*         P  DECREMENT INTERNAL LPME COUNTER                       */ 00418000
*/*         D  (YES,%VSM10,NO,) INTERNAL LPME COUNTER = 0?           */ 00419000
*/*         P  INCREMENT ASST EXT ARRAY SUBSCRIPT                    */ 00420000
*/*         D  (YES,,NO,%VSM09) REACHED END OF ARRAY?                */ 00421000
*/*         P  RESET TO BEGINNING OF ARRAY                           */ 00422000
*/*%VSM10:  D  (YES,%VSM11,NO,) INTERNAL ASST COUNTER = 0?           */ 00423000
*/*         P  INCREMENT BASE ARRAY POINTER                          */ 00424000
*/*         D  (YES,,NO,%VSM05) REACHED END OF ARRAY?                */ 00425000
*/*%VSM11:  R  RETURN TO MAINLINE                                    */ 00426000
*/*GETASPCT: END                                                     */ 00427000
*                                                                  0136 00428000
         EJECT                                                          00429000
*GETASPCT:                                                         0136 00430000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0136 00431000
GETASPCT DS    0H                                                  0137 00432000
*   RFY                                                            0137 00433000
*     R14 RSTD;                                                    0137 00434000
*   RETADDR1=R14;                   /* SAVE THE RETURN ADDRESS       */ 00435000
         ST    R14,RETADDR1                                        0138 00436000
*   RFY                                                            0139 00437000
*     R14 UNRSTD;                                                  0139 00438000
*                                                                  0139 00439000
*/********************************************************************/ 00440000
*/* BUILD THE RETRIEVAL KEY FOR VSAM, AND CALL GETONE TO RETRIEVE    */ 00441000
*/* THE ASPCT BASE.                                                  */ 00442000
*/********************************************************************/ 00443000
*                                                                  0140 00444000
*   WKAKEY=SSYM;                    /* COPY THE 'S' SYMBOL TO THE    */ 00445000
         L     @12,PARMPTR                                         0140 00446000
         L     @12,SSYMPTR(,@12)                                   0140 00447000
         MVC   WKAKEY(8),SSYM(@12)                                 0140 00448000
*   EXTNUMB=ZERO;                   /* WORKAREA KEY FOR VSAM         */ 00449000
         SLR   @12,@12                                             0141 00450000
         ST    @12,EXTNUMB                                         0141 00451000
*   EPARPLB=OFF;                    /* SET RPL BUILT FLAG OFF        */ 00452000
         L     @12,EPAPTR                                          0142 00453000
         NI    EPARPLB(@12),B'11111110'                            0142 00454000
*   CALL GETONE;                    /* RETRIEVE ASPCT BASE           */ 00455000
         BAL   @14,GETONE                                          0143 00456000
         EJECT                                                          00457000
*                                                                  0144 00458000
*/********************************************************************/ 00459000
*/* IF THE BASE RETRIEVAL WAS SUCCESSFUL AND THERE ARE EXTENSIONS,   */ 00460000
*/* ZERO THE BASE POINTERS TO ASST EXTENSIONS AND SETUP FOR          */ 00461000
*/* EXTENSION RETRIEVAL.                                             */ 00462000
*/********************************************************************/ 00463000
*                                                                  0144 00464000
*   RFY                                                            0144 00465000
*     R15 RSTD;                                                    0144 00466000
*   IF R15=ZERO                     /* SUCCESSFUL RETRIEVAL?         */ 00467000
*     THEN                                                         0145 00468000
         SLR   @14,@14                                             0145 00469000
         CR    R15,@14                                             0145 00470000
         BNE   @RF00145                                            0145 00471000
*     DO;                           /* YES                           */ 00472000
*       RFY                                                        0147 00473000
*         R15 UNRSTD;                                              0147 00474000
*       ASPCTPTR=BUFFER;            /* SAVE PTR TO ASPCT BASE        */ 00475000
         L     @12,BUFFER                                          0148 00476000
         ST    @12,ASPCTPTR                                        0148 00477000
*       RETASPCT=BUFFER;            /* ANCHOR ASPCT BASE             */ 00478000
         ST    @12,RETASPCT                                        0149 00479000
*       IF ASPAEXCT^=ZERO           /* ARE THERE ANY EXTENSIONS?     */ 00480000
*         THEN                                                     0150 00481000
         LH    @11,ASPAEXCT(,@12)                                  0150 00482000
         CR    @11,@14                                             0150 00483000
         BE    @RF00150                                            0150 00484000
*         DO;                       /* YES                           */ 00485000
*           BASE=ONE;               /* INIT BASE SUBSCRIPT           */ 00486000
         LA    @08,1                                               0152 00487000
         ST    @08,BASE                                            0152 00488000
*           ASST=TWO;               /* INIT ASST SUBSCRIPT           */ 00489000
         MVC   ASST(4),@CF00114                                    0153 00490000
*           LPMEXT=ASPLEXCT;        /* GET NUMBER OF LPME EXT'S      */ 00491000
         LH    @07,ASPLEXCT(,@12)                                  0154 00492000
         ST    @07,LPMEXT                                          0154 00493000
*           ASSTEXT=ASPAEXCT;       /* GET NUMBER OF ASST EXT'S      */ 00494000
         ST    @11,ASSTEXT                                         0155 00495000
*           ASPAEXCT=ZERO;          /* ZERO THE COUNT OF ASST EXT'S     00496000
*                                      ANCHORED IN ASPCT BASE        */ 00497000
         STH   @14,ASPAEXCT(,@12)                                  0156 00498000
*           ASPLEXCT=ZERO;          /* ZERO THE COUNT OF LPME EXT'S     00499000
*                                      ANCHORED IN ASST EXT'S        */ 00500000
         STH   @14,ASPLEXCT(,@12)                                  0157 00501000
*           DO I=1 TO 4 BY 1;       /* ZERO THE OLD POINTER TO       */ 00502000
         LR    I,@08                                               0158 00503000
@DL00158 DS    0H                                                  0159 00504000
*             ASPASSTP(I)=ZERO;     /* ASST EXTENSIONS               */ 00505000
         LR    @12,I                                               0159 00506000
         SLA   @12,2                                               0159 00507000
         SLR   @11,@11                                             0159 00508000
         L     @08,ASPCTPTR                                        0159 00509000
         ST    @11,ASPASSTP-4(@12,@08)                             0159 00510000
*           END;                                                   0160 00511000
         AL    I,@CF00098                                          0160 00512000
         C     I,@CF00063                                          0160 00513000
         BNH   @DL00158                                            0160 00514000
*           EPABASP=ZERO;           /* ZERO RECOVERY'S PTR TO I/O  0161 00515000
*                                      BUFFER                        */ 00516000
         L     @12,EPAPTR                                          0161 00517000
         SLR   @11,@11                                             0161 00518000
         ST    @11,EPABASP(,@12)                                   0161 00519000
*           EPARASP=BUFFER;         /* RECORD PTR TO ASPCT BASE      */ 00520000
         L     @11,BUFFER                                          0162 00521000
         ST    @11,EPARASP(,@12)                                   0162 00522000
         EJECT                                                          00523000
*                                                                  0163 00524000
*/********************************************************************/ 00525000
*/*                                                                  */ 00526000
*/*  PROCESS ASST EXTENSIONS                                         */ 00527000
*/*                                                                  */ 00528000
*/********************************************************************/ 00529000
*                                                                  0163 00530000
*           DO WHILE ASSTEXT^=ZERO; /* LOOP UNTIL WE HAVE RETRIEVED     00531000
*                                      ALL ASST EXTENSIONS           */ 00532000
         B     @DE00163                                            0163 00533000
@DL00163 DS    0H                                                  0164 00534000
*             EXTNUMB=EXTNUMB+ONE;  /* INCREMENT THE VSAM KEY        */ 00535000
         LA    @12,1                                               0164 00536000
         AL    @12,EXTNUMB                                         0164 00537000
         ST    @12,EXTNUMB                                         0164 00538000
*             CALL GETONE;          /* RETRIEVE AN ASST EXTENSION    */ 00539000
         BAL   @14,GETONE                                          0165 00540000
*             RFY                                                  0166 00541000
*               R15 RSTD;                                          0166 00542000
*             IF R15=ZERO           /* SUCCESSFUL RETRIEVAL?         */ 00543000
*               THEN                                               0167 00544000
         LTR   R15,R15                                             0167 00545000
         BNZ   @RF00167                                            0167 00546000
*               DO;                 /* YES                           */ 00547000
*                 RFY                                              0169 00548000
*                   R15 UNRSTD;                                    0169 00549000
*                 ASPEXPTR=BUFFER;  /* SAVE PTR TO ASST EXTENSION    */ 00550000
         L     @12,BUFFER                                          0170 00551000
         ST    @12,ASPEXPTR                                        0170 00552000
*                 DO I=1 TO ASPNASST BY 1;/* ZERO THE OLD POINTER TO */ 00553000
         LA    I,1                                                 0171 00554000
@DL00171 DS    0H                                                  0172 00555000
*                   ASPSECTA(I)=ZERO;/* THE LPME EXTENSIONS          */ 00556000
         LR    @12,I                                               0172 00557000
         SLA   @12,2                                               0172 00558000
         SLR   @11,@11                                             0172 00559000
         L     @08,ASPEXPTR                                        0172 00560000
         ST    @11,ASPSECTA-4(@12,@08)                             0172 00561000
*                 END;                                             0173 00562000
         AL    I,@CF00098                                          0173 00563000
         C     I,@CF00150                                          0173 00564000
         BNH   @DL00171                                            0173 00565000
*                 EPABASP=ZERO;     /* ZERO RECOVERY'S POINTER TO I/O   00566000
*                                      BUFFER                        */ 00567000
         L     @12,EPAPTR                                          0174 00568000
         SLR   @11,@11                                             0174 00569000
         ST    @11,EPABASP(,@12)                                   0174 00570000
*                 ASPASSTP(BASE)=BUFFER;/* ANCHOR ASST EXT IN BASE   */ 00571000
         L     @12,ASPCTPTR                                        0175 00572000
         L     @11,BASE                                            0175 00573000
         LR    @08,@11                                             0175 00574000
         SLA   @08,2                                               0175 00575000
         L     @07,BUFFER                                          0175 00576000
         ST    @07,ASPASSTP-4(@08,@12)                             0175 00577000
*                 ASPAEXCT=ASPAEXCT+ONE;/* INCREMENT THE ASST EXT  0176 00578000
*                                      COUNT IN BASE                 */ 00579000
         LA    @08,1                                               0176 00580000
         LH    @07,ASPAEXCT(,@12)                                  0176 00581000
         ALR   @07,@08                                             0176 00582000
         STH   @07,ASPAEXCT(,@12)                                  0176 00583000
*                 ASSTEXT=ASSTEXT-ONE;/* DECREMENT THE INTERNAL ASST    00584000
*                                      EXTENSION COUNT               */ 00585000
         L     @12,ASSTEXT                                         0177 00586000
         BCTR  @12,0                                               0177 00587000
         ST    @12,ASSTEXT                                         0177 00588000
*                 IF LPMEXT>=ASPNLPME/* MORE THAN ONE ASST EXT?      */ 00589000
*                   THEN            /* YES                           */ 00590000
         L     @12,LPMEXT                                          0178 00591000
         C     @12,@CF00150                                        0178 00592000
         BL    @RF00178                                            0178 00593000
*                   IF BASE=ONE     /* IS THIS THE FIRST ASST EXT    */ 00594000
*                     THEN          /* YES                           */ 00595000
         CR    @11,@08                                             0179 00596000
         BNE   @RF00179                                            0179 00597000
*                     LPMECNTL=ASPNLPME-ONE;/* ALLOW FOR LPME'S IN 0180 00598000
*                                      THE BASE                      */ 00599000
         MVC   LPMECNTL(4),@CF01539                                0180 00600000
*                   ELSE            /* NO IT'S NOT FIRST ASST EXT    */ 00601000
*                     LPMECNTL=ASPNLPME;/* SET LPME LOOP CONTROL FOR    00602000
*                                      MAXIMUM NUMBER LPME EXTS      */ 00603000
         B     @RC00179                                            0181 00604000
@RF00179 MVC   LPMECNTL(4),@CF00150                                0181 00605000
*                 ELSE              /* NO, ONLY ONE ASST EXT         */ 00606000
*                   LPMECNTL=LPMEXT;/* SET LOOP CONTROL FOR NUMBER OF   00607000
*                                      LPME EXTENSIONS               */ 00608000
         B     @RC00178                                            0182 00609000
@RF00178 L     @12,LPMEXT                                          0182 00610000
         ST    @12,LPMECNTL                                        0182 00611000
*                 LPMEXT=LPMEXT-LPMECNTL;/* DECREMENT LPME EXT COUNT    00612000
*                                      BY NUMBER PROCESSED THIS TIME    00613000
*                                      THRU LOOP                     */ 00614000
@RC00178 L     @12,LPMEXT                                          0183 00615000
         SL    @12,LPMECNTL                                        0183 00616000
         ST    @12,LPMEXT                                          0183 00617000
*                 BASE=BASE+ONE;    /* INCREMENT BASE SUBSCRIPT      */ 00618000
         LA    @12,1                                               0184 00619000
         AL    @12,BASE                                            0184 00620000
         ST    @12,BASE                                            0184 00621000
         EJECT                                                          00622000
*                                                                  0185 00623000
*/********************************************************************/ 00624000
*/*                                                                  */ 00625000
*/*  PROCESS LPME EXTENSIONS                                         */ 00626000
*/*                                                                  */ 00627000
*/********************************************************************/ 00628000
*                                                                  0185 00629000
*                 DO WHILE LPMECNTL^=ZERO;/* LOOP THRU RETRIEVING ALL   00630000
*                                      LPME EXTENSIONS FOR THIS ASST    00631000
*                                      EXTENSION                     */ 00632000
         B     @DE00185                                            0185 00633000
@DL00185 DS    0H                                                  0186 00634000
*                   EXTNUMB=EXTNUMB+ONE;/* INCREMENT THE VSAM KEY    */ 00635000
         LA    @12,1                                               0186 00636000
         AL    @12,EXTNUMB                                         0186 00637000
         ST    @12,EXTNUMB                                         0186 00638000
*                   CALL GETONE;    /* RETRIEVE AN LPME EXTENSION    */ 00639000
         BAL   @14,GETONE                                          0187 00640000
*                   RFY                                            0188 00641000
*                     R15 RSTD;                                    0188 00642000
*                   IF R15=ZERO     /* SUCCESSFUL RETRIEVAL?         */ 00643000
*                     THEN                                         0189 00644000
         SLR   @14,@14                                             0189 00645000
         CR    R15,@14                                             0189 00646000
         BNE   @RF00189                                            0189 00647000
*                     DO;           /* YES                           */ 00648000
*                       RFY                                        0191 00649000
*                         R15 UNRSTD;                              0191 00650000
*                       EPABASP=ZERO;/* ZERO RECOVERY'S POINTER TO 0192 00651000
*                                      I/O BUFFER                    */ 00652000
         L     @12,EPAPTR                                          0192 00653000
         ST    @14,EPABASP(,@12)                                   0192 00654000
*                       ASPASSTE(ASST)=BUFFER;/* ANCHOR THE LPME   0193 00655000
*                                      EXTENSION IN ASST EXTENSION   */ 00656000
         L     @12,ASST                                            0193 00657000
         LR    @11,@12                                             0193 00658000
         SLA   @11,2                                               0193 00659000
         L     @08,BUFFER                                          0193 00660000
         L     @07,ASPEXPTR                                        0193 00661000
         ST    @08,ASPASSTE-4(@11,@07)                             0193 00662000
*                       ASPLEXCT=ASPLEXCT+ONE;/* INCREMENT LPME EXT     00663000
*                                      COUNT IN ASPCT BASE           */ 00664000
         L     @11,ASPCTPTR                                        0194 00665000
         LA    @08,1                                               0194 00666000
         LH    @07,ASPLEXCT(,@11)                                  0194 00667000
         ALR   @07,@08                                             0194 00668000
         STH   @07,ASPLEXCT(,@11)                                  0194 00669000
*                       LPMECNTL=LPMECNTL-ONE;/* DECREMENT INTERNAL     00670000
*                                      LPME LOOP CONTROL             */ 00671000
         L     @11,LPMECNTL                                        0195 00672000
         BCTR  @11,0                                               0195 00673000
         ST    @11,LPMECNTL                                        0195 00674000
*                       ASST=ASST+ONE;/* INCREMENT ASST SUBSCRIPT    */ 00675000
         ALR   @12,@08                                             0196 00676000
         ST    @12,ASST                                            0196 00677000
*                     END;                                         0197 00678000
         EJECT                                                          00679000
*                                                                  0198 00680000
*/********************************************************************/ 00681000
*/* PROCESS AN ERROR RETURN FROM GETONE FOR LPME EXTENSIONS.         */ 00682000
*/********************************************************************/ 00683000
*                                                                  0198 00684000
*                   ELSE                                           0198 00685000
*                     DO;                                          0198 00686000
         B     @RC00189                                            0198 00687000
@RF00189 DS    0H                                                  0199 00688000
*                       RFY                                        0199 00689000
*                         R15 RSTD;                                0199 00690000
*                       RETCODE=R15;/* SAVE THE RETURN CODE          */ 00691000
         ST    R15,RETCODE                                         0200 00692000
*                       RFY                                        0201 00693000
*                         R15 UNRSTD;                              0201 00694000
*                       RFY                                        0202 00695000
*                         R8 RSTD;                                 0202 00696000
*                       R8=R13;     /* SAVE SAVEAREA POINTER GET   0203 00697000
*                                      LOCAL LOCK FOR ILRAFS00       */ 00698000
         LR    R8,R13                                              0203 00699000
*                       GENERATE SETS(R11,R12,R13,R14);            0204 00700000
GET1     SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(VIO,           *00701000
               ILRVSAMI(REL2))                                          00702000
*                       R13=R8;     /* RESTORE SAVEAREA POINTER      */ 00703000
         LR    R13,R8                                              0205 00704000
*                       RFY                                        0206 00705000
*                         R8 UNRSTD;                               0206 00706000
*                       IF RETCODE^=STORAGE/* WAS AN I/O BUFFER    0207 00707000
*                                      OBTAINED?                     */ 00708000
*                         THEN                                     0207 00709000
         CLC   RETCODE(4),@CF00122                                 0207 00710000
         BE    @RF00207                                            0207 00711000
*                         DO;       /* YES                           */ 00712000
*                           EPABASP=ZERO;/* ZERO RECOVERY'S POINTER     00713000
*                                      TO I/O BUFFER                 */ 00714000
         L     @12,EPAPTR                                          0209 00715000
         SLR   @11,@11                                             0209 00716000
         ST    @11,EPABASP(,@12)                                   0209 00717000
*                           ASPASSTE(ASST)=BUFFER;/* ANCHOR BUFFER IN   00718000
*                                      ASST EXT ILRAFS00 WILL BE USED   00719000
*                                      TO FREE THE BUFFER AND THE  0210 00720000
*                                      REST OF THE RETRIEVED CHAIN   */ 00721000
         L     @12,ASST                                            0210 00722000
         SLA   @12,2                                               0210 00723000
         L     @11,BUFFER                                          0210 00724000
         L     @08,ASPEXPTR                                        0210 00725000
         ST    @11,ASPASSTE-4(@12,@08)                             0210 00726000
*                           ASPLEXCT=ASPLEXCT+ONE;/* INCREMENT LPME     00727000
*                                      EXT COUNT IN BASE             */ 00728000
         L     @12,ASPCTPTR                                        0211 00729000
         LA    @11,1                                               0211 00730000
         AH    @11,ASPLEXCT(,@12)                                  0211 00731000
         STH   @11,ASPLEXCT(,@12)                                  0211 00732000
*                         END;                                     0212 00733000
*                       ELSE                                       0213 00734000
*                         ;                                        0213 00735000
@RF00207 DS    0H                                                  0214 00736000
*                       LPMECNTL=ZERO;/* FORCE LPME LOOP EXIT        */ 00737000
         SLR   @12,@12                                             0214 00738000
         ST    @12,LPMECNTL                                        0214 00739000
*                       ASSTEXT=ZERO;/* FORCE ASST LOOP EXIT         */ 00740000
         ST    @12,ASSTEXT                                         0215 00741000
*                     END;                                         0216 00742000
*                 END;              /* PHYSICAL END OF DO WHILE LOOP    00743000
*                                      FOR LPME EXTENSIONS           */ 00744000
@RC00189 DS    0H                                                  0217 00745000
@DE00185 L     @12,LPMECNTL                                        0217 00746000
         LTR   @12,@12                                             0217 00747000
         BNZ   @DL00185                                            0217 00748000
*                 ASST=ONE;         /* RESET ASST SUBSCRIPT          */ 00749000
         MVC   ASST(4),@CF00098                                    0218 00750000
*               END;                /* END PROCESSING FOR RETURN CODE   00751000
*                                      ZERO FROM GETONE FOR ASST   0219 00752000
*                                      EXTENSIONS                    */ 00753000
         EJECT                                                          00754000
*                                                                  0220 00755000
*/********************************************************************/ 00756000
*/*  PROCESS NON-ZERO RETURN FROM GETONE  FOR ASST EXTENSIONS        */ 00757000
*/********************************************************************/ 00758000
*                                                                  0220 00759000
*             ELSE                                                 0220 00760000
*               DO;                                                0220 00761000
         B     @RC00167                                            0220 00762000
@RF00167 DS    0H                                                  0221 00763000
*                 RFY                                              0221 00764000
*                   R15 RSTD;                                      0221 00765000
*                 RETCODE=R15;      /* SAVE THE RETURN CODE          */ 00766000
         ST    R15,RETCODE                                         0222 00767000
*                 RFY                                              0223 00768000
*                   R15 UNRSTD;                                    0223 00769000
*                 RFY                                              0224 00770000
*                   R8 RSTD;                                       0224 00771000
*                 R8=R13;           /* SAVE SAVEAREA POINTER GET   0225 00772000
*                                      LOCAL LOCK FOR ILRAFS00       */ 00773000
         LR    R8,R13                                              0225 00774000
*                 GENERATE SETS(R11,R12,R13,R14);                  0226 00775000
GET2     SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(VIO,           *00776000
               ILRVSAMI(REL2))                                          00777000
*                 R13=R8;           /* RESTORE SAVEAREA POINTER      */ 00778000
         LR    R13,R8                                              0227 00779000
*                 RFY                                              0228 00780000
*                   R8 UNRSTD;                                     0228 00781000
*                 IF RETCODE^=STORAGE/* DID WE OBTAIN I/O BUFFER?    */ 00782000
*                   THEN                                           0229 00783000
         CLC   RETCODE(4),@CF00122                                 0229 00784000
         BE    @RF00229                                            0229 00785000
*                   DO;             /* YES                           */ 00786000
*                     EPABASP=ZERO; /* ZERO RECOVERY'S POINTER TO I/O   00787000
*                                      BUFFER                        */ 00788000
         L     @12,EPAPTR                                          0231 00789000
         SLR   @11,@11                                             0231 00790000
         ST    @11,EPABASP(,@12)                                   0231 00791000
*                     RFY                                          0232 00792000
*                      (R0,                                        0232 00793000
*                       R1,                                        0232 00794000
*                       R3,                                        0232 00795000
*                       R4,                                        0232 00796000
*                       R7) RSTD;                                  0232 00797000
*                     R0=TWOK;      /* SET LENGTH FOR 2K I/O BUF     */ 00798000
         LA    R0,2048                                             0233 00799000
*                     R1=BUFFER;    /* GET ADDR OF BUFFER TO FREE    */ 00800000
         L     R1,BUFFER                                           0234 00801000
*                     R4=PSATOLD;   /* GET PTR TO CURRENT TCB        */ 00802000
         L     R4,PSATOLD                                          0235 00803000
*                     R7=PSAAOLD;   /* GET PTR TO CURRENT ASCB       */ 00804000
         L     R7,PSAAOLD                                          0236 00805000
*                     GENERATE REFS(R0,R1,R4,R7) SETS(R3);         0237 00806000
               FREEMAIN RC,SP=230,A=(1),LV=(0),BRANCH=YES               00807000
*                     RFY                                          0238 00808000
*                      (R0,                                        0238 00809000
*                       R1,                                        0238 00810000
*                       R3,                                        0238 00811000
*                       R4,                                        0238 00812000
*                       R7) UNRSTD;                                0238 00813000
*                   END;                                           0239 00814000
*                 ELSE                                             0240 00815000
*                   ;                                              0240 00816000
@RF00229 DS    0H                                                  0241 00817000
*                 ASSTEXT=ZERO;     /* FORCE EXIT FROM ASST LOOP     */ 00818000
         SLR   @12,@12                                             0241 00819000
         ST    @12,ASSTEXT                                         0241 00820000
*               END;                                               0242 00821000
*           END;                    /* PHYSICAL END OF DO WHILE LOOP    00822000
*                                      FOR ASST EXTENSIONS           */ 00823000
@RC00167 DS    0H                                                  0243 00824000
@DE00163 L     @12,ASSTEXT                                         0243 00825000
         LTR   @12,@12                                             0243 00826000
         BNZ   @DL00163                                            0243 00827000
*         END;                      /* END OF EXTENSION PROCESSING   */ 00828000
*     END;                          /* END FOR THEN DO GROUP FOR A 0245 00829000
*                                      ZERO RETURN CODE FROM GETONE     00830000
*                                      FOR THE ASPCT BASE            */ 00831000
         EJECT                                                          00832000
*                                                                  0246 00833000
*/********************************************************************/ 00834000
*/* PROCESS A NON-ZERO RETURN CODE FROM GETONE FOR THE ASPCT BASE    */ 00835000
*/********************************************************************/ 00836000
*                                                                  0246 00837000
*   ELSE                                                           0246 00838000
*     DO;                                                          0246 00839000
         B     @RC00145                                            0246 00840000
@RF00145 DS    0H                                                  0247 00841000
*       RFY                                                        0247 00842000
*         R15 RSTD;                                                0247 00843000
*       RETCODE=R15;                /* SAVE THE RETURN CODE          */ 00844000
         ST    R15,RETCODE                                         0248 00845000
*       RFY                                                        0249 00846000
*         R15 UNRSTD;                                              0249 00847000
*       IF RETCODE^=STORAGE         /* DID WE OBTAIN I/O BUFFER?     */ 00848000
*         THEN                                                     0250 00849000
         L     @12,RETCODE                                         0250 00850000
         C     @12,@CF00122                                        0250 00851000
         BE    @RF00250                                            0250 00852000
*         DO;                       /* YES                           */ 00853000
*           RFY                                                    0252 00854000
*            (R0,                                                  0252 00855000
*             R1,                                                  0252 00856000
*             R3,                                                  0252 00857000
*             R4,                                                  0252 00858000
*             R7,                                                  0252 00859000
*             R8) RSTD;                                            0252 00860000
*           R8=R13;                 /* SAVE SAVEAREA POINTER GET   0253 00861000
*                                      LOCAL LOCK                    */ 00862000
         LR    R8,R13                                              0253 00863000
*           GENERATE SETS(R3,R11,R12,R13,R14) REFS(EPAPTR);        0254 00864000
GET3     SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(VIO,           *00865000
               ILRVSAMI(REL1))                                          00866000
*                                                                       00867000
         LR    R13,R8                     RESTORE SAVEAREA POINTER      00868000
         L     R4,EPAPTR                  GET ADDRESS OF EPATH          00869000
         SLR   R7,R7                                                    00870000
         ST    R7,EPABASP(R4)             ZERO RECOVERYS POINTER TO     00871000
*                                         THE I/O BUFFER                00872000
         LA    R0,2048                    SET LENGTH FOR 2K BUFFER      00873000
         L     R1,BUFFER                  GET ADDR OF I/O BUFFER        00874000
         L     R4,PSATOLD                 GET PTR TO CURRENT TCB        00875000
         L     R7,PSAAOLD                 GET PTR TO CURRENT ASCB       00876000
         FREEMAIN RC,SP=230,A=(1),LV=(0),BRANCH=YES                     00877000
*                                                                       00878000
REL1     SETLOCK RELEASE,TYPE=LOCAL,RELATED=(VIO,ILRVSAMI(GET3))        00879000
*           R13=R8;                 /* RESTORE SAVEAREA POINTER      */ 00880000
         LR    R13,R8                                              0255 00881000
*           RFY                                                    0256 00882000
*            (R0,                                                  0256 00883000
*             R1,                                                  0256 00884000
*             R3,                                                  0256 00885000
*             R4,                                                  0256 00886000
*             R7,                                                  0256 00887000
*             R8) UNRSTD;                                          0256 00888000
*         END;                                                     0257 00889000
*     END;                                                         0258 00890000
@RF00250 DS    0H                                                  0259 00891000
         EJECT                                                          00892000
*                                                                  0259 00893000
*/********************************************************************/ 00894000
*/*  IF WE ENCOUNTERED ANY PROBLEMS WHILE TRYING TO RETRIEVE AN      */ 00895000
*/*  ASPCT BASE AND ITS ASST AND LPME EXTENSIONS, THIS SECTION WILL  */ 00896000
*/*  FREE ALL THE 2K I/O BUFFERS OBTAINED                            */ 00897000
*/********************************************************************/ 00898000
*                                                                  0259 00899000
*   IF RETCODE^=ZERO&RETASPCT^=ZERO /* WAS A NON-ZERO RETURN CODE  0259 00900000
*                                      SAVED AND WERE THERE        0259 00901000
*                                      EXTENSIONS?                   */ 00902000
*     THEN                                                         0259 00903000
@RC00145 SLR   @12,@12                                             0259 00904000
         C     @12,RETCODE                                         0259 00905000
         BE    @RF00259                                            0259 00906000
         L     @11,RETASPCT                                        0259 00907000
         CR    @11,@12                                             0259 00908000
         BE    @RF00259                                            0259 00909000
*     DO;                           /* YES                           */ 00910000
*       RFY                                                        0261 00911000
*        (R0,                                                      0261 00912000
*         R1) RSTD;                                                0261 00913000
*       EPARASP=ZERO;               /* ZERO RECOVERY'S POINTER TO THE   00914000
*                                      I/O BUFFER CHAIN              */ 00915000
         L     @08,EPAPTR                                          0262 00916000
         ST    @12,EPARASP(,@08)                                   0262 00917000
*       R1=RETASPCT;                /* GET ADDR OF ASPCT BASE        */ 00918000
         LR    R1,@11                                              0263 00919000
*       R0=TWOK;                    /* SET LENGTH FOR 2K BUFFERS     */ 00920000
         LA    R0,2048                                             0264 00921000
*       CALL ILRAFS00;              /* FREE THE I/O BUFFER CHAIN     */ 00922000
         BAL   @14,ILRAFS00                                        0265 00923000
*       RFY                                                        0266 00924000
*        (R8,                                                      0266 00925000
*         R15) RSTD;                                               0266 00926000
*       R8=R13;                     /* SAVE SAVEAREA POINTER RELEASE    00927000
*                                      THE LOCAL LOCK WHICH WAS    0267 00928000
*                                      OBTAINED DURING THE ERROR   0267 00929000
*                                      PROCESSING FOR ASST OR LPME 0267 00930000
*                                      EXTENSIONS                    */ 00931000
         LR    R8,R13                                              0267 00932000
*       GENERATE SETS(R11,R12,R13,R14);                            0268 00933000
REL2     SETLOCK RELEASE,TYPE=LOCAL,RELATED=(VIO,ILRVSAMI(GET1))        00934000
*       R13=R8;                     /* RESTORE SAVEAREA POINTER      */ 00935000
         LR    R13,R8                                              0269 00936000
*       RFY                                                        0270 00937000
*         R8 UNRSTD;                                               0270 00938000
*       IF R15^=ZERO                /* WAS ILRAFS00 SUCCESSFUL?      */ 00939000
*         THEN                                                     0271 00940000
         LTR   R15,R15                                             0271 00941000
         BZ    @RF00271                                            0271 00942000
*         DO;                       /* NO, RECORD THE ERROR          */ 00943000
*           STM(R0,R14,SAVREGSA);   /* SAVE REGS FOR RECOVERY        */ 00944000
         STM   R0,R14,SAVREGSA                                     0273 00945000
*           GEN(ABEND X'87',,,SYSTEM);                             0274 00946000
         ABEND X'87',,,SYSTEM                                           00947000
*         END;                                                     0275 00948000
*       RETASPCT=ZERO;              /* ZERO PTR TO ASPCT BASE        */ 00949000
@RF00271 SLR   @14,@14                                             0276 00950000
         ST    @14,RETASPCT                                        0276 00951000
*     END;                                                         0277 00952000
*   RFY                                                            0278 00953000
*     R14 RSTD;                                                    0278 00954000
@RF00259 DS    0H                                                  0279 00955000
*   R14=RETADDR1;                   /* GET RETURN ADDRESS            */ 00956000
         L     R14,RETADDR1                                        0279 00957000
*   R15=RETCODE;                    /* LOAD INTERNAL RETURN CODE     */ 00958000
         L     R15,RETCODE                                         0280 00959000
*   RETURN;                         /* RETURN TO MAINLINE            */ 00960000
@EL00002 DS    0H                                                  0281 00961000
@EF00002 DS    0H                                                  0281 00962000
@ER00002 BR    @14                                                 0281 00963000
*   RFY                                                            0282 00964000
*    (R0,                                                          0282 00965000
*     R1,                                                          0282 00966000
*     R14,                                                         0282 00967000
*     R15) UNRSTD;                                                 0282 00968000
*   END;                            /* END GETASPCT                  */ 00969000
         EJECT                                                          00970000
*                                                                  0284 00971000
*/********************************************************************/ 00972000
*/*                                                                  */ 00973000
*/*  PUTASPCT: WRITE AN ASPCT OUT TO SYS1.STGINDEX                   */ 00974000
*/*                                                                  */ 00975000
*/*  INPUT:    THE INPUT PARAMETER LIST                              */ 00976000
*/*              WORD 1 = 02 OP-CODE                                 */ 00977000
*/*              WORD 2 = PTR TO THE ASPCT BASE                      */ 00978000
*/*              WORD 3 = PTR TO THE EPATH                           */ 00979000
*/*                                                                  */ 00980000
*/*  PROCESS:  SAVE THE RETURN ADDRESS. COPY THE KEY FROM THE ASPCT  */ 00981000
*/*            BASE TO THE WORKAREA KEY. CALL PUTONE TO WRITE THE    */ 00982000
*/*            ASPCT BASE OUT TO SYS1.STGINDEX. IF THERE ARE NO      */ 00983000
*/*            EXTENSIONS, ZERO THE EPATH POINTER TO THE I/O BUFFER  */ 00984000
*/*            AND FREEMAIN THE I/O BUFFER. RETURN TO MAINLINE.      */ 00985000
*/*            SAVE THE NUMBER OF LPME AND ASST EXTENSIONS. GET THE  */ 00986000
*/*            POINTER TO AN ASST EXTENSION. COPY THE KEY TO THE     */ 00987000
*/*            WORKAREA KEY. CALL PUTONEA TO WRITE THE ASST EXTENSION*/ 00988000
*/*            OUT. NOW GET THE POINTER TO THE LPME EXTENSION. LOOP  */ 00989000
*/*            THROUGH ALL LPME EXTENSIONS FOR THIS ASST EXTENSION,  */ 00990000
*/*            CALLING PUTONEA TO WRITE EACH EXTENSION OUT. ONCE     */ 00991000
*/*            WE HAVE WRITTEN ALL THE LPME EXTENSIONS FOR THIS ASST */ 00992000
*/*            EXTENSION, LOOP BACK AND GET THE NEXT ASST EXTENSION. */ 00993000
*/*            ONCE ALL EXTENSIONS HAVE BEEN WRITTEN, FREEMAIN THE   */ 00994000
*/*            I/O BUFFER AND RETURN TO MAINLINE.                    */ 00995000
*/*            IF ANY OF THE WRITES FAIL, ALL RECORDS ALREADY WRITTEN*/ 00996000
*/*            ARE ERASED FROM SYS1.STGINDEX                         */ 00997000
*/*                                                                  */ 00998000
*/*  OUTPUT:   THE ASPCT BASE AND ALL OF ITS EXTENSIONS HAVE BEEN    */ 00999000
*/*            WRITTEN OUT TO SYS1.STGINDEX                          */ 01000000
*/*                                                                  */ 01001000
*/********************************************************************/ 01002000
*/*PUTASPCT: CHART (AREF,SEQ)                                        */ 01003000
*/*HEADER                                                          0284 01004000
*/* PUTASPCT: WRITE AN ASPCT OUT TO SYS1.STGINDEX                    */ 01005000
*/*PUTASPCT: E ENTRY                                                 */ 01006000
*/*         P  SAVE THE RETURN ADDRESS                               */ 01007000
*/*         P  SET WORKAREA KEY FOR ASPCT BASE                       */ 01008000
*/*         P  LOAD REG 1 WITH PTR TO BASE                           */ 01009000
*/*         S  PUTONE: WRITE BASE TO STGINDEX                        */ 01010000
*/*         D  (YES,%VSM13,NO,) ZERO RETURN CODE?                    */ 01011000
*/*         P  SAVE THE RETURN CODE                                  */ 01012000
*/*         D  (YES,,NO,%VSM12) STORAGE OBTAINED?                    */ 01013000
*/*         L  SETLOCK: UNCOND OBTAIN LOCAL LOCK                     */ 01014000
*/*         P  ZERO THE EPATH PTR TO I/O BUFFER                      */ 01015000
*/*         P  LOAD REGISTERS FOR FREEMAIN                           */ 01016000
*/*         S  FREEMAIN: FREE THE BUFFER                             */ 01017000
*/*         L  SETLOCK: UNCOND RELEASE LOCAL LOCK                    */ 01018000
*/*%VSM12:  D  (YES,,NO,%VSM12A) INTERNAL RETURN CODE 24?            */ 01019000
*/*         P  SET RETURN CODE TO 20                                 */ 01020000
*/*         P  SET STGINDEX FULL FLAG                                */ 01021000
*/*%VSM12A: R  RETURN TO MAINLINE                                    */ 01022000
*/*%VSM13:  D  (YES,%VSM14,NO,) ANY EXTENSIONS?                      */ 01023000
*/*         L  SETLOCK: UNCOND OBTAIN LOCAL LOCK                     */ 01024000
*/*         P  ZERO EPATH PTR TO I/O BUFFER                          */ 01025000
*/*         P  LOAD REGISTERS FOR FREEMAIN                           */ 01026000
*/*         S  FREEMAIN: FREE THE I/O BUFFER                         */ 01027000
*/*         L  SETLOCK: UNCOND RELEASE LOCAL LOCK                    */ 01028000
*/*         R  RETURN TO MAINLINE                                    */ 01029000
*/*%VSM14:  P  SAVE THE LPME EXT COUNTER (ASPLEXCT)                  */ 01030000
*/*         P  SAVE THE ASST EXT COUNTER (ASPAEXCT)                  */ 01031000
*/*%VSM15:  P  GET PTR TO AN ASST EXT FROM BASE (ASPASSTP)           */ 01032000
*/*         P  SET WORKAREA KEY FOR ASST EXTENSION                   */ 01033000
*/*         P  LOAD REG 1 WITH PTR TO ASST EXTENSION                 */ 01034000
*/*         S  PUTONEA: WRITE ASST EXT TO STGINDEX                   */ 01035000
*/*         D  (YES,,NO,%VSM19) ZERO RETURN CODE?                    */ 01036000
*/*         P  DECREMENT THE ASST EXT COUNTER                        */ 01037000
*/*%VSM16:  P  LOAD REG 1 WITH PTR TO LPME EXT FROM ASST EXT         */ 01038000
*/*         P  SET WORKAREA KEY FOR LPME EXTENSION                   */ 01039000
*/*         S  PUTONEA: WRITE LPME EXT TO STGINDEX                   */ 01040000
*/*         D  (YES,,NO,%VSM19) ZERO RETURN CODE?                    */ 01041000
*/*         P  DECREMENT THE LPME EXT COUNTER                        */ 01042000
*/*         D  (YES,%VSM17,NO,) LPME EXT COUNTER = 0?                */ 01043000
*/*         P  INCREMENT THE ASST ARRAY SUBSCRIPT                    */ 01044000
*/*         D  (YES,,NO,%VSM16) REACHED END OF ARRAY?                */ 01045000
*/*         P  RESET SUBSCRIPT TO BEGINNING OF ARRAY                 */ 01046000
*/*%VSM17:  D  (YES,%VSM18,NO,) ASST EXT COUNTER = 0?                */ 01047000
*/*         P  INCREMENT THE BASE ARRAY SUBSCRIPT                    */ 01048000
*/*         D  (YES,,NO,%VSM15) REACHED END OF ARRAY?                */ 01049000
*/*%VSM18:  L  SETLOCK: UNCOND OBTAIN LOCAL LOCK                     */ 01050000
*/*         P  LOAD REGISTERS FOR FREEMAIN                           */ 01051000
*/*         P  ZERO PTR TO BUFFER IN EPATH                           */ 01052000
*/*         S  FREEMAIN: FREE THE BUFFER                             */ 01053000
*/*         L  SETLOCK: UNCOND RELEASE LOCAL LOCK                    */ 01054000
*/*         P  LOAD INTERNAL RETURN CODE                             */ 01055000
*/*         D  (YES,,NO,%VSM18A) INTERNAL RETURN CODE 24?            */ 01056000
*/*         P  SET THE STGINDEX FULL FLAG                            */ 01057000
*/*         P  SET RETURN CODE TO 20                                 */ 01058000
*/*%VSM18A: R  RETURN TO MAINLINE                                    */ 01059000
*/*%VSM19:  P  CALCULATE THE NUMBER OF ASST EXT WRITTEN              */ 01060000
*/*         P  CALCULATE THE NUMBER OF LPME EXT WRITTEN              */ 01061000
*/*         P  SET WORKAREA KEY FOR BASE                             */ 01062000
*/*         P  LOAD REG FOR ERASE                                    */ 01063000
*/*         S  ERASE: THE ASPCT BASE                                 */ 01064000
*/*%VSM20:  D  (YES,%VSM21,NO,) ASST EXT COUNT ZERO?                 */ 01065000
*/*         P  SET WORKAREA KEY                                      */ 01066000
*/*         P  LOAD REG FOR ERASE                                    */ 01067000
*/*         S  ERASE: AN ASST EXTENSION                              */ 01068000
*/*         P  (,%VSM20) DECREMENT THE ASST COUNT                    */ 01069000
*/*%VSM21:  P  RESET WKA KEY FOR BASE                                */ 01070000
*/*         P  INCREMENT KEY BY ONE                                  */ 01071000
*/*%VSM22:  D  (YES,%VSM18,NO,) LPME EXT COUNT ZERO?                 */ 01072000
*/*         P  INCREMENT THE WKA KEY                                 */ 01073000
*/*         P  LOAD REG FOR ERASE                                    */ 01074000
*/*         S  ERASE: AN LPME EXTENSION                              */ 01075000
*/*         P  DECREMENT THE LPME EXT COUNT                          */ 01076000
*/*         P  INCREMENT ARRAY COUNTER                               */ 01077000
*/*         D  (YES,,NO,%VSM22) REACHED END OF AN ASST ARRAY?        */ 01078000
*/*         P  RESET ARRAY COUNTER                                   */ 01079000
*/*         P  (,%VSM22) INCREMENT WKA KEY                           */ 01080000
*/*PUTASPCT: END                                                     */ 01081000
*                                                                  0284 01082000
         EJECT                                                          01083000
*PUTASPCT:                                                         0284 01084000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0284 01085000
PUTASPCT DS    0H                                                  0285 01086000
*   RFY                                                            0285 01087000
*     R14 RSTD;                                                    0285 01088000
*   RETADDR1=R14;                   /* SAVE THE RETURN ADDRESS       */ 01089000
         ST    R14,RETADDR1                                        0286 01090000
*   RFY                                                            0287 01091000
*     R14 UNRSTD;                                                  0287 01092000
*                                                                  0287 01093000
*/****************************************************************** */ 01094000
*/* BUILD THE WRITE KEY FOR VSAM, AND CALL PUTONE TO WRITE THE       */ 01095000
*/* ASPCT BASE OUT TO SYS1.STGINDEX.                                 */ 01096000
*/****************************************************************** */ 01097000
*                                                                  0288 01098000
*   ASPCTPTR=BASEPTR;               /* GET PTR TO ASPCT BASE FROM  0288 01099000
*                                      INPUT PARM LIST               */ 01100000
         L     @12,PARMPTR                                         0288 01101000
         L     @12,BASEPTR(,@12)                                   0288 01102000
         ST    @12,ASPCTPTR                                        0288 01103000
*   WKAVKEY=ASPBKEY;                /* SET WORKAREA VSAM KEY TO THE     01104000
*                                      VSAM KEY IN ASPCT BASE        */ 01105000
         MVC   WKAVKEY(12),ASPBKEY(@12)                            0289 01106000
*   RETCODE=ZERO;                   /* INIT INTERNAL RETURN CODE TO     01107000
*                                      ZERO                          */ 01108000
         SLR   @11,@11                                             0290 01109000
         ST    @11,RETCODE                                         0290 01110000
*   BACKOUT=OFF;                    /* INIT ERROR FLAG AS OFF        */ 01111000
         NI    BACKOUT,B'01111111'                                 0291 01112000
*   EPARPLB=OFF;                    /* SET RPL BUILT FLAG OFF        */ 01113000
         L     @11,EPAPTR                                          0292 01114000
         NI    EPARPLB(@11),B'11111110'                            0292 01115000
*   RFY                                                            0293 01116000
*     R1 RSTD;                                                     0293 01117000
*   R1=ASPCTPTR;                    /* GET PTR TO ASPCT BASE         */ 01118000
         LR    R1,@12                                              0294 01119000
*   CALL PUTONE;                    /* WRITE THE ASPCT BASE OUT TO 0295 01120000
*                                      SYS1.STGINDEX                 */ 01121000
         BAL   @14,PUTONE                                          0295 01122000
         EJECT                                                          01123000
*                                                                  0296 01124000
*/****************************************************************** */ 01125000
*/* IF THE BASE WAS SUCCESSFULLY WRITTEN, AND THERE ARE              */ 01126000
*/* EXTENSIONS.                                                      */ 01127000
*/****************************************************************** */ 01128000
*                                                                  0296 01129000
*   RFY                                                            0296 01130000
*     R15 RSTD;                                                    0296 01131000
*   IF R15=ZERO                     /* WAS WRITE SUCCESSFUL?         */ 01132000
*     THEN                                                         0297 01133000
         SLR   @14,@14                                             0297 01134000
         CR    R15,@14                                             0297 01135000
         BNE   @RF00297                                            0297 01136000
*     DO;                           /* YES                           */ 01137000
*       RFY                                                        0299 01138000
*        (R1,                                                      0299 01139000
*         R15) UNRSTD;                                             0299 01140000
*       IF ASPAEXCT^=ZERO           /* ARE THERE ANY EXTENSIONS?     */ 01141000
*         THEN                                                     0300 01142000
         L     @12,ASPCTPTR                                        0300 01143000
         LH    @11,ASPAEXCT(,@12)                                  0300 01144000
         CR    @11,@14                                             0300 01145000
         BE    @RF00300                                            0300 01146000
*         DO;                       /* YES                           */ 01147000
         EJECT                                                          01148000
*                                                                  0302 01149000
*/********************************************************************/ 01150000
*/*                                                                  */ 01151000
*/*      PROCESS  EXTENSIONS                                         */ 01152000
*/*                                                                  */ 01153000
*/********************************************************************/ 01154000
*                                                                  0302 01155000
*           LPMEXT=ASPLEXCT;        /* GET NUMBER OF LPME EXTS       */ 01156000
         LH    @12,ASPLEXCT(,@12)                                  0302 01157000
         ST    @12,LPMEXT                                          0302 01158000
*           ASSTEXT=ASPAEXCT;       /* GET NUMBER OF ASST EXTS       */ 01159000
         ST    @11,ASSTEXT                                         0303 01160000
*           ASSTCNTL=ASSTEXT;       /* SET ASST LOOP CONTROLLER      */ 01161000
         ST    @11,ASSTCNTL                                        0304 01162000
*           BASE=ONE;               /* INIT BASE ARRAY SUBSCRIPT     */ 01163000
         MVC   BASE(4),@CF00098                                    0305 01164000
*           ASST=TWO;               /* INIT ASST ARRAY SUBSCRIPT     */ 01165000
         MVC   ASST(4),@CF00114                                    0306 01166000
*/********************************************************************/ 01167000
*/*  PROCESS  ASST  EXTENSIONS                                       */ 01168000
*/********************************************************************/ 01169000
*                                                                  0307 01170000
*           DO WHILE ASSTCNTL^=ZERO;/* LOOP UNTIL ALL ASST EXTENSIONS   01171000
*                                      ARE PROCESSED                 */ 01172000
         B     @DE00307                                            0307 01173000
@DL00307 DS    0H                                                  0308 01174000
*             ASPEXPTR=ASPASSTP(BASE);/* GET PTR TO ASST EXTENSION   */ 01175000
         L     @12,ASPCTPTR                                        0308 01176000
         L     @11,BASE                                            0308 01177000
         SLA   @11,2                                               0308 01178000
         L     @11,ASPASSTP-4(@11,@12)                             0308 01179000
         ST    @11,ASPEXPTR                                        0308 01180000
*             ASPESSYM=ASPSSYM;     /* MOVE 'S' SYM TO ASST EXTENSION*/ 01181000
         MVC   ASPESSYM(8,@11),ASPSSYM(@12)                        0309 01182000
*             WKAVKEY=ASPEXKEY;     /* COPY VSAM KEY TO WORKAREA     */ 01183000
         MVC   WKAVKEY(12),ASPEXKEY(@11)                           0310 01184000
*             RFY                                                  0311 01185000
*               R1 RSTD;                                           0311 01186000
*             R1=ASPEXPTR;          /* GET PTR TO ASST EXTENSION     */ 01187000
         LR    R1,@11                                              0312 01188000
*             CALL PUTONEA;         /* WRITE THE ASST EXTENSION OUT     01189000
*                                      TO SYS1.STGINDEX              */ 01190000
         BAL   @14,PUTONEA                                         0313 01191000
*             RFY                                                  0314 01192000
*               R15 RSTD;                                          0314 01193000
*             IF R15=ZERO           /* WAS WRITE SUCCESSFUL?         */ 01194000
*               THEN                                               0315 01195000
         LTR   R15,R15                                             0315 01196000
         BNZ   @RF00315                                            0315 01197000
*               DO;                 /* YES                           */ 01198000
*                 RFY                                              0317 01199000
*                  (R1,                                            0317 01200000
*                   R15) UNRSTD;                                   0317 01201000
*                 ASSTCNTL=ASSTCNTL-ONE;/* DECREMENT LOOP CONTROLLER */ 01202000
         L     @12,ASSTCNTL                                        0318 01203000
         BCTR  @12,0                                               0318 01204000
         ST    @12,ASSTCNTL                                        0318 01205000
*                 ASSTEXT=ASSTEXT-ONE;/* DECREMENT ASST EXT COUNT    */ 01206000
         L     @12,ASSTEXT                                         0319 01207000
         BCTR  @12,0                                               0319 01208000
         ST    @12,ASSTEXT                                         0319 01209000
*                 IF LPMEXT>=ASPNLPME/* MORE THAN ONE ASST EXT?      */ 01210000
*                   THEN            /* YES                           */ 01211000
         L     @12,LPMEXT                                          0320 01212000
         C     @12,@CF00150                                        0320 01213000
         BL    @RF00320                                            0320 01214000
*                   IF BASE=ONE     /* IS THIS FIRST ASST EXT        */ 01215000
*                     THEN          /* YES,ALLOW FOR LPMES IN BASE   */ 01216000
         CLC   BASE(4),@CF00098                                    0321 01217000
         BNE   @RF00321                                            0321 01218000
*                     LPMECNTL=ASPNLPME-ONE;                       0322 01219000
         MVC   LPMECNTL(4),@CF01539                                0322 01220000
*                   ELSE            /* NO, SET FOR FULL ASST EXT     */ 01221000
*                     LPMECNTL=ASPNLPME;                           0323 01222000
         B     @RC00321                                            0323 01223000
@RF00321 MVC   LPMECNTL(4),@CF00150                                0323 01224000
*                 ELSE              /* NO, ONLY PARTIAL ASST EXT     */ 01225000
*                   LPMECNTL=LPMEXT;                               0324 01226000
         B     @RC00320                                            0324 01227000
@RF00320 L     @12,LPMEXT                                          0324 01228000
         ST    @12,LPMECNTL                                        0324 01229000
*                 BASE=BASE+ONE;    /* INCREMENT BASE SUBSCRIPT      */ 01230000
@RC00320 LA    @12,1                                               0325 01231000
         AL    @12,BASE                                            0325 01232000
         ST    @12,BASE                                            0325 01233000
         EJECT                                                          01234000
*                                                                  0326 01235000
*/********************************************************************/ 01236000
*/*  PROCESS  LPME  EXTENSIONS                                       */ 01237000
*/********************************************************************/ 01238000
*                                                                  0326 01239000
*                 DO WHILE LPMECNTL^=ZERO;/* LOOP UNTIL ALL LPME'S 0326 01240000
*                                      HAVE BEEN PROCESSED FOR THIS     01241000
*                                      ASST EXTENSION                */ 01242000
         B     @DE00326                                            0326 01243000
@DL00326 DS    0H                                                  0327 01244000
*                   ASPASSTE(ASST)->ASPESSYM=ASPSSYM;/* MOVE 'S' SYM    01245000
*                                      TO LPME EXTENSION             */ 01246000
         L     @12,ASST                                            0327 01247000
         SLA   @12,2                                               0327 01248000
         L     @11,ASPEXPTR                                        0327 01249000
         L     @12,ASPASSTE-4(@12,@11)                             0327 01250000
         L     @11,ASPCTPTR                                        0327 01251000
         MVC   ASPESSYM(8,@12),ASPSSYM(@11)                        0327 01252000
*                   WKAVKEY=ASPASSTE(ASST)->ASPEXKEY;/* COPY VSAM KEY   01253000
*                                      FROM LPME EXT TO WORKAREA     */ 01254000
         MVC   WKAVKEY(12),ASPEXKEY(@12)                           0328 01255000
*                   RFY                                            0329 01256000
*                     R1 RSTD;                                     0329 01257000
*                   R1=ASPASSTE(ASST);/* GET PTR TO LPME EXTENSION   */ 01258000
         LR    R1,@12                                              0330 01259000
*                   CALL PUTONEA;   /* WRITE THE LPME EXTENSION OUT     01260000
*                                      TO SYS1.STGINDEX              */ 01261000
         BAL   @14,PUTONEA                                         0331 01262000
*                   RFY                                            0332 01263000
*                     R15 RSTD;                                    0332 01264000
*                   IF R15=ZERO     /* WRITE SUCCESSFUL?             */ 01265000
*                     THEN                                         0333 01266000
         LTR   R15,R15                                             0333 01267000
         BNZ   @RF00333                                            0333 01268000
*                     DO;           /* YES                           */ 01269000
*                       RFY                                        0335 01270000
*                        (R1,                                      0335 01271000
*                         R15) UNRSTD;                             0335 01272000
*                       LPMECNTL=LPMECNTL-ONE;/* DECREMENT LOOP    0336 01273000
*                                      CONTROLLER                    */ 01274000
         L     @12,LPMECNTL                                        0336 01275000
         BCTR  @12,0                                               0336 01276000
         ST    @12,LPMECNTL                                        0336 01277000
*                       LPMEXT=LPMEXT-ONE;/* DECREMENT LPME EXT COUNT*/ 01278000
         L     @12,LPMEXT                                          0337 01279000
         BCTR  @12,0                                               0337 01280000
         ST    @12,LPMEXT                                          0337 01281000
*                       ASST=ASST+ONE;/* INCREMENT ASST SUBSCRIPT    */ 01282000
         LA    @12,1                                               0338 01283000
         L     @11,ASST                                            0338 01284000
         ALR   @11,@12                                             0338 01285000
         ST    @11,ASST                                            0338 01286000
*                       IF ASST>ASPNASST/* REACHED END OF ARRAY?     */ 01287000
*                         THEN      /* YES                           */ 01288000
         C     @11,@CF00150                                        0339 01289000
         BNH   @RF00339                                            0339 01290000
*                         ASST=ONE; /* RESET FOR NEXT ARRAY          */ 01291000
         ST    @12,ASST                                            0340 01292000
*                     END;                                         0341 01293000
         EJECT                                                          01294000
*                                                                  0342 01295000
*/********************************************************************/ 01296000
*/* PROCESS A NON-ZERO RETURN CODE FROM PUTONEA FOR LPME EXTENSIONS  */ 01297000
*/********************************************************************/ 01298000
*                                                                  0342 01299000
*                   ELSE                                           0342 01300000
*                     DO;                                          0342 01301000
         B     @RC00333                                            0342 01302000
@RF00333 DS    0H                                                  0343 01303000
*                       RFY                                        0343 01304000
*                         R15 RSTD;                                0343 01305000
*                       RETCODE=R15;/* SAVE THE RETURN CODE          */ 01306000
         ST    R15,RETCODE                                         0344 01307000
*                       RFY                                        0345 01308000
*                         R15 UNRSTD;                              0345 01309000
*                       LPMECNTL=ZERO;/* FORCE LPME LOOP EXIT        */ 01310000
         SLR   @12,@12                                             0346 01311000
         ST    @12,LPMECNTL                                        0346 01312000
*                       ASSTCNTL=ZERO;/* FORCE ASST LOOP EXIT        */ 01313000
         ST    @12,ASSTCNTL                                        0347 01314000
*                       BACKOUT=ON; /* INDICATE WE HAD AN ERROR AND     01315000
*                                      BACKOUT PROCESSING REQ        */ 01316000
         OI    BACKOUT,B'10000000'                                 0348 01317000
*                     END;                                         0349 01318000
*                 END;              /* END PROCESSING OF LPME EXTS   */ 01319000
@RC00333 DS    0H                                                  0350 01320000
@DE00326 L     @12,LPMECNTL                                        0350 01321000
         LTR   @12,@12                                             0350 01322000
         BNZ   @DL00326                                            0350 01323000
*               END;                                               0351 01324000
         EJECT                                                          01325000
*                                                                  0352 01326000
*/********************************************************************/ 01327000
*/* PROCESS A NON-ZERO RETURN CODE FROM PUTONEA FOR ASST EXTENSIONS  */ 01328000
*/********************************************************************/ 01329000
*                                                                  0352 01330000
*             ELSE                                                 0352 01331000
*               DO;                                                0352 01332000
         B     @RC00315                                            0352 01333000
@RF00315 DS    0H                                                  0353 01334000
*                 RFY                                              0353 01335000
*                   R15 RSTD;                                      0353 01336000
*                 RETCODE=R15;      /* SAVE THE RETURN CODE          */ 01337000
         ST    R15,RETCODE                                         0354 01338000
*                 RFY                                              0355 01339000
*                   R15 UNRSTD;                                    0355 01340000
*                 ASSTCNTL=ZERO;    /* FORCE ASST LOOP EXIT          */ 01341000
         SLR   @12,@12                                             0356 01342000
         ST    @12,ASSTCNTL                                        0356 01343000
*                 BACKOUT=ON;       /* INDICATE WE HAD AN ERROR AND     01344000
*                                      BACKOUT PROCESSING REQ        */ 01345000
         OI    BACKOUT,B'10000000'                                 0357 01346000
*               END;                                               0358 01347000
*           END;                    /* END ASST EXT PROCESSING       */ 01348000
@RC00315 DS    0H                                                  0359 01349000
@DE00307 L     @12,ASSTCNTL                                        0359 01350000
         LTR   @12,@12                                             0359 01351000
         BNZ   @DL00307                                            0359 01352000
*         END;                      /* END EXTENSION PROCESSING      */ 01353000
*     END;                                                         0361 01354000
         EJECT                                                          01355000
*                                                                  0362 01356000
*/********************************************************************/ 01357000
*/* PROCESS A NON-ZERO RETURN CODE FROM PUTONE FOR ASPCT BASE        */ 01358000
*/********************************************************************/ 01359000
*                                                                  0362 01360000
*   ELSE                                                           0362 01361000
*     DO;                                                          0362 01362000
         B     @RC00297                                            0362 01363000
@RF00297 DS    0H                                                  0363 01364000
*       RFY                                                        0363 01365000
*         R15 RSTD;                                                0363 01366000
*       RETCODE=R15;                /* SAVE THE RETURN CODE          */ 01367000
         ST    R15,RETCODE                                         0364 01368000
*       IF EPARPLB=ON THEN                                         0365 01369000
         L     @14,EPAPTR                                          0365 01370000
         TM    EPARPLB(@14),B'00000001'                            0365 01371000
         BNO   @RF00365                                            0365 01372000
*         BACKOUT=ON;               /* INDICATE WE HAD AN ERROR AND     01373000
*                                      BACKOUT PROCESSING REQ        */ 01374000
         OI    BACKOUT,B'10000000'                                 0366 01375000
*       RFY                                                        0367 01376000
*         R15 UNRSTD;                                              0367 01377000
@RF00365 DS    0H                                                  0368 01378000
*     END;                                                         0368 01379000
         EJECT                                                          01380000
*                                                                  0369 01381000
*/********************************************************************/ 01382000
*/*                                                                  */ 01383000
*/* THIS SECTION WILL PERFORM ALL NECESSARY BACKOUT LOGIC. IF WE     */ 01384000
*/* COULD NOT WRITE AN ASPCT BASE AND ALL ITS EXTENSIONS OUT, WE     */ 01385000
*/* HAVE TO ERASE THOSE RECORDS WHICH WERE WRITTEN OUT TO AVOID      */ 01386000
*/* LOSING SLOTS ON SYS1.STGINDEX.                                   */ 01387000
*/*                                                                  */ 01388000
*/********************************************************************/ 01389000
*                                                                  0369 01390000
*   IF BACKOUT=ON                   /* WAS THERE AN ERROR?           */ 01391000
*     THEN                                                         0369 01392000
@RC00297 TM    BACKOUT,B'10000000'                                 0369 01393000
         BNO   @RF00369                                            0369 01394000
*     DO;                           /* YES                           */ 01395000
*       RFY                                                        0371 01396000
*        (R5,                                                      0371 01397000
*         R7) RSTD;                                                0371 01398000
*       R5=RPLPTR;                  /* OBTAIN RPL ADDR               */ 01399000
         L     R5,RPLPTR                                           0372 01400000
*       R7=ADDR(RECADDR);           /* ADDR AREA TO STORE ADDR OF  0373 01401000
*                                      RECORD LOCATED                */ 01402000
         LA    R7,RECADDR                                          0373 01403000
*       GEN(MODCB RPL=(5),OPTCD=(LOC,UPD),AREALEN=4,AREA=(7));/*   0374 01404000
*                                      CHANGE MVE AND NUP OPTIONS TO    01405000
*                                      LOC AND UPD                   */ 01406000
         MODCB RPL=(5),OPTCD=(LOC,UPD),AREALEN=4,AREA=(7)               01407000
*       DO WHILE EXTNUMB>=ZERO;     /* WORK BACKWARDS ERASING ALL  0375 01408000
*                                      EXTENSIONS WRITTEN OUT        */ 01409000
         B     @DE00375                                            0375 01410000
@DL00375 DS    0H                                                  0376 01411000
*         GEN(GET RPL=(5));         /* GET THE RECORD                */ 01412000
         GET RPL=(5)                                                    01413000
*         GEN(ERASE RPL=(5));       /* ERASE THE RECORD              */ 01414000
         ERASE RPL=(5)                                                  01415000
*         EXTNUMB=EXTNUMB-ONE;      /* DECREMENT KEY                 */ 01416000
         L     @12,EXTNUMB                                         0378 01417000
         BCTR  @12,0                                               0378 01418000
         ST    @12,EXTNUMB                                         0378 01419000
*       END;                                                       0379 01420000
@DE00375 L     @12,EXTNUMB                                         0379 01421000
         LTR   @12,@12                                             0379 01422000
         BNM   @DL00375                                            0379 01423000
*       RFY                                                        0380 01424000
*        (R5,                                                      0380 01425000
*         R7) UNRSTD;                                              0380 01426000
*     END;                                                         0381 01427000
*   ELSE                                                           0382 01428000
*     ;                                                            0382 01429000
@RF00369 DS    0H                                                  0383 01430000
         EJECT                                                          01431000
*   IF BUFFER^=ZERO                 /* WAS AN I/O BUFFER OBTAINED?   */ 01432000
*     THEN                                                         0383 01433000
         L     @12,BUFFER                                          0383 01434000
         LTR   @12,@12                                             0383 01435000
         BZ    @RF00383                                            0383 01436000
*     DO;                           /* YES, FREE BUFFER STORAGE      */ 01437000
*       RFY                                                        0385 01438000
*        (R0,                                                      0385 01439000
*         R1,                                                      0385 01440000
*         R3,                                                      0385 01441000
*         R4,                                                      0385 01442000
*         R7,                                                      0385 01443000
*         R8) RSTD;                                                0385 01444000
*       R8=R13;                     /* SAVE SAVEAREA POINTER OBTAIN     01445000
*                                      THE LOCAL LOCK                */ 01446000
         LR    R8,R13                                              0386 01447000
*       GENERATE SETS(R3,R11,R12,R13,R14) REFS(EPAPTR);            0387 01448000
GET5     SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(VIO,           *01449000
               ILRVSAMI(REL4))                                          01450000
         LR    R13,R8                     RESTORE SAVEAREA POINTER      01451000
         L     R4,EPAPTR                  GET ADDRESS OF EPATH          01452000
         SLR   R7,R7                                                    01453000
         ST    R7,EPABASP(R4)             ZERO RECOVERY POINTER TO      01454000
*                                         THE I/O BUFFER                01455000
         LA    R0,2048                    SET BUFFER LENGTH OF 2K       01456000
         L     R1,BUFFER                  SET FREEMAIN ADDRESS          01457000
         L     R4,PSATOLD                 GET CURRENT TCB ADDRESS       01458000
         L     R7,PSAAOLD                 GET CURRENT ASCB ADDRESS      01459000
         FREEMAIN RC,A=(1),LV=(0),SP=230,BRANCH=YES                     01460000
*                                                                       01461000
REL4     SETLOCK RELEASE,TYPE=LOCAL,RELATED=(VIO,ILRVSAMI(GET5))        01462000
*       R13=R8;                     /* RESTORE SAVEAREA POINTER      */ 01463000
         LR    R13,R8                                              0388 01464000
*       RFY                                                        0389 01465000
*        (R0,                                                      0389 01466000
*         R1,                                                      0389 01467000
*         R3,                                                      0389 01468000
*         R4,                                                      0389 01469000
*         R7,                                                      0389 01470000
*         R8) UNRSTD;                                              0389 01471000
*     END;                                                         0390 01472000
*   ELSE                                                           0391 01473000
*     ;                                                            0391 01474000
@RF00383 DS    0H                                                  0392 01475000
*   IF RETCODE=NOROOM               /* IS STGINDEX FULL?             */ 01476000
*     THEN                                                         0392 01477000
         CLC   RETCODE(4),@CF00141                                 0392 01478000
         BNE   @RF00392                                            0392 01479000
*     DO;                           /* YES                           */ 01480000
*       ASMNOSAV=ON;                /* INDICATE SAVING OF VIO ASPCTS    01481000
*                                      IS SUSPENDED UNTIL SLOTS ARE     01482000
*                                      RELEASED ON SYS1.STGINDEX     */ 01483000
         L     @12,ASMVTWPT                                        0394 01484000
         OI    ASMNOSAV(@12),B'01000000'                           0394 01485000
*       RETCODE=TWENTY;                                            0395 01486000
         MVC   RETCODE(4),@CF00120                                 0395 01487000
*     END;                                                         0396 01488000
*   RFY                                                            0397 01489000
*    (R14,                                                         0397 01490000
*     R15) RSTD;                                                   0397 01491000
@RF00392 DS    0H                                                  0398 01492000
*   R15=RETCODE;                    /* LOAD INTERNAL RETURN CODE     */ 01493000
         L     R15,RETCODE                                         0398 01494000
*   R14=RETADDR1;                   /* GET RETURN ADDRESS            */ 01495000
         L     R14,RETADDR1                                        0399 01496000
*   END PUTASPCT;                                                  0400 01497000
@EL00003 DS    0H                                                  0400 01498000
@EF00003 DS    0H                                                  0400 01499000
@ER00003 BR    @14                                                 0400 01500000
*   RFY                                                            0401 01501000
*    (R14,                                                         0401 01502000
*     R15) UNRSTD;                                                 0401 01503000
         EJECT                                                          01504000
*                                                                  0402 01505000
*/********************************************************************/ 01506000
*/*                                                                  */ 01507000
*/*  RETERASE: RETRIEVE AND ERASE AN ASPCT                           */ 01508000
*/*                                                                  */ 01509000
*/*  INPUT:    THE INPUT PARAMETER LIST                              */ 01510000
*/*              WORD 1 = 03 OR 04 OP-CODE                           */ 01511000
*/*              WORD 2 = PTR TO 8-BYTE 'S' SYMBOL                   */ 01512000
*/*              WORD 3 = PTR TO THE EPATH                           */ 01513000
*/*                                                                  */ 01514000
*/*  PROCESS:  SAVE THE RETURN ADDRESS. COPY THE 'S' SYMBOL TO THE   */ 01515000
*/*            WORKAREA KEY. CALL GETONE TO RETRIEVE THE ASPCT BASE. */ 01516000
*/*            ISSUE AN ERASE OF THE ASPCT BASE. IF THERE ARE NO     */ 01517000
*/*            EXTENSIONS RETURN TO MAINLINE.                        */ 01518000
*/*            SAVE THE NUMBER OF LPME AND ASST EXTENSIONS. ZERO     */ 01519000
*/*            THESE COUNTS AND THE POINTERS TO THE ASST EXTENSIONS  */ 01520000
*/*            IN THE ASPCT BASE. RECORD THE POINTER TO THE ASPCT    */ 01521000
*/*            BASE IN THE EPATH. INCREMENT THE WORKAREA KEY FOR AN  */ 01522000
*/*            ASST EXTENSION. CALL GETONE TO RETRIEVE AN ASST EXT.  */ 01523000
*/*            ZERO THE POINTERS TO THE LPME EXTENSIONS IN THE ASST  */ 01524000
*/*            EXT. STORE POINTER TO ASST EXT. IN THE BASE. ISSUE AN */ 01525000
*/*            ERASE OF THE ASST EXT. NOW LOOP THROUGH RETRIEVING AND*/ 01526000
*/*            ERASING THE LPME EXTS FOR THIS ASST EXT. GETONE IS    */ 01527000
*/*            USED TO RETRIEVE EACH LPME EXT. POINTERS TO THE LPME  */ 01528000
*/*            EXTS ARE STORED IN THE ASST EXT. ONCE ALL LPME EXT.   */ 01529000
*/*            HAVE BEEN READ FOR THIS ASST EXT. LOOP BACK AND       */ 01530000
*/*            RETRIEVE THE NEXT ASST EXT. ONCE ALL EXTENSIONS HAVE  */ 01531000
*/*            BEEN RETRIEVED AND ERASED, RETURN TO MAINLINE.        */ 01532000
*/*            IF EITHER A GET OR AN ERASE REQUEST FAIL, AND THIS IS */ 01533000
*/*            A 03 REQUEST, THE STORAGE USED FOR THE RETRIEVED ASPCT*/ 01534000
*/*            BASE AND THOSE EXTENSIONS WHICH HAVE BEEN RETRIEVED   */ 01535000
*/*            IS FREED.                                             */ 01536000
*/*            IF EITHER A GET OR AN ERASE REQUEST FAIL, AND THIS IS */ 01537000
*/*            A 04 REQUEST, THE REMAINING EXTENSIONS ARE ERASED FROM*/ 01538000
*/*            SYS1.STGINDEX, AND WHATEVER WAS RETRIEVED IS RETURNED */ 01539000
*/*            TO THE CALLER.                                        */ 01540000
*/*                                                                  */ 01541000
*/*  OUTPUT:   THE ASPCT BASE AND ALL ITS EXTENSIONS HAS BEEN        */ 01542000
*/*            RETRIEVED AND THEN ERASED FROM SYS1.STGINDEX.         */ 01543000
*/*                                                                  */ 01544000
*/********************************************************************/ 01545000
*/*RETERASE: CHART (AREF,SEQ)                                        */ 01546000
*/*HEADER                                                          0402 01547000
*/* RETERASE: RETRIEVED & ERASE ASPCT'S FROM SYS1.STGINDEX           */ 01548000
*/*RETERASE: E ENTRY                                                 */ 01549000
*/*         P  SAVE THE RETURN ADDRESS                               */ 01550000
*/*         P  SET WORKAREA KEY FOR BASE                             */ 01551000
*/*         S  GETONE: RETRIEVE THE BASE                             */ 01552000
*/*         D  (YES,%VSM23A,NO,) ZERO RETURN CODE?                   */ 01553000
*/*         P  SAVE THE RETURN CODE                                  */ 01554000
*/*         D  (YES,,NO,%VSM23) STORAGE OBTAINED?                    */ 01555000
*/*         L  SETLOCK: UNCOND OBTAIN LOCAL LOCK                     */ 01556000
*/*         P  ZERO THE EPATH PTR TO I/O BUFFER                      */ 01557000
*/*         P  LOAD REGISTERS FOR FREEMAIN                           */ 01558000
*/*         S  FREEMAIN: FREE THE BASE BUFFER                        */ 01559000
*/*         L  SETLOCK: UNCOND RELEASE LOCAL LOCK                    */ 01560000
*/*%VSM23:  P  LOAD REG 15 WITH INTERNAL RETURN CODE                 */ 01561000
*/*         R  RETURN TO MAINLINE                                    */ 01562000
*/*%VSM23A: P ZERO RETRY COUNTER                                     */ 01563000
*/*%VSM24:  P  LOAD REG FOR ERASE                                    */ 01564000
*/*         S  ERASE: THE BASE ASPCT                                 */ 01565000
*/*         D  (YES,%VSM25,NO,) ZERO RETURN CODE?                    */ 01566000
*/*         S  SHOWCB: LOOK AT ERROR                                 */ 01567000
*/*         D  (YES,,NO,%VSM24A) RETRY POSSIBLE?                     */ 01568000
*/*         P  INCREMENT THE RETRY COUNTER                           */ 01569000
*/*         D  (YES,,NO,%VSM24) REACHED MAXIMUM RETRY?               */ 01570000
*/*%VSM24A: P  SET INTERNAL RETURN CODE TO 4                         */ 01571000
*/*%VSM25:  D  (YES,%VSM26,NO,) ANY EXTENSIONS?                      */ 01572000
*/*         P  ZERO THE EPATH PTR TO I/O BUFFER                      */ 01573000
*/*         P  LOAD REG 15 WITH INTERNAL RETURN CODE                 */ 01574000
*/*         R  RETURN TO MAINLINE                                    */ 01575000
*/*%VSM26:  P  SAVE THE ASST EXT COUNTER (ASPAEXCT)                  */ 01576000
*/*         P  ZERO THE ASST EXT COUNTER IN BASE                     */ 01577000
*/*         P  SAVE THE LPME EXT COUNTER (ASPLEXCT)                  */ 01578000
*/*         P  ZERO THE LPME EXT COUNTER IN BASE                     */ 01579000
*/*         P  ZERO THE ASST PTR ARRAY IN BASE                       */ 01580000
*/*         P  RECORD PTR TO BUFFER IN EPATH                         */ 01581000
*/*         P  ZERO EPATH PTR TO I/O BUFFER                          */ 01582000
*/*%VSM27:  P  SET WORKAREA KEY FOR ASST EXT                         */ 01583000
*/*         S  GETONE : RETRIEVE AN ASST EXTENSION                   */ 01584000
*/*         D  (YES,%VSM34,NO,) ZERO RETURN CODE?                    */ 01585000
*/*         D  (YES,%VSM30,NO,) IS THIS A RLG REQUEST?               */ 01586000
*/*         L  SETLOCK: UNCOND OBTAIN LOCAL LOCK                     */ 01587000
*/*         D  (YES,,NO,%VSM28) STORAGE OBTAINED?                    */ 01588000
*/*         P  ZERO EPATH PTR TO I/O BUFFER                          */ 01589000
*/*         P  LOAD REGISTERS FOR FREEMAIN                           */ 01590000
*/*         S  FREEMAIN: FREE THE ASST BUFFER                        */ 01591000
*/*%VSM28:  P  ZERO BUFFER PTR IN EPATH                              */ 01592000
*/*         P  LOAD REG 1 WITH PTR TO BUFFER BASE                    */ 01593000
*/*         P  SET REG 0 TO LENGTH OF BUFFER                         */ 01594000
*/*         S  ILRAFS00: FREE THE BUFFERS                            */ 01595000
*/*         P  SAVE THE RETURN CODE                                  */ 01596000
*/*         L  SETLOCK: UNCOND RELEASE LOCAL LOCK                    */ 01597000
*/*         D  (YES,%VSM29,NO,) ZERO RETURN CODE?                    */ 01598000
*/*         S  ABEND: 087                                            */ 01599000
*/*%VSM29:  P  LOAD REG 15 WITH INTERNAL RETURN CODE                 */ 01600000
*/*         R  RETURN TO MAINLINE                                    */ 01601000
*/*%VSM30:  D  (YES,,NO,%VSM31) STORAGE OBTAINED?                    */ 01602000
*/*         P  (,%VSM34) MAKE BUFFER LOOK LIKE ASST EXT              */ 01603000
*/*%VSM31:  P  LOAD REG FOR ERASE                                    */ 01604000
*/*         S  ERASE: AN ASST EXTENSION                              */ 01605000
*/*         P  DECREMENT ASST EXT COUNTER                            */ 01606000
*/*         P  SET ARRAY COUNTER                                     */ 01607000
*/*%VSM32:  P  INCREMENT THE WKA KEY                                 */ 01608000
*/*         P  LOAD REG FOR ERASE                                    */ 01609000
*/*         S  ERASE: AN LPME EXTENSION                              */ 01610000
*/*         P  DECREMENT LPME EXT COUNTER                            */ 01611000
*/*         P  INCREMENT THE ARRAY COUNTER                           */ 01612000
*/*         D  (YES,,NO,%VSM33) LPME EXT COUNT ZERO?                 */ 01613000
*/*         P  SET RETURN CODE TO 20                                 */ 01614000
*/*         R  RETURN TO MAINLINE                                    */ 01615000
*/*%VSM33:  D  (YES,,NO,%VSM32) REACHED END OF ARRAY?                */ 01616000
*/*         P  (,%VSM31) INCREMENT THE WORKAREA KEY                  */ 01617000
*/*%VSM34:  P  ZERO THE ASST EXT ARRAY                               */ 01618000
*/*         P  STORE PTR TO ASST EXT IN BASE ARRAY                   */ 01619000
*/*         P  ZERO THE EPATH PTR TO I/O BUFFER                      */ 01620000
*/*         P  INCREMENT ASST EXT COUNTER IN BASE                    */ 01621000
*/*         P  DECREMENT ASST EXT COUNTER                            */ 01622000
*/*         P  ZERO RETRY COUNTER                                    */ 01623000
*/*%VSM35:  P  LOAD REG FOR ERASE                                    */ 01624000
*/*         S  ERASE: AN ASST EXTENSION                              */ 01625000
*/*         D  (YES,%VSM36,NO,) ZERO RETURN CODE?                    */ 01626000
*/*         S  SHOWCB: DETERMINE ERROR                               */ 01627000
*/*         D  (YES,,NO,%VSM35A) RETRY POSSIBLE?                     */ 01628000
*/*         P  INCREMENT THE RETRY COUNTER                           */ 01629000
*/*         D  (YES,,NO,%VSM35) REACHED MAXIMUM RETRY?               */ 01630000
*/*%VSM35A: P  SET INTERNAL RETURN CODE TO 4                         */ 01631000
*/*%VSM36:  P  SET WKA KEY FOR LPME EXT                              */ 01632000
*/*         S  GETONE : RETRIEVE AN LPME EXTENSION                   */ 01633000
*/*         D  (YES,%VSM41,NO,) ZERO RETURN CODE?                    */ 01634000
*/*         L  SETLOCK: UNCOND OBTAIN LOCAL LOCK                     */ 01635000
*/*         D  (YES,%VSM39,NO,) IS THIS A RLG REQUEST?               */ 01636000
*/*         D  (YES,,NO,%VSM37) STORAGE OBTAINED?                    */ 01637000
*/*         P  STORE PTR TO LPME EXT IN ASST ARRAY                   */ 01638000
*/*         P  ZERO THE EPATH PTR TO I/O BUFFER                      */ 01639000
*/*         P  INCREMENT LPME EXT COUNTER IN BASE                    */ 01640000
*/*%VSM37:  P  ZERO PTR TO BUFFER IN EPATH                           */ 01641000
*/*         P  LOAD REG 1 WITH PTR TO BASE BUFFER                    */ 01642000
*/*         P  SET REG 0 TO LENGTH OF BUFFER                         */ 01643000
*/*         S  ILRAFS00: FREE THE BUFFERS                            */ 01644000
*/*         P  SAVE THE RETURN CODE                                  */ 01645000
*/*         L  SETLOCK: UNCOND RELEASE LOCAL LOCK                    */ 01646000
*/*         D  (YES,%VSM38,NO,) ZERO RETURN CODE?                    */ 01647000
*/*         S  ABEND: 087                                            */ 01648000
*/*%VSM38:  P  LOAD REG 15 WITH INTERNAL RETURN CODE                 */ 01649000
*/*         R  RETURN TO MAINLINE                                    */ 01650000
*/*%VSM39:  D  (YES,,NO,%VSM40) STORAGE OBTAINED?                    */ 01651000
*/*         P  ZERO THE EPATH PTR TO I/O BUFFER                      */ 01652000
*/*         P  LOAD REGISTERS FOR FREEMAIN                           */ 01653000
*/*         S  FREEMAIN: FREE THE LPME BUFFER                        */ 01654000
*/*%VSM40:  L  SETLOCK: UNCOND RELEASE LOCAL LOCK                    */ 01655000
*/*         P  DECREMENT LPME EXT COUNTER                            */ 01656000
*/*         D  (YES,%VSM45,NO,%VSM44) LPME EXT COUNTER ZERO?         */ 01657000
*/*%VSM41:  P  STORE PTR TO LPME BUFFER IN ASST ARRAY                */ 01658000
*/*         P  ZERO THE EPATH PTR TO I/O BUFFER                      */ 01659000
*/*         P  INCREMENT LPME EXT COUNTER IN BASE                    */ 01660000
*/*         P  DECREMENT THE LPME EXT COUNTER                        */ 01661000
*/*         P  ZERO THE RETRY COUNTER                                */ 01662000
*/*%VSM42:  P  LOAD REG FOR ERASE                                    */ 01663000
*/*         S  ERASE: AN LPME EXTENSION                              */ 01664000
*/*         D  (YES,%VSM43,NO,) ZERO RETURN CODE?                    */ 01665000
*/*         S  SHOWCB: DETERMINE ERROR                               */ 01666000
*/*         D  (YES,,NO,%VSM42A) RETRY POSSIBLE?                     */ 01667000
*/*         P  INCREMENT THE RETRY COUNTER                           */ 01668000
*/*         D  (YES,,NO,%VSM42) REACHED MAXIMUM RETRY?               */ 01669000
*/*%VSM42A: P  SET INTERNAL RETURN CODE TO 4                         */ 01670000
*/*%VSM43:  D  (YES,%VSM45,NO,) LPME EXT COUNTER ZERO?               */ 01671000
*/*         P  INCREMENT THE ASST EXT ARRAY SUBSCRIPT                */ 01672000
*/*%VSM44:  D  (YES,,NO,%VSM36) REACHED END OF ASST EXT ARRAY?       */ 01673000
*/*         P  RESET ASST EXT ARRAY SUBSCRIPT                        */ 01674000
*/*%VSM45:  D  (YES,%VSM46,NO,) ASST EXT COUNTER ZERO?               */ 01675000
*/*         P  INCREMENT THE BASE ARRAY SUBSCRIPT                    */ 01676000
*/*         D  (YES,,NO,%VSM27) REACHED END OF BASE ARRAY?           */ 01677000
*/*%VSM46:  P  LOAD REG 15 WITH INTERNAL RETURN CODE                 */ 01678000
*/*         R  RETURN TO MAINLINE                                    */ 01679000
*/*RETERASE: END                                                     */ 01680000
*                                                                  0402 01681000
         EJECT                                                          01682000
*RETERASE:                                                         0402 01683000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0402 01684000
RETERASE DS    0H                                                  0403 01685000
*   RFY                                                            0403 01686000
*     R14 RSTD;                                                    0403 01687000
*   RETADDR1=R14;                   /* SAVE THE RETURN ADDRESS       */ 01688000
         ST    R14,RETADDR1                                        0404 01689000
*   RFY                                                            0405 01690000
*     R14 UNRSTD;                                                  0405 01691000
*   WKAKEY=SSYM;                    /* COPY THE 'S' SYMBOL TO WKA    */ 01692000
         L     @12,PARMPTR                                         0406 01693000
         L     @12,SSYMPTR(,@12)                                   0406 01694000
         MVC   WKAKEY(8),SSYM(@12)                                 0406 01695000
*   EXTNUMB=ZERO;                   /* SET LAST PART OF VSAM KEY FOR    01696000
*                                      AN ASPCT BASE                 */ 01697000
         SLR   @12,@12                                             0407 01698000
         ST    @12,EXTNUMB                                         0407 01699000
*   RETCODE=ZERO;                   /* INIT INTERNAL RETURN CODE     */ 01700000
         ST    @12,RETCODE                                         0408 01701000
*   MAXEXTN=ZERO;                   /* CLEAR MAXIMUM EXTENSION NUMBER*/ 01702000
         ST    @12,MAXEXTN                                         0409 01703000
*   PARTIALF=OFF;                   /* RESET THE PARTIAL RETRIEVED 0410 01704000
*                                      FLAG                          */ 01705000
         NI    PARTIALF,B'10111111'                                0410 01706000
*   EPARPLB=OFF;                    /* SET RPL BUILT FLAG OFF        */ 01707000
         L     @12,EPAPTR                                          0411 01708000
         NI    EPARPLB(@12),B'11111110'                            0411 01709000
*   BACKOUT=OFF;                    /* SET BACKOUT ERROR FLAG OFF    */ 01710000
         NI    BACKOUT,B'01111111'                                 0412 01711000
*   CALL GETONE;                    /* RETRIEVE THE ASPCT BASE       */ 01712000
         BAL   @14,GETONE                                          0413 01713000
*   RFY                                                            0414 01714000
*     R15 RSTD;                                                    0414 01715000
*   IF R15=ZERO                     /* WAS RETRIEVAL SUCCESSFUL?     */ 01716000
*     THEN                                                         0415 01717000
         LTR   R15,R15                                             0415 01718000
         BNZ   @RF00415                                            0415 01719000
*     DO;                           /* YES                           */ 01720000
*       RFY                                                        0417 01721000
*         R15 UNRSTD;                                              0417 01722000
*       ASPCTPTR=BUFFER;            /* SAVE PTR TO ASPCT BASE        */ 01723000
         L     @12,BUFFER                                          0418 01724000
         ST    @12,ASPCTPTR                                        0418 01725000
*       RETASPCT=BUFFER;            /* ANCHOR PTR TO ASPCT BASE      */ 01726000
         ST    @12,RETASPCT                                        0419 01727000
*       CALL ERASES;                /* ERASE THE BASE RECORD FROM  0420 01728000
*                                      SYS1.STGINDEX                 */ 01729000
         BAL   @14,ERASES                                          0420 01730000
         EJECT                                                          01731000
*                                                                  0421 01732000
*/********************************************************************/ 01733000
*/*                                                                  */ 01734000
*/*  PROCESS  ALL  ASST  AND  LPME  EXTENSIONS                       */ 01735000
*/*                                                                  */ 01736000
*/********************************************************************/ 01737000
*                                                                  0421 01738000
*       IF ASPAEXCT^=ZERO           /* ARE THERE ANY EXTENSIONS?     */ 01739000
*         THEN                                                     0421 01740000
         SLR   @12,@12                                             0421 01741000
         L     @11,ASPCTPTR                                        0421 01742000
         LH    @08,ASPAEXCT(,@11)                                  0421 01743000
         CR    @08,@12                                             0421 01744000
         BE    @RF00421                                            0421 01745000
*         DO;                       /* YES CALCULATE MAXIMUM       0422 01746000
*                                      EXTENSION NUMBER              */ 01747000
*           MAXEXTN=ASPAEXCT+ASPLEXCT;                             0423 01748000
         LH    @07,ASPLEXCT(,@11)                                  0423 01749000
         LR    @15,@08                                             0423 01750000
         ALR   @15,@07                                             0423 01751000
         ST    @15,MAXEXTN                                         0423 01752000
*           ASSTEXT=ASPAEXCT;       /* GET THE NUMBER OF ASST EXTS   */ 01753000
         ST    @08,ASSTEXT                                         0424 01754000
*           LPMEXT=ASPLEXCT;        /* GET THE NUMBER OF LPME EXTS   */ 01755000
         ST    @07,LPMEXT                                          0425 01756000
*           ASPAEXCT=ZERO;          /* ZERO THE ASST EXT COUNT IN  0426 01757000
*                                      ASPCT BASE                    */ 01758000
         STH   @12,ASPAEXCT(,@11)                                  0426 01759000
*           ASPLEXCT=ZERO;          /* ZERO THE LPME EXT COUNT IN  0427 01760000
*                                      ASPCT BASE                    */ 01761000
         STH   @12,ASPLEXCT(,@11)                                  0427 01762000
*           BASE=ONE;               /* INIT BASE ARRAY SUBSCRIPT     */ 01763000
         LA    @12,1                                               0428 01764000
         ST    @12,BASE                                            0428 01765000
*           ASST=TWO;               /* INIT ASST ARRAY SUBSCRIPT     */ 01766000
         MVC   ASST(4),@CF00114                                    0429 01767000
*           DO I=1 TO 4 BY 1;       /* ZERO THE OLD POINTERS TO      */ 01768000
         LR    I,@12                                               0430 01769000
@DL00430 DS    0H                                                  0431 01770000
*             ASPASSTP(I)=ZERO;     /* THE ASST EXTENSIONS           */ 01771000
         LR    @12,I                                               0431 01772000
         SLA   @12,2                                               0431 01773000
         SLR   @11,@11                                             0431 01774000
         L     @08,ASPCTPTR                                        0431 01775000
         ST    @11,ASPASSTP-4(@12,@08)                             0431 01776000
*           END;                                                   0432 01777000
         AL    I,@CF00098                                          0432 01778000
         C     I,@CF00063                                          0432 01779000
         BNH   @DL00430                                            0432 01780000
*           EPABASP=ZERO;           /* ZERO RECOVERY'S POINTER TO THE   01781000
*                                      I/O BUFFER                    */ 01782000
         L     @12,EPAPTR                                          0433 01783000
         SLR   @11,@11                                             0433 01784000
         ST    @11,EPABASP(,@12)                                   0433 01785000
*           EPARASP=BUFFER;         /* RECORD PTR TO ASPCT BASE      */ 01786000
         L     @11,BUFFER                                          0434 01787000
         ST    @11,EPARASP(,@12)                                   0434 01788000
         EJECT                                                          01789000
*                                                                  0435 01790000
*/********************************************************************/ 01791000
*/*  PROCESS  ASST  EXTENSIONS                                       */ 01792000
*/********************************************************************/ 01793000
*                                                                  0435 01794000
*           DO WHILE ASSTEXT^=ZERO; /* LOOP UNTIL ALL ASST EXTS HAVE    01795000
*                                      BEEN RETRIEVED AND ERASED     */ 01796000
         B     @DE00435                                            0435 01797000
@DL00435 DS    0H                                                  0436 01798000
*             EXTNUMB=EXTNUMB+ONE;  /* INCREMENT THE VSAM KEY        */ 01799000
         LA    @12,1                                               0436 01800000
         AL    @12,EXTNUMB                                         0436 01801000
         ST    @12,EXTNUMB                                         0436 01802000
*             CALL GETONE;          /* RETRIEVE AN ASST EXTENSION    */ 01803000
         BAL   @14,GETONE                                          0437 01804000
*             RFY                                                  0438 01805000
*               R15 RSTD;                                          0438 01806000
*             IF R15=ZERO           /* RETRIEVAL SUCCESSFUL?         */ 01807000
*               THEN                /* YES                           */ 01808000
         LTR   R15,R15                                             0439 01809000
         BNZ   @RF00439                                            0439 01810000
*               ASPEXPTR=BUFFER;    /* SAVE PTR TO ASST EXTENSION    */ 01811000
         L     @14,BUFFER                                          0440 01812000
         ST    @14,ASPEXPTR                                        0440 01813000
         EJECT                                                          01814000
*                                                                  0441 01815000
*/********************************************************************/ 01816000
*/*  PROCESS A NON-ZERO RETURN CODE FROM GETONE  FOR ASST EXTENSIONS */ 01817000
*/********************************************************************/ 01818000
*                                                                  0441 01819000
*             ELSE                                                 0441 01820000
*               DO;                                                0441 01821000
         B     @RC00439                                            0441 01822000
@RF00439 DS    0H                                                  0442 01823000
*                 RETCODE=R15;      /* SAVE THE RETURN CODE          */ 01824000
         ST    R15,RETCODE                                         0442 01825000
*                 RFY                                              0443 01826000
*                   R15 UNRSTD;                                    0443 01827000
*                 IF OPCODE^=REL    /* IS THIS REQUEST FOR RELEASE   */ 01828000
*                   THEN                                           0444 01829000
         L     @12,PARMPTR                                         0444 01830000
         CLI   OPCODE(@12),4                                       0444 01831000
         BE    @RF00444                                            0444 01832000
*                   DO;             /* NO                            */ 01833000
*/********************************************************************/ 01834000
*/* PROCESS FAILURE FOR A NON-RELEASE REQUEST                        */ 01835000
*/********************************************************************/ 01836000
*                                                                  0446 01837000
*                     RFY                                          0446 01838000
*                       R8 RSTD;                                   0446 01839000
*                     R8=R13;       /* SAVE SAVEAREA POINTER OBTAIN     01840000
*                                      THE LOCAL LOCK                */ 01841000
         LR    R8,R13                                              0447 01842000
*                     GENERATE SETS(R11,R12,R13,R14);              0448 01843000
GET6     SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(VIO,           *01844000
               ILRVSAMI(REL5))                                          01845000
*                     R13=R8;       /* RESTORE SAVEAREA POINTER      */ 01846000
         LR    R13,R8                                              0449 01847000
*                     RFY                                          0450 01848000
*                       R8 UNRSTD;                                 0450 01849000
*                     IF RETCODE^=STORAGE/* WAS AN I/O BUFFER      0451 01850000
*                                      OBTAINED?                     */ 01851000
*                       THEN                                       0451 01852000
         CLC   RETCODE(4),@CF00122                                 0451 01853000
         BE    @RF00451                                            0451 01854000
*                       DO;         /* YES                           */ 01855000
*                         EPABASP=ZERO;/* ZERO RECOVERY'S POINTER TO */ 01856000
         L     @12,EPAPTR                                          0453 01857000
         SLR   @11,@11                                             0453 01858000
         ST    @11,EPABASP(,@12)                                   0453 01859000
*                         RFY                                      0454 01860000
*                          (R0,                                    0454 01861000
*                           R1,                                    0454 01862000
*                           R3,                                    0454 01863000
*                           R4,                                    0454 01864000
*                           R7) RSTD;/* I/O BUFFER                   */ 01865000
*                         R0=TWOK;  /* SET LENGTH FOR 2K             */ 01866000
         LA    R0,2048                                             0455 01867000
*                         R1=BUFFER;/* GET BUFFER ADDRESS            */ 01868000
         L     R1,BUFFER                                           0456 01869000
*                         R4=PSATOLD;/* GET PTR TO CURRENT TCB       */ 01870000
         L     R4,PSATOLD                                          0457 01871000
*                         R7=PSAAOLD;/* GET PTR TO CURRENT ASCB FREE    01872000
*                                      THE I/O BUFFER                */ 01873000
         L     R7,PSAAOLD                                          0458 01874000
*                         GENERATE REFS(R0,R1,R4,R7) SETS(R3);     0459 01875000
                    FREEMAIN RC,A=(1),LV=(0),SP=230,BRANCH=YES          01876000
*                         RFY                                      0460 01877000
*                          (R3,                                    0460 01878000
*                           R4,                                    0460 01879000
*                           R7) UNRSTD;                            0460 01880000
*                       END;                                       0461 01881000
*                     ELSE                                         0462 01882000
*                       ;                                          0462 01883000
@RF00451 DS    0H                                                  0463 01884000
*                     EPARASP=ZERO; /* ZERO RECOVERYS PTR            */ 01885000
         SLR   @12,@12                                             0463 01886000
         L     @11,EPAPTR                                          0463 01887000
         ST    @12,EPARASP(,@11)                                   0463 01888000
*                     RETASPCT=ZERO;/* ZERO PTR TO RETRIEVED ASPCT   */ 01889000
         ST    @12,RETASPCT                                        0464 01890000
*                     R0=TWOK;      /* SET LENGTH FOR 2K             */ 01891000
         LA    R0,2048                                             0465 01892000
*                     R1=ASPCTPTR;  /* GET PTR TO ASPCT BASE         */ 01893000
         L     R1,ASPCTPTR                                         0466 01894000
*                     CALL ILRAFS00;/* FREE THE RETRIEVED ASPCT BASE    01895000
*                                      AND THOSE EXTS RETRIEVED      */ 01896000
         BAL   @14,ILRAFS00                                        0467 01897000
*                     RFY                                          0468 01898000
*                       R15 RSTD;                                  0468 01899000
*                     RFY                                          0469 01900000
*                      (R0,                                        0469 01901000
*                       R1) UNRSTD;                                0469 01902000
*                     RFY                                          0470 01903000
*                       R8 RSTD;                                   0470 01904000
*                     R8=R13;       /* SAVE SAVEAREA POINTER RELEASE    01905000
*                                      THE LOCAL LOCK                */ 01906000
         LR    R8,R13                                              0471 01907000
*                     GENERATE SETS(R11,R12,R13,R14);              0472 01908000
REL5           SETLOCK RELEASE,TYPE=LOCAL,RELATED=(VIO,ILRVSAMI(GET6))  01909000
*                     R13=R8;       /* RESTORE SAVEAREA POINTER      */ 01910000
         LR    R13,R8                                              0473 01911000
*                     RFY                                          0474 01912000
*                       R8 UNRSTD;                                 0474 01913000
*                     IF R15^=ZERO  /* WAS ILRAFS00 SUCCESSFUL?      */ 01914000
*                       THEN                                       0475 01915000
         LTR   R15,R15                                             0475 01916000
         BZ    @RF00475                                            0475 01917000
*                       DO;         /* NO                            */ 01918000
*                         STM(R0,R14,SAVREGSA);/* SAVE REGS FOR    0477 01919000
*                                      RECOVERY                      */ 01920000
         STM   R0,R14,SAVREGSA                                     0477 01921000
*                         GEN(ABEND X'87',,,SYSTEM);/* RECORD THE  0478 01922000
*                                      FREEMAIN ERROR                */ 01923000
         ABEND X'87',,,SYSTEM                                           01924000
*                       END;                                       0479 01925000
*                     BACKOUT=ON;   /* SET BACKOUT ERROR FLAG ON     */ 01926000
@RF00475 OI    BACKOUT,B'10000000'                                 0480 01927000
*                     ASSTEXT=ZERO; /* FORCE ASST LOOP EXIT          */ 01928000
         SLR   @14,@14                                             0481 01929000
         ST    @14,ASSTEXT                                         0481 01930000
*                     RFY                                          0482 01931000
*                       R15 UNRSTD;                                0482 01932000
*                   END;                                           0483 01933000
         EJECT                                                          01934000
*                                                                  0484 01935000
*/********************************************************************/ 01936000
*/* PROCESS FAILURE FOR A RELEASE REQUEST                            */ 01937000
*/********************************************************************/ 01938000
*                                                                  0484 01939000
*                 ELSE                                             0484 01940000
*                   DO;                                            0484 01941000
         B     @RC00444                                            0484 01942000
@RF00444 DS    0H                                                  0485 01943000
*                     IF RETCODE^=STORAGE/* WAS AN I/O BUFFER      0485 01944000
*                                      OBTAINED?                     */ 01945000
*                       THEN                                       0485 01946000
         CLC   RETCODE(4),@CF00122                                 0485 01947000
         BE    @RF00485                                            0485 01948000
*                       DO;         /* YES                           */ 01949000
*                                                                  0486 01950000
*                         /*******************************************/ 01951000
*                         /*                                         */ 01952000
*                         /* THIS NEXT SECTION WILL MAKE THE I/O     */ 01953000
*                         /* BUFFER LOOK LIKE AN ASST EXTENSION.     */ 01954000
*                         /*                                         */ 01955000
*                         /*******************************************/ 01956000
*                                                                  0487 01957000
*                         ASPEXPTR=BUFFER;/* SAVE POINTER TO BUFFER  */ 01958000
         L     @12,BUFFER                                          0487 01959000
         ST    @12,ASPEXPTR                                        0487 01960000
*                         ASPEIDNT='ASST';/* SET ASST EXT IDENTIFIER */ 01961000
         MVC   ASPEIDNT(4,@12),@CC01507                            0488 01962000
*                         ASPESSYM=ASPSSYM;/* COPY 'S' SYMBOL FROM 0489 01963000
*                                      BASE                          */ 01964000
         L     @11,ASPCTPTR                                        0489 01965000
         MVC   ASPESSYM(8,@12),ASPSSYM(@11)                        0489 01966000
*                         ASPEXTNM=EXTNUMB;/* SET THE EXTENSION    0490 01967000
*                                      NUMBER                        */ 01968000
         L     @08,EXTNUMB                                         0490 01969000
         ST    @08,ASPEXTNM(,@12)                                  0490 01970000
*                         ASPASSTN=ASPAEXCT+ONE;/* SET ASST EXT    0491 01971000
*                                      NUMBER                        */ 01972000
         LA    @08,1                                               0491 01973000
         AH    @08,ASPAEXCT(,@11)                                  0491 01974000
         STC   @08,ASPASSTN(,@12)                                  0491 01975000
*                         RETCODE=ZERO;/* RESET INTERNAL RETURN CODE */ 01976000
         SLR   @12,@12                                             0492 01977000
         ST    @12,RETCODE                                         0492 01978000
*                       END;                                       0493 01979000
         EJECT                                                          01980000
*                                                                  0494 01981000
*/********************************************************************/ 01982000
*/* THIS NEXT SECTION WILL ERASE ALL THE LPME EXTENSIONS             */ 01983000
*/* ASSOCIATED WITH THIS ASST EXTENSION.                             */ 01984000
*/********************************************************************/ 01985000
*                                                                  0494 01986000
*                     ELSE                                         0494 01987000
*                       DO;         /* NO, AN I/O BUFFER WAS NOT   0494 01988000
*                                      OBTAINED                      */ 01989000
         B     @RC00485                                            0494 01990000
@RF00485 DS    0H                                                  0495 01991000
*                         RFY                                      0495 01992000
*                          (R5,                                    0495 01993000
*                           R7) RSTD;                              0495 01994000
*                         R5=RPLPTR;/* OBTAIN RPL ADDR               */ 01995000
         L     R5,RPLPTR                                           0496 01996000
*                         R7=ADDR(RECADDR);/* ADDR OF AREA TO STORE     01997000
*                                      ADDR OF RECORD LOCATED        */ 01998000
         LA    R7,RECADDR                                          0497 01999000
*                         GEN                                      0498 02000000
*(MODCB RPL=(5),OPTCD=(LOC),AREALEN=4,AREA=(7));/* CHANGE MVE OPTION    02001000
*                                      TO LOCATE                     */ 02002000
         MODCB RPL=(5),OPTCD=(LOC),AREALEN=4,AREA=(7)                   02003000
*                         GEN(GET RPL=(5));/* GET THE EXTENSION      */ 02004000
         GET RPL=(5)                                                    02005000
*                         GEN(ERASE RPL=(5));/* ERASE THE ASST     0500 02006000
*                                      EXTENSION                     */ 02007000
         ERASE RPL=(5)                                                  02008000
*                         RFY                                      0501 02009000
*                          (R5,                                    0501 02010000
*                           R7) UNRSTD;                            0501 02011000
*                         ASSTEXT=ASSTEXT-ONE;/* DECREMENT ASST EXT     02012000
*                                      COUNT                         */ 02013000
         L     @12,ASSTEXT                                         0502 02014000
         BCTR  @12,0                                               0502 02015000
         ST    @12,ASSTEXT                                         0502 02016000
*                         IF ASPASSTP(1)=ZERO/* WAS THIS FIRST ASST     02017000
*                                      EXT?                          */ 02018000
*                           THEN    /* YES                           */ 02019000
         L     @12,ASPCTPTR                                        0503 02020000
         L     @12,ASPASSTP(,@12)                                  0503 02021000
         LTR   @12,@12                                             0503 02022000
         BNZ   @RF00503                                            0503 02023000
*                           ASST=TWO;/* INIT LOOP CONTROLLER         */ 02024000
         MVC   ASST(4),@CF00114                                    0504 02025000
*                         ELSE      /* NO                            */ 02026000
*                           ASST=ONE;/* INIT LOOP CONTROLLER         */ 02027000
         B     @RC00503                                            0505 02028000
@RF00503 MVC   ASST(4),@CF00098                                    0505 02029000
*                         DO WHILE ASST<=ASPNLPME;/* LOOP ERASING THE   02030000
*                                      LPME EXTS FOR THIS ASST EXT   */ 02031000
@RC00503 B     @DE00506                                            0506 02032000
@DL00506 DS    0H                                                  0507 02033000
*                           EXTNUMB=EXTNUMB+ONE;/* INCREMENT KEY FOR    02034000
*                                      LPME                          */ 02035000
         LA    @12,1                                               0507 02036000
         AL    @12,EXTNUMB                                         0507 02037000
         ST    @12,EXTNUMB                                         0507 02038000
*                           RFY                                    0508 02039000
*                             R5 RSTD;                             0508 02040000
*                           R5=RPLPTR;/* OBTAIN RPL ADDR             */ 02041000
         L     R5,RPLPTR                                           0509 02042000
*                           GEN(GET RPL=(5));/* RETRIEVE THE RECORD  */ 02043000
         GET RPL=(5)                                                    02044000
*                           GEN(ERASE RPL=(5));/* ERASE LPME RECORD  */ 02045000
         ERASE RPL=(5)                                                  02046000
*                           RFY                                    0512 02047000
*                             R5 UNRSTD;                           0512 02048000
*                           LPMEXT=LPMEXT-ONE;/* DECREMENT LPME EXT     02049000
*                                      COUNT                         */ 02050000
         L     @12,LPMEXT                                          0513 02051000
         BCTR  @12,0                                               0513 02052000
         ST    @12,LPMEXT                                          0513 02053000
*                           IF LPMEXT>ZERO/* ANYMORE LPME EXTS?      */ 02054000
*                             THEN  /* YES, INCREMENT ASST ARRAY     */ 02055000
         LTR   @12,@12                                             0514 02056000
         BNP   @RF00514                                            0514 02057000
*                             ASST=ASST+ONE;                       0515 02058000
         LA    @12,1                                               0515 02059000
         AL    @12,ASST                                            0515 02060000
         ST    @12,ASST                                            0515 02061000
*                           ELSE    /* NO, FORCE LOOP EXIT           */ 02062000
*                             ASST=ASPNLPME+ONE;                   0516 02063000
         B     @RC00514                                            0516 02064000
@RF00514 MVC   ASST(4),@CF01541                                    0516 02065000
*                         END;                                     0517 02066000
@RC00514 DS    0H                                                  0517 02067000
@DE00506 L     @12,ASST                                            0517 02068000
         C     @12,@CF00150                                        0517 02069000
         BNH   @DL00506                                            0517 02070000
*                         RFY                                      0518 02071000
*                           R5 RSTD;                               0518 02072000
*                         R5=RPLPTR;/* OBTAIN THE RPL ADDR           */ 02073000
         L     R5,RPLPTR                                           0519 02074000
*                         GEN(MODCB RPL=(5),OPTCD=(MVE),AREALEN=2048);  02075000
         MODCB RPL=(5),OPTCD=(MVE),AREALEN=2048                         02076000
*                                   /* CHANGE LOC OPTION BACK TO MOVE*/ 02077000
*                         RFY                                      0521 02078000
*                           R5 UNRSTD;                             0521 02079000
*                         PARTIALF=ON;/* INDICATE PARTIAL RETRIEVAL  */ 02080000
         OI    PARTIALF,B'01000000'                                0522 02081000
*                       END;                                       0523 02082000
*                   END;            /* FAILURE FOR RELEASE REQUEST   */ 02083000
@RC00485 DS    0H                                                  0525 02084000
*               END;                /* NON-ZERO RETURN CODE FOR ASST    02085000
*                                      EXTENSIONS                    */ 02086000
@RC00444 DS    0H                                                  0526 02087000
         EJECT                                                          02088000
*                                                                  0526 02089000
*/********************************************************************/ 02090000
*/*  ADD  THE  ASST  EXTENSION  INTO  CHAIN                          */ 02091000
*/********************************************************************/ 02092000
*                                                                  0526 02093000
*             IF RETCODE=ZERO       /* IS THERE AN ASST EXTENSION    */ 02094000
*               THEN                                               0526 02095000
@RC00439 L     @12,RETCODE                                         0526 02096000
         LTR   @12,@12                                             0526 02097000
         BNZ   @RF00526                                            0526 02098000
*               DO;                 /* YES                           */ 02099000
*                 DO I=1 TO ASPNASST BY 1;/* ZERO THE OLD PTRS TO  0528 02100000
*                                      LPME                          */ 02101000
         LA    I,1                                                 0528 02102000
@DL00528 DS    0H                                                  0529 02103000
*                   ASPASSTE(I)=ZERO;/* EXTENSIONS                   */ 02104000
         LR    @12,I                                               0529 02105000
         SLA   @12,2                                               0529 02106000
         SLR   @11,@11                                             0529 02107000
         L     @08,ASPEXPTR                                        0529 02108000
         ST    @11,ASPASSTE-4(@12,@08)                             0529 02109000
*                 END;                                             0530 02110000
         AL    I,@CF00098                                          0530 02111000
         C     I,@CF00150                                          0530 02112000
         BNH   @DL00528                                            0530 02113000
*                 EPABASP=ZERO;     /* ZERO RECOVERY'S POINTER TO THE   02114000
*                                      I/O BUFFER                    */ 02115000
         L     @12,EPAPTR                                          0531 02116000
         SLR   @11,@11                                             0531 02117000
         ST    @11,EPABASP(,@12)                                   0531 02118000
*                 ASPASSTP(BASE)=BUFFER;/* ANCHOR ASST EXT IN BASE   */ 02119000
         L     @12,ASPCTPTR                                        0532 02120000
         L     @11,BASE                                            0532 02121000
         SLA   @11,2                                               0532 02122000
         L     @08,BUFFER                                          0532 02123000
         ST    @08,ASPASSTP-4(@11,@12)                             0532 02124000
*                 ASPAEXCT=ASPAEXCT+ONE;/* INCREMENT ASST EXTENSION     02125000
*                                      COUNT IN ASPCT BASE           */ 02126000
         LA    @11,1                                               0533 02127000
         AH    @11,ASPAEXCT(,@12)                                  0533 02128000
         STH   @11,ASPAEXCT(,@12)                                  0533 02129000
*                 ASSTEXT=ASSTEXT-ONE;/* DECREMENT ASST EXT COUNT    */ 02130000
         L     @12,ASSTEXT                                         0534 02131000
         BCTR  @12,0                                               0534 02132000
         ST    @12,ASSTEXT                                         0534 02133000
*                 CALL ERASES;      /* ERASE THE ASST EXTENSION FROM    02134000
*                                      SYS1.STGINDEX                 */ 02135000
         BAL   @14,ERASES                                          0535 02136000
*                 IF LPMEXT>=ASPNLPME/* MORE THAN ONE ASST EXT       */ 02137000
*                   THEN            /* YES                           */ 02138000
         L     @12,LPMEXT                                          0536 02139000
         C     @12,@CF00150                                        0536 02140000
         BL    @RF00536                                            0536 02141000
*                   IF BASE=ONE     /* FIRST ASST EXT?               */ 02142000
*                     THEN          /* YES, ALLOW FOR LPMES IN BASE  */ 02143000
         CLC   BASE(4),@CF00098                                    0537 02144000
         BNE   @RF00537                                            0537 02145000
*                     LPMECNTL=ASPNLPME-ONE;                       0538 02146000
         MVC   LPMECNTL(4),@CF01539                                0538 02147000
*                   ELSE            /* NO, SET FOR FULL ASST EXT     */ 02148000
*                     LPMECNTL=ASPNLPME;                           0539 02149000
         B     @RC00537                                            0539 02150000
@RF00537 MVC   LPMECNTL(4),@CF00150                                0539 02151000
*                 ELSE              /* NO,SET FOR NUMBER REMAINING   */ 02152000
*                   LPMECNTL=LPMEXT;                               0540 02153000
         B     @RC00536                                            0540 02154000
@RF00536 L     @12,LPMEXT                                          0540 02155000
         ST    @12,LPMECNTL                                        0540 02156000
*                 LPMEXT=LPMEXT-LPMECNTL;/* DECREMENT FOR THIS LOOP  */ 02157000
@RC00536 L     @12,LPMEXT                                          0541 02158000
         SL    @12,LPMECNTL                                        0541 02159000
         ST    @12,LPMEXT                                          0541 02160000
*                 BASE=BASE+ONE;    /* INCREMENT BASE SUBSCRIPT      */ 02161000
         LA    @12,1                                               0542 02162000
         AL    @12,BASE                                            0542 02163000
         ST    @12,BASE                                            0542 02164000
         EJECT                                                          02165000
*                                                                  0543 02166000
*/********************************************************************/ 02167000
*/*  PROCESS  LPME  EXTENSIONS                                       */ 02168000
*/********************************************************************/ 02169000
*                                                                  0543 02170000
*                 DO WHILE LPMECNTL^=ZERO;/* LOOP UNTIL ALL LPME   0543 02171000
*                                      EXTENSIONS HAVE BEEN RETRIEVED   02172000
*                                      FOR THIS ASST EXTENSION       */ 02173000
         B     @DE00543                                            0543 02174000
@DL00543 DS    0H                                                  0544 02175000
*                   EXTNUMB=EXTNUMB+ONE;/* INCREMENT THE VSAM KEY    */ 02176000
         LA    @12,1                                               0544 02177000
         AL    @12,EXTNUMB                                         0544 02178000
         ST    @12,EXTNUMB                                         0544 02179000
*                   CALL GETONE;    /* RETRIEVE AN LPME EXTENSION  0545 02180000
*                                      FROM SYS1.STGINDEX            */ 02181000
         BAL   @14,GETONE                                          0545 02182000
*                   RFY                                            0546 02183000
*                     R15 RSTD;                                    0546 02184000
*                   IF R15=ZERO     /* RETRIEVAL SUCCESSFUL?         */ 02185000
*                     THEN                                         0547 02186000
         SLR   @14,@14                                             0547 02187000
         CR    R15,@14                                             0547 02188000
         BNE   @RF00547                                            0547 02189000
*                     DO;           /* YES                           */ 02190000
*                       RFY                                        0549 02191000
*                         R15 UNRSTD;                              0549 02192000
*                       EPABASP=ZERO;/* ZERO RECOVERY'S POINTER TO 0550 02193000
*                                      THE I/O BUFFER                */ 02194000
         L     @12,EPAPTR                                          0550 02195000
         ST    @14,EPABASP(,@12)                                   0550 02196000
*                       ASPASSTE(ASST)=BUFFER;/* ANCHOR THE LPME   0551 02197000
*                                      EXTENSION IN THE ASST       0551 02198000
*                                      EXTENSION                     */ 02199000
         L     @12,ASST                                            0551 02200000
         LR    @11,@12                                             0551 02201000
         SLA   @11,2                                               0551 02202000
         L     @08,BUFFER                                          0551 02203000
         L     @07,ASPEXPTR                                        0551 02204000
         ST    @08,ASPASSTE-4(@11,@07)                             0551 02205000
*                       ASPLEXCT=ASPLEXCT+ONE;/* INCREMENT LPME    0552 02206000
*                                      EXTENSION COUNT IN ASPCT BASE */ 02207000
         L     @11,ASPCTPTR                                        0552 02208000
         LA    @08,1                                               0552 02209000
         LH    @07,ASPLEXCT(,@11)                                  0552 02210000
         ALR   @07,@08                                             0552 02211000
         STH   @07,ASPLEXCT(,@11)                                  0552 02212000
*                       ASST=ASST+ONE;/* INCREMENT ASST SUBSCRIPT    */ 02213000
         ALR   @12,@08                                             0553 02214000
         ST    @12,ASST                                            0553 02215000
*                       LPMECNTL=LPMECNTL-ONE;/* DECREMENT LPME EXT     02216000
*                                      COUNT                         */ 02217000
         L     @12,LPMECNTL                                        0554 02218000
         BCTR  @12,0                                               0554 02219000
         ST    @12,LPMECNTL                                        0554 02220000
*                       CALL ERASES;/* ERASE THE LPME EXTENSION FROM    02221000
*                                      SYS1.STGINDEX                 */ 02222000
         BAL   @14,ERASES                                          0555 02223000
*                     END;                                         0556 02224000
         EJECT                                                          02225000
*                                                                  0557 02226000
*/********************************************************************/ 02227000
*/* PROCESS A NON-ZERO RETURN CODE FROM GETONE  FOR LPME EXTENSIONS  */ 02228000
*/********************************************************************/ 02229000
*                                                                  0557 02230000
*                   ELSE                                           0557 02231000
*                     DO;                                          0557 02232000
         B     @RC00547                                            0557 02233000
@RF00547 DS    0H                                                  0558 02234000
*                       RFY                                        0558 02235000
*                         R15 RSTD;                                0558 02236000
*                       RETCODE=R15;/* SAVE THE RETURN CODE          */ 02237000
         ST    R15,RETCODE                                         0559 02238000
*                       RFY                                        0560 02239000
*                         R15 UNRSTD;                              0560 02240000
*                       RFY                                        0561 02241000
*                         R8 RSTD;                                 0561 02242000
*                       R8=R13;     /* SAVE SAVEAREA POINTER OBTAIN     02243000
*                                      THE LOCAL LOCK                */ 02244000
         LR    R8,R13                                              0562 02245000
*                       GENERATE SETS(R11,R12,R13,R14);            0563 02246000
GET7     SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(VIO,           *02247000
               ILRVSAMI(REL6))                                          02248000
*                       R13=R8;     /* RESTORE SAVEAREA POINTER      */ 02249000
         LR    R13,R8                                              0564 02250000
*                       RFY                                        0565 02251000
*                         R8 UNRSTD;                               0565 02252000
*                       IF OPCODE^=REL/* IS THIS A RELEASE REQUEST?  */ 02253000
*                         THEN                                     0566 02254000
         L     @12,PARMPTR                                         0566 02255000
         CLI   OPCODE(@12),4                                       0566 02256000
         BE    @RF00566                                            0566 02257000
*                         DO;       /* NO                            */ 02258000
*/********************************************************************/ 02259000
*/*  PROCESS FAILURE FOR A NON-RELEASE REQUEST                       */ 02260000
*/********************************************************************/ 02261000
*                                                                  0568 02262000
*                           IF RETCODE^=STORAGE/* I/O BUFFER       0568 02263000
*                                      OBTAINED?                     */ 02264000
*                             THEN                                 0568 02265000
         CLC   RETCODE(4),@CF00122                                 0568 02266000
         BE    @RF00568                                            0568 02267000
*                             DO;   /* YES                           */ 02268000
*                               EPABASP=ZERO;/* ZERO RECOVERY'S    0570 02269000
*                                      POINTER TO THE I/O BUFFER   0570 02270000
*                                      ANCHOR BUFFER IN ASST EXT     */ 02271000
         L     @12,EPAPTR                                          0570 02272000
         SLR   @11,@11                                             0570 02273000
         ST    @11,EPABASP(,@12)                                   0570 02274000
*                               ASPASSTE(ASST)=BUFFER;/* INCREMENT 0571 02275000
*                                      LPME EXT COUNT                */ 02276000
         L     @12,ASST                                            0571 02277000
         SLA   @12,2                                               0571 02278000
         L     @11,BUFFER                                          0571 02279000
         L     @08,ASPEXPTR                                        0571 02280000
         ST    @11,ASPASSTE-4(@12,@08)                             0571 02281000
*                               ASPLEXCT=ASPLEXCT+ONE;             0572 02282000
         L     @12,ASPCTPTR                                        0572 02283000
         LA    @11,1                                               0572 02284000
         AH    @11,ASPLEXCT(,@12)                                  0572 02285000
         STH   @11,ASPLEXCT(,@12)                                  0572 02286000
*                             END;                                 0573 02287000
*                           ELSE                                   0574 02288000
*                             ;                                    0574 02289000
@RF00568 DS    0H                                                  0575 02290000
*                           RFY                                    0575 02291000
*                            (R0,                                  0575 02292000
*                             R1) RSTD;                            0575 02293000
*                           EPARASP=ZERO;/* ZERO RECOVERYS PTR TO  0576 02294000
*                                      ASPCT CHAIN                   */ 02295000
         SLR   @12,@12                                             0576 02296000
         L     @11,EPAPTR                                          0576 02297000
         ST    @12,EPARASP(,@11)                                   0576 02298000
*                           RETASPCT=ZERO;/* ZERO PTR TO RETRIEVED 0577 02299000
*                                      ASPCT                         */ 02300000
         ST    @12,RETASPCT                                        0577 02301000
*                           R1=ASPCTPTR;/* GET PTR TO ASPCT BASE     */ 02302000
         L     R1,ASPCTPTR                                         0578 02303000
*                           R0=TWOK;/* SET LENGTH TO 2K              */ 02304000
         LA    R0,2048                                             0579 02305000
*                           CALL ILRAFS00;/* FREE THE ASPCT BASE AND    02306000
*                                      ALL EXTENSIONS RETRIEVED THUS    02307000
*                                      FAR                           */ 02308000
         BAL   @14,ILRAFS00                                        0580 02309000
*                           RFY                                    0581 02310000
*                             R15 RSTD;                            0581 02311000
*                           RFY                                    0582 02312000
*                            (R0,                                  0582 02313000
*                             R1) UNRSTD;                          0582 02314000
*                           RFY                                    0583 02315000
*                             R8 RSTD;                             0583 02316000
*                           R8=R13; /* SAVE SAVEAREA POINTER RELEASE    02317000
*                                      THE LOCAL LOCK                */ 02318000
         LR    R8,R13                                              0584 02319000
*                           GENERATE SETS(R11,R12,R13,R14);        0585 02320000
REL6           SETLOCK RELEASE,TYPE=LOCAL,RELATED=(VIO,ILRVSAMI(GET7))  02321000
*                           R13=R8; /* RESTORE SAVEAREA POINTER      */ 02322000
         LR    R13,R8                                              0586 02323000
*                           RFY                                    0587 02324000
*                             R8 UNRSTD;                           0587 02325000
*                           IF R15^=ZERO/* WAS ILRAFS00 SUCCESSFUL?  */ 02326000
*                             THEN                                 0588 02327000
         LTR   R15,R15                                             0588 02328000
         BZ    @RF00588                                            0588 02329000
*                             DO;   /* NO, RECORD FREEMAIN ERROR     */ 02330000
*                               STM(R0,R14,SAVREGSA);/* SAVE REGS FOR   02331000
*                                      RECOVERY                      */ 02332000
         STM   R0,R14,SAVREGSA                                     0590 02333000
*                               GEN(ABEND X'87',,,SYSTEM);         0591 02334000
         ABEND X'87',,,SYSTEM                                           02335000
*                             END;                                 0592 02336000
*                           ELSE                                   0593 02337000
*                             ;                                    0593 02338000
@RF00588 DS    0H                                                  0594 02339000
*                           RFY                                    0594 02340000
*                             R15 UNRSTD;                          0594 02341000
*                           BACKOUT=ON;/* SET BACKOUT ERROR FLAG ON  */ 02342000
         OI    BACKOUT,B'10000000'                                 0595 02343000
*                           ASSTEXT=ZERO;/* FORCE ASST LOOP EXIT     */ 02344000
         SLR   @12,@12                                             0596 02345000
         ST    @12,ASSTEXT                                         0596 02346000
*                           LPMECNTL=ZERO;/* FORCE LPME LOOP EXIT    */ 02347000
         ST    @12,LPMECNTL                                        0597 02348000
*                         END;                                     0598 02349000
*                                                                  0598 02350000
*/********************************************************************/ 02351000
*/*  PROCESS FAILURE FOR A RELEASE REQUEST                           */ 02352000
*/********************************************************************/ 02353000
*                                                                  0599 02354000
*                       ELSE                                       0599 02355000
*                         DO;                                      0599 02356000
         B     @RC00566                                            0599 02357000
@RF00566 DS    0H                                                  0600 02358000
*                           IF RETCODE^=STORAGE/* I/O BUFFER       0600 02359000
*                                      OBTAINED?                     */ 02360000
*                             THEN                                 0600 02361000
         CLC   RETCODE(4),@CF00122                                 0600 02362000
         BE    @RF00600                                            0600 02363000
*                             DO;   /* YES                           */ 02364000
*                               EPABASP=ZERO;/* ZERO RECOVERY'S    0602 02365000
*                                      POINTER TO THE I/O BUFFER     */ 02366000
         L     @12,EPAPTR                                          0602 02367000
         SLR   @11,@11                                             0602 02368000
         ST    @11,EPABASP(,@12)                                   0602 02369000
*                               RFY                                0603 02370000
*                                (R0,                              0603 02371000
*                                 R1,                              0603 02372000
*                                 R3,                              0603 02373000
*                                 R4,                              0603 02374000
*                                 R7) RSTD;                        0603 02375000
*                               R0=TWOK;/* SET LENGTH OF 2K          */ 02376000
         LA    R0,2048                                             0604 02377000
*                               R1=BUFFER;/* GET BUFFER ADDRESS      */ 02378000
         L     R1,BUFFER                                           0605 02379000
*                               R4=PSATOLD;/* GET PTR TO CURRENT TCB */ 02380000
         L     R4,PSATOLD                                          0606 02381000
*                               R7=PSAAOLD;/* GET PTR TO CURRENT ASCB*/ 02382000
         L     R7,PSAAOLD                                          0607 02383000
*                               GENERATE REFS(R0,R1,R4,R7) SETS(R3);    02384000
                    FREEMAIN RC,A=(1),LV=(0),SP=230,BRANCH=YES          02385000
*                             END;                                 0609 02386000
*                           ELSE                                   0610 02387000
*                             ;                                    0610 02388000
@RF00600 DS    0H                                                  0611 02389000
*                           RFY                                    0611 02390000
*                            (R0,                                  0611 02391000
*                             R1,                                  0611 02392000
*                             R3,                                  0611 02393000
*                             R4,                                  0611 02394000
*                             R7) UNRSTD;                          0611 02395000
*                           RFY                                    0612 02396000
*                             R8 RSTD;                             0612 02397000
*                           R8=R13; /* SAVE SAVEAREA POINTER RELEASE    02398000
*                                      THE LOCAL LOCK                */ 02399000
         LR    R8,R13                                              0613 02400000
*                           GENERATE SETS(R11,R12,R13,R14);        0614 02401000
REL7           SETLOCK RELEASE,TYPE=LOCAL,RELATED=(VIO,ILRVSAMI(GET7))  02402000
*                           R13=R8; /* RESTORE SAVEAREA POINTER      */ 02403000
         LR    R13,R8                                              0615 02404000
*                           RFY                                    0616 02405000
*                             R8 UNRSTD;                           0616 02406000
*                           RFY                                    0617 02407000
*                            (R5,                                  0617 02408000
*                             R7) RSTD;                            0617 02409000
*                           R5=RPLPTR;/* OBTAIN THE RPL ADDR         */ 02410000
         L     R5,RPLPTR                                           0618 02411000
*                           R7=ADDR(RECADDR);/* ADDR OF AREA TO STORE   02412000
*                                      ADDR OF RECORD LOCATED        */ 02413000
         LA    R7,RECADDR                                          0619 02414000
*                           GEN                                    0620 02415000
*(MODCB RPL=(5),OPTCD=(LOC),AREALEN=4,AREA=(7));/* CHANGE MVE OPTION    02416000
*                                      TO LOCATE                     */ 02417000
         MODCB RPL=(5),OPTCD=(LOC),AREALEN=4,AREA=(7)                   02418000
*                           GEN(GET RPL=(5));/* RETRIEVE THE RECORD  */ 02419000
         GET RPL=(5)                                                    02420000
*                           GEN(ERASE RPL=(5));/* ERASE THE RECORD   */ 02421000
         ERASE RPL=(5)                                                  02422000
*                           GEN(MODCB RPL=(5),OPTCD=(MVE),AREALEN=2048) 02423000
*                               ;   /* CHANGE LOC OPTION BACK TO MOVE*/ 02424000
         MODCB RPL=(5),OPTCD=(MVE),AREALEN=2048                         02425000
*                           RFY                                    0624 02426000
*                            (R5,                                  0624 02427000
*                             R7) UNRSTD;                          0624 02428000
*                           LPMECNTL=LPMECNTL-ONE;/* DECREMENT LPME     02429000
*                                      EXT COUNT                     */ 02430000
         L     @12,LPMECNTL                                        0625 02431000
         BCTR  @12,0                                               0625 02432000
         ST    @12,LPMECNTL                                        0625 02433000
*                           DO WHILE LPMECNTL^=ZERO;/* LOOP        0626 02434000
*                                      RETRIEVING AND ERASING THE  0626 02435000
*                                      REMAINING LPME EXTS FOR THIS     02436000
*                                      ASST EXT                      */ 02437000
         B     @DE00626                                            0626 02438000
@DL00626 DS    0H                                                  0627 02439000
*                             EXTNUMB=EXTNUMB+ONE;/* INCREMENT THE 0627 02440000
*                                      VSAM KEY                      */ 02441000
         LA    @12,1                                               0627 02442000
         AL    @12,EXTNUMB                                         0627 02443000
         ST    @12,EXTNUMB                                         0627 02444000
*                             CALL GETONE;/* RETRIEVE AN LPME EXT    */ 02445000
         BAL   @14,GETONE                                          0628 02446000
*                             RFY                                  0629 02447000
*                               R15 RSTD;                          0629 02448000
*                             IF R15=ZERO/* WAS RETRIEVAL SUCCESSFUL?*/ 02449000
*                               THEN                               0630 02450000
         SLR   @14,@14                                             0630 02451000
         CR    R15,@14                                             0630 02452000
         BNE   @RF00630                                            0630 02453000
*                               DO; /* YES                           */ 02454000
*                                 EPABASP=ZERO;/* ZERO RECOVERYS   0632 02455000
*                                      POINTER TO THE I/O BUFFER     */ 02456000
         L     @12,EPAPTR                                          0632 02457000
         ST    @14,EPABASP(,@12)                                   0632 02458000
*                                 ASPASSTE(ASST)=BUFFER;/* ANCHOR  0633 02459000
*                                      LPME EXT IN THE ASST EXTENSION*/ 02460000
         L     @14,ASST                                            0633 02461000
         LR    @12,@14                                             0633 02462000
         SLA   @12,2                                               0633 02463000
         L     @11,BUFFER                                          0633 02464000
         L     @08,ASPEXPTR                                        0633 02465000
         ST    @11,ASPASSTE-4(@12,@08)                             0633 02466000
*                                 ASPLEXCT=ASPLEXCT+ONE;/* INCREMENT    02467000
*                                      LPME EXT COUNT IN ASPCT BASE  */ 02468000
         L     @12,ASPCTPTR                                        0634 02469000
         LA    @11,1                                               0634 02470000
         LH    @08,ASPLEXCT(,@12)                                  0634 02471000
         ALR   @08,@11                                             0634 02472000
         STH   @08,ASPLEXCT(,@12)                                  0634 02473000
*                                 ASST=ASST+ONE;/* INCREMENT ASST  0635 02474000
*                                      SUBSCRIPT                     */ 02475000
         ALR   @14,@11                                             0635 02476000
         ST    @14,ASST                                            0635 02477000
*                                 CALL ERASES;/* ERASE LPME EXT      */ 02478000
         BAL   @14,ERASES                                          0636 02479000
*                               END;                               0637 02480000
*                             ELSE                                 0638 02481000
*                               DO; /* NO, RETRIEVAL FAILED          */ 02482000
         B     @RC00630                                            0638 02483000
@RF00630 DS    0H                                                  0639 02484000
*                                 IF R15^=STORAGE/* WAS A BUFFER   0639 02485000
*                                      OBTAINED?                     */ 02486000
*                                   THEN                           0639 02487000
         C     R15,@CF00122                                        0639 02488000
         BE    @RF00639                                            0639 02489000
*                                   DO;/* YES, FREEMAIN THE BUFFER   */ 02490000
*                                    RFY                           0641 02491000
*                                     (R0,                         0641 02492000
*                                      R1,                         0641 02493000
*                                      R3,                         0641 02494000
*                                      R4,                         0641 02495000
*                                      R7,                         0641 02496000
*                                      R8) RSTD;                   0641 02497000
*                                    R8=R13;                       0642 02498000
         LR    R8,R13                                              0642 02499000
*                                    GENERATE SETS(R3,R11,R12,R13,R14); 02500000
GET11    SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(VIO,           *02501000
               ILRVSAMI(REL11))                                         02502000
         LR    R13,R8                                                   02503000
         LA    R0,2048                   SET 2K BUFFER LENGTH           02504000
         L     R1,BUFFER                  GET BUFFER ADDRESS            02505000
         L     R4,PSATOLD                 GET CURRENT TCB ADDRESS       02506000
         L     R7,PSAAOLD                 GET CURRENT ASCB ADDRESS      02507000
         FREEMAIN RC,A=(1),LV=(0),SP=230,BRANCH=YES                     02508000
*                                                                       02509000
REL11    SETLOCK RELEASE,TYPE=LOCAL,RELATED=(VIO,ILRVSAMI(GET11))       02510000
*                                    R13=R8;/* RESTORE SAVEAREA    0644 02511000
*                                      POINTER                       */ 02512000
         LR    R13,R8                                              0644 02513000
*                                    RFY                           0645 02514000
*                                     (R0,                         0645 02515000
*                                      R1,                         0645 02516000
*                                      R3,                         0645 02517000
*                                      R4,                         0645 02518000
*                                      R7,                         0645 02519000
*                                      R8,                         0645 02520000
*                                      R15) UNRSTD;                0645 02521000
*                                   END;                           0646 02522000
*                                 RFY                              0647 02523000
*                                  (R5,                            0647 02524000
*                                   R7) RSTD;                      0647 02525000
@RF00639 DS    0H                                                  0648 02526000
*                                 R5=RPLPTR;/* OBTAIN RPL ADDR       */ 02527000
         L     R5,RPLPTR                                           0648 02528000
*                                 R7=ADDR(RECADDR);/* ADDR OF AREA TO   02529000
*                                      STORE ADDR OF RECORD LOCATED  */ 02530000
         LA    R7,RECADDR                                          0649 02531000
*                                 GEN                              0650 02532000
*(MODCB RPL=(5),OPTCD=(LOC),AREALEN=4,AREA=(7));/* CHANGE MVE OPTION    02533000
*                                      TO LOCATE                     */ 02534000
         MODCB RPL=(5),OPTCD=(LOC),AREALEN=4,AREA=(7)                   02535000
*                                 GEN(GET RPL=(5));/* RETRIEVE THE 0651 02536000
*                                      RECORD                        */ 02537000
         GET RPL=(5)                                                    02538000
*                                 GEN(ERASE RPL=(5));/* ERASE THE  0652 02539000
*                                      RECORD                        */ 02540000
         ERASE RPL=(5)                                                  02541000
*                                 GEN                              0653 02542000
*(MODCB RPL=(5),OPTCD=(MVE),AREALEN=2048);/* CHANGE LOC OPTION BACK     02543000
*                                      TO MOVE                       */ 02544000
         MODCB RPL=(5),OPTCD=(MVE),AREALEN=2048                         02545000
*                                 RFY                              0654 02546000
*                                  (R5,                            0654 02547000
*                                   R7) UNRSTD;                    0654 02548000
*                               END;                               0655 02549000
*                             LPMECNTL=LPMECNTL-ONE;/* DECREMENT LPME   02550000
*                                      EXT COUNT                     */ 02551000
@RC00630 L     @12,LPMECNTL                                        0656 02552000
         BCTR  @12,0                                               0656 02553000
         ST    @12,LPMECNTL                                        0656 02554000
*                           END;                                   0657 02555000
@DE00626 SLR   @12,@12                                             0657 02556000
         C     @12,LPMECNTL                                        0657 02557000
         BNE   @DL00626                                            0657 02558000
*                           PARTIALF=ON;/* INDICATE PARTIAL RETRIEVAL*/ 02559000
         OI    PARTIALF,B'01000000'                                0658 02560000
*                           RETCODE=ZERO;                          0659 02561000
         ST    @12,RETCODE                                         0659 02562000
*                         END;                                     0660 02563000
         EJECT                                                          02564000
*                       IF ASST>ASPNLPME/* REACHED END OF ASST ARRAY */ 02565000
*                         THEN      /* YES                           */ 02566000
@RC00566 L     @12,ASST                                            0661 02567000
         C     @12,@CF00150                                        0661 02568000
         BNH   @RF00661                                            0661 02569000
*                         ASST=ONE; /* RESET FOR NEXT ARRAY          */ 02570000
         MVC   ASST(4),@CF00098                                    0662 02571000
*                       ELSE                                       0663 02572000
*                         ;                                        0663 02573000
@RF00661 DS    0H                                                  0664 02574000
*                     END;          /* END DO GROUP FOR NON-ZERO   0664 02575000
*                                      RETURN CODE FOR LPME EXTS     */ 02576000
*                 END;              /* END DO WHILE LOOP FOR LPME  0665 02577000
*                                      EXTENSIONS                    */ 02578000
@RC00547 DS    0H                                                  0665 02579000
@DE00543 L     @12,LPMECNTL                                        0665 02580000
         LTR   @12,@12                                             0665 02581000
         BNZ   @DL00543                                            0665 02582000
*                 ASST=ONE;         /* RESET ASST SUBSCRIPT          */ 02583000
         MVC   ASST(4),@CF00098                                    0666 02584000
*               END;                /* END DO GROUP FOR ASST       0667 02585000
*                                      EXTENSIONS                    */ 02586000
*             ELSE                  /* NO,CHECK FOR REL PROCESSING   */ 02587000
*               IF PARTIALF=ON      /* REL PROCESSING?               */ 02588000
*                 THEN              /* YES                           */ 02589000
         B     @RC00526                                            0668 02590000
@RF00526 TM    PARTIALF,B'01000000'                                0668 02591000
         BNO   @RF00668                                            0668 02592000
*                 RETCODE=ZERO;     /* RESET INT RETURN CODE         */ 02593000
         SLR   @12,@12                                             0669 02594000
         ST    @12,RETCODE                                         0669 02595000
*               ELSE                                               0670 02596000
*                 ;                                                0670 02597000
@RF00668 DS    0H                                                  0671 02598000
*           END;                    /* END DO WHILE LOOP FOR ASST  0671 02599000
*                                      EXTENSIONS                    */ 02600000
@RC00526 DS    0H                                                  0671 02601000
@DE00435 L     @12,ASSTEXT                                         0671 02602000
         LTR   @12,@12                                             0671 02603000
         BNZ   @DL00435                                            0671 02604000
*         END;                      /* END DO GROUP FOR EXTENSION  0672 02605000
*                                      PROCESSING                    */ 02606000
*       ELSE                                                       0673 02607000
*         DO;                       /* THERE ARE NO EXTENSIONS       */ 02608000
         B     @RC00421                                            0673 02609000
@RF00421 DS    0H                                                  0674 02610000
*           EPABASP=ZERO;           /* ZERO RECOVERY'S POINTER TO THE   02611000
*                                      I/O BUFFER                    */ 02612000
         L     @12,EPAPTR                                          0674 02613000
         SLR   @11,@11                                             0674 02614000
         ST    @11,EPABASP(,@12)                                   0674 02615000
*           EPARASP=BUFFER;         /* RECORD PTR TO ASPCT BASE      */ 02616000
         L     @11,BUFFER                                          0675 02617000
         ST    @11,EPARASP(,@12)                                   0675 02618000
*         END;                                                     0676 02619000
*     END;                          /* ZERO RETURN CODE PROCESSING 0677 02620000
*                                      FOR ASPCT BASE                */ 02621000
         EJECT                                                          02622000
*                                                                  0678 02623000
*/********************************************************************/ 02624000
*/* PROCESS A NON-ZERO RETURN CODE FROM GETONE FOR ASPCT BASE        */ 02625000
*/********************************************************************/ 02626000
*                                                                  0678 02627000
*   ELSE                                                           0678 02628000
*     DO;                                                          0678 02629000
         B     @RC00415                                            0678 02630000
@RF00415 DS    0H                                                  0679 02631000
*       RFY                                                        0679 02632000
*         R15 RSTD;                                                0679 02633000
*       RETCODE=R15;                /* SAVE THE RETURN CODE          */ 02634000
         ST    R15,RETCODE                                         0680 02635000
*       RFY                                                        0681 02636000
*         R15 UNRSTD;                                              0681 02637000
*       IF RETCODE^=STORAGE         /* I/O BUFFER OBTAINED?          */ 02638000
*         THEN                                                     0682 02639000
         L     @12,RETCODE                                         0682 02640000
         C     @12,@CF00122                                        0682 02641000
         BE    @RF00682                                            0682 02642000
*         DO;                       /* YES                           */ 02643000
*           RFY                                                    0684 02644000
*            (R0,                                                  0684 02645000
*             R1,                                                  0684 02646000
*             R3,                                                  0684 02647000
*             R4,                                                  0684 02648000
*             R7,                                                  0684 02649000
*             R8) RSTD;                                            0684 02650000
*           R8=R13;                 /* SAVE SAVEAREA POINTER OBTAIN     02651000
*                                      THE LOCAL LOCK                */ 02652000
         LR    R8,R13                                              0685 02653000
*           GENERATE SETS(R3,R11,R12,R13,R14) REFS(EPAPTR);        0686 02654000
GET8     SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(VIO,           *02655000
               ILRVSAMI(REL8))                                          02656000
         LR    R13,R8                     RESTORE SAVEAREA POINTER      02657000
         L     R4,EPAPTR                  GET PTR TO EPATH              02658000
         SLR   R7,R7                                                    02659000
         ST    R7,EPABASP(R4)             ZERO RECOVERYS POINTER TO     02660000
*                                         THE I/O BUFFER                02661000
         LA    R0,2048                    SET LENGTH FOR 2K             02662000
         L     R1,BUFFER                  GET BUFFER ADDRESS            02663000
         L     R4,PSATOLD                 GET PTR TO CURRENT TCB        02664000
         L     R7,PSAAOLD                 GET PTR TO CURRENT ASCB       02665000
         FREEMAIN RC,A=(1),LV=(0),SP=230,BRANCH=YES                     02666000
*                                                                       02667000
REL8     SETLOCK RELEASE,TYPE=LOCAL,RELATED=(VIO,ILRVSAMI(GET8))        02668000
*           R13=R8;                 /* RESTORE SAVEAREA POINTER      */ 02669000
         LR    R13,R8                                              0687 02670000
*           RFY                                                    0688 02671000
*            (R0,                                                  0688 02672000
*             R1,                                                  0688 02673000
*             R3,                                                  0688 02674000
*             R4,                                                  0688 02675000
*             R7,                                                  0688 02676000
*             R8) UNRSTD;                                          0688 02677000
*         END;                                                     0689 02678000
*       IF EPARPLB=ON THEN                                         0690 02679000
@RF00682 L     @12,EPAPTR                                          0690 02680000
         TM    EPARPLB(@12),B'00000001'                            0690 02681000
         BNO   @RF00690                                            0690 02682000
*         BACKOUT=ON;               /* SET BACKOUT ERROR FLAG ON     */ 02683000
         OI    BACKOUT,B'10000000'                                 0691 02684000
*     END;                                                         0692 02685000
@RF00690 DS    0H                                                  0693 02686000
         EJECT                                                          02687000
*                                                                  0693 02688000
*/********************************************************************/ 02689000
*/* IF WE HAVE HAD ANY TROUBLE RETRIEVING THE EXTENSIONS THE BACKOUT */ 02690000
*/* FLAG WILL HAVE BEEN TURNED ON. THIS SECTION WILL ERASE THE       */ 02691000
*/* REMAINING ASST AND LPME EXTENSIONS FROM SYS1.STGINDEX.           */ 02692000
*/********************************************************************/ 02693000
*                                                                  0693 02694000
*   IF BACKOUT=ON                   /* ANY ERRORS RETRIEVING?        */ 02695000
*     THEN                                                         0693 02696000
@RC00415 TM    BACKOUT,B'10000000'                                 0693 02697000
         BNO   @RF00693                                            0693 02698000
*     DO;                           /* YES                           */ 02699000
*       RFY                                                        0695 02700000
*        (R5,                                                      0695 02701000
*         R7) RSTD;                                                0695 02702000
*       R5=RPLPTR;                  /* OBTAIN THE RPL ADDR           */ 02703000
         L     R5,RPLPTR                                           0696 02704000
*       R7=ADDR(RECADDR);           /* ADDR AREA TO STORE ADDR OF  0697 02705000
*                                      RECORD LOCATED                */ 02706000
         LA    R7,RECADDR                                          0697 02707000
*       GEN(MODCB RPL=(5),OPTCD=(LOC),AREALEN=4,AREA=(7));/* CHANGE     02708000
*                                      MVE OPTION TO LOCATE          */ 02709000
         MODCB RPL=(5),OPTCD=(LOC),AREALEN=4,AREA=(7)                   02710000
*       DO WHILE EXTNUMB<=MAXEXTN;                                 0699 02711000
         B     @DE00699                                            0699 02712000
@DL00699 DS    0H                                                  0700 02713000
*         GEN(GET RPL=(5));         /* RETRIEVE THE RECORD           */ 02714000
         GET RPL=(5)                                                    02715000
*         GEN(ERASE RPL=(5));       /* ERASE THE EXTENSION           */ 02716000
         ERASE RPL=(5)                                                  02717000
*         EXTNUMB=EXTNUMB+ONE;      /* INCREMENT VSAM KEY            */ 02718000
         LA    @12,1                                               0702 02719000
         AL    @12,EXTNUMB                                         0702 02720000
         ST    @12,EXTNUMB                                         0702 02721000
*       END;                                                       0703 02722000
@DE00699 L     @12,EXTNUMB                                         0703 02723000
         C     @12,MAXEXTN                                         0703 02724000
         BNH   @DL00699                                            0703 02725000
*       RFY                                                        0704 02726000
*        (R5,                                                      0704 02727000
*         R7) UNRSTD;                                              0704 02728000
*     END;                                                         0705 02729000
*   RFY                                                            0706 02730000
*    (R14,                                                         0706 02731000
*     R15) RSTD;                                                   0706 02732000
@RF00693 DS    0H                                                  0707 02733000
*   R14=RETADDR1;                   /* GET RETURN ADDRESS            */ 02734000
         L     R14,RETADDR1                                        0707 02735000
*   R15=RETCODE;                    /* LOAD RETURN CODE              */ 02736000
         L     R15,RETCODE                                         0708 02737000
*   RETURN;                         /* RETURN TO MAINLINE            */ 02738000
@EL00004 DS    0H                                                  0709 02739000
@EF00004 DS    0H                                                  0709 02740000
@ER00004 BR    @14                                                 0709 02741000
*   RFY                                                            0710 02742000
*    (R14,                                                         0710 02743000
*     R15) UNRSTD;                                                 0710 02744000
         EJECT                                                          02745000
*                                                                  0711 02746000
*/********************************************************************/ 02747000
*/* THIS NEXT SECTION WILL ESTABLISH A RETRY LOOP, AND ISSUE AN      */ 02748000
*/* ERASE FOR THE RECORD KEY IN THE RPL. IF THE ERASE IS SUCCESSFUL, */ 02749000
*/* LOOP EXIT IS FORCED. IF THE ERASE IS UNSUCCESSFUL, THE RETURN    */ 02750000
*/* CODE IS CHECKED FOR EITHER A PHYSICAL OR LOGICAL ERROR. IF IT IS */ 02751000
*/* A PHYSICAL ERROR LOOP EXIT IS FORCED AND THE RETURN CODE IS SET  */ 02752000
*/* TO FOUR. IF IT IS A LOGICAL ERROR, A SHOWCB IS ISSUED TO         */ 02753000
*/* DETERMINE IF RETRY IS POSSIBLE. IF RETRY IS NOT POSSIBLE THE     */ 02754000
*/* RETURN CODE IS SET TO FOUR AND LOOP EXIT IS FORCED.              */ 02755000
*/********************************************************************/ 02756000
*                                                                  0711 02757000
*ERASES:                                                           0711 02758000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0711 02759000
ERASES   DS    0H                                                  0712 02760000
*   RFY                                                            0712 02761000
*     R14 RSTD;                                                    0712 02762000
*   RETADDR2=R14;                   /* SAVE THE RETURN ADDRESS       */ 02763000
         ST    R14,RETADDR2                                        0713 02764000
*   RFY                                                            0714 02765000
*     R14 UNRSTD;                                                  0714 02766000
*   RETRY=ZERO;                     /* INIT LOOP CONTROLLER          */ 02767000
         SLR   RETRY,RETRY                                         0715 02768000
*   DO WHILE RETRY<MAXIMUM;                                        0716 02769000
         B     @DE00716                                            0716 02770000
@DL00716 DS    0H                                                  0717 02771000
*     RFY                                                          0717 02772000
*       R1 RSTD;                                                   0717 02773000
*     R1=RPLPTR;                    /* OBTAIN RPL ADDR               */ 02774000
         L     R1,RPLPTR                                           0718 02775000
*     GEN(ERASE RPL=(1));           /* ERASE THE RECORD FROM       0719 02776000
*                                      SYS1.STGINDEX                 */ 02777000
         ERASE RPL=(1)                                                  02778000
*     RFY                                                          0720 02779000
*       R1 UNRSTD;                                                 0720 02780000
*     RFY                                                          0721 02781000
*       R15 RSTD;                                                  0721 02782000
*     IF R15^=ZERO                  /* ERASE SUCCESSFUL?             */ 02783000
*       THEN                        /* NO                            */ 02784000
         LTR   R15,R15                                             0722 02785000
         BZ    @RF00722                                            0722 02786000
*       IF R15=PHYSICAL             /* WAS IT A PHYSICAL ERROR       */ 02787000
*         THEN                                                     0723 02788000
         C     R15,@CF00093                                        0723 02789000
         BNE   @RF00723                                            0723 02790000
*         DO;                       /* YES                           */ 02791000
*           RETRY=MAXIMUM;          /* FORCE LOOP EXIT               */ 02792000
         LA    RETRY,5                                             0725 02793000
*           RFY                                                    0726 02794000
*             R15 UNRSTD;                                          0726 02795000
*         END;                                                     0727 02796000
*       ELSE                                                       0728 02797000
*         DO;                       /* NO, IT WAS A LOGICAL ERROR    */ 02798000
         B     @RC00723                                            0728 02799000
@RF00723 DS    0H                                                  0729 02800000
*           RFY                                                    0729 02801000
*            (R0,                                                  0729 02802000
*             R1,                                                  0729 02803000
*             R7) RSTD;                                            0729 02804000
*           FBCODE=ZERO;            /* ZERO FEEDBACK CODE AREA       */ 02805000
         SLR   @12,@12                                             0730 02806000
         ST    @12,FBCODE                                          0730 02807000
*           R0=RPLPTR;              /* GET ADDRESS OF RPL            */ 02808000
         L     R0,RPLPTR                                           0731 02809000
*           R7=ADDR(FBCODE);        /* GET ADDR OF RETURN AREA       */ 02810000
         LA    R7,FBCODE                                           0732 02811000
*           GENERATE SETS(FBCODE);                                 0733 02812000
*                                      /* DETERMINE TYPE OF ERROR    */ 02813000
               SHOWCB RPL=(R0),AREA=(R7),LENGTH=4,FIELDS=(FDBK),       *02814000
               MF=(G,BSHOWCB,SHOWSIZE)                                  02815000
*           RFY                                                    0734 02816000
*            (R0,                                                  0734 02817000
*             R1,                                                  0734 02818000
*             R7) UNRSTD;                                          0734 02819000
*                                                                  0734 02820000
*           /*********************************************************/ 02821000
*           /*                                                       */ 02822000
*           /* WAS VSAM UNABLE TO OBTAIN STORAGE, OR IS THE MAXIMUM  */ 02823000
*           /* NUMBER OF REQUESTS STARTED ALREADY?                   */ 02824000
*           /*                                                       */ 02825000
*           /*********************************************************/ 02826000
*                                                                  0735 02827000
*           IF FBCODE=SPACE|FBCODE=TOOMANY THEN/* YES, RETRY         */ 02828000
         L     @12,FBCODE                                          0735 02829000
         C     @12,@CF00137                                        0735 02830000
         BE    @RT00735                                            0735 02831000
         C     @12,@CF00139                                        0735 02832000
         BNE   @RF00735                                            0735 02833000
@RT00735 DS    0H                                                  0736 02834000
*             RETRY=RETRY+ONE;      /* INCREMENT LOOP CONTROLLER     */ 02835000
         AL    RETRY,@CF00098                                      0736 02836000
*           ELSE                    /* NO, NO RETRY                  */ 02837000
*             RETRY=MAXIMUM;        /* FORCE LOOP EXIT               */ 02838000
         B     @RC00735                                            0737 02839000
@RF00735 LA    RETRY,5                                             0737 02840000
*         END;                                                     0738 02841000
*     ELSE                          /* YES, ERASE WAS SUCCESSFUL     */ 02842000
*       RETRY=MAXIMUM;              /* FORCE LOOP EXIT               */ 02843000
         B     @RC00722                                            0739 02844000
@RF00722 LA    RETRY,5                                             0739 02845000
*   END;                            /* END DO WHILE LOOP FOR RETRY   */ 02846000
@RC00722 DS    0H                                                  0740 02847000
@DE00716 C     RETRY,@CF00131                                      0740 02848000
         BL    @DL00716                                            0740 02849000
*   RFY                                                            0741 02850000
*     R14 RSTD;                                                    0741 02851000
*   R14=RETADDR2;                   /* GET RETURN ADDRESS            */ 02852000
         L     R14,RETADDR2                                        0742 02853000
*   END ERASES;                                                    0743 02854000
@EL00005 DS    0H                                                  0743 02855000
@EF00005 DS    0H                                                  0743 02856000
@ER00005 BR    @14                                                 0743 02857000
*   END RETERASE;                                                  0744 02858000
*   RFY                                                            0745 02859000
*    (R14,                                                         0745 02860000
*     R15) UNRSTD;                                                 0745 02861000
         EJECT                                                          02862000
*                                                                  0746 02863000
*/********************************************************************/ 02864000
*/*                                                                  */ 02865000
*/*  GETONE:   RETRIEVE A RECORD FROM SYS1.STGINDEX                  */ 02866000
*/*                                                                  */ 02867000
*/*  INPUT:    POINTER TO THE EPATH                                  */ 02868000
*/*            POINTER TO AREA IN WHICH TO BUILD THE RPL             */ 02869000
*/*            WORKAREA KEY SET FOR THE RECORD                       */ 02870000
*/*                                                                  */ 02871000
*/*  PROCESS:  SAVE THE RETURN ADDRESS. GETMAIN A 2K BUFFER TO READ  */ 02872000
*/*            THE RECORD INTO. RECORD THE BUFFER ADDRESS IN THE     */ 02873000
*/*            EPATH. IF THIS REQUEST IS FOR AN ASPCT BASE, ISSUE A  */ 02874000
*/*            GENCB TO BUILD THE RPL. ISSUE A GET TO RETRIEVE THE   */ 02875000
*/*            RECORD FROM SYS1.STGINDEX. IF THERE IS A NON-ZERO     */ 02876000
*/*            RETURN FROM GET, ISSUE A SHOWCB TO DETERMINE TYPE OF  */ 02877000
*/*            ERROR. SET THE RETURN CODE TO 08 IF ERROR WAS RECORD  */ 02878000
*/*            COULD NOT BE FOUND, 20 FOR I/O ERRORS. RETURN TO      */ 02879000
*/*            CALLER.                                               */ 02880000
*/*                                                                  */ 02881000
*/*  OUTPUT:   REGISTER 1 = PTR TO RETRIEVED RECORD                  */ 02882000
*/*            REGISTER 15 = RETURN CODE                             */ 02883000
*/*                          00 = SUCCESSFUL                         */ 02884000
*/*                          08 = RECORD NOT FOUND                   */ 02885000
*/*                          20 = I/O ERROR ON SYS1.STGINDEX         */ 02886000
*/*                                                                  */ 02887000
*/********************************************************************/ 02888000
*/*GETONE: CHART (AREF,SEQ)                                          */ 02889000
*/*HEADER                                                          0746 02890000
*/* GETONE: READ A RECORD IN FROM SYS1.STGINDEX                      */ 02891000
*/*GETONE:  E  ENTRY                                                 */ 02892000
*/*         P  SAVE THE RETURN ADDRESS                               */ 02893000
*/*         P  LOAD REGISTERS FOR GENCB                              */ 02894000
*/*         S  GENCB: BUILD THE RPL                                  */ 02895000
*/*         D  (YES,GETONE ,NO,) ZERO RETURN CODE?                   */ 02896000
*/*         P  SET INTERNAL RETURN CODE TO 20                        */ 02897000
*/*         P  SET REG 1 TO ZERO                                     */ 02898000
*/*         R  RETURN CODE 20                                        */ 02899000
*/*GETONE : E  ENTRY                                                 */ 02900000
*/*         L  SETLOCK: UNCOND OBTAIN LOCAL LOCK                     */ 02901000
*/*         P  LOAD REGISTERS FOR GETMAIN                            */ 02902000
*/*         S  GETMAIN: GET A BUFFER FROM SP230                      */ 02903000
*/*         P  SAVE THE RETURN CODE                                  */ 02904000
*/*         P  SAVE PTR TO BUFFER                                    */ 02905000
*/*         L  SETLOCK: UNCOND RELEASE LOCAL LOCK                    */ 02906000
*/*         D  (YES,%VSM47,NO,) DID WE OBTAIN STORAGE?               */ 02907000
*/*         P  SET REG 1 TO ZERO                                     */ 02908000
*/*         P  SET INTERNAL RETURN CODE TO 28                        */ 02909000
*/*         R  RETURN CODE 28                                        */ 02910000
*/*%VSM47:  P  RECORD BUFFER ADDRESS IN EPATH                        */ 02911000
*/*         P  ZERO RETRY COUNTER                                    */ 02912000
*/*%VSM49:  P  LOAD REG FOR GET                                      */ 02913000
*/*         S  GET: RETRIEVE RECORD FROM STGINDEX                    */ 02914000
*/*         D  (YES,,NO,%VSM50) ZERO RETURN CODE?                    */ 02915000
*/*         P  LOAD REG 1 WITH PTR TO BUFFER                         */ 02916000
*/*         R  RETURN CODE 0                                         */ 02917000
*/*%VSM50:  S  SHOWCB: DETERMINE ERROR                               */ 02918000
*/*         D  (YES,,NO,%VSM51) RECORD NOT FOUND?                    */ 02919000
*/*         P  SET INTERNAL RETURN CODE TO 08                        */ 02920000
*/*         P  LOAD REG 1 WITH PTR TO I/O BUFFER                     */ 02921000
*/*         R  RETURN CODE 08                                        */ 02922000
*/*%VSM51:  D  (YES,,NO,%VSM51A) RETRY POSSIBLE?                     */ 02923000
*/*         P  INCREMENT THE RETRY COUNTER                           */ 02924000
*/*         D  (YES,,NO,%VSM49) REACHED MAXIMUM RETRY                */ 02925000
*/*%VSM51A: P  SET INTERNAL RETURN CODE TO 20                        */ 02926000
*/*         P  LOAD REG 1 WITH PTR TO I/O BUFFER                     */ 02927000
*/*         R  RETURN CODE 20                                        */ 02928000
*/*GETONE:  END                                                      */ 02929000
*                                                                  0746 02930000
         EJECT                                                          02931000
*GETONE:                                                           0746 02932000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0746 02933000
GETONE   DS    0H                                                  0747 02934000
*   RFY                                                            0747 02935000
*    (R0,                                                          0747 02936000
*     R1,                                                          0747 02937000
*     R3,                                                          0747 02938000
*     R4,                                                          0747 02939000
*     R7,                                                          0747 02940000
*     R8,                                                          0747 02941000
*     R14,                                                         0747 02942000
*     R15) RSTD;                                                   0747 02943000
*   RETADDR2=R14;                   /* SAVE THE RETURN ADDRESS       */ 02944000
         ST    R14,RETADDR2                                        0748 02945000
*   RFY                                                            0749 02946000
*     R14 UNRSTD;                                                  0749 02947000
*   R8=R13;                         /* SAVE SAVEAREA POINTER OBTAIN     02948000
*                                      THE LOCAL LOCK                */ 02949000
         LR    R8,R13                                              0750 02950000
*   GENERATE SETS(R1,R3,R11,R12,R13,R14) REFS(BUFFER,RETCODE1);    0751 02951000
GET9     SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(VIO,           *02952000
               ILRVSAMI(REL9))                                          02953000
         LR    R13,R8                     RESTORE SAVEAREA POINTER      02954000
         LA    R0,2048                    SET LENGTH FOR 2K BUFFER      02955000
         L     R4,PSATOLD                 GET ADDRESS OF CURRENT TCB    02956000
         L     R7,PSAAOLD                 GET ADDRESS OF CURRENT ASCB   02957000
         GETMAIN RC,LV=(0),SP=230,BRANCH=YES                            02958000
         ST    R1,BUFFER                  SAVE PTR TO GETMAIN AREA      02959000
         LR    R8,R13                     SAVE SAVEAREA POINTER         02960000
REL9     SETLOCK RELEASE,TYPE=LOCAL,RELATED=(VIO,ILRVSAMI(GET9))        02961000
*   R13=R8;                         /* RESTORE SAVEAREA POINTER      */ 02962000
         LR    R13,R8                                              0752 02963000
*   RFY                                                            0753 02964000
*    (R0,                                                          0753 02965000
*     R1,                                                          0753 02966000
*     R3,                                                          0753 02967000
*     R4,                                                          0753 02968000
*     R7,                                                          0753 02969000
*     R8) UNRSTD;                                                  0753 02970000
*   IF R15^=ZERO                    /* WAS GETMAIN SUCCESSFUL?       */ 02971000
*     THEN                                                         0754 02972000
         SLR   @14,@14                                             0754 02973000
         CR    R15,@14                                             0754 02974000
         BE    @RF00754                                            0754 02975000
*     DO;                           /* NO, RETURN TO CALLER          */ 02976000
*       BUFFER=ZERO;                /* CLEAR THE BUFFER POINTER      */ 02977000
         ST    @14,BUFFER                                          0756 02978000
*       RFY                                                        0757 02979000
*         R14 RSTD;                                                0757 02980000
*       R14=RETADDR2;               /* GET RETURN ADDRESS            */ 02981000
         L     R14,RETADDR2                                        0758 02982000
*       RETURN CODE(STORAGE);       /* RETURN INDICATING WE COULD NOT   02983000
*                                      OBTAIN STORAGE                */ 02984000
         LA    @15,28                                              0759 02985000
@EL00006 DS    0H                                                  0759 02986000
@EF00006 DS    0H                                                  0759 02987000
@ER00006 BR    @14                                                 0759 02988000
*       RFY                                                        0760 02989000
*        (R14,                                                     0760 02990000
*         R15) UNRSTD;                                             0760 02991000
*     END;                                                         0761 02992000
*   EPABASP=BUFFER;                 /* RECORD THE POINTER TO THE I/O    02993000
*                                      BUFFER FOR RECOVERY           */ 02994000
@RF00754 L     @12,BUFFER                                          0762 02995000
         L     @11,EPAPTR                                          0762 02996000
         ST    @12,EPABASP(,@11)                                   0762 02997000
*   IF EPARPLB=OFF                  /* HAS THE RPL BEEN BUILT?       */ 02998000
*     THEN                                                         0763 02999000
         TM    EPARPLB(@11),B'00000001'                            0763 03000000
         BNZ   @RF00763                                            0763 03001000
*     DO;                           /* NO                            */ 03002000
*       RFY                                                        0765 03003000
*        (R0,                                                      0765 03004000
*         R1,                                                      0765 03005000
*         R4,                                                      0765 03006000
*         R7,                                                      0765 03007000
*         R11,                                                     0765 03008000
*         R12) RSTD;                                               0765 03009000
*       R7=ASMSTGXA;                /* GET ADDRESS OF SYS1.STGINDEX     03010000
*                                      ACB FROM ASMVT                */ 03011000
         L     @08,ASMVTWPT                                        0766 03012000
         L     R7,ASMSTGXA(,@08)                                   0766 03013000
*       R4=BUFFER;                  /* GET ADDRESS OF I/O BUFFER     */ 03014000
         L     @08,BUFFER                                          0767 03015000
         LR    R4,@08                                              0767 03016000
*       R11=LENGTH(IFGRPL);         /* SET LENGTH OF AN RPL          */ 03017000
         LA    R11,76                                              0768 03018000
*       R0=ADDR(WKAVKEY);           /* GET ADDRESS OF VSAM KEY       */ 03019000
         LA    R0,WKAVKEY                                          0769 03020000
*       R12=RPLPTR;                 /* GET ADDRESS OF THE RPL BUILD     03021000
*                                      AREA                          */ 03022000
         L     R12,RPLPTR                                          0770 03023000
*       IF OPCODE=ONE THEN                                         0771 03024000
         L     @08,PARMPTR                                         0771 03025000
         CLI   OPCODE(@08),1                                       0771 03026000
         BNE   @RF00771                                            0771 03027000
*         DO;                       /* AN ACTIVATE REQUEST           */ 03028000
*           GENERATE REFS(R0,R1,R4,R7,R11,R12);                    0773 03029000
         GENCB BLK=RPL,AM=VSAM,ACB=(R7),ARG=(R0),COPIES=1,AREALEN=2048,*03030000
               LENGTH=(R11),AREA=(R4),OPTCD=(KEY,DIR,SYN,KEQ,FKS,MVE,  *03031000
               NUP),RECLEN=2041,WAREA=(R12),MF=(G,BLDGENCB,GENBSIZE)    03032000
*         END;                                                     0774 03033000
*       ELSE                                                       0775 03034000
*         DO;                       /* SAVE OR RELEASE REQUEST       */ 03035000
         B     @RC00771                                            0775 03036000
@RF00771 DS    0H                                                  0776 03037000
*           GENERATE REFS(R0,R1,R4,R7,R11,R12);                    0776 03038000
         GENCB BLK=RPL,AM=VSAM,ACB=(R7),ARG=(R0),COPIES=1,AREALEN=2048,*03039000
               LENGTH=(R11),AREA=(R4),OPTCD=(KEY,DIR,SYN,KEQ,FKS,MVE,  *03040000
               UPD),RECLEN=2041,WAREA=(R12),MF=(G,BLDGENCB)             03041000
*         END;                                                     0777 03042000
*       RFY                                                        0778 03043000
*        (R0,                                                      0778 03044000
*         R1,                                                      0778 03045000
*         R4,                                                      0778 03046000
*         R7,                                                      0778 03047000
*         R11,                                                     0778 03048000
*         R12) UNRSTD;                                             0778 03049000
@RC00771 DS    0H                                                  0779 03050000
*       RFY                                                        0779 03051000
*         R15 RSTD;                                                0779 03052000
*       IF R15^=ZERO                /* WAS THE RPL BUILT?            */ 03053000
*         THEN                                                     0780 03054000
         LTR   R15,R15                                             0780 03055000
         BZ    @RF00780                                            0780 03056000
*         DO;                       /* NO                            */ 03057000
*           RFY                                                    0782 03058000
*             R14 RSTD;                                            0782 03059000
*           R14=RETADDR2;           /* GET RETURN ADDRESS            */ 03060000
         L     R14,RETADDR2                                        0783 03061000
*           RETURN CODE(TWENTY);    /* RETURN INDICATING WE HAD A  0784 03062000
*                                      VSAM ERROR                    */ 03063000
         LA    @15,20                                              0784 03064000
         BR    @14                                                 0784 03065000
*           RFY                                                    0785 03066000
*            (R14,                                                 0785 03067000
*             R15) UNRSTD;                                         0785 03068000
*         END;                                                     0786 03069000
*       EPARPLB=ON;                 /* SET RPL BUILT FLAG            */ 03070000
@RF00780 L     @12,EPAPTR                                          0787 03071000
         OI    EPARPLB(@12),B'00000001'                            0787 03072000
*     END;                                                         0788 03073000
*   ELSE                            /* YES THE RPL WAS BUILT         */ 03074000
*     RPLAREA=BUFFER;               /* SET NEW BUFFER ADDRESS        */ 03075000
         B     @RC00763                                            0789 03076000
@RF00763 L     @12,BUFFER                                          0789 03077000
         L     @11,RPLPTR                                          0789 03078000
         ST    @12,RPLAREA(,@11)                                   0789 03079000
         EJECT                                                          03080000
*                                                                  0790 03081000
*/********************************************************************/ 03082000
*/*  RETRIEVE THE RECORD FROM SYS1.STGINDEX                          */ 03083000
*/********************************************************************/ 03084000
*                                                                  0790 03085000
*   RETRY=ZERO;                     /* INIT LOOP CONTROLLER          */ 03086000
@RC00763 SLR   RETRY,RETRY                                         0790 03087000
*   DO WHILE RETRY<MAXIMUM;                                        0791 03088000
         B     @DE00791                                            0791 03089000
@DL00791 DS    0H                                                  0792 03090000
*     RFY                                                          0792 03091000
*       R1 RSTD;                                                   0792 03092000
*     R1=RPLPTR;                    /* OBTAIN RPL ADDR               */ 03093000
         L     R1,RPLPTR                                           0793 03094000
*     GEN(GET RPL=(1));             /* RETRIEVE THE RECORD           */ 03095000
         GET RPL=(1)                                                    03096000
*     RFY                                                          0795 03097000
*       R1 UNRSTD;                                                 0795 03098000
*     RFY                                                          0796 03099000
*       R15 RSTD;                                                  0796 03100000
*     IF R15^=ZERO                  /* RETRIEVAL SUCCESSFUL?         */ 03101000
*       THEN                        /* NO                            */ 03102000
         LTR   R15,R15                                             0797 03103000
         BZ    @RF00797                                            0797 03104000
*       IF R15=PHYSICAL             /* WAS THERE A PHYSICAL ERROR    */ 03105000
*         THEN                                                     0798 03106000
         C     R15,@CF00093                                        0798 03107000
         BNE   @RF00798                                            0798 03108000
*         DO;                       /* YES, NO RETRY POSSIBLE        */ 03109000
*           RETRY=MAXIMUM;          /* FORCE LOOP EXIT               */ 03110000
         LA    RETRY,5                                             0800 03111000
*           R15=TWENTY;             /* SET RETURN CODE FOR I/O ERROR */ 03112000
         LA    R15,20                                              0801 03113000
*         END;                                                     0802 03114000
*       ELSE                                                       0803 03115000
*         DO;                       /* NO, IT WAS A LOGICAL ERROR    */ 03116000
         B     @RC00798                                            0803 03117000
@RF00798 DS    0H                                                  0804 03118000
*           RFY                                                    0804 03119000
*            (R0,                                                  0804 03120000
*             R1,                                                  0804 03121000
*             R7) RSTD;                                            0804 03122000
*           FBCODE=ZERO;            /* ZERO FEEDBACK CODE AREA       */ 03123000
         SLR   @14,@14                                             0805 03124000
         ST    @14,FBCODE                                          0805 03125000
*           R0=RPLPTR;              /* GET ADDRESS OF RPL            */ 03126000
         L     R0,RPLPTR                                           0806 03127000
*           R7=ADDR(FBCODE);        /* GET ADDR OF RETURN AREA       */ 03128000
         LA    R7,FBCODE                                           0807 03129000
*           GENERATE SETS(FBCODE);                                 0808 03130000
*                                      /* GET THE FEEDBACK CODE      */ 03131000
               SHOWCB RPL=(R0),AREA=(R7),LENGTH=4,FIELDS=(FDBK),       *03132000
               MF=(G,BSHOWCB)                                           03133000
*           RFY                                                    0809 03134000
*            (R0,                                                  0809 03135000
*             R1,                                                  0809 03136000
*             R7) UNRSTD;           /* WAS ERROR CAUSED BY         0809 03137000
*                                      INSUFFICIENT STORAGE OR WEW 0809 03138000
*                                      THE MAXIMUM NUMBER OF REQUESTS   03139000
*                                      OUTSTANDING                   */ 03140000
*           IF FBCODE=SPACE|FBCODE=TOOMANY THEN                    0810 03141000
         L     @14,FBCODE                                          0810 03142000
         C     @14,@CF00137                                        0810 03143000
         BE    @RT00810                                            0810 03144000
         C     @14,@CF00139                                        0810 03145000
         BNE   @RF00810                                            0810 03146000
@RT00810 DS    0H                                                  0811 03147000
*             DO;                   /* YES, RETRY                    */ 03148000
*               RETRY=RETRY+ONE;    /* INCREMENT RETRY COUNTER       */ 03149000
         AL    RETRY,@CF00098                                      0812 03150000
*               R15=TWENTY;         /* SET I/O ERROR RC              */ 03151000
         LA    R15,20                                              0813 03152000
*             END;                                                 0814 03153000
*           ELSE                                                   0815 03154000
*             DO;                   /* NO, NON-RETRIABLE ERROR       */ 03155000
         B     @RC00810                                            0815 03156000
@RF00810 DS    0H                                                  0816 03157000
*               RETRY=MAXIMUM;      /* FORCE LOOP EXIT               */ 03158000
         LA    RETRY,5                                             0816 03159000
*               IF FBCODE=NOTFOUND  /* RECORD NOT FOUND?             */ 03160000
*                 THEN              /* YES, SET NOT FOUND RC         */ 03161000
         CLC   FBCODE(4),@CF00143                                  0817 03162000
         BNE   @RF00817                                            0817 03163000
*                 R15=KEYNGOOD;                                    0818 03164000
         LA    R15,8                                               0818 03165000
*               ELSE                /* NO, SET I/O ERROR RC          */ 03166000
*                 R15=TWENTY;                                      0819 03167000
         B     @RC00817                                            0819 03168000
@RF00817 LA    R15,20                                              0819 03169000
*               RFY                                                0820 03170000
*                 R15 UNRSTD;       /* ERROR                         */ 03171000
@RC00817 DS    0H                                                  0821 03172000
*             END;                                                 0821 03173000
*         END;                                                     0822 03174000
*     ELSE                          /* YES, RETRIEVAL SUCCESSFUL     */ 03175000
*       RETRY=MAXIMUM;              /* FORCE LOOP EXIT               */ 03176000
         B     @RC00797                                            0823 03177000
@RF00797 LA    RETRY,5                                             0823 03178000
*   END;                            /* END RETRY LOOP                */ 03179000
@RC00797 DS    0H                                                  0824 03180000
@DE00791 C     RETRY,@CF00131                                      0824 03181000
         BL    @DL00791                                            0824 03182000
*   RFY                                                            0825 03183000
*     R14 RSTD;                                                    0825 03184000
*   R14=RETADDR2;                   /* GET RETURN ADDRESS            */ 03185000
         L     R14,RETADDR2                                        0826 03186000
*   RFY                                                            0827 03187000
*     R14 UNRSTD;                                                  0827 03188000
*   END GETONE;                                                    0828 03189000
         B     @EL00006                                            0828 03190000
         EJECT                                                          03191000
*                                                                  0829 03192000
*/********************************************************************/ 03193000
*/*                                                                  */ 03194000
*/*  PUTONE:   WRITE A RECORD TO SYS1.STGINDEX                       */ 03195000
*/*                                                                  */ 03196000
*/*  INPUT:    POINTER TO THE EPATH                                  */ 03197000
*/*            POINTER TO AREA IN WHICH TO BUILD THE RPL             */ 03198000
*/*            POINTER TO RECORD TO BE WRITTEN                       */ 03199000
*/*            WORKAREA KEY SET FOR THE RECORD                       */ 03200000
*/*                                                                  */ 03201000
*/*  PROCESS:  SAVE THE RETURN ADDRESS. ISSUE A GETMAIN FOR THE 2K   */ 03202000
*/*            I/O BUFFER. RECORD POINTER TO BUFFER IN THE EPATH.    */ 03203000
*/*            ISSUE A GENCB TO BUILD THE RPL. EXTENSION PROCESSING  */ 03204000
*/*            WILL ENTER HERE AT A SECONDARY ENTRY POINT PUTONEA.   */ 03205000
*/*            COPY THE RECORD TO BE WRITTEN OUT TO THE BUFFER. ISSUE*/ 03206000
*/*            A PUT TO WRITE THE RECORD TO SYS1.STGINDEX. IF THERE  */ 03207000
*/*            IS A NON-ZERO RETURN CODE FROM PUT, ISSUE A SHOWCB TO */ 03208000
*/*            DETERMINE TYPE OF ERROR. IF SYS1.STGINDEX IS FULL, SET*/ 03209000
*/*            THE RETURN CODE TO 24, OR 20 FOR I/O ERRORS. RETURN   */ 03210000
*/*            TO PUTASPCT.                                          */ 03211000
*/*                                                                  */ 03212000
*/*  OUTPUT:   THE RECORD IS WRITTEN TO SYS1.STGINDEX                */ 03213000
*/*                                                                  */ 03214000
*/********************************************************************/ 03215000
*/*PUTONE: CHART (AREF,SEQ)                                          */ 03216000
*/*HEADER                                                          0829 03217000
*/* PUTONE: WRITE A RECORD TO SYS1.STGINDEX                          */ 03218000
*/*PUTONE:  E  ENTRY                                                 */ 03219000
*/*         P  SAVE THE RETURN ADDRESS                               */ 03220000
*/*         L  SETLOCK: UNCOND OBTAIN LOCAL LOCK                     */ 03221000
*/*         P  LOAD REGISTERS FOR GETMAIN                            */ 03222000
*/*         S  GETMAIN: GET A BUFFER FROM SP230                      */ 03223000
*/*         P  SAVE THE RETURN CODE                                  */ 03224000
*/*         P  SAVE PTR TO BUFFER                                    */ 03225000
*/*         L  SETLOCK: UNCOND RELEASE LOCAL LOCK                    */ 03226000
*/*         D  (YES,%VSM52,NO,) DID WE OBTAIN STORAGE?               */ 03227000
*/*         P  SET INTERNAL RETURN CODE TO 28                        */ 03228000
*/*         R  RETURN CODE 28                                        */ 03229000
*/*%VSM52:  P  RECORD PTR TO BUFFER IN EPATH                         */ 03230000
*/*         P  LOAD REGISTERS FOR GENCB                              */ 03231000
*/*         S  GENCB: BUILD THE RPL                                  */ 03232000
*/*         D  (YES,PUTONEA,NO,) ZERO RETURN CODE?                   */ 03233000
*/*         P  SET INTERNAL RETURN CODE TO 20                        */ 03234000
*/*         R  RETURN CODE 20                                        */ 03235000
*/*PUTONEA: E  ENTRY                                                 */ 03236000
*/*         P  COPY ASPCT TO BUFFER                                  */ 03237000
*/*         P  ZERO THE RETRY COUNTER                                */ 03238000
*/*%VSM53:  P  LOAD REG FOR PUT                                      */ 03239000
*/*         S  PUT: WRITE RECORD TO STGINDEX                         */ 03240000
*/*         D  (YES,,NO,%VSM54) ZERO RETURN CODE?                    */ 03241000
*/*         R  RETURN CODE 0                                         */ 03242000
*/*%VSM54:  S  SHOWCB: DETERMINE ERROR                               */ 03243000
*/*         D  (YES,,NO,%VSM54A) RETRY POSSIBLE?                     */ 03244000
*/*         P  INCREMENT THE RETRY COUNTER                           */ 03245000
*/*         D  (YES,,NO,%VSM53) REACHED MAXIMUM RETRY?               */ 03246000
*/*%VSM54A: D  (YES,,NO,%VSM55) STGINDEX FULL?                       */ 03247000
*/*         P  (,%VSM56) SET RETURN CODE TO 24                       */ 03248000
*/*%VSM55:  P  SET RETURN CODE TO 20                                 */ 03249000
*/*%VSM56:  R  RETURN TO CALLER                                      */ 03250000
*/*PUTONE: END                                                       */ 03251000
*                                                                  0829 03252000
         EJECT                                                          03253000
*PUTONE:                                                           0829 03254000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0829 03255000
PUTONE   DS    0H                                                  0830 03256000
*   RFY                                                            0830 03257000
*     R14 RSTD;                                                    0830 03258000
*   RETADDR2=R14;                   /* SAVE THE RETURN ADDRESS       */ 03259000
         ST    R14,RETADDR2                                        0831 03260000
*   RFY                                                            0832 03261000
*     R14 UNRSTD;                                                  0832 03262000
*   RFY                                                            0833 03263000
*    (R0,                                                          0833 03264000
*     R1,                                                          0833 03265000
*     R3,                                                          0833 03266000
*     R4,                                                          0833 03267000
*     R7,                                                          0833 03268000
*     R8,                                                          0833 03269000
*     R15) RSTD;                                                   0833 03270000
*   R8=R13;                         /* SAVE SAVEAREA ADDRESS OBTAIN     03271000
*                                      THE LOCAL LOCK                */ 03272000
         LR    R8,R13                                              0834 03273000
*   GENERATE SETS(R1,R3,R4,R7,BUFFER,RETCODE1);                    0835 03274000
GET10    SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(VIO,           *03275000
               ILRVSAMI(REL10))                                         03276000
         LR    R13,R8                     RESTORE SAVEAREA POINTER      03277000
         LA    R0,2048                    SET LENGTH FOR 2K BUFFER      03278000
         L     R4,PSATOLD                 GET ADDRESS OF CURRENT TCB    03279000
         L     R7,PSAAOLD                 GET ADDRESS OF CURRENT ASCB   03280000
         GETMAIN RC,LV=(0),SP=230,BRANCH=YES                            03281000
         ST    R1,BUFFER                  SAVE THE BUFFER ADDRESS       03282000
REL10    SETLOCK RELEASE,TYPE=LOCAL,RELATED=(VIO,ILRVSAMI(GET10))       03283000
*   R13=R8;                         /* RESTORE SAVEAREA POINTER      */ 03284000
         LR    R13,R8                                              0836 03285000
*   RFY                                                            0837 03286000
*    (R0,                                                          0837 03287000
*     R1,                                                          0837 03288000
*     R3,                                                          0837 03289000
*     R4,                                                          0837 03290000
*     R7,                                                          0837 03291000
*     R8) UNRSTD;                                                  0837 03292000
*   IF R15^=ZERO                    /* WAS GETMAIN SUCCESSFUL?       */ 03293000
*     THEN                                                         0838 03294000
         SLR   @14,@14                                             0838 03295000
         CR    R15,@14                                             0838 03296000
         BE    @RF00838                                            0838 03297000
*     DO;                           /* NO                            */ 03298000
*       BUFFER=ZERO;                /* CLEAR THE BUFFER POINTER      */ 03299000
         ST    @14,BUFFER                                          0840 03300000
*       RFY                                                        0841 03301000
*         R14 RSTD;                                                0841 03302000
*       R14=RETADDR2;               /* GET RETURN ADDRESS            */ 03303000
         L     R14,RETADDR2                                        0842 03304000
*       RETURN CODE(STORAGE);       /* RETURN INDICATING WE COULD    */ 03305000
         LA    @15,28                                              0843 03306000
@EL00007 DS    0H                                                  0843 03307000
@EF00007 DS    0H                                                  0843 03308000
@ER00007 BR    @14                                                 0843 03309000
*       RFY                                                        0844 03310000
*        (R14,                                                     0844 03311000
*         R15) UNRSTD;              /* NOT OBTAIN STORAGE            */ 03312000
*     END;                                                         0845 03313000
*   EPABASP=BUFFER;                 /* RECORD PTR TO I/O BUFFER      */ 03314000
@RF00838 L     @12,BUFFER                                          0846 03315000
         L     @11,EPAPTR                                          0846 03316000
         ST    @12,EPABASP(,@11)                                   0846 03317000
         EJECT                                                          03318000
*                                                                  0847 03319000
*/********************************************************************/ 03320000
*/*  BUILD A VSAM REQUEST PARAMETER LIST                             */ 03321000
*/********************************************************************/ 03322000
*                                                                  0847 03323000
*   RFY                                                            0847 03324000
*    (R0,                                                          0847 03325000
*     R1,                                                          0847 03326000
*     R4,                                                          0847 03327000
*     R7,                                                          0847 03328000
*     R11,                                                         0847 03329000
*     R12) RSTD;                                                   0847 03330000
*   R0=ADDR(WKAVKEY);               /* GET ADDRESS OF VSAM KEY       */ 03331000
         LA    R0,WKAVKEY                                          0848 03332000
*   R4=BUFFER;                      /* GET PTR TO I/O BUFFER         */ 03333000
         L     @08,BUFFER                                          0849 03334000
         LR    R4,@08                                              0849 03335000
*   R7=ASMSTGXA;                    /* GET PTR TO STGINDEX ACB       */ 03336000
         L     @08,ASMVTWPT                                        0850 03337000
         L     R7,ASMSTGXA(,@08)                                   0850 03338000
*   R11=LENGTH(IFGRPL);             /* SET LENGTH OF AN RPL          */ 03339000
         LA    R11,76                                              0851 03340000
*   R12=RPLPTR;                     /* GET PTR TO RPL BUILD AREA     */ 03341000
         L     R12,RPLPTR                                          0852 03342000
*   GENERATE REFS(R0,R1,R4,R7,R11,R12);                            0853 03343000
         GENCB BLK=RPL,AM=VSAM,ACB=(R7),ARG=(R0),COPIES=1,AREALEN=2048,*03344000
               LENGTH=(R11),AREA=(R4),OPTCD=(KEY,DIR,SYN,KEQ,FKS,MVE,  *03345000
               NUP),RECLEN=2041,WAREA=(R12),MF=(G,BLDGENCB)             03346000
*   RFY                                                            0854 03347000
*    (R0,                                                          0854 03348000
*     R1,                                                          0854 03349000
*     R4,                                                          0854 03350000
*     R7,                                                          0854 03351000
*     R11,                                                         0854 03352000
*     R12) UNRSTD;                                                 0854 03353000
*   RFY                                                            0855 03354000
*     R15 RSTD;                                                    0855 03355000
*   IF R15^=ZERO                    /* GENCB SUCCESSFUL?             */ 03356000
*     THEN                                                         0856 03357000
         LTR   R15,R15                                             0856 03358000
         BZ    @RF00856                                            0856 03359000
*     DO;                           /* NO                            */ 03360000
*       RFY                                                        0858 03361000
*         R14 RSTD;                                                0858 03362000
*       R14=RETADDR2;               /* GET RETURN ADDRESS            */ 03363000
         L     R14,RETADDR2                                        0859 03364000
*       RETURN CODE(TWENTY);        /* RETURN INDICATING VSAM        */ 03365000
         LA    @15,20                                              0860 03366000
         BR    @14                                                 0860 03367000
*       RFY                                                        0861 03368000
*        (R14,                                                     0861 03369000
*         R15) UNRSTD;              /* ERROR                         */ 03370000
*     END;                                                         0862 03371000
*   EPARPLB=ON;                     /* SET RPL BUILT FLAG            */ 03372000
@RF00856 L     @12,EPAPTR                                          0863 03373000
         OI    EPARPLB(@12),B'00000001'                            0863 03374000
*   RFY                                                            0864 03375000
*     R1 RSTD;                                                     0864 03376000
*   R1=ASPCTPTR;                    /* GET PTR TO ASPCT BASE         */ 03377000
         L     R1,ASPCTPTR                                         0865 03378000
*   GOTO AROUND;                    /* BRANCH AROUND EXTENSION     0866 03379000
*                                      PROCESSING ENTRY POINT        */ 03380000
         B     AROUND                                              0866 03381000
*PUTONEA:                                                          0867 03382000
*   ENTRY;                                                         0867 03383000
PUTONEA  DS    0H                                                  0868 03384000
*   RFY                                                            0868 03385000
*     R14 RSTD;                                                    0868 03386000
*   RETADDR2=R14;                   /* SAVE THE RETURN ADDRESS       */ 03387000
         ST    R14,RETADDR2                                        0869 03388000
*   RETCODE1=ZERO;                  /* INIT INTERNAL RETURN CODE     */ 03389000
         SLR   @15,@15                                             0870 03390000
         ST    @15,RETCODE1                                        0870 03391000
*AROUND:                                                           0871 03392000
*   ;                                                              0871 03393000
AROUND   DS    0H                                                  0872 03394000
*   RFY                                                            0872 03395000
*    (R0,                                                          0872 03396000
*     R1,                                                          0872 03397000
*     R14,                                                         0872 03398000
*     R15) RSTD;                    /* COPY THE ASPCT BASE OR        */ 03399000
*   R0=BUFFER;                      /* EXTENSION TO THE I/O BUFFER   */ 03400000
         L     R0,BUFFER                                           0873 03401000
*   R14=R1;                                                        0874 03402000
         LR    R14,R1                                              0874 03403000
*   R1=LENGTH(ASPCT);                                              0875 03404000
         LA    R1,1088                                             0875 03405000
*   R15=R1;                                                        0876 03406000
         LR    R15,R1                                              0876 03407000
*   MVCL(R0,R14);                                                  0877 03408000
         MVCL  R0,R14                                              0877 03409000
*   RFY                                                            0878 03410000
*    (R0,                                                          0878 03411000
*     R1,                                                          0878 03412000
*     R14,                                                         0878 03413000
*     R15) UNRSTD;                                                 0878 03414000
*   RETRY=ZERO;                     /* INIT LOOP CONTROLLER          */ 03415000
         SLR   RETRY,RETRY                                         0879 03416000
*   DO WHILE RETRY<MAXIMUM;                                        0880 03417000
         B     @DE00880                                            0880 03418000
@DL00880 DS    0H                                                  0881 03419000
*     RFY                                                          0881 03420000
*       R1 RSTD;                                                   0881 03421000
*     R1=RPLPTR;                    /* OBTAIN RPL ADDR               */ 03422000
         L     R1,RPLPTR                                           0882 03423000
*     GEN(PUT RPL=(1));             /* WRITE THE BUFFER OUT TO     0883 03424000
*                                      SYS1.STGINDEX                 */ 03425000
         PUT RPL=(1)                                                    03426000
*     RFY                                                          0884 03427000
*       R1 UNRSTD;                                                 0884 03428000
*     RFY                                                          0885 03429000
*       R15 RSTD;                                                  0885 03430000
*     IF R15^=ZERO                  /* WAS WRITE SUCCESSFUL?         */ 03431000
*       THEN                        /* NO                            */ 03432000
         LTR   R15,R15                                             0886 03433000
         BZ    @RF00886                                            0886 03434000
*       IF R15=PHYSICAL             /* WAS IT A PHYSICAL ERROR       */ 03435000
*         THEN                                                     0887 03436000
         C     R15,@CF00093                                        0887 03437000
         BNE   @RF00887                                            0887 03438000
*         DO;                       /* YES                           */ 03439000
*           RETRY=MAXIMUM;          /* FORCE LOOP EXIT               */ 03440000
         LA    RETRY,5                                             0889 03441000
*           RETCODE1=TWENTY;        /* SET RETURN CODE FOR I/O       */ 03442000
         MVC   RETCODE1(4),@CF00120                                0890 03443000
*           RFY                                                    0891 03444000
*             R15 UNRSTD;           /* ERROR                         */ 03445000
*         END;                                                     0892 03446000
*       ELSE                                                       0893 03447000
*         DO;                       /* NO, IT WAS A LOGICAL ERROR    */ 03448000
         B     @RC00887                                            0893 03449000
@RF00887 DS    0H                                                  0894 03450000
*           RFY                                                    0894 03451000
*            (R0,                                                  0894 03452000
*             R1,                                                  0894 03453000
*             R7) RSTD;                                            0894 03454000
*           FBCODE=ZERO;            /* ZERO FEEDBACK CODE AREA       */ 03455000
         SLR   @12,@12                                             0895 03456000
         ST    @12,FBCODE                                          0895 03457000
*           R0=RPLPTR;              /* GET ADDRESS OF RPL            */ 03458000
         L     R0,RPLPTR                                           0896 03459000
*           R7=ADDR(FBCODE);        /* GET ADDR OF RETURN AREA       */ 03460000
         LA    R7,FBCODE                                           0897 03461000
*           GENERATE SETS(FBCODE);                                 0898 03462000
               SHOWCB RPL=(R0),AREA=(R7),LENGTH=4,FIELDS=(FDBK),       *03463000
               MF=(G,BSHOWCB)                                           03464000
*           RFY                                                    0899 03465000
*            (R0,                                                  0899 03466000
*             R1,                                                  0899 03467000
*             R7) UNRSTD;                                          0899 03468000
*           IF FBCODE=FULL          /* STGINDEX FULL?                */ 03469000
*             THEN                                                 0900 03470000
         CLC   FBCODE(4),@CF00122                                  0900 03471000
         BNE   @RF00900                                            0900 03472000
*             DO;                   /* YES                           */ 03473000
*               RETRY=MAXIMUM;      /* FORCE LOOP EXIT               */ 03474000
         LA    RETRY,5                                             0902 03475000
*               RETCODE1=NOROOM;    /* SET RETURN CODE FOR STGINDEX     03476000
*                                      FULL                          */ 03477000
         MVC   RETCODE1(4),@CF00141                                0903 03478000
*             END;                                                 0904 03479000
*           ELSE                    /* NO, WASN'T THERE ENOUGH     0905 03480000
*                                      STORAGE AVAILABLE OR WERE THE    03481000
*                                      MAXIMUM NUMBER OF REQUESTS  0905 03482000
*                                      GOING ALREADY?                */ 03483000
*             IF FBCODE=SPACE|FBCODE=TOOMANY THEN                  0905 03484000
         B     @RC00900                                            0905 03485000
@RF00900 L     @12,FBCODE                                          0905 03486000
         C     @12,@CF00137                                        0905 03487000
         BE    @RT00905                                            0905 03488000
         C     @12,@CF00139                                        0905 03489000
         BNE   @RF00905                                            0905 03490000
@RT00905 DS    0H                                                  0906 03491000
*               DO;                 /* YES, RETRY                    */ 03492000
*                 RETRY=RETRY+ONE;                                 0907 03493000
         AL    RETRY,@CF00098                                      0907 03494000
*                 RETCODE1=TWENTY;                                 0908 03495000
         MVC   RETCODE1(4),@CF00120                                0908 03496000
*               END;                                               0909 03497000
*             ELSE                                                 0910 03498000
*               DO;                 /* NO, EXIT                      */ 03499000
         B     @RC00905                                            0910 03500000
@RF00905 DS    0H                                                  0911 03501000
*                 RETRY=MAXIMUM;    /* FORCE LOOP EXIT               */ 03502000
         LA    RETRY,5                                             0911 03503000
*                 RETCODE1=TWENTY;  /* SET RETURN CODE FOR I/O ERROR */ 03504000
         MVC   RETCODE1(4),@CF00120                                0912 03505000
*               END;                                               0913 03506000
*         END;                                                     0914 03507000
*     ELSE                                                         0915 03508000
*       DO;                         /* NO, SUCCESSFUL WRITE          */ 03509000
         B     @RC00886                                            0915 03510000
@RF00886 DS    0H                                                  0916 03511000
*         RETRY=MAXIMUM;            /* FORCE LOOP EXIT               */ 03512000
         LA    RETRY,5                                             0916 03513000
*         RETCODE1=ZERO;            /* SET ZERO RETURN CODE          */ 03514000
         SLR   @12,@12                                             0917 03515000
         ST    @12,RETCODE1                                        0917 03516000
*       END;                                                       0918 03517000
*   END;                                                           0919 03518000
@RC00886 DS    0H                                                  0919 03519000
@DE00880 C     RETRY,@CF00131                                      0919 03520000
         BL    @DL00880                                            0919 03521000
*   RFY                                                            0920 03522000
*    (R14,                                                         0920 03523000
*     R15) RSTD;                                                   0920 03524000
*   R14=RETADDR2;                   /* GET THE RETURN ADDRESS        */ 03525000
         L     R14,RETADDR2                                        0921 03526000
*   R15=RETCODE1;                   /* LOAD THE RETURN CODE          */ 03527000
         L     R15,RETCODE1                                        0922 03528000
*   RFY                                                            0923 03529000
*    (R14,                                                         0923 03530000
*     R15) UNRSTD;                                                 0923 03531000
*   END PUTONE;                                                    0924 03532000
         B     @EL00007                                            0924 03533000
         EJECT                                                          03534000
*                                                                  0925 03535000
*/*  MACCOMP Y-4SC1CW/PZD81                                          */ 03536000
*/*  MACSTAT Y-475082/415304                                         */ 03537000
*/********************************************************************/ 03538000
*/*                                                                  */ 03539000
*/*  NAME:  ILRAFS00                                                 */ 03540000
*/*                                                                  */ 03541000
*/*  STATUS:  OS/VS2 RELEASE 4.1, LEVEL 0                            */ 03542000
*/*                                                                  */ 03543000
*/*  ENTRY POINT:  ILRAFS00                                          */ 03544000
*/*                                                                  */ 03545000
*/*  FUNCTION:  THIS SUBROUTINE FREES AN ASPCT.                      */ 03546000
*/*                                                                  */ 03547000
*/*  INPUT:  ADDRESS OF ASPCT IN REGISTER 1.                         */ 03548000
*/*          LENGTH OF ASPCT IN REGISTER 0.                          */ 03549000
*/*                                                                  */ 03550000
*/*  PROCESS:  TWO LOOPS, ONE TO FREE ASST EXTENSIONS AND ONE TO     */ 03551000
*/*            FREE LPME EXTENSIONS, ARE EXECUTED.  EACH USES THE    */ 03552000
*/*            SUBROUTINE AFSFREE TO INVOKE FREEMAIN.  A FINAL CALL  */ 03553000
*/*            TO AFSFREE FREES THE BASE ASPCT EXTN.                 */ 03554000
*/*                                                                  */ 03555000
*/*  OUTPUT:  RETURN CODE IN REGISTER 15.                            */ 03556000
*/*             00 = NORMAL RETURN                                   */ 03557000
*/*             44 = FREEMAIN FAILURE                                */ 03558000
*/*                                                                  */ 03559000
*/*  EXIT-NORMAL:  RETURN TO CALLER WITH RETURN CODE (SEE OUTPUT)    */ 03560000
*/*                                                                  */ 03561000
*/*  EXIT-ERROR:  NONE                                               */ 03562000
*/*                                                                  */ 03563000
*/*  EXTERNAL REFERENCES:  FREEMAIN                                  */ 03564000
*/*                                                                  */ 03565000
*/*  REGISTERS CLOBBERED:  0 AND 1, 14 AND 15                        */ 03566000
*/*                                                                  */ 03567000
*/*  MAPPING MACROS USED:  ILRASPCT                                  */ 03568000
*/*                                                                  */ 03569000
*/*  NOTES:  DUE TO PLS OPTIMIZATION, RESTRICT ALL NECESSARY         */ 03570000
*/*          REGISTERS AROUND THIS ROUTINE.                          */ 03571000
*/*          INVOKING ROUTINE MUST HOLD THE LOCAL LOCK, OR HAVE      */ 03572000
*/*          SPECIFIED %AFSSVC=YES.                                  */ 03573000
*/*          ALL LABELS AND DATA AREAS CREATED BY THIS ROUTINE BEGIN */ 03574000
*/*          WITH THE THREE CHARACTERS 'AFS'.  THE CALLING MODULE    */ 03575000
*/*          MUST INCLUDE SUFFICIENT WORKSPACE FOR THIS ROUTINE'S    */ 03576000
*/*          DATA AREAS.  THIS AMOUNT IS COMPILER DEPENDENT WITH A   */ 03577000
*/*          MAXIMUM REQUIREMENT OF 46 BYTES.  THIS ROUTINE ALSO     */ 03578000
*/*          REQUIRES THAT THE CALLING MODULE DECLARES REGISTERS     */ 03579000
*/*          R0-R15.  THE MAPPING MACRO LISTED ABOVE MUST BE         */ 03580000
*/*          INCLUDED.  THE BASE POINTER FOR THE ASPCT IS NOT        */ 03581000
*/*          REQUIRED BY THIS SUBROUTINE.                            */ 03582000
*/*                                                                  */ 03583000
*/*  METHOD OF ACCESS:                                               */ 03584000
*/*          %AFSSVC='YES' IF THE INVOKING ROUTINE MUST USE AN SVC   */ 03585000
*/*          %AFSSVC='NO' IF BRANCH ENTRY REQUIRED                   */ 03586000
*/*          %INCLUDE SYSLIB(ILRAFS00)                               */ 03587000
*/********************************************************************/ 03588000
*/*ILRAFS00: CHART (AREF)                                            */ 03589000
*/*HEADER                                                          0925 03590000
*/*            ILRAFS00 - FREE ASPCT STORAGE                         */ 03591000
*/*ILRAFS00: E ENTRY                                                 */ 03592000
*/*         P  SAVE THE RETURN ADDRESS                               */ 03593000
*/*         P  SAVE PTR TO ASPCT BASE                                */ 03594000
*/*         P  SAVE THE LENGTH OF ASPCT                              */ 03595000
*/*         D  (YES,,NO,%AFS01A) SPECIFIED LENGTH THAT OF ASPCT?     */ 03596000
*/*         P  (,%AFS01B) SET SUBPOOL ID TO 255                      */ 03597000
*/*%AFS01A: P  SET SUBPOOL ID TO 230                                 */ 03598000
*/*%AFS01B: D  (YES,,NO,%AFS06) ARE THERE ANY EXTENSIONS?            */ 03599000
*/*         P  INITIALIZE BASE ARRAY SUBSCRIPT TO ONE                */ 03600000
*/*         P  INITIALIZE ASST EXT ARRAY SUBSCRIPT TO TWO            */ 03601000
*/*%AFS01:  P  GET PTR TO ASST EXTENSION                             */ 03602000
*/*%AFS02:  P  GET PTR TO LPME EXTENSION                             */ 03603000
*/*%AFS02A: S  AFSFREE: FREE AN LPME EXTENSION                       */ 03604000
*/*         D  (YES,%AFS03,NO,) RETURN CODE ZERO?                    */ 03605000
*/*         P  INCREMENT THE ASST EXT ARRAY SUBSCRIPT                */ 03606000
*/*         D  (YES,%AFS04,NO,) REACHED END OF ASST EXT ARRAY?       */ 03607000
*/*         D  (YES,,NO,%AFS04) ANYMORE LPME EXTENSIONS?             */ 03608000
*/*         P  SET PTR TO LPME EXTENSION                             */ 03609000
*/*         D  (YES,%AFS02A,NO,%AFS04) IS THIS AN LPME EXTENSION?    */ 03610000
*/*%AFS03:  P  INCREMENT THE ASST EXT ARRAY SUBSCRIPT                */ 03611000
*/*         D  (YES,%AFS04,NO,) REACHED END OF ASST EXT ARRAY?       */ 03612000
*/*         D  (YES,%AFS02,NO,) ANYMORE LPME EXTENSIONS?             */ 03613000
*/*%AFS04:  P  SET WORK PTR TO ASST EXT                              */ 03614000
*/*         S  AFSFREE: FREE AN ASST EXTENSION                       */ 03615000
*/*         D  (YES,%AFS05,NO,) RETURN CODE ZERO?                    */ 03616000
*/*         P  INCREMENT THE BASE ARRAY SUBSCRIPT                    */ 03617000
*/*         D  (YES,%AFS06,NO,) REACHED END OF BASE ARRAY?           */ 03618000
*/*         D  (YES,,NO,%AFS06) ANYMORE ASST EXTENSIONS?             */ 03619000
*/*         P  GET PTR TO ASST EXTENSION                             */ 03620000
*/*         D  (YES,,NO,%AFS06) IS THIS AN ASST EXTENSION            */ 03621000
*/*         P  (,%AFS02) RESET ASST EXT ARRAY SUBSCRIPT TO ONE       */ 03622000
*/*%AFS05:  P  INCREMENT THE BASE ARRAY SUBSCRIPT                    */ 03623000
*/*         D  (YES,%AFS06,NO,) REACHED END OF BASE ARRAY            */ 03624000
*/*         D  (YES,,NO,%AFS06) ANYMORE ASST EXTENSIONS?             */ 03625000
*/*         P  (,%AFS01) RESET ASST EXT ARRAY SUBSCRIPT TO ONE       */ 03626000
*/*%AFS06:  P  SET THE WORK PTR TO ASPCT BASE                        */ 03627000
*/*         S  AFSFREE: FREE THE ASPCT BASE                          */ 03628000
*/*         R  RETURN TO CALLER                                      */ 03629000
*                                                                  0925 03630000
         EJECT                                                          03631000
*ILRAFS00:                                                         0925 03632000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0925 03633000
*                                                                  0925 03634000
ILRAFS00 DS    0H                                                  0926 03635000
*/*A-000000-999999                                           @Z40WPWH*/ 03636000
*                                                                  0926 03637000
*   DECLARE                                                        0926 03638000
*     AFSASPCT PTR(31),             /* PTR TO ASPCT BASE             */ 03639000
*     AFSEXPTR PTR(31),             /* PTR TO ASPCT EXTENSIONS       */ 03640000
*     AFSLNGTH FIXED(31),           /* FREEMAIN LENGTH               */ 03641000
*     AFSWORK PTR(31),              /* FREEMAIN ADDRESS              */ 03642000
*     AFSRET1 FIXED(31),            /* INTERNAL RETURN CODE          */ 03643000
*     AFSRET2 FIXED(31),            /* INTERNAL RETURN CODE          */ 03644000
*     AFSA FIXED(31),               /* ASST EXT ARRAY SUBSCRIPT      */ 03645000
*     AFSSPID FIXED(31),            /* SUBPOOL ID FOR FREEMAIN       */ 03646000
*     AFSB FIXED(15),               /* BASE ARRAY SUBSCRIPT          */ 03647000
*     AFSZERO FIXED(31) CONSTANT(0),                               0926 03648000
*     AFSSP230 FIXED(31) CONSTANT(230),                            0926 03649000
*     AFSSP255 FIXED(31) CONSTANT(255),                            0926 03650000
*     AFS257 FIXED(31) CONSTANT(257),                              0926 03651000
*     AFSONE FIXED(15) CONSTANT(1),                                0926 03652000
*     AFS44 FIXED(31) CONSTANT(44),                                0926 03653000
*     AFSTWO FIXED(15) CONSTANT(2),                                0926 03654000
*     AFSFIVE FIXED(15) CONSTANT(5),                               0926 03655000
*     AFSREG3 FIXED(31),            /* REGISTER 3 SAVEAREA           */ 03656000
*     AFSREG4 FIXED(31),            /* REGISTER 4 SAVEAREA           */ 03657000
*     AFSREG7 FIXED(31);            /* REGISTER 7 SAVEAREA           */ 03658000
*   RFY                                                            0927 03659000
*    (R0,                                                          0927 03660000
*     R1,                                                          0927 03661000
*     R3,                                                          0927 03662000
*     R4,                                                          0927 03663000
*     R7,                                                          0927 03664000
*     R14) RSTD;                                                   0927 03665000
*   AFSRET1=R14;                    /* SAVE THE RETURN ADDRESS       */ 03666000
         ST    R14,AFSRET1                                         0928 03667000
*   AFSASPCT=R1;                    /* SAVE PTR TO ASPCT BASE        */ 03668000
         ST    R1,AFSASPCT                                         0929 03669000
*   AFSLNGTH=R0;                    /* SAVE INPUT LENGTH             */ 03670000
         ST    R0,AFSLNGTH                                         0930 03671000
*   AFSREG3=R3;                     /* SAVE CALLER'S REG 3           */ 03672000
         ST    R3,AFSREG3                                          0931 03673000
*   AFSREG4=R4;                     /* SAVE CALLER'S REG 4           */ 03674000
         ST    R4,AFSREG4                                          0932 03675000
*   AFSREG7=R7;                     /* SAVE CALLER'S REG 7           */ 03676000
         ST    R7,AFSREG7                                          0933 03677000
*   RFY                                                            0934 03678000
*    (R0,                                                          0934 03679000
*     R1,                                                          0934 03680000
*     R3,                                                          0934 03681000
*     R4,                                                          0934 03682000
*     R7,                                                          0934 03683000
*     R14) UNRSTD;                                                 0934 03684000
*   IF AFSLNGTH=LENGTH(ASPCT)       /* CHECK WHICH SUBPOOL TO USE    */ 03685000
*     THEN                          /* ACTIVE ASPCT                  */ 03686000
         L     @12,AFSLNGTH                                        0935 03687000
         C     @12,@CF01555                                        0935 03688000
         BNE   @RF00935                                            0935 03689000
*     AFSSPID=AFSSP255;             /* SET SUBPOOL FOR LSQA          */ 03690000
         MVC   AFSSPID(4),@CF01539                                 0936 03691000
*   ELSE                            /* I/O BUFFERS                   */ 03692000
*     AFSSPID=AFSSP230;             /* SET SUBPOOL FOR USER KEY      */ 03693000
         B     @RC00935                                            0937 03694000
@RF00935 MVC   AFSSPID(4),@CF01537                                 0937 03695000
         EJECT                                                          03696000
*                                                                  0938 03697000
*/********************************************************************/ 03698000
*/*                                                                  */ 03699000
*/*  A TEST IS NOW MADE FOR EXTENSIONS. IF THERE ARE EXTENSIONS,     */ 03700000
*/*  THEY ARE FREED FIRST. FIRST ALL LPME EXTENSIONS FOR A PARTICULAR*/ 03701000
*/*  ASST EXTENSION ARE FREED, THEN THAT ASST EXTENSION IS FREED.    */ 03702000
*/*  THIS PROCESS IS REPEATED UNTIL ALL EXTENSIONS ARE FREED.        */ 03703000
*/*                                                                  */ 03704000
*/********************************************************************/ 03705000
*                                                                  0938 03706000
*   IF AFSASPCT->ASPAEXCT^=AFSZERO  /* ARE THERE ANY EXTENSIONS?     */ 03707000
*     THEN                                                         0938 03708000
@RC00935 L     @12,AFSASPCT                                        0938 03709000
         LH    @11,ASPAEXCT(,@12)                                  0938 03710000
         LTR   @11,@11                                             0938 03711000
         BZ    @RF00938                                            0938 03712000
*     DO;                           /* YES                           */ 03713000
*       AFSB=AFSONE;                /* SET BASE SUBSCRIPT FOR FIRST     03714000
*                                      ASST EXTENSION                */ 03715000
         LA    @07,1                                               0940 03716000
         STH   @07,AFSB                                            0940 03717000
*       AFSA=AFSTWO;                /* SET ASST SUBSCRIPT FOR FIRST     03718000
*                                      LPME EXTENSION OFF FIRST ASST    03719000
*                                      EXTENSION. GET PTR TO FIRST 0941 03720000
*                                      ASST EXT                      */ 03721000
         LA    AFSA,2                                              0941 03722000
*       AFSEXPTR=AFSASPCT->ASPASSTP(AFSB);                         0942 03723000
         SLA   @07,2                                               0942 03724000
         L     AFSEXPTR,ASPASSTP-4(@07,@12)                        0942 03725000
*       DO WHILE AFSEXPTR^=AFSZERO; /* LOOP UNTIL WE HAVE PROCESSED     03726000
*                                      ALL ASST EXTENSIONS GET PTR TO   03727000
*                                      LPME EXT                      */ 03728000
         B     @DE00943                                            0943 03729000
@DL00943 DS    0H                                                  0944 03730000
*         AFSWORK=AFSEXPTR->ASPASSTE(AFSA);                        0944 03731000
         LR    @07,AFSA                                            0944 03732000
         SLA   @07,2                                               0944 03733000
         L     AFSWORK,ASPASSTE-4(@07,AFSEXPTR)                    0944 03734000
*         DO WHILE AFSWORK^=AFSZERO;/* LOOP UNTIL WE HAVE PROCESSED     03735000
*                                      ALL LPME EXTENSIONS FOR A   0945 03736000
*                                      PARTICULAR ASST EXTENSION     */ 03737000
         B     @DE00945                                            0945 03738000
@DL00945 DS    0H                                                  0946 03739000
*           CALL AFSFREE;           /* FREE AN LPME EXTENSION        */ 03740000
         BAL   @14,AFSFREE                                         0946 03741000
*           RFY                                                    0947 03742000
*             R15 RSTD;                                            0947 03743000
*           IF R15=AFSZERO          /* SUCCESSFUL FREEMAIN?          */ 03744000
*             THEN                                                 0948 03745000
         LTR   R15,R15                                             0948 03746000
         BNZ   @RF00948                                            0948 03747000
*             DO;                   /* YES                           */ 03748000
*               RFY                                                0950 03749000
*                 R15 UNRSTD;                                      0950 03750000
*               AFSA=AFSA+AFSONE;   /* INCREMENT ASST SUBSCRIPT      */ 03751000
         AL    AFSA,@CF00098                                       0951 03752000
*               IF AFSA<AFS257      /* REACHED END OF ARRAY          */ 03753000
*                 THEN              /* NO, GET PTR TO NEXT LPME EX   */ 03754000
         C     AFSA,@CF01541                                       0952 03755000
         BNL   @RF00952                                            0952 03756000
*                 AFSWORK=AFSEXPTR->ASPASSTE(AFSA);                0953 03757000
         LR    @07,AFSA                                            0953 03758000
         SLA   @07,2                                               0953 03759000
         L     AFSWORK,ASPASSTE-4(@07,AFSEXPTR)                    0953 03760000
*               ELSE                /* YES, FORCE EXIT FROM LOOP     */ 03761000
*                 AFSWORK=AFSZERO;                                 0954 03762000
         B     @RC00952                                            0954 03763000
@RF00952 SLR   AFSWORK,AFSWORK                                     0954 03764000
*             END;                  /* THIS IS THE LOGICAL END OF THE   03765000
*                                      DO WHILE LOOP FOR LPME      0955 03766000
*                                      EXTENSIONS. PHYSICAL END IS 0955 03767000
*                                      AFTER THE ERROR CODE PROCESS     03768000
*                                      ING FOR A NON-ZERO RETURN FROM   03769000
*                                      AFSFREE.                      */ 03770000
         EJECT                                                          03771000
*                                                                  0956 03772000
*/********************************************************************/ 03773000
*/* THIS SECTION WILL PROCESS A NON-ZERO RETURN CODE FROM AFSFREE    */ 03774000
*/* FOR LPME EXTENSIONS. PROCESSING CONSISTS OF GETTING THE POINTER  */ 03775000
*/* TO THE NEXT LPME EXTENSION, AND VERIFYING THAT IT IS AN LPME     */ 03776000
*/* EXTENSION. IF IT IS WE WILL CONTINUE FREEING LPME EXTENSIONS,    */ 03777000
*/* IF NOT, WE WILL FORCE AN EXIT FROM THE LOOP.                     */ 03778000
*/********************************************************************/ 03779000
*                                                                  0956 03780000
*           ELSE                                                   0956 03781000
*             DO;                   /* NON-ZERO RETURN FROM AFSFREE  */ 03782000
         B     @RC00948                                            0956 03783000
@RF00948 DS    0H                                                  0957 03784000
*               AFSA=AFSA+AFSONE;   /* INCREMENT ASST SUBSCRIPT      */ 03785000
         AL    AFSA,@CF00098                                       0957 03786000
*               IF AFSA<AFS257      /* REACHED END OF ASST ARRAY?    */ 03787000
*                 THEN                                             0958 03788000
         C     AFSA,@CF01541                                       0958 03789000
         BNL   @RF00958                                            0958 03790000
*                 DO;               /* NO GET PTR TO NEXT LPME EXT   */ 03791000
*                   AFSWORK=AFSEXPTR->ASPASSTE(AFSA);/* IS THIS A  0960 03792000
*                                      VALID LPME EXT?               */ 03793000
         LR    @07,AFSA                                            0960 03794000
         SLA   @07,2                                               0960 03795000
         L     AFSWORK,ASPASSTE-4(@07,AFSEXPTR)                    0960 03796000
*                   IF AFSWORK->ASPEIDNT^='LPME' THEN/* NO           */ 03797000
         CLC   ASPEIDNT(4,AFSWORK),@CC01550                        0961 03798000
         BE    @RF00961                                            0961 03799000
*                     AFSWORK=AFSZERO;/* FORCE LOOP EXIT             */ 03800000
         SLR   AFSWORK,AFSWORK                                     0962 03801000
*                 END;                                             0963 03802000
*               ELSE                /* YES, REACHED END OF ARRAY     */ 03803000
*                 AFSWORK=AFSZERO;  /* FORCE LOOP EXIT               */ 03804000
         B     @RC00958                                            0964 03805000
@RF00958 SLR   AFSWORK,AFSWORK                                     0964 03806000
*             END;                                                 0965 03807000
@RC00958 DS    0H                                                  0966 03808000
*         END;                      /* THIS IS THE PHYSICAL END OF 0966 03809000
*                                      THE DO WHILE LOOP FOR LPME  0966 03810000
*                                      EXTENSIONS.                   */ 03811000
@RC00948 DS    0H                                                  0966 03812000
@DE00945 LTR   AFSWORK,AFSWORK                                     0966 03813000
         BNZ   @DL00945                                            0966 03814000
         EJECT                                                          03815000
*                                                                  0967 03816000
*/********************************************************************/ 03817000
*/* THIS SECTION PROCESSES THE ASST EXTENSIONS                       */ 03818000
*/********************************************************************/ 03819000
*                                                                  0967 03820000
*         AFSWORK=AFSEXPTR;         /* SET FREEMAIN POINTER TO AN  0967 03821000
*                                      ASST EXTENSION                */ 03822000
         LR    AFSWORK,AFSEXPTR                                    0967 03823000
*         CALL AFSFREE;             /* FREE THE ASST EXTENSION       */ 03824000
         BAL   @14,AFSFREE                                         0968 03825000
*         RFY                                                      0969 03826000
*           R15 RSTD;                                              0969 03827000
*         IF R15=AFSZERO            /* FREEMAIN SUCCESSFUL?          */ 03828000
*           THEN                                                   0970 03829000
         LTR   R15,R15                                             0970 03830000
         BNZ   @RF00970                                            0970 03831000
*           DO;                     /* YES                           */ 03832000
*             RFY                                                  0972 03833000
*               R15 UNRSTD;                                        0972 03834000
*             AFSB=AFSB+AFSONE;     /* INCREMENT BASE SUBSCRIPT      */ 03835000
         LA    @12,1                                               0973 03836000
         LH    @08,AFSB                                            0973 03837000
         ALR   @08,@12                                             0973 03838000
         STH   @08,AFSB                                            0973 03839000
*             IF AFSB<AFSFIVE       /* REACHED END OF ARRAY?         */ 03840000
*               THEN                                               0974 03841000
         C     @08,@CF00131                                        0974 03842000
         BNL   @RF00974                                            0974 03843000
*               DO;                 /* NO GET PTR TO NEXT ASST EXT   */ 03844000
*                 AFSEXPTR=AFSASPCT->ASPASSTP(AFSB);               0976 03845000
         LH    @07,AFSB                                            0976 03846000
         SLA   @07,2                                               0976 03847000
         L     @01,AFSASPCT                                        0976 03848000
         L     AFSEXPTR,ASPASSTP-4(@07,@01)                        0976 03849000
*                 AFSA=AFSONE;      /* RESET ASST SUBSCRIPT          */ 03850000
         LR    AFSA,@12                                            0977 03851000
*               END;                                               0978 03852000
*             ELSE                  /* YES, REACHED END OF ARRAY     */ 03853000
*               AFSEXPTR=AFSZERO;   /* FORCE LOOP EXIT               */ 03854000
         B     @RC00974                                            0979 03855000
@RF00974 SLR   AFSEXPTR,AFSEXPTR                                   0979 03856000
*           END;                    /* THIS THE LOGICAL END OF THE DO   03857000
*                                      WHILE LOOP FOR ASST         0980 03858000
*                                      EXTENSIONS. PHYSICAL END IS 0980 03859000
*                                      AFTER THE ERROR CODE PROCESS     03860000
*                                      ING FOR A NON-ZERO RETURN FROM   03861000
*                                      AFSFREE                       */ 03862000
         EJECT                                                          03863000
*                                                                  0981 03864000
*/********************************************************************/ 03865000
*/* THIS SECTION WILL PROCESS A NON-ZERO RETURN CODE FROM AFSFREE    */ 03866000
*/* FOR ASST EXTENSIONS. PROCESSING CONSISTS OF GETTING THE POINTER  */ 03867000
*/* TO THE NEXT ASST EXTENSION, AND VERIFYING THAT IT IS AN ASST     */ 03868000
*/* EXTENSION. IF IT IS WE WILL CONTINUE FREEING ASST EXTENSIONS,    */ 03869000
*/* IF NOT, WE WILL FORCE AN EXIT FROM THE LOOP.                     */ 03870000
*/********************************************************************/ 03871000
*                                                                  0981 03872000
*         ELSE                                                     0981 03873000
*           DO;                     /* NON-ZERO RETURN CODE FROM   0981 03874000
*                                      AFSFREE                       */ 03875000
         B     @RC00970                                            0981 03876000
@RF00970 DS    0H                                                  0982 03877000
*             AFSB=AFSB+AFSONE;     /* INCREMENT BASE SUBSCRIPT      */ 03878000
         LA    @12,1                                               0982 03879000
         LH    @08,AFSB                                            0982 03880000
         ALR   @08,@12                                             0982 03881000
         STH   @08,AFSB                                            0982 03882000
*             IF AFSB<AFSFIVE       /* REACHED END OF ARRAY          */ 03883000
*               THEN                                               0983 03884000
         C     @08,@CF00131                                        0983 03885000
         BNL   @RF00983                                            0983 03886000
*               DO;                 /* GET PTR TO NEXT ASST          */ 03887000
*                 AFSEXPTR=AFSASPCT->ASPASSTP(AFSB);/* VALID ASST  0985 03888000
*                                      EXTENSION?                    */ 03889000
         LH    @07,AFSB                                            0985 03890000
         SLA   @07,2                                               0985 03891000
         L     @01,AFSASPCT                                        0985 03892000
         L     AFSEXPTR,ASPASSTP-4(@07,@01)                        0985 03893000
*                 IF AFSEXPTR->ASPEIDNT='ASST' THEN/* YES            */ 03894000
         CLC   ASPEIDNT(4,AFSEXPTR),@CC01507                       0986 03895000
         BNE   @RF00986                                            0986 03896000
*                   AFSA=AFSONE;    /* RESET ASST SUBSCRIPT          */ 03897000
         LR    AFSA,@12                                            0987 03898000
*                 ELSE              /* NO                            */ 03899000
*                   AFSEXPTR=AFSZERO;/* FORCE LOOP EXIT              */ 03900000
         B     @RC00986                                            0988 03901000
@RF00986 SLR   AFSEXPTR,AFSEXPTR                                   0988 03902000
*               END;                                               0989 03903000
*             ELSE                  /* YES, REACHED END OF ARRAY     */ 03904000
*               AFSEXPTR=AFSZERO;   /* FORCE LOOP EXIT               */ 03905000
         B     @RC00983                                            0990 03906000
@RF00983 SLR   AFSEXPTR,AFSEXPTR                                   0990 03907000
*           END;                                                   0991 03908000
@RC00983 DS    0H                                                  0992 03909000
*       END;                        /* PHYSICAL END OF DO WHILE LOOP    03910000
*                                      FOR ASST EXTENSIONS           */ 03911000
@RC00970 DS    0H                                                  0992 03912000
@DE00943 LTR   AFSEXPTR,AFSEXPTR                                   0992 03913000
         BNZ   @DL00943                                            0992 03914000
*     END;                                                         0993 03915000
         EJECT                                                          03916000
*                                                                  0994 03917000
*/********************************************************************/ 03918000
*/* THIS SECTION FREES THE ASPCT BASE                                */ 03919000
*/********************************************************************/ 03920000
*                                                                  0994 03921000
*   AFSWORK=AFSASPCT;               /* GET PTR TO THE ASPCT BASE     */ 03922000
@RF00938 L     AFSWORK,AFSASPCT                                    0994 03923000
*   CALL AFSFREE;                   /* FREE THE BASE                 */ 03924000
         BAL   @14,AFSFREE                                         0995 03925000
         EJECT                                                          03926000
*   RFY                                                            0996 03927000
*    (R3,                                                          0996 03928000
*     R4,                                                          0996 03929000
*     R7,                                                          0996 03930000
*     R14) RSTD;                                                   0996 03931000
*   R3=AFSREG3;                     /* RESTORE CALLER'S REG 3        */ 03932000
         L     R3,AFSREG3                                          0997 03933000
*   R4=AFSREG4;                     /* RESTORE CALLER'S REG 4        */ 03934000
         L     R4,AFSREG4                                          0998 03935000
*   R7=AFSREG7;                     /* RESTORE CALLER'S REG 7        */ 03936000
         L     R7,AFSREG7                                          0999 03937000
*   R14=AFSRET1;                    /* GET RETURN ADDRESS            */ 03938000
         L     R14,AFSRET1                                         1000 03939000
*   RETURN;                         /* RETURN TO CALLER              */ 03940000
@EL00008 DS    0H                                                  1001 03941000
@EF00008 DS    0H                                                  1001 03942000
@ER00008 BR    @14                                                 1001 03943000
*   RFY                                                            1002 03944000
*    (R3,                                                          1002 03945000
*     R4,                                                          1002 03946000
*     R7,                                                          1002 03947000
*     R14) UNRSTD;                                                 1002 03948000
         EJECT                                                          03949000
*                                                                  1003 03950000
*/********************************************************************/ 03951000
*/*                                                                  */ 03952000
*/*  AFSFREE:  FREE ASPCT EXTN OF STORAGE                            */ 03953000
*/*                                                                  */ 03954000
*/*  INPUT:  ADDRESS OF EXTN IN REGISTER 1                           */ 03955000
*/*                                                                  */ 03956000
*/*  PROCESS:  SET UP REGS, ISSUE FREEMAIN MACRO TO FREE ASPCT EXTN. */ 03957000
*/*                                                                  */ 03958000
*/*  OUTPUT:  RETURN CODE IN REGISTER 15                             */ 03959000
*/*             00 - NORMAL RETURN                                   */ 03960000
*/*             44 - FREEMAIN RETURNED ERROR CODE                    */ 03961000
*/*                                                                  */ 03962000
*/********************************************************************/ 03963000
*/*AFSFREE: CHART (AREF)                                             */ 03964000
*/*HEADER                                                          1003 03965000
*/*  ILRAFS00                                                      1003 03966000
*/* AFSFREE - FREEMAIN THE ASPCT                                     */ 03967000
*/*AFSFREE: E  ENTRY                                                 */ 03968000
*/*         P  SAVE THE RETURN ADDRESS                               */ 03969000
*/*         N  THIS NEXT TEST AND RESULTING LEGS OF CODE, IS A MACRO */ 03970000
*/*         N  PASS TEST AND EXPANSION.                              */ 03971000
*/*         D  (YES,,NO,%AFS07) SVC OK?                              */ 03972000
*/*         P  LOAD REG 14 WITH SUBPOOL ID                           */ 03973000
*/*         P  LOAD REG 0 WITH LENGTH                                */ 03974000
*/*         P  LOAD REG 1 WITH ADDRESS OF AREA TO BE FREED           */ 03975000
*/*         S  (,%AFS08) FREEMAIN: FREE THE ASPCT                    */ 03976000
*/*%AFS07:  P  LOAD REG 0 WITH LENTH                                 */ 03977000
*/*         P  LOAD REG 1 WITH ADDRESS OF AREA TO BE FREED           */ 03978000
*/*         P  LOAD REG 4 WITH CURRENT TCB ADDRESS                   */ 03979000
*/*         P  LOAD REG 7 WITH CURRENT ASCB ADDRESS                  */ 03980000
*/*         P  LOAD REG 3 WITH SUBPOOL ID                            */ 03981000
*/*         S  IEAVGM00: FREE THE ASPCT                              */ 03982000
*/*%AFS08:  D  (YES,%AFS09,NO,) ZERO RETURN CODE?                    */ 03983000
*/*         P  SAVE FREEMAINS RETURN CODE                            */ 03984000
*/*         P  SET RETURN CODE TO 68                                 */ 03985000
*/*%AFS09:  R  RETURN TO MAINLINE                                    */ 03986000
*                                                                  1003 03987000
         EJECT                                                          03988000
*AFSFREE:                           /* FREEMAIN AN EXTN OF ASPCT     */ 03989000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          1003 03990000
AFSFREE  DS    0H                                                  1004 03991000
*   RFY                                                            1004 03992000
*     R14 RSTD;                                                    1004 03993000
*   AFSRET2=R14;                    /* SAVE THE RETURN ADDRESS       */ 03994000
         ST    R14,AFSRET2                                         1005 03995000
*   RFY                                                            1006 03996000
*    (R0,                                                          1006 03997000
*     R1,                                                          1006 03998000
*     R3,                                                          1006 03999000
*     R4,                                                          1006 04000000
*     R7) RSTD;                                                    1006 04001000
*   R0=AFSLNGTH;                    /* GET THE LENGTH OF AREA TO BE     04002000
*                                      FREED                         */ 04003000
         L     R0,AFSLNGTH                                         1007 04004000
*   R1=AFSWORK;                     /* GET ADDRESS OF AREA TO FREE   */ 04005000
         LR    R1,AFSWORK                                          1008 04006000
*   R4=PSATOLD;                     /* GET CURRENT TCB ADDRESS       */ 04007000
         L     R4,PSATOLD                                          1009 04008000
*   R7=PSAAOLD;                     /* GET CURRENT ASCB ADDRESS      */ 04009000
         L     R7,PSAAOLD                                          1010 04010000
*   R3=AFSSPID;                     /* GET SUBPOOL ID                */ 04011000
         L     R3,AFSSPID                                          1011 04012000
*   GENERATE REFS(R0,R1,R3,R4,R7,CVTCRMN,CVTMAP);                  1012 04013000
         FREEMAIN RC,A=(1),LV=(0),SP=(3),BRANCH=YES                     04014000
*   RFY                                                            1013 04015000
*    (R0,                                                          1013 04016000
*     R1,                                                          1013 04017000
*     R3,                                                          1013 04018000
*     R4,                                                          1013 04019000
*     R7,                                                          1013 04020000
*     R14) UNRSTD;                                                 1013 04021000
*   RFY                                                            1014 04022000
*    (R14,                                                         1014 04023000
*     R15) RSTD;                                                   1014 04024000
*   IF R15^=AFSZERO                 /* FREEMAIN SUCCESSFUL?          */ 04025000
*     THEN                          /* NO                            */ 04026000
         LTR   R15,R15                                             1015 04027000
         BZ    @RF01015                                            1015 04028000
*     R15=AFS44;                    /* SET RETURN CODE TO 44         */ 04029000
         LA    R15,44                                              1016 04030000
*   R14=AFSRET2;                    /* GET RETURN ADDRESS            */ 04031000
@RF01015 L     R14,AFSRET2                                         1017 04032000
*   RFY                                                            1018 04033000
*    (R14,                                                         1018 04034000
*     R15) UNRSTD;                                                 1018 04035000
*   END AFSFREE;                                                   1019 04036000
@EL00009 DS    0H                                                  1019 04037000
@EF00009 DS    0H                                                  1019 04038000
@ER00009 BR    @14                                                 1019 04039000
*   END ILRAFS00;                                                  1020 04040000
*   END ILRVSAMI                                                   1021 04041000
*                                                                  1021 04042000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04043000
*/*%INCLUDE SYSLIB  (ILRASPCT)                                       */ 04044000
*/*%INCLUDE SYSLIB  (ILRASMVT)                                       */ 04045000
*/*%INCLUDE SYSLIB  (ILREPATH)                                       */ 04046000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 04047000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 04048000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 04049000
*/*%INCLUDE SYSLIB  (ILRAFS00)                                       */ 04050000
*                                                                  1021 04051000
*       ;                                                          1021 04052000
@DATA    DS    0H                                                       04053000
@DATD    DSECT                                                          04054000
         DS    0F                                                       04055000
ILRVSAMI CSECT                                                          04056000
         DS    0F                                                       04057000
@CF00098 DC    F'1'                                                     04058000
@CF00114 DC    F'2'                                                     04059000
@CF00063 DC    F'4'                                                     04060000
@CF00131 DC    F'5'                                                     04061000
@CF00093 DC    F'12'                                                    04062000
@CF00143 DC    F'16'                                                    04063000
@CF00120 DC    F'20'                                                    04064000
@CF00141 DC    F'24'                                                    04065000
@CF00122 DC    F'28'                                                    04066000
@CF00137 DC    F'40'                                                    04067000
@CF00139 DC    F'64'                                                    04068000
@CF01537 DC    F'230'                                                   04069000
@CF01539 DC    F'255'                                                   04070000
@CF00150 DC    F'256'                                                   04071000
@CF01541 DC    F'257'                                                   04072000
@CF01555 DC    F'1088'                                                  04073000
@DATD    DSECT                                                          04074000
         DS    0D                                                       04075000
ASPCTPTR DS    A                                                        04076000
ASPEXPTR DS    A                                                        04077000
LPMEPTR  DS    A                                                        04078000
ASMVTWPT DS    A                                                        04079000
EPAPTR   DS    A                                                        04080000
PARMPTR  DS    A                                                        04081000
RETCODE  DS    F                                                        04082000
RETCODE1 DS    F                                                        04083000
RETADDR1 DS    F                                                        04084000
RETADDR2 DS    F                                                        04085000
LPMEXT   DS    F                                                        04086000
LPMECNTL DS    F                                                        04087000
ASSTEXT  DS    F                                                        04088000
ASSTCNTL DS    F                                                        04089000
BASE     DS    F                                                        04090000
ASST     DS    F                                                        04091000
MAXEXTN  DS    F                                                        04092000
RETASPCT DS    A                                                        04093000
BUFFER   DS    A                                                        04094000
RPLPTR   DS    A                                                        04095000
FBCODE   DS    F                                                        04096000
AFSASPCT DS    A                                                        04097000
AFSLNGTH DS    F                                                        04098000
AFSRET1  DS    F                                                        04099000
AFSRET2  DS    F                                                        04100000
AFSSPID  DS    F                                                        04101000
AFSREG3  DS    F                                                        04102000
AFSREG4  DS    F                                                        04103000
AFSREG7  DS    F                                                        04104000
AFSB     DS    H                                                        04105000
         DS    CL2                                                      04106000
WKAVKEY  DS    CL12                                                     04107000
         ORG   WKAVKEY                                                  04108000
WKAKEY   DS    CL8                                                      04109000
EXTNUMB  DS    FL4                                                      04110000
         ORG   WKAVKEY+12                                               04111000
FLAGS    DS    BL1                                                      04112000
         ORG   FLAGS                                                    04113000
BACKOUT  DS    BL1                                                      04114000
PARTIALF EQU   FLAGS+0                                                  04115000
@NM00003 EQU   FLAGS+0                                                  04116000
         ORG   FLAGS+1                                                  04117000
         DS    CL3                                                      04118000
SAVEREGA DS    CL72                                                     04119000
         ORG   SAVEREGA                                                 04120000
@NM00004 DS    CL12                                                     04121000
SAVREGSA DS    CL60                                                     04122000
         ORG   SAVEREGA+72                                              04123000
ILRVSAMI CSECT                                                          04124000
         NOPR  ((@ENDDATD-@DATD)/513*16)                                04125000
         DS    0F                                                       04126000
@SIZDATD DC    AL1(0)                                                   04127000
         DC    AL3(@ENDDATD-@DATD)                                      04128000
         DS    0D                                                       04129000
@CC01507 DC    C'ASST'                                                  04130000
@CC01550 DC    C'LPME'                                                  04131000
VSMPATCH DS    CL160                                                    04132000
PTRS     DC    AL4(GETASPCT)                                            04133000
         DC    AL4(PUTASPCT)                                            04134000
         DC    AL4(RETERASE)                                            04135000
         DC    AL4(RETERASE)                                            04136000
@DATD    DSECT                                                          04137000
         DS    0F                                                       04138000
BLDGENCB DS    CL(GENBSIZE)               PARM LIST FOR GENCB OF RPL    04139000
         DS    0F                                                       04140000
BSHOWCB  DS    CL(SHOWSIZE)               PARM LIST FOR SHOWCB OF RPL   04141000
@DATD    DSECT                                                          04142000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04143000
@ENDDATD EQU   *                                                        04144000
ILRVSAMI CSECT                                                          04145000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04146000
@01      EQU   01                                                       04147000
@02      EQU   02                                                       04148000
@03      EQU   03                                                       04149000
@04      EQU   04                                                       04150000
@05      EQU   05                                                       04151000
@06      EQU   06                                                       04152000
@07      EQU   07                                                       04153000
@08      EQU   08                                                       04154000
@09      EQU   09                                                       04155000
@10      EQU   10                                                       04156000
@11      EQU   11                                                       04157000
@12      EQU   12                                                       04158000
@13      EQU   13                                                       04159000
@14      EQU   14                                                       04160000
@15      EQU   15                                                       04161000
AFSA     EQU   @11                                                      04162000
AFSWORK  EQU   @12                                                      04163000
AFSEXPTR EQU   @08                                                      04164000
I        EQU   @02                                                      04165000
RETRY    EQU   @03                                                      04166000
OPCPTR   EQU   @02                                                      04167000
R0       EQU   @00                                                      04168000
R1       EQU   @01                                                      04169000
R3       EQU   @03                                                      04170000
R4       EQU   @04                                                      04171000
R5       EQU   @05                                                      04172000
R6       EQU   @06                                                      04173000
R7       EQU   @07                                                      04174000
R8       EQU   @08                                                      04175000
R9       EQU   @09                                                      04176000
R10      EQU   @10                                                      04177000
R11      EQU   @11                                                      04178000
R12      EQU   @12                                                      04179000
R13      EQU   @13                                                      04180000
R14      EQU   @14                                                      04181000
R15      EQU   @15                                                      04182000
ASMVTPTR EQU   @03                                                      04183000
R2       EQU   @02                                                      04184000
PSA      EQU   0                                                        04185000
FLCRNPSW EQU   PSA                                                      04186000
FLCROPSW EQU   PSA+8                                                    04187000
FLCICCW2 EQU   PSA+16                                                   04188000
FLCCVT   EQU   FLCICCW2                                                 04189000
PSAEEPSW EQU   PSA+132                                                  04190000
PSAESPSW EQU   PSA+136                                                  04191000
FLCSVILC EQU   PSAESPSW+1                                               04192000
PSAEPPSW EQU   PSA+140                                                  04193000
FLCPIILC EQU   PSAEPPSW+1                                               04194000
FLCPICOD EQU   PSAEPPSW+2                                               04195000
PSAPICOD EQU   FLCPICOD+1                                               04196000
FLCTEA   EQU   PSAEPPSW+4                                               04197000
FLCPER   EQU   PSA+152                                                  04198000
FLCMCLA  EQU   PSA+168                                                  04199000
FLCIOEL  EQU   FLCMCLA+4                                                04200000
FLCIOA   EQU   FLCMCLA+16                                               04201000
FLCFSA   EQU   FLCMCLA+80                                               04202000
PSATOLD  EQU   PSA+540                                                  04203000
PSAAOLD  EQU   PSA+548                                                  04204000
PSASUPER EQU   PSA+552                                                  04205000
PSASUP1  EQU   PSASUPER                                                 04206000
PSASUP2  EQU   PSASUPER+1                                               04207000
PSASUP3  EQU   PSASUPER+2                                               04208000
PSASUP4  EQU   PSASUPER+3                                               04209000
PSACLHT  EQU   PSA+640                                                  04210000
PSALKSA  EQU   PSA+696                                                  04211000
PSAHLHI  EQU   PSA+760                                                  04212000
PSADSSFL EQU   PSA+836                                                  04213000
PSADSSF1 EQU   PSADSSFL                                                 04214000
PSADSSF3 EQU   PSADSSFL+2                                               04215000
PSADSSF4 EQU   PSADSSFL+3                                               04216000
PSARSVT  EQU   PSA+896                                                  04217000
ROUTINE  EQU   0                                                        04218000
PARMLIST EQU   0                                                        04219000
@NM00001 EQU   PARMLIST                                                 04220000
OPCODE   EQU   @NM00001                                                 04221000
BASEPTR  EQU   PARMLIST+4                                               04222000
SSYMPTR  EQU   BASEPTR                                                  04223000
EPATHPTR EQU   PARMLIST+8                                               04224000
SSYM     EQU   0                                                        04225000
IFGRPL   EQU   0                                                        04226000
RPLCOMN  EQU   IFGRPL                                                   04227000
RPLIDWD  EQU   RPLCOMN                                                  04228000
RPLLEN   EQU   RPLIDWD+3                                                04229000
RPLECB   EQU   RPLCOMN+8                                                04230000
RPLFDBWD EQU   RPLCOMN+12                                               04231000
RPLFDBK  EQU   RPLFDBWD+1                                               04232000
RPLRTNCD EQU   RPLFDBK                                                  04233000
RPLCNDCD EQU   RPLFDBK+1                                                04234000
RPLCMPON EQU   RPLCNDCD                                                 04235000
RPLFDB2  EQU   RPLCMPON                                                 04236000
RPLERRCD EQU   RPLCNDCD+1                                               04237000
RPLFDB3  EQU   RPLERRCD                                                 04238000
RPLKEYLE EQU   RPLCOMN+16                                               04239000
RPLAREA  EQU   RPLCOMN+32                                               04240000
RPLARG   EQU   RPLCOMN+36                                               04241000
RPLOPTCD EQU   RPLCOMN+40                                               04242000
RPLOPT1  EQU   RPLOPTCD                                                 04243000
RPLECBSW EQU   RPLOPT1                                                  04244000
RPLOPT2  EQU   RPLOPTCD+1                                               04245000
RPLADR   EQU   RPLOPT2                                                  04246000
RPLOPT3  EQU   RPLOPTCD+2                                               04247000
RPLNXTRP EQU   RPLCOMN+44                                               04248000
RPLOPTC2 EQU   RPLCOMN+56                                               04249000
RPLOPT5  EQU   RPLOPTC2                                                 04250000
RPLWRTYP EQU   RPLOPT5                                                  04251000
RPLOPT6  EQU   RPLOPTC2+1                                               04252000
RPLUNTYP EQU   RPLOPT6                                                  04253000
RPLOPT7  EQU   RPLOPTC2+2                                               04254000
RPLCNOPT EQU   RPLOPT7                                                  04255000
RPLOPT8  EQU   RPLOPTC2+3                                               04256000
RPLRBAR  EQU   RPLCOMN+60                                               04257000
RPLAIXID EQU   RPLRBAR+2                                                04258000
RPLEXTDS EQU   RPLCOMN+68                                               04259000
RPLEXTD1 EQU   RPLEXTDS                                                 04260000
ASPCT    EQU   0                                                        04261000
ASPHDR   EQU   ASPCT                                                    04262000
ASPBKEY  EQU   ASPHDR+8                                                 04263000
ASPSSYM  EQU   ASPBKEY                                                  04264000
ASPFLAG  EQU   ASPHDR+28                                                04265000
ASPLEXCT EQU   ASPHDR+44                                                04266000
ASPAEXCT EQU   ASPHDR+46                                                04267000
ASPASSTP EQU   ASPCT+48                                                 04268000
ASPEXTSN EQU   0                                                        04269000
ASPEHDR  EQU   ASPEXTSN                                                 04270000
ASPEIDNT EQU   ASPEHDR                                                  04271000
ASPEXKEY EQU   ASPEHDR+8                                                04272000
ASPESSYM EQU   ASPEXKEY                                                 04273000
ASPEXTNM EQU   ASPEXKEY+8                                               04274000
ASPASSTN EQU   ASPEHDR+20                                               04275000
ASPSECTA EQU   ASPEXTSN+64                                              04276000
ASPLPME  EQU   0                                                        04277000
ASPLPFLG EQU   ASPLPME                                                  04278000
ASPVLSID EQU   ASPLPME+1                                                04279000
ASMVT    EQU   0                                                        04280000
ASMFLAG1 EQU   ASMVT                                                    04281000
ASMFLAG2 EQU   ASMVT+1                                                  04282000
ASMNOSAV EQU   ASMFLAG2                                                 04283000
ASMSTAGQ EQU   ASMVT+32                                                 04284000
ASMPCCWQ EQU   ASMVT+64                                                 04285000
ASMSTGXA EQU   ASMVT+136                                                04286000
ASMLSAI  EQU   ASMVT+144                                                04287000
ASMGOSQS EQU   ASMVT+152                                                04288000
ASMPEX   EQU   ASMVT+224                                                04289000
ASMSWKPC EQU   ASMVT+328                                                04290000
ASMWKSA1 EQU   ASMVT+368                                                04291000
ASMWKSA2 EQU   ASMVT+448                                                04292000
ASMWKSA3 EQU   ASMVT+528                                                04293000
ASMWKSA4 EQU   ASMVT+608                                                04294000
ASMWKSA5 EQU   ASMVT+688                                                04295000
ASMPOOLS EQU   0                                                        04296000
ASMCPAVQ EQU   ASMPOOLS+8                                               04297000
ASMCPAVL EQU   ASMCPAVQ                                                 04298000
ASMCPRSQ EQU   ASMPOOLS+16                                              04299000
EPATH    EQU   0                                                        04300000
EPAVSAM  EQU   EPATH                                                    04301000
EPAVWKA  EQU   EPAVSAM+4                                                04302000
EPATMWKA EQU   EPAVWKA                                                  04303000
EPAAASP  EQU   EPAVSAM+8                                                04304000
EPABASP  EQU   EPAVSAM+12                                               04305000
EPARASP  EQU   EPAVSAM+16                                               04306000
EPARTYRG EQU   EPAVSAM+20                                               04307000
EPABKSLT EQU   EPARTYRG                                                 04308000
EPAFLAG1 EQU   EPAVSAM+24                                               04309000
EPAVSAMI EQU   EPAFLAG1                                                 04310000
EPAGRPOP EQU   EPAFLAG1                                                 04311000
EPARPLB  EQU   EPAFLAG1                                                 04312000
EPAFLAG2 EQU   EPAVSAM+25                                               04313000
CVTMAP   EQU   0                                                        04314000
CVTDAR   EQU   CVTMAP+72                                                04315000
CVTFLGS1 EQU   CVTDAR                                                   04316000
CVTDCB   EQU   CVTMAP+116                                               04317000
CVTIERLC EQU   CVTMAP+144                                               04318000
CVTOPTA  EQU   CVTMAP+182                                               04319000
CVTOPTB  EQU   CVTMAP+183                                               04320000
CVTGTF   EQU   CVTMAP+236                                               04321000
CVTGTFST EQU   CVTGTF                                                   04322000
CVTGTFS  EQU   CVTGTFST                                                 04323000
CVTSTATE EQU   CVTGTFST                                                 04324000
CVTTMODE EQU   CVTGTFST                                                 04325000
CVTFORM  EQU   CVTGTFST                                                 04326000
CVTAQAVT EQU   CVTMAP+240                                               04327000
CVTTCMFG EQU   CVTAQAVT                                                 04328000
CVTVOLM2 EQU   CVTMAP+244                                               04329000
CVTTATA  EQU   CVTVOLM2                                                 04330000
CVTTSKS  EQU   CVTTATA                                                  04331000
CVTVOLF2 EQU   CVTTSKS                                                  04332000
CVTTAT   EQU   CVTTATA+1                                                04333000
CVTATER  EQU   CVTMAP+248                                               04334000
CVTEXT1  EQU   CVTMAP+252                                               04335000
CVTPURG  EQU   CVTMAP+260                                               04336000
CVTQMSG  EQU   CVTMAP+268                                               04337000
CVTDMSR  EQU   CVTMAP+272                                               04338000
CVTRSV37 EQU   CVTDMSR                                                  04339000
CVTDMSRF EQU   CVTRSV37                                                 04340000
CVTERPV  EQU   CVTMAP+316                                               04341000
CVTINTLA EQU   CVTMAP+320                                               04342000
CVTAPF   EQU   CVTMAP+324                                               04343000
CVTEXT2  EQU   CVTMAP+328                                               04344000
CVTHJES  EQU   CVTMAP+332                                               04345000
CVTPGSIA EQU   CVTMAP+348                                               04346000
CVTA1F1  EQU   CVTMAP+356                                               04347000
CVTSYSK  EQU   CVTMAP+357                                               04348000
CVTVOLM1 EQU   CVTMAP+380                                               04349000
CVTVOLF1 EQU   CVTVOLM1                                                 04350000
CVTATMCT EQU   CVTMAP+388                                               04351000
CVTXTNT1 EQU   0                                                        04352000
CVTXTNT2 EQU   0                                                        04353000
CVTDSSV  EQU   CVTXTNT2                                                 04354000
CVTFLGBT EQU   CVTXTNT2+5                                               04355000
CVTQID   EQU   CVTXTNT2+24                                              04356000
CVTRV400 EQU   CVTXTNT2+52                                              04357000
CVTRV409 EQU   CVTXTNT2+53                                              04358000
CVTATCVT EQU   CVTXTNT2+64                                              04359000
CVTRV429 EQU   CVTXTNT2+84                                              04360000
CVTRV438 EQU   CVTXTNT2+85                                              04361000
CVTRV457 EQU   CVTXTNT2+112                                             04362000
CVTRV466 EQU   CVTXTNT2+113                                             04363000
CVTFIX   EQU   0                                                        04364000
CVTRELNO EQU   CVTFIX+252                                               04365000
ILRPEX   EQU   0                                                        04366000
GMACELL  EQU   0                                                        04367000
GMANEXT  EQU   GMACELL                                                  04368000
CVTPTR   EQU   FLCCVT                                                   04369000
RECADDR  EQU   FBCODE                                                   04370000
RPL      EQU   IFGRPL                                                   04371000
ASPASST  EQU   ASPSECTA                                                 04372000
ASPASSTE EQU   ASPASST                                                  04373000
ASM1WKSV EQU   ASMWKSA1                                                 04374000
ASM1RGSV EQU   ASM1WKSV                                                 04375000
ASM1WRKA EQU   ASM1WKSV+60                                              04376000
ASM2WKSV EQU   ASMWKSA2                                                 04377000
ASM2WRKA EQU   ASM2WKSV+52                                              04378000
ASM2FLGS EQU   ASM2WRKA+12                                              04379000
ASM3WKSV EQU   ASMWKSA3                                                 04380000
ASM4WKSV EQU   ASMWKSA4                                                 04381000
ASM4RGSV EQU   ASM4WKSV                                                 04382000
ASM5WKSV EQU   ASMWKSA5                                                 04383000
ASM5RGSV EQU   ASM5WKSV                                                 04384000
CVTS01   EQU   CVTPGSIA                                                 04385000
CVTLPDIA EQU   CVTS01+12                                                04386000
CVTDIRST EQU   CVTLPDIA                                                 04387000
CVTSLIDA EQU   CVTS01+24                                                04388000
CVTCTLFG EQU   CVTS01+50                                                04389000
CVTCRMN  EQU   CVTS01+156                                               04390000
CVTRV210 EQU   CVTS01+424                                               04391000
CVTRV219 EQU   CVTS01+425                                               04392000
CVTRV228 EQU   CVTS01+426                                               04393000
CVTRV237 EQU   CVTS01+427                                               04394000
CVTMFRTR EQU   CVTS01+452                                               04395000
CVTRV262 EQU   CVTS01+468                                               04396000
CVTRV271 EQU   CVTS01+469                                               04397000
CVTRV280 EQU   CVTS01+470                                               04398000
CVTRV289 EQU   CVTS01+471                                               04399000
CVTGSDA  EQU   CVTS01+600                                               04400000
PSARSVTE EQU   PSARSVT                                                  04401000
ASPLPMEE EQU   ASPSECTA                                                 04402000
FLC      EQU   PSA                                                      04403000
*                                      START UNREFERENCED COMPONENTS    04404000
PSARSAV  EQU   PSARSVTE+60                                              04405000
PSARSTK  EQU   PSARSVTE+56                                              04406000
PSAESAV3 EQU   PSARSVTE+52                                              04407000
PSAESTK3 EQU   PSARSVTE+48                                              04408000
PSAESAV2 EQU   PSARSVTE+44                                              04409000
PSAESTK2 EQU   PSARSVTE+40                                              04410000
PSAESAV1 EQU   PSARSVTE+36                                              04411000
PSAESTK1 EQU   PSARSVTE+32                                              04412000
PSAPSAV  EQU   PSARSVTE+28                                              04413000
PSAPSTK  EQU   PSARSVTE+24                                              04414000
PSAMSAV  EQU   PSARSVTE+20                                              04415000
PSAMSTK  EQU   PSARSVTE+16                                              04416000
PSASSAV  EQU   PSARSVTE+12                                              04417000
PSASSTK  EQU   PSARSVTE+8                                               04418000
PSANSTK  EQU   PSARSVTE+4                                               04419000
PSACSTK  EQU   PSARSVTE                                                 04420000
CVTRV628 EQU   CVTS01+728                                               04421000
CVTRV627 EQU   CVTS01+724                                               04422000
CVTRV626 EQU   CVTS01+720                                               04423000
CVTRV625 EQU   CVTS01+716                                               04424000
CVTRV624 EQU   CVTS01+712                                               04425000
CVTRV623 EQU   CVTS01+708                                               04426000
CVTRV622 EQU   CVTS01+704                                               04427000
CVTRV621 EQU   CVTS01+700                                               04428000
CVTIHASU EQU   CVTS01+696                                               04429000
CVTSUSP  EQU   CVTS01+692                                               04430000
CVTT6SVC EQU   CVTS01+688                                               04431000
CVTCDAL  EQU   CVTS01+684                                               04432000
CVTTCTL  EQU   CVTS01+680                                               04433000
CVTRSUME EQU   CVTS01+676                                               04434000
CVTJTERM EQU   CVTS01+672                                               04435000
CVTASMRM EQU   CVTS01+668                                               04436000
CVTTCASP EQU   CVTS01+664                                               04437000
CVT0PT03 EQU   CVTS01+660                                               04438000
CVT0PT0E EQU   CVTS01+656                                               04439000
CVTRV609 EQU   CVTS01+652                                               04440000
CVTCGK   EQU   CVTS01+648                                               04441000
CVTRAC   EQU   CVTS01+644                                               04442000
CVTRV606 EQU   CVTS01+640                                               04443000
CVTRV605 EQU   CVTS01+636                                               04444000
CVTRV604 EQU   CVTS01+632                                               04445000
CVTEFF02 EQU   CVTS01+628                                               04446000
CVTCBBR  EQU   CVTS01+624                                               04447000
CVTSSCR  EQU   CVTS01+620                                               04448000
CVTEVENT EQU   CVTS01+616                                               04449000
CVTCRCA  EQU   CVTS01+612                                               04450000
CVTTPIO  EQU   CVTS01+608                                               04451000
CVTADV   EQU   CVTS01+604                                               04452000
CVTGSDAB EQU   CVTGSDA                                                  04453000
CVTQV3   EQU   CVTS01+596                                               04454000
CVTQV2   EQU   CVTS01+592                                               04455000
CVTQV1   EQU   CVTS01+588                                               04456000
CVTRPT   EQU   CVTS01+584                                               04457000
CVTSSRB  EQU   CVTS01+580                                               04458000
CVTCSDRL EQU   CVTS01+576                                               04459000
CVTEXP1  EQU   CVTS01+572                                               04460000
CVTRMPMT EQU   CVTS01+568                                               04461000
CVTRMPTT EQU   CVTS01+564                                               04462000
CVTVPSA  EQU   CVTS01+560                                               04463000
CVTVSTOP EQU   CVTS01+556                                               04464000
CVTGTFR8 EQU   CVTS01+552                                               04465000
CVTQUIT  EQU   CVTS01+548                                               04466000
CVTVACR  EQU   CVTS01+544                                               04467000
CVTWTCB  EQU   CVTS01+540                                               04468000
CVTSTPRS EQU   CVTS01+536                                               04469000
CVT0PT02 EQU   CVTS01+532                                               04470000
CVTDARCM EQU   CVTS01+528                                               04471000
CVTIRECM EQU   CVTS01+524                                               04472000
CVTJRECM EQU   CVTS01+520                                               04473000
CVTVEMS0 EQU   CVTS01+516                                               04474000
CVTSPFRR EQU   CVTS01+512                                               04475000
CVTRLSTG EQU   CVTS01+508                                               04476000
CVT0TC0A EQU   CVTS01+504                                               04477000
CVTGMBR  EQU   CVTS01+500                                               04478000
CVTLFRM  EQU   CVTS01+496                                               04479000
CVTRMBR  EQU   CVTS01+492                                               04480000
CVTVIOP  EQU   CVTS01+488                                               04481000
CVTRV307 EQU   CVTS01+486                                               04482000
CVTRV306 EQU   CVTS01+484                                               04483000
CVTRV305 EQU   CVTS01+482                                               04484000
CVTRV304 EQU   CVTS01+480                                               04485000
CVTRV303 EQU   CVTS01+478                                               04486000
CVTRV302 EQU   CVTS01+476                                               04487000
CVTTRCA  EQU   CVTS01+472                                               04488000
CVTRV297 EQU   CVTRV289                                                 04489000
CVTRV296 EQU   CVTRV289                                                 04490000
CVTRV295 EQU   CVTRV289                                                 04491000
CVTRV294 EQU   CVTRV289                                                 04492000
CVTRV293 EQU   CVTRV289                                                 04493000
CVTRV292 EQU   CVTRV289                                                 04494000
CVTRV291 EQU   CVTRV289                                                 04495000
CVTRV290 EQU   CVTRV289                                                 04496000
CVTRV288 EQU   CVTRV280                                                 04497000
CVTRV287 EQU   CVTRV280                                                 04498000
CVTRV286 EQU   CVTRV280                                                 04499000
CVTRV285 EQU   CVTRV280                                                 04500000
CVTRV284 EQU   CVTRV280                                                 04501000
CVTRV283 EQU   CVTRV280                                                 04502000
CVTRV282 EQU   CVTRV280                                                 04503000
CVTRV281 EQU   CVTRV280                                                 04504000
CVTRV279 EQU   CVTRV271                                                 04505000
CVTRV278 EQU   CVTRV271                                                 04506000
CVTRV277 EQU   CVTRV271                                                 04507000
CVTRV276 EQU   CVTRV271                                                 04508000
CVTRV275 EQU   CVTRV271                                                 04509000
CVTRV274 EQU   CVTRV271                                                 04510000
CVTRV273 EQU   CVTRV271                                                 04511000
CVTRV272 EQU   CVTRV271                                                 04512000
CVTRV270 EQU   CVTRV262                                                 04513000
CVTRV269 EQU   CVTRV262                                                 04514000
CVTRV268 EQU   CVTRV262                                                 04515000
CVTRV267 EQU   CVTRV262                                                 04516000
CVTRV266 EQU   CVTRV262                                                 04517000
CVTRV265 EQU   CVTRV262                                                 04518000
CVTRV264 EQU   CVTRV262                                                 04519000
CVTRV263 EQU   CVTRV262                                                 04520000
CVTVFP   EQU   CVTS01+464                                               04521000
CVTVSI   EQU   CVTS01+460                                               04522000
CVTVPSIB EQU   CVTS01+456                                               04523000
CVTMFACT EQU   CVTMFRTR                                                 04524000
CVTMFCTL EQU   CVTS01+448                                               04525000
CVTPVBP  EQU   CVTS01+444                                               04526000
CVTPWI   EQU   CVTS01+440                                               04527000
CVTRV254 EQU   CVTS01+438                                               04528000
CVTRV253 EQU   CVTS01+436                                               04529000
CVTRV252 EQU   CVTS01+434                                               04530000
CVTRV251 EQU   CVTS01+433                                               04531000
CVTRV250 EQU   CVTS01+432                                               04532000
CVTRV249 EQU   CVTS01+431                                               04533000
CVTRV248 EQU   CVTS01+430                                               04534000
CVTRV247 EQU   CVTS01+429                                               04535000
CVTRV246 EQU   CVTS01+428                                               04536000
CVTRV245 EQU   CVTRV237                                                 04537000
CVTRV244 EQU   CVTRV237                                                 04538000
CVTRV243 EQU   CVTRV237                                                 04539000
CVTRV242 EQU   CVTRV237                                                 04540000
CVTRV241 EQU   CVTRV237                                                 04541000
CVTRV240 EQU   CVTRV237                                                 04542000
CVTRV239 EQU   CVTRV237                                                 04543000
CVTRV238 EQU   CVTRV237                                                 04544000
CVTRV236 EQU   CVTRV228                                                 04545000
CVTRV235 EQU   CVTRV228                                                 04546000
CVTRV234 EQU   CVTRV228                                                 04547000
CVTRV233 EQU   CVTRV228                                                 04548000
CVTRV232 EQU   CVTRV228                                                 04549000
CVTRV231 EQU   CVTRV228                                                 04550000
CVTRV230 EQU   CVTRV228                                                 04551000
CVTRV229 EQU   CVTRV228                                                 04552000
CVTRV227 EQU   CVTRV219                                                 04553000
CVTRV226 EQU   CVTRV219                                                 04554000
CVTRV225 EQU   CVTRV219                                                 04555000
CVTRV224 EQU   CVTRV219                                                 04556000
CVTRV223 EQU   CVTRV219                                                 04557000
CVTRV222 EQU   CVTRV219                                                 04558000
CVTRV221 EQU   CVTRV219                                                 04559000
CVTRV220 EQU   CVTRV219                                                 04560000
CVTRV218 EQU   CVTRV210                                                 04561000
CVTRV217 EQU   CVTRV210                                                 04562000
CVTRV216 EQU   CVTRV210                                                 04563000
CVTRV215 EQU   CVTRV210                                                 04564000
CVTRV214 EQU   CVTRV210                                                 04565000
CVTRV213 EQU   CVTRV210                                                 04566000
CVTRV212 EQU   CVTRV210                                                 04567000
CVTRV211 EQU   CVTRV210                                                 04568000
CVTLCCAT EQU   CVTS01+420                                               04569000
CVTPCCAT EQU   CVTS01+416                                               04570000
CVTIPCRP EQU   CVTS01+412                                               04571000
CVTIPCRI EQU   CVTS01+408                                               04572000
CVTIPCDS EQU   CVTS01+404                                               04573000
CVTAIDVT EQU   CVTS01+400                                               04574000
CVTSSAP  EQU   CVTS01+396                                               04575000
CVTEHCIR EQU   CVTS01+392                                               04576000
CVTEHDEF EQU   CVTS01+388                                               04577000
CVTDAIR  EQU   CVTS01+384                                               04578000
CVTPERFM EQU   CVTS01+380                                               04579000
CVT044R2 EQU   CVTS01+376                                               04580000
CVTFETCH EQU   CVTS01+372                                               04581000
CVTRSTWD EQU   CVTS01+368                                               04582000
CVTSPOST EQU   CVTS01+364                                               04583000
CVTIOBP  EQU   CVTS01+360                                               04584000
CVTASMVT EQU   CVTS01+356                                               04585000
CVTRECRQ EQU   CVTS01+352                                               04586000
CVTWSAC  EQU   CVTS01+348                                               04587000
CVTRV149 EQU   CVTS01+344                                               04588000
CVTWSAL  EQU   CVTS01+340                                               04589000
CVTSPSA  EQU   CVTS01+336                                               04590000
CVTGLMN  EQU   CVTS01+332                                               04591000
CVTVEAC0 EQU   CVTS01+328                                               04592000
CVT062R1 EQU   CVTS01+324                                               04593000
CVTRPOST EQU   CVTS01+320                                               04594000
CVTDQIQE EQU   CVTS01+316                                               04595000
CVTCSD   EQU   CVTS01+312                                               04596000
CVTLKRMA EQU   CVTS01+308                                               04597000
CVTRSPIE EQU   CVTS01+304                                               04598000
CVTRENQ  EQU   CVTS01+300                                               04599000
CVTLQCB  EQU   CVTS01+296                                               04600000
CVTFQCB  EQU   CVTS01+292                                               04601000
CVTQCS01 EQU   CVTS01+288                                               04602000
CVTAPFT  EQU   CVTS01+284                                               04603000
CVTPARRL EQU   CVTS01+280                                               04604000
CVTVWAIT EQU   CVTS01+276                                               04605000
CVTGSPL  EQU   CVTS01+272                                               04606000
CVTLSMQ  EQU   CVTS01+268                                               04607000
CVTGSMQ  EQU   CVTS01+264                                               04608000
CVTEXPRO EQU   CVTS01+260                                               04609000
CVTOPCTP EQU   CVTS01+256                                               04610000
CVTSIC   EQU   CVTS01+252                                               04611000
CVTTPIOS EQU   CVTS01+248                                               04612000
CVTRTMS  EQU   CVTS01+244                                               04613000
CVTSDBF  EQU   CVTS01+240                                               04614000
CVTSCBP  EQU   CVTS01+236                                               04615000
CVTSDMP  EQU   CVTS01+232                                               04616000
CVTSV60  EQU   CVTS01+228                                               04617000
CVTRTMCT EQU   CVTS01+224                                               04618000
CVTASCBL EQU   CVTS01+220                                               04619000
CVTASCBH EQU   CVTS01+216                                               04620000
CVTGDA   EQU   CVTS01+212                                               04621000
CVTASVT  EQU   CVTS01+208                                               04622000
CVTVVMDI EQU   CVTS01+204                                               04623000
CVTAQTOP EQU   CVTS01+200                                               04624000
CVTIOSCS EQU   CVTS01+196                                               04625000
CVTSDRM  EQU   CVTS01+192                                               04626000
CVTOPTE  EQU   CVTS01+188                                               04627000
CVTSTXU  EQU   CVTS01+184                                               04628000
CVTQUIS  EQU   CVTS01+180                                               04629000
CVTPARS  EQU   CVTS01+176                                               04630000
CVTS1EE  EQU   CVTS01+172                                               04631000
CVTFRAS  EQU   CVTS01+168                                               04632000
CVTQSAS  EQU   CVTS01+164                                               04633000
CVTCRAS  EQU   CVTS01+160                                               04634000
CVTDELCP EQU   CVTS01+152                                               04635000
CVTFRECL EQU   CVTS01+148                                               04636000
CVTGETCL EQU   CVTS01+144                                               04637000
CVTBLDCP EQU   CVTS01+140                                               04638000
CVTAUTHL EQU   CVTS01+136                                               04639000
CVTSCAN  EQU   CVTS01+132                                               04640000
CVTRV144 EQU   CVTS01+130                                               04641000
CVTMAXMP EQU   CVTS01+128                                               04642000
CVTSTCK  EQU   CVTS01+124                                               04643000
CVTRV139 EQU   CVTS01+123                                               04644000
CVTDSSAC EQU   CVTS01+122                                               04645000
CVTRV513 EQU   CVTS01+121                                               04646000
CVTIOSPL EQU   CVTS01+120                                               04647000
CVTPTGT  EQU   CVTS01+116                                               04648000
CVTCSPIE EQU   CVTS01+112                                               04649000
CVTSMFEX EQU   CVTS01+108                                               04650000
CVTOLT0A EQU   CVTS01+104                                               04651000
CVTSRBRT EQU   CVTS01+100                                               04652000
CVTPUTL  EQU   CVTS01+96                                                04653000
CVTASCRL EQU   CVTS01+92                                                04654000
CVTASCRF EQU   CVTS01+88                                                04655000
CVTRV326 EQU   CVTS01+84                                                04656000
CVTRV325 EQU   CVTS01+80                                                04657000
CVTRV324 EQU   CVTS01+76                                                04658000
CVT0VL01 EQU   CVTS01+72                                                04659000
CVTSHRVM EQU   CVTS01+68                                                04660000
CVTRV332 EQU   CVTS01+64                                                04661000
CVTTAS   EQU   CVTS01+60                                                04662000
CVTRSCN  EQU   CVTS01+56                                                04663000
CVTTRAC2 EQU   CVTS01+54                                                04664000
CVTTRACE EQU   CVTS01+52                                                04665000
CVTAPG   EQU   CVTS01+51                                                04666000
CVTSDTRC EQU   CVTCTLFG                                                 04667000
CVTGTRCE EQU   CVTCTLFG                                                 04668000
CVTNOMP  EQU   CVTCTLFG                                                 04669000
CVTRSV79 EQU   CVTCTLFG                                                 04670000
CVTDSTAT EQU   CVTCTLFG                                                 04671000
CVTRSV78 EQU   CVTCTLFG                                                 04672000
CVTRV333 EQU   CVTCTLFG                                                 04673000
CVTRV323 EQU   CVTCTLFG                                                 04674000
CVTSPVLK EQU   CVTS01+49                                                04675000
CVTRSV77 EQU   CVTS01+48                                                04676000
CVTRV331 EQU   CVTS01+44                                                04677000
CVTRV330 EQU   CVTS01+40                                                04678000
CVTRV329 EQU   CVTS01+36                                                04679000
CVTRV328 EQU   CVTS01+32                                                04680000
CVTRV322 EQU   CVTS01+28                                                04681000
CVTSLID  EQU   CVTSLIDA+1                                               04682000
CVTSYLK  EQU   CVTSLIDA                                                 04683000
CVTRV321 EQU   CVTS01+20                                                04684000
CVTRV320 EQU   CVTS01+16                                                04685000
CVTLPDIR EQU   CVTLPDIA+1                                               04686000
CVTRSV69 EQU   CVTDIRST                                                 04687000
CVTRSV68 EQU   CVTDIRST                                                 04688000
CVTRSV67 EQU   CVTDIRST                                                 04689000
CVTRSV66 EQU   CVTDIRST                                                 04690000
CVTRSV65 EQU   CVTDIRST                                                 04691000
CVTRSV64 EQU   CVTDIRST                                                 04692000
CVTRSV63 EQU   CVTDIRST                                                 04693000
CVTDICOM EQU   CVTDIRST                                                 04694000
CVTPVTP  EQU   CVTS01+8                                                 04695000
CVTLPDSR EQU   CVTS01+4                                                 04696000
CVTGETL  EQU   CVTS01                                                   04697000
ASM5FLGS EQU   ASM5WKSV+64                                              04698000
ASM5AIA  EQU   ASM5WKSV+60                                              04699000
ASM5GCTR EQU   ASM5WKSV+56                                              04700000
ASM5SR14 EQU   ASM5WKSV+52                                              04701000
@NM00017 EQU   ASM5RGSV+4                                               04702000
ASM5RG2  EQU   ASM5RGSV                                                 04703000
@NM00016 EQU   ASM4RGSV+4                                               04704000
ASM4RG2  EQU   ASM4RGSV                                                 04705000
ASM3SR13 EQU   ASM3WKSV+28                                              04706000
ASM3R14B EQU   ASM3WKSV+24                                              04707000
ASM3R14A EQU   ASM3WKSV+20                                              04708000
ASM3GRPA EQU   ASM3WKSV+16                                              04709000
ASM3TMPA EQU   ASM3WKSV+12                                              04710000
ASM3PIOP EQU   ASM3WKSV+8                                               04711000
ASM3GENQ EQU   ASM3WKSV+4                                               04712000
ASM3SWPQ EQU   ASM3WKSV                                                 04713000
ASM2SR14 EQU   ASM2WRKA+16                                              04714000
@NM00015 EQU   ASM2WRKA+13                                              04715000
ASM2WFLG EQU   ASM2FLGS                                                 04716000
ASM2RFLG EQU   ASM2FLGS                                                 04717000
ASM2DUPQ EQU   ASM2WRKA+8                                               04718000
ASM2CAQ  EQU   ASM2WRKA+4                                               04719000
ASM2PAQ  EQU   ASM2WRKA                                                 04720000
ASM2RGSV EQU   ASM2WKSV                                                 04721000
ASM1NXTA EQU   ASM1WRKA+4                                               04722000
ASM1ASCB EQU   ASM1WRKA                                                 04723000
ASM1RG15 EQU   ASM1RGSV+56                                              04724000
@NM00014 EQU   ASM1RGSV+4                                               04725000
ASM1RG1  EQU   ASM1RGSV                                                 04726000
CVTLEVL  EQU   CVTRELNO+2                                               04727000
CVTNUMB  EQU   CVTRELNO                                                 04728000
CVTMDL   EQU   CVTFIX+250                                               04729000
@NM00021 EQU   CVTFIX+248                                               04730000
@NM00020 EQU   CVTFIX                                                   04731000
CVTRV482 EQU   CVTXTNT2+128                                             04732000
CVTRV481 EQU   CVTXTNT2+124                                             04733000
CVTRV480 EQU   CVTXTNT2+120                                             04734000
CVTRV479 EQU   CVTXTNT2+118                                             04735000
CVTRV478 EQU   CVTXTNT2+117                                             04736000
CVTRV477 EQU   CVTXTNT2+116                                             04737000
CVTRV476 EQU   CVTXTNT2+115                                             04738000
CVTRV475 EQU   CVTXTNT2+114                                             04739000
CVTRV474 EQU   CVTRV466                                                 04740000
CVTRV473 EQU   CVTRV466                                                 04741000
CVTRV472 EQU   CVTRV466                                                 04742000
CVTRV471 EQU   CVTRV466                                                 04743000
CVTRV470 EQU   CVTRV466                                                 04744000
CVTRV469 EQU   CVTRV466                                                 04745000
CVTRV468 EQU   CVTRV466                                                 04746000
CVTRV467 EQU   CVTRV466                                                 04747000
CVTRV465 EQU   CVTRV457                                                 04748000
CVTRV464 EQU   CVTRV457                                                 04749000
CVTRV463 EQU   CVTRV457                                                 04750000
CVTRV462 EQU   CVTRV457                                                 04751000
CVTRV461 EQU   CVTRV457                                                 04752000
CVTRV460 EQU   CVTRV457                                                 04753000
CVTRV459 EQU   CVTRV457                                                 04754000
CVTRV458 EQU   CVTRV457                                                 04755000
CVTRV456 EQU   CVTXTNT2+108                                             04756000
CVTRV455 EQU   CVTXTNT2+104                                             04757000
CVTRV454 EQU   CVTXTNT2+100                                             04758000
CVTRV453 EQU   CVTXTNT2+96                                              04759000
CVTRV452 EQU   CVTXTNT2+94                                              04760000
CVTRV451 EQU   CVTXTNT2+92                                              04761000
CVTRV450 EQU   CVTXTNT2+90                                              04762000
CVTRV449 EQU   CVTXTNT2+88                                              04763000
CVTRV448 EQU   CVTXTNT2+87                                              04764000
CVTRV447 EQU   CVTXTNT2+86                                              04765000
CVTRV446 EQU   CVTRV438                                                 04766000
CVTRV445 EQU   CVTRV438                                                 04767000
CVTRV444 EQU   CVTRV438                                                 04768000
CVTRV443 EQU   CVTRV438                                                 04769000
CVTRV442 EQU   CVTRV438                                                 04770000
CVTRV441 EQU   CVTRV438                                                 04771000
CVTRV440 EQU   CVTRV438                                                 04772000
CVTRV439 EQU   CVTRV438                                                 04773000
CVTRV437 EQU   CVTRV429                                                 04774000
CVTRV436 EQU   CVTRV429                                                 04775000
CVTRV435 EQU   CVTRV429                                                 04776000
CVTRV434 EQU   CVTRV429                                                 04777000
CVTRV433 EQU   CVTRV429                                                 04778000
CVTRV432 EQU   CVTRV429                                                 04779000
CVTRV431 EQU   CVTRV429                                                 04780000
CVTRV430 EQU   CVTRV429                                                 04781000
CVTRV428 EQU   CVTXTNT2+80                                              04782000
CVTRV427 EQU   CVTXTNT2+76                                              04783000
CVTRV426 EQU   CVTXTNT2+72                                              04784000
CVTRV425 EQU   CVTXTNT2+68                                              04785000
CVTATACT EQU   CVTATCVT                                                 04786000
CVTRV423 EQU   CVTXTNT2+62                                              04787000
CVTRV422 EQU   CVTXTNT2+60                                              04788000
CVTRV421 EQU   CVTXTNT2+58                                              04789000
CVTRV420 EQU   CVTXTNT2+56                                              04790000
CVTRV419 EQU   CVTXTNT2+55                                              04791000
CVTRV418 EQU   CVTXTNT2+54                                              04792000
CVTRV417 EQU   CVTRV409                                                 04793000
CVTRV416 EQU   CVTRV409                                                 04794000
CVTRV415 EQU   CVTRV409                                                 04795000
CVTRV414 EQU   CVTRV409                                                 04796000
CVTRV413 EQU   CVTRV409                                                 04797000
CVTRV412 EQU   CVTRV409                                                 04798000
CVTRV411 EQU   CVTRV409                                                 04799000
CVTRV410 EQU   CVTRV409                                                 04800000
CVTRV408 EQU   CVTRV400                                                 04801000
CVTRV407 EQU   CVTRV400                                                 04802000
CVTRV406 EQU   CVTRV400                                                 04803000
CVTRV405 EQU   CVTRV400                                                 04804000
CVTRV404 EQU   CVTRV400                                                 04805000
CVTRV403 EQU   CVTRV400                                                 04806000
CVTRV402 EQU   CVTRV400                                                 04807000
CVTRV401 EQU   CVTRV400                                                 04808000
CVTICB   EQU   CVTXTNT2+48                                              04809000
CVTSKTA  EQU   CVTXTNT2+44                                              04810000
CVTRSV99 EQU   CVTXTNT2+40                                              04811000
CVTRSV98 EQU   CVTXTNT2+36                                              04812000
CVTRSV97 EQU   CVTXTNT2+34                                              04813000
CVTRSV96 EQU   CVTXTNT2+32                                              04814000
CVTOLTEP EQU   CVTXTNT2+28                                              04815000
CVTQIDA  EQU   CVTQID+1                                                 04816000
CVTRSV95 EQU   CVTQID                                                   04817000
CVTRSV94 EQU   CVTXTNT2+20                                              04818000
CVTRSV93 EQU   CVTXTNT2+16                                              04819000
CVTRSV92 EQU   CVTXTNT2+12                                              04820000
CVTDEBVR EQU   CVTXTNT2+8                                               04821000
CVTRSV91 EQU   CVTXTNT2+6                                               04822000
CVTRSV9H EQU   CVTFLGBT                                                 04823000
CVTRSV9G EQU   CVTFLGBT                                                 04824000
CVTRSV9F EQU   CVTFLGBT                                                 04825000
CVTRSV9E EQU   CVTFLGBT                                                 04826000
CVTRSV9D EQU   CVTFLGBT                                                 04827000
CVTRSV9C EQU   CVTFLGBT                                                 04828000
CVTVME   EQU   CVTFLGBT                                                 04829000
CVTNPE   EQU   CVTFLGBT                                                 04830000
CVTNUCLS EQU   CVTXTNT2+4                                               04831000
CVTDSSVA EQU   CVTDSSV+1                                                04832000
CVTRSV89 EQU   CVTDSSV                                                  04833000
CVTRSV88 EQU   CVTXTNT1+8                                               04834000
CVTRSV87 EQU   CVTXTNT1+4                                               04835000
CVTFACHN EQU   CVTXTNT1                                                 04836000
CVTRV488 EQU   CVTMAP+412                                               04837000
CVTRV487 EQU   CVTMAP+408                                               04838000
CVTRV486 EQU   CVTMAP+404                                               04839000
CVTRV485 EQU   CVTMAP+400                                               04840000
CVTACTAP EQU   CVTMAP+396                                               04841000
CVTAUTH  EQU   CVTMAP+392                                               04842000
CVTATMCA EQU   CVTATMCT+1                                               04843000
CVTATMST EQU   CVTATMCT                                                 04844000
CVTRSV61 EQU   CVTMAP+384                                               04845000
CVTVOLT1 EQU   CVTVOLM1+1                                               04846000
CVTVOLI1 EQU   CVTVOLF1                                                 04847000
CVTSTOA  EQU   CVTMAP+376                                               04848000
CVTRSV58 EQU   CVTMAP+374                                               04849000
CVTRSV57 EQU   CVTMAP+372                                               04850000
CVTDDCE  EQU   CVTMAP+368                                               04851000
CVTPNWFR EQU   CVTMAP+364                                               04852000
CVTSMF   EQU   CVTMAP+360                                               04853000
CVTSULK  EQU   CVTMAP+358                                               04854000
CVTSLKO  EQU   CVTSYSK                                                  04855000
CVTSLKP  EQU   CVTSYSK                                                  04856000
CVTSLKQ  EQU   CVTSYSK                                                  04857000
CVTSLKR  EQU   CVTSYSK                                                  04858000
CVTRSV56 EQU   CVTSYSK                                                  04859000
CVTRSV55 EQU   CVTSYSK                                                  04860000
CVTRSV54 EQU   CVTSYSK                                                  04861000
CVTRSV53 EQU   CVTSYSK                                                  04862000
CVTRSV52 EQU   CVTA1F1                                                  04863000
CVTRSV51 EQU   CVTA1F1                                                  04864000
CVTRSV50 EQU   CVTA1F1                                                  04865000
CVTRSV49 EQU   CVTA1F1                                                  04866000
CVTRSV48 EQU   CVTA1F1                                                  04867000
CVTRSV47 EQU   CVTA1F1                                                  04868000
CVTSRSW  EQU   CVTA1F1                                                  04869000
CVTPFSW  EQU   CVTA1F1                                                  04870000
CVTPCVT  EQU   CVTMAP+352                                               04871000
CVTRSV46 EQU   CVTMAP+344                                               04872000
CVTRSV45 EQU   CVTMAP+340                                               04873000
CVTRSV44 EQU   CVTMAP+338                                               04874000
CVTRSV43 EQU   CVTMAP+336                                               04875000
CVTHJESA EQU   CVTHJES+1                                                04876000
CVTRSV42 EQU   CVTHJES                                                  04877000
CVTEXT2A EQU   CVTEXT2+1                                                04878000
CVTRSV41 EQU   CVTEXT2                                                  04879000
CVTAPFA  EQU   CVTAPF+1                                                 04880000
CVTRSV40 EQU   CVTAPF                                                   04881000
CVTRV518 EQU   CVTINTLA                                                 04882000
CVTRV517 EQU   CVTERPV                                                  04883000
CVTEORM  EQU   CVTMAP+312                                               04884000
CVTMCHPR EQU   CVTMAP+308                                               04885000
CVTTZ    EQU   CVTMAP+304                                               04886000
CVTJEPS  EQU   CVTMAP+300                                               04887000
CVTJESCT EQU   CVTMAP+296                                               04888000
CVTMODE  EQU   CVTMAP+292                                               04889000
CVTPTRV  EQU   CVTMAP+288                                               04890000
CVTREAL  EQU   CVTMAP+284                                               04891000
CVTRSV39 EQU   CVTMAP+280                                               04892000
CVTRSV38 EQU   CVTMAP+276                                               04893000
CVTDMSRA EQU   CVTDMSR+1                                                04894000
CVTRV634 EQU   CVTDMSRF                                                 04895000
CVTRV633 EQU   CVTDMSRF                                                 04896000
CVTRV632 EQU   CVTDMSRF                                                 04897000
CVTRV631 EQU   CVTDMSRF                                                 04898000
CVTRV630 EQU   CVTDMSRF                                                 04899000
CVTRV629 EQU   CVTDMSRF                                                 04900000
CVTUDUMP EQU   CVTDMSRF                                                 04901000
CVTSDUMP EQU   CVTDMSRF                                                 04902000
CVTQMSGA EQU   CVTQMSG+1                                                04903000
CVTRSV36 EQU   CVTQMSG                                                  04904000
CVTAMFF  EQU   CVTMAP+264                                               04905000
CVTPURGA EQU   CVTPURG+1                                                04906000
CVTRSV35 EQU   CVTPURG                                                  04907000
CVTCBSP  EQU   CVTMAP+256                                               04908000
CVTATERA EQU   CVTATER+1                                                04909000
CVTSYST  EQU   CVTATER                                                  04910000
CVTVOLT2 EQU   CVTTAT                                                   04911000
CVTVOLI2 EQU   CVTVOLF2                                                 04912000
CVTAQAVB EQU   CVTAQAVT+1                                               04913000
CVTRSV34 EQU   CVTTCMFG                                                 04914000
CVTRSV33 EQU   CVTTCMFG                                                 04915000
CVTRSV32 EQU   CVTTCMFG                                                 04916000
CVTRSV31 EQU   CVTTCMFG                                                 04917000
CVTRSV30 EQU   CVTTCMFG                                                 04918000
CVTRSV29 EQU   CVTTCMFG                                                 04919000
CVTRSV28 EQU   CVTTCMFG                                                 04920000
CVTTCRDY EQU   CVTTCMFG                                                 04921000
CVTGTFA  EQU   CVTGTF+1                                                 04922000
CVTRSV27 EQU   CVTGTFST                                                 04923000
CVTRNIO  EQU   CVTGTFST                                                 04924000
CVTUSR   EQU   CVTGTFST                                                 04925000
CVTRV318 EQU   CVTFORM                                                  04926000
CVTRV317 EQU   CVTTMODE                                                 04927000
CVTRV316 EQU   CVTSTATE                                                 04928000
CVTRV315 EQU   CVTGTFS                                                  04929000
CVTGTFAV EQU   CVTGTFS                                                  04930000
CVT0SCR1 EQU   CVTMAP+232                                               04931000
CVTRV515 EQU   CVTMAP+228                                               04932000
CVTRMS   EQU   CVTMAP+224                                               04933000
CVTPATCH EQU   CVTMAP+220                                               04934000
CVTTSCE  EQU   CVTMAP+216                                               04935000
CVTLNKSC EQU   CVTMAP+214                                               04936000
CVTQABST EQU   CVTMAP+212                                               04937000
CVTMDLDS EQU   CVTMAP+208                                               04938000
CVTUSER  EQU   CVTMAP+204                                               04939000
CVTABEND EQU   CVTMAP+200                                               04940000
CVTSMCA  EQU   CVTMAP+196                                               04941000
CVTRSV18 EQU   CVTMAP+192                                               04942000
CVTQLPAQ EQU   CVTMAP+188                                               04943000
CVTQCDSR EQU   CVTMAP+184                                               04944000
CVTRSV17 EQU   CVTOPTB                                                  04945000
CVTRSV16 EQU   CVTOPTB                                                  04946000
CVTFP    EQU   CVTOPTB                                                  04947000
CVTAPTHR EQU   CVTOPTB                                                  04948000
CVTNLOG  EQU   CVTOPTB                                                  04949000
CVTTOD   EQU   CVTOPTB                                                  04950000
CVTCTIMS EQU   CVTOPTB                                                  04951000
CVTPROT  EQU   CVTOPTB                                                  04952000
CVTXPFP  EQU   CVTOPTA                                                  04953000
CVTASCII EQU   CVTOPTA                                                  04954000
CVTRSV13 EQU   CVTOPTA                                                  04955000
CVTRSV12 EQU   CVTOPTA                                                  04956000
CVTNIP   EQU   CVTOPTA                                                  04957000
CVTDDR   EQU   CVTOPTA                                                  04958000
CVTAPR   EQU   CVTOPTA                                                  04959000
CVTCCH   EQU   CVTOPTA                                                  04960000
CVTSNCTR EQU   CVTMAP+180                                               04961000
CVTQMWR  EQU   CVTMAP+176                                               04962000
CVTQOCR  EQU   CVTMAP+172                                               04963000
CVT1EF00 EQU   CVTMAP+168                                               04964000
CVTMZ00  EQU   CVTMAP+164                                               04965000
CVTHEAD  EQU   CVTMAP+160                                               04966000
CVTRSV11 EQU   CVTMAP+156                                               04967000
CVT0PT01 EQU   CVTMAP+152                                               04968000
CVTMSER  EQU   CVTMAP+148                                               04969000
CVTRV516 EQU   CVTIERLC                                                 04970000
CVTILCH  EQU   CVTMAP+140                                               04971000
CVT0DS   EQU   CVTMAP+136                                               04972000
CVTFBOSV EQU   CVTMAP+132                                               04973000
CVTNUCB  EQU   CVTMAP+128                                               04974000
CVTIXAVL EQU   CVTMAP+124                                               04975000
CVTIOQET EQU   CVTMAP+120                                               04976000
CVTDCBA  EQU   CVTMAP+117                                               04977000
CVTMVS2  EQU   CVTDCB                                                   04978000
CVT6DAT  EQU   CVTDCB                                                   04979000
CVT4MPS  EQU   CVTDCB                                                   04980000
CVTRSV09 EQU   CVTDCB                                                   04981000
CVT4MS1  EQU   CVTDCB                                                   04982000
CVT2SPS  EQU   CVTDCB                                                   04983000
CVT1SSS  EQU   CVTDCB                                                   04984000
CVTRSV08 EQU   CVTDCB                                                   04985000
CVTSTB   EQU   CVTMAP+112                                               04986000
CVTQTD00 EQU   CVTMAP+108                                               04987000
CVTQTE00 EQU   CVTMAP+104                                               04988000
CVTCUCB  EQU   CVTMAP+100                                               04989000
CVTSJQ   EQU   CVTMAP+96                                                04990000
CVTPBLDL EQU   CVTMAP+92                                                04991000
CVTTPC   EQU   CVTMAP+88                                                04992000
CVTSVDCB EQU   CVTMAP+84                                                04993000
CVTBRET  EQU   CVTMAP+82                                                04994000
CVTEXIT  EQU   CVTMAP+80                                                04995000
CVT0FN00 EQU   CVTMAP+76                                                04996000
CVTDARA  EQU   CVTDAR+1                                                 04997000
CVTRSV07 EQU   CVTFLGS1                                                 04998000
CVTRSV06 EQU   CVTFLGS1                                                 04999000
CVTRSV05 EQU   CVTFLGS1                                                 05000000
CVTRSV04 EQU   CVTFLGS1                                                 05001000
CVTRSV03 EQU   CVTFLGS1                                                 05002000
CVTRSV02 EQU   CVTFLGS1                                                 05003000
CVTRSV01 EQU   CVTFLGS1                                                 05004000
CVTDMPLK EQU   CVTFLGS1                                                 05005000
CVTXITP  EQU   CVTMAP+68                                                05006000
CVTZDTAB EQU   CVTMAP+64                                                05007000
CVTMSLT  EQU   CVTMAP+60                                                05008000
CVTDATE  EQU   CVTMAP+56                                                05009000
CVTBTERM EQU   CVTMAP+52                                                05010000
CVTSYSAD EQU   CVTMAP+48                                                05011000
CVTXTLER EQU   CVTMAP+44                                                05012000
CVTILK2  EQU   CVTMAP+40                                                05013000
CVTILK1  EQU   CVTMAP+36                                                05014000
CVTPRLTV EQU   CVTMAP+32                                                05015000
CVTPCNVT EQU   CVTMAP+28                                                05016000
CVT0VL00 EQU   CVTMAP+24                                                05017000
CVTXAPG  EQU   CVTMAP+20                                                05018000
CVTBUF   EQU   CVTMAP+16                                                05019000
CVTJOB   EQU   CVTMAP+12                                                05020000
CVTLINK  EQU   CVTMAP+8                                                 05021000
CVT0EF00 EQU   CVTMAP+4                                                 05022000
CVTTCBP  EQU   CVTMAP                                                   05023000
CVT      EQU   CVTMAP                                                   05024000
@NM00019 EQU   EPATH+26                                                 05025000
@NM00018 EQU   EPAFLAG2                                                 05026000
EPARECUR EQU   EPAFLAG2                                                 05027000
EPATMI   EQU   EPAFLAG2                                                 05028000
EPAMAST  EQU   EPAFLAG2                                                 05029000
EPABUILD EQU   EPAFLAG2                                                 05030000
EPACOLD  EQU   EPAFLAG2                                                 05031000
EPAWARM  EQU   EPAFLAG2                                                 05032000
EPATMXIT EQU   EPAFLAG2                                                 05033000
EPAUNSAV EQU   EPAFLAG1                                                 05034000
EPAASGN  EQU   EPAFLAG1                                                 05035000
EPAACASR EQU   EPAFLAG1                                                 05036000
EPAACT   EQU   EPAGRPOP                                                 05037000
EPASAVE  EQU   EPAGRPOP                                                 05038000
EPARLG   EQU   EPAGRPOP                                                 05039000
EPATMISV EQU   EPABKSLT                                                 05040000
EPATMACB EQU   EPARASP                                                  05041000
EPATMIBA EQU   EPABASP                                                  05042000
EPADSLST EQU   EPAAASP                                                  05043000
EPASWKA  EQU   EPATMWKA                                                 05044000
EPAOWKA  EQU   EPAVSAM                                                  05045000
ASMCPRES EQU   ASMCPRSQ+4                                               05046000
ASMCPTAK EQU   ASMCPRSQ                                                 05047000
ASMCPCNT EQU   ASMCPAVQ+4                                               05048000
ASMCPEXT EQU   ASMPOOLS+6                                               05049000
ASMCPSIZ EQU   ASMPOOLS+4                                               05050000
ASMCPID  EQU   ASMPOOLS                                                 05051000
ASMRSV12 EQU   ASMVT+1000                                               05052000
ASMSAVE  EQU   ASMVT+928                                                05053000
ASMWKSA7 EQU   ASMVT+848                                                05054000
ASMWKSA6 EQU   ASMVT+768                                                05055000
ASMACEPC EQU   ASMVT+344                                                05056000
ASMBWKPC EQU   ASMVT+312                                                05057000
ASMIOEPC EQU   ASMVT+296                                                05058000
ASMRSV10 EQU   ASMVT+280                                                05059000
ASMPVACE EQU   ASMVT+276                                                05060000
ASMPIOFR EQU   ASMVT+272                                                05061000
ASMPVACQ EQU   ASMVT+268                                                05062000
ASMPMSGS EQU   ASMVT+264                                                05063000
ASMPMSG0 EQU   ASMVT+260                                                05064000
ASMPFRLG EQU   ASMVT+256                                                05065000
ASMPRLG  EQU   ASMVT+252                                                05066000
ASMPACT  EQU   ASMVT+248                                                05067000
ASMPSAV  EQU   ASMVT+244                                                05068000
ASMPCMP  EQU   ASMVT+240                                                05069000
ASMPCMPA EQU   ASMVT+236                                                05070000
ASMPCMPN EQU   ASMVT+232                                                05071000
ASMPCMPD EQU   ASMVT+228                                                05072000
ASMVRMTR EQU   ASMVT+220                                                05073000
ASMPSRBC EQU   ASMVT+216                                                05074000
ASMPSRMT EQU   ASMVT+212                                                05075000
ASMPSWPD EQU   ASMVT+208                                                05076000
ASMPTM   EQU   ASMVT+204                                                05077000
ASMPFRSW EQU   ASMVT+200                                                05078000
ASMPFRSL EQU   ASMVT+196                                                05079000
ASMPQIOE EQU   ASMVT+192                                                05080000
ASMRSV8  EQU   ASMVT+184                                                05081000
ASMTASCB EQU   ASMVT+180                                                05082000
ASMRLGWQ EQU   ASMVT+176                                                05083000
ASMRLGRQ EQU   ASMVT+172                                                05084000
ASMTMECB EQU   ASMVT+168                                                05085000
ASMTCBPT EQU   ASMVT+164                                                05086000
ASMREQCT EQU   ASMVT+160                                                05087000
ASMGOSWK EQU   ASMGOSQS+4                                               05088000
ASMGOSWT EQU   ASMGOSQS                                                 05089000
ASMLSAIH EQU   ASMLSAI+4                                                05090000
ASMLSAIL EQU   ASMLSAI                                                  05091000
ASMCINV  EQU   ASMVT+140                                                05092000
ASMLGVT  EQU   ASMVT+132                                                05093000
ASMSLOTV EQU   ASMVT+128                                                05094000
ASMERRS  EQU   ASMVT+124                                                05095000
ASMNVSC  EQU   ASMVT+120                                                05096000
ASMVSC   EQU   ASMVT+116                                                05097000
ASMSLOTS EQU   ASMVT+112                                                05098000
ASMBKSLT EQU   ASMVT+108                                                05099000
ASMRSV7  EQU   ASMVT+92                                                 05100000
ASMPSRB  EQU   ASMVT+88                                                 05101000
ASMSRBCT EQU   ASMVT+84                                                 05102000
ASMIOCNT EQU   ASMVT+80                                                 05103000
ASMBURST EQU   ASMVT+76                                                 05104000
ASMPCCWN EQU   ASMVT+72                                                 05105000
ASMPCCWC EQU   ASMPCCWQ+4                                               05106000
ASMPCCWA EQU   ASMPCCWQ                                                 05107000
ASMRSV6  EQU   ASMVT+48                                                 05108000
ASMIORQC EQU   ASMVT+44                                                 05109000
ASMIORQR EQU   ASMVT+40                                                 05110000
ASMSTAGL EQU   ASMSTAGQ+4                                               05111000
ASMSTAGF EQU   ASMSTAGQ                                                 05112000
ASMRSV5  EQU   ASMVT+28                                                 05113000
ASMMSGBF EQU   ASMVT+24                                                 05114000
ASMEREC  EQU   ASMVT+20                                                 05115000
ASMTRPAG EQU   ASMVT+16                                                 05116000
ASMGOS   EQU   ASMVT+12                                                 05117000
ASMPART  EQU   ASMVT+8                                                  05118000
ASMSART  EQU   ASMVT+4                                                  05119000
ASMRSV4  EQU   ASMVT+2                                                  05120000
ASMWARM  EQU   ASMFLAG2                                                 05121000
ASMQUICK EQU   ASMFLAG2                                                 05122000
ASMNOTPT EQU   ASMFLAG2                                                 05123000
ASMNOTMR EQU   ASMFLAG2                                                 05124000
ASMCALLQ EQU   ASMFLAG2                                                 05125000
ASMPLPAS EQU   ASMFLAG1                                                 05126000
ASMCOMMF EQU   ASMFLAG1                                                 05127000
ASMPLPAF EQU   ASMFLAG1                                                 05128000
ASMNODPX EQU   ASMFLAG1                                                 05129000
ASMRSV1  EQU   ASMFLAG1                                                 05130000
ASMNOLCL EQU   ASMFLAG1                                                 05131000
ASMNOCWQ EQU   ASMFLAG1                                                 05132000
ASMDUPLX EQU   ASMFLAG1                                                 05133000
ASPSLOT  EQU   ASPVLSID+1                                               05134000
ASPPRTNN EQU   ASPVLSID                                                 05135000
@NM00013 EQU   ASPLPFLG                                                 05136000
ASPLSVRP EQU   ASPLPFLG                                                 05137000
ASPLIOER EQU   ASPLPFLG                                                 05138000
ASPLOPIN EQU   ASPLPFLG                                                 05139000
ASPLSAVE EQU   ASPLPFLG                                                 05140000
ASPLVALD EQU   ASPLPFLG                                                 05141000
@NM00012 EQU   ASPEXTSN+1088                                            05142000
@NM00011 EQU   ASPEHDR+24                                               05143000
ASPASSTI EQU   ASPEHDR+22                                               05144000
@NM00010 EQU   ASPEHDR+21                                               05145000
@NM00009 EQU   ASPEHDR+4                                                05146000
@NM00008 EQU   ASPCT+1088                                               05147000
ASPLPMES EQU   ASPCT+64                                                 05148000
ASPSAVCT EQU   ASPHDR+40                                                05149000
ASPBKSLT EQU   ASPHDR+36                                                05150000
ASPMAXPN EQU   ASPHDR+32                                                05151000
@NM00007 EQU   ASPHDR+29                                                05152000
@NM00006 EQU   ASPFLAG                                                  05153000
ASPSAVRP EQU   ASPFLAG                                                  05154000
ASPSAVED EQU   ASPFLAG                                                  05155000
ASPLGE   EQU   ASPHDR+24                                                05156000
ASPASCB  EQU   ASPHDR+20                                                05157000
@NM00005 EQU   ASPBKEY+8                                                05158000
ASPLGID  EQU   ASPHDR+4                                                 05159000
ASPIDENT EQU   ASPHDR                                                   05160000
RPLERMSA EQU   RPLCOMN+72                                               05161000
RPLEMLEN EQU   RPLCOMN+70                                               05162000
RPLACTIV EQU   RPLCOMN+69                                               05163000
RPLBRANC EQU   RPLEXTD1                                                 05164000
RPLNIB   EQU   RPLEXTD1                                                 05165000
@NM00049 EQU   RPLEXTD1                                                 05166000
RPLEXIT  EQU   RPLEXTD1                                                 05167000
RPLNEXIT EQU   RPLEXTD1                                                 05168000
RPLEXSCH EQU   RPLEXTD1                                                 05169000
RPLDDDD  EQU   RPLRBAR+4                                                05170000
@NM00048 EQU   RPLRBAR+3                                                05171000
@NM00047 EQU   RPLAIXID                                                 05172000
RPLAXPKP EQU   RPLAIXID                                                 05173000
RPLAIXPC EQU   RPLRBAR                                                  05174000
RPLRSV88 EQU   RPLOPT8                                                  05175000
RPLUNCON EQU   RPLOPT8                                                  05176000
RPLACTV  EQU   RPLOPT8                                                  05177000
RPLSESS  EQU   RPLOPT8                                                  05178000
RPLPEND  EQU   RPLOPT8                                                  05179000
RPLODPRM EQU   RPLOPT8                                                  05180000
RPLODACP EQU   RPLOPT8                                                  05181000
RPLODACQ EQU   RPLOPT8                                                  05182000
RPLRSV78 EQU   RPLOPT7                                                  05183000
RPLRSV77 EQU   RPLOPT7                                                  05184000
RPLRLSOP EQU   RPLOPT7                                                  05185000
RPLTPOST EQU   RPLOPT7                                                  05186000
RPLQOPT  EQU   RPLOPT7                                                  05187000
RPLCNIMM EQU   RPLCNOPT                                                 05188000
RPLCNANY EQU   RPLCNOPT                                                 05189000
RPLCNALL EQU   RPLCNOPT                                                 05190000
RPLRSV68 EQU   RPLOPT6                                                  05191000
RPLRSV67 EQU   RPLOPT6                                                  05192000
RPLLOCK  EQU   RPLOPT6                                                  05193000
RPLNCOND EQU   RPLOPT6                                                  05194000
RPLCOND  EQU   RPLOPT6                                                  05195000
RPLEOT   EQU   RPLUNTYP                                                 05196000
RPLEOM   EQU   RPLUNTYP                                                 05197000
RPLEOB   EQU   RPLUNTYP                                                 05198000
RPLWROPT EQU   RPLOPT5                                                  05199000
RPLNODE  EQU   RPLOPT5                                                  05200000
RPLERACE EQU   RPLWRTYP                                                 05201000
RPLEAU   EQU   RPLWRTYP                                                 05202000
RPLNERAS EQU   RPLWRTYP                                                 05203000
RPLPSOPT EQU   RPLOPT5                                                  05204000
RPLSSNIN EQU   RPLOPT5                                                  05205000
RPLDLGIN EQU   RPLOPT5                                                  05206000
RPLBUFL  EQU   RPLCOMN+52                                               05207000
RPLRLEN  EQU   RPLCOMN+48                                               05208000
RPLCHAIN EQU   RPLNXTRP                                                 05209000
RPLOPT4  EQU   RPLOPTCD+3                                               05210000
RPLALIGN EQU   RPLOPT3                                                  05211000
RPLFMT   EQU   RPLOPT3                                                  05212000
RPLFLD   EQU   RPLOPT3                                                  05213000
RPLVFY   EQU   RPLOPT3                                                  05214000
RPLBLK   EQU   RPLOPT3                                                  05215000
RPLSFORM EQU   RPLOPT3                                                  05216000
RPLEODS  EQU   RPLOPT3                                                  05217000
RPLNSP   EQU   RPLOPT2                                                  05218000
RPLUPD   EQU   RPLOPT2                                                  05219000
@NM00046 EQU   RPLOPT2                                                  05220000
RPLLRD   EQU   RPLOPT2                                                  05221000
RPLBWD   EQU   RPLOPT2                                                  05222000
RPLCNV   EQU   RPLOPT2                                                  05223000
RPLADD   EQU   RPLADR                                                   05224000
RPLKEY   EQU   RPLOPT2                                                  05225000
RPLECBIN EQU   RPLECBSW                                                 05226000
RPLGEN   EQU   RPLOPT1                                                  05227000
RPLKGE   EQU   RPLOPT1                                                  05228000
RPLASY   EQU   RPLOPT1                                                  05229000
RPLSKP   EQU   RPLOPT1                                                  05230000
RPLSEQ   EQU   RPLOPT1                                                  05231000
RPLDIR   EQU   RPLOPT1                                                  05232000
RPLLOC   EQU   RPLOPT1                                                  05233000
RPLDAF   EQU   RPLARG+2                                                 05234000
RPLSAF   EQU   RPLARG                                                   05235000
RPLTCBPT EQU   RPLCOMN+28                                               05236000
RPLDACB  EQU   RPLCOMN+24                                               05237000
RPLCCHAR EQU   RPLCOMN+20                                               05238000
RPLSTRID EQU   RPLCOMN+18                                               05239000
RPLKEYL  EQU   RPLKEYLE                                                 05240000
RPLRDSOH EQU   RPLFDB3                                                  05241000
RPLRLG   EQU   RPLFDB3                                                  05242000
RPLLGFRC EQU   RPLFDB3                                                  05243000
RPLREOT  EQU   RPLFDB3                                                  05244000
RPLREOM  EQU   RPLFDB3                                                  05245000
RPLREOB  EQU   RPLFDB3                                                  05246000
RPLSV32  EQU   RPLFDB3                                                  05247000
RPLUINPT EQU   RPLFDB3                                                  05248000
RPLSTSAV EQU   RPLFDB2                                                  05249000
RPLCUERR EQU   RPLFDB2                                                  05250000
RPLDLGFL EQU   RPLFDB2                                                  05251000
RPLIOERR EQU   RPLFDB2                                                  05252000
RPLDVUNS EQU   RPLFDB2                                                  05253000
RPLATND  EQU   RPLFDB2                                                  05254000
RPLRVID  EQU   RPLFDB2                                                  05255000
RPLERLK  EQU   RPLFDB2                                                  05256000
RPLERREG EQU   RPLRTNCD                                                 05257000
RPLSTAT  EQU   RPLFDBWD                                                 05258000
RPLPOST  EQU   RPLECB                                                   05259000
RPLWAIT  EQU   RPLECB                                                   05260000
RPLPLHPT EQU   RPLCOMN+4                                                05261000
RPLLEN2  EQU   RPLLEN                                                   05262000
RPLREQ   EQU   RPLIDWD+2                                                05263000
RPLSTYP  EQU   RPLIDWD+1                                                05264000
RPLID    EQU   RPLIDWD                                                  05265000
@NM00002 EQU   @NM00001+1                                               05266000
@NM00045 EQU   PSA+3668                                                 05267000
PSASTAK  EQU   PSA+3072                                                 05268000
@NM00044 EQU   PSA+1048                                                 05269000
PSAUSEND EQU   PSA+1048                                                 05270000
PSARV062 EQU   PSA+1044                                                 05271000
PSACDAL  EQU   PSA+1040                                                 05272000
PSAWTCOD EQU   PSA+1036                                                 05273000
PSAATCVT EQU   PSA+1032                                                 05274000
PSAPCPSW EQU   PSA+1024                                                 05275000
PSAPIR2  EQU   PSA+1020                                                 05276000
PSARV059 EQU   PSA+1018                                                 05277000
PSASVC13 EQU   PSA+1016                                                 05278000
PSALSFCC EQU   PSA+1012                                                 05279000
PSASFACC EQU   PSA+1008                                                 05280000
PSASTOP  EQU   PSA+992                                                  05281000
PSASTART EQU   PSA+976                                                  05282000
PSARSPSW EQU   PSA+968                                                  05283000
PSASRPSW EQU   PSA+960                                                  05284000
PSARV045 EQU   PSA+892                                                  05285000
PSARV044 EQU   PSA+888                                                  05286000
PSARV043 EQU   PSA+884                                                  05287000
PSARV042 EQU   PSA+880                                                  05288000
PSARV041 EQU   PSA+876                                                  05289000
PSARV040 EQU   PSA+872                                                  05290000
PSARV025 EQU   PSA+868                                                  05291000
PSADSSED EQU   PSA+868                                                  05292000
PSADSSPR EQU   PSA+864                                                  05293000
PSADSSFW EQU   PSA+860                                                  05294000
PSADSS14 EQU   PSA+856                                                  05295000
PSADSSPP EQU   PSA+848                                                  05296000
PSADSSRP EQU   PSA+840                                                  05297000
PSADSS05 EQU   PSADSSF4                                                 05298000
PSADSS10 EQU   PSADSSF4                                                 05299000
PSADSSVE EQU   PSADSSF4                                                 05300000
PSADSSDE EQU   PSADSSF4                                                 05301000
PSADSSC0 EQU   PSADSSF4                                                 05302000
PSADSSIE EQU   PSADSSF4                                                 05303000
PSADSS12 EQU   PSADSSF4                                                 05304000
PSADSSRC EQU   PSADSSF4                                                 05305000
PSARV057 EQU   PSADSSF3                                                 05306000
PSARV056 EQU   PSADSSF3                                                 05307000
PSARV055 EQU   PSADSSF3                                                 05308000
PSADSSMC EQU   PSADSSF3                                                 05309000
PSADSSRW EQU   PSADSSF3                                                 05310000
PSADSSNM EQU   PSADSSF3                                                 05311000
PSADSSES EQU   PSADSSF3                                                 05312000
PSADSSGP EQU   PSADSSF3                                                 05313000
PSADSSF2 EQU   PSADSSFL+1                                               05314000
PSADSSPI EQU   PSADSSF1                                                 05315000
PSADSSOI EQU   PSADSSF1                                                 05316000
PSADSSSP EQU   PSADSSF1                                                 05317000
PSADSSTP EQU   PSADSSF1                                                 05318000
PSADSSDW EQU   PSADSSF1                                                 05319000
PSADSSDD EQU   PSADSSF1                                                 05320000
PSADSSDM EQU   PSADSSF1                                                 05321000
PSADSSMV EQU   PSADSSF1                                                 05322000
PSADSSTS EQU   PSA+816                                                  05323000
PSADSSWK EQU   PSA+812                                                  05324000
PSADSSR3 EQU   PSA+808                                                  05325000
PSADSSR2 EQU   PSA+804                                                  05326000
PSADSSRS EQU   PSA+800                                                  05327000
PSASTOR  EQU   PSA+796                                                  05328000
PSACPUSA EQU   PSA+794                                                  05329000
PSAVSTAP EQU   PSA+792                                                  05330000
PSAWKVAP EQU   PSA+788                                                  05331000
PSAWKRAP EQU   PSA+784                                                  05332000
PSAMCHIC EQU   PSA+783                                                  05333000
PSARV061 EQU   PSA+782                                                  05334000
PSASYMSK EQU   PSA+781                                                  05335000
PSAMCHFL EQU   PSA+780                                                  05336000
PSACR0   EQU   PSA+776                                                  05337000
PSAPSWSV EQU   PSA+768                                                  05338000
PSALITA  EQU   PSA+764                                                  05339000
PSACLHS  EQU   PSAHLHI                                                  05340000
PSALKR15 EQU   PSALKSA+60                                               05341000
PSALKR14 EQU   PSALKSA+56                                               05342000
PSALKR13 EQU   PSALKSA+52                                               05343000
PSALKR12 EQU   PSALKSA+48                                               05344000
PSALKR11 EQU   PSALKSA+44                                               05345000
PSALKR10 EQU   PSALKSA+40                                               05346000
PSALKR9  EQU   PSALKSA+36                                               05347000
PSALKR8  EQU   PSALKSA+32                                               05348000
PSALKR7  EQU   PSALKSA+28                                               05349000
PSALKR6  EQU   PSALKSA+24                                               05350000
PSALKR5  EQU   PSALKSA+20                                               05351000
PSALKR4  EQU   PSALKSA+16                                               05352000
PSALKR3  EQU   PSALKSA+12                                               05353000
PSALKR2  EQU   PSALKSA+8                                                05354000
PSALKR1  EQU   PSALKSA+4                                                05355000
PSALKR0  EQU   PSALKSA                                                  05356000
PSARV023 EQU   PSACLHT+52                                               05357000
PSALOCAL EQU   PSACLHT+48                                               05358000
PSACMSL  EQU   PSACLHT+44                                               05359000
PSAOPTL  EQU   PSACLHT+40                                               05360000
PSATPACL EQU   PSACLHT+36                                               05361000
PSATPDNL EQU   PSACLHT+32                                               05362000
PSATPNCL EQU   PSACLHT+28                                               05363000
PSAIOSLL EQU   PSACLHT+24                                               05364000
PSAIOSUL EQU   PSACLHT+20                                               05365000
PSAIOSCL EQU   PSACLHT+16                                               05366000
PSAIOSSL EQU   PSACLHT+12                                               05367000
PSASALCL EQU   PSACLHT+8                                                05368000
PSAASML  EQU   PSACLHT+4                                                05369000
PSADISPL EQU   PSACLHT                                                  05370000
PSASRSA  EQU   PSA+636                                                  05371000
PSARV050 EQU   PSA+634                                                  05372000
PSADSSGO EQU   PSA+633                                                  05373000
PSARECUR EQU   PSA+632                                                  05374000
PSAHLHIS EQU   PSA+628                                                  05375000
PSAIPCSA EQU   PSA+624                                                  05376000
@NM00043 EQU   PSA+621                                                  05377000
PSAIPCDM EQU   PSA+620                                                  05378000
PSAIPCD  EQU   PSA+616                                                  05379000
@NM00042 EQU   PSA+613                                                  05380000
PSAIPCRM EQU   PSA+612                                                  05381000
PSAIPCR  EQU   PSA+608                                                  05382000
PSAMCHEX EQU   PSA+600                                                  05383000
PSAMPSW  EQU   PSA+592                                                  05384000
PSAEXPS2 EQU   PSA+584                                                  05385000
PSAEXPS1 EQU   PSA+576                                                  05386000
PSAPIREG EQU   PSA+572                                                  05387000
PSARSREG EQU   PSA+568                                                  05388000
PSAGPREG EQU   PSA+556                                                  05389000
PSARV022 EQU   PSASUP4                                                  05390000
PSARV021 EQU   PSASUP4                                                  05391000
PSARV020 EQU   PSASUP4                                                  05392000
PSARV019 EQU   PSASUP4                                                  05393000
PSARV018 EQU   PSASUP4                                                  05394000
PSARV017 EQU   PSASUP4                                                  05395000
PSARV016 EQU   PSASUP4                                                  05396000
PSARV015 EQU   PSASUP4                                                  05397000
PSARV014 EQU   PSASUP3                                                  05398000
PSARV013 EQU   PSASUP3                                                  05399000
PSARV012 EQU   PSASUP3                                                  05400000
PSAESTA  EQU   PSASUP3                                                  05401000
PSASPR   EQU   PSASUP3                                                  05402000
PSAPSREG EQU   PSASUP3                                                  05403000
PSAPI2   EQU   PSASUP3                                                  05404000
PSAIOSUP EQU   PSASUP3                                                  05405000
PSALCR   EQU   PSASUP2                                                  05406000
PSARTM   EQU   PSASUP2                                                  05407000
PSAACR   EQU   PSASUP2                                                  05408000
PSAIPCE2 EQU   PSASUP2                                                  05409000
PSAIPCES EQU   PSASUP2                                                  05410000
PSAIPCEC EQU   PSASUP2                                                  05411000
PSAGTF   EQU   PSASUP2                                                  05412000
PSAIPCRI EQU   PSASUP2                                                  05413000
PSATYPE6 EQU   PSASUP1                                                  05414000
PSATCTL  EQU   PSASUP1                                                  05415000
PSADISP  EQU   PSASUP1                                                  05416000
PSALOCK  EQU   PSASUP1                                                  05417000
PSAPI    EQU   PSASUP1                                                  05418000
PSAEXT   EQU   PSASUP1                                                  05419000
PSASVC   EQU   PSASUP1                                                  05420000
PSAIO    EQU   PSASUP1                                                  05421000
PSAANEW  EQU   PSA+544                                                  05422000
PSATNEW  EQU   PSA+536                                                  05423000
PSALCCAR EQU   PSA+532                                                  05424000
PSALCCAV EQU   PSA+528                                                  05425000
PSAPCCAR EQU   PSA+524                                                  05426000
PSAPCCAV EQU   PSA+520                                                  05427000
PSACPULA EQU   PSA+518                                                  05428000
PSACPUPA EQU   PSA+516                                                  05429000
PSAPSA   EQU   PSA+512                                                  05430000
FLCHDEND EQU   PSA+512                                                  05431000
FLCCRSAV EQU   FLCMCLA+280                                              05432000
FLCGRSAV EQU   FLCMCLA+216                                              05433000
FLCFPSAV EQU   FLCMCLA+184                                              05434000
FLCFLA   EQU   FLCMCLA+88                                               05435000
FLCRGNCD EQU   FLCMCLA+84                                               05436000
FLCFSAA  EQU   FLCFSA+1                                                 05437000
@NM00041 EQU   FLCFSA                                                   05438000
@NM00040 EQU   FLCMCLA+72                                               05439000
FLCMCIC  EQU   FLCMCLA+64                                               05440000
@NM00039 EQU   FLCMCLA+20                                               05441000
FLCIOAA  EQU   FLCIOA+1                                                 05442000
@NM00038 EQU   FLCIOA                                                   05443000
@NM00037 EQU   FLCMCLA+15                                               05444000
@NM00036 EQU   FLCMCLA+14                                               05445000
@NM00035 EQU   FLCMCLA+12                                               05446000
FLCLCL   EQU   FLCMCLA+8                                                05447000
FLCIOELA EQU   FLCIOEL+1                                                05448000
@NM00034 EQU   FLCIOEL                                                  05449000
FLCCHNID EQU   FLCMCLA                                                  05450000
@NM00033 EQU   PSA+160                                                  05451000
FLCMTRCD EQU   PSA+157                                                  05452000
@NM00032 EQU   PSA+156                                                  05453000
FLCPERA  EQU   FLCPER+1                                                 05454000
@NM00031 EQU   FLCPER                                                   05455000
@NM00030 EQU   PSA+151                                                  05456000
FLCPERCD EQU   PSA+150                                                  05457000
FLCMCNUM EQU   PSA+149                                                  05458000
@NM00029 EQU   PSA+148                                                  05459000
FLCTEAA  EQU   FLCTEA+1                                                 05460000
@NM00028 EQU   FLCTEA                                                   05461000
PSAPIPC  EQU   PSAPICOD                                                 05462000
PSAPIMC  EQU   PSAPICOD                                                 05463000
PSAPIPER EQU   PSAPICOD                                                 05464000
PSARV049 EQU   FLCPICOD                                                 05465000
FLCPILCB EQU   FLCPIILC                                                 05466000
@NM00027 EQU   FLCPIILC                                                 05467000
@NM00026 EQU   PSAEPPSW                                                 05468000
FLCSVCN  EQU   PSAESPSW+2                                               05469000
FLCSILCB EQU   FLCSVILC                                                 05470000
@NM00025 EQU   FLCSVILC                                                 05471000
@NM00024 EQU   PSAESPSW                                                 05472000
FLCEICOD EQU   PSAEEPSW+2                                               05473000
PSASPAD  EQU   PSAEEPSW                                                 05474000
@NM00023 EQU   PSA+128                                                  05475000
FLCINPSW EQU   PSA+120                                                  05476000
FLCMNPSW EQU   PSA+112                                                  05477000
FLCPNPSW EQU   PSA+104                                                  05478000
FLCSNPSW EQU   PSA+96                                                   05479000
FLCENPSW EQU   PSA+88                                                   05480000
FLCTRACE EQU   PSA+84                                                   05481000
FLCTIMER EQU   PSA+80                                                   05482000
FLCCVT2  EQU   PSA+76                                                   05483000
FLCCAW   EQU   PSA+72                                                   05484000
FLCCSW   EQU   PSA+64                                                   05485000
FLCIOPSW EQU   PSA+56                                                   05486000
FLCMOPSW EQU   PSA+48                                                   05487000
FLCPOPSW EQU   PSA+40                                                   05488000
FLCSOPSW EQU   PSA+32                                                   05489000
FLCEOPSW EQU   PSA+24                                                   05490000
@NM00022 EQU   FLCICCW2+4                                               05491000
FLCICCW1 EQU   FLCROPSW                                                 05492000
FLCIPPSW EQU   FLCRNPSW                                                 05493000
*                                      END UNREFERENCED COMPONENTS      05494000
@RC00179 EQU   @RC00178                                                 05495000
@RF00150 EQU   @RC00145                                                 05496000
@RC00321 EQU   @RC00320                                                 05497000
@RF00339 EQU   @RC00333                                                 05498000
@RF00300 EQU   @RC00297                                                 05499000
@RC00537 EQU   @RC00536                                                 05500000
@RC00421 EQU   @RC00415                                                 05501000
@RC00723 EQU   @RC00722                                                 05502000
@RC00735 EQU   @RC00722                                                 05503000
@RC00798 EQU   @RC00797                                                 05504000
@RC00810 EQU   @RC00797                                                 05505000
@RC00887 EQU   @RC00886                                                 05506000
@RC00905 EQU   @RC00886                                                 05507000
@RC00900 EQU   @RC00886                                                 05508000
@RC00952 EQU   @RC00948                                                 05509000
@RF00961 EQU   @RC00958                                                 05510000
@RC00974 EQU   @RC00970                                                 05511000
@RC00986 EQU   @RC00983                                                 05512000
@ENDDATA EQU   *                                                        05513000
         END   ILRVSAMI,(C'PLS1506',0701,76087)                         05514000
