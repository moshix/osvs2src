         PRINT OFF                                                      00050007
         MACRO                                                          00050407
&NAME    BNGHJN &LABEL,&HJN                                             00050807
         LCLC  &HJA,&HJB                                                00051207
&HJA     SETC  '&SYSPARM'(1,4)                                          00051607
&HJB     SETC  '&SYSPARM'(5,4)                                          00052007
         AIF   ('&LABEL' EQ '').NOBRNCH                                 00052407
         B     &LABEL .                 BR AROUND CONSTANTS             00052807
         SPACE 2                                                        00053207
.NOBRNCH ANOP                                                           00053607
         AIF   ('&NAME' EQ '').NOLABEL                                  00054007
         DC    C'&NAME' .              MODULE IDENTIFIER                00054407
.NOLABEL ANOP                                                           00054807
         DC    X'&HJA' .                DATE OF MODIFICATION            00055207
         AIF   ('&HJN' NE 'HJN').DATE                                   00055607
         DC    X'&HJB' .                HJN OF MODIFICATION             00056007
.DATE    ANOP                                                           00056407
         AIF   ('&LABEL' EQ '').NOLBL                                   00056807
         SPACE 2                                                        00057207
&LABEL   DS    0H                                                       00057607
.NOLBL   ANOP                                                           00058007
         MEND                                                           00058407
         PRINT ON                                                       00058807
*********************************************************************** 00059207
*                                                                     * 00100000
* MODULE NAME = BNGT3270                                              * 00150000
*                                                                     * 00200000
* DESCRIPTIVE NAME = TCAM DEMF 3270 DISPLAY MODULE                    * 00250000
*                                                                     * 00300000
* COPYRIGHT = NONE                                                    * 00350000
*                                                                     * 00400000
* STATUS = RELEASE 1, LEVEL 1                                         * 00450000
*                                                                     * 00500000
* FUNCTION = 1) BNGT3270 IS LINKED TO BY BNGTDISP;                    * 00550000
*            2) HANDLES 3270 DISPLAY TERMINAL ERROR INFORMATION       * 00600000
*               REQUEST AND BITS PROMPTER REQUEST;                    * 00650000
*            3) ACCESSES SYS1.DEMFLOG DATA FILE AND COLLECTS THE      * 00700000
*               REQUESTED 3270 ERROR INFORMATION FROM IT;             * 00750000
*            4) FORMS OUTPUT MESSAGE AND WRITES IT TO THE 3270 DISPLAY* 00800000
*               TERMINAL; (ERR INFO AND SOME OF DISPLAY MESSAGES)     * 00850000
*            5) RETURNS CONTROL TO BNGTDISP.                          * 00900000
*                                                                     * 00950000
* NOTES = NONE                                                        * 01000000
*                                                                     * 01050000
*    DEPENDENCIES = NONE                                              * 01100000
*                                                                     * 01150000
*    RESTRICTIONS = NONE                                              * 01200000
*                                                                     * 01250000
*    REGISTER CONVENTIONS = R10 RECEIVES ADDRESS OF I/O MESSAGE AREA  * 01300000
*                           FROM BNGTDISP                             * 01350000
*                                                                     * 01400000
*    PATCH LABEL = NONE                                               * 01450000
*                                                                     * 01500000
* MODULE TYPE = TCAM DISPLAY                                          * 01550000
*                                                                     * 01600000
*    PROCESSOR = ASSEMBLER H                                          * 01650000
*                                                                     * 01700000
*    MODULE SIZE = 7623 DECIMAL BYTES                                 * 01750000
*                                                                     * 01800000
*    ATTRIBUTES = SERIALLY REUSABLE                                   * 01850000
*                                                                     * 01900000
* ENTRY POINT = BNGT3270                                              * 01950000
*                                                                     * 02000000
*    PURPOSE = SEE FUNCTION                                           * 02050000
*                                                                     * 02100000
*    LINKAGE = R1  LOADED WITH THE PARAM LIST POINTER                 * 02150000
*              R14 LOADED WITH THE RETURN ADDR (USED BY SUBROUTINE)   * 02200000
*              R15 LOADED WITH ENTRY POINT                            * 02250000
*                                                                     * 02300000
* INPUT = PARAM LIST ITEMS USED ARE :                                 * 02350000
*         IN MESSAGE ADDRESS  = TCAMFLDS (R10)                        * 02400000
*         IN MESSAGE COUNT    = VARIABLE (MAXIMUM=117 BYTES)          * 02450000
*                                                                     * 02500000
* OUTPUT = PARAM LIST ITEMS USED ARE :                                * 02550000
*         OUT MESSAGE ADDRESS = TIOADBAO (R10)                        * 02600000
*         OUT MESSAGE COUNT   = VARIABLE (MAXIMUM=2008 BYTES)         * 02650000
*                                                                     * 02700000
* EXIT-NORMAL = REGISTER 15 RETURN CODE RETURNED TO CALLER :          * 02750000
*               00 - OPERATION PERFORMED AS REQUESTED                 * 02800000
*                                                                     * 02850000
* EXIT-ERROR  = SYNAD ROUTINE AT LABEL - F1900                        * 02900000
*                                                                     * 02950000
* EXTERNAL REFERENCE = NONE                                           * 03000000
*                                                                     * 03050000
*    ROUTINES = LOCATE ROUTINE                                        * 03100000
*               GETTIOA ROUTINE (GET TERMINAL OUTPUT AREA)            * 03150000
*               BUOBR ROUTINE (BLOW-UP OBR ROUTINE)                   * 03200000
*               BUMDR ROUTINE (BLOW-UP MDR ROUTINE)                   * 03250000
*                                                                     * 03300000
*    DATA AREAS = SEE INPUT AND OUTPUT ABOVE                          * 03350000
*                                                                     * 03400000
*    CONTROL BLOCK = DCB (AT LABEL EMFILE)                            * 03450000
*                                                                     * 03500000
* TABLES = CALENDAR - CONVERT JULIAN DATE TO GREGORIAN DATE TABLE     * 03550000
*          LEAPTBL  - LEAP YEAR CALCULATION TABLE                     * 03600000
*          CCWTABL  - CONVERT 270X COMMAND CODE INTO ENGLISH          * 03650000
*          CSWTABL  - CONVERT LOCAL 327X STATUS OR 270X LINE STATUS   * 03700000
*                     INTO ENGLISH                                    * 03750000
*          SENSTABL - CONVERT 270X LINE SENSE CODE INTO ENGLISH       * 03800000
*          STATSTBL - CONVERT REMOTE 327X STATUS CODE INTO ENGLISH    * 03850000
*          SENS3272 - CONVERT LOCAL 327X SENSE CODE INTO ENGLISH      * 03900000
*          CCW3272  - CONVERT LOCAL 327X COMMAND CODE INTO ENGLISH    * 03950000
*          TPOPTBL  - CONVERT BTAM TP OP CODE INTO ENGLISH            * 04000000
*          TCAMPTOP - CONVERT TCAM TP OP CODE INTO ENGLISH            * 04050000
*          HXTOEB   - HEX CHARS TO EBCDIC CHARS TABLE                 * 04100000
*          EBTOHX   - EBCDIC CHARS TO HEX CHARS TABLE                 * 04150000
*                                                                     * 04200000
* MACROS = LINK, SAVE, RETURN, OPEN, READ, CHECK, CLOSE, TIME         * 04250000
*                                                                     * 04300000
******************CHANGE ACTIVITIES AS FOLLOWS:************************ 04350000
* CHANGE 01  11/15/77  PROLOGUE ADDED                                 * 04350107
* CHANGE 02  02/27/78  BNGHJN MACRO ADDED                             * 04350207
*A143000,287000                                                @OZ30478 04350307
*D144500-145000                                                @OZ30478 04350407
*C081500-089000                                                @OZ30675 04350507
*A207500,485000,543500                                         @OZ31884 04350607
*D636000-639000                                                @OZ31884 04350707
*                                                                     * 04400000
*                                                                     * 04450000
*********************************************************************** 04500000
R0       EQU   0                                                        04550000
R1       EQU   1              REGISTER ONE                              04600000
R8       EQU   8                                                        04650000
REG9     EQU   9                                                        04700000
BASE1    EQU   2                   1ST PROGRAM BASE REG.                04750000
BASE2    EQU   4                   2ND PROGRAM BASE REG.                04800000
TIOABAR  EQU   5                   TIOA POINTER.                        04850000
FIOABAR  EQU   6                   FIOA POINTER.                        04900000
DATAREG  EQU   7                   POINTER TO DATA IN EMF FILE BLOCK.   04950000
DATALOOP EQU   8                   LOOP REG FOR PROCESSING WITH DATAREG 05000000
OUTREG   EQU   9                   POINTER TO VARIABLE AREA IN TIOA.    05050000
LINKREG  EQU   11                  LOOP REG FOR PROCESSING WITH OUTREG. 05100000
OUTLOOP  EQU   12                  LINKAGE TO COMMON SUBROUTINES.       05150000
R14      EQU   14                                                       05200000
R15      EQU   15                                                       05250000
SBA      EQU   X'11'                                                    05300000
SF       EQU   X'1D'                                                    05350000
IC       EQU   X'13'                                                    05400000
UMN      EQU   X'41'               UNPROT,NORMAL,MODIFIED               05450000
UNA      EQU   X'40'                                                    05500000
PNA      EQU   X'60'                                                    05550000
UHA      EQU   X'C8'                                                    05600000
PDA      EQU   X'E8'                                                    05650000
PIA      EQU   X'6D'                                                    05700000
MNP      EQU   X'61'                                                    05750000
SML2P1   EQU   X'40E8'                                                  05800000
SML3P1   EQU   X'C150'                                                  05850000
SML4P1   EQU   X'C1F8'                                                  05900000
L1P1     EQU   X'4040'                                                  05950000
L2P1     EQU   X'C150'                                                  06000000
L3P1     EQU   X'C260'                                                  06050000
L4P1     EQU   X'C3F0'                                                  06100000
SML5P1   EQU   X'C260'   LINE 5 POSITION 1 FOR MOD-1 SCREEN             06150000
L1P36    EQU   X'40E3'                                                  06200000
L1P7     EQU   X'40C6'                                                  06250000
L3P39    EQU   X'C1F6'                                                  06300000
L2P79    EQU   X'C25E'                                                  06350000
L6P26    EQU   X'C6E9'                                                  06400000
TCAMOBR  EQU   X'34'                                                    06450000
BTAMOBR  EQU   X'30'                                                    06500000
TCAMFLDS DSECT                                                          06550000
         USING *,10                                                     06600000
TIOATDL  DC    X'0000'    TERMINAL DATA LENGTH                          06650000
TCTTETT  DS    CL1   91=REMOTE  99=LOCAL 3270                           06700000
TCTTETM  DS    CL1    F1=MODEL 1  F2=MODEL 2 3270                       06750000
TCTTEGU  DS    0H     EUATE LOCAL LINE ADDRESES                         06800000
TCTLERLN DS    CL3     LINE ADDRESS RELATIVE LINE #                     06850000
TCTTETA  DS    CL1   CONTROL UNIT ADDRESS                               06900000
         DS    CL1     TERNINAL ADDRESS REMOTE                          06950000
TIOADBA  DS    CL100        TERMINAL INPUT AREA                         07000000
TCTTETI  DS    CL8          TCAM  SYMBOLIC ADDRESS                      07050000
TIOWCC   DC    X'C3'       WRITE ERASE                                  07100000
TIOADBAO DS    CL2000     TERMINAL OUTPUT AREA                          07150000
         ORG   TIOADBA             POINT TO INPUT AREA                  07200000
SBA1     DS    CL3                 IST SBA POSITION                     07250000
CODE     DS    CL4                 TRANS CODE.                          07300000
SBA2     DS    CL3                 2ND SBA                              07350000
PGRM     DS    CL4                 PROGRAM NAME.                        07400000
SBA3     DS    CL3                 3RD SBA.                             07450000
FLP      DS    CL15                FIRST/LAST/PREVIOUS IF BLOWUP RQST.  07500000
SBA4     DS    CL3                 4TH SBA.                             07550000
BUX      DS    CL4                 X FOR BLOWUP REQUEST.                07600000
TIOITEM  DS    CL5                 ITEM ADDRESS TO BLOWUP.              07650000
         ORG   FLP                                                      07700000
         DS    C                   FOR FORWARD AND BACKWARD PAGE REQ XH 07750000
         DS    CL3                 ALTERNATE POSN FOR 4TH SBA           07800000
TIOFIRST DS    CL5                 BLK & SLT 1ST ITEM ON SCREN.         07850000
TIOLAST  DS    CL5                 BLK & SLT FOR LAST                   07900000
TIOPREV  DS    CL5                 BLK & SLT 1ST ITEM PREVIOUS SCREEN.  07950000
         DS    CL3                 5TH SBA                              08000000
RTNX     DS    C                   X FOR RETURN FROM BLOWUP             08050000
BNGTDISP DSECT                                                          08100000
         DS    4F                                              @OZ30675 08150007
         USING EMFILE,3                                        @OZ30675 08200007
EMFILE DCB DDNAME=EMFILE,DSORG=DA,MACRF=(RIC),OPTCD=R,                 X08950000
               RECFM=F                                                  09000000
SAVREG   DS    A                   RETURN SAVE AREA ADDRESS             09050000
SAVAREA  DS    18F                 DEMFDISP SAVE AREA                   09100000
TCAFCAAA DS    A                                                        09150000
TCTTEDA  DS    A                   ADDRESS OF PASSED FIELD              09200000
TCAPCPI  DC    CL8'00'    SYMBOLIC PROGRAM NAME TO LINK TO              09250000
TCAFCAA  DS    A                   FILE I/O AREA ADDRESS                09300000
         DS    0H                                                       09350000
TWAAREA  EQU   *        START OF TRANSACTION WORK AREA PAASE PARMS      09400000
PARM1    DS    D                   1ST INPUT FIELD.                     09450000
PARM2    DS    D                   2ND INPUT FIELD.                     09500000
PARM3    DS    D                   3RD INPUT FIELD.                     09550000
PARM4    DS    D                   4TH INPUT FIELD.                     09600000
PARM5    DS    D                   5TH INPUT FIELD.                     09650000
PARM6    DS    D                   6TH INPUT FIELD.                     09700000
TWASBAS  DS    PL1                 COUNT OF SBA'S IN INPUT MSG.         09750000
TWAREL   DS    CL3                 FILE CONTROL RELATIVE BLK ADDR.      09800000
         DS    CL3            SAVE AREA FOR LINE/CTRLREL BLOCK NO.      09850000
DUBLWD   DS    D                   WORK AREA                            09900000
TWATIOA  DS    F                   SAVE INPUT ADDRESS.                  09950000
TWATCTID DS    F                   SAVE TERML ID.                       10000000
TWASLOT  DS    F                   SLOT COUNTER.                        10050000
SAVE14   DS    F                   SAVE AREA.                           10100000
TWAOUT   DS    F                   SAVE OUTPUT HDR ADDR                 10150000
LINESZ   DS    H                   LINE SIZE (3277 MOD 1 OR MOD 2)      10200000
LINELOOP DS    H                   NBR LINE ITEMS PER LINESZ.           10250000
OUTSWCH  DS    C                                                        10300000
HXLINLIB DS    0CL6                LINE ADDRESS INCLUDING               10350000
         DS    C                                                        10400000
HEXLINE  DS    CL2                                                      10450000
HEXLIB   DS    CL3                                                      10500000
HEXCTRL  DS    C                   CTRL UNIT POLL CHAR.                 10550000
HEXTERM  DS    C                   TERML POLL CHAR.                     10600000
NEWFIRST DS    CL5                 SAVE AREA FOR OLD BLK & SLOT NBR.    10650000
NEWPREV  DS    CL5                 SAVE AREA FOR OLD BLK & SLOT NBR.    10700000
BITFIRST DS    CL5                 SAVE AREA FOR FIRST BLK & SLOT NBR.  10750000
BITLAST  DS    CL5                 SAVE AREA FOR LAST  BLK & SLOT NBR.  10800000
BITPREV  DS    CL5                 SAVE AREA FOR PREV  BLK & SLOT NBR.  10850000
        CNOP   0,4                                                      10900000
*                             IF 2ND SBA = L1P7                         10950000
         ORG   PARM6+X'70'         JUMP PAST DEMFDISP WORK AREA         11000000
WORK15   DS    CL5                                                      11050000
WORK16   DS    CL5                                                      11100000
         DS    CL6                                                      11150000
         DC    C'FILE I/O AREA'                                         11200000
         CNOP  0,4                                                      11250000
         USING *,FIOABAR                                                11300000
DFHFIOA  DS    0H      FILE I/O AREA ADDRESS                            11350000
FIOADBA  DC    4096X'00'        FILE INPUT AREA                         11400000
ENDDATA  DC    X'FFFFFFFF'     MARK END OF DATA                         11450000
         ORG   ENDDATA+8                                                11500000
PROGSTRT EQU   *                                                        11550000
         ORG   FIOADBA                                                  11600000
CTRLLAST DS    F                   LAST USED ADDR IN DATASET            11650000
CTRLTOTL DS    F                   TOTAL BLOCKS IN DATASET              11700000
CTRLBACK DS    F                   BACKWARD PTR IN CTRL BLK CHAIN       11750000
CTRLFWD  DS    F                   FORWARD PTR IN CTRL BLK CHAIN        11800000
CTRLENTS DS    C                   NBR ENTRIES IN THIS CTRL BLK         11850000
         DS    CL15                FOR FUTURE USE                       11900000
CTRLSLT1 DS    0C                  START OF CTRL SLOT NBR ONE.          11950000
         ORG  FIOADBA                                                   12000000
DATAPORT DS    CL6                 PORT & LIB ADDR                      12050000
DATATIME DS    CL4                 TIME BLOCK CREATED                   12100000
DATADATE DS    CL4                 DATE BLOCK CREATED                   12150000
DATAFWD  DS    CL3                 FORWARD CHAIN ADDR                   12200000
DATABACK DS    CL3                 BACKWAD CHAIN ADDR                   12250000
BLKLTH   DS    CL2                 NBR BYTES USED IN THIS BLOCK         12300000
         DS    CL10                                                     12350000
DATASLT1 DS    0C                  START OF 1ST DATA SLOT               12400000
DATASLOT DSECT                                                          12450000
         USING *,DATAREG                                                12500000
DATALTH  DS    C                   LTH OF THIS SLOT                     12550000
LINEID   DS    CL6                 LINE AND LIB ADDR                    12600000
ENTRYTYP DS    C                   ENTRY TYPE - MDR OR OBR              12650000
         DS    CL3                                                      12700000
MDRTYPE  DS    C                   TYPE HDWE - 03 EQUALS 3270           12750000
         DS    CL3                                                      12800000
DATE     DS    CL4                 DATE OF ERROR - 00YY0DDF             12850000
TIME     DS    CL4                 TIME OF ERROR - HHMMSSHH             12900000
         DS    CL8                                                      12950000
MDRCUA   DS    CL2                 MDR CHAN & UNIT ADDR                 13000000
MDRCTRL  DS    C                   MDR CTRL UNIT POLL ADDR              13050000
MDRTERM  DS    C                   MDR TERMIL POLL ADDR                 13100000
MDRSTATS DS    CL2                 REMOTE 3270 STATUS                   13150000
         DS    CL2                                                      13200000
OBRCCW   DS    CL8                 LAST CCW EXECUTED                    13250000
OBRCSW   DS    CL8                 CHANNEL STATUS WORD                  13300000
OBRDVDEP DS    CL1                                                      13350000
         DS    CL5                                                      13400000
OBRUCB   DS    C                                                        13450000
         DS    CL1                                                      13500000
OBRSDR   DS    CL1                 NUMBER BYTES OF STATICAL DATA        13550000
         DS    CL1                                                      13600000
OBRCUA   DS    CL2                 OBR CHAN & UNIT ADDR                 13650000
OBRPOLL  DS    CL2                 POLL CHAR                            13700000
         DS    CL12                                                     13750000
OBRSENSE DS    CL2                 OBR SENSE BYTES                      13800000
         ORG   DATALTH                                                  13850000
CTRLPORT DS    CL6                 PORT & LIB ADDRESS                   13900000
         DS    CL4                                                      13950000
CTRLFRST DS    CL3                 REL BLK ADDR 1ST BLK IN CHAIN.       14000000
         DS    CL3                                                      14050000
SLOTLTH  EQU   *-CTRLPORT                                               14100000
BNGT3270 CSECT                                                          14150000
         SAVE  (14,12)       SAVE CALLERS REGISTER                      14200000
         BALR  BASE1,0                                                  14250000
         USING *,BASE1,BASE2                                            14300000
BNGC3270 BNGHJN SKIPID                                         @OZ30478 14320007
         LA    BASE2,2048(BASE1)   SETUP PROGRAM BASE REGS.             14350000
         LA    BASE2,2048(BASE2)                                        14400000
A0000    ST    13,SAV3270R                                              14550000
         LA    13,SAV3270A                                              14600000
         L     TIOABAR,TCTTEDA     POINT TO TIOA INPUT AREA.            14650000
         L     FIOABAR,TCAFCAA  INITIALIZE FILE REG TO POINT FILE AREA  14700000
         OPEN  (EMFIL1,(INPUT))                                         14750000
         CP    TWASBAS,=P'2'       WERE LESS THAN 2 FIELDS INPUT?       14800000
         BNL   J010                NO. GO EXAMINE INPUT FURTHER.        14850000
A010     XC    TWAREL,TWAREL       YES. THIS IS A NEW RECAP REQUEST.    14900000
         CLC   PARM3(3),=C'ALL'    IF PARM 3 IS ONE OF THE DEMF         14950000
         BE    A140                DISPLAY CODES, THIS INPUT WAS FROM   15000000
         CLC   PARM3(4),=C'CTRL'          FORMATTED SCREEN.             15050000
         BE    A140                ZERO IT OUT AND TRY AGAIN.           15100000
         CLC   PARM3(4),=C'LINE'                                        15150000
         BE    A140                                                     15200000
         CLC   PARM3(4),=C'3270'                                        15250000
         BE    A140                                                     15300000
         CLC   PARM4(3),=C'ALL'                                         15350000
         BE    A130                                                     15400000
         CLC   PARM4(4),=C'CTRL'                                        15450000
         BE    A130                                                     15500000
         CLC   PARM4(4),=C'LINE'                                        15550000
         BE    A130                                                     15600000
         CLC   PARM4(4),=C'3270'                                        15650000
         BE    A130                                                     15700000
         CLC   PARM5(3),=C'ALL'                                         15750000
         BE    A120                                                     15800000
         CLC   PARM5(4),=C'CTRL'                                        15850000
         BE    A120                                                     15900000
         CLC   PARM5(4),=C'LINE'                                        15950000
         BE    A120                                                     16000000
         CLC   PARM5(5),=C'3270'                                        16050000
         BE    A120                                                     16100000
         OC    PARM3,PARM3         WAS LINE ID INPUT?                   16150000
         BNZ   B140                YES. GO SEARCH CTRL BLK FOR IT.      16200000
****************************************************************        16250000
*  THIS CODE INSERTS LINE, CTRL AND TERMINAL ADDRESS OF THE    *        16300000
*  TERMINAL OF THE USER IF HE ENTERS ONLY DEMF 3270                     16350000
****************************************************************        16400000
         MVC   DUBLWD+5(3),TCTLERLN     MOVE LINE ADDRESS TO WORK       16450000
         TR    DUBLWD,EBTOHX                 TR LINE ADDRESS            16500000
         PACK  DUBLWD(3),DUBLWD+5(4)        PACK IT                     16550000
         MVC   HEXLINE,DUBLWD        MOVE IT TO BE USED LATER           16600000
         MVC   HEXCTRL,TCTTETA                 MOVE IN CTRL UNIT        16650000
         MVC   HEXTERM,TCTTETA+1         MOVE IN TERMINAL ADDRESS       16700000
         MVC   PARM3(3),TCTLERLN             MOVE IN LINE NUMBER        16750000
         MVI   TCTLERLN,X'FF'      IND TO BNGTQEMF TCAMID SHOULD BE INS 16800000
         CLI   TCTTETT,X'99'            IS THIS A LOCAL 3270            16850000
         BE    D079                     YES,BR NOT CTRL AOR TERM ADR    16900000
         UNPK  DUBLWD,TCTTETA(2)                                        16950000
         TR    DUBLWD,HXTOEB                                            17000000
         MVC   PARM4(2),DUBLWD+5    MOVE IN CTRL ADDRESS                17050000
         UNPK  DUBLWD,TCTTETA+1(2)                                      17100000
         TR    DUBLWD,HXTOEB                                            17150000
         MVC   PARM5(2),DUBLWD+5       MOVE IN TERMINAL ADDRESS         17200000
         B     D079                                                     17250000
******************                                                      17300000
* THIS SECTION OF CODE SHOULD NOT BE ENTERED AS  SYMBOLIC               17350000
*    ADDRESS FOR TCAM DEMF ARE NOT SUPPORTED                            17400000
****************                                                        17450000
A120     XC    PARM5,PARM5                                              17500000
         B     A010                                                     17550000
A130     XC    PARM4(16),PARM4                                          17600000
         B     A010                                                     17650000
A140     XC    PARM3(24),PARM3     ZERO OUT PARMS 3, 4, AND 5.          17700000
         B     A010                                                     17750000
*                                                                       17800000
* AT THIS POINT, IF NO INPUT LINE/CTRL/TERM WAS SPECIFIED, THE          17850000
* ADDRESS PERTAINING TO THE REQUESTOR'S TERMINAL HAS BEEN PLACED        17900000
* IN THE INPUT PARMS AS IF THEY HAD BEEN KEYED IN.                      17950000
*                                                                       18000000
B140     MVC   DUBLWD+5(3),PARM3                                        18050000
         TR    DUBLWD,EBTOHX            GET LINE,                       18100000
         PACK  DUBLWD(3),DUBLWD+5(4)    CONTROL UNIT,                   18150000
         MVC   HEXLINE,DUBLWD           AND                             18200000
         MVC   DUBLWD+5(3),PARM4        TERMINAL                        18250000
         TR    DUBLWD,EBTOHX            ADDRESS                         18300000
         PACK  DUBLWD(2),DUBLWD+5(3)    INTO HEX                        18350000
         MVC   HEXCTRL,DUBLWD           FORMAT                          18400000
         MVC   DUBLWD+5(3),PARM5        FOR COMPARING                   18450000
         TR    DUBLWD,EBTOHX            TO DATA IN                      18500000
         PACK  DUBLWD(2),DUBLWD+5(3)    DISK FILE.                      18550000
         MVC   HEXTERM,DUBLWD                                           18600000
D079     ST    TIOABAR,TWATIOA     SAVE ADDR OF ORIGINAL INPUT AREA.    18650000
         BAL   LINKREG,GETTIOA     SETUP NEW OUTPUT AREA WITH HDRS.     18700000
D080     MVC   FILREC,TWAREL                                            18750000
         READ  ECB1,DI,EMFIL1,(6),4096,0,FILREC                         18800000
         CHECK ECB1                                                     18850000
         B     D190    BRANCH AROUND I/O ERRRO RTNE                     18900000
F1900    MVC   TIOADBAO(IOERRLTH),IOERRMSG                              18950000
         MVC   TIOATDL,=AL2(IOERRLTH)                                   19000000
         UNPK  DUBLWD,TWAREL(4)         SETUP I/O ERROR MSG WITH        19050000
         TR    DUBLWD,HXTOEB            BLOCK NBR THAT                  19100000
         MVC TIOADBAO+(IOBLOCK-IOERRMSG)(6),DUBLWD+1  WAS BEING READ,   19150000
         LR    R8,R0               DECB ADR IN R8                       19200000
         USING DECB,R8                                                  19250000
         UNPK  DUBLWD,EXCPBITS(3)       AND THE BDAM FILE               19300000
         DROP  R8                                                       19350000
         TR    DUBLWD,HXTOEB            EXCEPTION RETURN CODE.          19400000
         MVC   TIOADBAO+(IOCODE-IOERRMSG)(4),DUBLWD+3                   19450000
D170     CLOSE EMFIL1                                                   19500000
         L     13,SAV3270R                                              19550000
         RETURN  (14,12)                                                19600000
D190     L     FIOABAR,TCAFCAA     POINT TO FILE I/O AREA.              19650000
         SR    DATALOOP,DATALOOP   SETUP TO LOOP ON NBR OF              19700000
         IC    DATALOOP,CTRLENTS   ENTRIES IN THIS CNTRL BLK.           19750000
         LTR   DATALOOP,DATALOOP   VERIFY THAT THE DATA SET             19800000
         BNZ   E030                IS NOT EMPTY.                        19850000
         B     Z50                                                      19900000
E030     LA    DATAREG,CTRLSLT1    POINT TO FIRST CTRL SLOT.            19950000
E040     OC    PARM4,PARM4         WAS A CTRL UNIT ADDR INPUT?          20000000
         BNZ   E110                YES. LINE ID IS CORRECT.             20050000
         XC    DUBLWD,DUBLWD       NO. THIS MUST BE RQST FOR LOCAL.     20100000
         MVC   DUBLWD(3),HXLINLIB  ROUND CUA ADDR DOWN                  20150000
         NI    DUBLWD+2,B'11100000'     TO EVEN CHAN ADDR.              20200000
         CLC   DUBLWD(6),CTRLPORT       LOOK FOR EQUAL LINE ADDRESS.    20250000
         B     E120                                                     20300000
E110     CLC   HXLINLIB,CTRLPORT   IS THIS SLOT = RQSTD LINE ADDR?      20350000
E120     BE    E200                YES. GO READ ITS DATA BLOCK.         20400000
         LA    DATAREG,SLOTLTH(DATAREG)  NO. BUMP TO NEXT CTRL SLOT.    20450000
         BCT   DATALOOP,E040            MORE SLOTS TO LOOK AT?          20500000
         OC    CTRLBACK,CTRLBACK        NO. IS THERE ANOTHER CTRL BLK?  20550000
         BZ    Z50                 NO. SEND 'NO ERRS' MSG.              20600000
         MVC   TWAREL,CTRLBACK+1        YES. SAVE NEXT BLOCK ADDR.      20650000
         B     D080                                                     20700000
E200     MVC   TWAREL,CTRLFRST     MOVE DATA BLOCK ADDR.                20750000
         OC    TWAREL,TWAREL       IS THERE ANY DATA BLOCKS ?  @OZ31884 20760007
         BZ    T190                NO, WRITE 'NO DATA BLKS MSG'@OZ31884 20770007
F020     MVC   FILREC,TWAREL        ALIGN AND MKE RELOCATABLE           20800000
         READ  ECB2,DI,EMFIL1,(6),4096,0,FILREC                         20850000
         CHECK ECB2                                                     20900000
F050     L     FIOABAR,TCAFCAA     POINT TO DATA BLOCK.                 20950000
         XC    TWASLOT,TWASLOT     INITIALIZE SLOT COUNT TO 1.          21000000
         LH    DATALOOP,BLKLTH     SETUP TO LOOP ON NBR BYTES IN REC.   21050000
         LA    DATAREG,DATASLT1    POINT TO FIRST DATA ITEM.            21100000
F080     DS    0H                                                       21150000
         L     R15,TWASLOT         ADD 1 TO SLOT COUNT.                 21200000
         LA    R15,1(R15)      ADD ONE TO REG                           21250000
         ST    R15,TWASLOT                                              21300000
         CLI   ENTRYTYP,X'91'      IS THIS ENTRY AN MDR RECORD?         21350000
         BNE   H060                NO. TEST FURTHER.                    21400000
         CLI   MDRTYPE,X'03'       YES. IS IT A 3270?                   21450000
         BE    G060                YES. TEST FURTHER.                   21500000
F120     SR    R1,R1               NO. BUMP                             21550000
         IC    R1,0(DATAREG)     TO NEXT DATA ITEM.                     21600000
         LTR   R1,R1               PRECENT ENDLESS LOOP                 21650000
         BZ    F240                IN CASE GARBAGE IN RECORD.           21700000
         AR    DATAREG,R1                                               21750000
         SR    DATALOOP,R1         ALL DONE WITH THIS BLOCK?            21800000
         LTR   DATALOOP,DATALOOP                                        21850000
         BP    F080                NO. PROCESS NEXT ITEM.               21900000
         OC    DATAFWD,DATAFWD     YES. IS THERE ANOTHER BLOCK?         21950000
         BZ    F240                NO. GO WIND UP OUTPUT.               22000000
         MVC   TWAREL,DATAFWD      YES. GET CHAIN ADDR AND              22050000
         B     F020                GO READ NEXT BLOCK.                  22100000
F240     CLI   OUTSWCH,X'FF'       WAS ANY OUTPUT CREATED?              22150000
         BNE   Z50                 NO. SEND 'NO ERRS' MSG.              22200000
G020     LA    1,TIOADBAO           YES. COMPUTE                        22250000
         SR    OUTREG,1            TOTAL DATA LTH.                      22300000
         STH   OUTREG,TIOATDL                                           22350000
         B     D170                GO TRANSMIT DISPLAY.                 22750000
G060     CLC   MDRCTRL,HEXCTRL     IS THIS MDR FOR RQSTED CTRL UNIT?    22800000
         BNE   F120                NO. SKIP IT.                         22850000
         CLC   MDRTERM,HEXTERM     YES. IS IT FOR REQUESTED TERML?      22900000
         BNE   F120                NO. SKIP IT.                         22950000
         MVC   0(MDRLTH,OUTREG),MDRHDR   YES. SETUP BUILD 1 MDR LINE.   23000000
         UNPK  DUBLWD,MDRSTATS(3)                                       23050000
         TR    DUBLWD,HXTOEB       FILL IN REMOTE STATUS BYTES.         23100000
         MVC   (MDRSTAT-MDRHDR)(4,OUTREG),DUBLWD+3                      23150000
G100     UNPK  DUBLWD,TWAREL(4)                                         23200000
         TR    DUBLWD,HXTOEB       FILL IN THIS BLK NBR.                23250000
         MVC   (MDRBBBSS-MDRHDR)(3,OUTREG),DUBLWD+4                     23300000
         UNPK  DUBLWD,TWASLOT(5)                                        23350000
         TR    DUBLWD,HXTOEB       FILL IN THIS SLOT NBR.               23400000
         MVC   (MDRBBBSS+3-MDRHDR)(2,OUTREG),DUBLWD+5                   23450000
         L     R14,TWAOUT          POINT TO OUTPUT BBBSS FIELDS         23500000
         CLC   (BBBSS-HDR3)(5,R14),=C'BBBSS' IS 'FIRST' FILLED IN?      23550000
         BNE   G200                YES,SKIP IT                          23600000
         MVC   (BBBSS-HDR3)(5,R14),(MDRBBBSS-MDRHDR)(OUTREG) NO,DO IT.  23650000
         CLC   (BBBSS+10-HDR3)(5,R14),=C'BBBSS'  HOW ABOUT 'PREV'?      23700000
         BNE   G200                ALREADY THERE SKIP IT.               23750000
         MVC   (BBBSS+10-HDR3)(5,R14),(BBBSS-HDR3)(R14)  NO USE 'FIRST' 23800000
G200     MVC   (BBBSS+5-HDR3)(5,R14),(MDRBBBSS-MDRHDR)(OUTREG) FILL  XH 23850000
*                                                  IN 'LAST' BBBSS      23900000
         UNPK  DUBLWD,TIME                                              23950000
         MVC   (MDRHRS-MDRHDR)(2,OUTREG),DUBLWD+1   FILL IN HOURS       24000000
         MVC   (MDRMINS-MDRHDR)(2,OUTREG),DUBLWD+3     AND MINUTES.     24050000
G230     MVI   OUTSWCH,X'FF'       INDICATE SOME OUTPUT WAS CREATED.    24100000
         TIME    DEC          GET SYSTEM TIME                           24150000
         STCM  0,15,DATTIME        STORE TIME                           24200000
         STCM  1,15,DATDATE        STORE DATE                           24250000
         CP    DATE,DATDATE        DID ERROR HAPPEN TODAY?              24300000
         BE    G240                YES,BR HIGH INTENSITY                24350000
         SP    DATDATE,=P'1'       MAKE DATE YESTERDAY                  24400000
         CP    DATE,DATDATE        DID IT HAPPEN YESTERDAY              24450000
         BNE   G230A               NO,BR LEAVE INTENSITY NORMAL         24500000
         CLC   TIME,DATTIME        IS IT OLDER THAN 24 HRS?             24550000
         BNL   G240                NO,BR MAKE IT HIGH INTENSITY         24600000
G230A    LA    R1,LEAPTBL                                               24650000
G231     CLC   DATE+1(1),0(1)      SEE IF                               24700000
         BE    G232                ERROR HAPPENED                       24750000
         LA    R1,1(R1)            IN LEAP YEAR                         24800000
         CLI   0(R1),X'FF'         IS IT END OF TABLE                   24850000
         BNE   G231                NO,BR TRY NEXT YEAR                  24900000
         ZAP   CALENDAR+8(2),=P'28' NOT LEAP YEAR                       24950000
         B     G233                CONTINUE                             25000000
G232     ZAP   CALENDAR+8(2),=P'29' YES,LEAP YEAR                       25050000
G233     LA    R15,CALENDAR                                             25100000
G234     MVN   DATE+3(1),=X'0C'    MAKE SURE SIGN IS CORRECT            25150000
         CLC   DATE+2(2),3(R15)    COMPUTE MONTH                        25200000
         BNH   G235                AND DAY FROM                         25250000
         SP    DATE+2(2),3(2,R15)  DAY NUMBER                           25300000
         LA    R15,5(R15)                                               25350000
         B     G234                                                     25400000
G235     MVC   (MDRHRS-MDRHDR)(3,OUTREG),0(R15)  MOVE MONTH AND         25450000
         UNPK  (MDRMINS-MDRHDR)(2,OUTREG),DATE+2(2)   DAY TO OUTPUT     25500000
         OI    (MDRMINS+1-MDRHDR)(OUTREG),X'F0'                         25550000
         B     H030                                                     25600000
G240     MVI   1(OUTREG),PDA       YES.                                 25650000
         MVI   4(OUTREG),UHA                                            25700000
         MVI   15(OUTREG),PDA                                           25750000
H030     LA    OUTREG,MDRLTH(OUTREG)    BUMP TO NEXT OUTPUT SLOT.       25800000
         BCT   OUTLOOP,F120        MORE TIOA ROOM LEFT?                 25850000
         B     G020                NO. GO WIND UP OUTPUT.               25900000
H060     CLI   ENTRYTYP,X'91'      IS THIS ENTRY AN OBR?                25950000
         BE    F120                NO. SKIP IT.                         26000000
         CLC   OBRCUA,HEXLINE      YES. IS IT REQUESTED CUA ADDR?       26050000
         BNE   F120                NO. SKIP IT.                         26100000
         CLI   OBRUCB,X'10'        IS THIS A LOCAL                      26150000
         BE    H070                YES,BR                               26200000
         CLC   OBRPOLL(1),HEXCTRL  IS THIS OBR FOR RQSTED CTRL UNIT?    26250000
         BNE   F120                NO,SKIP IT                           26300000
         CLC   OBRPOLL+1(1),HEXTERM IS THIS OBR FOR RQSTED TERMINAL?    26350000
         BNE   F120                NO,SKIP IT                           26400000
H070     MVC   0(MDRLTH,OUTREG),MDRHDR  YES. SETUP COMMON MDR/OBR HDR.  26450000
         UNPK  DUBLWD,OBRCSW+4(3)                                       26500000
         TR    DUBLWD,HXTOEB       FILL IN CSW STATUS                   26550000
         MVC   (OBRSNS-MDRHDR)(4,OUTREG),DUBLWD+3                       26600000
         UNPK  DUBLWD,OBRSENSE(3)                                    XH 27050000
         TR    DUBLWD,HXTOEB       FILL IN SENSE BYTES.                 27100000
         MVC   (MDRSTAT-MDRHDR)(4,OUTREG),DUBLWD+3                   XH 27150000
         NI    OBRCCW+5,X'3F'      CLEAN UP TP OP CODE.                 27200000
         UNPK  DUBLWD,OBRCCW+5(2)                                       27250000
         TR    DUBLWD,HXTOEB       FILL IN TP OP CODE.                  27300000
         MVC   (OBRTPOP+1-MDRHDR)(2,OUTREG),DUBLWD+5                    27350000
         MVI   (OBRTPOP-1-MDRHDR)(OUTREG),C'B'                          27400000
         CLI   ENTRYTYP,TCAMOBR    IS THIS A TCAM OBR?                  27450000
         BNE   J005                NO, LEAVE 'B' FOR BTAM               27500000
         MVI   (OBRTPOP-1-MDRHDR)(OUTREG),C'T'    T=TCAM                27550000
J005     UNPK  DUBLWD,OBRCCW(2)                                         27600000
         TR    DUBLWD,HXTOEB       FILL IN CHANL COMMAND.               27650000
         MVC   (OBRCMD-MDRHDR)(2,OUTREG),DUBLWD+5                       27700000
         B     G100                GO FILL IN DATA COMMON TO MDR/OBR.   27750000
J010     CLC   TIOADBA+8(2),=AL2(L1P7)  IS SECOND FIELD LINE 1 POSN 7?  27800000
         BE    A010                YES. THIS IS NEW INPUT.              27850000
         CLC   TIOADBA+8(2),=AL2(L6P26) IS SECOND FIELD L2P26 FROM MENU 27900000
         BE    A010                YES,BR THIS IS NEW INPUT             27950000
         LA    R14,TIOADBA         SCAN THE INPUT TO SEE                28000000
J020     CLI   0(R14),C'%'         IF THE SPECIAL CHAR                  28050000
         BE    J140                '%" IS PRESENT WHICH                 28100000
         CLI   0(R14),X'00'        WAS PUT OUT BY THE BLOWUP            28150000
         BE    J050                ROUTINE TO INDICATE A                28200000
         LA    R14,1(R14)          ROUTINE FROM BLOWUP.                 28250000
         B     J020                                                     28300000
J050     CLC   PARM3(5),=C'BBBSS'  IF NO FIELDS WERE SELECTED, GO TO    28350000
         BE    S190                    INVALID INPUT REQUEST.           28400000
         CLC   PARM4(4),=C'PAGE'   IS THIS A 'PAGE' REQUEST?            28450000
         BNE   L160                NO. MUST BE 'BLOWUP' REQUEST.        28500000
         CLC   TIOFIRST,=C'BBBSS'  WAS A GOOD DISPLAY ON SCREEN?        28550000
         BE    S190                    NO. TRIED TO PAGE FROM NO-ERRS   28600000
         CP    TWASBAS,=P'4'       YES. IS IT RETURN FROM BLOWUP?       28650000
         CLC   19(2,R14),=X'C1D3'       PAGE REQUEST           @OZ30478 28700007
         BE    ALTBBB                   YES, POINT TO NEXT FLD @OZ30478 28702007
         CLC   19(2,R14),=X'C17B'       PAGE BKWRD LARGE SCREEN@OZ30478 28704007
         BE    ALTBBB                   YES, POINT TO NEXT FLD @OZ30478 28706007
         CLC   19(2,R14),=X'406B'       PAGE FRWRD SMALL SCREEN@OZ30478 28708007
         BE    ALTBBB                   YES, POINT TO NEXT FLD @OZ30478 28710007
         B     PTOK                     NO, POINTER IS OK      @OZ30478 28712007
ALTBBB   CLC   PARM5(7),=C'FORWARD'     IS IT PAGE FORWARD     @OZ30478 28714007
         BNE   J191                     NO, MUST BE BACKWARD   @OZ30478 28716007
         MVC   NEWFIRST,TIOLAST+4       OLD LAST TO NEW FIRST  @OZ30478 28718007
         MVC   NEWPREV,TIOFIRST+4       OLD FIRST TO NEW PREV  @OZ30478 28720007
         TR    TIOLAST+4,EBTOHX         TRANSLATE OLD LAST     @OZ30478 28722007
         PACK  DUBLWD,TIOLAST+4(6)      INTO HEX               @OZ30478 28724007
         B     J110                     CONTINUE               @OZ30478 28726007
J191     MVC   NEWFIRST,TIOPREV+4       OLD PREV TO NEW FIRST  @OZ30478 28728007
         MVC   NEWPREV,TIOPREV+4        OLD PREV TO NEW PREV   @OZ30478 28730007
         TR    TIOPREV+4,EBTOHX         TRANSLATE OLD PREV     @OZ30478 28732007
         PACK  DUBLWD,TIOPREV+4(6)      INTO HEX               @OZ30478 28734007
         B     J110                     CONTINUE               @OZ30478 28736007
PTOK     EQU   *                                               @OZ30478 28738007
         CLC   PARM5(7),=C'FORWARD'  NO. IS IT PAGE FORWARD?            28750000
         BNE   J190                NO. MUST BE PAGE BACKWARD.           28800000
         MVC   NEWFIRST,TIOLAST    YES. PROMOTE LAST & FIRST FROM OLD   28850000
         MVC   NEWPREV,TIOFIRST    SCREEN TO NEW FIRST & PREVIOUS.      28900000
         TR    TIOLAST,EBTOHX                                           28950000
         PACK  DUBLWD,TIOLAST(6)   GET OLD 'LAST' BLK & SLOT IN HEX.    29000000
J110     MVC   TWAREL,DUBLWD+3     SETUP TO READ APPROPRIATE BLK.       29050000
         MVC   TWASLOT(1),DUBLWD+6  SETUP TO LOCATE APPROPRIATE SLOT.   29100000
         B     K010       GO READ BLK WHERE DISPLAY WILL RESUME.        29150000
J140     SH    R14,=H'18'          BACKUP TO BBBSS FIELD                29200000
         MVC   BITFIRST(15),0(R14) ALIGN IT IN CASE NO PAGE ENTERED  XH 29250000
         MVC   NEWFIRST,BITFIRST   RESTORE OLD 'FIRST' & 'PREVIOUS'  XH 29300000
         MVC   NEWPREV,BITPREV     AS NEW 'FIRST' & 'PREVIOUS'       XH 29350000
         TR    BITFIRST,EBTOHX                                       XH 29400000
         PACK  DUBLWD,BITFIRST(6)  GET OLD 'FIRST' ADDR & SLOT IN HEXXH 29450000
         B     J110                                                     29500000
J190     MVC   NEWFIRST,TIOPREV    OLD 'PREVIOUS' NOW BECOMES NEW       29550000
         MVC   NEWPREV,TIOPREV     'PREVIOUS' AND 'FIRST'               29600000
         TR    TIOPREV,EBTOHX                                           29650000
         PACK  DUBLWD,TIOPREV(6)   GET OLD 'PREVIOUS' IN HEX.           29700000
         B     J110                                                     29750000
K010     BAL   LINKREG,LOCATE      LOCATE SLOT TO RESUME AT.            29800000
         XC    PARM4(16),PARM4     ZERO OUT INPUT PARMS.                29850000
         CLI   ENTRYTYP,X'91'      IS THIS AN MDR?                      29900000
         BE    K020                YES,LINE ADDRESS IS OK               29950000
         XC    HXLINLIB,HXLINLIB   NO,DON'T USE ROUNDED DOWN ADDR       30000000
         MVC   HXLINLIB+1(2),OBRCUA   GET ACTUAL CUA INSTEAD            30050000
         B     K030                                                     30100000
K020     MVC   HXLINLIB,LINEID                                          30150000
K030     UNPK  DUBLWD,HEXLINE(3)   RESTORE LINE NBR FROM DATA           30200000
         TR    DUBLWD,HXTOEB       BLOCK AS IF IT HAD BEEN KEYED IN.    30250000
         MVC   PARM3(3),DUBLWD+4                                        30300000
         CLI   ENTRYTYP,X'91'      IS THIS AN MDR RECORD?               30350000
         BE    K040                YES,PUT IN POLL CHARRS.              30400000
         CLI   OBRUCB,X'10'        IS THIS A LOCAL                      30450000
         BE    L110                YES,BR NO POLL CHARS                 30500000
         MVC   HEXCTRL,OBRPOLL     MOVE CNTRL UNIT ADDR                 30550000
         MVC   HEXTERM,OBRPOLL+1   MOVE TERMINAL ADDR                   30600000
         B     K050                                                     30650000
K040     MVC   HEXCTRL,MDRCTRL     YES.                                 30700000
         MVC   HEXTERM,MDRTERM     RESTORE CTRL UNIT ADDR               30750000
K050     UNPK  DUBLWD,HEXCTRL(3)   AND TERMINAL ADDR                    30800000
         TR    DUBLWD,HXTOEB       AS IF THEY HAD                       30850000
         MVC   PARM4(2),DUBLWD+3   BEEN KEYED IN.                       30900000
         MVC   PARM5(2),DUBLWD+5                                        30950000
L110     BAL   LINKREG,GETTIOA     SETUP OUTPUT AREA WITH HEADERS.      31000000
         L     R15,TWAOUT                                               31050000
         MVC   (BBBSS-HDR3)(5,R15),NEWFIRST FINISH HEADER WITH ADDR     31100000
         MVC   (BBBSS+10-HDR3)(5,R15),NEWPREV  OF FIRST & PREVIOUS BLK. 31150000
         B     F080                GO BUILD ANOTHER PAGE.               31200000
L160     CLC   PARM2(4),=C'TERM'     IS THIS COMPANION INPUT?           31250000
         BE    L200                YES. GO HUNT FOR CTRL & LINE ADDR.   31300000
**       FOLLOWING TEN  INSTRUCTIONS CHECK IF A FIELD WAS X'ED   33333  31350000
**       ON A BLOWUP REQUEST                                     33333  31400000
         MVC   WORK15,TIOITEM      MOVE XED FIELD TO WORK AREA   33333  31450000
         TR    WORK15,EBTOHX       TRANS TO HEX                  33333  31500000
         MVC   WORK16,FLP          MOVE FIRST BBBSS TO WORK AREA 33333  31550000
         TR    WORK16,EBTOHX       TRANSLATE TO HEX              33333  31600000
         MVC   WORK16,FLP+5        MOVE LAST BBBSS TO WORK ARE   33333  31750000
         TR    WORK16,EBTOHX       TRANSLATE TO HEX              33333  31800000
         TR    TIOITEM,EBTOHX      OK. GET REQUESTED ITEM ADDR.         31950000
         PACK  DUBLWD,TIOITEM(6)        AND SLOT NUMBER.                32000000
         MVC   TWAREL,DUBLWD+3          INTO HEX.                       32050000
         MVC   TWASLOT(1),DUBLWD+6                                      32100000
         BAL   LINKREG,LOCATE      LOCATE APPROPRIATE SLOT IN DATA BLK. 32150000
** INITIALIZE I/O AREA                                                  32200000
** TO ALL 40'S SO THAT BLOW UP WILL FORMAT PROPERLY                     32250000
         ST    DATALOOP,R8SAVE     SAVE REGISTER EIGHT                  32300000
         LA    0,TIOADBAO          FIELD ADDRESS TO BE CLEARED          32350000
         LA    1,2000              LENGTH OF FIELD TO BE CLEARED        32400000
         L     REG9,=X'40000001'  LENGTH AND PADDING CHARACTER          32450000
         LA    DATALOOP,FORTY      PLACE 40'S IN INITIALIZED AREA       32500000
         MVCL  0,DATALOOP          MOVE CHARACTER TO FIELD              32550000
         L     DATALOOP,R8SAVE     RESTORE REGISTER EIGHT               32600000
**    END OF STORAGE INITAILIZATION CODE                                32650000
         LA    TIOABAR,TIOADBAO    RELOAD OUTPUT AREA                   32700000
         ST    TIOABAR,TCTTEDA     FOR THE BLOWUP DISPLAY.              32750000
         XC    P,P                 CLEAR AREA                           32800000
         CLI   ENTRYTYP,BTAMOBR    IS THIS A OBR?                       32850000
         BE    L161                YES,BR HANDLE OBR                    32900000
         CLI   ENTRYTYP,TCAMOBR    IS THIS A TCAM OBR                   32950000
         BE    L161                YES,BR WILL ONLY HAVE LINE ADR       33000000
         UNPK  P3(4),DATAPORT+1(3) MOVE LINE ADR FROM RECORD            33050000
         MVI   P3+3,X'00'                                               33100000
         TR    P3,HXTOEB           PUT IT IN DISPLAY FORMAT             33150000
         UNPK  P4(3),MDRCTRL(2)    NO,GET CTRL UNIT POLL CHAR           33200000
         MVI   P4+2,X'00'                                               33250000
         TR    P4,HXTOEB           PUT IT IN DISPLAY FORMAT             33300000
         UNPK  P5(3),MDRTERM(2)    GET TERMINAL POLL CHAR               33350000
         MVI   P5+2,X'00'                                               33400000
         TR    P5,HXTOEB           PUT IT IN DISPLAY FORMAT             33450000
         B     L162                                                     33500000
L161     UNPK  P3(4),OBRCUA(3)     GET  LINE ADR FROM MDR RECORD        33550000
         MVI   P3+3,X'00'                                               33600000
         TR    P3,HXTOEB           PUT IT IN DISPLAY FORMAT             33650000
         CLI   OBRUCB,X'10'        IS THIS A LOCAL                      33700000
         BE    L162                YES,BR NO POLLING CHARS              33750000
         UNPK  P4(3),OBRPOLL(2)    GET CNTRL UNIT POLL CHARS            33800000
         MVI   P4+2,X'00'                                               33850000
         TR    P4,HXTOEB           PUT IT IN DISPLAY FORMAT             33900000
         UNPK  P5(3),OBRPOLL+1(2)  GET TERMINAL POLL CHARS              33950000
         MVI   P5+2,X'00'                                               34000000
         TR    P5,HXTOEB                                                34050000
L162     EQU   *                                                        34100000
         MVC   TIOADBAO(HDR1LTH),HDR1         SET UP                    34150000
         MVC   TIOADBAO+HDR1LTH(4),=C'3270'   FIRST LINE HEADER         34200000
         LA    OUTREG,TIOADBAO+HDR1LTH+4      BUMP OUTPUT ADDRESS       34250000
         CLI   TCTTETM,C'2'        IS THIS A MODEL TWO SCREEN           34300000
         BNE   L163                                                     34350000
         MVC   0(3,OUTREG),HDR2    YES,ADD ANOTHER SBA                  34400000
         LA    OUTREG,3(OUTREG)    THIS 80 CHAR SCREEN                  34450000
L163     MVC   0(HDR3LTH,OUTREG),HDR3     MOVE PAGE REQUEST LINE        34500000
         MVC   (BBBSS-HDR3)(15,OUTREG),TIOADBA+17 MOVE BBBSS            34550000
         LA    OUTREG,HDR3LTH(OUTREG)     BUMP OUTREG ADDRESS           34600000
         MVC   0(HDR4LTH,OUTREG),HDR4     MOVE THE RECAP LINE HDR       34650000
         OC    P5,P5               IS THERE A TERMINAL ADDRESS          34700000
         BZ    L165                NO,BR TO SHOW ONLY LINE ADR          34750000
         MVC   (HDR4TERM-HDR4)(2,OUTREG),P5    FILL IN THE              34800000
         MVC   (HDR4CTRL-HDR4)(2,OUTREG),P4    ID OF THIS TERMINAL      34850000
         MVC   (HDR4LINE-HDR4)(3,OUTREG),P3    CTRL UNIT AND LINE       34900000
L164     CLI   TCTTETM,C'2'        IS THIS SCREEN A MODEL 2?            34950000
         BE    M060                YES. MOVE APPROPRIATE HEADER.        35000000
         MVC   TIOADBAO+152(BUHDR1LT),BUHDR1   NO. MOVE MODEL 1 BLOWUP  35050000
         LA    OUTREG,TIOADBAO+BUHDR1LT+152  POINT TO NEXT BYTE OF OUTA 35100000
         B     M080                                                     35150000
L165     MVC   8(6,OUTREG),=C'LOCAL '   SO CHANGE HEADER TO             35200000
         MVC   14(3,OUTREG),P3          LOCAL FORMAT                    35250000
         MVC   17(24,OUTREG),=24C' '    BLANK OUT REST OF LINE          35300000
         B     L164                                                     35350000
L200     TR    PARM3,EBTOHX        PARM3 IS BBBSS OF CTRL UNIT DISPLAY. 35400000
         PACK  DUBLWD,PARM3(6)     GET ITS BLK & SLT IN HEX.            35450000
         MVC   TWAREL,DUBLWD+3                                          35500000
         MVC   TWASLOT(1),DUBLWD+6                                      35550000
         BAL   LINKREG,LOCATE      LOCATE BLK & SLOT OF PREVIOUS DISPLY 35600000
         XC    PARM3,PARM3         ERASE BBBSS GARBAGE.                 35650000
         UNPK  PARM3(4),DATAPORT+1(3)   MOVE LINE ADDR FROM RECORD.     35700000
         MVI   PARM3+3,X'00'                                            35750000
         TR    PARM3,HXTOEB        MAKE IT LOOK LIKE IT WAS KEYED IN.   35800000
         XC    PARM4,PARM4                                              35850000
         CLI   ENTRYTYP,X'91'      IS THIS AN OBR?                      35900000
         BNE   L270                YES,BR HANDLE OBR RECORD    .        35950000
         UNPK  PARM4(3),MDRCTRL(2) NO. GET CTRL UNIT POLL CHAR.         36000000
         MVI   PARM4+2,X'00'                                            36050000
         TR    PARM4,HXTOEB        MAKE IT LOOK LIKE IT WAS KEYED IN.   36100000
         B     A010                                                     36150000
L270     CLI   OBRUCB,X'10'        IS THIS A LOCAL                      36200000
         BE    L280                YES,BR NO POLL CHARS                 36250000
         UNPK  PARM4(3),OBRPOLL(2) GET CNTRL UNIT POLL CHARS            36300000
         MVI   PARM4+2,X'00'                                            36350000
         TR    PARM4,HXTOEB        MAKE IT LOOK LIKE IT WAS KEYED IN    36400000
         B     A010                                                     36450000
L280     MVC   PARM3,PARM5         UNROUND TERML ADDRESS                36500000
         XC    PARM5,PARM5         ERASE GARBAGE IF LOCAL CU.           36550000
L300     B     A010                                                     36600000
M060     MVC   TIOADBAO+152(BUHDR2LT),BUHDR2  MOVE MODEL 2 BLOWUP HDR   36650000
         LA    OUTREG,TIOADBAO+BUHDR2LT+152 POINT TO NEXT BYTE OF OUTAR 36700000
M080     UNPK  DUBLWD,TIME         MOVE TIME OF                         36750000
         MVC   0(2,OUTREG),DUBLWD+1     ERROR TO OUTPUT.                36800000
         MVI   2(OUTREG),C':'                                           36850000
         MVC   3(2,OUTREG),DUBLWD+3                                     36900000
         LA    1,LEAPTBL                                                36950000
M090     CLC   DATE+1(1),0(1)           FIGURE OUT IF                   37000000
         BE    M100                     ERROR HAPPENED                  37050000
         LA    1,1(1)                 DURING LEAP YEAR.                 37100000
         CLI   0(1),X'FF'                                               37150000
         BNE   M090                                                     37200000
         ZAP   CALENDAR+8(2),=P'28'                                     37250000
         B     M110                                                     37300000
M100     ZAP   CALENDAR+8(2),=P'29'                                     37350000
M110     LA    R15,CALENDAR                                             37400000
M120     MVN   DATE+3(1),=X'0C'    PROTECT AGAINST GARBAGE IN PACKED    37450000
         CLC   DATE+2(2),3(R15)    FIELD.  COMPUTE MONTH AND            37500000
         BNH   M130                     DAY FROM DAY NUMBER.            37550000
         SP    DATE+2(2),3(2,R15)                                       37600000
         LA    R15,5(R15)                                               37650000
         B     M120                                                     37700000
M130     MVC   6(3,OUTREG),0(R15)       MOVE MONTH TO OUTPUT.           37750000
         UNPK  9(2,OUTREG),DATE+2(2)    MOVE DAY TO OUTPUT.             37800000
         OI    10(OUTREG),X'F0'                                         37850000
         MVC   LINESZ,=H'40'                                            37900000
         MVC   LINELOOP,=H'4'                                           37950000
         CLI   TCTTETM,C'2'        SETUP CORRECT LINE SIZE & NBR        38000000
         BNE   M140                     ITEMS FOR SCREEN MODEL.         38050000
         MVC   LINESZ,=H'80'                                            38100000
         MVC   LINELOOP,=H'12'                                          38150000
M140     EQU   *                                                        38200000
         CLI   ENTRYTYP,X'91'      IS THIS ENTRY AN OBR?                38250000
         BNE   M160                YES.                                 38300000
         BAL   LINKREG,BUMDR       NO. BLOW UP AN MDR ENTRY.            38350000
M150     LA    R1,TIOADBAO                                              38400000
         SR    OUTREG,R1                                                38450000
         STH   OUTREG,TIOATDL      FINISH UP THE OUTPUT.                38500000
         CLOSE EMFIL1                                                   38550000
         L     13,SAV3270R                                              38600000
         RETURN  (14,12)                                                38650000
M160     BAL   LINKREG,BUOBR       BLOWUP AN OBR ENTRY.                 38700000
         B     M150                                                     38750000
BUOBR    MVC   13(5,OUTREG),=C'TP-OP'   MOVE THE                        38800000
         UNPK  DUBLWD,OBRCCW+5(2)       TP OP CODE                      38850000
         TR    DUBLWD,HXTOEB            TO OUTPUT AREA.                 38900000
         MVC   19(2,OUTREG),DUBLWD+5                                    38950000
         LA    R15,TPOPTBL                                              39000000
         CLI   ENTRYTYP,TCAMOBR    IS THIS A TCAM OBR?                  39050000
         BNE   O060                NO,REG15 POINTS AT BTAM              39100000
         L     R15,=A(TCAMTPOP)    YES,POINT REG15 TO TCAM TPOP TABLE   39150000
O060     CLC   0(2,R15),DUBLWD+5                                        39200000
         BE    O120                                                     39250000
         CLC   0(2,R15),=X'FFFF'                                        39300000
         BE    O120                                                     39350000
         LA    R15,20(R15)                                              39400000
         B     O060                                                     39450000
O120     MVC   22(18,OUTREG),2(R15) MOVE EXPLANATION OF TP OP CODE.     39500000
         AH    OUTREG,LINESZ       BUMP TO NEXT LINE OF OUTPUT.         39550000
O170     MVC   0(11,OUTREG),=C'DATA LENGTH'                             39600000
         UNPK  DUBLWD,OBRCCW+6(3)                                       39650000
         TR    DUBLWD,HXTOEB       MOVE DATA LENGTH.                    39700000
         MVC   12(4,OUTREG),DUBLWD+3                                    39750000
         MVC   21(14,OUTREG),=C'RESIDUAL COUNT'                         39800000
         UNPK  DUBLWD,OBRCSW+6(3)                                       39850000
         TR    DUBLWD,HXTOEB                                            39900000
         MVC   36(4,OUTREG),DUBLWD+3                                    39950000
         AH    OUTREG,LINESZ       BUMP TO NEXT OUTPUT LINE.            40000000
         MVC   0(15,OUTREG),=C'CHANNEL COMMAND'                         40050000
         UNPK  DUBLWD,OBRCCW(2)                                         40100000
         TR    DUBLWD,HXTOEB       MOVE THE CHANNEL COMMAND.            40150000
         MVC   16(2,OUTREG),DUBLWD+5                                    40200000
         LA    R15,CCWTABL                                              40250000
         CLI   OBRUCB,X'40'        IS THIS A REMOTE?                    40300000
         BE    P070                YES,USE 270X COMMANDS                40350000
         L     R15,=A(CCW3272)     NO,USE THE 3272 COMMANDS             40400000
P070     CLC   0(2,R15),DUBLWD+5                                        40450000
         BE    P130                                                     40500000
         CLC   0(2,R15),=X'FFFF'                                        40550000
         BE    P130                                                     40600000
         LA    R15,20(R15)                                              40650000
         B     P070                                                     40700000
P130     MVC   19(18,OUTREG),2(R15) MOVE CCW EXPLANATION.               40750000
         AH    OUTREG,LINESZ       BUMP TO NEXT OUTPUT LINE.            40800000
         MVC   4(5,OUTREG),=C'SENSE'    MOVE SENSE & STATUS HEADERS.    40850000
         MVC   24(6,OUTREG),=C'STATUS'                                  40900000
         UNPK  DUBLWD,OBRSENSE(3)  MOVE SENSE                        XH 41400000
         TR    DUBLWD,HXTOEB       BYTES TO                             41450000
         MVC   10(4,OUTREG),DUBLWD+3    OUTPUT AREA                  XH 41500000
         UNPK  DUBLWD,OBRCSW+4(3)  MOVE OBR STATUS                      41550000
         TR    DUBLWD,HXTOEB       BYTES TO                             41600000
         MVC   31(4,OUTREG),DUBLWD+3    OUTPUT AREA                     41650000
         AH    OUTREG,LINESZ       BUMP TO NEXT OUTPUT LINE             41700000
         LR    R14,OUTREG          TEMPORARY POINTER TO SENSE OUTPUT.   41750000
         LH    R1,LINELOOP         LIMIT DISPLAY IF MOD 1 SCREEN.       41800000
         LA    R15,SENSTABL                                             41850000
         CLI   OBRUCB,X'40'        IS THIS A REMOTE?                    41900000
         BE    P200                YES USE 270X SENSE                   41950000
         L     R15,=A(SENS3272)    NO,USE 3272 SENSE                    42000000
P200     MVC   DUBLWD(1),OBRSENSE  SETUP TO TEST SENSE BITS.         XH 42050000
         NC    DUBLWD(1),0(R15)                                         42100000
         CLC   DUBLWD(1),0(R15)                                         42150000
         BE    Q050                                                     42200000
Q010     LA    R15,19(R15)         BUMP TO NEXT SLOT IN SENSE TABL.     42250000
         CLI   0(R15),X'FF'                                             42300000
         BNE   P200                                                     42350000
         B     Q080                                                     42400000
Q050     MVC   0(18,R14),1(R15)    MOVE EXPLANATION OF 1 SENSE BIT.     42450000
         AH    R14,LINESZ          BUMP TO NEXT SENSE OUTPUT AREA.      42500000
         BCT   R1,Q010             ANY TIOA ROOM LEFT?                  42550000
Q080     ST    R14,SAVE14                                               42600000
         LR    R14,OUTREG          NO. SETUP TO LOOK AT STATUS BITS.    42650000
         LH    R1,LINELOOP                                              42700000
         LA    R15,CSWTABL                                              42750000
Q110     MVC   DUBLWD(2),OBRCSW+4                                       42800000
         NC    DUBLWD(2),0(R15)                                         42850000
         CLC   DUBLWD(2),0(R15)                                         42900000
         BE    Q180                                                     42950000
Q150     LA    R15,20(R15)                                              43000000
         CLI   0(R15),X'FF'                                             43050000
         BNE   Q110                                                     43100000
         B     Q210                                                     43150000
Q180     MVC   20(18,R14),2(R15)   MOVE EXPLANATION OF 1 CSW STATUS BIT 43200000
         AH    R14,LINESZ         BUMP TO NEXT OUTPUT SLOT              43250000
         BCT   R1,Q150             ANY TIOA ROOM LEFT?                  43300000
Q210     C     R14,SAVE14          NO.                                  43350000
         BH    R010                                                     43400000
         L     R14,SAVE14          SET OUTPUT REG TO HIGHER             43450000
R010     LR    OUTREG,R14          OUTPUT ADDRESS (SENSE OR STATUS).    43500000
         BR    LINKREG                                                  43550000
BUMDR    MVC   24(6,OUTREG),=C'SENSE '  MOVE SENSE HDR.                 43600000
         UNPK  DUBLWD,MDRSTATS(3)  MOVE MDR                             43650000
         TR    DUBLWD,HXTOEB       STATUS BYTES                         43700000
         MVC   31(4,OUTREG),DUBLWD+3    TO OUTPUT AREA                  43750000
         AH    OUTREG,LINESZ       BUMP TO NEXT OUTPUT LINE.            43800000
         LR    R14,OUTREG                                               43850000
         LH    R1,LINELOOP                                              43900000
         AR    R1,R1               LIMIT MOD 1 TO 7 BITS MAX.           43950000
         BCTR  R1,R0                                                    44000000
         LA    R15,STATSTBL                                             44050000
R080     MVC   DUBLWD(2),MDRSTATS  SETUP TO LOOK AT REMOTE STATUS TBL.  44100000
         NC    DUBLWD(2),0(R15)                                         44150000
         CLC   DUBLWD(2),0(R15)                                         44200000
         BE    R170                                                     44250000
R120     LA    R15,20(R15)                                              44300000
         CLI   0(R15),X'FF'                                             44350000
         BNE   R080                                                     44400000
         B     R200                                                     44450000
R170     MVC   20(18,R14),2(R15)   MOVE EXPLANATION OF 1 REMOTE STATUS  44500000
         AH    R14,LINESZ          BUMP TO NEXT OUTPUT AREA             44550000
         BCT   R1,R120             ANY TIOA ROOM LEFT?                  44600000
R200     LR    OUTREG,R14          NO. SETUP TO COMPUTE DATA LTH.       44650000
         BR    LINKREG             RETURN TO MAIN LINE.                 44700000
LOCATE   MVC   FILREC,TWAREL                                            44750000
         READ  ECB3,DI,EMFIL1,(6),4096,0,FILREC                         44800000
         CHECK ECB3                                                     44850000
S030     L     FIOABAR,TCAFCAA     POINT TO DATA BLK.                   44900000
         LH    DATALOOP,BLKLTH     SETUP LOOP NBR BYTES THIS BLK.       44950000
         LA    DATAREG,DATASLT1    POINT TO FIRST DATA ITEM             45000000
         SR    R1,R1               PREPARE SLOT NBR FOR                 45050000
         IC    R1,TWASLOT          PUTTING OUT IN DISPLAY               45100000
         BCTR  R1,R0                                                    45150000
         STC   R1,TWASLOT+3                                             45200000
S060     CLI   TWASLOT,2           IF RQSTED SLOT = 1, THIS IS IT.      45250000
         BL    S220                GO RESUME DISPLAY BUILDING.          45300000
         SR    R1,R1                                                    45350000
         IC    R1,TWASLOT          DECREMENT SLOT COUNT BY 1.           45400000
         BCTR  R1,R0                                                    45450000
         STC   R1,TWASLOT                                               45500000
         IC    1,0(DATAREG)      BUMP TO NEXT SLOT.                     45550000
         LTR   1,1                                                      45600000
         BZ    S190                PREVENT LOOP IF GARBAGE INPUT.       45650000
         AR    DATAREG,1                                                45700000
         SR    DATALOOP,1                                               45750000
         LTR   DATALOOP,DATALOOP   VERIFY SLOT NBR VALID FOR THIS BLK.  45800000
         BP    S060                                                     45850000
S190     DS    0H                                                       45900000
         MVC   TIOADBAO(INVLTH),INVMSG  IF RQSTED SLOT CAN'T            45950000
         MVC   TIOATDL,=AL2(INVLTH)     BE FOUND, SEND 'INVALID INPUT'  46000000
         B     D170                                                     46050000
S220     BR    LINKREG             RETURN TO MAIN LINE.                 46100000
GETTIOA  LA     TIOABAR,TIOADBAO     POINT  TO TCAM OUTPUT AREA         46150000
* NEXT 5 LINES INITIALIZES TIOA TO 40'S                                 46200000
         ST    DATALOOP,R8SAVE     SAVE REGIDTER EIGHT                  46250000
         LA    0,TIOADBAO          FIELD TO BE CLEARED                  46300000
         LA    1,2000              LENGTH OF FIELD TO BE CLEARED        46350000
         L     REG9,=X'40000001'   LENGTH AND PADDING CHARACTER         46400000
         LA    DATALOOP,FORTY      FILL  CHARACTER                      46450000
         MVCL  0,DATALOOP          MOVE FILL CHARACTER TO CLEAR FIELD   46500000
         L     DATALOOP,R8SAVE     RESTORE REGISTER EIGHT               46550000
* END OF INITIALIZE CODE                                                46600000
         ST    TIOABAR,TCTTEDA     ENOUGH FOR A MODEL-2 DISPLAY.        46650000
         MVC   TIOADBAO(HDR1LTH),HDR1                                   46700000
         MVC   TIOADBAO+HDR1LTH(4),=C'3270'    SET UP 1ST LINE OF HDR   46750000
         LA    OUTREG,TIOADBAO+HDR1LTH+4   BUMP OUTPUT AREA ADDRESS     46800000
         CLI   TCTTETM,C'2'        IS THIS SCREEN A MODEL 2?            46850000
         BNE   T120                NO. 1ST LINE IS OK.                  46900000
         MVC   0(3,OUTREG),HDR2    YES. ADD ANOTHER SBA TO FINISH       46950000
         LA    OUTREG,3(OUTREG)    THIS 80-CHAR LINE.                   47000000
T120     MVC   0(HDR3LTH,OUTREG),HDR3   MOVE THE 'PAGE' REQUEST LINES.  47050000
T130     ST    OUTREG,TWAOUT       SAVE THIS ADDR TO FILL IN BLK NBRS.  47100000
         LA    OUTREG,HDR3LTH(OUTREG)                                   47150000
         MVC   0(HDR4LTH,OUTREG),HDR4   MOVE THE RECAP LINE HDR.        47200000
         OC    PARM5,PARM5         IF NO TERM ADDR INPUT, SHOW ONLY LIN 47250000
         BZ    T150                                                     47300000
         MVC   (HDR4TERM-HDR4)(2,OUTREG),PARM5   FILL IN THE            47350000
         MVC   (HDR4CTRL-HDR4)(2,OUTREG),PARM4    ID OF THIS TERML      47400000
T150     DS    0H                                                       47450000
         MVC   (HDR4LINE-HDR4)(3,OUTREG),PARM3    CTRL UNIT, AND LINE.  47500000
         CLC   (HDR4TERM-HDR4)(2,OUTREG),=C'  '   IS THIS TERML BLANK?  47550000
         BNE   T160                     NO,LET IT GO                    47600000
         MVC   8(6,OUTREG),=C'LOCAL '   YES,CHANGE TO                   47650000
         MVC   14(3,OUTREG),PARM3       LOCAL FORMAT                    47700000
         MVC   17(24,OUTREG),=24C' '                                    47750000
T160     DS    0H                                                       47800000
         LA    OUTREG,HDR4LTH(OUTREG)                                   47850000
         CLI   TCTTETM,C'2'        IS THIS A BIG SCREEN?                47900000
         BNE   T170                NO. THIS LINE IS OK.                 47950000
         MVC   0(3,OUTREG),HDR5    YES. ADD ANOTHER SBA TO              48000000
         LA    OUTREG,3(OUTREG)  GET US PAST 40 MORE CHARS.             48050000
T170     MVC   0(HDR6LTH,OUTREG),HDR6   MOVE COLUMN HEADERS.            48100000
         LA    OUTREG,HDR6LTH(OUTREG)                                   48150000
         LA    OUTLOOP,7           SETUP TO SHOW 7 ITEMS ON MOD 1.      48200000
         CLI   TCTTETM,C'2'        IS THIS A BIG SCREEN?                48250000
         BNE   T180                NO. RETURN TO MAIN LINE.             48300000
         MVC   0(HDR6LTH,OUTREG),HDR6   YES. MOVE ANOTHER COLUMN HDR.   48350000
         LA    OUTREG,HDR6LTH(OUTREG)                                   48400000
         LA    OUTLOOP,40          SETUP TO SHOW 40 ITEMS ON MOD 2.     48450000
T180     BR    LINKREG             RETURN TO MAIN LINE.                 48500000
T190     MVC   TIOADBA(MSG13LTH),MSG13  MOVE IN THE MSG        @OZ31884 48507007
         MVC   TIOATDL,=AL2(MSG13LTH)   MOVE IN THE LENGTH     @OZ31884 48514007
         OC    PARM3(3),=CL3' '         INSURE NO X'00'        @OZ31884 48521007
         MVC   TIOADBA+(MSG13LN-MSG13)(3),PARM3 PUT IN LINE NO.@OZ31884 48528007
         LA    R8,MSG13LTH              SET UP MESSAGE LENGTH  @OZ31884 48535007
         B     Z50D                     GO WRITE MESSAGE       @OZ31884 48542007
Z50      CLI   PARM4,X'00'          IS FULL ADDRESS AVAILABLE ?         48550000
         BE    Z50A                 NO. JUST SHOW TERMINAL ADDR         48600000
         CLC   PARM4(2),=C'00'                                          48650000
         BE    Z50A                 NO. JUST SHOW TERMINAL ADDR         48700000
         MVC   TIOADBAO(MSG11LTH),MSG11  MOVE 'NO ERRS' MSG TO OUTPUT   48750000
         OC    PARM3(24),=CL24' '   CHANGE  X'00'  TO  X'40'            48800000
         LA    15,TIOADBAO          POINT TO OUTPUT AREA                48850000
         MVC   (MSG11TRM-MSG11)(2,15),PARM5  MOVE TERML TO OUTPUT       48900000
         MVC   (MSG11CU-MSG11)(2,15),PARM4   MOVE CTRL UNIT TO OUTPUT   48950000
         MVC   (MSG11LIN-MSG11)(3,15),PARM3  MOVE LINE      TO OUTPUT   49000000
         B     Z50C                                                     49250000
Z50A     OC    PARM3,=CL8' '          CHANGE  X'00'  TO  X'40'          49300000
         MVC   MSG12TRM,PARM3         MOVE TERML TO OUTPUT              49350000
Z50B     MVC   TIOADBAO(MSG12LTH),MSG12 MOVE MSG12 TO OUTPUT AREA       49700000
         LA    R8,MSG12LTH                                              49750000
         B     Z50D                                                     49800000
Z50C     LA    R8,MSG11LTH                                              49850000
Z50D     STH   R8,TIOATDL                                               49900000
         L     13,SAV3270R                                              49950000
         RETURN (14,12)                                                 50000000
*                                                                       50050000
EMFIL1 DCB DDNAME=EMFILE,DSORG=DA,MACRF=(RIC),OPTCD=R,                 X50100000
               RECFM=F,SYNAD=F1900                                      50150000
SAV3270R DS    A         CALLERS SAV AREA REGISTER ADDRESS              50200000
SAV3270A DS    18F   3270 PROGRAM SAVAREA                               50250000
P        DS    XL24'00'            PARM AREA FOR BLOWUP                 50300000
         ORG   P                                                        50350000
P3       DC    XL8'00'                                                  50400000
P4       DC    XL8'00'                                                  50450000
P5       DC    XL8'00'                                                  50500000
FORTY    DC    X'40404040'                                              50550000
HDR1     DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF'                   50600000
         DC    AL1(SF,UNA,IC),AL1(SBA),AL2(L1P36),AL1(SF,MNP)           50650000
HDR1LTH  EQU   *-HDR1                                                   50700000
HDR2     DC    AL1(SBA),AL2(L2P1)                                       50750000
HDR3     DC    AL1(SF,PNA),C'(',AL1(SF,UNA),C'?'                        50800000
         DC    AL1(SF,PNA),C') PAGE FORWARD'                            50850000
         DC    AL1(SF,PNA),C' '                                         50900000
HDR3ID   DC    C'                   '                                   50950000
         DC    AL1(SF,PNA),C'(',AL1(SF,UNA),C'?'                        51000000
         DC    AL1(SF,PNA),C') PAGE BACKWRD'                            51050000
         DC    AL1(SF,PIA)                                              51100000
BBBSS    DC    C'BBBSSBBBSSBBBSS',AL1(SF,PNA),C'    '                   51150000
HDR3LTH  EQU   *-HDR3                                                   51200000
HDR4     DC    AL1(SF,PNA),C'RECAP REMOTE '                             51250000
HDR4TERM DC    CL2'  ',C' ON CU '                                       51300000
HDR4CTRL DC    CL2'  ',C' ON LINE '                                     51350000
HDR4LINE DC    CL3'999',C'  '                                           51400000
HDR4LTH  EQU   *-HDR4                                                   51450000
HDR5     DC    AL1(SBA),AL2(L4P1)                                       51500000
HDR6     DC    AL1(SF,PNA),C'      FILE#  TIME SENSE STATUS TPOP CMD'   51550000
HDR6LTH  EQU   *-HDR6                                                   51600000
IOERRMSG DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)    51650000
         DC    XL34'00',AL1(SF,PNA),CL39' '                             51700000
         DC    CL39'BNG001A T I/O ERR READING SYS1.DEMFLOG '            51750000
         DC    CL28'    THE BDAM RETURN CODE IS '                       51800000
IOCODE   DC    CL4'0000'                                                51850000
         DC    CL8' '                                                   51900000
         DC    CL34'THE BDAM RELATIVE BLOCK NUMBER IS '                 51950000
IOBLOCK  DC    CL3'000'                                                 52000000
IOERRLTH EQU   *-IOERRMSG                                               52050000
MSG11    DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)    52100000
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                           52150000
         DC    C'BNG011I T NO ERRORS RECORDED FOR REMOTE'               52200000
         DC    AL1(SBA),AL2(L3P1),AL1(SF,PNA)                           52250000
         DC    CL9'TERMINAL '                                           52300000
MSG11TRM DC    CL2' '                                                   52350000
         DC    CL20'       ON CTRL UNIT '                               52400000
MSG11CU  DC    CL2' '                                                   52450000
         DC    AL1(SBA),AL2(L4P1),AL1(SF,PNA)                           52500000
         DC    CL8'ON LINE '                                            52550000
MSG11LIN DC    CL3' '                                                   52600000
         DC    CL8' '                                                   52650000
MSG11ID  DC    CL20' '          IMS SYMBOLIC NAME                       52700000
MSG11LTH EQU   *-MSG11                                                  52750000
MSG12    DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)    52800000
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                           52850000
         DC    C'BNG012I T NO ERRORS RECORDED FOR LOCAL '               52900000
         DC    AL1(SBA),AL2(L3P1),AL1(SF,PNA)                           52950000
         DC    CL9'TERMINAL '                                           53000000
MSG12TRM DC    CL3' '                                                   53050000
         DC    CL7' '                                                   53100000
MSG12ID  DC    CL20' '          IMS SYMBOLIC NAME                       53150000
MSG12LTH EQU   *-MSG12                                                  53200000
MDRHDR   DC    AL1(SF,PNA),C'(',AL1(SF,UNA),C'? ) '                     53250000
MDRBBBSS DC    CL5'BBBSS',AL1(SF,PNA)                                   53300000
MDRHRS   DC    CL2'24',C':'                                             53350000
MDRMINS  DC    CL2'60',C'  '                                            53400000
MDRSTAT  DC    CL4'XXXX',C'   '                                         53450000
OBRSNS   DC    CL4'    ',C'  '                                          53500000
OBRTPOP  DC    CL2'  ',C'  '                                            53550000
OBRCMD   DC    CL2'  ',C' '                                             53600000
MDRLTH   EQU   *-MDRHDR                                                 53650000
BUHDR1   DC    AL1(SBA),AL2(L1P7),AL1(IC)                               53700000
         DC   AL1(SBA),AL2(L3P39),AL1(SF,PIA),C'%',AL1(SBA),AL2(SML5P1) 53750000
         DC    X'3CC75F40',AL1(SBA),AL2(SML5P1)                         53800000
BUHDR1LT EQU   *-BUHDR1                                                 53850000
BUHDR2   DC    AL1(SBA),AL2(L1P7),AL1(IC)                               53900000
         DC    AL1(SBA),AL2(L2P79),AL1(SF,PIA),C'%',AL1(SBA),AL2(L4P1)  53950000
         DC    X'3C5D7F40',AL1(SBA),AL2(L4P1)                           54000000
BUHDR2LT EQU   *-BUHDR2                                                 54050000
INVMSG   DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)    54100000
         DC    XL34'00',AL1(SBA),AL2(L2P1),AL1(SF,PNA)                  54150000
         DC    CL39'BNG005I T ERROR NOT FOUND ON FILE FOR '             54200000
         DC    AL1(SBA),AL2(L3P1),AL1(SF,PNA)                           54250000
         DC    C'THE SELECTED ITEM '                                    54300000
INVLTH   EQU   *-INVMSG                                                 54350000
MSG13    DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)    54353007
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                  @OZ31884 54356007
         DC    CL39'BNG013A T NO DATA BLOCKS AVAILABLE FOR '   @OZ31884 54359007
         DC    CL5'LINE '                                      @OZ31884 54362007
MSG13LN  DC    CL3' '                                          @OZ31884 54365007
         DC    CL31':  DATA BASE IN DEGRADED MODE. '           @OZ31884 54368007
         DC    CL39' MUST ALLOCATE MORE BLOCKS THAN LINES'     @OZ31884 54371007
MSG13LTH EQU   *-MSG13                                         @OZ31884 54374007
         DS    0F                       ALIGN ON FULL WORD     @OZ31884 54377007
R8SAVE   DC    X'00000000'              SAVE AREA REG 8        @OZ31884 54380007
DATTIME  DC    X'00000000'              SAVE AREA FOR TIME     @OZ31884 54383007
DATDATE  DC    PL4'0'                   SAVE AREA FOR DATE     @OZ31884 54386007
FILREC   DC    X'000000'                WORK AREA FOR FILE REC @OZ31884 54389007
SENSAV   DC    XL1'00'                  OBR SENSE WORK AREA    @OZ31884 54392007
         DS    XL3                      SPARE                  @OZ31884 54395007
         LTORG                                                          54400000
CALENDAR DC    C'JAN',PL2'31'                                           54450000
         DC    C'FEB',PL2'28'                                           54500000
         DC    C'MAR',PL2'31'                                           54550000
         DC    C'APR',PL2'30'                                           54600000
         DC    C'MAY',PL2'31'                                           54650000
         DC    C'JUN',PL2'30'                                           54700000
         DC    C'JUL',PL2'31'                                           54750000
         DC    C'AUG',PL2'31'                                           54800000
         DC    C'SEP',PL2'30'                                           54850000
         DC    C'OCT',PL2'31'                                           54900000
         DC    C'NOV',PL2'30'                                           54950000
         DC    C'DEC',PL2'31'                                           55000000
LEAPTBL  DC    X'768084889296FF'                                        55050000
EBTOHX   DC    X'00000000000000000000000000000000'     00-0F  THIS      55100000
         DC    X'00000000000000000000000000000000'     10-1F  TABLE     55150000
         DC    X'00000000000000000000000000000000'     20-2F  CONVERTS  55200000
         DC    X'00000000000000000000000000000000'     30-3F  INPUT     55250000
         DC    X'00000000000000000000000000000000'     40-4F  A THRU F  55300000
         DC    X'000000000000000000000000FF000000'     50-5F    TO      55350000
         DC    X'00000000000000000000000000000000'     60-6F  0A - 0F   55400000
         DC    X'00000000000000000000000000000000'     70-7F   AND      55450000
         DC    X'00000000000000000000000000000000'     80-8F  F0 - F9   55500000
         DC    X'00000000000000000000000000000000'     90-9F    TO      55550000
         DC    X'00000000000000000000000000000000'     A0-AF  00 - 09   55600000
         DC    X'00000000000000000000000000000000'     B0-BF    AND     55650000
         DC    X'000A0B0C0D0E0F000000000000000000'     C0-CF     *      55700000
         DC    X'00000000000000000000000000000000'     D0-DF   BECOME   55750000
         DC    X'00000000000000000000000000000000'     E0-EF    FF.     55800000
         DC    X'00010203040506070809000000000000'     F0-FF            55850000
HXTOEB   DC    4XL16'00',C' ',XL15'00',7XL16'00'  THIS TABLE CONVERTS   55900000
         DC    X'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'  HEX CHARS           55950000
         DC    2XL16'00'                CHARS FA-THRU-FF BACK           56000000
         DC    X'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'  A THRU F            56050000
CCWTABL  DC    CL20'00TEST IO'                                          56100000
         DC    CL20'01WRITE'                                            56150000
         DC    CL20'02READ'                                             56200000
         DC    CL20'03NO OP'                                            56250000
         DC    CL20'04SENSE'                                            56300000
         DC    CL20'05TEST WRITE'                                       56350000
         DC    CL20'06READ PREPARE'                                     56400000
         DC    CL20'07STEP COUNT'                                       56450000
         DC    CL20'09WRITE POLL'                                       56500000
         DC    CL20'0AREAD INHIBIT'                                     56550000
         DC    CL20'0DWRITE BREAK'                                      56600000
         DC    CL20'0EREAD SEARCH'                                      56650000
         DC    CL20'11WRITE W/TIME OUT'                                 56700000
         DC    CL20'12TEST READ'                                        56750000
         DC    CL20'13SAD ZERO'                                         56800000
         DC    CL20'15WRAP'                                             56850000
         DC    CL20'17SAD ONE'                                          56900000
         DC    CL20'19POLL SOH'                                         56950000
         DC    CL20'1BSAD TWO'                                          57000000
         DC    CL20'1D DIAGNOSTIC POLL'                                 57050000
         DC    CL20'1EADDRESS PREPARE'                                  57100000
         DC    CL20'1FSAD THREE'                                        57150000
         DC    CL20'23SET MODE'                                         57200000
         DC    CL20'27ENABLE'                                           57250000
         DC    CL20'29WRITE DIAL'                                       57300000
         DC    CL20'2FDISABLE'                                          57350000
         DC    CL20'33TEST SYNC'                                        57400000
         DC    CL20'37SENFEOT'                                          57450000
         DC    CL20'3BSEND INQUIRY'                                     57500000
         DC    CL20'41WRITE BREAK'                                      57550000
         DC    CL20'42READ CLEAR'                                       57600000
         DC    X'FFFF',CL18'NO KNOWN MEANING'                           57650000
TPOPTBL  DC    CL20'00ON LINE TEST'                                     57700000
         DC    CL20'01DISABLE'                                          57750000
         DC    CL20'02WRITE EOA EOT EOT'                                57800000
         DC    CL20'03WRT POLL/ADDR CHRS'                               57850000
         DC    CL20'04WRITE SPACE'                                      57900000
         DC    CL20'05RD RSP TO POLLING'                                57950000
         DC    CL20'06RD RSP TO ADDRESSING'                             58000000
         DC    CL20'07READ ID RESPONSE'                                 58050000
         DC    CL20'08WRITE EOA'                                        58100000
         DC    CL20'09NOP OR TIC'                                       58150000
         DC    CL20'0AREAD INDEX'                                       58200000
         DC    CL20'0BREAD INQUIRY'                                     58250000
         DC    CL20'0CRD RSP TO INQUIRY'                                58300000
         DC    CL20'10WRT LINE ADDRESS'                                 58350000
         DC    CL20'11RD OR WRT TEXT'                                   58400000
         DC    CL20'12RD SKIP OR TIC'                                   58450000
         DC    CL20'13WRITE DLE ETX'                                    58500000
         DC    CL20'20RD RSP TO TEXT'                                   58550000
         DC    CL20'21ALL RESET COMMANDS'                               58600000
         DC    CL20'22READ SKIP'                                        58650000
         DC    CL20'23WRITE BREAK'                                      58700000
         DC    CL20'24OPEN LOPEN CLOSE'                                 58750000
         DC    CL20'25RD RSP TO TEXT'                                   58800000
         DC    X'FFFF',CL18'NO KNOWN MEANING'                           58850000
CSWTABL  DC    B'1000000000000000',CL18'ATTENTION'                      58900000
         DC    B'0100000000000000',CL18'STATUS MODIFIER'                58950000
         DC    B'0010000000000000',CL18'CTRL UNIT END'                  59000000
         DC    B'0001000000000000',CL18'BUSY'                           59050000
         DC    B'0000100000000000',CL18'CHANNEL END'                    59100000
         DC    B'0000010000000000',CL18'DEVICE END'                     59150000
         DC    B'0000001000000000',CL18'UNIT CHECK'                     59200000
         DC    B'0000000100000000',CL18'UNIT EXCEPTION'                 59250000
         DC    B'0000000010000000',CL18'PGRM CTRLD INTRPT'              59300000
         DC    B'0000000001000000',CL18'INCORRECT LENGTH'               59350000
         DC    B'0000000000100000',CL18'PROGRAM CHECK'                  59400000
         DC    B'0000000000010000',CL18'PROTECTION CHECK'               59450000
         DC    B'0000000000001000',CL18'CHANL DATA CHECK'               59500000
         DC    B'0000000000000100',CL18'CHANL CTRL CHECK'               59550000
         DC    B'0000000000000010',CL18'INTFACE CTRL CK'                59600000
         DC    B'0000000000000001',CL18'CHAINING CHECK'                 59650000
         DC    X'FF'                                                    59700000
SENSTABL DC    B'10000000',CL18'COMMAND REJECT'                         59750000
         DC    B'01000000',CL18'INTERVENTION REQD'                      59800000
         DC    B'00100000',CL18'BUS OUT CHECK'                          59850000
         DC    B'00010000',CL18'EQUIPMENT CHECK'                        59900000
         DC    B'00001000',CL18'DATA CHECK'                             59950000
         DC    B'00000100',CL18'OVERRUN'                                60000000
         DC    B'00000010',CL18'LOST DATA'                              60050000
         DC    B'00000001',CL18'TIMEOUT'                                60100000
         DC    X'FF'                                                    60150000
STATSTBL DC    B'0010000000000000',CL18'RESERVED'                       60200000
         DC    B'0001000000000000',CL18'RESERVED'                       60250000
         DC    B'0000100000000000',CL18'DEVICE BUSY'                    60300000
         DC    B'0000010000000000',CL18'UNIT SPECIFY'                   60350000
         DC    B'0000001000000000',CL18'DEVICE END'                     60400000
         DC    B'0000000100000000',CL18'TRANSMISSION CHECK'             60450000
         DC    B'0000000000100000',CL18'COMMAND REJECT'                 60500000
         DC    B'0000000000010000',CL18'INTERVENTION REQD'              60550000
         DC    B'0000000000001000',CL18'EQUIPMENT CHECK'                60600000
         DC    B'0000000000000100',CL18'DATA CHECK'                     60650000
         DC    B'0000000000000010',CL18'CONTROL CHECK'                  60700000
         DC    B'0000000000000001',CL18'OPERATION CHECK'                60750000
         DC    X'FF'                                                    60800000
SENS3272 DC    B'10000000',CL18'COMMAND REJECT'                         60850000
         DC    B'01000000',CL18'INTERVENTION REQD'                      60900000
         DC    B'00100000',CL18'BUS OUT CHECK'                          60950000
         DC    B'00010000',CL18'EQUIPMENT CHECK'                        61000000
         DC    B'00001000',CL18'DATA CHECK'                             61050000
         DC    B'00000100',CL18'UNIT SPECIFY'                           61100000
         DC    B'00000010',CL18'CONTROL CHECK'                          61150000
         DC    B'00000001',CL18'OPERATION CHECK'                        61200000
         DC    X'FF'                                                    61250000
CCW3272  DC    CL20'01WRITE'                                            61300000
         DC    CL20'05ERASE WRITE'                                      61350000
         DC    CL20'02READ BUFFER'                                      61400000
         DC    CL20'06READ MODIFIED'                                    61450000
         DC    CL20'0BSELECT'                                           61500000
         DC    CL20'0FERASE ALL PROTECTD'                               61550000
         DC    CL20'03NO OP'                                            61600000
         DC    CL20'04SENSE'                                            61650000
         DC    X'FFFF',CL18'NO KNOWN MEANING'                           61700000
TCAMTPOP DC    CL20'01WRT EOT FOR SELECT'                               61750000
         DC    CL20'02OPEN TP OP CODE'                                  61800000
         DC    CL20'03WRITE POLL CHARS'                                 61850000
         DC    CL20'04RD RSPNS TO POLL'                                 61900000
         DC    CL20'05WRITE PAD CHARS'                                  61950000
         DC    CL20'06ENABLE DIAL LINE'                                 62000000
         DC    CL20'07WRT ADDR SEQUENCE'                                62050000
         DC    CL20'08READ RSPNS TO ADDR'                               62100000
         DC    CL20'09WRITE EOA SEQUENCE'                               62150000
         DC    CL20'0ARD RSPNS EOB/ETB'                                 62200000
         DC    CL20'0BWRITE CPU ID'                                     62250000
         DC    CL20'0CREAD ENQ'                                         62300000
         DC    CL20'0DWRITE ENQ'                                        62350000
         DC    CL20'0ERD RSPNS TO ENQ'                                  62400000
         DC    CL20'0FWRITE DLE EOT'                                    62450000
         DC    CL20'10READ ID (TSO)'                                    62500000
         DC    CL20'11NON-R/W CCW'                                      62550000
         DC    CL20'12WRITE BREAK (TSO)'                                62600000
         DC    CL20'13WRT ENQ AFTER SEL'                                62650000
         DC    CL20'14READ LCOUT'                                       62700000
         DC    CL20'15WRT RSP BEFOR TXT'                                62750000
         DC    CL20'16WRITE RESPONSE'                                   62800000
         DC    CL20'17WRITE TONE'                                       62850000
         DC    CL20'18BSC READ ID ENQ'                                  62900000
         DC    CL20'1ABSC READ ID ACK'                                  62950000
         DC    CL20'1CABORT SEND/RECIEV'                                63000000
         DC    CL20'1EREAD TWX ID'                                      63050000
         DC    CL20'20BUF TRM RESET BLK'                                63100000
         DC    CL20'22 CLOSE SDR RECRDNG'                               63150000
         DC    CL20'24WRT RESET AFT SEL'                                63200000
         DC    CL20'51READ SKIP LOOP'                                   63250000
         DC    CL20'53WRT IDLES LOOP'                                   63300000
         DC    CL20'57WRT DLE STX'                                      63350000
         DC    CL20'59WRT DLE ETB(ETX)'                                 63400000
         DC    CL20'5BWRT ENQ RSP TO TXT'                               63450000
         DC    CL20'FFTEXT CCW'                                         63500000
         DC    X'FFFF',CL18'NO KNOWN MEANING'                           63550000
DECB     DSECT                                                          63950000
         DS    CL1                                                      64000000
EXCPBITS DS    CL2                 EXCEPTIONS BITS IN DECB              64050000
         DS    CL1                                                      64100000
T3270ID  DC    C'BNGT3270 END'                                          64150000
         END                                                            64200000
