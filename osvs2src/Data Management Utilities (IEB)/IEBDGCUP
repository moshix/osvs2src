*    NEW MODULE, RELEASE 17.                                       DG0H 00010000
*                                                                A32655 00020000
*A474000                                                         A48747 00030000
*D474000,486000                                                  A48747 00040000
*C39300.D394000                                                  A48773 00050000
*A499200-499498                                                  A50950 00060000
*C292000                                                       @ZA04231 00070000
*A499400-499410                                                @ZA07345 00080000
*C292000                                                       @ZA07345 00090000
*D499400                                                       @ZA07345 00100000
         LCLA  &T,&SPN                                            0002  00110000
.@001    ANOP                                                     0002  00120000
IEBDGCUP CSECT ,                                                  0002  00130000
         ST    @E,12(0,@D)                                        0002  00140000
         STM   @0,@8,20(@D)                                       0002  00150000
         STM   @A,@C,60(@D)                                       0002  00160000
         BALR  @B,0                                               0002  00170000
@PSTART  DS    0H                                                 0002  00180000
         USING @PSTART+00000,@B                                   0002  00190000
         L     @0,@SIZ001                                         0002  00200000
         GETMAIN  R,LV=(0)                                        0002  00210000
         LR    @C,@1                                              0002  00220000
         USING @DATD+00000,@C                                     0002  00230000
         LM    @0,@1,20(@D)                                       0002  00240000
         XC    @TEMPS(@L),@TEMPS                                  0002  00250000
         ST    @D,@SAV001+4                                       0002  00260000
         LA    @F,@SAV001                                         0002  00270000
         ST    @F,8(0,@D)                                         0002  00280000
         LR    @D,@F                                              0002  00290000
*  GEN ( EJECT);                                                        00300000
          EJECT                                                         00310000
         DS    0H                                                       00320000
*  DCL  R14 REG(14);                                                    00330000
*  DCL  R15 REG(15);                                                    00340000
*  DCL R0 REG(0);                                                       00350000
*  DCL R1 REG(1);                                                       00360000
*  DCL R2 REG(2);                                                       00370000
*  DCL R3 REG(3);                                                       00380000
*  DCL R5 REG(5) PTR(31);                                               00390000
*         RESTRICT(5);                                                  00400000
*  DCL R6 REG(6) PTR(31);                                               00410000
*  RESTRICT(6);                                                         00420000
*  DCL R7 REG(7) PTR(31);                                               00430000
*  RESTRICT(7);                                                         00440000
*  DCL R8 REG(8) PTR(31);                                               00450000
*  RESTRICT (8);                                                        00460000
*  DCL R9 REG(9) PTR(31);                                               00470000
*   RESTRICT (9);                                                       00480000
*  DCL    1     COMMON BDY(DWORD) BASED(R5),                            00490000
*               2  PAGENO CHAR(4),                                      00500000
*                   2  LINECT FIXED(31),                                00510000
*                   2  LINECTR FIXED(31),                               00520000
*         2     PARM PTR(31),                                           00530000
*               2 REPEATNO FIXED(15),                                   00540000
*               2 CREATENO FIXED(15),                                   00550000
*         2     SYSP CHAR(96),                                          00560000
*         2     SYSI CHAR(96),                                          00570000
*               2  Q  CHAR(16) BDY(DWORD),                              00580000
*         3  QFILL CHAR(7),                                             00590000
*         3  QSIGN BIT(8),                                              00600000
*                    3 QFILL1 CHAR(7),                                  00610000
*                    3 QSIGN1 BIT(8),                                   00620000
*         2 COUNTER  PTR(31),                                           00630000
*         2 OPENLIST CHAR(8),                                           00640000
*                                   3 OPTBYTE1 CHAR(4),                 00650000
*                                   3 OPTBYTE2 CHAR(4),                 00660000
*               2  EXLST,                                               00670000
*                                        3  INHDR CHAR(1),              00680000
*                                        3 INHDR1 PTR(24),              00690000
*                                        3 OUTHDR CHAR(1),              00700000
*                                        3 OUTHDR1 PTR(24),             00710000
*                                        3 INTRL CHAR(1),               00720000
*                                        3 INTRL1 PTR(24),              00730000
*                                        3 OUTTRL CHAR(1),              00740000
*                                        3 OUTTRL1 PTR(24),             00750000
*                                        3 EXITDCB CHAR(1),             00760000
*                                        3 EXITDCB1 PTR(24),            00770000
*                                        3 TOTAL CHAR(1),               00780000
*                                        3 TOTAL1 PTR(24),              00790000
*               2 EXLST1,                                               00800000
*                                       3 EDCB1 CHAR(1),                00810000
*                                       3 EDCB2 PTR(24),                00820000
*              2 EXLST2,                                                00830000
*                                       3 EDCB3 CHAR(1),                00840000
*                                       3 EDCB4 PTR(24),                00850000
*         2  EXLST3,                                                    00860000
*               3  EDCB5 CHAR(1),                                       00870000
*               3 EDCB6  PTR(24),                                       00880000
*               2 DLRECL FIXED(15),                                     00890000
*               2 DBLKSI FIXED(15),                                     00900000
*               2 DRECFM BIT(8),                                        00910000
*               2 LEFTOVER FIXED(31),                                   00920000
*         2     OFFSET PTR(31),                                         00930000
*         2     LPTR PTR(31),                                           00940000
*         2     DCBPTR PTR(31),                                         00950000
*         2 DUMMY PTR(31);                                              00960000
*  DCL 1 COMMON1 BASED(ADDR(DUMMY)) BDY(WORD),                          00970000
*               2   SAVEMS  FIXED(15),                                  00980000
*               2   CONCODE FIXED(15),                                  00990000
*         2 OUTREC   PTR(31),                                           01000000
*         2 CRTABPT  PTR(31),                                           01010000
*         2 CURCRTE  PTR(31),                                           01020000
*         2 CURCRGM  PTR(31),                                           01030000
*         2 CURPIC PTR(31),                                             01040000
*         2 PICCTR FIXED(31),                                           01050000
*         2 EXITTAB PTR(31),                                            01060000
*         2 EXITGM PTR(31),                                             01070000
*         2 CUREXIT PTR(31),                                            01080000
*               2  DELIM  CHAR(4),                                      01090000
*         2 RECREM   FIXED(31),                                         01100000
*         2 CURFD    PTR(31),                                           01110000
*         2 CUROUT PTR(31),                                             01120000
*         2  SAVE14  PTR(31),                                           01130000
*         2 GETMLIST CHAR(16) BDY(WORD),                                01140000
*            3 GLENGTH FIXED(31),                                       01150000
*            3 ADRLIST PTR(31),                                         01160000
*            3 IND CHAR(4),                                             01170000
*               4 GCODE CHAR(1),                                        01180000
*               4 SPOOL CHAR(1),                                        01190000
*               4 CCODE CHAR(2),                                        01200000
*            3 GCADDR PTR(31),                                          01210000
*         2     FIRSTGMO  PTR(31),                                      01220000
*         2     CURRGMO   PTR(31),                                      01230000
*         2     LASTGMO   PTR(31),                                      01240000
*         2     FIRSTGMI  PTR(31),                                      01250000
*         2     CURRGMI   PTR(31),                                      01260000
*         2     LASTGMI   PTR(31),                                      01270000
*         2     CONDCODE FIXED(15),                                     01280000
*               2       MS     FIXED(15),                               01290000
*               2 INBUFA1 CHAR(121),                                    01300000
*                   3   INFILL CHAR(10),                                01310000
*                      3  INBUFA  CHAR(111),                            01320000
*         2     DDPTR PTR(31),                                          01330000
*               2   DUMMY1 PTR(31);                                     01340000
*  DCL 1 COMMON2 BASED (ADDR(DUMMY1)) BDY(WORD),                        01350000
*         2  SWITCH   CHAR(52),                                         01360000
*               3  FDCSW      CHAR(1),                                  01370000
*               3  FDNAMESW   CHAR(1),                                  01380000
*               3  FDPCSW     CHAR(1),                                  01390000
*               3  FDFMTSW    CHAR(1),                                  01400000
*               3  FDPLSW     CHAR(1),                                  01410000
*               3  RANGESW    CHAR(1),                                  01420000
*               3  FILLSW     CHAR(1),                                  01430000
*               3  REPSW      CHAR(1),                                  01440000
*               3  INDEXSW    CHAR(1),                                  01450000
*               3  INDNMSW    CHAR(1),                                  01460000
*               3  BQUOTESW   CHAR(1),                                  01470000
*               3  PQUOTESW   CHAR(1),                                  01480000
*               3  EQUOTESW   CHAR(1),                                  01490000
*               3  FDSW       CHAR(1),                                  01500000
*               3  DSDSW      CHAR(1),                                  01510000
*               3  NOGOSW     CHAR(1),                                  01520000
*               3  CREATESW   CHAR(1),                                  01530000
*               3  DSDCSW     CHAR(1),                                  01540000
*               3  CRCSW      CHAR(1),                                  01550000
*               3  EXITSW     CHAR(1),                                  01560000
*               3  EODSTOP    CHAR(1),                                  01570000
*               3  DSDNULSW   CHAR(1),                                  01580000
*               3  DSDORGSW   CHAR(1),                                  01590000
*               3  DSDDDSW    CHAR(1),                                  01600000
*               3  CRTBLK     CHAR(1),                                  01610000
*               3  NAMCSW     BIT(8),                                   01620000
*               3  PICCSW     BIT(8),                                   01630000
*               3  BUFPSW     CHAR(1),                                  01640000
*               3  ENDSW      CHAR(1),                                  01650000
*               3  COMCSW     CHAR(1),                                  01660000
*               3  FLAGSW     BIT(8),                                   01670000
*               3  PAGESW     CHAR(1),                                  01680000
*               3  EPSW       PTR(8),                                   01690000
*               3  SYSISW     CHAR(1),                                  01700000
*               3  SYSPSW     CHAR(1),                                  01710000
*               3  OLDNEWSW   CHAR(1),                                  01720000
*               3  FLUSHSW    CHAR(1),                                  01730000
*               3  FLUSHSW1   CHAR(1),                                  01740000
*               3  DSDOSW     CHAR(1),                                  01750000
*               3  DSDISW     CHAR(1),                                  01760000
*               3  QUANSW     CHAR(1),                                  01770000
*               3  PARENSW    CHAR(1),                                  01780000
*               3  REPEATSW   CHAR(1),                                  01790000
*         2 FDPLGTH FIXED(15),                                          01800000
*         2 SGCADDR PTR(31),                                            01810000
*         2 FDPTR   PTR(31),                                            01820000
*         2 FDPTR1  PTR(31),                                            01830000
*         2 FDPTR2  PTR(31),                                            01840000
*         2  DUMMY2  PTR(31);                                           01850000
*  DCL 1 COMMON3 BASED(ADDR(DUMMY2)) BDY(WORD),                         01860000
*               2    FDCTR     PTR(15),                                 01870000
*         2  LREMAIN PTR(31),                                           01880000
*               2     COMPCTR    PTR(31),                               01890000
*               2  LMOVED    PTR(15),                                   01900000
*               2    U    PTR(31),                                      01910000
*               2 PICEND  PTR(15),                                      01920000
*         2 CURFDGM  PTR(31),                                           01930000
*         2  SWTCH,                                                     01940000
*               3    SYSINSEL CHAR(1),                                  01950000
*               3  FIRSTSW     CHAR(1),                                 01960000
*               3  FRSTSW     CHAR(1),                                  01970000
*               3  STOPSW     CHAR(1),                                  01980000
*         2  COPYVAL      FIXED(15),                                    01990000
*         2  COPYFD       PTR(31),                                      02000000
*         2  COPYFDGM     PTR(31),                                      02010000
*         2  NAMCTR       FIXED(15),                                    02020000
*         2  NAMCTR1      FIXED(15),                                    02030000
*               2    INRECSZ   PTR(15),                                 02040000
*               2    OUTRECSZ  PTR(15),                                 02050000
*               2    INRECFM   CHAR(1),                                 02060000
*               2    RECOFFST  PTR(8),                                  02070000
*               2    OUTRECFM  CHAR(1),                                 02080000
*         2     PICBASE PTR(31),                                        02090000
*         2     MESSAGE CHAR(121),                                      02100000
*         2     DUMMY3  PTR(31);                                        02110000
*  DCL 1 DCBD BASED(DCBPTR) BDY(DWORD),                                 02120000
*               2  FILL CHAR(26),                                       02130000
*               2  DSORG1 CHAR(2),                                      02140000
*                                        3  DSORG  BIT(8),              02150000
*               2  FILLER CHAR(8),                                      02160000
*                   3  IOBAD CHAR(4),                                   02170000
*                   3  BFTEK BIT(8),                                    02180000
*                   3  EODAD CHAR(3),                                   02190000
*         2  RECFM  BIT(8),                                             02200000
*         2  EXLIST  PTR(24),                                           02210000
*         2 DDNAME CHAR(8),                                             02220000
*          3 DEBAD CHAR(4),                                             02230000
*              4 IFLGS BIT(8),                                          02240000
*         2     GETAD CHAR(4),                                          02250000
*                                   3 OFLGS BIT(8),                     02260000
*                    3  OFLGS1  CHAR(1),                                02270000
*                    3  MACRF    CHAR(2),                               02280000
*         2     FILL2 CHAR(10),                                         02290000
*         2     BLKSI FIXED(15),                                        02300000
*         2     FILL3 CHAR(18),                                         02310000
*         2     LRECL FIXED(15),                                        02320000
*         2 FILL4 CHAR(172),                                            02330000
*         2 NEXTDCB PTR(31),                                            02340000
*               2  DDNAME1 CHAR(8),                                     02350000
*               2  EODSW   CHAR(1),                                     02360000
*               2 DCBSW1   CHAR(1),                                     02370000
*               2 DCBSW2   CHAR(1),                                     02380000
*         2     DCBSW3 BIT(8),                                          02390000
*         2     INREC  PTR(31),                                         02400000
*         2     GMLGTH FIXED(15),                                       02410000
*         2     FIELDSEL CHAR(1),                                       02420000
*         2     SPARE    CHAR(1);                                       02430000
*  DCL 1 FDTBL CHAR(520) BASED(FDPTR) BDY(WORD),                        02440000
*               2    FDNAME    CHAR(8),                                 02450000
*               2    FDREPNM   CHAR(8),                                 02460000
*               2    FDINDNM   CHAR(8) BDY(WORD),                       02470000
*                   3    FDUMMY CHAR(4),                                02480000
*                    3    FDINDNUM  PTR(31),                            02490000
*               2    FDLGTH    PTR(15),                                 02500000
*               2    FDCYCLE   PTR(15),                                 02510000
*               2    FDACTION  CHAR(2),                                 02520000
*               2    FDFORMAT  CHAR(2),                                 02530000
*               2    FDSWITCH  BIT(8),                                  02540000
*                  3      INDBYNAM  BIT(1),                             02550000
*                   3  PASS     BIT(1),                                 02560000
*                   3  FXACTION BIT(1),                                 02570000
*                   3  RPACTION BIT(1),                                 02580000
*                   3  ROACTION BIT(1),                                 02590000
*                   3  WVACTION BIT(1),                                 02600000
*                   3  STACTION BIT(1),                                 02610000
*               3  NUACTION  BIT(1),                                    02620000
*               2    FDFILL    CHAR(1),                                 02630000
*               2    FDSIGN    CHAR(1),                                 02640000
*               2    FDCHAR    CHAR(1),                                 02650000
*               2    FDRANGE   CHAR(4),                                 02660000
*               2    FDOBUF    PTR(15),                                 02670000
*               2    FDFRINC   PTR(15),                                 02680000
*               2    FDFROMAD  CHAR(4),                                 02690000
*               2    FDMLGTH   PTR(15),                                 02700000
*               2    FDTOINC   PTR(15),                                 02710000
*               2    FDCYCCNT  PTR(15),                                 02720000
*               2    FDSLGTH   PTR(15),                                 02730000
*               2    FDSLGTHR  PTR(15),                                 02740000
*               2    FDFRINCR  CHAR(1),                                 02750000
*               2    FDTOINCR  CHAR(1),                                 02760000
*               2    LTOFREE  PTR(15),                      /*@ZA07345* 02770000
*               2    FDSW1  BIT(8),                                     02780000
*                   3    STRTLOC1  BIT(1);                              02790000
*  DCL FOXZEROS  CHAR(16) INIT('F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0'X);    02800000
*   DCL BUFPTR      PTR(31);                                            02810000
*  DCL INBUF CHAR(80) BASED(R9);                                        02820000
*  DCL  BUFFER CHAR(32767) BASED(BUFPTR);                               02830000
*  DCL RCODE FIXED(31) BDY(WORD) ;                                      02840000
*         DCL ON CHAR(1) INIT('FF'X);                                   02850000
*         DCL OFF CHAR(1) INIT('00'X);                                  02860000
*  DCL WKADDR CHAR(32767) BASED(GCADDR);                                02870000
*  DCL COPAT CHAR(27) INIT(' ½.<(+|&!$*);^-/,%_>?:#@''="');             02880000
*  DCL ALPAT CHAR(36) INIT('ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789');     02890000
*  DCL OPTPTR PTR(31);                                                  02900000
*  DCL PGPTR PTR(31);                                                   02910000
*  DCL OPTIONS CHAR(256) BASED(OPTPTR);                                 02920000
*  DCL PAGE CHAR(256) BASED(PGPTR);                                     02930000
*  DCL DDLST CHAR(256) BASED(DDPTR);                                    02940000
*  /******************************************************************* 02950000
*  /**                                                                * 02960000
*  /** THIS SECTION WILL CLOSE THE OUTPUT DCB DEFINED ON THE DSD CARD * 02970000
*  /** ITS ADDRESS IS CONTAINED IN FIRSTGMO.AFTER THE CLOSE THE BUFFER* 02980000
*  /** POOL IS FREED AND CORE IS FREED THAT HELD THE DCB.CODE IS      * 02990000
*  /** PRESENT FOR MORE THAN ONE OUTPUT DCB ALTHOUGH ONE OUTPUT       * 03000000
*  /** IS ALLOWED AT THE PRESENT TIME                                 * 03010000
*  /**                                                                * 03020000
*  /**    THIS SECTION CHECKS FOR MORE OUTPUT DCBS TO CLOSE.IF NONE A * 03030000
*  /** BRANCH IS TAKEN TO TEST FOR INPUT DCBS                         * 03040000
*  /**                                                                * 03050000
*  /******************************************************************* 03060000
*  A2J3:;                                                               03070000
*         IF FIRSTGMO = 0 THEN GO TO A2J4;                              03080000
A2J3     SR    @F,@F                                              0042  03090000
         C     @F,380(0,@5)                                       0042  03100000
         BC    08,A2J4                                            0043  03110000
*               DCBPTR = FIRSTGMO /**REINITILIZE DCB POINTER**/;        03120000
         MVC   300(4,@5),380(@5)                                  0044  03130000
*  /******************************************************************* 03140000
*  /**                                                                * 03150000
*  /**    THIS SECTION WILL INITILIZE THE DCB POINTER AND TEST FOR THE* 03160000
*  /** DCB BEING OPEN.IF NOT OPEN A BRANCH IS TAKEN AROUND THE CLOSE  * 03170000
*  /** AND FREEPOOL.IF OPEN THE LIST IS INITILIZED FOR CLOSE WITH     * 03180000
*  /** DISPOSITION FROM THE DD CARD AND THE CLOSE MACRO IS ISSUED.    * 03190000
*  /**                                                                * 03200000
*  /******************************************************************* 03210000
*         IF OFLGS(4) = '1'B THEN DO /** CLOSE DCB IF OPEN**/;          03220000
         L     @1,300(0,@5)                                       0045  03230000
         TM    48(@1),B'00010000'                                 0045  03240000
         BC    12,@9FF                                            0045  03250000
*               OPTBYTE1 = FIRSTGMO /* OUTPUT DCB ADDR TO CLOSE */;     03260000
         MVC   236(4,@5),380(@5)                                  0047  03270000
*         OPTBYTE1(1) = '8F'X;                                          03280000
         MVI   236(@5),X'8F'                                      0048  03290000
*  /** IF DCB IS OPEN OUTREC CONTAINS ADDRESS OF OUTPUT WORKAREA.    ** 03300000
*  /** ITS LENGTH IS IN GMLGTH FIELD OF DCB                           * 03310000
*               R7 = GMLGTH    /**PICK UP WORKAREA LENGTH**/;           03320000
         L     @1,300(0,@5)                                       0049  03330000
         LH    @7,276(0,@1)                                       0049  03340000
*         R6 = ADDR(OUTREC);                                            03350000
         LA    @6,308(0,@5)                                       0050  03360000
*         R1 = ADDR(GETMLIST)  /**  ADDRESS  THE GET MAIN LIST**/;      03370000
         LA    @1,364(0,@5)                                       0051  03380000
*     IF   OUTREC=0  THEN GO TO L1;                          /*A32655*/ 03390000
         SR    @F,@F                                              0052  03400000
         C     @F,308(0,@5)                                       0052  03410000
         BC    08,L1                                              0053  03420000
*                        /**   FREEMAIN FOR WORKAREA    **/;            03430000
*         GEN ( FREEMAIN E,LV=(R7),A=(R6),SP=0,MF=(E,(R1)));            03440000
          FREEMAIN E,LV=(R7),A=(R6),SP=0,MF=(E,(R1))                    03450000
         DS    0H                                                       03460000
*   L1:;                                                     /*A32655*/ 03470000
*         R1 = ADDR(OPENLIST);                                          03480000
L1       LA    @1,236(0,@5)                                       0057  03490000
*         GEN (CLOSE MF=(E,(1)));                                       03500000
         CLOSE MF=(E,(1))                                               03510000
         DS    0H                                                       03520000
*  GEN ( EJECT);                                                        03530000
          EJECT                                                         03540000
         DS    0H                                                       03550000
*  /******************************************************************* 03560000
*  /**                                                                * 03570000
*  /**    THIS SECTION ISSUES A FREEPOOL MACRO FOR THE DCB JUST CLOSED* 03580000
*  /** DATA MANAGENENT DOES NOT FREE ANY BUFFERS IT GETS FOR US.      * 03590000
*  /**                                                                * 03600000
*  /******************************************************************* 03610000
*               R1 = FIRSTGMO            /*OUTPUT DCBAD TO REGISTER*/;  03620000
         L     @1,380(0,@5)                                       0060  03630000
*                                        /* FREE THE BUFFER POOL*/      03640000
*         GEN ( FREEPOOL (R1));                                         03650000
          FREEPOOL (R1)                                                 03660000
         DS    0H                                                       03670000
*         END;                                                          03680000
*  /******************************************************************* 03690000
*  /**                                                                * 03700000
*  /**    THIS SECTION PLACES ADDRESS OF NEXTDCB IN FIRSTGMO POINTER  * 03710000
*  /** IF NO NEXTDCB BINARY ZEROS ARE PLACED IN FIRSTGMO AS  THE AREA * 03720000
*  /** FOR THE DCB WAS CLEARED TO BINARY ZEROS AFTER THE GETMAIN      * 03730000
*  /**                                                                * 03740000
*  /******************************************************************* 03750000
*               DCBPTR = FIRSTGMO        /* FILL DCBPTR WITH DCBADDR*/; 03760000
@9FF     MVC   300(4,@5),380(@5)                                  0063  03770000
*               FIRSTGMO = NEXTDCB       /*NEXT DCB ADDR TO FIRSTGMO*/; 03780000
         L     @1,300(0,@5)                                       0064  03790000
         MVC   380(4,@5),256(@1)                                  0064  03800000
*  /******************************************************************* 03810000
*  /**    THIS SECTION SETS UP REGISTERS AND ISSUES A FREEMAIN FOR 280* 03820000
*  /** BYTES.A FREEMAIN IS NEEDED EVEN IF A DCB WAS NOT OPEN.         * 03830000
*  /**                                                                * 03840000
*  /******************************************************************* 03850000
*               R6 = ADDR(DCBPTR)        /* CORE LIST ADDRESS*/;        03860000
         LA    @6,300(0,@5)                                       0065  03870000
*               R1 = ADDR(GETMLIST) /**ADDRESS THE GET MAIN LIST**/;    03880000
         LA    @1,364(0,@5)                                       0066  03890000
*                                        /*FREEMAIN FOR DCB*/           03900000
*         GEN ( FREEMAIN E,LV=280,A=(R6),SP=0,MF=(E,(R1)));             03910000
          FREEMAIN E,LV=280,A=(R6),SP=0,MF=(E,(R1))                     03920000
         DS    0H                                                       03930000
*  GEN ( EJECT);                                                        03940000
          EJECT                                                         03950000
         DS    0H                                                       03960000
*         IF FIRSTGMO ^= 0 THEN GO TO A2J3 /* BR MORE TO FREE*/;        03970000
         SR    @F,@F                                              0069  03980000
         C     @F,380(0,@5)                                       0069  03990000
         BC    07,A2J3                                            0070  04000000
*  /******************************************************************* 04010000
*  /**                                                                * 04020000
*  /** THIS SECTION WILL CLOSE ALL INPUT DCBS OPENED FOR THIS DSD     * 04030000
*  /** GROUP.EACH BUFFER POOL IS FREED AND DYNAMIC CORE RETURNED TO   * 04040000
*  /** THE SYSTEM.LINKAGE IS THROUGH FIRSTGMI AND NEXTDCB.LAST DCB    * 04050000
*  /** WILL HAVE BINARY ZEROS PRESENT IN NEXTDCB FIELD.CONTROL IS     * 04060000
*  /** RETURNED TO THE BASE MODULE WHEN FIRSTGMI IS ZERO.             * 04070000
*  /**                                                                * 04080000
*  /******************************************************************* 04090000
*  A2J4:;                                                               04100000
*  /******************************************************************* 04110000
*  /**                                                                * 04120000
*  /**    THIS SECTION WILL BRANCH TO A2J6 TO TEST FOR END OF DSD     * 04130000
*  /** GROUP IF THERE ARE NO INPUT DCBS TO CLOSE.                     * 04140000
*  /**                                                                * 04150000
*  /******************************************************************* 04160000
*         IF FIRSTGMI = 0 THEN GO TO A2J6 /**BRANCH NO MORE INPUT DCB** 04170000
A2J4     SR    @F,@F                                              0072  04180000
         C     @F,392(0,@5)                                       0072  04190000
         BC    08,A2J6                                            0073  04200000
*  A2J5:           DCBPTR = FIRSTGMI; /*REINITILIZE DCBPTR COR  A48773* 04210000
A2J5     MVC   300(4,@5),392(@5)                                  0074  04220000
*  /******************************************************************* 04230000
*  /**                                                                * 04240000
*  /**    IF INPUT DCB IS NOT OPEN A BRANCH IS TAKEN TO FREEMAIN      * 04250000
*  /**                                                                * 04260000
*  /******************************************************************* 04270000
*         IF OFLGS(4) = '1'B THEN DO /** CLOSE DCB IF OPEN**/;          04280000
         L     @1,300(0,@5)                                       0075  04290000
         TM    48(@1),B'00010000'                                 0075  04300000
         BC    12,@9FE                                            0075  04310000
*  /******************************************************************* 04320000
*  /**                                                                * 04330000
*  /**    THIS SECTION INITILIZES THE LIST FOR CLOSEING OF THE INPUT  * 04340000
*  /** DCB.DISPOSITION IS TAKEN FROM THE DD CARD.                     * 04350000
*  /**                                                                * 04360000
*  /******************************************************************* 04370000
*               OPTBYTE1 = FIRSTGMI      /* INPUT DCBAD TO LIST*/;      04380000
         MVC   236(4,@5),392(@5)                                  0077  04390000
*                                        /*  DECLARE OPTION FOR CLOSE*/ 04400000
*                                        /* TAKE DISP FROM DD CARD*/    04410000
*               OPTBYTE1(1) = '80'X      /*  OPTION = LAST,DISP*/;      04420000
         MVI   236(@5),X'80'                                      0078  04430000
*  /** IF INPUT DCB IS OPEN INREC CONTAINS ADDRESS OF INPUT WORKAREA  * 04440000
*  /** LENGTH IS TAKEN FROM GMLGTH OF DCB FOR FREEING                 * 04450000
*               R7 = GMLGTH    /**PICK UP WORKAREA LENGTH**/;           04460000
         L     @1,300(0,@5)                                       0079  04470000
         LH    @7,276(0,@1)                                       0079  04480000
*         R6 = ADDR(INREC) /**GET INPUT WORKAREA PTR**/;                04490000
         LA    @6,272(0,@1)                                       0080  04500000
*         R1 = ADDR(GETMLIST)  /**  ADDRESS  THE GET MAIN LIST**/;      04510000
         LA    @1,364(0,@5)                                       0081  04520000
*                        /**   FREEMAIN FOR WORKAREA    **/;            04530000
*         GEN ( FREEMAIN E,LV=(R7),A=(R6),SP=0,MF=(E,(R1)));            04540000
          FREEMAIN E,LV=(R7),A=(R6),SP=0,MF=(E,(R1))                    04550000
         DS    0H                                                       04560000
*               R1 = ADDR(OPENLIST)      /*LIST ADDR FOR CLOSE*/;       04570000
         LA    @1,236(0,@5)                                       0084  04580000
*         GEN ( CLOSE MF=(E,(1)));                                      04590000
          CLOSE MF=(E,(1))                                              04600000
         DS    0H                                                       04610000
*                   /* DCB NOW CLOSED */                                04620000
*  GEN ( EJECT);                                                        04630000
          EJECT                                                         04640000
         DS    0H                                                       04650000
*  /******************************************************************* 04660000
*  /**    THIS SECTION FREES THE BUFFERS GOTTEN BY DATA MANAGEMENT.   * 04670000
*  /******************************************************************* 04680000
*               R1 = FIRSTGMI /*INPUT DCB TO REGISTER*/;                04690000
         L     @1,392(0,@5)                                       0087  04700000
*                                        /* FREE THE BUFFER POOL*/      04710000
*         GEN ( FREEPOOL (R1));                                         04720000
          FREEPOOL (R1)                                                 04730000
         DS    0H                                                       04740000
*         END;                                                          04750000
*  /******************************************************************* 04760000
*  /**    THIS SECTION INITILIZES THE POINTER TO THE NEXT DCB AND SETS* 04770000
*  /** UP REGISTERS FOR A FREEMAIN OF 280 BYTES USED FOR THE DCB.     * 04780000
*  /******************************************************************* 04790000
*               DCBPTR = FIRSTGMI        /* ADDRESS THE DCB */;         04800000
@9FE     MVC   300(4,@5),392(@5)                                  0090  04810000
*               FIRSTGMI = NEXTDCB       /*NEXT DCB ADDR TO FIRSTGMI*/; 04820000
         L     @1,300(0,@5)                                       0091  04830000
         MVC   392(4,@5),256(@1)                                  0091  04840000
*               R6 = ADDR(DCBPTR)        /* CORE LIST ADDRESS*/;        04850000
         LA    @6,300(0,@5)                                       0092  04860000
*               R1 = ADDR(GETMLIST) /**ADDRESS THE GET MAIN LIST**/;    04870000
         LA    @1,364(0,@5)                                       0093  04880000
*         GEN ( FREEMAIN E,LV=280,A=(R6),SP=0,MF=(E,(R1)));             04890000
          FREEMAIN E,LV=280,A=(R6),SP=0,MF=(E,(R1))                     04900000
         DS    0H                                                       04910000
*         IF FIRSTGMI ^= 0 THEN GO TO A2J5 /*BR IF MORE TO FREE*/;      04920000
         SR    @F,@F                                              0095  04930000
         C     @F,392(0,@5)                                       0095  04940000
         BC    07,A2J5                                            0096  04950000
*  GEN ( EJECT);                                                        04960000
          EJECT                                                         04970000
         DS    0H                                                       04980000
*  /******************************************************************* 04990000
*  /**                                                                * 05000000
*  /**    THIS SECTION WILL TEST FOR ENTRY AS A RESULT OF FINDING AN  * 05010000
*  /** END CARD IN THE INPUT STREAM.IF END IS PRESENT WE DO NOT CLOSE * 05020000
*  /** THE DATA GENERATOR INPUT AND OUTPUT DCBS AS THEY MAY BE NEEDED * 05030000
*  /** FOR MORE DSD GROUPS.CONTROL RETURNS TO THE BASE MODULE IN THIS * 05040000
*  /** CASE.WHEN ENTRY IS A RESULT OF FINDING THE SYSIN DELIMITER CARD* 05050000
*  /** FIRSTGMO AND FIRSTGMI SHOULD BE ZERO.WE ARE  DEFINED IN THE SRL* 05060000
*  /** AS REQUIREING AN END CARD FOR EACH GROUP,HOWEVER IF ONE IS NOT * 05070000
*  /** PRESENT FOR THE LAST GROUP,THE USER DCBS GET CLOSED ANYWAY     * 05080000
*  /**                                                                * 05090000
*  /******************************************************************* 05100000
*  A2J6:;                                                               05110000
*  /** THIS SECTION WILL PLACE FOXES IN NAME FIELDS OF FDTBLS THAT    * 05120000
*  /** WERE USED FOR FIELD SELECTION.SELECTION IS INDICATED BY A NAME * 05130000
*  /** IN THE FDREPNM FIELD.THIS MUST BE DONE SO THAT THE USER MAY    * 05140000
*  /** NEVER ACCESS THE NAME IN ANOTHER DSD GROUP.THE FROMAD IS       * 05150000
*  /** DYNAMIC AS INREC WAS GOTTEN WHEN THE DCB WAS OPENED.THE RECORD * 05160000
*  /** IS READ INTO INREC BY THE 'GET' OF THE CREATE MODULE.INREC HAS * 05170000
*  /** BEEN FREED SO IT CAN BE SEEN THAT IF THE NAME WAS ACCESSED IN  * 05180000
*  /** ANOTHER DSD GROUP THAT INCORRECT INFORMATION WOULD BE OBTAINED * 05190000
*  /** THE DATA SETS MUST BE REDEFINED FOR EACH DSD GROUP AS THEY ARE * 05200000
*  /** FREED BY THIS MODULE.SYSIN DOESNT NEED REDEFINING BUT ANY      * 05210000
*  /** RECORD SELECTION ASSOCIATED WITH INPUT MUST BE REDEFINED       * 05220000
*  /**  FD NAMES THAT ARE BE BLANKED OUT MUST BE REDEFINED IF USED    * 05230000
*  /** AGAIN.                                                         * 05240000
*  /**                                                                * 05250000
*      IF FDPTR1 ^= 0 THEN DO /* DO IF FDPTR IS NOT ZERO    A36081 */;  05260000
A2J6     SR    @F,@F                                              0099  05270000
         C     @F,600(0,@5)                                       0099  05280000
         BC    08,@9FD                                            0099  05290000
*               R7 = FDPTR1    /** PICK UP FIRST TABLE ADDRESS **/;     05300000
         L     @7,600(0,@5)                                       0101  05310000
*  A2J64:;                                                              05320000
*               R6 = R7        /** COPY TABLE ADDRESS **/;              05330000
A2J64    LR    @6,@7                                              0103  05340000
*  /**LMOVED IS USED AS COUNTER,IT IS INIT TO ZERO WHEN USED ELSEWHERE* 05350000
*               LMOVED = 0     /** INIT COUNTER FOR SCAN**/;            05360000
         SR    @F,@F                                              0104  05370000
         STH   @F,620(0,@5)                                       0104  05380000
*  A2J65:;                                                              05390000
*   /**  IF NAME IS PRESENT DO BELOW**/                                 05400000
*               LMOVED = LMOVED + 1 ; /* ADD ONE TO COUNTER A48747 */   05410000
A2J65    LA    @F,1                                               0106  05420000
         AH    @F,620(0,@5)                                       0106  05430000
         STH   @F,620(0,@5)                                       0106  05440000
*       IF R6 -> FDREPNM(1) ^= '00'X THEN DO; /* IF INPUT DO BELOW */   05450000
         CLI   8(@6),X'00'                                        0107  05460000
         BC    08,@9FC                                            0107  05470000
*         R6 -> FDNAME = 'FFFFFFFFFFFFFFFF'X /** FOXES TO NAME FIELD**/ 05480000
         MVC   0(8,@6),@X5                                        0109  05490000
*         END;                                                          05500000
*         IF LMOVED ^= 8 THEN DO /** BR IF NOT AT END OF TABLE**/;      05510000
@9FC     LA    @F,8                                               0111  05520000
         CH    @F,620(0,@5)                                       0111  05530000
         BC    08,@9FB                                            0111  05540000
*               R6 = R6 + 64   /** POINTER TO NEXT SECTION **/;         05550000
         AH    @6,@D1                                             0113  05560000
*               GO TO A2J65    /** BRANCH TO KEEP LOOKING**/;           05570000
         BC    15,A2J65                                           0114  05580000
*         END;                                                          05590000
*    /**  BRANCH IF DONE**/                                             05600000
*         IF R7 -> FDTBL(517:520) = '00000000'X THEN GO TO A2J66 ;      05610000
@9FB     CLC   516(4,@7),@X6                                      0116  05620000
         BC    08,A2J66                                           0117  05630000
*         R7 = R7 -> FDTBL(517:520) /**PICK UP NEXT TABLE ADDRESS**/;   05640000
         L     @7,516(0,@7)                                       0118  05650000
*               GO TO A2J64         /**BR TO START LOOKING AGAIN**/;    05660000
         BC    15,A2J64                                           0119  05670000
*       END;                                                            05680000
*  A2J66:;                                                              05690000
@9FD     EQU   *                                                  0121  05700000
*         IF ENDSW = ON THEN GO TO A2J7 /** BR NOT END OF JOB**/;       05710000
A2J66    CLC   564(1,@5),ON                                       0122  05720000
         BC    08,A2J7                                            0123  05730000
*  /******************************************************************* 05740000
*  /**    THIS SECTION FREES CORE OBTAINED FOR THE FD TABLES.AT ENTRY * 05750000
*  /** FDPTR1 CONTAINS ADDRESS OF FIRST FD TABLE.LINK ADDRESS TO THE  * 05760000
*  /** NEXT FD TABLE IS MAINTAINED AT BYTE LOCATION 517-520 OF CURRENT* 05770000
*  /** TABLE.THIS LOCATION WILL BE ZERO WHEN WE ARE ADDRESSING THE    * 05780000
*  /** LAST TABLE                                                     * 05790000
*  /******************************************************************* 05800000
*  A2J67:;                                                              05810000
*         IF FDPTR1 ^= 0 THEN DO /** DO BELOW IF FDPTR NOT ZERO**/;     05820000
A2J67    SR    @F,@F                                              0125  05830000
         C     @F,600(0,@5)                                       0125  05840000
         BC    08,@9FA                                            0125  05850000
*         R6 = ADDR(FDPTR1) /** PICK UP FDPTR**/;                       05860000
         LA    @6,600(0,@5)                                       0127  05870000
*         FDPTR = FDPTR1  /** PICKUP ADDRESS NEXT FDTABEL**/ ;          05880000
         MVC   596(4,@5),600(@5)                                  0128  05890000
*  LMOVED = 0 ;                   /** SET COUNTER TO ZERO       A50950  05900000
         SR    @F,@F                                              0129  05910000
         STH   @F,620(0,@5)                                       0129  05920000
*  A2J67A:;                                                             05930000
*              IF FDACTION = 'RO' THEN DO;   /* ROLL ACTION     A50950* 05940000
A2J67A   L     @1,596(0,@5)                                       0131  05950000
         CLC   28(2,@1),@C7                                       0131  05960000
         BC    07,@9F9                                            0131  05970000
*                 FDFROMAD = FDFROMAD - FDLGTH ; /* RESET POINT A50950* 05980000
         LH    @F,24(0,@1)                                        0133  05990000
         LCR   @F,@F                                              0133  06000000
         AL    @F,44(0,@1)                                        0133  06010000
         ST    @F,44(0,@1)                                        0133  06020000
*              END;                        /*TO START OF FIELD  A50950* 06030000
*          R7 = ADDR(FDFROMAD) ;  /** R7 WITH THE FD FLD ADDR.  A50950  06040000
@9F9     L     @1,596(0,@5)                                       0135  06050000
         LA    @7,44(0,@1)                                        0135  06060000
* GENERATE(  SR  8,8);                  /* CLEAR REG 8        @ZA07345* 06070000
           SR  8,8                                                      06080000
         DS    0H                                                       06090000
* GENERATE(  ICM 8,3,60(1));       /* GET LENGTH OF FD FIELD  @ZA07345* 06100000
           ICM 8,3,60(1)                                                06110000
         DS    0H                                                       06120000
*             IF R8 ^= 0 THEN DO ;   /** IS A FD FLD PRESENT ?  A50950  06130000
         LTR   @8,@8                                              0138  06140000
         BC    08,@9F8                                            0138  06150000
*                R1 = ADDR(GETMLIST) ;   /** THEN DO            A50950  06160000
         LA    @1,364(0,@5)                                       0140  06170000
*                GEN ( FREEMAIN E,LV=(R8),A=(R7),SP=0,MF=(E,(R1))) ;    06180000
          FREEMAIN E,LV=(R8),A=(R7),SP=0,MF=(E,(R1))                    06190000
         DS    0H                                                       06200000
*                                                            /* A50950  06210000
*             END ;                                          /* A50950  06220000
*             FDPTR = FDPTR+64 ;     /** GET NEXT FD FLD ADDR.  A50950  06230000
@9F8     LA    @F,64                                              0143  06240000
         A     @F,596(0,@5)                                       0143  06250000
         ST    @F,596(0,@5)                                       0143  06260000
*             LMOVED = LMOVED + 1 ;        /** UPDATE COUNTER   A50950  06270000
         LA    @F,1                                               0144  06280000
         AH    @F,620(0,@5)                                       0144  06290000
         STH   @F,620(0,@5)                                       0144  06300000
*                IF LMOVED ^= 8 THEN DO ;  /** 8 FD FLDS HAD ?  A50950  06310000
         LA    @F,8                                               0145  06320000
         CH    @F,620(0,@5)                                       0145  06330000
*                   GO TO A2J67A ;   /** NO, FREEM. NEXT FD FLD A50950  06340000
         BC    07,A2J67A                                          0147  06350000
*                END ;               /** YES, CONTINUE          A50950  06360000
*         FDPTR = FDPTR1 ;   /** PICKUP ADDRESS NEXT FDTABEL    A50950  06370000
@9F7     MVC   596(4,@5),600(@5)                                  0149  06380000
*         FDPTR = FDTBL(517:520) ;                                      06390000
         L     @1,596(0,@5)                                       0150  06400000
         L     @F,516(0,@1)                                       0150  06410000
         ST    @F,596(0,@5)                                       0150  06420000
*        R1 = ADDR(GETMLIST)  /** ADDRESS THE GET MAIN LIST **/ ;       06430000
         LA    @1,364(0,@5)                                       0151  06440000
*         GEN ( FREEMAIN E,LV=520,A=(R6),SP=0,MF=(E,(R1)));             06450000
          FREEMAIN E,LV=520,A=(R6),SP=0,MF=(E,(R1))                     06460000
         DS    0H                                                       06470000
*         FDPTR1 = FDPTR ;                                              06480000
         MVC   600(4,@5),596(@5)                                  0153  06490000
*         GO TO A2J67 /** FREE NEXT FDTBL AREA **/ ;                    06500000
         BC    15,A2J67                                           0154  06510000
*         END ;                                                         06520000
*  /******************************************************************* 06530000
*  /**    THIS SECTION WILL CLOSE AND FREEPOOL THE SYSI DCB OF THE    * 06540000
*  /** DATA GENERATOR.                                                * 06550000
*  /******************************************************************* 06560000
*               DCBPTR = ADDR(SYSI) /**PICK UP SYSI DCB ADDRESS**/;     06570000
@9FA     LA    @F,116(0,@5)                                       0156  06580000
         ST    @F,300(0,@5)                                       0156  06590000
*         IF OFLGS(4) = '1'B THEN DO /**BRANCH IF DCB NOT OPENED**/;    06600000
         L     @1,300(0,@5)                                       0157  06610000
         TM    48(@1),B'00010000'                                 0157  06620000
         BC    12,@9F6                                            0157  06630000
*               OPTBYTE1 = DCBPTR /**DCB ADDRESS TO LIST**/;            06640000
         MVC   236(4,@5),300(@5)                                  0159  06650000
*               OPTBYTE1(1) = '80'X /** INITILIZE OPTIONS**/;           06660000
         MVI   236(@5),X'80'                                      0160  06670000
*               R1 = ADDR(OPENLIST) /**ADDRESS THE LIST**/;             06680000
         LA    @1,236(0,@5)                                       0161  06690000
*         GEN ( CLOSE MF=(E,(R1)));                                     06700000
          CLOSE MF=(E,(R1))                                             06710000
         DS    0H                                                       06720000
*               R1 = DCBPTR    /**PICK UP DCB ADDRESS**/;               06730000
         L     @1,300(0,@5)                                       0163  06740000
*         GEN ( FREEPOOL (R1));                                         06750000
          FREEPOOL (R1)                                                 06760000
         DS    0H                                                       06770000
*         END;                                                          06780000
*  GEN ( EJECT);                                                        06790000
@9F6     EQU   *                                                  0166  06800000
          EJECT                                                         06810000
         DS    0H                                                       06820000
*  /******************************************************************* 06830000
*  /**    THIS SECTION WILL CLOSE AND FREEPOOL THE SYSP DCB OF THE    * 06840000
*  /** DATA GENERATOR.                                                * 06850000
*  /******************************************************************* 06860000
*               DCBPTR = ADDR(SYSP) /**PICK UP SYSP DCB ADDRESS**/;     06870000
         LA    @F,20(0,@5)                                        0167  06880000
         ST    @F,300(0,@5)                                       0167  06890000
*         IF OFLGS(4) = '1'B THEN DO /**BRANCH IF DCB NOT OPEN**/;      06900000
         L     @1,300(0,@5)                                       0168  06910000
         TM    48(@1),B'00010000'                                 0168  06920000
         BC    12,@9F5                                            0168  06930000
*               OPTBYTE1 = DCBPTR /**DCB ADDRESS TO LIST**/;            06940000
         MVC   236(4,@5),300(@5)                                  0170  06950000
*               OPTBYTE1(1) = '8F'X /**INITILIZE OPTIONS**/;            06960000
         MVI   236(@5),X'8F'                                      0171  06970000
*               R1 = ADDR(OPENLIST) /**ADDRESS THE LIST**/;             06980000
         LA    @1,236(0,@5)                                       0172  06990000
*         GEN ( CLOSE MF=(E,(R1)));                                     07000000
          CLOSE MF=(E,(R1))                                             07010000
         DS    0H                                                       07020000
*               R1 = DCBPTR /**PICK UP DCB ADDRESS**/;                  07030000
         L     @1,300(0,@5)                                       0174  07040000
*         GEN (FREEPOOL (R1));                                          07050000
         FREEPOOL (R1)                                                  07060000
         DS    0H                                                       07070000
*         END;                                                          07080000
*  GEN ( EJECT);                                                        07090000
@9F5     EQU   *                                                  0177  07100000
          EJECT                                                         07110000
         DS    0H                                                       07120000
*  /******************************************************************* 07130000
*  /******************************************************************* 07140000
*  /** ***** NOTICE THERE IS NO FREEMAIN FOR THE SYSI AND SYSP DCBS.  * 07150000
*  /** ***** THEY EXIST IN THE COMMON AREA WHICH IS FREED WHEN A      * 07160000
*  /** ***** RETURN IS GIVEN FROM THE BASE MODULE.                    * 07170000
*  /******************************************************************* 07180000
*  /******************************************************************* 07190000
*  A2J7:;                                                               07200000
*         RETURN;                                                       07210000
*         END IEBDGCUP;                                                 07220000
@EL01    L     @D,4(0,@D)                                         0180  07230000
         LR    @1,@C                                              0180  07240000
         L     @0,@SIZ001                                         0180  07250000
         FREEMAIN R,LV=(0),A=(1)                                  0180  07260000
         L     @E,12(0,@D)                                        0180  07270000
         LM    @0,@8,20(@D)                                       0180  07280000
         LM    @A,@C,60(@D)                                       0180  07290000
         BCR   15,@E                                              0180  07300000
@DATA1   EQU   *                                                        07310000
@0       EQU   00                  EQUATES FOR REGISTERS 0-15           07320000
@1       EQU   01                                                       07330000
@2       EQU   02                                                       07340000
@3       EQU   03                                                       07350000
@4       EQU   04                                                       07360000
@5       EQU   05                                                       07370000
@6       EQU   06                                                       07380000
@7       EQU   07                                                       07390000
@8       EQU   08                                                       07400000
@9       EQU   09                                                       07410000
@A       EQU   10                                                       07420000
@B       EQU   11                                                       07430000
@C       EQU   12                                                       07440000
@D       EQU   13                                                       07450000
@E       EQU   14                                                       07460000
@F       EQU   15                                                       07470000
@D1      DC    H'64'                                                    07480000
         DS    0F                                                       07490000
@SIZ001  DC    AL1(&SPN)                                                07500000
         DC    AL3(@DATEND-@DATD)                                       07510000
         DS    0F                                                       07520000
@X5      DC    X'FFFFFFFFFFFFFFFF'                                      07530000
@X6      DC    X'00000000'                                              07540000
@C7      DC    C'RO'                                                    07550000
         DS    0D                                                       07560000
@DATA    EQU   *                                                        07570000
R14      EQU   00000014            FULLWORD INTEGER REGISTER            07580000
R15      EQU   00000015            FULLWORD INTEGER REGISTER            07590000
R0       EQU   00000000            FULLWORD INTEGER REGISTER            07600000
R1       EQU   00000001            FULLWORD INTEGER REGISTER            07610000
R2       EQU   00000002            FULLWORD INTEGER REGISTER            07620000
R3       EQU   00000003            FULLWORD INTEGER REGISTER            07630000
R5       EQU   00000005            FULLWORD POINTER REGISTER            07640000
R6       EQU   00000006            FULLWORD POINTER REGISTER            07650000
R7       EQU   00000007            FULLWORD POINTER REGISTER            07660000
R8       EQU   00000008            FULLWORD POINTER REGISTER            07670000
R9       EQU   00000009            FULLWORD POINTER REGISTER            07680000
COMMON   EQU   00000000            308 BYTE(S) ON DWORD                 07690000
PAGENO   EQU   COMMON+00000000     4 BYTE(S)                            07700000
LINECT   EQU   COMMON+00000004     FULLWORD INTEGER                     07710000
LINECTR  EQU   COMMON+00000008     FULLWORD INTEGER                     07720000
PARM     EQU   COMMON+00000012     FULLWORD POINTER                     07730000
REPEATNO EQU   COMMON+00000016     HALFWORD INTEGER                     07740000
CREATENO EQU   COMMON+00000018     HALFWORD INTEGER                     07750000
SYSP     EQU   COMMON+00000020     96 BYTE(S)                           07760000
SYSI     EQU   COMMON+00000116     96 BYTE(S)                           07770000
Q        EQU   COMMON+00000216     16 BYTE(S) ON DWORD                  07780000
QFILL    EQU   COMMON+00000216     7 BYTE(S)                            07790000
QSIGN    EQU   COMMON+00000223     8 BIT(S)                             07800000
QFILL1   EQU   COMMON+00000224     7 BYTE(S)                            07810000
QSIGN1   EQU   COMMON+00000231     8 BIT(S)                             07820000
COUNTER  EQU   COMMON+00000232     FULLWORD POINTER                     07830000
OPENLIST EQU   COMMON+00000236     8 BYTE(S)                            07840000
OPTBYTE1 EQU   COMMON+00000236     4 BYTE(S)                            07850000
OPTBYTE2 EQU   COMMON+00000240     4 BYTE(S)                            07860000
EXLST    EQU   COMMON+00000244     24 BYTE(S) ON WORD                   07870000
INHDR    EQU   COMMON+00000244     1 BYTE(S)                            07880000
INHDR1   EQU   COMMON+00000245     3  BYTE  POINTER ON WORD+1           07890000
OUTHDR   EQU   COMMON+00000248     1 BYTE(S)                            07900000
OUTHDR1  EQU   COMMON+00000249     3  BYTE  POINTER ON WORD+1           07910000
INTRL    EQU   COMMON+00000252     1 BYTE(S)                            07920000
INTRL1   EQU   COMMON+00000253     3  BYTE  POINTER ON WORD+1           07930000
OUTTRL   EQU   COMMON+00000256     1 BYTE(S)                            07940000
OUTTRL1  EQU   COMMON+00000257     3  BYTE  POINTER ON WORD+1           07950000
EXITDCB  EQU   COMMON+00000260     1 BYTE(S)                            07960000
EXITDCB1 EQU   COMMON+00000261     3  BYTE  POINTER ON WORD+1           07970000
TOTAL    EQU   COMMON+00000264     1 BYTE(S)                            07980000
TOTAL1   EQU   COMMON+00000265     3  BYTE  POINTER ON WORD+1           07990000
EXLST1   EQU   COMMON+00000268     4 BYTE(S) ON WORD                    08000000
EDCB1    EQU   COMMON+00000268     1 BYTE(S)                            08010000
EDCB2    EQU   COMMON+00000269     3  BYTE  POINTER ON WORD+1           08020000
EXLST2   EQU   COMMON+00000272     4 BYTE(S) ON WORD                    08030000
EDCB3    EQU   COMMON+00000272     1 BYTE(S)                            08040000
EDCB4    EQU   COMMON+00000273     3  BYTE  POINTER ON WORD+1           08050000
EXLST3   EQU   COMMON+00000276     4 BYTE(S) ON WORD                    08060000
EDCB5    EQU   COMMON+00000276     1 BYTE(S)                            08070000
EDCB6    EQU   COMMON+00000277     3  BYTE  POINTER ON WORD+1           08080000
DLRECL   EQU   COMMON+00000280     HALFWORD INTEGER                     08090000
DBLKSI   EQU   COMMON+00000282     HALFWORD INTEGER                     08100000
DRECFM   EQU   COMMON+00000284     8 BIT(S)                             08110000
LEFTOVER EQU   COMMON+00000288     FULLWORD INTEGER                     08120000
OFFSET   EQU   COMMON+00000292     FULLWORD POINTER                     08130000
LPTR     EQU   COMMON+00000296     FULLWORD POINTER                     08140000
DCBPTR   EQU   COMMON+00000300     FULLWORD POINTER                     08150000
DUMMY    EQU   COMMON+00000304     FULLWORD POINTER                     08160000
COMMON1  EQU   00000304            236 BYTE(S) ON WORD                  08170000
SAVEMS   EQU   COMMON1+00000000    HALFWORD INTEGER                     08180000
CONCODE  EQU   COMMON1+00000002    HALFWORD INTEGER                     08190000
OUTREC   EQU   COMMON1+00000004    FULLWORD POINTER                     08200000
CRTABPT  EQU   COMMON1+00000008    FULLWORD POINTER                     08210000
CURCRTE  EQU   COMMON1+00000012    FULLWORD POINTER                     08220000
CURCRGM  EQU   COMMON1+00000016    FULLWORD POINTER                     08230000
CURPIC   EQU   COMMON1+00000020    FULLWORD POINTER                     08240000
PICCTR   EQU   COMMON1+00000024    FULLWORD INTEGER                     08250000
EXITTAB  EQU   COMMON1+00000028    FULLWORD POINTER                     08260000
EXITGM   EQU   COMMON1+00000032    FULLWORD POINTER                     08270000
CUREXIT  EQU   COMMON1+00000036    FULLWORD POINTER                     08280000
DELIM    EQU   COMMON1+00000040    4 BYTE(S)                            08290000
RECREM   EQU   COMMON1+00000044    FULLWORD INTEGER                     08300000
CURFD    EQU   COMMON1+00000048    FULLWORD POINTER                     08310000
CUROUT   EQU   COMMON1+00000052    FULLWORD POINTER                     08320000
SAVE14   EQU   COMMON1+00000056    FULLWORD POINTER                     08330000
GETMLIST EQU   COMMON1+00000060    16 BYTE(S) ON WORD                   08340000
GLENGTH  EQU   COMMON1+00000060    FULLWORD INTEGER                     08350000
ADRLIST  EQU   COMMON1+00000064    FULLWORD POINTER                     08360000
IND      EQU   COMMON1+00000068    4 BYTE(S)                            08370000
GCODE    EQU   COMMON1+00000068    1 BYTE(S)                            08380000
SPOOL    EQU   COMMON1+00000069    1 BYTE(S)                            08390000
CCODE    EQU   COMMON1+00000070    2 BYTE(S)                            08400000
GCADDR   EQU   COMMON1+00000072    FULLWORD POINTER                     08410000
FIRSTGMO EQU   COMMON1+00000076    FULLWORD POINTER                     08420000
CURRGMO  EQU   COMMON1+00000080    FULLWORD POINTER                     08430000
LASTGMO  EQU   COMMON1+00000084    FULLWORD POINTER                     08440000
FIRSTGMI EQU   COMMON1+00000088    FULLWORD POINTER                     08450000
CURRGMI  EQU   COMMON1+00000092    FULLWORD POINTER                     08460000
LASTGMI  EQU   COMMON1+00000096    FULLWORD POINTER                     08470000
CONDCODE EQU   COMMON1+00000100    HALFWORD INTEGER                     08480000
MS       EQU   COMMON1+00000102    HALFWORD INTEGER                     08490000
INBUFA1  EQU   COMMON1+00000104    121 BYTE(S)                          08500000
INFILL   EQU   COMMON1+00000104    10 BYTE(S)                           08510000
INBUFA   EQU   COMMON1+00000114    111 BYTE(S)                          08520000
DDPTR    EQU   COMMON1+00000228    FULLWORD POINTER                     08530000
DUMMY1   EQU   COMMON1+00000232    FULLWORD POINTER                     08540000
COMMON2  EQU   00000536            76 BYTE(S) ON WORD                   08550000
SWITCH   EQU   COMMON2+00000000    52 BYTE(S)                           08560000
FDCSW    EQU   COMMON2+00000000    1 BYTE(S)                            08570000
FDNAMESW EQU   COMMON2+00000001    1 BYTE(S)                            08580000
FDPCSW   EQU   COMMON2+00000002    1 BYTE(S)                            08590000
FDFMTSW  EQU   COMMON2+00000003    1 BYTE(S)                            08600000
FDPLSW   EQU   COMMON2+00000004    1 BYTE(S)                            08610000
RANGESW  EQU   COMMON2+00000005    1 BYTE(S)                            08620000
FILLSW   EQU   COMMON2+00000006    1 BYTE(S)                            08630000
REPSW    EQU   COMMON2+00000007    1 BYTE(S)                            08640000
INDEXSW  EQU   COMMON2+00000008    1 BYTE(S)                            08650000
INDNMSW  EQU   COMMON2+00000009    1 BYTE(S)                            08660000
BQUOTESW EQU   COMMON2+00000010    1 BYTE(S)                            08670000
PQUOTESW EQU   COMMON2+00000011    1 BYTE(S)                            08680000
EQUOTESW EQU   COMMON2+00000012    1 BYTE(S)                            08690000
FDSW     EQU   COMMON2+00000013    1 BYTE(S)                            08700000
DSDSW    EQU   COMMON2+00000014    1 BYTE(S)                            08710000
NOGOSW   EQU   COMMON2+00000015    1 BYTE(S)                            08720000
CREATESW EQU   COMMON2+00000016    1 BYTE(S)                            08730000
DSDCSW   EQU   COMMON2+00000017    1 BYTE(S)                            08740000
CRCSW    EQU   COMMON2+00000018    1 BYTE(S)                            08750000
EXITSW   EQU   COMMON2+00000019    1 BYTE(S)                            08760000
EODSTOP  EQU   COMMON2+00000020    1 BYTE(S)                            08770000
DSDNULSW EQU   COMMON2+00000021    1 BYTE(S)                            08780000
DSDORGSW EQU   COMMON2+00000022    1 BYTE(S)                            08790000
DSDDDSW  EQU   COMMON2+00000023    1 BYTE(S)                            08800000
CRTBLK   EQU   COMMON2+00000024    1 BYTE(S)                            08810000
NAMCSW   EQU   COMMON2+00000025    8 BIT(S)                             08820000
PICCSW   EQU   COMMON2+00000026    8 BIT(S)                             08830000
BUFPSW   EQU   COMMON2+00000027    1 BYTE(S)                            08840000
ENDSW    EQU   COMMON2+00000028    1 BYTE(S)                            08850000
COMCSW   EQU   COMMON2+00000029    1 BYTE(S)                            08860000
FLAGSW   EQU   COMMON2+00000030    8 BIT(S)                             08870000
PAGESW   EQU   COMMON2+00000031    1 BYTE(S)                            08880000
EPSW     EQU   COMMON2+00000032    1  BYTE  POINTER                     08890000
SYSISW   EQU   COMMON2+00000033    1 BYTE(S)                            08900000
SYSPSW   EQU   COMMON2+00000034    1 BYTE(S)                            08910000
OLDNEWSW EQU   COMMON2+00000035    1 BYTE(S)                            08920000
FLUSHSW  EQU   COMMON2+00000036    1 BYTE(S)                            08930000
FLUSHSW1 EQU   COMMON2+00000037    1 BYTE(S)                            08940000
DSDOSW   EQU   COMMON2+00000038    1 BYTE(S)                            08950000
DSDISW   EQU   COMMON2+00000039    1 BYTE(S)                            08960000
QUANSW   EQU   COMMON2+00000040    1 BYTE(S)                            08970000
PARENSW  EQU   COMMON2+00000041    1 BYTE(S)                            08980000
REPEATSW EQU   COMMON2+00000042    1 BYTE(S)                            08990000
FDPLGTH  EQU   COMMON2+00000052    HALFWORD INTEGER                     09000000
SGCADDR  EQU   COMMON2+00000056    FULLWORD POINTER                     09010000
FDPTR    EQU   COMMON2+00000060    FULLWORD POINTER                     09020000
FDPTR1   EQU   COMMON2+00000064    FULLWORD POINTER                     09030000
FDPTR2   EQU   COMMON2+00000068    FULLWORD POINTER                     09040000
DUMMY2   EQU   COMMON2+00000072    FULLWORD POINTER                     09050000
COMMON3  EQU   00000608            188 BYTE(S) ON WORD                  09060000
FDCTR    EQU   COMMON3+00000000    HALFWORD POINTER                     09070000
LREMAIN  EQU   COMMON3+00000004    FULLWORD POINTER                     09080000
COMPCTR  EQU   COMMON3+00000008    FULLWORD POINTER                     09090000
LMOVED   EQU   COMMON3+00000012    HALFWORD POINTER                     09100000
U        EQU   COMMON3+00000016    FULLWORD POINTER                     09110000
PICEND   EQU   COMMON3+00000020    HALFWORD POINTER                     09120000
CURFDGM  EQU   COMMON3+00000024    FULLWORD POINTER                     09130000
SWTCH    EQU   COMMON3+00000028    4 BYTE(S) ON WORD                    09140000
SYSINSEL EQU   COMMON3+00000028    1 BYTE(S)                            09150000
FIRSTSW  EQU   COMMON3+00000029    1 BYTE(S)                            09160000
FRSTSW   EQU   COMMON3+00000030    1 BYTE(S)                            09170000
STOPSW   EQU   COMMON3+00000031    1 BYTE(S)                            09180000
COPYVAL  EQU   COMMON3+00000032    HALFWORD INTEGER                     09190000
COPYFD   EQU   COMMON3+00000036    FULLWORD POINTER                     09200000
COPYFDGM EQU   COMMON3+00000040    FULLWORD POINTER                     09210000
NAMCTR   EQU   COMMON3+00000044    HALFWORD INTEGER                     09220000
NAMCTR1  EQU   COMMON3+00000046    HALFWORD INTEGER                     09230000
INRECSZ  EQU   COMMON3+00000048    HALFWORD POINTER                     09240000
OUTRECSZ EQU   COMMON3+00000050    HALFWORD POINTER                     09250000
INRECFM  EQU   COMMON3+00000052    1 BYTE(S)                            09260000
RECOFFST EQU   COMMON3+00000053    1  BYTE  POINTER                     09270000
OUTRECFM EQU   COMMON3+00000054    1 BYTE(S)                            09280000
PICBASE  EQU   COMMON3+00000056    FULLWORD POINTER                     09290000
MESSAGE  EQU   COMMON3+00000060    121 BYTE(S)                          09300000
DUMMY3   EQU   COMMON3+00000184    FULLWORD POINTER                     09310000
DCBD     EQU   00000000            280 BYTE(S) ON DWORD                 09320000
FILL     EQU   DCBD+00000000       26 BYTE(S)                           09330000
DSORG1   EQU   DCBD+00000026       2 BYTE(S)                            09340000
DSORG    EQU   DCBD+00000026       8 BIT(S)                             09350000
FILLER   EQU   DCBD+00000028       8 BYTE(S)                            09360000
IOBAD    EQU   DCBD+00000028       4 BYTE(S)                            09370000
BFTEK    EQU   DCBD+00000032       8 BIT(S)                             09380000
EODAD    EQU   DCBD+00000033       3 BYTE(S)                            09390000
RECFM    EQU   DCBD+00000036       8 BIT(S)                             09400000
EXLIST   EQU   DCBD+00000037       3  BYTE  POINTER ON WORD+1           09410000
DDNAME   EQU   DCBD+00000040       8 BYTE(S)                            09420000
DEBAD    EQU   DCBD+00000040       4 BYTE(S)                            09430000
IFLGS    EQU   DCBD+00000040       8 BIT(S)                             09440000
GETAD    EQU   DCBD+00000048       4 BYTE(S)                            09450000
OFLGS    EQU   DCBD+00000048       8 BIT(S)                             09460000
OFLGS1   EQU   DCBD+00000049       1 BYTE(S)                            09470000
MACRF    EQU   DCBD+00000050       2 BYTE(S)                            09480000
FILL2    EQU   DCBD+00000052       10 BYTE(S)                           09490000
BLKSI    EQU   DCBD+00000062       HALFWORD INTEGER                     09500000
FILL3    EQU   DCBD+00000064       18 BYTE(S)                           09510000
LRECL    EQU   DCBD+00000082       HALFWORD INTEGER                     09520000
FILL4    EQU   DCBD+00000084       172 BYTE(S)                          09530000
NEXTDCB  EQU   DCBD+00000256       FULLWORD POINTER                     09540000
DDNAME1  EQU   DCBD+00000260       8 BYTE(S)                            09550000
EODSW    EQU   DCBD+00000268       1 BYTE(S)                            09560000
DCBSW1   EQU   DCBD+00000269       1 BYTE(S)                            09570000
DCBSW2   EQU   DCBD+00000270       1 BYTE(S)                            09580000
DCBSW3   EQU   DCBD+00000271       8 BIT(S)                             09590000
INREC    EQU   DCBD+00000272       FULLWORD POINTER                     09600000
GMLGTH   EQU   DCBD+00000276       HALFWORD INTEGER                     09610000
FIELDSEL EQU   DCBD+00000278       1 BYTE(S)                            09620000
SPARE    EQU   DCBD+00000279       1 BYTE(S)                            09630000
FDTBL    EQU   00000000            520 BYTE(S) ON WORD                  09640000
FDNAME   EQU   FDTBL+00000000      8 BYTE(S)                            09650000
FDREPNM  EQU   FDTBL+00000008      8 BYTE(S)                            09660000
FDINDNM  EQU   FDTBL+00000016      8 BYTE(S) ON WORD                    09670000
FDUMMY   EQU   FDTBL+00000016      4 BYTE(S)                            09680000
FDINDNUM EQU   FDTBL+00000020      FULLWORD POINTER                     09690000
FDLGTH   EQU   FDTBL+00000024      HALFWORD POINTER                     09700000
FDCYCLE  EQU   FDTBL+00000026      HALFWORD POINTER                     09710000
FDACTION EQU   FDTBL+00000028      2 BYTE(S)                            09720000
FDFORMAT EQU   FDTBL+00000030      2 BYTE(S)                            09730000
FDSWITCH EQU   FDTBL+00000032      8 BIT(S)                             09740000
INDBYNAM EQU   FDTBL+00000032      1 BIT(S)                             09750000
PASS     EQU   FDTBL+00000032      1 BIT(S)                             09760000
FXACTION EQU   FDTBL+00000032      1 BIT(S)                             09770000
RPACTION EQU   FDTBL+00000032      1 BIT(S)                             09780000
ROACTION EQU   FDTBL+00000032      1 BIT(S)                             09790000
WVACTION EQU   FDTBL+00000032      1 BIT(S)                             09800000
STACTION EQU   FDTBL+00000032      1 BIT(S)                             09810000
NUACTION EQU   FDTBL+00000032      1 BIT(S)                             09820000
FDFILL   EQU   FDTBL+00000033      1 BYTE(S)                            09830000
FDSIGN   EQU   FDTBL+00000034      1 BYTE(S)                            09840000
FDCHAR   EQU   FDTBL+00000035      1 BYTE(S)                            09850000
FDRANGE  EQU   FDTBL+00000036      4 BYTE(S)                            09860000
FDOBUF   EQU   FDTBL+00000040      HALFWORD POINTER                     09870000
FDFRINC  EQU   FDTBL+00000042      HALFWORD POINTER                     09880000
FDFROMAD EQU   FDTBL+00000044      4 BYTE(S)                            09890000
FDMLGTH  EQU   FDTBL+00000048      HALFWORD POINTER                     09900000
FDTOINC  EQU   FDTBL+00000050      HALFWORD POINTER                     09910000
FDCYCCNT EQU   FDTBL+00000052      HALFWORD POINTER                     09920000
FDSLGTH  EQU   FDTBL+00000054      HALFWORD POINTER                     09930000
FDSLGTHR EQU   FDTBL+00000056      HALFWORD POINTER                     09940000
FDFRINCR EQU   FDTBL+00000058      1 BYTE(S)                            09950000
FDTOINCR EQU   FDTBL+00000059      1 BYTE(S)                            09960000
LTOFREE  EQU   FDTBL+00000060      HALFWORD POINTER                     09970000
FDSW1    EQU   FDTBL+00000062      8 BIT(S)                             09980000
STRTLOC1 EQU   FDTBL+00000062      1 BIT(S)                             09990000
FOXZEROS EQU   *                   16 BYTE(S)                           10000000
         DC    X'F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0'                      10010000
INBUF    EQU   00000000            80 BYTE(S)                           10020000
BUFFER   EQU   00000000            32767 BYTE(S)                        10030000
ON       EQU   *                   1 BYTE(S)                            10040000
         DC    X'FF'                                                    10050000
OFF      EQU   *                   1 BYTE(S)                            10060000
         DC    X'00'                                                    10070000
WKADDR   EQU   00000000            32767 BYTE(S)                        10080000
COPAT    EQU   *                   27 BYTE(S)                           10090000
         DC    C' ½.<(+|&&!$*);^-/,%_>?:#@''="'                         10100000
ALPAT    EQU   *                   36 BYTE(S)                           10110000
         DC    C'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'                  10120000
OPTIONS  EQU   00000000            256 BYTE(S)                          10130000
PAGE     EQU   00000000            256 BYTE(S)                          10140000
DDLST    EQU   00000000            256 BYTE(S)                          10150000
         ORG   @DATA                                                    10160000
         DS    00000081C                                                10170000
@L       EQU   1                                                        10180000
@DATD    DSECT                                                          10190000
@SAV001  EQU   @DATD+00000000      72 BYTE(S) ON WORD                   10200000
BUFPTR   EQU   @DATD+00000072      FULLWORD POINTER                     10210000
RCODE    EQU   @DATD+00000076      FULLWORD INTEGER                     10220000
OPTPTR   EQU   @DATD+00000080      FULLWORD POINTER                     10230000
PGPTR    EQU   @DATD+00000084      FULLWORD POINTER                     10240000
         DS    00000088C                                                10250000
@TEMPS   DS    0F                                                       10260000
         DS    C                                                        10270000
@DATEND  EQU   *                                                        10280000
IEBDGCUP CSECT ,                                                        10290000
A2J7     EQU   @EL01                                                    10300000
         END   IEBDGCUP                                                 10310000
