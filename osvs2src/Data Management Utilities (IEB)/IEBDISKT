         TITLE 'IEBDISKT --- OS/VS DISKETTE MAINTENANCE UTILITY        *00001000
                        '                                               00002000
IEBDISKT CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IEBDISKT  77.320'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @06,0                                               0001 00011000
@PSTART  LA    @07,4095(,@06)                                      0001 00012000
         LA    @08,4095(,@07)                                      0001 00013000
         LA    @09,4095(,@08)                                      0001 00014000
         LA    @10,4095(,@09)                                      0001 00015000
         LA    @04,4095(,@10)                                      0001 00016000
         LA    @05,4095(,@04)                                      0001 00017000
         USING @PSTART,@06                                         0001 00018000
         USING @PSTART+4095,@07                                    0001 00019000
         USING @PSTART+8190,@08                                    0001 00020000
         USING @PSTART+12285,@09                                   0001 00021000
         USING @PSTART+16380,@10                                   0001 00022000
         USING @PSTART+20475,@04                                   0001 00023000
         USING @PSTART+24570,@05                                   0001 00024000
         ST    @13,@SA00001+4                                      0001 00025000
         LA    @14,@SA00001                                        0001 00026000
         ST    @14,8(,@13)                                         0001 00027000
         LR    @13,@14                                             0001 00028000
*                                                                  0260 00029000
*   /*****************************************************************/ 00030000
*   /*                                                               */ 00031000
*   /* START OF MAINLINE                                     @Y30OE72*/ 00032000
*   /*                                                               */ 00033000
*   /*****************************************************************/ 00034000
*                                                                  0260 00035000
*   SWITCHES=SWITCHES&&SWITCHES;    /* INITIALIZE SWITCHES   @Y30OE72*/ 00036000
         XC    SWITCHES(17),SWITCHES                               0260 00037000
*   CALL INSPECT;                   /* CHECK VALIDITY OF JCL @Y30OE72*/ 00038000
         BAL   @14,INSPECT                                         0261 00039000
*   IF FAILSW=OFF THEN              /* ANY ERRORS SO FAR?    @Y30OE72*/ 00040000
         CLC   FAILSW(1),OFF                                       0262 00041000
         BNE   @RF00262                                            0262 00042000
*     IF WORKSISW=ON THEN           /* NO. IF THERE IS A     @Y30OE72   00043000
*                                      CONTROL DATA SET,     @Y30OE72*/ 00044000
         CLC   WORKSISW(1),ON                                      0263 00045000
         BNE   @RF00263                                            0263 00046000
*       CALL INTERPR;               /* PROCESS CONTROL STMTS @Y30OE72*/ 00047000
         BAL   @14,INTERPR                                         0264 00048000
*   IF FAILSW=OFF THEN              /* CONTROL STMTS OK?     @Y30OE72*/ 00049000
@RF00263 DS    0H                                                  0265 00050000
@RF00262 CLC   FAILSW(1),OFF                                       0265 00051000
         BNE   @RF00265                                            0265 00052000
*     CALL TR0BUILD;                /* YES. BUILD TRACK 0    @Y30OE72   00053000
*                                      TABLE IN CORE         @Y30OE72*/ 00054000
         BAL   @14,TR0BUILD                                        0266 00055000
*   IF FAILSW=OFF&                  /* TRACK 0 BUILT OK?     @Y30OE72*/ 00056000
*       HDRCNT>ZERO THEN            /* DATA SETS TO COPY?    @Y30OE72*/ 00057000
@RF00265 CLC   FAILSW(1),OFF                                       0267 00058000
         BNE   @RF00267                                            0267 00059000
         ICM   @12,3,HDRCNT                                        0267 00060000
         BNP   @RF00267                                            0267 00061000
*     IF MODESW=ONE3540 THEN        /* YES. DSKT-DASD COPY?  @Y30OE72*/ 00062000
         CLI   MODESW,1                                            0268 00063000
         BNE   @RF00268                                            0268 00064000
*       DO;                         /* YES.                  @Y30OE72*/ 00065000
*         GEN(OPEN (SYSUT2QS,(OUTPUT)));/* INTERMED FILE     @Y30OE72*/ 00066000
         OPEN (SYSUT2QS,(OUTPUT))                                       00067000
*         REG1=ADDR(SYSUT2QS);      /* POINT TO DCB          @Y30OE72*/ 00068000
         LA    REG1,SYSUT2QS                                       0271 00069000
*         IF DCBOFOPN^=SETON THEN   /* OPEN SUCCESSFUL?      @Y30OE72*/ 00070000
         TM    DCBOFOPN+40(REG1),B'00010000'                       0272 00071000
         BO    @RF00272                                            0272 00072000
*           DO;                     /* NO.                   @Y30OE72*/ 00073000
*             I511DDNM=SYSUT2DD;    /* DDNAME                @Y30OE72*/ 00074000
         MVC   I511DDNM(8),@CC02093                                0274 00075000
*             REG1=ADDR(IEB511I);   /* MSG ADDR              @Y30OE72*/ 00076000
         LA    REG1,IEB511I                                        0275 00077000
*             MSGLEN=LENGTH(IEB511I);/* ISSUE MSG            @Y30OE72*/ 00078000
         MVI   MSGLEN,X'28'                                        0276 00079000
*             CALL MSGWRTR;         /* IEB511I               @Y30OE72*/ 00080000
         BAL   @14,MSGWRTR                                         0277 00081000
*             FAILSW=ON;            /* TERMINATE RUN         @Y30OE72*/ 00082000
         MVC   FAILSW(1),ON                                        0278 00083000
*           END;                    /*                       @Y30OE72*/ 00084000
*         IF FAILSW=OFF THEN        /* FILE OPENED OK?       @Y30OE72*/ 00085000
@RF00272 CLC   FAILSW(1),OFF                                       0280 00086000
         BNE   @RF00280                                            0280 00087000
*           DO;                     /* YES.                  @Y30OE72*/ 00088000
*             ABNDEXT2=ADDR(ABEXIT2);/* PT TO EOV ABEND EXIT @Z30OE72*/ 00089000
         LA    @12,ABEXIT2                                         0282 00090000
         STCM  @12,7,ABNDEXT2                                      0282 00091000
*             CALL COPY1;           /* COPY DSKT TO DASD     @Y30OE72*/ 00092000
         BAL   @14,COPY1                                           0283 00093000
*             GEN(CLOSE SYSUT2QS);  /* CLOSE DASD FILE       @Y30OE72*/ 00094000
         CLOSE SYSUT2QS                                                 00095000
*           END;                    /*                       @Y30OE72*/ 00096000
*       END;                        /* END DSKT-DASD COPY    @Y30OE72*/ 00097000
@RF00280 DS    0H                                                  0287 00098000
*   IF FAILSW=OFF THEN              /* ANY ERRORS?           @Y30OE72*/ 00099000
@RF00268 DS    0H                                                  0287 00100000
@RF00267 CLC   FAILSW(1),OFF                                       0287 00101000
         BNE   @RF00287                                            0287 00102000
*     CALL CHECKOUT;                /* NO. CHK TRACK 0 OF    @Y30OE72   00103000
*                                      OUTPUT DISKETTE       @Y30OE72*/ 00104000
         BAL   @14,CHECKOUT                                        0288 00105000
*   IF FAILSW=OFF&                  /* OUTPUT TRACK 0 OK?    @Y30OE72*/ 00106000
*       HDRCNT>ZERO THEN            /* DATA SETS TO COPY?    @Y30OE72*/ 00107000
@RF00287 CLC   FAILSW(1),OFF                                       0289 00108000
         BNE   @RF00289                                            0289 00109000
         ICM   @12,3,HDRCNT                                        0289 00110000
         BNP   @RF00289                                            0289 00111000
*     IF MODESW=ONE3540 THEN        /* YES. DATA ON DASD?    @Y30OE72*/ 00112000
         CLI   MODESW,1                                            0290 00113000
         BNE   @RF00290                                            0290 00114000
*       DO;                         /* YES.                  @Y30OE72*/ 00115000
*         GEN(OPEN SYSUT2IN);       /* OPEN DASD FOR INPUT   @Y30OE72*/ 00116000
         OPEN SYSUT2IN                                                  00117000
*         REG1=ADDR(SYSUT2IN);      /* POINT TO DCB          @Y30OE72*/ 00118000
         LA    REG1,SYSUT2IN                                       0293 00119000
*         IF DCBOFOPN^=SETON THEN   /* OPEN SUCCESSFUL?      @Y30OE72*/ 00120000
         TM    DCBOFOPN+40(REG1),B'00010000'                       0294 00121000
         BO    @RF00294                                            0294 00122000
*           DO;                     /* NO.                   @Y30OE72*/ 00123000
*             I511DDNM=SYSUT2DD;    /* DDNAME                @Y30OE72*/ 00124000
         MVC   I511DDNM(8),@CC02093                                0296 00125000
*             REG1=ADDR(IEB511I);   /* MSG ADDR              @Y30OE72*/ 00126000
         LA    REG1,IEB511I                                        0297 00127000
*             MSGLEN=LENGTH(IEB511I);/* ISSUE MSG            @Y30OE72*/ 00128000
         MVI   MSGLEN,X'28'                                        0298 00129000
*             CALL MSGWRTR;         /* IEB511I               @Y30OE72*/ 00130000
         BAL   @14,MSGWRTR                                         0299 00131000
*             FAILSW=ON;            /* TERMINATE RUN         @Y30OE72*/ 00132000
         MVC   FAILSW(1),ON                                        0300 00133000
*           END;                    /*                       @Y30OE72*/ 00134000
*         IF FAILSW=OFF THEN        /* FILE OPENED OK?       @Y30OE72*/ 00135000
@RF00294 CLC   FAILSW(1),OFF                                       0302 00136000
         BNE   @RF00302                                            0302 00137000
*           DO;                     /* YES.                  @Y30OE72*/ 00138000
*             MODESW=DASDDSKT;      /* IND MODE FOR COPY1    @Y30OE72*/ 00139000
         MVI   MODESW,X'03'                                        0304 00140000
*             CALL COPY1;           /* COPY DASD TO DSKT     @Y30OE72*/ 00141000
         BAL   @14,COPY1                                           0305 00142000
*           END;                    /*                       @Y30OE72*/ 00143000
*       END;                        /*                       @Y30OE72*/ 00144000
*     ELSE                          /* DATA ON DSKT          @Y30OE72*/ 00145000
*       CALL COPY1;                 /* COPY DSKT TO DSKT     @Y30OE72*/ 00146000
         B     @RC00290                                            0308 00147000
@RF00290 BAL   @14,COPY1                                           0308 00148000
*   IF FAILSW=OFF THEN              /* DATA COPIED OK?       @Y30OE72*/ 00149000
@RC00290 DS    0H                                                  0309 00150000
@RF00289 CLC   FAILSW(1),OFF                                       0309 00151000
         BNE   @RF00309                                            0309 00152000
*     CALL TR0WRITE;                /* YES. WRITE TRACK 0    @Y30OE72   00153000
*                                      ON OUTPUT DISKETTE    @Y30OE72*/ 00154000
         BAL   @14,TR0WRITE                                        0310 00155000
*   IF FAILSW=OFF THEN              /* GOOD RUN?             @Y30OE72*/ 00156000
@RF00309 CLC   FAILSW(1),OFF                                       0311 00157000
         BNE   @RF00311                                            0311 00158000
*     DO;                           /* YES.                  @Y30OE72*/ 00159000
*       RTNCODE=ZERO;               /* SET ZERO RTN CODE     @Y30OE72*/ 00160000
         MVI   RTNCODE,X'00'                                       0313 00161000
*       REG1=ADDR(IEB500I);         /* ISSUE                 @Y30OE72*/ 00162000
         LA    REG1,IEB500I                                        0314 00163000
*       MSGLEN=LENGTH(IEB500I);     /* MESSAGE               @Y30OE72*/ 00164000
         MVI   MSGLEN,X'2B'                                        0315 00165000
*       CALL MSGWRTR;               /* IEB500I               @Y30OE72*/ 00166000
         BAL   @14,MSGWRTR                                         0316 00167000
*     END;                          /*                       @Y30OE72*/ 00168000
*   ELSE                            /* ERROR RUN             @Y30OE72*/ 00169000
*     IF CANCELED=SETON THEN        /* DID OPR REPLY CANCEL? @Y30OE72*/ 00170000
         B     @RC00311                                            0318 00171000
@RF00311 TM    CANCELED,B'10000000'                                0318 00172000
         BNO   @RF00318                                            0318 00173000
*       RTNCODE=8;                  /* YES. RTN CODE = 8     @Y30OE72*/ 00174000
         MVI   RTNCODE,X'08'                                       0319 00175000
*     ELSE                          /* NO. OTHER ERRORS      @Y30OE72*/ 00176000
*       RTNCODE=4;                  /* RTN CODE = 4          @Y30OE72*/ 00177000
         B     @RC00318                                            0320 00178000
@RF00318 MVI   RTNCODE,X'04'                                       0320 00179000
*   CALL CLOSEFIL;                  /* CLOSE FILES           @Y30OE72*/ 00180000
@RC00318 DS    0H                                                  0321 00181000
@RC00311 BAL   @14,CLOSEFIL                                        0321 00182000
*   RETURN CODE(RTNCODE);           /* SET RETURN CODE       @Y30OE72*/ 00183000
         SLR   @15,@15                                             0322 00184000
         IC    @15,RTNCODE                                         0322 00185000
         L     @13,4(,@13)                                         0322 00186000
         L     @14,12(,@13)                                        0322 00187000
         LM    @00,@12,20(@13)                                     0322 00188000
         BR    @14                                                 0322 00189000
*                                                                  0323 00190000
*   /*****************************************************************/ 00191000
*   /*                                                               */ 00192000
*   /* ROUTINE NAME = DCBEXIT                                @Y30OE72*/ 00193000
*   /*                                                       @Y30OE72*/ 00194000
*   /* FUNCTION = DCBEXIT FOR INTERMEDIATE FILE.             @Y30OE72*/ 00195000
*   /*                                                       @Y30OE72*/ 00196000
*   /* INPUT = REG1 POINTS TO DCB                            @Y30OE72*/ 00197000
*   /*                                                       @Y30OE72*/ 00198000
*   /* OUTPUT = IF DCBBLKSZ WAS NOT SPECIFIED BY THE USER IT @Y30OE72*/ 00199000
*   /* WILL BE SET TO 1 TRACK.                               @Z30OE72*/ 00200000
*   /*                                                       @Y30OE72*/ 00201000
*   /* ROUTINES CALLED = NONE                                @Y30OE72*/ 00202000
*   /*                                                       @Y30OE72*/ 00203000
*   /* MACROS = DCB.                                         @Y30OE72*/ 00204000
*   /*                                                               */ 00205000
*   /*****************************************************************/ 00206000
*                                                                  0323 00207000
*DCBEXIT:                           /*                       @Y30OE72*/ 00208000
*   PROCEDURE OPTIONS(SAVE(14));    /* PROCEDURE START       @Y30OE72*/ 00209000
@EL00001 L     @13,4(,@13)                                         0323 00210000
@EF00001 DS    0H                                                  0323 00211000
@ER00001 LM    @14,@12,12(@13)                                     0323 00212000
         BR    @14                                                 0323 00213000
DCBEXIT  ST    @14,12(,@13)                                        0323 00214000
*   IF DCBBLKSI=ZEROREC(1:2) THEN   /* USER SUPPLY BLKSIZE?  @Y30OE72*/ 00215000
         LA    @12,52                                              0324 00216000
         ALR   @12,REG1                                            0324 00217000
         SLR   @11,@11                                             0324 00218000
         ICM   @11,3,ZEROREC                                       0324 00219000
         CH    @11,DCBBLKSI(,@12)                                  0324 00220000
         BNE   @RF00324                                            0324 00221000
*     DCBBLKSI=TRKSIZE;             /* NO. USE 1 TRACK       @Z30OE72*/ 00222000
         MVC   DCBBLKSI(2,@12),TRKSIZE                             0325 00223000
*   END DCBEXIT;                    /*                       @Y30OE72*/ 00224000
@EL00002 DS    0H                                                  0326 00225000
@EF00002 DS    0H                                                  0326 00226000
@ER00002 L     @14,12(,@13)                                        0326 00227000
         BR    @14                                                 0326 00228000
*                                                                  0327 00229000
*   /*****************************************************************/ 00230000
*   /*                                                               */ 00231000
*   /* ROUTINE NAME = SYPTEXIT                               @Y30OE72*/ 00232000
*   /*                                                       @Y30OE72*/ 00233000
*   /* FUNCTION = DCBEXIT FOR SYSPRINT AND SYSIN FILES.      @Z30OE72*/ 00234000
*   /*                                                       @Y30OE72*/ 00235000
*   /* INPUT = REG1 POINTS TO DCB                            @Y30OE72*/ 00236000
*   /*                                                       @Y30OE72*/ 00237000
*   /* OUTPUT = IF DCBBLKSZ WAS NOT SPECIFIED BY THE USER IT @Y30OE72*/ 00238000
*   /* WILL BE SET EQUAL TO LRECL.                           @Z30OE72*/ 00239000
*   /*                                                       @Y30OE72*/ 00240000
*   /* ROUTINES CALLED = NONE                                @Y30OE72*/ 00241000
*   /*                                                       @Y30OE72*/ 00242000
*   /* MACROS = DCB.                                         @Y30OE72*/ 00243000
*   /*                                                               */ 00244000
*   /*****************************************************************/ 00245000
*                                                                  0327 00246000
*SYPTEXIT:                          /*                       @Y30OE72*/ 00247000
*   PROCEDURE OPTIONS(SAVE(14));    /* PROCEDURE START       @Y30OE72*/ 00248000
SYPTEXIT ST    @14,12(,@13)                                        0327 00249000
*   IF DCBBLKSI=ZEROREC(1:2) THEN   /* USER SUPPLY BLKSIZE?  @Y30OE72*/ 00250000
         LA    @12,52                                              0328 00251000
         ALR   @12,REG1                                            0328 00252000
         SLR   @11,@11                                             0328 00253000
         ICM   @11,3,ZEROREC                                       0328 00254000
         CH    @11,DCBBLKSI(,@12)                                  0328 00255000
         BNE   @RF00328                                            0328 00256000
*     DCBBLKSI=DCBLRECL;            /* NO. USE DEFAULT       @Z30OE72*/ 00257000
         MVC   DCBBLKSI(2,@12),DCBLRECL+72(REG1)                   0329 00258000
*   END SYPTEXIT;                   /*                       @Y30OE72*/ 00259000
@EL00003 DS    0H                                                  0330 00260000
@EF00003 DS    0H                                                  0330 00261000
@ER00003 L     @14,12(,@13)                                        0330 00262000
         BR    @14                                                 0330 00263000
*                                                                  0331 00264000
*   /*****************************************************************/ 00265000
*   /*                                                               */ 00266000
*   /* ROUTINE NAME = ABEXIT                                 @Z30OE72*/ 00267000
*   /*                                                       @Z30OE72*/ 00268000
*   /* FUNCTION = ABEND EXIT FOR ALL FILES DURING OPEN       @Z30OE72*/ 00269000
*   /*                                                       @Z30OE72*/ 00270000
*   /* INPUT = REG1 POINTS TO PARM LIST                      @Z30OE72*/ 00271000
*   /*                                                       @Z30OE72*/ 00272000
*   /* OUTPUT = IF AN IGNORABLE ABEND ERROR OCCURED,         @Z30OE72*/ 00273000
*   /* THE OPTION MASK WILL BE SET TO IGNORE IT.             @Z30OE72*/ 00274000
*   /*                                                       @Z30OE72*/ 00275000
*   /* ROUTINES CALLED = NONE                                @Z30OE72*/ 00276000
*   /*                                                       @Z30OE72*/ 00277000
*   /* MACROS = NONE                                         @Z30OE72*/ 00278000
*   /*                                                               */ 00279000
*   /*****************************************************************/ 00280000
*                                                                  0331 00281000
*ABEXIT:                            /*                       @Z30OE72*/ 00282000
*   PROCEDURE OPTIONS(SAVE(14));    /* PROCEDURE START       @Z30OE72*/ 00283000
ABEXIT   ST    @14,12(,@13)                                        0331 00284000
*   IF OKIGNORE=SETON THEN          /* CAN ABEND BE IGNORED? @Z30OE72*/ 00285000
         TM    OKIGNORE(REG1),B'00000100'                          0332 00286000
         BNO   @RF00332                                            0332 00287000
*     OPTMASK=IGNORE;               /* YES. IGNORE IT.       @Z30OE72*/ 00288000
         MVI   OPTMASK(REG1),X'04'                                 0333 00289000
*   END ABEXIT;                     /*                       @Z30OE72*/ 00290000
@EL00004 DS    0H                                                  0334 00291000
@EF00004 DS    0H                                                  0334 00292000
@ER00004 L     @14,12(,@13)                                        0334 00293000
         BR    @14                                                 0334 00294000
*                                                                  0335 00295000
*   /*****************************************************************/ 00296000
*   /*                                                               */ 00297000
*   /* ROUTINE NAME = ABEXIT2                                @Z30OE72*/ 00298000
*   /*                                                       @Z30OE72*/ 00299000
*   /* FUNCTION = ABEND EXIT FOR DASD FILE DURING EOV        @Z30OE72*/ 00300000
*   /*                                                       @Z30OE72*/ 00301000
*   /* INPUT = REG1 POINTS TO PARM LIST                      @Z30OE72*/ 00302000
*   /*                                                       @Z30OE72*/ 00303000
*   /* OUTPUT = IF AN IGNORABLE ABEND ERROR OCCURED,         @Z30OE72*/ 00304000
*   /* THE OPTION MASK WILL BE SET TO IGNORE IT.             @Z30OE72*/ 00305000
*   /*                                                       @Z30OE72*/ 00306000
*   /* ROUTINES CALLED = MSGWRTR - MESSAGE WRITING ROUTINE   @Z30OE72*/ 00307000
*   /*                                                       @Z30OE72*/ 00308000
*   /* MACROS = NONE                                         @Z30OE72*/ 00309000
*   /*                                                               */ 00310000
*   /*****************************************************************/ 00311000
*                                                                  0335 00312000
*ABEXIT2:                           /*                       @Z30OE72*/ 00313000
*   PROCEDURE OPTIONS(SAVE(14));    /* PROCEDURE START       @Z30OE72*/ 00314000
ABEXIT2  ST    @14,@SA00005                                        0335 00315000
*   IF OKIGNORE=SETON THEN          /* CAN ABEND BE IGNORED? @Z30OE72*/ 00316000
         TM    OKIGNORE(REG1),B'00000100'                          0336 00317000
         BNO   @RF00336                                            0336 00318000
*     OPTMASK=IGNORE;               /* YES. IGNORE IT.       @Z30OE72*/ 00319000
         MVI   OPTMASK(REG1),X'04'                                 0337 00320000
*   RFY                             /*                       @Z30OE72*/ 00321000
*     SVARREG RSTD;                 /*                       @Z30OE72*/ 00322000
@RF00336 DS    0H                                                  0339 00323000
*   SVARREG=ADDR(SAVEREGS);         /* REG SAVE AREA         @Z30OE72*/ 00324000
         LA    SVARREG,SAVEREGS                                    0339 00325000
*   RFY                             /*                       @Z30OE72*/ 00326000
*     SVARREG UNRSTD;               /*                       @Z30OE72*/ 00327000
*   I520DDNM=SYSUT2DD;              /* DDNAME INTO MSG       @Z30OE72*/ 00328000
         MVC   I520DDNM(8),@CC02093                                0341 00329000
*   REG1=ADDR(IEB520I);             /* ISSUE                 @Z30OE72*/ 00330000
         LA    REG1,IEB520I                                        0342 00331000
*   MSGLEN=LENGTH(IEB520I);         /* MESSAGE               @Z30OE72*/ 00332000
         MVI   MSGLEN,X'1A'                                        0343 00333000
*   CALL MSGWRTR;                   /* IEB520I               @Z30OE72*/ 00334000
         BAL   @14,MSGWRTR                                         0344 00335000
*   FAILSW=ON;                      /* TERMINATE RUN         @Z30OE72*/ 00336000
         MVC   FAILSW(1),ON                                        0345 00337000
*   END ABEXIT2;                    /*                       @Z30OE72*/ 00338000
@EL00005 DS    0H                                                  0346 00339000
@EF00005 DS    0H                                                  0346 00340000
@ER00005 L     @14,@SA00005                                        0346 00341000
         BR    @14                                                 0346 00342000
*                                                                  0347 00343000
*/********************************************************************/ 00344000
*/*                                                          #Y30OE72*/ 00345000
*/* ROUTINE NAME = INSPECT                                   #Y30OE72*/ 00346000
*/*                                                          #Y30OE72*/ 00347000
*/* FUNCTION = CHECK PRESENCE AND VALIDITY OF JCL DD         #Y30OE72*/ 00348000
*/*            STATEMENTS.                                   #Y30OE72*/ 00349000
*/*                                                          @Y30OE72*/ 00350000
*/* INPUT = TIOT (SEE INPUT SECTION OF MODULE SPECS)         @Y30OE72*/ 00351000
*/*                                                          @Y30OE72*/ 00352000
*/* OUTPUT= SYSPRINT DD OPENED.                              @Y30OE72*/ 00353000
*/*         WORKSYS1 & WORKSYS2 POINTING TO DD ENTRIES       @Y30OE72*/ 00354000
*/*         FOR SYSUT1 & SYSUT2.                             @Y30OE72*/ 00355000
*/*         WORKSISW SET ON IF SYSIN DD WAS FOUND            @Y30OE72*/ 00356000
*/*         FAILSW ON IF ERROR WAS FOUND                     @Y30OE72*/ 00357000
*/*                                                          @Y30OE72*/ 00358000
*/* ROUTINES CALLED = MSGWRTR - MESSAGE WRITING ROUTINE      @Y30OE72*/ 00359000
*/*                                                          @Y30OE72*/ 00360000
*/* MACROS = IEFTIOT1,EXTRACT,OPEN,WTO                       @Y30OE72*/ 00361000
*/*                                                          @Y30OE72*/ 00362000
*/********************************************************************/ 00363000
*                                                                  0347 00364000
*INSPECT:                           /*                       @Y30OE72*/ 00365000
*   PROCEDURE OPTIONS(SAVE(14));    /* PROCEDURE START       @Y30OE72*/ 00366000
INSPECT  ST    @14,@SA00006                                        0347 00367000
*   GEN(EXTRACT TIOTADDR,,FIELDS=(TIOT));/* GET TIOT ADDR    @Y30OE72*/ 00368000
         EXTRACT TIOTADDR,,FIELDS=(TIOT)                                00369000
*   WORKSW=ON;                      /* SET DOWHILE CONTROL   @Y30OE72*/ 00370000
         MVC   WORKSW(1),ON                                        0349 00371000
*   DO WHILE WORKSW=ON;             /* SCAN TIOT ENTRIES     @Y30OE72*/ 00372000
         B     @DE00350                                            0350 00373000
@DL00350 DS    0H                                                  0351 00374000
*     IF TIOEDDNM=SYSPRTDD THEN     /* SYSPRINT DD ?         @Y30OE72*/ 00375000
         L     @12,TIOTADDR                                        0351 00376000
         CLC   TIOEDDNM(8,@12),@CC02087                            0351 00377000
         BNE   @RF00351                                            0351 00378000
*       WORKSPSW=ON;                /* INDICATE SYSPRINT     @Y30OE72   00379000
*                                      DD PROVIDED           @Y30OE72*/ 00380000
         MVC   WORKSPSW(1),ON                                      0352 00381000
*     IF TIOEDDNM=SYSINDD THEN      /* SYSIN DD ?            @Y30OE72*/ 00382000
@RF00351 L     @12,TIOTADDR                                        0353 00383000
         CLC   TIOEDDNM(8,@12),@CC02089                            0353 00384000
         BNE   @RF00353                                            0353 00385000
*       WORKSISW=ON;                /* INDICATE SYSIN        @Y30OE72   00386000
*                                      DD PROVIDED           @Y30OE72*/ 00387000
         MVC   WORKSISW(1),ON                                      0354 00388000
*     IF TIOEDDNM=SYSUT1DD THEN     /* SYSUT1 DD ?           @Y30OE72*/ 00389000
@RF00353 L     @12,TIOTADDR                                        0355 00390000
         CLC   TIOEDDNM(8,@12),@CC02091                            0355 00391000
         BNE   @RF00355                                            0355 00392000
*       DO;                         /* YES. INDICATE         @Y30OE72*/ 00393000
*         WORKU1SW=ON;              /* SYSUT1 PROVIDED AND   @Y30OE72*/ 00394000
         MVC   WORKU1SW(1),ON                                      0357 00395000
*         WORKSYS1=TIOTADDR;        /* SAVE DD ENTRY ADDR    @Y30OE72*/ 00396000
         STCM  @12,7,WORKSYS1                                      0358 00397000
*       END;                        /*                       @Y30OE72*/ 00398000
*     IF TIOEDDNM=SYSUT2DD THEN     /* SYSUT2 DD ?           @Y30OE72*/ 00399000
@RF00355 L     @12,TIOTADDR                                        0360 00400000
         CLC   TIOEDDNM(8,@12),@CC02093                            0360 00401000
         BNE   @RF00360                                            0360 00402000
*       DO;                         /* YES. INDICATE         @Y30OE72*/ 00403000
*         WORKU2SW=ON;              /* SYSUT2 PROVIDED AND   @Y30OE72*/ 00404000
         MVC   WORKU2SW(1),ON                                      0362 00405000
*         WORKSYS2=TIOTADDR;        /* SAVE DD ENTRY ADDR    @Y30OE72*/ 00406000
         STCM  @12,7,WORKSYS2                                      0363 00407000
*       END;                        /*                       @Y30OE72*/ 00408000
*     IF TIOELNGH=ZERO THEN         /* END OF TIOT ?         @Y30OE72*/ 00409000
@RF00360 L     @12,TIOTADDR                                        0365 00410000
         CLI   TIOELNGH(@12),0                                     0365 00411000
         BNE   @RF00365                                            0365 00412000
*       WORKSW=OFF;                 /* YES. GET OUT OF LOOP  @Y30OE72*/ 00413000
         MVC   WORKSW(1),OFF                                       0366 00414000
*     ELSE                                                         0367 00415000
*       TIOTADDR=TIOTADDR+TIOELNGH; /* POINT TO NEXT DD ENT  @Y30OE72*/ 00416000
         B     @RC00365                                            0367 00417000
@RF00365 L     @12,TIOTADDR                                        0367 00418000
         SLR   @11,@11                                             0367 00419000
         IC    @11,TIOELNGH(,@12)                                  0367 00420000
         ALR   @11,@12                                             0367 00421000
         ST    @11,TIOTADDR                                        0367 00422000
*   END;                            /* END DOWHILE           @Y30OE72*/ 00423000
@RC00365 DS    0H                                                  0368 00424000
@DE00350 CLC   WORKSW(1),ON                                        0368 00425000
         BE    @DL00350                                            0368 00426000
*   IF WORKSPSW=ON THEN             /* SYSPRINT DD FOUND ?   @Z30OE72*/ 00427000
         CLC   WORKSPSW(1),ON                                      0369 00428000
         BNE   @RF00369                                            0369 00429000
*     DO;                           /* YES.                  @Z30OE72*/ 00430000
*       GEN(OPEN (SYSPRINT,(OUTPUT)));/* OPEN SYSPRINT FILE  @Y30OE72*/ 00431000
         OPEN (SYSPRINT,(OUTPUT))                                       00432000
*       REG1=ADDR(SYSPRINT);        /* POINT TO DCB          @Y30OE72*/ 00433000
         LA    REG1,SYSPRINT                                       0372 00434000
*       IF DCBOFOPN^=SETON THEN     /* OPEN SUCCESSFUL?      @Y30OE72*/ 00435000
         TM    DCBOFOPN+40(REG1),B'00010000'                       0373 00436000
         BO    @RF00373                                            0373 00437000
*         WORKSPSW=OFF;             /* NO. SYSPRINT NOT OPN  @Z30OE72*/ 00438000
         MVC   WORKSPSW(1),OFF                                     0374 00439000
*     END;                          /*                       @Y30OE72*/ 00440000
@RF00373 DS    0H                                                  0376 00441000
*   IF WORKSPSW=OFF THEN            /* SYSPRINT FILE OK?     @Z30OE72*/ 00442000
@RF00369 CLC   WORKSPSW(1),OFF                                     0376 00443000
         BNE   @RF00376                                            0376 00444000
*     DO;                           /* NO. ISSUE             @Z30OE72*/ 00445000
*       GEN;                                                       0378 00446000
*                                   /* WTP                   @Z30OE72*/ 00447000
         WTO   'IEB511I DDNAME SYSPRINT CANNOT BE OPENED',ROUTCDE=(11),C00448000
               DESC=7                                          @Y30OE72 00449000
*       FAILSW=ON;                  /* TERMINATE RUN         @Z30OE72*/ 00450000
         MVC   FAILSW(1),ON                                        0379 00451000
*     END;                          /*                       @Z30OE72*/ 00452000
*   IF FAILSW=OFF THEN              /* FILE OPENED OK?       @Y30OE72*/ 00453000
@RF00376 CLC   FAILSW(1),OFF                                       0381 00454000
         BNE   @RF00381                                            0381 00455000
*     DO;                           /* YES.                  @Y30OE72*/ 00456000
*       IF WORKU1SW=OFF THEN        /* SYSUT1 DD FOUND ?     @Y30OE72*/ 00457000
         CLC   WORKU1SW(1),OFF                                     0383 00458000
         BNE   @RF00383                                            0383 00459000
*         DO;                       /*                       @Y30OE72*/ 00460000
*           I511DDNM=SYSUT1DD;      /* NO.                   @Y30OE72*/ 00461000
         MVC   I511DDNM(8),@CC02091                                0385 00462000
*           REG1=ADDR(IEB511I);     /* MSG ADDR              @Y30OE72*/ 00463000
         LA    REG1,IEB511I                                        0386 00464000
*           MSGLEN=LENGTH(IEB511I); /* ISSUE MSG             @Y30OE72*/ 00465000
         MVI   MSGLEN,X'28'                                        0387 00466000
*           CALL MSGWRTR;           /* IEB511I               @Y30OE72*/ 00467000
         BAL   @14,MSGWRTR                                         0388 00468000
*           FAILSW=ON;              /* TERMINATE RUN         @Y30OE72*/ 00469000
         MVC   FAILSW(1),ON                                        0389 00470000
*         END;                      /*                       @Y30OE72*/ 00471000
*       IF WORKU2SW=OFF THEN        /* SYSUT2 DD FOUND ?     @Y30OE72*/ 00472000
@RF00383 CLC   WORKU2SW(1),OFF                                     0391 00473000
         BNE   @RF00391                                            0391 00474000
*         DO;                       /*                       @Y30OE72*/ 00475000
*           I511DDNM=SYSUT2DD;      /* NO.                   @Y30OE72*/ 00476000
         MVC   I511DDNM(8),@CC02093                                0393 00477000
*           REG1=ADDR(IEB511I);     /* MSG ADDR              @Y30OE72*/ 00478000
         LA    REG1,IEB511I                                        0394 00479000
*           MSGLEN=LENGTH(IEB511I); /* ISSUE MSG             @Y30OE72*/ 00480000
         MVI   MSGLEN,X'28'                                        0395 00481000
*           CALL MSGWRTR;           /* IEB511I               @Y30OE72*/ 00482000
         BAL   @14,MSGWRTR                                         0396 00483000
*           FAILSW=ON;              /* TERMINATE RUN         @Y30OE72*/ 00484000
         MVC   FAILSW(1),ON                                        0397 00485000
*         END;                      /*                       @Y30OE72*/ 00486000
*     END;                          /*                       @Y30OE72*/ 00487000
@RF00391 DS    0H                                                  0400 00488000
*   IF FAILSW=OFF THEN              /* ALL DD STMTS FOUND?   @Y30OE72*/ 00489000
@RF00381 CLC   FAILSW(1),OFF                                       0400 00490000
         BNE   @RF00400                                            0400 00491000
*     DO;                           /* YES. CONTINUE         @Y30OE72*/ 00492000
*       RFY                         /* POINT TO SYSUT1       @Y30OE72*/ 00493000
*         TIOT1 BASED(WORKSYS1);    /* DD ENTRY IN TIOT      @Y30OE72*/ 00494000
*       IF UCBTYP(3:4)^=TYPE3540 THEN/* SYSUT1 A 3540        @Y30OE72*/ 00495000
         ICM   @12,7,WORKSYS1                                      0403 00496000
         ICM   @11,7,TIOEFSRT(@12)                                 0403 00497000
         SLR   @12,@12                                             0403 00498000
         ICM   @12,3,UCBTYP+2(@11)                                 0403 00499000
         CH    @12,TYPE3540                                        0403 00500000
         BE    @RF00403                                            0403 00501000
*         DO;                       /* NO.                   @Y30OE72*/ 00502000
*           MSGLEN=LENGTH(IEB510I); /* THEN                  @Y30OE72*/ 00503000
         MVI   MSGLEN,X'1B'                                        0405 00504000
*           REG1=ADDR(IEB510I);     /* ISSUE                 @Y30OE72*/ 00505000
         LA    REG1,IEB510I                                        0406 00506000
*           I510DDNM=CHAR1;         /* MESSAGE               @Y30OE72*/ 00507000
         MVI   I510DDNM,C'1'                                       0407 00508000
*           CALL MSGWRTR;           /* IEB510I               @Y30OE72*/ 00509000
         BAL   @14,MSGWRTR                                         0408 00510000
*           FAILSW=ON;              /* TERMINATE RUN         @Y30OE72*/ 00511000
         MVC   FAILSW(1),ON                                        0409 00512000
*         END;                      /*                       @Y30OE72*/ 00513000
*       ELSE                        /* SYSUT1 IS 3540        @Y30OE72*/ 00514000
*         DO;                       /*                       @Y30OE72*/ 00515000
         B     @RC00403                                            0411 00516000
@RF00403 DS    0H                                                  0412 00517000
*           SAVEUNIT=UCBNAME;       /* SAVE SYSUT1 UNIT      @Y30OE72*/ 00518000
         ICM   @12,7,WORKSYS1                                      0412 00519000
         SLR   @11,@11                                             0412 00520000
         ICM   @11,7,TIOEFSRT(@12)                                 0412 00521000
         MVC   SAVEUNIT(3),UCBNAME(@11)                            0412 00522000
*           INUCB=TIOEFSRT;         /* UCB @ INTO ESTAE LIST @Y30OE72*/ 00523000
         ST    @11,INUCB                                           0413 00524000
*           RFY                     /* POINT TO SYSUT2 DD    @Y30OE72*/ 00525000
*             TIOT1 BASED(WORKSYS2);/* ENTRY IN TIOT         @Y30OE72*/ 00526000
*           IF UCBTYP(3:4)^=TYPE3540 THEN/* SYSUT2 A 3540?   @Y30OE72*/ 00527000
         ICM   @12,7,WORKSYS2                                      0415 00528000
         SLR   @11,@11                                             0415 00529000
         ICM   @11,7,TIOEFSRT(@12)                                 0415 00530000
         SLR   @12,@12                                             0415 00531000
         ICM   @12,3,UCBTYP+2(@11)                                 0415 00532000
         CH    @12,TYPE3540                                        0415 00533000
         BE    @RF00415                                            0415 00534000
*             IF UCB3DACC^=SETON THEN/* NO. SYSUT2 DASD?     @Y30OE72*/ 00535000
         TM    UCB3DACC(@11),B'00100000'                           0416 00536000
         BO    @RF00416                                            0416 00537000
*               DO;                 /* NO.                   @Y30OE72*/ 00538000
*                 MSGLEN=LENGTH(IEB510I);/* THEN             @Y30OE72*/ 00539000
         MVI   MSGLEN,X'1B'                                        0418 00540000
*                 REG1=ADDR(IEB510I);/* ISSUE                @Y30OE72*/ 00541000
         LA    REG1,IEB510I                                        0419 00542000
*                 I510DDNM=CHAR2;   /* MESSAGE               @Y30OE72*/ 00543000
         MVI   I510DDNM,C'2'                                       0420 00544000
*                 CALL MSGWRTR;     /* IEB510I               @Y30OE72*/ 00545000
         BAL   @14,MSGWRTR                                         0421 00546000
*                 FAILSW=ON;        /* TERMINATE RUN         @Y30OE72*/ 00547000
         MVC   FAILSW(1),ON                                        0422 00548000
*               END;                /*                       @Y30OE72*/ 00549000
*             ELSE                                                 0424 00550000
*               MODESW=ONE3540;     /* IND THAT SYSUT2 DASD  @Y30OE72*/ 00551000
         B     @RC00416                                            0424 00552000
@RF00416 MVI   MODESW,X'01'                                        0424 00553000
*           ELSE                    /* SYSUT2 3540           @Y30OE72*/ 00554000
*             IF UCBNAME=SAVEUNIT THEN/* IF SYSUT1 & SYSUT2  @Y30OE72*/ 00555000
         B     @RC00415                                            0425 00556000
@RF00415 ICM   @12,7,WORKSYS2                                      0425 00557000
         ICM   @11,7,TIOEFSRT(@12)                                 0425 00558000
         CLC   UCBNAME(3,@11),SAVEUNIT                             0425 00559000
         BNE   @RF00425                                            0425 00560000
*               DO;                 /* ARE THE SAME 3540     @Y30OE72*/ 00561000
*                 MSGLEN=LENGTH(IEB510I);/* THEN             @Y30OE72*/ 00562000
         MVI   MSGLEN,X'1B'                                        0427 00563000
*                 REG1=ADDR(IEB510I);/* ISSUE                @Y30OE72*/ 00564000
         LA    REG1,IEB510I                                        0428 00565000
*                 I510DDNM=CHAR2;   /* MESSAGE               @Y30OE72*/ 00566000
         MVI   I510DDNM,C'2'                                       0429 00567000
*                 CALL MSGWRTR;     /* IEB510I               @Y30OE72*/ 00568000
         BAL   @14,MSGWRTR                                         0430 00569000
*                 FAILSW=ON;        /* TERMINATE RUN         @Y30OE72*/ 00570000
         MVC   FAILSW(1),ON                                        0431 00571000
*               END;                /*                       @Y30OE72*/ 00572000
*             ELSE                  /* INDICATE DISKETTE     @Y30OE72*/ 00573000
*               DO;                 /*                       @Y30OE72*/ 00574000
         B     @RC00425                                            0433 00575000
@RF00425 DS    0H                                                  0434 00576000
*                 MODESW=TWO3540;   /* TO DISKETTE COPY      @Y30OE72*/ 00577000
         MVI   MODESW,X'02'                                        0434 00578000
*                 OUTUCB=TIOEFSRT;  /* UCB @ INTO ESTAE LIST @Y30OE72*/ 00579000
         ICM   @12,7,WORKSYS2                                      0435 00580000
         SLR   @11,@11                                             0435 00581000
         ICM   @11,7,TIOEFSRT(@12)                                 0435 00582000
         ST    @11,OUTUCB                                          0435 00583000
*               END;                /*                       @Y30OE72*/ 00584000
*         END;                      /*                       @Y30OE72*/ 00585000
@RC00425 DS    0H                                                  0437 00586000
@RC00415 DS    0H                                                  0438 00587000
*       RFY                         /* RESET TIOT            @Y30OE72*/ 00588000
*         TIOT1 BASED(TIOTADDR);    /* ADDRESSABILITY        @Y30OE72*/ 00589000
@RC00403 DS    0H                                                  0439 00590000
*     END;                          /*                       @Z30OE72*/ 00591000
*   END INSPECT;                    /*                       @Y30OE72*/ 00592000
@EL00006 DS    0H                                                  0440 00593000
@EF00006 DS    0H                                                  0440 00594000
@ER00006 L     @14,@SA00006                                        0440 00595000
         BR    @14                                                 0440 00596000
*                                                                  0441 00597000
*/********************************************************************/ 00598000
*/*                                                          @Y30OE72*/ 00599000
*/* ROUTINE NAME = INTERPR                                   @Y30OE72*/ 00600000
*/*                                                          @Y30OE72*/ 00601000
*/* FUNCTION = READ    UTILITY CONTROL STATEMENTS AND        @Y30OE72*/ 00602000
*/*            CHECK THEM FOR PROPER SEQUENCE, FORMAT AND    @Y30OE72*/ 00603000
*/*            VALIDITY.                                     @Y30OE72*/ 00604000
*/*                                                          @Y30OE72*/ 00605000
*/* INPUT = CONTROL STATEMENTS ARE READ FROM THE SYSIN       @Y30OE72*/ 00606000
*/*         DATA SET. SET INPUT SECTION OF MODULE            @Y30OE72*/ 00607000
*/*         SPECIFICATIONS FOR FORMAT DESCRIPTION.           @Y30OE72*/ 00608000
*/*                                                          @Y30OE72*/ 00609000
*/* OUTPUT = SET VOLSW ON & SAVE VOL PARAMETER IN            @Y30OE72*/ 00610000
*/*          REPVOL IF VOL STMT SUPPLIED.                    @Y30OE72*/ 00611000
*/*          STORE DS STMT INFO IN REPTAB (IF PRESENT AND    @Y30OE72*/ 00612000
*/*          CORRECT). STORE PERTAINING SEQUENCE NUMBERS     @Y30OE72*/ 00613000
*/*          IN NUMTAB (REPLACEMENTS) OR DELTAB              @Y30OE72*/ 00614000
*/*          (DELETIONS).                                    @Y30OE72*/ 00615000
*/*          FAILSW = ON IF AN ERROR IS DETECTED.            @Y30OE72*/ 00616000
*/*                                                          @Y30OE72*/ 00617000
*/* ROUTINES CALLED = MSGWRTR - MESSAGE WRITING ROUTINE      @Y30OE72*/ 00618000
*/*                   VOLCHECK -TO CHECK VOL STMT VOLID      @Y30OE72*/ 00619000
*/* MACROS = OPEN,GET                                        @Y30OE72*/ 00620000
*/*                                                          @Y30OE72*/ 00621000
*/********************************************************************/ 00622000
*                                                                  0441 00623000
*INTERPR:                           /*                       @Y30OE72*/ 00624000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30OE72*/ 00625000
INTERPR  ST    @14,@SA00007                                        0441 00626000
*   GEN(OPEN (SYSIN));              /* OPEN CONTROL DATA SET @Y30OE72*/ 00627000
         OPEN (SYSIN)                                                   00628000
*   REG1=ADDR(SYSIN);               /* POINT TO DCB          @Y30OE72*/ 00629000
         LA    REG1,SYSIN                                          0443 00630000
*   IF DCBOFOPN^=SETON THEN         /* OPEN SUCCESSFUL?      @Y30OE72*/ 00631000
         TM    DCBOFOPN+40(REG1),B'00010000'                       0444 00632000
         BO    @RF00444                                            0444 00633000
*     DO;                           /* NO.                   @Y30OE72*/ 00634000
*       I511DDNM=SYSINDD;           /* DDNAME                @Y30OE72*/ 00635000
         MVC   I511DDNM(8),@CC02089                                0446 00636000
*       REG1=ADDR(IEB511I);         /* MSG ADDR              @Y30OE72*/ 00637000
         LA    REG1,IEB511I                                        0447 00638000
*       MSGLEN=LENGTH(IEB511I);     /* ISSUE MSG             @Y30OE72*/ 00639000
         MVI   MSGLEN,X'28'                                        0448 00640000
*       CALL MSGWRTR;               /* IEB511I               @Y30OE72*/ 00641000
         BAL   @14,MSGWRTR                                         0449 00642000
*       FAILSW=ON;                  /* TERMINATE RUN         @Y30OE72*/ 00643000
         MVC   FAILSW(1),ON                                        0450 00644000
*     END;                          /*                       @Y30OE72*/ 00645000
*   D=1;                            /* INIT DELTAB INDEX     @Y30OE72*/ 00646000
@RF00444 MVI   D,X'01'                                             0452 00647000
*   N=1;                            /* INIT REPTAB INDEX     @Y30OE72*/ 00648000
         MVI   N,X'01'                                             0453 00649000
*   IF FAILSW=OFF THEN              /* FILE OPENED OK?       @Y30OE72*/ 00650000
         CLC   FAILSW(1),OFF                                       0454 00651000
         BNE   @RF00454                                            0454 00652000
*     WORKSW=ON;                    /* YES. SET CONTROL SW   @Y30OE72*/ 00653000
         MVC   WORKSW(1),ON                                        0455 00654000
*INTDO1:                            /*                       @Y30OE72*/ 00655000
*   DO WHILE WORKSW=ON;             /* PROCESS CONTROL STMTS @Y30OE72*/ 00656000
@RF00454 DS    0H                                                  0456 00657000
INTDO1   B     @DE00456                                            0456 00658000
@DL00456 DS    0H                                                  0457 00659000
*     GEN(GET SYSIN,CARDBUF)        /* READ A                @Y30OE72*/ 00660000
*     REFS(CARDBUF);                /* CONTROL STATEMENT     @Y30OE72*/ 00661000
         GET SYSIN,CARDBUF                                              00662000
*     MSGLEN=LENGTH(CARD);          /* PRINT                 @Y30OE72*/ 00663000
         MVI   MSGLEN,X'50'                                        0458 00664000
*     REG1=ADDR(CARD);              /* CONTROL               @Y30OE72*/ 00665000
         LA    REG1,CARD                                           0459 00666000
*     CALL MSGWRTR;                 /* STATEMENT             @Y30OE72*/ 00667000
         BAL   @14,MSGWRTR                                         0460 00668000
*     IF PRINTERR=SETON THEN        /* SYSPRINT ERROR?       @Y30OE72*/ 00669000
         TM    PRINTERR,B'00001000'                                0461 00670000
         BNO   @RF00461                                            0461 00671000
*       WORKSW=OFF;                 /* YES. QUIT READING     @Y30OE72*/ 00672000
         MVC   WORKSW(1),OFF                                       0462 00673000
*     SWDS=ZERO;                    /* CLEAR SWITCH BYTE     @Y30OE72*/ 00674000
@RF00461 MVI   SWDS,X'00'                                          0463 00675000
*     IF CARDBUF(1:5)=CHARVOL THEN  /* VOL CONTROL STMT?     @Y30OE72*/ 00676000
         CLC   CARDBUF(5),@CC02043                                 0464 00677000
         BNE   @RF00464                                            0464 00678000
*       CASESELT=VOLSTMT;           /* YES. TAKE VOL PATH    @Y30OE72*/ 00679000
         LA    CASESELT,1                                          0465 00680000
*     ELSE                          /* NO.                   @Y30OE72*/ 00681000
*       IF CARDBUF(1:3)=BLDS THEN   /* DS CONTROL STMT?      @Y30OE72*/ 00682000
         B     @RC00464                                            0466 00683000
@RF00464 CLC   CARDBUF(3),@CC02041                                 0466 00684000
         BNE   @RF00466                                            0466 00685000
*         CASESELT=DSSTMT;          /* YES. TAKE DS PATH     @Y30OE72*/ 00686000
         LA    CASESELT,2                                          0467 00687000
*       ELSE                        /* NO.                   @Y30OE72*/ 00688000
*         CASESELT=BADSTMT;         /* TAKE ERROR PATH       @Y30OE72*/ 00689000
         B     @RC00466                                            0468 00690000
@RF00466 LA    CASESELT,3                                          0468 00691000
*     GOTO CNTRLSTM;                /* SKIP EODAD, SYNAD RTN @Y30OE72*/ 00692000
         B     CNTRLSTM                                            0469 00693000
*SYSINERR:                          /* SYNAD RTN             @Y30OE72*/ 00694000
*     CASESELT=INIOERR;             /* TAKE I/O ERR PATH     @Y30OE72*/ 00695000
SYSINERR LA    CASESELT,5                                          0470 00696000
*     GOTO CNTRLSTM;                /* SKIP EODAD RTN        @Y30OE72*/ 00697000
         B     CNTRLSTM                                            0471 00698000
*EODSYSIN:                          /* EODAD ROUTINE         @Y30OE72*/ 00699000
*     CASESELT=ENDDATA;             /* TAKE EODAD PATH       @Y30OE72*/ 00700000
EODSYSIN LA    CASESELT,4                                          0472 00701000
*CNTRLSTM:                                                         0473 00702000
*     DO; /*CNTRLSTM:CASE(CASESELT)NAMES(VOL,DS,BAD,EODAD,SYNAD)*/ 0473 00703000
CNTRLSTM DS    0H                                                  0474 00704000
*       DCL CL0001@ LABEL BASED(CP0001@(CASESELT))                 0474 00705000
*               VALUERANGE(VOL,DS,BAD,EODAD,SYNAD); /*BRANCH TARGET */  00706000
*       DCL CP0001@(5) PTR(31)                                     0475 00707000
*               INIT(ADDR(VOL),ADDR(DS),ADDR(BAD),ADDR(EODAD),ADDR(SYNA 00708000
*));    GOTO CL0001@; /*BRANCH TO SELECTED CASE*//*        @Y30OE72*/   00709000
*                                                                  0475 00710000
         LR    @12,CASESELT                                        0476 00711000
         SLA   @12,2                                               0476 00712000
         L     @12,CP0001@-4(@12)                                  0476 00713000
         BR    @12                                                 0476 00714000
*     /***************************************************************/ 00715000
*     /*                                                             */ 00716000
*     /* PROCESS VOL STATEMENT                               @Y30OE72*/ 00717000
*     /*                                                             */ 00718000
*     /***************************************************************/ 00719000
*                                                                  0477 00720000
*                                                                  0477 00721000
*VOL:  DO; /*SUBCASE*/                /*                       @Y30OE72 00722000
*/                                                                 0477 00723000
VOL      DS    0H                                                  0478 00724000
*     IF NOT1ST=SETON THEN          /* 1ST CONTROL STMT?     @Y30OE72*/ 00725000
         TM    NOT1ST,B'01000000'                                  0478 00726000
         BNO   @RF00478                                            0478 00727000
*       DO;                         /* NO.                   @Y30OE72*/ 00728000
*         MSGLEN=LENGTH(IEB515I);   /* THEN STMT IS OUT OF   @Y30OE72*/ 00729000
         MVI   MSGLEN,X'29'                                        0480 00730000
*         REG1=ADDR(IEB515I);       /* SEQUENCE. VOL STMT    @Y30OE72*/ 00731000
         LA    REG1,IEB515I                                        0481 00732000
*         CALL MSGWRTR;             /* MUST BE 1ST IF IT IS  @Y30OE72*/ 00733000
         BAL   @14,MSGWRTR                                         0482 00734000
*         FAILSW=ON;                /* SUPPLIED. ISSUE MSG   @Y30OE72*/ 00735000
         MVC   FAILSW(1),ON                                        0483 00736000
*       END;                        /* IEB515I               @Y30OE72*/ 00737000
*     ELSE                          /* 1ST STATEMENT         @Y30OE72*/ 00738000
*       DO;                         /*                       @Y30OE72*/ 00739000
         B     @RC00478                                            0485 00740000
@RF00478 DS    0H                                                  0486 00741000
*         LETPTR=ADDR(VOLAREA);     /* PT TO 1ST VOLID CHAR  @Y30OE72*/ 00742000
         LA    LETPTR,VOLAREA                                      0486 00743000
*         CALL VOLCHECK;            /* CHECK VOLID VALIDITY  @Y30OE72*/ 00744000
         BAL   @14,VOLCHECK                                        0487 00745000
*         IF BADVOLID=SETOFF THEN   /* 1ST 6 BYTES OK?       @Y30OE72*/ 00746000
         TM    BADVOLID,B'00000010'                                0488 00747000
         BNZ   @RF00488                                            0488 00748000
*           IF VOLAREA(6)^=BLANK(1) THEN/* YES. IS IT 6 BYT  @Y30OE72*/ 00749000
         CLC   VOLAREA+5(1),BLANK                                  0489 00750000
         BE    @RF00489                                            0489 00751000
*             IF VOLAREA(7)^=BLANK(1) THEN/* YES. IF 7TH BYTE@Y30OE72*/ 00752000
         CLC   VOLAREA+6(1),BLANK                                  0490 00753000
         BE    @RF00490                                            0490 00754000
*               BADVOLID=SETON;     /* NOT BLANK, THEN ITS   @Y30OE72   00755000
*                                      TOO LONG.             @Y30OE72*/ 00756000
         OI    BADVOLID,B'00000010'                                0491 00757000
*         IF BADVOLID=SETON THEN    /* BAD VOLID?            @Y30OE72*/ 00758000
@RF00490 DS    0H                                                  0492 00759000
@RF00489 DS    0H                                                  0492 00760000
@RF00488 TM    BADVOLID,B'00000010'                                0492 00761000
         BNO   @RF00492                                            0492 00762000
*           DO;                     /* YES.                  @Y30OE72*/ 00763000
*             MSGLEN=LENGTH(IEB519I);/* ISSUE                @Y30OE72*/ 00764000
         MVI   MSGLEN,X'21'                                        0494 00765000
*             REG1=ADDR(IEB519I);   /* MESSAGE               @Y30OE72*/ 00766000
         LA    REG1,IEB519I                                        0495 00767000
*             CALL MSGWRTR;         /* IEB519I               @Y30OE72*/ 00768000
         BAL   @14,MSGWRTR                                         0496 00769000
*             FAILSW=ON;            /* TERMINATE RUN         @Y30OE72*/ 00770000
         MVC   FAILSW(1),ON                                        0497 00771000
*           END;                    /*                       @Y30OE72*/ 00772000
*         ELSE                      /* 1ST STATEMENT         @Y30OE72*/ 00773000
*           DO;                     /*                       @Y30OE72*/ 00774000
         B     @RC00492                                            0499 00775000
@RF00492 DS    0H                                                  0500 00776000
*             REPVOL=CARDBUF(6:11); /* SAVE VOLID            @Y30OE72*/ 00777000
         MVC   REPVOL(6),CARDBUF+5                                 0500 00778000
*             VOLSW=ON;             /* IND VOL STMT PROVIDED @Y30OE72*/ 00779000
         MVC   VOLSW(1),ON                                         0501 00780000
*           END;                    /*                       @Y30OE72*/ 00781000
*       END;                        /*                       @Y30OE72*/ 00782000
*        GOTO CE0001@; /*BRANCH TO END OF CASE*/                   0504 00783000
         B     CE0001@                                             0504 00784000
*      END VOL; /*END OF SUBCASE*/                 /*              0505 00785000
*    @Y30OE72*/                                                    0505 00786000
*                                                                  0506 00787000
*     /***************************************************************/ 00788000
*     /*                                                             */ 00789000
*     /* ROUTINE TO CHECK HDR1 REPLACEMENT                   @Y30OE72*/ 00790000
*     /* ( DS - STMT )                                       @Y30OE72*/ 00791000
*     /*                                                             */ 00792000
*     /***************************************************************/ 00793000
*                                                                  0506 00794000
*                                                                  0506 00795000
*DS:   DO; /*SUBCASE*/                 /*                       @Y30OE7 00796000
**/                                                                0506 00797000
DS       DS    0H                                                  0507 00798000
*     IF CARDBUF(4:5)=BLANK(1:2)|CARDBUF(6)^=BLANK(1)/* IF   @Y30OE72   00799000
*                                      SEQ-NBR FIELD=        @Y30OE72*/ 00800000
*       THEN                        /*                       @Y30OE72*/ 00801000
         CLC   CARDBUF+3(2),BLANK                                  0507 00802000
         BE    @RT00507                                            0507 00803000
         CLC   CARDBUF+5(1),BLANK                                  0507 00804000
         BE    @RF00507                                            0507 00805000
@RT00507 DS    0H                                                  0508 00806000
*       SW505I=ERRON;               /* BLANK OR NEXT FLD     @Y30OE72   00807000
*                                      NOT BLANK, FAIL       @Y30OE72*/ 00808000
         OI    SW505I,B'10000000'                                  0508 00809000
*     ELSE                          /* VALID DS # FORMAT     @Y30OE72*/ 00810000
*       IF^(CARDBUF(4)>=CHAR0&      /* IS                    @Y30OE72*/ 00811000
*           CARDBUF(4)<=CHAR9&      /* DS                    @Y30OE72*/ 00812000
*           CARDBUF(5)>=CHAR0&      /* NUMBER                @Y30OE72*/ 00813000
*           CARDBUF(5)<=CHAR9) THEN /* NUMERIC?              @Y30OE72*/ 00814000
         B     @RC00507                                            0509 00815000
@RF00507 CLI   CARDBUF+3,C'0'                                      0509 00816000
         BL    @RT00509                                            0509 00817000
         CLI   CARDBUF+3,C'9'                                      0509 00818000
         BH    @RT00509                                            0509 00819000
         CLI   CARDBUF+4,C'0'                                      0509 00820000
         BL    @RT00509                                            0509 00821000
         CLI   CARDBUF+4,C'9'                                      0509 00822000
         BNH   @RF00509                                            0509 00823000
@RT00509 DS    0H                                                  0510 00824000
*         SW515I=ERRON;             /* NO. FAIL              @Y30OE72*/ 00825000
         OI    SW515I,B'00001000'                                  0510 00826000
*       ELSE                        /* DS NUMBER             @Y30OE72*/ 00827000
*         DO;                       /* IS NUMERIC.           @Y30OE72*/ 00828000
         B     @RC00509                                            0511 00829000
@RF00509 DS    0H                                                  0512 00830000
*           WORK1=WORK1&&WORK1;     /* INITIALIZE WORKFIELDS @Y30OE72*/ 00831000
         XC    WORK1(4),WORK1                                      0512 00832000
*           WORK2=WORK2&&WORK2;     /*                       @Y30OE72*/ 00833000
         XC    WORK2(4),WORK2                                      0513 00834000
*           PACK(WORK1,CARDBUF(4:5));/* CONVERT DS-NBR       @Y30OE72*/ 00835000
         PACK  WORK1(4),CARDBUF+3(2)                               0514 00836000
*           CVB(WORKB,WORK1);       /* AND TRANSFER IT TO    @Y30OE72*/ 00837000
         XC    @TS00001(8),@TS00001                                0515 00838000
         MVC   @TS00001+4(4),WORK1                                 0515 00839000
         CVB   @12,@TS00001                                        0515 00840000
         ST    @12,WORKB                                           0515 00841000
*           DSNR=WORK2(4);          /* DSNR                  @Y30OE72*/ 00842000
         MVC   DSNR(1),WORK2+3                                     0516 00843000
*           IF DSNR>19|             /* DS # MUST BE < 19 &   @Y30OE72*/ 00844000
*               DSNR<1 THEN         /* > 1                   @Y30OE72*/ 00845000
         CLI   DSNR,19                                             0517 00846000
         BH    @RT00517                                            0517 00847000
         CLI   DSNR,1                                              0517 00848000
         BNL   @RF00517                                            0517 00849000
@RT00517 DS    0H                                                  0518 00850000
*             SW515I=ERRON;         /* IF NOT CANCEL         @Y30OE72*/ 00851000
         OI    SW515I,B'00001000'                                  0518 00852000
*           ELSE                    /*                       @Y30OE72*/ 00853000
*             DO;                   /*                       @Y30OE72*/ 00854000
         B     @RC00517                                            0519 00855000
@RF00517 DS    0H                                                  0520 00856000
*               IF N>1 THEN         /*                       @Y30OE72*/ 00857000
         CLI   N,1                                                 0520 00858000
         BNH   @RF00520                                            0520 00859000
*                 IF DSNR^>NUMTAB(N-1)/* DS # MUST BE        @Y30OE72*/ 00860000
*                   THEN            /*                       @Y30OE72*/ 00861000
         SLR   @12,@12                                             0521 00862000
         IC    @12,N                                               0521 00863000
         SLR   @11,@11                                             0521 00864000
         IC    @11,DSNR                                            0521 00865000
         SLR   @00,@00                                             0521 00866000
         IC    @00,NUMTAB-2(@12)                                   0521 00867000
         CR    @11,@00                                             0521 00868000
         BH    @RF00521                                            0521 00869000
*                   SW515I=ERRON;   /* GREATER THAN          @Y30OE72*/ 00870000
         OI    SW515I,B'00001000'                                  0522 00871000
*               IF D>1 THEN         /* PREVIOUS DS #         @Y30OE72*/ 00872000
@RF00521 DS    0H                                                  0523 00873000
@RF00520 CLI   D,1                                                 0523 00874000
         BNH   @RF00523                                            0523 00875000
*                 IF DSNR^>DELTAB(D-1)/* IF NOT HIGHER       @Y30OE72*/ 00876000
*                   THEN            /*                       @Y30OE72*/ 00877000
         SLR   @12,@12                                             0524 00878000
         IC    @12,D                                               0524 00879000
         SLR   @11,@11                                             0524 00880000
         IC    @11,DSNR                                            0524 00881000
         SLR   @00,@00                                             0524 00882000
         IC    @00,DELTAB-2(@12)                                   0524 00883000
         CR    @11,@00                                             0524 00884000
         BH    @RF00524                                            0524 00885000
*                   SW515I=ERRON;   /* FAIL                  @Y30OE72*/ 00886000
         OI    SW515I,B'00001000'                                  0525 00887000
*             END;                  /*                       @Y30OE72*/ 00888000
@RF00524 DS    0H                                                  0526 00889000
@RF00523 DS    0H                                                  0527 00890000
*         END;                      /*                       @Y30OE72*/ 00891000
@RC00517 DS    0H                                                  0528 00892000
*     IF SWDS=ZERO THEN             /* SEQ # OK?             @Y30OE72*/ 00893000
@RC00509 DS    0H                                                  0528 00894000
@RC00507 CLI   SWDS,0                                              0528 00895000
         BNE   @RF00528                                            0528 00896000
*INTDO2:                            /*                       @Y30OE72*/ 00897000
*       DO;                         /* YES. CONTINUE         @Y30OE72*/ 00898000
INTDO2   DS    0H                                                  0530 00899000
*         IF CARDBUF(7:71)=BLANK(1:65) THEN/* IF A DELETED ENTR    0530 00900000
*                                                            @Y30OE72*/ 00901000
         CLC   CARDBUF+6(65),BLANK                                 0530 00902000
         BNE   @RF00530                                            0530 00903000
*           DO;                     /* IS DESCRIBED IN       @Y30OE72*/ 00904000
*             DELTAB(D)=DSNR;       /* THE DS-CARD, ENTER    @Y30OE72*/ 00905000
         SLR   @12,@12                                             0532 00906000
         IC    @12,D                                               0532 00907000
         SLR   @11,@11                                             0532 00908000
         IC    @11,DSNR                                            0532 00909000
         STC   @11,DELTAB-1(@12)                                   0532 00910000
*             D=D+1;                /* SEQ-NBR IN DELTAB,    @Y30OE72   00911000
*                                      UPDATE INDEX D TO     @Y30OE72*/ 00912000
         LA    @12,1(,@12)                                         0533 00913000
         STC   @12,D                                               0533 00914000
*             DELENT=SETON;         /* IND DELETED ENT FOUND @Y30OE72*/ 00915000
         OI    DELENT,B'00100000'                                  0534 00916000
*           END;                    /* RETURN.               @Y30OE72*/ 00917000
*         ELSE                      /*                       @Y30OE72*/ 00918000
*INTDO3:                            /*                       @Y30OE72*/ 00919000
*           DO;                     /* START REQUIRED ENTS   @Y30OE72*/ 00920000
         B     @RC00530                                            0536 00921000
@RF00530 DS    0H                                                  0536 00922000
INTDO3   DS    0H                                                  0537 00923000
*             NUMTAB(N)=DSNR;       /* FILE NBR TO NUMTAB    @Y30OE72*/ 00924000
         SLR   @12,@12                                             0537 00925000
         IC    @12,N                                               0537 00926000
         SLR   @11,@11                                             0537 00927000
         IC    @11,DSNR                                            0537 00928000
         STC   @11,NUMTAB-1(@12)                                   0537 00929000
*             DO A=7 TO 51 WHILE CARDBUF(A)=BLANK(1);/* FIND DATA  0538 00930000
*                                                            @Y30OE72*/ 00931000
         LA    @12,7                                               0538 00932000
         STC   @12,A                                               0538 00933000
@DL00538 LA    @11,CARDBUF-1(@12)                                  0538 00934000
         CLC   0(1,@11),BLANK                                      0538 00935000
         BNE   @DC00538                                            0538 00936000
*             END;                  /* START                 @Y30OE72*/ 00937000
         AH    @12,@CH00052                                        0539 00938000
         STC   @12,A                                               0539 00939000
         CH    @12,@CH03382                                        0539 00940000
         BNH   @DL00538                                            0539 00941000
@DC00538 DS    0H                                                  0540 00942000
*             DO B=7 TO 52 WHILE CARDBUF(B)^=COMMA;/* FIND FIRST   0540 00943000
*                                                            @Y30OE72*/ 00944000
         LA    B,7                                                 0540 00945000
@DL00540 LA    @12,CARDBUF-1(B)                                    0540 00946000
         CLI   0(@12),C','                                         0540 00947000
         BE    @DC00540                                            0540 00948000
*             END;                  /* COMMA                 @Y30OE72*/ 00949000
         AH    B,@CH00052                                          0541 00950000
         CH    B,@CH00042                                          0541 00951000
         BNH   @DL00540                                            0541 00952000
@DC00540 DS    0H                                                  0542 00953000
*             IF A>51|B>52 THEN     /*                       @Y30OE72*/ 00954000
         CLI   A,51                                                0542 00955000
         BH    @RT00542                                            0542 00956000
         CH    B,@CH00042                                          0542 00957000
         BNH   @RF00542                                            0542 00958000
@RT00542 DS    0H                                                  0543 00959000
*               SW505I=ERRON;       /* START INVALID         @Y30OE72*/ 00960000
         OI    SW505I,B'10000000'                                  0543 00961000
*             ELSE                  /*                       @Y30OE72*/ 00962000
*INTDO4:                            /*                       @Y30OE72*/ 00963000
*               DO;                 /*                       @Y30OE72*/ 00964000
         B     @RC00542                                            0544 00965000
@RF00542 DS    0H                                                  0544 00966000
INTDO4   DS    0H                                                  0545 00967000
*                 IF B^>A|B>(A+8) THEN/* DSID MUST BE        @Y30OE72*/ 00968000
         SLR   @12,@12                                             0545 00969000
         IC    @12,A                                               0545 00970000
         CR    B,@12                                               0545 00971000
         BNH   @RT00545                                            0545 00972000
         AH    @12,@CH00034                                        0545 00973000
         CR    B,@12                                               0545 00974000
         BNH   @RF00545                                            0545 00975000
@RT00545 DS    0H                                                  0546 00976000
*                   SW505I=ERRON;   /* <= 8 CHARS            @Y30OE72*/ 00977000
         OI    SW505I,B'10000000'                                  0546 00978000
*                 ELSE              /*                       @Y30OE72*/ 00979000
*                   DO;             /*                       @Y30OE72*/ 00980000
         B     @RC00545                                            0547 00981000
@RF00545 DS    0H                                                  0548 00982000
*                     DSIDLEN=B-A;  /* SAVE LEN OF DSID      @Y30OE72*/ 00983000
         SLR   @12,@12                                             0548 00984000
         IC    @12,A                                               0548 00985000
         LR    @11,B                                               0548 00986000
         SLR   @11,@12                                             0548 00987000
         STC   @11,DSIDLEN                                         0548 00988000
*                     REPTAB(N,1:(B-A))=CARDBUF(A:(B-1));/* XFER FILE   00989000
*                                      ID                    @Y30OE72*/ 00990000
         SLR   @02,@02                                             0549 00991000
         IC    @02,N                                               0549 00992000
         MH    @02,@CH02356                                        0549 00993000
         LA    @15,REPTAB-47(@02)                                  0549 00994000
         BCTR  @11,0                                               0549 00995000
         LA    @02,CARDBUF-1(@12)                                  0549 00996000
         EX    @11,@SM03550                                        0549 00997000
*                     A=B+1;        /* POINT A TO RECL       @Y30OE72*/ 00998000
         LA    @12,1(,B)                                           0550 00999000
         STC   @12,A                                               0550 01000000
*                     J=A;          /* POINT J TO NXT FLD    @Y30OE72*/ 01001000
         ST    @12,J                                               0551 01002000
*                     DO B=J TO(J+5) WHILE CARDBUF(B)^=COMMA;/* FIND    01003000
*                                      2ND ,                 @Y30OE72*/ 01004000
         LR    B,@12                                               0552 01005000
         B     @DE00552                                            0552 01006000
@DL00552 LA    @12,CARDBUF-1(B)                                    0552 01007000
         CLI   0(@12),C','                                         0552 01008000
         BE    @DC00552                                            0552 01009000
*                     END;          /*                       @Y30OE72*/ 01010000
         AH    B,@CH00052                                          0553 01011000
@DE00552 LA    @12,5                                               0553 01012000
         AL    @12,J                                               0553 01013000
         CR    B,@12                                               0553 01014000
         BNH   @DL00552                                            0553 01015000
@DC00552 DS    0H                                                  0554 01016000
*                     IF B^>A|B>(A+5) THEN/* BLK SZE LEN     @Y30OE72*/ 01017000
         SLR   @12,@12                                             0554 01018000
         IC    @12,A                                               0554 01019000
         CR    B,@12                                               0554 01020000
         BNH   @RT00554                                            0554 01021000
         AH    @12,@CH00038                                        0554 01022000
         CR    B,@12                                               0554 01023000
         BNH   @RF00554                                            0554 01024000
@RT00554 DS    0H                                                  0555 01025000
*                       SW505I=ERRON;/* MUST BE 1-5 CHARS    @Y30OE72*/ 01026000
         OI    SW505I,B'10000000'                                  0555 01027000
*                     ELSE          /*                       @Y30OE72*/ 01028000
*                       DO;         /*                       @Y30OE72*/ 01029000
         B     @RC00554                                            0556 01030000
@RF00554 DS    0H                                                  0557 01031000
*                         REPTAB(N,(14+A-B):13)=CARDBUF(A:(B-1));/*     01032000
*                                      XFER RECL             @Y30OE72*/ 01033000
         SLR   @12,@12                                             0557 01034000
         IC    @12,N                                               0557 01035000
         MH    @12,@CH02356                                        0557 01036000
         SLR   @11,@11                                             0557 01037000
         IC    @11,A                                               0557 01038000
         LA    @02,14                                              0557 01039000
         LR    @15,@11                                             0557 01040000
         ALR   @15,@02                                             0557 01041000
         SLR   @15,B                                               0557 01042000
         ALR   @12,@15                                             0557 01043000
         LA    @14,REPTAB-48(@12)                                  0557 01044000
         LCR   @15,@15                                             0557 01045000
         AH    @15,@CH02083                                        0557 01046000
         LA    @12,CARDBUF-1(@11)                                  0557 01047000
         EX    @15,@SM03552                                        0557 01048000
*                         A=B+1;    /* PT A TO BOE CARDBUF   @Y30OE72*/ 01049000
         LA    @12,1                                               0558 01050000
         LR    @11,B                                               0558 01051000
         ALR   @11,@12                                             0558 01052000
         STC   @11,A                                               0558 01053000
*                         J=14;     /* POINT J TO BOE REPTAB @Y30OE72*/ 01054000
         ST    @02,J                                               0559 01055000
*                         DO I=1 TO 2;/* SET LOOP CONTROL    @Y30OE72*/ 01056000
         ST    @12,I                                               0560 01057000
@DL00560 DS    0H                                                  0561 01058000
*                           IF CARDBUF(A+5)^=COMMA THEN/*    @Y30OE72*/ 01059000
         SLR   @12,@12                                             0561 01060000
         IC    @12,A                                               0561 01061000
         LA    @11,CARDBUF+4(@12)                                  0561 01062000
         CLI   0(@11),C','                                         0561 01063000
         BE    @RF00561                                            0561 01064000
*                             SW505I=ERRON;/* CHECK LNTH     @Y30OE72*/ 01065000
         OI    SW505I,B'10000000'                                  0562 01066000
*                           REPTAB(N,J:(J+4))=CARDBUF(A:(A+4));/*  0563 01067000
*                                                            @Y30OE72   01068000
*                                      XFER BOE,EOE          @Y30OE72*/ 01069000
@RF00561 L     @12,J                                               0563 01070000
         SLR   @11,@11                                             0563 01071000
         IC    @11,N                                               0563 01072000
         MH    @11,@CH02356                                        0563 01073000
         ALR   @11,@12                                             0563 01074000
         LA    @15,REPTAB-48(@11)                                  0563 01075000
         SLR   @11,@11                                             0563 01076000
         IC    @11,A                                               0563 01077000
         LA    @14,CARDBUF-1(@11)                                  0563 01078000
         MVC   0(5,@15),0(@14)                                     0563 01079000
*                           A=A+6;  /* UPDATE CARDBUF INDEX  @Y30OE72*/ 01080000
         LA    @11,6(,@11)                                         0564 01081000
         STC   @11,A                                               0564 01082000
*                           J=J+5;  /* UPDATE REPTAB INDEX   @Y30OE72*/ 01083000
         AH    @12,@CH00038                                        0565 01084000
         ST    @12,J                                               0565 01085000
*                         END;      /*                       @Y30OE72*/ 01086000
         LA    @12,1                                               0566 01087000
         AL    @12,I                                               0566 01088000
         ST    @12,I                                               0566 01089000
         CH    @12,@CH00070                                        0566 01090000
         BNH   @DL00560                                            0566 01091000
*                         REPEOD(N)=CARDBUF(A:(A+4));/* XFER EOD   0567 01092000
*                                                            @Y30OE72*/ 01093000
         SLR   @12,@12                                             0567 01094000
         IC    @12,N                                               0567 01095000
         MH    @12,@CH02356                                        0567 01096000
         LA    @11,REPEOD-47(@12)                                  0567 01097000
         SLR   @12,@12                                             0567 01098000
         IC    @12,A                                               0567 01099000
         LA    @15,CARDBUF-1(@12)                                  0567 01100000
         MVC   0(5,@11),0(@15)                                     0567 01101000
*                       END;        /*                       @Y30OE72*/ 01102000
*                   END;            /*                       @Y30OE72*/ 01103000
@RC00554 DS    0H                                                  0570 01104000
*               END INTDO4;         /*                       @Y30OE72*/ 01105000
@RC00545 DS    0H                                                  0571 01106000
*           END INTDO3;             /*                       @Y30OE72*/ 01107000
@RC00542 DS    0H                                                  0572 01108000
*         IF SWDS=ZERO THEN         /* REQUIRED ENTRIES OK?  @Y30OE72*/ 01109000
@RC00530 CLI   SWDS,0                                              0572 01110000
         BNE   @RF00572                                            0572 01111000
*INTDO5:                            /*                       @Y30OE72*/ 01112000
*           DO;                     /* YES                   @Y30OE72   01113000
*                                      DO OPTIONAL ENTRIES   @Y30OE72*/ 01114000
INTDO5   DS    0H                                                  0574 01115000
*             A=A+5;                /* UPDATE CARDBUF INDEX  @Y30OE72*/ 01116000
         LA    @12,5                                               0574 01117000
         SLR   @11,@11                                             0574 01118000
         IC    @11,A                                               0574 01119000
         ALR   @11,@12                                             0574 01120000
         STC   @11,A                                               0574 01121000
*             J=J+5;                /* UPDATE REPTAB INDEX   @Y30OE72*/ 01122000
         AL    @12,J                                               0575 01123000
         ST    @12,J                                               0575 01124000
*             I=0;                  /* INIT COMMA COUNTER    @Y30OE72*/ 01125000
         SLR   @12,@12                                             0576 01126000
         ST    @12,I                                               0576 01127000
*             IF CARDBUF(A)=BLANK(1) THEN/*                  @Y30OE72*/ 01128000
         LA    @12,CARDBUF-1(@11)                                  0577 01129000
         CLC   0(1,@12),BLANK                                      0577 01130000
         BNE   @RF00577                                            0577 01131000
*               GOODDS=SETON;       /* ONLY BLANK OR COMMA   @Y30OE72*/ 01132000
         OI    GOODDS,B'01000000'                                  0578 01133000
*             ELSE                  /*                       @Y30OE72*/ 01134000
*INTDO6:                                                           0579 01135000
*               DO;                 /*                       @Y30OE72*/ 01136000
         B     @RC00577                                            0579 01137000
@RF00577 DS    0H                                                  0579 01138000
INTDO6   DS    0H                                                  0580 01139000
*                 IF CARDBUF(A)^=COMMA THEN/*                @Y30OE72*/ 01140000
         SLR   @12,@12                                             0580 01141000
         IC    @12,A                                               0580 01142000
         LA    @11,CARDBUF-1(@12)                                  0580 01143000
         CLI   0(@11),C','                                         0580 01144000
         BE    @RF00580                                            0580 01145000
*                   SW505I=ERRON;   /* IS ALLOWED            @Y30OE72   01146000
*                                      FOLLOWING AN ENTRY    @Y30OE72   01147000
*                                      START 5 1-BYTE ENTS   @Y30OE72*/ 01148000
         OI    SW505I,B'10000000'                                  0581 01149000
*                 ELSE                                             0582 01150000
*                   DO;             /*                       @Y30OE72*/ 01151000
         B     @RC00580                                            0582 01152000
@RF00580 DS    0H                                                  0583 01153000
*                     IF CARDBUF(A+1)=BLANK(1) THEN/*        @Y30OE72*/ 01154000
         SLR   @12,@12                                             0583 01155000
         IC    @12,A                                               0583 01156000
         LA    @11,CARDBUF(@12)                                    0583 01157000
         CLC   0(1,@11),BLANK                                      0583 01158000
         BNE   @RF00583                                            0583 01159000
*                       SW505I=ERRON;/*                      @Y30OE72*/ 01160000
         OI    SW505I,B'10000000'                                  0584 01161000
*                     ELSE          /* PROCESS 1-BYTE ENTS   @Y30OE72*/ 01162000
*                       DO WHILE I^>4&GOODDS=SETOFF&/*       @Z30OE72*/ 01163000
*                             SW505I=SETOFF;/*               @Z30OE72*/ 01164000
         B     @RC00583                                            0585 01165000
@RF00583 B     @DE00585                                            0585 01166000
@DL00585 DS    0H                                                  0586 01167000
*                         A=A+1;    /*                       @Y30OE72*/ 01168000
         SLR   @12,@12                                             0586 01169000
         IC    @12,A                                               0586 01170000
         LA    @12,1(,@12)                                         0586 01171000
         STC   @12,A                                               0586 01172000
*                         IF CARDBUF(A)^=COMMA THEN/*        @Y30OE72*/ 01173000
         LA    @11,CARDBUF-1(@12)                                  0587 01174000
         CLI   0(@11),C','                                         0587 01175000
         BE    @RF00587                                            0587 01176000
*                           DO;     /*                       @Y30OE72*/ 01177000
*                             REPTAB(N,J)=CARDBUF(A);/*      @Y30OE72*/ 01178000
         SLR   @11,@11                                             0589 01179000
         IC    @11,N                                               0589 01180000
         MH    @11,@CH02356                                        0589 01181000
         AL    @11,J                                               0589 01182000
         LA    @15,REPTAB-48(@11)                                  0589 01183000
         LA    @11,CARDBUF-1(@12)                                  0589 01184000
         MVC   0(1,@15),0(@11)                                     0589 01185000
*                             IF CARDBUF(A+1)=BLANK(1) THEN/*      0590 01186000
*                                                            @Y30OE72*/ 01187000
         LA    @11,CARDBUF(@12)                                    0590 01188000
         CLC   0(1,@11),BLANK                                      0590 01189000
         BNE   @RF00590                                            0590 01190000
*                               GOODDS=SETON;/* STMT END     @Y30OE72*/ 01191000
         OI    GOODDS,B'01000000'                                  0591 01192000
*                             ELSE  /*                       @Y30OE72*/ 01193000
*                               IF CARDBUF(A+1)^=COMMA THEN/*      0592 01194000
*                                                            @Y30OE72*/ 01195000
         B     @RC00590                                            0592 01196000
@RF00590 SLR   @12,@12                                             0592 01197000
         IC    @12,A                                               0592 01198000
         LA    @11,CARDBUF(@12)                                    0592 01199000
         CLI   0(@11),C','                                         0592 01200000
         BE    @RF00592                                            0592 01201000
*                                 SW505I=ERRON;/*            @Y30OE72*/ 01202000
         OI    SW505I,B'10000000'                                  0593 01203000
*                           END;    /*                       @Y30OE72*/ 01204000
*                         ELSE      /* PROCESS               @Y30OE72*/ 01205000
*                           DO;     /* NEXT ENTRY            @Y30OE72*/ 01206000
         B     @RC00587                                            0595 01207000
@RF00587 DS    0H                                                  0596 01208000
*                             I=I+1;/* LOOP CONTROL          @Y30OE72*/ 01209000
         LA    @12,1                                               0596 01210000
         L     @11,I                                               0596 01211000
         ALR   @11,@12                                             0596 01212000
         ST    @11,I                                               0596 01213000
*                             J=J+1;/* REPTAB INDEX          @Y30OE72*/ 01214000
         AL    @12,J                                               0597 01215000
         ST    @12,J                                               0597 01216000
*                             IF CARDBUF(A+1)=BLANK(1) THEN/*      0598 01217000
*                                                            @Y30OE72*/ 01218000
         SLR   @12,@12                                             0598 01219000
         IC    @12,A                                               0598 01220000
         LA    @11,CARDBUF(@12)                                    0598 01221000
         CLC   0(1,@11),BLANK                                      0598 01222000
         BNE   @RF00598                                            0598 01223000
*                               SW505I=ERRON;/*              @Y30OE72*/ 01224000
         OI    SW505I,B'10000000'                                  0599 01225000
*                           END;    /*                       @Y30OE72*/ 01226000
@RF00598 DS    0H                                                  0601 01227000
*                       END;        /* DO WHILE              @Y30OE72*/ 01228000
@RC00587 DS    0H                                                  0601 01229000
@DE00585 CLC   I(4),@CF00037                                       0601 01230000
         BH    @DC00585                                            0601 01231000
         TM    GOODDS,B'11000000'                                  0601 01232000
         BZ    @DL00585                                            0601 01233000
@DC00585 DS    0H                                                  0602 01234000
*                   END;            /*                       @Y30OE72*/ 01235000
@RC00583 DS    0H                                                  0603 01236000
*               END INTDO6;         /*                       @Y30OE72*/ 01237000
@RC00580 DS    0H                                                  0604 01238000
*           END INTDO5;             /*                       @Y30OE72*/ 01239000
@RC00577 DS    0H                                                  0605 01240000
*         IF SWDS=ZERO THEN         /* EVERYTHING OK?        @Y30OE72*/ 01241000
@RF00572 CLI   SWDS,0                                              0605 01242000
         BNE   @RF00605                                            0605 01243000
*INTDO7:                            /*                       @Y30OE72*/ 01244000
*           DO;                     /* YES. CONTINUE         @Y30OE72*/ 01245000
INTDO7   DS    0H                                                  0607 01246000
*             A=A+1;                /* COMMA BEFORE SEQ# ENT @Y30OE72*/ 01247000
         SLR   @12,@12                                             0607 01248000
         IC    @12,A                                               0607 01249000
         LA    @12,1(,@12)                                         0607 01250000
         STC   @12,A                                               0607 01251000
*             IF CARDBUF(A)^=COMMA THEN/* NO BLANK&NO COMMA  @Y30OE72*/ 01252000
         LA    @11,CARDBUF-1(@12)                                  0608 01253000
         CLI   0(@11),C','                                         0608 01254000
         BE    @RF00608                                            0608 01255000
*               DO;                 /* SO IT IS AN ENTRY     @Y30OE72*/ 01256000
*                 REPSEQ#(N)=CARDBUF(A:(A+1));/* XFER ENTRY AND    0610 01257000
*                                                            @Y30OE72*/ 01258000
         SLR   @11,@11                                             0610 01259000
         IC    @11,N                                               0610 01260000
         MH    @11,@CH02356                                        0610 01261000
         LA    @15,REPSEQ#-47(@11)                                 0610 01262000
         LA    @11,CARDBUF-1(@12)                                  0610 01263000
         MVC   0(2,@15),0(@11)                                     0610 01264000
*                 A=A+2;            /* UPDATE CARDBUF PTR    @Y30OE72*/ 01265000
         LA    @12,2(,@12)                                         0611 01266000
         STC   @12,A                                               0611 01267000
*               END;                /*                       @Y30OE72*/ 01268000
*             J=J+2;                /* UPDATE REPTAB PTR     @Y30OE72*/ 01269000
@RF00608 LA    @12,2                                               0613 01270000
         AL    @12,J                                               0613 01271000
         ST    @12,J                                               0613 01272000
*INTDO8:                            /*                       @Y30OE72*/ 01273000
*             DO I=1 TO 2           /* START DATE-ENTRIES    @Y30OE72*/ 01274000
*                   WHILE GOODDS=SETOFF;/*                   @Y30OE72*/ 01275000
INTDO8   LA    @12,1                                               0614 01276000
         ST    @12,I                                               0614 01277000
@DL00614 TM    GOODDS,B'01000000'                                  0614 01278000
         BNZ   @DC00614                                            0614 01279000
*               IF CARDBUF(A)=COMMA THEN/*                   @Y30OE72*/ 01280000
         SLR   @12,@12                                             0615 01281000
         IC    @12,A                                               0615 01282000
         LA    @11,CARDBUF-1(@12)                                  0615 01283000
         CLI   0(@11),C','                                         0615 01284000
         BNE   @RF00615                                            0615 01285000
*                 A=A+1;            /* IF COMMA,UPD. PTR     @Y30OE72*/ 01286000
         LA    @12,1(,@12)                                         0616 01287000
         STC   @12,A                                               0616 01288000
*               ELSE                /* NOT A COMMA           @Y30OE72*/ 01289000
*                 IF CARDBUF(A)=BLANK(1) THEN/*              @Y30OE72*/ 01290000
         B     @RC00615                                            0617 01291000
@RF00615 SLR   @12,@12                                             0617 01292000
         IC    @12,A                                               0617 01293000
         LA    @11,CARDBUF-1(@12)                                  0617 01294000
         CLC   0(1,@11),BLANK                                      0617 01295000
         BNE   @RF00617                                            0617 01296000
*                   GOODDS=SETON;   /* STMT END              @Y30OE72*/ 01297000
         OI    GOODDS,B'01000000'                                  0618 01298000
*                 ELSE              /*                       @Y30OE72*/ 01299000
*                   SW505I=ERRON;   /* NEITER, CANCEL        @Y30OE72*/ 01300000
         B     @RC00617                                            0619 01301000
@RF00617 OI    SW505I,B'10000000'                                  0619 01302000
*               IF CARDBUF(A)=BLANK(1)&/* BLANK COL AND NOT  @Y30OE72*/ 01303000
*                   GOODDS=SETOFF THEN/* END OF STMT         @Y30OE72*/ 01304000
@RC00617 DS    0H                                                  0620 01305000
@RC00615 SLR   @12,@12                                             0620 01306000
         IC    @12,A                                               0620 01307000
         LA    @11,CARDBUF-1(@12)                                  0620 01308000
         CLC   0(1,@11),BLANK                                      0620 01309000
         BNE   @RF00620                                            0620 01310000
         TM    GOODDS,B'01000000'                                  0620 01311000
         BNZ   @RF00620                                            0620 01312000
*                 SW505I=ERRON;     /* THEN ITS AN ERROR     @Y30OE72*/ 01313000
         OI    SW505I,B'10000000'                                  0621 01314000
*               ELSE                /*                       @Y30OE72*/ 01315000
*                 IF CARDBUF(A)^=COMMA&/* NO BLANK,NO COMMA  @Y30OE72*/ 01316000
*                     GOODDS=SETOFF THEN/* NOT END OF STMT   @Y30OE72*/ 01317000
         B     @RC00620                                            0622 01318000
@RF00620 SLR   @12,@12                                             0622 01319000
         IC    @12,A                                               0622 01320000
         LA    @11,CARDBUF-1(@12)                                  0622 01321000
         CLI   0(@11),C','                                         0622 01322000
         BE    @RF00622                                            0622 01323000
         TM    GOODDS,B'01000000'                                  0622 01324000
         BNZ   @RF00622                                            0622 01325000
*                   DO;             /* SO IT IS AN ENTRY     @Y30OE72*/ 01326000
*                     REPTAB(N,J:(J+5))=CARDBUF(A:(A+5));/* XFER   0624 01327000
*                                                            @Y30OE72   01328000
*                                      ENTRY AND             @Y30OE72*/ 01329000
         SLR   @11,@11                                             0624 01330000
         IC    @11,N                                               0624 01331000
         MH    @11,@CH02356                                        0624 01332000
         AL    @11,J                                               0624 01333000
         LA    @15,REPTAB-48(@11)                                  0624 01334000
         LA    @11,CARDBUF-1(@12)                                  0624 01335000
         MVC   0(6,@15),0(@11)                                     0624 01336000
*                     A=A+6;        /* UPDATE CARDBUF PTR    @Y30OE72*/ 01337000
         LA    @12,6(,@12)                                         0625 01338000
         STC   @12,A                                               0625 01339000
*                   END;            /*                       @Y30OE72*/ 01340000
*               J=J+6;              /* UPDATE REPTAB PTR     @Y30OE72*/ 01341000
@RF00622 DS    0H                                                  0627 01342000
@RC00620 LA    @12,6                                               0627 01343000
         AL    @12,J                                               0627 01344000
         ST    @12,J                                               0627 01345000
*             END INTDO8;           /*                       @Y30OE72*/ 01346000
         LA    @12,1                                               0628 01347000
         AL    @12,I                                               0628 01348000
         ST    @12,I                                               0628 01349000
         CH    @12,@CH00070                                        0628 01350000
         BNH   @DL00614                                            0628 01351000
@DC00614 DS    0H                                                  0629 01352000
*             IF CARDBUF(A)^=BLANK(1) THEN/* STMT MUST BE    @Y30OE72*/ 01353000
         SLR   @12,@12                                             0629 01354000
         IC    @12,A                                               0629 01355000
         LA    @11,CARDBUF-1(@12)                                  0629 01356000
         CLC   0(1,@11),BLANK                                      0629 01357000
         BE    @RF00629                                            0629 01358000
*               SW505I=ERRON;       /* DELIMITED BY BLANK    @Y30OE72*/ 01359000
         OI    SW505I,B'10000000'                                  0630 01360000
*             IF SW505I=SETOFF THEN /* ANY ERR IN DATES?     @Z30OE72*/ 01361000
@RF00629 TM    SW505I,B'10000000'                                  0631 01362000
         BNZ   @RF00631                                            0631 01363000
*               GOODDS=SETON;       /* NO. GOOD STMT         @Z30OE72*/ 01364000
         OI    GOODDS,B'01000000'                                  0632 01365000
*           END INTDO7;             /*                       #Y30OE72*/ 01366000
*                                                                  0633 01367000
@RF00631 DS    0H                                                  0634 01368000
*         /***********************************************************/ 01369000
*         /*                                                         */ 01370000
*         /*                                                 @Y30OE72*/ 01371000
*         /* END DATA XFER FROM CARDBUF TO REPTAB            @Y30OE72*/ 01372000
*         /*                                                 @Y30OE72*/ 01373000
*         /*                                                         */ 01374000
*         /***********************************************************/ 01375000
*                                                                  0634 01376000
*         IF GOODDS=SETON THEN      /* ANY ERR IN DS STMT?   @Z30OE72*/ 01377000
@RF00605 TM    GOODDS,B'01000000'                                  0634 01378000
         BNO   @RF00634                                            0634 01379000
*           DO;                     /* NO.                   @Z30OE72*/ 01380000
*             LETPTR=ADDR(REPBOE(N));/* PT TO 1ST BOE CHAR   @Z30OE72*/ 01381000
         SLR   LETPTR,LETPTR                                       0636 01382000
         IC    LETPTR,N                                            0636 01383000
         MH    LETPTR,@CH02356                                     0636 01384000
         LA    LETPTR,REPBOE-47(LETPTR)                            0636 01385000
*             DO I=1 TO 15          /* CHECK BOE,EOE,EOD     @Z30OE72*/ 01386000
*                   WHILE SW506I=SETOFF;/* EXTENTS           @Z30OE72*/ 01387000
         LA    @12,1                                               0637 01388000
         ST    @12,I                                               0637 01389000
@DL00637 TM    SW506I,B'00010000'                                  0637 01390000
         BNZ   @DC00637                                            0637 01391000
*               IF^(LETTER>=CHAR0&  /* CHARS FOR             @Z30OE72*/ 01392000
*                   LETTER<=CHAR9) THEN/* NUMERICS           @Z30OE72*/ 01393000
         CLI   LETTER(LETPTR),C'0'                                 0638 01394000
         BL    @RT00638                                            0638 01395000
         CLI   LETTER(LETPTR),C'9'                                 0638 01396000
         BNH   @RF00638                                            0638 01397000
@RT00638 DS    0H                                                  0639 01398000
*                 DO;               /*                       @Z30OE72*/ 01399000
*                   SW506I=ERRON;   /* NOT NUMERIC           @Z30OE72*/ 01400000
*                   GOODDS=SETOFF;  /* FAIL                  @Z30OE72*/ 01401000
         OI    SW506I,B'00010000'                                  0641 01402000
         NI    GOODDS,B'10111111'                                  0641 01403000
*                 END;              /*                       @Z30OE72*/ 01404000
*               LETPTR=LETPTR+1;    /* PT TO NEXT CHAR       @Z30OE72*/ 01405000
@RF00638 AH    LETPTR,@CH00052                                     0643 01406000
*             END;                  /*                       @Z30OE72*/ 01407000
         LA    @12,1                                               0644 01408000
         AL    @12,I                                               0644 01409000
         ST    @12,I                                               0644 01410000
         CH    @12,@CH00058                                        0644 01411000
         BNH   @DL00637                                            0644 01412000
@DC00637 DS    0H                                                  0645 01413000
*           END;                    /*                       @Z30OE72*/ 01414000
*         IF GOODDS=SETON THEN      /* ANY ERRORS IN DS STMT?#Y30OE72*/ 01415000
@RF00634 TM    GOODDS,B'01000000'                                  0646 01416000
         BNO   @RF00646                                            0646 01417000
*INTDO9:                            /*                       #Y30OE72*/ 01418000
*           DO;                     /*                       @Y30OE72   01419000
*                                      CALC BOE,EOE AND EOD  @Y30OE72   01420000
*                                      RELATIVE TO TRK 0,    @Y30OE72   01421000
*                                      REC 0                 @Y30OE72*/ 01422000
INTDO9   DS    0H                                                  0648 01423000
*             WORK1=WORK1&&WORK1;   /* INITIALIZE WORKFIELDS @Y30OE72*/ 01424000
         XC    WORK1(4),WORK1                                      0648 01425000
*             WORK2=WORK2&&WORK2;   /*                       @Y30OE72*/ 01426000
         XC    WORK2(4),WORK2                                      0649 01427000
*             WORK3=WORK3&&WORK3;   /*                       @Y30OE72*/ 01428000
         XC    WORK3(4),WORK3                                      0650 01429000
*             BOEABS=BOEABS&&BOEABS;/*                       @Y30OE72*/ 01430000
         LH    @12,BOEABS                                          0651 01431000
         LR    @11,@12                                             0651 01432000
         XR    @11,@12                                             0651 01433000
         STH   @11,BOEABS                                          0651 01434000
*             EOEABS=EOEABS&&EOEABS;/*                       @Y30OE72*/ 01435000
         LH    @12,EOEABS                                          0652 01436000
         LR    @11,@12                                             0652 01437000
         XR    @11,@12                                             0652 01438000
         STH   @11,EOEABS                                          0652 01439000
*             EODABS=EODABS&&EODABS;/*                       @Y30OE72*/ 01440000
         LH    @12,EODABS                                          0653 01441000
         LR    @11,@12                                             0653 01442000
         XR    @11,@12                                             0653 01443000
         STH   @11,EODABS                                          0653 01444000
*             PACK(WORK1,REPBOETT(N));/* CONVERT BOE TRACK   @Y30OE72*/ 01445000
         SLR   @12,@12                                             0654 01446000
         IC    @12,N                                               0654 01447000
         MH    @12,@CH02356                                        0654 01448000
         LA    @11,REPBOETT-47(@12)                                0654 01449000
         PACK  WORK1(4),0(2,@11)                                   0654 01450000
*             CVB(WORKB,WORK1);     /* AND TRANSFER IT TO    @Y30OE72*/ 01451000
         XC    @TS00001(8),@TS00001                                0655 01452000
         MVC   @TS00001+4(4),WORK1                                 0655 01453000
         CVB   @11,@TS00001                                        0655 01454000
         ST    @11,WORKB                                           0655 01455000
*             DSBOETRK=WORK2(4);    /* DS TABLE              @Y30OE72*/ 01456000
         MVC   DSBOETRK(1),WORK2+3                                 0656 01457000
*             WORK1=WORK1&&WORK1;   /* INITIALIZE WORKFIELD  @Y30OE72*/ 01458000
         XC    WORK1(4),WORK1                                      0657 01459000
*             PACK(WORK1,REPBOESS(N));/* CONVERT BOE SECTOR  @Y30OE72*/ 01460000
         LA    @11,REPBOESS-47(@12)                                0658 01461000
         PACK  WORK1(4),0(2,@11)                                   0658 01462000
*             CVB(WORKC,WORK1);     /* AND TRANSFER IT TO    @Y30OE72*/ 01463000
         XC    @TS00001(8),@TS00001                                0659 01464000
         MVC   @TS00001+4(4),WORK1                                 0659 01465000
         CVB   @12,@TS00001                                        0659 01466000
         ST    @12,WORKC                                           0659 01467000
*             DSBOESEC=WORK3(4);    /* DS TABLE              @Y30OE72*/ 01468000
         MVC   DSBOESEC(1),WORK3+3                                 0660 01469000
*             IF DSBOETRK>73|       /*                       @Y30OE72*/ 01470000
*                 DSBOETRK<TRACK1 THEN/*                     @Y30OE72*/ 01471000
         CLI   DSBOETRK,73                                         0661 01472000
         BH    @RT00661                                            0661 01473000
         CLI   DSBOETRK,1                                          0661 01474000
         BNL   @RF00661                                            0661 01475000
@RT00661 DS    0H                                                  0662 01476000
*               SW506I=ERRON;       /* TERMINATE RUN         @Y30OE72*/ 01477000
         OI    SW506I,B'00010000'                                  0662 01478000
*             ELSE                  /*                       @Y30OE72*/ 01479000
*INTDO10:                           /*                       @Y30OE72*/ 01480000
*               DO;                 /*                       @Y30OE72*/ 01481000
         B     @RC00661                                            0663 01482000
@RF00661 DS    0H                                                  0663 01483000
INTDO10  DS    0H                                                  0664 01484000
*                 WORK1=WORK1&&WORK1;/* INITIALIZE WORKFIELD @Y30OE72*/ 01485000
         XC    WORK1(4),WORK1                                      0664 01486000
*                 WORKA=(WORKB*TWSIX+WORKC);/* CALCULATION OF ABS  0665 01487000
*                                                            @Y30OE72*/ 01488000
         L     @12,WORKB                                           0665 01489000
         MH    @12,TWSIX                                           0665 01490000
         AL    @12,WORKC                                           0665 01491000
         ST    @12,WORKA                                           0665 01492000
*                 BOEABS=WORKA;     /* RECORD NBR OF BOE     @Y30OE72*/ 01493000
         STH   @12,BOEABS                                          0666 01494000
*                 WORK1=WORK1&&WORK1;/* INITIALIZE WORKFIELDS      0667 01495000
*                                                            @Y30OE72*/ 01496000
         XC    WORK1(4),WORK1                                      0667 01497000
*                 WORK2=WORK2&&WORK2;/*                      @Y30OE72*/ 01498000
         XC    WORK2(4),WORK2                                      0668 01499000
*                 WORK3=WORK3&&WORK3;/*                      @Y30OE72*/ 01500000
         XC    WORK3(4),WORK3                                      0669 01501000
*                 PACK(WORK1,REPEOETT(N));/* CONVERT EOE TRACK     0670 01502000
*                                                            @Y30OE72*/ 01503000
         SLR   @12,@12                                             0670 01504000
         IC    @12,N                                               0670 01505000
         MH    @12,@CH02356                                        0670 01506000
         LA    @11,REPEOETT-47(@12)                                0670 01507000
         PACK  WORK1(4),0(2,@11)                                   0670 01508000
*                 CVB(WORKB,WORK1); /* AND TRANSFER IT TO    @Y30OE72*/ 01509000
         XC    @TS00001(8),@TS00001                                0671 01510000
         MVC   @TS00001+4(4),WORK1                                 0671 01511000
         CVB   @11,@TS00001                                        0671 01512000
         ST    @11,WORKB                                           0671 01513000
*                 DSEOETRK=WORK2(4);/* DS TABLE              @Y30OE72*/ 01514000
         MVC   DSEOETRK(1),WORK2+3                                 0672 01515000
*                 WORK1=WORK1&&WORK1;/* INITIALIZE WORKFIELD @Y30OE72*/ 01516000
         XC    WORK1(4),WORK1                                      0673 01517000
*                 PACK(WORK1,REPEOESS(N));/* CONVERT EOE SECTOR    0674 01518000
*                                                            @Y30OE72*/ 01519000
         LA    @11,REPEOESS-47(@12)                                0674 01520000
         PACK  WORK1(4),0(2,@11)                                   0674 01521000
*                 CVB(WORKC,WORK1); /* AND TRANSFER IT TO    @Y30OE72*/ 01522000
         XC    @TS00001(8),@TS00001                                0675 01523000
         MVC   @TS00001+4(4),WORK1                                 0675 01524000
         CVB   @12,@TS00001                                        0675 01525000
         ST    @12,WORKC                                           0675 01526000
*                 DSEOESEC=WORK3(4);/* DS TABLE              @Y30OE72*/ 01527000
         MVC   DSEOESEC(1),WORK3+3                                 0676 01528000
*                 IF DSEOETRK>73|   /*                       @Y30OE72*/ 01529000
*                     DSEOETRK<TRACK1 THEN/*                 @Y30OE72*/ 01530000
         CLI   DSEOETRK,73                                         0677 01531000
         BH    @RT00677                                            0677 01532000
         CLI   DSEOETRK,1                                          0677 01533000
         BNL   @RF00677                                            0677 01534000
@RT00677 DS    0H                                                  0678 01535000
*                   SW506I=ERRON;   /* TERMINATE RUN         @Y30OE72*/ 01536000
         OI    SW506I,B'00010000'                                  0678 01537000
*                 ELSE              /*                       @Y30OE72*/ 01538000
*INTDO11:                           /*                       @Y30OE72*/ 01539000
*                   DO;             /*                       @Y30OE72*/ 01540000
         B     @RC00677                                            0679 01541000
@RF00677 DS    0H                                                  0679 01542000
INTDO11  DS    0H                                                  0680 01543000
*                     WORK1=WORK1&&WORK1;/* INITIALIZE WORKFIELD   0680 01544000
*                                                            @Y30OE72*/ 01545000
         XC    WORK1(4),WORK1                                      0680 01546000
*                     WORKA=(WORKB*TWSIX+WORKC);/* CALCULATION OF ABS   01547000
*                                                            @Y30OE72*/ 01548000
         L     @12,WORKB                                           0681 01549000
         MH    @12,TWSIX                                           0681 01550000
         AL    @12,WORKC                                           0681 01551000
         ST    @12,WORKA                                           0681 01552000
*                     EOEABS=WORKA; /* RECORD NBR OF EOE     @Y30OE72*/ 01553000
         STH   @12,EOEABS                                          0682 01554000
*                     WORK1=WORK1&&WORK1;/* INITIALIZE WORKFIELDS  0683 01555000
*                                                            @Y30OE72*/ 01556000
         XC    WORK1(4),WORK1                                      0683 01557000
*                     WORK2=WORK2&&WORK2;/*                  @Y30OE72*/ 01558000
         XC    WORK2(4),WORK2                                      0684 01559000
*                     WORK3=WORK3&&WORK3;/*                  @Y30OE72*/ 01560000
         XC    WORK3(4),WORK3                                      0685 01561000
*                     PACK(WORK1,REPEODTT(N));/* CONVERT EOD TRACK 0686 01562000
*                                                            @Y30OE72*/ 01563000
         SLR   @12,@12                                             0686 01564000
         IC    @12,N                                               0686 01565000
         MH    @12,@CH02356                                        0686 01566000
         LA    @11,REPEODTT-47(@12)                                0686 01567000
         PACK  WORK1(4),0(2,@11)                                   0686 01568000
*                     CVB(WORKB,WORK1);/* AND TRANSFER IT TO @Y30OE72*/ 01569000
         XC    @TS00001(8),@TS00001                                0687 01570000
         MVC   @TS00001+4(4),WORK1                                 0687 01571000
         CVB   @11,@TS00001                                        0687 01572000
         ST    @11,WORKB                                           0687 01573000
*                     DSEODTRK=WORK2(4);/* DS TABLE          @Y30OE72*/ 01574000
         MVC   DSEODTRK(1),WORK2+3                                 0688 01575000
*                     WORK1=WORK1&&WORK1;/* INITIALIZE WORKFIELD   0689 01576000
*                                                            @Y30OE72*/ 01577000
         XC    WORK1(4),WORK1                                      0689 01578000
*                     PACK(WORK1,REPEODSS(N));/* CONVERT EOD SECTOR     01579000
*                                                            @Y30OE72*/ 01580000
         LA    @11,REPEODSS-47(@12)                                0690 01581000
         PACK  WORK1(4),0(2,@11)                                   0690 01582000
*                     CVB(WORKC,WORK1);/* AND TRANSFER IT TO @Y30OE72*/ 01583000
         XC    @TS00001(8),@TS00001                                0691 01584000
         MVC   @TS00001+4(4),WORK1                                 0691 01585000
         CVB   @12,@TS00001                                        0691 01586000
         ST    @12,WORKC                                           0691 01587000
*                     DSEODSEC=WORK3(4);/* DS TABLE          @Y30OE72*/ 01588000
         MVC   DSEODSEC(1),WORK3+3                                 0692 01589000
*                     IF DSEODTRK>74|/*                      @Y30OE72*/ 01590000
*                         DSEODTRK<TRACK1 THEN/*             @Y30OE72*/ 01591000
         CLI   DSEODTRK,74                                         0693 01592000
         BH    @RT00693                                            0693 01593000
         CLI   DSEODTRK,1                                          0693 01594000
         BNL   @RF00693                                            0693 01595000
@RT00693 DS    0H                                                  0694 01596000
*                       SW506I=ERRON;/* TERMINATE RUN        @Y30OE72*/ 01597000
         OI    SW506I,B'00010000'                                  0694 01598000
*                     ELSE          /*                       @Y30OE72*/ 01599000
*INTDO12:                           /*                       @Y30OE72*/ 01600000
*                       DO;         /*                       @Y30OE72*/ 01601000
         B     @RC00693                                            0695 01602000
@RF00693 DS    0H                                                  0695 01603000
INTDO12  DS    0H                                                  0696 01604000
*                         IF DSEODTRK>73&DSEODSEC>HEX01 THEN/*     0696 01605000
*                                                            @Y30OE72*/ 01606000
         CLI   DSEODTRK,73                                         0696 01607000
         BNH   @RF00696                                            0696 01608000
         CLC   DSEODSEC(1),HEX01                                   0696 01609000
         BNH   @RF00696                                            0696 01610000
*                           SW506I=ERRON;/*                  @Y30OE72*/ 01611000
         OI    SW506I,B'00010000'                                  0697 01612000
*                         ELSE      /*                       @Y30OE72*/ 01613000
*                           IF DSBOESEC<SECTOR1|/* VERIFY    @Y30OE72*/ 01614000
*                               DSBOESEC>SECTOR26|/* SECTOR  @Y30OE72*/ 01615000
*                               DSEOESEC<SECTOR1|/* NUMBERS  @Y30OE72*/ 01616000
*                               DSEOESEC>SECTOR26|/* GT 0    @Y30OE72*/ 01617000
*                               DSEODSEC<SECTOR1|/* AND < 27 @Y30OE72*/ 01618000
*                               REPBOE0(N)^=FOXZERO|/* H MUST = 0  0698 01619000
*                                                            @Y30OE72*/ 01620000
*                               REPEOE0(N)^=FOXZERO|/* H MUST = 0  0698 01621000
*                                                            @Y30OE72*/ 01622000
*                               REPEOD0(N)^=FOXZERO|/* H MUST = 0  0698 01623000
*                                                            @Y30OE72*/ 01624000
*                               DSEODSEC>SECTOR26 THEN/*     @Y30OE72*/ 01625000
         B     @RC00696                                            0698 01626000
@RF00696 CLC   DSBOESEC(1),SECTOR1                                 0698 01627000
         BL    @RT00698                                            0698 01628000
         CLI   DSBOESEC,26                                         0698 01629000
         BH    @RT00698                                            0698 01630000
         CLC   DSEOESEC(1),SECTOR1                                 0698 01631000
         BL    @RT00698                                            0698 01632000
         CLI   DSEOESEC,26                                         0698 01633000
         BH    @RT00698                                            0698 01634000
         CLC   DSEODSEC(1),SECTOR1                                 0698 01635000
         BL    @RT00698                                            0698 01636000
         SLR   @12,@12                                             0698 01637000
         IC    @12,N                                               0698 01638000
         MH    @12,@CH02356                                        0698 01639000
         LA    @11,REPBOE0-47(@12)                                 0698 01640000
         CLI   0(@11),X'F0'                                        0698 01641000
         BNE   @RT00698                                            0698 01642000
         LA    @11,REPEOE0-47(@12)                                 0698 01643000
         CLI   0(@11),X'F0'                                        0698 01644000
         BNE   @RT00698                                            0698 01645000
         LA    @11,REPEOD0-47(@12)                                 0698 01646000
         CLI   0(@11),X'F0'                                        0698 01647000
         BNE   @RT00698                                            0698 01648000
         CLI   DSEODSEC,26                                         0698 01649000
         BNH   @RF00698                                            0698 01650000
@RT00698 DS    0H                                                  0699 01651000
*                             SW506I=ERRON;/* NO. FAIL       @Y30OE72*/ 01652000
         OI    SW506I,B'00010000'                                  0699 01653000
*                           ELSE    /* SECTOR #S OK          @Y30OE72*/ 01654000
*                             DO;   /*                       @Y30OE72*/ 01655000
         B     @RC00698                                            0700 01656000
@RF00698 DS    0H                                                  0701 01657000
*                               WORK1=WORK1&&WORK1;/* INITIALIZE   0701 01658000
*                                      WORKFIELD             @Y30OE72*/ 01659000
         XC    WORK1(4),WORK1                                      0701 01660000
*                               WORKA=(WORKB*TWSIX+WORKC);/*       0702 01661000
*                                      CALCULATION OF ABS    @Y30OE72*/ 01662000
         L     @12,WORKB                                           0702 01663000
         MH    @12,TWSIX                                           0702 01664000
         AL    @12,WORKC                                           0702 01665000
         ST    @12,WORKA                                           0702 01666000
*                               EODABS=WORKA;/* RECORD NBR OF EOD  0703 01667000
*                                                            @Y30OE72*/ 01668000
         STH   @12,EODABS                                          0703 01669000
*                               IF EOEABS<BOEABS THEN/* EOE < BOE? 0704 01670000
*                                                            @Y30OE72*/ 01671000
         LH    @12,EOEABS                                          0704 01672000
         CH    @12,BOEABS                                          0704 01673000
         BNL   @RF00704                                            0704 01674000
*                                 SW506I=ERRON;/* YES. FAIL  @Y30OE72*/ 01675000
         OI    SW506I,B'00010000'                                  0705 01676000
*                             END;  /*                       @Y30OE72*/ 01677000
@RF00704 DS    0H                                                  0707 01678000
*                       END INTDO12;/*                       @Y30OE72*/ 01679000
@RC00698 DS    0H                                                  0707 01680000
@RC00696 DS    0H                                                  0708 01681000
*                   END INTDO11;    /*                       @Y30OE72*/ 01682000
@RC00693 DS    0H                                                  0709 01683000
*               END INTDO10;        /*                       @Y30OE72*/ 01684000
@RC00677 DS    0H                                                  0710 01685000
*             IF SW506I^=ERRON THEN /* EXTENTS OK?           @Y30OE72*/ 01686000
@RC00661 TM    SW506I,B'00010000'                                  0710 01687000
         BO    @RF00710                                            0710 01688000
*               DO;                 /*                       @Y30OE72*/ 01689000
*                 IF EODABS<BOEABS THEN/* EOD < BOE?         @Y30OE72*/ 01690000
         LH    @12,EODABS                                          0712 01691000
         CH    @12,BOEABS                                          0712 01692000
         BNL   @RF00712                                            0712 01693000
*                   SW506I=ERRON;   /* YES. FAIL             @Y30OE72*/ 01694000
         OI    SW506I,B'00010000'                                  0713 01695000
*                 ELSE              /*                       @Y30OE72*/ 01696000
*                   IF EODABS>(EOEABS+1) THEN/* EOD TOO BIG? @Y30OE72*/ 01697000
         B     @RC00712                                            0714 01698000
@RF00712 LA    @12,1                                               0714 01699000
         AH    @12,EOEABS                                          0714 01700000
         CH    @12,EODABS                                          0714 01701000
         BNL   @RF00714                                            0714 01702000
*                     SW506I=ERRON; /* YES. FAIL             @Y30OE72*/ 01703000
         OI    SW506I,B'00010000'                                  0715 01704000
*               END;                /*                       @Y30OE72*/ 01705000
@RF00714 DS    0H                                                  0716 01706000
@RC00712 DS    0H                                                  0717 01707000
*           END INTDO9;             /*                       @Y30OE72*/ 01708000
@RF00710 DS    0H                                                  0718 01709000
*       END INTDO2;                 /*                       @Y30OE72*/ 01710000
@RF00646 DS    0H                                                  0719 01711000
*     GOODDS=SETOFF;                /* RESET WORK SWITCH     @Y30OE72*/ 01712000
@RF00528 NI    GOODDS,B'10111111'                                  0719 01713000
*     IF DELENT=SETOFF THEN         /* DELETED ENTRY?        @Y30OE72*/ 01714000
         TM    DELENT,B'00100000'                                  0720 01715000
         BNZ   @RF00720                                            0720 01716000
*       IF SWDS=ZERO THEN           /* ANY ERRORS?           @Y30OE72*/ 01717000
         CLI   SWDS,0                                              0721 01718000
         BNE   @RF00721                                            0721 01719000
*INTDO13:                           /*                       @Y30OE72*/ 01720000
*         DO;                       /* NO.                   @Y30OE72*/ 01721000
INTDO13  DS    0H                                                  0723 01722000
*           LETPTR=ADDR(REPDSID(N));/* POINT TO 1ST DSID CHR @Y30OE72*/ 01723000
         SLR   LETPTR,LETPTR                                       0723 01724000
         IC    LETPTR,N                                            0723 01725000
         MH    LETPTR,@CH02356                                     0723 01726000
         LA    LETPTR,REPDSID-47(LETPTR)                           0723 01727000
*INTDO14:                           /*                       @Y30OE72*/ 01728000
*           DO I=1 TO DSIDLEN       /* CHK DSID FOR          @Y30OE72*/ 01729000
*                 WHILE SW506I=SETOFF;/* SIMPLE              @Y30OE72*/ 01730000
INTDO14  LA    @12,1                                               0724 01731000
         B     @DE00724                                            0724 01732000
@DL00724 TM    SW506I,B'00010000'                                  0724 01733000
         BNZ   @DC00724                                            0724 01734000
*             IF^((LETTER>=CHARA&   /* DATA                  @Y30OE72*/ 01735000
*                 LETTER<=CHARI)|   /* SET                   @Y30OE72*/ 01736000
*                 (LETTER>=CHARJ&   /* NAME                  @Y30OE72*/ 01737000
*                 LETTER<=CHARR)|   /*                       @Y30OE72*/ 01738000
*                 (LETTER>=CHARS&   /*                       @Y30OE72*/ 01739000
*                 LETTER<=CHARZ)|   /*                       @Y30OE72*/ 01740000
*                 (LETTER>=CHAR0&   /*                       @Y30OE72*/ 01741000
*                 LETTER<=CHAR9)|   /*                       @Y30OE72*/ 01742000
*                 LETTER=HYPHEN|    /*                       @Y30OE72*/ 01743000
*                 LETTER=LEFTBRAC|  /*                       @Y30OE72*/ 01744000
*                 LETTER=CHAR#|     /*                       @Y30OE72*/ 01745000
*                 LETTER=CHAR@|     /*                       @Y30OE72*/ 01746000
*                 LETTER=CHAR$)     /*                       @Y30OE72*/ 01747000
*               THEN                /* INVALID CHARS         @Y30OE72*/ 01748000
         CLI   LETTER(LETPTR),C'A'                                 0725 01749000
         BL    @GL00034                                            0725 01750000
         CLI   LETTER(LETPTR),C'I'                                 0725 01751000
         BNH   @RF00725                                            0725 01752000
@GL00034 CLI   LETTER(LETPTR),C'J'                                 0725 01753000
         BL    @GL00033                                            0725 01754000
         CLI   LETTER(LETPTR),C'R'                                 0725 01755000
         BNH   @RF00725                                            0725 01756000
@GL00033 CLI   LETTER(LETPTR),C'S'                                 0725 01757000
         BL    @GL00032                                            0725 01758000
         CLI   LETTER(LETPTR),C'Z'                                 0725 01759000
         BNH   @RF00725                                            0725 01760000
@GL00032 CLI   LETTER(LETPTR),C'0'                                 0725 01761000
         BL    @GL00031                                            0725 01762000
         CLI   LETTER(LETPTR),C'9'                                 0725 01763000
         BNH   @RF00725                                            0725 01764000
@GL00031 CLI   LETTER(LETPTR),C'-'                                 0725 01765000
         BE    @RF00725                                            0725 01766000
         CLI   LETTER(LETPTR),X'8B'                                0725 01767000
         BE    @RF00725                                            0725 01768000
         CLI   LETTER(LETPTR),C'#'                                 0725 01769000
         BE    @RF00725                                            0725 01770000
         CLI   LETTER(LETPTR),C'@'                                 0725 01771000
         BE    @RF00725                                            0725 01772000
         CLI   LETTER(LETPTR),C'$'                                 0725 01773000
         BE    @RF00725                                            0725 01774000
*               SW506I=ERRON;       /* TERMINATE RUN         @Y30OE72*/ 01775000
         OI    SW506I,B'00010000'                                  0726 01776000
*             ELSE                  /*                       @Y30OE72*/ 01777000
*               IF I=1 THEN         /* FIRST CHAR?           @Y30OE72*/ 01778000
         B     @RC00725                                            0727 01779000
@RF00725 CLC   I(4),@CF00052                                       0727 01780000
         BNE   @RF00727                                            0727 01781000
*                 IF LETTER>=CHAR0& /* YES. IS IT            @Y30OE72*/ 01782000
*                     LETTER<=CHAR9 /* NUMERIC?              @Y30OE72*/ 01783000
*                   THEN            /* YES. ERROR            @Y30OE72*/ 01784000
         CLI   LETTER(LETPTR),C'0'                                 0728 01785000
         BL    @RF00728                                            0728 01786000
         CLI   LETTER(LETPTR),C'9'                                 0728 01787000
         BH    @RF00728                                            0728 01788000
*                   SW506I=ERRON;   /* TERMINATE RUN         @Y30OE72*/ 01789000
         OI    SW506I,B'00010000'                                  0729 01790000
*             LETPTR=LETPTR+1;      /* POINT TO NEXT CHAR    @Y30OE72*/ 01791000
@RF00728 DS    0H                                                  0730 01792000
@RF00727 DS    0H                                                  0730 01793000
@RC00725 AL    LETPTR,@CF00052                                     0730 01794000
*           END INTDO14;            /* END DSID CHECKING     @Y30OE72*/ 01795000
         LA    @12,1                                               0731 01796000
         AL    @12,I                                               0731 01797000
@DE00724 ST    @12,I                                               0731 01798000
         SLR   @11,@11                                             0731 01799000
         IC    @11,DSIDLEN                                         0731 01800000
         CR    @12,@11                                             0731 01801000
         BNH   @DL00724                                            0731 01802000
@DC00724 DS    0H                                                  0732 01803000
*           BLANKCHR=SETON;         /* SET BLANK CHAR IND    @Y30OE72*/ 01804000
*           NONZERO=SETOFF;         /* INIT SWITCH           @Y30OE72*/ 01805000
*           BADBLKLN=SETOFF;        /* INIT SWITCH           @Y30OE72*/ 01806000
         OI    BLANKCHR,B'00000100'                                0734 01807000
         NI    NONZERO,B'11111100'                                 0734 01808000
*           DO I=1 TO 5 WHILE BLANKCHR=SETON;/*              @Y30OE72*/ 01809000
         LA    @12,1                                               0735 01810000
         ST    @12,I                                               0735 01811000
@DL00735 TM    BLANKCHR,B'00000100'                                0735 01812000
         BNO   @DC00735                                            0735 01813000
*             IF REPBLKLN(N,I)^=BLANK(1)/* NO MORE LEADG     @Y30OE72*/ 01814000
*               THEN                /* BLANKS ?              @Y30OE72*/ 01815000
         SLR   @11,@11                                             0736 01816000
         IC    @11,N                                               0736 01817000
         MH    @11,@CH02356                                        0736 01818000
         ALR   @11,@12                                             0736 01819000
         LA    @15,REPBLKLN-48(@11)                                0736 01820000
         CLC   0(1,@15),BLANK                                      0736 01821000
         BE    @RF00736                                            0736 01822000
*               DO J=I TO 5;        /*                       @Y30OE72*/ 01823000
         B     @DE00737                                            0737 01824000
@DL00737 DS    0H                                                  0738 01825000
*                 BLANKCHR=SETOFF;  /* SET BLNK CHAR IND     @Y30OE72*/ 01826000
         NI    BLANKCHR,B'11111011'                                0738 01827000
*                 IF REPBLKLN(N,J)<CHAR0|/* INVALID BLK      @Y30OE72*/ 01828000
*                     REPBLKLN(N,J)>CHAR9/* LENGTH ?         @Y30OE72*/ 01829000
*                   THEN            /*                       @Y30OE72*/ 01830000
         SLR   @11,@11                                             0739 01831000
         IC    @11,N                                               0739 01832000
         MH    @11,@CH02356                                        0739 01833000
         ALR   @11,@12                                             0739 01834000
         LA    @12,REPBLKLN-48(@11)                                0739 01835000
         CLI   0(@12),C'0'                                         0739 01836000
         BL    @RT00739                                            0739 01837000
         LA    @12,REPBLKLN-48(@11)                                0739 01838000
         CLI   0(@12),C'9'                                         0739 01839000
         BNH   @RF00739                                            0739 01840000
@RT00739 DS    0H                                                  0740 01841000
*                   BADBLKLN=SETON; /* SET INVAL LEN IND     @Y30OE72*/ 01842000
         OI    BADBLKLN,B'00000010'                                0740 01843000
*                 ELSE              /* NUMERIC               @Y30OE72*/ 01844000
*                   IF REPBLKLN(N,J)^=CHAR0 THEN/* NON-ZERO ?      0741 01845000
*                                                            @Y30OE72*/ 01846000
         B     @RC00739                                            0741 01847000
@RF00739 SLR   @12,@12                                             0741 01848000
         IC    @12,N                                               0741 01849000
         MH    @12,@CH02356                                        0741 01850000
         AL    @12,J                                               0741 01851000
         LA    @11,REPBLKLN-48(@12)                                0741 01852000
         CLI   0(@11),C'0'                                         0741 01853000
         BE    @RF00741                                            0741 01854000
*                     NONZERO=SETON;/* YES. SET IND          @Y30OE72*/ 01855000
         OI    NONZERO,B'00000001'                                 0742 01856000
*               END;                /*                       @Y30OE72*/ 01857000
@RF00741 DS    0H                                                  0743 01858000
@RC00739 LA    @12,1                                               0743 01859000
         AL    @12,J                                               0743 01860000
@DE00737 ST    @12,J                                               0743 01861000
         CH    @12,@CH00038                                        0743 01862000
         BNH   @DL00737                                            0743 01863000
*           END;                    /*                       @Y30OE72*/ 01864000
@RF00736 LA    @12,1                                               0744 01865000
         AL    @12,I                                               0744 01866000
         ST    @12,I                                               0744 01867000
         CH    @12,@CH00038                                        0744 01868000
         BNH   @DL00735                                            0744 01869000
@DC00735 DS    0H                                                  0745 01870000
*           IF^(REPBLKLN(N)>=BLNKONE&/* BLOCK LENGTH > 0 AND @Y30OE72*/ 01871000
*               NONZERO=SETON&      /*                       @Y30OE72*/ 01872000
*               BADBLKLN=SETOFF&    /*                       @Y30OE72*/ 01873000
*               REPBLKLN(N)<=MAXRECL)/* <= 128?              @Y30OE72*/ 01874000
*             THEN                  /* NO.                   @Y30OE72*/ 01875000
         SLR   @12,@12                                             0745 01876000
         IC    @12,N                                               0745 01877000
         MH    @12,@CH02356                                        0745 01878000
         LA    @11,REPBLKLN-47(@12)                                0745 01879000
         CLC   0(5,@11),BLNKONE                                    0745 01880000
         BL    @RT00745                                            0745 01881000
         TM    BADBLKLN,B'00000010'                                0745 01882000
         BNZ   @RT00745                                            0745 01883000
         TM    NONZERO,B'00000001'                                 0745 01884000
         BNO   @RT00745                                            0745 01885000
         LA    @11,REPBLKLN-47(@12)                                0745 01886000
         CLC   0(5,@11),MAXRECL                                    0745 01887000
         BNH   @RF00745                                            0745 01888000
@RT00745 DS    0H                                                  0746 01889000
*             SW506I=ERRON;         /* TERMINATE RUN         @Y30OE72*/ 01890000
         OI    SW506I,B'00010000'                                  0746 01891000
*           IF^(REPBYPAS(N)=CHARB|  /* BYPASS IND = B        @Y30OE72*/ 01892000
*               REPBYPAS(N)=BLANK(1))/* OR BLANK?            @Y30OE72*/ 01893000
*             THEN                  /* NO.                   @Y30OE72*/ 01894000
@RF00745 SLR   @12,@12                                             0747 01895000
         IC    @12,N                                               0747 01896000
         MH    @12,@CH02356                                        0747 01897000
         LA    @11,REPBYPAS-47(@12)                                0747 01898000
         CLI   0(@11),C'B'                                         0747 01899000
         BE    @RF00747                                            0747 01900000
         LA    @11,REPBYPAS-47(@12)                                0747 01901000
         CLC   0(1,@11),BLANK                                      0747 01902000
         BE    @RF00747                                            0747 01903000
*             SW506I=ERRON;         /* TERMINATE RUN         @Y30OE72*/ 01904000
         OI    SW506I,B'00010000'                                  0748 01905000
*           IF^(REPWP(N)=CHARP|     /* WRITE PROTECT IND = P @Y30OE72*/ 01906000
*               REPWP(N)=BLANK(1))  /* OR BLANK?             @Y30OE72*/ 01907000
*             THEN                  /* NO.                   @Y30OE72*/ 01908000
@RF00747 SLR   @12,@12                                             0749 01909000
         IC    @12,N                                               0749 01910000
         MH    @12,@CH02356                                        0749 01911000
         LA    @11,REPWP-47(@12)                                   0749 01912000
         CLI   0(@11),C'P'                                         0749 01913000
         BE    @RF00749                                            0749 01914000
         LA    @11,REPWP-47(@12)                                   0749 01915000
         CLC   0(1,@11),BLANK                                      0749 01916000
         BE    @RF00749                                            0749 01917000
*             SW506I=ERRON;         /* TERMINATE RUN         @Y30OE72*/ 01918000
         OI    SW506I,B'00010000'                                  0750 01919000
*           IF^(REPVER(N)=CHARV|    /* VERIFY IND = V        @Y30OE72*/ 01920000
*               REPVER(N)=CHARC|    /* OR C                  @Y30OE72*/ 01921000
*               REPVER(N)=BLANK(1)) /* OR BLANK?             @Y30OE72*/ 01922000
*             THEN                  /* NO.                   @Y30OE72*/ 01923000
@RF00749 SLR   @12,@12                                             0751 01924000
         IC    @12,N                                               0751 01925000
         MH    @12,@CH02356                                        0751 01926000
         LA    @11,REPVER-47(@12)                                  0751 01927000
         CLI   0(@11),C'V'                                         0751 01928000
         BE    @RF00751                                            0751 01929000
         LA    @11,REPVER-47(@12)                                  0751 01930000
         CLI   0(@11),C'C'                                         0751 01931000
         BE    @RF00751                                            0751 01932000
         LA    @11,REPVER-47(@12)                                  0751 01933000
         CLC   0(1,@11),BLANK                                      0751 01934000
         BE    @RF00751                                            0751 01935000
*             SW506I=ERRON;         /* TERMINATE RUN         @Y30OE72*/ 01936000
         OI    SW506I,B'00010000'                                  0752 01937000
*           IF^(REPCONT(N)=CHARC|   /* MULTIVOL IND = C      @Y30OE72*/ 01938000
*               REPCONT(N)=CHARL|   /* OR L                  @Y30OE72*/ 01939000
*               REPCONT(N)=BLANK(1))/* OR BLANK?             @Y30OE72*/ 01940000
*             THEN                  /* NO.                   @Y30OE72*/ 01941000
@RF00751 SLR   @12,@12                                             0753 01942000
         IC    @12,N                                               0753 01943000
         MH    @12,@CH02356                                        0753 01944000
         LA    @11,REPCONT-47(@12)                                 0753 01945000
         CLI   0(@11),C'C'                                         0753 01946000
         BE    @RF00753                                            0753 01947000
         LA    @11,REPCONT-47(@12)                                 0753 01948000
         CLI   0(@11),C'L'                                         0753 01949000
         BE    @RF00753                                            0753 01950000
         LA    @11,REPCONT-47(@12)                                 0753 01951000
         CLC   0(1,@11),BLANK                                      0753 01952000
         BE    @RF00753                                            0753 01953000
*             SW506I=ERRON;         /* TERMINATE RUN         @Y30OE72*/ 01954000
         OI    SW506I,B'00010000'                                  0754 01955000
*           IF^(REPSEQ#(N)=BLANK(1:2)|/* SEQUENCE NUM =BLANK @Y30OE72*/ 01956000
*               (REPSEQ#(N)>ZEROS&  /* OR > 0                @Y30OE72*/ 01957000
*               REPSEQ#1(N)>=CHAR0& /*                       @Y30OE72*/ 01958000
*               REPSEQ#1(N)<=CHAR9& /*                       @Y30OE72*/ 01959000
*               REPSEQ#2(N)>=CHAR0& /*                       @Y30OE72*/ 01960000
*               REPSEQ#2(N)<=CHAR9& /*                       @Y30OE72*/ 01961000
*               REPSEQ#(N)<=CHAR99))/* AND <=99?             @Y30OE72*/ 01962000
*             THEN                  /* NO.                   @Y30OE72*/ 01963000
@RF00753 SLR   @12,@12                                             0755 01964000
         IC    @12,N                                               0755 01965000
         MH    @12,@CH02356                                        0755 01966000
         LA    @11,REPSEQ#-47(@12)                                 0755 01967000
         CLC   0(2,@11),BLANK                                      0755 01968000
         BE    @RF00755                                            0755 01969000
         LA    @11,REPSEQ#-47(@12)                                 0755 01970000
         CLC   0(2,@11),ZEROS                                      0755 01971000
         BNH   @RT00755                                            0755 01972000
         LA    @11,REPSEQ#1-47(@12)                                0755 01973000
         CLI   0(@11),C'0'                                         0755 01974000
         BL    @RT00755                                            0755 01975000
         LA    @11,REPSEQ#1-47(@12)                                0755 01976000
         CLI   0(@11),C'9'                                         0755 01977000
         BH    @RT00755                                            0755 01978000
         LA    @11,REPSEQ#2-47(@12)                                0755 01979000
         CLI   0(@11),C'0'                                         0755 01980000
         BL    @RT00755                                            0755 01981000
         LA    @11,REPSEQ#2-47(@12)                                0755 01982000
         CLI   0(@11),C'9'                                         0755 01983000
         BH    @RT00755                                            0755 01984000
         LA    @11,REPSEQ#-47(@12)                                 0755 01985000
         CLC   0(2,@11),CHAR99                                     0755 01986000
         BNH   @RF00755                                            0755 01987000
@RT00755 DS    0H                                                  0756 01988000
*             SW506I=ERRON;         /* TERMINATE RUN         @Y30OE72*/ 01989000
         OI    SW506I,B'00010000'                                  0756 01990000
*           DATEPTR=ADDR(REPCREAT(N));/* PT TO CREATION DATE @Y30OE72*/ 01991000
@RF00755 SLR   DATEPTR,DATEPTR                                     0757 01992000
         IC    DATEPTR,N                                           0757 01993000
         MH    DATEPTR,@CH02356                                    0757 01994000
         LA    DATEPTR,REPCREAT-47(DATEPTR)                        0757 01995000
*           DO I=1 TO 2;            /* VALIDITY CHK DATES    @Y30OE72*/ 01996000
         LA    @12,1                                               0758 01997000
         ST    @12,I                                               0758 01998000
@DL00758 DS    0H                                                  0759 01999000
*             IF^(DATEMAP=BLANK(1:6)|/* DATE ALL BLANKS      @Y30OE72*/ 02000000
*                 (DATEYY>ZEROS&    /* OR YEAR > 0           @Y30OE72*/ 02001000
*                 DATEYY<=CHAR99&   /* AND <=99              @Y30OE72*/ 02002000
*                 DATEMM>ZEROS&     /* AND MONTH > 0         @Y30OE72*/ 02003000
*                 DATEMM<=CHAR12&   /* AND <= 12             @Y30OE72*/ 02004000
*                 DATEDD>ZEROS&     /* AND DAY > 0           @Y30OE72*/ 02005000
*                 DATEDD<=CHAR31))  /* AND <= 31             @Y30OE72*/ 02006000
*               THEN                /* NO.                   @Y30OE72*/ 02007000
         CLC   DATEMAP(6,DATEPTR),BLANK                            0759 02008000
         BE    @RF00759                                            0759 02009000
         CLC   DATEYY(2,DATEPTR),ZEROS                             0759 02010000
         BNH   @RT00759                                            0759 02011000
         CLC   DATEYY(2,DATEPTR),CHAR99                            0759 02012000
         BH    @RT00759                                            0759 02013000
         CLC   DATEMM(2,DATEPTR),ZEROS                             0759 02014000
         BNH   @RT00759                                            0759 02015000
         CLC   DATEMM(2,DATEPTR),CHAR12                            0759 02016000
         BH    @RT00759                                            0759 02017000
         CLC   DATEDD(2,DATEPTR),ZEROS                             0759 02018000
         BNH   @RT00759                                            0759 02019000
         CLC   DATEDD(2,DATEPTR),CHAR31                            0759 02020000
         BNH   @RF00759                                            0759 02021000
@RT00759 DS    0H                                                  0760 02022000
*               SW506I=ERRON;       /* TERMINATE RUN         @Y30OE72*/ 02023000
         OI    SW506I,B'00010000'                                  0760 02024000
*             DATEPTR=DATEPTR+LENGTH(REPCREAT);/* EXP DATE   @Y30OE72*/ 02025000
@RF00759 AH    DATEPTR,@CH00032                                    0761 02026000
*           END;                    /*                       @Y30OE72*/ 02027000
         LA    @12,1                                               0762 02028000
         AL    @12,I                                               0762 02029000
         ST    @12,I                                               0762 02030000
         CH    @12,@CH00070                                        0762 02031000
         BNH   @DL00758                                            0762 02032000
*         END INTDO13;              /*                       @Y30OE72*/ 02033000
*     IF SW505I=SETON THEN          /* INVALID DS STMT FORM? @Y30OE72*/ 02034000
@RF00721 DS    0H                                                  0764 02035000
@RF00720 TM    SW505I,B'10000000'                                  0764 02036000
         BNO   @RF00764                                            0764 02037000
*       DO;                         /* YES.                  @Y30OE72*/ 02038000
*         REG1=ADDR(IEB505I);       /* ISSUE                 @Y30OE72*/ 02039000
         LA    REG1,IEB505I                                        0766 02040000
*         MSGLEN=LENGTH(IEB505I);   /* MESSAGE               @Y30OE72*/ 02041000
         MVI   MSGLEN,X'27'                                        0767 02042000
*         CALL MSGWRTR;             /* IEB505I               @Y30OE72*/ 02043000
         BAL   @14,MSGWRTR                                         0768 02044000
*         FAILSW=ON;                /* TERMINATE RUN         @Y30OE72*/ 02045000
         MVC   FAILSW(1),ON                                        0769 02046000
*       END;                        /*                       @Y30OE72*/ 02047000
*     ELSE                          /* GOOD DS STMT FORMAT   @Y30OE72*/ 02048000
*       IF SW506I=SETON THEN        /* INVALID VALUES?       @Y30OE72*/ 02049000
         B     @RC00764                                            0771 02050000
@RF00764 TM    SW506I,B'00010000'                                  0771 02051000
         BNO   @RF00771                                            0771 02052000
*         DO;                       /* YES.                  @Y30OE72*/ 02053000
*           I506DS#=CARDBUF(4:5);   /* DS # IN MSG           @Y30OE72*/ 02054000
         MVC   I506DS#(2),CARDBUF+3                                0773 02055000
*           REG1=ADDR(IEB506I);     /* ISSUE                 @Y30OE72*/ 02056000
         LA    REG1,IEB506I                                        0774 02057000
*           MSGLEN=LENGTH(IEB506I); /* MESSAGE               @Y30OE72*/ 02058000
         MVI   MSGLEN,X'22'                                        0775 02059000
*           CALL MSGWRTR;           /* IEB506I               @Y30OE72*/ 02060000
         BAL   @14,MSGWRTR                                         0776 02061000
*           FAILSW=ON;              /* TERMINATE RUN         @Y30OE72*/ 02062000
         MVC   FAILSW(1),ON                                        0777 02063000
*         END;                      /*                       @Y30OE72*/ 02064000
*       ELSE                        /*                       @Y30OE72*/ 02065000
*         IF SW515I=SETON THEN      /* CARD OUT OF SEQUENCE? @Y30OE72*/ 02066000
         B     @RC00771                                            0779 02067000
@RF00771 TM    SW515I,B'00001000'                                  0779 02068000
         BNO   @RF00779                                            0779 02069000
*           DO;                     /* YES.                  @Y30OE72*/ 02070000
*             REG1=ADDR(IEB515I);   /* ISSUE                 @Y30OE72*/ 02071000
         LA    REG1,IEB515I                                        0781 02072000
*             MSGLEN=LENGTH(IEB515I);/* MESSAGE              @Y30OE72*/ 02073000
         MVI   MSGLEN,X'29'                                        0782 02074000
*             CALL MSGWRTR;         /* IEB515I               @Y30OE72*/ 02075000
         BAL   @14,MSGWRTR                                         0783 02076000
*             FAILSW=ON;            /* TERMINATE RUN         @Y30OE72*/ 02077000
         MVC   FAILSW(1),ON                                        0784 02078000
*           END;                    /*                       @Y30OE72*/ 02079000
*     IF SW506I=SETOFF&             /* ANY ERRORS?           @Y30OE72*/ 02080000
*         SW505I=SETOFF&            /*                       @Y30OE72*/ 02081000
*         DELENT=SETOFF&            /* NOT A DELETE DS       @Y30OE72*/ 02082000
*         SW515I=SETOFF THEN        /*                       @Y30OE72*/ 02083000
@RF00779 DS    0H                                                  0786 02084000
@RC00771 DS    0H                                                  0786 02085000
@RC00764 TM    SW506I,B'10111000'                                  0786 02086000
         BNZ   @RF00786                                            0786 02087000
*       N=N+1;                      /* NO. UPDATE REPTAB NDX @Y30OE72*/ 02088000
         IC    @12,N                                               0787 02089000
         LA    @12,1(,@12)                                         0787 02090000
         STC   @12,N                                               0787 02091000
*     ELSE                          /* YES.                  @Y30OE72*/ 02092000
*       REPTAB(N)=BLANK(1:47);      /* CLEAR REPTAB ENTRY    @Y30OE72*/ 02093000
         B     @RC00786                                            0788 02094000
@RF00786 SLR   @12,@12                                             0788 02095000
         IC    @12,N                                               0788 02096000
         MH    @12,@CH02356                                        0788 02097000
         LA    @11,REPTAB-47(@12)                                  0788 02098000
         MVC   0(47,@11),BLANK                                     0788 02099000
*        GOTO CE0001@; /*BRANCH TO END OF CASE*/                   0789 02100000
         B     CE0001@                                             0789 02101000
*      END DS; /*END OF SUBCASE*/                  /*              0790 02102000
*    @Y30OE72*/                                                    0790 02103000
*                                                                  0791 02104000
*BAD:  DO; /*SUBCASE*/                /*                       @Y30OE72 02105000
*/                                                                 0791 02106000
BAD      DS    0H                                                  0792 02107000
*     REG1=ADDR(IEB509I);           /* ISSUE                 @Y30OE72*/ 02108000
         LA    REG1,IEB509I                                        0792 02109000
*     MSGLEN=LENGTH(IEB509I);       /* MESSAGE               @Y30OE72*/ 02110000
         MVI   MSGLEN,X'24'                                        0793 02111000
*     CALL MSGWRTR;                 /* IEB509I               @Y30OE72*/ 02112000
         BAL   @14,MSGWRTR                                         0794 02113000
*     FAILSW=ON;                    /* TERMINATE RUN         @Y30OE72*/ 02114000
         MVC   FAILSW(1),ON                                        0795 02115000
*        GOTO CE0001@; /*BRANCH TO END OF CASE*/                   0796 02116000
         B     CE0001@                                             0796 02117000
*      END BAD; /*END OF SUBCASE*/                 /*              0797 02118000
*    @Y30OE72*/                                                    0797 02119000
*                                                                  0797 02120000
*EODAD:DO; /*SUBCASE*/              /*                       @Y30OE72*/ 02121000
EODAD    DS    0H                                                  0799 02122000
*     WORKSW=OFF;                   /* GET OUT OF DOWHILE    @Y30OE72*/ 02123000
         MVC   WORKSW(1),OFF                                       0799 02124000
*        GOTO CE0001@; /*BRANCH TO END OF CASE*/                   0800 02125000
         B     CE0001@                                             0800 02126000
*      END EODAD; /*END OF SUBCASE*/               /*              0801 02127000
*    @Y30OE72*/                                                    0801 02128000
*                                                                  0801 02129000
*SYNAD:DO; /*SUBCASE*/              /*                       @Y30OE72*/ 02130000
SYNAD    DS    0H                                                  0803 02131000
*     I520DDNM=SYSINDD;             /* DDNAME INTO MSG       @Y30OE72*/ 02132000
         MVC   I520DDNM(8),@CC02089                                0803 02133000
*     REG1=ADDR(IEB520I);           /* ISSUE                 @Y30OE72*/ 02134000
         LA    REG1,IEB520I                                        0804 02135000
*     MSGLEN=LENGTH(IEB520I);       /* MESSAGE               @Y30OE72*/ 02136000
         MVI   MSGLEN,X'1A'                                        0805 02137000
*     CALL MSGWRTR;                 /* IEB520I               @Y30OE72*/ 02138000
         BAL   @14,MSGWRTR                                         0806 02139000
*     WORKSW=OFF;                   /* GET OUT OF DOWHILE    @Y30OE72*/ 02140000
         MVC   WORKSW(1),OFF                                       0807 02141000
*     FAILSW=ON;                    /* TERMINATE RUN         @Y30OE72*/ 02142000
         MVC   FAILSW(1),ON                                        0808 02143000
*        GOTO CE0001@; /*BRANCH TO END OF CASE*/                   0809 02144000
         B     CE0001@                                             0809 02145000
*      END SYNAD; /*END OF SUBCASE*/               /*              0810 02146000
*    @Y30OE72*/                                                    0810 02147000
*                                                                  0810 02148000
*CE0001@:                                                          0811 02149000
*      END CNTRLSTM; /*END OF CASE*/           /*                  0811 02150000
*@Y30OE72*/                                                        0811 02151000
CE0001@  DS    0H                                                  0812 02152000
*     NOT1ST=SETON;                 /* IND 1ST STMT HAS      @Y30OE72   02153000
*                                      BEEN PROCESSED        @Y30OE72*/ 02154000
         OI    NOT1ST,B'01000000'                                  0812 02155000
*   END INTDO1;                     /*                       @Y30OE72*/ 02156000
@DE00456 CLC   WORKSW(1),ON                                        0813 02157000
         BE    @DL00456                                            0813 02158000
*   END INTERPR;                    /*                       @Y30OE72*/ 02159000
@EL00007 DS    0H                                                  0814 02160000
@EF00007 DS    0H                                                  0814 02161000
@ER00007 L     @14,@SA00007                                        0814 02162000
         BR    @14                                                 0814 02163000
*                                                                  0815 02164000
*/****************************************************************** */ 02165000
*/*                                                          @Y30OE72*/ 02166000
*/* ROUTINE NAME = TR0BUILD                                  @Y30OE72*/ 02167000
*/*                                                          @Y30OE72*/ 02168000
*/* FUNCTION = READ TRACK 0 OF THE INPUT DISKETTE AND        @Y30OE72*/ 02169000
*/*            BUILD A TABLE IN CORE (TR0T) THAT CONTAINS    @Y30OE72*/ 02170000
*/*            THE CONTENTS OF THE FOLLOWING SECTORS:        @Y30OE72*/ 02171000
*/*            SECTOR 1-2 - IPL RECORDS -ONLY IF READABLE    @Y30OE72*/ 02172000
*/*                   7   - VOL1 LABEL - ONLY IF READABLE    @Y30OE72*/ 02173000
*/*                         OR USER SUPPLIED.                @Y30OE72*/ 02174000
*/*                   8-26- HDR1 LABELS - ONLY IF NOT 'D'    @Y30OE72*/ 02175000
*/*                         OR 'F' RECORDS. RECORDS GIV-     @Y30OE72*/ 02176000
*/*                         ING AN I/O ERROR WILL BE         @Y30OE72*/ 02177000
*/*                         ENTERED WITH '**' IN BYTES       @Y30OE72*/ 02178000
*/*                         62-63. RECORDS NOT 'HDR1' OR     @Y30OE72*/ 02179000
*/*                         'D' OR 'F' ARE ALSO ENTERED      @Y30OE72*/ 02180000
*/*                         WITH '**' IN 62-63.              @Y30OE72*/ 02181000
*/*            VOL1 LABEL PROCESSING:                        @Y30OE72*/ 02182000
*/*             1.IF SECTOR7 NOT READABLE & NO VOL STMT      @Y30OE72*/ 02183000
*/*               WAS PROVIDED, THEN FAIL.                   @Y30OE72*/ 02184000
*/*             2.IF SECTOR7 NOT READABLE & VOL STMT WAS     @Y30OE72*/ 02185000
*/*               PROVIDED, BUILD NEW VOL1 LABEL.            @Y30OE72*/ 02186000
*/*             3.IF SECTOR7 READABLE & NO VOL STMT WAS      @Y30OE72*/ 02187000
*/*               PROVIDED, USE INPUT SECTOR7.               @Y30OE72*/ 02188000
*/*             4. IF SECTOR7 READABLE & VOL STATEMENT       @Y30OE72*/ 02189000
*/*                PROVIDED, VOLIDS MUST BE EQUAL TO         @Y30OE72*/ 02190000
*/*                PROCEED. OTHERWISE FAIL.                  @Y30OE72*/ 02191000
*/*            HDR1 LABEL PROCESSING:                        @Y30OE72*/ 02192000
*/*             ALL HDR1 LABELS ARE MOVED INTO THE TR0T      @Y30OE72*/ 02193000
*/*             EXCEPT 'D' & 'F' RECORDS. A COUNTER          @Y30OE72*/ 02194000
*/*             (ERRCOUNT) KEEPS TRACK OF THE # OF ERROR     @Y30OE72*/ 02195000
*/*             RECORDS. AFTER ALL TRACK 0 SECTORS HAVE      @Y30OE72*/ 02196000
*/*             BEEN PROCESSED, NUMTAB & DELTAB ARE          @Y30OE72*/ 02197000
*/*             EXAMINED TO LOCATE THE TR0T ENTRIES TO BE    @Y30OE72*/ 02198000
*/*             OVERWRITTEN. THE TR0T ENTRIES DETERMINED     @Y30OE72*/ 02199000
*/*             BY DELTAB ARE CHANGED INTO 'D' RECORDS.      @Y30OE72*/ 02200000
*/*             THE ENTRIES DETERMINED BY NUMTAB ARE         @Y30OE72*/ 02201000
*/*             RECONSTRUCTED AS DEFINED IN REPTAB. AT       @Y30OE72*/ 02202000
*/*             EACH REPLACEMENT ERRCOUNT IS REDUCED BY      @Y30OE72*/ 02203000
*/*             1. WHEN BOTH NUMTAB & DELTAB ARE FINISHED    @Y30OE72*/ 02204000
*/*             ERRCOUNT SHOULD BE 0 AND THE TR0T SHOULD     @Y30OE72*/ 02205000
*/*             BE FREE OF '**' ENTRIES. IF ERRCOUNT IS      @Y30OE72*/ 02206000
*/*             >0 MORE DS STMTS ARE REQUIRED. IF            @Y30OE72*/ 02207000
*/*             ERRCOUNTIS <0, THEN TOO MANY DS STMTS        @Y30OE72*/ 02208000
*/*             WERE SUPPLIED. IF ERROUNT IS =0 AND '**'     @Y30OE72*/ 02209000
*/*             ENTRIES STILL APPEAR IN THE TR0T, THEN       @Y30OE72*/ 02210000
*/*             THE USER REPLACED CORRECT HDR1 ENTRIES.      @Y30OE72*/ 02211000
*/*             FOR ANY OF THESE ERRORS, AN ERROR MSG        @Y30OE72*/ 02212000
*/*             IS ISSUED, THE TR0T IS WRITTEN TO THE        @Y30OE72*/ 02213000
*/*             SYSPRINT DATA SET, AND THE JOB IS FAILED.    @Y30OE72*/ 02214000
*/*             IF ERRCOUNT IS 0 AND THERE ARE NO '**'       @Y30OE72*/ 02215000
*/*             ENTRIES, CHECKTAB IS CALLED TO CHECK THE     @Y30OE72*/ 02216000
*/*             TR0T ENTRIES FOR OVERLAPPING EXTENTS. IF     @Y30OE72*/ 02217000
*/*             OVERLAPS EXIST, A MSG IS ISSUED, THE TR0T    @Y30OE72*/ 02218000
*/*             IS PRINTED AND THE JOB FAILED.               @Y30OE72*/ 02219000
*/*                                                          @Y30OE72*/ 02220000
*/* INPUT = TRACK 0 OF THE INPUT DISKETTE.                   @Y30OE72*/ 02221000
*/*         REPTAB,NUMTAB,DELTAB (BUILT BY INTERPR).         @Y30OE72*/ 02222000
*/*                                                          @Y30OE72*/ 02223000
*/* OUTPUT = TRACK 0 TABLE (TR0T) CONTAINING INFORMATION     @Y30OE72*/ 02224000
*/*          NECESSARY TO WRITE OUTPUT DISKETTE TRACK 0.     @Y30OE72*/ 02225000
*/*          FAILSW=ON IF AN ERROR WAS FOUND.                @Y30OE72*/ 02226000
*/*          INPUT DISKETTE DEVICE IS OPENED.                @Y30OE72*/ 02227000
*/*                                                          @Y30OE72*/ 02228000
*/* ROUTINES CALLED = PRINTTAB -TO WRITE TR0T TO SYSPRINT    @Y30OE72*/ 02229000
*/*                   CHECKTAB -TO ARRANGE AND CHECK         @Y30OE72*/ 02230000
*/*                             EXTENT LIMITS.               @Y30OE72*/ 02231000
*/*                   MSGWRTR  -TO WRITE MSGS                @Y30OE72*/ 02232000
*/*                   VOLCHECK -TO VALIDITY CHECK INPUT      @Y30OE72*/ 02233000
*/*                             DISKETTE VOLID               @Y30OE72*/ 02234000
*/*                   SECURCHK -TO PROCESS A SECURE INPUT    @Y30OE72*/ 02235000
*/*                             DISKETTE.                    @Y30OE72*/ 02236000
*/*                   READSECT -TO READ INPUT DISKETTE       @Y30OE72*/ 02237000
*/*                                TRACK 0 SECTORS.          @Y30OE72*/ 02238000
*/*                   UCBDEBUP - TO LOAD IGG019VW AND UPDATE @Y30OE72*/ 02239000
*/*                              UCBVLSER                    @Y30OE72*/ 02240000
*/*                                                          @Y30OE72*/ 02241000
*/*    MACROS = OPEN,ESTAE                                   @Z30OE72*/ 02242000
*/*                                                          @Y30OE72*/ 02243000
*/********************************************************************/ 02244000
*                                                                  0815 02245000
*TR0BUILD:                          /*                       @Y30OE72*/ 02246000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30OE72*/ 02247000
*                                                                  0815 02248000
TR0BUILD ST    @14,@SA00008                                        0815 02249000
*   /*****************************************************************/ 02250000
*   /*                                                               */ 02251000
*   /* READ IPL & VOL1 SECTORS.                              @Y30OE72*/ 02252000
*   /*                                                               */ 02253000
*   /*****************************************************************/ 02254000
*                                                                  0816 02255000
*   RFY                             /*                       @Y30OE72*/ 02256000
*     EXITADDR RSTD;                /*                       @Y30OE72*/ 02257000
*   EXITADDR=ADDR(IOEESTAE);        /* ESTAE RTN ADDRESS     @Y30OE72*/ 02258000
         L     EXITADDR,@CV02205                                   0817 02259000
*   GEN                             /*                       @Y30OE72*/ 02260000
*       REFS(UCBLIST);                                             0818 02261000
*                                   /*                       @Y30OE72*/ 02262000
         ESTAE (EXITADDR),CT,PARAM=UCBLIST,PURGE=HALT,                 C02263000
               ASYNCH=NO,TERM=YES                              @Z30OE72 02264000
*   RFY                             /*                       @Y30OE72*/ 02265000
*     EXITADDR UNRSTD;              /*                       @Y30OE72*/ 02266000
*   GEN(OPEN (SYSUT1));             /* OPEN INPUT DISKETTE   @Y30OE72*/ 02267000
         OPEN (SYSUT1)                                                  02268000
*   REG1=ADDR(SYSUT1);              /* POINT TO DCB          @Y30OE72*/ 02269000
         LA    REG1,SYSUT1                                         0821 02270000
*   IF DCBOFOPN^=SETON THEN         /* OPEN SUCCESSFUL?      @Y30OE72*/ 02271000
         TM    DCBOFOPN+40(REG1),B'00010000'                       0822 02272000
         BO    @RF00822                                            0822 02273000
*     DO;                           /* NO.                   @Y30OE72*/ 02274000
*       I511DDNM=SYSUT1DD;          /* DDNAME                @Y30OE72*/ 02275000
         MVC   I511DDNM(8),@CC02091                                0824 02276000
*       REG1=ADDR(IEB511I);         /* MSG ADDR              @Y30OE72*/ 02277000
         LA    REG1,IEB511I                                        0825 02278000
*       MSGLEN=LENGTH(IEB511I);     /* ISSUE MSG             @Y30OE72*/ 02279000
         MVI   MSGLEN,X'28'                                        0826 02280000
*       CALL MSGWRTR;               /* IEB511I               @Y30OE72*/ 02281000
         BAL   @14,MSGWRTR                                         0827 02282000
*       FAILSW=ON;                  /* TERMINATE RUN         @Y30OE72*/ 02283000
         MVC   FAILSW(1),ON                                        0828 02284000
*     END;                          /*                       @Y30OE72*/ 02285000
*   IF FAILSW=OFF THEN              /* FILE OPENED OK?       @Y30OE72*/ 02286000
@RF00822 CLC   FAILSW(1),OFF                                       0830 02287000
         BNE   @RF00830                                            0830 02288000
*     DO;                           /* YES.                  @Y30OE72*/ 02289000
*       MODESWIT=GETIRB;            /* UPDATE DEB AND UCB    @Z30OE72*/ 02290000
         MVI   MODESWIT,X'03'                                      0832 02291000
*       TIOTADDR=WORKSYS1;          /* SYSUT1 TIOT ENTRY     @Z30OE72*/ 02292000
         SLR   @12,@12                                             0833 02293000
         ICM   @12,7,WORKSYS1                                      0833 02294000
         ST    @12,TIOTADDR                                        0833 02295000
*       DCBADDR=ADDR(SYSUT1);       /* PT TO SYSUT1 DCB      @Z30OE72*/ 02296000
         LA    @12,SYSUT1                                          0834 02297000
         ST    @12,DCBADDR                                         0834 02298000
*       CALL UCBDEBUP;              /* UPDATE UCB & DEB      @Z30OE72*/ 02299000
         BAL   @14,UCBDEBUP                                        0835 02300000
*       FIRSTIO=SETON;              /* SET FIRST TIME SWITCH @Y30OE72   02301000
*                                      FOR READSECT ROUTINE  @Y30OE72*/ 02302000
         OI    FIRSTIO,B'10000000'                                 0836 02303000
*       SC=TRACK0;                  /* START ADDR = TRACK 0  @Y30OE72*/ 02304000
         SLR   @12,@12                                             0837 02305000
         IC    @12,TRACK0                                          0837 02306000
         STH   @12,SC                                              0837 02307000
*       SR=IPLREC1;                 /* SECTOR 1              @Y30OE72*/ 02308000
         SLR   @11,@11                                             0838 02309000
         IC    @11,IPLREC1                                         0838 02310000
         STH   @11,SR                                              0838 02311000
*       EC=TRACK0;                  /* END ADDR = TRACK 0    @Y30OE72*/ 02312000
         STH   @12,EC                                              0839 02313000
*       ER=IPLREC2;                 /* SECTOR 2              @Y30OE72*/ 02314000
         SLR   @12,@12                                             0840 02315000
         IC    @12,IPLREC2                                         0840 02316000
         STH   @12,ER                                              0840 02317000
*       DO T=1 TO 2;                /* READ IPL RECORDS      @Y30OE72*/ 02318000
         LA    @12,1                                               0841 02319000
         STC   @12,T                                               0841 02320000
@DL00841 DS    0H                                                  0842 02321000
*         CALL READSECT;            /* TO READ A TR 0 SECTOR @Y30OE72*/ 02322000
         BAL   @14,READSECT                                        0842 02323000
*         TR0T(T,1:80)=RECBUF(1:80);/* COPY RECORD INTO TR0T @Y30OE72*/ 02324000
         SLR   @12,@12                                             0843 02325000
         IC    @12,T                                               0843 02326000
         LR    @11,@12                                             0843 02327000
         MH    @11,@CH00311                                        0843 02328000
         LA    @15,TR0T-80(@11)                                    0843 02329000
         L     @11,IOBPTR                                          0843 02330000
         ICM   @14,7,CCWRDADD(@11)                                 0843 02331000
         MVC   0(80,@15),RECBUF(@14)                               0843 02332000
*         FIRSTIO=SETOFF;           /* RESET SWITCH          @Y30OE72*/ 02333000
         NI    FIRSTIO,B'01111111'                                 0844 02334000
*       END;                        /* END OF IPL-READ       @Y30OE72*/ 02335000
         AL    @12,@CF00052                                        0845 02336000
         STC   @12,T                                               0845 02337000
         CH    @12,@CH00070                                        0845 02338000
         BNH   @DL00841                                            0845 02339000
*       FIRSTIO=SETON;              /* SET FIRST TIME SWITCH @Y30OE72   02340000
*                                      FOR READSECT ROUTINE  @Y30OE72*/ 02341000
         OI    FIRSTIO,B'10000000'                                 0846 02342000
*       SR=VOLLABEL;                /* START SECTOR = 7      @Y30OE72*/ 02343000
         LA    @12,7                                               0847 02344000
         STH   @12,SR                                              0847 02345000
*       ER=VOLLABEL;                /* END SECTOR = 7        @Y30OE72*/ 02346000
         STH   @12,ER                                              0848 02347000
*       CALL READSECT;              /* TO READ VOL1 SECTOR   @Y30OE72*/ 02348000
         BAL   @14,READSECT                                        0849 02349000
*       FIRSTIO=SETOFF;             /* RESET SWITCH          @Y30OE72*/ 02350000
         NI    FIRSTIO,B'01111111'                                 0850 02351000
*       IF BADRECSW=SET|            /* I/O ERROR OR          @Y30OE72*/ 02352000
*           DFSWITCH=SET|           /* DF RECORD OR          @Y30OE72*/ 02353000
*           RECBUF(1:4)^=CHARVOL1|  /* NOT 'VOL1' OR         @Y30OE72*/ 02354000
*           RECBUF(80)^=CHARW THEN  /* NOT STANDARD LABELS?  @Y30OE72*/ 02355000
         CLC   BADRECSW(1),SET                                     0851 02356000
         BE    @RT00851                                            0851 02357000
         CLC   DFSWITCH(1),SET                                     0851 02358000
         BE    @RT00851                                            0851 02359000
         L     @12,IOBPTR                                          0851 02360000
         SLR   @11,@11                                             0851 02361000
         ICM   @11,7,CCWRDADD(@12)                                 0851 02362000
         CLC   RECBUF(4,@11),@CC02049                              0851 02363000
         BNE   @RT00851                                            0851 02364000
         CLI   RECBUF+79(@11),C'W'                                 0851 02365000
         BE    @RF00851                                            0851 02366000
@RT00851 DS    0H                                                  0852 02367000
*         SW508I=SETON;             /* YES. SET ERROR IND    @Y30OE72*/ 02368000
         OI    SW508I,B'00000001'                                  0852 02369000
*       ELSE                        /* NO ERRORS             @Y30OE72*/ 02370000
*         DO;                       /* VALIDITY CHECK VOLID  @Y30OE72*/ 02371000
         B     @RC00851                                            0853 02372000
@RF00851 DS    0H                                                  0854 02373000
*           IF RECBUF(11)^=BLANK(1) THEN/* SECURE VOLUME?    @Y30OE72*/ 02374000
         L     @12,IOBPTR                                          0854 02375000
         ICM   @11,7,CCWRDADD(@12)                                 0854 02376000
         CLC   RECBUF+10(1,@11),BLANK                              0854 02377000
         BE    @RF00854                                            0854 02378000
*             DO;                   /* YES.                  @Y30OE72*/ 02379000
*               REPEATSW=ON;        /* INIT LOOP CONTROL     @Y30OE72*/ 02380000
         MVC   REPEATSW(1),ON                                      0856 02381000
*               CALL SECURCHK;      /* YES. ASK OPR FOR QUAL @Y30OE72*/ 02382000
         BAL   @14,SECURCHK                                        0857 02383000
*             END;                  /*                       @Y30OE72*/ 02384000
*           ELSE                    /* NOT SECURE            @Y30OE72*/ 02385000
*             USEVOL=SETON;         /* USE THE VOLUME        @Y30OE72*/ 02386000
         B     @RC00854                                            0859 02387000
@RF00854 OI    USEVOL,B'00000100'                                  0859 02388000
*           IF USEVOL=SETON THEN    /* SECURITY OK?          @Y30OE72*/ 02389000
@RC00854 TM    USEVOL,B'00000100'                                  0860 02390000
         BNO   @RF00860                                            0860 02391000
*             DO;                   /* YES. CHK VOLID        @Y30OE72*/ 02392000
*               LETPTR=ADDR(VOLAREA);/* PT TO 1ST VOLID CHAR @Y30OE72*/ 02393000
         LA    LETPTR,VOLAREA                                      0862 02394000
*               VOLAREA(1:6)=RECBUF(5:10);/* VOLID INTO WORKAREA   0863 02395000
*                                                            @Y30OE72*/ 02396000
         L     @12,IOBPTR                                          0863 02397000
         ICM   @11,7,CCWRDADD(@12)                                 0863 02398000
         MVC   VOLAREA(6),RECBUF+4(@11)                            0863 02399000
*               CALL VOLCHECK;      /* CHECK VALIDITY        @Y30OE72*/ 02400000
         BAL   @14,VOLCHECK                                        0864 02401000
*             END;                  /*                       @Y30OE72*/ 02402000
*           ELSE                    /* NO. DON'T COPY        @Y30OE72*/ 02403000
*             FAILSW=ON;            /* TERMINATE RUN         @Y30OE72*/ 02404000
         B     @RC00860                                            0866 02405000
@RF00860 MVC   FAILSW(1),ON                                        0866 02406000
*         END;                      /*                       @Y30OE72*/ 02407000
@RC00860 DS    0H                                                  0868 02408000
*     END;                          /*                       @Y30OE72*/ 02409000
@RC00851 DS    0H                                                  0869 02410000
*   IF FAILSW=OFF THEN              /* NON-SECURE VOL?       @Y30OE72*/ 02411000
@RF00830 CLC   FAILSW(1),OFF                                       0869 02412000
         BNE   @RF00869                                            0869 02413000
*     DO;                           /* YES.                  @Y30OE72*/ 02414000
*       IF BADVOLID=SETON|          /* BAD VOL1              @Y30OE72*/ 02415000
*           SW508I=SETON THEN       /* LABEL?                @Y30OE72*/ 02416000
         TM    BADVOLID,B'00000011'                                0871 02417000
         BZ    @RF00871                                            0871 02418000
*         DO;                       /* YES.                  @Y30OE72*/ 02419000
*           IF VOLSW=OFF THEN       /* VOL STMT SUPPLIED?    @Y30OE72*/ 02420000
         CLC   VOLSW(1),OFF                                        0873 02421000
         BNE   @RF00873                                            0873 02422000
*             DO;                   /* NO.                   @Y30OE72*/ 02423000
*               REG1=ADDR(IEB508I); /* ISSUE                 @Y30OE72*/ 02424000
         LA    REG1,IEB508I                                        0875 02425000
*               MSGLEN=LENGTH(IEB508I);/* MESSAGE            @Y30OE72*/ 02426000
         MVI   MSGLEN,X'23'                                        0876 02427000
*               CALL MSGWRTR;       /* IEB508I               @Y30OE72*/ 02428000
         BAL   @14,MSGWRTR                                         0877 02429000
*               FAILSW=ON;          /* TERMINATE RUN         @Y30OE72*/ 02430000
         MVC   FAILSW(1),ON                                        0878 02431000
*             END;                  /* .                     @Y30OE72*/ 02432000
*           ELSE                    /*                       @Y30OE72*/ 02433000
*             DO;                   /* IF VOL STMT SPECIFIED @Y30OE72*/ 02434000
         B     @RC00873                                            0880 02435000
@RF00873 DS    0H                                                  0881 02436000
*               TR0T(3,1:4)=CHARVOL1;/* BUILD NEW VOL1 LABEL @Y30OE72*/ 02437000
         MVC   TR0T+160(4),@CC02049                                0881 02438000
*               TR0T(3,5:10)=REPVOL;/* VOLID                 @Y30OE72*/ 02439000
         MVC   TR0T+164(6),REPVOL                                  0882 02440000
*               TR0T(3,80)=CHARW;   /* LABEL STD VERSION     @Y30OE72*/ 02441000
         MVI   TR0T+239,C'W'                                       0883 02442000
*             END;                  /*                       @Y30OE72*/ 02443000
*         END;                      /* END BAD VOL1          @Y30OE72*/ 02444000
*       ELSE                        /* GOOD INPUT VOL1       @Y30OE72*/ 02445000
*         DO;                       /* CHK FOR VOL STMT      @Y30OE72*/ 02446000
         B     @RC00871                                            0886 02447000
@RF00871 DS    0H                                                  0887 02448000
*           IF VOLSW=ON THEN        /* VOL STMT PROVIDED?    @Y30OE72*/ 02449000
         CLC   VOLSW(1),ON                                         0887 02450000
         BNE   @RF00887                                            0887 02451000
*             IF RECBUF(5:10)^=REPVOL THEN/* YES. VOL STMT & @Y30OE72   02452000
*                                      SECTOR 7 EQUAL?       @Y30OE72*/ 02453000
         L     @12,IOBPTR                                          0888 02454000
         ICM   @11,7,CCWRDADD(@12)                                 0888 02455000
         CLC   RECBUF+4(6,@11),REPVOL                              0888 02456000
         BE    @RF00888                                            0888 02457000
*               DO;                 /* NO.                   @Y30OE72*/ 02458000
*                 REG1=ADDR(IEB516I);/* ISSUE                @Y30OE72*/ 02459000
         LA    REG1,IEB516I                                        0890 02460000
*                 MSGLEN=LENGTH(IEB516I);/* MESSAGE          @Y30OE72*/ 02461000
         MVI   MSGLEN,X'1F'                                        0891 02462000
*                 CALL MSGWRTR;     /* IEB516I               @Y30OE72*/ 02463000
         BAL   @14,MSGWRTR                                         0892 02464000
*                 FAILSW=ON;        /* TERMINATE RUN         @Y30OE72*/ 02465000
         MVC   FAILSW(1),ON                                        0893 02466000
*               END;                /* THE JOB               @Y30OE72*/ 02467000
*           MODESWIT=UCBONLY;       /* UPDATE UCBVLSER       @Z30OE72*/ 02468000
@RF00888 DS    0H                                                  0895 02469000
@RF00887 MVI   MODESWIT,X'02'                                      0895 02470000
*           TIOTADDR=WORKSYS1;      /* SYSUT1 TIOT ENTRY     @Y30OE72*/ 02471000
         SLR   @12,@12                                             0896 02472000
         ICM   @12,7,WORKSYS1                                      0896 02473000
         ST    @12,TIOTADDR                                        0896 02474000
*           DCBADDR=ADDR(SYSUT1);   /* PT TO SYSUT1 DCB      @Y30OE72*/ 02475000
         LA    @12,SYSUT1                                          0897 02476000
         ST    @12,DCBADDR                                         0897 02477000
*           CALL UCBDEBUP;          /* UPDATE UCB & DEB      @Y30OE72*/ 02478000
         BAL   @14,UCBDEBUP                                        0898 02479000
*           TR0T(3,1:80)=RECBUF(1:80);/* VOL STMT INTO TR0T  @Y30OE72*/ 02480000
         L     @12,IOBPTR                                          0899 02481000
         ICM   @11,7,CCWRDADD(@12)                                 0899 02482000
         MVC   TR0T+160(80),RECBUF(@11)                            0899 02483000
*         END;                      /*                       @Y30OE72*/ 02484000
*     END;                          /*                       @Y30OE72*/ 02485000
@RC00871 DS    0H                                                  0902 02486000
*                                                                  0902 02487000
*   /*****************************************************************/ 02488000
*   /*                                                               */ 02489000
*   /* READ ALL HDR1 SECTORS.                                @Y30OE72*/ 02490000
*   /*                                                               */ 02491000
*   /*****************************************************************/ 02492000
*                                                                  0902 02493000
*   IF FAILSW=OFF THEN              /* VOL1 LABEL OK?        @Y30OE72*/ 02494000
@RF00869 CLC   FAILSW(1),OFF                                       0902 02495000
         BNE   @RF00902                                            0902 02496000
*     DO;                           /* YES. READ HDR1S       @Y30OE72*/ 02497000
*       E=4;                        /* INITIALIZE TR0T INDEX @Y30OE72   02498000
*                                      TO THE START OF THE   @Y30OE72   02499000
*                                      HDR1 LABELS.          @Y30OE72*/ 02500000
         MVI   E,X'04'                                             0904 02501000
*       FIRSTIO=SETON;              /* SET FIRST TIME SWITCH @Y30OE72   02502000
*                                      FOR READSECT RTN      @Y30OE72*/ 02503000
         OI    FIRSTIO,B'10000000'                                 0905 02504000
*       SR=FIRSTHDR;                /* START SECTOR = 8      @Y30OE72*/ 02505000
         LA    @12,8                                               0906 02506000
         STH   @12,SR                                              0906 02507000
*       ER=SECTOR26;                /* END SECTOR = 26       @Y30OE72*/ 02508000
         MVC   ER(2),@CH02141                                      0907 02509000
*       DO T=8 TO 26;               /* SET UP READ-LOOP      @Y30OE72*/ 02510000
         STC   @12,T                                               0908 02511000
@DL00908 DS    0H                                                  0909 02512000
*         CALL READSECT;            /* TO READ A SECTOR      @Y30OE72*/ 02513000
         BAL   @14,READSECT                                        0909 02514000
*         FIRSTIO=SETOFF;           /* RESET 1ST TIME SW     @Y30OE72*/ 02515000
         NI    FIRSTIO,B'01111111'                                 0910 02516000
*         IF DFSWITCH=NOTSET&BADRECSW=NOTSET&/*              @Y30OE72*/ 02517000
*             RECBUF(1:4)=CHARHDR1 THEN/*                    @Y30OE72*/ 02518000
         CLC   DFSWITCH(1),NOTSET                                  0911 02519000
         BNE   @RF00911                                            0911 02520000
         CLC   BADRECSW(1),NOTSET                                  0911 02521000
         BNE   @RF00911                                            0911 02522000
         L     @12,IOBPTR                                          0911 02523000
         SLR   @11,@11                                             0911 02524000
         ICM   @11,7,CCWRDADD(@12)                                 0911 02525000
         CLC   RECBUF(4,@11),CHARHDR1                              0911 02526000
         BNE   @RF00911                                            0911 02527000
*           DO;                     /*                       @Y30OE72*/ 02528000
*             TR0T(E,1:80)=RECBUF(1:80);/* COPY TO TR0T      @Y30OE72*/ 02529000
         SLR   @12,@12                                             0913 02530000
         IC    @12,E                                               0913 02531000
         LR    @15,@12                                             0913 02532000
         MH    @15,@CH00311                                        0913 02533000
         LA    @14,TR0T-80(@15)                                    0913 02534000
         MVC   0(80,@14),RECBUF(@11)                               0913 02535000
*             E=E+1;                /* UPDATE TR0T INDEX     @Y30OE72*/ 02536000
         LA    @11,1                                               0914 02537000
         ALR   @12,@11                                             0914 02538000
         STC   @12,E                                               0914 02539000
*             TABCNT=TABCNT+1;      /* AND TR0T COUNTER      @Y30OE72*/ 02540000
         AH    @11,TABCNT                                          0915 02541000
         STH   @11,TABCNT                                          0915 02542000
*           END;                    /*                       @Y30OE72*/ 02543000
*         ELSE                      /*                       @Y30OE72*/ 02544000
*           IF DFSWITCH=NOTSET THEN /* A BAD RECORD          @Y30OE72*/ 02545000
         B     @RC00911                                            0917 02546000
@RF00911 CLC   DFSWITCH(1),NOTSET                                  0917 02547000
         BNE   @RF00917                                            0917 02548000
*             DO;                   /* WILL BE MARKED        @Y30OE72*/ 02549000
*               RECBUF(62)=CHARAST; /* IN BYTE 62 AND 63     @Y30OE72*/ 02550000
         L     @12,IOBPTR                                          0919 02551000
         SLR   @11,@11                                             0919 02552000
         ICM   @11,7,CCWRDADD(@12)                                 0919 02553000
         MVC   RECBUF+61(1,@11),CHARAST                            0919 02554000
*               RECBUF(63)=CHARAST; /* WHILE IN BUFFER       @Y30OE72*/ 02555000
         MVC   RECBUF+62(1,@11),CHARAST                            0920 02556000
*               ERRCOUNT=ERRCOUNT+1;/* ADD 1 TO ERRCOUNT     @Y30OE72*/ 02557000
         LA    @12,1                                               0921 02558000
         LH    @00,ERRCOUNT                                        0921 02559000
         ALR   @00,@12                                             0921 02560000
         STH   @00,ERRCOUNT                                        0921 02561000
*               TR0T(E,1:80)=RECBUF(1:80);/* COPY TO TR0T    @Y30OE72*/ 02562000
         SLR   @15,@15                                             0922 02563000
         IC    @15,E                                               0922 02564000
         LR    @14,@15                                             0922 02565000
         MH    @14,@CH00311                                        0922 02566000
         LA    @03,TR0T-80(@14)                                    0922 02567000
         MVC   0(80,@03),RECBUF(@11)                               0922 02568000
*               E=E+1;              /* UPDATE TR0T INDEX     @Y30OE72*/ 02569000
         ALR   @15,@12                                             0923 02570000
         STC   @15,E                                               0923 02571000
*               TABCNT=TABCNT+1;    /* AND TR0T COUNTER      @Y30OE72*/ 02572000
         AH    @12,TABCNT                                          0924 02573000
         STH   @12,TABCNT                                          0924 02574000
*             END;                  /* END BAD REC           @Y30OE72*/ 02575000
*       END;                        /* END HDR1-READ         @Y30OE72*/ 02576000
@RF00917 DS    0H                                                  0926 02577000
@RC00911 SLR   @12,@12                                             0926 02578000
         IC    @12,T                                               0926 02579000
         AL    @12,@CF00052                                        0926 02580000
         STC   @12,T                                               0926 02581000
         CH    @12,@CH02141                                        0926 02582000
         BNH   @DL00908                                            0926 02583000
*       HDRCNT=TABCNT;              /* NUM HDR1S IN TR0T     @Y30OE72*/ 02584000
         MVC   HDRCNT(2),TABCNT                                    0927 02585000
*     END;                          /*                       @Y30OE72*/ 02586000
*   ELSE                            /* VOL1                  @Y30OE72*/ 02587000
*     RETURN;                       /* ERROR                 @Y30OE72*/ 02588000
*                                                                  0930 02589000
*   /*****************************************************************/ 02590000
*   /*                                                               */ 02591000
*   /* UPDATE TR0T FROM REPTAB                               @Y30OE72*/ 02592000
*   /*                                                               */ 02593000
*   /*****************************************************************/ 02594000
*                                                                  0930 02595000
*   IF NUMTAB(1)^=AST2 THEN         /* DS-CARDS SUPPLIED,    @Y30OE72*/ 02596000
         CLC   NUMTAB(1),AST2                                      0930 02597000
         BE    @RF00930                                            0930 02598000
*     DO N=1 TO 19                  /* SEARCH NUMTAB FOR     @Y30OE72   02599000
*                                      SEQUENCE NBRS         @Y30OE72*/ 02600000
*           WHILE(NUMTAB(N)^=AST2); /* OF TR0T ENTRIES.      @Y30OE72*/ 02601000
         LA    @12,1                                               0931 02602000
         STC   @12,N                                               0931 02603000
@DL00931 SLR   @11,@11                                             0931 02604000
         IC    @11,NUMTAB-1(@12)                                   0931 02605000
         SLR   @00,@00                                             0931 02606000
         IC    @00,AST2                                            0931 02607000
         CR    @11,@00                                             0931 02608000
         BE    @DC00931                                            0931 02609000
*       R=N;                        /* SET REPTAB INDEX      @Y30OE72*/ 02610000
         STC   @12,R                                               0932 02611000
*       E=NUMTAB(N)+3;              /* TR0T INDEX = DS # + 3 @Y30OE72*/ 02612000
         LA    @11,3(,@11)                                         0933 02613000
         STC   @11,E                                               0933 02614000
*       TR0T(E,1:80)=ZEROREC(1:80); /* CLEAN TR0T AND        @Y30OE72   02615000
*                                      REBUILD IT.           @Y30OE72*/ 02616000
         MH    @11,@CH00311                                        0934 02617000
         LA    @12,TR0T-80(@11)                                    0934 02618000
         MVC   0(80,@12),ZEROREC                                   0934 02619000
*       TR0T(E,1:4)=CHARHDR1;       /* HDR1                  @Y30OE72*/ 02620000
         LA    @12,TR0T-80(@11)                                    0935 02621000
         MVC   0(4,@12),CHARHDR1                                   0935 02622000
*       DUPDSID=SETOFF;             /* INIT MSG CONTROL SW   @Y30OE72*/ 02623000
         NI    DUPDSID,B'01111111'                                 0936 02624000
*       DO I=1 TO TABCNT            /* SCAN FOR DUP DSIDS    @Y30OE72*/ 02625000
*             WHILE DUPDSID=SETOFF; /* TIL 1ST ONE IS FOUND  @Y30OE72*/ 02626000
         LA    @12,1                                               0937 02627000
         B     @DE00937                                            0937 02628000
@DL00937 TM    DUPDSID,B'10000000'                                 0937 02629000
         BNZ   @DC00937                                            0937 02630000
*         T=I+3;                    /* TR0T INDEX            @Y30OE72*/ 02631000
         LA    @12,3(,@12)                                         0938 02632000
         STC   @12,T                                               0938 02633000
*         IF TR0TDSID(T)=REPDSID(R)&/* DUPLICATE             @Y30OE72*/ 02634000
*             TR0T(T,62)^=CHARAST THEN/* DSIDS?              @Y30OE72*/ 02635000
         MH    @12,@CH00311                                        0939 02636000
         SLR   @11,@11                                             0939 02637000
         IC    @11,R                                               0939 02638000
         MH    @11,@CH02356                                        0939 02639000
         LA    @15,TR0TDSID-80(@12)                                0939 02640000
         LA    @14,REPDSID-47(@11)                                 0939 02641000
         CLC   0(8,@15),0(@14)                                     0939 02642000
         BNE   @RF00939                                            0939 02643000
         LA    @11,TR0T-19(@12)                                    0939 02644000
         CLC   0(1,@11),CHARAST                                    0939 02645000
         BE    @RF00939                                            0939 02646000
*           DO;                     /* YES.                  @Y30OE72*/ 02647000
*             I506DS#=PRTNRS(NUMTAB(N));/* DS # IN MSG       @Y30OE72*/ 02648000
         SLR   @12,@12                                             0941 02649000
         IC    @12,N                                               0941 02650000
         SLR   @11,@11                                             0941 02651000
         IC    @11,NUMTAB-1(@12)                                   0941 02652000
         ALR   @11,@11                                             0941 02653000
         LA    @12,PRTNRS-2(@11)                                   0941 02654000
         MVC   I506DS#(2),0(@12)                                   0941 02655000
*             REG1=ADDR(IEB506I);   /* ISSUE                 @Y30OE72*/ 02656000
         LA    REG1,IEB506I                                        0942 02657000
*             MSGLEN=LENGTH(IEB506I);/* MESSAGE              @Y30OE72*/ 02658000
         MVI   MSGLEN,X'22'                                        0943 02659000
*             CALL MSGWRTR;         /* IEB506I               @Y30OE72*/ 02660000
         BAL   @14,MSGWRTR                                         0944 02661000
*             DUPDSID=SETON;        /* ISSUE MSG ONLY ONCE   @Y30OE72*/ 02662000
         OI    DUPDSID,B'10000000'                                 0945 02663000
*             FAILSW=ON;            /* TERMINATE RUN         @Y30OE72*/ 02664000
         MVC   FAILSW(1),ON                                        0946 02665000
*           END;                    /*                       @Y30OE72*/ 02666000
*       END;                        /*                       @Y30OE72*/ 02667000
@RF00939 LA    @12,1                                               0948 02668000
         AL    @12,I                                               0948 02669000
@DE00937 ST    @12,I                                               0948 02670000
         CH    @12,TABCNT                                          0948 02671000
         BNH   @DL00937                                            0948 02672000
@DC00937 DS    0H                                                  0949 02673000
*       TR0T(E,6:13)=REPDSID(R);    /* FILE NAME             @Y30OE72*/ 02674000
         SLR   @12,@12                                             0949 02675000
         IC    @12,E                                               0949 02676000
         LR    @11,@12                                             0949 02677000
         MH    @11,@CH00311                                        0949 02678000
         LA    @15,TR0T-75(@11)                                    0949 02679000
         SLR   @14,@14                                             0949 02680000
         IC    @14,R                                               0949 02681000
         MH    @14,@CH02356                                        0949 02682000
         LA    @03,REPDSID-47(@14)                                 0949 02683000
         MVC   0(8,@15),0(@03)                                     0949 02684000
*       TR0T(E,23:27)=REPBLKLN(R);  /* BLOCK LENGTH          @Y30OE72*/ 02685000
         LA    @15,TR0T-58(@11)                                    0950 02686000
         LA    @03,REPBLKLN-47(@14)                                0950 02687000
         MVC   0(5,@15),0(@03)                                     0950 02688000
*       TR0T(E,29:33)=REPBOE(R);    /* BOE (LEL)             @Y30OE72*/ 02689000
         LA    @15,TR0T-52(@11)                                    0951 02690000
         LA    @03,REPBOE-47(@14)                                  0951 02691000
         MVC   0(5,@15),0(@03)                                     0951 02692000
*       TR0T(E,35:39)=REPEOE(R);    /* EOE (UEL)             @Y30OE72*/ 02693000
         LA    @15,TR0T-46(@11)                                    0952 02694000
         LA    @03,REPEOE-47(@14)                                  0952 02695000
         MVC   0(5,@15),0(@03)                                     0952 02696000
*       TR0T(E,41)=REPBYPAS(R);     /* BYPASS INDICATOR      @Y30OE72*/ 02697000
         LA    @15,TR0T-40(@11)                                    0953 02698000
         LA    @03,REPBYPAS-47(@14)                                0953 02699000
         MVC   0(1,@15),0(@03)                                     0953 02700000
*       TR0T(E,42)=REPDSS(R);       /* SECURITY BYTE         @Y30OE72*/ 02701000
         LA    @15,TR0T-39(@11)                                    0954 02702000
         LA    @03,REPDSS-47(@14)                                  0954 02703000
         MVC   0(1,@15),0(@03)                                     0954 02704000
*       TR0T(E,43)=REPWP(R);        /* WRITE PROTECT         @Y30OE72*/ 02705000
         LA    @15,TR0T-38(@11)                                    0955 02706000
         LA    @03,REPWP-47(@14)                                   0955 02707000
         MVC   0(1,@15),0(@03)                                     0955 02708000
*       TR0T(E,45)=REPCONT(R);      /* MULTI-VOLUME IND      @Y30OE72*/ 02709000
         LA    @15,TR0T-36(@11)                                    0956 02710000
         LA    @03,REPCONT-47(@14)                                 0956 02711000
         MVC   0(1,@15),0(@03)                                     0956 02712000
*       TR0T(E,46:47)=REPSEQ#(R);   /* VOLUME SEQ NUMBER     @Y30OE72*/ 02713000
         LA    @15,TR0T-35(@11)                                    0957 02714000
         LA    @03,REPSEQ#-47(@14)                                 0957 02715000
         MVC   0(2,@15),0(@03)                                     0957 02716000
*       TR0T(E,48:53)=REPCREAT(R);  /* CREATION DATE         @Y30OE72*/ 02717000
         LA    @15,TR0T-33(@11)                                    0958 02718000
         LA    @03,REPCREAT-47(@14)                                0958 02719000
         MVC   0(6,@15),0(@03)                                     0958 02720000
*       TR0T(E,67:72)=REPEXPIR(R);  /* EXPIRATION DATE       @Y30OE72*/ 02721000
         LA    @15,TR0T-14(@11)                                    0959 02722000
         LA    @03,REPEXPIR-47(@14)                                0959 02723000
         MVC   0(6,@15),0(@03)                                     0959 02724000
*       TR0T(E,73)=REPVER(R);       /* VERIFY INDICATOR      @Y30OE72*/ 02725000
         LA    @15,TR0T-8(@11)                                     0960 02726000
         LA    @03,REPVER-47(@14)                                  0960 02727000
         MVC   0(1,@15),0(@03)                                     0960 02728000
*       TR0T(E,75:79)=REPEOD(R);    /* END OF DATA           @Y30OE72*/ 02729000
         LA    @15,TR0T-6(@11)                                     0961 02730000
         LA    @11,REPEOD-47(@14)                                  0961 02731000
         MVC   0(5,@15),0(@11)                                     0961 02732000
*       IF(TABCNT+3)>=E THEN        /* IF DATA SET EXISTS    @Y30OE72*/ 02733000
         LA    @11,3                                               0962 02734000
         AH    @11,TABCNT                                          0962 02735000
         CR    @11,@12                                             0962 02736000
         BL    @RF00962                                            0962 02737000
*         ERRCOUNT=ERRCOUNT-1;      /* REDUCE # ERR RECORDS  @Y30OE72*/ 02738000
         LH    @12,ERRCOUNT                                        0963 02739000
         BCTR  @12,0                                               0963 02740000
         STH   @12,ERRCOUNT                                        0963 02741000
*       ELSE                        /* UNNECESSARY DS STMT   @Y30OE72*/ 02742000
*         ERRCOUNT=ERRCOUNT-2;      /* FORCE MSG IEB514I     @Y30OE72*/ 02743000
         B     @RC00962                                            0964 02744000
@RF00962 LH    @12,ERRCOUNT                                        0964 02745000
         BCTR  @12,0                                               0964 02746000
         BCTR  @12,0                                               0964 02747000
         STH   @12,ERRCOUNT                                        0964 02748000
*     END;                          /* END TR0T FROM REPTAB  @Y30OE72*/ 02749000
@RC00962 LA    @12,1                                               0965 02750000
         SLR   @11,@11                                             0965 02751000
         IC    @11,N                                               0965 02752000
         ALR   @12,@11                                             0965 02753000
         STC   @12,N                                               0965 02754000
         CH    @12,@CH02061                                        0965 02755000
         BNH   @DL00931                                            0965 02756000
@DC00931 DS    0H                                                  0966 02757000
*                                                                  0966 02758000
*   /*****************************************************************/ 02759000
*   /*                                                               */ 02760000
*   /* UPDATE TR0T FROM DELTAB                               @Y30OE72*/ 02761000
*   /*                                                               */ 02762000
*   /*****************************************************************/ 02763000
*                                                                  0966 02764000
*   IF DELTAB(1)^=AST2 THEN         /* ANY DELETE DS STMTS?  @Y30OE72*/ 02765000
@RF00930 CLC   DELTAB(1),AST2                                      0966 02766000
         BE    @RF00966                                            0966 02767000
*     DO;                           /* YES                   @Y30OE72*/ 02768000
*       RECBUF(1:128)=BLANK;        /* PREPARE RECORD        @Y30OE72*/ 02769000
         L     @12,IOBPTR                                          0968 02770000
         SLR   @11,@11                                             0968 02771000
         ICM   @11,7,CCWRDADD(@12)                                 0968 02772000
         MVC   RECBUF(128,@11),BLANK                               0968 02773000
*       RECBUF(1:4)=CHARDDR1;       /* ONLY MARKED DDR1      @Y30OE72*/ 02774000
         MVC   RECBUF(4,@11),CHARDDR1                              0969 02775000
*       DO D=1 TO 19                /* SRCH DELTAB FOR TR0T  @Y30OE72*/ 02776000
*             WHILE(DELTAB(D)^=AST2);/* SEQUENCE NBRS        @Y30OE72*/ 02777000
         LA    @12,1                                               0970 02778000
         STC   @12,D                                               0970 02779000
@DL00970 SLR   @11,@11                                             0970 02780000
         IC    @11,DELTAB-1(@12)                                   0970 02781000
         SLR   @12,@12                                             0970 02782000
         IC    @12,AST2                                            0970 02783000
         CR    @11,@12                                             0970 02784000
         BE    @DC00970                                            0970 02785000
*         E=DELTAB(D)+3;            /* TROT INDEX=DS# +3     @Y30OE72*/ 02786000
         LA    @12,3                                               0971 02787000
         ALR   @11,@12                                             0971 02788000
         STC   @11,E                                               0971 02789000
*         TR0T(E,1:80)=RECBUF(1:80);/* OVERWRITE TR0T        @Y30OE72*/ 02790000
         LR    @15,@11                                             0972 02791000
         MH    @15,@CH00311                                        0972 02792000
         LA    @14,TR0T-80(@15)                                    0972 02793000
         L     @15,IOBPTR                                          0972 02794000
         ICM   @03,7,CCWRDADD(@15)                                 0972 02795000
         MVC   0(80,@14),RECBUF(@03)                               0972 02796000
*         IF(TABCNT+3)>=E THEN      /* IF DATA SET EXISTS    @Y30OE72*/ 02797000
         AH    @12,TABCNT                                          0973 02798000
         CR    @12,@11                                             0973 02799000
         BL    @RF00973                                            0973 02800000
*           DO;                     /*                       @Y30OE72*/ 02801000
*             HDRCNT=HDRCNT-1;      /* NUM HDR1S IN TR0T     @Y30OE72*/ 02802000
         LH    @12,HDRCNT                                          0975 02803000
         BCTR  @12,0                                               0975 02804000
         STH   @12,HDRCNT                                          0975 02805000
*             ERRCOUNT=ERRCOUNT-1;  /* REDUCE # ERR RECORDS  @Y30OE72*/ 02806000
         LH    @12,ERRCOUNT                                        0976 02807000
         BCTR  @12,0                                               0976 02808000
         STH   @12,ERRCOUNT                                        0976 02809000
*           END;                    /*                       @Y30OE72*/ 02810000
*         ELSE                      /*                       @Y30OE72*/ 02811000
*           ERRCOUNT=ERRCOUNT-2;    /* FORCE MSG IEB514I     @Y30OE72*/ 02812000
         B     @RC00973                                            0978 02813000
@RF00973 LH    @12,ERRCOUNT                                        0978 02814000
         BCTR  @12,0                                               0978 02815000
         BCTR  @12,0                                               0978 02816000
         STH   @12,ERRCOUNT                                        0978 02817000
*       END;                        /* END SEARCH DELTAB     @Y30OE72*/ 02818000
@RC00973 LA    @12,1                                               0979 02819000
         SLR   @11,@11                                             0979 02820000
         IC    @11,D                                               0979 02821000
         ALR   @12,@11                                             0979 02822000
         STC   @12,D                                               0979 02823000
         CH    @12,@CH02061                                        0979 02824000
         BNH   @DL00970                                            0979 02825000
@DC00970 DS    0H                                                  0980 02826000
*     END;                          /* END DELTAB UPDATE     @Y30OE72*/ 02827000
*                                                                  0981 02828000
*   /*****************************************************************/ 02829000
*   /*                                                               */ 02830000
*   /* CHECK TR0T FOR REPLACEMENT                            @Y30OE72*/ 02831000
*   /* OF ALL BAD SECTORS.                                   @Y30OE72*/ 02832000
*   /*                                                               */ 02833000
*   /*****************************************************************/ 02834000
*                                                                  0981 02835000
*   IF ERRCOUNT<0 THEN              /* IF # OF DS-CARDS IS   @Y30OE72*/ 02836000
@RF00966 ICM   @12,3,ERRCOUNT                                      0981 02837000
         BNM   @RF00981                                            0981 02838000
*     DO;                           /* > THE NBR OF TRACK 0  @Y30OE72   02839000
*                                      ERRORS, A MESSAGE IS  @Y30OE72   02840000
*                                      ISSUED. SCANAST       @Y30OE72   02841000
*                                      WILL LIST UNREPLACED  @Y30OE72   02842000
*                                      ERRORS, IF ANY.       @Y30OE72*/ 02843000
*       REG1=ADDR(IEB514I);         /* ISSUE                 @Y30OE72*/ 02844000
         LA    REG1,IEB514I                                        0983 02845000
*       MSGLEN=LENGTH(IEB514I);     /* MESSAGE               @Y30OE72*/ 02846000
         MVI   MSGLEN,X'1C'                                        0984 02847000
*       CALL MSGWRTR;               /* IEB514I               @Y30OE72*/ 02848000
         BAL   @14,MSGWRTR                                         0985 02849000
*     END;                          /* END MSG               @Y30OE72*/ 02850000
*   ELSE                            /*                       @Y30OE72*/ 02851000
*     IF ERRCOUNT>0 THEN            /* IF # OF DS-CARDS IS   @Y30OE72*/ 02852000
         B     @RC00981                                            0987 02853000
@RF00981 ICM   @12,3,ERRCOUNT                                      0987 02854000
         BNP   @RF00987                                            0987 02855000
*       DO;                         /* < THE NBR OF TRACK 0  @Y30OE72   02856000
*                                      ERRORS, PUT MSG       @Y30OE72   02857000
*                                      THIS WILL BE          @Y30OE72   02858000
*                                      FOLLOWED BY SCANAST   @Y30OE72*/ 02859000
*         REG1=ADDR(IEB501I);       /* ISSUE                 @Y30OE72*/ 02860000
         LA    REG1,IEB501I                                        0989 02861000
*         MSGLEN=LENGTH(IEB501I);   /* MESSAGE               @Y30OE72*/ 02862000
         MVI   MSGLEN,X'26'                                        0990 02863000
*         CALL MSGWRTR;             /* IEB501I               @Y30OE72*/ 02864000
         BAL   @14,MSGWRTR                                         0991 02865000
*       END;                        /* END MSG               @Y30OE72*/ 02866000
*SCANAST:                           /* LIST ERROR ENTRIES    @Y30OE72*/ 02867000
*   MSGCNT=0;                       /* INITIALIZE MSGCOUNT   @Y30OE72*/ 02868000
@RF00987 DS    0H                                                  0993 02869000
@RC00981 DS    0H                                                  0993 02870000
SCANAST  SLR   @12,@12                                             0993 02871000
         STH   @12,MSGCNT                                          0993 02872000
*   DO E=4 TO 22                    /* SCAN ALL HDR1 ENT IN  @Y30OE72*/ 02873000
*         WHILE PRINTERR=SETOFF;    /*                       @Y30OE72*/ 02874000
         LA    @12,4                                               0994 02875000
         STC   @12,E                                               0994 02876000
@DL00994 TM    PRINTERR,B'00001000'                                0994 02877000
         BNZ   @DC00994                                            0994 02878000
*     IF TR0T(E,63)=CHARAST THEN    /* TR0T FOR * IN COL 63  @Y30OE72*/ 02879000
         LR    @11,@12                                             0995 02880000
         MH    @11,@CH00311                                        0995 02881000
         LA    @15,TR0T-18(@11)                                    0995 02882000
         CLC   0(1,@15),CHARAST                                    0995 02883000
         BNE   @RF00995                                            0995 02884000
*       DO;                         /* AT EVERY OCCURRENCE   @Y30OE72*/ 02885000
*         WORK1=WORK1&&WORK1;       /* INITIALIZE WORKFIELDS @Y30OE72*/ 02886000
         XC    WORK1(4),WORK1                                      0997 02887000
*         WORK2=WORK2&&WORK2;       /*                       @Y30OE72*/ 02888000
         XC    WORK2(4),WORK2                                      0998 02889000
*         WORK1(4)=E-3;             /* CONVERT AND STORE     @Y30OE72*/ 02890000
         SH    @12,@CH00108                                        0999 02891000
         STC   @12,WORK1+3                                         0999 02892000
*         CVD(WORKA,WORK2);         /* TR0T SEQ. NBR         @Y30OE72*/ 02893000
         L     @12,WORKA                                           1000 02894000
         CVD   @12,@TS00001                                        1000 02895000
         MVC   WORK2(4),@TS00001+4                                 1000 02896000
*         GEN(OI    WORK2+3,X'0F'); /* IN                    @Y30OE72*/ 02897000
         OI    WORK2+3,X'0F'                                            02898000
*         UNPK(WORK1,WORK2);        /* MSG                   @Y30OE72*/ 02899000
         UNPK  WORK1(4),WORK2(4)                                   1002 02900000
*         I512HDR#=WORK1(3:4);      /* TEXT                  @Y30OE72*/ 02901000
         MVC   I512HDR#(2),WORK1+2                                 1003 02902000
*         REG1=ADDR(IEB512I);       /* ISSUE                 @Y30OE72*/ 02903000
         LA    REG1,IEB512I                                        1004 02904000
*         MSGLEN=LENGTH(IEB512I);   /* MESSAGE               @Y30OE72*/ 02905000
         MVI   MSGLEN,X'25'                                        1005 02906000
*         CALL MSGWRTR;             /* IEB512I               @Y30OE72*/ 02907000
         BAL   @14,MSGWRTR                                         1006 02908000
*         MSGCNT=MSGCNT+1;          /* ADD 1 TO MSGCOUNT     @Y30OE72*/ 02909000
         LH    @12,MSGCNT                                          1007 02910000
         LA    @12,1(,@12)                                         1007 02911000
         STH   @12,MSGCNT                                          1007 02912000
*       END;                        /* END MSG               @Y30OE72*/ 02913000
*   END;                            /* END SCAN              @Y30OE72*/ 02914000
@RF00995 SLR   @12,@12                                             1009 02915000
         IC    @12,E                                               1009 02916000
         AL    @12,@CF00052                                        1009 02917000
         STC   @12,E                                               1009 02918000
         CH    @12,@CH02322                                        1009 02919000
         BNH   @DL00994                                            1009 02920000
@DC00994 DS    0H                                                  1010 02921000
*   IF ERRCOUNT=0&MSGCNT=0&         /* ANY ERRORS SO FAR     @Y30OE72*/ 02922000
*       HDRCNT>ZERO THEN            /* DATA SETS TO COPY?    @Y30OE72*/ 02923000
         SLR   @12,@12                                             1010 02924000
         CH    @12,ERRCOUNT                                        1010 02925000
         BNE   @RF01010                                            1010 02926000
         CH    @12,MSGCNT                                          1010 02927000
         BNE   @RF01010                                            1010 02928000
         CH    @12,HDRCNT                                          1010 02929000
         BNL   @RF01010                                            1010 02930000
*     CALL CHECKTAB;                /* CHECK FOR OVERLAP     @Y30OE72*/ 02931000
         BAL   @14,CHECKTAB                                        1011 02932000
*   IF ERRCOUNT^=0|MSGCNT^=0|FAILSW=ON THEN/*                @Y30OE72*/ 02933000
@RF01010 SLR   @12,@12                                             1012 02934000
         CH    @12,ERRCOUNT                                        1012 02935000
         BNE   @RT01012                                            1012 02936000
         CH    @12,MSGCNT                                          1012 02937000
         BNE   @RT01012                                            1012 02938000
         CLC   FAILSW(1),ON                                        1012 02939000
         BNE   @RF01012                                            1012 02940000
@RT01012 DS    0H                                                  1013 02941000
*     DO;                           /* IF ANY ERROR IN       @Y30OE72*/ 02942000
*       CALL PRINTTAB;              /* THIS RTN              @Y30OE72*/ 02943000
         BAL   @14,PRINTTAB                                        1014 02944000
*       FAILSW=ON;                  /* PRINT TR0T AND CANCEL @Y30OE72*/ 02945000
         MVC   FAILSW(1),ON                                        1015 02946000
*     END;                          /* END PRINT & CANCEL    @Y30OE72*/ 02947000
*   END TR0BUILD;                   /* RETURN TO MAINLINE    @Y30OE72*/ 02948000
@EL00008 DS    0H                                                  1017 02949000
@EF00008 DS    0H                                                  1017 02950000
@ER00008 L     @14,@SA00008                                        1017 02951000
         BR    @14                                                 1017 02952000
*                                                                  1018 02953000
*/********************************************************************/ 02954000
*/*                                                          @Y30OE72*/ 02955000
*/* ROUTINE NAME = CHECKTAB                                  @Y30OE72*/ 02956000
*/*                                                          @Y30OE72*/ 02957000
*/* FUNCTION = BUILD FILESEQ TABLE (PHYSICAL ORDER OF FILES  @Y30OE72*/ 02958000
*/*            TR0T)                                         @Y30OE72*/ 02959000
*/*            VALIDITY CHECK EXTENTS OF DISKETTE DATA SETS  @Y30OE72*/ 02960000
*/*                                                          @Y30OE72*/ 02961000
*/* INPUT = TR0T (TABLE OF DATA SETS TO BE COPIED)           @Y30OE72*/ 02962000
*/*         TABCNT - COUNT OF ENTRIES IN TR0T                @Y30OE72*/ 02963000
*/*                                                          @Y30OE72*/ 02964000
*/* OUTPUT = FILESEQ TABLE                                   @Y30OE72*/ 02965000
*/*          MSGCNT > 0 IF AN ERROR WAS DETECTED             @Y30OE72*/ 02966000
*/*                                                          @Y30OE72*/ 02967000
*/* ROUTINES CALLED = MSGWRTR - TO WRITE ERROR MESSAGES      @Y30OE72*/ 02968000
*/*                                                          @Y30OE72*/ 02969000
*/* MACROS = NONE                                            @Y30OE72*/ 02970000
*/*                                                          @Y30OE72*/ 02971000
*/********************************************************************/ 02972000
*                                                                  1018 02973000
*CHECKTAB:                          /*                       @Y30OE72*/ 02974000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30OE72*/ 02975000
*                                                                  1018 02976000
CHECKTAB ST    @14,@SA00009                                        1018 02977000
*   /*****************************************************************/ 02978000
*   /*                                                               */ 02979000
*   /* FILL TABLE ABSLEL WITH BOE LIMITS                     @Y30OE72*/ 02980000
*   /* FROM HDRI TABLE TR0T. DELETED ENTRIES ARE SKIPPED     @Y30OE72*/ 02981000
*   /*                                                               */ 02982000
*   /*****************************************************************/ 02983000
*                                                                  1019 02984000
*   Q=ADDR(TR0T)+240;               /* PT Q TO 1ST HDR1 ENT  @Y30OE72*/ 02985000
         LA    Q,TR0T                                              1019 02986000
         AH    Q,@CH03434                                          1019 02987000
*   J=0;                            /* ABSLEL/FILESEQ PTR    @Y30OE72*/ 02988000
         SLR   @12,@12                                             1020 02989000
         ST    @12,J                                               1020 02990000
*   DO I=1 TO TABCNT;               /*                       @Y30OE72*/ 02991000
         LA    @12,1                                               1021 02992000
         B     @DE01021                                            1021 02993000
@DL01021 DS    0H                                                  1022 02994000
*     IF HDRI^=DDRI THEN            /* DELETED ENTRY?        @Y30OE72*/ 02995000
         CLI   HDRI(Q),C'D'                                        1022 02996000
         BE    @RF01022                                            1022 02997000
*       DO;                         /* NO.                   @Y30OE72*/ 02998000
*         J=J+1;                    /* PT TO NEXT TAB ENTRY  @Y30OE72*/ 02999000
         LA    @11,1                                               1024 03000000
         AL    @11,J                                               1024 03001000
         ST    @11,J                                               1024 03002000
*         ABSLEL(J)=LL;             /* BOE INTO TABLE        @Y30OE72*/ 03003000
         LR    @02,@11                                             1025 03004000
         MH    @02,@CH00038                                        1025 03005000
         LA    @15,ABSLEL-5(@02)                                   1025 03006000
         MVC   0(5,@15),LL(Q)                                      1025 03007000
*         FILESEQ(J)=I+2;           /* FILESEQ UPDATED BY    @Y30OE72*/ 03008000
         AH    @12,@CH00070                                        1026 03009000
         STC   @12,FILESEQ-1(@11)                                  1026 03010000
*       END;                        /* ONE AT END OF ROUTINE @Y30OE72*/ 03011000
*     Q=Q+80;                       /* UPDATE TR0T PTR       @Y30OE72*/ 03012000
@RF01022 AL    Q,@CF00311                                          1028 03013000
*   END;                            /*                       @Y30OE72*/ 03014000
         LA    @12,1                                               1029 03015000
         AL    @12,I                                               1029 03016000
@DE01021 ST    @12,I                                               1029 03017000
         CH    @12,TABCNT                                          1029 03018000
         BNH   @DL01021                                            1029 03019000
*   RLCNT=J;                        /* # REAL HDR1 ENTRIES   @Y30OE72*/ 03020000
         MVC   RLCNT(1),J+3                                        1030 03021000
*                                                                  1031 03022000
*   /*****************************************************************/ 03023000
*   /*                                                               */ 03024000
*   /* NEXT ROUTINE SORTS ABSLEL TABLE AND BUILDS FILESEQ    @Y30OE72*/ 03025000
*   /*                                                               */ 03026000
*   /*****************************************************************/ 03027000
*                                                                  1031 03028000
*   SW=ON;                          /* INIT LOOP CONTROL     @Y30OE72*/ 03029000
         MVC   SW(1),ON                                            1031 03030000
*   DO I=1 TO RLCNT-1 WHILE(SW=ON); /* LOOP UNTIL TABLE IS   @Y30OE72*/ 03031000
         LA    @12,1                                               1032 03032000
         B     @DE01032                                            1032 03033000
@DL01032 CLC   SW(1),ON                                            1032 03034000
         BNE   @DC01032                                            1032 03035000
*     SW=OFF;                       /* SORTED                @Y30OE72*/ 03036000
         MVC   SW(1),OFF                                           1033 03037000
*     DO J=1 TO RLCNT-I;            /* SORT TABLE            @Y30OE72*/ 03038000
         LA    @12,1                                               1034 03039000
         B     @DE01034                                            1034 03040000
@DL01034 DS    0H                                                  1035 03041000
*       IF ABSLEL(J)>ABSLEL(J+1) THEN/* IF 1ST ENTRY         @Y30OE72*/ 03042000
         LR    @11,@12                                             1035 03043000
         MH    @11,@CH00038                                        1035 03044000
         LA    @15,ABSLEL-5(@11)                                   1035 03045000
         LA    @14,ABSLEL(@11)                                     1035 03046000
         CLC   0(5,@15),0(@14)                                     1035 03047000
         BNH   @RF01035                                            1035 03048000
*         DO;                       /* LARGER THAN 2ND       @Y30OE72*/ 03049000
*           SAVEFLD=ABSLEL(J);      /* ENTRY, THEN           @Y30OE72*/ 03050000
         LA    @02,ABSLEL-5(@11)                                   1037 03051000
         MVC   SAVEFLD(5),0(@02)                                   1037 03052000
*           ABSLEL(J)=ABSLEL(J+1);  /* FLIP                  @Y30OE72*/ 03053000
         LA    @02,ABSLEL-5(@11)                                   1038 03054000
         LA    @15,ABSLEL(@11)                                     1038 03055000
         MVC   0(5,@02),0(@15)                                     1038 03056000
*           ABSLEL(J+1)=SAVEFLD;    /* ENTRIES.              @Y30OE72*/ 03057000
         LA    @02,ABSLEL(@11)                                     1039 03058000
         MVC   0(5,@02),SAVEFLD                                    1039 03059000
*           SAVE1=FILESEQ(J);       /* FLIP                  @Y30OE72*/ 03060000
         SLR   SAVE1,SAVE1                                         1040 03061000
         IC    SAVE1,FILESEQ-1(@12)                                1040 03062000
*           FILESEQ(J)=FILESEQ(J+1);/* SEQUENCE TABLE        @Y30OE72*/ 03063000
         SLR   @11,@11                                             1041 03064000
         IC    @11,FILESEQ(@12)                                    1041 03065000
         STC   @11,FILESEQ-1(@12)                                  1041 03066000
*           FILESEQ(J+1)=SAVE1;     /* ENTRIES               @Y30OE72*/ 03067000
         STC   SAVE1,FILESEQ(@12)                                  1042 03068000
*           SW=ON;                  /* STAY IN LOOP          @Y30OE72*/ 03069000
         MVC   SW(1),ON                                            1043 03070000
*         END;                      /*                       @Y30OE72*/ 03071000
*     END;                          /*                       @Y30OE72*/ 03072000
@RF01035 LA    @12,1                                               1045 03073000
         AL    @12,J                                               1045 03074000
@DE01034 ST    @12,J                                               1045 03075000
         SLR   @11,@11                                             1045 03076000
         IC    @11,RLCNT                                           1045 03077000
         SL    @11,I                                               1045 03078000
         CR    @12,@11                                             1045 03079000
         BNH   @DL01034                                            1045 03080000
*   END;                            /*                       @Y30OE72*/ 03081000
         LA    @12,1                                               1046 03082000
         AL    @12,I                                               1046 03083000
@DE01032 ST    @12,I                                               1046 03084000
         SLR   @11,@11                                             1046 03085000
         IC    @11,RLCNT                                           1046 03086000
         BCTR  @11,0                                               1046 03087000
         CR    @12,@11                                             1046 03088000
         BNH   @DL01032                                            1046 03089000
@DC01032 DS    0H                                                  1047 03090000
*                                                                  1047 03091000
*   /*****************************************************************/ 03092000
*   /*                                                               */ 03093000
*   /* THIS ROUTINE CHECKS FOR VALID EXTENTS ON DIFFERENT    @Y30OE72*/ 03094000
*   /* DATA SETS. IF SO, A MESSAGE IS GIVEN AND THE          @Y30OE72*/ 03095000
*   /* JOB IS CANCELED                                       @Y30OE72*/ 03096000
*   /*                                                               */ 03097000
*   /*****************************************************************/ 03098000
*                                                                  1047 03099000
*   REG1=ADDR(IEB507I);             /* INIT FOR MESSAGE      @Y30OE72*/ 03100000
         LA    REG1,IEB507I                                        1047 03101000
*   Q=ADDR(TR0T)+80*FILESEQ(1);     /* PT Q TO LOWEST ENTRY  @Y30OE72*/ 03102000
         LA    Q,TR0T                                              1048 03103000
         SLR   @12,@12                                             1048 03104000
         IC    @12,FILESEQ                                         1048 03105000
         MH    @12,@CH00311                                        1048 03106000
         ALR   Q,@12                                               1048 03107000
*   IF LOW>LL THEN                  /* IF LOWEST EXTENT IS   @Y30OE72*/ 03108000
         CLC   LOW(5),LL(Q)                                        1049 03109000
         BNH   @RF01049                                            1049 03110000
*     DO;                           /* LESS THAN 01001       @Y30OE72   03111000
*                                      THEN ISSUE MSG        @Y30OE72*/ 03112000
*       I507DS#=PRTNRS(1);          /* DATA SET NUMBER       @Y30OE72*/ 03113000
         MVC   I507DS#(2),PRTNRS                                   1051 03114000
*       REG1=ADDR(IEB507I);         /* ISSUE                 @Y30OE72*/ 03115000
         LA    REG1,IEB507I                                        1052 03116000
*       MSGLEN=LENGTH(IEB507I);     /* MESSAGE               @Y30OE72*/ 03117000
         MVI   MSGLEN,X'1B'                                        1053 03118000
*       CALL MSGWRTR;               /* IEB507I               @Y30OE72*/ 03119000
         BAL   @14,MSGWRTR                                         1054 03120000
*       MSGCNT=MSGCNT+1;            /* SET ERROR INDICATOR   @Y30OE72*/ 03121000
         LH    @12,MSGCNT                                          1055 03122000
         LA    @12,1(,@12)                                         1055 03123000
         STH   @12,MSGCNT                                          1055 03124000
*     END;                          /*                       @Y30OE72*/ 03125000
*   DO I=1 TO RLCNT-1;              /* IF EXTENT UPPER LIMIT @Y30OE72*/ 03126000
@RF01049 LA    @12,1                                               1057 03127000
         B     @DE01057                                            1057 03128000
@DL01057 DS    0H                                                  1058 03129000
*     Q=ADDR(TR0T)+80*FILESEQ(I+1); /* FROM ONE EXTENT IS    @Y30OE72*/ 03130000
         LA    @11,TR0T                                            1058 03131000
         LA    @15,80                                              1058 03132000
         SLR   Q,Q                                                 1058 03133000
         IC    Q,FILESEQ(@12)                                      1058 03134000
         MR    @02,@15                                             1058 03135000
         ALR   Q,@11                                               1058 03136000
*     P=ADDR(TR0T)+80*FILESEQ(I);   /* HIGHER THEN EXTENT LL @Y30OE72*/ 03137000
         SLR   @02,@02                                             1059 03138000
         IC    @02,FILESEQ-1(@12)                                  1059 03139000
         MR    @14,@02                                             1059 03140000
         ALR   @11,@15                                             1059 03141000
         ST    @11,P                                               1059 03142000
*     IF UL>=LL THEN                /* OF NEXT HIGHER EXTENT @Y30OE72*/ 03143000
         CLC   UL(5,@11),LL(Q)                                     1060 03144000
         BL    @RF01060                                            1060 03145000
*       DO;                         /*                       @Y30OE72*/ 03146000
*         I507DS#=PRTNRS(FILESEQ(I)-2);/* DATA SET #         @Y30OE72*/ 03147000
         ALR   @02,@02                                             1062 03148000
         LA    @12,PRTNRS-6(@02)                                   1062 03149000
         MVC   I507DS#(2),0(@12)                                   1062 03150000
*         REG1=ADDR(IEB507I);       /* ISSUE                 @Y30OE72*/ 03151000
         LA    REG1,IEB507I                                        1063 03152000
*         MSGLEN=LENGTH(IEB507I);   /* MESSAGE               @Y30OE72*/ 03153000
         MVI   MSGLEN,X'1B'                                        1064 03154000
*         CALL MSGWRTR;             /* IEB507I               @Y30OE72*/ 03155000
         BAL   @14,MSGWRTR                                         1065 03156000
*         MSGCNT=MSGCNT+1;          /* SET ERROR INDICATOR   @Y30OE72*/ 03157000
         LH    @12,MSGCNT                                          1066 03158000
         LA    @12,1(,@12)                                         1066 03159000
         STH   @12,MSGCNT                                          1066 03160000
*       END;                        /*                       @Y30OE72*/ 03161000
*   END;                            /*                       @Y30OE72*/ 03162000
@RF01060 LA    @12,1                                               1068 03163000
         AL    @12,I                                               1068 03164000
@DE01057 ST    @12,I                                               1068 03165000
         SLR   @11,@11                                             1068 03166000
         IC    @11,RLCNT                                           1068 03167000
         BCTR  @11,0                                               1068 03168000
         CR    @12,@11                                             1068 03169000
         BNH   @DL01057                                            1068 03170000
*   P=ADDR(TR0T)+80*FILESEQ(RLCNT); /* PT TO LAST ENT        @Y30OE72*/ 03171000
         LA    @12,TR0T                                            1069 03172000
         SLR   @11,@11                                             1069 03173000
         IC    @11,RLCNT                                           1069 03174000
         SLR   @00,@00                                             1069 03175000
         IC    @00,FILESEQ-1(@11)                                  1069 03176000
         MH    @00,@CH00311                                        1069 03177000
         ALR   @12,@00                                             1069 03178000
         ST    @12,P                                               1069 03179000
*   IF UL>=HIG THEN                 /* IF EOE >= 74001       @Y30OE72*/ 03180000
         CLC   UL(5,@12),HIG                                       1070 03181000
         BL    @RF01070                                            1070 03182000
*     DO;                           /*                       @Y30OE72*/ 03183000
*       I507DS#=PRTNRS(RLCNT);      /*                       @Y30OE72*/ 03184000
         ALR   @11,@11                                             1072 03185000
         LA    @12,PRTNRS-2(@11)                                   1072 03186000
         MVC   I507DS#(2),0(@12)                                   1072 03187000
*       REG1=ADDR(IEB507I);         /* ISSUE                 @Y30OE72*/ 03188000
         LA    REG1,IEB507I                                        1073 03189000
*       MSGLEN=LENGTH(IEB507I);     /* MESSAGE               @Y30OE72*/ 03190000
         MVI   MSGLEN,X'1B'                                        1074 03191000
*       CALL MSGWRTR;               /* IEB507I               @Y30OE72*/ 03192000
         BAL   @14,MSGWRTR                                         1075 03193000
*       MSGCNT=MSGCNT+1;            /* SET ERROR INDICATOR   @Y30OE72*/ 03194000
         LH    @12,MSGCNT                                          1076 03195000
         LA    @12,1(,@12)                                         1076 03196000
         STH   @12,MSGCNT                                          1076 03197000
*     END;                          /*                       @Y30OE72*/ 03198000
*   DO I=1 TO RLCNT;                /*                       @Y30OE72*/ 03199000
@RF01070 LA    @12,1                                               1078 03200000
         B     @DE01078                                            1078 03201000
@DL01078 DS    0H                                                  1079 03202000
*     FILESEQ(I)=FILESEQ(I)+1;      /* ADD 1 TO GET CORRECT  @Y30OE72*/ 03203000
         LA    @11,1                                               1079 03204000
         SLR   @00,@00                                             1079 03205000
         IC    @00,FILESEQ-1(@12)                                  1079 03206000
         ALR   @11,@00                                             1079 03207000
         STC   @11,FILESEQ-1(@12)                                  1079 03208000
*   END;                            /* NUMBERS               @Y30OE72*/ 03209000
         AL    @12,@CF00052                                        1080 03210000
@DE01078 ST    @12,I                                               1080 03211000
         SLR   @11,@11                                             1080 03212000
         IC    @11,RLCNT                                           1080 03213000
         CR    @12,@11                                             1080 03214000
         BNH   @DL01078                                            1080 03215000
*   IF MSGCNT=ZERO THEN             /* IF OK SO FAR          @Y30OE72*/ 03216000
         ICM   @12,3,MSGCNT                                        1081 03217000
         BNZ   @RF01081                                            1081 03218000
*     DO F=1 TO 19                  /* CHK EXTENT            @Y30OE72*/ 03219000
*           WHILE(FILESEQ(F)^=AST2);/* VALIDITY              @Y30OE72*/ 03220000
         LA    @12,1                                               1082 03221000
         STC   @12,F                                               1082 03222000
@DL01082 SLR   @11,@11                                             1082 03223000
         IC    @11,FILESEQ-1(@12)                                  1082 03224000
         SLR   @12,@12                                             1082 03225000
         IC    @12,AST2                                            1082 03226000
         CR    @11,@12                                             1082 03227000
         BE    @DC01082                                            1082 03228000
*       E=FILESEQ(F);               /* TR0T INDEX            @Y30OE72*/ 03229000
         STC   @11,E                                               1083 03230000
*       TEMPBOE=TR0TBOE(E);         /* BOE INTO WORK AREA    @Z30OE72*/ 03231000
         MH    @11,@CH00311                                        1084 03232000
         LA    @12,TR0TBOE-80(@11)                                 1084 03233000
         MVC   TEMPBOE(5),0(@12)                                   1084 03234000
*       TEMPEOE=TR0TEOE(E);         /* EOE INTO WORK AREA    @Z30OE72*/ 03235000
         LA    @12,TR0TEOE-80(@11)                                 1085 03236000
         MVC   TEMPEOE(5),0(@12)                                   1085 03237000
*       TEMPEOD=TR0TEOD(E);         /* EOD INTO WORK AREA    @Z30OE72*/ 03238000
         LA    @12,TR0TEOD-80(@11)                                 1086 03239000
         MVC   TEMPEOD(5),0(@12)                                   1086 03240000
*       LETPTR=ADDR(TEMPEXT);       /* PT TO 1ST EXTENT CHAR @Z30OE72*/ 03241000
         LA    LETPTR,TEMPEXT                                      1087 03242000
*       DO I=1 TO 15                /* CHECK BOE,EOE,EOD     @Z30OE72*/ 03243000
*             WHILE SW507I=SETOFF;  /* EXTENTS               @Z30OE72*/ 03244000
         LA    @12,1                                               1088 03245000
         ST    @12,I                                               1088 03246000
@DL01088 TM    SW507I,B'00100000'                                  1088 03247000
         BNZ   @DC01088                                            1088 03248000
*         IF^(LETTER>=CHAR0&        /* CHARS FOR             @Z30OE72*/ 03249000
*             LETTER<=CHAR9) THEN   /* NUMERICS              @Z30OE72*/ 03250000
         CLI   LETTER(LETPTR),C'0'                                 1089 03251000
         BL    @RT01089                                            1089 03252000
         CLI   LETTER(LETPTR),C'9'                                 1089 03253000
         BNH   @RF01089                                            1089 03254000
@RT01089 DS    0H                                                  1090 03255000
*           SW507I=ERRON;           /* NOT NUMERIC, FAIL     @Z30OE72*/ 03256000
         OI    SW507I,B'00100000'                                  1090 03257000
*         LETPTR=LETPTR+1;          /* PT TO NEXT CHAR       @Z30OE72*/ 03258000
@RF01089 AL    LETPTR,@CF00052                                     1091 03259000
*       END;                        /*                       @Z30OE72*/ 03260000
         LA    @12,1                                               1092 03261000
         AL    @12,I                                               1092 03262000
         ST    @12,I                                               1092 03263000
         CH    @12,@CH00058                                        1092 03264000
         BNH   @DL01088                                            1092 03265000
@DC01088 DS    0H                                                  1093 03266000
*       IF SW507I=SETOFF THEN       /* IF ALL NUMERIC        @Z30OE72*/ 03267000
         TM    SW507I,B'00100000'                                  1093 03268000
         BNZ   @RF01093                                            1093 03269000
*         CALL WRKTABLE;            /* BOE,EOE,EOD INTO      #Y30OE72   03270000
*                                      DS TABLE              @Y30OE72*/ 03271000
         BAL   @14,WRKTABLE                                        1094 03272000
*       IF DSBOESEC<SECTOR1|        /* VERIFY                @Y30OE72*/ 03273000
*           DSBOESEC>SECTOR26|      /* SECTOR                @Y30OE72*/ 03274000
*           DSEOESEC<SECTOR1|       /* NUMBERS               @Y30OE72*/ 03275000
*           DSEOESEC>SECTOR26|      /* GT 0                  @Y30OE72*/ 03276000
*           DSEODSEC<SECTOR1|       /* AND                   @Y30OE72*/ 03277000
*           DSEODSEC>SECTOR26 THEN  /* LT 27                 @Y30OE72*/ 03278000
@RF01093 CLC   DSBOESEC(1),SECTOR1                                 1095 03279000
         BL    @RT01095                                            1095 03280000
         CLI   DSBOESEC,26                                         1095 03281000
         BH    @RT01095                                            1095 03282000
         CLC   DSEOESEC(1),SECTOR1                                 1095 03283000
         BL    @RT01095                                            1095 03284000
         CLI   DSEOESEC,26                                         1095 03285000
         BH    @RT01095                                            1095 03286000
         CLC   DSEODSEC(1),SECTOR1                                 1095 03287000
         BL    @RT01095                                            1095 03288000
         CLI   DSEODSEC,26                                         1095 03289000
         BNH   @RF01095                                            1095 03290000
@RT01095 DS    0H                                                  1096 03291000
*         SW507I=ERRON;             /* NO. FAIL              @Y30OE72*/ 03292000
         OI    SW507I,B'00100000'                                  1096 03293000
*       IF EODABS<BOEABS THEN       /* EOD < BOE?            @Y30OE72*/ 03294000
@RF01095 LH    @12,EODABS                                          1097 03295000
         CH    @12,BOEABS                                          1097 03296000
         BNL   @RF01097                                            1097 03297000
*         SW507I=ERRON;             /* YES. FAIL             @Y30OE72*/ 03298000
         OI    SW507I,B'00100000'                                  1098 03299000
*       ELSE                        /*                       @Y30OE72*/ 03300000
*         IF EODABS>(EOEABS+1) THEN /* EOD TOO BIG?          @Y30OE72*/ 03301000
         B     @RC01097                                            1099 03302000
@RF01097 LA    @12,1                                               1099 03303000
         AH    @12,EOEABS                                          1099 03304000
         CH    @12,EODABS                                          1099 03305000
         BNL   @RF01099                                            1099 03306000
*           SW507I=ERRON;           /* YES. FAIL             @Y30OE72*/ 03307000
         OI    SW507I,B'00100000'                                  1100 03308000
*       IF TR0TBOE0(E)^=FOXZERO|    /* H MUST = 0            @Y30OE72*/ 03309000
*           TR0TEOE0(E)^=FOXZERO|   /* H MUST = 0            @Y30OE72*/ 03310000
*           TR0TEOD0(E)^=FOXZERO THEN/* H MUST = 0           @Y30OE72*/ 03311000
@RF01099 DS    0H                                                  1101 03312000
@RC01097 SLR   @12,@12                                             1101 03313000
         IC    @12,E                                               1101 03314000
         MH    @12,@CH00311                                        1101 03315000
         LA    @11,TR0TBOE0-80(@12)                                1101 03316000
         CLI   0(@11),X'F0'                                        1101 03317000
         BNE   @RT01101                                            1101 03318000
         LA    @11,TR0TEOE0-80(@12)                                1101 03319000
         CLI   0(@11),X'F0'                                        1101 03320000
         BNE   @RT01101                                            1101 03321000
         LA    @11,TR0TEOD0-80(@12)                                1101 03322000
         CLI   0(@11),X'F0'                                        1101 03323000
         BE    @RF01101                                            1101 03324000
@RT01101 DS    0H                                                  1102 03325000
*         SW507I=ERRON;             /* IF NOT. FAIL          @Y30OE72*/ 03326000
         OI    SW507I,B'00100000'                                  1102 03327000
*       IF SW507I=SETON THEN        /* INVALID EXTENTS?      @Y30OE72*/ 03328000
@RF01101 TM    SW507I,B'00100000'                                  1103 03329000
         BNO   @RF01103                                            1103 03330000
*         DO;                       /* YES.                  @Y30OE72*/ 03331000
*           I507DS#=PRTNRS(E-3);    /* DATA SET NUMBER       @Y30OE72*/ 03332000
         SLR   @12,@12                                             1105 03333000
         IC    @12,E                                               1105 03334000
         ALR   @12,@12                                             1105 03335000
         LA    @11,PRTNRS-8(@12)                                   1105 03336000
         MVC   I507DS#(2),0(@11)                                   1105 03337000
*           REG1=ADDR(IEB507I);     /* ISSUE                 @Y30OE72*/ 03338000
         LA    REG1,IEB507I                                        1106 03339000
*           MSGLEN=LENGTH(IEB507I); /* MESSAGE               @Y30OE72*/ 03340000
         MVI   MSGLEN,X'1B'                                        1107 03341000
*           CALL MSGWRTR;           /* IEB507I               @Y30OE72*/ 03342000
         BAL   @14,MSGWRTR                                         1108 03343000
*           MSGCNT=MSGCNT+1;        /* SET ERROR INDICATOR   @Y30OE72*/ 03344000
         LH    @12,MSGCNT                                          1109 03345000
         LA    @12,1(,@12)                                         1109 03346000
         STH   @12,MSGCNT                                          1109 03347000
*           SW507I=SETOFF;          /* RESET MSG SWITCH      @Z30OE72*/ 03348000
         NI    SW507I,B'11011111'                                  1110 03349000
*         END;                      /*                       @Y30OE72*/ 03350000
*     END;                          /*                       @Y30OE72*/ 03351000
@RF01103 LA    @12,1                                               1112 03352000
         SLR   @11,@11                                             1112 03353000
         IC    @11,F                                               1112 03354000
         ALR   @12,@11                                             1112 03355000
         STC   @12,F                                               1112 03356000
         CH    @12,@CH02061                                        1112 03357000
         BNH   @DL01082                                            1112 03358000
@DC01082 DS    0H                                                  1113 03359000
*   END CHECKTAB;                   /*                       @Y30OE72*/ 03360000
@EL00009 DS    0H                                                  1113 03361000
@EF00009 DS    0H                                                  1113 03362000
@ER00009 L     @14,@SA00009                                        1113 03363000
         BR    @14                                                 1113 03364000
*                                                                  1114 03365000
*/********************************************************************/ 03366000
*/*                                                          @Y30OE72*/ 03367000
*/* ROUTINE NAME = VOLCHECK                                  @Y30OE72*/ 03368000
*/*                                                          @Y30OE72*/ 03369000
*/* FUNCTION = VALIDITY CHECK A DISKETTE VOLID               @Y30OE72*/ 03370000
*/*                                                          @Y30OE72*/ 03371000
*/* INPUT = VOLID IN VOLAREA                                 @Y30OE72*/ 03372000
*/*                                                          @Y30OE72*/ 03373000
*/* OUTPUT = BADVOLID SWITCH ON IF VOLID WAS INVALID         @Y30OE72*/ 03374000
*/*                                                          @Y30OE72*/ 03375000
*/* MACROS = NONE                                            @Y30OE72*/ 03376000
*/*                                                          @Y30OE72*/ 03377000
*/********************************************************************/ 03378000
*                                                                  1114 03379000
*VOLCHECK:                          /*                       @Y30OE72*/ 03380000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30OE72*/ 03381000
VOLCHECK ST    @14,12(,@13)                                        1114 03382000
*   DO I=1 TO 6                     /* CHECK VOLID           @Y30OE72*/ 03383000
*         WHILE(LETTER^=BLANK(1)&   /* FOR ALPHAMERIC        @Y30OE72*/ 03384000
*         BADVOLID=SETOFF);         /* CHARACTERS            @Y30OE72*/ 03385000
         LA    @12,1                                               1115 03386000
         ST    @12,I                                               1115 03387000
@DL01115 CLC   LETTER(1,LETPTR),BLANK                              1115 03388000
         BE    @DC01115                                            1115 03389000
         TM    BADVOLID,B'00000010'                                1115 03390000
         BNZ   @DC01115                                            1115 03391000
*     IF^((LETTER>=CHARA&           /*                       @Y30OE72*/ 03392000
*         LETTER<=CHARI)|           /*                       @Y30OE72*/ 03393000
*         (LETTER>=CHARJ&           /*                       @Y30OE72*/ 03394000
*         LETTER<=CHARR)|           /*                       @Y30OE72*/ 03395000
*         (LETTER>=CHARS&           /*                       @Y30OE72*/ 03396000
*         LETTER<=CHARZ)|           /*                       @Y30OE72*/ 03397000
*         (LETTER>=CHAR0&           /*                       @Y30OE72*/ 03398000
*         LETTER<=CHAR9))           /*                       @Y30OE72*/ 03399000
*       THEN                        /* INVALID CHARS         @Y30OE72*/ 03400000
         CLI   LETTER(LETPTR),C'A'                                 1116 03401000
         BL    @GL00082                                            1116 03402000
         CLI   LETTER(LETPTR),C'I'                                 1116 03403000
         BNH   @RF01116                                            1116 03404000
@GL00082 CLI   LETTER(LETPTR),C'J'                                 1116 03405000
         BL    @GL00081                                            1116 03406000
         CLI   LETTER(LETPTR),C'R'                                 1116 03407000
         BNH   @RF01116                                            1116 03408000
@GL00081 CLI   LETTER(LETPTR),C'S'                                 1116 03409000
         BL    @GL00080                                            1116 03410000
         CLI   LETTER(LETPTR),C'Z'                                 1116 03411000
         BNH   @RF01116                                            1116 03412000
@GL00080 CLI   LETTER(LETPTR),C'0'                                 1116 03413000
         BL    @RT01116                                            1116 03414000
         CLI   LETTER(LETPTR),C'9'                                 1116 03415000
         BNH   @RF01116                                            1116 03416000
@RT01116 DS    0H                                                  1117 03417000
*       BADVOLID=ERRON;             /* TERMINATE RUN         @Y30OE72*/ 03418000
         OI    BADVOLID,B'00000010'                                1117 03419000
*     ELSE                          /*                       @Y30OE72*/ 03420000
*       LETPTR=LETPTR+1;            /* POINT TO NEXT CHAR    @Y30OE72*/ 03421000
         B     @RC01116                                            1118 03422000
@RF01116 AL    LETPTR,@CF00052                                     1118 03423000
*   END;                            /* END VOLID CHKING      @Y30OE72*/ 03424000
@RC01116 LA    @12,1                                               1119 03425000
         AL    @12,I                                               1119 03426000
         ST    @12,I                                               1119 03427000
         CH    @12,@CH00032                                        1119 03428000
         BNH   @DL01115                                            1119 03429000
@DC01115 DS    0H                                                  1120 03430000
*   IF BADVOLID=SETOFF&             /* NO BAD CHARS&         @Y30OE72*/ 03431000
*       LETPTR<ADDR(VOLAREA)+6 THEN /* VOLID LT 6 CHARS?     @Y30OE72*/ 03432000
         TM    BADVOLID,B'00000010'                                1120 03433000
         BNZ   @RF01120                                            1120 03434000
         LA    @12,6                                               1120 03435000
         LA    @11,VOLAREA                                         1120 03436000
         ALR   @11,@12                                             1120 03437000
         CR    LETPTR,@11                                          1120 03438000
         BNL   @RF01120                                            1120 03439000
*     IF VOLAREA(I+1:6)^=BLANK(1:6-I) THEN/* YES. CHK        @Y30OE72   03440000
*                                      EMBEDDED BLANKS       @Y30OE72*/ 03441000
         L     @11,I                                               1121 03442000
         SLR   @12,@11                                             1121 03443000
         BCTR  @12,0                                               1121 03444000
         LA    @15,VOLAREA(@11)                                    1121 03445000
         EX    @12,@SC03562                                        1121 03446000
         BE    @RF01121                                            1121 03447000
*       BADVOLID=ERRON;             /* YES. BAD VOL1         @Y30OE72*/ 03448000
         OI    BADVOLID,B'00000010'                                1122 03449000
*   END VOLCHECK;                   /*                       @Y30OE72*/ 03450000
@EL00010 DS    0H                                                  1123 03451000
@EF00010 DS    0H                                                  1123 03452000
@ER00010 L     @14,12(,@13)                                        1123 03453000
         BR    @14                                                 1123 03454000
*                                                                  1124 03455000
*/********************************************************************/ 03456000
*/*                                                          @Y30OE72*/ 03457000
*/* ROUTINE NAME = SECURCHK                                  @Y30OE72*/ 03458000
*/*                                                          @Y30OE72*/ 03459000
*/* FUNCTION = PROCESS SECURE DISKETTES BY ISSUEING A WTOR   @Y30OE72*/ 03460000
*/*            TO THE OPERATOR (IEB5I8A).                    @Y30OE72*/ 03461000
*/*                                                          @Y30OE72*/ 03462000
*/* INPUT = OUTSW SWITCH ON IF PROCESSING OUTPUT DISKETTE    @Y30OE72*/ 03463000
*/*                                                          @Y30OE72*/ 03464000
*/* OUTPUT = SWITCH SETTINGS:                                @Y30OE72*/ 03465000
*/*            USEVOL - ON = OPR SUPPLIED CORRECT QUALIFIER  @Y30OE72*/ 03466000
*/*            RETRYSW - ON = RETRY ON DISKETTE NOW MOUNTED  @Y30OE72*/ 03467000
*/*                           (OUTPUT ONLY)                  @Y30OE72*/ 03468000
*/*            CANCELED - OPR EITHER REPLIED CANCEL OR       @Y30OE72*/ 03469000
*/*                       FAILED IN 3 TRIES TO SUPPLY THE    @Y30OE72*/ 03470000
*/*                       QUALIFIER                          @Y30OE72*/ 03471000
*/*            FAILSW - ON = TERMINATE RUN                   @Y30OE72*/ 03472000
*/*                                                          @Y30OE72*/ 03473000
*/* ROUTINES CALLED = MSGWRTR - TO ISSUE IEB518A             @Y30OE72*/ 03474000
*/*                                                          @Y30OE72*/ 03475000
*/* MACROS = NONE                                            @Y30OE72*/ 03476000
*/*                                                          @Y30OE72*/ 03477000
*/********************************************************************/ 03478000
*                                                                  1124 03479000
*SECURCHK:                          /*                       @Y30OE72*/ 03480000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30OE72*/ 03481000
SECURCHK ST    @14,@SA00011                                        1124 03482000
*   USEVOL=SETOFF;                  /* INIT SWITCH           @Y30OE72*/ 03483000
         NI    USEVOL,B'11111011'                                  1125 03484000
*   DO I=1 TO 3                     /* YES. GIVE OPR 3 TRIES @Y30OE72*/ 03485000
*         WHILE REPEATSW=ON;        /* TO SUPPLY VOL ACC IND @Y30OE72*/ 03486000
         LA    @12,1                                               1126 03487000
         ST    @12,I                                               1126 03488000
@DL01126 CLC   REPEATSW(1),ON                                      1126 03489000
         BNE   @DC01126                                            1126 03490000
*     REPEATSW=OFF;                 /* RESET LOOP CONTROL    @Y30OE72*/ 03491000
         MVC   REPEATSW(1),OFF                                     1127 03492000
*     REG1=ADDR(IEB518A);           /* SET UP FOR WTOR       @Y30OE72*/ 03493000
         LA    REG1,IEB518A                                        1128 03494000
*     MSGTYPE=ACTION;               /* OF IEB518A            @Y30OE72*/ 03495000
         MVI   MSGTYPE,C'A'                                        1129 03496000
*     IF OUTSW=SETON THEN           /* CHKING OUTPUT DSKT?   @Y30OE72*/ 03497000
         TM    OUTSW,B'01000000'                                   1130 03498000
         BNO   @RF01130                                            1130 03499000
*       DO;                         /* YES.                  @Y30OE72*/ 03500000
*         IF MODESW=ONE3540 THEN    /* IF OUTPUT DISKETTE    @Y30OE72*/ 03501000
         CLI   MODESW,1                                            1132 03502000
         BNE   @RF01132                                            1132 03503000
*           TIOTADDR=WORKSYS1;      /* ON SYSUT1, POINT TO   @Y30OE72   03504000
*                                      SYSUT1 TIOT ENTRY     @Y30OE72*/ 03505000
         SLR   @12,@12                                             1133 03506000
         ICM   @12,7,WORKSYS1                                      1133 03507000
         ST    @12,TIOTADDR                                        1133 03508000
*         ELSE                      /* NO. THEN              @Y30OE72*/ 03509000
*           TIOTADDR=WORKSYS2;      /* POINT TO              @Y30OE72   03510000
*                                      SYSUT2 TIOT ENTRY     @Y30OE72*/ 03511000
         B     @RC01132                                            1134 03512000
@RF01132 SLR   @12,@12                                             1134 03513000
         ICM   @12,7,WORKSYS2                                      1134 03514000
         ST    @12,TIOTADDR                                        1134 03515000
*         I518INOT=OUTPUT;          /* OUTPUT CONSTANT       @Y30OE72*/ 03516000
@RC01132 MVC   I518INOT(6,REG1),@CC02095                           1135 03517000
*       END;                        /*                       @Y30OE72*/ 03518000
*     ELSE                          /* INPUT DISKETTE        @Y30OE72*/ 03519000
*       TIOTADDR=WORKSYS1;          /* PT TO SYSUT1 TIOT ENT @Y30OE72*/ 03520000
         B     @RC01130                                            1137 03521000
@RF01130 SLR   @12,@12                                             1137 03522000
         ICM   @12,7,WORKSYS1                                      1137 03523000
         ST    @12,TIOTADDR                                        1137 03524000
*     I518DEV=UCBNAME;              /* PUT DEV @ IN MSG      @Y30OE72*/ 03525000
@RC01130 L     @12,TIOTADDR                                        1138 03526000
         ICM   @11,7,TIOEFSRT(@12)                                 1138 03527000
         MVC   I518DEV(3,REG1),UCBNAME(@11)                        1138 03528000
*     CALL MSGWRTR;                 /* ISSUE IEB518A         @Y30OE72*/ 03529000
         BAL   @14,MSGWRTR                                         1139 03530000
*     IF REPLY=CANCEL1 THEN         /* DID HE CANCEL JOB?    @Y30OE72*/ 03531000
         CLC   REPLY(5),@CC02175                                   1140 03532000
         BNE   @RF01140                                            1140 03533000
*       DO;                         /* YES.                  @Y30OE72*/ 03534000
*         CANCELED=SETON;           /* IND OPR CANCELED      @Y30OE72*/ 03535000
         OI    CANCELED,B'10000000'                                1142 03536000
*         FAILSW=ON;                /* TERMINATE RUN         @Y30OE72*/ 03537000
         MVC   FAILSW(1),ON                                        1143 03538000
*       END;                        /*                       @Y30OE72*/ 03539000
*     ELSE                          /* NO. DID HE SUPPLY     @Y30OE72*/ 03540000
*       IF REPLY(1)=RECBUF(11)&     /* CORRECT QUAL?         @Y30OE72*/ 03541000
*           REPLY(2:5)=BLANK(1:4) THEN/*                     @Y30OE72*/ 03542000
         B     @RC01140                                            1145 03543000
@RF01140 L     @12,IOBPTR                                          1145 03544000
         ICM   @11,7,CCWRDADD(@12)                                 1145 03545000
         CLC   REPLY(1),RECBUF+10(@11)                             1145 03546000
         BNE   @RF01145                                            1145 03547000
         CLC   REPLY+1(4),BLANK                                    1145 03548000
         BNE   @RF01145                                            1145 03549000
*         USEVOL=SETON;             /* YES. USE DSKT         @Y30OE72*/ 03550000
         OI    USEVOL,B'00000100'                                  1146 03551000
*       ELSE                        /* NO.                   @Y30OE72*/ 03552000
*         IF OUTSW=SETON&           /* CHKING OUTPUT DSKT?   @Y30OE72*/ 03553000
*             REPLY=RETRY1 THEN     /* OPR MOUNT NEW DSKT?   @Y30OE72*/ 03554000
         B     @RC01145                                            1147 03555000
@RF01145 TM    OUTSW,B'01000000'                                   1147 03556000
         BNO   @RF01147                                            1147 03557000
         CLC   REPLY(5),@CC02178                                   1147 03558000
         BNE   @RF01147                                            1147 03559000
*           RETRYSW=ON;             /* YES. RETRY            @Y30OE72*/ 03560000
         MVC   RETRYSW(1),ON                                       1148 03561000
*         ELSE                      /* NO. INVALID REPLY     @Y30OE72*/ 03562000
*           REPEATSW=ON;            /* REISSUE MSG           @Y30OE72*/ 03563000
         B     @RC01147                                            1149 03564000
@RF01147 MVC   REPEATSW(1),ON                                      1149 03565000
*   END;                            /* END IEB517A PROCESS   @Y30OE72*/ 03566000
@RC01147 DS    0H                                                  1150 03567000
@RC01145 DS    0H                                                  1150 03568000
@RC01140 LA    @12,1                                               1150 03569000
         AL    @12,I                                               1150 03570000
         ST    @12,I                                               1150 03571000
         CH    @12,@CH00108                                        1150 03572000
         BNH   @DL01126                                            1150 03573000
@DC01126 DS    0H                                                  1151 03574000
*   IF RETRYSW=OFF&                 /* OPR REPLY RETRY OR    @Y30OE72*/ 03575000
*       USEVOL=SETOFF&              /* CORRECT QUALIFIER OR  @Y30OE72*/ 03576000
*       CANCELED=SETOFF THEN        /* CANCEL?               @Y30OE72*/ 03577000
         CLC   RETRYSW(1),OFF                                      1151 03578000
         BNE   @RF01151                                            1151 03579000
         TM    USEVOL,B'00000100'                                  1151 03580000
         BNZ   @RF01151                                            1151 03581000
         TM    CANCELED,B'10000000'                                1151 03582000
         BNZ   @RF01151                                            1151 03583000
*     CANCELED=SETON;               /* NO. THEN OPR FAILED   @Y30OE72   03584000
*                                      TO SUPPLY SECURITY    @Y30OE72   03585000
*                                      QUALIFIER IN 3 TRIES. @Y30OE72   03586000
*                                      FORCE RTNCODE OF 8.   @Y30OE72*/ 03587000
         OI    CANCELED,B'10000000'                                1152 03588000
*   END SECURCHK;                   /*                       @Y30OE72*/ 03589000
@EL00011 DS    0H                                                  1153 03590000
@EF00011 DS    0H                                                  1153 03591000
@ER00011 L     @14,@SA00011                                        1153 03592000
         BR    @14                                                 1153 03593000
*                                                                  1154 03594000
*/********************************************************************/ 03595000
*/*                                                          @Y30OE72*/ 03596000
*/* ROUTINE NAME = UCBDEBUP                                  @Y30OE72*/ 03597000
*/*                                                          @Y30OE72*/ 03598000
*/* FUNCTION = LOAD THE ASSYNCHRONOUS ROUTINE (IGG019VW)     @Y30OE72*/ 03599000
*/*            AND CREATE AN RB FOR IT TO RUN UNDER.         @Y30OE72*/ 03600000
*/*            UPDATE THE UCBVLSER WITH A VOLID OR ZEROS.    @Y30OE72*/ 03601000
*/*            DEPENDING ON MODESWIT SETTING (SEE BELOW).    @Y30OE72*/ 03602000
*/*                                                          @Y30OE72*/ 03603000
*/* INPUT = MODESWIT - BOTH - LOAD IGG019VW & UPDTE UCBVLSER @Y30OE72*/ 03604000
*/*                    UCBZERO - ZERO UCBVLSER ONLY          @Y30OE72*/ 03605000
*/*                    UCBONLY - UPDATE UCBVLSER WITH VOLID  @Y30OE72*/ 03606000
*/*                              IN RECBUF                   @Y30OE72*/ 03607000
*/*         DCBADDR - ADDR OF DCB JUST OPENED.               @Y30OE72*/ 03608000
*/*         TIOTADDR - PTR TO TIOT ENTRY FOR UCB TO BE UPDTD @Y30OE72*/ 03609000
*/*                                                          @Y30OE72*/ 03610000
*/* OUTPUT = IGG019VW LOADED (MODESWIT=BOTH)                 @Y30OE72*/ 03611000
*/*          UCBVLSER UPDATED (MODESWIT=BOTH,UCBONLY)        @Y30OE72*/ 03612000
*/*          UCBVLSER ZEROED (MODESWIT=UCBZERO)              @Y30OE72*/ 03613000
*/*                                                          @Y30OE72*/ 03614000
*/* ROUTINES CALLED = NONE                                   @Y30OE72*/ 03615000
*/*                                                          @Y30OE72*/ 03616000
*/* MACROS = MODESET,LOAD,CIRB,SETLOCK                       @Z30OE72*/ 03617000
*/*                                                          @Y30OE72*/ 03618000
*/********************************************************************/ 03619000
*                                                                  1154 03620000
*UCBDEBUP:                          /*                       @Y30OE72*/ 03621000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30OE72*/ 03622000
UCBDEBUP ST    @14,@SA00012                                        1154 03623000
*   IF MODESWIT=GETIRB THEN         /* 3540 DEV JUST OPENED? @Z30OE72*/ 03624000
         CLI   MODESWIT,3                                          1155 03625000
         BNE   @RF01155                                            1155 03626000
*     DO;                           /* YES. LOAD IGG019VW    @Y30OE72   03627000
*                                      AND CREATE IRB        @Y30OE72*/ 03628000
*       GEN;                                                       1157 03629000
*                                   /*                       @Y30OE72*/ 03630000
         LOAD  EP=IGG019VW              LOAD ASSYNCHRONOUS RTN @Y30OE72 03631000
         CIRB  EP=(0),STAB=RE,SVAREA=YES                       @Y30OE72 03632000
*       VWIRB=REG1;                 /* SAVE IRB ADDRESS      @Y30OE72*/ 03633000
         STCM  REG1,7,VWIRB                                        1158 03634000
*     END;                          /*                       @Y30OE72*/ 03635000
*   GEN(MODESET KEY=ZERO,MODE=SUP); /* TO UPDATE UCB,DEB     @Z30OE72*/ 03636000
@RF01155 DS    0H                                                  1160 03637000
         MODESET KEY=ZERO,MODE=SUP                                      03638000
*   IF MODESWIT=GETIRB THEN         /* DID WE GET AN IRB?    @Z30OE72*/ 03639000
         CLI   MODESWIT,3                                          1161 03640000
         BNE   @RF01161                                            1161 03641000
*     DO;                           /* YES. PUT ADDR IN DEB  @Y30OE72*/ 03642000
*       REG1=DCBADDR;               /* DCB ADDRESSABILITY    @Y30OE72*/ 03643000
         L     REG1,DCBADDR                                        1163 03644000
*       DEBPTR=DCBDEBA;             /* DEB ADDRESSABILITY    @Y30OE72*/ 03645000
         SLR   DEBPTR,DEBPTR                                       1164 03646000
         ICM   DEBPTR,7,DCBDEBA+40(REG1)                           1164 03647000
*       DEBIRBB=VWIRB;              /* IRB ADDR IN DEB       @Y30OE72*/ 03648000
         MVC   DEBIRBB(3,DEBPTR),VWIRB                             1165 03649000
*     END;                          /*                       @Y30OE72*/ 03650000
*   RFY                             /*                       @Z30OE72*/ 03651000
*     LOCKADDR RSTD;                /*                       @Z30OE72*/ 03652000
@RF01161 DS    0H                                                  1168 03653000
*   LOCKADDR=ADDR(UCBLOCK);         /* LOCKWORD ADDRESS      @Z30OE72*/ 03654000
         L     @12,TIOTADDR                                        1168 03655000
         SLR   LOCKADDR,LOCKADDR                                   1168 03656000
         ICM   LOCKADDR,7,TIOEFSRT(@12)                            1168 03657000
         AL    LOCKADDR,@CF03564                                   1168 03658000
*   GEN;                                                           1169 03659000
*                                   /*                       @Z30OE72*/ 03660000
         SETLOCK OBTAIN,TYPE=IOSUCB,ADDR=(11),MODE=UNCOND,             C03661000
               REGS=USE,RELATED=(UCB,IEBDISKT(UCBDEBUP))       @Z30OE72 03662000
*   IF MODESWIT=UCBONLY             /* UPDATE UCBVLSER?      @Z30OE72*/ 03663000
*     THEN                          /* YES.                  @Z30OE72*/ 03664000
         CLI   MODESWIT,2                                          1170 03665000
         BNE   @RF01170                                            1170 03666000
*     UCBVLSER=RECBUF(5:10);        /* DSKT VOLID INTO UCB   @Y30OE72*/ 03667000
         L     @12,TIOTADDR                                        1171 03668000
         ICM   @15,7,TIOEFSRT(@12)                                 1171 03669000
         L     @12,UCBXTADR(,@15)                                  1171 03670000
         L     @15,IOBPTR                                          1171 03671000
         ICM   @14,7,CCWRDADD(@15)                                 1171 03672000
         MVC   UCBVLSER(6,@12),RECBUF+4(@14)                       1171 03673000
*   ELSE                            /* NO.                   @Y30OE72*/ 03674000
*     UCBVLSER=ZEROREC(1:6);        /* ZERO IT.              @Y30OE72*/ 03675000
         B     @RC01170                                            1172 03676000
@RF01170 L     @12,TIOTADDR                                        1172 03677000
         ICM   @15,7,TIOEFSRT(@12)                                 1172 03678000
         L     @12,UCBXTADR(,@15)                                  1172 03679000
         MVC   UCBVLSER(6,@12),ZEROREC                             1172 03680000
*   GEN;                                                           1173 03681000
@RC01170 DS    0H                                                  1173 03682000
*                                   /*                       @Z30OE72*/ 03683000
         SETLOCK RELEASE,TYPE=IOSUCB,ADDR=(11),                        C03684000
               REGS=USE,RELATED=(UCB,IEBDISKT(UCBDEBUP))       @Z30OE72 03685000
        MODESET KEY=NZERO,MODE=PROB    RESET TO PP KEY         @Z30OE72 03686000
*   RFY                             /*                       @Z30OE72*/ 03687000
*     LOCKADDR UNRSTD;              /*                       @Z30OE72*/ 03688000
*   END UCBDEBUP;                   /*                       @Y30OE72*/ 03689000
@EL00012 DS    0H                                                  1175 03690000
@EF00012 DS    0H                                                  1175 03691000
@ER00012 L     @14,@SA00012                                        1175 03692000
         BR    @14                                                 1175 03693000
*                                                                  1176 03694000
*/********************************************************************/ 03695000
*/*                                                          @Y30OE72*/ 03696000
*/* ROUTINE NAME = PRINTTAB                                  @Y30OE72*/ 03697000
*/*                                                          @Y30OE72*/ 03698000
*/* FUNCTION = WRITE THE TR0T TO THE SYSPRINT DATA SET       @Y30OE72*/ 03699000
*/*                                                          @Y30OE72*/ 03700000
*/* INPUT = TR0T                                             @Y30OE72*/ 03701000
*/*                                                          @Y30OE72*/ 03702000
*/* OUTPUT = TR0T WRITTEN TO SYSPRINT                        @Y30OE72*/ 03703000
*/*                                                          @Y30OE72*/ 03704000
*/* ROUTINES CALLED = MSGWRTR - TO PUT RECORDS TO SYSPRINT   @Y30OE72*/ 03705000
*/*                   SKIP2 - TO WRITE BLANK LINES           @Y30OE72*/ 03706000
*/*                                                          @Y30OE72*/ 03707000
*/* MACROS = NONE                                            @Y30OE72*/ 03708000
*/*                                                          @Y30OE72*/ 03709000
*/********************************************************************/ 03710000
*                                                                  1176 03711000
*PRINTTAB:                          /*                       @Y30OE72*/ 03712000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30OE72*/ 03713000
*                                                                  1176 03714000
PRINTTAB ST    @14,@SA00013                                        1176 03715000
*   /*****************************************************************/ 03716000
*   /*                                                               */ 03717000
*   /* WRITE TABLE HEADER LINES                              @Y30OE72*/ 03718000
*   /*                                                               */ 03719000
*   /*****************************************************************/ 03720000
*                                                                  1177 03721000
*   CALL SKIP2;                     /* SKIP 2 LINES          @Y30OE72*/ 03722000
         BAL   @14,SKIP2                                           1177 03723000
*   PRT(34:48)=HEAD1;               /* MOVE HEADER           @Y30OE72*/ 03724000
         MVC   PRT+33(15),HEAD1                                    1178 03725000
*   Q=ADDR(TR0T)+160;               /* SET POINTER           @Y30OE72*/ 03726000
         LA    Q,TR0T                                              1179 03727000
         AH    Q,@CH03449                                          1179 03728000
*   PRT(50:55)=LABELN;              /* MOVE LABEL            @Y30OE72*/ 03729000
         MVC   PRT+49(6),LABELN(Q)                                 1180 03730000
*   MSGTYPE=TABLE;                  /* IND MSG TYPE          @Y30OE72*/ 03731000
         MVI   MSGTYPE,C'T'                                        1181 03732000
*   CALL MSGWRTR;                   /* WRITE HEADER          @Y30OE72*/ 03733000
         BAL   @14,MSGWRTR                                         1182 03734000
*   CALL SKIP2;                     /* SKIP 2 LINES          @Y30OE72*/ 03735000
         BAL   @14,SKIP2                                           1183 03736000
*   PRT(4:91)=HEAD2;                /* MOVE 2ND HEADER       @Y30OE72*/ 03737000
         MVC   PRT+3(88),HEAD2                                     1184 03738000
*   MSGTYPE=TABLE;                  /* IND MSG TYPE          @Y30OE72*/ 03739000
         MVI   MSGTYPE,C'T'                                        1185 03740000
*   CALL MSGWRTR;                   /* WRITE HEADER          @Y30OE72*/ 03741000
         BAL   @14,MSGWRTR                                         1186 03742000
*   CALL SKIP2;                     /* SKIP 2 LINES          @Y30OE72*/ 03743000
         BAL   @14,SKIP2                                           1187 03744000
*   Q=ADDR(TR0T)+240;               /* SET POINTER           @Y30OE72*/ 03745000
         LA    Q,TR0T                                              1188 03746000
         AH    Q,@CH03434                                          1188 03747000
*   PRT(4:5)='DS';                  /*                       @Y30OE72*/ 03748000
         MVC   PRT+3(2),@CC03452                                   1189 03749000
*                                                                  1190 03750000
*   /*****************************************************************/ 03751000
*   /*                                                               */ 03752000
*   /* WRITE TR0T TO SYSPRINT                                @Y30OE72*/ 03753000
*   /*                                                               */ 03754000
*   /*****************************************************************/ 03755000
*                                                                  1190 03756000
*   DO I=1 TO 19                    /* PRINT TABLE           @Y30OE72*/ 03757000
*         WHILE PRINTERR=SETOFF;    /*                       @Y30OE72*/ 03758000
         LA    @12,1                                               1190 03759000
         ST    @12,I                                               1190 03760000
@DL01190 TM    PRINTERR,B'00001000'                                1190 03761000
         BNZ   @DC01190                                            1190 03762000
*     PRT(6:7)=PRTNRS(I);           /*                       @Y30OE72*/ 03763000
         ALR   @12,@12                                             1191 03764000
         LA    @11,PRTNRS-2(@12)                                   1191 03765000
         MVC   PRT+5(2),0(@11)                                     1191 03766000
*     IF HDRI=DDRI                  /* FOR DELETED ENTRY     @Y30OE72*/ 03767000
*       THEN                        /*                       @Y30OE72*/ 03768000
         CLI   HDRI(Q),C'D'                                        1192 03769000
         BNE   @RF01192                                            1192 03770000
*       DO;                         /*                       @Y30OE72*/ 03771000
*         PRT(2:3)=FLAG;            /* MOVE FLAG             @Y30OE72*/ 03772000
         MVC   PRT+1(2),FLAG(Q)                                    1194 03773000
*         PRT(10:49)=HEADER1(1:39); /* MOVE DESCRIPTION      @Y30OE72*/ 03774000
         MVI   PRT+48,C' '                                         1195 03775000
         MVC   PRT+9(39),HEADER1(Q)                                1195 03776000
*       END;                        /*                       @Y30OE72*/ 03777000
*     ELSE                          /*                       @Y30OE72*/ 03778000
*       DO;                         /*                       @Y30OE72*/ 03779000
         B     @RC01192                                            1197 03780000
@RF01192 DS    0H                                                  1198 03781000
*         PRT(2:3)=FLAG;            /*                       @Y30OE72*/ 03782000
         MVC   PRT+1(2),FLAG(Q)                                    1198 03783000
*         PRT(10:17)=DSI;           /* MOVE ALL ENTRIES      @Y30OE72*/ 03784000
         MVC   PRT+9(8),DSI(Q)                                     1199 03785000
*         PRT(20:24)=BL;            /*                       @Y30OE72*/ 03786000
         MVC   PRT+19(5),BL(Q)                                     1200 03787000
*         PRT(27:31)=BOE;           /*                       @Y30OE72*/ 03788000
         MVC   PRT+26(5),BOE(Q)                                    1201 03789000
*         PRT(34:38)=EOE;           /*                       @Y30OE72*/ 03790000
         MVC   PRT+33(5),EOE(Q)                                    1202 03791000
*         PRT(41:41)=BI;            /*                       @Y30OE72*/ 03792000
         MVC   PRT+40(1),BI(Q)                                     1203 03793000
*         PRT(45:45)=DSS;           /*                       @Y30OE72*/ 03794000
         MVC   PRT+44(1),DSS(Q)                                    1204 03795000
*         PRT(49:49)=WP;            /*                       @Y30OE72*/ 03796000
         MVC   PRT+48(1),WP(Q)                                     1205 03797000
*         PRT(53:53)=EI;            /*                       @Y30OE72*/ 03798000
         MVC   PRT+52(1),EI(Q)                                     1206 03799000
*         PRT(57:57)=MVI;           /*                       @Y30OE72*/ 03800000
         MVC   PRT+56(1),MVI(Q)                                    1207 03801000
*         PRT(61:62)=VS#;           /*                       @Y30OE72*/ 03802000
         MVC   PRT+60(2),VS#(Q)                                    1208 03803000
*         PRT(66:71)=CRDT;          /*                       @Y30OE72*/ 03804000
         MVC   PRT+65(6),CRDT(Q)                                   1209 03805000
*         PRT(74:79)=ED;            /*                       @Y30OE72*/ 03806000
         MVC   PRT+73(6),ED(Q)                                     1210 03807000
*         PRT(83:83)=VI;            /*                       @Y30OE72*/ 03808000
         MVC   PRT+82(1),VI(Q)                                     1211 03809000
*         PRT(87:91)=EOD;           /*                       @Y30OE72*/ 03810000
         MVC   PRT+86(5),EOD(Q)                                    1212 03811000
*         PRT(92:94)=BLANK(1:3);    /*                       @Y30OE72*/ 03812000
         MVC   PRT+91(3),BLANK                                     1213 03813000
*       END;                        /*                       @Y30OE72*/ 03814000
*     MSGTYPE=TABLE;                /* IND MSG TYPE          @Y30OE72*/ 03815000
@RC01192 MVI   MSGTYPE,C'T'                                        1215 03816000
*     CALL MSGWRTR;                 /* PRINT AN ENTRY        @Y30OE72*/ 03817000
         BAL   @14,MSGWRTR                                         1216 03818000
*     PRT=BLANK(1:121);             /* CLEAR PRINTAREA       @Y30OE72*/ 03819000
         MVC   PRT(121),BLANK                                      1217 03820000
*     Q=Q+80;                       /* UPDATE POINTER        @Y30OE72*/ 03821000
         AL    Q,@CF00311                                          1218 03822000
*   END;                            /*                       @Y30OE72*/ 03823000
         LA    @12,1                                               1219 03824000
         AL    @12,I                                               1219 03825000
         ST    @12,I                                               1219 03826000
         CH    @12,@CH02061                                        1219 03827000
         BNH   @DL01190                                            1219 03828000
@DC01190 DS    0H                                                  1220 03829000
*   CALL SKIP2;                     /* SKIP 2 LINES          @Y30OE72*/ 03830000
         BAL   @14,SKIP2                                           1220 03831000
*   PRT(1:7)=LEGEND;                /* LEGEND:               @Y30OE72*/ 03832000
         MVC   PRT(7),LEGEND                                       1221 03833000
*   MSGTYPE=TABLE;                  /* IND MSG TYPE          @Y30OE72*/ 03834000
         MVI   MSGTYPE,C'T'                                        1222 03835000
*   CALL MSGWRTR;                   /* WRITE HEADER          @Y30OE72*/ 03836000
         BAL   @14,MSGWRTR                                         1223 03837000
*   PRT(1:7)=BLANK(1:7);            /* CLEAR PRINT AREA      @Y30OE72*/ 03838000
         MVC   PRT(7),BLANK                                        1224 03839000
*   Q=ADDR(HEAD3);                  /*                       @Y30OE72*/ 03840000
         LA    Q,HEAD3                                             1225 03841000
*   DO I=1 TO 5                     /* PRINT DESCRIPTION     @Y30OE72*/ 03842000
*         WHILE PRINTERR=SETOFF;    /*                       @Y30OE72*/ 03843000
         LA    @12,1                                               1226 03844000
         ST    @12,I                                               1226 03845000
@DL01226 TM    PRINTERR,B'00001000'                                1226 03846000
         BNZ   @DC01226                                            1226 03847000
*     PRT(4:83)=HEADER1;            /*                       @Y30OE72*/ 03848000
         MVC   PRT+3(80),HEADER1(Q)                                1227 03849000
*     Q=Q+80;                       /*                       @Y30OE72*/ 03850000
         AL    Q,@CF00311                                          1228 03851000
*     MSGTYPE=TABLE;                /* IND MSG TYPE          @Y30OE72*/ 03852000
         MVI   MSGTYPE,C'T'                                        1229 03853000
*     CALL MSGWRTR;                 /* WRITE HEADER          @Y30OE72*/ 03854000
         BAL   @14,MSGWRTR                                         1230 03855000
*   END;                            /*                       @Y30OE72*/ 03856000
         LA    @12,1                                               1231 03857000
         AL    @12,I                                               1231 03858000
         ST    @12,I                                               1231 03859000
         CH    @12,@CH00038                                        1231 03860000
         BNH   @DL01226                                            1231 03861000
@DC01226 DS    0H                                                  1232 03862000
*   END PRINTTAB;                   /*                       @Y30OE72*/ 03863000
@EL00013 DS    0H                                                  1232 03864000
@EF00013 DS    0H                                                  1232 03865000
@ER00013 L     @14,@SA00013                                        1232 03866000
         BR    @14                                                 1232 03867000
*                                                                  1233 03868000
*   /*****************************************************************/ 03869000
*   /*                                                               */ 03870000
*   /* ROUTINE TO SKIP 2 LINES IN TABLE PRINTOUT             @Y30OE72*/ 03871000
*   /*                                                               */ 03872000
*   /*****************************************************************/ 03873000
*                                                                  1233 03874000
*SKIP2:                             /*                       @Y30OE72*/ 03875000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE72*/ 03876000
SKIP2    ST    @14,@SA00014                                        1233 03877000
*   DO I=1 TO 2;                    /* WRITE 2 LINES         @Y30OE72*/ 03878000
         LA    @12,1                                               1234 03879000
         ST    @12,I                                               1234 03880000
@DL01234 DS    0H                                                  1235 03881000
*     PRT=BLANK(1:121);             /* CLEAR PRINT AREA      @Y30OE72*/ 03882000
         MVC   PRT(121),BLANK                                      1235 03883000
*     MSGTYPE=TABLE;                /* IND MSG TYPE          @Y30OE72*/ 03884000
         MVI   MSGTYPE,C'T'                                        1236 03885000
*     CALL MSGWRTR;                 /* WRITE BLANK LINE      @Y30OE72*/ 03886000
         BAL   @14,MSGWRTR                                         1237 03887000
*   END;                            /*                       @Y30OE72*/ 03888000
         LA    @12,1                                               1238 03889000
         AL    @12,I                                               1238 03890000
         ST    @12,I                                               1238 03891000
         CH    @12,@CH00070                                        1238 03892000
         BNH   @DL01234                                            1238 03893000
*   END SKIP2;                      /*                       @Y30OE72*/ 03894000
@EL00014 DS    0H                                                  1239 03895000
@EF00014 DS    0H                                                  1239 03896000
@ER00014 L     @14,@SA00014                                        1239 03897000
         BR    @14                                                 1239 03898000
*                                                                  1240 03899000
*/********************************************************************/ 03900000
*/*                                                          @Y30OE72*/ 03901000
*/* ROUTINE NAME = COPY1                                     @Y30OE72*/ 03902000
*/*                                                          @Y30OE72*/ 03903000
*/* FUNCTION = COPY DATA SETS FROM INPUT DISKETTE TO OUTPUT  @Y30OE72*/ 03904000
*/*            DISKETTE(MODESW=TWO3540) OR DASD(MODESW=      @Y30OE72*/ 03905000
*/*            ONE3540) OR COPY DATA SETS FROM DASD TO THE   @Y30OE72*/ 03906000
*/*            OUTPUT DISKETTE(MODESW=DASDDSKT).             @Y30OE72*/ 03907000
*/*            THE DATA SETS ARE COPIED IN                   @Y30OE72*/ 03908000
*/*            ASCENDING ORDER OF EXTENT LIMITS AS DETERMIN- @Y30OE72*/ 03909000
*/*            ED BY THE FILESEQ TABLE. EOD IN THE TR0T IS   @Y30OE72*/ 03910000
*/*            UPDATED FOR EACH FILE AFTER IT IS COPIED. EOD @Y30OE72*/ 03911000
*/*            IS DECREMENTED BY THE NUMBER OF 'D' & 'F'     @Y30OE72*/ 03912000
*/*            RECORDS FOUND IN THE DATA ON THE INPUT DSKT.  @Y30OE72*/ 03913000
*/*                                                          @Y30OE72*/ 03914000
*/* INPUT = FILESEQ TABLE                                    @Y30OE72*/ 03915000
*/*         TR0T                                             @Y30OE72*/ 03916000
*/*                                                          @Y30OE72*/ 03917000
*/* OUTPUT = UPDATED TR0T EOD VALUES                         @Y30OE72*/ 03918000
*/*          DATA RECORDS ON OUTPUT DISKETTE OR DASD         @Y30OE72*/ 03919000
*/*          FAILSW ON IF ERROR OCCURRED                     @Y30OE72*/ 03920000
*/*                                                          @Y30OE72*/ 03921000
*/* ROUTINES CALLED = WRKTABLE - TO CALCULATE BINARY FILE    @Y30OE72*/ 03922000
*/*                              CONSTANTS                   @Y30OE72*/ 03923000
*/*                   WRITE1 - TO COPY DATA FROM INPUT DSKT  @Y30OE72*/ 03924000
*/*                   WRITE2 - TO COPY DATA FROM DASD        @Y30OE72*/ 03925000
*/*                   MSGWRTR - TO WRITE IEB504I IF AN       @Y30OE72*/ 03926000
*/*                             I/O ERROR WAS ENCOUNTERED    @Y30OE72*/ 03927000
*/*                             ON THE OUTPUT DISKETTE.      @Y30OE72*/ 03928000
*/*                                                          @Y30OE72*/ 03929000
*/* MACROS = NONE                                            @Y30OE72*/ 03930000
*/*                                                          @Y30OE72*/ 03931000
*/********************************************************************/ 03932000
*                                                                  1240 03933000
*COPY1:                             /* SEE GENERAL COMMENTS  @Y30OE72*/ 03934000
*   PROC OPTIONS(SAVE(14));         /* ON PREVIOUS PAGE      @Y30OE72*/ 03935000
COPY1    ST    @14,@SA00015                                        1240 03936000
*   DO F=1 TO 19                    /* LOOP CONTROLS TO READ @Y30OE72*/ 03937000
*         WHILE(FILESEQ(F)^=AST2&   /* ALL FILESEQ ENTRIES.  @Y30OE72*/ 03938000
*         FAILSW=OFF);              /*                       @Y30OE72*/ 03939000
         LA    @12,1                                               1241 03940000
         STC   @12,F                                               1241 03941000
@DL01241 SLR   @11,@11                                             1241 03942000
         IC    @11,FILESEQ-1(@12)                                  1241 03943000
         SLR   @12,@12                                             1241 03944000
         IC    @12,AST2                                            1241 03945000
         CR    @11,@12                                             1241 03946000
         BE    @DC01241                                            1241 03947000
         CLC   FAILSW(1),OFF                                       1241 03948000
         BNE   @DC01241                                            1241 03949000
*     E=FILESEQ(F);                 /* INDEX TR0T-ENTRY      @Y30OE72*/ 03950000
         STC   @11,E                                               1242 03951000
*     CALL WRKTABLE;                /* CALC FILE CONSTANTS   @Y30OE72*/ 03952000
         BAL   @14,WRKTABLE                                        1243 03953000
*     IF FIRSTREC<=LASTREC THEN     /* NULL DATA SET?        @Y30OE72*/ 03954000
         CLC   FIRSTREC(4),LASTREC                                 1244 03955000
         BH    @RF01244                                            1244 03956000
*       DO;                         /* NO. COPY IT           @Y30OE72*/ 03957000
*         FIRSTIO=SETON;            /* READSECT 1ST TIME SW  @Y30OE72*/ 03958000
*         FIRSTPUT=SETON;           /* WRITETRK 1ST TIME SW  @Y30OE72*/ 03959000
         OI    FIRSTIO,B'10100000'                                 1247 03960000
*         IF MODESW=DASDDSKT THEN   /* DATA ON DASD?         @Y30OE72*/ 03961000
         CLI   MODESW,3                                            1248 03962000
         BNE   @RF01248                                            1248 03963000
*           CALL WRITE2;            /* YES. CALL DASD-DSKT   @Y30OE72*/ 03964000
         BAL   @14,WRITE2                                          1249 03965000
*         ELSE                      /* NO.                   @Y30OE72*/ 03966000
*           CALL WRITE1;            /* DSKT-DSKT/DASD RTN    @Y30OE72*/ 03967000
         B     @RC01248                                            1250 03968000
@RF01248 BAL   @14,WRITE1                                          1250 03969000
*         IF SW504I=SETON THEN      /* I/O ERROR?            @Y30OE72*/ 03970000
@RC01248 TM    SW504I,B'00001000'                                  1251 03971000
         BNO   @RF01251                                            1251 03972000
*           DO;                     /* YES.                  @Y30OE72*/ 03973000
*             REG1=ADDR(IEB504I);   /* ISSUE                 @Y30OE72*/ 03974000
         LA    REG1,IEB504I                                        1253 03975000
*             MSGLEN=LENGTH(IEB504I);/* MESSAGE              @Y30OE72*/ 03976000
         MVI   MSGLEN,X'28'                                        1254 03977000
*             CALL MSGWRTR;         /* IEB504I               @Y30OE72*/ 03978000
         BAL   @14,MSGWRTR                                         1255 03979000
*             FAILSW=ON;            /* TERMINATE RUN         @Y30OE72*/ 03980000
         MVC   FAILSW(1),ON                                        1256 03981000
*           END;                    /*                       @Y30OE72*/ 03982000
*         ELSE                      /* NO ERRORS             @Y30OE72*/ 03983000
*           IF MODESW^=DASDDSKT THEN/* READ FROM DSKT?       @Y30OE72*/ 03984000
         B     @RC01251                                            1258 03985000
@RF01251 CLI   MODESW,3                                            1258 03986000
         BE    @RF01258                                            1258 03987000
*             DO;                   /* TES. UPDATE EOD @     @Y30OE72*/ 03988000
*               EODABS=EODABS-LRT;  /* NEW EOD = OLD EOD     @Y30OE72   03989000
*                                      MINUS NUMBER OF       @Y30OE72*/ 03990000
         LH    @12,EODABS                                          1260 03991000
         SH    @12,LRT                                             1260 03992000
         STH   @12,EODABS                                          1260 03993000
*               WORK1=EODABS/TWSIX; /* 'D' AND 'F' RECORDS   @Y30OE72*/ 03994000
         LH    @11,TWSIX                                           1261 03995000
         LR    @02,@12                                             1261 03996000
         SRDA  @02,32                                              1261 03997000
         DR    @02,@11                                             1261 03998000
         ST    @03,WORK1                                           1261 03999000
*               WORK2=EODABS//TWSIX;/* FOUND IN INPUT        @Y30OE72*/ 04000000
         LR    @02,@12                                             1262 04001000
         SRDA  @02,32                                              1262 04002000
         DR    @02,@11                                             1262 04003000
         ST    @02,WORK2                                           1262 04004000
*               IF WORK2(4)=HEX00 THEN/* CHECK FOR           @Y30OE72*/ 04005000
         CLC   WORK2+3(1),HEX00                                    1263 04006000
         BNE   @RF01263                                            1263 04007000
*                 DO;               /* VALIDITY OF           @Y30OE72*/ 04008000
*                   WORK2(4)=SECTOR26;/* ADDRESS             @Y30OE72*/ 04009000
         MVI   WORK2+3,X'1A'                                       1265 04010000
*                   WORKA=WORKA-1;  /*                       @Y30OE72*/ 04011000
         L     @12,WORKA                                           1266 04012000
         BCTR  @12,0                                               1266 04013000
         ST    @12,WORKA                                           1266 04014000
*                 END;              /*                       @Y30OE72*/ 04015000
*               DSEODTT=WORK1(3:4); /* UPDATE EOD            @Y30OE72*/ 04016000
@RF01263 MVC   DSEODTT(2),WORK1+2                                  1268 04017000
*               DSEODSS=WORK2(3:4); /* IN DS TABLE           @Y30OE72*/ 04018000
         MVC   DSEODSS(2),WORK2+2                                  1269 04019000
*               WORK1=WORK1&&WORK1; /*                       @Y30OE72*/ 04020000
         XC    WORK1(4),WORK1                                      1270 04021000
*               WORK2=WORK2&&WORK2; /*                       @Y30OE72*/ 04022000
         XC    WORK2(4),WORK2                                      1271 04023000
*               WORK1(4)=DSEODTRK;  /* CONVERT TRK PORTION   @Y30OE72*/ 04024000
         MVC   WORK1+3(1),DSEODTRK                                 1272 04025000
*               CVD(WORKA,WORK2);   /* OF EOD                @Y30OE72*/ 04026000
         L     @12,WORKA                                           1273 04027000
         CVD   @12,@TS00001                                        1273 04028000
         MVC   WORK2(4),@TS00001+4                                 1273 04029000
*               GEN(OI    WORK2+3,X'0F');/* AND              @Y30OE72*/ 04030000
         OI    WORK2+3,X'0F'                                            04031000
*               UNPK(WORK1,WORK2);  /* STORE                 @Y30OE72*/ 04032000
         UNPK  WORK1(4),WORK2(4)                                   1275 04033000
*               TR0T(E,75:76)=WORK1(3:4);/* IT IN TR0T       @Y30OE72*/ 04034000
         SLR   @12,@12                                             1276 04035000
         IC    @12,E                                               1276 04036000
         MH    @12,@CH00311                                        1276 04037000
         LA    @11,TR0T-6(@12)                                     1276 04038000
         MVC   0(2,@11),WORK1+2                                    1276 04039000
*               WORK1=WORK1&&WORK1; /*                       @Y30OE72*/ 04040000
         XC    WORK1(4),WORK1                                      1277 04041000
*               WORK2=WORK2&&WORK2; /*                       @Y30OE72*/ 04042000
         XC    WORK2(4),WORK2                                      1278 04043000
*               WORK1(4)=DSEODSEC;  /* CONVERT SEC PORTION   @Y30OE72*/ 04044000
         MVC   WORK1+3(1),DSEODSEC                                 1279 04045000
*               CVD(WORKA,WORK2);   /* OF EOD                @Y30OE72*/ 04046000
         L     @12,WORKA                                           1280 04047000
         CVD   @12,@TS00001                                        1280 04048000
         MVC   WORK2(4),@TS00001+4                                 1280 04049000
*               GEN(OI    WORK2+3,X'0F');/* AND              @Y30OE72*/ 04050000
         OI    WORK2+3,X'0F'                                            04051000
*               UNPK(WORK1,WORK2);  /* STORE                 @Y30OE72*/ 04052000
         UNPK  WORK1(4),WORK2(4)                                   1282 04053000
*               TR0T(E,78:79)=WORK1(3:4);/* IT IN TR0T       @Y30OE72*/ 04054000
         SLR   @12,@12                                             1283 04055000
         IC    @12,E                                               1283 04056000
         MH    @12,@CH00311                                        1283 04057000
         LA    @11,TR0T-3(@12)                                     1283 04058000
         MVC   0(2,@11),WORK1+2                                    1283 04059000
*             END;                  /*                       @Y30OE72*/ 04060000
*       END;                        /* END DATA SET COPY     @Y30OE72*/ 04061000
@RF01258 DS    0H                                                  1285 04062000
@RC01251 DS    0H                                                  1286 04063000
*   END;                            /* END DO WHILE          @Y30OE72*/ 04064000
@RF01244 LA    @12,1                                               1286 04065000
         SLR   @11,@11                                             1286 04066000
         IC    @11,F                                               1286 04067000
         ALR   @12,@11                                             1286 04068000
         STC   @12,F                                               1286 04069000
         CH    @12,@CH02061                                        1286 04070000
         BNH   @DL01241                                            1286 04071000
@DC01241 DS    0H                                                  1287 04072000
*   END COPY1;                      /* PROCEDURE END.        @Y30OE72*/ 04073000
@EL00015 DS    0H                                                  1287 04074000
@EF00015 DS    0H                                                  1287 04075000
@ER00015 L     @14,@SA00015                                        1287 04076000
         BR    @14                                                 1287 04077000
*                                                                  1288 04078000
*/********************************************************************/ 04079000
*/*                                                          @Y30OE72*/ 04080000
*/* ROUTINE NAME = WRITE1                                    @Y30OE72*/ 04081000
*/*                                                          @Y30OE72*/ 04082000
*/* FUNCTION = READ A FILE FROM THE INPUT DISKETTE AND WRITE @Y30OE72*/ 04083000
*/*            EACH NON 'D' OR 'F' RECORD TO THE OUTPUT      @Y30OE72*/ 04084000
*/*            DISKETTE(MODESW=ONE3540) OR TO DASD(MODESW=   @Y30OE72*/ 04085000
*/*            TWO3540).                                     @Y30OE72*/ 04086000
*/*                                                          @Y30OE72*/ 04087000
*/* INPUT = INPUT DISKETTE (SYSUT1)                          @Y30OE72*/ 04088000
*/*         FILE CONSTANT LASTREC SET BY WRKTABLE            @Y30OE72*/ 04089000
*/*         MODESW + DETERMINES MODE OF COPY                 @Y30OE72*/ 04090000
*/*         DFSWITCH - SET ON WHEN A 'D' OR 'F' RECORD IS    @Y30OE72*/ 04091000
*/*                    READ FROM THE INPUT DISKETTE          @Y30OE72*/ 04092000
*/*         BADRECSW - SET ON WHEN AN I/O ERROR IS FOUND ON  @Y30OE72*/ 04093000
*/*                    AN INPUT DISKETTE DATA SECTOR.        @Y30OE72*/ 04094000
*/*                                                          @Y30OE72*/ 04095000
*/* OUTPUT = DATA RECORDS ON SYSUT2 DEVICE                   @Y30OE72*/ 04096000
*/*            - IF SYSUT2 3540, THEN DATA RECORDS ARE       @Y30OE72*/ 04097000
*/*              WITHIN THE SAME EXTENTS LIMITS THEY HAD ON  @Y30OE72*/ 04098000
*/*              THE INPUT DISKETTE.                         @Y30OE72*/ 04099000
*/*            - IF SYSUT2 DASD, THEN DATA RECORDS ARE       @Y30OE72*/ 04100000
*/*              SEQUENTIALLY LOCATED IN THE TEMPORARY       @Y30OE72*/ 04101000
*/*              FILE.                                       @Y30OE72*/ 04102000
*/*          MSG IEB513I IN THE MESSAGE DATA SET IDENTIFYING @Y30OE72*/ 04103000
*/*          ANY ERROR RECORDS THAT WERE FOUND.              @Y30OE72*/ 04104000
*/*          FAILSW = ON IF AN I/O ERROR ENCOUNTERED ON      @Y30OE72*/ 04105000
*/*                   THE DASD FILE.                         @Y30OE72*/ 04106000
*/*                                                          @Y30OE72*/ 04107000
*/* ROUTINES CALLED = READSECT - TO READ DATA RECORDS FROM   @Y30OE72*/ 04108000
*/*                              INPUT DISKETTE.             @Y30OE72*/ 04109000
*/*                   WRITETRK - TO WRITE DATA RECORDS TO    @Y30OE72*/ 04110000
*/*                              OUTPUT DISKETTE             @Y30OE72*/ 04111000
*/*                                                          @Y30OE72*/ 04112000
*/* MACROS = PUT                                             @Y30OE72*/ 04113000
*/*                                                          @Y30OE72*/ 04114000
*/********************************************************************/ 04115000
*                                                                  1288 04116000
*WRITE1:                            /* SEE GENERAL COMMENTS  @Y30OE72*/ 04117000
*   PROC OPTIONS(SAVE(14));         /* ON PREVIOUS PAGE      @Y30OE72*/ 04118000
WRITE1   ST    @14,@SA00016                                        1288 04119000
*   DO                              /* PROCESS A DATA SET    @Y30OE72*/ 04120000
*         WHILE(IOBSKADR^=LASTREC&  /* FROM INPUT DISKETTE   @Y30OE72*/ 04121000
*         SW504I=SETOFF&PRINTERR=SETOFF&/*                   @Z30OE72*/ 04122000
*         FAILSW=OFF);              /*                       @Z30OE72*/ 04123000
         B     @DE01289                                            1289 04124000
@DL01289 DS    0H                                                  1290 04125000
*     CALL READSECT;                /* READ A SECTOR         @Y30OE72*/ 04126000
         BAL   @14,READSECT                                        1290 04127000
*     FIRSTIO=SETOFF;               /* RESET 1ST TIME SW     @Y30OE72*/ 04128000
         NI    FIRSTIO,B'01111111'                                 1291 04129000
*     IF BADRECSW=ON THEN           /* READ SUCCESSFUL?      @Y30OE72*/ 04130000
         CLC   BADRECSW(1),ON                                      1292 04131000
         BNE   @RF01292                                            1292 04132000
*       DO;                         /* NO.                   @Y30OE72*/ 04133000
*         WORK1=WORK1&&WORK1;       /* INITIALIZE WORKFIELDS @Y30OE72*/ 04134000
         XC    WORK1(4),WORK1                                      1294 04135000
*         WORK2=WORK2&&WORK2;       /*                       @Y30OE72*/ 04136000
         XC    WORK2(4),WORK2                                      1295 04137000
*         WORK1(4)=IOBSKTT;         /* CONVERT AND STORE     @Y30OE72*/ 04138000
         L     @12,IOBPTR                                          1296 04139000
         MVC   WORK1+3(1),IOBSKTT(@12)                             1296 04140000
*         CVD(WORKA,WORK2);         /* TRACK #               @Y30OE72*/ 04141000
         L     @12,WORKA                                           1297 04142000
         CVD   @12,@TS00001                                        1297 04143000
         MVC   WORK2(4),@TS00001+4                                 1297 04144000
*         GEN(OI    WORK2+3,X'0F'); /* IN                    @Y30OE72*/ 04145000
         OI    WORK2+3,X'0F'                                            04146000
*         UNPK(WORK1,WORK2);        /* MSG                   @Y30OE72*/ 04147000
         UNPK  WORK1(4),WORK2(4)                                   1299 04148000
*         I513TRK#=WORK1(3:4);      /* TEXT                  @Y30OE72*/ 04149000
         MVC   I513TRK#(2),WORK1+2                                 1300 04150000
*         WORK1=WORK1&&WORK1;       /* INITIALIZE WORKFIELDS @Y30OE72*/ 04151000
         XC    WORK1(4),WORK1                                      1301 04152000
*         WORK2=WORK2&&WORK2;       /*                       @Y30OE72*/ 04153000
         XC    WORK2(4),WORK2                                      1302 04154000
*         WORK1(4)=IOBSKSS;         /* CONVERT AND STORE     @Y30OE72*/ 04155000
         L     @12,IOBPTR                                          1303 04156000
         MVC   WORK1+3(1),IOBSKSS(@12)                             1303 04157000
*         CVD(WORKA,WORK2);         /* SECTOR #              @Y30OE72*/ 04158000
         L     @12,WORKA                                           1304 04159000
         CVD   @12,@TS00001                                        1304 04160000
         MVC   WORK2(4),@TS00001+4                                 1304 04161000
*         GEN(OI    WORK2+3,X'0F'); /* IN                    @Y30OE72*/ 04162000
         OI    WORK2+3,X'0F'                                            04163000
*         UNPK(WORK1,WORK2);        /* MSG                   @Y30OE72*/ 04164000
         UNPK  WORK1(4),WORK2(4)                                   1306 04165000
*         I513SCT#=WORK1(3:4);      /* TEXT                  @Y30OE72*/ 04166000
         MVC   I513SCT#(2),WORK1+2                                 1307 04167000
*         REG1=ADDR(IEB513I);       /* ISSUE                 @Y30OE72*/ 04168000
         LA    REG1,IEB513I                                        1308 04169000
*         MSGLEN=LENGTH(IEB513I);   /* MESSAGE               @Y30OE72*/ 04170000
         MVI   MSGLEN,X'28'                                        1309 04171000
*         CALL MSGWRTR;             /* IEB513I               @Y30OE72*/ 04172000
         BAL   @14,MSGWRTR                                         1310 04173000
*       END;                        /*                       @Y30OE72*/ 04174000
*     BADRECSW=OFF;                 /* RESET ERROR REC SW    @Y30OE72*/ 04175000
@RF01292 MVC   BADRECSW(1),OFF                                     1312 04176000
*     IF DFSWITCH=OFF THEN          /*                       @Y30OE72*/ 04177000
         CLC   DFSWITCH(1),OFF                                     1313 04178000
         BNE   @RF01313                                            1313 04179000
*       IF MODESW=TWO3540 THEN      /* DSKT TO DSKT MODE?    @Y30OE72*/ 04180000
         CLI   MODESW,2                                            1314 04181000
         BNE   @RF01314                                            1314 04182000
*         DO;                       /* YES.                  @Y30OE72*/ 04183000
*           CALL WRITETRK;          /* WRITE TO DISKETTE     @Y30OE72*/ 04184000
         BAL   @14,WRITETRK                                        1316 04185000
*           FIRSTPUT=SETOFF;        /* RESET SW              @Y30OE72*/ 04186000
         NI    FIRSTPUT,B'11011111'                                1317 04187000
*         END;                      /*                       @Y30OE72*/ 04188000
*       ELSE                        /* OR TO DISK            @Y30OE72*/ 04189000
*         DO;                       /*                       @Y30OE72*/ 04190000
         B     @RC01314                                            1319 04191000
@RF01314 DS    0H                                                  1320 04192000
*           RFY                     /*                       @Y30OE72*/ 04193000
*             AREAADDR RSTD;        /*                       @Y30OE72*/ 04194000
*           AREAADDR=ADDR(RECBUF);  /* PT TO RECORD AREA     @Y30OE72*/ 04195000
         L     @12,IOBPTR                                          1321 04196000
         SLR   AREAADDR,AREAADDR                                   1321 04197000
         ICM   AREAADDR,7,CCWRDADD(@12)                            1321 04198000
*           GEN(PUT SYSUT2QS,(AREAADDR));/* WRITE REC TO     @Y30OE72   04199000
*                                      INTERMEDIATE FILE     @Y30OE72*/ 04200000
         PUT SYSUT2QS,(AREAADDR)                                        04201000
*           RFY                     /*                       @Y30OE72*/ 04202000
*             AREAADDR UNRSTD;      /*                       @Y30OE72*/ 04203000
*         END;                      /*                       @Y30OE72*/ 04204000
*   END;                            /* END DOWHILE           @Y30OE72*/ 04205000
@RC01314 DS    0H                                                  1325 04206000
@RF01313 DS    0H                                                  1325 04207000
@DE01289 L     @12,IOBPTR                                          1325 04208000
         CLC   IOBSKADR(4,@12),LASTREC                             1325 04209000
         BE    @DC01289                                            1325 04210000
         TM    SW504I,B'00001000'                                  1325 04211000
         BNZ   @DC01289                                            1325 04212000
         TM    PRINTERR,B'00001000'                                1325 04213000
         BNZ   @DC01289                                            1325 04214000
         CLC   FAILSW(1),OFF                                       1325 04215000
         BE    @DL01289                                            1325 04216000
@DC01289 DS    0H                                                  1326 04217000
*   IF MODESW=TWO3540 THEN          /* DSKT TO DSKT MODE?    @Y30OE72*/ 04218000
         CLI   MODESW,2                                            1326 04219000
         BNE   @RF01326                                            1326 04220000
*     IF SW504I=SETOFF THEN         /* YES. ANY WRITE ERR?   @Y30OE72*/ 04221000
         TM    SW504I,B'00001000'                                  1327 04222000
         BNZ   @RF01327                                            1327 04223000
*       DO;                         /* NO. FLUSH BUFFERS     @Y30OE72*/ 04224000
*         LASTPUT=SETON;            /* INDICATE END OF FILE  @Y30OE72*/ 04225000
         OI    LASTPUT,B'00010000'                                 1329 04226000
*         CALL WRITETRK;            /* FLUSH BUFFERS         @Y30OE72*/ 04227000
         BAL   @14,WRITETRK                                        1330 04228000
*         LASTPUT=SETOFF;           /* RESET                 @Y30OE72*/ 04229000
         NI    LASTPUT,B'11101111'                                 1331 04230000
*       END;                        /*                       @Y30OE72*/ 04231000
*   GOTO CONT1;                     /*                       @Y30OE72*/ 04232000
         B     CONT1                                               1333 04233000
*SYNADQS:                           /* SYNAD ROUTINE         @Y30OE72*/ 04234000
*   I520DDNM=SYSUT2DD;              /* DDNAME INTO MSG       @Y30OE72*/ 04235000
SYNADQS  MVC   I520DDNM(8),@CC02093                                1334 04236000
*   REG1=ADDR(IEB520I);             /* ISSUE                 @Y30OE72*/ 04237000
         LA    REG1,IEB520I                                        1335 04238000
*   MSGLEN=LENGTH(IEB520I);         /* MESSAGE               @Y30OE72*/ 04239000
         MVI   MSGLEN,X'1A'                                        1336 04240000
*   CALL MSGWRTR;                   /* IEB520I               @Y30OE72*/ 04241000
         BAL   @14,MSGWRTR                                         1337 04242000
*   FAILSW=ON;                      /* TERMINATE RUN         @Y30OE72*/ 04243000
         MVC   FAILSW(1),ON                                        1338 04244000
*CONT1:                             /*                       @Y30OE72*/ 04245000
*   END WRITE1;                     /* PROCEDURE END         @Y30OE72*/ 04246000
@EL00016 DS    0H                                                  1339 04247000
@EF00016 DS    0H                                                  1339 04248000
@ER00016 L     @14,@SA00016                                        1339 04249000
         BR    @14                                                 1339 04250000
*                                                                  1340 04251000
*/********************************************************************/ 04252000
*/*                                                          @Y30OE72*/ 04253000
*/* ROUTINE NAME = READSECT                                  @Y30OE72*/ 04254000
*/*                                                          @Y30OE72*/ 04255000
*/* FUNCTION = READ INPUT DISKETTE. RECORDS ARE READ A       @Y30OE72*/ 04256000
*/*            SECTOR AT A TIME. DOUBLE BUFFERING IS USED.   @Y30OE72*/ 04257000
*/*            AFTER A SECTOR IS READ THE IOB & ECB ARE      @Y30OE72*/ 04258000
*/*            CHECKED TO DETERMINE IF A 'D' OR 'F' RECORD   @Y30OE72*/ 04259000
*/*            OR PERMANENT I/O ERROR WAS ENCOUNTERED.       @Y30OE72*/ 04260000
*/*            SWITCHES ARE SET TO INDICATE SUCH CONDITIONS  @Y30OE72*/ 04261000
*/*            TO THE CALLER. WHEN SUCH AN ERROR RECORD IS   @Y30OE72*/ 04262000
*/*            FOUND, THE OTHER IOB IS CHECKED TO SEE IF IT  @Y30OE72*/ 04263000
*/*            IS PURGED. IF IT IS, IT IS RESTORED TO ITS    @Y30OE72*/ 04264000
*/*            PRE-ERROR STATUS AND THE I/O IS REISSUED.     @Y30OE72*/ 04265000
*/*                                                          @Y30OE72*/ 04266000
*/* INPUT = IN1IOB,IN2IOB AND THEIR ASSOCIATED ECBS,CCW      @Y30OE72*/ 04267000
*/*         CHAINS & BUFFERS.                                @Y30OE72*/ 04268000
*/*         FIRSTIO SWITCH SETON FOR THE 1ST REQUEST TO READ @Y30OE72*/ 04269000
*/*         FROM A DATA SET.                                 @Y30OE72*/ 04270000
*/*         LASTREC FILE CONSTANT - DSKT ADDRESS OF LAST     @Y30OE72*/ 04271000
*/*                                 RECORD TO BE READ        @Y30OE72*/ 04272000
*/*                                                          @Y30OE72*/ 04273000
*/* OUTPUT = DATA RECORD IN RECBUF1 OR RECBUF2 (MAPPED BY    @Y30OE72*/ 04274000
*/*          RECBUF)                                         @Y30OE72*/ 04275000
*/*          DFSWITCH SETON IF A 'D' OR 'F' RECORD WAS READ  @Y30OE72*/ 04276000
*/*          BADRECSW SETON IF A PERMANENT I/O WAS FOUND     @Y30OE72*/ 04277000
*/*                                                          @Y30OE72*/ 04278000
*/* ROUTINES CALLED = NONE                                   @Y30OE72*/ 04279000
*/*                                                          @Y30OE72*/ 04280000
*/* MACROS = EXCP,WAIT                                       @Y30OE72*/ 04281000
*/*                                                          @Y30OE72*/ 04282000
*/********************************************************************/ 04283000
*                                                                  1340 04284000
*READSECT:                          /*                       @Y30OE72*/ 04285000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30OE72*/ 04286000
READSECT ST    @14,@SA00017                                        1340 04287000
*   DFSWITCH=OFF;                   /* RESET                 @Y30OE72*/ 04288000
         MVC   DFSWITCH(1),OFF                                     1341 04289000
*   BADRECSW=OFF;                   /* SWITCHES              @Y30OE72*/ 04290000
*                                                                  1342 04291000
         MVC   BADRECSW(1),OFF                                     1342 04292000
*   /*****************************************************************/ 04293000
*   /*                                                               */ 04294000
*   /* IF FIRST REQUEST FOR THIS DATA SET, THEN INITIALIZE   @Y30OE72*/ 04295000
*   /* TABLES AND PRIME FIRST BUFFER                         @Y30OE72*/ 04296000
*   /*                                                               */ 04297000
*   /*****************************************************************/ 04298000
*                                                                  1343 04299000
*   IF FIRSTIO=SETON THEN           /* BEGINNING OF DATA SET @Y30OE72*/ 04300000
         TM    FIRSTIO,B'10000000'                                 1343 04301000
         BNO   @RF01343                                            1343 04302000
*     DO;                           /* YES. PRIME 1ST BUFFER @Y30OE72*/ 04303000
*       IF SC=ZERO&                 /* READING VOL LABEL     @Y30OE72*/ 04304000
*           SR=VOLLABEL THEN        /* SECTOR?               @Y30OE72*/ 04305000
         ICM   @12,3,SC                                            1345 04306000
         BNZ   @RF01345                                            1345 04307000
         CLC   SR(2),@CH00033                                      1345 04308000
         BNE   @RF01345                                            1345 04309000
*         DO;                       /* YES.                  @Y30OE72*/ 04310000
*           MODESWIT=UCBZERO;       /* FOR UCBDEBUP RTN      @Y30OE72*/ 04311000
         MVI   MODESWIT,X'01'                                      1347 04312000
*           IF IN1DCBPT=ADDR(SYSUT2EX) THEN/* READING SYSUT2 @Y30OE72*/ 04313000
         LA    @12,SYSUT2EX                                        1348 04314000
         SLR   @11,@11                                             1348 04315000
         ICM   @11,7,IN1DCBPT                                      1348 04316000
         CR    @12,@11                                             1348 04317000
         BNE   @RF01348                                            1348 04318000
*             TIOTADDR=WORKSYS2;    /* YES. PT TO SYSUT2 ENT @Y30OE72*/ 04319000
         SLR   @12,@12                                             1349 04320000
         ICM   @12,7,WORKSYS2                                      1349 04321000
         ST    @12,TIOTADDR                                        1349 04322000
*           ELSE                    /* NO.                   @Y30OE72*/ 04323000
*             TIOTADDR=WORKSYS1;    /* SYSUT1 TIOT ENTRY     @Y30OE72*/ 04324000
         B     @RC01348                                            1350 04325000
@RF01348 SLR   @12,@12                                             1350 04326000
         ICM   @12,7,WORKSYS1                                      1350 04327000
         ST    @12,TIOTADDR                                        1350 04328000
*           CALL UCBDEBUP;          /* GO ZERO VLSER         @Y30OE72*/ 04329000
@RC01348 BAL   @14,UCBDEBUP                                        1351 04330000
*         END;                      /*                       @Y30OE72*/ 04331000
*       IOBPTR=ADDR(IN1IOB);        /* POINT TO FIRST IOB    @Y30OE72*/ 04332000
@RF01345 LA    @12,IN1IOB                                          1353 04333000
         ST    @12,IOBPTR                                          1353 04334000
*       REG1=IOBDCBPB;              /* PT TO DCB             @ZA04492*/ 04335000
         SLR   REG1,REG1                                           1354 04336000
         ICM   REG1,7,IOBDCBPB(@12)                                1354 04337000
*       DCBIFEC=SETOFF;             /* DCB PIOERR OFF        @Y30OE72*/ 04338000
         NI    DCBIFEC+40(REG1),B'00111111'                        1355 04339000
*       DO K=1 TO 2;                /* CLEAN UP IOBS         @Y30OE72*/ 04340000
         LA    K,1                                                 1356 04341000
@DL01356 DS    0H                                                  1357 04342000
*         IOBECBCC=GOODIO;          /* MARK ECBS COMPLETE    @Y30OE72*/ 04343000
         L     @12,IOBPTR                                          1357 04344000
         LR    @11,@12                                             1357 04345000
         AL    @11,@CF03567                                        1357 04346000
         MVI   IOBECBCC-4(@11),X'7F'                               1357 04347000
*         IOBMAP(1:4)=ZEROREC(1:4); /* RESET IOB             @Y30OE72*/ 04348000
         MVC   IOBMAP(4,@12),ZEROREC                               1358 04349000
*         IOBMAP(1)='40'X;          /* TO                    @Y30OE72*/ 04350000
         MVI   IOBMAP(@12),X'40'                                   1359 04351000
*         IOBMAP(5)=ZERO;           /* PRE                   @Y30OE72*/ 04352000
         MVI   IOBMAP+4(@12),X'00'                                 1360 04353000
*         IOBMAP(9:17)=ZEROREC(1:9);/* ERROR                 @Y30OE72*/ 04354000
         MVC   IOBMAP+8(9,@12),ZEROREC                             1361 04355000
*         IOBMAP(29:32)=ZEROREC(1:4);/* STATUS               @Z30OE72*/ 04356000
         MVC   IOBMAP+28(4,@12),ZEROREC                            1362 04357000
*         IOBPTR=IOBIOB@;           /* POINT TO OTHER IOB    @Y30OE72*/ 04358000
         L     @12,IOBIOB@(,@12)                                   1363 04359000
         ST    @12,IOBPTR                                          1363 04360000
*       END;                        /*                       @Y30OE72*/ 04361000
         AL    K,@CF00052                                          1364 04362000
         CH    K,@CH00070                                          1364 04363000
         BNH   @DL01356                                            1364 04364000
*       IOBPTR=ADDR(IN1IOB);        /* POINT TO FIRST IOB    @Y30OE72*/ 04365000
         LA    @12,IN1IOB                                          1365 04366000
         ST    @12,IOBPTR                                          1365 04367000
*       IOBSKTT=SC;                 /* INITIALIZE            @Y30OE72*/ 04368000
         MVC   IOBSKTT(1,@12),SC+1                                 1366 04369000
*       IOBSKSS=SR;                 /* SEEK ADDRESS          @Y30OE72*/ 04370000
         MVC   IOBSKSS(1,@12),SR+1                                 1367 04371000
*       IOBECB=ZEROREC(1:4);        /* CLEAR ECB             @Y30OE72*/ 04372000
         LR    @11,@12                                             1368 04373000
         AL    @11,@CF03567                                        1368 04374000
         MVC   IOBECB-4(4,@11),ZEROREC                             1368 04375000
*       REG1=IOBPTR;                /* SET UP TO ISSUE I/O   @Y30OE72*/ 04376000
         LR    REG1,@12                                            1369 04377000
*       RECBUF=BLANK;               /* CLEAR BUFFER          @Y30OE72*/ 04378000
         ICM   @11,7,CCWRDADD(@12)                                 1370 04379000
         MVC   RECBUF(128,@11),BLANK                               1370 04380000
*       GEN(EXCP (REG1));           /* ISSUE EXCP            @Y30OE72*/ 04381000
         EXCP (REG1)                                                    04382000
*       IOBPTR=IOBIOB@;             /* POINT TO OTHER IOB    @Y30OE72*/ 04383000
         L     @12,IOBPTR                                          1372 04384000
         L     @12,IOBIOB@(,@12)                                   1372 04385000
         ST    @12,IOBPTR                                          1372 04386000
*       IF SR=SECTOR1 THEN          /* START ON TRK BOUND?   @Y30OE72*/ 04387000
         LH    @11,SR                                              1373 04388000
         SLR   @00,@00                                             1373 04389000
         IC    @00,SECTOR1                                         1373 04390000
         CR    @11,@00                                             1373 04391000
         BNE   @RF01373                                            1373 04392000
*         DO;                       /* YES.                  @Y30OE72*/ 04393000
*           IOBSKTT=SC-1;           /* IOBSKADR OF 2ND IOB = @Y30OE72*/ 04394000
         LH    @11,SC                                              1375 04395000
         BCTR  @11,0                                               1375 04396000
         STC   @11,IOBSKTT(,@12)                                   1375 04397000
*           IOBSKSS=SECTOR26;       /* START ADDRESS         @Y30OE72*/ 04398000
         MVI   IOBSKSS(@12),X'1A'                                  1376 04399000
*         END;                      /* MINUS ONE             @Y30OE72*/ 04400000
*       ELSE                        /* NOT ON TRK BOUND      @Y30OE72*/ 04401000
*         DO;                       /* IOBSKADR OF 2ND IOB = @Y30OE72*/ 04402000
         B     @RC01373                                            1378 04403000
@RF01373 DS    0H                                                  1379 04404000
*           IOBSKTT=SC;             /* START ADDRESS         @Y30OE72*/ 04405000
         L     @12,IOBPTR                                          1379 04406000
         MVC   IOBSKTT(1,@12),SC+1                                 1379 04407000
*           IOBSKSS=SR-1;           /* MINUS                 @Y30OE72*/ 04408000
         LH    @11,SR                                              1380 04409000
         BCTR  @11,0                                               1380 04410000
         STC   @11,IOBSKSS(,@12)                                   1380 04411000
*         END;                      /* ONE                   @Y30OE72*/ 04412000
*     END;                          /*                       @Y30OE72*/ 04413000
*                                                                  1382 04414000
@RC01373 DS    0H                                                  1383 04415000
*   /*****************************************************************/ 04416000
*   /*                                                               */ 04417000
*   /* COMMON PROCESSING - UPDATE READ ADDRESS AND ISSUE     @Y30OE72*/ 04418000
*   /* I/O TO FILL A BUFFER                                  @Y30OE72*/ 04419000
*   /*                                                               */ 04420000
*   /*****************************************************************/ 04421000
*                                                                  1383 04422000
*   IF IOBSKSS<SECTOR25 THEN        /* END OF TRACK?         @Y30OE72*/ 04423000
@RF01343 L     @12,IOBPTR                                          1383 04424000
         CLI   IOBSKSS(@12),25                                     1383 04425000
         BNL   @RF01383                                            1383 04426000
*     IOBSKSS=IOBSKSS+NUMIOB;       /* NO. BUMP SECTOR BY 2  @Y30OE72*/ 04427000
         LA    @11,2                                               1384 04428000
         SLR   @00,@00                                             1384 04429000
         IC    @00,IOBSKSS(,@12)                                   1384 04430000
         ALR   @11,@00                                             1384 04431000
         STC   @11,IOBSKSS(,@12)                                   1384 04432000
*   ELSE                            /* YES.                  @Y30OE72*/ 04433000
*     DO;                           /* THEN                  @Y30OE72*/ 04434000
         B     @RC01383                                            1385 04435000
@RF01383 DS    0H                                                  1386 04436000
*       IF IOBSKSS=SECTOR25 THEN    /* BUMP SECTOR           @Y30OE72*/ 04437000
         L     @12,IOBPTR                                          1386 04438000
         CLI   IOBSKSS(@12),25                                     1386 04439000
         BNE   @RF01386                                            1386 04440000
*         IOBSKSS=SECTOR1;          /* NUMBER TO             @Y30OE72*/ 04441000
         MVC   IOBSKSS(1,@12),SECTOR1                              1387 04442000
*       ELSE                        /* NEXT                  @Y30OE72*/ 04443000
*         IOBSKSS=SECTOR2;          /* TRACK                 @Y30OE72*/ 04444000
         B     @RC01386                                            1388 04445000
@RF01386 L     @12,IOBPTR                                          1388 04446000
         MVC   IOBSKSS(1,@12),SECTOR2                              1388 04447000
*       IOBSKTT=IOBSKTT+1;          /* BUMP TO NEXT TRK      @Y30OE72*/ 04448000
@RC01386 L     @12,IOBPTR                                          1389 04449000
         LA    @11,1                                               1389 04450000
         SLR   @00,@00                                             1389 04451000
         IC    @00,IOBSKTT(,@12)                                   1389 04452000
         ALR   @11,@00                                             1389 04453000
         STC   @11,IOBSKTT(,@12)                                   1389 04454000
*     END;                          /* END END-OF-TRK PROCES @Y30OE72*/ 04455000
*   IF IOBSKADR<=LASTREC THEN       /* LAST REC BEEN READ    @Y30OE72*/ 04456000
@RC01383 L     @12,IOBPTR                                          1391 04457000
         CLC   IOBSKADR(4,@12),LASTREC                             1391 04458000
         BH    @RF01391                                            1391 04459000
*     DO;                           /* NO.                   @Y30OE72*/ 04460000
*       IOBECB=ZEROREC(1:4);        /* CLEAR ECB             @Y30OE72*/ 04461000
         LR    @11,@12                                             1393 04462000
         AL    @11,@CF03567                                        1393 04463000
         MVC   IOBECB-4(4,@11),ZEROREC                             1393 04464000
*       REG1=IOBPTR;                /* SET UP FOR I/O        @Y30OE72*/ 04465000
         LR    REG1,@12                                            1394 04466000
*       RECBUF=BLANK;               /* CLEAR BUFFER          @Y30OE72*/ 04467000
         ICM   @11,7,CCWRDADD(@12)                                 1395 04468000
         MVC   RECBUF(128,@11),BLANK                               1395 04469000
*       GEN(EXCP (REG1));           /* ISSUE EXCP            @Y30OE72*/ 04470000
         EXCP (REG1)                                                    04471000
*     END;                          /*                       @Y30OE72*/ 04472000
*   IOBPTR=IOBIOB@;                 /* POINT TO OTHER IOB    @Y30OE72*/ 04473000
@RF01391 L     @12,IOBPTR                                          1398 04474000
         L     @12,IOBIOB@(,@12)                                   1398 04475000
         ST    @12,IOBPTR                                          1398 04476000
*   IF IOBECBC^=SETON THEN          /* ECB COMPLETE?         @Y30OE72*/ 04477000
         SH    @12,@CH00034                                        1399 04478000
         TM    IOBECBC(@12),B'01000000'                            1399 04479000
         BO    @RF01399                                            1399 04480000
*     DO;                           /* NO.                   @Y30OE72*/ 04481000
*       REG1=ADDR(IOBECB);          /* SET UP FOR WAIT       @Y30OE72*/ 04482000
         LA    REG1,IOBECB(,@12)                                   1401 04483000
*       GEN(WAIT ECB=(REG1));       /* ISSUE WAIT            @Y30OE72*/ 04484000
         WAIT ECB=(REG1)                                                04485000
*     END;                          /*                       @Y30OE72*/ 04486000
*                                                                  1403 04487000
*   /*****************************************************************/ 04488000
*   /*                                                               */ 04489000
*   /* CHECK PASSBACK FOR SPECIAL RECORDS TRANSFERRED OR     @Y30OE72*/ 04490000
*   /* PERMANENT I/O ERRORS                                  @Y30OE72*/ 04491000
*   /*                                                               */ 04492000
*   /*****************************************************************/ 04493000
*                                                                  1404 04494000
*   IF IOBECBCC=GOODIO THEN         /* ANY ERRORS IN I/O?    @Y30OE72*/ 04495000
@RF01399 L     @12,IOBPTR                                          1404 04496000
         LR    @11,@12                                             1404 04497000
         AL    @11,@CF03567                                        1404 04498000
         CLI   IOBECBCC-4(@11),X'7F'                               1404 04499000
         BNE   @RF01404                                            1404 04500000
*     IF IOBSKTT=TRACK0 THEN        /* NO. IS IT TRACK 0?    @Y30OE72*/ 04501000
         CLC   IOBSKTT(1,@12),TRACK0                               1405 04502000
         BNE   @RF01405                                            1405 04503000
*       IF                          /* YES. IS IT            @Y30OE72*/ 04504000
*           (DATABYT1=CHARD|DATABYT1='44'X|/* A 'D' OR       @Y30OE72*/ 04505000
*           DATABYT1=CHARF|DATABYT1='46'X) THEN/* 'F' RECORD?      1406 04506000
*                                                            @Y30OE72*/ 04507000
         SLR   @11,@11                                             1406 04508000
         ICM   @11,7,CCWRDADD(@12)                                 1406 04509000
         CLI   DATABYT1(@11),C'D'                                  1406 04510000
         BE    @RT01406                                            1406 04511000
         CLI   DATABYT1(@11),X'44'                                 1406 04512000
         BE    @RT01406                                            1406 04513000
         CLI   DATABYT1(@11),C'F'                                  1406 04514000
         BE    @RT01406                                            1406 04515000
         CLI   DATABYT1(@11),X'46'                                 1406 04516000
         BNE   @RF01406                                            1406 04517000
@RT01406 DS    0H                                                  1407 04518000
*         DFSWITCH=ON;              /* YES. SET IND FOR CALR @Y30OE72*/ 04519000
         MVC   DFSWITCH(1),ON                                      1407 04520000
*       ELSE                                                       1408 04521000
*         ;                         /*                       @Y30OE72*/ 04522000
@RF01406 DS    0H                                                  1409 04523000
*     ELSE                                                         1409 04524000
*       ;                           /*                       @Y30OE72*/ 04525000
@RF01405 DS    0H                                                  1410 04526000
*   ELSE                            /* I/O ERRORS            @Y30OE72*/ 04527000
*     DO;                           /*                       @Y30OE72*/ 04528000
         B     @RC01404                                            1410 04529000
@RF01404 DS    0H                                                  1411 04530000
*       IF IOBDATAC=SETON&          /* DATA CHECK &          @Y30OE72*/ 04531000
*           IOBSRECT=SETON&         /* SPEC REC TRANSFER &   @Y30OE72*/ 04532000
*           (DATABYT1=CHARD|DATABYT1='44'X|/* A 'D' OR       @Y30OE72*/ 04533000
*           DATABYT1=CHARF|DATABYT1='46'X) THEN/* 'F' RECORD?      1411 04534000
*                                                            @Y30OE72*/ 04535000
         L     @12,IOBPTR                                          1411 04536000
         TM    IOBDATAC(@12),B'00001000'                           1411 04537000
         BNO   @RF01411                                            1411 04538000
         TM    IOBSRECT(@12),B'00001000'                           1411 04539000
         BNO   @RF01411                                            1411 04540000
         SLR   @11,@11                                             1411 04541000
         ICM   @11,7,CCWRDADD(@12)                                 1411 04542000
         CLI   DATABYT1(@11),C'D'                                  1411 04543000
         BE    @RT01411                                            1411 04544000
         CLI   DATABYT1(@11),X'44'                                 1411 04545000
         BE    @RT01411                                            1411 04546000
         CLI   DATABYT1(@11),C'F'                                  1411 04547000
         BE    @RT01411                                            1411 04548000
         CLI   DATABYT1(@11),X'46'                                 1411 04549000
         BNE   @RF01411                                            1411 04550000
@RT01411 DS    0H                                                  1412 04551000
*         DO;                       /* YES.                  @Y30OE72*/ 04552000
*           DFSWITCH=ON;            /* SET IND FOR CALLER    @Y30OE72*/ 04553000
         MVC   DFSWITCH(1),ON                                      1413 04554000
*           LRT=LRT+1;              /* INCR # OF LOST RECS   @Y30OE72*/ 04555000
         LH    @12,LRT                                             1414 04556000
         LA    @12,1(,@12)                                         1414 04557000
         STH   @12,LRT                                             1414 04558000
*         END;                      /*                       @Y30OE72*/ 04559000
*       ELSE                        /* NO. THEN ITS A        @Y30OE72*/ 04560000
*         BADRECSW=ON;              /* BAD RECORD            @Y30OE72*/ 04561000
         B     @RC01411                                            1416 04562000
@RF01411 MVC   BADRECSW(1),ON                                      1416 04563000
*       IOBPTR=IOBIOB@;             /* POINT TO OTHER IOB    @Y30OE72*/ 04564000
@RC01411 L     @12,IOBPTR                                          1417 04565000
         L     @12,IOBIOB@(,@12)                                   1417 04566000
         ST    @12,IOBPTR                                          1417 04567000
*       IF IOBECBC^=SETON THEN      /* ECB COMPLETE?         @Y30OE72*/ 04568000
         SH    @12,@CH00034                                        1418 04569000
         TM    IOBECBC(@12),B'01000000'                            1418 04570000
         BO    @RF01418                                            1418 04571000
*         DO;                       /* NO.                   @Y30OE72*/ 04572000
*           REG1=ADDR(IOBECB);      /* SET UP FOR WAIT       @Y30OE72*/ 04573000
         LA    REG1,IOBECB(,@12)                                   1420 04574000
*           GEN(WAIT ECB=(REG1));   /* ISSUE WAIT            @Y30OE72*/ 04575000
         WAIT ECB=(REG1)                                                04576000
*         END;                      /*                       @Y30OE72*/ 04577000
*       IF IOBECBCC^=GOODIO THEN    /* I/O OK?               @Y30OE72*/ 04578000
@RF01418 L     @12,IOBPTR                                          1423 04579000
         LR    @11,@12                                             1423 04580000
         SH    @11,@CH00034                                        1423 04581000
         CLI   IOBECBCC(@11),X'7F'                                 1423 04582000
         BE    @RF01423                                            1423 04583000
*         DO;                       /* NO. RESET             @Y30OE72*/ 04584000
*           REG1=IOBDCBPB;          /* PT TO DCB             @ZA04492*/ 04585000
         SLR   REG1,REG1                                           1425 04586000
         ICM   REG1,7,IOBDCBPB(@12)                                1425 04587000
*           DCBIFEC=SETOFF;         /* DCB PIOERR OFF        @Y30OE72*/ 04588000
         NI    DCBIFEC+40(REG1),B'00111111'                        1426 04589000
*           IOBMAP(1:4)=ZEROREC(1:4);/* RESET IOB            @Y30OE72*/ 04590000
         MVC   IOBMAP(4,@12),ZEROREC                               1427 04591000
*           IOBMAP(1)='40'X;        /* TO                    @Y30OE72*/ 04592000
         MVI   IOBMAP(@12),X'40'                                   1428 04593000
*           IOBMAP(5)=ZERO;         /* PRE                   @Y30OE72*/ 04594000
         MVI   IOBMAP+4(@12),X'00'                                 1429 04595000
*           IOBMAP(9:17)=ZEROREC(1:9);/* ERROR               @Y30OE72*/ 04596000
         MVC   IOBMAP+8(9,@12),ZEROREC                             1430 04597000
*           IOBMAP(29:32)=ZEROREC(1:4);/* STATUS             @Z30OE72*/ 04598000
         MVC   IOBMAP+28(4,@12),ZEROREC                            1431 04599000
*           IF IOBECBCC=PURGED THEN /* WAS IT PURGED?        @Y30OE72*/ 04600000
         CLI   IOBECBCC(@11),X'48'                                 1432 04601000
         BNE   @RF01432                                            1432 04602000
*             DO;                   /* YES.                  @Y30OE72*/ 04603000
*               IOBECB=ZEROREC(1:4);/* CLEAR ECB             @Y30OE72*/ 04604000
         MVC   IOBECB(4,@11),ZEROREC                               1434 04605000
*               REG1=IOBPTR;        /* SET UP FOR I/O        @Y30OE72*/ 04606000
         LR    REG1,@12                                            1435 04607000
*               RECBUF=BLANK;       /* CLEAR BUFFER          @Y30OE72*/ 04608000
         ICM   @11,7,CCWRDADD(@12)                                 1436 04609000
         MVC   RECBUF(128,@11),BLANK                               1436 04610000
*               GEN(EXCP (REG1));   /* ISSUE EXCP            @Y30OE72*/ 04611000
         EXCP (REG1)                                                    04612000
*             END;                  /*                       @Y30OE72*/ 04613000
*           ELSE                    /* NOT PURGED            @Y30OE72*/ 04614000
*             IOBECB=ZEROREC(1:4);  /* CLEAR ECB             @Y30OE72*/ 04615000
         B     @RC01432                                            1439 04616000
@RF01432 L     @12,IOBPTR                                          1439 04617000
         AL    @12,@CF03567                                        1439 04618000
         MVC   IOBECB-4(4,@12),ZEROREC                             1439 04619000
*         END;                      /*                       @Y30OE72*/ 04620000
@RC01432 DS    0H                                                  1441 04621000
*       IOBPTR=IOBIOB@;             /* POINT TO OTHER IOB    @Y30OE72*/ 04622000
@RF01423 L     @12,IOBPTR                                          1441 04623000
         L     @12,IOBIOB@(,@12)                                   1441 04624000
         ST    @12,IOBPTR                                          1441 04625000
*     END;                          /*                       @Y30OE72*/ 04626000
*   END READSECT;                   /*                       @Y30OE72*/ 04627000
@EL00017 DS    0H                                                  1443 04628000
@EF00017 DS    0H                                                  1443 04629000
@ER00017 L     @14,@SA00017                                        1443 04630000
         BR    @14                                                 1443 04631000
*                                                                  1444 04632000
*/********************************************************************/ 04633000
*/*                                                          @Y30OE72*/ 04634000
*/* ROUTINE NAME = WRITETRK                                  @Y30OE72*/ 04635000
*/*                                                          @Y30OE72*/ 04636000
*/* FUNCTION = WRITE DATA TO THE OUTPUT DISKETTE. DOUBLE     @Y30OE72*/ 04637000
*/*            BUFFERING WITH FULL-TRACK BUFFERS IS USED.    @Y30OE72*/ 04638000
*/*                                                          @Y30OE72*/ 04639000
*/* INPUT = OT1IOB,OT2IOB AND THEIR ASSOCIATED ECBS,CCW      @Y30OE72*/ 04640000
*/*         CHAINS AND BUFFERS.                              @Y30OE72*/ 04641000
*/*         FIRSTPUT SWITCH SETON TO INDICATE 1ST RECORD TO  @Y30OE72*/ 04642000
*/*         BE WRITTEN.                                      @Y30OE72*/ 04643000
*/*         LASTPUT SWITCH SETON TO INDICATE NO MORE RECORDS @Y30OE72*/ 04644000
*/*         TO BE WRITTEN(I.E. FLUSH BUFFERS).               @Y30OE72*/ 04645000
*/*                                                          @Y30OE72*/ 04646000
*/* OUTPUT = DATA RECORD MOVED FROM RECBUF INTO OUTPUT       @Y30OE72*/ 04647000
*/*          BUFFER.                                         @Y30OE72*/ 04648000
*/*                                                          @Y30OE72*/ 04649000
*/* ROUTINES CALLED = WRITEIO - TO WRITE A BUFFER (TRACK) OF @Y30OE72*/ 04650000
*/*                             DATA TO THE OUTPUT DISKETTE. @Y30OE72*/ 04651000
*/*                                                          @Y30OE72*/ 04652000
*/* MACROS = NONE                                            @Y30OE72*/ 04653000
*/*                                                          @Y30OE72*/ 04654000
*/********************************************************************/ 04655000
*                                                                  1444 04656000
*WRITETRK:                          /*                       @Y30OE72*/ 04657000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30OE72*/ 04658000
WRITETRK ST    @14,@SA00018                                        1444 04659000
*   IF LASTPUT=SETON THEN           /* END OF DATA SET?      @Y30OE72*/ 04660000
         TM    LASTPUT,B'00010000'                                 1445 04661000
         BNO   @RF01445                                            1445 04662000
*     DO;                           /* YES.                  @Y30OE72*/ 04663000
*       MODE=QUIESCE;               /* IND END OF DATA SET   @Y30OE72*/ 04664000
         MVI   MODE,C'Q'                                           1447 04665000
*       CALL WRITEIO;               /* FLUSH BUFFERS         @Y30OE72*/ 04666000
         BAL   @14,WRITEIO                                         1448 04667000
*       IF WRTDDR1=ON               /* WRT W/CONTROL REQ     @ZA28058*/ 04668000
*         THEN                      /* YES                   @ZA28058*/ 04669000
         CLC   WRTDDR1(1),ON                                       1449 04670000
         BNE   @RF01449                                            1449 04671000
*         DO;                       /*                       @ZA28058*/ 04672000
*           CCWPTR=ADDR(OT1WTCCW);  /* GET CURRENT PTR CCW   @ZA28058*/ 04673000
         LA    @12,OT1WTCCW                                        1451 04674000
         ST    @12,CCWPTR                                          1451 04675000
*           DO I=1 TO 19;           /* CHANGE 19 CCW'S       @ZA28058*/ 04676000
         LA    @12,1                                               1452 04677000
         ST    @12,I                                               1452 04678000
@DL01452 DS    0H                                                  1453 04679000
*             CURCCWOP=WRITE;       /* RESTORE WRT OP CODE   @ZA28058*/ 04680000
         L     @11,CCWPTR                                          1453 04681000
         MVI   CURCCWOP(@11),X'05'                                 1453 04682000
*             CCWPTR=CCWPTR+CCWLEN; /* PNT TO NEXT CCW       @ZA28058*/ 04683000
         AH    @11,@CH00034                                        1454 04684000
         ST    @11,CCWPTR                                          1454 04685000
*           END;                    /*                       @ZA28058*/ 04686000
         AL    @12,@CF00052                                        1455 04687000
         ST    @12,I                                               1455 04688000
         CH    @12,@CH02061                                        1455 04689000
         BNH   @DL01452                                            1455 04690000
*         END;                      /*                       @ZA28058*/ 04691000
*       OTIOBPTR=OTIOBNXT;          /* PT TO OTHER IOB       @Y30OE72*/ 04692000
@RF01449 L     @12,OTIOBPTR                                        1457 04693000
         L     @12,OTIOBNXT(,@12)                                  1457 04694000
         ST    @12,OTIOBPTR                                        1457 04695000
*       DFOPSCNT=0;                 /* RESET DEFINE OPS CNT  @Y30OE72*/ 04696000
         MVI   DFOPSCNT(@12),X'00'                                 1458 04697000
*     END;                          /* END LAST PUT PROCESS  @Y30OE72*/ 04698000
*   ELSE                            /* NOT END OF DATA SET   @Y30OE72*/ 04699000
*     DO;                           /*                       @Y30OE72*/ 04700000
         B     @RC01445                                            1460 04701000
@RF01445 DS    0H                                                  1461 04702000
*       IF FIRSTPUT=SETON THEN      /* BEGINNING OF DATA SET @Y30OE72*/ 04703000
         TM    FIRSTPUT,B'00100000'                                1461 04704000
         BNO   @RF01461                                            1461 04705000
*         DO;                       /* YES.                  @Y30OE72*/ 04706000
*           STARTREC=SR;            /* SET FOR WRITEIO       @Y30OE72*/ 04707000
         LH    @12,SR                                              1463 04708000
         STC   @12,STARTREC                                        1463 04709000
*           OTIOBPTR=ADDR(OT1IOB);  /* POINT TO 1ST IOB      @Y30OE72*/ 04710000
         LA    @11,OT1IOB                                          1464 04711000
         ST    @11,OTIOBPTR                                        1464 04712000
*           OT1SKTT=SC;             /* 1ST IOB SEEK @        @Y30OE72*/ 04713000
         LH    @11,SC                                              1465 04714000
         STC   @11,OT1SKTT                                         1465 04715000
*           OT1SKSS=SR;             /* = BOE                 @Y30OE72*/ 04716000
         STC   @12,OT1SKSS                                         1466 04717000
*           OT2SKTT=SC-1;           /* 2ND IOB SEEK @        @Y30OE72*/ 04718000
         BCTR  @11,0                                               1467 04719000
         STC   @11,OT2SKTT                                         1467 04720000
*           OT2SKSS=SECTOR1;        /* = BOE TT - 1          @Y30OE72*/ 04721000
         MVC   OT2SKSS(1),SECTOR1                                  1468 04722000
*           OT2ECBCC=GOODIO;        /* MARK 2ND BUFF COMPLTE @Y30OE72*/ 04723000
         MVI   OT2ECBCC,X'7F'                                      1469 04724000
*           CCWPTR=ADDR(OT1WTCCW);  /* PT TO 1ST WRITE CCW   @Y30OE72*/ 04725000
         LA    @12,OT1WTCCW                                        1470 04726000
         ST    @12,CCWPTR                                          1470 04727000
*           IF CURCCWOP=TIC THEN    /* 1ST CCW A TIC?        @Y30OE72*/ 04728000
         CLI   CURCCWOP(@12),8                                     1471 04729000
         BNE   @RF01471                                            1471 04730000
*             DO;                   /* YES.                  @Y30OE72*/ 04731000
*               TICCCW=TICCCW&&OT1WTCCW;/* RESTORE           @Y30OE72*/ 04732000
         XC    TICCCW(8),OT1WTCCW                                  1473 04733000
*               OT1WTCCW=OT1WTCCW&&TICCCW;/* FIRST           @Y30OE72*/ 04734000
         XC    OT1WTCCW(8),TICCCW                                  1474 04735000
*               TICCCW=TICCCW&&OT1WTCCW;/* WRITE CCW         @Y30OE72*/ 04736000
         XC    TICCCW(8),OT1WTCCW                                  1475 04737000
*             END;                  /*                       @Y30OE72*/ 04738000
*           IF STARTREC^=SECTOR1 THEN/* NON-TRK-BDY START?   @Y30OE72*/ 04739000
@RF01471 CLC   STARTREC(1),SECTOR1                                 1477 04740000
         BE    @RF01477                                            1477 04741000
*             CCWPTR=ADDR(OT1WTCCW)+/* YES. SET CCWPTR TO    @Y30OE72*/ 04742000
*                 ((STARTREC-1)*CCWLEN);/* PROPER WRITE CCW  @Y30OE72*/ 04743000
         LA    @12,OT1WTCCW                                        1478 04744000
         SLR   @11,@11                                             1478 04745000
         IC    @11,STARTREC                                        1478 04746000
         BCTR  @11,0                                               1478 04747000
         SLA   @11,3                                               1478 04748000
         ALR   @12,@11                                             1478 04749000
         ST    @12,CCWPTR                                          1478 04750000
*           FIRSTPUT=SETOFF;        /* RESET                 @Y30OE72*/ 04751000
@RF01477 NI    FIRSTPUT,B'11011111'                                1479 04752000
*         END;                      /*                       @Y30OE72*/ 04753000
*       IF CCWPTR=ADDR(OTNOOP) THEN /* BUFFER FULL?          @Y30OE72*/ 04754000
@RF01461 L     @12,OTIOBPTR                                        1481 04755000
         LA    @12,OTNOOP(,@12)                                    1481 04756000
         C     @12,CCWPTR                                          1481 04757000
         BNE   @RF01481                                            1481 04758000
*         DO;                       /* YES.                  @Y30OE72*/ 04759000
*           MODE=FLIP;              /* SET FOR WRITEIO       @Y30OE72*/ 04760000
         MVI   MODE,C'F'                                           1483 04761000
*           CALL WRITEIO;           /* WRITE, FLIP BUFFERS   @Y30OE72*/ 04762000
         BAL   @14,WRITEIO                                         1484 04763000
*         END;                      /*                       @Y30OE72*/ 04764000
*       IF WRTDDR1=ON               /* WRT WITH CONTROL REQ  @ZA28058*/ 04765000
*         THEN                      /* YES                   @ZA28058*/ 04766000
@RF01481 CLC   WRTDDR1(1),ON                                       1486 04767000
         BNE   @RF01486                                            1486 04768000
*         CURCCWOP=WRTCNTL;         /* CHANGE CMD CODE       @ZA28058*/ 04769000
         L     @12,CCWPTR                                          1487 04770000
         MVI   CURCCWOP(@12),X'21'                                 1487 04771000
*       BUFFAREA=RECBUF;            /* MOVE DATA INTO BUFFER @Y30OE72*/ 04772000
@RF01486 L     @12,CCWPTR                                          1488 04773000
         ICM   @11,7,CCWWTADD(@12)                                 1488 04774000
         L     @02,IOBPTR                                          1488 04775000
         ICM   @15,7,CCWRDADD(@02)                                 1488 04776000
         MVC   BUFFAREA(128,@11),RECBUF(@15)                       1488 04777000
*       CCWPTR=CCWPTR+CCWLEN;       /* PT TO NEXT SLOT       @Y30OE72*/ 04778000
         AH    @12,@CH00034                                        1489 04779000
         ST    @12,CCWPTR                                          1489 04780000
*       DFOPSCNT=DFOPSCNT+1;        /* BUMP DEFINE OPS CNT   @Y30OE72*/ 04781000
         L     @12,OTIOBPTR                                        1490 04782000
         LA    @11,1                                               1490 04783000
         SLR   @02,@02                                             1490 04784000
         IC    @02,DFOPSCNT(,@12)                                  1490 04785000
         ALR   @11,@02                                             1490 04786000
         STC   @11,DFOPSCNT(,@12)                                  1490 04787000
*     END;                          /*                       @Y30OE72*/ 04788000
*   END WRITETRK;                   /*                       @Y30OE72*/ 04789000
@EL00018 DS    0H                                                  1492 04790000
@EF00018 DS    0H                                                  1492 04791000
@ER00018 L     @14,@SA00018                                        1492 04792000
         BR    @14                                                 1492 04793000
*                                                                  1493 04794000
*/********************************************************************/ 04795000
*/*                                                          @Y30OE72*/ 04796000
*/* ROUTINE NAME = CHECKOUT                                  @Y30OE72*/ 04797000
*/*                                                          @Y30OE72*/ 04798000
*/* FUNCTION = IF COPYING ON ONE DEVICE, ISSUE IEB502A TO    @Y30OE72*/ 04799000
*/*            GET OUTPUT DISKETTE MOUNTED. IF TWO DEVICE    @Y30OE72*/ 04800000
*/*            COPY, THEN OPEN OUTPUT DISKETTE. IF OUTPUT    @Y30OE72*/ 04801000
*/*            DISKETTE HAS PROTECTED OR UNEXPIRED FILES     @Y30OE72*/ 04802000
*/*            MESSAGES ARE ISSUED TO THE OPERATOR TO OBTAIN @Y30OE72*/ 04803000
*/*            AN OUTPUT DISKETTE. IF A GOOD OUTPUT DISKETTE @Y30OE72*/ 04804000
*/*            IS FOUND, DELETED HDR1 LABELS ARE WRITTEN IN  @Y30OE72*/ 04805000
*/*            SECTORS 8 THRU 26 OF TRACK 0.                 @Y30OE72*/ 04806000
*/*                                                          @Y30OE72*/ 04807000
*/* INPUT = TIOT - TO GET UCB ADDRESS FOR MESSAGES           @Y30OE72*/ 04808000
*/*         MODESW - TO DETERMINE WHICH DEVICE HAS THE       @Y30OE72*/ 04809000
*/*                  OUTPUT DISKETTE.                        @Y30OE72*/ 04810000
*/*         PROTSW,EXPSW - SETON IF OUTPUT DISKETTE HAS      @Y30OE72*/ 04811000
*/*                        PROTECTED OR UNEXPIRED FILES.     @Y30OE72*/ 04812000
*/*                                                          @Y30OE72*/ 04813000
*/* OUTPUT = OUTPUT DISKETTE VERIFIED AS OK TO WRITE ON.     @Y30OE72*/ 04814000
*/*          FAILSW SETON IF AN ERROR WAS DETECTED.          @Y30OE72*/ 04815000
*/*          MSGS IEB502A,IEB517A,IEB503A,IEB504I,IEB511I    @Y30OE72*/ 04816000
*/*          MAY BE ISSUED TO THE OPERATOR.                  @Y30OE72*/ 04817000
*/*                                                          @Y30OE72*/ 04818000
*/* ROUTINES CALLED = PROTECT - TO READ OUTPUT DISKETTE      @Y30OE72*/ 04819000
*/*                             TRACK0 AND SET PROTSW,EXPSW, @Y30OE72*/ 04820000
*/*                             FAILSW IF NECESSARY.         @Y30OE72*/ 04821000
*/*                   MSGWRTR - TO WRITE MESSAGES.           @Y30OE72*/ 04822000
*/*                   WRITETRK - TO WRITE DDR1 LABELS ON     @Y30OE72*/ 04823000
*/*                              OUTPUT DISKETTE TRACK 0     @Y30OE72*/ 04824000
*/*                                                          @Y30OE72*/ 04825000
*/* MACROS = OPEN                                            @Y30OE72*/ 04826000
*/*                                                          @Y30OE72*/ 04827000
*/********************************************************************/ 04828000
*                                                                  1493 04829000
*CHECKOUT:                          /*                       @Y30OE72*/ 04830000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE72*/ 04831000
CHECKOUT ST    @14,@SA00019                                        1493 04832000
*   REPEATSW=ON;                    /* INIT LOOP CONTROL     @Y30OE72*/ 04833000
         MVC   REPEATSW(1),ON                                      1494 04834000
*   RETRYSW=1;                      /* INIT                  @Y30OE72*/ 04835000
*                                                                  1495 04836000
         MVI   RETRYSW,X'01'                                       1495 04837000
*   /*****************************************************************/ 04838000
*   /*                                                               */ 04839000
*   /* ISSUE MOUNT MESSAGE FOR OUTPUT DISKETTE               @Y30OE72*/ 04840000
*   /*                                                               */ 04841000
*   /*****************************************************************/ 04842000
*                                                                  1496 04843000
*   IF MODESW=ONE3540 THEN          /* SYSUT2 A DASD?        @Y30OE72*/ 04844000
         CLI   MODESW,1                                            1496 04845000
         BNE   @RF01496                                            1496 04846000
*     DO WHILE REPEATSW=ON;         /* YES.                  @Y30OE72*/ 04847000
         B     @DE01497                                            1497 04848000
@DL01497 DS    0H                                                  1498 04849000
*       REPEATSW=OFF;               /*                       @Y30OE72*/ 04850000
         MVC   REPEATSW(1),OFF                                     1498 04851000
*       REG1=ADDR(IEB502A);         /* MOUNT OUTPUT          @Y30OE72*/ 04852000
         LA    REG1,IEB502A                                        1499 04853000
*       MSGTYPE=ACTION;             /* DISKETTE              @Y30OE72*/ 04854000
         MVI   MSGTYPE,C'A'                                        1500 04855000
*       TIOTADDR=WORKSYS1;          /* POINT TO SYSUT1       @Y30OE72   04856000
*                                      DD ENTRY IN TIOT      @Y30OE72*/ 04857000
         SLR   @12,@12                                             1501 04858000
         ICM   @12,7,WORKSYS1                                      1501 04859000
         ST    @12,TIOTADDR                                        1501 04860000
*       I502DEV=UCBNAME;            /* PUT DEV @ IN MSG      @Y30OE72*/ 04861000
         ICM   @11,7,TIOEFSRT(@12)                                 1502 04862000
         MVC   I502DEV(3,REG1),UCBNAME(@11)                        1502 04863000
*       CALL MSGWRTR;               /* ISSUE MSG IEB502A     @Y30OE72*/ 04864000
         BAL   @14,MSGWRTR                                         1503 04865000
*       IF REPLY(1)=CANCEL THEN     /* DID OPR CANCEL?       @Y30OE72*/ 04866000
         CLI   REPLY,C'C'                                          1504 04867000
         BNE   @RF01504                                            1504 04868000
*         DO;                       /* YES.                  @Y30OE72*/ 04869000
*           CANCELED=SETON;         /* IND OPR CANCELED      @Y30OE72*/ 04870000
         OI    CANCELED,B'10000000'                                1506 04871000
*           FAILSW=ON;              /* TERMINATE RUN         @Y30OE72*/ 04872000
         MVC   FAILSW(1),ON                                        1507 04873000
*         END;                      /*                       @Y30OE72*/ 04874000
*       ELSE                        /* NO. IF HE DIDN'T SAY  @Y30OE72*/ 04875000
*         IF REPLY(1)^=GO THEN      /* GO, THEN BAD REPLY    @Y30OE72*/ 04876000
         B     @RC01504                                            1509 04877000
@RF01504 CLI   REPLY,C'U'                                          1509 04878000
         BE    @RF01509                                            1509 04879000
*           REPEATSW=ON;            /* REISSUE MSG           @Y30OE72*/ 04880000
         MVC   REPEATSW(1),ON                                      1510 04881000
*     END;                          /* END IEB502A PROCESS   @Y30OE72*/ 04882000
@RF01509 DS    0H                                                  1511 04883000
@RC01504 DS    0H                                                  1511 04884000
@DE01497 CLC   REPEATSW(1),ON                                      1511 04885000
         BE    @DL01497                                            1511 04886000
*   IF FAILSW=OFF THEN              /* OUTPUT DSKT MOUNTED?  @Y30OE72*/ 04887000
@RF01496 CLC   FAILSW(1),OFF                                       1512 04888000
         BNE   @RF01512                                            1512 04889000
*     DO;                           /* YES.                  @Y30OE72*/ 04890000
*       IF MODESW=ONE3540 THEN      /* IS IT ON SYSUT1?      @Y30OE72*/ 04891000
         CLI   MODESW,1                                            1514 04892000
         BNE   @RF01514                                            1514 04893000
*         DO;                       /* YES.                  @Y30OE72*/ 04894000
*           OT1DCBPT=ADDR(SYSUT1);  /* POINT OUTPUT IOBS     @Y30OE72*/ 04895000
         LA    @12,SYSUT1                                          1516 04896000
         STCM  @12,7,OT1DCBPT                                      1516 04897000
*           OT2DCBPT=ADDR(SYSUT1);  /* SYSUT1                @Y30OE72*/ 04898000
         STCM  @12,7,OT2DCBPT                                      1517 04899000
*         END;                      /*                       @Y30OE72*/ 04900000
*       ELSE                        /* NO. OPEN              @Y30OE72*/ 04901000
*         DO;                       /* OUTPUT                @Y30OE72*/ 04902000
         B     @RC01514                                            1519 04903000
@RF01514 DS    0H                                                  1520 04904000
*           GEN(OPEN (SYSUT2EX,(OUTPUT)));/* DISKETTE        @Y30OE72*/ 04905000
         OPEN (SYSUT2EX,(OUTPUT))                                       04906000
*           REG1=ADDR(SYSUT2EX);    /* POINT TO DCB          @Y30OE72*/ 04907000
         LA    REG1,SYSUT2EX                                       1521 04908000
*           IF DCBOFOPN^=SETON THEN /* OPEN SUCCESSFUL?      @Y30OE72*/ 04909000
         TM    DCBOFOPN+40(REG1),B'00010000'                       1522 04910000
         BO    @RF01522                                            1522 04911000
*             DO;                   /* NO.                   @Y30OE72*/ 04912000
*               I511DDNM=SYSUT2DD;  /* DDNAME                @Y30OE72*/ 04913000
         MVC   I511DDNM(8),@CC02093                                1524 04914000
*               REG1=ADDR(IEB511I); /* MSG ADDR              @Y30OE72*/ 04915000
         LA    REG1,IEB511I                                        1525 04916000
*               MSGLEN=LENGTH(IEB511I);/* ISSUE MSG          @Y30OE72*/ 04917000
         MVI   MSGLEN,X'28'                                        1526 04918000
*               CALL MSGWRTR;       /* IEB511I               @Y30OE72*/ 04919000
         BAL   @14,MSGWRTR                                         1527 04920000
*               FAILSW=ON;          /* TERMINATE RUN         @Y30OE72*/ 04921000
         MVC   FAILSW(1),ON                                        1528 04922000
*             END;                  /*                       @Y30OE72*/ 04923000
*           ELSE                    /*                       @ZA04470*/ 04924000
*             DO;                   /*                       @ZA04470*/ 04925000
         B     @RC01522                                            1530 04926000
@RF01522 DS    0H                                                  1531 04927000
*               TIOTADDR=WORKSYS2;  /* SYSUT2 TIOT ENTRY     @ZA04470*/ 04928000
         SLR   @12,@12                                             1531 04929000
         ICM   @12,7,WORKSYS2                                      1531 04930000
         ST    @12,TIOTADDR                                        1531 04931000
*               DCBADDR=ADDR(SYSUT2EX);/* PT TO SYSUT2 DCB   @ZA04470*/ 04932000
         LA    @12,SYSUT2EX                                        1532 04933000
         ST    @12,DCBADDR                                         1532 04934000
*               MODESWIT=GETIRB;    /* LOAD VW AND           @ZAA4470*/ 04935000
         MVI   MODESWIT,X'03'                                      1533 04936000
*               CALL UCBDEBUP;      /* UPDATE DEB            @ZA04470*/ 04937000
         BAL   @14,UCBDEBUP                                        1534 04938000
*             END;                  /*                       @ZA04470*/ 04939000
*         END;                      /*                       @Y30OE72*/ 04940000
@RC01522 DS    0H                                                  1537 04941000
*     END;                          /*                       @Y30OE72*/ 04942000
@RC01514 DS    0H                                                  1538 04943000
*   DO WHILE RETRYSW=ON&FAILSW=OFF; /* VERIFY OUTPUT DSKT    @Y30OE72*/ 04944000
@RF01512 B     @DE01538                                            1538 04945000
@DL01538 DS    0H                                                  1539 04946000
*     CALL PROTECT;                 /* CHECK LABEL TRACK     @Y30OE72*/ 04947000
         BAL   @14,PROTECT                                         1539 04948000
*     REPEATSW=1;                   /* INIT LOOP CONTROL     @Y30OE72*/ 04949000
*                                                                  1540 04950000
         MVI   REPEATSW,X'01'                                      1540 04951000
*     /***************************************************************/ 04952000
*     /*                                                             */ 04953000
*     /* PROCESS PROTECTED FILES                             @Y30OE72*/ 04954000
*     /*                                                             */ 04955000
*     /***************************************************************/ 04956000
*                                                                  1541 04957000
*     IF PROTSW=ON&                 /* PROTECTED             @Y30OE72*/ 04958000
*         FAILSW=OFF THEN           /* FILES?                @Y30OE72*/ 04959000
         CLC   PROTSW(1),ON                                        1541 04960000
         BNE   @RF01541                                            1541 04961000
         CLC   FAILSW(1),OFF                                       1541 04962000
         BNE   @RF01541                                            1541 04963000
*       DO;                         /* YES.                  @Y30OE72*/ 04964000
*         PROTSW=OFF;               /* RESET SWITCH          @Y30OE72*/ 04965000
         MVC   PROTSW(1),OFF                                       1543 04966000
*         DO WHILE REPEATSW=ON;     /* ASK OPR FOR NEW DSKT  @Y30OE72*/ 04967000
         B     @DE01544                                            1544 04968000
@DL01544 DS    0H                                                  1545 04969000
*           REPEATSW=OFF;           /* RESET LOOP CONTROL    @Y30OE72*/ 04970000
         MVC   REPEATSW(1),OFF                                     1545 04971000
*           REG1=ADDR(IEB517A);     /* SET UP FOR WTOR       @Y30OE72*/ 04972000
         LA    REG1,IEB517A                                        1546 04973000
*           MSGTYPE=ACTION;         /* OF IEB517A            @Y30OE72*/ 04974000
         MVI   MSGTYPE,C'A'                                        1547 04975000
*           IF MODESW=ONE3540 THEN  /* IF OUTPUT DISKETTE    @Y30OE72*/ 04976000
         CLI   MODESW,1                                            1548 04977000
         BNE   @RF01548                                            1548 04978000
*             TIOTADDR=WORKSYS1;    /* ON SYSUT1, POINT TO   @Y30OE72   04979000
*                                      SYSUT1 TIOT ENTRY     @Y30OE72*/ 04980000
         SLR   @12,@12                                             1549 04981000
         ICM   @12,7,WORKSYS1                                      1549 04982000
         ST    @12,TIOTADDR                                        1549 04983000
*           ELSE                    /* NO. THEN              @Y30OE72*/ 04984000
*             TIOTADDR=WORKSYS2;    /* POINT TO              @Y30OE72   04985000
*                                      SYSUT2 TIOT ENTRY     @Y30OE72*/ 04986000
         B     @RC01548                                            1550 04987000
@RF01548 SLR   @12,@12                                             1550 04988000
         ICM   @12,7,WORKSYS2                                      1550 04989000
         ST    @12,TIOTADDR                                        1550 04990000
*           I517DEV=UCBNAME;        /* PUT DEV @ IN MSG      @Y30OE72*/ 04991000
@RC01548 L     @12,TIOTADDR                                        1551 04992000
         ICM   @11,7,TIOEFSRT(@12)                                 1551 04993000
         MVC   I517DEV(3,REG1),UCBNAME(@11)                        1551 04994000
*           CALL MSGWRTR;           /* ISSUE IEB517A         @Y30OE72*/ 04995000
         BAL   @14,MSGWRTR                                         1552 04996000
*           IF REPLY(1)=RETRY THEN  /* OPR MOUNT NEW DSKT?   @Y30OE72*/ 04997000
         CLI   REPLY,C'R'                                          1553 04998000
         BNE   @RF01553                                            1553 04999000
*             RETRYSW=ON;           /* YES. RETRY            @Y30OE72*/ 05000000
         MVC   RETRYSW(1),ON                                       1554 05001000
*           ELSE                    /* NO.                   @Y30OE72*/ 05002000
*             IF REPLY(1)=CANCEL THEN/* DID HE CANCEL JOB?   @Y30OE72*/ 05003000
         B     @RC01553                                            1555 05004000
@RF01553 CLI   REPLY,C'C'                                          1555 05005000
         BNE   @RF01555                                            1555 05006000
*               DO;                 /* YES.                  @Y30OE72*/ 05007000
*                 CANCELED=SETON;   /* IND OPR CANCELED      @Y30OE72*/ 05008000
         OI    CANCELED,B'10000000'                                1557 05009000
*                 FAILSW=ON;        /* TERMINATE RUN         @Y30OE72*/ 05010000
         MVC   FAILSW(1),ON                                        1558 05011000
*               END;                /*                       @Y30OE72*/ 05012000
*             ELSE                  /* NO. INVALID REPLY     @Y30OE72*/ 05013000
*               REPEATSW=ON;        /* REISSUE MSG           @Y30OE72*/ 05014000
         B     @RC01555                                            1560 05015000
@RF01555 MVC   REPEATSW(1),ON                                      1560 05016000
*         END;                      /* END IEB517A PROCESS   @Y30OE72*/ 05017000
@RC01555 DS    0H                                                  1561 05018000
@RC01553 DS    0H                                                  1561 05019000
@DE01544 CLC   REPEATSW(1),ON                                      1561 05020000
         BE    @DL01544                                            1561 05021000
*       END;                        /* END PROTECTED FILES   @Y30OE72*/ 05022000
*                                                                  1562 05023000
*     /***************************************************************/ 05024000
*     /*                                                             */ 05025000
*     /* PROCESS UNEXPIRED FILES                             @Y30OE72*/ 05026000
*     /*                                                             */ 05027000
*     /***************************************************************/ 05028000
*                                                                  1563 05029000
*     IF RETRYSW=OFF&               /* NO PROTECTED FILES &  @Y30OE72*/ 05030000
*         FAILSW=OFF THEN           /* NO OPERATOR CANCEL    @Y30OE72*/ 05031000
@RF01541 CLC   RETRYSW(1),OFF                                      1563 05032000
         BNE   @RF01563                                            1563 05033000
         CLC   FAILSW(1),OFF                                       1563 05034000
         BNE   @RF01563                                            1563 05035000
*       DO;                         /* YES.                  @Y30OE72*/ 05036000
*         IF EXPSW=ON THEN          /* ANY UNEXPIRED D/S?    @Y30OE72*/ 05037000
         CLC   EXPSW(1),ON                                         1565 05038000
         BNE   @RF01565                                            1565 05039000
*           DO;                     /* YES.                  @Y30OE72*/ 05040000
*             EXPSW=OFF;            /* RESET SWITCH          @Y30OE72*/ 05041000
         MVC   EXPSW(1),OFF                                        1567 05042000
*             DO WHILE REPEATSW=ON; /* ASK OPR WHAT TO DO    @Y30OE72*/ 05043000
         B     @DE01568                                            1568 05044000
@DL01568 DS    0H                                                  1569 05045000
*               REPEATSW=OFF;       /* RESET LOOP CONTROL    @Y30OE72*/ 05046000
         MVC   REPEATSW(1),OFF                                     1569 05047000
*               REG1=ADDR(IEB503A); /* SET UP FOR WTOR       @Y30OE72*/ 05048000
         LA    REG1,IEB503A                                        1570 05049000
*               MSGTYPE=ACTION;     /* OF IEB503A            @Y30OE72*/ 05050000
         MVI   MSGTYPE,C'A'                                        1571 05051000
*               IF MODESW=ONE3540 THEN/* IF OUTPUT DISKETTE  @Y30OE72*/ 05052000
         CLI   MODESW,1                                            1572 05053000
         BNE   @RF01572                                            1572 05054000
*                 TIOTADDR=WORKSYS1;/* ON SYSUT1, POINT TO   @Y30OE72   05055000
*                                      SYSUT1 TIOT ENTRY     @Y30OE72*/ 05056000
         SLR   @12,@12                                             1573 05057000
         ICM   @12,7,WORKSYS1                                      1573 05058000
         ST    @12,TIOTADDR                                        1573 05059000
*               ELSE                /* NO. THEN              @Y30OE72*/ 05060000
*                 TIOTADDR=WORKSYS2;/* POINT TO              @Y30OE72   05061000
*                                      SYSUT2 TIOT ENTRY     @Y30OE72*/ 05062000
         B     @RC01572                                            1574 05063000
@RF01572 SLR   @12,@12                                             1574 05064000
         ICM   @12,7,WORKSYS2                                      1574 05065000
         ST    @12,TIOTADDR                                        1574 05066000
*               I503DEV=UCBNAME;    /* PUT DEV @ IN MSG      @Y30OE72*/ 05067000
@RC01572 L     @12,TIOTADDR                                        1575 05068000
         ICM   @11,7,TIOEFSRT(@12)                                 1575 05069000
         MVC   I503DEV(3,REG1),UCBNAME(@11)                        1575 05070000
*               CALL MSGWRTR;       /* ISSUE IEB503A         @Y30OE72*/ 05071000
         BAL   @14,MSGWRTR                                         1576 05072000
*               IF REPLY(1)=RETRY THEN/* OPR MOUNT NEW DSKT? @Y30OE72*/ 05073000
         CLI   REPLY,C'R'                                          1577 05074000
         BNE   @RF01577                                            1577 05075000
*                 RETRYSW=ON;       /* YES. RETRY            @Y30OE72*/ 05076000
         MVC   RETRYSW(1),ON                                       1578 05077000
*               ELSE                /* NO.                   @Y30OE72*/ 05078000
*                 IF REPLY(1)=CANCEL THEN/* DID OPR CANCEL?  @Y30OE72*/ 05079000
         B     @RC01577                                            1579 05080000
@RF01577 CLI   REPLY,C'C'                                          1579 05081000
         BNE   @RF01579                                            1579 05082000
*                   DO;             /* YES.                  @Y30OE72*/ 05083000
*                     CANCELED=SETON;/* IND OPR CANCELED     @Y30OE72*/ 05084000
         OI    CANCELED,B'10000000'                                1581 05085000
*                     FAILSW=ON;    /* TERMINATE RUN         @Y30OE72*/ 05086000
         MVC   FAILSW(1),ON                                        1582 05087000
*                   END;            /*                       @Y30OE72*/ 05088000
*                 ELSE              /* IF HE DIDN'T SAY      @Y30OE72*/ 05089000
*                   IF REPLY(1)^=GO THEN/* GO, THEN BAD REPLY      1584 05090000
*                                                            @Y30OE72*/ 05091000
         B     @RC01579                                            1584 05092000
@RF01579 CLI   REPLY,C'U'                                          1584 05093000
         BE    @RF01584                                            1584 05094000
*                     REPEATSW=ON;  /* REISSUE MSG           @Y30OE72*/ 05095000
         MVC   REPEATSW(1),ON                                      1585 05096000
*             END;                  /* END IEB503A PROCESS   @Y30OE72*/ 05097000
@RF01584 DS    0H                                                  1586 05098000
@RC01579 DS    0H                                                  1586 05099000
@RC01577 DS    0H                                                  1586 05100000
@DE01568 CLC   REPEATSW(1),ON                                      1586 05101000
         BE    @DL01568                                            1586 05102000
*           END;                    /* END UNEXPIRED FILES   @Y30OE72*/ 05103000
*       END;                        /*                       @Y30OE72*/ 05104000
@RF01565 DS    0H                                                  1589 05105000
*   END;                            /* END VER OUTPUT DSKT   @Y30OE72*/ 05106000
*                                                                  1589 05107000
@RF01563 DS    0H                                                  1589 05108000
@DE01538 CLC   RETRYSW(1),ON                                       1589 05109000
         BNE   @DC01538                                            1589 05110000
         CLC   FAILSW(1),OFF                                       1589 05111000
         BE    @DL01538                                            1589 05112000
@DC01538 DS    0H                                                  1590 05113000
*   /*****************************************************************/ 05114000
*   /*                                                               */ 05115000
*   /* WRITE DDR1 LABELS IN OUTPUT DISKETTE HDR1 SECTORS     @Y30OE72*/ 05116000
*   /*                                                               */ 05117000
*   /*****************************************************************/ 05118000
*                                                                  1590 05119000
*   IF FAILSW=OFF THEN              /* OUTPUT DSKT OK?       @Y30OE72*/ 05120000
         CLC   FAILSW(1),OFF                                       1590 05121000
         BNE   @RF01590                                            1590 05122000
*     DO;                           /* YES.                  @Y30OE72*/ 05123000
*       SC=TRACK0;                  /* START ADDR = TRACK 0  @Y30OE72*/ 05124000
         SLR   @12,@12                                             1592 05125000
         IC    @12,TRACK0                                          1592 05126000
         STH   @12,SC                                              1592 05127000
*       SR=FIRSTHDR;                /* START ADDR=SECTOR 8   @Y30OE72*/ 05128000
         MVC   SR(2),@CH00034                                      1593 05129000
*       FIRSTPUT=SETON;             /* WRITETRK 1ST TIME SW  @Y30OE72*/ 05130000
         OI    FIRSTPUT,B'00100000'                                1594 05131000
*       RECBUF=BLANK;               /* CLEAR BUFFER          @Y30OE72*/ 05132000
         L     @12,IOBPTR                                          1595 05133000
         SLR   @11,@11                                             1595 05134000
         ICM   @11,7,CCWRDADD(@12)                                 1595 05135000
         MVC   RECBUF(128,@11),BLANK                               1595 05136000
*       RECBUF(1:4)=CHARDDR1;       /* BUILD DELETED HDR1    @Y30OE72*/ 05137000
         MVC   RECBUF(4,@11),CHARDDR1                              1596 05138000
*       WRTDDR1=ON;                 /* IND WRT W/CNTL REQ    @ZA28058*/ 05139000
         MVC   WRTDDR1(1),ON                                       1597 05140000
*       DO I=1 TO 19;               /* WRITE 19 DDR1S        @Y30OE72*/ 05141000
         LA    @12,1                                               1598 05142000
         ST    @12,I                                               1598 05143000
@DL01598 DS    0H                                                  1599 05144000
*         CALL WRITETRK;            /* PUT REC IN OUTPUT BUF @Y30OE72*/ 05145000
         BAL   @14,WRITETRK                                        1599 05146000
*         FIRSTPUT=SETOFF;          /* RESET 1ST TIME SW     @Y30OE72*/ 05147000
         NI    FIRSTPUT,B'11011111'                                1600 05148000
*       END;                        /*                       @Y30OE72*/ 05149000
         LA    @12,1                                               1601 05150000
         AL    @12,I                                               1601 05151000
         ST    @12,I                                               1601 05152000
         CH    @12,@CH02061                                        1601 05153000
         BNH   @DL01598                                            1601 05154000
*       LASTPUT=SETON;              /* FLUSH BUFFER SW       @Y30OE72*/ 05155000
         OI    LASTPUT,B'00010000'                                 1602 05156000
*       CALL WRITETRK;              /* WRITE VOL1 & HDR1S    @Y30OE72*/ 05157000
         BAL   @14,WRITETRK                                        1603 05158000
*       WRTDDR1=SETOFF;             /* WRT W/CNTL SW OFF     @ZA28058*/ 05159000
         MVI   WRTDDR1,X'00'                                       1604 05160000
*       LASTPUT=SETOFF;             /* RESET                 @Y30OE72*/ 05161000
         NI    LASTPUT,B'11101111'                                 1605 05162000
*       IF SW504I=SETON THEN        /* I/O ERROR?            @Y30OE72*/ 05163000
         TM    SW504I,B'00001000'                                  1606 05164000
         BNO   @RF01606                                            1606 05165000
*         DO;                       /* YES.                  @Y30OE72*/ 05166000
*           REG1=ADDR(IEB504I);     /* ISSUE                 @Y30OE72*/ 05167000
         LA    REG1,IEB504I                                        1608 05168000
*           MSGLEN=LENGTH(IEB504I); /* MESSAGE               @Y30OE72*/ 05169000
         MVI   MSGLEN,X'28'                                        1609 05170000
*           CALL MSGWRTR;           /* IEB504I               @Y30OE72*/ 05171000
         BAL   @14,MSGWRTR                                         1610 05172000
*           FAILSW=ON;              /* TERMINATE RUN         @Y30OE72*/ 05173000
         MVC   FAILSW(1),ON                                        1611 05174000
*         END;                      /*                       @Y30OE72*/ 05175000
*     END;                          /* END WRITE DDR1S       @Y30OE72*/ 05176000
*   END CHECKOUT;                   /*                       @Y30OE72*/ 05177000
@EL00019 DS    0H                                                  1614 05178000
@EF00019 DS    0H                                                  1614 05179000
@ER00019 L     @14,@SA00019                                        1614 05180000
         BR    @14                                                 1614 05181000
*                                                                  1615 05182000
*/********************************************************************/ 05183000
*/*                                                          @Y30OE72*/ 05184000
*/* ROUTINE NAME = PROTECT                                   @Y30OE72*/ 05185000
*/*                                                          @Y30OE72*/ 05186000
*/* FUNCTION = READ AND VERIFY OUTPUT DISKETTE TRACK 0.      @Y30OE72*/ 05187000
*/*            CHECK FOR SECURE VOLUME, PROTECTED FILES AND  @Y30OE72*/ 05188000
*/*            UNEXPIRED FILES AND SET PROPER INDICATORS.    @Y30OE72*/ 05189000
*/*                                                          @Y30OE72*/ 05190000
*/* INPUT = OUTPUT DISKETTE TRACK 0                          @Y30OE72*/ 05191000
*/*         MODESW - TO DETERMINE WHETHER OUTPUT DISKETTE IS @Y30OE72*/ 05192000
*/*                  ON SYSUT1 OR SYSUT2.                    @Y30OE72*/ 05193000
*/*                                                          @Y30OE72*/ 05194000
*/* OUTPUT = EXPSW SETON IF UNEXPIRED FILES FOUND.           @Y30OE72*/ 05195000
*/*          PROTSW SETON IF PROTECTED FILES FOUND.          @Y30OE72*/ 05196000
*/*          FAILSW SETON IF AN I/O ERROR OR SECURE VOLUME.  @Y30OE72*/ 05197000
*/*                                                          @Y30OE72*/ 05198000
*/* ROUTINES CALLED = READSECT - TO READ OUTPUT DISKETTE     @Y30OE72*/ 05199000
*/*                              TRACK 0.                    @Y30OE72*/ 05200000
*/*                   MSGWRTR - TO WRITE MESSAGES.           @Y30OE72*/ 05201000
*/*                   SECURCHK - TO PROCESS SECURE OUTPUT    @Y30OE72*/ 05202000
*/*                              DISKETTE.                   @Y30OE72*/ 05203000
*/*                                                          @Y30OE72*/ 05204000
*/* MACROS = TIME                                            @Y30OE72*/ 05205000
*/*                                                          @Y30OE72*/ 05206000
*/********************************************************************/ 05207000
*                                                                  1615 05208000
*PROTECT:                           /*                       @Y30OE72*/ 05209000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE72*/ 05210000
PROTECT  ST    @14,@SA00020                                        1615 05211000
*   EXPSW=SETOFF;                   /* INIT SWITCH           @Y30OE72*/ 05212000
         MVI   EXPSW,X'00'                                         1616 05213000
*   PROTSW=SETOFF;                  /* INIT SWITCH           @Y30OE72*/ 05214000
         MVI   PROTSW,X'00'                                        1617 05215000
*   FIRSTVOL=SETON;                 /* TO INSURE THAT VW     @Y30OE72   05216000
*                                      IS ONLT LOADED ONCE   @Y30OE72*/ 05217000
         OI    FIRSTVOL,B'00010000'                                1618 05218000
*   SC=TRACK0;                      /* START ADDR = TRACK 0  @Y30OE72*/ 05219000
         SLR   @12,@12                                             1619 05220000
         IC    @12,TRACK0                                          1619 05221000
         STH   @12,SC                                              1619 05222000
*   SR=VOLLABEL;                    /* SECTOR 7              @Y30OE72*/ 05223000
         LA    @11,7                                               1620 05224000
         STH   @11,SR                                              1620 05225000
*   EC=TRACK0;                      /* END ADDR = TRACK 0    @Y30OE72*/ 05226000
         STH   @12,EC                                              1621 05227000
*   ER=VOLLABEL;                    /* SECTOR 7              @Y30OE72*/ 05228000
         STH   @11,ER                                              1622 05229000
*   IF MODESW=TWO3540 THEN          /* OUTPT DSKT ON SYSUT2? @Y30OE72*/ 05230000
         CLI   MODESW,2                                            1623 05231000
         BNE   @RF01623                                            1623 05232000
*     DO;                           /* YES.                  @Y30OE72*/ 05233000
*       IN1DCBPT=ADDR(SYSUT2EX);    /* POINT READ IOBS       @Y30OE72*/ 05234000
         LA    @12,SYSUT2EX                                        1625 05235000
         STCM  @12,7,IN1DCBPT                                      1625 05236000
*       IN2DCBPT=ADDR(SYSUT2EX);    /* TO SYSUT2             @Y30OE72*/ 05237000
         STCM  @12,7,IN2DCBPT                                      1626 05238000
*     END;                          /*                       @Y30OE72*/ 05239000
*                                                                  1627 05240000
*   /*****************************************************************/ 05241000
*   /*                                                               */ 05242000
*   /* READ VOL1 LABEL AND PROCESS SECURE DISKETTE           @Y30OE72*/ 05243000
*   /*                                                               */ 05244000
*   /*****************************************************************/ 05245000
*                                                                  1628 05246000
*   RETRYSW=ON;                     /* INIT LOOP CONTROL     @Z30OE72*/ 05247000
@RF01623 MVC   RETRYSW(1),ON                                       1628 05248000
*   DO WHILE RETRYSW=ON;            /* CHK SECURE DSKT       @Z30OE72*/ 05249000
         B     @DE01629                                            1629 05250000
@DL01629 DS    0H                                                  1630 05251000
*     RETRYSW=OFF;                  /* RESET SWITCH          @Z30OE72*/ 05252000
         MVC   RETRYSW(1),OFF                                      1630 05253000
*     FIRSTIO=SETON;                /* SET FIRST TIME SWITCH @Z30OE72   05254000
*                                      FOR READSECT ROUTINE  @Z30OE72*/ 05255000
         OI    FIRSTIO,B'10000000'                                 1631 05256000
*     CALL READSECT;                /* TO READ VOL1 SECTOR   @Y30OE72*/ 05257000
         BAL   @14,READSECT                                        1632 05258000
*     FIRSTIO=SETOFF;               /* RESET SWITCH          @Y30OE72*/ 05259000
         NI    FIRSTIO,B'01111111'                                 1633 05260000
*     IF BADRECSW=SET THEN          /* I/O ERROR?            @Y30OE72*/ 05261000
         CLC   BADRECSW(1),SET                                     1634 05262000
         BNE   @RF01634                                            1634 05263000
*       DO;                         /* YES.                  @Y30OE72*/ 05264000
*         REG1=ADDR(IEB504I);       /* ISSUE                 @Y30OE72*/ 05265000
         LA    REG1,IEB504I                                        1636 05266000
*         MSGLEN=LENGTH(IEB504I);   /* MESSAGE               @Y30OE72*/ 05267000
         MVI   MSGLEN,X'28'                                        1637 05268000
*         CALL MSGWRTR;             /* IEB504I               @Y30OE72*/ 05269000
         BAL   @14,MSGWRTR                                         1638 05270000
*         FAILSW=ON;                /* YES. TERMINATE RUN    @Y30OE72*/ 05271000
         MVC   FAILSW(1),ON                                        1639 05272000
*       END;                        /*                       @Y30OE72*/ 05273000
*     IF FAILSW=OFF&                /* VOL1 SECTOR READ AND  @Y30OE72*/ 05274000
*         RECBUF(1:4)=CHARVOL1 THEN /* LABEL ID PRESENT?     @Y30OE72*/ 05275000
@RF01634 CLC   FAILSW(1),OFF                                       1641 05276000
         BNE   @RF01641                                            1641 05277000
         L     @12,IOBPTR                                          1641 05278000
         SLR   @11,@11                                             1641 05279000
         ICM   @11,7,CCWRDADD(@12)                                 1641 05280000
         CLC   RECBUF(4,@11),@CC02049                              1641 05281000
         BNE   @RF01641                                            1641 05282000
*       IF RECBUF(11)^=BLANK(1) THEN/* YES. IS IT SECURE?    @Y30OE72*/ 05283000
         CLC   RECBUF+10(1,@11),BLANK                              1642 05284000
         BE    @RF01642                                            1642 05285000
*         DO;                       /* YES.                  @Y30OE72*/ 05286000
*           REPEATSW=ON;            /* INIT LOOP CONTROL     @Y30OE72*/ 05287000
         MVC   REPEATSW(1),ON                                      1644 05288000
*           OUTSW=SETON;            /* IND OUTPUT DSKT       @Y30OE72*/ 05289000
         OI    OUTSW,B'01000000'                                   1645 05290000
*           CALL SECURCHK;          /* ASK OPR FOR QUALIFIER @Y30OE72*/ 05291000
         BAL   @14,SECURCHK                                        1646 05292000
*         END;                      /*                       @Y30OE72*/ 05293000
*       ELSE                        /* NON-SECURE DSKT       @Y30OE72*/ 05294000
*         USEVOL=SETON;             /* USE DISKETTE          @Y30OE72*/ 05295000
         B     @RC01642                                            1648 05296000
@RF01642 OI    USEVOL,B'00000100'                                  1648 05297000
*   END;                            /* END SECURE DSKT CHK   @Z30OE72*/ 05298000
@RC01642 DS    0H                                                  1649 05299000
@RF01641 DS    0H                                                  1649 05300000
@DE01629 CLC   RETRYSW(1),ON                                       1649 05301000
         BE    @DL01629                                            1649 05302000
*   IF USEVOL=SETOFF THEN           /* OUTPUT DSKT OK?       @Y30OE72*/ 05303000
         TM    USEVOL,B'00000100'                                  1650 05304000
         BNZ   @RF01650                                            1650 05305000
*     FAILSW=ON;                    /* NO. TERMINATE         @Y30OE72*/ 05306000
         MVC   FAILSW(1),ON                                        1651 05307000
*   IF FAILSW=OFF THEN              /* VOL LABEL OK?         @Y30OE72*/ 05308000
@RF01650 CLC   FAILSW(1),OFF                                       1652 05309000
         BNE   @RF01652                                            1652 05310000
*     DO;                           /* YES. PROCESS HDR1S    @Y30OE72*/ 05311000
*       IF MODESW=ONE3540 THEN      /* OUTPUT DSKT ON SYSUT1 @Y30OE72*/ 05312000
         CLI   MODESW,1                                            1654 05313000
         BNE   @RF01654                                            1654 05314000
*         TIOTADDR=WORKSYS1;        /* PT TO SYSUT1 TIOT ENT @Y30OE72*/ 05315000
         SLR   @12,@12                                             1655 05316000
         ICM   @12,7,WORKSYS1                                      1655 05317000
         ST    @12,TIOTADDR                                        1655 05318000
*       ELSE                        /* OUTPUT DSKT ON SYSUT2 @Y30OE72*/ 05319000
*         DO;                       /*                       @Y30OE72*/ 05320000
         B     @RC01654                                            1656 05321000
@RF01654 DS    0H                                                  1657 05322000
*           DCBADDR=ADDR(SYSUT2EX); /* SYSUT2 DCB            @Y30OE72*/ 05323000
         LA    @12,SYSUT2EX                                        1657 05324000
         ST    @12,DCBADDR                                         1657 05325000
*           TIOTADDR=WORKSYS2;      /* SYSUT2 TIOT ENTRY     @Y30OE72*/ 05326000
         SLR   @12,@12                                             1658 05327000
         ICM   @12,7,WORKSYS2                                      1658 05328000
         ST    @12,TIOTADDR                                        1658 05329000
*         END;                      /*                       @Y30OE72*/ 05330000
*       MODESWIT=UCBONLY;           /* UPDATE UCBVLSER       @Z30OE72*/ 05331000
@RC01654 MVI   MODESWIT,X'02'                                      1660 05332000
*       CALL UCBDEBUP;              /* UPDATE UCB AND DEB    @Y30OE72*/ 05333000
         BAL   @14,UCBDEBUP                                        1661 05334000
*       FIRSTVOL=SETOFF;            /* VW HAS BEEN LOADED    @Y30OE72*/ 05335000
         NI    FIRSTVOL,B'11101111'                                1662 05336000
*       GEN;                                                       1663 05337000
*                                   /* GENERATE ASSEMBLER    @Y30OE72*/ 05338000
                TIME DEC                ISSUE TIME MACRO       @Y30OE72 05339000
*       SAVEDATE=REG1;              /* SAVE SYSTEM DATE      @Y30OE72*/ 05340000
         ST    REG1,SAVEDATE                                       1664 05341000
*       UNPK(UNPKDATE,SAVEDATE);    /* CONV TO EBCDIC        @Y30OE72*/ 05342000
         UNPK  UNPKDATE(8),SAVEDATE(4)                             1665 05343000
*       PACK(SYSYEAR,UNPKYEAR);     /* PACK SYS YEAR         @Y30OE72*/ 05344000
         PACK  SYSYEAR(2),UNPKYEAR(2)                              1666 05345000
*       SYSDAY=SAVEDATE(3:4);       /* GET PACKED SYS DAY    @Y30OE72*/ 05346000
         MVC   SYSDAY(2),SAVEDATE+2                                1667 05347000
*       FIRSTIO=SETON;              /* SET FIRST TIME SWITCH @Y30OE72   05348000
*                                      FOR READSECT RTN      @Y30OE72*/ 05349000
         OI    FIRSTIO,B'10000000'                                 1668 05350000
*       SR=FIRSTHDR;                /* START SECTOR = 8      @Y30OE72*/ 05351000
         MVC   SR(2),@CH00034                                      1669 05352000
*       ER=SECTOR26;                /* END SECTOR = 26       @Y30OE72*/ 05353000
*                                                                  1670 05354000
         MVC   ER(2),@CH02141                                      1670 05355000
*       /*************************************************************/ 05356000
*       /*                                                           */ 05357000
*       /* READ HDR1 LABELS AND CHECK FOR PROTECTED AND      @Y30OE72*/ 05358000
*       /* UNEXPIRED FILES                                   @Y30OE72*/ 05359000
*       /*                                                           */ 05360000
*       /*************************************************************/ 05361000
*                                                                  1671 05362000
*       DO T=1 TO 19                /* READ HDR1S AS LONG    @Y30OE72*/ 05363000
*             WHILE(FAILSW=OFF);    /* AS NO I/O ERRORS      @Y30OE72*/ 05364000
         LA    @12,1                                               1671 05365000
         STC   @12,T                                               1671 05366000
@DL01671 CLC   FAILSW(1),OFF                                       1671 05367000
         BNE   @DC01671                                            1671 05368000
*         CALL READSECT;            /* TO READ A SECTOR      @Y30OE72*/ 05369000
         BAL   @14,READSECT                                        1672 05370000
*         FIRSTIO=SETOFF;           /* RESET 1ST TIME SW     @Y30OE72*/ 05371000
         NI    FIRSTIO,B'01111111'                                 1673 05372000
*         IF BADRECSW=SET THEN      /* I/O ERROR?            @Y30OE72*/ 05373000
         CLC   BADRECSW(1),SET                                     1674 05374000
         BNE   @RF01674                                            1674 05375000
*           DO;                     /* YES.                  @Y30OE72*/ 05376000
*             REG1=ADDR(IEB504I);   /* ISSUE                 @Y30OE72*/ 05377000
         LA    REG1,IEB504I                                        1676 05378000
*             MSGLEN=LENGTH(IEB504I);/* MESSAGE              @Y30OE72*/ 05379000
         MVI   MSGLEN,X'28'                                        1677 05380000
*             CALL MSGWRTR;         /* IEB504I               @Y30OE72*/ 05381000
         BAL   @14,MSGWRTR                                         1678 05382000
*             FAILSW=ON;            /* YES. TERMINATE RUN    @Y30OE72*/ 05383000
         MVC   FAILSW(1),ON                                        1679 05384000
*           END;                    /*                       @Y30OE72*/ 05385000
*         ELSE                      /* GOOD READ             @Y30OE72*/ 05386000
*           IF DFSWITCH=OFF&        /* DELETED RECORD OR     @Y30OE72*/ 05387000
*               RECBUF(1:4)=CHARHDR1 THEN/* NOT 'HDR1'?      @Y30OE72*/ 05388000
         B     @RC01674                                            1681 05389000
@RF01674 CLC   DFSWITCH(1),OFF                                     1681 05390000
         BNE   @RF01681                                            1681 05391000
         L     @12,IOBPTR                                          1681 05392000
         SLR   @11,@11                                             1681 05393000
         ICM   @11,7,CCWRDADD(@12)                                 1681 05394000
         CLC   RECBUF(4,@11),CHARHDR1                              1681 05395000
         BNE   @RF01681                                            1681 05396000
*             DO;                   /* NO. CHK HDR FIELDS    @Y30OE72*/ 05397000
*               WORKSW=OFF;         /* INIT TO VALID DATE    @Y30OE72*/ 05398000
         MVC   WORKSW(1),OFF                                       1683 05399000
*               LETPTR=ADDR(HDREXDTE);/* PT TO 1ST DATE CHAR @Y30OE72*/ 05400000
         LA    LETPTR,HDREXDTE(,@11)                               1684 05401000
*               DO I=1 TO 6;        /* CHECK FOR             @Y30OE72*/ 05402000
         LA    @12,1                                               1685 05403000
         ST    @12,I                                               1685 05404000
@DL01685 DS    0H                                                  1686 05405000
*                 IF^(LETTER>=CHAR0&/* VALID                 @Y30OE72*/ 05406000
*                     LETTER<=CHAR9) THEN/* EXPIRATION DATE  @Y30OE72*/ 05407000
         CLI   LETTER(LETPTR),C'0'                                 1686 05408000
         BL    @RT01686                                            1686 05409000
         CLI   LETTER(LETPTR),C'9'                                 1686 05410000
         BNH   @RF01686                                            1686 05411000
@RT01686 DS    0H                                                  1687 05412000
*                   WORKSW=ON;      /* NO. IND BAD DATE      @Y30OE72*/ 05413000
         MVC   WORKSW(1),ON                                        1687 05414000
*                 LETPTR=LETPTR+1;  /* PT TO NEXT CHAR       @Y30OE72*/ 05415000
@RF01686 AL    LETPTR,@CF00052                                     1688 05416000
*               END;                /*                       @Y30OE72*/ 05417000
         LA    @12,1                                               1689 05418000
         AL    @12,I                                               1689 05419000
         ST    @12,I                                               1689 05420000
         CH    @12,@CH00032                                        1689 05421000
         BNH   @DL01685                                            1689 05422000
*               IF WORKSW=OFF       /* VALID EXPIR DATE?     @Y30OE72*/ 05423000
*                 THEN              /* YES                   @Y30OE72*/ 05424000
         CLC   WORKSW(1),OFF                                       1690 05425000
         BNE   @RF01690                                            1690 05426000
*                 DO;               /* CHK IF EXPIRED        @Y30OE72*/ 05427000
*                   PACK(HDRYEAR1,HDRYEAR);/* PACK HDR1 YEAR @Y30OE72*/ 05428000
         L     @12,IOBPTR                                          1692 05429000
         SLR   @11,@11                                             1692 05430000
         ICM   @11,7,CCWRDADD(@12)                                 1692 05431000
         PACK  HDRYEAR1(2),HDRYEAR(2,@11)                          1692 05432000
*                   IF HDRYEAR1=SYSYEAR/* IS THE YEAR THE SAME     1693 05433000
*                                                            @Y30OE72*/ 05434000
*                     THEN          /* YES                   @Y30OE72*/ 05435000
         CLC   HDRYEAR1(2),SYSYEAR                                 1693 05436000
         BNE   @RF01693                                            1693 05437000
*                     DO;           /* CHECK DAY             @Y30OE72*/ 05438000
*                       PACK(HDRDAY1,HDRDAY);/* PACK HDR1 DAY      1695 05439000
*                                                            @Y30OE72*/ 05440000
         PACK  HDRDAY1(2),HDRDAY(2,@11)                            1695 05441000
*                       PACK(HDRMTH1,HDRMONTH);/* PACK HDR1 MON    1696 05442000
*                                                            @Y30OE72*/ 05443000
         PACK  HDRMTH1(2),HDRMONTH(2,@11)                          1696 05444000
*                       CVB(MONTH,HDRMTH1);/* GET BINARY MONTH     1697 05445000
*                                                            @Y30OE72*/ 05446000
         XC    @TS00001(8),@TS00001                                1697 05447000
         MVC   @TS00001+6(2),HDRMTH1                               1697 05448000
         CVB   @12,@TS00001                                        1697 05449000
         STC   @12,MONTH                                           1697 05450000
*                       CVB(DAY,HDRDAY1);/* GET BINARY DAY   @Y30OE72*/ 05451000
         XC    @TS00001(8),@TS00001                                1698 05452000
         MVC   @TS00001+6(2),HDRDAY1                               1698 05453000
         CVB   @11,@TS00001                                        1698 05454000
         STC   @11,DAY                                             1698 05455000
*                       CVB(YEAR,HDRYEAR1);/* GET BINARY YEAR      1699 05456000
*                                                            @Y30OE72*/ 05457000
         XC    @TS00001(8),@TS00001                                1699 05458000
         MVC   @TS00001+6(2),HDRYEAR1                              1699 05459000
         CVB   @02,@TS00001                                        1699 05460000
         STC   @02,YEAR                                            1699 05461000
*                       REMAIN=YEAR//4;/* DIVIDE YEAR BY 4   @Y30OE72   05462000
*                                      AND SAVE REMAINDER    @Y30OE72*/ 05463000
         LR    @14,@02                                             1700 05464000
         SRDA  @14,32                                              1700 05465000
         D     @14,@CF00037                                        1700 05466000
         STC   @14,REMAIN                                          1700 05467000
*                       JULIANDY=NLPYRTBL(MONTH)+DAY;/* GET JULIAN 1701 05468000
*                                      DAY                   @Y30OE72*/ 05469000
         ALR   @12,@12                                             1701 05470000
         AH    @11,NLPYRTBL-2(@12)                                 1701 05471000
         LR    JULIANDY,@11                                        1701 05472000
*                       IF REMAIN=ZERO/* IS THIS A LEAP YEAR @Y30OE72*/ 05473000
*                         THEN      /* YES                   @Y30OE72*/ 05474000
         CLI   REMAIN,0                                            1702 05475000
         BNE   @RF01702                                            1702 05476000
*                         IF MONTH>FEBRUARY THEN/* IF MARCH OR LATER    05477000
*                                                            @Y30OE72*/ 05478000
         CLI   MONTH,2                                             1703 05479000
         BNH   @RF01703                                            1703 05480000
*                           JULIANDY=JULIANDY+1;/* ADD 1 FOR LEAP  1704 05481000
*                                      YEAR                  @Y30OE72*/ 05482000
         AL    JULIANDY,@CF00052                                   1704 05483000
*                       CVD(JULIANDY,JULIANDT);/* PACK JULIAN DAY  1705 05484000
*                                                            @Y30OE72*/ 05485000
@RF01703 DS    0H                                                  1705 05486000
@RF01702 CVD   JULIANDY,@TS00001                                   1705 05487000
         MVC   JULIANDT(2),@TS00001+6                              1705 05488000
*                       IF SYSDAY<JULIANDT/* EXPIRED?        @Y30OE72*/ 05489000
*                         THEN      /* NO IND UNEXPIRED      @Y30OE72*/ 05490000
         CLC   SYSDAY(2),JULIANDT                                  1706 05491000
         BNL   @RF01706                                            1706 05492000
*                         EXPSW=ON; /* DATA SETS             @Y30OE72*/ 05493000
         MVC   EXPSW(1),ON                                         1707 05494000
*                     END;          /* END SAME YEAR PROCESS @Y30OE72*/ 05495000
*                   ELSE            /* YEAR NOT THE SAME     @Y30OE72*/ 05496000
*                     IF HDRYEAR1>SYSYEAR/* IS EXPIR YEAR >  @Y30OE72   05497000
*                                      THAN SYSTEM YEAR      @Y30OE72*/ 05498000
*                       THEN        /* YES, D.S. STILL GOOD  @Y30OE72*/ 05499000
         B     @RC01693                                            1709 05500000
@RF01693 CLC   HDRYEAR1(2),SYSYEAR                                 1709 05501000
         BNH   @RF01709                                            1709 05502000
*                       EXPSW=ON;   /* IND UNEXPIRED D/S     @Y30OE72*/ 05503000
         MVC   EXPSW(1),ON                                         1710 05504000
*                 END;              /* END EXP DATE PROCESS  @Y30OE72*/ 05505000
@RF01709 DS    0H                                                  1711 05506000
@RC01693 DS    0H                                                  1712 05507000
*               IF HDRWTPTI^=BLANK(1)/* WRITE PROTECTED?     @Y30OE72*/ 05508000
*                 THEN              /* YES.                  @Y30OE72*/ 05509000
@RF01690 L     @12,IOBPTR                                          1712 05510000
         ICM   @11,7,CCWRDADD(@12)                                 1712 05511000
         CLC   HDRWTPTI(1,@11),BLANK                               1712 05512000
         BE    @RF01712                                            1712 05513000
*                 PROTSW=ON;        /* IND WP DATA SETS      @Y30OE72*/ 05514000
         MVC   PROTSW(1),ON                                        1713 05515000
*             END;                  /* END HDR CHKING        @Y30OE72*/ 05516000
@RF01712 DS    0H                                                  1715 05517000
*       END;                        /* END READ HDR LOOP     @Y30OE72*/ 05518000
@RF01681 DS    0H                                                  1715 05519000
@RC01674 LA    @12,1                                               1715 05520000
         SLR   @11,@11                                             1715 05521000
         IC    @11,T                                               1715 05522000
         ALR   @12,@11                                             1715 05523000
         STC   @12,T                                               1715 05524000
         CH    @12,@CH02061                                        1715 05525000
         BNH   @DL01671                                            1715 05526000
@DC01671 DS    0H                                                  1716 05527000
*     END;                          /* END HDR1 PROCESS      @Y30OE72*/ 05528000
*   IF MODESW=TWO3540 THEN          /* OUTPT DSKT ON SYSUT2? @Y30OE72*/ 05529000
@RF01652 CLI   MODESW,2                                            1717 05530000
         BNE   @RF01717                                            1717 05531000
*     DO;                           /* YES.                  @Y30OE72*/ 05532000
*       IN1DCBPT=ADDR(SYSUT1);      /* RESET READ IOBS       @Y30OE72*/ 05533000
         LA    @12,SYSUT1                                          1719 05534000
         STCM  @12,7,IN1DCBPT                                      1719 05535000
*       IN2DCBPT=ADDR(SYSUT1);      /* TO SYSUT1             @Y30OE72*/ 05536000
         STCM  @12,7,IN2DCBPT                                      1720 05537000
*     END;                          /*                       @Y30OE72*/ 05538000
*   END PROTECT;                    /*                       @Y30OE72*/ 05539000
@EL00020 DS    0H                                                  1722 05540000
@EF00020 DS    0H                                                  1722 05541000
@ER00020 L     @14,@SA00020                                        1722 05542000
         BR    @14                                                 1722 05543000
*                                                                  1723 05544000
*/********************************************************************/ 05545000
*/*                                                          @Y30OE72*/ 05546000
*/* ROUTINE NAME = WRITE2                                    @Y30OE72*/ 05547000
*/*                                                          @Y30OE72*/ 05548000
*/* FUNCTION = READ A DATA SET FROM THE DASD INTERMEDIATE    @Y30OE72*/ 05549000
*/*            FILE AND WRITE IT TO THE OUTPUT DISKETTE.     @Y30OE72*/ 05550000
*/*                                                          @Y30OE72*/ 05551000
*/* INPUT = TN - FILE CONSTANT OF TOTAL NUMBER OF RECORDS IN @Y30OE72*/ 05552000
*/*              THE DATA SET.                               @Y30OE72*/ 05553000
*/*         DATA RECORDS ON THE SYSVT2 INTERMEDIATE FILE     @Y30OE72*/ 05554000
*/*         SYNAD ROUTINE (SYNADIN) ENTERED FROM QSAM GET IF @Y30OE72*/ 05555000
*/*         I/O ERROR ON INTERMEDIATE FILE.                  @Y30OE72*/ 05556000
*/*                                                          @Y30OE72*/ 05557000
*/* OUTPUT = DATA RECORDS FOR DATA SET WRITTEN ON OUTPUT     @Y30OE72*/ 05558000
*/*          DISKETTE.                                       @Y30OE72*/ 05559000
*/*          IEB504I OR IEB520I WRITTEN IF AN I/O ERROR      @Y30OE72*/ 05560000
*/*          OCCURRED.                                       @Y30OE72*/ 05561000
*/*                                                          @Y30OE72*/ 05562000
*/* ROUTINES CALLED = WRITETRK - TO WRITE DATA RECORDS TO    @Y30OE72*/ 05563000
*/*                              THE OUTPUT DISKETTE.        @Y30OE72*/ 05564000
*/*                   MSGWRTR - TO WRITE MESSAGES.           @Y30OE72*/ 05565000
*/*                                                          @Y30OE72*/ 05566000
*/* MACROS = GET                                             @Y30OE72*/ 05567000
*/*                                                          @Y30OE72*/ 05568000
*/********************************************************************/ 05569000
*                                                                  1723 05570000
*WRITE2:                            /*                       @Y30OE72*/ 05571000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE72*/ 05572000
WRITE2   ST    @14,@SA00021                                        1723 05573000
*   DO K=1 TO TN                    /*                       @Y30OE72*/ 05574000
*         WHILE SW504I=SETOFF;      /* READ/WRITE D/S        @Y30OE72*/ 05575000
         LA    K,1                                                 1724 05576000
         B     @DE01724                                            1724 05577000
@DL01724 TM    SW504I,B'00001000'                                  1724 05578000
         BNZ   @DC01724                                            1724 05579000
*     RFY                           /*                       @Y30OE72*/ 05580000
*       AREAADDR RSTD;              /*                       @Y30OE72*/ 05581000
*     AREAADDR=ADDR(RECBUF);        /* PT TO RECORD AREA     @Y30OE72*/ 05582000
         L     @12,IOBPTR                                          1726 05583000
         SLR   AREAADDR,AREAADDR                                   1726 05584000
         ICM   AREAADDR,7,CCWRDADD(@12)                            1726 05585000
*     GEN(GET SYSUT2IN,(AREAADDR)); /* READ A RECORD         @Y30OE72   05586000
*                                      OF DATA               @Y30OE72*/ 05587000
         GET SYSUT2IN,(AREAADDR)                                        05588000
*     CALL WRITETRK;                /* WRITE TO DSKT         @Y30OE72*/ 05589000
         BAL   @14,WRITETRK                                        1728 05590000
*     FIRSTPUT=SETOFF;              /* RESET 1ST TIME SW     @Y30OE72*/ 05591000
         NI    FIRSTPUT,B'11011111'                                1729 05592000
*     RFY                           /*                       @Y30OE72*/ 05593000
*       AREAADDR UNRSTD;            /*                       @Y30OE72*/ 05594000
*   END;                            /* END READ LOOP         @Y30OE72*/ 05595000
         AL    K,@CF00052                                          1731 05596000
@DE01724 CH    K,TN                                                1731 05597000
         BNH   @DL01724                                            1731 05598000
@DC01724 DS    0H                                                  1732 05599000
*EODADIN:                           /* EODAD RTN             @Y30OE72*/ 05600000
*   IF SW504I=SETOFF THEN           /* ANY WRITE ERRORS?     @Y30OE72*/ 05601000
EODADIN  TM    SW504I,B'00001000'                                  1732 05602000
         BNZ   @RF01732                                            1732 05603000
*     DO;                           /* NO. FLUSH BUFFERS     @Y30OE72*/ 05604000
*       LASTPUT=SETON;              /* INDICATE END OF FILE  @Y30OE72*/ 05605000
         OI    LASTPUT,B'00010000'                                 1734 05606000
*       CALL WRITETRK;              /* FLUSH BUFFERS         @Y30OE72*/ 05607000
         BAL   @14,WRITETRK                                        1735 05608000
*       LASTPUT=SETOFF;             /* RESET                 @Y30OE72*/ 05609000
         NI    LASTPUT,B'11101111'                                 1736 05610000
*     END;                          /*                       @Y30OE72*/ 05611000
*   GOTO CONT;                      /* EXIT FROM ROUTINE     @Y30OE72*/ 05612000
         B     CONT                                                1738 05613000
*SYNADIN:                           /* SYNAD ROUTINE         @Y30OE72*/ 05614000
*   I520DDNM=SYSUT2DD;              /* DDNAME INTO MSG       @Y30OE72*/ 05615000
SYNADIN  MVC   I520DDNM(8),@CC02093                                1739 05616000
*   REG1=ADDR(IEB520I);             /* ISSUE                 @Y30OE72*/ 05617000
         LA    REG1,IEB520I                                        1740 05618000
*   MSGLEN=LENGTH(IEB520I);         /* MESSAGE               @Y30OE72*/ 05619000
         MVI   MSGLEN,X'1A'                                        1741 05620000
*   CALL MSGWRTR;                   /* IEB520I               @Y30OE72*/ 05621000
         BAL   @14,MSGWRTR                                         1742 05622000
*   FAILSW=ON;                      /* TERMINATE RUN         @Y30OE72*/ 05623000
         MVC   FAILSW(1),ON                                        1743 05624000
*CONT:                              /*                       @Y30OE72*/ 05625000
*   END WRITE2;                     /* PROCEDURE END         @Y30OE72*/ 05626000
@EL00021 DS    0H                                                  1744 05627000
@EF00021 DS    0H                                                  1744 05628000
@ER00021 L     @14,@SA00021                                        1744 05629000
         BR    @14                                                 1744 05630000
*                                                                  1745 05631000
*/********************************************************************/ 05632000
*/*                                                          @Y30OE72*/ 05633000
*/* ROUTINE NAME = TR0WRITE                                  @Y30OE72*/ 05634000
*/*                                                          @Y30OE72*/ 05635000
*/* FUNCTION = WRITE TRACK 0 RECORDS ON OUTPUT DISKETTE.     @Y30OE72*/ 05636000
*/*            THE TR0T IS CHECKED FOR SECURE DATA SETS. IF  @Y30OE72*/ 05637000
*/*            SECURE DATA SETS ARE PRESENT AND THE VOLUME   @Y30OE72*/ 05638000
*/*            ACCESSABILITY INDICATOR IS NOT NON-BLANK,     @Y30OE72*/ 05639000
*/*            THEN THE VA INDICATOR IS SET = TO THE DSS     @Y30OE72*/ 05640000
*/*            INDICATOR OF THE 1ST SECURE D/S.  IEB521I IS  @Y30OE72*/ 05641000
*/*            ISSUED TO THE USER TO INFORM HIM THAT THE     @Y30OE72*/ 05642000
*/*            VOLUME ACCESSABILITY INDICATOR HAS BEEN SET.  @Y30OE72*/ 05643000
*/*            CREATION & EXPIRATION DATES ARE FILLED IN FOR @Y30OE72*/ 05644000
*/*            ALL DATA SETS THAT HAVE BLANK ENTRIES FOR THE @Y30OE72*/ 05645000
*/*            DATES.                                        @Y30OE72*/ 05646000
*/*                                                          @Y30OE72*/ 05647000
*/* INPUT = TR0T - IN CORE REPRESENTATION OF TRACK 0 INFO    @Y30OE72*/ 05648000
*/*         SAVEDATE - CURRENT SYSTEM DATE                   @Y30OE72*/ 05649000
*/*                                                          @Y30OE72*/ 05650000
*/* OUTPUT = TRACK 0 WRITTEN ON OUTPUT DISKETTE              @Y30OE72*/ 05651000
*/*          MSG IEB521I IF A VA INDICATOR WAS ASSIGNED      @Y30OE72*/ 05652000
*/*          MSG IEB504I IF I/O ERROR WRITING TRACK 0        @Y30OE72*/ 05653000
*/*                                                          @Y30OE72*/ 05654000
*/* ROUTINES CALLED = DATECONV - TO CONVERT A DATE FROM      @Y30OE72*/ 05655000
*/*                              YYDDD TO YYMMDD FORMAT.     @Y30OE72*/ 05656000
*/*                   MSGWRTR - TO WRITE MESSAGES.           @Y30OE72*/ 05657000
*/*                   WRITETRK - TO WRITE TRACK 0            @Y30OE72*/ 05658000
*/*                                                          @Y30OE72*/ 05659000
*/* MACROS = NONE                                            @Y30OE72*/ 05660000
*/*                                                          @Y30OE72*/ 05661000
*/********************************************************************/ 05662000
*                                                                  1745 05663000
*TR0WRITE:                          /*                       @Y30OE72*/ 05664000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE72*/ 05665000
TR0WRITE ST    @14,@SA00022                                        1745 05666000
*   PROTSW=OFF;                     /* INITIALIZE SWITCH     @Y30OE72*/ 05667000
         MVC   PROTSW(1),OFF                                       1746 05668000
*   CVB(DAY1,SAVEDATE(3:4));        /* GET BINARY SYS DAY    @Y30OE72*/ 05669000
         XC    @TS00001(8),@TS00001                                1747 05670000
         MVC   @TS00001+6(2),SAVEDATE+2                            1747 05671000
         CVB   DAY1,@TS00001                                       1747 05672000
*   CALL DATECONV;                  /* CONVERT CURRENT DATE  @Y30OE72*/ 05673000
         BAL   @14,DATECONV                                        1748 05674000
*   CREADATE=DATE;                  /* SAVE CREATION DATE    @Y30OE72*/ 05675000
         MVC   CREADATE(6),DATE                                    1749 05676000
*   CVB(DAY1,SAVEDATE(3:4));        /* GET BINARY SYS DAY    @Y30OE72*/ 05677000
         XC    @TS00001(8),@TS00001                                1750 05678000
         MVC   @TS00001+6(2),SAVEDATE+2                            1750 05679000
         CVB   DAY1,@TS00001                                       1750 05680000
*   DAY1=DAY1+1;                    /* EXPIRATION DATE       @Z30OEAD*/ 05681000
         AL    DAY1,@CF00052                                       1751 05682000
*   CALL DATECONV;                  /* CONVERT EXP DATE      @Y30OE72*/ 05683000
         BAL   @14,DATECONV                                        1752 05684000
*   EXPDATE=DATE;                   /* SAVE EXP DATE         @Y30OE72*/ 05685000
*                                                                  1753 05686000
         MVC   EXPDATE(6),DATE                                     1753 05687000
*   /*****************************************************************/ 05688000
*   /*                                                               */ 05689000
*   /* FILL IN CREATION/EXPIRATION DATES AND VOLUME          @Y30OE72*/ 05690000
*   /* ACCESSABILITY INDICATOR, IF REQUIRED                  @Y30OE72*/ 05691000
*   /*                                                               */ 05692000
*   /*****************************************************************/ 05693000
*                                                                  1754 05694000
*   DO I=4 TO(TABCNT+3);            /* SEARCH TR0T FOR OPEN  @Y30OE72   05695000
*                                      DATES & SECURE D/S    @Y30OE72*/ 05696000
         LA    @12,4                                               1754 05697000
         B     @DE01754                                            1754 05698000
@DL01754 DS    0H                                                  1755 05699000
*     IF TR0TDSS(I)^=BLANK(1) THEN  /* SECURE DATA SET?      @Y30OE72*/ 05700000
         MH    @12,@CH00311                                        1755 05701000
         LA    @11,TR0TDSS-80(@12)                                 1755 05702000
         CLC   0(1,@11),BLANK                                      1755 05703000
         BE    @RF01755                                            1755 05704000
*       IF TR0T(3,11)=BLANK(1) THEN /* YES. IS VOL SECURE?   @Y30OE72*/ 05705000
         CLC   TR0T+170(1),BLANK                                   1756 05706000
         BNE   @RF01756                                            1756 05707000
*         DO;                       /* NO.                   @Y30OE72*/ 05708000
*           TR0T(3,11)=TR0TDSS(I);  /* USE 1ST DSS FOR VA    @Y30OE72*/ 05709000
         LA    @11,TR0TDSS-80(@12)                                 1758 05710000
         MVC   @TS00001(1),0(@11)                                  1758 05711000
         MVC   TR0T+170(1),@TS00001                                1758 05712000
*           I521VA=TR0TDSS(I);      /* INSERT VA IN MSG      @Y30OE72*/ 05713000
         LA    @11,TR0TDSS-80(@12)                                 1759 05714000
         MVC   I521VA(1),0(@11)                                    1759 05715000
*           REG1=ADDR(IEB521I);     /* ISSUE                 @Y30OE72*/ 05716000
         LA    REG1,IEB521I                                        1760 05717000
*           MSGLEN=LENGTH(IEB521I); /* MESSAGE               @Y30OE72*/ 05718000
         MVI   MSGLEN,X'30'                                        1761 05719000
*           CALL MSGWRTR;           /* IEB521I               @Y30OE72*/ 05720000
         BAL   @14,MSGWRTR                                         1762 05721000
*         END;                      /*                       @Y30OE72*/ 05722000
*     IF TR0TCREA(I)=BLANK(1:6)&    /* CREATION DATE?        @Y30OE72*/ 05723000
*         TR0TID(I)=CHARHDR1 THEN   /*                       @Y30OE72*/ 05724000
@RF01756 DS    0H                                                  1764 05725000
@RF01755 L     @12,I                                               1764 05726000
         MH    @12,@CH00311                                        1764 05727000
         LA    @11,TR0TCREA-80(@12)                                1764 05728000
         CLC   0(6,@11),BLANK                                      1764 05729000
         BNE   @RF01764                                            1764 05730000
         LA    @11,TR0TID-80(@12)                                  1764 05731000
         CLC   0(4,@11),CHARHDR1                                   1764 05732000
         BNE   @RF01764                                            1764 05733000
*       TR0TCREA(I)=CREADATE;       /* NO. FILL IT IN        @Y30OE72*/ 05734000
         LA    @11,TR0TCREA-80(@12)                                1765 05735000
         MVC   0(6,@11),CREADATE                                   1765 05736000
*     IF TR0TEXP(I)=BLANK(1:6)&     /* EXPIRATION DATE?      @Y30OE72*/ 05737000
*         TR0TID(I)=CHARHDR1 THEN   /*                       @Y30OE72*/ 05738000
@RF01764 L     @12,I                                               1766 05739000
         MH    @12,@CH00311                                        1766 05740000
         LA    @11,TR0TEXP-80(@12)                                 1766 05741000
         CLC   0(6,@11),BLANK                                      1766 05742000
         BNE   @RF01766                                            1766 05743000
         LA    @11,TR0TID-80(@12)                                  1766 05744000
         CLC   0(4,@11),CHARHDR1                                   1766 05745000
         BNE   @RF01766                                            1766 05746000
*       TR0TEXP(I)=EXPDATE;         /* NO. FILL IT IN        @Y30OE72*/ 05747000
         LA    @11,TR0TEXP-80(@12)                                 1767 05748000
         MVC   0(6,@11),EXPDATE                                    1767 05749000
*   END;                            /*                       @Y30OE72*/ 05750000
@RF01766 LA    @12,1                                               1768 05751000
         AL    @12,I                                               1768 05752000
@DE01754 ST    @12,I                                               1768 05753000
         LA    @11,3                                               1768 05754000
         AH    @11,TABCNT                                          1768 05755000
         CR    @12,@11                                             1768 05756000
         BNH   @DL01754                                            1768 05757000
*   SC=TRACK0;                      /* START ADDR = TRACK 0  @Y30OE72*/ 05758000
         SLR   @12,@12                                             1769 05759000
         IC    @12,TRACK0                                          1769 05760000
         STH   @12,SC                                              1769 05761000
*   SR=IPLREC1;                     /* SECTOR 1              @Y30OE72*/ 05762000
         SLR   @12,@12                                             1770 05763000
         IC    @12,IPLREC1                                         1770 05764000
         STH   @12,SR                                              1770 05765000
*   FIRSTPUT=SETON;                 /* WRITETRK 1ST TIME SW  @Y30OE72*/ 05766000
*                                                                  1771 05767000
         OI    FIRSTPUT,B'00100000'                                1771 05768000
*   /*****************************************************************/ 05769000
*   /*                                                               */ 05770000
*   /* WRITE IPL RECORDS                                     @Y30OE72*/ 05771000
*   /*                                                               */ 05772000
*   /*****************************************************************/ 05773000
*                                                                  1772 05774000
*   DO I=1 TO 2;                    /* WRITE IPL RECORDS     @Y30OE72*/ 05775000
         LA    @12,1                                               1772 05776000
         ST    @12,I                                               1772 05777000
@DL01772 DS    0H                                                  1773 05778000
*     RECBUF=ZEROREC;               /* CLEAR BUFFER          @ZA04465*/ 05779000
         L     @11,IOBPTR                                          1773 05780000
         SLR   @15,@15                                             1773 05781000
         ICM   @15,7,CCWRDADD(@11)                                 1773 05782000
         MVC   RECBUF(128,@15),ZEROREC                             1773 05783000
*     RECBUF(1:80)=TR0T(I);         /* MOVE IPL REC IN BUFF  @Y30OE72*/ 05784000
         MH    @12,@CH00311                                        1774 05785000
         LA    @11,TR0T-80(@12)                                    1774 05786000
         MVC   RECBUF(80,@15),0(@11)                               1774 05787000
*     CALL WRITETRK;                /* PUT REC IN OUTPUT BUF @Y30OE72*/ 05788000
         BAL   @14,WRITETRK                                        1775 05789000
*     FIRSTPUT=SETOFF;              /* RESET 1ST TIME SW     @Y30OE72*/ 05790000
         NI    FIRSTPUT,B'11011111'                                1776 05791000
*   END;                            /*                       @Y30OE72*/ 05792000
         LA    @12,1                                               1777 05793000
         AL    @12,I                                               1777 05794000
         ST    @12,I                                               1777 05795000
         CH    @12,@CH00070                                        1777 05796000
         BNH   @DL01772                                            1777 05797000
*   LASTPUT=SETON;                  /* FLUSH BUFFER SW       @Y30OE72*/ 05798000
         OI    LASTPUT,B'00010000'                                 1778 05799000
*   CALL WRITETRK;                  /* WRITE 2 IPL RECS      @Y30OE72*/ 05800000
         BAL   @14,WRITETRK                                        1779 05801000
*   LASTPUT=SETOFF;                 /* RESET                 @Y30OE72*/ 05802000
*                                                                  1780 05803000
         NI    LASTPUT,B'11101111'                                 1780 05804000
*   /*****************************************************************/ 05805000
*   /*                                                               */ 05806000
*   /* WRITE VOL1 AND HDR1 LABELS                            @Y30OE72*/ 05807000
*   /*                                                               */ 05808000
*   /*****************************************************************/ 05809000
*                                                                  1781 05810000
*   IF SW504I=SETOFF THEN           /* IPL RECS WRITTEN OK?  @Y30OE72*/ 05811000
         TM    SW504I,B'00001000'                                  1781 05812000
         BNZ   @RF01781                                            1781 05813000
*     DO;                           /* YES. WRTE VOL & HDR1S @Y30OE72*/ 05814000
*       SR=VOLLABEL;                /* START ADDR=SECTOR 7   @Y30OE72*/ 05815000
         MVC   SR(2),@CH00033                                      1783 05816000
*       FIRSTPUT=SETON;             /* WRITETRK 1ST TIME SW  @Y30OE72*/ 05817000
         OI    FIRSTPUT,B'00100000'                                1784 05818000
*       DO I=3 TO TABCNT+3;         /* MOVE RECS TO BUFFER   @Y30OE72*/ 05819000
         LA    @12,3                                               1785 05820000
         B     @DE01785                                            1785 05821000
@DL01785 DS    0H                                                  1786 05822000
*         RECBUF=ZEROREC;           /* CLEAR BUFFER          @ZA04465*/ 05823000
         L     @11,IOBPTR                                          1786 05824000
         SLR   @15,@15                                             1786 05825000
         ICM   @15,7,CCWRDADD(@11)                                 1786 05826000
         MVC   RECBUF(128,@15),ZEROREC                             1786 05827000
*         RECBUF(1:80)=TR0T(I);     /* MOVE REC IN BUFF      @Y30OE72*/ 05828000
         MH    @12,@CH00311                                        1787 05829000
         LA    @11,TR0T-80(@12)                                    1787 05830000
         MVC   RECBUF(80,@15),0(@11)                               1787 05831000
*         CALL WRITETRK;            /* PUT REC IN OUTPUT BUF @Y30OE72*/ 05832000
         BAL   @14,WRITETRK                                        1788 05833000
*         FIRSTPUT=SETOFF;          /* RESET 1ST TIME SW     @Y30OE72*/ 05834000
         NI    FIRSTPUT,B'11011111'                                1789 05835000
*       END;                        /*                       @Y30OE72*/ 05836000
         LA    @12,1                                               1790 05837000
         AL    @12,I                                               1790 05838000
@DE01785 ST    @12,I                                               1790 05839000
         LA    @11,3                                               1790 05840000
         AH    @11,TABCNT                                          1790 05841000
         CR    @12,@11                                             1790 05842000
         BNH   @DL01785                                            1790 05843000
*       LASTPUT=SETON;              /* FLUSH BUFFER SW       @Y30OE72*/ 05844000
         OI    LASTPUT,B'00010000'                                 1791 05845000
*       CALL WRITETRK;              /* WRITE VOL1 & HDR1S    @Y30OE72*/ 05846000
         BAL   @14,WRITETRK                                        1792 05847000
*       LASTPUT=SETOFF;             /* RESET                 @Y30OE72*/ 05848000
         NI    LASTPUT,B'11101111'                                 1793 05849000
*     END;                          /*                       @Y30OE72*/ 05850000
*   IF SW504I=SETON THEN            /* I/O ERROR?            @Y30OE72*/ 05851000
@RF01781 TM    SW504I,B'00001000'                                  1795 05852000
         BNO   @RF01795                                            1795 05853000
*     DO;                           /* YES.                  @Y30OE72*/ 05854000
*       REG1=ADDR(IEB504I);         /* ISSUE                 @Y30OE72*/ 05855000
         LA    REG1,IEB504I                                        1797 05856000
*       MSGLEN=LENGTH(IEB504I);     /* MESSAGE               @Y30OE72*/ 05857000
         MVI   MSGLEN,X'28'                                        1798 05858000
*       CALL MSGWRTR;               /* IEB504I               @Y30OE72*/ 05859000
         BAL   @14,MSGWRTR                                         1799 05860000
*       FAILSW=ON;                  /* TERMINATE RUN         @Y30OE72*/ 05861000
         MVC   FAILSW(1),ON                                        1800 05862000
*     END;                          /*                       @Y30OE72*/ 05863000
*   END TR0WRITE;                   /* PROCEDURE END         @Y30OE72*/ 05864000
@EL00022 DS    0H                                                  1802 05865000
@EF00022 DS    0H                                                  1802 05866000
@ER00022 L     @14,@SA00022                                        1802 05867000
         BR    @14                                                 1802 05868000
*                                                                  1803 05869000
*/********************************************************************/ 05870000
*/*                                                          @Y30OE72*/ 05871000
*/* ROUTINE NAME = DATECONV                                  @Y30OE72*/ 05872000
*/*                                                          @Y30OE72*/ 05873000
*/* FUNCTION = CONVERT DATE FROM YYDDD TO YYMMDD FORMAT      @Y30OE72*/ 05874000
*/*                                                          @Y30OE72*/ 05875000
*/* INPUT = DATE IN YYDDD FORMAT                             @Y30OE72*/ 05876000
*/*                                                          @Y30OE72*/ 05877000
*/* OUTPUT = DATE IN YYMMDD FORMAT                           @Y30OE72*/ 05878000
*/*                                                          @Y30OE72*/ 05879000
*/* ROUTINES CALLED = NONE                                   @Y30OE72*/ 05880000
*/*                                                          @Y30OE72*/ 05881000
*/* MACROS = NONE                                            @Y30OE72*/ 05882000
*/*                                                          @Y30OE72*/ 05883000
*/********************************************************************/ 05884000
*                                                                  1803 05885000
*DATECONV:                          /*                       @Y30OE72*/ 05886000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE72*/ 05887000
DATECONV ST    @14,12(,@13)                                        1803 05888000
*   PACK(SYSYEAR,UNPKYEAR);         /* GET PACKED SYS YEAR   @Y30OE72*/ 05889000
         PACK  SYSYEAR(2),UNPKYEAR(2)                              1804 05890000
*   CVB(YEAR,SYSYEAR);              /* GET BINARY SYS YEAR   @Y30OE72*/ 05891000
         XC    @TS00001(8),@TS00001                                1805 05892000
         MVC   @TS00001+6(2),SYSYEAR                               1805 05893000
         CVB   @12,@TS00001                                        1805 05894000
         STC   @12,YEAR                                            1805 05895000
*   REMAIN=YEAR//4;                 /* GET REMAINDER OF YEAR @Y30OE72   05896000
*                                      DIVIDED BY FOUR       @Y30OE72*/ 05897000
         LR    @14,@12                                             1806 05898000
         SRDA  @14,32                                              1806 05899000
         D     @14,@CF00037                                        1806 05900000
         STC   @14,REMAIN                                          1806 05901000
*   IF REMAIN=ZERO                  /* IS THIS A LEAP YEAR   @Y30OE72*/ 05902000
*     THEN                          /* YES                   @Y30OE72*/ 05903000
         CLI   REMAIN,0                                            1807 05904000
         BNE   @RF01807                                            1807 05905000
*     DO;                           /* CONTINUE              @Y30OE72*/ 05906000
*       NUMDAY=LEAPDAYS;            /* NUMBER OF DAYS=366    @Y30OE72*/ 05907000
         MVC   NUMDAY(2),LEAPDAYS                                  1809 05908000
*       TABPTR=ADDR(LPYRTBL);       /* GET LEAP YEAR TABLE   @Y30OE72*/ 05909000
         LA    @12,LPYRTBL                                         1810 05910000
         ST    @12,TABPTR                                          1810 05911000
*     END;                          /* END LEAP YEAR         @Y30OE72*/ 05912000
*   ELSE                            /* NOT LEAP YEAR         @Y30OE72*/ 05913000
*     DO;                           /*                       @Y30OE72*/ 05914000
         B     @RC01807                                            1812 05915000
@RF01807 DS    0H                                                  1813 05916000
*       NUMDAY=REGDAYS;             /* SET NUM OF DAYS = 365 @Y30OE72*/ 05917000
         MVC   NUMDAY(2),REGDAYS                                   1813 05918000
*       TABPTR=ADDR(NLPYRTBL);      /* GET NON-LEAP YEAR TBL @Y30OE72*/ 05919000
         LA    @12,NLPYRTBL                                        1814 05920000
         ST    @12,TABPTR                                          1814 05921000
*     END;                          /* END NON LEAP YEAR     @Y30OE72*/ 05922000
*   IF DAY1>NUMDAY                  /* PAST END OF YEAR?     @Y30OE72*/ 05923000
*     THEN                          /*                       @Y30OE72*/ 05924000
@RC01807 LH    @12,NUMDAY                                          1816 05925000
         CR    DAY1,@12                                            1816 05926000
         BNH   @RF01816                                            1816 05927000
*     DO;                           /* YES.                  @Y30OE72*/ 05928000
*       DAY1=DAY1-NUMDAY;           /* GET DAY NUM OF NXT YR @Y30OE72*/ 05929000
         SLR   DAY1,@12                                            1818 05930000
*       YEAR=YEAR+1;                /* YEAR=NEXT YEAR        @Y30OE72*/ 05931000
         IC    @12,YEAR                                            1819 05932000
         LA    @12,1(,@12)                                         1819 05933000
         STC   @12,YEAR                                            1819 05934000
*     END;                          /* END YEAR PROCESS      @Y30OE72*/ 05935000
*   I=NUMMONTH;                     /* SET MONTH CTR TO 12   @Y30OE72*/ 05936000
@RF01816 MVC   I(4),@CF02184                                       1821 05937000
*   DO WHILE TRANSTBL(I)-DAY1>=ZERO;/* FIND CORRECT MONTH    @Y30OE72*/ 05938000
         B     @DE01822                                            1822 05939000
@DL01822 DS    0H                                                  1823 05940000
*     I=I-1;                        /* DECREASE MONTH BY ONE @Y30OE72*/ 05941000
         L     @12,I                                               1823 05942000
         BCTR  @12,0                                               1823 05943000
         ST    @12,I                                               1823 05944000
*   END;                            /*                       @Y30OE72*/ 05945000
@DE01822 L     @12,I                                               1824 05946000
         LR    @11,@12                                             1824 05947000
         ALR   @11,@11                                             1824 05948000
         L     @02,TABPTR                                          1824 05949000
         BCTR  @02,0                                               1824 05950000
         BCTR  @02,0                                               1824 05951000
         LH    @11,TRANSTBL(@11,@02)                               1824 05952000
         LR    @02,@11                                             1824 05953000
         SLR   @02,DAY1                                            1824 05954000
         LTR   @02,@02                                             1824 05955000
         BNM   @DL01822                                            1824 05956000
*   DAY1=DAY1-TRANSTBL(I);          /* GET DAY OF MONTH      @Y30OE72*/ 05957000
         SLR   DAY1,@11                                            1825 05958000
*   CVD(I,HDRMTH1);                 /* GET PACKED MONTH      @Y30OE72*/ 05959000
         CVD   @12,@TS00001                                        1826 05960000
         MVC   HDRMTH1(2),@TS00001+6                               1826 05961000
*   UNPK(DATEMON,HDRMTH1);          /* EBCDIC MONTH          @Y30OE72*/ 05962000
         UNPK  DATEMON(2),HDRMTH1(2)                               1827 05963000
*   DATEMON(2)=DATEMON(2)|FOXZERO;  /* CHANGE SIGN           @Y30OE72*/ 05964000
         OI    DATEMON+1,X'F0'                                     1828 05965000
*   CVD(DAY1,HDRDAY1);              /* GET PACKED DAY        @Y30OE72*/ 05966000
         CVD   DAY1,@TS00001                                       1829 05967000
         MVC   HDRDAY1(2),@TS00001+6                               1829 05968000
*   UNPK(DATEDAY,HDRDAY1);          /* EBCDIC DAY            @Y30OE72*/ 05969000
         UNPK  DATEDAY(2),HDRDAY1(2)                               1830 05970000
*   DATEDAY(2)=DATEDAY(2)|FOXZERO;  /* CHANGE SIGN           @Y30OE72*/ 05971000
         OI    DATEDAY+1,X'F0'                                     1831 05972000
*   CVD(YEAR,HDRYEAR1);             /* GET PACKED YEAR       @Y30OE72*/ 05973000
         SLR   @12,@12                                             1832 05974000
         IC    @12,YEAR                                            1832 05975000
         CVD   @12,@TS00001                                        1832 05976000
         MVC   HDRYEAR1(2),@TS00001+6                              1832 05977000
*   UNPK(DATEYEAR,HDRYEAR1);        /* EBCDIC YEAR           @Y30OE72*/ 05978000
         UNPK  DATEYEAR(2),HDRYEAR1(2)                             1833 05979000
*   DATEYEAR(2)=DATEYEAR(2)|FOXZERO;/* CHANGE SIGN           @Y30OE72*/ 05980000
         OI    DATEYEAR+1,X'F0'                                    1834 05981000
*   END DATECONV;                   /*                       @Y30OE72*/ 05982000
@EL00023 DS    0H                                                  1835 05983000
@EF00023 DS    0H                                                  1835 05984000
@ER00023 L     @14,12(,@13)                                        1835 05985000
         BR    @14                                                 1835 05986000
*                                                                  1836 05987000
*/********************************************************************/ 05988000
*/*                                                          @Y30OE72*/ 05989000
*/* ROUTINE NAME = MSGWRTR                                   @Y30OE72*/ 05990000
*/*                                                          @Y30OE72*/ 05991000
*/* FUNCTION = ISSUE ALL MESSAGES                            @Y30OE72*/ 05992000
*/*                                                          @Y30OE72*/ 05993000
*/* INPUT = REG1 POINTS THE MESSAGE                          @Y30OE72*/ 05994000
*/*         MSGLEN - LENGTH OF MESSAGE                       @Y30OE72*/ 05995000
*/*                                                          @Y30OE72*/ 05996000
*/* OUTPUT = MESSAGE WRITTEN TO CONSOLE OR SYSPRINT DATA SET @Y30OE72*/ 05997000
*/*          REPLY CONTAINS OPERATOR REPLY IF A WTOR WAS     @Y30OE72*/ 05998000
*/*          ISSUED.                                         @Y30OE72*/ 05999000
*/*                                                          @Y30OE72*/ 06000000
*/* ROUTINES CALLED = NONE                                   @Y30OE72*/ 06001000
*/*                                                          @Y30OE72*/ 06002000
*/* MACROS = WTOR,WAIT,PUT                                   @Y30OE72*/ 06003000
*/*                                                          @Y30OE72*/ 06004000
*/********************************************************************/ 06005000
*                                                                  1836 06006000
*MSGWRTR:                           /*                       @Y30OE72*/ 06007000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE72*/ 06008000
*                                                                  1836 06009000
MSGWRTR  ST    @14,@SA00024                                        1836 06010000
*   /*****************************************************************/ 06011000
*   /*                                                               */ 06012000
*   /* ISSUE WTORS                                           @Y30OE72*/ 06013000
*   /*                                                               */ 06014000
*   /*****************************************************************/ 06015000
*                                                                  1837 06016000
*   IF MSGTYPE=ACTION THEN          /* WTOR MESSAGE?         @Y30OE72*/ 06017000
         CLI   MSGTYPE,C'A'                                        1837 06018000
         BNE   @RF01837                                            1837 06019000
*     DO;                           /* YES.                  @Y30OE72*/ 06020000
*       REPLY=BLANK(1:5);           /* INIT REPLY AREA       @Y30OE72*/ 06021000
         MVC   REPLY(5),BLANK                                      1839 06022000
*       GEN(WTOR MF=(E,(1)));       /* ISSUE WTOR            @Y30OE72*/ 06023000
         WTOR MF=(E,(1))                                                06024000
*       WTORECB=WTORECB&&WTORECB;   /* CLEAR ECB             @Y30OE72*/ 06025000
         XC    WTORECB(4),WTORECB                                  1841 06026000
*       REG1=ADDR(WTORECB);         /* SET UP FOR WAIT       @Y30OE72*/ 06027000
         LA    REG1,WTORECB                                        1842 06028000
*       GEN(WAIT ECB=(REG1));       /* WAIT FOR REPLY        @Y30OE72*/ 06029000
         WAIT ECB=(REG1)                                                06030000
*       REPLY=REPLY|BLANK(1:5);     /* CAPITALIZE REPLY      @Y30OE72*/ 06031000
         OC    REPLY(5),BLANK                                      1844 06032000
*     END;                          /*                       @Y30OE72*/ 06033000
*                                                                  1845 06034000
*   /*****************************************************************/ 06035000
*   /*                                                               */ 06036000
*   /* ISSUE INFORMATIONAL MESSAGES                          @Y30OE72*/ 06037000
*   /*                                                               */ 06038000
*   /*****************************************************************/ 06039000
*                                                                  1846 06040000
*   ELSE                            /* INFORMATIONAL MSG     @Y30OE72*/ 06041000
*     DO;                           /* OR TABLE PRINT        @Y30OE72*/ 06042000
         B     @RC01837                                            1846 06043000
@RF01837 DS    0H                                                  1847 06044000
*       IF MSGTYPE^=TABLE THEN      /* INFO MSG?             @Y30OE72*/ 06045000
         CLI   MSGTYPE,C'T'                                        1847 06046000
         BE    @RF01847                                            1847 06047000
*         DO;                       /*                       @Y30OE72*/ 06048000
*           IF PRTTITLE=ON THEN     /* IF 1ST MSG, THEN      @Y30OE72*/ 06049000
         CLC   PRTTITLE(1),ON                                      1849 06050000
         BNE   @RF01849                                            1849 06051000
*             DO;                   /*                       @Y30OE72*/ 06052000
*               REG1SAVE=REG1;      /*                       @Y30OE72*/ 06053000
         ST    REG1,REG1SAVE                                       1851 06054000
*               DO I=1 TO 3;        /* PRINT TITLE, SPACE 2  @Y30OE72*/ 06055000
         LA    @12,1                                               1852 06056000
         ST    @12,I                                               1852 06057000
@DL01852 DS    0H                                                  1853 06058000
*                 GEN(PUT SYSPRINT,PRT)/*                    @Y30OE72*/ 06059000
*                 REFS(PRT);        /*                       @Y30OE72*/ 06060000
         PUT SYSPRINT,PRT                                               06061000
*                 PRT=BLANK(1:121); /* BLANK OUT BUFFER      @Y30OE72*/ 06062000
         MVC   PRT(121),BLANK                                      1854 06063000
*                 PRTTITLE=OFF;     /* PRINT TITLE 1 TIME    @Y30OE72*/ 06064000
         MVC   PRTTITLE(1),OFF                                     1855 06065000
*               END;                /*                       @Y30OE72*/ 06066000
         LA    @12,1                                               1856 06067000
         AL    @12,I                                               1856 06068000
         ST    @12,I                                               1856 06069000
         CH    @12,@CH00108                                        1856 06070000
         BNH   @DL01852                                            1856 06071000
*               REG1=REG1SAVE;      /*                       @Y30OE72*/ 06072000
         L     REG1,REG1SAVE                                       1857 06073000
*             END;                  /*                       @Y30OE72*/ 06074000
*           PRT=BLANK(1:121);       /* BLANK OUT BUFFER      @Y30OE72*/ 06075000
@RF01849 MVC   PRT(121),BLANK                                      1859 06076000
*           PRT(1:MSGLEN)=MSGTEXT(1:MSGLEN);/* MOVE IN MSG   @Y30OE72*/ 06077000
         SLR   @12,@12                                             1860 06078000
         IC    @12,MSGLEN                                          1860 06079000
         BCTR  @12,0                                               1860 06080000
         EX    @12,@SM03568                                        1860 06081000
*         END;                      /*                       @Y30OE72*/ 06082000
*       GEN(PUT SYSPRINT,PRT)       /* WRITE                 @Y30OE72*/ 06083000
*       REFS(PRT);                  /* MESSAGE               @Y30OE72*/ 06084000
@RF01847 DS    0H                                                  1862 06085000
         PUT SYSPRINT,PRT                                               06086000
*     END;                          /*                       @Y30OE72*/ 06087000
*   MSGTYPE=BLANK(1);               /* RESET TYPE INDICATOR  @Y30OE72*/ 06088000
@RC01837 MVC   MSGTYPE(1),BLANK                                    1864 06089000
*   END MSGWRTR;                    /*                       @Y30OE72*/ 06090000
@EL00024 DS    0H                                                  1865 06091000
@EF00024 DS    0H                                                  1865 06092000
@ER00024 L     @14,@SA00024                                        1865 06093000
         BR    @14                                                 1865 06094000
*SYSPTERR:                          /* SYSPRINT SYNAD RTN    @Y30OE72*/ 06095000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE72*/ 06096000
SYSPTERR ST    @14,@SA00025                                        1866 06097000
*   I520DDNM=SYSPRTDD;              /* DDNAME INTO MSG       @Y30OE72*/ 06098000
         MVC   I520DDNM(8),@CC02087                                1867 06099000
*   PRT(5:4+LENGTH(IEB520I))=IEB520I;/* MSG TEXT INTO BUFF   @Y30OE72*/ 06100000
         MVC   PRT+4(26),IEB520I                                   1868 06101000
*   PRT(1:2)=LENGTH(IEB520I)+4;     /* TEXT LENGTH           @Y30OE72*/ 06102000
         MVC   PRT(2),@CH03521                                     1869 06103000
*   PRT(3:4)=MCSFLAGS;              /* MCS FLAGS             @Y30OE72*/ 06104000
         MVC   PRT+2(2),MCSFLAGS                                   1870 06105000
*   PRT(5+LENGTH(IEB520I):8+LENGTH(IEB520I))=DESCROUT;/*     @Y30OE72*/ 06106000
         MVC   PRT+30(4),DESCROUT                                  1871 06107000
*   REG1=ADDR(PRT);                 /* PT TO WTO LIST        @Y30OE72*/ 06108000
         LA    REG1,PRT                                            1872 06109000
*   GEN(WTO MF=(E,(REG1)));         /* ISSUE WTO             @Y30OE72*/ 06110000
         WTO MF=(E,(REG1))                                              06111000
*   FAILSW=ON;                      /* TERMINATE RUN         @Y30OE72*/ 06112000
         MVC   FAILSW(1),ON                                        1874 06113000
*   PRINTERR=SETON;                 /* IND SYSPRINT ERROR    @Y30OE72*/ 06114000
         OI    PRINTERR,B'00001000'                                1875 06115000
*   END SYSPTERR;                   /*                       @Y30OE72*/ 06116000
@EL00025 DS    0H                                                  1876 06117000
@EF00025 DS    0H                                                  1876 06118000
@ER00025 L     @14,@SA00025                                        1876 06119000
         BR    @14                                                 1876 06120000
*                                                                  1877 06121000
*/********************************************************************/ 06122000
*/*                                                          @Y30OE72*/ 06123000
*/* ROUTINE NAME = WRKTABLE                                  @Y30OE72*/ 06124000
*/*                                                          @Y30OE72*/ 06125000
*/* FUNCTION = CALCULATE BINARY CONSTANTS USED TO READ A     @Y30OE72*/ 06126000
*/*            FILE.                                         @Y30OE72*/ 06127000
*/*                                                          @Y30OE72*/ 06128000
*/* INPUT = E - TR0T INDEX FOR ENTRY TO BE PROCESSED         @Y30OE72*/ 06129000
*/*                                                          @Y30OE72*/ 06130000
*/* OUTPUT = BINARY FILE CONSTANTS AS EXPLAINED IN STATEMENT @Y30OE72*/ 06131000
*/*          REMARKS.                                        @Y30OE72*/ 06132000
*/* ROUTINES CALLED = NONE                                   @Y30OE72*/ 06133000
*/*                                                          @Y30OE72*/ 06134000
*/* MACROS = NONE                                            @Y30OE72*/ 06135000
*/*                                                          @Y30OE72*/ 06136000
*/********************************************************************/ 06137000
*                                                                  1877 06138000
*WRKTABLE:                          /*                       @Y30OE72*/ 06139000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE72*/ 06140000
WRKTABLE ST    @14,12(,@13)                                        1877 06141000
*   WORK1=WORK1&&WORK1;             /* INITIALIZE WORKFIELDS @Y30OE72*/ 06142000
         XC    WORK1(4),WORK1                                      1878 06143000
*   WORK2=WORK2&&WORK2;             /*                       @Y30OE72*/ 06144000
         XC    WORK2(4),WORK2                                      1879 06145000
*   WORK3=WORK3&&WORK3;             /*                       @Y30OE72*/ 06146000
         XC    WORK3(4),WORK3                                      1880 06147000
*   BOEABS=BOEABS&&BOEABS;          /*                       @Y30OE72*/ 06148000
         LH    @12,BOEABS                                          1881 06149000
         LR    @11,@12                                             1881 06150000
         XR    @11,@12                                             1881 06151000
         STH   @11,BOEABS                                          1881 06152000
*   EOEABS=EOEABS&&EOEABS;          /*                       @Y30OE72*/ 06153000
         LH    @12,EOEABS                                          1882 06154000
         LR    @11,@12                                             1882 06155000
         XR    @11,@12                                             1882 06156000
         STH   @11,EOEABS                                          1882 06157000
*   EODABS=EODABS&&EODABS;          /*                       @Y30OE72*/ 06158000
         LH    @12,EODABS                                          1883 06159000
         LR    @11,@12                                             1883 06160000
         XR    @11,@12                                             1883 06161000
         STH   @11,EODABS                                          1883 06162000
*   PACK(WORK1,TR0T(E,29:30));      /* CONVERT BOE TRACK     @Y30OE72*/ 06163000
         SLR   @12,@12                                             1884 06164000
         IC    @12,E                                               1884 06165000
         MH    @12,@CH00311                                        1884 06166000
         LA    @11,TR0T-52(@12)                                    1884 06167000
         PACK  WORK1(4),0(2,@11)                                   1884 06168000
*   CVB(WORKB,WORK1);               /* AND TRANSFER IT TO    @Y30OE72*/ 06169000
         XC    @TS00001(8),@TS00001                                1885 06170000
         MVC   @TS00001+4(4),WORK1                                 1885 06171000
         CVB   @11,@TS00001                                        1885 06172000
         ST    @11,WORKB                                           1885 06173000
*   DSBOETRK=WORK2(4);              /* DS TABLE              @Y30OE72*/ 06174000
         MVC   DSBOETRK(1),WORK2+3                                 1886 06175000
*   WORK1=WORK1&&WORK1;             /* INITIALIZE WORKFIELD  @Y30OE72*/ 06176000
         XC    WORK1(4),WORK1                                      1887 06177000
*   PACK(WORK1,TR0T(E,32:33));      /* CONVERT BOE SECTOR    @Y30OE72*/ 06178000
         LA    @15,TR0T-49(@12)                                    1888 06179000
         PACK  WORK1(4),0(2,@15)                                   1888 06180000
*   CVB(WORKC,WORK1);               /* AND TRANSFER IT TO    @Y30OE72*/ 06181000
         XC    @TS00001(8),@TS00001                                1889 06182000
         MVC   @TS00001+4(4),WORK1                                 1889 06183000
         CVB   @00,@TS00001                                        1889 06184000
         ST    @00,WORKC                                           1889 06185000
*   DSBOESEC=WORK3(4);              /* DS TABLE              @Y30OE72*/ 06186000
         MVC   DSBOESEC(1),WORK3+3                                 1890 06187000
*   WORK1=WORK1&&WORK1;             /* INITIALIZE WORKFIELD  @Y30OE72*/ 06188000
         XC    WORK1(4),WORK1                                      1891 06189000
*   WORKA=(WORKB*TWSIX+WORKC);      /* CALC OF ABSOLUTE      @Y30OE72*/ 06190000
         LH    @15,TWSIX                                           1892 06191000
         LR    @03,@11                                             1892 06192000
         MR    @02,@15                                             1892 06193000
         ALR   @03,@00                                             1892 06194000
         ST    @03,WORKA                                           1892 06195000
*   BOEABS=WORKA;                   /* RECORD NBR OF LEL     @Y30OE72*/ 06196000
         STH   @03,BOEABS                                          1893 06197000
*   WORK1=WORK1&&WORK1;             /* INITIALIZE WORKFIELDS @Y30OE72*/ 06198000
         XC    WORK1(4),WORK1                                      1894 06199000
*   WORK2=WORK2&&WORK2;             /*                       @Y30OE72*/ 06200000
         XC    WORK2(4),WORK2                                      1895 06201000
*   WORK3=WORK3&&WORK3;             /*                       @Y30OE72*/ 06202000
         XC    WORK3(4),WORK3                                      1896 06203000
*   PACK(WORK1,TR0T(E,35:36));      /* CONVERT EOE TRACK     @Y30OE72*/ 06204000
         LA    @11,TR0T-46(@12)                                    1897 06205000
         PACK  WORK1(4),0(2,@11)                                   1897 06206000
*   CVB(WORKB,WORK1);               /* AND TRANSFER IT TO    @Y30OE72*/ 06207000
         XC    @TS00001(8),@TS00001                                1898 06208000
         MVC   @TS00001+4(4),WORK1                                 1898 06209000
         CVB   @11,@TS00001                                        1898 06210000
         ST    @11,WORKB                                           1898 06211000
*   DSEOETRK=WORK2(4);              /* DS TABLE              @Y30OE72*/ 06212000
         MVC   DSEOETRK(1),WORK2+3                                 1899 06213000
*   WORK1=WORK1&&WORK1;             /* INITIALIZE WORKFIELD  @Y30OE72*/ 06214000
         XC    WORK1(4),WORK1                                      1900 06215000
*   PACK(WORK1,TR0T(E,38:39));      /* CONVERT EOE SECTOR    @Y30OE72*/ 06216000
         LA    @14,TR0T-43(@12)                                    1901 06217000
         PACK  WORK1(4),0(2,@14)                                   1901 06218000
*   CVB(WORKC,WORK1);               /* AND TRANSFER IT TO    @Y30OE72*/ 06219000
         XC    @TS00001(8),@TS00001                                1902 06220000
         MVC   @TS00001+4(4),WORK1                                 1902 06221000
         CVB   @00,@TS00001                                        1902 06222000
         ST    @00,WORKC                                           1902 06223000
*   DSEOESEC=WORK3(4);              /* DS TABLE              @Y30OE72*/ 06224000
         MVC   DSEOESEC(1),WORK3+3                                 1903 06225000
*   WORK1=WORK1&&WORK1;             /* INITIALIZE WORKFIELD  @Y30OE72*/ 06226000
         XC    WORK1(4),WORK1                                      1904 06227000
*   WORKA=(WORKB*TWSIX+WORKC);      /* CALC OF ABSOLUTE      @Y30OE72*/ 06228000
         LR    @03,@11                                             1905 06229000
         MR    @02,@15                                             1905 06230000
         ALR   @03,@00                                             1905 06231000
         ST    @03,WORKA                                           1905 06232000
*   EOEABS=WORKA;                   /* RECORD NBR OF EOE     @Y30OE72*/ 06233000
         STH   @03,EOEABS                                          1906 06234000
*   WORK1=WORK1&&WORK1;             /* INITIALIZE WORKFIELDS @Y30OE72*/ 06235000
         XC    WORK1(4),WORK1                                      1907 06236000
*   WORK2=WORK2&&WORK2;             /*                       @Y30OE72*/ 06237000
         XC    WORK2(4),WORK2                                      1908 06238000
*   WORK3=WORK3&&WORK3;             /*                       @Y30OE72*/ 06239000
         XC    WORK3(4),WORK3                                      1909 06240000
*   PACK(WORK1,TR0T(E,75:76));      /* CONVERT EOD TRACK     @Y30OE72*/ 06241000
         LA    @11,TR0T-6(@12)                                     1910 06242000
         PACK  WORK1(4),0(2,@11)                                   1910 06243000
*   CVB(WORKB,WORK1);               /* AND TRANSFER IT TO    @Y30OE72*/ 06244000
         XC    @TS00001(8),@TS00001                                1911 06245000
         MVC   @TS00001+4(4),WORK1                                 1911 06246000
         CVB   @11,@TS00001                                        1911 06247000
         ST    @11,WORKB                                           1911 06248000
*   DSEODTRK=WORK2(4);              /* DS TABLE              @Y30OE72*/ 06249000
         MVC   DSEODTRK(1),WORK2+3                                 1912 06250000
*   WORK1=WORK1&&WORK1;             /* INITIALIZE WORKFIELD  @Y30OE72*/ 06251000
         XC    WORK1(4),WORK1                                      1913 06252000
*   PACK(WORK1,TR0T(E,78:79));      /* CONVERT EOD SECTOR    @Y30OE72*/ 06253000
         LA    @14,TR0T-3(@12)                                     1914 06254000
         PACK  WORK1(4),0(2,@14)                                   1914 06255000
*   CVB(WORKC,WORK1);               /* AND TRANSFER IT TO    @Y30OE72*/ 06256000
         XC    @TS00001(8),@TS00001                                1915 06257000
         MVC   @TS00001+4(4),WORK1                                 1915 06258000
         CVB   @12,@TS00001                                        1915 06259000
         ST    @12,WORKC                                           1915 06260000
*   DSEODSEC=WORK3(4);              /* DS TABLE              @Y30OE72*/ 06261000
         MVC   DSEODSEC(1),WORK3+3                                 1916 06262000
*   WORK1=WORK1&&WORK1;             /* INITIALIZE WORKFIELD  @Y30OE72*/ 06263000
         XC    WORK1(4),WORK1                                      1917 06264000
*   WORKA=(WORKB*TWSIX+WORKC);      /* CALC OF ABSOLUTE      @Y30OE72*/ 06265000
         LR    @03,@11                                             1918 06266000
         MR    @02,@15                                             1918 06267000
         ALR   @03,@12                                             1918 06268000
         ST    @03,WORKA                                           1918 06269000
*   EODABS=WORKA;                   /* RECORD NBR OF EOD     @Y30OE72*/ 06270000
         STH   @03,EODABS                                          1919 06271000
*   TN=EODABS-BOEABS;               /* TN=TOTAL NBR RECORDS  @Y30OE72*/ 06272000
         SH    @03,BOEABS                                          1920 06273000
         STH   @03,TN                                              1920 06274000
*   SC=DSBOETT;                     /* FIRST TRACK NUMBER    @Y30OE72*/ 06275000
         MVC   SC(2),DSBOETT                                       1921 06276000
*   SR=DSBOESS;                     /* FIRST SECTOR NUMBER   @Y30OE72*/ 06277000
         MVC   SR(2),DSBOESS                                       1922 06278000
*   ER=DSEODSS;                     /* LAST SECTOR NUMBER    @Y30OE72*/ 06279000
         SLR   @12,@12                                             1923 06280000
         ICM   @12,3,DSEODSS                                       1923 06281000
         STH   @12,ER                                              1923 06282000
*   ER=ER-1;                        /* READ = EOD-1          @Y30OE72*/ 06283000
         BCTR  @12,0                                               1924 06284000
         STH   @12,ER                                              1924 06285000
*   EC=DSEODTT;                     /* LAST TRACK NUMBER     @Y30OE72*/ 06286000
         SLR   @11,@11                                             1925 06287000
         ICM   @11,3,DSEODTT                                       1925 06288000
         STH   @11,EC                                              1925 06289000
*   IF ER=0 THEN                    /* END ON TRK BDY?       @Y30OE72*/ 06290000
         LTR   @12,@12                                             1926 06291000
         BNZ   @RF01926                                            1926 06292000
*     DO;                           /* YES. THEN             @Y30OE72*/ 06293000
*       ER=SECTOR26;                /* LASTREC = LAST        @Y30OE72*/ 06294000
         MVC   ER(2),@CH02141                                      1928 06295000
*       EC=EC-1;                    /* SECTOR ON             @Y30OE72*/ 06296000
         BCTR  @11,0                                               1929 06297000
         STH   @11,EC                                              1929 06298000
*     END;                          /* PREVIOUS TRACK        @Y30OE72*/ 06299000
*   LRT=0;                          /* LOST RECORD TOTAL     @Y30OE72*/ 06300000
@RF01926 SLR   @12,@12                                             1931 06301000
         STH   @12,LRT                                             1931 06302000
*   END WRKTABLE;                   /*                       @Y30OE72*/ 06303000
@EL00026 DS    0H                                                  1932 06304000
@EF00026 DS    0H                                                  1932 06305000
@ER00026 L     @14,12(,@13)                                        1932 06306000
         BR    @14                                                 1932 06307000
*                                                                  1933 06308000
*/********************************************************************/ 06309000
*/*                                                          @Y30OE72*/ 06310000
*/* ROUTINE NAME = WRITEIO                                   @Y30OE72*/ 06311000
*/*                                                          @Y30OE72*/ 06312000
*/* FUNCTION = ISSUE I/O TO WRITE DATA ON DISKETTE (DATA IS  @Y30OE72*/ 06313000
*/*            WRITTEN A TRACK AT A TIME).                   @Y30OE72*/ 06314000
*/*                                                          @Y30OE72*/ 06315000
*/* INPUT = OT1IOB,OT2IOB AND THEIR ASSOCIATED ECBS,CCWS,    @Y30OE72*/ 06316000
*/*         AND BUFFERS.                                     @Y30OE72*/ 06317000
*/*         MODE - SWITCH INDICATING WHETHER OR NOT DATA SET @Y30OE72*/ 06318000
*/*                IS COMPLETED (I.E. FLUSH BUFFERS).        @Y30OE72*/ 06319000
*/*                                                          @Y30OE72*/ 06320000
*/* OUTPUT = DATA WRITTEN TO OUTPUT DISKETTE                 @Y30OE72*/ 06321000
*/*                                                          @Y30OE72*/ 06322000
*/* ROUTINES CALLED = NONE                                   @Y30OE72*/ 06323000
*/*                                                          @Y30OE72*/ 06324000
*/* MACROS = EXCP,WAIT                                       @Y30OE72*/ 06325000
*/*                                                          @Y30OE72*/ 06326000
*/********************************************************************/ 06327000
*                                                                  1933 06328000
*WRITEIO:                           /* SEE GENERAL COMMENTS  @Y30OE72*/ 06329000
*   PROC OPTIONS(SAVE(14));         /* ON PREVIOUS PAGE      @Y30OE72*/ 06330000
WRITEIO  ST    @14,@SA00027                                        1933 06331000
*   OTIOBECB=ZEROREC(1:4);          /* CLEAR ECB             @Y30OE72*/ 06332000
*                                                                  1934 06333000
         L     @12,OTIOBPTR                                        1934 06334000
         AL    @12,@CF03567                                        1934 06335000
         MVC   OTIOBECB-4(4,@12),ZEROREC                           1934 06336000
*   /*****************************************************************/ 06337000
*   /*                                                               */ 06338000
*   /* SET UP CCW CHAIN TO WRITE SHORT TRACKS, IF NECASSARY  @Y30OE72*/ 06339000
*   /*                                                               */ 06340000
*   /*****************************************************************/ 06341000
*                                                                  1935 06342000
*   IF STARTREC^=SECTOR1 THEN       /* NON-TRK BDY START?    @Y30OE72*/ 06343000
         CLC   STARTREC(1),SECTOR1                                 1935 06344000
         BE    @RF01935                                            1935 06345000
*     DO;                           /* YES.                  @Y30OE72*/ 06346000
*       TICADDR=ADDR(OT1WTCCW)+     /* SET TIC ADDR TO       @Y30OE72*/ 06347000
*           ((STARTREC-1)*CCWLEN);  /* PROPER WRITE CCW      @Y30OE72*/ 06348000
         LA    @12,OT1WTCCW                                        1937 06349000
         SLR   @11,@11                                             1937 06350000
         IC    @11,STARTREC                                        1937 06351000
         BCTR  @11,0                                               1937 06352000
         SLA   @11,3                                               1937 06353000
         ALR   @12,@11                                             1937 06354000
         STCM  @12,7,TICADDR                                       1937 06355000
*       OT1WTCCW=OT1WTCCW&&TICCCW;  /* REPLACE FIRST         @Y30OE72*/ 06356000
         XC    OT1WTCCW(8),TICCCW                                  1938 06357000
*       TICCCW=TICCCW&&OT1WTCCW;    /* WRITE CCW             @Y30OE72*/ 06358000
         XC    TICCCW(8),OT1WTCCW                                  1939 06359000
*       OT1WTCCW=OT1WTCCW&&TICCCW;  /* WITH TIC CCW          @Y30OE72*/ 06360000
         XC    OT1WTCCW(8),TICCCW                                  1940 06361000
*       STARTREC=SECTOR1;           /* RESET START ADDR      @Y30OE72*/ 06362000
         MVC   STARTREC(1),SECTOR1                                 1941 06363000
*     END;                          /*                       @Y30OE72*/ 06364000
*   IF CCWPTR^=ADDR(OTNOOP) THEN    /* FULL BUFFER?          @Y30OE72*/ 06365000
@RF01935 L     @12,CCWPTR                                          1943 06366000
         L     @11,OTIOBPTR                                        1943 06367000
         LA    @02,OTNOOP(,@11)                                    1943 06368000
         CR    @12,@02                                             1943 06369000
         BE    @RF01943                                            1943 06370000
*     DO;                           /* NO.                   @Y30OE72*/ 06371000
*       CURCCW=CURCCW&&OTNOOP;      /* PLACE LAST NOOP       @Y30OE72*/ 06372000
         XC    CURCCW(8,@12),OTNOOP(@11)                           1945 06373000
*       OTNOOP=OTNOOP&&CURCCW;      /* AT CURRENT            @Y30OE72*/ 06374000
         XC    OTNOOP(8,@11),CURCCW(@12)                           1946 06375000
*       CURCCW=CURCCW&&OTNOOP;      /* END OF CHAIN          @Y30OE72*/ 06376000
         XC    CURCCW(8,@12),OTNOOP(@11)                           1947 06377000
*       NOOP@=CCWPTR;               /* SAVE PTR TO NOOP CCW  @Y30OE72*/ 06378000
         ST    @12,NOOP@                                           1948 06379000
*     END;                          /*                       @Y30OE72*/ 06380000
*                                                                  1949 06381000
*   /*****************************************************************/ 06382000
*   /*                                                               */ 06383000
*   /* ISSUE EXCP, WAIT , AND CHECK FOR ERRORS               @Y30OE72*/ 06384000
*   /*                                                               */ 06385000
*   /*****************************************************************/ 06386000
*                                                                  1950 06387000
*   REG1=OTIOBPTR;                  /* SET UP FOR I/O        @Y30OE72*/ 06388000
@RF01943 L     REG1,OTIOBPTR                                       1950 06389000
*   GEN(EXCP (REG1));               /* ISSUE EXCP            @Y30OE72*/ 06390000
         EXCP (REG1)                                                    06391000
*   IF MODE=FLIP THEN               /* SWITCH MODE?          @Y30OE72*/ 06392000
         CLI   MODE,C'F'                                           1952 06393000
         BNE   @RF01952                                            1952 06394000
*     DO;                           /* YES.                  @Y30OE72*/ 06395000
*       OTIOBPTR=OTIOBNXT;          /* PT TO OTHER IOB       @Y30OE72*/ 06396000
         L     @12,OTIOBPTR                                        1954 06397000
         L     @12,OTIOBNXT(,@12)                                  1954 06398000
         ST    @12,OTIOBPTR                                        1954 06399000
*       OUTSKTT=OUTSKTT+2;          /* UPDATE TRK NUM        @Y30OE72*/ 06400000
         LA    @11,2                                               1955 06401000
         SLR   @02,@02                                             1955 06402000
         IC    @02,OUTSKTT(,@12)                                   1955 06403000
         ALR   @11,@02                                             1955 06404000
         STC   @11,OUTSKTT(,@12)                                   1955 06405000
*       CCWPTR=ADDR(OUTWTCCW);      /* PT TO 1ST WRITE CCW   @Y30OE72*/ 06406000
         LA    @12,OUTWTCCW(,@12)                                  1956 06407000
         ST    @12,CCWPTR                                          1956 06408000
*     END;                          /*                       @Y30OE72*/ 06409000
*   IF OUTECBC^=SETON THEN          /* ECB COMPLETE?         @Y30OE72*/ 06410000
@RF01952 L     @12,OTIOBPTR                                        1958 06411000
         SH    @12,@CH00034                                        1958 06412000
         TM    OUTECBC(@12),B'01000000'                            1958 06413000
         BO    @RF01958                                            1958 06414000
*     DO;                           /* NO.                   @Y30OE72*/ 06415000
*       REG1=ADDR(OTIOBECB);        /* SET UP FOR WAIT       @Y30OE72*/ 06416000
         LA    REG1,OTIOBECB(,@12)                                 1960 06417000
*       GEN(WAIT ECB=(REG1));       /* ISSUE WAIT            @Y30OE72*/ 06418000
         WAIT ECB=(REG1)                                                06419000
*     END;                          /*                       @Y30OE72*/ 06420000
*   IF OUTECBCC^=GOODIO THEN        /* I/O ERROR?            @Y30OE72*/ 06421000
@RF01958 L     @12,OTIOBPTR                                        1963 06422000
         AL    @12,@CF03567                                        1963 06423000
         CLI   OUTECBCC-4(@12),X'7F'                               1963 06424000
         BE    @RF01963                                            1963 06425000
*     SW504I=ERRON;                 /* YES. SET IND FOR CALR @Y30OE72*/ 06426000
*                                                                  1964 06427000
         OI    SW504I,B'00001000'                                  1964 06428000
*   /*****************************************************************/ 06429000
*   /*                                                               */ 06430000
*   /* RESTORE CCW CHAIN TO WRITE FULL TRACKS, IF SHORT      @Y30OE72*/ 06431000
*   /* TRACK WAS WRITTEN                                     @Y30OE72*/ 06432000
*   /*                                                               */ 06433000
*   /*****************************************************************/ 06434000
*                                                                  1965 06435000
*   IF CURCCWOP=TIC THEN            /* 1ST CCW A TIC?        @Y30OE72*/ 06436000
@RF01963 L     @12,CCWPTR                                          1965 06437000
         CLI   CURCCWOP(@12),8                                     1965 06438000
         BNE   @RF01965                                            1965 06439000
*     DO;                           /* YES.                  @Y30OE72*/ 06440000
*       OUTSKSS=SECTOR1;            /* RESET SECTOR NUM      @Y30OE72*/ 06441000
         L     @12,OTIOBPTR                                        1967 06442000
         MVC   OUTSKSS(1,@12),SECTOR1                              1967 06443000
*       TICCCW=TICCCW&&OUTWTCCW;    /* RESTORE               @Y30OE72*/ 06444000
         XC    TICCCW(8),OUTWTCCW(@12)                             1968 06445000
*       OUTWTCCW=OUTWTCCW&&TICCCW;  /* FIRST                 @Y30OE72*/ 06446000
         XC    OUTWTCCW(8,@12),TICCCW                              1969 06447000
*       TICCCW=TICCCW&&OUTWTCCW;    /* WRITE CCW             @Y30OE72*/ 06448000
         XC    TICCCW(8),OUTWTCCW(@12)                             1970 06449000
*     END;                          /*                       @Y30OE72*/ 06450000
*   IF OTNOOPOP=WRITE THEN          /* 27TH CCW A WRITE?     @Y30OE72*/ 06451000
@RF01965 L     @12,OTIOBPTR                                        1972 06452000
         CLI   OTNOOPOP(@12),5                                     1972 06453000
         BNE   @RF01972                                            1972 06454000
*     DO;                           /* YES.                  @Y30OE72*/ 06455000
*       OTNOOP=OTNOOP&&NOOPCCW;     /* RESTORE NOOP CCW      @Y30OE72*/ 06456000
         L     @11,NOOP@                                           1974 06457000
         XC    OTNOOP(8,@12),NOOPCCW(@11)                          1974 06458000
*       NOOPCCW=NOOPCCW&&OTNOOP;    /* TO END                @Y30OE72*/ 06459000
         XC    NOOPCCW(8,@11),OTNOOP(@12)                          1975 06460000
*       OTNOOP=OTNOOP&&NOOPCCW;     /* OF CHAIN              @Y30OE72*/ 06461000
         XC    OTNOOP(8,@12),NOOPCCW(@11)                          1976 06462000
*     END;                          /*                       @Y30OE72*/ 06463000
*   DFOPSCNT=0;                     /* RESET DEFINE OPS CNT  @Y30OE72*/ 06464000
@RF01972 L     @12,OTIOBPTR                                        1978 06465000
         MVI   DFOPSCNT(@12),X'00'                                 1978 06466000
*   END WRITEIO;                    /*                       @Y30OE72*/ 06467000
@EL00027 DS    0H                                                  1979 06468000
@EF00027 DS    0H                                                  1979 06469000
@ER00027 L     @14,@SA00027                                        1979 06470000
         BR    @14                                                 1979 06471000
*                                                                  1980 06472000
*/********************************************************************/ 06473000
*/*                                                          @Y30OE72*/ 06474000
*/* ROUTINE NAME = CLOSEFIL                                  @Y30OE72*/ 06475000
*/*                                                          @Y30OE72*/ 06476000
*/* FUNCTION = CLOSE OPEN FILES                              @Y30OE72*/ 06477000
*/*            ZERO 3540 UCB VOLSERS                         @Y30OE72*/ 06478000
*/*            DELETE IGG019VW                               @Y30OE72*/ 06479000
*/*                                                          @Y30OE72*/ 06480000
*/* INPUT = CLOSLIST - AREA TO BUILD CLOSE LIST FOR CLOSE    @Y30OE72*/ 06481000
*/*                    MACRO                                 @Y30OE72*/ 06482000
*/*         DCBS FOR SYSPRINT,SYSIN,SYSUT1,SYSUT2QS,SYSUT2IN @Y30OE72*/ 06483000
*/*                  SYSUT2EX                                @Y30OE72*/ 06484000
*/*         WORKSYS1,WORKSYS2 - PTRS TO SYSUT1,SYSUT2 TIOT   @Y30OE72*/ 06485000
*/*                             ENTRIES                      @Y30OE72*/ 06486000
*/*                                                          @Y30OE72*/ 06487000
*/* OUTPUT = ALL FILES CLOSED                                @Y30OE72*/ 06488000
*/*          3540 UCB VOLSERS ZEROED                         @Y30OE72*/ 06489000
*/*          IGG019VW DELETED IF IT WAS LOADED               @Y30OE72*/ 06490000
*/*                                                          @Y30OE72*/ 06491000
*/* ROUTINES CALLED = UCBDEBUP - TO ZERO 3540 UCB VOLSERS    @Y30OE72*/ 06492000
*/*                                                          @Y30OE72*/ 06493000
*/* MACROS = CLOSE,DELETE                                    @Y30OE72*/ 06494000
*/*                                                          @Y30OE72*/ 06495000
*/********************************************************************/ 06496000
*                                                                  1980 06497000
*CLOSEFIL:                          /* SEE GENERAL COMMENTS  @Y30OE72*/ 06498000
*   PROC OPTIONS(SAVE(14));         /* ON PREVIOUS PAGE      @Y30OE72*/ 06499000
CLOSEFIL ST    @14,@SA00028                                        1980 06500000
*   IF WORKU1SW=ON THEN             /* SYSUT1 DD PROVIDED?   @Y30OE72*/ 06501000
         CLC   WORKU1SW(1),ON                                      1981 06502000
         BNE   @RF01981                                            1981 06503000
*     DO;                           /* YES.                  @Y30OE72*/ 06504000
*       TIOTADDR=WORKSYS1;          /* PT TO SYSUT1 TIOT ENT @Y30OE72*/ 06505000
         SLR   @12,@12                                             1983 06506000
         ICM   @12,7,WORKSYS1                                      1983 06507000
         ST    @12,TIOTADDR                                        1983 06508000
*       IF UCBTYP(3:4)=TYPE3540 THEN/* IS IT A 3540          @Y30OE72*/ 06509000
         ICM   @11,7,TIOEFSRT(@12)                                 1984 06510000
         SLR   @12,@12                                             1984 06511000
         ICM   @12,3,UCBTYP+2(@11)                                 1984 06512000
         CH    @12,TYPE3540                                        1984 06513000
         BNE   @RF01984                                            1984 06514000
*         DO;                       /* YES.                  @Y30OE72*/ 06515000
*           MODESWIT=UCBZERO;       /* ZERO UCBVOLID SW      @Y30OE72*/ 06516000
         MVI   MODESWIT,X'01'                                      1986 06517000
*           CALL UCBDEBUP;          /* GO ZERO UCBVOLID      @Y30OE72*/ 06518000
         BAL   @14,UCBDEBUP                                        1987 06519000
*         END;                      /*                       @Y30OE72*/ 06520000
*     END;                          /*                       @Y30OE72*/ 06521000
@RF01984 DS    0H                                                  1990 06522000
*   IF WORKU2SW=ON THEN             /* SYSUT2 DD PROVIDED?   @Y30OE72*/ 06523000
@RF01981 CLC   WORKU2SW(1),ON                                      1990 06524000
         BNE   @RF01990                                            1990 06525000
*     DO;                           /* YES.                  @Y30OE72*/ 06526000
*       TIOTADDR=WORKSYS2;          /* PT TO SYSUT2 TIOT ENT @Y30OE72*/ 06527000
         SLR   @12,@12                                             1992 06528000
         ICM   @12,7,WORKSYS2                                      1992 06529000
         ST    @12,TIOTADDR                                        1992 06530000
*       IF UCBTYP(3:4)=TYPE3540 THEN/* IS IT A 3540          @Y30OE72*/ 06531000
         ICM   @11,7,TIOEFSRT(@12)                                 1993 06532000
         SLR   @12,@12                                             1993 06533000
         ICM   @12,3,UCBTYP+2(@11)                                 1993 06534000
         CH    @12,TYPE3540                                        1993 06535000
         BNE   @RF01993                                            1993 06536000
*         DO;                       /* YES.                  @Y30OE72*/ 06537000
*           MODESWIT=UCBZERO;       /* ZERO UCBVOLID SW      @Y30OE72*/ 06538000
         MVI   MODESWIT,X'01'                                      1995 06539000
*           CALL UCBDEBUP;          /* GO ZERO UCBVOLID      @Y30OE72*/ 06540000
         BAL   @14,UCBDEBUP                                        1996 06541000
*         END;                      /*                       @Y30OE72*/ 06542000
*     END;                          /*                       @Y30OE72*/ 06543000
@RF01993 DS    0H                                                  1999 06544000
*   CLOSLIST=ZEROREC(1:24);         /* ZERO LIST             @Y30OE72*/ 06545000
@RF01990 MVC   CLOSLIST(24),ZEROREC                                1999 06546000
*   REG1=ADDR(SYSPRINT);            /* PT TO SYSPRINT DCB    @Y30OE72*/ 06547000
         LA    @12,SYSPRINT                                        2000 06548000
         LR    REG1,@12                                            2000 06549000
*   IF DCBOFOPN=SETON THEN          /* SYSPRINT OPEN?        @Y30OE72*/ 06550000
         TM    DCBOFOPN+40(REG1),B'00010000'                       2001 06551000
         BNO   @RF02001                                            2001 06552000
*     DO;                           /* YES.                  @Y30OE72*/ 06553000
*       LISTDCB@=ADDR(SYSPRINT);    /* DCB PTR INTO LIST     @Y30OE72*/ 06554000
         L     @11,LISTPTR                                         2003 06555000
         STCM  @12,7,LISTDCB@(@11)                                 2003 06556000
*       LISTPTR=LISTPTR+4;          /* PT TO NEXT LIST ENTRY @Y30OE72*/ 06557000
         AL    @11,@CF00037                                        2004 06558000
         ST    @11,LISTPTR                                         2004 06559000
*     END;                          /*                       @Y30OE72*/ 06560000
*   REG1=ADDR(SYSIN);               /* PT TO SYSIN DCB       @Y30OE72*/ 06561000
@RF02001 LA    @12,SYSIN                                           2006 06562000
         LR    REG1,@12                                            2006 06563000
*   IF DCBOFOPN=SETON THEN          /* SYSIN OPEN?           @Y30OE72*/ 06564000
         TM    DCBOFOPN+40(REG1),B'00010000'                       2007 06565000
         BNO   @RF02007                                            2007 06566000
*     DO;                           /* YES.                  @Y30OE72*/ 06567000
*       LISTDCB@=ADDR(SYSIN);       /* DCB PTR INTO LIST     @Y30OE72*/ 06568000
         L     @11,LISTPTR                                         2009 06569000
         STCM  @12,7,LISTDCB@(@11)                                 2009 06570000
*       LISTPTR=LISTPTR+4;          /* PT TO NEXT LIST ENTRY @Y30OE72*/ 06571000
         AL    @11,@CF00037                                        2010 06572000
         ST    @11,LISTPTR                                         2010 06573000
*     END;                          /*                       @Y30OE72*/ 06574000
*   REG1=ADDR(SYSUT2QS);            /* PT TO SYSUT2QS DCB    @Y30OE72*/ 06575000
@RF02007 LA    @12,SYSUT2QS                                        2012 06576000
         LR    REG1,@12                                            2012 06577000
*   IF DCBOFOPN=SETON THEN          /* SYSUT2QS OPEN?        @Y30OE72*/ 06578000
         TM    DCBOFOPN+40(REG1),B'00010000'                       2013 06579000
         BNO   @RF02013                                            2013 06580000
*     DO;                           /* YES.                  @Y30OE72*/ 06581000
*       LISTDCB@=ADDR(SYSUT2QS);    /* DCB PTR INTO LIST     @Y30OE72*/ 06582000
         L     @11,LISTPTR                                         2015 06583000
         STCM  @12,7,LISTDCB@(@11)                                 2015 06584000
*       LISTPTR=LISTPTR+4;          /* PT TO NEXT LIST ENTRY @Y30OE72*/ 06585000
         AL    @11,@CF00037                                        2016 06586000
         ST    @11,LISTPTR                                         2016 06587000
*     END;                          /*                       @Y30OE72*/ 06588000
*   REG1=ADDR(SYSUT1);              /* PT TO SYSUT1 DCB      @Y30OE72*/ 06589000
@RF02013 LA    @12,SYSUT1                                          2018 06590000
         LR    REG1,@12                                            2018 06591000
*   IF DCBOFOPN=SETON THEN          /* SYSUT1 OPEN?          @Y30OE72*/ 06592000
         TM    DCBOFOPN+40(REG1),B'00010000'                       2019 06593000
         BNO   @RF02019                                            2019 06594000
*     DO;                           /* YES.                  @Y30OE72*/ 06595000
*       LISTDCB@=ADDR(SYSUT1);      /* DCB PTR INTO LIST     @Y30OE72*/ 06596000
         L     @11,LISTPTR                                         2021 06597000
         STCM  @12,7,LISTDCB@(@11)                                 2021 06598000
*       LISTPTR=LISTPTR+4;          /* PT TO NEXT LIST ENTRY @Y30OE72*/ 06599000
         AL    @11,@CF00037                                        2022 06600000
         ST    @11,LISTPTR                                         2022 06601000
*       GEN(DELETE EP=IGG019VW);    /* DELETE ASSYNCH RTN    @Y30OE72*/ 06602000
         DELETE EP=IGG019VW                                             06603000
*     END;                          /*                       @Y30OE72*/ 06604000
*   REG1=ADDR(SYSUT2IN);            /* PT TO SYSUT2IN DCB    @Y30OE72*/ 06605000
@RF02019 LA    @12,SYSUT2IN                                        2025 06606000
         LR    REG1,@12                                            2025 06607000
*   IF DCBOFOPN=SETON THEN          /* SYSUT2IN OPEN?        @Y30OE72*/ 06608000
         TM    DCBOFOPN+40(REG1),B'00010000'                       2026 06609000
         BNO   @RF02026                                            2026 06610000
*     DO;                           /* YES.                  @Y30OE72*/ 06611000
*       LISTDCB@=ADDR(SYSUT2IN);    /* DCB PTR INTO LIST     @Y30OE72*/ 06612000
         L     @11,LISTPTR                                         2028 06613000
         STCM  @12,7,LISTDCB@(@11)                                 2028 06614000
*       LISTPTR=LISTPTR+4;          /* PT TO NEXT LIST ENTRY @Y30OE72*/ 06615000
         AL    @11,@CF00037                                        2029 06616000
         ST    @11,LISTPTR                                         2029 06617000
*     END;                          /*                       @Y30OE72*/ 06618000
*   REG1=ADDR(SYSUT2EX);            /* PT TO SYSUT2EX DCB    @Y30OE72*/ 06619000
@RF02026 LA    @12,SYSUT2EX                                        2031 06620000
         LR    REG1,@12                                            2031 06621000
*   IF DCBOFOPN=SETON THEN          /* SYSUT2EX OPEN?        @Y30OE72*/ 06622000
         TM    DCBOFOPN+40(REG1),B'00010000'                       2032 06623000
         BNO   @RF02032                                            2032 06624000
*     DO;                           /* YES.                  @Y30OE72*/ 06625000
*       LISTDCB@=ADDR(SYSUT2EX);    /* DCB PTR INTO LIST     @Y30OE72*/ 06626000
         L     @11,LISTPTR                                         2034 06627000
         STCM  @12,7,LISTDCB@(@11)                                 2034 06628000
*       LISTPTR=LISTPTR+4;          /* PT TO NEXT LIST ENTRY @Y30OE72*/ 06629000
         AL    @11,@CF00037                                        2035 06630000
         ST    @11,LISTPTR                                         2035 06631000
*       GEN(DELETE EP=IGG019VW);    /* DELETE ASSYNCH RTN    @Y30OE72*/ 06632000
         DELETE EP=IGG019VW                                             06633000
*     END;                          /*                       @Y30OE72*/ 06634000
*   IF LISTPTR^=ADDR(CLOSLIST) THEN /* ANY FILES TO CLOSE?   @Y30OE72*/ 06635000
@RF02032 L     @12,LISTPTR                                         2038 06636000
         LA    @11,CLOSLIST                                        2038 06637000
         CR    @12,@11                                             2038 06638000
         BE    @RF02038                                            2038 06639000
*     DO;                           /* YES.                  @Y30OE72*/ 06640000
*       LISTPTR=LISTPTR-4;          /* PT TO LAST ENTRY      @Y30OE72*/ 06641000
         SL    @12,@CF00037                                        2040 06642000
         ST    @12,LISTPTR                                         2040 06643000
*       LISTEND=SETON;              /* SET END OF LIST IND   @Y30OE72*/ 06644000
         OI    LISTEND(@12),B'10000000'                            2041 06645000
*       REG1=ADDR(CLOSLIST);        /* PT TO LIST            @Y30OE72*/ 06646000
         LR    REG1,@11                                            2042 06647000
*       GEN(CLOSE MF=(E,(REG1)));   /* CLOSE FILES           @Y30OE72*/ 06648000
         CLOSE MF=(E,(REG1))                                            06649000
*     END;                          /*                       @Y30OE72*/ 06650000
*   END CLOSEFIL;                   /*                       @Y30OE72*/ 06651000
@EL00028 DS    0H                                                  2045 06652000
@EF00028 DS    0H                                                  2045 06653000
@ER00028 L     @14,@SA00028                                        2045 06654000
         BR    @14                                                 2045 06655000
*   END IEBDISKT                    /* PROGRAM END           @Y30OE72*/ 06656000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 06657000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                        * 06658000
*/*%INCLUDE SYSLIB  (IHADCB  )                                        * 06659000
*/*%INCLUDE SYSLIB  (IEFTIOT1)                                        * 06660000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                        * 06661000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 06662000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                        * 06663000
*/*%INCLUDE SYSLIB  (IEZDEB  )                                        * 06664000
*;                                                                 2046 06665000
@DATA    DS    0H                                                       06666000
@CH00070 DC    H'2'                                                     06667000
@CH00108 DC    H'3'                                                     06668000
@CH00038 DC    H'5'                                                     06669000
@CH00032 DC    H'6'                                                     06670000
@CH00033 DC    H'7'                                                     06671000
@CH00034 DC    H'8'                                                     06672000
@CH02083 DC    H'13'                                                    06673000
@CH00058 DC    H'15'                                                    06674000
@CH02061 DC    H'19'                                                    06675000
@CH02322 DC    H'22'                                                    06676000
@CH02141 DC    H'26'                                                    06677000
@CH03521 DC    H'30'                                                    06678000
@CH02356 DC    H'47'                                                    06679000
@CH03382 DC    H'51'                                                    06680000
@CH00042 DC    H'52'                                                    06681000
@CH03449 DC    H'160'                                                   06682000
@CH03434 DC    H'240'                                                   06683000
@SM03550 MVC   0(0,@15),0(@02)                                          06684000
@SM03552 MVC   0(0,@14),0(@12)                                          06685000
@SC03562 CLC   0(0,@15),BLANK                                           06686000
@SM03568 MVC   PRT(0),MSGTEXT(REG1)                                     06687000
         DS    0F                                                       06688000
@SA00001 DS    18F                                                      06689000
@SA00006 DS    1F                                                       06690000
@SA00007 DS    1F                                                       06691000
@SA00008 DS    1F                                                       06692000
@SA00024 DS    1F                                                       06693000
@SA00005 DS    1F                                                       06694000
@SA00015 DS    1F                                                       06695000
@SA00019 DS    1F                                                       06696000
@SA00022 DS    1F                                                       06697000
@SA00028 DS    1F                                                       06698000
@SA00012 DS    1F                                                       06699000
@SA00017 DS    1F                                                       06700000
@SA00011 DS    1F                                                       06701000
@SA00009 DS    1F                                                       06702000
@SA00013 DS    1F                                                       06703000
@SA00014 DS    1F                                                       06704000
@SA00021 DS    1F                                                       06705000
@SA00016 DS    1F                                                       06706000
@SA00018 DS    1F                                                       06707000
@SA00027 DS    1F                                                       06708000
@SA00020 DS    1F                                                       06709000
@SA00025 DS    1F                                                       06710000
         DS    0F                                                       06711000
@CF00052 DC    F'1'                                                     06712000
@CH00052 EQU   @CF00052+2                                               06713000
@CF00037 DC    F'4'                                                     06714000
@CF02184 DC    F'12'                                                    06715000
@CF00311 DC    F'80'                                                    06716000
@CH00311 EQU   @CF00311+2                                               06717000
@CF03564 DC    F'-8'                                                    06718000
@CF03567 DC    F'-4'                                                    06719000
@CV02205 DC    V(IOEESTAE)                                              06720000
         DS    0D                                                       06721000
TIOTADDR DS    A                                                        06722000
P        DS    A                                                        06723000
DCBADDR  DS    A                                                        06724000
I        DS    A                                                        06725000
J        DS    A                                                        06726000
DSBOE    DC    F'0'                                                     06727000
         ORG   DSBOE                                                    06728000
DSBOETT  DS    CL2                                                      06729000
         ORG   DSBOETT                                                  06730000
@NM00068 DS    AL1                                                      06731000
DSBOETRK DS    AL1                                                      06732000
         ORG   DSBOE+2                                                  06733000
DSBOESS  DS    CL2                                                      06734000
         ORG   DSBOESS                                                  06735000
@NM00069 DS    AL1                                                      06736000
DSBOESEC DS    AL1                                                      06737000
         ORG   DSBOE+4                                                  06738000
DSEOE    DC    F'0'                                                     06739000
         ORG   DSEOE                                                    06740000
DSEOETT  DS    CL2                                                      06741000
         ORG   DSEOETT                                                  06742000
@NM00070 DS    AL1                                                      06743000
DSEOETRK DS    AL1                                                      06744000
         ORG   DSEOE+2                                                  06745000
DSEOESS  DS    CL2                                                      06746000
         ORG   DSEOESS                                                  06747000
@NM00071 DS    AL1                                                      06748000
DSEOESEC DS    AL1                                                      06749000
         ORG   DSEOE+4                                                  06750000
DSEOD    DC    F'0'                                                     06751000
         ORG   DSEOD                                                    06752000
DSEODTT  DS    CL2                                                      06753000
         ORG   DSEODTT                                                  06754000
@NM00072 DS    AL1                                                      06755000
DSEODTRK DS    AL1                                                      06756000
         ORG   DSEOD+2                                                  06757000
DSEODSS  DS    CL2                                                      06758000
         ORG   DSEODSS                                                  06759000
@NM00073 DS    AL1                                                      06760000
DSEODSEC DS    AL1                                                      06761000
         ORG   DSEOD+4                                                  06762000
REG1SAVE DS    A                                                        06763000
TABPTR   DS    A                                                        06764000
LISTPTR  DC    AL4(CLOSLIST)                                            06765000
CCWPTR   DS    A                                                        06766000
NOOP@    DS    A                                                        06767000
IOBPTR   DS    A                                                        06768000
OTIOBPTR DS    A                                                        06769000
UCBDCPTR DS    A                                                        06770000
TWSIX    DC    XL2'1A'                                                  06771000
TYPE3540 DC    XL2'0844'                                                06772000
LEAPDAYS DC    H'366'                                                   06773000
REGDAYS  DC    H'365'                                                   06774000
TRKSIZE  DC    H'3328'                                                  06775000
BOEABS   DS    H                                                        06776000
EOEABS   DS    H                                                        06777000
EODABS   DS    H                                                        06778000
TN       DS    H                                                        06779000
LRT      DS    H                                                        06780000
ERRCOUNT DC    XL2'00'                                                  06781000
TABCNT   DC    XL2'00'                                                  06782000
HDRCNT   DC    XL2'00'                                                  06783000
MSGCNT   DC    XL2'00'                                                  06784000
NUMDAY   DS    H                                                        06785000
HEX00    DC    XL1'00'                                                  06786000
HEX01    DC    XL1'01'                                                  06787000
HEX02    DC    XL1'02'                                                  06788000
AST2     DC    XL1'5C'                                                  06789000
RLCNT    DS    FL1                                                      06790000
DSNR     DS    FL1                                                      06791000
F        DS    FL1                                                      06792000
R        DS    FL1                                                      06793000
E        DS    FL1                                                      06794000
T        DS    FL1                                                      06795000
A        DS    FL1                                                      06796000
N        DS    FL1                                                      06797000
D        DS    FL1                                                      06798000
         DS    CL2                                                      06799000
VWIRB    DS    AL3                                                      06800000
DSIDLEN  DS    FL1                                                      06801000
MSGLEN   DS    FL1                                                      06802000
DAY      DS    AL1                                                      06803000
MONTH    DS    AL1                                                      06804000
YEAR     DS    AL1                                                      06805000
STARTREC DS    AL1                                                      06806000
RTNCODE  DS    AL1                                                      06807000
PRTTITLE DC    XL1'01'                                                  06808000
         DS    0D                                                       06809000
@TS00001 DS    CL8                                                      06810000
@CC02087 DC    C'SYSPRINT'                                              06811000
@CC02089 DC    C'SYSIN   '                                              06812000
@CC02091 DC    C'SYSUT1  '                                              06813000
@CC02093 DC    C'SYSUT2  '                                              06814000
@CC02095 DC    C'OUTPUT'                                                06815000
@CC02043 DC    C' VOL='                                                 06816000
@CC02175 DC    C'     '                                                 06817000
@CC02178 DC    C'RETRY'                                                 06818000
@CC02049 DC    C'VOL1'                                                  06819000
@CC02041 DC    C' DS'                                                   06820000
@CC03452 DC    C'DS'                                                    06821000
         DS    CL2                                                      06822000
DEBSBPTR DS    CL4                                                      06823000
         ORG   DEBSBPTR                                                 06824000
DEBEXPTR DS    AL4                                                      06825000
         ORG   DEBEXPTR                                                 06826000
DEBDAPTR DS    AL4                                                      06827000
         ORG   DEBSBPTR+4                                               06828000
ZEROREC  DS    CL128                                                    06829000
         ORG   ZEROREC                                                  06830000
@NM00065 DC    128XL1'00'                                               06831000
         ORG   ZEROREC+128                                              06832000
BLANK    DC    CL128' '                                                 06833000
LEGEND   DC    CL7'LEGEND-'                                             06834000
CHARDDR1 DC    CL4'DDR1'                                                06835000
CHARHDR1 DC    CL4'HDR1'                                                06836000
LOW      DC    CL5'01001'                                               06837000
HIG      DC    CL5'74000'                                               06838000
CHARDDR2 DC    CL13'DELETED ENTRY'                                      06839000
BLNKONE  DC    CL5'    1'                                               06840000
MAXRECL  DC    CL5'00128'                                               06841000
CHAR99   DC    CL2'99'                                                  06842000
ZEROS    DC    CL2'00'                                                  06843000
CHAR12   DC    CL2'12'                                                  06844000
CHAR31   DC    CL2'31'                                                  06845000
DFOPSIN  DC    X'01800000'                                              06846000
MCSFLAGS DC    X'8000'                                                  06847000
DESCROUT DC    X'02000020'                                              06848000
SWITCHES DS    CL17                                                     06849000
         ORG   SWITCHES                                                 06850000
VOLSW    DS    FL1                                                      06851000
PROTSW   DS    FL1                                                      06852000
BADRECSW DS    FL1                                                      06853000
DFSWITCH DS    FL1                                                      06854000
MODESW   DS    FL1                                                      06855000
RETRYSW  DS    FL1                                                      06856000
SW       DS    FL1                                                      06857000
EXPSW    DS    FL1                                                      06858000
MODESWIT DS    FL1                                                      06859000
SWITCH3  DS    BL1                                                      06860000
         ORG   SWITCH3                                                  06861000
DUPDSID  DS    BL1                                                      06862000
@NM00066 EQU   SWITCH3+0                                                06863000
         ORG   SWITCHES+10                                              06864000
SWITCH2  DS    BL1                                                      06865000
         ORG   SWITCH2                                                  06866000
CANCELED DS    BL1                                                      06867000
OUTSW    EQU   SWITCH2+0                                                06868000
SW507I   EQU   SWITCH2+0                                                06869000
FIRSTVOL EQU   SWITCH2+0                                                06870000
PRINTERR EQU   SWITCH2+0                                                06871000
BLANKCHR EQU   SWITCH2+0                                                06872000
BADBLKLN EQU   SWITCH2+0                                                06873000
NONZERO  EQU   SWITCH2+0                                                06874000
         ORG   SWITCHES+11                                              06875000
WORKSW   DS    FL1                                                      06876000
SWITCH1  DS    BL1                                                      06877000
         ORG   SWITCH1                                                  06878000
FIRSTIO  DS    BL1                                                      06879000
NOT1ST   EQU   SWITCH1+0                                                06880000
FIRSTPUT EQU   SWITCH1+0                                                06881000
LASTPUT  EQU   SWITCH1+0                                                06882000
SW504I   EQU   SWITCH1+0                                                06883000
USEVOL   EQU   SWITCH1+0                                                06884000
BADVOLID EQU   SWITCH1+0                                                06885000
SW508I   EQU   SWITCH1+0                                                06886000
         ORG   SWITCHES+13                                              06887000
SWDS     DS    BL1                                                      06888000
         ORG   SWDS                                                     06889000
SW505I   DS    BL1                                                      06890000
GOODDS   EQU   SWDS+0                                                   06891000
DELENT   EQU   SWDS+0                                                   06892000
SW506I   EQU   SWDS+0                                                   06893000
SW515I   EQU   SWDS+0                                                   06894000
@NM00067 EQU   SWDS+0                                                   06895000
         ORG   SWITCHES+14                                              06896000
FAILSW   DS    FL1                                                      06897000
WRTDDR1  DS    FL1                                                      06898000
REPEATSW DS    FL1                                                      06899000
         ORG   SWITCHES+17                                              06900000
CARD     DS    CL80                                                     06901000
         ORG   CARD                                                     06902000
CARDBUF  DC    CL80' '                                                  06903000
         ORG   CARD+80                                                  06904000
         DS    CL1                                                      06905000
RECBUF1  DS    CL128                                                    06906000
RECBUF2  DS    CL128                                                    06907000
DATE     DS    CL6                                                      06908000
         ORG   DATE                                                     06909000
DATEYEAR DS    CL2                                                      06910000
DATEMON  DS    CL2                                                      06911000
DATEDAY  DS    CL2                                                      06912000
         ORG   DATE+6                                                   06913000
CREADATE DS    CL6                                                      06914000
EXPDATE  DS    CL6                                                      06915000
         DS    CL2                                                      06916000
WORK1    DS    CL4                                                      06917000
WORK2    DS    CL4                                                      06918000
WORK3    DS    CL4                                                      06919000
REPLY    DS    CL5                                                      06920000
SAVEFLD  DS    CL5                                                      06921000
REPVOL   DC    CL6' '                                                   06922000
WORKTIOT DS    CL16                                                     06923000
         ORG   WORKTIOT                                                 06924000
WORKSPSW DC    AL1(0)                                                   06925000
WORKSYSP DS    AL3                                                      06926000
WORKSISW DC    AL1(0)                                                   06927000
WORKSYSI DS    AL3                                                      06928000
WORKU1SW DC    AL1(0)                                                   06929000
WORKSYS1 DS    AL3                                                      06930000
WORKU2SW DC    AL1(0)                                                   06931000
WORKSYS2 DS    AL3                                                      06932000
         ORG   WORKTIOT+16                                              06933000
SYSPEXIT DS    CL8                                                      06934000
         ORG   SYSPEXIT                                                 06935000
@NM00083 DC    X'05'                                                    06936000
@NM00084 DC    AL3(SYPTEXIT)                                            06937000
ABNDEXT  DS    CL4                                                      06938000
         ORG   ABNDEXT                                                  06939000
@NM00085 DC    X'91'                                                    06940000
@NM00086 DC    AL3(ABEXIT)                                              06941000
         ORG   SYSPEXIT+8                                               06942000
OPENEXIT DS    CL8                                                      06943000
         ORG   OPENEXIT                                                 06944000
@NM00087 DC    X'05'                                                    06945000
@NM00088 DC    AL3(DCBEXIT)                                             06946000
@NM00089 DS    CL4                                                      06947000
         ORG   @NM00089                                                 06948000
@NM00090 DC    X'91'                                                    06949000
ABNDEXT2 DC    AL3(ABEXIT)                                              06950000
         ORG   OPENEXIT+8                                               06951000
MSGTYPE  DC    CL1' '                                                   06952000
REMAIN   DS    CL1                                                      06953000
JULIANDT DS    CL2                                                      06954000
SAVEDATE DS    CL4                                                      06955000
UNPKDATE DS    CL8                                                      06956000
         ORG   UNPKDATE                                                 06957000
@NM00091 DS    CL3                                                      06958000
UNPKYEAR DS    CL2                                                      06959000
UNPKDAY  DS    CL3                                                      06960000
         ORG   UNPKDATE+8                                               06961000
SYSYEAR  DS    CL2                                                      06962000
SYSDAY   DS    CL2                                                      06963000
HDRYEAR1 DS    CL2                                                      06964000
HDRDAY1  DS    CL2                                                      06965000
HDRMTH1  DS    CL2                                                      06966000
LASTREC  DS    CL4                                                      06967000
         ORG   LASTREC                                                  06968000
EC       DC    H'0'                                                     06969000
ER       DC    H'0'                                                     06970000
         ORG   LASTREC+4                                                06971000
FIRSTREC DS    CL4                                                      06972000
         ORG   FIRSTREC                                                 06973000
SC       DC    H'0'                                                     06974000
SR       DC    H'0'                                                     06975000
         ORG   FIRSTREC+4                                               06976000
MODE     DS    CL1                                                      06977000
         DS    CL1                                                      06978000
TICCCW   DS    CL8                                                      06979000
         ORG   TICCCW                                                   06980000
@NM00096 DC    X'08'                                                    06981000
TICADDR  DS    AL3                                                      06982000
@NM00097 DC    X'60000001'                                              06983000
         ORG   TICCCW+8                                                 06984000
WTORECB  DS    CL4                                                      06985000
UCBLIST  DS    CL8                                                      06986000
         ORG   UCBLIST                                                  06987000
INUCB    DC    A(0)                                                     06988000
OUTUCB   DC    A(0)                                                     06989000
         ORG   UCBLIST+8                                                06990000
IEB500I  DC    CL43'IEB500I END OF DISKETTE MAINTENANCE UTILITY'        06991000
IEB501I  DC    CL38'IEB501I INCOMPLETE TRACK 0 INFORMATION'             06992000
IEB504I  DC    CL40'IEB504I ERROR SECTORS ON OUTPUT DISKETTE'           06993000
IEB505I  DC    CL39'IEB505I INCORRECT FORMAT - DS STATEMENT'            06994000
IEB506I  DS    CL34                                                     06995000
         ORG   IEB506I                                                  06996000
@NM00103 DC    CL10'IEB506I DS'                                         06997000
I506DS#  DC    CL2'NN'                                                  06998000
@NM00104 DC    CL22' INVALID SPECIFICATION'                             06999000
         ORG   IEB506I+34                                               07000000
IEB507I  DS    CL27                                                     07001000
         ORG   IEB507I                                                  07002000
@NM00105 DC    CL10'IEB507I DS'                                         07003000
I507DS#  DC    CL2'NN'                                                  07004000
@NM00106 DC    CL15' INVALID EXTENT'                                    07005000
         ORG   IEB507I+27                                               07006000
IEB508I  DC    CL35'IEB508I SYSUT1 VOL1 SECTOR IN ERROR'                07007000
IEB509I  DC    CL36'IEB509I INCORRECT CONTROL IDENTIFIER'               07008000
IEB510I  DS    CL27                                                     07009000
         ORG   IEB510I                                                  07010000
@NM00107 DC    CL13'IEB510I SYSUT'                                      07011000
I510DDNM DC    AL1(1)                                                   07012000
@NM00108 DC    CL13' UNIT INVALID'                                      07013000
         ORG   IEB510I+27                                               07014000
IEB511I  DS    CL40                                                     07015000
         ORG   IEB511I                                                  07016000
@NM00109 DC    CL15'IEB511I DDNAME '                                    07017000
I511DDNM DC    CL8'DDNAMEXX'                                            07018000
@NM00110 DC    CL17' CANNOT BE OPENED'                                  07019000
         ORG   IEB511I+40                                               07020000
IEB512I  DS    CL37                                                     07021000
         ORG   IEB512I                                                  07022000
@NM00111 DC    CL20'IEB512I FILE NUMBER '                               07023000
I512HDR# DC    CL2'XX'                                                  07024000
@NM00112 DC    CL15' - ERROR SECTOR'                                    07025000
         ORG   IEB512I+37                                               07026000
IEB513I  DS    CL40                                                     07027000
         ORG   IEB513I                                                  07028000
@NM00113 DC    CL27'IEB513I READ ERROR - TRACK '                        07029000
I513TRK# DC    CL2'TT'                                                  07030000
@NM00114 DC    CL9', SECTOR '                                           07031000
I513SCT# DC    CL2'SS'                                                  07032000
         ORG   IEB513I+40                                               07033000
IEB514I  DC    CL28'IEB514I EXCESS DS STATEMENTS'                       07034000
IEB515I  DC    CL41'IEB515I CONTROL STATEMENT OUT OF SEQUENCE'          07035000
IEB516I  DC    CL31'IEB516I SYSUT1 INCORRECT VOLUME'                    07036000
IEB519I  DC    CL33'IEB519I INVALID VOL SPECIFICATION'                  07037000
IEB520I  DS    CL26                                                     07038000
         ORG   IEB520I                                                  07039000
@NM00115 DC    CL8'IEB520I '                                            07040000
I520DDNM DC    CL8'DDNAMEXX'                                            07041000
@NM00116 DC    CL10' I/O ERROR'                                         07042000
         ORG   IEB520I+26                                               07043000
IEB521I  DS    CL48                                                     07044000
         ORG   IEB521I                                                  07045000
@NM00117 DC    CL47'IEB521I OUTPUT DISKETTE VOLUME ACCESSIBILITY = '    07046000
I521VA   DC    CL1'S'                                                   07047000
         ORG   IEB521I+48                                               07048000
         DS    CL1                                                      07049000
PRT      DS    CL121                                                    07050000
         ORG   PRT                                                      07051000
@NM00132 DC    CL37' '                                                  07052000
TITLELIN DC    CL47'IEBDISKT --- OS/VS DISKETTE MAINTENANCE UTILITY'    07053000
@NM00133 DC    CL37' '                                                  07054000
         ORG   PRT+121                                                  07055000
HEAD1    DC    CL15'VOLUME LABEL IS'                                    07056000
HEAD2    DS    CL91                                                     07057000
         ORG   HEAD2                                                    07058000
@NM00134 DC    CL34' (1)    (2)      (3)    (4)    (5)'                 07059000
@NM00135 DC    CL29'  (6) (7) (8) (9)(10) (11)   '                      07060000
@NM00136 DC    CL12'(12)    (13)'                                       07061000
@NM00137 DC    CL13'  (14)  (15) '                                      07062000
         ORG   HEAD2+91                                                 07063000
HEAD3    DS    CL80                                                     07064000
         ORG   HEAD3                                                    07065000
@NM00138 DC    CL27'(1) DSNN                   '                        07066000
@NM00139 DC    CL14'(6) BYPASS IND'                                     07067000
@NM00140 DC    CL25'ICATOR       (11) VOLUME '                          07068000
@NM00141 DC    CL14'SEQUENCE NUM  '                                     07069000
         ORG   HEAD3+80                                                 07070000
HEAD4    DS    CL80                                                     07071000
         ORG   HEAD4                                                    07072000
@NM00142 DC    CL40'(2) DATA SET IDENTIFIER    (7) DATA SET '           07073000
@NM00143 DC    CL40'SECURITY      (12) CREATION DATE YYMMDD '           07074000
         ORG   HEAD4+80                                                 07075000
HEAD5    DS    CL80                                                     07076000
         ORG   HEAD5                                                    07077000
@NM00144 DC    CL40'(3) BLOCK LENGTH           (8) WRITE PRO'           07078000
@NM00145 DC    CL40'TECTION       (13) EXPIR. DATE YYMMDD   '           07079000
         ORG   HEAD5+80                                                 07080000
HEAD6    DS    CL80                                                     07081000
         ORG   HEAD6                                                    07082000
@NM00146 DC    CL40'(4) BEGIN OF EXTENT TT0SS  (9) EXCHANGE '           07083000
@NM00147 DC    CL40'INDICATOR     (14) VERIFY INDICATOR     '           07084000
         ORG   HEAD6+80                                                 07085000
HEAD7    DS    CL80                                                     07086000
         ORG   HEAD7                                                    07087000
@NM00148 DC    CL40'(5) END OF EXTENT TT0SS   (10) MULTI VOL'           07088000
@NM00149 DC    CL40'UME INDICATOR (15) END OF DATA TT0SS    '           07089000
         ORG   HEAD7+80                                                 07090000
         DS    CL1                                                      07091000
IN1PREFX DS    CL72                                                     07092000
         ORG   IN1PREFX                                                 07093000
@NM00150 DC    AL4(IN2PREFX)                                            07094000
IN1ECB   DC    F'0'                                                     07095000
IN1IOB   DS    0C                                                       07096000
IN1FLAG1 DC    X'40'                                                    07097000
@NM00151 DC    AL3(0)                                                   07098000
@NM00152 DC    AL1(0)                                                   07099000
IN1ECBPT DC    AL3(IN1ECB)                                              07100000
@NM00153 DC    F'0'                                                     07101000
@NM00154 DC    F'0'                                                     07102000
@NM00155 DC    AL1(0)                                                   07103000
IN1START DC    AL3(IN1CCWS)                                             07104000
@NM00156 DC    AL1(0)                                                   07105000
IN1DCBPT DC    AL3(SYSUT1)                                              07106000
@NM00157 DC    F'0'                                                     07107000
@NM00158 DC    F'0'                                                     07108000
IN1SKADR DS    CL4                                                      07109000
         ORG   IN1SKADR                                                 07110000
IN1SKRV  DC    AL1(0)                                                   07111000
IN1SKTT  DS    AL1                                                      07112000
IN1SK0   DC    AL1(0)                                                   07113000
IN1SKSS  DS    AL1                                                      07114000
         ORG   IN1PREFX+44                                              07115000
IN1NIOB  DC    AL4(IN2IOB)                                              07116000
IN1CCWS  DS    CL24                                                     07117000
         ORG   IN1CCWS                                                  07118000
IN1DFOPS DS    CL8                                                      07119000
         ORG   IN1DFOPS                                                 07120000
IN1DFOPC DC    X'2F'                                                    07121000
IN1DFOPA DC    AL3(DFOPSIN)                                             07122000
IN1DFSIL DC    X'60'                                                    07123000
IN1DFCNT DC    X'000004'                                                07124000
         ORG   IN1CCWS+8                                                07125000
IN1SEEK  DS    CL8                                                      07126000
         ORG   IN1SEEK                                                  07127000
IN1SKOPC DC    X'07'                                                    07128000
IN1SKADD DC    AL3(IN1SKADR)                                            07129000
IN1SKSIL DC    X'60'                                                    07130000
IN1SKCNT DC    X'000004'                                                07131000
         ORG   IN1CCWS+16                                               07132000
IN1RDCCW DS    CL8                                                      07133000
         ORG   IN1RDCCW                                                 07134000
IN1RDOPC DC    X'06'                                                    07135000
IN1RDADD DC    AL3(RECBUF1)                                             07136000
IN1RDSIL DC    X'20'                                                    07137000
IN1RDCNT DC    X'000080'                                                07138000
         ORG   IN1PREFX+72                                              07139000
IN2PREFX DS    CL72                                                     07140000
         ORG   IN2PREFX                                                 07141000
@NM00159 DC    AL4(IN1PREFX)                                            07142000
IN2ECB   DC    F'0'                                                     07143000
IN2IOB   DS    0C                                                       07144000
IN2FLAG1 DC    X'40'                                                    07145000
@NM00160 DC    AL3(0)                                                   07146000
@NM00161 DC    AL1(0)                                                   07147000
IN2ECBPT DC    AL3(IN2ECB)                                              07148000
@NM00162 DC    F'0'                                                     07149000
@NM00163 DC    F'0'                                                     07150000
@NM00164 DC    AL1(0)                                                   07151000
IN2START DC    AL3(IN2CCWS)                                             07152000
@NM00165 DC    AL1(0)                                                   07153000
IN2DCBPT DC    AL3(SYSUT1)                                              07154000
@NM00166 DC    F'0'                                                     07155000
@NM00167 DC    F'0'                                                     07156000
IN2SKADR DS    CL4                                                      07157000
         ORG   IN2SKADR                                                 07158000
IN2SKRV  DC    AL1(0)                                                   07159000
IN2SKTT  DS    AL1                                                      07160000
IN2SK0   DC    AL1(0)                                                   07161000
IN2SKSS  DS    AL1                                                      07162000
         ORG   IN2PREFX+44                                              07163000
IN2NIOB  DC    AL4(IN1IOB)                                              07164000
IN2CCWS  DS    CL24                                                     07165000
         ORG   IN2CCWS                                                  07166000
IN2DFOPS DS    CL8                                                      07167000
         ORG   IN2DFOPS                                                 07168000
IN2DFOPC DC    X'2F'                                                    07169000
IN2DFOPA DC    AL3(DFOPSIN)                                             07170000
IN2DFSIL DC    X'60'                                                    07171000
IN2DFCNT DC    X'000004'                                                07172000
         ORG   IN2CCWS+8                                                07173000
IN2SEEK  DS    CL8                                                      07174000
         ORG   IN2SEEK                                                  07175000
IN2SKOPC DC    X'07'                                                    07176000
IN2SKADD DC    AL3(IN2SKADR)                                            07177000
IN2SKSIL DC    X'60'                                                    07178000
IN2SKCNT DC    X'000004'                                                07179000
         ORG   IN2CCWS+16                                               07180000
IN2RDCCW DS    CL8                                                      07181000
         ORG   IN2RDCCW                                                 07182000
IN2RDOPC DC    X'06'                                                    07183000
IN2RDADD DC    AL3(RECBUF2)                                             07184000
IN2RDSIL DC    X'20'                                                    07185000
IN2RDCNT DC    X'000080'                                                07186000
         ORG   IN2PREFX+72                                              07187000
OT1PREFX DS    CL288                                                    07188000
         ORG   OT1PREFX                                                 07189000
@NM00181 DC    AL4(OT2PREFX)                                            07190000
OT1ECB   DC    F'0'                                                     07191000
OT1IOB   DS    0C                                                       07192000
OT1FLAG1 DC    X'40'                                                    07193000
@NM00182 DC    AL3(0)                                                   07194000
@NM00183 DC    AL1(0)                                                   07195000
OT1ECBPT DC    AL3(OT1ECB)                                              07196000
@NM00184 DC    F'0'                                                     07197000
@NM00185 DC    F'0'                                                     07198000
@NM00186 DC    AL1(0)                                                   07199000
OT1START DC    AL3(OT1CCWS)                                             07200000
@NM00187 DC    AL1(0)                                                   07201000
OT1DCBPT DC    AL3(SYSUT2EX)                                            07202000
@NM00188 DC    F'0'                                                     07203000
@NM00189 DC    F'0'                                                     07204000
OT1SKADR DS    CL4                                                      07205000
         ORG   OT1SKADR                                                 07206000
OT1SKRV  DC    AL1(0)                                                   07207000
OT1SKTT  DS    AL1                                                      07208000
OT1SK0   DC    AL1(0)                                                   07209000
OT1SKSS  DS    AL1                                                      07210000
         ORG   OT1PREFX+44                                              07211000
OT1NIOB  DC    AL4(OT2IOB)                                              07212000
@NM00190 DS    CL4                                                      07213000
DFOPSOT1 DC    X'00400000'                                              07214000
OT1CCWS  DS    CL232                                                    07215000
         ORG   OT1CCWS                                                  07216000
OT1DFOPS DS    CL8                                                      07217000
         ORG   OT1DFOPS                                                 07218000
OT1DFOPC DC    X'2F'                                                    07219000
OT1DFOPA DC    AL3(DFOPSOT1)                                            07220000
OT1DFSIL DC    X'60'                                                    07221000
OT1DFCNT DC    X'000004'                                                07222000
         ORG   OT1CCWS+8                                                07223000
OT1SEEK  DS    CL8                                                      07224000
         ORG   OT1SEEK                                                  07225000
OT1SKOPC DC    X'07'                                                    07226000
OT1SKADD DC    AL3(OT1SKADR)                                            07227000
OT1SKSIL DC    X'60'                                                    07228000
OT1SKCNT DC    X'000004'                                                07229000
         ORG   OT1CCWS+16                                               07230000
OT1WTCCW DS    CL8                                                      07231000
         ORG   OT1WTCCW                                                 07232000
OT1WTOPC DC    X'05'                                                    07233000
OT1WTADD DC    AL3(OT1REC1)                                             07234000
OT1WTSIL DC    X'60'                                                    07235000
OT1WTCNT DC    X'000080'                                                07236000
         ORG   OT1CCWS+24                                               07237000
@NM00191 DS    CL8                                                      07238000
         ORG   @NM00191                                                 07239000
@NM00192 DC    X'05'                                                    07240000
@NM00193 DC    AL3(OT1REC2)                                             07241000
@NM00194 DC    X'60'                                                    07242000
@NM00195 DC    X'000080'                                                07243000
         ORG   OT1CCWS+32                                               07244000
@NM00196 DS    CL8                                                      07245000
         ORG   @NM00196                                                 07246000
@NM00197 DC    X'05'                                                    07247000
@NM00198 DC    AL3(OT1REC3)                                             07248000
@NM00199 DC    X'60'                                                    07249000
@NM00200 DC    X'000080'                                                07250000
         ORG   OT1CCWS+40                                               07251000
@NM00201 DS    CL8                                                      07252000
         ORG   @NM00201                                                 07253000
@NM00202 DC    X'05'                                                    07254000
@NM00203 DC    AL3(OT1REC4)                                             07255000
@NM00204 DC    X'60'                                                    07256000
@NM00205 DC    X'000080'                                                07257000
         ORG   OT1CCWS+48                                               07258000
@NM00206 DS    CL8                                                      07259000
         ORG   @NM00206                                                 07260000
@NM00207 DC    X'05'                                                    07261000
@NM00208 DC    AL3(OT1REC5)                                             07262000
@NM00209 DC    X'60'                                                    07263000
@NM00210 DC    X'000080'                                                07264000
         ORG   OT1CCWS+56                                               07265000
@NM00211 DS    CL8                                                      07266000
         ORG   @NM00211                                                 07267000
@NM00212 DC    X'05'                                                    07268000
@NM00213 DC    AL3(OT1REC6)                                             07269000
@NM00214 DC    X'60'                                                    07270000
@NM00215 DC    X'000080'                                                07271000
         ORG   OT1CCWS+64                                               07272000
@NM00216 DS    CL8                                                      07273000
         ORG   @NM00216                                                 07274000
@NM00217 DC    X'05'                                                    07275000
@NM00218 DC    AL3(OT1REC7)                                             07276000
@NM00219 DC    X'60'                                                    07277000
@NM00220 DC    X'000080'                                                07278000
         ORG   OT1CCWS+72                                               07279000
@NM00221 DS    CL8                                                      07280000
         ORG   @NM00221                                                 07281000
@NM00222 DC    X'05'                                                    07282000
@NM00223 DC    AL3(OT1REC8)                                             07283000
@NM00224 DC    X'60'                                                    07284000
@NM00225 DC    X'000080'                                                07285000
         ORG   OT1CCWS+80                                               07286000
@NM00226 DS    CL8                                                      07287000
         ORG   @NM00226                                                 07288000
@NM00227 DC    X'05'                                                    07289000
@NM00228 DC    AL3(OT1REC9)                                             07290000
@NM00229 DC    X'60'                                                    07291000
@NM00230 DC    X'000080'                                                07292000
         ORG   OT1CCWS+88                                               07293000
@NM00231 DS    CL8                                                      07294000
         ORG   @NM00231                                                 07295000
@NM00232 DC    X'05'                                                    07296000
@NM00233 DC    AL3(OT1REC10)                                            07297000
@NM00234 DC    X'60'                                                    07298000
@NM00235 DC    X'000080'                                                07299000
         ORG   OT1CCWS+96                                               07300000
@NM00236 DS    CL8                                                      07301000
         ORG   @NM00236                                                 07302000
@NM00237 DC    X'05'                                                    07303000
@NM00238 DC    AL3(OT1REC11)                                            07304000
@NM00239 DC    X'60'                                                    07305000
@NM00240 DC    X'000080'                                                07306000
         ORG   OT1CCWS+104                                              07307000
@NM00241 DS    CL8                                                      07308000
         ORG   @NM00241                                                 07309000
@NM00242 DC    X'05'                                                    07310000
@NM00243 DC    AL3(OT1REC12)                                            07311000
@NM00244 DC    X'60'                                                    07312000
@NM00245 DC    X'000080'                                                07313000
         ORG   OT1CCWS+112                                              07314000
@NM00246 DS    CL8                                                      07315000
         ORG   @NM00246                                                 07316000
@NM00247 DC    X'05'                                                    07317000
@NM00248 DC    AL3(OT1REC13)                                            07318000
@NM00249 DC    X'60'                                                    07319000
@NM00250 DC    X'000080'                                                07320000
         ORG   OT1CCWS+120                                              07321000
@NM00251 DS    CL8                                                      07322000
         ORG   @NM00251                                                 07323000
@NM00252 DC    X'05'                                                    07324000
@NM00253 DC    AL3(OT1REC14)                                            07325000
@NM00254 DC    X'60'                                                    07326000
@NM00255 DC    X'000080'                                                07327000
         ORG   OT1CCWS+128                                              07328000
@NM00256 DS    CL8                                                      07329000
         ORG   @NM00256                                                 07330000
@NM00257 DC    X'05'                                                    07331000
@NM00258 DC    AL3(OT1REC15)                                            07332000
@NM00259 DC    X'60'                                                    07333000
@NM00260 DC    X'000080'                                                07334000
         ORG   OT1CCWS+136                                              07335000
@NM00261 DS    CL8                                                      07336000
         ORG   @NM00261                                                 07337000
@NM00262 DC    X'05'                                                    07338000
@NM00263 DC    AL3(OT1REC16)                                            07339000
@NM00264 DC    X'60'                                                    07340000
@NM00265 DC    X'000080'                                                07341000
         ORG   OT1CCWS+144                                              07342000
@NM00266 DS    CL8                                                      07343000
         ORG   @NM00266                                                 07344000
@NM00267 DC    X'05'                                                    07345000
@NM00268 DC    AL3(OT1REC17)                                            07346000
@NM00269 DC    X'60'                                                    07347000
@NM00270 DC    X'000080'                                                07348000
         ORG   OT1CCWS+152                                              07349000
@NM00271 DS    CL8                                                      07350000
         ORG   @NM00271                                                 07351000
@NM00272 DC    X'05'                                                    07352000
@NM00273 DC    AL3(OT1REC18)                                            07353000
@NM00274 DC    X'60'                                                    07354000
@NM00275 DC    X'000080'                                                07355000
         ORG   OT1CCWS+160                                              07356000
@NM00276 DS    CL8                                                      07357000
         ORG   @NM00276                                                 07358000
@NM00277 DC    X'05'                                                    07359000
@NM00278 DC    AL3(OT1REC19)                                            07360000
@NM00279 DC    X'60'                                                    07361000
@NM00280 DC    X'000080'                                                07362000
         ORG   OT1CCWS+168                                              07363000
@NM00281 DS    CL8                                                      07364000
         ORG   @NM00281                                                 07365000
@NM00282 DC    X'05'                                                    07366000
@NM00283 DC    AL3(OT1REC20)                                            07367000
@NM00284 DC    X'60'                                                    07368000
@NM00285 DC    X'000080'                                                07369000
         ORG   OT1CCWS+176                                              07370000
@NM00286 DS    CL8                                                      07371000
         ORG   @NM00286                                                 07372000
@NM00287 DC    X'05'                                                    07373000
@NM00288 DC    AL3(OT1REC21)                                            07374000
@NM00289 DC    X'60'                                                    07375000
@NM00290 DC    X'000080'                                                07376000
         ORG   OT1CCWS+184                                              07377000
@NM00291 DS    CL8                                                      07378000
         ORG   @NM00291                                                 07379000
@NM00292 DC    X'05'                                                    07380000
@NM00293 DC    AL3(OT1REC22)                                            07381000
@NM00294 DC    X'60'                                                    07382000
@NM00295 DC    X'000080'                                                07383000
         ORG   OT1CCWS+192                                              07384000
@NM00296 DS    CL8                                                      07385000
         ORG   @NM00296                                                 07386000
@NM00297 DC    X'05'                                                    07387000
@NM00298 DC    AL3(OT1REC23)                                            07388000
@NM00299 DC    X'60'                                                    07389000
@NM00300 DC    X'000080'                                                07390000
         ORG   OT1CCWS+200                                              07391000
@NM00301 DS    CL8                                                      07392000
         ORG   @NM00301                                                 07393000
@NM00302 DC    X'05'                                                    07394000
@NM00303 DC    AL3(OT1REC24)                                            07395000
@NM00304 DC    X'60'                                                    07396000
@NM00305 DC    X'000080'                                                07397000
         ORG   OT1CCWS+208                                              07398000
@NM00306 DS    CL8                                                      07399000
         ORG   @NM00306                                                 07400000
@NM00307 DC    X'05'                                                    07401000
@NM00308 DC    AL3(OT1REC25)                                            07402000
@NM00309 DC    X'60'                                                    07403000
@NM00310 DC    X'000080'                                                07404000
         ORG   OT1CCWS+216                                              07405000
@NM00311 DS    CL8                                                      07406000
         ORG   @NM00311                                                 07407000
@NM00312 DC    X'05'                                                    07408000
@NM00313 DC    AL3(OT1REC26)                                            07409000
@NM00314 DC    X'60'                                                    07410000
@NM00315 DC    X'000080'                                                07411000
         ORG   OT1CCWS+224                                              07412000
OT1NOOP  DC    X'0300000100000001'                                      07413000
         ORG   OT1PREFX+288                                             07414000
OT2PREFX DS    CL288                                                    07415000
         ORG   OT2PREFX                                                 07416000
@NM00316 DC    AL4(OT1PREFX)                                            07417000
OT2ECB   DS    CL4                                                      07418000
         ORG   OT2ECB                                                   07419000
OT2ECBCC DS    BL1                                                      07420000
         ORG   OT2ECBCC                                                 07421000
@NM00317 DS    BL1                                                      07422000
OT2ECBC  EQU   OT2ECBCC+0                                               07423000
@NM00318 EQU   OT2ECBCC+0                                               07424000
         ORG   OT2ECB+1                                                 07425000
@NM00319 DS    CL3                                                      07426000
         ORG   OT2PREFX+8                                               07427000
OT2IOB   DS    0C                                                       07428000
OT2FLAG1 DC    X'40'                                                    07429000
@NM00320 DC    AL3(0)                                                   07430000
@NM00321 DC    AL1(0)                                                   07431000
OT2ECBPT DC    AL3(OT2ECB)                                              07432000
@NM00322 DC    F'0'                                                     07433000
@NM00323 DC    F'0'                                                     07434000
@NM00324 DC    AL1(0)                                                   07435000
OT2START DC    AL3(OT2CCWS)                                             07436000
@NM00325 DC    AL1(0)                                                   07437000
OT2DCBPT DC    AL3(SYSUT2EX)                                            07438000
@NM00326 DC    F'0'                                                     07439000
@NM00327 DC    F'0'                                                     07440000
OT2SKADR DS    CL4                                                      07441000
         ORG   OT2SKADR                                                 07442000
OT2SKRV  DC    AL1(0)                                                   07443000
OT2SKTT  DS    AL1                                                      07444000
OT2SK0   DC    AL1(0)                                                   07445000
OT2SKSS  DS    AL1                                                      07446000
         ORG   OT2PREFX+44                                              07447000
OT2NIOB  DC    AL4(OT1IOB)                                              07448000
@NM00328 DS    CL4                                                      07449000
DFOPSOT2 DC    X'00400000'                                              07450000
OT2CCWS  DS    CL232                                                    07451000
         ORG   OT2CCWS                                                  07452000
OT2DFOPS DS    CL8                                                      07453000
         ORG   OT2DFOPS                                                 07454000
OT2DFOPC DC    X'2F'                                                    07455000
OT2DFOPA DC    AL3(DFOPSOT2)                                            07456000
OT2DFSIL DC    X'60'                                                    07457000
OT2DFCNT DC    X'000004'                                                07458000
         ORG   OT2CCWS+8                                                07459000
OT2SEEK  DS    CL8                                                      07460000
         ORG   OT2SEEK                                                  07461000
OT2SKOPC DC    X'07'                                                    07462000
OT2SKADD DC    AL3(OT2SKADR)                                            07463000
OT2SKSIL DC    X'60'                                                    07464000
OT2SKCNT DC    X'000004'                                                07465000
         ORG   OT2CCWS+16                                               07466000
OT2WTCCW DS    CL8                                                      07467000
         ORG   OT2WTCCW                                                 07468000
OT2WTOPC DC    X'05'                                                    07469000
OT2WTADD DC    AL3(OT2REC1)                                             07470000
OT2WTSIL DC    X'60'                                                    07471000
OT2WTCNT DC    X'000080'                                                07472000
         ORG   OT2CCWS+24                                               07473000
@NM00329 DS    CL8                                                      07474000
         ORG   @NM00329                                                 07475000
@NM00330 DC    X'05'                                                    07476000
@NM00331 DC    AL3(OT2REC2)                                             07477000
@NM00332 DC    X'60'                                                    07478000
@NM00333 DC    X'000080'                                                07479000
         ORG   OT2CCWS+32                                               07480000
@NM00334 DS    CL8                                                      07481000
         ORG   @NM00334                                                 07482000
@NM00335 DC    X'05'                                                    07483000
@NM00336 DC    AL3(OT2REC3)                                             07484000
@NM00337 DC    X'60'                                                    07485000
@NM00338 DC    X'000080'                                                07486000
         ORG   OT2CCWS+40                                               07487000
@NM00339 DS    CL8                                                      07488000
         ORG   @NM00339                                                 07489000
@NM00340 DC    X'05'                                                    07490000
@NM00341 DC    AL3(OT2REC4)                                             07491000
@NM00342 DC    X'60'                                                    07492000
@NM00343 DC    X'000080'                                                07493000
         ORG   OT2CCWS+48                                               07494000
@NM00344 DS    CL8                                                      07495000
         ORG   @NM00344                                                 07496000
@NM00345 DC    X'05'                                                    07497000
@NM00346 DC    AL3(OT2REC5)                                             07498000
@NM00347 DC    X'60'                                                    07499000
@NM00348 DC    X'000080'                                                07500000
         ORG   OT2CCWS+56                                               07501000
@NM00349 DS    CL8                                                      07502000
         ORG   @NM00349                                                 07503000
@NM00350 DC    X'05'                                                    07504000
@NM00351 DC    AL3(OT2REC6)                                             07505000
@NM00352 DC    X'60'                                                    07506000
@NM00353 DC    X'000080'                                                07507000
         ORG   OT2CCWS+64                                               07508000
@NM00354 DS    CL8                                                      07509000
         ORG   @NM00354                                                 07510000
@NM00355 DC    X'05'                                                    07511000
@NM00356 DC    AL3(OT2REC7)                                             07512000
@NM00357 DC    X'60'                                                    07513000
@NM00358 DC    X'000080'                                                07514000
         ORG   OT2CCWS+72                                               07515000
@NM00359 DS    CL8                                                      07516000
         ORG   @NM00359                                                 07517000
@NM00360 DC    X'05'                                                    07518000
@NM00361 DC    AL3(OT2REC8)                                             07519000
@NM00362 DC    X'60'                                                    07520000
@NM00363 DC    X'000080'                                                07521000
         ORG   OT2CCWS+80                                               07522000
@NM00364 DS    CL8                                                      07523000
         ORG   @NM00364                                                 07524000
@NM00365 DC    X'05'                                                    07525000
@NM00366 DC    AL3(OT2REC9)                                             07526000
@NM00367 DC    X'60'                                                    07527000
@NM00368 DC    X'000080'                                                07528000
         ORG   OT2CCWS+88                                               07529000
@NM00369 DS    CL8                                                      07530000
         ORG   @NM00369                                                 07531000
@NM00370 DC    X'05'                                                    07532000
@NM00371 DC    AL3(OT2REC10)                                            07533000
@NM00372 DC    X'60'                                                    07534000
@NM00373 DC    X'000080'                                                07535000
         ORG   OT2CCWS+96                                               07536000
@NM00374 DS    CL8                                                      07537000
         ORG   @NM00374                                                 07538000
@NM00375 DC    X'05'                                                    07539000
@NM00376 DC    AL3(OT2REC11)                                            07540000
@NM00377 DC    X'60'                                                    07541000
@NM00378 DC    X'000080'                                                07542000
         ORG   OT2CCWS+104                                              07543000
@NM00379 DS    CL8                                                      07544000
         ORG   @NM00379                                                 07545000
@NM00380 DC    X'05'                                                    07546000
@NM00381 DC    AL3(OT2REC12)                                            07547000
@NM00382 DC    X'60'                                                    07548000
@NM00383 DC    X'000080'                                                07549000
         ORG   OT2CCWS+112                                              07550000
@NM00384 DS    CL8                                                      07551000
         ORG   @NM00384                                                 07552000
@NM00385 DC    X'05'                                                    07553000
@NM00386 DC    AL3(OT2REC13)                                            07554000
@NM00387 DC    X'60'                                                    07555000
@NM00388 DC    X'000080'                                                07556000
         ORG   OT2CCWS+120                                              07557000
@NM00389 DS    CL8                                                      07558000
         ORG   @NM00389                                                 07559000
@NM00390 DC    X'05'                                                    07560000
@NM00391 DC    AL3(OT2REC14)                                            07561000
@NM00392 DC    X'60'                                                    07562000
@NM00393 DC    X'000080'                                                07563000
         ORG   OT2CCWS+128                                              07564000
@NM00394 DS    CL8                                                      07565000
         ORG   @NM00394                                                 07566000
@NM00395 DC    X'05'                                                    07567000
@NM00396 DC    AL3(OT2REC15)                                            07568000
@NM00397 DC    X'60'                                                    07569000
@NM00398 DC    X'000080'                                                07570000
         ORG   OT2CCWS+136                                              07571000
@NM00399 DS    CL8                                                      07572000
         ORG   @NM00399                                                 07573000
@NM00400 DC    X'05'                                                    07574000
@NM00401 DC    AL3(OT2REC16)                                            07575000
@NM00402 DC    X'60'                                                    07576000
@NM00403 DC    X'000080'                                                07577000
         ORG   OT2CCWS+144                                              07578000
@NM00404 DS    CL8                                                      07579000
         ORG   @NM00404                                                 07580000
@NM00405 DC    X'05'                                                    07581000
@NM00406 DC    AL3(OT2REC17)                                            07582000
@NM00407 DC    X'60'                                                    07583000
@NM00408 DC    X'000080'                                                07584000
         ORG   OT2CCWS+152                                              07585000
@NM00409 DS    CL8                                                      07586000
         ORG   @NM00409                                                 07587000
@NM00410 DC    X'05'                                                    07588000
@NM00411 DC    AL3(OT2REC18)                                            07589000
@NM00412 DC    X'60'                                                    07590000
@NM00413 DC    X'000080'                                                07591000
         ORG   OT2CCWS+160                                              07592000
@NM00414 DS    CL8                                                      07593000
         ORG   @NM00414                                                 07594000
@NM00415 DC    X'05'                                                    07595000
@NM00416 DC    AL3(OT2REC19)                                            07596000
@NM00417 DC    X'60'                                                    07597000
@NM00418 DC    X'000080'                                                07598000
         ORG   OT2CCWS+168                                              07599000
@NM00419 DS    CL8                                                      07600000
         ORG   @NM00419                                                 07601000
@NM00420 DC    X'05'                                                    07602000
@NM00421 DC    AL3(OT2REC20)                                            07603000
@NM00422 DC    X'60'                                                    07604000
@NM00423 DC    X'000080'                                                07605000
         ORG   OT2CCWS+176                                              07606000
@NM00424 DS    CL8                                                      07607000
         ORG   @NM00424                                                 07608000
@NM00425 DC    X'05'                                                    07609000
@NM00426 DC    AL3(OT2REC21)                                            07610000
@NM00427 DC    X'60'                                                    07611000
@NM00428 DC    X'000080'                                                07612000
         ORG   OT2CCWS+184                                              07613000
@NM00429 DS    CL8                                                      07614000
         ORG   @NM00429                                                 07615000
@NM00430 DC    X'05'                                                    07616000
@NM00431 DC    AL3(OT2REC22)                                            07617000
@NM00432 DC    X'60'                                                    07618000
@NM00433 DC    X'000080'                                                07619000
         ORG   OT2CCWS+192                                              07620000
@NM00434 DS    CL8                                                      07621000
         ORG   @NM00434                                                 07622000
@NM00435 DC    X'05'                                                    07623000
@NM00436 DC    AL3(OT2REC23)                                            07624000
@NM00437 DC    X'60'                                                    07625000
@NM00438 DC    X'000080'                                                07626000
         ORG   OT2CCWS+200                                              07627000
@NM00439 DS    CL8                                                      07628000
         ORG   @NM00439                                                 07629000
@NM00440 DC    X'05'                                                    07630000
@NM00441 DC    AL3(OT2REC24)                                            07631000
@NM00442 DC    X'60'                                                    07632000
@NM00443 DC    X'000080'                                                07633000
         ORG   OT2CCWS+208                                              07634000
@NM00444 DS    CL8                                                      07635000
         ORG   @NM00444                                                 07636000
@NM00445 DC    X'05'                                                    07637000
@NM00446 DC    AL3(OT2REC25)                                            07638000
@NM00447 DC    X'60'                                                    07639000
@NM00448 DC    X'000080'                                                07640000
         ORG   OT2CCWS+216                                              07641000
@NM00449 DS    CL8                                                      07642000
         ORG   @NM00449                                                 07643000
@NM00450 DC    X'05'                                                    07644000
@NM00451 DC    AL3(OT2REC26)                                            07645000
@NM00452 DC    X'60'                                                    07646000
@NM00453 DC    X'000080'                                                07647000
         ORG   OT2CCWS+224                                              07648000
OT2NOOP  DC    X'0300000100000001'                                      07649000
         ORG   OT2PREFX+288                                             07650000
OUTBUF1  DS    CL3328                                                   07651000
         ORG   OUTBUF1                                                  07652000
OT1REC1  DS    CL128                                                    07653000
OT1REC2  DS    CL128                                                    07654000
OT1REC3  DS    CL128                                                    07655000
OT1REC4  DS    CL128                                                    07656000
OT1REC5  DS    CL128                                                    07657000
OT1REC6  DS    CL128                                                    07658000
OT1REC7  DS    CL128                                                    07659000
OT1REC8  DS    CL128                                                    07660000
OT1REC9  DS    CL128                                                    07661000
OT1REC10 DS    CL128                                                    07662000
OT1REC11 DS    CL128                                                    07663000
OT1REC12 DS    CL128                                                    07664000
OT1REC13 DS    CL128                                                    07665000
OT1REC14 DS    CL128                                                    07666000
OT1REC15 DS    CL128                                                    07667000
OT1REC16 DS    CL128                                                    07668000
OT1REC17 DS    CL128                                                    07669000
OT1REC18 DS    CL128                                                    07670000
OT1REC19 DS    CL128                                                    07671000
OT1REC20 DS    CL128                                                    07672000
OT1REC21 DS    CL128                                                    07673000
OT1REC22 DS    CL128                                                    07674000
OT1REC23 DS    CL128                                                    07675000
OT1REC24 DS    CL128                                                    07676000
OT1REC25 DS    CL128                                                    07677000
OT1REC26 DS    CL128                                                    07678000
         ORG   OUTBUF1+3328                                             07679000
OUTBUF2  DS    CL3328                                                   07680000
         ORG   OUTBUF2                                                  07681000
OT2REC1  DS    CL128                                                    07682000
OT2REC2  DS    CL128                                                    07683000
OT2REC3  DS    CL128                                                    07684000
OT2REC4  DS    CL128                                                    07685000
OT2REC5  DS    CL128                                                    07686000
OT2REC6  DS    CL128                                                    07687000
OT2REC7  DS    CL128                                                    07688000
OT2REC8  DS    CL128                                                    07689000
OT2REC9  DS    CL128                                                    07690000
OT2REC10 DS    CL128                                                    07691000
OT2REC11 DS    CL128                                                    07692000
OT2REC12 DS    CL128                                                    07693000
OT2REC13 DS    CL128                                                    07694000
OT2REC14 DS    CL128                                                    07695000
OT2REC15 DS    CL128                                                    07696000
OT2REC16 DS    CL128                                                    07697000
OT2REC17 DS    CL128                                                    07698000
OT2REC18 DS    CL128                                                    07699000
OT2REC19 DS    CL128                                                    07700000
OT2REC20 DS    CL128                                                    07701000
OT2REC21 DS    CL128                                                    07702000
OT2REC22 DS    CL128                                                    07703000
OT2REC23 DS    CL128                                                    07704000
OT2REC24 DS    CL128                                                    07705000
OT2REC25 DS    CL128                                                    07706000
OT2REC26 DS    CL128                                                    07707000
         ORG   OUTBUF2+3328                                             07708000
ABSLEL   DS    19CL5                                                    07709000
PRTNRS   DC    CL2'01'                                                  07710000
         DC    CL2'02'                                                  07711000
         DC    CL2'03'                                                  07712000
         DC    CL2'04'                                                  07713000
         DC    CL2'05'                                                  07714000
         DC    CL2'06'                                                  07715000
         DC    CL2'07'                                                  07716000
         DC    CL2'08'                                                  07717000
         DC    CL2'09'                                                  07718000
         DC    CL2'10'                                                  07719000
         DC    CL2'11'                                                  07720000
         DC    CL2'12'                                                  07721000
         DC    CL2'13'                                                  07722000
         DC    CL2'14'                                                  07723000
         DC    CL2'15'                                                  07724000
         DC    CL2'16'                                                  07725000
         DC    CL2'17'                                                  07726000
         DC    CL2'18'                                                  07727000
         DC    CL2'19'                                                  07728000
FILESEQ  DC    19XL1'5C'                                                07729000
TR0T     DC    CL80' '                                                  07730000
         ORG   TR0T+0                                                   07731000
TR0TID   DS    CL4                                                      07732000
@NM00074 DS    CL1                                                      07733000
TR0TDSID DS    CL8                                                      07734000
@NM00075 DS    CL9                                                      07735000
TR0TBLKL DS    CL5                                                      07736000
@NM00076 DS    CL1                                                      07737000
TR0TBOE  DS    CL5                                                      07738000
         ORG   TR0TBOE+0                                                07739000
TR0TBOET DS    CL2                                                      07740000
TR0TBOE0 DS    CL1                                                      07741000
TR0TBOES DS    CL2                                                      07742000
         ORG   TR0T+33                                                  07743000
@NM00077 DS    CL1                                                      07744000
TR0TEOE  DS    CL5                                                      07745000
         ORG   TR0TEOE+0                                                07746000
TR0TEOET DS    CL2                                                      07747000
TR0TEOE0 DS    CL1                                                      07748000
TR0TEOES DS    CL2                                                      07749000
         ORG   TR0T+39                                                  07750000
@NM00078 DS    CL1                                                      07751000
TR0TBYPS DS    CL1                                                      07752000
TR0TDSS  DS    CL1                                                      07753000
TR0TWP   DS    CL1                                                      07754000
@NM00079 DS    CL1                                                      07755000
TR0TCONT DS    CL1                                                      07756000
TR0TSEQ# DS    CL2                                                      07757000
TR0TCREA DS    CL6                                                      07758000
@NM00080 DS    CL13                                                     07759000
TR0TEXP  DS    CL6                                                      07760000
TR0TVER  DS    CL1                                                      07761000
@NM00081 DS    CL1                                                      07762000
TR0TEOD  DS    CL5                                                      07763000
         ORG   TR0TEOD+0                                                07764000
TR0TEODT DS    CL2                                                      07765000
TR0TEOD0 DS    CL1                                                      07766000
TR0TEODS DS    CL2                                                      07767000
         ORG   TR0T+79                                                  07768000
@NM00082 DS    CL1                                                      07769000
         ORG   TR0T+80                                                  07770000
         DC    CL80' '                                                  07771000
         ORG   TR0T+160                                                 07772000
         DC    CL80' '                                                  07773000
         ORG   TR0T+240                                                 07774000
         DC    CL80' '                                                  07775000
         ORG   TR0T+320                                                 07776000
         DC    CL80' '                                                  07777000
         ORG   TR0T+400                                                 07778000
         DC    CL80' '                                                  07779000
         ORG   TR0T+480                                                 07780000
         DC    CL80' '                                                  07781000
         ORG   TR0T+560                                                 07782000
         DC    CL80' '                                                  07783000
         ORG   TR0T+640                                                 07784000
         DC    CL80' '                                                  07785000
         ORG   TR0T+720                                                 07786000
         DC    CL80' '                                                  07787000
         ORG   TR0T+800                                                 07788000
         DC    CL80' '                                                  07789000
         ORG   TR0T+880                                                 07790000
         DC    CL80' '                                                  07791000
         ORG   TR0T+960                                                 07792000
         DC    CL80' '                                                  07793000
         ORG   TR0T+1040                                                07794000
         DC    CL80' '                                                  07795000
         ORG   TR0T+1120                                                07796000
         DC    CL80' '                                                  07797000
         ORG   TR0T+1200                                                07798000
         DC    CL80' '                                                  07799000
         ORG   TR0T+1280                                                07800000
         DC    CL80' '                                                  07801000
         ORG   TR0T+1360                                                07802000
         DC    CL80' '                                                  07803000
         ORG   TR0T+1440                                                07804000
         DC    CL80' '                                                  07805000
         ORG   TR0T+1520                                                07806000
         DC    CL80' '                                                  07807000
         ORG   TR0T+1600                                                07808000
         DC    CL80' '                                                  07809000
         ORG   TR0T+1680                                                07810000
         DC    CL80' '                                                  07811000
         ORG   TR0T+1760                                                07812000
REPTAB   DC    CL47' '                                                  07813000
         ORG   REPTAB+0                                                 07814000
REPDSID  DS    CL8                                                      07815000
REPBLKLN DS    CL5                                                      07816000
REPBOE   DS    CL5                                                      07817000
         ORG   REPBOE+0                                                 07818000
REPBOETT DS    CL2                                                      07819000
REPBOE0  DS    CL1                                                      07820000
REPBOESS DS    CL2                                                      07821000
         ORG   REPTAB+18                                                07822000
REPEOE   DS    CL5                                                      07823000
         ORG   REPEOE+0                                                 07824000
REPEOETT DS    CL2                                                      07825000
REPEOE0  DS    CL1                                                      07826000
REPEOESS DS    CL2                                                      07827000
         ORG   REPTAB+23                                                07828000
REPEOD   DS    CL5                                                      07829000
         ORG   REPEOD+0                                                 07830000
REPEODTT DS    CL2                                                      07831000
REPEOD0  DS    CL1                                                      07832000
REPEODSS DS    CL2                                                      07833000
         ORG   REPTAB+28                                                07834000
REPBYPAS DS    CL1                                                      07835000
REPDSS   DS    CL1                                                      07836000
REPWP    DS    CL1                                                      07837000
REPVER   DS    CL1                                                      07838000
REPCONT  DS    CL1                                                      07839000
REPSEQ#  DS    CL2                                                      07840000
         ORG   REPSEQ#+0                                                07841000
REPSEQ#1 DS    CL1                                                      07842000
REPSEQ#2 DS    CL1                                                      07843000
         ORG   REPTAB+35                                                07844000
REPCREAT DS    CL6                                                      07845000
REPEXPIR DS    CL6                                                      07846000
         ORG   REPTAB+47                                                07847000
         DC    CL47' '                                                  07848000
         ORG   REPTAB+94                                                07849000
         DC    CL47' '                                                  07850000
         ORG   REPTAB+141                                               07851000
         DC    CL47' '                                                  07852000
         ORG   REPTAB+188                                               07853000
         DC    CL47' '                                                  07854000
         ORG   REPTAB+235                                               07855000
         DC    CL47' '                                                  07856000
         ORG   REPTAB+282                                               07857000
         DC    CL47' '                                                  07858000
         ORG   REPTAB+329                                               07859000
         DC    CL47' '                                                  07860000
         ORG   REPTAB+376                                               07861000
         DC    CL47' '                                                  07862000
         ORG   REPTAB+423                                               07863000
         DC    CL47' '                                                  07864000
         ORG   REPTAB+470                                               07865000
         DC    CL47' '                                                  07866000
         ORG   REPTAB+517                                               07867000
         DC    CL47' '                                                  07868000
         ORG   REPTAB+564                                               07869000
         DC    CL47' '                                                  07870000
         ORG   REPTAB+611                                               07871000
         DC    CL47' '                                                  07872000
         ORG   REPTAB+658                                               07873000
         DC    CL47' '                                                  07874000
         ORG   REPTAB+705                                               07875000
         DC    CL47' '                                                  07876000
         ORG   REPTAB+752                                               07877000
         DC    CL47' '                                                  07878000
         ORG   REPTAB+799                                               07879000
         DC    CL47' '                                                  07880000
         ORG   REPTAB+846                                               07881000
         DC    CL47' '                                                  07882000
         ORG   REPTAB+893                                               07883000
NUMTAB   DC    19XL1'5C'                                                07884000
DELTAB   DC    19XL1'5C'                                                07885000
         DS    CL1                                                      07886000
NLPYRTBL DC    H'0'                                                     07887000
         DC    H'31'                                                    07888000
         DC    H'59'                                                    07889000
         DC    H'90'                                                    07890000
         DC    H'120'                                                   07891000
         DC    H'151'                                                   07892000
         DC    H'181'                                                   07893000
         DC    H'212'                                                   07894000
         DC    H'243'                                                   07895000
         DC    H'273'                                                   07896000
         DC    H'304'                                                   07897000
         DC    H'334'                                                   07898000
LPYRTBL  DC    H'0'                                                     07899000
         DC    H'31'                                                    07900000
         DC    H'60'                                                    07901000
         DC    H'91'                                                    07902000
         DC    H'121'                                                   07903000
         DC    H'152'                                                   07904000
         DC    H'182'                                                   07905000
         DC    H'213'                                                   07906000
         DC    H'244'                                                   07907000
         DC    H'274'                                                   07908000
         DC    H'305'                                                   07909000
         DC    H'335'                                                   07910000
CP0001@  DC    AL4(VOL)                                                 07911000
         DC    AL4(DS)                                                  07912000
         DC    AL4(BAD)                                                 07913000
         DC    AL4(EODAD)                                               07914000
         DC    AL4(SYNAD)                                               07915000
IEBDISKT CSECT                                                          07916000
*                                                          /*@Y30OE72*/ 07917000
IEB502A  WTOR  'IEB502D MOUNT OUTPUT DISKETTE ON DDD',                 C07918000
               ROUTCDE=(1,7),DESC=7,MF=L,REPLY,1,WTORECB       @Y30OE72 07919000
IEB503A  WTOR  'IEB503D DDD - UNEXPIRED FILES ON OUTPUT DISKETTE',     C07920000
               ROUTCDE=(1,7,9),DESC=7,MF=L,REPLY,1,WTORECB     @Y30OE72 07921000
IEB517A  WTOR  'IEB517D DDD - PROTECTED FILES ON OUTPUT DISKETTE',     C07922000
               ROUTCDE=(1,7,9),DESC=7,MF=L,REPLY,1,WTORECB     @Y30OE72 07923000
IEB518A  WTOR  'IEB518D DDD - SECURE INPUT  DISKETTE',                 C07924000
               ROUTCDE=(1,7,9),DESC=7,MF=L,REPLY,5,WTORECB     @Y30OE72 07925000
IEBDISKT CSECT                                                          07926000
*                                     /*                     @Z30OE72*/ 07927000
SYSPRINT DCB   DSORG=PS,MACRF=PM,DDNAME=SYSPRINT,RECFM=FB,LRECL=121,   C07928000
               SYNAD=SYSPTERR,EXLST=SYSPEXIT                   @Y30OE72 07929000
SYSIN    DCB   DSORG=PS,MACRF=GM,DDNAME=SYSIN,EODAD=EODSYSIN,RECFM=FB, C07930000
               SYNAD=SYSINERR,EXLST=SYSPEXIT,LRECL=80          @Y30OE72 07931000
SYSUT1   DCB   DDNAME=SYSUT1,MACRF=(E),XENDA=VV,EXLST=ABNDEXT  @Z30OE72 07932000
SYSUT2EX DCB   DDNAME=SYSUT2,MACRF=(E),XENDA=VV,EXLST=ABNDEXT  @Z30OE72 07933000
SYSUT2QS DCB   DSORG=PS,MACRF=PM,DDNAME=SYSUT2,RECFM=FB,LRECL=128,     C07934000
               SYNAD=SYNADQS,EXLST=OPENEXIT,BUFNO=1            @Y30OE72 07935000
SYSUT2IN DCB   DSORG=PS,MACRF=GM,DDNAME=SYSUT2,RECFM=FB,LRECL=128,     C07936000
               SYNAD=SYNADIN,EXLST=OPENEXIT                    @Y30OE72 07937000
MT3540AR DC    200F'-1'                SERVICE AREA            @Y30OE72 07938000
IEBDISKT CSECT                                                          07939000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07940000
@01      EQU   01                                                       07941000
@02      EQU   02                                                       07942000
@03      EQU   03                                                       07943000
@04      EQU   04                                                       07944000
@05      EQU   05                                                       07945000
@06      EQU   06                                                       07946000
@07      EQU   07                                                       07947000
@08      EQU   08                                                       07948000
@09      EQU   09                                                       07949000
@10      EQU   10                                                       07950000
@11      EQU   11                                                       07951000
@12      EQU   12                                                       07952000
@13      EQU   13                                                       07953000
@14      EQU   14                                                       07954000
@15      EQU   15                                                       07955000
K        EQU   @03                                                      07956000
LETPTR   EQU   @03                                                      07957000
DAY1     EQU   @03                                                      07958000
JULIANDY EQU   @03                                                      07959000
DATEPTR  EQU   @03                                                      07960000
CASESELT EQU   @03                                                      07961000
B        EQU   @03                                                      07962000
SAVE1    EQU   @03                                                      07963000
Q        EQU   @03                                                      07964000
DEBPTR   EQU   @03                                                      07965000
REG1     EQU   @01                                                      07966000
AREAADDR EQU   @02                                                      07967000
EXITADDR EQU   @02                                                      07968000
SVARREG  EQU   @13                                                      07969000
LOCKADDR EQU   @11                                                      07970000
CVTPTR   EQU   16                                                       07971000
PSA      EQU   0                                                        07972000
FLCRNPSW EQU   PSA                                                      07973000
FLCROPSW EQU   PSA+8                                                    07974000
FLCICCW2 EQU   PSA+16                                                   07975000
PSAEEPSW EQU   PSA+132                                                  07976000
PSAESPSW EQU   PSA+136                                                  07977000
FLCSVILC EQU   PSAESPSW+1                                               07978000
PSAEPPSW EQU   PSA+140                                                  07979000
FLCPIILC EQU   PSAEPPSW+1                                               07980000
FLCPICOD EQU   PSAEPPSW+2                                               07981000
PSAPICOD EQU   FLCPICOD+1                                               07982000
FLCTEA   EQU   PSAEPPSW+4                                               07983000
FLCPER   EQU   PSA+152                                                  07984000
FLCMCLA  EQU   PSA+168                                                  07985000
FLCIOEL  EQU   FLCMCLA+4                                                07986000
FLCIOA   EQU   FLCMCLA+16                                               07987000
FLCFSA   EQU   FLCMCLA+80                                               07988000
PSASUPER EQU   PSA+552                                                  07989000
PSASUP1  EQU   PSASUPER                                                 07990000
PSASUP2  EQU   PSASUPER+1                                               07991000
PSASUP3  EQU   PSASUPER+2                                               07992000
PSASUP4  EQU   PSASUPER+3                                               07993000
PSACLHT  EQU   PSA+640                                                  07994000
PSALKSA  EQU   PSA+696                                                  07995000
PSAHLHI  EQU   PSA+760                                                  07996000
PSADSSFL EQU   PSA+836                                                  07997000
PSADSSF1 EQU   PSADSSFL                                                 07998000
PSADSSF3 EQU   PSADSSFL+2                                               07999000
PSADSSF4 EQU   PSADSSFL+3                                               08000000
PSARSVT  EQU   PSA+896                                                  08001000
IHADCB   EQU   0                                                        08002000
IHADCS00 EQU   0                                                        08003000
DCBFDAD  EQU   IHADCS00+5                                               08004000
IHADCS01 EQU   0                                                        08005000
DCBDVTBL EQU   IHADCS01                                                 08006000
IHADCS11 EQU   0                                                        08007000
DCBRELB  EQU   IHADCS11                                                 08008000
DCBREL   EQU   DCBRELB+1                                                08009000
DCBBUFCB EQU   IHADCS11+4                                               08010000
DCBDSORG EQU   IHADCS11+10                                              08011000
DCBDSRG1 EQU   DCBDSORG                                                 08012000
DCBDSRG2 EQU   DCBDSORG+1                                               08013000
DCBIOBAD EQU   IHADCS11+12                                              08014000
DCBODEB  EQU   DCBIOBAD                                                 08015000
DCBLNP   EQU   DCBODEB                                                  08016000
DCBQSLM  EQU   DCBLNP                                                   08017000
DCBIOBAA EQU   DCBODEB+1                                                08018000
IHADCS50 EQU   0                                                        08019000
DCBSVCXL EQU   IHADCS50                                                 08020000
DCBEODAD EQU   IHADCS50+4                                               08021000
DCBBFALN EQU   DCBEODAD                                                 08022000
DCBHIARC EQU   DCBBFALN                                                 08023000
DCBBFTEK EQU   DCBHIARC                                                 08024000
DCBBFT   EQU   DCBBFTEK                                                 08025000
DCBEXLST EQU   IHADCS50+8                                               08026000
DCBRECFM EQU   DCBEXLST                                                 08027000
DCBRECLA EQU   DCBRECFM                                                 08028000
IHADCS24 EQU   0                                                        08029000
DCBOFLGS EQU   IHADCS24+8                                               08030000
DCBOFLWR EQU   DCBOFLGS                                                 08031000
DCBOFOPN EQU   DCBOFLGS                                                 08032000
DCBIFLG  EQU   IHADCS24+9                                               08033000
DCBMACR  EQU   IHADCS24+10                                              08034000
DCBMACR1 EQU   DCBMACR                                                  08035000
DCBMRFE  EQU   DCBMACR1                                                 08036000
DCBMRGET EQU   DCBMRFE                                                  08037000
DCBMRAPG EQU   DCBMACR1                                                 08038000
DCBMRRD  EQU   DCBMRAPG                                                 08039000
DCBMRCI  EQU   DCBMACR1                                                 08040000
DCBMRMVG EQU   DCBMRCI                                                  08041000
DCBMRLCG EQU   DCBMACR1                                                 08042000
DCBMRABC EQU   DCBMACR1                                                 08043000
DCBMRPT1 EQU   DCBMRABC                                                 08044000
DCBMRSBG EQU   DCBMRPT1                                                 08045000
DCBMRCRL EQU   DCBMACR1                                                 08046000
DCBMRCHK EQU   DCBMRCRL                                                 08047000
DCBMRRDX EQU   DCBMRCHK                                                 08048000
DCBMRDMG EQU   DCBMACR1                                                 08049000
DCBMACR2 EQU   DCBMACR+1                                                08050000
DCBMRPUT EQU   DCBMACR2                                                 08051000
DCBMRWRT EQU   DCBMACR2                                                 08052000
DCBMRMVP EQU   DCBMACR2                                                 08053000
DCBMR5WD EQU   DCBMACR2                                                 08054000
DCBMRLDM EQU   DCBMR5WD                                                 08055000
DCBMRLCP EQU   DCBMRLDM                                                 08056000
DCBMR4WD EQU   DCBMACR2                                                 08057000
DCBMRPT2 EQU   DCBMR4WD                                                 08058000
DCBMRTMD EQU   DCBMRPT2                                                 08059000
DCBMR3WD EQU   DCBMACR2                                                 08060000
DCBMRCTL EQU   DCBMR3WD                                                 08061000
DCBMRSTK EQU   DCBMRCTL                                                 08062000
DCBMR1WD EQU   DCBMACR2                                                 08063000
DCBMRSWA EQU   DCBMR1WD                                                 08064000
DCBMRDMD EQU   DCBMRSWA                                                 08065000
IHADCS25 EQU   0                                                        08066000
DCBMACRF EQU   IHADCS25+2                                               08067000
DCBMACF1 EQU   DCBMACRF                                                 08068000
DCBMFFE  EQU   DCBMACF1                                                 08069000
DCBMFGET EQU   DCBMFFE                                                  08070000
DCBMFAPG EQU   DCBMACF1                                                 08071000
DCBMFRD  EQU   DCBMFAPG                                                 08072000
DCBMFCI  EQU   DCBMACF1                                                 08073000
DCBMFMVG EQU   DCBMFCI                                                  08074000
DCBMFLCG EQU   DCBMACF1                                                 08075000
DCBMFABC EQU   DCBMACF1                                                 08076000
DCBMFPT1 EQU   DCBMFABC                                                 08077000
DCBMFSBG EQU   DCBMFPT1                                                 08078000
DCBMFCRL EQU   DCBMACF1                                                 08079000
DCBMFCHK EQU   DCBMFCRL                                                 08080000
DCBMFDMG EQU   DCBMACF1                                                 08081000
DCBMACF2 EQU   DCBMACRF+1                                               08082000
DCBMFPUT EQU   DCBMACF2                                                 08083000
DCBMFWRT EQU   DCBMACF2                                                 08084000
DCBMFMVP EQU   DCBMACF2                                                 08085000
DCBMF5WD EQU   DCBMACF2                                                 08086000
DCBMFLDM EQU   DCBMF5WD                                                 08087000
DCBMFLCP EQU   DCBMFLDM                                                 08088000
DCBMF4WD EQU   DCBMACF2                                                 08089000
DCBMFPT2 EQU   DCBMF4WD                                                 08090000
DCBMFTMD EQU   DCBMFPT2                                                 08091000
DCBMF3WD EQU   DCBMACF2                                                 08092000
DCBMFCTL EQU   DCBMF3WD                                                 08093000
DCBMFSTK EQU   DCBMFCTL                                                 08094000
DCBMF1WD EQU   DCBMACF2                                                 08095000
DCBMFSWA EQU   DCBMF1WD                                                 08096000
DCBMFDMD EQU   DCBMFSWA                                                 08097000
DCBDEBAD EQU   IHADCS25+4                                               08098000
DCBIFLGS EQU   DCBDEBAD                                                 08099000
DCBIFEC  EQU   DCBIFLGS                                                 08100000
DCBDEBA  EQU   DCBDEBAD+1                                               08101000
IHADCS26 EQU   0                                                        08102000
DCBWRITE EQU   IHADCS26                                                 08103000
DCBREAD  EQU   DCBWRITE                                                 08104000
DCBWRITA EQU   DCBREAD+1                                                08105000
IHADCS27 EQU   0                                                        08106000
DCBGET   EQU   IHADCS27                                                 08107000
DCBPUT   EQU   DCBGET                                                   08108000
DCBGETA  EQU   DCBPUT+1                                                 08109000
IHADCS36 EQU   0                                                        08110000
DCBGERR  EQU   IHADCS36                                                 08111000
DCBPERR  EQU   DCBGERR                                                  08112000
DCBCHECK EQU   DCBPERR                                                  08113000
DCBOPTCD EQU   DCBCHECK                                                 08114000
DCBOPTH  EQU   DCBOPTCD                                                 08115000
DCBOPTO  EQU   DCBOPTH                                                  08116000
DCBOPTZ  EQU   DCBOPTCD                                                 08117000
DCBGERRA EQU   DCBCHECK+1                                               08118000
DCBPERRA EQU   DCBGERRA                                                 08119000
DCBSYNAD EQU   IHADCS36+4                                               08120000
DCBCIND1 EQU   IHADCS36+8                                               08121000
DCBCIND2 EQU   IHADCS36+9                                               08122000
DCBBLKSI EQU   IHADCS36+10                                              08123000
DCBIOBA  EQU   IHADCS36+16                                              08124000
DCBCICB  EQU   DCBIOBA                                                  08125000
IHADCS52 EQU   0                                                        08126000
DCBDIRCT EQU   IHADCS52                                                 08127000
DCBQSWS  EQU   DCBDIRCT                                                 08128000
DCBUSASI EQU   DCBQSWS                                                  08129000
DCBQADFS EQU   DCBUSASI                                                 08130000
DCBBUFOF EQU   DCBDIRCT+1                                               08131000
IHADCS37 EQU   0                                                        08132000
DCBFLAG1 EQU   IHADCS37                                                 08133000
IHADCS38 EQU   0                                                        08134000
DCBEOBR  EQU   IHADCS38                                                 08135000
DCBLRECL EQU   IHADCS38+10                                              08136000
DCBPOINT EQU   IHADCS38+12                                              08137000
DCBCNTRL EQU   DCBPOINT                                                 08138000
IHADCS40 EQU   0                                                        08139000
DCBEOBAD EQU   IHADCS40                                                 08140000
DCBCCCW  EQU   IHADCS40+4                                               08141000
DCBRECAD EQU   DCBCCCW                                                  08142000
DCBRECBT EQU   DCBRECAD                                                 08143000
DCBRCREL EQU   DCBRECBT                                                 08144000
@NM00025 EQU   IHADCS40+12                                              08145000
DCBEROPT EQU   @NM00025                                                 08146000
TIOT1    EQU   0                                                        08147000
UCB      EQU   0                                                        08148000
UCBLOCK  EQU   UCB+504                                                  08149000
UCBOB    EQU   0                                                        08150000
UCBJBNR  EQU   UCBOB                                                    08151000
UCBFL5   EQU   UCBOB+1                                                  08152000
UCBAF    EQU   UCBFL5                                                   08153000
UCBSTAT  EQU   UCBOB+3                                                  08154000
UCBCHAN  EQU   UCBOB+4                                                  08155000
UCBSFLS  EQU   UCBOB+6                                                  08156000
UCBFLA   EQU   UCBSFLS                                                  08157000
UCBFL1   EQU   UCBFLA                                                   08158000
UCBBSY   EQU   UCBFL1                                                   08159000
UCBNRY   EQU   UCBFL1                                                   08160000
UCBPST   EQU   UCBFL1                                                   08161000
UCBCUB   EQU   UCBFL1                                                   08162000
UCBFLB   EQU   UCBSFLS+1                                                08163000
UCBCHM   EQU   UCBOB+8                                                  08164000
UCBCHM1  EQU   UCBCHM                                                   08165000
UCBPTH0  EQU   UCBCHM1                                                  08166000
UCBPTH1  EQU   UCBCHM1                                                  08167000
UCBWGT   EQU   UCBOB+12                                                 08168000
UCBNAME  EQU   UCBOB+13                                                 08169000
UCBTYP   EQU   UCBOB+16                                                 08170000
UCBTBYT1 EQU   UCBTYP                                                   08171000
UCB1FEA5 EQU   UCBTBYT1                                                 08172000
UCB1FEA6 EQU   UCBTBYT1                                                 08173000
UCBTBYT2 EQU   UCBTYP+1                                                 08174000
UCB2OPT2 EQU   UCBTBYT2                                                 08175000
UCBDUDN1 EQU   UCB2OPT2                                                 08176000
UCB2OPT3 EQU   UCBTBYT2                                                 08177000
UCBDUDN2 EQU   UCB2OPT3                                                 08178000
UCB2OPT4 EQU   UCBTBYT2                                                 08179000
UCBRWTAU EQU   UCB2OPT4                                                 08180000
UCB2OPT6 EQU   UCBTBYT2                                                 08181000
UCB2OPT7 EQU   UCBTBYT2                                                 08182000
UCBTBYT3 EQU   UCBTYP+2                                                 08183000
UCBDVCLS EQU   UCBTBYT3                                                 08184000
UCB3DACC EQU   UCBDVCLS                                                 08185000
UCBTBYT4 EQU   UCBTYP+3                                                 08186000
UCBEXTPT EQU   UCBOB+20                                                 08187000
UCBFLC   EQU   UCBEXTPT                                                 08188000
UCBDEV   EQU   UCBOB+24                                                 08189000
UCBCMEXT EQU   0                                                        08190000
UCBATI   EQU   UCBCMEXT+3                                               08191000
@NM00034 EQU   UCBATI                                                   08192000
UCBFLP1  EQU   UCBCMEXT+5                                               08193000
UCBMT    EQU   0                                                        08194000
UCBOCR   EQU   0                                                        08195000
UCB3540X EQU   0                                                        08196000
UCBVLSER EQU   UCB3540X                                                 08197000
UCBDKBYT EQU   UCB3540X+6                                               08198000
UCBUCS   EQU   0                                                        08199000
UCBUCSOP EQU   UCBUCS+4                                                 08200000
UCBFCBOP EQU   UCBUCS+5                                                 08201000
CVTMAP   EQU   0                                                        08202000
CVTDAR   EQU   CVTMAP+72                                                08203000
CVTFLGS1 EQU   CVTDAR                                                   08204000
CVTDCB   EQU   CVTMAP+116                                               08205000
CVTIERLC EQU   CVTMAP+144                                               08206000
CVTOPTA  EQU   CVTMAP+182                                               08207000
CVTOPTB  EQU   CVTMAP+183                                               08208000
CVTGTF   EQU   CVTMAP+236                                               08209000
CVTGTFST EQU   CVTGTF                                                   08210000
CVTGTFS  EQU   CVTGTFST                                                 08211000
CVTSTATE EQU   CVTGTFST                                                 08212000
CVTTMODE EQU   CVTGTFST                                                 08213000
CVTFORM  EQU   CVTGTFST                                                 08214000
CVTAQAVT EQU   CVTMAP+240                                               08215000
CVTTCMFG EQU   CVTAQAVT                                                 08216000
CVTVOLM2 EQU   CVTMAP+244                                               08217000
CVTTATA  EQU   CVTVOLM2                                                 08218000
CVTTSKS  EQU   CVTTATA                                                  08219000
CVTVOLF2 EQU   CVTTSKS                                                  08220000
CVTTAT   EQU   CVTTATA+1                                                08221000
CVTATER  EQU   CVTMAP+248                                               08222000
CVTEXT1  EQU   CVTMAP+252                                               08223000
CVTPURG  EQU   CVTMAP+260                                               08224000
CVTQMSG  EQU   CVTMAP+268                                               08225000
CVTDMSR  EQU   CVTMAP+272                                               08226000
CVTERPV  EQU   CVTMAP+316                                               08227000
CVTINTLA EQU   CVTMAP+320                                               08228000
CVTAPF   EQU   CVTMAP+324                                               08229000
CVTEXT2  EQU   CVTMAP+328                                               08230000
CVTHJES  EQU   CVTMAP+332                                               08231000
CVTPGSIA EQU   CVTMAP+348                                               08232000
CVTA1F1  EQU   CVTMAP+356                                               08233000
CVTSYSK  EQU   CVTMAP+357                                               08234000
CVTVOLM1 EQU   CVTMAP+380                                               08235000
CVTVOLF1 EQU   CVTVOLM1                                                 08236000
CVTATMCT EQU   CVTMAP+388                                               08237000
CVTXTNT1 EQU   0                                                        08238000
CVTXTNT2 EQU   0                                                        08239000
CVTDSSV  EQU   CVTXTNT2                                                 08240000
CVTFLGBT EQU   CVTXTNT2+5                                               08241000
CVTQID   EQU   CVTXTNT2+24                                              08242000
CVTRV400 EQU   CVTXTNT2+52                                              08243000
CVTRV409 EQU   CVTXTNT2+53                                              08244000
CVTATCVT EQU   CVTXTNT2+64                                              08245000
CVTRV429 EQU   CVTXTNT2+84                                              08246000
CVTRV438 EQU   CVTXTNT2+85                                              08247000
CVTRV457 EQU   CVTXTNT2+112                                             08248000
CVTRV466 EQU   CVTXTNT2+113                                             08249000
CVTFIX   EQU   0                                                        08250000
CVTRELNO EQU   CVTFIX+252                                               08251000
DEBBASIC EQU   0                                                        08252000
DEBTCBAD EQU   DEBBASIC                                                 08253000
DEBDEBAD EQU   DEBBASIC+4                                               08254000
DEBIRBAD EQU   DEBBASIC+8                                               08255000
DEBOFLGS EQU   DEBIRBAD                                                 08256000
DEBIRBB  EQU   DEBIRBAD+1                                               08257000
DEBOPATB EQU   DEBBASIC+12                                              08258000
DEBFLGS1 EQU   DEBBASIC+14                                              08259000
DEBUSRPG EQU   DEBBASIC+16                                              08260000
DEBRRQ   EQU   DEBBASIC+20                                              08261000
DEBECBAD EQU   DEBRRQ                                                   08262000
DEBDCBAD EQU   DEBBASIC+24                                              08263000
DEBPROTG EQU   DEBDCBAD                                                 08264000
DEBAPPAD EQU   DEBBASIC+28                                              08265000
DEBBASND EQU   DEBBASIC+32                                              08266000
DEBDASD  EQU   0                                                        08267000
DEBUCBAD EQU   DEBDASD                                                  08268000
DEBACSMD EQU   0                                                        08269000
DEBVOLSQ EQU   DEBACSMD                                                 08270000
DEBVOLBT EQU   DEBVOLSQ                                                 08271000
DEBDSNM  EQU   DEBACSMD+4                                               08272000
DEBUTSAA EQU   DEBDSNM                                                  08273000
DEBACS01 EQU   0                                                        08274000
DEBDSNAM EQU   DEBACS01                                                 08275000
DEBACS02 EQU   0                                                        08276000
DEBDBLK  EQU   DEBACS02                                                 08277000
DEBACS03 EQU   0                                                        08278000
DEBACS04 EQU   0                                                        08279000
DEBTBFRA EQU   DEBACS04                                                 08280000
DEBTCCWA EQU   DEBACS04+4                                               08281000
DEBACS05 EQU   0                                                        08282000
DEBFUCBA EQU   DEBACS05                                                 08283000
DEBLUCBA EQU   DEBACS05+4                                               08284000
DEBACS06 EQU   0                                                        08285000
DEBACS07 EQU   0                                                        08286000
DEBACS08 EQU   0                                                        08287000
DEBSUBNM EQU   0                                                        08288000
DEB      EQU   0                                                        08289000
DEBAVT   EQU   DEB                                                      08290000
DEBEOEA  EQU   DEBAVT                                                   08291000
DEBEOEAB EQU   DEBEOEA                                                  08292000
DEBSIOA  EQU   DEBAVT+4                                                 08293000
DEBSIOAB EQU   DEBSIOA                                                  08294000
DEBPCIA  EQU   DEBAVT+8                                                 08295000
DEBPCIAB EQU   DEBPCIA                                                  08296000
DEBCEA   EQU   DEBAVT+12                                                08297000
DEBCEAB  EQU   DEBCEA                                                   08298000
DEBXCEA  EQU   DEBAVT+16                                                08299000
DEBXCEAB EQU   DEBXCEA                                                  08300000
DEBPREFX EQU   DEB+20                                                   08301000
DEBXTNP  EQU   DEBPREFX+8                                               08302000
DEBXTN   EQU   0                                                        08303000
DEBXFLG1 EQU   DEBXTN+2                                                 08304000
LL       EQU   28                                                       08305000
UL       EQU   34                                                       08306000
DATEMAP  EQU   0                                                        08307000
DATEYY   EQU   DATEMAP                                                  08308000
DATEMM   EQU   DATEMAP+2                                                08309000
DATEDD   EQU   DATEMAP+4                                                08310000
HDRI     EQU   0                                                        08311000
MSGTEXT  EQU   0                                                        08312000
DAYTABLE EQU   0                                                        08313000
TRANSTBL EQU   DAYTABLE                                                 08314000
LETTER   EQU   0                                                        08315000
RECBUF   EQU   0                                                        08316000
DATABYT1 EQU   RECBUF                                                   08317000
HDRWTPTI EQU   RECBUF+42                                                08318000
HDREXDTE EQU   RECBUF+66                                                08319000
HDRYEAR  EQU   HDREXDTE                                                 08320000
HDRMONTH EQU   HDREXDTE+2                                               08321000
HDRDAY   EQU   HDREXDTE+4                                               08322000
LISTENT  EQU   0                                                        08323000
OPTBYTE  EQU   LISTENT                                                  08324000
LISTEND  EQU   OPTBYTE                                                  08325000
LISTDCB@ EQU   LISTENT+1                                                08326000
BUFFAREA EQU   0                                                        08327000
CURCCW   EQU   0                                                        08328000
CURCCWOP EQU   CURCCW                                                   08329000
CCWWTADD EQU   CURCCW+1                                                 08330000
NOOPCCW  EQU   0                                                        08331000
ABPARM   EQU   0                                                        08332000
OPTMASK  EQU   ABPARM+3                                                 08333000
OKIGNORE EQU   OPTMASK                                                  08334000
MAP502A  EQU   0                                                        08335000
I502DEV  EQU   MAP502A+45                                               08336000
MAP503A  EQU   0                                                        08337000
I503DEV  EQU   MAP503A+20                                               08338000
MAP517A  EQU   0                                                        08339000
I517DEV  EQU   MAP517A+20                                               08340000
MAP518A  EQU   0                                                        08341000
I518DEV  EQU   MAP518A+20                                               08342000
I518INOT EQU   MAP518A+33                                               08343000
HEADER1  EQU   0                                                        08344000
DSI      EQU   HEADER1+5                                                08345000
BL       EQU   HEADER1+22                                               08346000
BOE      EQU   HEADER1+28                                               08347000
EOE      EQU   HEADER1+34                                               08348000
BI       EQU   HEADER1+40                                               08349000
DSS      EQU   HEADER1+41                                               08350000
WP       EQU   HEADER1+42                                               08351000
EI       EQU   HEADER1+43                                               08352000
MVI      EQU   HEADER1+44                                               08353000
VS#      EQU   HEADER1+45                                               08354000
CRDT     EQU   HEADER1+47                                               08355000
FLAG     EQU   HEADER1+61                                               08356000
ED       EQU   HEADER1+66                                               08357000
VI       EQU   HEADER1+72                                               08358000
EOD      EQU   HEADER1+74                                               08359000
LABELN   EQU   4                                                        08360000
IOBPREFX EQU   0                                                        08361000
IOBECB   EQU   IOBPREFX+4                                               08362000
IOBECBCC EQU   IOBECB                                                   08363000
IOBECBC  EQU   IOBECBCC                                                 08364000
IOBMAP   EQU   0                                                        08365000
IOBSENS0 EQU   IOBMAP+2                                                 08366000
IOBDATAC EQU   IOBSENS0                                                 08367000
IOBSENS1 EQU   IOBMAP+3                                                 08368000
IOBSRECT EQU   IOBSENS1                                                 08369000
IOBDCBPT EQU   IOBMAP+20                                                08370000
IOBDCBPB EQU   IOBDCBPT+1                                               08371000
IOBSKADR EQU   IOBMAP+32                                                08372000
IOBSKTT  EQU   IOBSKADR+1                                               08373000
IOBSKSS  EQU   IOBSKADR+3                                               08374000
IOBIOB@  EQU   IOBMAP+36                                                08375000
READCCW  EQU   IOBMAP+56                                                08376000
CCWRDADD EQU   READCCW+1                                                08377000
OTIOBPRE EQU   0                                                        08378000
OTIOBECB EQU   OTIOBPRE+4                                               08379000
OUTECBCC EQU   OTIOBECB                                                 08380000
OUTECBC  EQU   OUTECBCC                                                 08381000
OTIOBMAP EQU   0                                                        08382000
OUTSKADR EQU   OTIOBMAP+32                                              08383000
OUTSKTT  EQU   OUTSKADR+1                                               08384000
OUTSKSS  EQU   OUTSKADR+3                                               08385000
OTIOBNXT EQU   OTIOBMAP+36                                              08386000
DFOPSOUT EQU   OTIOBMAP+44                                              08387000
DFOPSCNT EQU   DFOPSOUT                                                 08388000
OUTWTCCW EQU   OTIOBMAP+64                                              08389000
OTNOOP   EQU   OTIOBMAP+272                                             08390000
OTNOOPOP EQU   OTNOOP                                                   08391000
CL0001@  EQU   0                                                        08392000
UCBBGN   EQU   0                                                        08393000
TIOENTRY EQU   TIOT1+24                                                 08394000
TIOELNGH EQU   TIOENTRY                                                 08395000
TIOESTTA EQU   TIOENTRY+1                                               08396000
TIOERLOC EQU   TIOENTRY+2                                               08397000
TIOELINK EQU   TIOERLOC+1                                               08398000
TIOESYOT EQU   TIOELINK                                                 08399000
TIOEDDNM EQU   TIOENTRY+4                                               08400000
TIOESTTC EQU   TIOENTRY+15                                              08401000
TIOESTTB EQU   TIOENTRY+16                                              08402000
TIOEFSRT EQU   TIOENTRY+17                                              08403000
POOLSTAR EQU   TIOENTRY+20                                              08404000
TIOEDEVE EQU   TIOESTTB                                                 08405000
TIOSTTB  EQU   TIOEDEVE                                                 08406000
UCBOBS01 EQU   UCBDEV                                                   08407000
UCBSTAB  EQU   UCBOBS01+10                                              08408000
UCBBSVL  EQU   UCBSTAB                                                  08409000
UCBPRSRS EQU   UCBSTAB                                                  08410000
UCBDMCT  EQU   UCBOBS01+11                                              08411000
UCBFL4   EQU   UCBOBS01+13                                              08412000
UCBOBS02 EQU   UCBDEV                                                   08413000
UCBTFL1  EQU   UCBOBS02+19                                              08414000
UCBXTN   EQU   UCBOBS02+20                                              08415000
UCBVOPT  EQU   UCBXTN                                                   08416000
UCBOBS03 EQU   UCBDEV                                                   08417000
UCBXTADR EQU   UCBOBS03                                                 08418000
UCBOBS04 EQU   UCBDEV                                                   08419000
UCBBTA   EQU   UCBOBS04+12                                              08420000
UCBOBS06 EQU   UCBDEV                                                   08421000
UCBAOF   EQU   UCBOBS06                                                 08422000
UCBAOF1  EQU   UCBAOF                                                   08423000
UCBAOF2  EQU   UCBAOF+1                                                 08424000
@NM00033 EQU   UCBOBS06+3                                               08425000
UCBIRB   EQU   UCBOBS06+4                                               08426000
UCBGRAF  EQU   UCBIRB                                                   08427000
UCBLDNCA EQU   UCBOBS06+8                                               08428000
UCBRDYQ  EQU   UCBLDNCA                                                 08429000
UCBIRLN  EQU   UCBRDYQ                                                  08430000
UCBLDNCB EQU   UCBRDYQ+1                                                08431000
UCBCTLNK EQU   UCBOBS06+12                                              08432000
UCBOBS07 EQU   UCBDEV                                                   08433000
UCBOBS08 EQU   UCBDEV                                                   08434000
UCBOBS09 EQU   UCBDEV                                                   08435000
CVTS01   EQU   CVTPGSIA                                                 08436000
CVTLPDIA EQU   CVTS01+12                                                08437000
CVTDIRST EQU   CVTLPDIA                                                 08438000
CVTSLIDA EQU   CVTS01+24                                                08439000
CVTCTLFG EQU   CVTS01+50                                                08440000
CVTRV210 EQU   CVTS01+424                                               08441000
CVTRV219 EQU   CVTS01+425                                               08442000
CVTRV228 EQU   CVTS01+426                                               08443000
CVTRV237 EQU   CVTS01+427                                               08444000
CVTMFRTR EQU   CVTS01+452                                               08445000
CVTRV262 EQU   CVTS01+468                                               08446000
CVTRV271 EQU   CVTS01+469                                               08447000
CVTRV280 EQU   CVTS01+470                                               08448000
CVTRV289 EQU   CVTS01+471                                               08449000
CVTGSDA  EQU   CVTS01+600                                               08450000
PSARSVTE EQU   PSARSVT                                                  08451000
DEBBAS02 EQU   DEBBASND                                                 08452000
DEBDDS1  EQU   DEBBAS02                                                 08453000
DEBSUCBA EQU   DEBDDS1                                                  08454000
DEBDEVED EQU   DEBDDS1+4                                                08455000
DEBRDCB  EQU   DEBDDS1+4                                                08456000
DEBPDCB  EQU   DEBDDS1+8                                                08457000
DEBWDCB  EQU   DEBDDS1+12                                               08458000
DEBACS09 EQU   DEBDEVED                                                 08459000
DEBASC09 EQU   DEBACS09                                                 08460000
DEBEAMFG EQU   DEBASC09+3                                               08461000
DEBDSID  EQU   DEBASC09+4                                               08462000
DEBEOD   EQU   DEBASC09+12                                              08463000
DEBBOE   EQU   DEBEOD                                                   08464000
DEBEODRV EQU   DEBBOE                                                   08465000
DEBEODTT EQU   DEBBOE+1                                                 08466000
DEBEOD0  EQU   DEBBOE+2                                                 08467000
DEBEODSS EQU   DEBBOE+3                                                 08468000
DEBBAS01 EQU   DEBBASND                                                 08469000
DEBISAM  EQU   DEBBAS01                                                 08470000
DEBFIEAD EQU   DEBISAM                                                  08471000
DEBFPEAD EQU   DEBISAM+4                                                08472000
DEBFOEAD EQU   DEBISAM+8                                                08473000
DEBEXPT  EQU   DEBISAM+12                                               08474000
DEBRPSID EQU   DEBEXPT                                                  08475000
SET      EQU   HEX01                                                    08476000
ON       EQU   HEX01                                                    08477000
NOTSET   EQU   HEX00                                                    08478000
OFF      EQU   HEX00                                                    08479000
CHARAST  EQU   AST2                                                     08480000
SECTOR1  EQU   HEX01                                                    08481000
SECTOR2  EQU   HEX02                                                    08482000
TRACK0   EQU   HEX00                                                    08483000
IPLREC1  EQU   HEX01                                                    08484000
IPLREC2  EQU   HEX02                                                    08485000
WORKA    EQU   WORK1                                                    08486000
WORKB    EQU   WORK2                                                    08487000
WORKC    EQU   WORK3                                                    08488000
TEMPEXT  EQU   CARD                                                     08489000
TEMPBOE  EQU   TEMPEXT                                                  08490000
TEMPEOE  EQU   TEMPEXT+5                                                08491000
TEMPEOD  EQU   TEMPEXT+10                                               08492000
SAVEREGS EQU   CARD                                                     08493000
VOLAREA  EQU   CARDBUF+5                                                08494000
SAVEUNIT EQU   WORK1                                                    08495000
CLOSLIST EQU   CARDBUF                                                  08496000
FLC      EQU   PSA                                                      08497000
*                                      START UNREFERENCED COMPONENTS    08498000
DEBEXPTA EQU   DEBEXPT+1                                                08499000
DEBRSV12 EQU   DEBRPSID                                                 08500000
DEBRSV11 EQU   DEBRPSID                                                 08501000
DEBRSV10 EQU   DEBRPSID                                                 08502000
DEBRSV09 EQU   DEBRPSID                                                 08503000
DEBRPSAP EQU   DEBRPSID                                                 08504000
DEBRPSO  EQU   DEBRPSID                                                 08505000
DEBRPSI  EQU   DEBRPSID                                                 08506000
DEBRPSP  EQU   DEBRPSID                                                 08507000
DEBFOEB  EQU   DEBFOEAD+1                                               08508000
DEBNOEE  EQU   DEBFOEAD                                                 08509000
DEBFPEB  EQU   DEBFPEAD+1                                               08510000
DEBNPEE  EQU   DEBFPEAD                                                 08511000
DEBFIEB  EQU   DEBFIEAD+1                                               08512000
DEBNIEE  EQU   DEBFIEAD                                                 08513000
DEBBOESS EQU   DEBEODSS                                                 08514000
DEBBOE0  EQU   DEBEOD0                                                  08515000
DEBBOETT EQU   DEBEODTT                                                 08516000
DEBBOERV EQU   DEBEODRV                                                 08517000
DEBRV008 EQU   DEBDSID+7                                                08518000
DEBWTPTI EQU   DEBDSID+6                                                08519000
DEBEXDTE EQU   DEBDSID                                                  08520000
DEBRV007 EQU   DEBEAMFG                                                 08521000
DEBRV006 EQU   DEBEAMFG                                                 08522000
DEBRV005 EQU   DEBEAMFG                                                 08523000
DEBRV004 EQU   DEBEAMFG                                                 08524000
DEBSECVL EQU   DEBEAMFG                                                 08525000
DEBVAMSG EQU   DEBEAMFG                                                 08526000
DEBDSOPN EQU   DEBEAMFG                                                 08527000
DEBMULTI EQU   DEBEAMFG                                                 08528000
DEBVSEQU EQU   DEBASC09+2                                               08529000
DEBDSSQL EQU   DEBASC09+1                                               08530000
DEBVOLAC EQU   DEBASC09                                                 08531000
DEBWDCBA EQU   DEBWDCB+1                                                08532000
DEBRSV08 EQU   DEBWDCB                                                  08533000
DEBPDCBA EQU   DEBPDCB+1                                                08534000
DEBRSV07 EQU   DEBPDCB                                                  08535000
DEBRDCBA EQU   DEBRDCB+1                                                08536000
DEBRSV06 EQU   DEBRDCB                                                  08537000
DEBSUCBB EQU   DEBSUCBA+1                                               08538000
DEBSDVM  EQU   DEBSUCBA                                                 08539000
PSARSAV  EQU   PSARSVTE+60                                              08540000
PSARSTK  EQU   PSARSVTE+56                                              08541000
PSAESAV3 EQU   PSARSVTE+52                                              08542000
PSAESTK3 EQU   PSARSVTE+48                                              08543000
PSAESAV2 EQU   PSARSVTE+44                                              08544000
PSAESTK2 EQU   PSARSVTE+40                                              08545000
PSAESAV1 EQU   PSARSVTE+36                                              08546000
PSAESTK1 EQU   PSARSVTE+32                                              08547000
PSAPSAV  EQU   PSARSVTE+28                                              08548000
PSAPSTK  EQU   PSARSVTE+24                                              08549000
PSAMSAV  EQU   PSARSVTE+20                                              08550000
PSAMSTK  EQU   PSARSVTE+16                                              08551000
PSASSAV  EQU   PSARSVTE+12                                              08552000
PSASSTK  EQU   PSARSVTE+8                                               08553000
PSANSTK  EQU   PSARSVTE+4                                               08554000
PSACSTK  EQU   PSARSVTE                                                 08555000
CVTRV628 EQU   CVTS01+728                                               08556000
CVTRV627 EQU   CVTS01+724                                               08557000
CVTRV626 EQU   CVTS01+720                                               08558000
CVTRV625 EQU   CVTS01+716                                               08559000
CVTRV624 EQU   CVTS01+712                                               08560000
CVTRV623 EQU   CVTS01+708                                               08561000
CVTRV622 EQU   CVTS01+704                                               08562000
CVTRV621 EQU   CVTS01+700                                               08563000
CVTRV620 EQU   CVTS01+696                                               08564000
CVTRV619 EQU   CVTS01+692                                               08565000
CVTRV618 EQU   CVTS01+688                                               08566000
CVTRV617 EQU   CVTS01+684                                               08567000
CVTRV616 EQU   CVTS01+680                                               08568000
CVTRV615 EQU   CVTS01+676                                               08569000
CVTRV614 EQU   CVTS01+672                                               08570000
CVTRV613 EQU   CVTS01+668                                               08571000
CVTRV612 EQU   CVTS01+664                                               08572000
CVTRV611 EQU   CVTS01+660                                               08573000
CVTRV610 EQU   CVTS01+656                                               08574000
CVTRV609 EQU   CVTS01+652                                               08575000
CVTRV608 EQU   CVTS01+648                                               08576000
CVTRV607 EQU   CVTS01+644                                               08577000
CVTRV606 EQU   CVTS01+640                                               08578000
CVTRV605 EQU   CVTS01+636                                               08579000
CVTRV604 EQU   CVTS01+632                                               08580000
CVTEFF02 EQU   CVTS01+628                                               08581000
CVTCBBR  EQU   CVTS01+624                                               08582000
CVTSSCR  EQU   CVTS01+620                                               08583000
CVTEVENT EQU   CVTS01+616                                               08584000
CVTCRCA  EQU   CVTS01+612                                               08585000
CVTTPIO  EQU   CVTS01+608                                               08586000
CVTADV   EQU   CVTS01+604                                               08587000
CVTGSDAB EQU   CVTGSDA                                                  08588000
CVTQV3   EQU   CVTS01+596                                               08589000
CVTQV2   EQU   CVTS01+592                                               08590000
CVTQV1   EQU   CVTS01+588                                               08591000
CVTRPT   EQU   CVTS01+584                                               08592000
CVTSSRB  EQU   CVTS01+580                                               08593000
CVTCSDRL EQU   CVTS01+576                                               08594000
CVTEXP1  EQU   CVTS01+572                                               08595000
CVTRMPMT EQU   CVTS01+568                                               08596000
CVTRMPTT EQU   CVTS01+564                                               08597000
CVTVPSA  EQU   CVTS01+560                                               08598000
CVTVSTOP EQU   CVTS01+556                                               08599000
CVTGTFR8 EQU   CVTS01+552                                               08600000
CVTQUIT  EQU   CVTS01+548                                               08601000
CVTVACR  EQU   CVTS01+544                                               08602000
CVTWTCB  EQU   CVTS01+540                                               08603000
CVTSTPRS EQU   CVTS01+536                                               08604000
CVT0PT02 EQU   CVTS01+532                                               08605000
CVTDARCM EQU   CVTS01+528                                               08606000
CVTIRECM EQU   CVTS01+524                                               08607000
CVTJRECM EQU   CVTS01+520                                               08608000
CVTVEMS0 EQU   CVTS01+516                                               08609000
CVTSPFRR EQU   CVTS01+512                                               08610000
CVTRLSTG EQU   CVTS01+508                                               08611000
CVT0TC0A EQU   CVTS01+504                                               08612000
CVTGMBR  EQU   CVTS01+500                                               08613000
CVTLFRM  EQU   CVTS01+496                                               08614000
CVTRMBR  EQU   CVTS01+492                                               08615000
CVTVIOP  EQU   CVTS01+488                                               08616000
CVTRV307 EQU   CVTS01+486                                               08617000
CVTRV306 EQU   CVTS01+484                                               08618000
CVTRV305 EQU   CVTS01+482                                               08619000
CVTRV304 EQU   CVTS01+480                                               08620000
CVTRV303 EQU   CVTS01+478                                               08621000
CVTRV302 EQU   CVTS01+476                                               08622000
CVTTRCA  EQU   CVTS01+472                                               08623000
CVTRV297 EQU   CVTRV289                                                 08624000
CVTRV296 EQU   CVTRV289                                                 08625000
CVTRV295 EQU   CVTRV289                                                 08626000
CVTRV294 EQU   CVTRV289                                                 08627000
CVTRV293 EQU   CVTRV289                                                 08628000
CVTRV292 EQU   CVTRV289                                                 08629000
CVTRV291 EQU   CVTRV289                                                 08630000
CVTRV290 EQU   CVTRV289                                                 08631000
CVTRV288 EQU   CVTRV280                                                 08632000
CVTRV287 EQU   CVTRV280                                                 08633000
CVTRV286 EQU   CVTRV280                                                 08634000
CVTRV285 EQU   CVTRV280                                                 08635000
CVTRV284 EQU   CVTRV280                                                 08636000
CVTRV283 EQU   CVTRV280                                                 08637000
CVTRV282 EQU   CVTRV280                                                 08638000
CVTRV281 EQU   CVTRV280                                                 08639000
CVTRV279 EQU   CVTRV271                                                 08640000
CVTRV278 EQU   CVTRV271                                                 08641000
CVTRV277 EQU   CVTRV271                                                 08642000
CVTRV276 EQU   CVTRV271                                                 08643000
CVTRV275 EQU   CVTRV271                                                 08644000
CVTRV274 EQU   CVTRV271                                                 08645000
CVTRV273 EQU   CVTRV271                                                 08646000
CVTRV272 EQU   CVTRV271                                                 08647000
CVTRV270 EQU   CVTRV262                                                 08648000
CVTRV269 EQU   CVTRV262                                                 08649000
CVTRV268 EQU   CVTRV262                                                 08650000
CVTRV267 EQU   CVTRV262                                                 08651000
CVTRV266 EQU   CVTRV262                                                 08652000
CVTRV265 EQU   CVTRV262                                                 08653000
CVTRV264 EQU   CVTRV262                                                 08654000
CVTRV263 EQU   CVTRV262                                                 08655000
CVTVFP   EQU   CVTS01+464                                               08656000
CVTVSI   EQU   CVTS01+460                                               08657000
CVTVPSIB EQU   CVTS01+456                                               08658000
CVTMFACT EQU   CVTMFRTR                                                 08659000
CVTMFCTL EQU   CVTS01+448                                               08660000
CVTPVBP  EQU   CVTS01+444                                               08661000
CVTPWI   EQU   CVTS01+440                                               08662000
CVTRV254 EQU   CVTS01+438                                               08663000
CVTRV253 EQU   CVTS01+436                                               08664000
CVTRV252 EQU   CVTS01+434                                               08665000
CVTRV251 EQU   CVTS01+433                                               08666000
CVTRV250 EQU   CVTS01+432                                               08667000
CVTRV249 EQU   CVTS01+431                                               08668000
CVTRV248 EQU   CVTS01+430                                               08669000
CVTRV247 EQU   CVTS01+429                                               08670000
CVTRV246 EQU   CVTS01+428                                               08671000
CVTRV245 EQU   CVTRV237                                                 08672000
CVTRV244 EQU   CVTRV237                                                 08673000
CVTRV243 EQU   CVTRV237                                                 08674000
CVTRV242 EQU   CVTRV237                                                 08675000
CVTRV241 EQU   CVTRV237                                                 08676000
CVTRV240 EQU   CVTRV237                                                 08677000
CVTRV239 EQU   CVTRV237                                                 08678000
CVTRV238 EQU   CVTRV237                                                 08679000
CVTRV236 EQU   CVTRV228                                                 08680000
CVTRV235 EQU   CVTRV228                                                 08681000
CVTRV234 EQU   CVTRV228                                                 08682000
CVTRV233 EQU   CVTRV228                                                 08683000
CVTRV232 EQU   CVTRV228                                                 08684000
CVTRV231 EQU   CVTRV228                                                 08685000
CVTRV230 EQU   CVTRV228                                                 08686000
CVTRV229 EQU   CVTRV228                                                 08687000
CVTRV227 EQU   CVTRV219                                                 08688000
CVTRV226 EQU   CVTRV219                                                 08689000
CVTRV225 EQU   CVTRV219                                                 08690000
CVTRV224 EQU   CVTRV219                                                 08691000
CVTRV223 EQU   CVTRV219                                                 08692000
CVTRV222 EQU   CVTRV219                                                 08693000
CVTRV221 EQU   CVTRV219                                                 08694000
CVTRV220 EQU   CVTRV219                                                 08695000
CVTRV218 EQU   CVTRV210                                                 08696000
CVTRV217 EQU   CVTRV210                                                 08697000
CVTRV216 EQU   CVTRV210                                                 08698000
CVTRV215 EQU   CVTRV210                                                 08699000
CVTRV214 EQU   CVTRV210                                                 08700000
CVTRV213 EQU   CVTRV210                                                 08701000
CVTRV212 EQU   CVTRV210                                                 08702000
CVTRV211 EQU   CVTRV210                                                 08703000
CVTLCCAT EQU   CVTS01+420                                               08704000
CVTPCCAT EQU   CVTS01+416                                               08705000
CVTIPCRP EQU   CVTS01+412                                               08706000
CVTIPCRI EQU   CVTS01+408                                               08707000
CVTIPCDS EQU   CVTS01+404                                               08708000
CVTAIDVT EQU   CVTS01+400                                               08709000
CVTSSAP  EQU   CVTS01+396                                               08710000
CVTEHCIR EQU   CVTS01+392                                               08711000
CVTEHDEF EQU   CVTS01+388                                               08712000
CVTDAIR  EQU   CVTS01+384                                               08713000
CVTPERFM EQU   CVTS01+380                                               08714000
CVT044R2 EQU   CVTS01+376                                               08715000
CVTFETCH EQU   CVTS01+372                                               08716000
CVTRSTWD EQU   CVTS01+368                                               08717000
CVTSPOST EQU   CVTS01+364                                               08718000
CVTIOBP  EQU   CVTS01+360                                               08719000
CVTASMVT EQU   CVTS01+356                                               08720000
CVTRECRQ EQU   CVTS01+352                                               08721000
CVTWSAC  EQU   CVTS01+348                                               08722000
CVTRV149 EQU   CVTS01+344                                               08723000
CVTWSAL  EQU   CVTS01+340                                               08724000
CVTSPSA  EQU   CVTS01+336                                               08725000
CVTGLMN  EQU   CVTS01+332                                               08726000
CVTVEAC0 EQU   CVTS01+328                                               08727000
CVT062R1 EQU   CVTS01+324                                               08728000
CVTRPOST EQU   CVTS01+320                                               08729000
CVTDQIQE EQU   CVTS01+316                                               08730000
CVTCSD   EQU   CVTS01+312                                               08731000
CVTLKRMA EQU   CVTS01+308                                               08732000
CVTRSPIE EQU   CVTS01+304                                               08733000
CVTRENQ  EQU   CVTS01+300                                               08734000
CVTLQCB  EQU   CVTS01+296                                               08735000
CVTFQCB  EQU   CVTS01+292                                               08736000
CVTQCS01 EQU   CVTS01+288                                               08737000
CVTAPFT  EQU   CVTS01+284                                               08738000
CVTPARRL EQU   CVTS01+280                                               08739000
CVTVWAIT EQU   CVTS01+276                                               08740000
CVTGSPL  EQU   CVTS01+272                                               08741000
CVTLSMQ  EQU   CVTS01+268                                               08742000
CVTGSMQ  EQU   CVTS01+264                                               08743000
CVTEXPRO EQU   CVTS01+260                                               08744000
CVTOPCTP EQU   CVTS01+256                                               08745000
CVTSIC   EQU   CVTS01+252                                               08746000
CVTTPIOS EQU   CVTS01+248                                               08747000
CVTRTMS  EQU   CVTS01+244                                               08748000
CVTSDBF  EQU   CVTS01+240                                               08749000
CVTSCBP  EQU   CVTS01+236                                               08750000
CVTSDMP  EQU   CVTS01+232                                               08751000
CVTSV60  EQU   CVTS01+228                                               08752000
CVTRTMCT EQU   CVTS01+224                                               08753000
CVTASCBL EQU   CVTS01+220                                               08754000
CVTASCBH EQU   CVTS01+216                                               08755000
CVTGDA   EQU   CVTS01+212                                               08756000
CVTASVT  EQU   CVTS01+208                                               08757000
CVTVVMDI EQU   CVTS01+204                                               08758000
CVTAQTOP EQU   CVTS01+200                                               08759000
CVTIOSCS EQU   CVTS01+196                                               08760000
CVTSDRM  EQU   CVTS01+192                                               08761000
CVTOPTE  EQU   CVTS01+188                                               08762000
CVTSTXU  EQU   CVTS01+184                                               08763000
CVTQUIS  EQU   CVTS01+180                                               08764000
CVTPARS  EQU   CVTS01+176                                               08765000
CVTS1EE  EQU   CVTS01+172                                               08766000
CVTFRAS  EQU   CVTS01+168                                               08767000
CVTQSAS  EQU   CVTS01+164                                               08768000
CVTCRAS  EQU   CVTS01+160                                               08769000
CVTCRMN  EQU   CVTS01+156                                               08770000
CVTDELCP EQU   CVTS01+152                                               08771000
CVTFRECL EQU   CVTS01+148                                               08772000
CVTGETCL EQU   CVTS01+144                                               08773000
CVTBLDCP EQU   CVTS01+140                                               08774000
CVTAUTHL EQU   CVTS01+136                                               08775000
CVTSCAN  EQU   CVTS01+132                                               08776000
CVTRV144 EQU   CVTS01+130                                               08777000
CVTMAXMP EQU   CVTS01+128                                               08778000
CVTSTCK  EQU   CVTS01+124                                               08779000
CVTRV139 EQU   CVTS01+123                                               08780000
CVTDSSAC EQU   CVTS01+122                                               08781000
CVTRV513 EQU   CVTS01+121                                               08782000
CVTIOSPL EQU   CVTS01+120                                               08783000
CVTPTGT  EQU   CVTS01+116                                               08784000
CVTCSPIE EQU   CVTS01+112                                               08785000
CVTSMFEX EQU   CVTS01+108                                               08786000
CVTOLT0A EQU   CVTS01+104                                               08787000
CVTSRBRT EQU   CVTS01+100                                               08788000
CVTPUTL  EQU   CVTS01+96                                                08789000
CVTRV519 EQU   CVTS01+92                                                08790000
CVTRV327 EQU   CVTS01+88                                                08791000
CVTRV326 EQU   CVTS01+84                                                08792000
CVTRV325 EQU   CVTS01+80                                                08793000
CVTRV324 EQU   CVTS01+76                                                08794000
CVT0VL01 EQU   CVTS01+72                                                08795000
CVTSHRVM EQU   CVTS01+68                                                08796000
CVTRV332 EQU   CVTS01+64                                                08797000
CVTTAS   EQU   CVTS01+60                                                08798000
CVTRSCN  EQU   CVTS01+56                                                08799000
CVTTRAC2 EQU   CVTS01+54                                                08800000
CVTTRACE EQU   CVTS01+52                                                08801000
CVTAPG   EQU   CVTS01+51                                                08802000
CVTSDTRC EQU   CVTCTLFG                                                 08803000
CVTGTRCE EQU   CVTCTLFG                                                 08804000
CVTNOMP  EQU   CVTCTLFG                                                 08805000
CVTRSV79 EQU   CVTCTLFG                                                 08806000
CVTDSTAT EQU   CVTCTLFG                                                 08807000
CVTRSV78 EQU   CVTCTLFG                                                 08808000
CVTRV333 EQU   CVTCTLFG                                                 08809000
CVTRV323 EQU   CVTCTLFG                                                 08810000
CVTSPVLK EQU   CVTS01+49                                                08811000
CVTRSV77 EQU   CVTS01+48                                                08812000
CVTRV331 EQU   CVTS01+44                                                08813000
CVTRV330 EQU   CVTS01+40                                                08814000
CVTRV329 EQU   CVTS01+36                                                08815000
CVTRV328 EQU   CVTS01+32                                                08816000
CVTRV322 EQU   CVTS01+28                                                08817000
CVTSLID  EQU   CVTSLIDA+1                                               08818000
CVTSYLK  EQU   CVTSLIDA                                                 08819000
CVTRV321 EQU   CVTS01+20                                                08820000
CVTRV320 EQU   CVTS01+16                                                08821000
CVTLPDIR EQU   CVTLPDIA+1                                               08822000
CVTRSV69 EQU   CVTDIRST                                                 08823000
CVTRSV68 EQU   CVTDIRST                                                 08824000
CVTRSV67 EQU   CVTDIRST                                                 08825000
CVTRSV66 EQU   CVTDIRST                                                 08826000
CVTRSV65 EQU   CVTDIRST                                                 08827000
CVTRSV64 EQU   CVTDIRST                                                 08828000
CVTRSV63 EQU   CVTDIRST                                                 08829000
CVTDICOM EQU   CVTDIRST                                                 08830000
CVTPVTP  EQU   CVTS01+8                                                 08831000
CVTLPDSR EQU   CVTS01+4                                                 08832000
CVTGETL  EQU   CVTS01                                                   08833000
UCBRV066 EQU   UCBOBS09+4                                               08834000
UCBIOSBA EQU   UCBOBS09                                                 08835000
UCBRV042 EQU   UCBOBS08+5                                               08836000
UCBCTCF1 EQU   UCBOBS08+4                                               08837000
UCBCTCAD EQU   UCBOBS08                                                 08838000
UCBICNCB EQU   UCBOBS07+4                                               08839000
UCBRV040 EQU   UCBOBS07                                                 08840000
UCBCTLNA EQU   UCBCTLNK+1                                               08841000
UCBRLN   EQU   UCBCTLNK                                                 08842000
UCBRDYQA EQU   UCBLDNCB                                                 08843000
UCBINRLN EQU   UCBIRLN                                                  08844000
UCBIRBA  EQU   UCBIRB+1                                                 08845000
UCBRV039 EQU   UCBGRAF                                                  08846000
UCBDWNR  EQU   UCBGRAF                                                  08847000
UCBRPND  EQU   UCBGRAF                                                  08848000
UCBUPM   EQU   UCBGRAF                                                  08849000
UCBBTAM  EQU   UCBGRAF                                                  08850000
UCBDRNO  EQU   UCBGRAF                                                  08851000
UCBDRO   EQU   UCBGRAF                                                  08852000
UCBOIP   EQU   UCBGRAF                                                  08853000
UCBATRCD EQU   @NM00033                                                 08854000
UCBSKPFG EQU   @NM00033                                                 08855000
UCBRIPND EQU   @NM00033                                                 08856000
UCBRTIAC EQU   @NM00033                                                 08857000
UCBRSV79 EQU   @NM00033                                                 08858000
UCBRSV78 EQU   @NM00033                                                 08859000
UCBRSV77 EQU   @NM00033                                                 08860000
UCBOLTEP EQU   @NM00033                                                 08861000
UCBATNCT EQU   UCBOBS06+2                                               08862000
UCBRSV76 EQU   UCBAOF2                                                  08863000
UCBRSV75 EQU   UCBAOF2                                                  08864000
UCBRSV74 EQU   UCBAOF2                                                  08865000
UCBRSV73 EQU   UCBAOF2                                                  08866000
UCBRSV72 EQU   UCBAOF2                                                  08867000
UCBRSV71 EQU   UCBAOF2                                                  08868000
UCBRSV70 EQU   UCBAOF2                                                  08869000
UCBRSV69 EQU   UCBAOF2                                                  08870000
UCBRSV68 EQU   UCBAOF1                                                  08871000
UCBRSV67 EQU   UCBAOF1                                                  08872000
UCBRSV66 EQU   UCBAOF1                                                  08873000
UCBRSV65 EQU   UCBAOF1                                                  08874000
UCBRSV64 EQU   UCBAOF1                                                  08875000
UCBOFNL  EQU   UCBAOF1                                                  08876000
UCBOFSP  EQU   UCBAOF1                                                  08877000
UCBOFMCR EQU   UCBAOF1                                                  08878000
UCBBTB   EQU   UCBBTA+1                                                 08879000
UCBDI    EQU   UCBBTA                                                   08880000
UCBSNS   EQU   UCBOBS04+8                                               08881000
UCBTEB   EQU   UCBOBS04+4                                               08882000
UCBGCB   EQU   UCBOBS04+3                                               08883000
UCBOPEN  EQU   UCBOBS04+2                                               08884000
UCBSTART EQU   UCBOBS04                                                 08885000
UCBXTNB  EQU   UCBXTN+1                                                 08886000
UCBRSV22 EQU   UCBVOPT                                                  08887000
UCBRSV21 EQU   UCBVOPT                                                  08888000
UCBRSV20 EQU   UCBVOPT                                                  08889000
UCBESVE  EQU   UCBVOPT                                                  08890000
UCBERPC  EQU   UCBVOPT                                                  08891000
UCBESVC  EQU   UCBVOPT                                                  08892000
UCBEVA   EQU   UCBVOPT                                                  08893000
UCBESV   EQU   UCBVOPT                                                  08894000
UCBRV009 EQU   UCBTFL1                                                  08895000
UCBRV008 EQU   UCBTFL1                                                  08896000
UCBRV007 EQU   UCBTFL1                                                  08897000
UCBRV006 EQU   UCBTFL1                                                  08898000
UCBRV005 EQU   UCBTFL1                                                  08899000
UCBRV038 EQU   UCBTFL1                                                  08900000
UCBNSLTP EQU   UCBTFL1                                                  08901000
UCBNLTP  EQU   UCBTFL1                                                  08902000
UCBRES1B EQU   UCBOBS02+18                                              08903000
UCBFSER  EQU   UCBOBS02+12                                              08904000
@NM00032 EQU   UCBOBS02+4                                               08905000
UCBFSEQ  EQU   UCBOBS02+2                                               08906000
UCBFSCT  EQU   UCBOBS02                                                 08907000
UCBNEXP  EQU   UCBOBS01+20                                              08908000
UCBBASE  EQU   UCBOBS01+16                                              08909000
UCBRES1A EQU   UCBOBS01+15                                              08910000
UCBUSER  EQU   UCBOBS01+14                                              08911000
UCBFL47  EQU   UCBFL4                                                   08912000
UCBFL46  EQU   UCBFL4                                                   08913000
UCBFL45  EQU   UCBFL4                                                   08914000
UCBRV065 EQU   UCBFL4                                                   08915000
UCBDSS   EQU   UCBFL4                                                   08916000
UCBRV028 EQU   UCBFL4                                                   08917000
UCBWDAV  EQU   UCBFL4                                                   08918000
UCBDAVV  EQU   UCBFL4                                                   08919000
UCBSQC   EQU   UCBOBS01+12                                              08920000
UCBDATP  EQU   UCBOBS01+12                                              08921000
UCBDMC   EQU   UCBDMCT                                                  08922000
UCBMOUNT EQU   UCBDMCT                                                  08923000
UCBBNUL  EQU   UCBSTAB                                                  08924000
UCBSHAR  EQU   UCBSTAB                                                  08925000
UCBBSTR  EQU   UCBSTAB                                                  08926000
UCBBPUB  EQU   UCBSTAB                                                  08927000
UCBBPRV  EQU   UCBSTAB                                                  08928000
UCBBALB  EQU   UCBPRSRS                                                 08929000
UCBPGFL  EQU   UCBSTAB                                                  08930000
UCBDVSHR EQU   UCBBSVL                                                  08931000
UCBVOLI  EQU   UCBOBS01+4                                               08932000
UCBVTOC  EQU   UCBOBS01                                                 08933000
TIOUCBP  EQU   TIOEDEVE+1                                               08934000
TIOVERF  EQU   TIOSTTB                                                  08935000
TIOUNLD  EQU   TIOSTTB                                                  08936000
TIOMNTD  EQU   TIOSTTB                                                  08937000
TIOSETU  EQU   TIOSTTB                                                  08938000
TIOVLSR  EQU   TIOSTTB                                                  08939000
TIOPVIO  EQU   TIOSTTB                                                  08940000
TIOREQD  EQU   TIOSTTB                                                  08941000
TIOUSED  EQU   TIOSTTB                                                  08942000
TIOTFEND EQU   POOLSTAR+16                                              08943000
TIOPSLOT EQU   POOLSTAR+13                                              08944000
TIOPSTTB EQU   POOLSTAR+12                                              08945000
TIOPPOOL EQU   POOLSTAR+4                                               08946000
TIOPNSRT EQU   POOLSTAR+3                                               08947000
@NM00030 EQU   POOLSTAR+2                                               08948000
TIOPNSLT EQU   POOLSTAR+1                                               08949000
@NM00029 EQU   POOLSTAR                                                 08950000
TIOSVERF EQU   TIOESTTB                                                 08951000
TIOSUNLD EQU   TIOESTTB                                                 08952000
TIOSMNTD EQU   TIOESTTB                                                 08953000
TIOSSETU EQU   TIOESTTB                                                 08954000
TIOSVLSR EQU   TIOESTTB                                                 08955000
TIOSPVIO EQU   TIOESTTB                                                 08956000
TIOSREQD EQU   TIOESTTB                                                 08957000
TIOSUSED EQU   TIOESTTB                                                 08958000
TIOSBALS EQU   TIOESTTC                                                 08959000
TIOSBALP EQU   TIOESTTC                                                 08960000
TIOSVOLS EQU   TIOESTTC                                                 08961000
TIOSVOLP EQU   TIOESTTC                                                 08962000
TIOSAFFS EQU   TIOESTTC                                                 08963000
TIOSAFFP EQU   TIOESTTC                                                 08964000
TIOSDEFR EQU   TIOESTTC                                                 08965000
TIOSDKCR EQU   TIOESTTC                                                 08966000
TIOEJFCB EQU   TIOENTRY+12                                              08967000
TIOTREM  EQU   TIOELINK                                                 08968000
TIOESSDS EQU   TIOESYOT                                                 08969000
TIOESYIN EQU   TIOELINK                                                 08970000
TIOEQNAM EQU   TIOELINK                                                 08971000
TIOEDYNM EQU   TIOELINK                                                 08972000
TIOTTERM EQU   TIOELINK                                                 08973000
TIOTRV01 EQU   TIOELINK                                                 08974000
TIOSYOUT EQU   TIOELINK                                                 08975000
TIOEWTCT EQU   TIOERLOC                                                 08976000
TIOSDSP2 EQU   TIOESTTA                                                 08977000
TIOSDSP1 EQU   TIOESTTA                                                 08978000
TIOSLABL EQU   TIOESTTA                                                 08979000
TIOSDADS EQU   TIOESTTA                                                 08980000
TIOSJBLB EQU   TIOESTTA                                                 08981000
TIOSPLTS EQU   TIOESTTA                                                 08982000
TIOSPLTP EQU   TIOESTTA                                                 08983000
TIOSLTYP EQU   TIOESTTA                                                 08984000
@NM00463 EQU   OTNOOP+1                                                 08985000
@NM00462 EQU   OTIOBMAP+72                                              08986000
@NM00461 EQU   OTIOBMAP+48                                              08987000
@NM00460 EQU   DFOPSOUT+1                                               08988000
@NM00459 EQU   OTIOBMAP+40                                              08989000
OUTSK0   EQU   OUTSKADR+2                                               08990000
OUTSKRV  EQU   OUTSKADR                                                 08991000
@NM00458 EQU   OTIOBMAP                                                 08992000
@NM00457 EQU   OTIOBECB+1                                               08993000
@NM00456 EQU   OUTECBCC                                                 08994000
@NM00455 EQU   OUTECBCC                                                 08995000
@NM00454 EQU   OTIOBPRE                                                 08996000
@NM00180 EQU   READCCW+4                                                08997000
@NM00179 EQU   READCCW                                                  08998000
SEEKCCW  EQU   IOBMAP+48                                                08999000
DFOPSCCW EQU   IOBMAP+40                                                09000000
IOBSK0   EQU   IOBSKADR+2                                               09001000
IOBSKRV  EQU   IOBSKADR                                                 09002000
@NM00178 EQU   IOBMAP+24                                                09003000
IOBFLAG4 EQU   IOBDCBPT                                                 09004000
@NM00177 EQU   IOBMAP+4                                                 09005000
@NM00176 EQU   IOBSENS1                                                 09006000
@NM00175 EQU   IOBSENS1                                                 09007000
@NM00174 EQU   IOBSENS0                                                 09008000
@NM00173 EQU   IOBSENS0                                                 09009000
@NM00172 EQU   IOBMAP                                                   09010000
@NM00171 EQU   IOBECB+1                                                 09011000
@NM00170 EQU   IOBECBCC                                                 09012000
@NM00169 EQU   IOBECBCC                                                 09013000
@NM00168 EQU   IOBPREFX                                                 09014000
@NM00131 EQU   HEADER1+79                                               09015000
@NM00130 EQU   HEADER1+73                                               09016000
@NM00129 EQU   HEADER1+63                                               09017000
@NM00128 EQU   HEADER1+53                                               09018000
@NM00127 EQU   HEADER1+39                                               09019000
@NM00126 EQU   HEADER1+33                                               09020000
@NM00125 EQU   HEADER1+27                                               09021000
@NM00124 EQU   HEADER1+13                                               09022000
@NM00123 EQU   HEADER1                                                  09023000
@NM00122 EQU   MAP518A+23                                               09024000
@NM00121 EQU   MAP518A                                                  09025000
@NM00120 EQU   MAP517A                                                  09026000
@NM00119 EQU   MAP503A                                                  09027000
@NM00118 EQU   MAP502A                                                  09028000
@NM00102 EQU   ABPARM+4                                                 09029000
@NM00101 EQU   OPTMASK                                                  09030000
@NM00100 EQU   OPTMASK                                                  09031000
@NM00099 EQU   ABPARM                                                   09032000
@NM00098 EQU   CURCCW+4                                                 09033000
@NM00095 EQU   OPTBYTE                                                  09034000
@NM00094 EQU   RECBUF+72                                                09035000
@NM00093 EQU   RECBUF+43                                                09036000
@NM00092 EQU   RECBUF+1                                                 09037000
DEBXRV40 EQU   DEBXTN+28                                                09038000
DEBXRV39 EQU   DEBXTN+24                                                09039000
DEBXXARG EQU   DEBXTN+20                                                09040000
DEBXMCF2 EQU   DEBXTN+19                                                09041000
DEBXMCF1 EQU   DEBXTN+18                                                09042000
DEBXDSO2 EQU   DEBXTN+17                                                09043000
DEBXDSO1 EQU   DEBXTN+16                                                09044000
DEBXDBPR EQU   DEBXTN+12                                                09045000
DEBXDCBM EQU   DEBXTN+8                                                 09046000
DEBXDSAB EQU   DEBXTN+4                                                 09047000
DEBXRV48 EQU   DEBXTN+3                                                 09048000
DEBXRV47 EQU   DEBXFLG1                                                 09049000
DEBXRV46 EQU   DEBXFLG1                                                 09050000
DEBXRV45 EQU   DEBXFLG1                                                 09051000
DEBXRV44 EQU   DEBXFLG1                                                 09052000
DEBXRV43 EQU   DEBXFLG1                                                 09053000
DEBXRV42 EQU   DEBXFLG1                                                 09054000
DEBXTSKC EQU   DEBXFLG1                                                 09055000
DEBXCDCB EQU   DEBXFLG1                                                 09056000
DEBXLNGH EQU   DEBXTN                                                   09057000
DEBTBLOF EQU   DEBPREFX+14                                              09058000
DEBAMTYP EQU   DEBPREFX+13                                              09059000
DEBLNGTH EQU   DEBPREFX+12                                              09060000
DEBDCBMK EQU   DEBXTNP                                                  09061000
DEBDSCBA EQU   DEBPREFX+1                                               09062000
DEBWKARA EQU   DEBPREFX                                                 09063000
DEBXCEAD EQU   DEBXCEA+1                                                09064000
DEBXCENP EQU   DEBXCEAB                                                 09065000
DEBRSV35 EQU   DEBXCEAB                                                 09066000
DEBRSV34 EQU   DEBXCEAB                                                 09067000
DEBRSV33 EQU   DEBXCEAB                                                 09068000
DEBRSV32 EQU   DEBXCEAB                                                 09069000
DEBCEAD  EQU   DEBCEA+1                                                 09070000
DEBCENP  EQU   DEBCEAB                                                  09071000
DEBRSV31 EQU   DEBCEAB                                                  09072000
DEBRSV30 EQU   DEBCEAB                                                  09073000
DEBRSV29 EQU   DEBCEAB                                                  09074000
DEBRSV28 EQU   DEBCEAB                                                  09075000
DEBPCIAD EQU   DEBPCIA+1                                                09076000
DEBPCINP EQU   DEBPCIAB                                                 09077000
DEBRSV27 EQU   DEBPCIAB                                                 09078000
DEBRSV26 EQU   DEBPCIAB                                                 09079000
DEBRSV25 EQU   DEBPCIAB                                                 09080000
DEBRSV24 EQU   DEBPCIAB                                                 09081000
DEBSIOAD EQU   DEBSIOA+1                                                09082000
DEBSIONP EQU   DEBSIOAB                                                 09083000
DEBFIX   EQU   DEBSIOAB                                                 09084000
DEBIOVR  EQU   DEBSIOAB                                                 09085000
DEBSIOX  EQU   DEBSIOAB                                                 09086000
DEBPGFX  EQU   DEBSIOAB                                                 09087000
DEBEOEAD EQU   DEBEOEA+1                                                09088000
DEBEOENP EQU   DEBEOEAB                                                 09089000
DEBRSV22 EQU   DEBEOEAB                                                 09090000
DEBRSV21 EQU   DEBEOEAB                                                 09091000
DEBRSV20 EQU   DEBEOEAB                                                 09092000
DEBRSV19 EQU   DEBEOEAB                                                 09093000
DEBSUBID EQU   DEBSUBNM                                                 09094000
DEBSIOA2 EQU   DEBACS08+24                                              09095000
DEBRPSIO EQU   DEBACS08+20                                              09096000
DEBFREED EQU   DEBACS08+16                                              09097000
@NM00064 EQU   DEBACS08+12                                              09098000
@NM00063 EQU   DEBACS08+8                                               09099000
DEBDISAD EQU   DEBACS08+4                                               09100000
@NM00062 EQU   DEBACS08                                                 09101000
DEBRPSST EQU   DEBACS07+64                                              09102000
DEBARECK EQU   DEBACS07+60                                              09103000
DEBAREWT EQU   DEBACS07+56                                              09104000
DEBACHK  EQU   DEBACS07+52                                              09105000
DEBAWRIT EQU   DEBACS07+48                                              09106000
DEBASETL EQU   DEBACS07+44                                              09107000
DEBAREAD EQU   DEBACS07+40                                              09108000
DEBCRECK EQU   DEBACS07+36                                              09109000
DEBCREWT EQU   DEBACS07+32                                              09110000
DEBCCHK  EQU   DEBACS07+28                                              09111000
DEBCWRIT EQU   DEBACS07+24                                              09112000
DEBCSETL EQU   DEBACS07+20                                              09113000
DEBCREAD EQU   DEBACS07+16                                              09114000
DEBWKPT5 EQU   DEBACS07+12                                              09115000
DEBWKPT4 EQU   DEBACS07+8                                               09116000
DEBGET   EQU   DEBACS07+4                                               09117000
@NM00061 EQU   DEBACS07                                                 09118000
DEBPUT   EQU   DEBACS06+4                                               09119000
DEBDCBFA EQU   DEBACS06                                                 09120000
DEBLUCBB EQU   DEBLUCBA+1                                               09121000
DEBRSV18 EQU   DEBLUCBA                                                 09122000
DEBFUCBB EQU   DEBFUCBA+1                                               09123000
DEBRSV17 EQU   DEBFUCBA                                                 09124000
DEBTCCWB EQU   DEBTCCWA+1                                               09125000
DEBRSV16 EQU   DEBTCCWA                                                 09126000
DEBTBFRB EQU   DEBTBFRA+1                                               09127000
DEBRSV15 EQU   DEBTBFRA                                                 09128000
DEBDBPEF EQU   DEBACS03+8                                               09129000
DEBDBPP  EQU   DEBACS03+4                                               09130000
DEBDTPP  EQU   DEBACS03                                                 09131000
DEBDBPE  EQU   DEBDBLK+1                                                09132000
DEBDBPT  EQU   DEBDBLK                                                  09133000
DEBEXTNM EQU   DEBDSNAM                                                 09134000
DEBRSV14 EQU   DEBDSNM+4                                                09135000
DEBUTSAB EQU   DEBUTSAA+1                                               09136000
DEBRSV13 EQU   DEBUTSAA                                                 09137000
DEBVOLNM EQU   DEBACSMD+2                                               09138000
DEBVLSEQ EQU   DEBVOLSQ+1                                               09139000
DEBRSV42 EQU   DEBVOLBT                                                 09140000
DEBRSV41 EQU   DEBVOLBT                                                 09141000
DEBRSV40 EQU   DEBVOLBT                                                 09142000
DEBRSV39 EQU   DEBVOLBT                                                 09143000
DEBRSV38 EQU   DEBVOLBT                                                 09144000
DEBRSV37 EQU   DEBVOLBT                                                 09145000
DEBRSV36 EQU   DEBVOLBT                                                 09146000
DEBEXFUL EQU   DEBVOLBT                                                 09147000
DEBNMTRK EQU   DEBDASD+14                                               09148000
DEBENDHH EQU   DEBDASD+12                                               09149000
DEBENDCC EQU   DEBDASD+10                                               09150000
DEBSTRHH EQU   DEBDASD+8                                                09151000
DEBSTRCC EQU   DEBDASD+6                                                09152000
DEBBINUM EQU   DEBDASD+4                                                09153000
DEBUCBA  EQU   DEBUCBAD+1                                               09154000
DEBDVMOD EQU   DEBUCBAD                                                 09155000
DEBAPPB  EQU   DEBAPPAD+1                                               09156000
DEBEXSCL EQU   DEBAPPAD                                                 09157000
DEBDCBB  EQU   DEBDCBAD+1                                               09158000
DEBDEBID EQU   DEBPROTG                                                 09159000
DEBECBB  EQU   DEBECBAD+1                                               09160000
DEBPRIOR EQU   DEBECBAD                                                 09161000
DEBUSRPB EQU   DEBUSRPG+1                                               09162000
DEBNMEXT EQU   DEBUSRPG                                                 09163000
DEBRSV05 EQU   DEBBASIC+15                                              09164000
DEBXTNIN EQU   DEBFLGS1                                                 09165000
DEBAPFIN EQU   DEBFLGS1                                                 09166000
DEBF1CEV EQU   DEBFLGS1                                                 09167000
DEBCINDI EQU   DEBFLGS1                                                 09168000
DEBRSV02 EQU   DEBFLGS1                                                 09169000
DEBRSIOA EQU   DEBFLGS1                                                 09170000
DEBEOFDF EQU   DEBFLGS1                                                 09171000
DEBPWCKD EQU   DEBFLGS1                                                 09172000
DEBQSCNT EQU   DEBBASIC+13                                              09173000
DEBACCS  EQU   DEBOPATB                                                 09174000
DEBPOSIT EQU   DEBOPATB                                                 09175000
DEBZERO  EQU   DEBOPATB                                                 09176000
DEBABEND EQU   DEBOPATB                                                 09177000
DEBRERR  EQU   DEBOFLGS                                                 09178000
DEBLABEL EQU   DEBOFLGS                                                 09179000
DEBSPLIT EQU   DEBOFLGS                                                 09180000
DEBDCB   EQU   DEBOFLGS                                                 09181000
DEBRLSE  EQU   DEBOFLGS                                                 09182000
DEBEOF   EQU   DEBOFLGS                                                 09183000
DEBDISP  EQU   DEBOFLGS                                                 09184000
DEBDEBB  EQU   DEBDEBAD+1                                               09185000
DEBAMLNG EQU   DEBDEBAD                                                 09186000
DEBTCBB  EQU   DEBTCBAD+1                                               09187000
DEBNMSUB EQU   DEBTCBAD                                                 09188000
CVTLEVL  EQU   CVTRELNO+2                                               09189000
CVTNUMB  EQU   CVTRELNO                                                 09190000
CVTMDL   EQU   CVTFIX+250                                               09191000
@NM00036 EQU   CVTFIX+248                                               09192000
@NM00035 EQU   CVTFIX                                                   09193000
CVTRV482 EQU   CVTXTNT2+128                                             09194000
CVTRV481 EQU   CVTXTNT2+124                                             09195000
CVTRV480 EQU   CVTXTNT2+120                                             09196000
CVTRV479 EQU   CVTXTNT2+118                                             09197000
CVTRV478 EQU   CVTXTNT2+117                                             09198000
CVTRV477 EQU   CVTXTNT2+116                                             09199000
CVTRV476 EQU   CVTXTNT2+115                                             09200000
CVTRV475 EQU   CVTXTNT2+114                                             09201000
CVTRV474 EQU   CVTRV466                                                 09202000
CVTRV473 EQU   CVTRV466                                                 09203000
CVTRV472 EQU   CVTRV466                                                 09204000
CVTRV471 EQU   CVTRV466                                                 09205000
CVTRV470 EQU   CVTRV466                                                 09206000
CVTRV469 EQU   CVTRV466                                                 09207000
CVTRV468 EQU   CVTRV466                                                 09208000
CVTRV467 EQU   CVTRV466                                                 09209000
CVTRV465 EQU   CVTRV457                                                 09210000
CVTRV464 EQU   CVTRV457                                                 09211000
CVTRV463 EQU   CVTRV457                                                 09212000
CVTRV462 EQU   CVTRV457                                                 09213000
CVTRV461 EQU   CVTRV457                                                 09214000
CVTRV460 EQU   CVTRV457                                                 09215000
CVTRV459 EQU   CVTRV457                                                 09216000
CVTRV458 EQU   CVTRV457                                                 09217000
CVTRV456 EQU   CVTXTNT2+108                                             09218000
CVTRV455 EQU   CVTXTNT2+104                                             09219000
CVTRV454 EQU   CVTXTNT2+100                                             09220000
CVTRV453 EQU   CVTXTNT2+96                                              09221000
CVTRV452 EQU   CVTXTNT2+94                                              09222000
CVTRV451 EQU   CVTXTNT2+92                                              09223000
CVTRV450 EQU   CVTXTNT2+90                                              09224000
CVTRV449 EQU   CVTXTNT2+88                                              09225000
CVTRV448 EQU   CVTXTNT2+87                                              09226000
CVTRV447 EQU   CVTXTNT2+86                                              09227000
CVTRV446 EQU   CVTRV438                                                 09228000
CVTRV445 EQU   CVTRV438                                                 09229000
CVTRV444 EQU   CVTRV438                                                 09230000
CVTRV443 EQU   CVTRV438                                                 09231000
CVTRV442 EQU   CVTRV438                                                 09232000
CVTRV441 EQU   CVTRV438                                                 09233000
CVTRV440 EQU   CVTRV438                                                 09234000
CVTRV439 EQU   CVTRV438                                                 09235000
CVTRV437 EQU   CVTRV429                                                 09236000
CVTRV436 EQU   CVTRV429                                                 09237000
CVTRV435 EQU   CVTRV429                                                 09238000
CVTRV434 EQU   CVTRV429                                                 09239000
CVTRV433 EQU   CVTRV429                                                 09240000
CVTRV432 EQU   CVTRV429                                                 09241000
CVTRV431 EQU   CVTRV429                                                 09242000
CVTRV430 EQU   CVTRV429                                                 09243000
CVTRV428 EQU   CVTXTNT2+80                                              09244000
CVTRV427 EQU   CVTXTNT2+76                                              09245000
CVTRV426 EQU   CVTXTNT2+72                                              09246000
CVTRV425 EQU   CVTXTNT2+68                                              09247000
CVTATACT EQU   CVTATCVT                                                 09248000
CVTRV423 EQU   CVTXTNT2+62                                              09249000
CVTRV422 EQU   CVTXTNT2+60                                              09250000
CVTRV421 EQU   CVTXTNT2+58                                              09251000
CVTRV420 EQU   CVTXTNT2+56                                              09252000
CVTRV419 EQU   CVTXTNT2+55                                              09253000
CVTRV418 EQU   CVTXTNT2+54                                              09254000
CVTRV417 EQU   CVTRV409                                                 09255000
CVTRV416 EQU   CVTRV409                                                 09256000
CVTRV415 EQU   CVTRV409                                                 09257000
CVTRV414 EQU   CVTRV409                                                 09258000
CVTRV413 EQU   CVTRV409                                                 09259000
CVTRV412 EQU   CVTRV409                                                 09260000
CVTRV411 EQU   CVTRV409                                                 09261000
CVTRV410 EQU   CVTRV409                                                 09262000
CVTRV408 EQU   CVTRV400                                                 09263000
CVTRV407 EQU   CVTRV400                                                 09264000
CVTRV406 EQU   CVTRV400                                                 09265000
CVTRV405 EQU   CVTRV400                                                 09266000
CVTRV404 EQU   CVTRV400                                                 09267000
CVTRV403 EQU   CVTRV400                                                 09268000
CVTRV402 EQU   CVTRV400                                                 09269000
CVTRV401 EQU   CVTRV400                                                 09270000
CVTICB   EQU   CVTXTNT2+48                                              09271000
CVTSKTA  EQU   CVTXTNT2+44                                              09272000
CVTRSV99 EQU   CVTXTNT2+40                                              09273000
CVTRSV98 EQU   CVTXTNT2+36                                              09274000
CVTRSV97 EQU   CVTXTNT2+34                                              09275000
CVTRSV96 EQU   CVTXTNT2+32                                              09276000
CVTOLTEP EQU   CVTXTNT2+28                                              09277000
CVTQIDA  EQU   CVTQID+1                                                 09278000
CVTRSV95 EQU   CVTQID                                                   09279000
CVTRSV94 EQU   CVTXTNT2+20                                              09280000
CVTRSV93 EQU   CVTXTNT2+16                                              09281000
CVTRSV92 EQU   CVTXTNT2+12                                              09282000
CVTDEBVR EQU   CVTXTNT2+8                                               09283000
CVTRSV91 EQU   CVTXTNT2+6                                               09284000
CVTRSV9H EQU   CVTFLGBT                                                 09285000
CVTRSV9G EQU   CVTFLGBT                                                 09286000
CVTRSV9F EQU   CVTFLGBT                                                 09287000
CVTRSV9E EQU   CVTFLGBT                                                 09288000
CVTRSV9D EQU   CVTFLGBT                                                 09289000
CVTRSV9C EQU   CVTFLGBT                                                 09290000
CVTVME   EQU   CVTFLGBT                                                 09291000
CVTNPE   EQU   CVTFLGBT                                                 09292000
CVTNUCLS EQU   CVTXTNT2+4                                               09293000
CVTDSSVA EQU   CVTDSSV+1                                                09294000
CVTRSV89 EQU   CVTDSSV                                                  09295000
CVTRSV88 EQU   CVTXTNT1+8                                               09296000
CVTRSV87 EQU   CVTXTNT1+4                                               09297000
CVTFACHN EQU   CVTXTNT1                                                 09298000
CVTRV488 EQU   CVTMAP+412                                               09299000
CVTRV487 EQU   CVTMAP+408                                               09300000
CVTRV486 EQU   CVTMAP+404                                               09301000
CVTRV485 EQU   CVTMAP+400                                               09302000
CVTACTAP EQU   CVTMAP+396                                               09303000
CVTAUTH  EQU   CVTMAP+392                                               09304000
CVTATMCA EQU   CVTATMCT+1                                               09305000
CVTATMST EQU   CVTATMCT                                                 09306000
CVTRSV61 EQU   CVTMAP+384                                               09307000
CVTVOLT1 EQU   CVTVOLM1+1                                               09308000
CVTVOLI1 EQU   CVTVOLF1                                                 09309000
CVTSTOA  EQU   CVTMAP+376                                               09310000
CVTRSV58 EQU   CVTMAP+374                                               09311000
CVTRSV57 EQU   CVTMAP+372                                               09312000
CVTDDCE  EQU   CVTMAP+368                                               09313000
CVTPNWFR EQU   CVTMAP+364                                               09314000
CVTSMF   EQU   CVTMAP+360                                               09315000
CVTSULK  EQU   CVTMAP+358                                               09316000
CVTSLKO  EQU   CVTSYSK                                                  09317000
CVTSLKP  EQU   CVTSYSK                                                  09318000
CVTSLKQ  EQU   CVTSYSK                                                  09319000
CVTSLKR  EQU   CVTSYSK                                                  09320000
CVTRSV56 EQU   CVTSYSK                                                  09321000
CVTRSV55 EQU   CVTSYSK                                                  09322000
CVTRSV54 EQU   CVTSYSK                                                  09323000
CVTRSV53 EQU   CVTSYSK                                                  09324000
CVTRSV52 EQU   CVTA1F1                                                  09325000
CVTRSV51 EQU   CVTA1F1                                                  09326000
CVTRSV50 EQU   CVTA1F1                                                  09327000
CVTRSV49 EQU   CVTA1F1                                                  09328000
CVTRSV48 EQU   CVTA1F1                                                  09329000
CVTRSV47 EQU   CVTA1F1                                                  09330000
CVTSRSW  EQU   CVTA1F1                                                  09331000
CVTPFSW  EQU   CVTA1F1                                                  09332000
CVTPCVT  EQU   CVTMAP+352                                               09333000
CVTRSV46 EQU   CVTMAP+344                                               09334000
CVTRSV45 EQU   CVTMAP+340                                               09335000
CVTRSV44 EQU   CVTMAP+338                                               09336000
CVTRSV43 EQU   CVTMAP+336                                               09337000
CVTHJESA EQU   CVTHJES+1                                                09338000
CVTRSV42 EQU   CVTHJES                                                  09339000
CVTEXT2A EQU   CVTEXT2+1                                                09340000
CVTRSV41 EQU   CVTEXT2                                                  09341000
CVTAPFA  EQU   CVTAPF+1                                                 09342000
CVTRSV40 EQU   CVTAPF                                                   09343000
CVTRV518 EQU   CVTINTLA                                                 09344000
CVTRV517 EQU   CVTERPV                                                  09345000
CVTEORM  EQU   CVTMAP+312                                               09346000
CVTMCHPR EQU   CVTMAP+308                                               09347000
CVTTZ    EQU   CVTMAP+304                                               09348000
CVTJEPS  EQU   CVTMAP+300                                               09349000
CVTJESCT EQU   CVTMAP+296                                               09350000
CVTMODE  EQU   CVTMAP+292                                               09351000
CVTPTRV  EQU   CVTMAP+288                                               09352000
CVTREAL  EQU   CVTMAP+284                                               09353000
CVTRSV39 EQU   CVTMAP+280                                               09354000
CVTRSV38 EQU   CVTMAP+276                                               09355000
CVTDMSRA EQU   CVTDMSR+1                                                09356000
CVTRSV37 EQU   CVTDMSR                                                  09357000
CVTQMSGA EQU   CVTQMSG+1                                                09358000
CVTRSV36 EQU   CVTQMSG                                                  09359000
CVTAMFF  EQU   CVTMAP+264                                               09360000
CVTPURGA EQU   CVTPURG+1                                                09361000
CVTRSV35 EQU   CVTPURG                                                  09362000
CVTCBSP  EQU   CVTMAP+256                                               09363000
CVTATERA EQU   CVTATER+1                                                09364000
CVTSYST  EQU   CVTATER                                                  09365000
CVTVOLT2 EQU   CVTTAT                                                   09366000
CVTVOLI2 EQU   CVTVOLF2                                                 09367000
CVTAQAVB EQU   CVTAQAVT+1                                               09368000
CVTRSV34 EQU   CVTTCMFG                                                 09369000
CVTRSV33 EQU   CVTTCMFG                                                 09370000
CVTRSV32 EQU   CVTTCMFG                                                 09371000
CVTRSV31 EQU   CVTTCMFG                                                 09372000
CVTRSV30 EQU   CVTTCMFG                                                 09373000
CVTRSV29 EQU   CVTTCMFG                                                 09374000
CVTRSV28 EQU   CVTTCMFG                                                 09375000
CVTTCRDY EQU   CVTTCMFG                                                 09376000
CVTGTFA  EQU   CVTGTF+1                                                 09377000
CVTRSV27 EQU   CVTGTFST                                                 09378000
CVTRNIO  EQU   CVTGTFST                                                 09379000
CVTUSR   EQU   CVTGTFST                                                 09380000
CVTRV318 EQU   CVTFORM                                                  09381000
CVTRV317 EQU   CVTTMODE                                                 09382000
CVTRV316 EQU   CVTSTATE                                                 09383000
CVTRV315 EQU   CVTGTFS                                                  09384000
CVTGTFAV EQU   CVTGTFS                                                  09385000
CVT0SCR1 EQU   CVTMAP+232                                               09386000
CVTRV515 EQU   CVTMAP+228                                               09387000
CVTRMS   EQU   CVTMAP+224                                               09388000
CVTPATCH EQU   CVTMAP+220                                               09389000
CVTTSCE  EQU   CVTMAP+216                                               09390000
CVTLNKSC EQU   CVTMAP+214                                               09391000
CVTQABST EQU   CVTMAP+212                                               09392000
CVTMDLDS EQU   CVTMAP+208                                               09393000
CVTUSER  EQU   CVTMAP+204                                               09394000
CVTABEND EQU   CVTMAP+200                                               09395000
CVTSMCA  EQU   CVTMAP+196                                               09396000
CVTRSV18 EQU   CVTMAP+192                                               09397000
CVTQLPAQ EQU   CVTMAP+188                                               09398000
CVTQCDSR EQU   CVTMAP+184                                               09399000
CVTRSV17 EQU   CVTOPTB                                                  09400000
CVTRSV16 EQU   CVTOPTB                                                  09401000
CVTFP    EQU   CVTOPTB                                                  09402000
CVTAPTHR EQU   CVTOPTB                                                  09403000
CVTNLOG  EQU   CVTOPTB                                                  09404000
CVTTOD   EQU   CVTOPTB                                                  09405000
CVTCTIMS EQU   CVTOPTB                                                  09406000
CVTPROT  EQU   CVTOPTB                                                  09407000
CVTXPFP  EQU   CVTOPTA                                                  09408000
CVTASCII EQU   CVTOPTA                                                  09409000
CVTRSV13 EQU   CVTOPTA                                                  09410000
CVTRSV12 EQU   CVTOPTA                                                  09411000
CVTNIP   EQU   CVTOPTA                                                  09412000
CVTDDR   EQU   CVTOPTA                                                  09413000
CVTAPR   EQU   CVTOPTA                                                  09414000
CVTCCH   EQU   CVTOPTA                                                  09415000
CVTSNCTR EQU   CVTMAP+180                                               09416000
CVTQMWR  EQU   CVTMAP+176                                               09417000
CVTQOCR  EQU   CVTMAP+172                                               09418000
CVT1EF00 EQU   CVTMAP+168                                               09419000
CVTMZ00  EQU   CVTMAP+164                                               09420000
CVTHEAD  EQU   CVTMAP+160                                               09421000
CVTRSV11 EQU   CVTMAP+156                                               09422000
CVT0PT01 EQU   CVTMAP+152                                               09423000
CVTMSER  EQU   CVTMAP+148                                               09424000
CVTRV516 EQU   CVTIERLC                                                 09425000
CVTILCH  EQU   CVTMAP+140                                               09426000
CVT0DS   EQU   CVTMAP+136                                               09427000
CVTFBOSV EQU   CVTMAP+132                                               09428000
CVTNUCB  EQU   CVTMAP+128                                               09429000
CVTIXAVL EQU   CVTMAP+124                                               09430000
CVTIOQET EQU   CVTMAP+120                                               09431000
CVTDCBA  EQU   CVTMAP+117                                               09432000
CVTMVS2  EQU   CVTDCB                                                   09433000
CVT6DAT  EQU   CVTDCB                                                   09434000
CVT4MPS  EQU   CVTDCB                                                   09435000
CVTRSV09 EQU   CVTDCB                                                   09436000
CVT4MS1  EQU   CVTDCB                                                   09437000
CVT2SPS  EQU   CVTDCB                                                   09438000
CVT1SSS  EQU   CVTDCB                                                   09439000
CVTRSV08 EQU   CVTDCB                                                   09440000
CVTSTB   EQU   CVTMAP+112                                               09441000
CVTQTD00 EQU   CVTMAP+108                                               09442000
CVTQTE00 EQU   CVTMAP+104                                               09443000
CVTCUCB  EQU   CVTMAP+100                                               09444000
CVTSJQ   EQU   CVTMAP+96                                                09445000
CVTPBLDL EQU   CVTMAP+92                                                09446000
CVTTPC   EQU   CVTMAP+88                                                09447000
CVTSVDCB EQU   CVTMAP+84                                                09448000
CVTBRET  EQU   CVTMAP+82                                                09449000
CVTEXIT  EQU   CVTMAP+80                                                09450000
CVT0FN00 EQU   CVTMAP+76                                                09451000
CVTDARA  EQU   CVTDAR+1                                                 09452000
CVTRSV07 EQU   CVTFLGS1                                                 09453000
CVTRSV06 EQU   CVTFLGS1                                                 09454000
CVTRSV05 EQU   CVTFLGS1                                                 09455000
CVTRSV04 EQU   CVTFLGS1                                                 09456000
CVTRSV03 EQU   CVTFLGS1                                                 09457000
CVTRSV02 EQU   CVTFLGS1                                                 09458000
CVTRSV01 EQU   CVTFLGS1                                                 09459000
CVTDMPLK EQU   CVTFLGS1                                                 09460000
CVTXITP  EQU   CVTMAP+68                                                09461000
CVTZDTAB EQU   CVTMAP+64                                                09462000
CVTMSLT  EQU   CVTMAP+60                                                09463000
CVTDATE  EQU   CVTMAP+56                                                09464000
CVTBTERM EQU   CVTMAP+52                                                09465000
CVTSYSAD EQU   CVTMAP+48                                                09466000
CVTXTLER EQU   CVTMAP+44                                                09467000
CVTILK2  EQU   CVTMAP+40                                                09468000
CVTILK1  EQU   CVTMAP+36                                                09469000
CVTPRLTV EQU   CVTMAP+32                                                09470000
CVTPCNVT EQU   CVTMAP+28                                                09471000
CVT0VL00 EQU   CVTMAP+24                                                09472000
CVTXAPG  EQU   CVTMAP+20                                                09473000
CVTBUF   EQU   CVTMAP+16                                                09474000
CVTJOB   EQU   CVTMAP+12                                                09475000
CVTLINK  EQU   CVTMAP+8                                                 09476000
CVT0EF00 EQU   CVTMAP+4                                                 09477000
CVTTCBP  EQU   CVTMAP                                                   09478000
CVT      EQU   CVTMAP                                                   09479000
UCBERADR EQU   UCBUCS+12                                                09480000
UCBFCBID EQU   UCBUCS+8                                                 09481000
UCBERCNT EQU   UCBUCS+7                                                 09482000
UCBRSV51 EQU   UCBUCS+6                                                 09483000
UCBRSV50 EQU   UCBFCBOP                                                 09484000
UCBRSV49 EQU   UCBFCBOP                                                 09485000
UCBRSV48 EQU   UCBFCBOP                                                 09486000
UCBRSV47 EQU   UCBFCBOP                                                 09487000
UCBRSV46 EQU   UCBFCBOP                                                 09488000
UCBRSV45 EQU   UCBFCBOP                                                 09489000
UCBRSV44 EQU   UCBFCBOP                                                 09490000
UCBFCBO1 EQU   UCBFCBOP                                                 09491000
UCBUCSPE EQU   UCBUCSOP                                                 09492000
UCBRSV43 EQU   UCBUCSOP                                                 09493000
UCBRSV42 EQU   UCBUCSOP                                                 09494000
UCBRSV41 EQU   UCBUCSOP                                                 09495000
UCBRSV40 EQU   UCBUCSOP                                                 09496000
UCBRSV39 EQU   UCBUCSOP                                                 09497000
UCBUCSO2 EQU   UCBUCSOP                                                 09498000
UCBUCSO1 EQU   UCBUCSOP                                                 09499000
UCBUCSID EQU   UCBUCS                                                   09500000
UCBRV073 EQU   UCB3540X+7                                               09501000
UCBRV072 EQU   UCBDKBYT                                                 09502000
UCBRV071 EQU   UCBDKBYT                                                 09503000
UCBRV070 EQU   UCBDKBYT                                                 09504000
UCBRV069 EQU   UCBDKBYT                                                 09505000
UCBRV068 EQU   UCBDKBYT                                                 09506000
UCBRV067 EQU   UCBDKBYT                                                 09507000
UCBVLVER EQU   UCBDKBYT                                                 09508000
UCBDKAMX EQU   UCBDKBYT                                                 09509000
UCBRDATA EQU   UCBOCR+4                                                 09510000
UCBFRID  EQU   UCBOCR                                                   09511000
UCBCLN   EQU   UCBMT+14                                                 09512000
UCBERG   EQU   UCBMT+12                                                 09513000
UCBMS    EQU   UCBMT+11                                                 09514000
UCBNB    EQU   UCBMT+10                                                 09515000
UCBPW    EQU   UCBMT+9                                                  09516000
UCBPR    EQU   UCBMT+8                                                  09517000
UCBSIO   EQU   UCBMT+6                                                  09518000
UCBTW    EQU   UCBMT+5                                                  09519000
UCBTR    EQU   UCBMT+4                                                  09520000
UCBTWT   EQU   UCBMT+3                                                  09521000
UCBTRT   EQU   UCBMT+2                                                  09522000
UCBCTD   EQU   UCBMT                                                    09523000
UCBWTOID EQU   UCBCMEXT+17                                              09524000
UCBRV043 EQU   UCBCMEXT+16                                              09525000
UCBASID  EQU   UCBCMEXT+14                                              09526000
UCBMFCNT EQU   UCBCMEXT+12                                              09527000
UCBPMSK  EQU   UCBCMEXT+10                                              09528000
UCBCCWOF EQU   UCBCMEXT+8                                               09529000
UCBRV041 EQU   UCBCMEXT+6                                               09530000
UCBRV036 EQU   UCBFLP1                                                  09531000
UCBRV035 EQU   UCBFLP1                                                  09532000
UCBRV034 EQU   UCBFLP1                                                  09533000
UCBRV033 EQU   UCBFLP1                                                  09534000
UCBRV032 EQU   UCBFLP1                                                  09535000
UCBRV031 EQU   UCBFLP1                                                  09536000
UCBSHRUP EQU   UCBFLP1                                                  09537000
UCBNSRCH EQU   UCBFLP1                                                  09538000
UCBSNSCT EQU   UCBCMEXT+4                                               09539000
UCBHPDV  EQU   @NM00034                                                 09540000
UCBHALI  EQU   @NM00034                                                 09541000
UCBRSV09 EQU   @NM00034                                                 09542000
UCBRSV08 EQU   @NM00034                                                 09543000
UCBRSV07 EQU   @NM00034                                                 09544000
UCBRSV06 EQU   @NM00034                                                 09545000
UCBRSV05 EQU   @NM00034                                                 09546000
UCBRSV04 EQU   @NM00034                                                 09547000
UCBDTI   EQU   UCBCMEXT+2                                               09548000
UCBSTI   EQU   UCBCMEXT+1                                               09549000
UCBETI   EQU   UCBCMEXT                                                 09550000
UCBEXTP  EQU   UCBEXTPT+1                                               09551000
UCBDDRSW EQU   UCBFLC                                                   09552000
UCBTICBT EQU   UCBFLC                                                   09553000
UCBIVRR  EQU   UCBFLC                                                   09554000
UCBIVRS  EQU   UCBFLC                                                   09555000
UCBITF   EQU   UCBFLC                                                   09556000
UCBUDE   EQU   UCBFLC                                                   09557000
UCBWAA   EQU   UCBFLC                                                   09558000
UCBATTP  EQU   UCBFLC                                                   09559000
UCBUNTYP EQU   UCBTBYT4                                                 09560000
UCBRSV11 EQU   UCBDVCLS                                                 09561000
UCBRSV10 EQU   UCBDVCLS                                                 09562000
UCB3CHAR EQU   UCBDVCLS                                                 09563000
UCB3UREC EQU   UCBDVCLS                                                 09564000
UCB3DISP EQU   UCBDVCLS                                                 09565000
UCB3COMM EQU   UCBDVCLS                                                 09566000
UCB3TAPE EQU   UCBDVCLS                                                 09567000
UCBDVPWR EQU   UCB2OPT7                                                 09568000
UCBVLPWR EQU   UCB2OPT6                                                 09569000
UCB2OPT5 EQU   UCBTBYT2                                                 09570000
UCBRVDEV EQU   UCBRWTAU                                                 09571000
UCBRPS   EQU   UCBDUDN2                                                 09572000
UCBRR    EQU   UCBDUDN1                                                 09573000
UCB2OPT1 EQU   UCBTBYT2                                                 09574000
UCB2OPT0 EQU   UCBTBYT2                                                 09575000
UCB1FEA7 EQU   UCBTBYT1                                                 09576000
UCBD6250 EQU   UCB1FEA6                                                 09577000
UCBD1600 EQU   UCB1FEA5                                                 09578000
UCB1FEA4 EQU   UCBTBYT1                                                 09579000
UCB1FEA3 EQU   UCBTBYT1                                                 09580000
UCB1FEA2 EQU   UCBTBYT1                                                 09581000
UCB1FEA1 EQU   UCBTBYT1                                                 09582000
UCB1FEA0 EQU   UCBTBYT1                                                 09583000
UCBRV029 EQU   UCBWGT                                                   09584000
UCBVHRSN EQU   UCBWGT                                                   09585000
UCBVORSN EQU   UCBWGT                                                   09586000
UCBMTPXP EQU   UCBWGT                                                   09587000
UCBREW   EQU   UCBWGT                                                   09588000
UCBPUB   EQU   UCBWGT                                                   09589000
UCBOUT   EQU   UCBWGT                                                   09590000
UCBIN    EQU   UCBWGT                                                   09591000
UCBCPU   EQU   UCBOB+11                                                 09592000
UCBLCI   EQU   UCBOB+10                                                 09593000
UCBCNT   EQU   UCBOB+9                                                  09594000
UCBRV017 EQU   UCBCHM1                                                  09595000
UCBRV016 EQU   UCBCHM1                                                  09596000
UCBRV015 EQU   UCBCHM1                                                  09597000
UCBRV014 EQU   UCBCHM1                                                  09598000
UCBSPB   EQU   UCBPTH1                                                  09599000
UCBPPB   EQU   UCBPTH1                                                  09600000
UCBSPA   EQU   UCBPTH0                                                  09601000
UCBPPA   EQU   UCBPTH0                                                  09602000
UCBFLB7  EQU   UCBFLB                                                   09603000
UCBVALPH EQU   UCBFLB                                                   09604000
UCBCRHSN EQU   UCBFLB                                                   09605000
UCBCRHRV EQU   UCBFLB                                                   09606000
UCBRESVH EQU   UCBFLB                                                   09607000
UCBSPST  EQU   UCBFLB                                                   09608000
UCBASNS  EQU   UCBFLB                                                   09609000
UCBIORST EQU   UCBFLB                                                   09610000
UCBQISCE EQU   UCBFL1                                                   09611000
UCBACTV  EQU   UCBFL1                                                   09612000
UCBSAP   EQU   UCBFL1                                                   09613000
UCBNOTRC EQU   UCBCUB                                                   09614000
UCBPSNS  EQU   UCBFL1                                                   09615000
UCBUSING EQU   UCBPST                                                   09616000
UCBNOTRD EQU   UCBNRY                                                   09617000
UCBBUSYD EQU   UCBBSY                                                   09618000
UCBUA    EQU   UCBCHAN+1                                                09619000
UCBCHA   EQU   UCBCHAN                                                  09620000
UCBDADI  EQU   UCBSTAT                                                  09621000
UCBSYSR  EQU   UCBSTAT                                                  09622000
UCBPRES  EQU   UCBSTAT                                                  09623000
UCBALOC  EQU   UCBSTAT                                                  09624000
UCBUNLD  EQU   UCBSTAT                                                  09625000
UCBRESV  EQU   UCBSTAT                                                  09626000
UCBCHGS  EQU   UCBSTAT                                                  09627000
UCBONLI  EQU   UCBSTAT                                                  09628000
UCBID    EQU   UCBOB+2                                                  09629000
UCBALTPH EQU   UCBFL5                                                   09630000
UCBALTCU EQU   UCBFL5                                                   09631000
UCBNALOC EQU   UCBFL5                                                   09632000
UCBENVRD EQU   UCBFL5                                                   09633000
UCBVSDR  EQU   UCBFL5                                                   09634000
UCBSASK  EQU   UCBFL5                                                   09635000
UCBAMV   EQU   UCBAF                                                    09636000
UCBDCC   EQU   UCBFL5                                                   09637000
UCBMONT  EQU   UCBJBNR                                                  09638000
UCBRV011 EQU   UCBJBNR                                                  09639000
UCBRSV02 EQU   UCBJBNR                                                  09640000
UCBOLDSM EQU   UCBJBNR                                                  09641000
UCBRV003 EQU   UCBJBNR                                                  09642000
UCBRV002 EQU   UCBJBNR                                                  09643000
UCBJES3  EQU   UCBJBNR                                                  09644000
UCBVRDEV EQU   UCBJBNR                                                  09645000
UCBCMSEG EQU   UCBOB                                                    09646000
UCBPFXND EQU   UCB+512                                                  09647000
UCBIOQ   EQU   UCB+508                                                  09648000
UCBPXST  EQU   UCB+504                                                  09649000
@NM00031 EQU   UCB                                                      09650000
TIOCSTEP EQU   TIOT1+8                                                  09651000
TIOCNJOB EQU   TIOT1                                                    09652000
DCBEOB   EQU   IHADCS40+20                                              09653000
DCBPRECL EQU   IHADCS40+18                                              09654000
@NM00028 EQU   IHADCS40+16                                              09655000
@NM00027 EQU   @NM00025+1                                               09656000
@NM00026 EQU   DCBEROPT                                                 09657000
DCBERABE EQU   DCBEROPT                                                 09658000
DCBERSKP EQU   DCBEROPT                                                 09659000
DCBERACC EQU   DCBEROPT                                                 09660000
@NM00024 EQU   IHADCS40+10                                              09661000
@NM00023 EQU   IHADCS40+9                                               09662000
@NM00022 EQU   IHADCS40+8                                               09663000
DCBRECA  EQU   DCBRECAD+1                                               09664000
@NM00021 EQU   DCBRECBT                                                 09665000
DCBRCFGT EQU   DCBRCREL                                                 09666000
DCBRCTRU EQU   DCBRCREL                                                 09667000
DCBLCCW  EQU   DCBEOBAD                                                 09668000
DCBNOTE  EQU   DCBCNTRL                                                 09669000
@NM00020 EQU   IHADCS38+8                                               09670000
DCBEOBW  EQU   IHADCS38+4                                               09671000
DCBEOBRA EQU   DCBEOBR+1                                                09672000
DCBNCP   EQU   DCBEOBR                                                  09673000
@NM00019 EQU   DCBFLAG1                                                 09674000
DCBSTFLS EQU   DCBFLAG1                                                 09675000
DCBSTQCK EQU   DCBFLAG1                                                 09676000
DCBDIRCQ EQU   DCBBUFOF                                                 09677000
DCBQSTRU EQU   DCBUSASI                                                 09678000
@NM00018 EQU   DCBUSASI                                                 09679000
DCBQADF3 EQU   DCBQADFS                                                 09680000
DCBQADF2 EQU   DCBQADFS                                                 09681000
DCBQADF1 EQU   DCBQADFS                                                 09682000
DCBBLBP  EQU   DCBUSASI                                                 09683000
@NM00017 EQU   DCBUSASI                                                 09684000
DCBCICBA EQU   DCBCICB+1                                                09685000
@NM00016 EQU   DCBCICB                                                  09686000
DCBOFFSW EQU   IHADCS36+15                                              09687000
DCBOFFSR EQU   IHADCS36+14                                              09688000
DCBWCPL  EQU   IHADCS36+13                                              09689000
DCBWCPO  EQU   IHADCS36+12                                              09690000
DCBCNQSM EQU   DCBCIND2                                                 09691000
DCBCNFEO EQU   DCBCIND2                                                 09692000
DCBCNCHS EQU   DCBCIND2                                                 09693000
DCBCNBFP EQU   DCBCIND2                                                 09694000
DCBCNIOE EQU   DCBCIND2                                                 09695000
DCBCNCLO EQU   DCBCIND2                                                 09696000
DCBCNWRO EQU   DCBCIND2                                                 09697000
DCBCNSTO EQU   DCBCIND2                                                 09698000
DCBCNEXB EQU   DCBCIND1                                                 09699000
@NM00015 EQU   DCBCIND1                                                 09700000
DCBCNBRM EQU   DCBCIND1                                                 09701000
@NM00014 EQU   DCBCIND1                                                 09702000
DCBCNEVA EQU   DCBCIND1                                                 09703000
DCBCNEVB EQU   DCBCIND1                                                 09704000
DCBCNSRD EQU   DCBCIND1                                                 09705000
DCBCNTOV EQU   DCBCIND1                                                 09706000
DCBSYNA  EQU   DCBSYNAD+1                                               09707000
DCBIOBL  EQU   DCBSYNAD                                                 09708000
DCBCHCKA EQU   DCBPERRA                                                 09709000
@NM00013 EQU   DCBOPTCD                                                 09710000
DCBOPTT  EQU   DCBOPTCD                                                 09711000
DCBSRCHD EQU   DCBOPTZ                                                  09712000
DCBOPTQ  EQU   DCBOPTCD                                                 09713000
DCBBCKPT EQU   DCBOPTO                                                  09714000
DCBOPTC  EQU   DCBOPTCD                                                 09715000
DCBOPTU  EQU   DCBOPTCD                                                 09716000
DCBOPTW  EQU   DCBOPTCD                                                 09717000
DCBPUTA  EQU   DCBGETA                                                  09718000
@NM00012 EQU   DCBPUT                                                   09719000
DCBREADA EQU   DCBWRITA                                                 09720000
@NM00011 EQU   DCBREAD                                                  09721000
@NM00010 EQU   DCBIFLGS                                                 09722000
DCBIFIOE EQU   DCBIFLGS                                                 09723000
DCBIFPCT EQU   DCBIFLGS                                                 09724000
DCBMFSTI EQU   DCBMFDMD                                                 09725000
DCBMFAWR EQU   DCBMFSTK                                                 09726000
DCBMFUIP EQU   DCBMFTMD                                                 09727000
DCBMFIDW EQU   DCBMFLCP                                                 09728000
DCBMFWRK EQU   DCBMFMVP                                                 09729000
DCBMFRDQ EQU   DCBMFWRT                                                 09730000
DCBMFGTQ EQU   DCBMFPUT                                                 09731000
DCBMFSTL EQU   DCBMACF2                                                 09732000
DCBMFCK  EQU   DCBMFDMG                                                 09733000
DCBMFRDX EQU   DCBMFCHK                                                 09734000
DCBMFDBF EQU   DCBMFSBG                                                 09735000
DCBMFRDI EQU   DCBMFLCG                                                 09736000
DCBMFRDK EQU   DCBMFMVG                                                 09737000
DCBMFWRQ EQU   DCBMFRD                                                  09738000
DCBMFPTQ EQU   DCBMFGET                                                 09739000
DCBMFECP EQU   DCBMACF1                                                 09740000
DCBTIOT  EQU   IHADCS25                                                 09741000
DCBMRSTI EQU   DCBMRDMD                                                 09742000
DCBMRAWR EQU   DCBMRSTK                                                 09743000
DCBMRUIP EQU   DCBMRTMD                                                 09744000
DCBMRIDW EQU   DCBMRLCP                                                 09745000
DCBMRWRK EQU   DCBMRMVP                                                 09746000
DCBMRRDQ EQU   DCBMRWRT                                                 09747000
DCBMRGTQ EQU   DCBMRPUT                                                 09748000
DCBMRSTL EQU   DCBMACR2                                                 09749000
DCBMRCK  EQU   DCBMRDMG                                                 09750000
DCBPGFXA EQU   DCBMRRDX                                                 09751000
DCBMRDBF EQU   DCBMRSBG                                                 09752000
DCBMRRDI EQU   DCBMRLCG                                                 09753000
DCBMRRDK EQU   DCBMRMVG                                                 09754000
DCBMRWRQ EQU   DCBMRRD                                                  09755000
DCBMRPTQ EQU   DCBMRGET                                                 09756000
DCBMRECP EQU   DCBMACR1                                                 09757000
@NM00009 EQU   DCBIFLG                                                  09758000
DCBIBIOE EQU   DCBIFLG                                                  09759000
DCBIBPCT EQU   DCBIFLG                                                  09760000
DCBIBEC  EQU   DCBIFLG                                                  09761000
DCBOFIOF EQU   DCBOFLGS                                                 09762000
DCBOFUEX EQU   DCBOFLGS                                                 09763000
DCBOFTM  EQU   DCBOFLGS                                                 09764000
DCBOFPPC EQU   DCBOFLGS                                                 09765000
DCBOFEOV EQU   DCBOFLGS                                                 09766000
DCBOFLRB EQU   DCBOFLGS                                                 09767000
DCBOFIOD EQU   DCBOFLWR                                                 09768000
DCBDDNAM EQU   IHADCS24                                                 09769000
DCBEXLSA EQU   DCBEXLST+1                                               09770000
DCBRECKL EQU   DCBRECFM                                                 09771000
DCBRECCC EQU   DCBRECFM                                                 09772000
DCBRECSB EQU   DCBRECFM                                                 09773000
DCBRECBR EQU   DCBRECFM                                                 09774000
DCBRECTO EQU   DCBRECLA                                                 09775000
DCBRECL  EQU   DCBRECLA                                                 09776000
DCBEODA  EQU   DCBEODAD+1                                               09777000
DCBBFA   EQU   DCBBFTEK                                                 09778000
DCBH0    EQU   DCBBFTEK                                                 09779000
DCBBFTKD EQU   DCBBFTEK                                                 09780000
DCBBFTE  EQU   DCBBFT                                                   09781000
DCBBFTKR EQU   DCBBFT                                                   09782000
DCBBFTS  EQU   DCBBFT                                                   09783000
DCBH1    EQU   DCBBFTEK                                                 09784000
DCBSVCXA EQU   DCBSVCXL+1                                               09785000
@NM00008 EQU   DCBSVCXL                                                 09786000
DCBODEBA EQU   DCBIOBAA                                                 09787000
@NM00007 EQU   DCBQSLM                                                  09788000
DCBUPDBT EQU   DCBQSLM                                                  09789000
DCBUPDCM EQU   DCBQSLM                                                  09790000
DCB1DVDS EQU   DCBQSLM                                                  09791000
@NM00006 EQU   DCBDSRG2                                                 09792000
DCBDSGTR EQU   DCBDSRG2                                                 09793000
DCBACBM  EQU   DCBDSRG2                                                 09794000
@NM00005 EQU   DCBDSRG2                                                 09795000
DCBDSGTQ EQU   DCBDSRG2                                                 09796000
DCBDSGTX EQU   DCBDSRG2                                                 09797000
DCBDSGGS EQU   DCBDSRG2                                                 09798000
DCBDSGU  EQU   DCBDSRG1                                                 09799000
DCBDSGPO EQU   DCBDSRG1                                                 09800000
DCBDSGMQ EQU   DCBDSRG1                                                 09801000
DCBDSGCQ EQU   DCBDSRG1                                                 09802000
DCBDSGCX EQU   DCBDSRG1                                                 09803000
DCBDSGDA EQU   DCBDSRG1                                                 09804000
DCBDSGPS EQU   DCBDSRG1                                                 09805000
DCBDSGIS EQU   DCBDSRG1                                                 09806000
DCBBUFL  EQU   IHADCS11+8                                               09807000
DCBBUFCA EQU   DCBBUFCB+1                                               09808000
DCBBUFNO EQU   DCBBUFCB                                                 09809000
DCBDEVT  EQU   DCBREL                                                   09810000
DCBKEYLE EQU   DCBRELB                                                  09811000
DCBTRBAL EQU   IHADCS01+6                                               09812000
@NM00004 EQU   IHADCS01+5                                               09813000
@NM00003 EQU   IHADCS01+4                                               09814000
DCBDVTBA EQU   DCBDVTBL+1                                               09815000
@NM00002 EQU   DCBDVTBL                                                 09816000
DCBKEYCN EQU   IHADCS00+4                                               09817000
DCBRELAD EQU   IHADCS00                                                 09818000
@NM00001 EQU   IHADCB                                                   09819000
@NM00060 EQU   PSA+3668                                                 09820000
PSASTAK  EQU   PSA+3072                                                 09821000
@NM00059 EQU   PSA+1040                                                 09822000
PSAUSEND EQU   PSA+1040                                                 09823000
PSARV062 EQU   PSA+1036                                                 09824000
PSAATCVT EQU   PSA+1032                                                 09825000
PSAPCPSW EQU   PSA+1024                                                 09826000
PSAPIR2  EQU   PSA+1020                                                 09827000
PSARV059 EQU   PSA+1018                                                 09828000
PSASVC13 EQU   PSA+1016                                                 09829000
PSALSFCC EQU   PSA+1012                                                 09830000
PSASFACC EQU   PSA+1008                                                 09831000
PSASTOP  EQU   PSA+992                                                  09832000
PSASTART EQU   PSA+976                                                  09833000
PSARSPSW EQU   PSA+968                                                  09834000
PSASRPSW EQU   PSA+960                                                  09835000
PSARV045 EQU   PSA+892                                                  09836000
PSARV044 EQU   PSA+888                                                  09837000
PSARV043 EQU   PSA+884                                                  09838000
PSARV042 EQU   PSA+880                                                  09839000
PSARV041 EQU   PSA+876                                                  09840000
PSARV040 EQU   PSA+872                                                  09841000
PSARV025 EQU   PSA+868                                                  09842000
PSADSSED EQU   PSA+868                                                  09843000
PSADSSPR EQU   PSA+864                                                  09844000
PSADSSFW EQU   PSA+860                                                  09845000
PSADSS14 EQU   PSA+856                                                  09846000
PSADSSPP EQU   PSA+848                                                  09847000
PSADSSRP EQU   PSA+840                                                  09848000
PSADSS05 EQU   PSADSSF4                                                 09849000
PSADSS10 EQU   PSADSSF4                                                 09850000
PSADSSVE EQU   PSADSSF4                                                 09851000
PSADSSDE EQU   PSADSSF4                                                 09852000
PSADSSC0 EQU   PSADSSF4                                                 09853000
PSADSSIE EQU   PSADSSF4                                                 09854000
PSADSS12 EQU   PSADSSF4                                                 09855000
PSADSSRC EQU   PSADSSF4                                                 09856000
PSARV057 EQU   PSADSSF3                                                 09857000
PSARV056 EQU   PSADSSF3                                                 09858000
PSARV055 EQU   PSADSSF3                                                 09859000
PSADSSMC EQU   PSADSSF3                                                 09860000
PSADSSRW EQU   PSADSSF3                                                 09861000
PSADSSNM EQU   PSADSSF3                                                 09862000
PSADSSES EQU   PSADSSF3                                                 09863000
PSADSSGP EQU   PSADSSF3                                                 09864000
PSADSSF2 EQU   PSADSSFL+1                                               09865000
PSADSSPI EQU   PSADSSF1                                                 09866000
PSADSSOI EQU   PSADSSF1                                                 09867000
PSADSSSP EQU   PSADSSF1                                                 09868000
PSADSSTP EQU   PSADSSF1                                                 09869000
PSADSSDW EQU   PSADSSF1                                                 09870000
PSADSSDD EQU   PSADSSF1                                                 09871000
PSADSSDM EQU   PSADSSF1                                                 09872000
PSADSSMV EQU   PSADSSF1                                                 09873000
PSADSSTS EQU   PSA+816                                                  09874000
PSADSSWK EQU   PSA+812                                                  09875000
PSADSSR3 EQU   PSA+808                                                  09876000
PSADSSR2 EQU   PSA+804                                                  09877000
PSADSSRS EQU   PSA+800                                                  09878000
PSASTOR  EQU   PSA+796                                                  09879000
PSACPUSA EQU   PSA+794                                                  09880000
PSAVSTAP EQU   PSA+792                                                  09881000
PSAWKVAP EQU   PSA+788                                                  09882000
PSAWKRAP EQU   PSA+784                                                  09883000
PSAMCHIC EQU   PSA+783                                                  09884000
PSARV061 EQU   PSA+782                                                  09885000
PSASYMSK EQU   PSA+781                                                  09886000
PSAMCHFL EQU   PSA+780                                                  09887000
PSACR0   EQU   PSA+776                                                  09888000
PSAPSWSV EQU   PSA+768                                                  09889000
PSALITA  EQU   PSA+764                                                  09890000
PSACLHS  EQU   PSAHLHI                                                  09891000
PSALKR15 EQU   PSALKSA+60                                               09892000
PSALKR14 EQU   PSALKSA+56                                               09893000
PSALKR13 EQU   PSALKSA+52                                               09894000
PSALKR12 EQU   PSALKSA+48                                               09895000
PSALKR11 EQU   PSALKSA+44                                               09896000
PSALKR10 EQU   PSALKSA+40                                               09897000
PSALKR9  EQU   PSALKSA+36                                               09898000
PSALKR8  EQU   PSALKSA+32                                               09899000
PSALKR7  EQU   PSALKSA+28                                               09900000
PSALKR6  EQU   PSALKSA+24                                               09901000
PSALKR5  EQU   PSALKSA+20                                               09902000
PSALKR4  EQU   PSALKSA+16                                               09903000
PSALKR3  EQU   PSALKSA+12                                               09904000
PSALKR2  EQU   PSALKSA+8                                                09905000
PSALKR1  EQU   PSALKSA+4                                                09906000
PSALKR0  EQU   PSALKSA                                                  09907000
PSARV023 EQU   PSACLHT+52                                               09908000
PSALOCAL EQU   PSACLHT+48                                               09909000
PSACMSL  EQU   PSACLHT+44                                               09910000
PSAOPTL  EQU   PSACLHT+40                                               09911000
PSATPACL EQU   PSACLHT+36                                               09912000
PSATPDNL EQU   PSACLHT+32                                               09913000
PSATPNCL EQU   PSACLHT+28                                               09914000
PSAIOSLL EQU   PSACLHT+24                                               09915000
PSAIOSUL EQU   PSACLHT+20                                               09916000
PSAIOSCL EQU   PSACLHT+16                                               09917000
PSAIOSSL EQU   PSACLHT+12                                               09918000
PSASALCL EQU   PSACLHT+8                                                09919000
PSAASML  EQU   PSACLHT+4                                                09920000
PSADISPL EQU   PSACLHT                                                  09921000
PSASRSA  EQU   PSA+636                                                  09922000
PSARV050 EQU   PSA+634                                                  09923000
PSADSSGO EQU   PSA+633                                                  09924000
PSARECUR EQU   PSA+632                                                  09925000
PSAHLHIS EQU   PSA+628                                                  09926000
PSAIPCSA EQU   PSA+624                                                  09927000
@NM00058 EQU   PSA+621                                                  09928000
PSAIPCDM EQU   PSA+620                                                  09929000
PSAIPCD  EQU   PSA+616                                                  09930000
@NM00057 EQU   PSA+613                                                  09931000
PSAIPCRM EQU   PSA+612                                                  09932000
PSAIPCR  EQU   PSA+608                                                  09933000
PSAMCHEX EQU   PSA+600                                                  09934000
PSAMPSW  EQU   PSA+592                                                  09935000
PSAEXPS2 EQU   PSA+584                                                  09936000
PSAEXPS1 EQU   PSA+576                                                  09937000
PSAPIREG EQU   PSA+572                                                  09938000
PSARSREG EQU   PSA+568                                                  09939000
PSAGPREG EQU   PSA+556                                                  09940000
PSARV022 EQU   PSASUP4                                                  09941000
PSARV021 EQU   PSASUP4                                                  09942000
PSARV020 EQU   PSASUP4                                                  09943000
PSARV019 EQU   PSASUP4                                                  09944000
PSARV018 EQU   PSASUP4                                                  09945000
PSARV017 EQU   PSASUP4                                                  09946000
PSARV016 EQU   PSASUP4                                                  09947000
PSARV015 EQU   PSASUP4                                                  09948000
PSARV014 EQU   PSASUP3                                                  09949000
PSARV013 EQU   PSASUP3                                                  09950000
PSARV012 EQU   PSASUP3                                                  09951000
PSARV011 EQU   PSASUP3                                                  09952000
PSARV010 EQU   PSASUP3                                                  09953000
PSAPSREG EQU   PSASUP3                                                  09954000
PSAPI2   EQU   PSASUP3                                                  09955000
PSAIOSUP EQU   PSASUP3                                                  09956000
PSALCR   EQU   PSASUP2                                                  09957000
PSARTM   EQU   PSASUP2                                                  09958000
PSAACR   EQU   PSASUP2                                                  09959000
PSAIPCE2 EQU   PSASUP2                                                  09960000
PSAIPCES EQU   PSASUP2                                                  09961000
PSAIPCEC EQU   PSASUP2                                                  09962000
PSAGTF   EQU   PSASUP2                                                  09963000
PSAIPCRI EQU   PSASUP2                                                  09964000
PSAIPCRP EQU   PSASUP1                                                  09965000
PSAIPCDR EQU   PSASUP1                                                  09966000
PSADISP  EQU   PSASUP1                                                  09967000
PSALOCK  EQU   PSASUP1                                                  09968000
PSAPI    EQU   PSASUP1                                                  09969000
PSAEXT   EQU   PSASUP1                                                  09970000
PSASVC   EQU   PSASUP1                                                  09971000
PSAIO    EQU   PSASUP1                                                  09972000
PSAAOLD  EQU   PSA+548                                                  09973000
PSAANEW  EQU   PSA+544                                                  09974000
PSATOLD  EQU   PSA+540                                                  09975000
PSATNEW  EQU   PSA+536                                                  09976000
PSALCCAR EQU   PSA+532                                                  09977000
PSALCCAV EQU   PSA+528                                                  09978000
PSAPCCAR EQU   PSA+524                                                  09979000
PSAPCCAV EQU   PSA+520                                                  09980000
PSACPULA EQU   PSA+518                                                  09981000
PSACPUPA EQU   PSA+516                                                  09982000
PSAPSA   EQU   PSA+512                                                  09983000
FLCHDEND EQU   PSA+512                                                  09984000
FLCCRSAV EQU   FLCMCLA+280                                              09985000
FLCGRSAV EQU   FLCMCLA+216                                              09986000
FLCFPSAV EQU   FLCMCLA+184                                              09987000
FLCFLA   EQU   FLCMCLA+88                                               09988000
FLCRGNCD EQU   FLCMCLA+84                                               09989000
FLCFSAA  EQU   FLCFSA+1                                                 09990000
@NM00056 EQU   FLCFSA                                                   09991000
@NM00055 EQU   FLCMCLA+72                                               09992000
FLCMCIC  EQU   FLCMCLA+64                                               09993000
@NM00054 EQU   FLCMCLA+20                                               09994000
FLCIOAA  EQU   FLCIOA+1                                                 09995000
@NM00053 EQU   FLCIOA                                                   09996000
@NM00052 EQU   FLCMCLA+15                                               09997000
@NM00051 EQU   FLCMCLA+14                                               09998000
@NM00050 EQU   FLCMCLA+12                                               09999000
FLCLCL   EQU   FLCMCLA+8                                                10000000
FLCIOELA EQU   FLCIOEL+1                                                10001000
@NM00049 EQU   FLCIOEL                                                  10002000
FLCCHNID EQU   FLCMCLA                                                  10003000
@NM00048 EQU   PSA+160                                                  10004000
FLCMTRCD EQU   PSA+157                                                  10005000
@NM00047 EQU   PSA+156                                                  10006000
FLCPERA  EQU   FLCPER+1                                                 10007000
@NM00046 EQU   FLCPER                                                   10008000
@NM00045 EQU   PSA+151                                                  10009000
FLCPERCD EQU   PSA+150                                                  10010000
FLCMCNUM EQU   PSA+149                                                  10011000
@NM00044 EQU   PSA+148                                                  10012000
FLCTEAA  EQU   FLCTEA+1                                                 10013000
@NM00043 EQU   FLCTEA                                                   10014000
PSAPIPC  EQU   PSAPICOD                                                 10015000
PSAPIMC  EQU   PSAPICOD                                                 10016000
PSAPIPER EQU   PSAPICOD                                                 10017000
PSARV049 EQU   FLCPICOD                                                 10018000
FLCPILCB EQU   FLCPIILC                                                 10019000
@NM00042 EQU   FLCPIILC                                                 10020000
@NM00041 EQU   PSAEPPSW                                                 10021000
FLCSVCN  EQU   PSAESPSW+2                                               10022000
FLCSILCB EQU   FLCSVILC                                                 10023000
@NM00040 EQU   FLCSVILC                                                 10024000
@NM00039 EQU   PSAESPSW                                                 10025000
FLCEICOD EQU   PSAEEPSW+2                                               10026000
PSASPAD  EQU   PSAEEPSW                                                 10027000
@NM00038 EQU   PSA+128                                                  10028000
FLCINPSW EQU   PSA+120                                                  10029000
FLCMNPSW EQU   PSA+112                                                  10030000
FLCPNPSW EQU   PSA+104                                                  10031000
FLCSNPSW EQU   PSA+96                                                   10032000
FLCENPSW EQU   PSA+88                                                   10033000
FLCTRACE EQU   PSA+84                                                   10034000
FLCTIMER EQU   PSA+80                                                   10035000
FLCCVT2  EQU   PSA+76                                                   10036000
FLCCAW   EQU   PSA+72                                                   10037000
FLCCSW   EQU   PSA+64                                                   10038000
FLCIOPSW EQU   PSA+56                                                   10039000
FLCMOPSW EQU   PSA+48                                                   10040000
FLCPOPSW EQU   PSA+40                                                   10041000
FLCSOPSW EQU   PSA+32                                                   10042000
FLCEOPSW EQU   PSA+24                                                   10043000
@NM00037 EQU   FLCICCW2+4                                               10044000
FLCCVT   EQU   FLCICCW2                                                 10045000
FLCICCW1 EQU   FLCROPSW                                                 10046000
FLCIPPSW EQU   FLCRNPSW                                                 10047000
*                                      END UNREFERENCED COMPONENTS      10048000
@RF00302 EQU   @RC00290                                                 10049000
@RF00324 EQU   @EL00002                                                 10050000
@RF00328 EQU   @EL00003                                                 10051000
@RF00332 EQU   @EL00004                                                 10052000
@RC00416 EQU   @RC00415                                                 10053000
@RF00400 EQU   @EL00006                                                 10054000
@RC00466 EQU   CNTRLSTM                                                 10055000
@RC00464 EQU   CNTRLSTM                                                 10056000
@RC00478 EQU   CE0001@                                                  10057000
@RC00492 EQU   CE0001@                                                  10058000
@RF00592 EQU   @RC00587                                                 10059000
@RC00590 EQU   @RC00587                                                 10060000
@RC00786 EQU   CE0001@                                                  10061000
@RC00873 EQU   @RC00871                                                 10062000
@RF00902 EQU   @EL00008                                                 10063000
@RF01012 EQU   @EL00008                                                 10064000
@RF01081 EQU   @EL00009                                                 10065000
@RF01121 EQU   @EL00010                                                 10066000
@RF01120 EQU   @EL00010                                                 10067000
@RF01151 EQU   @EL00011                                                 10068000
CONT1    EQU   @EL00016                                                 10069000
@RC01404 EQU   @EL00017                                                 10070000
@RC01445 EQU   @EL00018                                                 10071000
@RF01590 EQU   @EL00019                                                 10072000
@RF01606 EQU   @EL00019                                                 10073000
@RF01706 EQU   @RC01693                                                 10074000
@RF01717 EQU   @EL00020                                                 10075000
CONT     EQU   @EL00021                                                 10076000
@RF01795 EQU   @EL00022                                                 10077000
@RF02038 EQU   @EL00028                                                 10078000
@RF01327 EQU   CONT1                                                    10079000
@RF01326 EQU   CONT1                                                    10080000
@RF01732 EQU   CONT                                                     10081000
@ENDDATA EQU   *                                                        10082000
         END   IEBDISKT,(C'PLS0823',0701,77320)                         10083000
