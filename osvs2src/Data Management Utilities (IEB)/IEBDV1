VALD     TITLE 'IEBDV1 VALIDATE ROUTINE- OUT DATA SET'                  00080000
IEBDV1   CSECT                                                          00160019
*A197600-203200                                                  A33299 00200000
*A204000                                                         A36059 00220000
*C138318,138336                                       VS08432 = OZ00100 00222002
*C889600                                                         A41780 00230021
*A603300-603900,896600-896700                                    A37881 00230121
*D856000-860800,869600                                           A41809 00230400
* 009600,025600-026400,052800,096000,098400,111200-116000,138000 X010XX 00230800
* 320000,331200-336000,352000-364000,784800-785600,865600-866400 X010XX 00232100
* 886400,801600-803200                                           X010XX 00234100
*D156800-160800                                                  A45216 00236022
*A146500-147160                                                  A45216 00238022
*C144800,154400                                                  A45216 00238422
*D575600,576800,577600,813600-815200                             A44144 00238822
*C696000,868000,80400,561600                                     A44144 00238922
*A576500,813300-815940                                           A44144 00239222
*D136000,A076730,A131400-131600,A136000-136700,A340744-340789   OY01182 00239302
*D340761-340784,A874430-875000                                  OY01182 00239402
*A138306-138384                                                @YA02573 00239502
*C138400                                                       @YA02573 00239602
*A465400-465560,763800-763920                                  @ZA06526 00239799
*C459200                                                       @ZA06526 00259799
*C874910                                                       @ZA06528 00259899
*A465420-465440                                                @ZA07344 00269899
*C874670                                                       @ZA18344 00279899
*********************************************************************** 00280099
         ENTRY IEBDV0                                                   00300099
        ENTRY IEBDV2                                                    00320019
        ENTRY IEBDV3                                                    00400019
        ENTRY IEBDV4                                                    00480019
         ENTRY IEBDVJCB                                                 00560019
         SPACE 1                                                        00640019
*                                                                     * 00720019
*TITLE- IEBDSCPY VALIDATE ROUTINE- IEBDV1                             * 00800019
*                                                                     * 00880019
*STATUS- CHANGE LEVEL 002                                        X010XX 00960000
*                                                                     * 01040019
*FUNCTION/OPERATION- THIS MODULE OPENS DATA SETS FOR INPUT, OUTPUT    * 01120019
*       SYSUT3 AND SYSUT4 DATA SETS. THE CHARACTERISTICS OF THE DATA  * 01200019
*       SETS ARE VERIFIED. IT DETERMINES IF BLOCKING/REBLOCKING IS    * 01280019
*       TO BE DONE.                                                   * 01360019
*                                                                     * 01440019
*ENTRY POINTS- ENTERED AT IEBDV1 TO OPEN AND VALIDATE OUTPUT DATA SET * 01520019
*       ALWAYS VALIDATE AND OPEN AN INPUT DATA SET ALSO SO RIGHT AFTER* 01600019
*       ENTER INPUT VALIDATION/OPEN ROUTINE AT 'DOINDCB'              * 01680019
*              ENTERED AT IEBDV2 TO VALIDATE/OPEN AN INPUT DATA SET   * 01760019
*       AFTER FIRST ONE IS VALIDATED ALONG WITH OUTPUT DATA SET       * 01840019
*              ENTERED AT IEBDV3 TO VALIDATE SYSUT 3 DATA SET. GENERAL* 01920019
*       SUB-ROUTINE 'VALIDS34' USED TO VALIDATE AND OPEN SYSUT3 OR    * 02000019
*       SYSUT4.                                                       * 02080019
*              ENTERED AT IEBDV4 TO VALIDATE SYSUT4 DATA SET. GENERAL * 02160019
*       SUB-ROUTINE 'VALIDS34' USED TO VALIDATE AND OPEN SYSUT3 OR    * 02240019
*       SYSUT4 WORK DATA SETS USED IF SPILL NECESSARY.                * 02320019
*              ENTERED AT IEBDV0 TO OPEN AND VALIDATE SYSPRINT/SYSIN. * 02400019
*                                                                     * 02480019
*INPUT- REGISTER 4 POINTS TO IEBMCA COMMUNICATION AREA           X010XX 02560000
*                                                                     * 02720019
*OUTPUT- SWITCHES IN 'FORM' ARE SET TO DENOTE RECFM OF DATA SETS-     * 02800019
*       'FORM1' SET MEANS INPUT DATA SET HAS VARIABLE RECORD FORMAT   * 02880019
*       'FORM2' SET MEANS INPUT DATA SET HAS BLOCKED RECORDS          * 02960019
*       'FORM3' SET MEANS OUTPUT DATA SET HAS BLOCKED RECORDS.        * 03040019
*       'FORM4' SET IF INPUT OR OUTPUT MAY HAVE TRACK OVERFLOW RECORDS* 03120019
*       'TAG5' IN 'TAG' SET IF READ BACK CHECK TO BE DONE             * 03200019
*       SWITCH 'REBLK' IN 'FLG3' SET IF BLOCK/REBLOCK TO BE DONE      * 03280019
*       -BADBLOCK- SET BY DCB EXLST ROUTINE IF SYSPRINT/SYSIN HAVE    * 03360019
*                  INVALID BLOCKSIZE.                                 * 03440019
*            AREAS SET UP BY VALIDATE IN IEBMCA--                     * 03520019
*       -OBLKSIZE- OUTPUT DATA SET BLOCKSIZE                          * 03600019
*       -IBLKSIZE- INPUT DATA SET BLOCKSIZE                           * 03680019
*       -INLRECL-  INPUT DATA SET LOGICAL RECORD LENGTH               * 03760019
*       -OUTLRECL- OUTPUT DATA SET LOGICAL RECORD LENGTH              * 03840019
*       -OBLKFAC-  OUTPUT DATA SET BLOCKING FACTOR                    * 03920019
*       -IBLKFAC-  INPUT DATA SET BLOCKING FACTOR                     * 04000019
*       -OUTDS1-   TTR AND TRACK BALANCE END OF DATA SET OUTPUT DSCB  * 04080019
*       -INDS1-    TTR AND TRACK BALANCE END OF DATA SET INPUT DSCB   * 04160019
*       -UT3DS1-   TTR AND TRACK BALANCE END OF DATA SET SYSUT3 DSCB  * 04240019
*       -UT4DS1-   TTR AND TRACK BALANCE END OF DATA SET SYSUT4 DSCB  * 04320019
*       -FDAD-     IN PROPER DCB SET TO BBCCHH OF INITIAL RECORD      * 04400019
*       -OUTCHAR-   DEVICE CHARACTERISTIC BUFFER OUTPUT DATA SET      * 04480019
*       -INCHAR-    DEVICE CHARACTERISTIC BUFFER INPUT DATA SET       * 04560019
*       -UT3CHAR-   DEVICE CHARACTERISTIC BUFFER SYSUT3 DATA SET      * 04640019
*       -UT4CHAR-   DEVICE CHARACTERISTIC BUFFER SYSUT4 DATA SET      * 04720019
*       -OUTNAME-   OUTPUT DATA SET DDNAME                            * 04800019
*       -DDVALNM-   AREA THAT HOLDS DDNAME OF DATA SET BEING VALIDATED* 04880019
*       -NOTRKS-   NUMBER OF TRACKS IN EXTENT OUTPUT DATA SET         * 04960019
*                                                                     * 05040019
*EXTERNAL ROUTINES- SYSTEM MACROS- OBTAIN,RDJFCB,DEVTYPE,OPEN         * 05120019
*                   IF AN UNLOAD CONDITION IS FOUND, A LINK IS   X010XX 05170000
*                     DONE TO THE ENTRY POINT IEBLDUL2 IN        X010XX 05180000
*                     IEBLDUL                                    X010XX 05190000
*                   IF A LOAD CONDITION IS FOUND, A LINK IS      X010XX 05192000
*                     DONE TO THE ENTRY POINT IEBLDUL1 IN        X010XX 05194000
*                     IEBLDUL                                    X010XX 05196000
*                                                                     * 05200019
*EXITS - NORMAL                                                  X010XX 05280000
*        RETURN TO CALLER                                        X010XX 05330000
*                                                                X010XX 05340000
*EXITS - ERROR                                                   X010XX 05350000
*        MESSAGE SET UP DEFINING ERROR AND DATASET AND ISSUED    X010XX 05352000
*        BY MESSAGE WRITER ROUTINE WHICH WILL RETURN TO IEBSCN        * 05360019
*       PROGRAM TO FLUSH TO NEXT COPY STATEMENT                       * 05440019
*                                                                     * 05520019
*TABLES/WORK AREAS-                                                   * 05600019
*       -JFCB1-     JFCB WORK AREA (RDJFCB)                           * 05680019
*       -DSCB-      DSCB WORK AREA (CAMLST FOR OBTAIN)                * 05760019
*                                                                     * 05840019
*ATTRIBUTES- SERIAL REUSABLE                                          * 05920019
*                                                                     * 06000019
         EJECT                                                          06080019
*                                                                     * 06160019
*                SYMBOLIC REGISTERS FOR VALIDATE ROUTINE              * 06240019
*                                                                     * 06320019
GR0      EQU   0                                                        06400019
GR1      EQU   1                                                        06480019
GR2      EQU   2                                                        06560019
GR3      EQU   3                                                        06640019
GR4      EQU   4                       COMMON AREA POINTER              06720019
GR5      EQU   5                                                        06800019
GR6      EQU   6                                                        06880019
GR7      EQU   7                                                        06960019
GR8      EQU   8                                                        07040019
GR9      EQU   9                                                        07120019
GR10     EQU   10                                                       07200019
GR11     EQU   11                                                       07280019
GR12     EQU   12                      BASE REGISTER FOR VALIDATE       07360019
GR13     EQU   13                                                       07440019
GR14     EQU   14                                                       07520019
GR15     EQU   15                                                       07600019
SAV4     EQU   4                  SAVE AREA DISPLACEMENT                07603019
SAV8     EQU   8                  SAVE AREA DISPLACEMENT                07606019
LEN8     EQU   8                                                        07609019
X00      EQU   X'00'                                                    07612019
LEN6     EQU   6                  L                                     07615019
LEN44    EQU   44                                                       07618019
LEN46    EQU   46                                                X010XX 07620000
LEN1     EQU   1                                                        07621019
LEN2     EQU   2                                                        07624019
XFF      EQU   X'FF'                                                    07627019
LEN3     EQU   3                                                        07630019
LEN4     EQU   4                                                        07633019
LEN11    EQU   11                                                X010XX 07635000
LEN12    EQU   12                                                       07636019
LEN0     EQU   0                                                        07639019
LEN16    EQU   16                                                       07642019
X40      EQU   X'40'                                                    07645019
LEN120   EQU   120                                                      07648019
LEN37    EQU   37                                                       07651019
LEN10    EQU   10                                                       07654019
RTCDE    EQU   C'8'                                                     07657019
MS8      EQU   8                                                        07660019
RTCD     EQU   C'4'                                                     07663019
X1E      EQU   X'1E'                                                    07666019
X01     EQU   X'01'                                             OY01182 07673002
         EJECT                                                          07680019
         SAVE  (14,12),,*                                               07760019
*                                                                     * 07840019
*                  BASE ADDRESS REGISTER GR12- COMMUNICATION GR4      * 07920019
         BALR  GR12,GR0           GET ADDRESSABILITY                    08000019
         USING START,GR12                                               08080019
         USING IEBMCA,GR4                                               08160019
START    EQU   *                                                        08240019
*ENTRY VALIDATE/OPEN OUTPUT DATA SET PLUS FIRST INPUT DATA SET        * 08320019
         SPACE 1                                                        08400019
         ST    GR13,SV5+SAV4      POINTER TO OLD SAVE AREA              08480019
         LA    GR15,SV5                 PTR TO SAVE AREA                08560019
         ST    GR15,SAV8(GR13)    POINTER TO NEW SAVE AREA IN OLD       08640019
         LR    GR13,GR15               POINTER TO NEW SAVE AREA         08720019
         OI    FLG3,OUTPUTEP           SET FOR ENTRY AT DV1             08800019
         NI    ULLDST,XFF-UNLOAD       TURN OFF UNLOAD SWITCH    X010XX 08810000
         SPACE 1                                                 X010XX 08820000
         LA    GR5,OUTDCB              SET DCB POINTER REGISTER  X010XX 08830000
*                                       TO ADDRESS OF OUTPUT PDS X010XX 08832000
*                                       DCB                      X010XX 08834000
         USING IHADCB,GR5              DCB DSECT ADDRESSABILITY  X010XX 08836000
         MVI   DCBKEYLE,X00            CLEAR DCB KEYLEN FIELD    X010XX 08838000
         NI    DCBOPTCD,AOSFB          CLEAR DCB OPTCD FIELD     X010XX 08838400
         MVI   DCBRECFM,X00            CLEAR DCB RECFM FIELD     X010XX 08838800
         SPACE 1                                                 X010XX 08839200
         NI    FORM,XFF-FORM4          TURN OFF OVERFLOW FLAG    A36059 08840020
         BAL   GR9,DOINDCB             OPEN FIRST INPUT DATA SET        08880019
         SPACE 1                                                        08960019
*                                                                     * 09040019
*                  READ IN JFCB THEN OPEN AND THEN OBTAIN DSCB TO     * 09120019
*         GET BLOCKSIZE, TTRS AND TRACK BALANCE OF OUTPUT DATA SET,   * 09200019
*         AND CHECK DATA SET ORGANIZATION FOR PARTITIONED.            * 09280019
*                  GR5 MAINTAINS DCB ADDRESS AS LONG AS NECESSARY     * 09360019
*                                                                     * 09440019
         SPACE 1                                                        09520019
         LA    GR5,OUTDCB                                               09680019
         MVC   DDVALNM(LEN8),DDNAME1(GR5) SAV NAME OF DS VALIDATING     09760019
         LA    GR8,JFCB1               POINTER TO JFCB                  09920019
         ST    GR8,LIST1               STORE IN EXIT LIST               10000019
         MVI   LIST1,JFCBECON          SET JFCB EXIT+LAST ENTRY         10080019
         SPACE 1                                                        10160019
         LA    GR1,BPAMOUT             ADDRESS OF OUTPUT DATA SET BPAM  10240019
         MVC   DDNAME1(LEN8,GR1),DDNAME1(GR5) NAME OF CURRENT OUTPUT DS 10320019
         SPACE                                                          10400019
         DEVTYPE DDVALNM,OUTCHAR,DEVTAB GET OUTPUT DEVICE DATA   S20201 10480020
         LTR   GR15,GR15               MISSING DD CARD                  10560019
         BZ    ODDPRES                 NO, OK                           10640019
         SPACE 1                                                        10720019
         BAL   GR8,NODDCD              GIVE ERROR MSG                   10800019
         B     GETNEXT                 GO TO ERROR RTN                  10880019
         SPACE 1                                                        10960019
ODDPRES  EQU   *                                                        11040019
         SPACE 1                                                        11680019
         RDJFCB ((GR5))                                                 11760019
         LA    GR8,JFCB1               JFCB BUFFER ADDRESS              11840019
         USING INFMJFCB,GR8                                             11920019
         MVC   OTDSNAME(LEN44),JFCBDSNM MOVE OUTPUT DSNAME TO COMM AREA 12000019
         MVC   OUTVOL(LEN6),JFCBVOLS  SAVE OUTPUT VOLID                 12080019
         SPACE 1                                                 X010XX 12130000
         CLI   OUTUCBTP,UCBDIRCT       IS OUTPUT DATA SET DASD   X010XX 12140000
         BNE   DV000200                NO, GO TO UNLOAD INITIAL- X010XX 12150000
*                                       IZATION ROUTINE          X010XX 12152000
         SPACE 1                                                 X010XX 12154000
         SPACE                                                          12160019
*********************************************************************** 12240019
*                                                                     * 12320019
*  THIS SECTION OF CODE 1) OBTAINS THE OUTPUT DSCB, 2) DETERMINES     * 12400019
*  DATA SET CHARACTERISTICS THAT ARE NULL IN THE OUTPUT DSCB AND      * 12480019
*  OUTPUT JFCB, 3) FILLS THESE NULL OUTPUT CHARACTERISTICS WITH THE   * 12560019
*   FIRST INPUT DATA SET'S CHARACTERISTICS                            * 12640019
*                                                                     * 12720019
*********************************************************************** 12800019
         SPACE                                                          12880019
         USING DXDSCB,GR2                                               12960019
         LA    GR2,DSCB                POINTER TO DSCB                  13040019
         LA    GR3,INDCB               POINTER TO INPUT DCB             13120019
         NI    FLG3,XFF-ENTOBT         SET OBTAIN NOT ENTERED YET 01182 13140002
OUTOBT   EQU   *                                                OY01182 13160002
         SPACE                                                          13200019
         OBTAIN OBTL                   GET OUTPUT DSCB                  13280019
         LTR   GR15,GR15               OBTAIN OK                        13360019
         BZ    OUTOBTOK                YES, GO ON                       13440019
         SPACE 1                                                        13520019
         LA    GR8,LEN4                                         OY01182 13600002
         CR    GR15,GR8                WAS VOLUME MOUNTED       OY01182 13607002
         BH    BADOBT                  NO,VALIDATION ERROR      OY01182 13614002
*     TRY TO MOUNT IT NOW                                       OY01182 13621002
         TM    FLG3,ENTOBT             DO NOT LOOP              OY01182 13628002
         BO    BADOBT                                           OY01182 13635002
         MVI   MNTJFCB+117,X01         1 VOLUME ON LIST         OY01182 13642002
         MVC   MNTJFCB+118(LEN6),INVOL GET VOLUME SER           OY01182 13649002
         MVI   MNTJFCB+124,X40    NO MORE VOLUMES               OY01182 13656002
         LA    GR7,OUTOBT         SET RETURN ADDR               OY01182 13663002
         B     OPENVTOC                ISSUE MOUNT REQUEST      OY01182 13670002
         SPACE 1                                                        13680019
OUTOBTOK EQU   *                                                        13760019
         TM    DS1DSORG(GR2),PARTORG   PARTIONED ORGANIZATION    A33299 13770020
         BO    OUTPDS                  YES, OK                   A33299 13780020
         SPACE 1                                                 X010XX 13782000
         TM    DS1DSORG(GR2),BADDSORG  IS OR DA DSORG            X010XX 13784000
         BZ    DV000200                NO, GO TO UNLOAD INITIAL- X010XX 13786000
*                                       IZATION ROUTINE          X010XX 13788000
         SPACE 1                                                 A33299 13790020
         BAL   GR8,DV000800            GIVE ERROR MESSAGE        X010XX 13800000
         B     GETNEXT                 GO TO ERROR RTN           A33299 13810020
         SPACE 1                                                 A33299 13820020
OUTPDS   EQU   *                                                 A33299 13830020
         TM    JFCBIND2,JFCNEW    IS OUTPUT A 'NEW' DS         @YA02573 13830602
         BO    TESTKEY            YES                          @YA02573 13831202
         CLC   KEYLENGT(LEN1,GR3),JFCKEYLE  INPUT KEY LENGTH =  OZ00100 13831802
*                                      OUTPUT JFCB KEY LENGTH  @YA02573 13832402
         BE    TESTRCFM           YES                          @YA02573 13833002
         CLC   KEYLENGT(LEN1,GR3),DSCKEYL   INPUT KEY LENGTH =  OZ00100 13833602
*                                      OUTPUT DSCB KEY LENGTH  @YA02573 13834202
         BE    TESTRCFM           YES                          @YA02573 13834802
         L     GR1,NXTINDS        NO; LOAD POINTER TO INDD     @YA02573 13835402
*                                  NAME                        @YA02573 13836002
         MVC   DDVALNM(LEN8),LEN2(GR1)  MOVE IN INDD NAME      @YA02573 13836602
*                                       TO BE USED IN MSG      @YA02573 13837202
         BAL   GR8,KEYERR         WRITE KEYLENGTH ERROR MSG    @YA02573 13837802
         B     GETNEXT            GO TO ERROR RTN              @YA02573 13838402
TESTKEY  MVC   WKA1(LEN1),DSCKEYL MOVE OUTPUT DSCB KEY LENGTH  @YA02573 13840002
         OC    WKA1(LEN1),JFCKEYLE  OR OUTPUT JFCB KEY LENGTH           13920019
         BNZ   TESTRCFM                BRANCH IF BOTH NOT ZERO          14000019
         MVC   JFCKEYLE(LEN1),KEYLENGT(GR3)  MOVE INPUT KEY LENGTH TO   14080019
*                                         OUTPUT JFCB                   14160019
TESTRCFM EQU   *                                                        14240019
         MVC   WKA1(LEN1),DSCRECFM  MOVE OUTPUT DSCB RECFM              14320019
         OC    WKA1(LEN1),JFCRECFM  ARE THEY BOTH ZERO                  14400019
         BNZ   LRCLNEED             NO, GO AROUND                A45216 14480022
         MVC   JFCRECFM(LEN1),RECFMFLD(GR3) MOVE INPUT RECFM TO OUTPUT  14560019
*                                        JFCB                           14640019
LRCLNEED EQU   *                                                 A45216 14650022
         TM    JFCRECFM,UNDEFREC       OUTPUT UNDEFINED RECRDS   A45216 14660022
         BO    TESTOPCD                YES-DON'T FILL LRECL      A45216 14670022
         BM    TESTLRCL                NO-DO LRECL               A45216 14680022
         TM    DSCRECFM,UNDEFREC       OUTPUT UNDEFINED RECRDS   A45216 14682022
         BO    TESTOPCD                YES-DON'T FILL LRECL      A45216 14684022
TESTLRCL EQU   *                                                 A45216 14690022
         MVC   WKA1(LEN2),DSCLRECL     MOVE OUTPUT DSCB LRECL    A45216 14700022
         OC    WKA1(LEN2),JFCLRECL     ARE THEY BOTH ZERO        A45216 14710022
         BNZ   TESTOPCD                NO, GO AROUND             A45216 14712022
         MVC   JFCLRECL(LEN2),INLRECL  MOVE INPT LRECL TO OUTPUT A45216 14714022
*                                        JFCB                    A45216 14716022
TESTOPCD EQU   *                                                        14720019
         MVC   WKA1(LEN1),DSCOPTCD  MOVE OUTPUT DSCB OPTCD              14800019
         OC    WKA1(LEN1),JFCOPTCD  ARE THEY BOTH ZERO                  14880019
         BNZ   TESTBLKS                NO, GO AROUND                    14960019
         MVC   JFCOPTCD(LEN1),OPTCDFLD(GR3) MOVE INPUT OPTCD TO OUTPUT  15040019
*                                        JFCB                           15120019
TESTBLKS EQU   *                                                        15200019
         MVC   WKA1(LEN2),DSCBLKL  MOVE OUTPUT DSCB BLKSIZE             15280019
         OC    WKA1(LEN2),JFCBLKSI ARE THEY BOTH ZERO                   15360019
         BNZ   FILLDONE                NO, GO AROUND             A45216 15440022
         MVC   JFCBLKSI(LEN2),IBLKSIZE  MOVE INPUT BLOCKSIZE TO OUTPUT  15520019
*                                        JFCB                           15600019
FILLDONE EQU   *                                                        16160019
         SPACE                                                          16240019
         SPACE 1                                                        16320019
         OPEN  ((GR5),OUTIN),TYPE=J    OPEN OUTPUT DCB                  16400019
         SPACE 1                                                        16480019
         TM    OPENFLGS(GR5),OPENOK    OPEN ERROR                       16560019
         BO    OUTOPEND                NO, OK                           16640019
         SPACE 1                                                        16720019
         BAL   GR8,OPENBAD             GIVE ERROR MSG                   16800019
         B     GETNEXT                 GO TO ERROR RTN                  16880019
         SPACE 1                                                        16960019
OUTOPEND EQU   *                                                        17040019
         NI    OPENFLGS(GR5),XFF-LWR  TURN OFF LAST OPERATION WAS       17200019
*                                        A WRITE IN OUTPUT DCB SO       17280019
*                                        THAT IF AN ABEND OCCURS        17360019
*                                        CLOSE WON'T UPDATE DSCLSTAR    17440019
*                                        FIELD IN DSCB                  17520019
         SPACE 1                                                        17600019
OBTAINS  OBTAIN OBTL                   OBTAIN OUTPUT DSCB               17680019
         LTR   GR15,GR15               OBTAIN OKAY                      17760019
         BZ    OUTOBTGD                YES, GO ON                       17840019
         SPACE 1                                                        17920019
BADOBT   EQU   *                                                        18000019
         BAL   GR8,OBTAINBD            GIVE ERROR MSG                   18080019
         B     GETNEXT                 GO TO ERROR RTN                  18160019
         SPACE 1                                                        18240019
OUTOBTGD EQU   *                                                        18320019
         MVC   OUTDS1(LEN3),DS1LSTAR(GR2) MOVE TTR TO BUFFER (LAST REC) 18400019
         MVI   OUTDS1+LEN3,X00          SET N=0                         18480019
         MVC   OUTDS1+LEN4(LEN2),DS1LSTAR+LEN3(GR2) MOVE TRACK BALANCE  18560019
         MVC   OUTPTTR(LEN6),OUTDS1  SAVE TTRN/TB IN BACK UP BUFFER     18640019
         MVC   TRKBALAN(LEN2,GR5),OUTDS1+LEN4  MOVE TRACK BAL TO DCB    18720019
         MVC   ERPTTR(LEN4),OUTDS1  MOVE TTRN TO WORK AREA              18800019
         MVC   ERPTB(LEN2),OUTDS1+LEN4 MOVE TRACK BAL TO WORK AREA      18880019
         MVC   BPAMOUT+DIRCTDCB(LEN2),DSCBLDBL   SAVE NUMBER OF BYTES   18890019
*                                                  USED IN LAST         18900019
*                                                  DIRECTORY BLOCK      18910019
*                                                  IN CASE WE RUN OUT   18920019
*                                                  OF DIRECTORY SPACE   18930019
         SPACE 1                                                        18960019
         LR    GR1,GR5                 OUTDCB ADDRESS                   19040019
         L     GR0,OUTDS1              TTRN TO CONVERT (LAST RECORD)    19120019
         LA    GR2,OUTFDAD             BUFFER FOR MBBCCHHR              19200019
         L     GR15,VTTOCC             TTRN TO MBBCCHHR CONVERT ROUTINE 19280019
         BALR  GR14,GR15               CONVERT TO MBBCCHHR STORE 0(GR2) 19360019
         SPACE 1                                                        19440019
         MVC   TRBALBUF(LEN2),OUTCHAR+LEN12  MAXIMUM RECORD ON TRACK    19520019
         MVC   ERPLMFD(LEN8),OUTFDAD                                    19600019
         LA    GR2,DSCB                POINTER TO DSCB           A33299 19640020
         SPACE                                                          19680019
         TM    RECFMFLD(GR5),OVERFLOW  DATA SET HAS OVERFLOW            20480019
         BNO   NOTOVRFL                NO, GO AROUND                    20560019
         OI    FORM,FORM4              SET FOR A DATA SET WITH OVERFLOW 20640019
NOTOVRFL EQU   *                                                        20720019
         LH    GR7,DS1BLKL(GR2)        DATA SET BLOCK LENGTH DSCB       20800019
         LTR   GR7,GR7                                                  20880019
         BP    OBGTZERO                BLOCKSIZE GT THAN ZERO (OK)      20960019
         SPACE 1                                                        21040019
         B     OBLKERR                 GIVE ERROR MSG                   21120019
         SPACE 1                                                        21200019
OBGTZERO EQU   *                                                        21280019
         STH   GR7,OBLKSIZE            STORE BLOCK SIZE IN BUFFER       21360019
         LH    GR6,DS1LRECL(GR2)       DATA SET LRECL IN DSCB           21440019
         STH   GR6,OUTLRECL            STORE LRECL IN BUFFER            21520019
         XR    GR15,GR15               CLEAR REG                        21530019
         IC    GR15,OUTBOLST           INSERT BLOCK OVERHEAD LAST REC   21540019
         TM    OUTDEVFG,HALFOVER       TWO BYTE OVERHEAD         S20201 21542020
         BNO   NOTTWO                  NO, GO AROUND             S20201 21544020
         LH    GR15,OUTOVER2           LOAD OVERHEAD VALUE       S20201 21546020
NOTTWO   EQU   *                                                 S20201 21548020
         AH    GR15,OBLKSIZE           ADD BLOCKSIZE                    21550019
         XR    GR14,GR14               CLEAR REG                        21560019
         IC    GR14,KEYLENGT(GR5)      INSERT KEY LENGTH                21570019
         AR    GR15,GR14               ADD TO BLOCKSIZE + OVERHEAD      21580019
         LTR   GR14,GR14               KEY LENGTH ZERO                  21590019
         BNZ   ITSKEYED                YES, DON'T SUBTRACT KEY OVHD     21600019
         IC    GR14,OUTKEYOV           INSERT KEY OVERHEAD              21610019
         SR    GR15,GR14               SUBTRACT FROM BLOCKSIZE+         21620019
*                                         KEYLENGTH+BLOCK OVERHEAD      21630019
ITSKEYED EQU   *                                                        21640019
         CH    GR15,TRBALBUF           WILL MAXIMUM SIZE RECORD FIT     21650019
*                                         ON ONE TRACK                  21660019
         BNH   OKGO                    YES, GO ON                       21670019
         TM    RECFMFLD(GR5),OVERFLOW  OVERFLOW RECORDS ON DATA SET     21760019
         BO    OKGO                    YES, OK                          21840019
         SPACE 1                                                        21920019
OBLKERR  EQU   *                                                        22000019
         BAL   GR8,BLOCKERR            GIVE ERROR MSG                   22080019
         B     GETNEXT                 GO TO ERROR RTN                  22160019
         SPACE 1                                                        22240019
OKGO     EQU   *                                                        22320019
         L     GR1,DEBADDR(GR5)        DEB POINTER FROM DCB             22400019
         LA    GR1,LEN0(GR1)   CLEAR HIGH ORDER BYTE                    22480019
         LA    GR6,OUTIOB                                               22560019
         XC    FDADADDR(LEN8,GR5),FDADADDR(GR5) CLEAR FDAD FIELD IN DCB 22640019
         MVC   FDADADDR+LEN1(LEN6,GR5),DEBBCCHH(GR1) BBCCHH-FDAD OUTDCB 22720019
         NI    TAG,XFF-TAG5       RESET VALIDITY CHECK SWITCH           22800019
         MVC   OKEYLEN(LEN1),KEYLENGT(GR5)  MOVE KEY LENGTH TO BUFFER   22880019
         CLI   OUTUCBDV,THE2321        IS OUTPUT DEVICE A 2321          22960019
         BE    SET4CHKB                FORCE READ BACK CHECKING         23040019
         TM    OPTCDFLD(GR5),VALCHK    CHECK FOR READBACK CHECK         23120019
         BZ    NEXTINS                 NO                               23200019
SET4CHKB EQU   *                                                        23280019
         OI    TAG,TAG5                SET VALIDITY CHECK SWITCH        23360019
         SPACE 1                                                        23440019
NEXTINS  EQU   *                                                        23520019
         TM    RECFMFLD(GR5),UNDEFREC  RECORD FORMAT UNDEFINED TYPE     23600019
         BO    UNDEFNOB           UNDEFINED IF BOTH ON- NO BLOCK        23680019
         TM    RECFMFLD(GR5),VARREC    OUTPUT VARIABLE                  23760019
         BNO   BLOCKTST                NO, GO ON                        23840019
         SPACE 1                                                        23920019
         LH    GR2,OBLKSIZE            LOAD OUTPUT BLKSIZE              24000019
         LH    GR1,OUTLRECL            LOAD OUTPUT LRECL                24080019
         LA    GR1,LEN4(GR0,GR1)     ADD 4 TO LRECL                     24160019
         SR    GR2,GR1                 BLKSIZE=LRECL+4  (OR MORE)       24240019
         BNM   BLOCKTST              YES, GO ON                         24320019
         SPACE 1                                                        24400019
         B     OBLKERR                 GIVE ERROR MSG                   24480019
         SPACE 1                                                        24560019
BLOCKTST EQU   *                                                        24640019
         TM    RECFMFLD(GR5),BLOCKREC  RECORDS BLOCKED                  24720019
         BZ    CHKOFIXD                NO, CHECK FOR FIXED UNBLOCKED    24800019
         LH    GR1,OUTLRECL            LOAD OUTPUT LRECL                24880019
         LTR   GR1,GR1                 LRECL=0 OR LESS                  24960019
         BP    OLRECLOK                NO, OK                           25040019
         SPACE 1                                                        25120019
         BAL   GR8,LRECLBAD            GIVE ERROR MSG                   25200019
         B     GETNEXT                 GO TO ERROR RTN                  25280019
         SPACE 1                                                        25360019
OLRECLOK EQU   *                                                        25440019
         LH    GR3,OBLKSIZE            OUTPUT BLOCKING FACTOR           25520019
         SR    GR2,GR2                                                  25600019
         DR    GR2,GR1                                                  25680019
         LTR   GR2,GR2                 ANY REMAINDER                    25760019
         BZ    SETOBLK                 NO, GO ON                        25840019
         TM    RECFMFLD(GR5),VARREC    VARIABLE LENGTH RECORDS          25920019
         BO    SETOBLK                 YES, GO ON                       26000019
         SPACE 1                                                        26080019
         B     OBLKERR                 GIVE ERROR MSG                   26160019
         SPACE 1                                                        26240019
SETOBLK  EQU   *                                                        26320019
         OI    FORM,FORM3              SET SWITCH FOR BLOCKED OUTPUT    26400019
         B     PUTBLK                  STORE BLOCKING FACTOR            26480019
         SPACE 1                                                        26560019
CHKOFIXD EQU   *                                                        26640019
         TM    RECFMFLD(GR5),FIXEDREC  RIXED RECFM                      26720019
         BZ    UNDEFNOB                NO, GO AROUND                    26800019
         LH    GR1,OUTLRECL            LOAD OUTPUT LRECL                26880019
         LTR   GR1,GR1                 IS IT ZERO                       26960019
         BNZ   OLVOB                   NO, GO ON                        27040019
         MVC   OUTLRECL(LEN2),OBLKSIZE SET OUTPUT LRECL=OUTPUT BLKSIZE  27120019
OLVOB    EQU   *                                                        27200019
         CLC   OUTLRECL(LEN2),OBLKSIZE BLOCKSIZE=LRECL - OUTPUT         27280019
         BE    UNDEFNOB                YES, GO ON                       27360019
         SPACE 1                                                        27440019
         B     OBLKERR                 GIVE ERROR MSG                   27520019
         SPACE 1                                                        27600019
UNDEFNOB EQU   *                                                        27680019
         NI    FORM,XFF-FORM3     RESET OUTPUT BLOCKED SWITCH           27760019
         LA    GR3,LEN1           BLOCKING FACTOR IF UNBLOCKED          27840019
         SPACE 1                                                        27920019
PUTBLK   EQU   *                                                        28000019
         STH   GR3,OBLKFAC             STORE BLOCKING FACTOR            28080019
         XC    NOTRKS(LEN2),NOTRKS                                      28160019
         L     GR2,DEBADDR(GR5)        DEB POINTER FROM DCB             28240019
         SR    GR5,GR5                                                  28320019
         IC    GR5,EXTNODEB(GR2)       PICK FROM DEB NUMBER OF EXTENTS  28400019
         LR    GR8,GR5                 SAVE EXTENT FOR COUNT            28480019
         SLL   GR5,LEN4           MULTIPLY BY 16                        28560019
         LA    GR5,DEBNMTRK(GR5)       UP PAST LAST DEBNMTRK FIELD      28640019
         AR    GR5,GR2                 POINT TO LAST EXTENT DEBNMTRK    28720019
         LA    GR6,LEN16          SIZE OF EXTENT APPENDAGE ON DEB       28800019
         SPACE 1                                                        28880019
EXTENTLP EQU   *                                                        28960019
         SR    GR5,GR6                 BACK UP TO EXTENT DEBNMTRK       29040019
         LH    GR7,LEN0(GR5)      GET NUMBER OF TRACKS IN EXTENT        29120019
         AH    GR7,NOTRKS                                               29200019
         STH   GR7,NOTRKS              UP TOTAL TRACK NUMBER            29280019
         BCT   GR8,EXTENTLP            TOTAL TRACKS IN ALL EXTENTS      29360019
         LA    GR9,CMPINOUT            SET UP RETURN ADDRESS TO BE      29440019
*                                        USED LATER ON WHEN A           29520019
*                                        VALIDATION ERROR OCCURS ON     29600019
*                                        AN INPUT DATA SET              29680019
         B     CMPINOUT                COMPARE INPUT AND OUTPUT DATA    29760019
*                                         DATA SETS                     29840019
DV000200 EQU   *                                                 X010XX 29890000
         SPACE 1                                                 X010XX 29900000
         LA    GR1,PARMLST             LOAD PARAMETER LIST       X010XX 29910000
*                                       ADDRESS                  X010XX 29912000
         L     GR15,VLDUL2             LOAD ADDRESS OF UNLOAD    X010XX 29914000
*                                       INITIALIZATION ROUTINE   X010XX 29916000
         BALR  GR14,GR15               OPEN UNLOAD DATA SET      X010XX 29918000
         SPACE 1                                                 X010XX 29918400
         LTR   GR15,GR15               ERROR FOUND BY IEBLDUL2   X010XX 29918800
         BZ    TSTCMPRS                NO, CHECK FOR PARM=       X010XX 29919200
*                                       COMPRESS                 X010XX 29919600
         B     GETNEXT                 YES, GO TO ERROR ROUTINE  X010XX 29919700
         SPACE                                                          29920019
         TITLE 'IEBDV1 VALIDATE ROUTINE- IN DATA SET - IEBDV2'          30000019
         DS    0F                      FORCE ALIGNMENT                  30080019
IEBDV2   EQU   *                                                        30160019
*ENTRY VALIDATE/OPEN INPUT DATA SET- NOT FIRST ONE                    * 30240019
         SAVE  (14,12),,IEBDV2                                          30320019
         BALR  GR12,GR0           GET ADDRESSABILITY                    30400019
         LA    GR15,IEBDV2-IEBDV1      ESTABLISH TOTAL ADDRESSABILITY   30480019
         SR    GR12,GR15               RELATIVE TO START OF CSECT       30560019
         ST    GR13,SV5+SAV4      POINTER TO OLD SAVE AREA              30640019
         LA    GR15,SV5                 PTR TO SAVE AREA                30720019
         ST    GR15,LEN8(GR13)                                          30800019
         LR    GR13,GR15               POINTER TO NEW SAVE AREA         30880019
         NI    FLG3,XFF-OUTPUTEP  RESET FOR ENTRY AT DV2                30960019
         LA    GR5,OUTDCB         GET POINTER TO OUTPUT DCB      A38778 30970021
         TM    DCBRECFM,OVERFLOW  IS OUTPUT TRACK OVERFLOW       A38778 30980021
         BO    DV105000           YES, GO AROUND                 A38778 30990021
         SPACE 1                                                 A38778 31000021
         NI    FORM,XFF-FORM4     RESET SWITCH INDICATING OUTPUT A38778 31010021
*                                OR INPUT PDS HAS TRACK OVERLLOW A38778 31020021
DV105000 EQU   *                                                 A38778 31030021
         LA    GR9,CMPINOUT            TO BE USED LATER FOR BRANCH      31040019
         SPACE 1                                                        31120019
*                                                                     * 31200019
*                  READ IN JFCB THEN OPEN AND THEN OBTAIN DSCB TO     * 31280019
*         GET BLOCKSIZE, TTRS AND TRACK BALANCE OF OUTPUT DATA SET,   * 31360019
*         AND CHECK DATA SET ORGANIZATION FOR PARTITIONED.            * 31440019
*                  GR5 MAINTAINS DCB ADDRESS AS LONG AS NECESSARY     * 31520019
*                                                                     * 31600019
         SPACE 1                                                        31680019
DOINDCB  EQU   *                                                        31760019
         LA    GR5,INDCB                                                31840019
         MVC   DDVALNM(LEN8),DDNAME1(GR5) SAVE NAME OF DS VALIDATING    31920019
         NI    ULLDST,XFF-LOAD         TURN OFF LOAD SWITCH      X010XX 32000000
         MVI   DCBKEYLE,X00            CLEAR DCB KEYLEN FIELD    X010XX 32050000
         NI    DCBOPTCD,AOSFB          CLEAR DCB OPTCD FIELD     X010XX 32060000
         MVI   DCBRECFM,X00            CLEAR DCB RECFM FIELD     X010XX 32070000
         LA    GR1,JFCB1               POINTER TO JFCB                  32080019
         ST    GR1,LIST1               STORE IN EXIT LIST               32160019
         MVI   LIST1,JFCBECON          SET FOR JFCB EXIT+LAST           32240019
         SPACE                                                          32320019
         DEVTYPE DDVALNM,INCHAR,DEVTAB GET INPUT DEVICE DATA     S20201 32400020
         LTR   GR15,GR15               MISSING DD CARD                  32480019
         BZ    IDDPRES                 NO, OK                           32560019
         SPACE 1                                                        32640019
         BAL   GR8,NODDCD              GIVE ERROR MSG                   32720019
         B     GETNEXT                 GO TO ERROR RTN                  32800019
         SPACE 1                                                        32880019
IDDPRES  EQU   *                                                        32960019
         BAL   GR7,CHECKCAT            CHECK FOR CONCATENATION          33040019
         SPACE                                                          33680019
         RDJFCB ((GR5))                                                 33760019
         LA    GR8,JFCB1               JFCB BUFFER ADDRESS              33840019
         MVC   INDSNAME(LEN44),JFCBDSNM  MOVE INPUT DSNAME TO COMM AREA 33920019
         MVC   INVOL(LEN6),JFCBVOLS    SAVE INPUT VOLID                 33970000
         SPACE 1                                                 X010XX 34050100
         CLI   INUCBTP,UCBDIRCT        IS INPUT DATA SET DASD    X010XX 34060100
         BNE   DV000600                NO, GO TO LOAD INITIALIZ- X010XX 34070100
*                                        ATION ROUTINE           X010XX 34072100
         SPACE 1                                                 X010XX 34074100
         NI    FLG3,XFF-ENTOBT         FIRST OBTAIN FOR DATASET OY01182 34074202
INOBT    EQU   *                                                OY01182 34074302
         OBTAIN  OBTL                  OBTAIN INPUT DSCB        OY01182 34074402
         LTR   GR15,GR15               OBTAIN OK                OY01182 34074502
         BZ    DV000400                YES,GO ON                OY01182 34074602
         LA    GR8,LEN4                                         OY01182 34074702
         CR    GR15,GR8                VOLUME NOT MOUNTED       OY01182 34074802
         BH    BDIOBT                  NO,VALIDATION ERROR      OY01182 34074902
         TM    FLG3,ENTOBT             DONT LOOP                OY01182 34075002
         BO    BDIOBT                                           OY01182 34075102
         MVI   MNTJFCB+117,X01         1 VOLUME ON LIST         OY01182 34075202
         MVC   MNTJFCB+118(LEN6),INVOL GET VOLSER               OY01182 34075302
         MVI   MNTJFCB+124,X40         NO MORE VOLUMES          OY01182 34075402
         LA    GR7,INOBT               SET RETURN ADDRESS       OY01182 34075502
         B     OPENVTOC                GO ISSUE MOUNT REQUEST   OY01182 34075602
BDIOBT   EQU   *                                                OY01182 34075702
         SPACE 1                                                 X010XX 34078800
         BAL   GR8,OBTAINBD            GIVE ERROR MESSAGE        X010XX 34079200
         B     GETNEXT                 GO TO ERROR ROUTINE       X010XX 34079600
         SPACE 1                                                 X010XX 34079700
DV000400 EQU   *                                                 X010XX 34079800
         LA    GR2,DSCB                LOCATION DSCB JUST READ   X010XX 34079900
         TM    DS1DSORG(GR2),PARTORG   PARTITIONED PRGANIZATION  X010XX 34106600
         BO    INPDS                   YES, GO OPEN DCB          X010XX 34116600
         SPACE 1                                                 X010XX 34126600
         TM    DS1DSORG(GR2),BADDSORG  IS OR DA DSORG            X010XX 34128600
         BZ    DV000600                NO, GO TO LOAD INITIALIZ- X010XX 34130600
*                                        ATION ROUTINE           X010XX 34132600
         SPACE 1                                                 X010XX 34133000
         BAL   GR8,DV000800            GIVE ERROR MESSAGE        X010XX 34133100
         B     GETNEXT                 GO TO ERROR ROUTINE       X010XX 34133200
         SPACE 1                                                 X010XX 34142100
INPDS    EQU   *                                                 X010XX 34144100
         SPACE 1                                                 X010XX 34151100
         OPEN  ((GR5),INPUT),TYPE=J    OPEN INPUT DCB                   34160019
         TM    OPENFLGS(GR5),OPENOK    OPEN ERROR                       34240019
         BO    INOPEND                 NO, OK                           34320019
         SPACE 1                                                        34400019
         BAL   GR8,OPENBAD             GIVE ERROR MSG                   34480019
         B     GETNEXT                 GO TO ERROR RTN                  34560019
         SPACE 1                                                        34640019
INOPEND  EQU   *                                                        34720019
         L     GR1,DEBADDR(GR5)        DEB POINTER FROM DCB             34800019
         LA    GR1,LEN0(GR1)      CLEAR HIGH ORDER BYTE                 34880019
         XC    FDADADDR(LEN8,GR5),FDADADDR(GR5) CLEAR FDAD FIELD IN DCB 34960019
         MVC   FDADADDR+LEN1(LEN6,GR5),DEBBCCHH(GR1) BBCCHH -FDAD-INDCB 35040019
         B     SETFIXED                BRANCH AROUND LOAD CODE   X010XX 35090000
         SPACE 1                                                 X010XX 35100000
DV000600 EQU   *                                                 X010XX 35110000
         LA    GR1,PARMLST             LOAD PARAMETER LIST       X010XX 35112000
*                                       ADDRESS                  X010XX 35114000
         L     GR15,VLDUL1             LOAD ADDRESS OF LOAD INIT-X010XX 35116000
*                                       IALIZATION ROUTINE       X010XX 35118000
         BALR  GR14,GR15               OPEN LOAD DCB             X010XX 35118400
         SPACE 1                                                 X010XX 35118800
         LTR   GR15,GR15               ERROR FOUND BY IEBLDUL1   X010XX 35119200
         BP    GETNEXT                 YES, GO TO ERROR ROUTINE  X010XX 35119600
         SPACE 1                                                 X010XX 35119700
         SPACE 1                                                        35120019
SETFIXED EQU   *                                                        36480019
         NI    FORM,XFF-FORM1     SET FOR FIXED INPUT                   36560019
         TM    RECFMFLD(GR5),VARREC    INPUT V (OR U)                   36640019
         BNO   CHECKBLK                NO, GO AROUND                    36720019
         OI    FORM,FORM1              SET FOR V RECORDS   (OR U)       36800019
CHECKBLK EQU *                                                          36880019
         LA    GR8,JFCB1               POINTER TO JFCB                  36960019
         LH    GR7,JFCBLKSZ(GR0,GR8)   LOAD JFCB BLKSIZE                37040019
         LTR   GR7,GR7                 IS IT ZERO                       37120019
         BP    STOREBLK                NO, LET IT OVER-RIDE DSCB        37200019
         LH    GR7,DS1BLKL(GR2)        DATA SET BLOCK LENGTH DSCB       37280019
         LTR   GR7,GR7                 BLOCKSIZE ZERO                   37360019
         BP    STOREBLK                NO, OK                           37440019
         SPACE 1                                                        37520019
IBLKERR  EQU   *                                                        37600019
         BAL   GR8,BLOCKERR            GIVE ERROR MSG                   37680019
         B     GETNEXT                 GO TO ERROR RTN                  37760019
         SPACE 1                                                        37840019
STOREBLK EQU   *                                                        37920019
         STH   GR7,IBLKSIZE            STORE INPUT BLOCKSIZE            38000019
         LH    GR6,JFCBLREC(GR0,GR8)   LOAD JFCB LRECL                  38080019
         LTR   GR6,GR6                 IS IT ZERO                       38160019
         BP    STORELRC                NO, LET IT OVER-RIDE DSCB        38240019
         LH    GR6,DS1LRECL(GR2)       DATA SET LRECL IN DSCB           38320019
STORELRC EQU   *                                                        38400019
         STH   GR6,INLRECL             STORE INPUT LRECL                38480019
         SPACE 1                                                        38560019
         TM    RECFMFLD(GR5),OVERFLOW  DEVICE HAVE OVERFLOW- INPUT      38640019
         BNO   NOTOVRFO                NO, INPUT NOT OVERFLOW           38720019
TRKOVRST EQU   *                                                        38800019
         OI    FORM,FORM4              SET FOR A DATA SET WITH OVERFLOW 38880019
NOTOVRFO EQU   *                                                        38960019
         TM    RECFMFLD(GR5),UNDEFREC  RECORD FORMAT UNDEFINED TYPE     39040019
         BO    SKPLRECL           UNDEFINED RECORDS LRECL=0             39120019
         TM    RECFMFLD(GR5),VARREC    IS INPUT VARIABLE                39200019
         BNO   CHKINBLK                NO, GO ON                        39280019
         SPACE 1                                                        39360019
         LH    GR6,IBLKSIZE            LOAD INPUT BLKSIZE               39440019
         LH    GR1,INLRECL             LOAD INPUT LRECL                 39520019
         LA    GR1,LEN4(GR0,GR1)  ADD 4 TO LRECL                        39600019
         SR    GR6,GR1                 BLKSIZE=LRECL+4  (OR MORE)       39680019
         BNM   CHKINBLK           YES, GO ON                            39760019
         SPACE 1                                                        39840019
         B     IBLKERR                 GIVE ERROR MESSAGE               39920019
         SPACE 1                                                        40000019
CHKINBLK EQU   *                                                        40080019
         TM    RECFMFLD(GR5),BLOCKREC  RECORDS BLOCKED                  40160019
         BZ    CHKIFIXD                NO, CHECK FOR FIXED UNBLOCKED    40240019
         LH    GR1,INLRECL             LOAD INPUT LRECL                 40320019
         LTR   GR1,GR1                 LRECL=0 OR LESS                  40400019
         BP    ILGTZERO                NO, OK                           40480019
         SPACE 1                                                        40560019
ILRECERR EQU   *                                                        40640019
         BAL   GR8,LRECLBAD            GIVE ERROR MSG                   40720019
         B     GETNEXT                 GO TO ERROR RTN                  40800019
         SPACE 1                                                        40880019
ILGTZERO EQU   *                                                        40960019
         LH    GR7,IBLKSIZE            INPUT BLOCK SIZE                 41040019
         SR    GR6,GR6                                                  41120019
         DR    GR6,GR1                                                  41200019
         LTR   GR6,GR6                 ANY REMAINDER                    41280019
         BZ    SETIBLK                 NO, GO ON                        41360019
         TM    RECFMFLD(GR5),VARREC    VARIABLE LENGTH RECORDS          41440019
         BO    SETIBLK                 YES, GO ON                       41520019
         SPACE 1                                                        41600019
         B     IBLKERR                 GIVE ERROR MSG                   41680019
         SPACE 1                                                        41760019
SETIBLK  EQU   *                                                        41840019
         OI    FORM,FORM2              SET INPUT BLOCKED SWITCH         41920019
         B     GETDEVIN                STORE BLOCKING FACTOR            42000019
         SPACE 1                                                        42080019
CHKIFIXD  EQU   *                                                       42160019
         TM    RECFMFLD(GR5),FIXEDREC  FIXED RECFM                      42240019
         BZ    SKPLRECL                NO, GO AROUND                    42320019
         LH    GR1,INLRECL             LOAD INPUT LRECL                 42400019
         LTR   GR1,GR1                 IS IT ZERO                       42480019
         BNZ   ILVIB                   NO, GO ON                        42560019
         MVC   INLRECL(LEN2),IBLKSIZE  SET INPUT LRECL=INPUT BLKSIZE    42640019
ILVIB    EQU   *                                                        42720019
         CLC   IBLKSIZE(LEN2),INLRECL  BLKSIZE=LRECL - INPUT            42800019
         BE    SKPLRECL                YES, GO ON                       42880019
         SPACE 1                                                        42960019
         B     IBLKERR                 GIVE ERROR MSG                   43040019
         SPACE 1                                                        43120019
SKPLRECL EQU   *                                                        43200019
         LA    GR7,LEN1           ASSUME BLOCKING FACTOR OF 1           43280019
         NI    FORM,XFF-FORM2     RESET INPUT BLOCKED SWITCH            43360019
GETDEVIN EQU   *                                                        43440019
         STH   GR7,IBLKFAC             BLOCKING FACTOR                  43520019
         BR    GR9                     RETURN TO DV1 IF OPENING OUTPUT  43600019
*                                         NEXT OR FALL THROUGH AND      43680019
*                                         COMPARE INPUT VS. OUTPUT      43760019
         SPACE 1                                                        43840019
CMPINOUT EQU   *                                                        43920019
         SPACE 1                                                        44000019
         L     GR1,NXTINDS             LOAD POINTER TO INDD NAME        44080019
         MVC   DDVALNM(LEN8),LEN2(GR1) MOVE IN INDD NAME IN CASE AN     44160019
*                                         ERROR IS FOUND                44240019
         SPACE 1                                                        44320019
         NI    FLG3,XFF-REBLK     RESET BLOCKING SWITCH                 44400019
         LA    GR3,OUTDCB              POINTER TO OUT DCB               44480019
         LA    GR5,INDCB               POINTER TO INPUT DCB             44560019
         SPACE 1                                                        45120019
GOONSS   EQU   *                                                        45200019
         CLC   KEYLENGT(LEN1,GR5),OKEYLEN  EQUAL KEY LENGTHS            45280019
         BE    KEYSOK                  YES, GO ON                       45360019
         SPACE 1                                                        45440019
         BAL   GR8,KEYERR              GIVE ERROR MSG                   45520019
         B     GETNEXT                 GO TO ERROR RTN                  45600019
         SPACE 1                                                        45680019
KEYSOK   EQU   *                                                        45760019
         TM    RECFMFLD(GR3),UNDEFREC  IS OUTPUT U                      45840019
         BO    BLKTEST                 TEST BLOCKSIZE          @ZA06526 45920099
         MVC   WKA1(LEN1),RECFMFLD(GR5) RECORD FORMAT FROM INDCB        46000019
         XC    WKA1(LEN1),RECFMFLD(GR3) RECORD FORMAT FROM OUTDCB       46080019
         TM    WKA1,FIXEDREC+VARREC    F TO V OR V TO F                 46160019
         BZ    THERECMP                NO, GO ON                        46240019
         SPACE 1                                                        46320019
         BAL   GR8,UNEQRCFM            GIVE ERROR MSG                   46400019
         B     GETNEXT                 GO TO ERROR RTN                  46480019
         SPACE 1                                                        46530099
BLKTEST  EQU   *                                               @ZA06526 46540099
         TM    RECFMFLD(GR5),UNDEFREC  IS INPUT U              @ZA07344 46542099
         BO    COMPTEST                YES-OK                  @ZA07344 46544099
         CLC   OBLKSIZE(LEN2),IBLKSIZE BLKSIZES THE SAME       @ZA06526 46550099
         BE    COMPTEST                YES-TEST FOR COMPRESS   @ZA06526 46552099
         BAL   GR8,NOREDEB             NO-GIVE ERROR MSG132    @ZA06526 46554099
         B     GETNEXT                 GO TO ERROR RTN         @ZA06526 46556099
         SPACE 1                                                        46560019
THERECMP EQU   *                                                        46640019
         CLC   INLRECL(LEN2),OUTLRECL   LOGICAL RECORD LENGTHS EQUAL    46720019
         BE    SETREBLK                YES, OK                          46800019
         SPACE 1                                                        46880019
         B     ILRECERR                GIVE ERROR MSG                   46960019
         SPACE 1                                                        47040019
         SPACE 1                                                        47120019
SETREBLK EQU   *                                                        47200019
         CLC   OBLKSIZE(LEN2),IBLKSIZE  BLOCKING FACTORS THE SAME       47280019
         BE    COMPTEST                YES, NO REBLOCKING               47360019
         TM    FORM,FORM4              INPUT OR OUTPUT HAVE TRACK OVERF 47440019
         BNO   CHKFRKEY                NO, GO ON                        47520019
         SPACE 1                                                        47600019
         BAL   GR8,NOREBLOV            GIVE ERROR MSG                   47680019
         B     GETNEXT                 GO TO ERROR RTN                  47760019
         SPACE 1                                                        47840019
CHKFRKEY EQU   *                                                        47920019
         MVC   WKA1(LEN1),OKEYLEN   INPUT OR                            48000019
         OC    WKA1(LEN1),KEYLENGT(GR5)  OUTPUT KEYED                   48080019
         BZ    NOKEYS                  NO, GO ON                        48160019
         SPACE 1                                                        48240019
         BAL   GR8,NOREBLKY            GIVE ERROR MSG                   48320019
         B     GETNEXT                 GO TO ERROR RTN                  48400019
         SPACE 1                                                        48480019
NOKEYS   EQU   *                                                        48560019
         OI    FLG3,REBLK              SET FLAG FOR REBLOCKING          48640019
         SPACE 1                                                        48720019
**  CHECK FOR COMPRESS                                                  48800019
         SPACE 1                                                        48880019
COMPTEST EQU   *                                                        48960019
         SPACE 1                                                        49040019
         CLC   INDSNAME(LEN44),OTDSNAME  DSNAMES EQUAL                  49120019
         BNE   TSTCMPRS                NO, CHECK PARM=COMPRESS          49200019
         CLC   OUTVOL(LEN6),INVOL  VOLUME=SER'S EQUAL                   49280019
         BNE   TSTCMPRS                NO, CHECK PARM=COMPRESS          49360019
         TM    DSCB+DS1DSORG,UNMOVEBL  IS OUTPUT (ALSO INPUT) DATA      49440019
*                                        SET UNMOVEABLE                 49520019
         BNO   TESTKEYS                NO, GO ON                        49600019
         SPACE 1                                                        49680019
         BAL   GR8,NOMOVE              GIVE ERROR MSG                   49760019
         B     GETNEXT                 TRY NEXT INPUT DATA SET          49840019
         SPACE 1                                                        49920019
TESTKEYS EQU   *                                                        50000019
         OC    OKEYLEN(LEN1),OKEYLEN  KEY LENGTH = 0                    50080019
         BZ    TESTRB                  NO, GO ON                        50160019
         SPACE 1                                                        50240019
         BAL   GR8,NCMPKEYS            GIVE ERROR MSG                   50320019
         B     GETNEXT                 GO TO ERROR RTN                  50400019
         SPACE 1                                                        50480019
TESTRB   EQU   *                                                        50560019
         TM    FLG3,REBLK              RE/DE BLOCKING REQUESTED         50640019
         BZ    TESTSE                  NO, GO ON                        50720019
         SPACE 1                                                        50800019
         BAL   GR8,NCMPRB              GIVE ERROR MSG                   50880019
         B     GETNEXT                 GO TO ERROR RTN                  50960019
         SPACE 1                                                        51040019
TESTSE   EQU   *                                                        51120019
         TM    COMDCDSW,SELECTSC+EXCLUDES  SELECTIVE OR EXCLUSIVE       51200019
*                                          COPY OPERATION               51280019
         BZ    TESTOV                  NO, GO ON                        51360019
         SPACE 1                                                        51440019
         BAL   GR8,NCMPSE              GIVE ERROR MESSAGE               51520019
         B     GETNEXT                 GO TO ERROR ROUTINE              51600019
         SPACE 1                                                        51680019
TESTOV   EQU   *                                                        51760019
         TM    FORM,FORM4              TRACK OVERFLOW                   51840019
         BZ    SETCMPSW                NO, GO ON                        51920019
         SPACE 1                                                        52000019
         BAL   GR8,NCMPOV              GIVE ERROR MSG                   52080019
         B     GETNEXT                 GO TO ERROR RTN                  52160019
         SPACE 1                                                        52240019
SETCMPSW EQU   *                                                        52320019
         OI    COMDCDSW,COMPRESS       SET COMPRESS BIT                 52400019
         BAL   GR8,COMPMESS            GIVE COMPRESS MESSAGE            52480019
         B     LEAVE                   GO ON                            52560019
         SPACE 1                                                        52640019
TSTCMPRS EQU   *                                                        52720019
         TM    COMDCDSW,COMPRESS       WAS PARM=COMPRESS                52800019
         BNO   LEAVE                   NO, GO ON                        52880019
         NI    COMDCDSW,XFF-COMPRESS  TURN OFF COMPRESS SWITCH          52960019
         BAL   GR8,NCMPMSG             GIVE NO COMPRESS MSG             53040019
         SPACE 1                                                        53120019
LEAVE    EQU   *                                                        53200019
         SPACE 1                                                        53280019
         L     GR13,SV5+SAV4      CALLERS SAVE AREA                     53360019
         RETURN (14,12)                RETURN TO CALLER- NO ERRORS      53440019
         TITLE 'IEBDV1 VALIDATE ROUTINE- SYSPRINT/SYSIN - IEBDV0'       53520019
         DS    0F                      FORCE ALIGNMENT                  53600019
IEBDV0   EQU   *                                                        53680019
*ENTRY VALIDATE/OPEN SYSPRINT/SYSIN                                     53760019
         SAVE  (14,12),,IEBDV0                                          53840019
         BALR  GR12,GR0           SET BASE REGISTER UP                  53920019
         LA    GR15,IEBDV0-IEBDV1      ESTABLISH TOTAL ADDRESSIBILITY   54000019
         SR    GR12,GR15               RELATIVE TO START OF CSECT       54080019
         ST    GR13,SV5+SAV4      POINTER TO OLD SAVE AREA              54160019
         LA    GR15,SV5                 PTR TO SAVE AREA                54240019
         ST    GR15,LEN8(GR13)                                          54320019
         LR    GR13,GR15               POINTER TO NEW SAVE AREA         54400019
         SPACE 1                                                        54480019
*                    OPEN AND VALIDATE SYSPRINT                       * 54560019
         SPACE 1                                                        54640019
         LA    GR5,PRTDCB              PRINTER DCB POINTER              54720019
         MVC   SYNADADR(LEN4,GR5),VIEBPER  ADDR OF SYSPRNT SYNAD TO DCB 54800019
         LA    GR3,PRDEXLST            PRINTER EXLST HANDLER- SYSIN TOO 54880019
         ST    GR3,LIST2               SET POINTER INTO EXIT LIST       54960019
         MVI   LIST2,LIST2SET          SET CODE FOR OPEN EXLST          55040019
         MVC   DDVALNM(LEN8),DDNAME1(GR5) SAVE NAME OF DS VALIDATING    55120019
         SPACE 1                                                        55200019
         OPEN  ((GR5),OUTPUT)          OPEN SYSPRINT                    55280019
         SPACE 1                                                        55360019
         TM    OPENFLGS(GR5),OPENOK    OPEN ERROR                       55440019
         BO    PRTOPEN                 NO, GO ON                        55520019
         SPACE                                                          55600019
ROTTENPT EQU   *                                                        55680019
         OI    IOEF2,SPRNOPN           SET SYSPRINT NOT OPEN SWITCH     55760019
         MVI   MSG1+LEN1,BADPRINT   BAD SYSPRINT MESSAGE                55840019
         MVI   MSG1,LASTMSG+PBIT       LAST MSG + BUILD                 55920019
         MVI   NAMEDISP,X00       OFFSET FOR NAME                       56000019
         MVI   PARAMS,NAME             EBDIC MSG                        56080019
         BAL   GR8,GIVEMES4            GIVE MESSAGE              A44144 56160022
         SPACE                                                          56240019
PRTOPEN  EQU   *                                                        56320019
         TM    CCDELIM,BADBLOCK        WAS THERE AN ERROR IN BLOCKSIZE  56400019
         BNO   OPENSYSN                NO, GO ON                        56480019
         NI    CCDELIM,XFF-BADBLOCK  TURN OFF ERROR SWITCH              56560019
         SPACE 1                                                        56640019
         CLOSE ((GR5))                 CLOSE SYSPRINT                   56720019
         SPACE 1                                                        56800019
         L     GR3,AMSG                LOAD POINTER TO MESSAGE CSECT    56880019
         USING IEBDV1MG,GR3            ADDRESSABILITY TO MSG CSECT      56960019
         MVI   MSGBUF,X40         SET BLANK IN BUFFER                   57040019
         MVC   MSGBUF+LEN1(LEN120),MSGBUF  CLEAR MSG BUFFER             57120019
         MVC   MSGBUF+LEN1(LEN37),TEXT1 SET INVALID SYSPRINT BLKSIZE    57200019
*                                         MSG IN BUFFER                 57280019
         MVC   MSGBUF+LEN10(LEN8),DDNAME1(GR5) MOVE DDNAME TO MESSAGE   57360019
         DROP  GR3                                                      57440019
         OI    IOEF2,SPRNOPN           SET SYSPRINT NOT OPEN SWITCH     57520019
         MVI   MSG1,IOERF+LASTMSG      SET AS SYNAD MSG+LAST            57600019
         BAL   GR8,GIVEMES4            SET RCD WRITE MESSAGE     A44144 57650022
         SPACE 1                                                        57840019
*                     OPEN AND VALIDATE SYSIN                         * 57920019
OPENSYSN EQU   *                                                        58000019
         LA    GR5,CARDCB              SYSIN DCB                        58080019
         MVC   EOFADDRS(LEN3,GR5),VIEBEOF+LEN1  SYSIN EODAD - TO DCB    58160019
         MVC   SYNADADR(LEN4,GR5),VIEBCER  ADDR OF SYSIN SYNAT TO DCB   58240019
         MVC   DDVALNM(LEN8),DDNAME1(GR5)  MOVE NAME TO BUFFER          58320019
         SPACE 1                                                        58400019
         OPEN  ((GR5),INPUT)           OPEN SYSIN                       58480019
         SPACE 1                                                        58560019
         TM    OPENFLGS(GR5),OPENOK    OPEN ERROR                       58640019
         BO    INOPEN                  NO, GO ON                        58720019
         SPACE                                                          58800019
         BAL   GR8,OPENBAD             GIVE MESSAGE                     58880019
ROTTENIN EQU   *                                                        58960019
         MVI   RCBUF,RTCDE        SET RETURN CODE=8                     59040019
         OI    IOEF2,NOSYSIN           SET SYSIN ERROR SWITCH           59120019
         OI    VTMFLG1,UNUSEND         SET SWITCH FOR VTM               59200019
         OI    FLG4,NEWODS             SET SWITCH FOR VTM               59280019
         B     SYSINVTM                TERMINATE                        59360019
         SPACE                                                          59440019
INOPEN   EQU   *                                                        59520019
         TM    CCDELIM,BADBLOCK        WAS THERE AN ERROR IN BLOCKSIZE  59600019
         BNO   SYSINOK                 NO, CONTINUE                     59680019
         SPACE 1                                                        59760019
         CLOSE ((GR5))                 CLOSE SYSIN                      59840019
         SPACE 1                                                        59920019
         BAL   GR8,BLOCKERR            GIVE ERROR MSG                   60000019
         B     ROTTENIN                TERMINATE                        60080019
         SPACE 1                                                        60160019
SYSINOK  EQU   *                                                        60240019
         MVI   CPARAMSW,READ1          PREPARE SO SCAN WILL READ A CARD 60320019
         USING CVT,GR1                                           A37881 60370000
         L     GR1,CVTPTR         ADDR OF COMM VECTOR TABLE      A37881 60380000
         L     GR2,CVTSVDCB       ADDR OF DCB FOR SYS1.SVCLIB    X010XX 60390000
         DROP  GR1                                               A37881 60392000
         LOAD  EP=IGG019C8,DCB=(GR2)   PRELOAD PCIAPPENDAGE      X010XX 60394000
         LOAD  EP=IGG019FT,DCB=(GR2)   PRELOAD SIOAPPENDAGE      X010XX 60396000
         B     LEAVE                   ALL DONE- SYSPRINT/SYSIN OK      60400019
         SPACE 1                                                        60480019
*                                      REGISTER 1 HAD DCB ADDRESS       60560019
*  EXIT LIST SYSPRINT/SYSIN            REGISTERS 2-13 SHOULD BE THE     60640019
*                                      SAME AS TIME OPEN WAS GIVEN      60720019
*                                      DON'T CLOBBER REGISTER 14        60800019
         SPACE 1                                                        60880019
PRDEXLST EQU   *        SYSIN/SYSPRINT EXIT LIST HANDLER BLKSIZE CHECK  60960019
         LH    GR6,LRECLDCB(GR1)       OBTAIN LRECL FROM DCB (121)      61040019
*                                      SYSIN DCB MACRO SET FOR 80 BYTES 61120019
         SR    GR8,GR8                 SYSPRINT DCB MACRO SET FOR 121   61200019
         LH    GR9,BLKSZDCB(GR1)       OBTAIN SYSPRINT BLOCKSIZE WHICH  61280019
*  WAS MERGED INTO DCB- OR SHOULD HAVE BEEN. SAME FOR SYSIN             61360019
         LTR   GR9,GR9                 BLOCKSIZE ZERO                   61440019
         BZ    NOBLKSZ                 YES- ASSUME LRECL                61520019
         DR    GR8,GR6                 DIVIDE BLKSIZE BY LRECL          61600019
         LTR   GR8,GR8                 ANY REMAINDER                    61680019
         BCR   MS8,GR14           NO REMAINDER RETURN TO OPEN           61760019
         OI    CCDELIM,BADBLOCK        SET BAD BLOCK SIZE SWITCH        61840019
NOBLKSZ  EQU   *                                                        61920019
         STH   GR6,BLKSZDCB(GR1)       MAKE BLOCKSIZE EQUAL LRECL       62000019
         BR    GR14                    RETURN TO OPEN                   62080019
         TITLE 'IEBDV1 VALIDATE ROUTINE- SYSUT3 DATA SET - IEBDV3'      62160019
         DS    0F                      FORCE ALIGNMENT                  62240019
IEBDV3   EQU   *                                                        62320019
*ENTRY VALIDATE/OPEN SYSUT3 DATA SET                                  * 62400019
         SAVE  (14,12),,IEBDV3                                          62480019
         BALR  GR12,GR0           GET ADDRESSABILITY                    62560019
         LA    GR15,IEBDV3-IEBDV1      ESTABLISH TOTAL ADDRESSIBILITY   62640019
         SR    GR12,GR15               RELATIVE TO START OF CSECT       62720019
         ST    GR13,SV5+SAV4      POINTER TO OLD SAVE AREA              62800019
         LA    GR15,SV5                 PTR TO SAVE AREA                62880019
         ST    GR15,LEN8(GR13)                                          62960019
         LR    GR13,GR15               POINTER TO NEW SAVE AREA         63040019
         SPACE 1                                                        63120019
         LA    GR5,UT3DCB                                               63200019
         LA    GR1,JFCB1               POINTER TO JFCB                  63280019
         ST    GR1,LIST1               STORE IN EXIT LIST               63360019
         MVI   LIST1,JFCBECON          SET JFCB EXIT+LAST ENTRY         63440019
         MVC   DDVALNM(LEN8),DDNAME1(GR5) SAVE NAME OF DS VALIDATING    63520019
         SPACE                                                          63600019
         DEVTYPE DDVALNM,UT3CHAR,DEVTAB GET SYSUT3 DEVICE DATA   S20201 63680020
         LTR   GR15,GR15               MISSING DD CARD                  63760019
         BZ    S3DDPRES                NO, GO ON                        63840019
         SPACE 1                                                        63920019
         BAL   GR8,NODDCD              GIVE ERROR MSG                   64000019
         B     SYSUT3PT                GO TO ERROR RTN                  64080019
         SPACE 1                                                        64160019
S3DDPRES EQU   *                                                        64240019
         CLI   UT3UCBTP,UCBDIRCT       IS SYSUT3 DASD                   64320019
         BE    UT3DIRCT                YES, GO ON                       64340019
         SPACE 1                                                        64360019
         BAL   GR8,NODIRECT            GIVE ERROR MESSAGE               64380019
         B     SYSUT3PT                GO TO ERROR ROUTINE              64400019
         SPACE 1                                                        64420019
UT3DIRCT EQU   *                                                        64440019
         LH    GR11,UT3LRECL           VALID LRECL                      64480019
         LA    GR9,DEVSYSU3            RETURN FROM 'VALIDS34'           64560019
         SPACE 1                                                        64640019
*                                                                     * 64720019
*  VALIDS34 IS GENERAL SUBROUTINE FOR VALIDATING AND OPENING EITHER   * 64800019
* SYSUT3 OR SYSUT4 UTILITY DATA SET. UPON ENTRY TO VALIDS34, GR9 IS   * 64880019
* SET WITH RETURN ADDRESS AND GR5 IS SET WITH DCB ADDRESS OF DATA SET * 64960019
* GR6 IS SET WITH UT3DS1 OR UT4DS1- TTR/TRACK BALANCE LAST RECORD BUF.* 65040019
* TO VALIDATE AND OPEN AND GR11 IS SET WITH VALID LRECL FOR THE DATA  * 65120019
* SET. SYSUT3 LRECL = 80 BYTES, SYSUT4 DATA SET LRECL = 272 BYTES     * 65200019
* GR2 HAS A POINTER TO BUFFER FOR MBBCCHHR OF LAST RECORD ON DATA SET * 65280019
*                                                                     * 65360019
         SPACE 1                                                        65440019
VALIDS34 EQU   *                                                        65520019
*                                                                     * 65600019
*                  READ IN JFCB AND OPEN                              * 65680019
*                                                                     * 65760019
         RDJFCB ((GR5))                READ JFCB SYSUT3 OR SYSUT4       65840019
         LA    GR8,JFCB1               JFCB BUFFER ADDRESS              65920019
         STH   GR11,JFCBLREC(GR8)      STORE LRECL IN JFCB              66000019
         STH   GR11,JFCBLKSZ(GR8)      STORE BLKSIZE IN JFCB            66080019
         SPACE 1                                                        66160019
         OPEN  ((GR5),OUTIN),TYPE=J    OPEN SYSUT3 AND SYSUT4           66240019
         BR    GR9                     RETURN                           66320019
         SPACE 1                                                        66400019
DEVSYSU3 EQU   *                                                        66480019
         TM    OPENFLGS(GR5),OPENOK    OPEN ERROR                       66560019
         BO    UT3OPEN                 NO, OK                           66640019
         SPACE 1                                                        66720019
         BAL   GR8,OPENBAD             GIVE MESSAGE                     66800019
         B     SYSUT3PT                GO TO ERROR RTN                  66880019
         SPACE 1                                                        66960019
UT3OPEN  EQU   *                                                        67040019
         L     GR1,DEBADDR(GR5)        DEB POINTER FROM DCB             67120019
         XC    UT3FDAD(LEN8),UT3FDAD   SET FDAD                         67200019
         MVC   UT3FDAD+LEN1(LEN6),DEBBCCHH(GR1)  IN BUFFER              67280019
         XC    UT3DS1(LEN8),UT3DS1   CLEAR TTR AND TRACK SIZE           67360019
         MVC   UT3DS1+LEN4(LEN2),UT3TSIZE SET TRK BALANCE=TRK SIZE      67440019
         MVC   SYS3TTR(LEN8),UT3DS1  MOVE TTRN/TB TO BACK UP BUFFER     67520019
         MVC   TRKBALAN(LEN2,GR5),UT3TSIZE  SET TRK BALANCE IN DCB      67600019
         MVC   FDADADDR(LEN8,GR5),UT3FDAD  SET FDAD IN DCB              67680019
         B     LEAVE                   RETURN- VALIDATE SYSUT3 DONE     67760019
         EJECT                                                          67840019
*********************************************************************** 67920019
*                                                                     * 68000019
*   THIS ROUTINE IS ENTERED WHEN A VALIDATION ERROR OCCURS ON         * 68080019
*  SYSUT3 OR SYSUT4.  IT HAS TWO ENTRY POINTS 'SYSUT3PT' FOR SYSUT3   * 68160019
*  AND 'SYSUT4PT' FOR SYSUT4                                          * 68240019
*                                                                     * 68320019
*********************************************************************** 68400019
         SPACE 1                                                        68480019
SYSUT4PT EQU   *                                                        68580019
         NI    FLG4,XFF-ODALT     TURN OFF ODALT                        68650019
         B     UT34OPEN                GO AROUND                        68730019
SYSUT3PT EQU   *                                                        68780019
         OI    FLG7,NOPRNBDB+SUPPRMSG  INHIBIT SOME MSGS BY IEBVTM      68880019
UT34OPEN EQU   *                                                        68980019
         TM    OPENFLGS(GR5),OPENOK    WORK FILE OPEN                   69120019
         BNO   WCLOSED                 NO, GO AROUND                    69200019
         SPACE 1                                                        69280019
         CLOSE ((GR5))                 CLOSE WORK FILE                  69360019
         SPACE 1                                                        69440019
WCLOSED  EQU   *                                                        69520019
         MVI   RCBUF,RTCDE             SET RETURN CODE=8         A44144 69600022
         B     TERMINAT                TERMINATE                        69680019
         TITLE 'IEBDV1 VALIDATE ROUTINE- SYSUT4 DATA SET - IEBDV4'      69760019
         DS    0F                      FORCE ALIGNMENT                  69840019
IEBDV4   EQU   *                                                        69920019
*ENTRY VALIDATE/OPEN SYSUT4 DATA SET                                  * 70000019
         SAVE  (14,12),,IEBDV4                                          70080019
         BALR  GR12,GR0           GET ADDRESSABILITY                    70160019
         LA    GR15,IEBDV4-IEBDV1      ESTABLISH TOTAL ADDRESSIBILITY   70240019
         SR    GR12,GR15               RELATIVE TO START OF CSECT       70320019
         ST    GR13,SV5+SAV4      POINTER TO OLD SAVE AREA              70400019
         LA    GR15,SV5                 PTR TO SAVE AREA                70480019
         ST    GR15,SAV8(GR13)                                          70560019
         LR    GR13,GR15               POINTER TO NEW SAVE AREA         70640019
         SPACE 1                                                        70720019
         LA    GR5,UT4DCB              DCB TO CHECK                     70800019
         LA    GR1,JFCB1               POINTER TO JFCB                  70880019
         ST    GR1,LIST1               STORE IN EXIT LIST               70960019
         MVI   LIST1,JFCBECON          SET JFCB EXIT+LAST ENTRY         71040019
         MVC   DDVALNM(LEN8),DDNAME1(GR5)  SAVE NAME OF DS VALIDATING   71120019
         SPACE                                                          71200019
         DEVTYPE DDVALNM,UT4CHAR,DEVTAB GET SYSUT4 DEVICE DATA   S20201 71280020
         LTR   GR15,GR15               MISSING DD CARD                  71360019
         BZ    S4DDPRES                NO, GO ON                        71440019
         SPACE 1                                                        71520019
         BAL   GR8,NODDCD              GIVE ERROR MSG                   71600019
         B     SYSUT4PT                GO TO ERROR RTN                  71680019
         SPACE 1                                                        71760019
S4DDPRES EQU   *                                                        71840019
         CLI   UT4UCBTP,UCBDIRCT       IS SYSUT4 DASD                   71920019
         BE    UT4DIRCT                YES, GO ON                       71940019
         SPACE 1                                                        71960019
         BAL   GR8,NODIRECT            GIVE ERROR MESSAGE               71980019
         B     SYSUT4PT                GO TO ERROR ROUTINE              72000019
         SPACE 1                                                        72020019
UT4DIRCT EQU   *                                                        72040019
         LH    GR11,UT4LRECL           VALID LRECL                      72080019
         BAL   GR9,VALIDS34            CHECK SYSUT4 AND OPEN            72160019
         SPACE 1                                                        72240019
         TM    OPENFLGS(GR5),OPENOK    OPEN ERROR                       72320019
         BO    UT4OPEN                 NO, OK                           72400019
         SPACE 1                                                        72480019
         BAL   GR8,OPENBAD             GIVE MESSAGE                     72560019
         B     SYSUT4PT                GO TO ERROR RTN                  72640019
         SPACE 1                                                        72720019
UT4OPEN  EQU   *                                                        72800019
         L     GR1,DEBADDR(GR5)        DEB POINTER FROM DCB             72880019
         XC    UT4FDAD(LEN8),UT4FDAD  SET FDAD                          72960019
         MVC   UT4FDAD+LEN1(LEN6),DEBBCCHH(GR1)  IN BUFFER              73040019
         XC    UT4DS1(LEN8),UT4DS1   CLEAR TTR AND TRACK SIZE           73120019
         MVC   UT4DS1+LEN4(LEN2),UT4TSIZE  SET TRK BAL=TRK SIZE         73200019
         MVC   SYS4TTR(LEN8),UT4DS1  MOVE TTRN/TB TO BACK UP BUFFER     73280019
         MVC   TRKBALAN(LEN2,GR5),UT4TSIZE SET TRK BALANCE IN DCB       73360019
         MVC   FDADADDR(LEN8,GR5),UT4FDAD  SET FDAD IN DCB              73440019
         B     LEAVE                   RETURN- VALIDATE SYSUT4 DONE     73520019
         TITLE 'IEBDV1 VALIDATE ROUTINE MESSAGES AND CONSTANTS'         73600019
*                                                                     * 73680019
*                 VALIDATION ERROR MESSAGES PREPARATION AREA          * 73760019
*                                                                     * 73840019
         SPACE 1                                                        73920019
NOREBLKY EQU   *                                                        74000019
         MVI   MSG2+LEN1,NORBKEYS  NO REBLOCK KEYED RECORDS MESS        74080019
         B     GENVALMS                SET UP HEADER AND THIS MESSAGE   74160019
         SPACE                                                          74240019
CATERROR EQU   *                                                        74320019
         MVI   MSG2+LEN1,CONCATBD  CONCATENATION ERROR                  74400019
         B     GENVALMS                SET UP HEADER AND THIS MESSAGE   74480019
         SPACE 1                                                        74560019
NOREBLOV EQU   *                                                        74640019
         MVI   MSG2+LEN1,NORBOVRF  NO REBLOCK OVERFLOW RECORDS          74720019
         B     GENVALMS                SET UP HEADER AND THIS MESSAGE   74800019
         SPACE 1                                                        74880019
KEYERR   EQU   *                                                        74960019
         MVI   MSG2+LEN1,UNEQKEYS  UNEQUAL KEY LENGTH                   75040019
         B     GENVALMS                SET UP HEADER AND THIS MESSAGE   75120019
         SPACE 1                                                        75200019
UNEQRCFM EQU   *                                                        75280019
         MVI   MSG2+LEN1,RECFMINC  RECORD FORMAT INCOMPATIBLE           75360019
         B     GENVALMS                SET UP HEADER AND THIS MESSAGE   75440019
         SPACE 1                                                        75520019
NOMOVE   EQU   *                                                        75600019
         MVI   MSG1+LEN1,UNMOVEDS                                       75680019
         MVI   MSG1,LASTMSG+PBIT       LAST MSG + BUILD                 75760019
         MVI   NAMEDISP,X00        OFFSET FOR NAME                      75840019
         MVI   PARAMS,NAME             EBDIC NAME                       75920019
         B     GIVEMESS                GIVE MSG                         76000019
         SPACE 1                                                        76080019
NCMPKEYS EQU   *                                                        76160019
         MVI   MSG2+LEN1,INVALRFM  NO COMPRESS WITH KEYS                76240019
         B     GENVALMS                SET UP HEADER AND THIS MSG       76320019
         SPACE 1                                                        76370099
NOREDEB  EQU   *                                               @ZA06526 76380099
         MVI   MSG2+LEN1,INVALRBC      NO RE/DE BLOCK IF UNDEF @ZA06526 76390099
         B     GENVALMS                SET UP HDR AND THIS MSG @ZA06526 76392099
         SPACE 1                                                        76400019
NCMPRB   EQU   *                                                        76480019
         MVI   MSG2+LEN1,M51      NO COMPRESS WITH RE/DE BLOCK          76560019
         B     GENVALMS                SET UP HEADER AND THIS MSG       76640019
         SPACE 1                                                        76720019
NCMPSE   EQU   *                                                        76800019
         MVI   MSG2+LEN1,M39      NO COMPRESS WITH SELECT               76880019
*                                        OR EXCLUDE                     76960019
         B     GENVALMS                SET UP HEADER AND THIS MESSAGE   77040019
         SPACE 1                                                        77120019
NCMPOV   EQU   *                                                        77200019
         MVI   MSG2+LEN1,M50      NO COMPRESS WITH TRKOVFLOW            77280019
         B     GENVALMS                SET UP HEADER AND THIS MSG       77360019
         SPACE 1                                                        77440019
LRECLBAD EQU   *                                                        77520019
         MVI   MSG2+LEN1,INVALREC  INVALID LRECL MESSAGE                77600019
         B     GENVALMS                SET UP HEADER AND THIS MESSAGE   77680019
         SPACE 1                                                        77760019
BLOCKERR EQU   *                                                        77840019
         MVI   MSG2+LEN1,INVALBLK  INVALID BLOCKSIZE                    77920019
         B     GENVALMS                SET UP HEADER AND THIS MESSAGE   78000019
         SPACE 1                                                        78080019
OBTAINBD EQU   *                                                        78160019
         MVI   MSG2+LEN1,OBTAINER  OBTAIN ERROR                         78240019
         B     GENVALMS                SET UP HEADER AND THIS MESSAGE   78320019
         SPACE 1                                                        78400019
DV000800 EQU   *                                                 X010XX 78480000
         MVI   MSG2+LEN1,NOTPDSER  INVALID DSORG                 X010XX 78530000
         B     GENVALMS                SET UP HEADER AND THIS MESSAGE   78640019
         SPACE 1                                                        78720019
NODIRECT EQU   *                                                        78800019
         MVI   MSG2+LEN1,NOTDA     NOT A DASD DATA SET                  78880019
         B     GENVALMS                SET UP HEADER AND THIS MESSAGE   78960019
         SPACE                                                          79040019
NODDCD   EQU   *                                                        79120019
         MVI   MSG2+LEN1,NODDCARD  DD CARD NOT FOUND                    79200019
         B     GENVALMS                SET UP HEADER AND THIS MESSAGE   79280019
         SPACE 1                                                        79360019
COMPMESS EQU   *                                                        79440019
         MVI   MSG1+LEN1,IMPCOMPR  IMPLIED COMPRESS                     79520019
         MVI   MSG1,LASTMSG+PBIT       LAST MSG + BUILD                 79600019
         MVI   NAMEDISP,LEN37      OFFSET FOR NAME                      79680019
         MVI   PARAMS,NAME             EBDIC NAME                       79760019
         B     KEEPCODE                GIVE MESSAGE                     79840019
         SPACE 1                                                        79920019
NCMPMSG  EQU   *                                                        80000019
         MVI   MSG1+LEN1,NOCMPOSS  NO COMPRESS MESSAGE                  80080019
         MVI   MSG1,LASTMSG            LAST MESSAGE              X010XX 80160000
         B     GIVEMES4                GIVE MESSAGE              A44144 80400022
         SPACE                                                          80480019
OPENBAD  EQU   *                                                        80560019
         MVI   MSG2+LEN1,OPENERRX  OPEN ERROR                           80640019
         SPACE 1                                                        80720019
GENVALMS EQU   *                                                        80800019
         MVI   MSG1+LEN1,GENERUAL  GENERAL VALIDATE MESSAGE             80880019
         MVI   MSG1,PBIT               SET TO SHOW MESSAGE TO BE BUILT  80960019
         MVI   PARAMS,NAME             EBDIC NAME                       81040019
         MVI   NAMEDISP,X00       PUT DDNAME IN FRONT OF MESSAGE        81120019
         MVI   MSG2,LASTMSG            SET LAST MESSAGE SWITCH          81200019
GIVEMESS EQU   *                                                        81280019
         CLI   RCBUF,RTCDE             PRESENT CODE LOWER 8      A44144 81330022
         BNL   KEEPCODE                NO                        A44144 81380022
         MVI   RCBUF,RTCDE             YES-MOVE IN CODE OF 8     A44144 81430022
         B     KEEPCODE                GIVE MESSAGE              A44144 81570022
GIVEMES4 EQU   *                                                 A44144 81580022
         CLI   RCBUF,RTCD              PRESENT CODE LOWER 4      A44144 81590022
         BNL   KEEPCODE                NO                        A44144 81592022
         MVI   RCBUF,RTCD              YES-MOVE IN CODE OF 4     A44144 81594022
KEEPCODE EQU   *                                                        81600019
         L     GR15,VIEBVMS            ADDRESS OF MESSAGE WRITER        81680019
         BALR  GR14,GR15               WRITE MESSAGE                    81760019
         SPACE                                                          81840019
         BR    GR8                     RETURN                           81920019
         EJECT                                                          82000019
*********************************************************************** 82080019
*                                                                     * 82160019
*        THIS ROUTINE CHECKS FOR CONCATENATED DD CARDS WHICH ARE      * 82240019
*     INVALID FOR THIS PROGRAM ON INDD CARDS                          * 82320019
*                                                                     * 82400019
*********************************************************************** 82480019
         SPACE                                                          82560019
CHECKCAT EQU   *                                                        82640019
         SPACE                                                          82720019
         EXTRACT TIOT,FIELDS=(TIOT)    PLACE TIOT ADDRESS AT TIOT       82800019
         SPACE                                                          82880019
         XR    GR0,GR0                 CLEAR WORK REGISTER              82960019
         L     GR1,TIOT                POINTER TO TIOT                  83040019
         LA    GR1,DDENTRY(GR0,GR1)  BUMP TO FIRST DD CARD              83120019
         SPACE                                                          83200019
CHECKDD  EQU   *                                                        83280019
         IC    GR0,LEN0(GR0,GR1)     INSERT  DD ENTRY LENGTH            83360019
         CLC   NAMEDD(LEN8,GR1),DDVALNM  IS THIS CURRENT DD NAME        83440019
         BE    NEXTBLNK                YES, CHECK FOR CONCATENATION     83520019
         AR    GR1,GR0                 BUMP TO NEXT DD ENTRY            83600019
         B     CHECKDD                 TRY AGAIN                        83680019
         SPACE                                                          83760019
NEXTBLNK EQU   *                                                        83840019
         AR    GR1,GR0                 BUMP TO NEXT ENTRY               83920019
         CLI   LEN0(GR1),X00      IS THIS LAST ENTRY                    84000019
         BE    CHECKOK            YES, OK (NO CONCATENATION)            84080019
         SPACE                                                          84160019
         CLI   NAMEDD(GR1),BLANK       IS DDNAME BLANK                  84240019
         BNE   CHECKOK                 NO, OK                           84320019
         SPACE 1                                                        84400019
         BAL   GR8,CATERROR            GIVE ERROR MSG                   84480019
         B     GETNEXT                 GO TO ERROR RTN                  84560019
         SPACE                                                          84640019
CHECKOK  EQU   *                                                        84720019
         BR    GR7                     RETURN                           84800019
         EJECT                                                          84880019
*********************************************************************** 84960019
*                                                                     * 85040019
*    THIS ROUTINE IS ENTERED FOR VALIDATION ERRORS OCCURING ON THE    * 85120019
*  OUTPUT OR INPUT DATA SET.  CONTROL IS GIVEN TO IEBVTM.             * 85200019
*                                                                     * 85280019
*********************************************************************** 85360019
         SPACE 1                                                        85440019
GETNEXT  EQU   *                                                        85520019
         TM    FLG3,OUTPUTEP           ENTERED AT DV1                   86160019
         BZ    TERMINAT                NO, GO ON                        86240019
         SPACE 1                                                        86320019
         MVI   MSG1+LEN1,NONECOPY NO MEMBERS COPIED MSG                 86400019
         MVI   MSG1,LASTMSG+PBIT       LAST MSG + BUILD                 86480019
         MVI   PARAMS,NAME+MSGULLD     INDIC NAME PARAMETER      X010XX 86560000
*                                       AND ' COPIED ' IN MSG    X010XX 86610000
         MVI   NAMEDISP,LEN46          SET OFFSET FOR NAME       X010XX 86620000
         MVI   COPDISP,LEN11           DISP OF ' COPIED ' IN MSG X010XX 86630000
         MVC   DDVALNM(LEN8),OUTNAME  MOVE OUTDD NAME FOR MSG           86720019
         BAL   GR8,GIVEMESS            GIVE MESSAGE              A44144 86800022
         SPACE 1                                                        87040019
TERMINAT EQU   *                                                        87120019
         MVI   VTMFLG1,UNUSEND         SET SWITCH FOR VTM               87200019
SYSINVTM EQU   *                                                        87240019
         L    GR15,VIEBVTM                                              87280019
         BALR  GR14,GR15               GO TO VTM (NO RETURN)            87360019
         EJECT                                                          87440019
**       A MOUNT REQUEST IS GIVEN NOW BY MEANS OF AN            OY01182 87443002
**       OPENJ OF THE VTOC OF THE VOLUME  SEARCHED FOR          OY01182 87446002
OPENVTOC LA    GR8,OPENJDCB            DCB FOR THE VTOC         OY01182 87449002
         USING IHADCB,GR8                                       OY01182 87452002
         OI    FLG3,ENTOBT             PREVENT LOOP             OY01182 87455002
         OI    MNTJFCB+87,JFCSHARE                              OY01182 87458002
         MVC   DCBDDNAM(MS8),DDNAME1(GR5)                       OY01182 87461002
         OPEN  ((GR8),INPUT),TYPE=J    OPEN VTOC                OY01182 87464002
         CLOSE ((GR8))            OK,VOLUME SHOULD BE MOUNTED  @ZA18344 87467099
         DROP  GR8                                              OY01182 87470002
         BR    GR7                REPEAT OBTAIN,VOLUME MOUNTED  OY01182 87473002
OPENJDCB DCB   DSORG=PS,MACRF=R,EXLST=MNTLIST,BLKSIZE=96,       OY01182C87476002
               LRECL=96,KEYLEN=44,RECFM=F                       OY01182 87479002
         DS    0F                                               OY01182 87482002
MNTLIST  DC    X'87'                                            OY01182 87485002
         DC    AL3(MNTJFCB)                                     OY01182 87488002
MNTJFCB  DC    44X'04'                                         @ZA06528 87491099
         DC    8C' '                                            OY01182 87494002
         DC    X'08'                   WRITE BACK INHIBIT       OY01182 87497002
         DC    XL123'00'                                        OY01182 87500002
         SPACE 1                                                        87520019
IEBDVJCB DC    44F'0'                  JFCB AREA                        87570019
JFCB1    EQU   IEBDVJCB                                                 87620019
         SPACE                                                          87680019
         SPACE                                                          87760019
TIOT     DC    F'0'                    ADDRESS OF TIOT FILLED IN BY     87840019
*                                        EXTRACT MACRO                  87920019
         SPACE 1                                                        88000019
INVOL    DS    CL6                     VOLID OF INPUT                   88080019
         SPACE 1                                                        88160019
INDSNAME DS    CL44                    FIELD FOR INPUT DSNAME           88240019
         SPACE 1                                                        88320019
OBTL     CAMLST  SEARCH,JFCB1,JFCBVOLD,DSCB  OBTAIN MACRO               88400019
         SPACE 1                                                        88480019
DSCB     DS    0F                                                       88560019
         DS    148C                    DSCB BUFFER               X010XX 88640000
         SPACE 1                                                        88720019
AMSG     DC    A(IEBDV1MG)             ADDRESS OF MSG CSECT             88800019
PARMLST  DC    A(IEBDVJCB)             ADDRESS OF JFCB AREA      X010XX 88850000
         DC    A(DSCB)                 ADDRESS OF DSCB AREA      X010XX 88860000
         DC    A(INVOL)                ADDRESS OF INPUT VOLID    X010XX 88870000
*                                       AREA                     X010XX 88872000
         DC    A(INDSNAME)             ADDRESS OF INPUT DSNAME   X010XX 88874000
*                                       AREA                     X010XX 88876000
PATCHLEN EQU   (*-IEBDV1)/20      LENGTH OF 5 PER CENT PATCH AREA       88880019
PATCH    DC    XL(PATCHLEN)'00'   5 PER CENT PATCH AREA          A41780 88960021
         EJECT                                                          89040019
IEBDV1MG CSECT                                                          89120019
TEXT1    DC    C'IEB173I           - INVALID BLOCKSIZE'  ERROR MSG      89200019
         EJECT                                                          89280019
IEBMCA   DSECT                                                          89360019
         IEBMCA                                                         89440019
         EJECT                                                          89520019
         DCBD  DSORG=PS                                                 89600019
         EJECT                                                          89610000
CVT      DSECT                                                   A37881 89620000
         CVT                                                     A37881 89630000
         EJECT                                                          89650021
IECDSECT DSECT                                                          89760019
         IECDSECT                                                       89840019
         EJECT                                                          89920019
*                      GENERAL EQUATES                                  90000019
         SPACE 1                                                        90080019
PARTORG  EQU   X'02'                   BIT 6 SET IF PDS.                90160019
BADDSORG EQU   X'A0'                   DSORG BITS USED ONLY FOR  X010XX 90210000
*                                        IS OR DA DATA SETS      X010XX 90220000
UNMOVEBL EQU   X'01'                   DSORG SETTING INMOVABLE DATA SET 90240019
FIXEDREC EQU   X'80'                   DCB RECFM FIELD FOR FIXED RECORD 90320019
VARREC   EQU   X'40'                   DCB RECFM FIELD FOR VAR RECORDS  90400019
UNDEFREC EQU   X'C0'                   DCB RECFM FIELD FOR UNDEFINED RC 90480019
BLOCKREC EQU   X'10'                   DCB RECFM FIELD FOR BLOCKED REC. 90560019
VARBLOCK EQU   X'50'                   DCB RECFM FIELD VARIABLE BLOCKED 90640019
OVERFLOW EQU   X'20'                   DCB RECFM FIELD FOR OVERFLOW REC 90720019
OPENOK   EQU   X'10'                   TEST FOR OPEN ERROR              90800019
NEWDATAS EQU   X'11'                   CODE FOR NEW DATA SET            90880019
VALCHK   EQU   X'80'                   SET IF VALIDITY CHECK TO BE DONE 90960019
CLEAR0   EQU   X'00'                                                    91040019
THE2321  EQU   X'05'                   UCB CODE FOR 2321                91120019
NMDISP   EQU   2                       DISPLACEMENT OF DDNAME IN        91200019
*                                         INDD TABLE                    91280019
INCRINDD EQU   10                      LENGTH OF INDD TABLE ENTRY       91360019
BLANK    EQU   X'40'                   EBCDIC BLANK                     91440019
         SPACE 1                                                        91520019
*                     JFCB FIELDS                                       91600019
VOLIDJCB EQU   JFCBVOLS-INFMJFCB       OFFSET OF VOLID IN JFCB          91680019
JFCBVOLD EQU   JFCB1+VOLIDJCB          VOLID AREA JFCB FOR OBTAIN MACRO 91760019
JFCBMOD  EQU   JFCBIND2-INFMJFCB       '01' = OLD,'11' = NEW, '10'=MOD  91840019
JFCBMRGE EQU   JFCBUFNO-INFMJFCB       CLEAR 20 BYTES FOR MERGE         91920019
JFCBLREC EQU   JFCLRECL-INFMJFCB       LRECL FIELD                      92000019
JFCBLKSZ EQU   JFCBLKSI-INFMJFCB       BLOCK SIZE                       92080019
JFCBVALC EQU   JFCOPTCD-INFMJFCB       VALIDITY CHECK IF '80'           92160019
         SPACE 1                                                        92240019
*                     DSCB FIELDS                                       92320019
DS1DSORG EQU   DSCFILTY-DXDSCB         DATA SET ORGANIZATION FIELD DSCB 92400019
DS1LRECL EQU   DSCLRECL-DXDSCB         DATA SET LRECL DSCB              92480019
DS1BLKL  EQU    DSCBLKL-DXDSCB         DATA SET BLOCK SIZE DSCB         92560019
DS1LSTAR EQU   DSCLSTAR-DXDSCB         TTR + TRACK BALANCE LAST TRACK   92640019
         SPACE 1                                                        92720019
*                      DEB FIELDS                                       92800019
EXTNODEB EQU   DXDEBUSR-DXDEB          NUMBER OF EXTENTS FROM DEB       92880019
DEBNMTRK EQU   DXDEBNTR-DXDEB          EXTENT TRACKS                    92960019
DEBBCCHH EQU   DXDEBBIN-DXDEB          BBCCHH IN DEB                    93040019
UCBPTR   EQU   DXDEBUCB-DXDEB          POINTER TO UCB IN DEB            93120019
         SPACE 1                                                        93200019
*                      IOB FIELDS                                       93280019
IOBBCCHH EQU   DXDAADDR-DXIOB+1        BBCCHH IN IOB                    93360019
IOBMCCHH EQU   DXDAADDR-DXIOB          MBBCCHHR IN IOB                  93440019
         SPACE 1                                                        93520019
*                      DCB FIELDS                                       93600019
FDADADDR EQU   DCBFDAD-IHADCB          FDAD ADDRESS IN DCB              93680019
TRKBALAN EQU   DCBTRBAL-IHADCB         DCB TRACK BALANCE                93760019
KEYLENGT EQU   DCBKEYLE-IHADCB         KEY LENGTH IN DCB                93840019
RECFMFLD EQU   DCBRECFM-IHADCB         RECFM FIELD IN DCB               93920019
DDNAME1  EQU   DCBDDNAM-IHADCB         DD NAME IN DCB                   94000019
OPENFLGS EQU   DCBOFLGS-IHADCB         OPEN FLAGS IN DCB                94080019
DEBADDR  EQU   DCBDEBAD-IHADCB         DEB POINTER IN DCB               94160019
SYNADADR EQU   DCBSYNAD-IHADCB         SYNAD ADDRESS IN DCB             94240019
EOFADDRS EQU   DCBEODAD-IHADCB+1       EODAD ADDRESS IN DCB             94320019
LRECLDCB EQU   DCBLRECL-IHADCB         DCB LRECL FIELD                  94400019
BLKSZDCB EQU   DCBBLKSI-IHADCB         DCB BLOCK SIZE FIELD             94480019
OPTCDFLD EQU   DCBOPTCD-IHADCB         DCB OPTCD FIELD                  94560019
DIRCTDCB EQU   DCBDIRCT-IHADCB         DCB DIRECTORY BYTE COUNT FIELD   94600019
LWR      EQU   X'80'                   LAST OPERATION WAS A WRITE       94640019
*                                        (HIGH ORDER BIT OF DCBOFLAGS)  94720019
AOSFB    EQU   X'08'                   FIX LIST APPENDAGE INDIC- X010XX 94770000
*                                        ATOR IN DCBOPTCD FIELD  X010XX 94780000
         SPACE                                                          94800019
*                      TIOT FIELDS                                      94880019
DDENTRY  EQU   24                      OFFSET TO FIRST DD CARD ENTRY    94960019
NAMEDD   EQU   4                       OFFSET TO DDNAMES FROM DD ENTRY  95040019
         SPACE 1                                                        95120019
*                      DEVTYPE FIELDS                                   95200019
UT3UCBTP EQU   UT3CHAR+2               UCBTYPE FIELDS                   95280019
UT4UCBTP EQU   UT4CHAR+2                  FROM DEVTYPE MACRO            95360019
UT3TSIZE EQU   UT3CHAR+12              TRACK SIZE FIELD                 95440019
UT4TSIZE EQU   UT4CHAR+12              TRACK SIZE FIELD                 95520019
UCBDIRCT EQU   X'20'                   DIRECT ACCESS                    95600019
INUCBTP  EQU   INCHAR+2    INDCB UCB TYPE FROM DEVTYPE                  95680019
OUTUCBTP EQU   OUTCHAR+2  OUTDCB UCB TYPE FROM DEVTYPE                  95760019
OUTUCBDV EQU   OUTCHAR+3               DEVICE CODE FROM UCB (DEVTYPE)   95840019
OUTBOLST EQU   OUTCHAR+15    BLOCK OVERHEAD LAST RECORD - 1 BYTE FIELD  95860019
OUTKEYOV EQU   OUTCHAR+16    KEY OVERHEAD - 1 BYTE FIELD                95880019
OUTDEVFG EQU   OUTCHAR+17    OUTPUT DEVICE FLAG FIELD            S20201 95885020
HALFOVER EQU   X'08'         OVERHEAD LAST=OVERHEAD NOT LAST     S20201 95890020
*                               AND IS A TWO BYTE FIELD          S20201 95895020
OUTOVER2 EQU   OUTCHAR+14    OUTPUT DEVICE RECORD IF THIS IS A   S20201 95900020
*                               DEVICE WITH A TWO BYTE OVERHEAD  S20201 95905020
*                               VALUE                            S20201 95910020
         END                                                            95920019
