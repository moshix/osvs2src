*    NEW MODULE, RELEASE 17.                                       DG0H 00010000
*A547700-548000,714600                                           A35464 00020000
*C548100                                                         A35464 00030000
*D548600-549100                                                  A35464 00040000
*A285900-285984,291900,763600,764100                             A38710 00050000
*C308200,436100,444100                                           A38710 00060000
*A598700-598792                                                  A44355 00070000
*A412650-413100                                                 OY01164 00080000
*C162400                                                       @ZA04231 00090000
*C162400                                                       @ZA07345 00100000
*D184600                                                       @ZA24045 00110000
*A598730-598737,600100,603100,609700                           @ZA24045 00120000
         LCLA  &T,&SPN                                            0002  00130000
.@001    ANOP                                                     0002  00140000
IEBFDANL CSECT ,                                                  0002  00150000
         ST    @E,12(0,@D)                                        0002  00160000
         STM   @0,@8,20(@D)                                       0002  00170000
         STM   @A,@C,60(@D)                                       0002  00180000
         BALR  @B,0                                               0002  00190000
@PSTART  DS    0H                                                 0002  00200000
         USING @PSTART+00000,@B                                   0002  00210000
         LA    @3,4095(0,@B)                                      0002  00220000
         USING @PSTART+04095,@3                                   0002  00230000
         L     @0,@SIZ001                                         0002  00240000
         GETMAIN  R,LV=(0)                                        0002  00250000
         LR    @C,@1                                              0002  00260000
         USING @DATD+00000,@C                                     0002  00270000
         LM    @0,@1,20(@D)                                       0002  00280000
         XC    @TEMPS(@L),@TEMPS                                  0002  00290000
         ST    @D,@SAV001+4                                       0002  00300000
         LA    @F,@SAV001                                         0002  00310000
         ST    @F,8(0,@D)                                         0002  00320000
         LR    @D,@F                                              0002  00330000
*  F1A2:;                                                               00340000
*         IF FDPSW = ON THEN DO     /*DO WE CONTINUE AFTER PICT LGTH*/; 00350000
F1A2     CLC   549(1,@5),ON                                       0046  00360000
         BC    07,@9FF                                            0046  00370000
*               R9 = R9 + 2         /*YES ADVANCE PTR TO CONT COLUMN*/; 00380000
         AH    @9,@D1                                             0048  00390000
*         R6 = LREMAIN         /** REFRESH VALUE TO BE MOVED**/;        00400000
         L     @6,612(0,@5)                                       0049  00410000
*               GO TO F4B5          /*BRANCH TO PROCESS PICTURE */;     00420000
         BC    15,F4B5                                            0050  00430000
*         END;                                                          00440000
*  /******************************************************************* 00450000
*  /**                                                               ** 00460000
*  /** THIS SECTION TESTS FOR THE FDPCSW WHICH WAS SET WHEN THE       * 00470000
*  /** PICTURE PARAMETER WAS CONTINUED UPON ANOTHER CARD.IF THE SWITCH* 00480000
*  /** IS ON IT IS TURNED OFF,THE SCAN POINTER ADVANCED TO COLUMN     * 00490000
*  /** THREE(ONE MORE TO BE ADDED LATER),THE LENGTH REMAINING IN THE  * 00500000
*  /** PICTURE PLACED IN A REGISTER AND A BRANCH TAKEN TO SCAN OUT THE* 00510000
*  /** REST OF THE PICTURE.THE BASE MODULE PASSES CONTROL TO THIS     * 00520000
*  /** MODULE WHEN THE FDPCSW IS FOUND ON.                            * 00530000
*  /**                                                                * 00540000
*                              /**WE ARE NOW SCANNING OUT A PICTURE  ** 00550000
*                              /**THAT EXTENDS OVER MORE THAN ONE    ** 00560000
*                              /**INPUT CARD                         ** 00570000
*  /******************************************************************/ 00580000
*         IF FDPCSW = ON THEN DO   /* IF PICSW ON THEN DO FOLLOWING*/;  00590000
@9FF     CLC   538(1,@5),ON                                       0052  00600000
         BC    07,@9FE                                            0052  00610000
*               FDPCSW = OFF   /**TURN OFF PICTURE CONTINUE SWITCH**/;  00620000
         MVC   538(1,@5),OFF                                      0054  00630000
*               R9 = R9 + 2              /**ADD TWO TO BUF PTR **/;     00640000
         AH    @9,@D1                                             0055  00650000
*               R6 = LREMAIN        /** PICK UP REMAINING LENGTH**/;    00660000
         L     @6,612(0,@5)                                       0056  00670000
*               GO TO F4E3               /*BRANCH TO CONT PROCESS */;   00680000
         BC    15,F4E3                                            0057  00690000
*         END;                                                          00700000
*  /******************************************************************* 00710000
*  /**                                                                * 00720000
*  /** THIS SECTION TESTS FOR THE FDCSW (FD CONTINUATION SWITCH) BEING* 00730000
*  /** ON.IT WAS SET WHEN A FD CONTINUATION WAS DETERMINED.CONTROL IS * 00740000
*  /** PASSED TO THIS MODULE WHEN THE BASE MODULE FINDS THIS SWITCH ON* 00750000
*  /** WHEN ON,THE CONTINUATION SWITCH IS TURNED OFF,THE SCAN POINTER * 00760000
*  /**ADVANCED TO COLUMN THREE(ONE MORE TO BE ADDED LATER) AND A      * 00770000
*  /** BRANCH TAKEN FOR FURTHER PROCESSING.                           * 00780000
*                              /**THIS IS A NORMAL CONTINUATION      ** 00790000
*                              /**EXPECT A KEYWORD NEXT              ** 00800000
*  /**                                                                * 00810000
*  /******************************************************************* 00820000
*         IF FDCSW = ON THEN DO    /*IF FD CONTINUE ON DO FOLLOWING*/;  00830000
@9FE     CLC   536(1,@5),ON                                       0059  00840000
         BC    07,@9FD                                            0059  00850000
*               FDCSW = OFF    /**TURN OFF FD CONTINUE SWITCH**/;       00860000
         MVC   536(1,@5),OFF                                      0061  00870000
*               R9 = R9 + 2              /**ADD 2 TO BUF POINTER**/;    00880000
         AH    @9,@D1                                             0062  00890000
*               GO TO F1E2         /*BRANCH TO CONTINUE PROCESSING*/;   00900000
         BC    15,F1E2                                            0063  00910000
*         END;                                                          00920000
*  /******************************************************************/ 00930000
*  /**                                                                * 00940000
*  /** THE FDCTR IS USED TO DETERMINE THE NUMBER OF FD TABLES PRESENT * 00950000
*  /** PER GETMAIN OF 520 BYTES.FDCTR EQUAL TO ZERO OR EIGHT INDICATED* 00960000
*  /** THE NEED FOR A GETMAIN.IF THE COUNTER IS OTHER THAN ZERO OR    * 00970000
*  /** EIGHT A BRANCH IS TAKEN TO SCAN FOR KEYWORDS                   * 00980000
*  /**                                                               ** 00990000
*  /******************************************************************/ 01000000
*  F1C2:        R9 = R9 + 2  /*STEP POINTER TO COLUMN AFTER OPERATION*/ 01010000
@9FD     EQU   *                                                  0065  01020000
F1C2     AH    @9,@D1                                             0065  01030000
*         IF FDCTR = 0 THEN GO TO F1C3  /*IF FDCTR = 0 GO TO GETMAIN*/; 01040000
         SR    @F,@F                                              0066  01050000
         CH    @F,608(0,@5)                                       0066  01060000
         BC    08,F1C3                                            0067  01070000
*        IF FDCTR ^= 8 THEN GO TO F1D2  /*BR IF WE HAVE MORE SPACE*/;   01080000
         LA    @F,8                                               0068  01090000
         CH    @F,608(0,@5)                                       0068  01100000
         BC    07,F1D2                                            0069  01110000
*  /******************************************************************* 01120000
*  /**                                                                * 01130000
*  /** THIS SECTION GETS MAIN FOR 520 BYTES TO BE USED FOR FD TABLES  * 01140000
*  /** A FD TABLE IS 64 BYTES LONG.THIS AREA WILL HOLD EIGHT FD TABLES* 01150000
*  /** THE EIGHT   BYTES LEFT OVER ARE USED FOR LINKAGE TO THE NEXT FD* 01160000
*  /** TABLE.THE LINK ADDRESS IS STORED IN THE LAST FOUR BYTES OF THIS* 01170000
*  /** AREA.AN UNSUCCESSFUL GETMAIN CAUSES CON CODE 12 AND A RETURN   * 01180000
*  /** CORE IS CLEARED TO BINARY ZEROES.WE STEP THROUGH THIS TABLE BY * 01190000
*  /** INCREMENTING THE FD POINTER BY 64.COUNT IS KEPT IN FDCTR       * 01200000
*  /**                                                                * 01210000
*  /******************************************************************* 01220000
*  F1C3:;                                                               01230000
*  /*NEXT SEQUENCE ISSUES A CONDITIONAL GETMAIN                       * 01240000
*               FDCTR = 0      /**REINITILIZE FD COUNTER**/;            01250000
F1C3     SR    @F,@F                                              0071  01260000
         STH   @F,608(0,@5)                                       0071  01270000
*               R6 = ADDR(GCADDR)        /*PICK UP ADDRESS FOR GMAIN*/; 01280000
         LA    @6,376(0,@5)                                       0072  01290000
*               R1 = ADDR(GETMLIST)      /*PICK UP LIST ADDR*/;         01300000
         LA    @1,364(0,@5)                                       0073  01310000
*                              /*ISSUE GET MAIN MACRO*/                 01320000
*  GEN ( GETMAIN EC,LV=520,A=(R6),SP=0,MF=(E,(R1)));                    01330000
          GETMAIN EC,LV=520,A=(R6),SP=0,MF=(E,(R1))                     01340000
         DS    0H                                                       01350000
*         IF R15 = 0 THEN GO TO F1B5  /*BR IF SUCCESSFUL GET MAIN*/;    01360000
         LTR   @F,@F                                              0075  01370000
         BC    08,F1B5                                            0076  01380000
*               MS = 10         /*INDICATE MESSAGE */;                  01390000
         LA    @F,10                                              0077  01400000
         STH   @F,406(0,@5)                                       0077  01410000
*  /******************************************************************/ 01420000
*  /**                                                               ** 01430000
*  /** THIS SECTION CONSISTING OF THREE LABELS WHICH ARE BRANCHED TO  * 01440000
*  /** FOR EXITING FROM THIS ROUTINE WHEN RETURN OF CONTROL IS NOT    * 01450000
*  /** REQUIRED.A BRANCH TO F1B41 CAUSES ALL FD SWITCHES TO BE TURNED** 01460000
*  /** OFF AND A NORMAL RETURN TO THE BASE MODULE.A BRANCH TO F1B411  * 01470000
*  /** CAUSES THE EPSW TO BE SET TO ONE(INDICATES NEED FOR MESSAGE)   * 01480000
*  /** SWITCHES OFF AND RETURN.A BRANCH TO F1B4 CAUSES FLAGSW(1) TO   * 01490000
*  /** BE SET INDICATING A NEED FOR ERROR FLAGGING A MESSAGE.EPSW IS  * 01500000
*  /** THEN SET,SWITCHES TURNED OFF AND A RETURN ISSUED.THUS F1B41    * 01510000
*  /** IS FOR A NORMAL RETURN.F1B411 INDICATES NEED FOR A MESSAGE AND * 01520000
*  /** RETURN.F1B4 INDICATES ERROR FLAGGING,MESSAGE AND RETURN.       * 01530000
*  /**                                                               ** 01540000
*  /******************************************************************/ 01550000
*  F1B4:;                                                               01560000
*               FLAGSW(1) = '1'B         /*INDICATE ERROR FLAG WANTED*/ 01570000
F1B4     OI    566(@5),B'10000000'                                0079  01580000
*  F1B411:;                                                             01590000
*               EPSW = 1        /*INDICATE NEED FOR MESSAGE */;         01600000
F1B411   MVI   568(@5),1                                          0081  01610000
*               FDNAME = 'BADFIELD' /**INDICATE BAD FIELD **/;          01620000
         L     @1,596(0,@5)                                       0082  01630000
         MVC   0(8,@1),@C2                                        0082  01640000
*  F1B41:;                                                              01650000
*               SWITCH(1) = OFF          /**TURN OFF FIRST FD SWITCH**/ 01660000
F1B41    MVC   536(1,@5),OFF                                      0084  01670000
*         SWITCH(2:14) = SWITCH(1:13) /** TURN OFF FD SWITCHES**/;      01680000
         MVC   537(13,@5),536(@5)                                 0085  01690000
*               RETURN;                                                 01700000
         BC    15,@EL01                                           0086  01710000
*  F1B5:;                                                               01720000
*  /**                                                                * 01730000
*  /**    THIS SECTION CLEARS CORE FOR THE 520 BYTE FD TABLE.         * 01740000
*  /** POINTERS ARE INITILIZED AS FOLLOWS                             * 01750000
*  /**    FDPTR1- INIT ONCE FOR FIRST TIME                            * 01760000
*  /**    FDPTR2- INIT TO CURRENT FD TABLE                            * 01770000
*  /**FDPTR - INIT TO CURRENT 64 BYTE ENTRY                           * 01780000
*  /** FOR FIRST TIME LOGIC 64 IS TAKEN AWAY FROM FDPTR AS WE ADD 64  * 01790000
*  /** TO STEP THROUGH THE TABLE                                      * 01800000
*  /**                                                                * 01810000
*  /******************************************************************* 01820000
*               FDPTR = GCADDR /** INIT PTR TO NEW ADDRESS           ** 01830000
F1B5     MVC   596(4,@5),376(@5)                                  0088  01840000
*               FDTBL(1) = '00'X  /*FIRST BYTE OF NEW TABLE TO ZERO*/;  01850000
         L     @1,596(0,@5)                                       0089  01860000
         MVI   0(@1),X'00'                                        0089  01870000
*               FDTBL(2:256) = FDTBL(1:255)     /* CLEAR TABLE*/;       01880000
         MVC   1(255,@1),0(@1)                                    0090  01890000
*               FDTBL(257:512) = FDTBL(255:511) /*CLEAR TABLE*/;        01900000
         MVC   256(256,@1),254(@1)                                0091  01910000
*         FDTBL(513:520) = FDTBL(512:519) /**CLEAR THRU 520 BYTES**/;   01920000
         MVC   512(8,@1),511(@1)                                  0092  01930000
*         IF FDPTR2 ^= 0 THEN GO TO F1B6 /**BR NOT FIRST TIME IN TBL ** 01940000
         SR    @F,@F                                              0093  01950000
         C     @F,604(0,@5)                                       0093  01960000
         BC    07,F1B6                                            0094  01970000
*               FDPTR1 = GCADDR         /**INIT PTR TO FIRST TBL ADDR** 01980000
         MVC   600(4,@5),376(@5)                                  0095  01990000
*               GO TO F1B7            /**BR NO LINKAGE FOR FIRST TIME** 02000000
         BC    15,F1B7                                            0096  02010000
*  F1B6:;                                                               02020000
*         FDPTR2 -> FDTBL(517:520) = GCADDR /**LINK TABLE TO LAST**/;   02030000
F1B6     L     @1,604(0,@5)                                       0098  02040000
         MVC   516(4,@1),376(@5)                                  0098  02050000
*  F1B7:;                                                               02060000
*               FDPTR2 = GCADDR               /**INIT CURRENT PTR**/;   02070000
F1B7     MVC   604(4,@5),376(@5)                                  0100  02080000
*               FDPTR = FDPTR - 64 /**INIT PTR FOR FIRST TIME LOGIC**/; 02090000
         LH    @F,@D2                                             0101  02100000
         A     @F,596(0,@5)                                       0101  02110000
         ST    @F,596(0,@5)                                       0101  02120000
*  /* A BRANCH IS TAKEN TO THIS POINT IF THE FD TABLE ISNT USED UP */   02130000
*  /******************************************************************* 02140000
*  /**                                                                * 02150000
*  /**    THIS IS ENTERED WHEN WE HAVE ROOM FOR ANOTHER 64 BYTE ENTRY * 02160000
*  /** WITHIN THE FD TABLE.ONE IS ADDED TO THE FDCTR AND THE FDPTR IS * 02170000
*  /** INCREMENTED BY 64 TO POINT TO A FRESH SECTION OF THE FD TABLE. * 02180000
*  /** THE SCAN POINTER IS NOW POINTING AT THE COLUMN FOLLOWING THE   * 02190000
*  /** CONTROL CARD NAME(FD).A MESSAGE IS INDICATED IF A BLANK IS NOT * 02200000
*  /** IN THIS POSITION.CONTROL PASSES TO THE NEXT SECTION IF A BLANK * 02210000
*  /** IS PRESENT.                                                    * 02220000
*  /**                                                                * 02230000
*  /******************************************************************* 02240000
*  F1D2:;                                                               02250000
*               FDCTR = FDCTR + 1        /*ADD ONE TO FDCTR*/;          02260000
F1D2     LA    @F,1                                               0103  02270000
         AH    @F,608(0,@5)                                       0103  02280000
         STH   @F,608(0,@5)                                       0103  02290000
*               FDPTR = FDPTR + 64 /**POINT AT FRESH TABLE**/;          02300000
         LA    @F,64                                              0104  02310000
         A     @F,596(0,@5)                                       0104  02320000
         ST    @F,596(0,@5)                                       0104  02330000
*         IF INBUF(1) ^=' ' THEN DO;/* IF NO BLANK AFTER KEY SET MSG*/  02340000
         CLI   0(@9),C' '                                         0105  02350000
         BC    08,@9FC                                            0105  02360000
*               MS = 11                  /*SET MESSAGE*/;               02370000
         LA    @F,11                                              0107  02380000
         STH   @F,406(0,@5)                                       0107  02390000
*               GO TO F1B4           /* BRANCH TO EXIT POINT */;        02400000
         BC    15,F1B4                                            0108  02410000
*         END;                                                          02420000
*  /******************************************************************* 02430000
*  /**                                                                * 02440000
*  /**    THIS SECTION WILL SCAN,LOOKING FOR A NON-BLANK.IF THE       * 02450000
*  /** POINTER IS AT COLUMN 71 AND COLUMN 72 IS NON-BLANK,A COMMENTS  * 02460000
*  /** CONTINUATION IS INDICATED.A BLANK IN COLUMN 71 INDICATES A     * 02470000
*  /** REGULAR CONTINUATION.BLANK CARDS WILL BE SCANNED AND IGNORED   * 02480000
*  /** WE ARE LOOKING FOR THE FIRST KEYWORD.                          * 02490000
*  /**                                                                * 02500000
*  /******************************************************************* 02510000
*  F1E2:        R9 = R9 + 1              /*STEP POINTER BY ONE */;      02520000
@9FC     EQU   *                                                  0110  02530000
F1E2     AH    @9,@D3                                             0110  02540000
*         IF R9 => COUNTER THEN DO       /*IS POINTER PAST COL 71 */;   02550000
         C     @9,232(0,@5)                                       0111  02560000
         BC    04,@9FB                                            0111  02570000
*               FDCSW = ON               /*TURN ON FD CONTINUE SWITCH*/ 02580000
         MVC   536(1,@5),ON                                       0113  02590000
*               RETURN                   /*RETURN TO IEBDG*/;           02600000
         BC    15,@EL01                                           0114  02610000
*         END;                                                          02620000
*         IF INBUF(1) = ' ' THEN GO TO F1E2 /*IF BLANK BRANCH TO F1E2*/ 02630000
@9FB     CLI   0(@9),C' '                                         0116  02640000
         BC    08,F1E2                                            0117  02650000
*               GO TO F2B11              /**BRANCH TO SCAN KEYWORDS**/; 02660000
         BC    15,F2B11                                           0118  02670000
*  /******************************************************************* 02680000
*  /**                                                                * 02690000
*  /**    THIS SECTION CHECKS FOR A COMMA OR BLANK FOLLOWING A KEYWORD* 02700000
*  /** PARAMETER.A BLANK INDICATES THE END OF KEYWORD PROCESSING.     * 02710000
*  /** A NON-BLANK IN COLUMN 72 INDICATES A COMMENTS CONTINUATION.THE * 02720000
*  /** NEXT CARD WILL BE TREATED AS A COMMENT CARD AS THE COMCSW WILL * 02730000
*  /** BE TURNED ON.THE BASE MODULE PROCESSES ALL COMMENT CONT. CARDS * 02740000
*  /** FOR THIS MODULE.IF A BLANK IS FOUND THE FIELD LENGTH IS PICKED * 02750000
*  /** UP IN A REGISTER AND A BRANCH IS TAKEN TO PROCESS THIS ENTRY IN* 02760000
*  /** THE FD TABLE.A COMMA WILL CAUSE A BRANCH INTO THE KEYWORD SCAN.* 02770000
*  /** AN IMPROPER VALUE WILL CAUSE A MSG INDICATION AND BRANCH       * 02780000
*  /**                                                                * 02790000
*  /******************************************************************* 02800000
*  F2A1:;                                                               02810000
*        IF R9 > COUNTER + 1 THEN GO TO F2A11 ; /* PAST COL 72 A38710 * 02820000
F2A1     LA    @F,1                                               0120  02830000
         A     @F,232(0,@5)                                       0120  02840000
         CR    @F,@9                                              0120  02850000
         BC    04,F2A11                                           0121  02860000
*        IF R9 = COUNTER + 1 THEN DO ;     /* AT COL 72        A38710 * 02870000
         LA    @F,1                                               0122  02880000
         A     @F,232(0,@5)                                       0122  02890000
         CR    @F,@9                                              0122  02900000
         BC    07,@9FA                                            0122  02910000
*              IF INBUF(1) = ' ' THEN   /* NO CONTINUATION     A38710 * 02920000
         CLI   0(@9),C' '                                         0124  02930000
*                   GO TO F2A11 ;                           /* A38710 * 02940000
         BC    08,F2A11                                           0125  02950000
*                   GO TO F2B12 ;        /* CONTINUATION       A38710 * 02960000
         BC    15,F2B12                                           0126  02970000
*              END ;                                        /* A38710 * 02980000
*   IF INBUF(1) = ' ' THEN DO;                                          02990000
@9FA     CLI   0(@9),C' '                                         0128  03000000
         BC    07,@9F9                                            0128  03010000
*  /*THE CONTINUATION SW WILL BE SET IF COL 72 IS NOT BLANK */          03020000
*               IF COUNTER -> INBUF(2) ^=' ' THEN DO;                   03030000
         L     @1,232(0,@5)                                       0130  03040000
         CLI   1(@1),C' '                                         0130  03050000
         BC    08,@9F8                                            0130  03060000
*                    COMCSW = ON         /*TURN ON COMMENT SW*/;        03070000
         MVC   565(1,@5),ON                                       0132  03080000
*               END;                                                    03090000
* F2A11: R6 = FDLGTH ;                  /* RESTORE FIELD LENGTHA38710*/ 03100000
@9F8     EQU   *                                                  0134  03110000
F2A11    L     @1,596(0,@5)                                       0134  03120000
         LH    @6,24(0,@1)                                        0134  03130000
*               GO TO F5D2          /*BRANCH TO PROCESS WKAREA*/;       03140000
         BC    15,F5D2                                            0135  03150000
*  /*COLUMN AFTER PARA MUST ALWAYS BE A COMMA */                        03160000
*         END;                                                          03170000
*   IF INBUF(1) = ',' THEN GO TO F2B1 ;                                 03180000
@9F9     CLI   0(@9),C','                                         0137  03190000
         BC    08,F2B1                                            0138  03200000
*        IF R9 = COUNTER THEN GO TO F1E2 ; /* AT COL 71        A38710 * 03210000
         C     @9,232(0,@5)                                       0139  03220000
         BC    08,F1E2                                            0140  03230000
*  /******************************************************************* 03240000
*  /**                                                                * 03250000
*  /**    THIS SECTION IS THE KEYWORD SCAN.                           * 03260000
*  /** IF A BLANK FOLLOWS THE COMMA AFTER LAST PARAMETER SCANNED,THIS * 03270000
*  /** INDICATES A CONTINUATION OF THE FD CARD.THE FDCSW WILL BE      * 03280000
*  /** TURNED ON AND A BRANCH TAKEN TO RETURN TO THE BASE MODULE. IF  * 03290000
*  /** NOT A BLANK A BRANCH IS TAKEN TO SCAN FOR KEYWORDS.ILLEGIMATE. * 03300000
*  /** KEYWORDS WILL CAUSE A MSG INDICATION AND A BRANCH TO EXIT.     * 03310000
*  /** THERE IS NO CHECK FOR DUPLICATE KEYWORDS.A DUPLICATE WILL CAUSE* 03320000
*  /** THE LAST FOUND TO BE OVERLAID.THIS SCAN ALWAYS CONSIDERS THE   * 03330000
*  /** EQUAL SIGN FOLLOWING THE KEYWORD TO BE PART OF THE KEYWORD.WHEN* 03340000
*  /** A LEGITIMATE KEYWORD IS FOUND A BRANCH WILL BE TAKEN TO PROCESS* 03350000
*  /** IT.INDEX BY NAME IS NOT ALLOWED FOR FIRST RELEASE,ALTHOUGH CODE* 03360000
*  /** WILL BE FOUND WHICH PLACES THE NAME IN THE TABLE.THE SAME IS   * 03370000
*  /** TRUE FOR 'REPLACE'.THEREFORE A NAME IN PLACE OF A NUMBER FOR   * 03380000
*  /** THE KEYWORD INDEX= WILL CAUSE THE NAME TO BE PLACED IN THE FD  * 03390000
*  /** TABLE.THIS MAY CAUSE INCONSISTENT RESULTS WHEN INDEXING AS THE * 03400000
*  /** CREATE MODULE IS CODED FOR PROCESSING INDEX BY NUMBER ONLY     * 03410000
*  /**                                                                * 03420000
*  /******************************************************************* 03430000
*  F2A2:;                                                               03440000
*               MS = 11        /** INDICATE MESSABE NUMBER 11**/;       03450000
F2A2     LA    @F,11                                              0142  03460000
         STH   @F,406(0,@5)                                       0142  03470000
*               GO TO F1B4               /*BRANCH TO EXIT POINT*/;      03480000
         BC    15,F1B4                                            0143  03490000
*  F2B1:;                                                               03500000
*         IF INBUF(2) = ' ' THEN GO TO F2B12 /**BR CONTINUATION**/;     03510000
F2B1     CLI   1(@9),C' '                                         0145  03520000
         BC    08,F2B12                                           0146  03530000
*               R9 = R9 + 1              /**STEP POINTER PAST COMMA**/; 03540000
         AH    @9,@D3                                             0147  03550000
*  F2B11:;                                                              03560000
*        IF R9 = COUNTER + 1 THEN DO ; /* COMMA IN COL 72      A38710 * 03570000
F2B11    LA    @F,1                                               0149  03580000
         A     @F,232(0,@5)                                       0149  03590000
         CR    @F,@9                                              0149  03600000
         BC    07,@9F7                                            0149  03610000
*  F2B12:;                                                              03620000
*               FDCSW = ON     /**TURN ON FD CONTINUATION SWITCH**/;    03630000
F2B12    MVC   536(1,@5),ON                                       0152  03640000
*         RETURN               /** RETURN TO BASE MODULE**/;            03650000
         BC    15,@EL01                                           0153  03660000
*         END;                                                          03670000
*                                       /**IF NAME= BRANCH TO F2B2**/   03680000
*         IF INBUF(1:5) = 'NAME=' THEN GO TO F2B2;                      03690000
@9F7     CLC   0(5,@9),@C6                                        0155  03700000
         BC    08,F2B2                                            0156  03710000
*         IF INBUF(1:6) = 'INPUT=' THEN GO TO F3H1 /**BR ITS INPUT **/; 03720000
         CLC   0(6,@9),@C7                                        0157  03730000
         BC    08,F3H1                                            0158  03740000
*         IF INBUF(1:8) = 'FROMLOC=' THEN GO TO F3J1 /**BR TO F3J1 FOR  03750000
         CLC   0(8,@9),@C8                                        0159  03760000
*                                                       FROMLOC **/;    03770000
         BC    08,F3J1                                            0160  03780000
*                                        /*IF LENGTH= GO TO F2C2 */     03790000
*         IF INBUF(1:7) = 'LENGTH=' THEN GO TO F2C2 /*BR IF LENGTH*/;   03800000
         CLC   0(7,@9),@C9                                        0161  03810000
         BC    08,F2C2                                            0162  03820000
*                                        /*IF STARTLOC= GO TO F2D2*/    03830000
*         IF INBUF(1:9) = 'STARTLOC=' THEN GO TO F2D2;                  03840000
         CLC   0(9,@9),@C10                                       0163  03850000
         BC    08,F2D2                                            0164  03860000
*                                        /*IF PICTURE= GO TO F2E2*/     03870000
*         IF INBUF(1:8) = 'PICTURE=' THEN GO TO F2E2;                   03880000
         CLC   0(8,@9),@C11                                       0165  03890000
         BC    08,F2E2                                            0166  03900000
*                                        /*IF FORMAT= GO TO F2F2*/      03910000
*         IF INBUF(1:7) = 'FORMAT=' THEN GO TO F2F2;                    03920000
         CLC   0(7,@9),@C12                                       0167  03930000
         BC    08,F2F2                                            0168  03940000
*                                        /*IF ACTION= GO TO F2G2*/      03950000
*         IF INBUF(1:7) = 'ACTION=' THEN GO TO F2G2;                    03960000
         CLC   0(7,@9),@C13                                       0169  03970000
         BC    08,F2G2                                            0170  03980000
*                                        /*IF FILL= GO TO F2H2 */       03990000
*         IF INBUF(1:5) = 'FILL=' THEN GO TO F2H2;                      04000000
         CLC   0(5,@9),@C14                                       0171  04010000
         BC    08,F2H2                                            0172  04020000
*                                        /*IF CYCLE= GO TO F2J2*/       04030000
*         IF INBUF(1:6) = 'CYCLE=' THEN GO TO F2J2;                     04040000
         CLC   0(6,@9),@C15                                       0173  04050000
         BC    08,F2J2                                            0174  04060000
*         IF INBUF(1:6) = 'RANGE=' THEN GO TO F3A1 /*BR IF RANGE*/;     04070000
         CLC   0(6,@9),@C16                                       0175  04080000
         BC    08,F3A1                                            0176  04090000
*                                        /*IF CHARACTER= GO TO F3C2*/   04100000
*         IF INBUF(1:10) = 'CHARACTER=' THEN GO TO F3C2;                04110000
         CLC   0(10,@9),@C17                                      0177  04120000
         BC    08,F3C2                                            0178  04130000
*                                        /*IF SIGN= GO TO F3D2*/        04140000
*         IF INBUF(1:5) = 'SIGN=' THEN GO TO F3D2;                      04150000
         CLC   0(5,@9),@C18                                       0179  04160000
         BC    08,F3D2                                            0180  04170000
*                                        /*IF INDEX= GO TO F3E2*/       04180000
*         IF INBUF(1:6) = 'INDEX=' THEN GO TO F3E2;                     04190000
         CLC   0(6,@9),@C19                                       0181  04200000
         BC    08,F3E2                                            0182  04210000
*                                        /*IF REPLACE= GO TO F3G2*/     04220000
*         IF INBUF(1:8) = 'REPLACE=' THEN GO TO F3G2;                   04230000
         CLC   0(8,@9),@C20                                       0183  04240000
         BC    08,F3G2                                            0184  04250000
*  /*AT THIS POINT A LEGITIMATE KEYWORD WAS NOT FOUND.ISSUE MSG */      04260000
*               MS = 5                   /* INDICATE MSG */;            04270000
         LA    @F,5                                               0185  04280000
         STH   @F,406(0,@5)                                       0185  04290000
*               GO TO F1B4               /*BRANCH TO EXIT POINT */;     04300000
         BC    15,F1B4                                            0186  04310000
*  /******************************************************************/ 04320000
*  /* NAME IS PROCESSED HERE ****************************************/  04330000
*  /** THE SCAN POINTER IS INCREMENTED TO POINT AT THE NAME FOLLOWING * 04340000
*  /** THE EQUAL SIGN AND THE NAME IS SCANNED OUT.IF THE FIRST        * 04350000
*  /** CHARACTER IS VALID ALPHABETIC AND THE LENGTH IS PROPER THE NAME* 04360000
*  /** IS PLACED IN THE FD TABLE,OTHERWISE A MSG IS INDICATED AND A   * 04370000
*  /**BRANCH TAKEN TO EXIT.THE POINTER IS THEN STEPPED PAST THE       * 04380000
*  /** PARAMETER AND A BRANCH TAKEN TO TEST FOR LAST PARAMETER ON CARD* 04390000
*  F2B2:;                                                               04400000
*         R9 = R9 + 5                    /*POINT AT NAME PARAMETER*/;   04410000
F2B2     AH    @9,@D4                                             0188  04420000
*               CALL SCANOUT;            /*SCANS OUT PARAMETER*/        04430000
         BAL   @E,SCANOUT                                         0189  04440000
*  /** THE EQUAL SIGN AND THE NAME IS SCANNED OUT.THE SCANOUT ROUTINE * 04450000
*  /** TESTS FOR THE NAME BEING LONGER THAN 8 CHARS.THE FD TABLES ARE * 04460000
*  /** THEN SCANNED TO SEE IF THE NAME IS A DUPLICATE.THE SCAN IS     * 04470000
*  /** ENDED WHEN THE LAST NAME FIELD AND LINK FIELD CONTAIN ZERO     * 04480000
*         HOLDNAME = INBUF(1:R7);                                       04490000
         LR    @1,@7                                              0190  04500000
         BCTR  @1,0                                               0190  04510000
         LR    @E,@9                                              0190  04520000
         LA    @A,790(0,@5)                                       0190  04530000
         MVI   0(@A),C' '                                         0190  04540000
         MVC   1(007,@A),0(@A)                                    0190  04550000
         EX    @1,@MVC                                            0190  04560000
*               R4 = FDPTR1    /**PICK UP FIRST TABLE ADDRESS**/;       04570000
         L     @4,600(0,@5)                                       0191  04580000
*  F2B21:;                                                              04590000
*  /**LMOVED IS USED AS COUNTER,IT IS INIT TO ZERO WHEN USED ELSEWHERE* 04600000
*               LMOVED = 0    /**INIT COUNTER FOR SCAN**/;              04610000
F2B21    SR    @F,@F                                              0193  04620000
         STH   @F,620(0,@5)                                       0193  04630000
*               R6 = R4        /**  COPY ADDRESS**/;                    04640000
         LR    @6,@4                                              0194  04650000
*  F2B22:;                                                              04660000
*               LMOVED = LMOVED + 1 /** ADD ONE TO COUNTER**/;          04670000
F2B22    LA    @F,1                                               0196  04680000
         AH    @F,620(0,@5)                                       0196  04690000
         STH   @F,620(0,@5)                                       0196  04700000
*         IF R6 -> FDTBL(1) ^= '00'X THEN DO /**DO BELOW IF NO NAME**/; 04710000
         CLI   0(@6),X'00'                                        0197  04720000
         BC    08,@9F6                                            0197  04730000
*         IF R6-> FDTBL(1:8) = HOLDNAME  THEN                           04740000
         CLC   0(8,@6),790(@5)                                    0199  04750000
         BC    07,@9F5                                            0199  04760000
*         DO;                                                           04770000
*        /**   FOUND DUPLICATE NAME   **/                               04780000
*               MS = 3         /** SET MESSAGE INDICATION **/;          04790000
         LA    @F,3                                               0201  04800000
         STH   @F,406(0,@5)                                       0201  04810000
*               GO TO F1B4     /**BR TO EXIT THIS ROUTINE**/;           04820000
         BC    15,F1B4                                            0202  04830000
*         END;                                                          04840000
*               R6 = R6 + 64   /**POINT AT NEXT FD ENTRY**/;            04850000
@9F5     AH    @6,@D5                                             0204  04860000
*         IF LMOVED ^= 8 THEN DO /**BR IF AT END OF TABLE**/;           04870000
         LA    @F,8                                               0205  04880000
         CH    @F,620(0,@5)                                       0205  04890000
*               GO TO F2B22    /** BRANCH TO COMPARE**/;                04900000
         BC    07,F2B22                                           0207  04910000
*         END;                                                          04920000
*         R4 = R4 -> FDTBL(517:520) /** PICK UP NEXT TABLE ADDRESS**/;  04930000
@9F4     L     @4,516(0,@4)                                       0209  04940000
*               GO TO F2B21    /**BR TO START LOOKING AGAIN**/;         04950000
         BC    15,F2B21                                           0210  04960000
*         END;                                                          04970000
*  F2B23:;                                                              04980000
@9F6     EQU   *                                                  0212  04990000
*         FDNAME = INBUF(1:R7)           /*PLACE NAME IN FDTABLE*/;     05000000
F2B23    LR    @1,@7                                              0213  05010000
         BCTR  @1,0                                               0213  05020000
         LR    @E,@9                                              0213  05030000
         L     @2,596(0,@5)                                       0213  05040000
         LR    @A,@2                                              0213  05050000
         MVI   0(@A),C' '                                         0213  05060000
         MVC   1(007,@A),0(@A)                                    0213  05070000
         EX    @1,@MVC                                            0213  05080000
*  STEPPTR:     R9 = R8             /*STEP POINTER PAST PARAMETER*/;    05090000
STEPPTR  LR    @9,@8                                              0214  05100000
*               GO TO F2A1               /*BR TO TEST FOR LAST PARA */; 05110000
         BC    15,F2A1                                            0215  05120000
*  /******************************************************************/ 05130000
*  /* LENGTH IS PROCESSED HERE **************************************/  05140000
*  /******************************************************************/ 05150000
*  /**                                                                * 05160000
*  /**    THE SCAN POINTER IS STEPPED TO POINT AT THE LENGTH,AND THE  * 05170000
*  /** NUMBER IS SCANNED OUT,VALIDITY CHECKED,CONVERTED TO BINARY AND * 05180000
*  /** PLACED IN FDLGTH OF THE TABLE.A BRANCH IS THEN TAKEN TO STEP   * 05190000
*  /** POINTER PAST PARAMETER AND TEST FOR LAST PARAMETER             * 05200000
*  /**                                                                * 05210000
*  /******************************************************************* 05220000
*  F2C2:;                                                               05230000
*         R9 = R9 + 7                    /*POINT TO PARAMETER */;       05240000
F2C2     AH    @9,@D6                                             0217  05250000
*               CALL SCANOUT;            /*SCANS OUT PARAMETER*/        05260000
         BAL   @E,SCANOUT                                         0218  05270000
*               CALL VALCHECK            /**VALIDITY CHECK THE NUMBER** 05280000
         BAL   @E,VALCHECK                                        0219  05290000
*               CALL CONVB;              /*CONVERTS NUMBER TO BINARY*/  05300000
         BAL   @E,CONVB                                           0220  05310000
*         FDLGTH = R6                    /*BINARY LGTH TO TABLE*/;      05320000
         L     @1,596(0,@5)                                       0221  05330000
         STH   @6,24(0,@1)                                        0221  05340000
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;    05350000
         BC    15,STEPPTR                                         0222  05360000
*  /******************************************************************/ 05370000
*  /* STARTLOC IS PROCESSED HERE ************************************/  05380000
*  /**                                                                * 05390000
*  /**    THE SCAN POINTER IS STEPPED TO POINT AT PARAMETER.THE NUMBER* 05400000
*  /** IS SCANNED OUT,VALIDITY CHECKED,CONVERTED TO BINARY,ITS VALUE  * 05410000
*  /** MINUS ONE IS THEN PLACED AT FDOBUF IN THE TABLE.A VALE MINUS   * 05420000
*  /** ONE IS REQUIRED BY THE CREATE MODULE.A BRANCH IS THEN TAKEN TO * 05430000
*  /** STEP THE POINTER AND TEST FOR LAST PARAMETER.                  * 05440000
*  /** A LENGTH OF ZERO IS NOT ALLOWED.MESSAGE 3 ISSUED BY CONVB RT.  * 05450000
*  /**                                                                * 05460000
*  /******************************************************************/ 05470000
*  F2D2:;                                                               05480000
*         R9 = R9 + 9                    /*POINT TO PARAMETER*/;        05490000
F2D2     AH    @9,@D7                                             0224  05500000
*               CALL SCANOUT;            /*SCANS OUT PARAMETER */       05510000
         BAL   @E,SCANOUT                                         0225  05520000
*               CALL VALCHECK            /**VALIDITY CHECK THE NUMBER** 05530000
         BAL   @E,VALCHECK                                        0226  05540000
*               CALL CONVB;              /*CONVERTS NUMBER TO BINARY*/  05550000
         BAL   @E,CONVB                                           0227  05560000
*               STRTLOC1 = '1'B /** TURN ON STARTLOC SWITCH **/;        05570000
         L     @1,596(0,@5)                                       0228  05580000
         OI    62(@1),B'10000000'                                 0228  05590000
*                              /**STARTLOC MINUS ONE REQD BY CREATE**/  05600000
*               FDOBUF = R6 - 1 /**STARTLOC MINUS ONE TO TABLE**/;      05610000
         LR    @F,@6                                              0229  05620000
         BCTR  @F,0                                               0229  05630000
         STH   @F,40(0,@1)                                        0229  05640000
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER */;   05650000
         BC    15,STEPPTR                                         0230  05660000
*  /******************************************************************/ 05670000
*  /* PICTURE IS PROCESSED HERE AND AT F4A1 *************************** 05680000
*  /******************************************************************/ 05690000
*  /**    THIS SECTION PROCESSES THE LENGTH SUB-PARAMETER OF PICTURE. * 05700000
*  /** PICTURE CANNOT BE PRESENT IF A FORMAT IS PRESENT.A FORMAT WILL * 05710000
*  /** HAVE SET THE FDFMTSW.IF THIS IS ON A MSG IS INDICATED AND A    * 05720000
*  /** BRANCH TAKEN TO EXIT ROUTINE.IF NO FORMAT IS PRESENT THE FDPLSW* 05730000
*  /** IS TURNED ON SO THAT FORMAT WILL BE EXCLUDED AND THE LENGTH    * 05740000
*  /** SCANNED OUT,VALIDITY CHECKED,CONVERTED TO BINARY AND THE VALUE * 05750000
*  /** PLACED AT FDPLGTH FOR FURTHER PROCESSING.A BRANCH IS THEN TAKEN* 05760000
*  /** TO SCAN OUT THE ACTUAL PICTURE.LENGTH MUST BE PRESENT FOR      * 05770000
*  /** PROPER SCAN OF PICTURE.AS WE MUST BE REENTRANT,THE LENGTH IS   * 05780000
*  /** REQUIRED BEFORE THE PICTURE AS IT MAY EXTEND OVER MANY CARDS.  * 05790000
*  /** WE SCAN THE PICTURE OUT DEPENDING UPON A LENGTH.THEREFORE EVERY* 05800000
*  /** CHARACTER BETWEEN THE DELIMITING QUOTES IS CONSIDERED PART OF  * 05810000
*  /** THE PICTURE.                                                   * 05820000
*  /**                                                                * 05830000
*  /******************************************************************* 05840000
*  F2E2:;                                                               05850000
*         R9 = R9 + 8                    /*POINT TO LENGTH SUBPARA */;  05860000
F2E2     AH    @9,@D8                                             0232  05870000
*                         /* PICTURE AND FORMAT ARE EXCLUSIVE IF BOTH*/ 05880000
*                         /* ARE PRESENT,INDICATED BY FDFMTSW AND */    05890000
*                         /* FDPLSW WE STOP WITH MESSAGE*/              05900000
*         IF FDFMTSW = ON THEN DO    /*IF FORMAT PRESENT DO FOLLOWING*/ 05910000
         CLC   539(1,@5),ON                                       0233  05920000
         BC    07,@9F3                                            0233  05930000
*  F2F4:;                                                               05940000
*               MS = 13              /*INDICATE MESSAGE */;             05950000
F2F4     LA    @F,13                                              0236  05960000
         STH   @F,406(0,@5)                                       0236  05970000
*               GO TO F1B4           /*BRANCH TO EXIT */;               05980000
         BC    15,F1B4                                            0237  05990000
*         END;                                                          06000000
*         FDPLSW = ON                    /*TURN ON PICT LGHT SWITCH */; 06010000
@9F3     MVC   540(1,@5),ON                                       0239  06020000
*               CALL SCANOUT;            /*SCAN OUT LENGTH OF PARA*/;   06030000
         BAL   @E,SCANOUT                                         0240  06040000
*               CALL VALCHECK            /**VALIDITY CHECK THE NUMBER** 06050000
         BAL   @E,VALCHECK                                        0242  06060000
*               CALL CONVB;              /*CONVERT LGTH */              06070000
         BAL   @E,CONVB                                           0243  06080000
*         FDPLGTH = R6                   /*SAVE LGTH FOR PICT SCAN */;  06090000
         STH   @6,588(0,@5)                                       0244  06100000
*               GO TO F4A1               /*BRANCH TO FINISH PICTURE*/;  06110000
         BC    15,F4A1                                            0245  06120000
*  /******************************************************************/ 06130000
*  /* FORMAT IS PROCESSED HERE *************************************/   06140000
*  /******************************************************************* 06150000
*  /**    THE SCAN POINTER IS STEPPED TO POINT AT THE PARAMETER AND   * 06160000
*  /** THE FDPLSW IS CHECKED TO SEE IF THIS PARAMETER IS EXCLUDED.IF  * 06170000
*  /** EXCLUDED A BRANCH IS TAKEN TO INDICATE A MSG AND EXIT.IF NOT   * 06180000
*  /** EXCLUDED THE FORMAT IS SCANNED OUT,CHECKED FOR TWO CHARACTERS  * 06190000
*  /** (MSG INDICATED IF NOT TWO) AND PLACED AT FDFORMAT IN FD TABLE. * 06200000
*  /** A BRANCH IS THE TAKEN TO STEP THE POINTER AND TEST FOR LAST    * 06210000
*  /** PARAMETER.                                                     * 06220000
*  /**                                                                * 06230000
*  /******************************************************************* 06240000
*  F2F2:;                                                               06250000
*         R9 = R9 + 7                    /*POINT TO PARAMETER*/;        06260000
F2F2     AH    @9,@D6                                             0247  06270000
*         IF FDPLSW = ON THEN GO TO F2F4 /*BRANCH IF EXCLUDED*/;        06280000
         CLC   540(1,@5),ON                                       0248  06290000
         BC    08,F2F4                                            0249  06300000
*               FDFMTSW = ON             /*TURN ON FORMAT SWITCH*/;     06310000
         MVC   539(1,@5),ON                                       0250  06320000
*               CALL SCANOUT             /*SCAN OUT PARAMETER*/;        06330000
         BAL   @E,SCANOUT                                         0251  06340000
*  /**IF RETURN IS TO THIS POINT PARA IS PRESENT.A VALUE OF 2 IN REG**/ 06350000
*  /** SEVEN INDICATES A CORRECT LENGTH**/                              06360000
*         IF R7 = 2 THEN GO TO F6F22 /**BRANCH IF CORRECT LENGTH**/;    06370000
         CH    @7,@D1                                             0252  06380000
         BC    08,F6F22                                           0253  06390000
*  F2F21:;                                                              06400000
*               MS =  3                  /**INDICATE MESSAGE**/;        06410000
F2F21    LA    @F,3                                               0255  06420000
         STH   @F,406(0,@5)                                       0255  06430000
*               GO TO F1B4           /* BRANCH TO EXIT POINT*/;         06440000
         BC    15,F1B4                                            0256  06450000
*  F6F22:;                                                              06460000
*         IF INBUF(1:2) = 'AN'         /* FORMAT VALUE VALID   OY01164* 06470000
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164* 06480000
F6F22    CLC   0(2,@9),@C21                                       0258  06490000
         BC    08,F6F24                                           0259  06500000
*         IF INBUF(1:2) = 'AL'         /* FORMAT VALUE VALID   OY01164* 06510000
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164* 06520000
         CLC   0(2,@9),@C22                                       0260  06530000
         BC    08,F6F24                                           0261  06540000
*         IF INBUF(1:2) = 'ZD'         /* FORMAT VALUE VALID   OY01164* 06550000
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164* 06560000
         CLC   0(2,@9),@C23                                       0262  06570000
         BC    08,F6F24                                           0263  06580000
*         IF INBUF(1:2) = 'PD'         /* FORMAT VALUE VALID   OY01164* 06590000
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164* 06600000
         CLC   0(2,@9),@C24                                       0264  06610000
         BC    08,F6F24                                           0265  06620000
*         IF INBUF(1:2) = 'CO'         /* FORMAT VALUE VALID   OY01164* 06630000
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164* 06640000
         CLC   0(2,@9),@C25                                       0266  06650000
         BC    08,F6F24                                           0267  06660000
*         IF INBUF(1:2) = 'BI'         /* FORMAT VALUE VALID   OY01164* 06670000
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164* 06680000
         CLC   0(2,@9),@C26                                       0268  06690000
         BC    08,F6F24                                           0269  06700000
*         IF INBUF(1:2) = 'RA'         /* FORMAT VALUE VALID   OY01164* 06710000
*              THEN GO TO F6F24;        /* YES,PUT IN TABLE    OY01164* 06720000
         CLC   0(2,@9),@C16                                       0270  06730000
         BC    08,F6F24                                           0271  06740000
*              ELSE MS = 3;             /* INVALID VALUE GIVE MOY01164* 06750000
         LA    @F,3                                               0272  06760000
         STH   @F,406(0,@5)                                       0272  06770000
*              GO TO F1B4;              /* PRINT ERROR MESSAGE OY01164* 06780000
         BC    15,F1B4                                            0273  06790000
* F6F24:;                               /* PUT VALUES IN TABLE OY01164* 06800000
*         FDFORMAT = INBUF(1:2)          /*PLACE FORMAT IN TABLE*/;     06810000
F6F24    L     @1,596(0,@5)                                       0275  06820000
         MVC   30(2,@1),0(@9)                                     0275  06830000
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;    06840000
         BC    15,STEPPTR                                         0276  06850000
*  /******************************************************************/ 06860000
*  /* ACTION IS PROCESSED HERE **************************************/  06870000
*  /******************************************************************/ 06880000
*  /**    THE SCAN POINTER IS STEPPED TO POINT TO THE PARAMETER AND   * 06890000
*  /** THE PARAMETER SCANNED OUT.IF THE PARAMETER LENGTH IS NOT TWO A * 06900000
*  /** BRANCH IS TAKEN TO INDICATE MSG.IF LENGTH IS CORRECT THE       * 06910000
*  /** PARAMETER IS PLACED AT FDACTION IN THE FD TABLE AND A BRANCH   * 06920000
*  /** TAKEN TO STEP THE POINTER PAST THE PARAMETER.                  * 06930000
*  /**                                                                * 06940000
*  /******************************************************************* 06950000
*  F2G2:;                                                               06960000
*               R9 = R9 + 7              /*POINT AT PARAMETER*/;        06970000
F2G2     AH    @9,@D6                                             0278  06980000
*               CALL SCANOUT             /*SCAN OUT PARAMETER */;       06990000
         BAL   @E,SCANOUT                                         0279  07000000
*  /**IF RETURN IS TO THIS POINT PARA IS PRESENT.A VALUE OF 2 IN REG**/ 07010000
*  /**SEVEN INDICATES A CORRECT LENGTH**/                               07020000
*         IF R7 ^= 2 THEN GO TO F2F21 /**IF INCORRECT BR TO SEND MSG**/ 07030000
         CH    @7,@D1                                             0280  07040000
         BC    07,F2F21                                           0281  07050000
*               FDACTION = INBUF(1:2)    /*PLACE ACTION IN TABLE */;    07060000
         L     @1,596(0,@5)                                       0282  07070000
         MVC   28(2,@1),0(@9)                                     0282  07080000
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;    07090000
         BC    15,STEPPTR                                         0283  07100000
*  /******************************************************************/ 07110000
*  /* FILL IS PROCESSED HERE ****************************************/  07120000
*  /**                                                                * 07130000
*  /**    THE SCAN POINTER IS STEPPED TO POINT TO THE PARAMETER.      * 07140000
*  /** THE PARAMETER MAY BE PRESENT IN TWO FORMS.                     * 07150000
*  /**    1.---- EBCDIC CHARACTER--DELIMITED BY QUOTES FRONT AND REAR * 07160000
*  /**    2.---- TWO HEXADECIMAL DIGITS --DELIMITED BY X' AT FRONT    * 07170000
*  /**                                  --DELIMITED BY  ' AT REAR     * 07180000
*  /** IF THE ABOVE CONDITIONS ARE NOT MET A MSG IS INDICATED AND A   * 07190000
*  /** BRANCH TAKEN TO EXIT.IF THE CHARACTER IS EBCDIC IT IS PLACED   * 07200000
*  /** DIRECTLY INTO THE TABLE AT FDFILL.IF THE CHARACTER IS HEX      * 07210000
*  /** IT IS FIRST CONVERTED AND THEN PLACED IN THE TABLE.            * 07220000
*  /**    E.G.--- X'C1' INTERNALLY IS A3F1                            * 07230000
*  /**          THIS IS CONVERTED TO A C1 AND PLACED IN TABLE.        * 07240000
*  /**                                                                * 07250000
*  F2H2:;                                                               07260000
*         R9 = R9 + 5                    /* POINT AT P&RAMETER */;      07270000
F2H2     AH    @9,@D4                                             0285  07280000
*         IF INBUF(1) = 'X' THEN DO      /*ARE HEX DIGITS PRESENT */;   07290000
         CLI   0(@9),C'X'                                         0286  07300000
         BC    07,@9F2                                            0286  07310000
*         IF INBUF(2) ^= '''' THEN GO TO F2H22 /**ERROR IF NO QUOTE**/; 07320000
         CLI   1(@9),C''''                                        0288  07330000
         BC    07,F2H22                                           0289  07340000
*        IF ADDR(INBUF(5)) > COUNTER THEN  /* PAST COL 72      A38710 * 07350000
         L     @F,232(0,@5)                                       0290  07360000
         LA    @0,4(0,@9)                                         0290  07370000
         SR    @F,@0                                              0290  07380000
         BC    10,@9F1                                            0290  07390000
*         DO;                                                           07400000
* F2H21:                                                                07410000
*         MS = 21;                                                      07420000
F2H21    LA    @F,21                                              0292  07430000
         STH   @F,406(0,@5)                                       0292  07440000
*         GOTO F1B4;                                                    07450000
         BC    15,F1B4                                            0293  07460000
*   END;                                                                07470000
*        IF INBUF(5) = '''' THEN GO TO F2H3    /**BR IF QUOTE **/;      07480000
@9F1     CLI   4(@9),C''''                                        0295  07490000
         BC    08,F2H3                                            0296  07500000
*  F2H22:;                                                              07510000
*  /* AT THIS POINT QUOTES WERE NO IN PROPER POSITION */                07520000
*               MS = 3                   /*INDICATE MESSAGE */;         07530000
F2H22    LA    @F,3                                               0298  07540000
         STH   @F,406(0,@5)                                       0298  07550000
*               GO TO F1B4               /*BRANCH TO EXIT */;           07560000
         BC    15,F1B4                                            0299  07570000
*         END;                                                          07580000
*  /*AT THIS POINT FILL CHARACTER IS EBCDIC NOT HEX IT MAY BE MOVED */  07590000
*  /*DIRECTLY INTO TABLE IF IT MEETS REQUIREMENTS FOR QUOTES  */        07600000
*        IF INBUF(1) ^= '''' THEN GO TO F2H22 /**BR IF NOT QUOTE**/;    07610000
@9F2     CLI   0(@9),C''''                                        0301  07620000
         BC    07,F2H22                                           0302  07630000
*        IF INBUF(3) ^= '''' THEN GO TO F2H22 /**BR IF NOT QUOTE**/;    07640000
         CLI   2(@9),C''''                                        0303  07650000
         BC    07,F2H22                                           0304  07660000
*        IF ADDR(INBUF(3)) > COUNTER THEN  /* PAST COL 72      A38710 * 07670000
         L     @F,232(0,@5)                                       0305  07680000
         LA    @0,2(0,@9)                                         0305  07690000
         SR    @F,@0                                              0305  07700000
*         GOTO F2H21;                                                   07710000
         BC    04,F2H21                                           0306  07720000
*               FDFILL = INBUF(2) /**FILL CHARACTER TO TABLE**/;        07730000
         L     @1,596(0,@5)                                       0307  07740000
         MVC   33(1,@1),1(@9)                                     0307  07750000
*               R9 = R9 + 3              /*POSITION POINTER */;         07760000
         AH    @9,@D9                                             0308  07770000
*               GO TO F2A1               /*BR TO CONTINUE PROCESSING */ 07780000
         BC    15,F2A1                                            0309  07790000
*  /* AT THIS POINT HEX FILL IS PRESENT MUST CONVERT IT */              07800000
*  /* INTERNALLY THE VALID CHARS ALLOWED ARE:           */              07810000
*  /*                     F0 THRU F9                    */              07820000
*  /*                     C1 THRU C6                    */              07830000
*  /*                                                   */              07840000
*  F2H3:;                                                               07850000
*               FILLSW = OFF             /*CLEAR FILL SWITCH*/;         07860000
F2H3     MVC   542(1,@5),OFF                                      0311  07870000
*  F2H4:;                                                               07880000
*               /* R9 POINTS AT THE X PRECEDING 'CHARS' */              07890000
*               R6 = 0                   /*CLEAR WORK REGISTER*/;       07900000
F2H4     SR    @6,@6                                              0313  07910000
*         IF INBUF(3) => 'F0'X THEN DO   /*IF REQMT NOT MET GO TO F2H7* 07920000
         CLI   2(@9),X'F0'                                        0314  07930000
         BC    04,@9F0                                            0314  07940000
*         IF INBUF(3) =< 'F9'X THEN DO   /*IF REQMT NOT MET GO TO F2H6* 07950000
         CLI   2(@9),X'F9'                                        0316  07960000
         BC    02,@9EF                                            0316  07970000
*               R6 = R6 | INBUF(3)       /* OR DIGIT TO REGISTER */;    07980000
         SR    @F,@F                                              0318  07990000
         IC    @F,2(0,@9)                                         0318  08000000
         OR    @6,@F                                              0318  08010000
*               R6 = R6 & '0F'X          /* AND OUT TOP 4 DIGITS */;    08020000
         LA    @F,X'0F'                                           0319  08030000
         NR    @6,@F                                              0319  08040000
*  F2H5:;                                                               08050000
*         IF FILLSW = ON THEN GO TO F2H8 /*BR TO PROCESS LAST DIGIT */; 08060000
F2H5     CLC   542(1,@5),ON                                       0321  08070000
         BC    08,F2H8                                            0322  08080000
*               R6 = R6 * 16             /* SHIFT DIGIT TO PROPER POS*/ 08090000
         SLA   @6,4                                               0323  08100000
*               FILLSW = ON              /* TURN ON FILL SWITCH */;     08110000
         MVC   542(1,@5),ON                                       0324  08120000
*               Q(1:4) = R6    /**STORE VALUE IN TEMPORARY AREA**/;     08130000
         ST    @6,@TEMP4                                          0325  08140000
         MVC   216(4,@5),@TEMP4                                   0325  08150000
*               FDFILL = Q(4)  /**PLACE FILL CHARACTER IN FD TABLE**/;  08160000
         L     @1,596(0,@5)                                       0326  08170000
         MVC   33(1,@1),219(@5)                                   0326  08180000
*               R9 = R9 + 1              /*INCREMENT POINTER */;        08190000
         AH    @9,@D3                                             0327  08200000
*               GO TO F2H4               /*BR TO PROCESS 2ND DIGIT*/;   08210000
         BC    15,F2H4                                            0328  08220000
*         END;                                                          08230000
*  /*AT THIS POINT INVALID CHARACTERS WERE FOUND */                     08240000
*  F2H6:;                                                               08250000
@9EF     EQU   *                                                  0330  08260000
*               MS = 3                   /* INDICATE MSG */;            08270000
F2H6     LA    @F,3                                               0331  08280000
         STH   @F,406(0,@5)                                       0331  08290000
*               GO TO F1B4               /* BRANCH TO EXIT */;          08300000
         BC    15,F1B4                                            0332  08310000
*         END;                                                          08320000
*  /*AT THIS POINT THE CHAR IS TESTED FOR C1 THRU C6 */                 08330000
*  F2H7:;                                                               08340000
@9F0     EQU   *                                                  0334  08350000
*         IF INBUF(3)  < 'C1'X THEN GO TO F2H6 /*BR IF INVALID */;      08360000
F2H7     CLI   2(@9),X'C1'                                        0335  08370000
         BC    04,F2H6                                            0336  08380000
*         IF INBUF(3)  > 'C6'X THEN GO TO F2H6 /*BR IF INVALID */;      08390000
         CLI   2(@9),X'C6'                                        0337  08400000
         BC    02,F2H6                                            0338  08410000
*  /* VALID DIGIT FOUND HERE */                                         08420000
*               R6 = R6 | INBUF(3:3)     /* OR DIGIT TO REGISTER */;    08430000
         SR    @F,@F                                              0339  08440000
         IC    @F,2(0,@9)                                         0339  08450000
         OR    @6,@F                                              0339  08460000
*               R6 = R6 & '0F'X          /*  & OUT TOP 4 DIGITS */;     08470000
         LA    @F,X'0F'                                           0340  08480000
         NR    @6,@F                                              0340  08490000
*               R6 = R6 + 9              /*CREATE PROPER DIGIT*/;       08500000
         AH    @6,@D7                                             0341  08510000
*               GO TO F2H5               /* BR TO TEST FOR FIRST DIGIT* 08520000
         BC    15,F2H5                                            0342  08530000
*  /* ENTER HERE FOR SECOND DIGIT OF FILL */                            08540000
*  F2H8:;                                                               08550000
*               R6 = R6 | FDFILL         /*CONSTRUCT FILL CHARACTER*/;  08560000
F2H8     L     @1,596(0,@5)                                       0344  08570000
         SR    @0,@0                                              0344  08580000
         IC    @0,33(0,@1)                                        0344  08590000
         OR    @6,@0                                              0344  08600000
*               Q(1:4) = R6    /**STORE VALUE IN TEMPORARY AREA**/;     08610000
         ST    @6,@TEMP4                                          0345  08620000
         MVC   216(4,@5),@TEMP4                                   0345  08630000
*               FDFILL = Q(4)  /**PLACE FILL CHARACTER IN FD TABLE**/;  08640000
         L     @1,596(0,@5)                                       0346  08650000
         MVC   33(1,@1),219(@5)                                   0346  08660000
*               R9 = R9 + 4              /* POSITION POINTER */;        08670000
         AH    @9,@D10                                            0347  08680000
*               GO TO F2A1               /*BR TO CONTINUE PROCESSING*/; 08690000
         BC    15,F2A1                                            0348  08700000
*  /******************************************************************/ 08710000
*  /* CYCLE IS PROCESSED HERE ************************************/     08720000
*  /******************************************************************/ 08730000
*  /******************************************************************/ 08740000
*  /**                                                              **/ 08750000
*  /**    CYCLE IS PROCESSED BY POSITIONING THE SCAN POINTER TO THE **/ 08760000
*  /** DECIMAL NUMBER UPON THE CONTROL CARD.THE SCANOUT SUBROUTINE  **/ 08770000
*  /** IS CALLED TO ESTABLISH POINTERS USED BY THE VALIDITY CHECK   **/ 08780000
*  /** SUBROUTINE.AFTER THE NUMBER IS VALIDITY CHECKED,CONVB IS     **/ 08790000
*  /** CALLED IN ORDER TO CONVERT THE NUMBER TO BINARY.THE BINARY   **/ 08800000
*  /** VALUE OF CYCLE,FOUND IN REG 6 IS THEN PLACED INTO THE CYCLE  **/ 08810000
*  /** LOCATION OF THE FD TABLE.A BRANCH IS THEN TAKEN TO STEPPTR   **/ 08820000
*  /** TO STEP THE LOCATION POINTER TO THE NEXT PARAMETER IF PRESENT**/ 08830000
*  /**                                                              **/ 08840000
*  /******************************************************************/ 08850000
*  F2J2:;                                                               08860000
*               R9 = R9 + 6              /*POSITION POINTER*/;          08870000
F2J2     AH    @9,@D11                                            0350  08880000
*               CALL SCANOUT             /*SCAN OUT PARAMETER*/;        08890000
         BAL   @E,SCANOUT                                         0351  08900000
*               CALL VALCHECK            /**VALIDITY CHECK THE NUMBER** 08910000
         BAL   @E,VALCHECK                                        0352  08920000
*               CALL CONVB               /* CONVERT NUMBER TO BINARY*/; 08930000
         BAL   @E,CONVB                                           0353  08940000
*               FDCYCLE = R6             /*NUMBER TO TABLE*/;           08950000
         L     @1,596(0,@5)                                       0354  08960000
         STH   @6,26(0,@1)                                        0354  08970000
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER */;   08980000
         BC    15,STEPPTR                                         0355  08990000
*  /******************************************************************/ 09000000
*  /* RANGE IS PROCESSED HERE ************************************/     09010000
*  /******************************************************************/ 09020000
*  /**    POSITION THE SCAN POINTER TO NUMBER AS FOUND ON INPUT     **/ 09030000
*  /**CONTROL CARD.TURN ON THE RANGE SWITCH AND CALL THE SCANOUT    **/ 09040000
*  /**SUBROUTINE TO ESTABLISH POINTERS USED FOR VALIDITY CHECKING.  **/ 09050000
*  /**VALIDITY CHECK THE NUMBER FOR VALID DECIMAL DIGITS AND CONVERT**/ 09060000
*  /**THE NUMBER TO BINARY BY CALLING THE CONVB SUBROUTINE.PLACE THE**/ 09070000
*  /**BINARY VALUE OF THE DECIMAL NUMBER INTO THE RANGE LOCATION OF **/ 09080000
*  /**THE FD TABLE.BRANCH TO STEPPTR TO PROCESS NEXT PARAMETER.     **/ 09090000
*  /**                                                              **/ 09100000
*  /******************************************************************/ 09110000
*  F3A1:;                                                               09120000
*               R9 = R9 + 6              /* POSITION POINTER*/;         09130000
F3A1     AH    @9,@D11                                            0357  09140000
*               RANGESW = ON             /* TURN ON RANGE SWITCH*/;     09150000
         MVC   541(1,@5),ON                                       0358  09160000
*               CALL SCANOUT             /* SCAN OUT PARAMETER*/;       09170000
         BAL   @E,SCANOUT                                         0359  09180000
*               CALL VALCHECK            /**VALIDITY CHECK THE NUMBER** 09190000
         BAL   @E,VALCHECK                                        0360  09200000
*               CALL CONVB               /*CONVERT NUMBER TO BINARY*/;  09210000
         BAL   @E,CONVB                                           0361  09220000
*               FDRANGE = R6             /*RANGE TO TABLE*/;            09230000
         L     @1,596(0,@5)                                       0362  09240000
         ST    @6,36(0,@1)                                        0362  09250000
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;    09260000
         BC    15,STEPPTR                                         0363  09270000
*  /******************************************************************/ 09280000
*  /* CHARACTER IS PROCESSED HERE ********************************/     09290000
*  /******************************************************************/ 09300000
*  /**    THE SCAN POINTER IS STEPPED TO THE PARAMETER AND THE START  * 09310000
*  /** CHARACTER IS PLACED AT FDCHAR IN THE FDTABLE.THE POINTER IS    * 09320000
*  /** THEN POSITIONED AND A BRANCH TAKEN FOR FURTHER PROCESSING      * 09330000
*  /**                                                              **/ 09340000
*  /******************************************************************/ 09350000
*  F3C2:;                                                               09360000
*               R9 = R9 + 10             /* POSITION POINTER*/;         09370000
F3C2     AH    @9,@D12                                            0365  09380000
*               FDCHAR = INBUF(1) /**STARTING CHARACTER TO TABLE**/;    09390000
         L     @1,596(0,@5)                                       0366  09400000
         MVC   35(1,@1),0(@9)                                     0366  09410000
*               R9 = R9 + 1        /** POSITION POINTER**/;             09420000
         AH    @9,@D3                                             0367  09430000
*               GO TO F2A1               /*BR TO FURTHER PROCESSING*/;  09440000
         BC    15,F2A1                                            0368  09450000
*  F3D2:;                                                               09460000
*  /******************************************************************* 09470000
*  /* SIGN IS PROCESSED HERE *************************************/     09480000
*  /******************************************************************/ 09490000
*  /** SIGN IS PROCESSED BY TESTING THE VALUE AS FOUND IN THE CONTROL * 09500000
*  /** CARD FOR PLUS OR MINUS,AND IF FOUND CORRECT PLACING THE VALUE  * 09510000
*  /** FROM THE CARD IN THE FD SIGN FIELD OF THE FD TABLE             * 09520000
*  /** AN IMPROPER VALUE WILL CAUSE A MESSAGE TO BE ISSUED            * 09530000
*  /** THE SCAN POINTER IS THEN INCREMENTED TO POINT AT THE BLANK OR  * 09540000
*  /** COMMA FOLLOWING THE SIGN. A BRANCH IS THEN TAKEN TO TEST FOR   * 09550000
*  /** LAST PARAMETER ON THE CARD                                     * 09560000
*  /**                                                                * 09570000
*  /******************************************************************* 09580000
*         IF INBUF(6) = '+' THEN GO TO F3D3 /**BR OK TO PROCESS SIGN**/ 09590000
F3D2     CLI   5(@9),C'+'                                         0370  09600000
         BC    08,F3D3                                            0371  09610000
*         IF INBUF(6) = '-' THEN GO TO F3D3 /**BR OK TO PROCESS SIGN**/ 09620000
         CLI   5(@9),C'-'                                         0372  09630000
         BC    08,F3D3                                            0373  09640000
*               R9 = R9 + 5    /** POINT AT ERROR PARAMETER***/;        09650000
         AH    @9,@D4                                             0374  09660000
*               GO TO F2F21    /**BRANCH TO SET MESSAGE**/;             09670000
         BC    15,F2F21                                           0375  09680000
*  F3D3:;                                                               09690000
*         FDSIGN = INBUF(6) /** EBCDIC SIGN TO TABLE**/;                09700000
F3D3     L     @1,596(0,@5)                                       0377  09710000
         MVC   34(1,@1),5(@9)                                     0377  09720000
*               R9 = R9 + 6    /**POINT PAST PARAMETER**/;              09730000
         AH    @9,@D11                                            0378  09740000
*               GO TO F2A1               /*BRANCH TO CONTINUE */;       09750000
         BC    15,F2A1                                            0379  09760000
*  /******************************************************************/ 09770000
*  /* INDEX IS PROCESSED HERE ************************************/     09780000
*  /******************************************************************/ 09790000
*  /**    THE SCAN POINTER IS STEPPED TO THE PARAMETER. (REFER TO     * 09800000
*  /** EXPLANATION INDEX BY NAME AND REPLACE AT KEYWORD SCAN).INDEX   * 09810000
*  /** AND REPLACE ARE MUTUALLY EXCLUSIVE.SO ARE INDEX NAME AND NUMBER* 09820000
*  /** THE INDEX NUMBER IS SCANNED OUT,VALIDITY CHECKED,CONVERTED TO  * 09830000
*  /** BINARY AND PLACED AT FDINDNUM IN THE FD TABLE.A BRANCH IS THEN * 09840000
*  /** TAKEN TO STEP POINTER AND TEST FOR LAST PARAMETER.INDEX BY NAME* 09850000
*  /** WHEN FOUND WILL BE PLACED AT FDINDNM IN TABLE.                 * 09860000
*  /**                                                                * 09870000
*  /******************************************************************* 09880000
*  F3E2:;                                                               09890000
*               R9 = R9 + 6              /* ADJUST POINTER*/;           09900000
F3E2     AH    @9,@D11                                            0381  09910000
*         IF REPSW = ON THEN DO          /* IS INDEX EXCLUDED */;       09920000
         CLC   543(1,@5),ON                                       0382  09930000
         BC    07,@9EE                                            0382  09940000
*  F3F2:        MS = 13                  /* YES SET MESSAGE*/;          09950000
F3F2     LA    @F,13                                              0384  09960000
         STH   @F,406(0,@5)                                       0384  09970000
*               GO TO F1B4               /* BRANCH TO EXIT*/;           09980000
         BC    15,F1B4                                            0385  09990000
*         END;                                                          10000000
*  /* COME HERE IF INDEX NOT EXCLUDED */                                10010000
*               INDEXSW = ON             /* INDICATE INDEXING*/;        10020000
@9EE     MVC   544(1,@5),ON                                       0387  10030000
*  /** CHANGE FOLLOWING INSTRUCTION TO GO TO F3F4 WHEN INDEXING BY **/  10040000
*  /** NAME IS ALLOWED**/                                               10050000
*         IF INBUF(1) =< 'Z' THEN GO TO F2H22 /**BRANCH NOT NUMBER**/;  10060000
         CLI   0(@9),C'Z'                                         0388  10070000
         BC    12,F2H22                                           0389  10080000
*  /* PROCESS NUMBER HERE NAME PROCESSED A F3F4*/                       10090000
*               CALL SCANOUT             /*SCAN OUT PARAMETER*/;        10100000
         BAL   @E,SCANOUT                                         0390  10110000
*               CALL VALCHECK            /**VALIDITY CHECK THE NUMBER** 10120000
         BAL   @E,VALCHECK                                        0391  10130000
*               CALL CONVB               /*CONVERT NUMBER TO BINARY*/;  10140000
         BAL   @E,CONVB                                           0392  10150000
*               FDINDNUM = R6            /*NUMBER TO TABLE*/;           10160000
         L     @1,596(0,@5)                                       0393  10170000
         ST    @6,20(0,@1)                                        0393  10180000
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;    10190000
         BC    15,STEPPTR                                         0394  10200000
*  /* INDEX BY NAME PROCESSED HERE */                                   10210000
*  F3F4:;                                                               10220000
*               INDNMSW = ON   /**INDEX BY NAME SW ON**/;               10230000
F3F4     MVC   545(1,@5),ON                                       0396  10240000
*               INDBYNAM = '1'B /**FD INDEX BY NAME SWITCH ON**/;       10250000
         L     @1,596(0,@5)                                       0397  10260000
         OI    32(@1),B'10000000'                                 0397  10270000
*  F3G4:;                                                               10280000
*               CALL SCANOUT             /*SCAN OUT PARAMETER*/;        10290000
F3G4     BAL   @E,SCANOUT                                         0399  10300000
*         IF INDNMSW = ON THEN DO        /*INDEXING BY NAME */;         10310000
         CLC   545(1,@5),ON                                       0400  10320000
         BC    07,@9ED                                            0400  10330000
*               FDINDNM = INBUF(1:R7)    /**YES-NAME TO TABLE**/;       10340000
         LR    @1,@7                                              0402  10350000
         BCTR  @1,0                                               0402  10360000
         LR    @E,@9                                              0402  10370000
         L     @2,596(0,@5)                                       0402  10380000
         LA    @A,16(0,@2)                                        0402  10390000
         MVI   0(@A),C' '                                         0402  10400000
         MVC   1(007,@A),0(@A)                                    0402  10410000
         EX    @1,@MVC                                            0402  10420000
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;    10430000
         BC    15,STEPPTR                                         0403  10440000
*         END;                                                          10450000
*  /* REPLACING HERE */                                                 10460000
*               FDREPNM = INBUF(1:R7)    /**REPNAME TO TABLE**/;        10470000
@9ED     LR    @1,@7                                              0405  10480000
         BCTR  @1,0                                               0405  10490000
         LR    @E,@9                                              0405  10500000
         L     @2,596(0,@5)                                       0405  10510000
         LA    @A,8(0,@2)                                         0405  10520000
         MVI   0(@A),C' '                                         0405  10530000
         MVC   1(007,@A),0(@A)                                    0405  10540000
         EX    @1,@MVC                                            0405  10550000
*               GO TO STEPPTR            /*BRANCH TO STEP POINTER*/;    10560000
         BC    15,STEPPTR                                         0406  10570000
*  /******************************************************************/ 10580000
*  /* REPLACE IS PROCESSED HRRE **********************************/     10590000
*  /******************************************************************/ 10600000
*  F3G2:;                                                               10610000
*         IF INDEXSW = ON THEN GO TO F3F2 /*BR IF REPLACE EXCLUDED*/;   10620000
F3G2     CLC   544(1,@5),ON                                       0408  10630000
         BC    08,F3F2                                            0409  10640000
*               REPSW = ON               /*TURN ON REPLACE SWITCH*/;    10650000
         MVC   543(1,@5),ON                                       0410  10660000
*               R9 = R9 + 8              /**ADJUST POINTER**/;          10670000
         AH    @9,@D8                                             0411  10680000
*               GO TO F3G4               /*BR TO SCAN OUT NAME*/;       10690000
         BC    15,F3G4                                            0412  10700000
*  /******************************************************************* 10710000
*  /**  THIS SECTION PROCESSES THE INPUT KEYWORD FOR FIELD SELECTION  * 10720000
*  /** THE NAME IS PLACED IN FDTBL AT REPNAME AND THEN COMPARED TO SEE* 10730000
*  /** IF THE NAME WAS PRESENT UPON THE DSD CARD EXCEPT WHEN SYSIN    * 10740000
*  /** MESSAGE 4 ISSUED IF NO MATCH.                                  * 10750000
*  /******************************************************************* 10760000
*  F3H1:;                                                               10770000
*               R9 = R9 + 6    /** POINT AT INPUT DDNAME    **/;        10780000
F3H1     AH    @9,@D11                                            0414  10790000
*               CALL SCANOUT   /**SCAN OUT NAME AND CHECK LENGTH**/;    10800000
         BAL   @E,SCANOUT                                         0415  10810000
*                              /**REG 9 POINTS AT START OF NAME**/      10820000
*                              /**REG 8 COMMA OR BLANK AFTER NAME**/    10830000
*                              /** REG 7 CONTAINS LENGTH **/            10840000
*         FDREPNM = INBUF(1:R7) /** MOVE DDNAME TO FD TABLE**/;         10850000
         LR    @1,@7                                              0416  10860000
         BCTR  @1,0                                               0416  10870000
         LR    @E,@9                                              0416  10880000
         L     @2,596(0,@5)                                       0416  10890000
         LA    @A,8(0,@2)                                         0416  10900000
         MVI   0(@A),C' '                                         0416  10910000
         MVC   1(007,@A),0(@A)                                    0416  10920000
         EX    @1,@MVC                                            0416  10930000
*         INPUTSW = ON;                                                 10940000
         MVC   789(1,@5),ON                                       0417  10950000
*         IF INBUF(1:5) = 'SYSIN' THEN DO /** DO BELOW IF SYSIN**/;     10960000
         CLC   0(5,@9),@C36                                       0418  10970000
         BC    07,@9EC                                            0418  10980000
*               SYSINSEL = ON  /** TURN ON SYSIN SEL SWITCH**/;         10990000
         MVC   636(1,@5),ON                                       0420  11000000
*               DCBPTR = ADDR(SYSI) /** POINT AT SYSIN DCB**/;          11010000
         LA    @F,116(0,@5)                                       0421  11020000
         ST    @F,300(0,@5)                                       0421  11030000
*               GO TO STEPPTR  /** BR TO CONTINUE PROCESSING**/;        11040000
         BC    15,STEPPTR                                         0422  11050000
*         END;                                                          11060000
* F3H3:                                                                 11070000
*         IF FIRSTGMI = 0 THEN DO /** IF NO INPUT DCB DO BELOW**/;      11080000
@9EC     EQU   *                                                  0424  11090000
F3H3     SR    @F,@F                                              0424  11100000
         C     @F,392(0,@5)                                       0424  11110000
         BC    07,@9EB                                            0424  11120000
*  F3H2:;                                                               11130000
*               MS = 4         /** INDICATE MESSAGE 4 **/;              11140000
F3H2     LA    @F,4                                               0427  11150000
         STH   @F,406(0,@5)                                       0427  11160000
*               GO TO F1B4     /** BRANCH TO EXIT THIS ROUTINE**/;      11170000
         BC    15,F1B4                                            0428  11180000
*         END;                                                          11190000
*               DCBPTR = FIRSTGMI /** PICK UP FIRST DCB ADDRESS**/;     11200000
@9EB     MVC   300(4,@5),392(@5)                                  0430  11210000
*  F3H5:;                                                               11220000
*         IF DDNAME1 = FDREPNM THEN DO /**IF NAME MATCHES DO BELOW**/;  11230000
F3H5     L     @1,596(0,@5)                                       0432  11240000
         L     @2,300(0,@5)                                       0432  11250000
         CLC   260(8,@2),8(@1)                                    0432  11260000
         BC    07,@9EA                                            0432  11270000
*               FIELDSEL = ON  /**TURN ON FIELD SELECT SWITCH **/;      11280000
         MVC   278(1,@2),ON                                       0434  11290000
*        IF INPUTSW = ON THEN DO ;      /* TEST IF ENTRY IS FIRST35464* 11300000
         CLC   789(1,@5),ON                                       0435  11310000
         BC    07,@9E9                                            0435  11320000
*               FDFROMAD = INREC ;      /* SAVE INREC IN FDTBL A35464 * 11330000
         MVC   44(4,@1),272(@2)                                   0437  11340000
*               GO TO STEPPTR ;         /* END OF INPUT CHECK  A35464 * 11350000
         BC    15,STEPPTR                                         0438  11360000
*         END ;                                             /* A35464 * 11370000
*         GO TO F5F31 ;                 /* END OF FD CARD      A35464 * 11380000
*         END;                                                          11390000
*         IF NEXTDCB = 0 THEN GO TO F3H2 /** IF NO MORE INPUT DCBS      11400000
@9EA     SR    @F,@F                                              0442  11410000
         L     @1,300(0,@5)                                       0442  11420000
         C     @F,256(0,@1)                                       0442  11430000
*                                             PRESENT FOR COMPARE-BR ** 11440000
         BC    08,F3H2                                            0443  11450000
*               DCBPTR = NEXTDCB /**PICK UP NEXT DCB POINTER**/;        11460000
         MVC   300(4,@5),256(@1)                                  0444  11470000
*               GO TO F3H5     /**BR TO KEEP LOOKING FOR DCB MATCH**/;  11480000
         BC    15,F3H5                                            0445  11490000
*  /******************************************************************* 11500000
*  /** THIS SECTION PLACES THE FROM LOCATION IN THE FD TABLE AT **/     11510000
*  /**  FDMLGTH  **/                                                    11520000
*  /******************************************************************* 11530000
*  F3J1:;                                                               11540000
*               R9 = R9 + 8    /** POINT AT PARAMETER**/;               11550000
F3J1     AH    @9,@D8                                             0447  11560000
*               CALL SCANOUT   /** SCAN OUT PARAMETER**/;               11570000
         BAL   @E,SCANOUT                                         0448  11580000
*               CALL VALCHECK  /**VALIDITY CHECK THE NUMBER**/;         11590000
         BAL   @E,VALCHECK                                        0449  11600000
*               CALL CONVB     /** CONVERT TO BINARY**/;                11610000
         BAL   @E,CONVB                                           0450  11620000
*         FDMLGTH = R6 - 1 /**ADJ NO.AND PUT IN TEMP LOCATION**/;       11630000
         LR    @F,@6                                              0451  11640000
         BCTR  @F,0                                               0451  11650000
         L     @1,596(0,@5)                                       0451  11660000
         STH   @F,48(0,@1)                                        0451  11670000
*               GO TO STEPPTR  /** BRANCH TO STEP POINTER**/;           11680000
         BC    15,STEPPTR                                         0452  11690000
*  /******************************************************************/ 11700000
*  /* PICTURE IS PROCESSED HERE **********************************/     11710000
*  /******************************************************************/ 11720000
*  /**    THIS SECTION BETWEEN LABELS OF F4A1 AND F5D2 WILL SCAN A    * 11730000
*  /** PICTURE AS INPUT ON CONTROL CARDS AND PLACE IT INTO A TEMPORARY* 11740000
*  /** AREA OF STORAGE FOR FURTHER PROCESSING.A GETMAIN IS FIRST      * 11750000
*  /** ISSUED TO HOLD THE PICTURE.AFTER SETTING A SWITCH TO INDICATE  * 11760000
*  /** THE TYPE OF PICTURE(EBCDIC,BINARY OR PACKED DECIMAL) THE       * 11770000
*  /** PICTURE IS PLACED AT SGCADDR AS IT IS SCANNED.THE PICTURE MAY  * 11780000
*  /** EXTEND FROM COLUMN FOUR THROUGH COLUMN 71.WHEN CONTINUED IT IS * 11790000
*  /** PICKED UP FROM COLUMN FOUR OF THE NEXT CARD.                   * 11800000
*  /**                                                                * 11810000
*  /**                                                                * 11820000
*  /******************************************************************* 11830000
*  F4A1:;                                                               11840000
*               /* THIS GET MAIN IS ISSUED TO OBTAIN CORE FOR PICTURE*/ 11850000
*               R1 = ADDR(GETMLIST)      /** PICK UP LIST ADDRESS    ** 11860000
F4A1     LA    @1,364(0,@5)                                       0454  11870000
*                              /*ISSUE GET MAIN MACRO*/                 11880000
*               R7 = ADDR(GCADDR)        /** PICK UP GCADDR ADDRESS  ** 11890000
         LA    @7,376(0,@5)                                       0455  11900000
*         GEN ( GETMAIN EC,LV=(R6),A=(R7),SP=0,MF=(E,(R1)));            11910000
          GETMAIN EC,LV=(R6),A=(R7),SP=0,MF=(E,(R1))                    11920000
         DS    0H                                                       11930000
*         IF R15 = 0 THEN GO TO F4A2     /*BRANCH ON SUCCESSFUL GM */;  11940000
         LTR   @F,@F                                              0457  11950000
         BC    08,F4A2                                            0458  11960000
*               MS = 10                  /*INDICATE MESSAGE*/;          11970000
         LA    @F,10                                              0459  11980000
         STH   @F,406(0,@5)                                       0459  11990000
*               GO TO F1B4               /*BRANCH TO EXIT */;           12000000
         BC    15,F1B4                                            0460  12010000
*  /******************************************************************* 12020000
*  /**                                                                * 12030000
*  /**    THIS SECTION INITILIZES COUNTERS AND ADDRESSES AND POINTS AT* 12040000
*  /** COMMA FOLLOWING LENGTH.IF COMMA IS IN COLUMN 71 THE FDPSW IS   * 12050000
*  /** TURNED ON AND CONTROL RETURNED TO THE BASE MODULE.CONTROL WILL * 12060000
*  /** RETURN TO F4B5 TO TEST FOR TYPE OF PICTURE.IF COMMA HAPPENS TO * 12070000
*  /** BE PAST COLUMN 71 A MSG IS INDICATED AND A BRANCH TAKEN TO FREE* 12080000
*  /** CORE AND EXIT AS THIS IS AN ERROR                              * 12090000
*  /**                                                                * 12100000
*  /******************************************************************* 12110000
*  F4A2:;                                                               12120000
*               LMOVED = 0     /**INITILIZE COUNTER***/;                12130000
F4A2     SR    @F,@F                                              0462  12140000
         STH   @F,620(0,@5)                                       0462  12150000
*         LREMAIN = FDPLGTH    /**INIT LREMAIN TO PICTURE LENGTH**/;    12160000
         LH    @F,588(0,@5)                                       0463  12170000
         ST    @F,612(0,@5)                                       0463  12180000
*         SGCADDR = GCADDR     /*SUCESSFUL GETMAIN HERE SAVE ADDRESS*/; 12190000
         MVC   592(4,@5),376(@5)                                  0464  12200000
*               FDPCSW = ON              /*TURN ON PIC SW */;           12210000
         MVC   538(1,@5),ON                                       0465  12220000
*               R9 = R8               /** POINT AT COMMA AFTER LENGTH** 12230000
         LR    @9,@8                                              0466  12240000
*         IF INBUF(1) ^= ',' THEN GO TO F2A2 /**BR TO SET MESSAGE**/;   12250000
         CLI   0(@9),C','                                         0467  12260000
         BC    07,F2A2                                            0468  12270000
*  /* IS PICTURE IS INTERRUPTED AFTER LENGTH PARA BECAUSE COMMA IS IN * 12280000
*  /* COLUMN 71 REST OF PARAMETERS MUST START IN COLUMN 4 */            12290000
*         IF R9 = COUNTER THEN DO        /*ARE WE AT COL 71*/;          12300000
         C     @9,232(0,@5)                                       0469  12310000
         BC    07,@9E8                                            0469  12320000
*               FDPSW = ON               /*YES-CONT PICT AFTER LGTH*/;  12330000
         MVC   549(1,@5),ON                                       0471  12340000
*               RETURN                   /*RETURN TO IEBDG*/;           12350000
         BC    15,@EL01                                           0472  12360000
*         END;                                                          12370000
*         IF R9 > COUNTER THEN DO        /*ARE WE PAST COL 71*/;        12380000
@9E8     C     @9,232(0,@5)                                       0474  12390000
         BC    12,@9E7                                            0474  12400000
*               MS = 21                  /*YES SET MSG*/;               12410000
         LA    @F,21                                              0476  12420000
         STH   @F,406(0,@5)                                       0476  12430000
*               GO TO F4E1          /**BRANCH TO FREEMAIN**/;           12440000
         BC    15,F4E1                                            0477  12450000
*         END;                                                          12460000
*  /******************************************************************* 12470000
*  /**                                                                * 12480000
*  /**    THIS SECTION STEPS THE POINTER PAST THE COMMA FOLLOWING     * 12490000
*  /** LENGTH OR IN CASE PICTURE WAS CONTINUED AFTER THE LENGTH SUB-  * 12500000
*  /** PARAMETER TO COLUMN FOUR.THE TYPE OF PICTURE IS INDICATED BY   * 12510000
*  /** SETTING  EQUOTESW,BQUOTESW OR PQUOTESW.THE POINTER IS THEN     * 12520000
*  /** ADVANCED TO THE QUOTE.IF QUOTE IS IN COLUMN 71 CONTROL IS      * 12530000
*  /** RETURNED TO GET ANOTHER CARD.CONTROL WILL RETURN TO F4E3 TO SET* 12540000
*  /** UP FOR SCANNING PICTURE,OTHERWISE WE GO TO F4E3.               * 12550000
*  /**                                                                * 12560000
*  /******************************************************************* 12570000
*  F4B5:;                                                               12580000
@9E7     EQU   *                                                  0479  12590000
*               R9 = R9 + 1              /*POINT PAST COMMA*/;          12600000
F4B5     AH    @9,@D3                                             0480  12610000
*        IF INBUF(1) = '''' THEN DO /**IF EBCDIC DO BELOW**/;           12620000
         CLI   0(@9),C''''                                        0481  12630000
         BC    07,@9E6                                            0481  12640000
*              EQUOTESW = ON        /**TURN ON EQUOTE SWITCH**/;        12650000
         MVC   548(1,@5),ON                                       0483  12660000
*               GO TO F4D3     /**BRANCH TO PROCESS EBCDIC PICTURE**/;  12670000
         BC    15,F4D3                                            0484  12680000
*        END ;                                                          12690000
*         IF INBUF(1:2) = 'B''' THEN GO TO F4C2 /* BR IF B'*/;          12700000
@9E6     CLC   0(2,@9),@C37                                       0486  12710000
         BC    08,F4C2                                            0487  12720000
*         IF INBUF(1:2) = 'P''' THEN GO TO F4C5 /**BR IF P QUOTE**/;    12730000
         CLC   0(2,@9),@C38                                       0488  12740000
         BC    08,F4C5                                            0489  12750000
*         IF INBUF(1) = ' '         /* BLANK AFTER LENGTH PARAM A44355* 12760000
*            THEN DO ;              /* CHECK IF CONTINUATION    A44355* 12770000
         CLI   0(@9),C' '                                         0490  12780000
         BC    07,@9E5                                            0490  12790000
*            IF FDPSW = ON THEN DO; /*IS THIS A CONTINUATION  @ZA24045* 12800000
         CLC   549(1,@5),ON                                       0492  12810000
         BC    07,@9E4                                            0492  12820000
*                    /*THEN LOOK FOR A NON-BLANK IN THIS CARD @ZA24045* 12830000
*               IF R9 => COUNTER THEN DO; /*IF PAST COL 71    @ZA24045* 12840000
         C     @9,232(0,@5)                                       0494  12850000
*                                   /*CONTINUE WITH NEXT CARD @ZA24045* 12860000
*                  RETURN ;         /*RETURN TO IEBDG         @ZA24045* 12870000
         BC    11,@EL01                                           0496  12880000
*               END ;                                       /*@ZA24045* 12890000
*               GO TO F4B5;         /*LOOK FOR A NON-BLANK    @ZA24045* 12900000
         BC    15,F4B5                                            0498  12910000
*            END ;                                          /*@ZA24045* 12920000
*               IF COUNTER -> INBUF(2) ^= ' '               /*  A44355* 12930000
*                  THEN DO ;        /* CONTINUATION REQUIRED    A44355* 12940000
@9E4     L     @1,232(0,@5)                                       0500  12950000
         CLI   1(@1),C' '                                         0500  12960000
         BC    08,@9E2                                            0500  12970000
*                     FDPSW = ON ;  /* PICTURE CONT. SW ON      A44355* 12980000
         MVC   549(1,@5),ON                                       0502  12990000
*                     RETURN ;      /* RETURN TO IEBDG FOR NEXT A44355* 13000000
         BC    15,@EL01                                           0503  13010000
*               END ;               /* OTHERWISE THE BLANK IS   A44355* 13020000
*         END ;                     /* AN ERROR                 A44355* 13030000
@9E2     EQU   *                                                  0505  13040000
*               MS = 21                  /* NO PARA SET MSG*/;          13050000
@9E5     LA    @F,21                                              0506  13060000
         STH   @F,406(0,@5)                                       0506  13070000
*               GO TO F4E1               /*BR TO FREEMAIN */;           13080000
         BC    15,F4E1                                            0507  13090000
*  F4C2:;                                                               13100000
*               FDPSW = OFF;        /*TURN OFF FDPSW          @ZA24045* 13110000
F4C2     MVC   549(1,@5),OFF                                      0509  13120000
*               BQUOTESW = ON            /*TURN ON BQUOTE SW */;        13130000
         MVC   546(1,@5),ON                                       0510  13140000
*  F4C21:;                                                              13150000
*               R9 = R9 + 1              /*ADVANCE PTR TO QUOTE*/;      13160000
F4C21    AH    @9,@D3                                             0512  13170000
*               GO TO F4D3     /** BRANCH TO PROCESS NUMBER**/;         13180000
         BC    15,F4D3                                            0513  13190000
*  F4C5:;                                                               13200000
*               FDPSW = OFF;             /*TURN OFF FDPSW     @ZA24045* 13210000
F4C5     MVC   549(1,@5),OFF                                      0515  13220000
*               PQUOTESW = ON            /*TURN ON PQUOTE SW */;        13230000
         MVC   547(1,@5),ON                                       0516  13240000
*               GO TO F4C21              /*BR TO ADVANCE PTR*/;         13250000
         BC    15,F4C21                                           0517  13260000
*  /******************************************************************* 13270000
*  /**                                                                * 13280000
*  /**    AT THIS POINT R9 SHOULD BE POINTING AT THE LEADING QUOTE IN * 13290000
*  /**THE PICTURE STRING.IF THE QUOTE HAPPENS TO BE IN COL 71,WHICH  ** 13300000
*  /** IS INDICATED BY R9 AND COUNTER BEING EQUAL,THE FDPCSW WILL BE  * 13310000
*  /** SET ON AND A RETURN ISSUED TO GO BACK TO THE BASE MODULE.      * 13320000
*  /**                                                                * 13330000
*  /******************************************************************* 13340000
*  F4D3:;                                                               13350000
*               FDPSW = OFF;      /*TURN OFF FDPSW            @ZA24045* 13360000
F4D3     MVC   549(1,@5),OFF                                      0519  13370000
*         IF R9 = COUNTER THEN DO /**IF POINTER NOT AT COL 71 BRANCH**/ 13380000
         C     @9,232(0,@5)                                       0520  13390000
         BC    07,@9E1                                            0520  13400000
*               FDPCSW = ON    /**TURN ON FDPCSW**/;                    13410000
         MVC   538(1,@5),ON                                       0522  13420000
*                              /**BRANCH TO RETURN POINT**/             13430000
*               RETURN;                                                 13440000
         BC    15,@EL01                                           0523  13450000
*         END;                                                          13460000
*  F4E3:;                                                               13470000
@9E1     EQU   *                                                  0525  13480000
*               R7 = GCADDR + LMOVED /**PICTURE GOES INTO THIS AREA**/; 13490000
F4E3     LH    @7,620(0,@5)                                       0526  13500000
         A     @7,376(0,@5)                                       0526  13510000
*               FDPSW = OFF    /**TURN OFF FDPSW WE ARE PAST LENGTH**/; 13520000
         MVC   549(1,@5),OFF                                      0527  13530000
*               R9 = R9 + 1              /*POINT AT FIRST CHAR*/;       13540000
         AH    @9,@D3                                             0528  13550000
*               R8 = R9                  /*COPY POINTER*/;              13560000
         LR    @8,@9                                              0529  13570000
*  /******************************************************************* 13580000
*  /**                                                                * 13590000
*  /** THIS SECTION WILL TEST FOR ALL OF THE PICTURE BEING MOVED.THIS * 13600000
*  /** SECTION MAY BE ENTERED AS A RESULT OF THE FDPCSW BEING ON,WHICH* 13610000
*  /** ORDINARILY MEANS A NORMAL PICTURE CONTINUATION.THE ONE CASE NOT* 13620000
*  /** COVERED IS WHEN THE END OF THE PICTURE COINCIDES WITH COL 71.  * 13630000
*  /** IN THIS CASE COL 4 OF THE NEXT CARD SHOULD CONTAIN A QUOTE.AT  * 13640000
*  /** THIS TIME R6 SHOULD BE ZERO.IF ZERO,THE SCAN POINTER IS INC BY * 13650000
*  /** ONE AND A BRANCH IS TAKEN TO SCAN FOR MORE PARAMETERS.IF R6 IS * 13660000
*  /** ZERO AND NO QUOTE IS FOUND IN COL 4 A BRANCH IS TAKEN TO SET   * 13670000
*  /** MESSAGE NUMBER AND FREE CORE NO LONGER NEEDED FOR THE PICTURE  * 13680000
*  /**                                                                * 13690000
*  /******************************************************************* 13700000
*         IF R6 = 0 THEN DO    /**BRANCH IF R6 NOT ZERO**/;             13710000
         LTR   @6,@6                                              0530  13720000
         BC    07,@9E0                                            0530  13730000
*         IF INBUF(1) = '''' THEN DO /**IF QUOTE IN COL 4 DO BELOW**/;  13740000
         CLI   0(@9),C''''                                        0532  13750000
         BC    07,@9DF                                            0532  13760000
*               R9 = R9 + 1    /**INCREMENT SCAN POINTER BY ONE**/;     13770000
         AH    @9,@D3                                             0534  13780000
*               FDPCSW = OFF   /**TURN OFF FDPCSW**/;                   13790000
         MVC   538(1,@5),OFF                                      0535  13800000
*               FDPSW = OFF    /**TURN OFF FDPSW**/;                    13810000
         MVC   549(1,@5),OFF                                      0536  13820000
*               GO TO F2A1     /**BRANCH TO SCAN FOR MORE PARAMETERS**/ 13830000
         BC    15,F2A1                                            0537  13840000
*         END;                                                          13850000
*               GO TO F4G11    /**BRANCH TO SET MSG AND FREE CORE**/;   13860000
*         END;                                                          13870000
*                              /**COME HERE IF R6 NOT ZERO **/          13880000
*  /******************************************************************* 13890000
*  /**                                                                * 13900000
*  /**    THIS SECTION SCANS OUT THE ACTUAL PICTURE. REG6 IS USED TO  * 13910000
*  /** COUNT THE LENGTH. IT IS DECREMENTED BY ONE  IN THIS LOOP,IF IT * 13920000
*  /** BECOMES ZERO THIS INDICATES THE END OF THE PICTURE AND A BRANCH* 13930000
*  /** IS TAKEN TO F4G1 TO LOOK FOR THE QUOTE WHICH MUST FOLLOW THE   * 13940000
*  /** PICTURE. REG8 IS INCREMENTED BY ONE UNTIL COLUMN 71 IS REACHED.* 13950000
*  /**     IF COLUMN 71 IS ENCOUNTERED BEFORE THE COUNT BECOMES ZERO, * 13960000
*  /**  A BRANCH IS TAKEN TO MOVE THE CHARACTERS SCANNED.             * 13970000
*  /**                                                                * 13980000
*  /******************************************************************* 13990000
*  F4F3:;                                                               14000000
@9E0     EQU   *                                                  0541  14010000
*               R8 = R8 + 1              /*ADVANCE POINTER*/;           14020000
F4F3     AH    @8,@D3                                             0542  14030000
*               R6 = R6 - 1              /*SUBT ONE FROM LENGTH*/;      14040000
         BCTR  @6,0                                               0543  14050000
*         IF R6 = 0 THEN GO TO F4G1      /*BR TO F4G1 IF LGTH NOW ZERO* 14060000
         LTR   @6,@6                                              0544  14070000
         BC    08,F4G1                                            0545  14080000
*         IF R8 ^= COUNTER THEN GO TO F4F3 /**BR NOT AT COL 71 **/;     14090000
         C     @8,232(0,@5)                                       0546  14100000
         BC    07,F4F3                                            0547  14110000
*               GO TO F4G4          /** BRANCH TO MOVE PICTURE**/;      14120000
         BC    15,F4G4                                            0548  14130000
*  F4G5:;                                                               14140000
*                                   /**MOVE PICTURE TO HOLD AREA**/     14150000
*         GEN ( MVC 0(1,R7),0(R9));                                     14160000
F4G5      MVC 0(1,R7),0(R9)                                             14170000
         DS    0H                                                       14180000
*  /******************************************************************* 14190000
*  /**                                                                * 14200000
*  /**    THIS SECTION OBTAINS THE LENGTH TO MOVE AND ADDS THE LENGTH * 14210000
*  /** TO BE MOVED TO LMOVED( ZEROED AR START). LREMAIN IS CALCULATED * 14220000
*  /** AND PICTURE IS MOVED TO THE TEMPORARY HOLD AREA(SGCADDR). THE  * 14230000
*  /** FDPCSW IS TURNED ON(INDICATES MORE TO SCAN) AND CONTROL IS     * 14240000
*  /** RETURNED TO THE BASE MODULE.                                   * 14250000
*  /**                                                                * 14260000
*  /******************************************************************* 14270000
*  F4G4:;                                                               14280000
*               R6 = R8 - R9 + 1 /**OBTAIN LENGTH TO MOVE **/;          14290000
F4G4     LA    @6,1                                               0552  14300000
         SR    @6,@9                                              0552  14310000
         AR    @6,@8                                              0552  14320000
*               LMOVED = LMOVED + R6 /**COUNT LENGTH MOVED**/;          14330000
         LR    @F,@6                                              0553  14340000
         AH    @F,620(0,@5)                                       0553  14350000
         STH   @F,620(0,@5)                                       0553  14360000
*         LREMAIN = LREMAIN - R6 /**DETERMINE LENGTH LEFT IN PICTURE**/ 14370000
         LCR   @F,@6                                              0554  14380000
         A     @F,612(0,@5)                                       0554  14390000
         ST    @F,612(0,@5)                                       0554  14400000
*               R6 = R6 -1          /** CORRECT THE LENGTH TO MOVE**/;  14410000
         BCTR  @6,0                                               0555  14420000
*  /* THIS MOVES CHARACTERS SCANNED TO PICTURE AREA*/                   14430000
*         GEN ( EX R6,F4G5);                                            14440000
          EX R6,F4G5                                                    14450000
         DS    0H                                                       14460000
*               FDPCSW = ON         /**TURN ON PICTURE CONT SWITCH**/;  14470000
         MVC   538(1,@5),ON                                       0557  14480000
*         RETURN;                                                       14490000
         BC    15,@EL01                                           0558  14500000
*  /******************************************************************* 14510000
*  /**                                                                * 14520000
*  /**    THIS SECTION TESTS FOR THE QUOTE FOLLOWING THE PICTURE AND  * 14530000
*  /** IF FOUND,A BRANCH IS TAKEN TO MOVE THE LAST OF THE PICTURE.    * 14540000
*  /** OTHERWISE, THE MESSAGE IS INDICATED, POINTER IS SET FOR        * 14550000
*  /** FLAGGING. CONTROL THEN GOES TO THE NEXT SECTION.               * 14560000
*  /**                                                                * 14570000
*  /******************************************************************* 14580000
*  F4G1:;                                                               14590000
*         IF R8 -> INBUF(1) = '''' THEN GO TO F4H1 /**BR TO MOVE REST** 14600000
F4G1     CLI   0(@8),C''''                                        0560  14610000
         BC    08,F4H1                                            0561  14620000
*  /**    IF R8 IS GT COUNTER ALL OF PICTURE IS SCANNED**/              14630000
*         IF R8 > COUNTER THEN GO TO F4H1; /**BR PICTURE IS SCANNED**/  14640000
         C     @8,232(0,@5)                                       0562  14650000
         BC    02,F4H1                                            0563  14660000
*  F4G11:;                                                              14670000
*               MS = 3                   /* INDICATE MESSAGE*/;         14680000
F4G11    LA    @F,3                                               0565  14690000
         STH   @F,406(0,@5)                                       0565  14700000
*               R9 = R8                  /*SET POINTER FOR FLAG*/;      14710000
         LR    @9,@8                                              0566  14720000
*  /******************************************************************* 14730000
*  /**                                                                * 14740000
*  /**    THIS SECTION FREES CORE OBTAINED FOR TEMPORARY STORAGE OF   * 14750000
*  /** THE PICTURE. A BRANCH IS THEN TO EXIT THIS ROUTINE.            * 14760000
*  /* THIS WILL FREE CORE OBTAINED TO HOLD PICTURE IT IS IN ERROR*/     14770000
*  /**                                                                * 14780000
*  /******************************************************************* 14790000
*  F4E1:;                                                               14800000
*               R6 = FDPLGTH             /*PICK UP AMOUNT TO FREE*/;    14810000
F4E1     LH    @6,588(0,@5)                                       0568  14820000
*               R7 = ADDR(GCADDR)   /**PICK UP ADDRESS**/;              14830000
         LA    @7,376(0,@5)                                       0569  14840000
*               R1 = ADDR(GETMLIST)      /*PICK UP LIST ADDR*/;         14850000
         LA    @1,364(0,@5)                                       0570  14860000
*  GEN ( FREEMAIN E,LV=(R6),A=(R7),SP=0,MF=(E,(1)));                    14870000
          FREEMAIN E,LV=(R6),A=(R7),SP=0,MF=(E,(1))                     14880000
         DS    0H                                                       14890000
*               GO TO F1B4               /*BRANCH TO EXIT */;           14900000
         BC    15,F1B4                                            0572  14910000
*  /******************************************************************* 14920000
*  /**                                                                * 14930000
*  /**    THIS SECTION MOVES REMAINING PART OF PICTURE OR ALL OF IT   * 14940000
*  /** IN CASE IT WAS CONTAINED ON  ONE CARD. THE PICTURE SWITCHES ARE* 14950000
*  /** THEN TURNED OFF,POINTER ADVANCED TO COLUMN PAST QUOTE  AND  A  * 14960000
*  /** BRANCH TAKEN TO CONTINUE PROCESSING.                           * 14970000
*  /**                                                                * 14980000
*  /******************************************************************* 14990000
*  F4H1:;                                                               15000000
*               R6 = R8 - R9             /*OBTAIN LGTH TO MOVE*/;       15010000
F4H1     LCR   @6,@9                                              0574  15020000
         AR    @6,@8                                              0574  15030000
*               R6 = R6 - 1    /**TO CORRECT THE LENGTH**/;             15040000
         BCTR  @6,0                                               0575  15050000
*                                        /*MOVE REMAINING CHARACTERS*/  15060000
*          GEN ( EX R6,F4G5);                                           15070000
          EX R6,F4G5                                                    15080000
         DS    0H                                                       15090000
*               FDPSW  = OFF   /**TURN OFF PICTURE SWITCH**/;           15100000
         MVC   549(1,@5),OFF                                      0577  15110000
*  /** IF HOWEVER LAST CHARACTER OF PICTURE WAS IN COLUMN 71 WE MUST  * 15120000
*  /** EXPECT QUOTE IN COLUMN 4 OF NEXT CARD**/                         15130000
*         IF R8 > COUNTER THEN DO; /**IS R8 PAST COLUMN 71**/           15140000
         C     @8,232(0,@5)                                       0578  15150000
         BC    12,@9DE                                            0578  15160000
*               LREMAIN = 0;   /** SET LENGTH REMAINING TO ZERO**/      15170000
         SR    @F,@F                                              0580  15180000
         ST    @F,612(0,@5)                                       0580  15190000
*               FDPCSW = ON;   /**TURN ON PICT CONT SWITCH**/           15200000
         MVC   538(1,@5),ON                                       0581  15210000
*               RETURN;        /** BRANCH TO RETURN TO BASE**/          15220000
         BC    15,@EL01                                           0582  15230000
*         END;                                                          15240000
*               FDPCSW = OFF   /**TURN OFF PICTURE SWITCH**/;           15250000
@9DE     MVC   538(1,@5),OFF                                      0584  15260000
*               R9 = R8 + 1    /*POINTER TO COLUMN PAST QUOTE*/;        15270000
         LA    @9,1                                               0585  15280000
         AR    @9,@8                                              0585  15290000
*               GO TO F2A1     /*BRANCH TO CONTINUE PROCESSING*/;       15300000
         BC    15,F2A1                                            0586  15310000
*  /******************************************************************* 15320000
*  /**                                                                * 15330000
*  /**    THIS SECTION STARTS THE PROCESSING OF THE FD TABLE AFTER    * 15340000
*  /** ALL PARAMETERS HAVE BEEN SCANNED FROM THE CARD. LENGTH AND NAME* 15350000
*  /** MUST BE PRESENT. IF EITHER ONE IS MISSING, A MESSAGE IS        * 15360000
*  /** INDICATED AND  A BRANCH TAKEN TO EXIT THE ROUTINE. A LINK      * 15370000
*  /** MACRO IS THEN ISSUED FOR IEBFDTBL TO COMPLETE THE PROCESSING   * 15380000
*  /** REQUIRED. UPON RETURN FROM THE TABLE PROCESSING ROUTINE,       * 15390000
*  /** CONTROL IS PASSED TO THE BASE MODULE.                          * 15400000
*  /**                                                                * 15410000
*  /******************************************************************* 15420000
*  F5D2:;                                                               15430000
*         IF FDLGTH = '0000'X THEN DO /*IF NO LGTH DO FOLLOWING*/;      15440000
F5D2     L     @F,@X39                                            0588  15450000
         L     @1,596(0,@5)                                       0588  15460000
         CH    @F,24(0,@1)                                        0588  15470000
         BC    07,@9DD                                            0588  15480000
*  F5D3:        MS = 15                  /* SET MESSAGE */;             15490000
F5D3     LA    @F,15                                              0590  15500000
         STH   @F,406(0,@5)                                       0590  15510000
*               GO TO F1B4               /* BRANCH TO EXIT*/;           15520000
         BC    15,F1B4                                            0591  15530000
*         END;                                                          15540000
*  F5E2:;                                                               15550000
@9DD     EQU   *                                                  0593  15560000
*                                        /*BRANCH IF NAME IS MISSING*/  15570000
*         IF FDNAME = '0000000000000000'X THEN GO TO F5D3 ;             15580000
F5E2     L     @1,596(0,@5)                                       0594  15590000
         CLC   0(8,@1),@X40                                       0594  15600000
         BC    08,F5D3                                            0595  15610000
*  /** THIS SECTION WILL TEST FOR THE INPUT DDNAME BEING PRESENT      * 15620000
*  /** WHICH WILL INDICATE FIELD SELECTION IS TO BE PERFORMAD.        * 15630000
*  /** THE DDNAME WAS PLACED AT FDREPNM IN THE TABLE.IF PRESENT THE   * 15640000
*  /** DCBPTR SHOULD STILL BE POINTING AT THE PROPER INPUT DCB.       * 15650000
*  /** ACTION WILL BE MADE FIXED.IF RECFM IS 'V', FOUR IS ADDED TO THE* 15660000
*  /** FROM LOCATION.FROM LOCATION IS ACCESSED AT ITS TEMPORARY       * 15670000
*  /** LOCATION FDMLGTH AND PLACED IN FDFROMAD                        * 15680000
*  F5F1:;                                                               15690000
*   IF FDREPNM(1) ^= '00'X THEN DO ;                                    15700000
F5F1     L     @1,596(0,@5)                                       0597  15710000
         CLI   8(@1),X'00'                                        0597  15720000
         BC    08,@9DC                                            0597  15730000
*               FXACTION = '1'B /** TURN ON FIXED ACTION SW **/;        15740000
         OI    32(@1),B'00100000'                                 0599  15750000
*    FDFROMAD = FDMLGTH + FDFROMAD /* ADD FROMLOC TO INPUT REC A35464*/ 15760000
         L     @F,44(0,@1)                                        0600  15770000
         LH    @0,48(0,@1)                                        0600  15780000
         ALR   @F,@0                                              0600  15790000
         ST    @F,44(0,@1)                                        0600  15800000
*         IF FDREPNM(1:5) = 'SYSIN' THEN DO /**DO BELOW IF SYSIN**/;    15810000
         CLC   8(5,@1),@C36                                       0601  15820000
         BC    07,@9DB                                            0601  15830000
*         FDFROMAD = FDMLGTH + ADDR(INBUFA) /** INITILIZE FROM ADDRESS  15840000
*                                              FOR SYSIN ONLY**/;       15850000
         LA    @F,418(0,@5)                                       0603  15860000
         AH    @F,48(0,@1)                                        0603  15870000
         ST    @F,44(0,@1)                                        0603  15880000
*         IF FDLGTH + FDMLGTH > 80 THEN DO /**IS FIELD IN RECORD**/;    15890000
         LH    @F,48(0,@1)                                        0604  15900000
         AH    @F,24(0,@1)                                        0604  15910000
         CH    @F,@D13                                            0604  15920000
         BC    12,@9DA                                            0604  15930000
*  F5F3:;                                                               15940000
*               MS = 16        /** NO-INDICATE MESSAGE 16 **/;          15950000
F5F3     LA    @F,16                                              0607  15960000
         STH   @F,406(0,@5)                                       0607  15970000
*               GO TO F1B411   /** BRANCH TO EXIT THIS ROUTINE**/;      15980000
         BC    15,F1B411                                          0608  15990000
*         END;                                                          16000000
*               GO TO F5F4     /** BRANCH AROUND NEXT TEST**/;          16010000
*         END;                                                          16020000
*         INPUTSW = OFF;                                                16030000
@9DB     MVC   789(1,@5),OFF                                      0612  16040000
*         GO TO F3H3;                                                   16050000
         BC    15,F3H3                                            0613  16060000
* F5F31:                                                                16070000
*         IF FDLGTH + FDMLGTH > GMLGTH THEN GO TO F5F3 /**IS FIELD IN   16080000
F5F31    L     @1,596(0,@5)                                       0614  16090000
         LH    @F,48(0,@1)                                        0614  16100000
         AH    @F,24(0,@1)                                        0614  16110000
         L     @2,300(0,@5)                                       0614  16120000
         CH    @F,276(0,@2)                                       0614  16130000
*                                                         RECORD     ** 16140000
         BC    02,F5F3                                            0615  16150000
*  F5F4:;                                                               16160000
*         IF RECFM(1) = '1'B THEN GO TO F5F6 /**BR ITS NOT 'V' FMT**/;  16170000
F5F4     L     @1,300(0,@5)                                       0617  16180000
         TM    36(@1),B'10000000'                                 0617  16190000
         BC    01,F5F6                                            0618  16200000
*         IF RECFM(2) ^= '1'B THEN GO TO F5F6 /**BR ITS NOT 'V' FMT**/; 16210000
         TM    36(@1),B'01000000'                                 0619  16220000
         BC    12,F5F6                                            0620  16230000
*         FDFROMAD = FDFROMAD + 4 /** ADJUST FR ADDRESS FOR 'V'**/;     16240000
         LA    @F,4                                               0621  16250000
         L     @2,596(0,@5)                                       0621  16260000
         AL    @F,44(0,@2)                                        0621  16270000
         ST    @F,44(0,@2)                                        0621  16280000
*  F5F6:;                                                               16290000
*               FDMLGTH = FDLGTH  /** INIT MLGTH FOR CREATE**/;         16300000
F5F6     L     @1,596(0,@5)                                       0623  16310000
         MVC   48(2,@1),24(@1)                                    0623  16320000
*        SWITCH(1:14) = SWITCH(1:14) && SWITCH(1:14); /* SW OFF A48971* 16330000
         XC    536(14,@5),536(@5)                                 0624  16340000
*         RETURN;                                                       16350000
         BC    15,@EL01                                           0625  16360000
*         END;                                                          16370000
*               FDMLGTH = FDLGTH /**INIT MOVE LENGTH FOR CREATE**/;     16380000
@9DC     L     @1,596(0,@5)                                       0627  16390000
         MVC   48(2,@1),24(@1)                                    0627  16400000
*         GEN ( LINK EP=IEBFDTBL);                                      16410000
          LINK EP=IEBFDTBL                                              16420000
         DS    0H                                                       16430000
*               RETURN;                                                 16440000
*  SCANOUT: PROCEDURE OPTIONS(NOSAVEAREA,DONTSAVE);                     16450000
@EL01    L     @D,4(0,@D)                                         0630  16460000
         LR    @1,@C                                              0630  16470000
         L     @0,@SIZ001                                         0630  16480000
         FREEMAIN R,LV=(0),A=(1)                                  0630  16490000
         L     @E,12(0,@D)                                        0630  16500000
         LM    @0,@8,20(@D)                                       0630  16510000
         LM    @A,@C,60(@D)                                       0630  16520000
         BCR   15,@E                                              0630  16530000
SCANOUT  EQU   *                                                  0630  16540000
*                              /*************************************** 16550000
*                              /** THIS PROCEDURE WILL FIND THE LGTH ** 16560000
*                              /** OF THE PARAMETER FOLLOWING THE    ** 16570000
*                              /** EQUAL SIGN.UPON ENTRY REG 9 SHOULD** 16580000
*                              /** BE POINTING AT START OF PARAMETER ** 16590000
*                              /** UPON EXIT REGISTERS ARE AS FOLLOWS** 16600000
*                              /**                                   ** 16610000
*                              /** REG  7  EQUALS LENGTH OF PARA     ** 16620000
*                              /** REG  8  COMMA OR BLANK AFTER PARA ** 16630000
*                              /** REG  9  START OF PARAMETER        ** 16640000
*                              /**                                   ** 16650000
*                              /*************************************** 16660000
*               R8 = R9                  /*COPY SCAN POINTER */;        16670000
         LR    @8,@9                                              0631  16680000
*       IF R8 -> INBUF(1) = ' ' THEN                                    16690000
         CLI   0(@8),C' '                                         0632  16700000
*         GO TO MESS3;                                                  16710000
         BC    08,MESS3                                           0633  16720000
*  SCANOUT1:;                                                           16730000
*         R8 = R8 + 1                    /*INC PTR BY ONE*/;            16740000
SCANOUT1 AH    @8,@D3                                             0635  16750000
*       IF R8 -> INBUF(1) = ' ' THEN GO TO SCANOUT2 /*BR IF BLANK*/;    16760000
         CLI   0(@8),C' '                                         0636  16770000
         BC    08,SCANOUT2                                        0637  16780000
*  /*                                                        */         16790000
* /* CHECK IF PAST COL 72                                      A38710 * 16800000
*        IF R8 > COUNTER +1 THEN  /*                           A38710 * 16810000
         LA    @F,1                                               0638  16820000
         A     @F,232(0,@5)                                       0638  16830000
         CR    @F,@8                                              0638  16840000
*         GO TO MESS21;                                                 16850000
         BC    04,MESS21                                          0639  16860000
*       IF R8 -> INBUF(1) = ',' THEN GO TO SCANOUT2 /*BR IF COMMA*/;    16870000
         CLI   0(@8),C','                                         0640  16880000
         BC    08,SCANOUT2                                        0641  16890000
*         GO TO SCANOUT1;                                               16900000
         BC    15,SCANOUT1                                        0642  16910000
* MESS21:                                                               16920000
*               MS  =  21                       /** INDICATE MESSAGE ** 16930000
MESS21   LA    @F,21                                              0643  16940000
         STH   @F,406(0,@5)                                       0643  16950000
*               GO TO F1B4                /** BRANCH TO EXIT ROUTINE ** 16960000
         BC    15,F1B4                                            0644  16970000
*  /*                                                        */         16980000
*  SCANOUT2:;                                                           16990000
*               /* R8 SHOULD BE POINTING AT BLANK OR COMMA*/            17000000
*               R7 = R8 - R9           /** CALCULATE PARAMETER LENGTH** 17010000
SCANOUT2 LCR   @7,@9                                              0646  17020000
         AR    @7,@8                                              0646  17030000
*         IF R7 = 0 THEN DO    /**BR WHEN LENGTH IS NOT EQUAL TO ZERO** 17040000
         LTR   @7,@7                                              0647  17050000
         BC    07,@9D9                                            0647  17060000
*   MESS3:                                                              17070000
*               MS = 3         /** INDICATE MESSAGE**/;                 17080000
MESS3    LA    @F,3                                               0649  17090000
         STH   @F,406(0,@5)                                       0649  17100000
*               GO TO F1B4               /*BRANCH TO EXIT IEBFDANL*/;   17110000
         BC    15,F1B4                                            0650  17120000
*         END;                                                          17130000
*                              /** LGTH GT EIGHT- NAME IS TOO LONG   ** 17140000
*         IF R7 > 8 THEN DO    /** BR IF LENGTH LT,EQ TO 8           ** 17150000
@9D9     CH    @7,@D8                                             0652  17160000
         BC    12,@9D8                                            0652  17170000
*               MS = 12        /** INDICATE MESSAGE NUMBER 12 **/;      17180000
         LA    @F,12                                              0654  17190000
         STH   @F,406(0,@5)                                       0654  17200000
*               GO TO F1B4               /** BRANCH TO EXIT ROUTINE  ** 17210000
         BC    15,F1B4                                            0655  17220000
*         END;                                                          17230000
*               RETURN    /* RETURN TO CALLER WITH REGISTERS SET*/;     17240000
*  END SCANOUT;                                                         17250000
@EL02    BCR   15,@E                                              0658  17260000
*  /*                                    */                             17270000
*  /******************************************************************* 17280000
*  /**                                                                * 17290000
*  /** THIS PROCEDURE WILL CONVERT AN EBCDIC NUMBER FROM THE INPUT    * 17300000
*  /** WORKAREA TO BINARY.THE NUMBER IS TESTED BEFORE CONVERSION FOR  * 17310000
*  /** 2147483647.THE LARGEST BINARY NUMBER A REGISTER CAN CONTAIN IS * 17320000
*  /** THIS NUMBER.THIS NUMBER MUST BE VALIDITY CHECKED BEFORE ENTRY  * 17330000
*  /** TO THIS ROUTINE OR THE CVB INSTRUCTION MAY FAIL.               * 17340000
*  /** UPON ENTRY REG 9 POINTS AT START OF EBCDIC NUMBER IN INBUF     * 17350000
*  /** UPON ENTRY REG 7 CONTAINS LENGTH OF NUMBER                     * 17360000
*  /** UPON EXIT REG9 AND REG7 ARE NOT CHANGED                        * 17370000
*  /** REG 6 CONTAINS THE BINARY EQUIVALENT OF NUMBER                 * 17380000
*  /** IF RANGESW IS NOT ON THE NUMBER IS TESTED FOR BEING LARGER THAN* 17390000
*  /** 32767 THE MAXIMUM VALUE ALLOWED FOR LRECL.                     * 17400000
*  /**                                                                * 17410000
*  /******************************************************************* 17420000
*  CONVB: PROCEDURE OPTIONS(NOSAVEAREA,DONTSAVE);                       17430000
*                                   /*SAVE REG 14 IN COMMON AREA. */    17440000
*            SAVE14 = R14;                                              17450000
CONVB    ST    @E,360(0,@5)                                       0660  17460000
*               R6 = R7 - 1    /**CORRECT THE VALUE IN THE REGISTER**/; 17470000
         LH    @6,@D14                                            0661  17480000
         AR    @6,@7                                              0661  17490000
*                              /**PACK THE NUMBER IN Q AREA **/         17500000
*         GEN ( EX R6,CONVBP);                                          17510000
          EX R6,CONVBP                                                  17520000
         DS    0H                                                       17530000
*                              /**TEST FOR NUMBER BEING LARGER THEN**/  17540000
*                              /**2147483647 AND BRANCH IF NOT SO **/   17550000
*         IF Q(1:8) > '000002147483647F'X THEN DO /*BR IF NUMBER OK*/;  17560000
         CLC   216(8,@5),@X41                                     0663  17570000
*               GO TO CONVB1             /*BRANCH TO SET MSG*/;         17580000
         BC    03,CONVB1                                          0665  17590000
*         END;                                                          17600000
*           GEN ( CVB R6,Q(0,R5));                                      17610000
@9D7     EQU   *                                                  0667  17620000
          CVB R6,Q(0,R5)                                                17630000
         DS    0H                                                       17640000
*         IF R6 = 0 THEN GO TO F2H6 /** IF ZERO BR TO ISSUE MSG**/;     17650000
         LTR   @6,@6                                              0668  17660000
         BC    08,F2H6                                            0669  17670000
*         IF RANGESW = ON THEN DO /** IF RANGESW ON DO BELOW**/;        17680000
         CLC   541(1,@5),ON                                       0670  17690000
         BC    07,@9D6                                            0670  17700000
*               RANGESW = OFF  /**TURN OFF RANGE SW**/;                 17710000
         MVC   541(1,@5),OFF                                      0672  17720000
*               RETURN;                                                 17730000
         BC    15,@EL03                                           0673  17740000
*         END;                                                          17750000
*         IF R6 <= 32767 THEN DO     /** BRANCH IF LARGER THAN 32767**/ 17760000
@9D6     CH    @6,@D15                                            0675  17770000
         BC    02,@9D5                                            0675  17780000
*                                   /*RESTORE REG 14 FROM COMMON AREA.  17790000
*            R14 = SAVE14;                                              17800000
         L     @E,360(0,@5)                                       0677  17810000
*               RETURN                   /*RETURN TO CALLER*/;          17820000
         BC    15,@EL03                                           0678  17830000
*         END;                                                          17840000
*  CONVB1:;                                                             17850000
@9D5     EQU   *                                                  0680  17860000
*               MS = 6                   /*INDICATE MSG*/;              17870000
CONVB1   LA    @F,6                                               0681  17880000
         STH   @F,406(0,@5)                                       0681  17890000
*               GO TO F1B411   /**BRANCH TO EXIT **/;                   17900000
         BC    15,F1B411                                          0682  17910000
*  CONVBP: GEN ( PACK Q(8,R5),0(1,R9));                                 17920000
CONVBP    PACK Q(8,R5),0(1,R9)                                          17930000
         DS    0H                                                       17940000
*  END CONVB;                                                           17950000
@EL03    BCR   15,@E                                              0684  17960000
*  /******************************************************************* 17970000
*  /**                                                                * 17980000
*  /** THIS PROCEDURE WILL MOVE ANY NUMBER OF CHARACTERS FOR THE      * 17990000
*  /** CALLER.EXPECTED CONTENTS OF REGISTERS UPON ENTRY ARE:          * 18000000
*  /** REG 9 = FROM ADDRESS                                           * 18010000
*  /** REG 8 = TO ADDRESS                                             * 18020000
*  /** REG 7 = LENGTH TO MOVE                                         * 18030000
*  /** REGISTER CONTENTS ARE DESTROYED UPON EXIT IF MOVE IS GT 256    * 18040000
*  /**                                                                * 18050000
*  /******************************************************************* 18060000
*  MOVEROUT: PROCEDURE OPTIONS(NOSAVEAREA,DONTSAVE);                    18070000
MOVEROUT EQU   *                                                  0685  18080000
*  MOVE1:;                                                              18090000
*         IF R7 = 0 THEN RETURN          /** RETURN IF ZERO LENGTH   ** 18100000
MOVE1    LTR   @7,@7                                              0687  18110000
         BC    08,@EL04                                           0688  18120000
*         IF R7 < 256 THEN GO TO MOVE5   /** BR IF LT 256 TO MOVE    ** 18130000
@9D4     CH    @7,@D16                                            0689  18140000
         BC    04,MOVE5                                           0690  18150000
*                                        /*MOVES 256 BYTES*/            18160000
*         GEN (MVC 0(256,R8),0(R9));                                    18170000
         MVC 0(256,R8),0(R9)                                            18180000
         DS    0H                                                       18190000
*               R9 = R9 + 256            /*ADD 256 TO POSITION ADDR*/;  18200000
         AH    @9,@D16                                            0692  18210000
*               R8 = R8 + 256            /*ADD 256 TO POSITION ADDR*/;  18220000
         AH    @8,@D16                                            0693  18230000
*               R7 = R7 - 256            /*SUBT 256 TO CORRECT LENGTH*/ 18240000
         SH    @7,@D16                                            0694  18250000
*          GO TO MOVE1                   /*BR TO CONTINUE PROCESSING*/; 18260000
         BC    15,MOVE1                                           0695  18270000
*  MOVE4 :;                                                             18280000
*                                        /*MOVE REMAINING BYTES*/       18290000
*         GEN ( MVC 0(1,R8),0(R9));                                     18300000
MOVE4     MVC 0(1,R8),0(R9)                                             18310000
         DS    0H                                                       18320000
*  MOVE5:;                                                              18330000
*               R7 = R7 - 1              /*CORRECT THE LENGTH*/;        18340000
MOVE5    BCTR  @7,0                                               0699  18350000
*         GEN ( EX R7,MOVE4);                                           18360000
          EX R7,MOVE4                                                   18370000
         DS    0H                                                       18380000
*               R7 = R7 + 1 /**RESTORE REG 7 FOR EXIT WHEN LT 256 **/;  18390000
         AH    @7,@D3                                             0701  18400000
*               RETURN                   /*RETURN TO CALLER */;         18410000
*  END MOVEROUT;                                                        18420000
@EL04    BCR   15,@E                                              0703  18430000
*  /******************************************************************* 18440000
*  /**                                                                * 18450000
*  /** THIS PROCEDURE WILL VALIDITY CHECK AN EBCDIC NUMBER AS IT IS   * 18460000
*  /** INPUT FROM THE CONTROL CARD.UPON ENTRY REG 9 SHOULD POINT AT   * 18470000
*  /** START OF NUMBER IN INBUF.REG 7 SHOULD CONTAIN LENGTH OF NUMBER** 18480000
*  /** A WORKAREA IS CLEARED TO BINARY ZERO AND ZONES FROM THE NUMBER * 18490000
*  /** ARE MOVED TO THE WORKAREA.A COMPARE IS THEN DONE AGAINST       * 18500000
*  /** FOXZEROEZ.IF ALL DIGITS DO NOT COMPARE THE NUMBER IS INVALID   * 18510000
*  /** AND A BRANCH IS TAKEN TO SET UP MESSAGE AND RETURN,OTHERWISE   * 18520000
*  /** RETURN IS TO THE CALLER.                                       * 18530000
*  /**                                                                * 18540000
*  /******************************************************************* 18550000
*  VALCHECK: PROCEDURE OPTIONS(NOSAVEAREA,DONTSAVE);                    18560000
*                                   /*SAVE REG 14 IN COMMON AREA. */    18570000
*            SAVE14 = R14;                                              18580000
VALCHECK ST    @E,360(0,@5)                                       0705  18590000
*               Q  =  Q && Q             /*CLEAR Q TO ZEROS */;         18600000
         XC    216(16,@5),216(@5)                                 0706  18610000
*                              /* MOVE ZONES FROM NUMBER TO Q */        18620000
*         GEN ( EX R7,MOVEZONE);                                        18630000
          EX R7,MOVEZONE                                                18640000
         DS    0H                                                       18650000
*  /**COMPARE FOXZEROS TO Q LOOKING FOR EQ.BR IF NO EQ COMPARE  **/     18660000
*         IF Q (1:R7) ^= FOXZEROS(1:R7) THEN DO /*BRANCH OUT IF VALID** 18670000
         LA    @E,FOXZEROS                                        0708  18680000
         LR    @1,@7                                              0708  18690000
         BCTR  @1,0                                               0708  18700000
         LA    @A,216(0,@5)                                       0708  18710000
         EX    @1,@CLC                                            0708  18720000
         BC    08,@9D3                                            0708  18730000
*               MS = 3         /**INDICATE MESSAGE **/;                 18740000
         LA    @F,3                                               0710  18750000
         STH   @F,406(0,@5)                                       0710  18760000
*               GO TO F1B4     /**BRANCH TO LEAVE ROUTINE**/;           18770000
         BC    15,F1B4                                            0711  18780000
*         END;                                                          18790000
*                                   /*RESTORE REG 14 FROM COMMON AREA.  18800000
*            R14 = SAVE14;                                              18810000
@9D3     L     @E,360(0,@5)                                       0713  18820000
*                              /* RETURN TO CALLER*/                    18830000
*               RETURN;                                                 18840000
         BC    15,@EL05                                           0714  18850000
*  MOVEZONE:;                                                           18860000
*               /** MOVE ZONES TO Q FOR COMPARE **/                     18870000
*         GEN ( MVZ Q(1,R5),0(R9));                                     18880000
MOVEZONE  MVZ Q(1,R5),0(R9)                                             18890000
         DS    0H                                                       18900000
*    END VALCHECK;                                                      18910000
@EL05    BCR   15,@E                                              0717  18920000
*  END IEBFDANL;                                                        18930000
@DATA1   EQU   *                                                        18940000
@0       EQU   00                  EQUATES FOR REGISTERS 0-15           18950000
@1       EQU   01                                                       18960000
@2       EQU   02                                                       18970000
@3       EQU   03                                                       18980000
@4       EQU   04                                                       18990000
@5       EQU   05                                                       19000000
@6       EQU   06                                                       19010000
@7       EQU   07                                                       19020000
@8       EQU   08                                                       19030000
@9       EQU   09                                                       19040000
@A       EQU   10                                                       19050000
@B       EQU   11                                                       19060000
@C       EQU   12                                                       19070000
@D       EQU   13                                                       19080000
@E       EQU   14                                                       19090000
@F       EQU   15                                                       19100000
@D1      DC    H'2'                                                     19110000
@D2      DC    H'-64'                                                   19120000
@D3      DC    H'1'                                                     19130000
@D4      DC    H'5'                                                     19140000
@D5      DC    H'64'                                                    19150000
@D6      DC    H'7'                                                     19160000
@D7      DC    H'9'                                                     19170000
@D8      DC    H'8'                                                     19180000
@D9      DC    H'3'                                                     19190000
@D10     DC    H'4'                                                     19200000
@D11     DC    H'6'                                                     19210000
@D12     DC    H'10'                                                    19220000
@D13     DC    H'80'                                                    19230000
@D14     DC    H'-1'                                                    19240000
@D15     DC    H'32767'                                                 19250000
@D16     DC    H'256'                                                   19260000
@CLC     CLC   0(1,@A),0(@E)                                            19270000
@MVC     MVC   0(1,@A),0(@E)                                            19280000
         DS    0F                                                       19290000
@SIZ001  DC    AL1(&SPN)                                                19300000
         DC    AL3(@DATEND-@DATD)                                       19310000
         DS    0F                                                       19320000
@C2      DC    C'BADFIELD'                                              19330000
@C8      DC    C'FROMLOC='                                              19340000
@C11     DC    C'PICTURE='                                              19350000
@C20     DC    C'REPLACE='                                              19360000
@X39     DC    X'00000000'                                              19370000
@X40     DC    X'0000000000000000'                                      19380000
@X41     DC    X'000002147483647F'                                      19390000
@C7      DC    C'INPUT='                                                19400000
@C15     DC    C'CYCLE='                                                19410000
@C16     DC    C'RANGE='                                                19420000
@C17     DC    C'CHARACTER='                                            19430000
@C19     DC    C'INDEX='                                                19440000
@C21     DC    C'AN'                                                    19450000
@C22     DC    C'AL'                                                    19460000
@C23     DC    C'ZD'                                                    19470000
@C24     DC    C'PD'                                                    19480000
@C25     DC    C'CO'                                                    19490000
@C26     DC    C'BI'                                                    19500000
@C37     DC    C'B'''                                                   19510000
@C38     DC    C'P'''                                                   19520000
@C6      DC    C'NAME='                                                 19530000
@C9      DC    C'LENGTH='                                               19540000
@C10     DC    C'STARTLOC='                                             19550000
@C12     DC    C'FORMAT='                                               19560000
@C13     DC    C'ACTION='                                               19570000
@C14     DC    C'FILL='                                                 19580000
@C18     DC    C'SIGN='                                                 19590000
@C36     DC    C'SYSIN'                                                 19600000
         DS    0D                                                       19610000
@DATA    EQU   *                                                        19620000
R14      EQU   00000014            FULLWORD INTEGER REGISTER            19630000
R15      EQU   00000015            FULLWORD INTEGER REGISTER            19640000
R0       EQU   00000000            FULLWORD INTEGER REGISTER            19650000
R4       EQU   00000004            FULLWORD POINTER REGISTER            19660000
R3       EQU   00000003            FULLWORD INTEGER REGISTER            19670000
R1       EQU   00000001            FULLWORD INTEGER REGISTER            19680000
R2       EQU   00000002            FULLWORD INTEGER REGISTER            19690000
R5       EQU   00000005            FULLWORD POINTER REGISTER            19700000
R6       EQU   00000006            FULLWORD POINTER REGISTER            19710000
R7       EQU   00000007            FULLWORD POINTER REGISTER            19720000
R8       EQU   00000008            FULLWORD POINTER REGISTER            19730000
R9       EQU   00000009            FULLWORD POINTER REGISTER            19740000
COMMON   EQU   00000000            308 BYTE(S) ON DWORD                 19750000
PAGENO   EQU   COMMON+00000000     4 BYTE(S)                            19760000
LINECT   EQU   COMMON+00000004     FULLWORD INTEGER                     19770000
LINECTR  EQU   COMMON+00000008     FULLWORD INTEGER                     19780000
PARM     EQU   COMMON+00000012     FULLWORD POINTER                     19790000
REPEATNO EQU   COMMON+00000016     HALFWORD INTEGER                     19800000
CREATENO EQU   COMMON+00000018     HALFWORD INTEGER                     19810000
SYSP     EQU   COMMON+00000020     96 BYTE(S)                           19820000
SYSI     EQU   COMMON+00000116     96 BYTE(S)                           19830000
Q        EQU   COMMON+00000216     16 BYTE(S) ON DWORD                  19840000
QFILL    EQU   COMMON+00000216     7 BYTE(S)                            19850000
QSIGN    EQU   COMMON+00000223     8 BIT(S)                             19860000
QFILL1   EQU   COMMON+00000224     7 BYTE(S)                            19870000
QSIGN1   EQU   COMMON+00000231     8 BIT(S)                             19880000
COUNTER  EQU   COMMON+00000232     FULLWORD POINTER                     19890000
OPENLIST EQU   COMMON+00000236     8 BYTE(S)                            19900000
OPTBYTE1 EQU   COMMON+00000236     4 BYTE(S)                            19910000
OPTBYTE2 EQU   COMMON+00000240     4 BYTE(S)                            19920000
EXLST    EQU   COMMON+00000244     24 BYTE(S) ON WORD                   19930000
INHDR    EQU   COMMON+00000244     1 BYTE(S)                            19940000
INHDR1   EQU   COMMON+00000245     3  BYTE  POINTER ON WORD+1           19950000
OUTHDR   EQU   COMMON+00000248     1 BYTE(S)                            19960000
OUTHDR1  EQU   COMMON+00000249     3  BYTE  POINTER ON WORD+1           19970000
INTRL    EQU   COMMON+00000252     1 BYTE(S)                            19980000
INTRL1   EQU   COMMON+00000253     3  BYTE  POINTER ON WORD+1           19990000
OUTTRL   EQU   COMMON+00000256     1 BYTE(S)                            20000000
OUTTRL1  EQU   COMMON+00000257     3  BYTE  POINTER ON WORD+1           20010000
EXITDCB  EQU   COMMON+00000260     1 BYTE(S)                            20020000
EXITDCB1 EQU   COMMON+00000261     3  BYTE  POINTER ON WORD+1           20030000
TOTAL    EQU   COMMON+00000264     1 BYTE(S)                            20040000
TOTAL1   EQU   COMMON+00000265     3  BYTE  POINTER ON WORD+1           20050000
EXLST1   EQU   COMMON+00000268     4 BYTE(S) ON WORD                    20060000
EDCB1    EQU   COMMON+00000268     1 BYTE(S)                            20070000
EDCB2    EQU   COMMON+00000269     3  BYTE  POINTER ON WORD+1           20080000
EXLST2   EQU   COMMON+00000272     4 BYTE(S) ON WORD                    20090000
EDCB3    EQU   COMMON+00000272     1 BYTE(S)                            20100000
EDCB4    EQU   COMMON+00000273     3  BYTE  POINTER ON WORD+1           20110000
EXLST3   EQU   COMMON+00000276     4 BYTE(S) ON WORD                    20120000
EDCB5    EQU   COMMON+00000276     1 BYTE(S)                            20130000
EDCB6    EQU   COMMON+00000277     3  BYTE  POINTER ON WORD+1           20140000
DLRECL   EQU   COMMON+00000280     HALFWORD INTEGER                     20150000
DBLKSI   EQU   COMMON+00000282     HALFWORD INTEGER                     20160000
DRECFM   EQU   COMMON+00000284     8 BIT(S)                             20170000
LEFTOVER EQU   COMMON+00000288     FULLWORD INTEGER                     20180000
OFFSET   EQU   COMMON+00000292     FULLWORD POINTER                     20190000
LPTR     EQU   COMMON+00000296     FULLWORD POINTER                     20200000
DCBPTR   EQU   COMMON+00000300     FULLWORD POINTER                     20210000
DUMMY    EQU   COMMON+00000304     FULLWORD POINTER                     20220000
COMMON1  EQU   00000304            236 BYTE(S) ON WORD                  20230000
SAVEMS   EQU   COMMON1+00000000    HALFWORD INTEGER                     20240000
CONCODE  EQU   COMMON1+00000002    HALFWORD INTEGER                     20250000
OUTREC   EQU   COMMON1+00000004    FULLWORD POINTER                     20260000
CRTABPT  EQU   COMMON1+00000008    FULLWORD POINTER                     20270000
CURCRTE  EQU   COMMON1+00000012    FULLWORD POINTER                     20280000
CURCRGM  EQU   COMMON1+00000016    FULLWORD POINTER                     20290000
CURPIC   EQU   COMMON1+00000020    FULLWORD POINTER                     20300000
PICCTR   EQU   COMMON1+00000024    FULLWORD INTEGER                     20310000
EXITTAB  EQU   COMMON1+00000028    FULLWORD POINTER                     20320000
EXITGM   EQU   COMMON1+00000032    FULLWORD POINTER                     20330000
CUREXIT  EQU   COMMON1+00000036    FULLWORD POINTER                     20340000
DELIM    EQU   COMMON1+00000040    4 BYTE(S)                            20350000
RECREM   EQU   COMMON1+00000044    FULLWORD INTEGER                     20360000
CURFD    EQU   COMMON1+00000048    FULLWORD POINTER                     20370000
CUROUT   EQU   COMMON1+00000052    FULLWORD POINTER                     20380000
SAVE14   EQU   COMMON1+00000056    FULLWORD POINTER                     20390000
GETMLIST EQU   COMMON1+00000060    16 BYTE(S) ON WORD                   20400000
GLENGTH  EQU   COMMON1+00000060    FULLWORD INTEGER                     20410000
ADRLIST  EQU   COMMON1+00000064    FULLWORD POINTER                     20420000
IND      EQU   COMMON1+00000068    4 BYTE(S)                            20430000
GCODE    EQU   COMMON1+00000068    1 BYTE(S)                            20440000
SPOOL    EQU   COMMON1+00000069    1 BYTE(S)                            20450000
CCODE    EQU   COMMON1+00000070    2 BYTE(S)                            20460000
GCADDR   EQU   COMMON1+00000072    FULLWORD POINTER                     20470000
FIRSTGMO EQU   COMMON1+00000076    FULLWORD POINTER                     20480000
CURRGMO  EQU   COMMON1+00000080    FULLWORD POINTER                     20490000
LASTGMO  EQU   COMMON1+00000084    FULLWORD POINTER                     20500000
FIRSTGMI EQU   COMMON1+00000088    FULLWORD POINTER                     20510000
CURRGMI  EQU   COMMON1+00000092    FULLWORD POINTER                     20520000
LASTGMI  EQU   COMMON1+00000096    FULLWORD POINTER                     20530000
CONDCODE EQU   COMMON1+00000100    HALFWORD INTEGER                     20540000
MS       EQU   COMMON1+00000102    HALFWORD INTEGER                     20550000
INBUFA1  EQU   COMMON1+00000104    121 BYTE(S)                          20560000
INFILL   EQU   COMMON1+00000104    10 BYTE(S)                           20570000
INBUFA   EQU   COMMON1+00000114    111 BYTE(S)                          20580000
DDPTR    EQU   COMMON1+00000228    FULLWORD POINTER                     20590000
DUMMY1   EQU   COMMON1+00000232    FULLWORD POINTER                     20600000
COMMON2  EQU   00000536            76 BYTE(S) ON WORD                   20610000
SWITCH   EQU   COMMON2+00000000    52 BYTE(S)                           20620000
FDCSW    EQU   COMMON2+00000000    1 BYTE(S)                            20630000
FDNAMESW EQU   COMMON2+00000001    1 BYTE(S)                            20640000
FDPCSW   EQU   COMMON2+00000002    1 BYTE(S)                            20650000
FDFMTSW  EQU   COMMON2+00000003    1 BYTE(S)                            20660000
FDPLSW   EQU   COMMON2+00000004    1 BYTE(S)                            20670000
RANGESW  EQU   COMMON2+00000005    1 BYTE(S)                            20680000
FILLSW   EQU   COMMON2+00000006    1 BYTE(S)                            20690000
REPSW    EQU   COMMON2+00000007    1 BYTE(S)                            20700000
INDEXSW  EQU   COMMON2+00000008    1 BYTE(S)                            20710000
INDNMSW  EQU   COMMON2+00000009    1 BYTE(S)                            20720000
BQUOTESW EQU   COMMON2+00000010    1 BYTE(S)                            20730000
PQUOTESW EQU   COMMON2+00000011    1 BYTE(S)                            20740000
EQUOTESW EQU   COMMON2+00000012    1 BYTE(S)                            20750000
FDPSW    EQU   COMMON2+00000013    1 BYTE(S)                            20760000
DSDSW    EQU   COMMON2+00000014    1 BYTE(S)                            20770000
NOGOSW   EQU   COMMON2+00000015    1 BYTE(S)                            20780000
CREATESW EQU   COMMON2+00000016    1 BYTE(S)                            20790000
DSDCSW   EQU   COMMON2+00000017    1 BYTE(S)                            20800000
CRCSW    EQU   COMMON2+00000018    1 BYTE(S)                            20810000
EXITSW   EQU   COMMON2+00000019    1 BYTE(S)                            20820000
EODSTOP  EQU   COMMON2+00000020    1 BYTE(S)                            20830000
DSDNULSW EQU   COMMON2+00000021    1 BYTE(S)                            20840000
DSDORGSW EQU   COMMON2+00000022    1 BYTE(S)                            20850000
DSDDDSW  EQU   COMMON2+00000023    1 BYTE(S)                            20860000
CRTBLK   EQU   COMMON2+00000024    1 BYTE(S)                            20870000
NAMCSW   EQU   COMMON2+00000025    8 BIT(S)                             20880000
PICCSW   EQU   COMMON2+00000026    8 BIT(S)                             20890000
BUFPSW   EQU   COMMON2+00000027    1 BYTE(S)                            20900000
ENDSW    EQU   COMMON2+00000028    1 BYTE(S)                            20910000
COMCSW   EQU   COMMON2+00000029    1 BYTE(S)                            20920000
FLAGSW   EQU   COMMON2+00000030    8 BIT(S)                             20930000
PAGESW   EQU   COMMON2+00000031    1 BYTE(S)                            20940000
EPSW     EQU   COMMON2+00000032    1  BYTE  POINTER                     20950000
SYSISW   EQU   COMMON2+00000033    1 BYTE(S)                            20960000
SYSPSW   EQU   COMMON2+00000034    1 BYTE(S)                            20970000
OLDNEWSW EQU   COMMON2+00000035    1 BYTE(S)                            20980000
FLUSHSW  EQU   COMMON2+00000036    1 BYTE(S)                            20990000
FLUSHSW1 EQU   COMMON2+00000037    1 BYTE(S)                            21000000
DSDOSW   EQU   COMMON2+00000038    1 BYTE(S)                            21010000
DSDISW   EQU   COMMON2+00000039    1 BYTE(S)                            21020000
QUANSW   EQU   COMMON2+00000040    1 BYTE(S)                            21030000
PARENSW  EQU   COMMON2+00000041    1 BYTE(S)                            21040000
REPEATSW EQU   COMMON2+00000042    1 BYTE(S)                            21050000
FDPLGTH  EQU   COMMON2+00000052    HALFWORD INTEGER                     21060000
SGCADDR  EQU   COMMON2+00000056    FULLWORD POINTER                     21070000
FDPTR    EQU   COMMON2+00000060    FULLWORD POINTER                     21080000
FDPTR1   EQU   COMMON2+00000064    FULLWORD POINTER                     21090000
FDPTR2   EQU   COMMON2+00000068    FULLWORD POINTER                     21100000
DUMMY2   EQU   COMMON2+00000072    FULLWORD POINTER                     21110000
COMMON3  EQU   00000608            196 BYTE(S) ON WORD                  21120000
FDCTR    EQU   COMMON3+00000000    HALFWORD POINTER                     21130000
LREMAIN  EQU   COMMON3+00000004    FULLWORD POINTER                     21140000
COMPCTR  EQU   COMMON3+00000008    FULLWORD POINTER                     21150000
LMOVED   EQU   COMMON3+00000012    HALFWORD POINTER                     21160000
U        EQU   COMMON3+00000016    FULLWORD POINTER                     21170000
PICEND   EQU   COMMON3+00000020    HALFWORD POINTER                     21180000
CURFDGM  EQU   COMMON3+00000024    FULLWORD POINTER                     21190000
SWTCH    EQU   COMMON3+00000028    4 BYTE(S) ON WORD                    21200000
SYSINSEL EQU   COMMON3+00000028    1 BYTE(S)                            21210000
FIRSTSW  EQU   COMMON3+00000029    1 BYTE(S)                            21220000
FRSTSW   EQU   COMMON3+00000030    1 BYTE(S)                            21230000
STOPSW   EQU   COMMON3+00000031    1 BYTE(S)                            21240000
COPYVAL  EQU   COMMON3+00000032    HALFWORD INTEGER                     21250000
COPYFD   EQU   COMMON3+00000036    FULLWORD POINTER                     21260000
COPYFDGM EQU   COMMON3+00000040    FULLWORD POINTER                     21270000
NAMCTR   EQU   COMMON3+00000044    HALFWORD INTEGER                     21280000
NAMCTR1  EQU   COMMON3+00000046    HALFWORD INTEGER                     21290000
INRECSZ  EQU   COMMON3+00000048    HALFWORD POINTER                     21300000
OUTRECSZ EQU   COMMON3+00000050    HALFWORD POINTER                     21310000
INRECFM  EQU   COMMON3+00000052    1 BYTE(S)                            21320000
RECOFFST EQU   COMMON3+00000053    1  BYTE  POINTER                     21330000
OUTRECFM EQU   COMMON3+00000054    1 BYTE(S)                            21340000
PICBASE  EQU   COMMON3+00000056    FULLWORD POINTER                     21350000
MESSAGE  EQU   COMMON3+00000060    121 BYTE(S)                          21360000
INPUTSW  EQU   COMMON3+00000181    1 BYTE(S)                            21370000
HOLDNAME EQU   COMMON3+00000182    8 BYTE(S)                            21380000
DUMMY3   EQU   COMMON3+00000192    FULLWORD POINTER                     21390000
DCBD     EQU   00000000            280 BYTE(S) ON DWORD                 21400000
FILL     EQU   DCBD+00000000       26 BYTE(S)                           21410000
DSORG1   EQU   DCBD+00000026       2 BYTE(S)                            21420000
DSORG    EQU   DCBD+00000026       8 BIT(S)                             21430000
FILLER   EQU   DCBD+00000028       8 BYTE(S)                            21440000
IOBAD    EQU   DCBD+00000028       4 BYTE(S)                            21450000
BFTEK    EQU   DCBD+00000032       8 BIT(S)                             21460000
EODAD    EQU   DCBD+00000033       3 BYTE(S)                            21470000
RECFM    EQU   DCBD+00000036       8 BIT(S)                             21480000
EXLIST   EQU   DCBD+00000037       3  BYTE  POINTER ON WORD+1           21490000
DDNAME   EQU   DCBD+00000040       8 BYTE(S)                            21500000
DEBAD    EQU   DCBD+00000040       4 BYTE(S)                            21510000
IFLGS    EQU   DCBD+00000040       8 BIT(S)                             21520000
GETAD    EQU   DCBD+00000048       4 BYTE(S)                            21530000
OFLGS    EQU   DCBD+00000048       8 BIT(S)                             21540000
OFLGS1   EQU   DCBD+00000049       1 BYTE(S)                            21550000
MACRF    EQU   DCBD+00000050       2 BYTE(S)                            21560000
FILL2    EQU   DCBD+00000052       10 BYTE(S)                           21570000
BLKSI    EQU   DCBD+00000062       HALFWORD INTEGER                     21580000
FILL3    EQU   DCBD+00000064       18 BYTE(S)                           21590000
LRECL    EQU   DCBD+00000082       HALFWORD INTEGER                     21600000
FILL4    EQU   DCBD+00000084       172 BYTE(S)                          21610000
NEXTDCB  EQU   DCBD+00000256       FULLWORD POINTER                     21620000
DDNAME1  EQU   DCBD+00000260       8 BYTE(S)                            21630000
EODSW    EQU   DCBD+00000268       1 BYTE(S)                            21640000
DCBSW1   EQU   DCBD+00000269       1 BYTE(S)                            21650000
DCBSW2   EQU   DCBD+00000270       1 BYTE(S)                            21660000
DCBSW3   EQU   DCBD+00000271       8 BIT(S)                             21670000
INREC    EQU   DCBD+00000272       FULLWORD POINTER                     21680000
GMLGTH   EQU   DCBD+00000276       HALFWORD INTEGER                     21690000
FIELDSEL EQU   DCBD+00000278       1 BYTE(S)                            21700000
SPARE    EQU   DCBD+00000279       1 BYTE(S)                            21710000
FDTBL    EQU   00000000            520 BYTE(S) ON WORD                  21720000
FDNAME   EQU   FDTBL+00000000      8 BYTE(S)                            21730000
FDREPNM  EQU   FDTBL+00000008      8 BYTE(S)                            21740000
FDINDNM  EQU   FDTBL+00000016      8 BYTE(S) ON WORD                    21750000
FDUMMY   EQU   FDTBL+00000016      4 BYTE(S)                            21760000
FDINDNUM EQU   FDTBL+00000020      FULLWORD POINTER                     21770000
FDLGTH   EQU   FDTBL+00000024      HALFWORD POINTER                     21780000
FDCYCLE  EQU   FDTBL+00000026      HALFWORD POINTER                     21790000
FDACTION EQU   FDTBL+00000028      2 BYTE(S)                            21800000
FDFORMAT EQU   FDTBL+00000030      2 BYTE(S)                            21810000
FDSWITCH EQU   FDTBL+00000032      8 BIT(S)                             21820000
INDBYNAM EQU   FDTBL+00000032      1 BIT(S)                             21830000
PASS     EQU   FDTBL+00000032      1 BIT(S)                             21840000
FXACTION EQU   FDTBL+00000032      1 BIT(S)                             21850000
RPACTION EQU   FDTBL+00000032      1 BIT(S)                             21860000
ROACTION EQU   FDTBL+00000032      1 BIT(S)                             21870000
WVACTION EQU   FDTBL+00000032      1 BIT(S)                             21880000
STACTION EQU   FDTBL+00000032      1 BIT(S)                             21890000
NUACTION EQU   FDTBL+00000032      1 BIT(S)                             21900000
FDFILL   EQU   FDTBL+00000033      1 BYTE(S)                            21910000
FDSIGN   EQU   FDTBL+00000034      1 BYTE(S)                            21920000
FDCHAR   EQU   FDTBL+00000035      1 BYTE(S)                            21930000
FDRANGE  EQU   FDTBL+00000036      4 BYTE(S)                            21940000
FDOBUF   EQU   FDTBL+00000040      HALFWORD POINTER                     21950000
FDFRINC  EQU   FDTBL+00000042      HALFWORD POINTER                     21960000
FDFROMAD EQU   FDTBL+00000044      4 BYTE(S)                            21970000
FDMLGTH  EQU   FDTBL+00000048      HALFWORD POINTER                     21980000
FDTOINC  EQU   FDTBL+00000050      HALFWORD POINTER                     21990000
FDCYCCNT EQU   FDTBL+00000052      HALFWORD POINTER                     22000000
FDSLGTH  EQU   FDTBL+00000054      HALFWORD POINTER                     22010000
FDSLGTHR EQU   FDTBL+00000056      HALFWORD POINTER                     22020000
FDFRINCR EQU   FDTBL+00000058      1 BYTE(S)                            22030000
FDTOINCR EQU   FDTBL+00000059      1 BYTE(S)                            22040000
LTOFREE  EQU   FDTBL+00000060      HALFWORD POINTER                     22050000
FDSW1    EQU   FDTBL+00000062      8 BIT(S)                             22060000
STRTLOC1 EQU   FDTBL+00000062      1 BIT(S)                             22070000
FOXZEROS EQU   *                   16 BYTE(S)                           22080000
         DC    X'F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0'                      22090000
INBUF    EQU   00000000            80 BYTE(S)                           22100000
BUFFER   EQU   00000000            32767 BYTE(S)                        22110000
ON       EQU   *                   1 BYTE(S)                            22120000
         DC    X'FF'                                                    22130000
OFF      EQU   *                   1 BYTE(S)                            22140000
         DC    X'00'                                                    22150000
WKADDR   EQU   00000000            32767 BYTE(S)                        22160000
COPAT    EQU   *                   27 BYTE(S)                           22170000
         DC    C' .<(+|&&!$*);^-/,%_>?:#@''="'                         22180000
ALPAT    EQU   *                   36 BYTE(S)                           22190000
         DC    C'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'                  22200000
OPTIONS  EQU   00000000            256 BYTE(S)                          22210000
PAGE     EQU   00000000            256 BYTE(S)                          22220000
DDLST    EQU   00000000            256 BYTE(S)                          22230000
         ORG   @DATA                                                    22240000
         DS    00000081C                                                22250000
@L       EQU   1                                                        22260000
@DATD    DSECT                                                          22270000
@SAV001  EQU   @DATD+00000000      72 BYTE(S) ON WORD                   22280000
BUFPTR   EQU   @DATD+00000072      FULLWORD POINTER                     22290000
RCODE    EQU   @DATD+00000076      FULLWORD INTEGER                     22300000
OPTPTR   EQU   @DATD+00000080      FULLWORD POINTER                     22310000
PGPTR    EQU   @DATD+00000084      FULLWORD POINTER                     22320000
         DS    00000088C                                                22330000
@TEMPS   DS    0F                                                       22340000
@TEMP4   DC    F'0'                                                     22350000
@DATEND  EQU   *                                                        22360000
IEBFDANL CSECT ,                                                        22370000
@9E9     EQU   F5F31                                                    22380000
@9E3     EQU   F4B5                                                     22390000
@9DF     EQU   F4G11                                                    22400000
@9DA     EQU   F5F4                                                     22410000
@9D8     EQU   @EL02                                                    22420000
         END   IEBFDANL                                                 22430000
