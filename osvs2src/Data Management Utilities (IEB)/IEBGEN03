 TITLE  'IEBGEN03-IEBGENER MAIN PROCESSOR'                        10696 00010014
*********************************************************************** 00020000
*                                                                     * 00040000
*                    * * * I E B G E N 0 3 * * *                      * 00060000
*                         * * * * * * * * *                           * 00080000
*                                                                     * 00100000
*      THIS IS THE PROCESSING MODULE FOR NON-SPANNED DATASETS      UL0H 00120017
*      IT GETS CONTROL AFTER IEBGENR3 HAS OPENED THE INPUT AND     UL0H 00140017
*      OUTPUT DATASETS                                             UL0H 00160017
*      IT CONTROLS LINKAGE TO EDIT AND CONVERSION ROUTINES FOR     UL0H 00180017
*      SPECIAL PROCESSING DICTATED BY IEBGENER CONTROL STATEMEBT   UL0H 00200017
*      IT USES THE BSAM ACCESS METHOD AND DOUBLR BUFFERING         UL0H 00220017
*      AFTER PROCESSING IS COMPLETED IT RETURNS TO IEBGENR3        UL0H 00240017
*                                                                     * 00320000
*                         * * * * * * * * *                           * 00340000
*                                                                     * 00360000
*                             E N T R Y                               * 00380000
*                                                                     * 00400000
*      THE SUBROUTINE HAS ONE EXTERNALLY REFERENCABLE ENTRY POINT     * 00420000
*      WHOSE SYMBOLIC NAME IS:                                        * 00440000
*                             H G E N P                               * 00460000
*                                                                     * 00480000
*                         * * * * * * * * *                           * 00500000
*                                                                     * 00520000
*                             I N P U T                               * 00540000
*                                                                     * 00560000
*      THE SUBROUTINE IS ENTERED WITH OP REGISTER 1  POINTING TO      * 00580000
*      A LIST IN WHICH ARE THE ADDRESSES OF TABLES CONSTRUCTED BY     * 00600000
*      THE I E B G S C A N SUBROUTINE ACCORDING TO THE PARAMETERS     * 00620000
*      SPECIFIED IN THE UTILITY CONTROL CARDS. MAIN  STORAGE  FOR     * 00640000
*      THESE TABLES IS GOTTEN AND RELEASED OUTSIDE THIS ROUTINE.      * 00660000
*                                                                     * 00680000
*********************************************************************** 00700000
         EJECT                                                          00720000
*********************************************************************** 00740000
*                                                                     * 00760000
*                             E X T R N                               * 00780000
*                                                                     * 00800000
*      THE SUBROUTINE REFERENCES THESE EXTERNALLY DEFINED  VALUES     * 00820000
*      OR SUBROUTINE NAMES:                                           * 00840000
*                             H M O V E                               * 00860000
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 00880000
*              TO MOVE RECORDS OF ANY SIZE IN CORE                    * 00900000
*                                                                     * 00920000
*                             H E D I T                               * 00940000
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 00960000
*              TO EXECUTE THE EDITING SPECIFIED BY THE                * 00980000
*              UTILITY CONTROL CARDS.                                 * 01000000
*                                                                     * 01020000
*                              H P R L                                * 01040000
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 01060000
*              TO ESTABLISH THE LENGTH OF AN OUTPUT RE-               * 01080000
*              CORD ACCORDING TO THE EDIT PARAMETERS.                 * 01100000
*                                                                     * 01120000
*                            H W R M S G                              * 01140000
*                                                                     * 01160000
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 01180000
*              TO WRITE MESSAGES ISSUED BY THIS ROUTINE               * 01200000
*              ON THE DEVICE SPECIFIED BY SYSPRINT  DD-               * 01220000
*              NAME.                                                  * 01240000
*                                                                     * 01260000
*                          D D E R R O R 1                            * 01280000
*                                                                     * 01300000
*              A MESSAGE USED AS A DIAGNOSTIC WHEN DATA               * 01320000
*              DEFINITION STATEMENT NAMES ARE IMPROPER-               * 01340000
*              LY SPECIFIED TO THE PROGRAM.                           * 01360000
*                                                                     * 01380000
*********************************************************************** 01400000
         EJECT                                                          01420000
*********************************************************************** 01440000
*                                                                     * 01460000
*                   E R R O R   C O N D I T I O N                     * 01480000
*                                                                     * 01500000
*      THE SUBROUTINE WILL TERMINATE PROCESSING, CAUSE AN APPROP-     * 01520000
*      RIATE DIAGNOSTIC MESSAGE TO BE PRINTED AND RETURN VIA REG-     * 01540000
*      ISTER 14 UPON RECOGNITION OF THE FOLLOWING TYPES OF ERROR:     * 01560000
*                                                                     * 01580000
*              1.PERMANENT I/O ERROR ON EITHER INPUT OR               * 01600000
*                OUTPUT DATA SET.                                     * 01620000
*              2.ANY CONTROL STATEMENT ERROR UNABLE  TO               * 01640000
*                BE DETERMINED AT CONTROL CARD  PROCES-               * 01660000
*                SING TIME,I.E.-PARAMETERS WHICH ARE AT               * 01680000
*                VARIANCE WITH INCOMING DATA.                         * 01700000
*              3.DATA FORMAT ERRORS NOT APPARENT TO THE               * 01720000
*                BSAM ACCESS METHOD.                                  * 01740000
*              4.NO BLKSIZE SPECIFIED FOR EITHER INPUT            10696 01746014
*                OR OUTPUT DATA SET.                              10696 01752014
*                                                                     * 01760000
*                         * * * * * * * * *                           * 01780000
*                                                                     * 01800000
*                             N O T E S                               * 01820000
*                                                                     * 01840000
*      THIS SUBROUTINE IS 'ONLY LOADABLE'.IT IS NOT RE-ENTRANT;IT     * 01860000
*      IS NOT RE-USABLE.                                              * 01880000
*                                                                     * 01900000
*********************************************************************** 01920000
         EJECT                                                          01940000
IEBGEN03 CSECT                                                          01980000
*                                                                A36114 01980121
*047000                                                          A23810 01980218
*102100                                                          F25211 01980418
*135000,139800,167000                                            A22671 01980618
*151910,155200-155270                                            F21533 01980818
* 0219700,021900                                                  M2461 01980918
* 088800                                                         A25958 01981119
* 132800-135800,140800-141800                                    A27717 01981319
* 038000-039200,039800,040000                                    A35449 01981420
* 118600-119000,119600-122000                                    A35448 01981520
*A092750,092907-092942                                           A45131 01982121
*D092750                                                         A45131 01982721
*A046720-047040,047500-047592,147690,169900                      A45145 01983521
*D046730,046760,046800,046880,046960,047040,047120               A45145 01985521
*C047600,147590                                                  A45145 01985921
*A139100,139300-139340,175300                                    A48809 01988621
*C138000,138400                                                  A48809 01990621
*D141100                                                         A48809 01991021
*A037500,062100,063100,063460,063520,641000,65100,082200,        A50939 01991121
*A092400-092670,098250,127460,127520,175330,175360               A50939 01991221
*D064400-064800,082200,092400,092500                             A50939 01991321
*A092911                                                       @ZA03366 01991403
*C092914                                                       @ZA03366 01991503
*D092928                                                       @ZA03366 01991603
*A062966-062990                                                @ZA01743 01991703
*A100220-100280                                                @ZA04424 01992100
*A100292-100296                                                @ZA07363 01992500
*A100100-100200                                                @ZA10940 01992600
*C100300                                                       @ZA10940 01995800
*A100284-100288                                                @ZA13747 01997800
*C047400                                                       @ZA16476 01998299
*A147271,173100                                                @ZA24341 01998700
R0       EQU   0                                                        01999200
R1       EQU   1                                                        02002421
R2       EQU   2                                                        02005621
R3       EQU   3                                                        02008821
R4       EQU   4                                                        02012021
R5       EQU   5                                                        02015221
R6       EQU   6                                                        02018421
R7       EQU   7                                                        02021621
R8       EQU   8                                                        02024821
R9       EQU   9                                                        02028021
R10      EQU   10                                                       02031221
R11      EQU   11                                                       02034421
R12      EQU   12                                                       02037621
R13      EQU   13                                                       02040821
R14      EQU   14                                                       02044021
R15      EQU   15                                                       02047221
HGENP    SAVE  (14,12),T,GEN03                                 @ZA24341 02050400
         LR    2,15                                                     02053621
         USING HGENP,2                                                  02056800
         LA    3,HGENPRS                LOAD WORK AREA ADDRESS          02060000
         ST    3,8(13)                  AND STORE IT                    02080000
         STM   13,14,HSAVE13                                            02100000
         LA    13,HGENPRS                                               02120000
         L     3,0(1)                   LOAD EXIT TABLE ADDRESS         02140000
         ST    3,HEXITTA                STORE EXIT TABLE ADDRESS        02160000
         MVC   HMDTCUR(16),64(3)        STOER SWITCHES             UL0H 02163017
         MVC   HMDTCUR+16(1),93(3)      STORE PO SWITCH            UL0H 02166017
         MVC   HPOID(1),94(3)                                      UL0H 02169017
         MVC   LABPOLAT(8),80(3)       MOVE LABEL POOL ADDRESSES   UL0H 02172017
         MVC   TOTLAREA+12(4),88(R3)   MOVE TOTALING AREA ADDRESS  UL0I 02175018
         MVC   LABPROSW(1),92(3)       MOVE LABEL PROCESSING SWITC UL0H 02178017
         L     12,HDCBINA              LOAD SYSUT1DCB ADDRESS           02185017
         MVC   EODADOFS(3,12),HEODAD+1 MOVE EODAD ROUT.ADD AND          02186017
         MVC   SYNADOFS+1(3,R12),HINERAD+1 PUT SYNAD ADDR IN DCB  M2461 02187018
         L     4,HDCBOUTA              STORE SYNAD ROUT,ADDRESS         02189017
         MVC   SYNADOFS+1(3,R4),HOUERAD+1  PUT SYNAD ADDR IN DCB  M2461 02190018
         ST    4,TOTLAREA+4            STORE DCB ADDRESS IN LIST        02192017
         CLI   0(3),X'40'              TOTALING SPECFIED                02196017
         BE    HGENP5A                 NO-BRANCH                        02200017
         OI    TOTLEXSW,X'80'          SET TOTALING EXIT SWITCH         02204017
         LR    10,3                                                     02208017
         LOAD  EPLOC=(10)              LOAD USER ROUTINE                02212017
         ST    0,ADTOTEXR              STORE ADDRESS                    02216017
HGENP5A  BAL   14,INOUTSET             DATA SET ATTRIBUTES         6598 02970013
*                                                                  7653 02973017
*  GO TO THE MESSAGE WRITER TO SPACE SYSPRINT ONE LINE IN CASE     7653 02976017
*  SYSUT2 AND SYSPRINT ARE THE SAME DATA SET.                      7653 02979017
*                                                                  7653 02982017
         LA    0,1                 INDICATE MSG LENGTH OF 1        7653 02985017
         LA    1,BLANKS            POINT TO BLANKS AS THE MSG      7653 02988017
         L     15,HCDWRA           ADDR OF ENTRY PT TO WTR ROUTINE 7653 02991017
         BAL   14,4(15)            ENTER 4 PAST ENTRY PT TO SKP LA 7653 02994017
         SR    0,0                                                 7653 02997017
         C     0,HKEYLOU                IF KEYS,GET SAVE AREA           03000000
         BE    HINP1                                                    03020000
         L     0,HKEYLOU                LOAD KEY LENGTH                 03040000
         GETMAIN R,LV=(0)               GET CORE TO SAVE KEY            03060000
         ST    1,HKEYA                  STORE CORE ADDR                 03080000
         L     0,HKEYLOU                LOAD KEY LENGTH                 03100000
         BCTR  0,0                      REDUCE KEY LENGTH BY 1          03120000
         STC   0,HGENP6+1               STORE EXACT KEY LNGTH IN XC INS 03140000
HGENP6   XC    0(1,1),0(1)              ZERO OUT KEY AREA               03160000
HINP1    L     5,HIN1AD            PREPARE REGS FOR PROCESSING     3599 03260015
         L     6,HOU2AD            RECORDS BY LOADING BUFFER ADDRS 3599 03360015
HINP1A   ST    6,HOU2AD                 INITIALIZE OUTPUT XR            03480000
         MVC   CPYSWSAV(1),HCOPYSW                                      03500000
         TM    HCOPYSW,X'FF'            EDITING WITH IDENT              03520000
         BO    HINP1A1                                                  03540000
         BM    HINP1A1                                                  03560000
         L     9,HRDTCUR                YES                             03580000
         TM    0(9),X'20'               EDITING THIS RECORD             03600000
         BO    HINP1A1                  YES                             03620000
         OI    HCOPYSW,HCOPYMSK         NO, SET COPY SWITCH             03640000
HINP1A1  BAL   12,HREAD                                                 03660000
         B     HINP3                                                    03680000
HINP2    C     7,HBLIN                  TEST FOR END OF BUFFER          03700000
         BL    HINP6                    IF NOT,GO TO UPDATE XR AND ARS  03720000
HINP3     SR    4,4                                                     03740000
         NI    CHECKINP,X'00'      MARK INP CHECK ISSUED         A50939 03750021
         CHECK HDECBIN                  CHECK SYSUT1                    03760000
         XC    REDANY(1),REDANY        RCD(S) IN SYSUT1 DATASET    6291 03770017
HINP3X   NOP   HEOD                                                     03780017
         L     9,HDECBIN+8        GET SYSUT1 DCB ADDRESS         A35449 03800020
         L     10,HDECBIN+16      GET SYSUT1 IOB ADDRESS         A35449 03820020
         LH    10,14(0,10)        GET RESIDUAL COUNT             A35449 03840020
         LH    9,62(0,9)          GET BLOCKSIZE FROM DCB         A35449 03860020
         SR    9,10               CALCULATE LENGTH LAST BLOCK    A35449 03880020
         TM    HINORG,X'10'  INPUT BLOCKED ?                     A35449 03900021
         BO    SKIPKEYL      YES, IGNORE KEYLENGTH               A35449 03902021
         A     9,HKEYL       ADD  KEYLENGTH                      A35449 03904021
SKIPKEYL ST    9,HBLIN    STORE RECORD LENGTH                    A35449 03906021
         L     10,HDECBIN+8  GET SYSUT1 DCB ADDRESS              A36114 03910021
         TM   36(10),X'80'   IS RECFM VARIABLE                   A36114 03920021
         BNZ   CONTIN        NO                                  A36114 03930021
         L     10,ACINAREA   LOAD ACT INP. BUFFER ADDRESS        A36114 03932021
         LH    10,0(0,10)    LOAD BDW NUMBER OF VAR RECORD       A36114 03934021
         CR    10,9          BDW NUMBER SMALLER TH PH. REC.      A36114 03936021
         BNL   CONTIN        NO                                  A36114 03938021
         ST    10,HBLIN      YES,SAVE TRUE BLKLENGTH             A36114 03938421
CONTIN   EQU   *                                                 A36114 03938821
         TM    HINORG,X'20'             U-TYPE REC?                     03940000
         BZ    HINP3N                   NO                              03960000
         S     9,HKEYL            CALCULATE RECORD LENGTH        A35449 03980020
         STH   9,HRLIN            SAVE THIS LENGTH               A35449 04000020
HINP3N   CALL  HMOVE,(HIN2AD,HIN1AD,HBLIN) MOVE SYSUT1 BUFF1 TO BUFF2   04020000
         L     5,HIN1AD                 SET XR FOR READ                 04040000
         CLI   HKEYLOU+3,X'00'          IS THERE A KEY?                 04060000
         BE    HINP4                    NO                              04080000
         L     10,HKEYLOU               YES                             04100000
         BCTR  10,0                     LOAD                            04120000
         STC   10,HINP3A+1              KEY                             04140000
         L     10,HKEYA                 IN REG10                        04160000
HINP3A   MVC   0(1,10),0(5)             MOVE KEY TO SAVE AREA           04180000
HINP4    BAL   12,HREAD                 READ SYSUT1 INTO BUFF1          04200000
         L     5,HIN2AD                 RESET INPUT XR                  04220000
         LH    7,HRLIN                  RESET INPUT ARS                 04240000
         STH   7,HWK2                                                   04260000
         A     5,HKEYL                  ADD KEY LENGTH TO XR            04280000
         TM    HINORG,X'40'             TEST FOR V                      04300000
         BZ    HINP5                    IF V,                           04320000
         LA    5,4(0,5)                 ADJUST XR FOR COUNT FIELD,      04340000
         MVC   HWK2(2),0(5)             SET ARS TO LENGTH OF FIRST      04360000
         LA    5,4(0,5)                 DISPLACE PAST RECORD COUNT      04380000
HINP4A   LH    7,HWK2                   RECORD AND ADJUST FOR           04400000
         LA    7,4(0,7)                 COUNT FIELD                     04420000
HINP5    A     7,HKEYL                                                  04440000
         B     HINP7A                                                   04460000
HINP6    LR    5,7                                                      04480000
         A     5,HIN2AD                                                 04500000
         TM    HINORG,X'40'             TEST FOR F OR U                 04520000
         BO    HINP7                                                    04540000
         MVC   HWK2(2),HRLIN                                            04560000
         AH    7,HRLIN                  UPDATE ARS FOR U OR F TYPE      04580000
         B     HINP7A                                                   04600000
HINP7    MVC   HWK2(2),0(5)             UPDATE ARS FOR V TYPE           04620000
         LA    5,4(0,5)                 DISPLACE PAST RECORD COUNT      04640000
         AH    7,HWK2                                                   04660000
HINP7A   L     12,HDCBINA              LOAD INPUT DCB ADDRESS           04670017
         CLC   HWK2(2),LRECLINP    LRECL/BLKSI GREATER TH.SPEC.  A45145 04672021
         BH    HINER2              YES,PERM. INP. ERROR          A45145 04704021
         TM    RECFM(12),X'80'     RECFM F OR U ?                A45145 04706021
         BO    TESTFU              YES, SKIP V TEST              A45145 04708021
         CLC   HWK2(2),HH4              IS REC CT LESS THAN 4           04720000
         BL    HINER2              YES--PERM INPUT ERROR       @ZA16476 04740099
TESTFU   CLC   HWK2(2),HH0         LRECL/BLKSIZE ZERO   ?        A45145 04750021
         BE    TESTU               YES, TEST RECFM FOR U         A45145 04752021
         B     HINP7A3             SKIP U TEST                   A45145 04754021
TESTU    TM    HINORG,X'20'        RECFM=U ?                     A45145 04756021
         BNO   HINER2              NO, PERM. INP. ERROR          A45145 04758021
         TM    17(12),X'50'        INPUT DEV. PAPER TAPE ?       A45145 04758421
         BNO   HINER2              NO, PERM. INP. ERROR          A45145 04758821
         B     HINP3               YES, READ NEXT RECORD         A45145 04759221
HINP7A3  TM    HCOPYSW,HCOPYMSK    PREDICT 1ST OUTPUT REC LENGTH A45145 04760021
         BZ    HINP8                    IF COPY,                        04780000
         BAL   12,ANYBODY               SET HRLPRE                      04800000
HINP7B   NOP   HOUP1                                                    04820000
         OI    HINP7B+1,X'F0'           FIRST TIME THROUGH,             04840000
HINP7C   L     8,HKEYLOU                INITIALIZE OUTPUT ARS           04860000
         BAL   12,HMVKEY                MOVE KEY TO OUTPUT              04880000
         A     6,HKEYLOU                ADJUST OUTPUT XR FOR KEY LENGTH 04900000
         TM    HOUORG,X'40'                                             04920000
         BZ    HOUP1                    IF V TYPE,                      04940000
         LA    8,4(0,8)                 ADJUST XR AND ARS               04960000
         MVC   2(2,6),HH0          ZERO THE RECORD BB FIELD        4028 04980015
         LA    6,4(0,6)                                                 05000000
         B     HINP7B                   BEFORE OUTPUT                   05020000
HINP8    NOP   HOUP1                    IF EDIT,GO TO HPRL              05040000
         BAL   12,HPREDLEN              PREDICT LENGTH OF FIRST REC GRP 05060000
         OI    HINP8+1,X'F0'                                            05080000
         B     HINP7B                                                   05100000
HOUP1    BAL   12,ANYBODY               SET HRLPRE                      05120000
         AH    8,HRLPRE                 ADD DATA COUNT TO OUTCOUNT      05140000
         TM    HOUORG,X'40'                                             05160000
         BZ    HOUP1A                   IF V EDIT,                      05180000
         LA    8,4(0,8)                 ADJUST ARS FOR RECORD COUNT FLD 05200000
HOUP1A   TM    HOUORG,X'10'             IF UNBLOCKED OUTPUT,            05220000
HOUP1B   B     HOUP4                                                    05240000
         BZ    HOUP2A                   SKIP OVERFLOW TEST              05260000
         CH    8,HBLOU                  WILL NEXT RECORD OVERFLOW?      05280000
         BH    HOUP2A                   IF SO,WRITE BLOCK               05300000
         TM    HPOID,X'02'              TEST FOR PDS                    05320000
         BZ    HOUP4                                                    05340000
         TM    HSTOWSW,X'FF'            TEST FOR END OF MEMBER          05360000
         BZ    HOUP4                    IF END,WRITE ANYWAY             05380000
HOUP2A   SH    8,HRLPRE                 ADJUST ARS                      05400000
         S     8,HKEYLOU                                                05420000
HOUP2B   L     9,HOU2AD                 MOVE KEY,IF ANY                 05440000
         CLI   HKEYLOU+3,X'00'          IF OUTPUT KEYS,                 05460000
         BE    HOUP2C                   LINK TO USER EXIT               05480000
         L     10,HEXITTA                                               05500000
         LTR   10,10                    IF NO EXIT LIST,                05520000
         BZ    HOUP2K                   SKIP TEST                       05540000
         CLI   48(10),X'40'                                             05560017
         BE    HOUP2K                                                   05580000
         LA    10,48(10)               LOAD ROUTINE NAME LOC.           05600017
         L     11,HOU2AD                LOAD SYSUT2 BUFF2 ADDR          05620000
         L     12,HDCBOUTA             LOAD SYSUT2 DCB ADDRESS          05640017
         LINK  EPLOC=(10),PARAM=((11),(12))                             05660000
         SR    1,1                                                      05680000
         BAL   12,HTSTTRM               TEST FOR TERMINATION REQUEST    05700000
         B     HOUP2K                   NO                              05720000
         LA    1,HMSGTKR                YES,WRITE MESSAGE               05740000
         SLL   1,8                                                      05760000
         LA    4,6                      MESSAGE ID 6                    05780000
HOUP2J   AR    1,4                                                      05800000
         L     15,HWRMSGA                                               05820000
         BALR  14,15                                                    05840000
         B     HTERMU                   TERMINATE                       05860000
HOUP2K   A     9,HKEYLOU                                                05880000
HOUP2C   TM    HOUORG,X'40'             IF V,                           05900000
         BZ    HOUP2E                   ENTER BLOCK LENGTH              05920000
         SH    8,HH4                                                    05940000
         STH   8,HALFWORK          STORE BLKSIZE IN WORKAREA       000G 05950016
         MVC   0(2,9),HALFWORK     MOVE BLKSIZE TO BLOCK LL FIELD  000G 05960016
         B     HOUP3                                                    05980000
HOUP2E   TM    HOUORG,X'80'                                             06000000
         BZ    HOUP2F                                                   06020000
         L     10,HDCBOUTA             MODIFY DCB LENGTH                06040017
         LTR   8,8                                                      06060000
         BC    8,NOWRITE                                                06080000
         STH   8,BLKSI(10)                                              06100000
         B     HOUP3                                                    06120000
HOUP2F   LR    10,8                     STORE U-TYPE LENGTH             06140000
HOUP3    A     8,HKEYLOU                                                06160000
         ST    8,HBLOUAC                STORE ACTUAL BLOCK LENGTH       06180000
HOUP3A   B     HOUP3B                   DO NOT CHECK 1ST TIME THROUGH   06200000
         NI    CHECKOUT,X'00'      MARK OUTP CHECK ISSUED        A50939 06210021
         CHECK HDECBOU                  CHECK SYSUT2                    06220000
HOUP3B   NI    HOUP3A+1,X'0F'           MOVE SYSUT2 BUFF2               06240000
         CALL  HMOVE,(HOU1AD,HOU2AD,HBLOUAC)  TO BUFF1                  06260000
         L     6,HOU1AD                SET XR TO WRITE             UL0H 06262017
         TM    TOTLEXSW,X'80'          TEST TOTALING EXIT          UL0H 06264017
         BZ    HOUP3B2                 NO EXT - BRANCH             UL0H 06266017
         ST    R6,TOTLAREA             POINTTOTAL ROUT. TO BUFFER  UL0I 06268018
         LA    1,TOTLAREA              LOAD ADDRESS OF PARAMETERS  UL0H 06270017
         L     15,ADTOTEXR             LOAD ADDRESS OF USER ROUT.  UL0H 06272017
         BALR  14,15                                               UL0H 06274017
         CH    15,HCONCODE             UPDATE HIGHEST COND.CODE    UL0H 06276017
         BL    HOUP3B1                 IF                          UL0H 06278017
         STH   15,HCONCODE             NESSECARY                   UL0H 06280017
HOUP3B1  CH    15,SIXTEEN              RETRN CODE = SIXTEEN?       UL0H 06282017
         BE    TOTMSG1                 YES-TERMINATE               UL0H 06284017
         CH    15,EIGHT                RETURN CODE=EIGHT?          UL0H 06286017
         BE    TOTMSG2                 YES-GO TO END OF DATA       UL0H 06288017
         CH    15,FOUR                 RETRNCODE=FOUR              UL0H 06290017
         BE    HOUP3B2                 YES-BRANCH                  UL0H 06292017
         B     TOTMSG3                                             UL0H 06294017
HOUP3B2  DS    0H                                                       06296017
         L     1,HDCBOUTA           GET DCB ADDRESS            @ZA01743 06296603
         TM    36(1),X'80'          IS OUTPUT F OR U           @ZA01743 06297203
         BO    *+14                 BRANCH IF YES              @ZA01743 06297803
         CLC   4(2,6),82(1)         IS RDW GREATER THAN LRECL  @ZA01743 06298403
         BH    ERROR                YES ERROR                  @ZA01743 06299003
         WRITE HDECBOU,SF,HDCBOUT,(6),(10) WRITE SYSUT2 FROM BUFF1      06300000
         OI    CHECKOUT,X'F0'      MARK OUTP WRITE ISSUED        A50939 06310021
         L     10,HDCBOUTA             RESTORE DCB BLOCKSIZE            06320017
         MVC   BLKSI(2,10),HBLOU                                        06340000
NOWRITE  TM    HSTOWSW,X'FF'       MUST STOW BE ISSUED ?         A50939 06346021
         BZ    HOUP3F              NO, SKIP CHECK ETC.           A50939 06352021
         L     10,HMDTCUR               LOAD MEMBER TRUE NAME           06360000
         MVC   HSTOWAR(8),2(10)         LOAD MEMBER TRUE NAME           06380000
         XC    HSTOWAR+8(4),HSTOWAR+8   ZERO OUT C BYTE                 06400000
         NI    CHECKOUT,X'00'      MARK OUTP CHECK ISSUED        A50939 06410021
         CHECK HDECBOU                  CHECKS BEFORE STOW              06420000
         LA    4,1                                                      06500017
         NI    CHECKINP,X'00'      MARK INP CHECK ISSUED         A50939 06510021
         CHECK HDECBIN                                                  06520000
HOUP3C   BAL   12,HSTOW                 STOW TRUE NAME                  06540000
         LH    11,0(10)                 LOAD ALIAS COUNT                06560000
         LA    10,10(0,10)              UPDATE MDT XR                   06580000
         LTR   11,11                                                    06600000
         BZ    HOUP3E                                                   06620000
HOUP3D   MVI   HSTOWAR+11,X'80'         SET ALIAS BIT IN C BYTE         06640000
         MVC   HSTOWAR(8),0(10)         LOAD ALIAS                      06660000
         BAL   12,HSTOW                 STOW ALIAS                      06680000
         LA    10,8(0,10)               UPDATE MDT XR                   06700000
         BCT   11,HOUP3D                                                06720000
HOUP3E   ST    10,HMDTCUR               STORE UPDATED MDT ADDRESS       06740000
         NI    HSTOWSW,X'00'            TURN OFF STOW SWITCH            06760000
HOUP3F   NOP   HOUP4F                   SWITCH FOR EOD                  06780000
         L     6,HOU2AD                 RESET OUTPUT XR                 06800000
         BAL   12,HMVKEY                MOVE KEY TO OUTPUT              06820000
         A     6,HKEYLOU                ADJUST FOR KEY                  06840000
         LH    8,HRLPRE                 RESET OUTPUT ARS                06860000
         A     8,HKEYLOU                ADJUST FOR KEY                  06880000
         TM    HOUORG,X'40'                                             06900000
         BZ    HOUP4B                   IF V,                           06920000
         LA    6,4(0,6)                 ADJUST XR                       06940000
         LA    8,4(0,8)                 AND ARS                         06960000
         LA    8,4(0,8)                 ADJUST ARS                      06980000
HOUP4    NI    HOUP1B+1,X'0F'                                           07000000
         TM    HOUORG,X'40'                                             07020000
         BZ    HOUP4B                                                   07040000
HOUP4A   LH    9,HRLPRE                 LET RECORD COUNT                07060000
         LA    9,4(0,9)                 FIELD REFLECT                   07080000
         STH   9,HALFWORK               PLACE LENGTH IN STORAGE         07100000
         MVC   0(2,6),HALFWORK          MOVE LENGTH INTO CT FIELD       07120000
         MVC   2(2,6),HH0          ZERO BLOCK BB FIELD             4028 07140015
         LA    6,4(0,6)                 DISPLACE PAST RECORD COUNT      07160000
HOUP4B   ST    6,HIXOUT                 STORE CURR REC ADDR FOR SYSUT1  07180000
         ST    5,HIXIN                  AND SYSUT2                      07200000
         L     9,HEXITTA                LOAD USER EXIT TABLE ADDR       07220000
         LTR   9,9                      IF NO EXITS,                    07240000
         BZ    HOUP4C                   SKIP TEST                       07260000
         CLI   40(9),X'40'                                              07280017
         BE    HOUP4C                   IF USER DATA EXIT,LINK          07300000
         LA    9,40(9)                 SET UP ADDERSS                   07320017
         L     12,HDCBINA                                               07340017
         LR    11,5                     USER EXIT TABLE                 07360000
         LINK  EPLOC=(9),PARAM=((11),(12))                              07380000
         SR    1,1                                                      07400000
         BAL   12,HTSTTRM               TEST FOR TERMINATION REQ        07420000
         B     HOUP4C                   NO                              07440000
         LA    1,HMSGTDR                YES                             07460000
         SLL   1,8                                                      07480000
         LA    4,7                      MESSAGE ID 7                    07500000
         B     HOUP2J                   WRITE MESSAGE AND TERMINATE     07520000
HOUP4C   TM    HCOPYSW,HCOPYMSK         TEST COPY SWITCH                07540000
         BZ    HOUP4D                                                   07560000
HOUP4M   BAL   12,HRIDTST                                               07580000
         MVC   HWK4+2(2),HRLPRE                                         07600000
         CALL  HMOVE,(HIXOUT,HIXIN,HWK4) SYSUT1 BUFF2 TO SYSUT2 BUFF2   07620000
         B     HOUP4E                                                   07640000
HOUP4D   BAL   12,HRIDTST               MOVE REC WITH EDITING           07660000
         MVC   HWK2(2),HRLPRE           HWK2=DATA COUNT                 07680000
HOUP4X   CALL  HEDIT,(HEDCUR,HIXOUT,HIXIN,HWK2,HLITTA)                  07700000
         B     HOUP4E                   NORMAL RETURN FROM EDITOR       07720000
         B     HPREDLN2                 ERROR RETURN FROM EDITOR        07740000
HOUP4E   AH    6,HRLPRE                 UPDATE XR                       07760000
HOUP4F   TM    HEODSW,HEODMSK           IF PROCESSING TO END AT EOD,    07780000
         BO    HOUP5A                   OMIT LAST RECORD CHECK          07800000
         CLI   HRIDSW,X'FF'             TEST FOR LAST REC OF GROUP      07820000
         BE    HOUP5B                                                   07840000
HOUP5A   NOP   HOUP9              GO CLOSE AT EOD                  7342 07860000
         B     HINP2                                                    07880000
HOUP5B   L     9,HRDTCUR                                                07900000
         ST    9,HRDTSAV                                                07920000
         TM    HPOID,X'02'              PDS?                            07940000
         BZ    HOUP5D                   NO                              07960000
         TM    HMEMBYT(9),X'0F'         END OF MEMBER?                  07980000
         BZ    HOUP5F                   NO                              08000000
         OI    HSTOWSW,X'FF'            SET STOW SWITCH                 08020000
HOUP5D   TM    0(9),X'9F'               IF PDS,IS LAST CNTRL            08040000
         BNO   HOUP5D1                 CARD A MEMBER CARD          7653 08070017
         OI    HEODSW,HEODMSK           YES, PROCESS TO EOD             08100000
         B     HINP2                                                    08120000
HOUP5D1  TM    0(9),X'8F'               SET UP                          08140000
         BZ    HOUP5F                   FOR                             08160000
         BM    HOUP5F                   END OF                          08180000
         OI    HEODSW,HEODMSK           DATA ROUTINES                   08200000
HOUP5E   NOP   HOUP9               SWITCH FOR LAST RECORD        A50939 08220021
         OI    HOUP5E+1,X'F0'                                           08240000
         OI    TYPMSG,X'30'        SET LAST RECORD ID MSG SW       7653 08320017
         SR    4,4                                                      08370017
         B     HEOD                                                     08420000
HOUP5F   LA    9,12(0,9)                UPDATE RDT XR                   08440000
         ST    9,HRDTCUR                AND STORE                       08460000
         CLI   CPYSWSAV,X'00'           EDITING WITH IDENT              08480000
         BNE   HOUP5F1                  NO                              08500000
         B     HOUP5F2                  YES, CHECK LAST RECORD          08520000
HOUP5F1  TM    HCOPYSW,HCOPYMSK         EDITING                         08540000
         BO    HINP2                    NO                              08560000
         B     HOUP5G                                                   08580000
HOUP5F2  L     9,HRDTSAV                CHECK LAST RECORD               08600000
         TM    0(9),X'4F'               LAST IDENT                      08620000
         BZ    HOUP5F3                                                  08640000
         BM    HOUP5F3                                                  08660000
         L     9,HEDCUR                 YES                             08680000
HCHKFLD  TM    0(9),X'80'               LAST FIELD THIS RECORD          08700000
         BO    HLSTFLD                  YES                             08720000
         LA    9,8(0,9)                 NO, INCREMENT IX                08740000
         B     HCHKFLD                  CHECK AGAIN                     08760000
HLSTFLD  TM    0(9),X'81'               LAST RECORD FIELD               08780000
         BM    HCPYREV                  NO                              08800000
RAUNCH   OI    HEODSW,HEODMSK           YES,SET TO PROCESS EOD          08820000
         B     HOUP5E                   DO LAST WRITE                   08840000
HCPYREV  MVI   CPYSWSAV,X'FF'           RESET SWITCHES                  08860000
         OI    HEODSW,HEODMSK           PROCESS TO EOD                  08900000
         B     HOUP5G                                                   08920000
HOUP5F3  L     9,HRDTCUR                GET NEXT RECORD                 08940000
         TM    0(9),X'20'               EDITING                         08960000
         BO    HRESET1                  YES                             08980000
         OI    HCOPYSW,HCOPYMSK         NO,SET COPY SWITCH              09000000
         B     HRESET2                                                  09020000
HRESET1  MVI   HCOPYSW,X'00'            SET FOR EDITING                 09040000
HRESET2  L     9,HRDTSAV                GET LAST RECORD                 09060000
         TM    0(9),X'20'               WAS THERE EDITING               09080000
         BO    HOUP5G                   YES                             09100000
         L     9,HRDTCUR                RELOAD RDT IX                   09120000
         B     HINP2                    NO, CONTINUE                    09140000
HOUP5G   MVC   HEDCUR(4),HEDSV          GET NEXT EDT                    09160000
         L     9,HRDTCUR                RELOAD RDT IX                   09180000
         BAL   12,HPREDLEN                                              09200000
         B     HINP2                                                    09220000
HOUP9    TM    CHECKINP,X'F0'      MUST CHECK BE ISS. FOR INP ?  A50939 09240021
         BNO   CHKOUT              NO, SKIP INP CHECK            A50939 09243021
         NI    CHECKINP,X'00'      MARK INP CHECK ISSUED         A50939 09246021
         LH    4,THREE             SET R4=3, TO MARK RETURN PNT  A50939 09249021
         CHECK HDECBIN             CHECK LAST READ               A50939 09252021
CHKOUT   TM    CHECKOUT,X'F0'      MUST CHECK BE ISS. FOR OUTP ? A50939 09255021
         BNO   FRMAIN              NO, SKIP OUTP CHECK           A50939 09258021
         NI    CHECKOUT,X'00'      MARK OUTP CHECK ISSUED        A50939 09261021
         CHECK HDECBOU             CHECK LAST WRITE              A50939 09264021
FRMAIN   L     0,REGSAV            LOAD LGTH OF INP + OUTP BUFF. A50939 09267021
         LTR   0,0                 WAS BUFFER CORE GOTTEN          3599 09270015
         BZ    TSTKEYFR           IF NOT, TEST FOR KEY FREEMAIN  A45131 09275021
         XC    REGSAV(4),REGSAV    CLEAR REGSAV                    3599 09280015
         L     1,HIN1AD              BUFFER CORE ADDRESS FOR FREEMA3599 09285015
       FREEMAIN R,LV=(0),A=(1)                                     3599 09290015
TSTKEYFR L     R10,HKEYLOU        LOAD KEY LENGTH                A45131 09290721
         L     1,HKEYA            LOAD KEYSAVE ADDRESS         @ZA03366 09291103
         LTR   R1,R1              KEY PRESENT ?                @ZA03366 09291403
         BZ    DONTFREE           NO, RETURN TO GENR3            A45131 09292121
         LR    R0,R10             LOAD KEY LENGTH IN REG 0       A45131 09293521
         FREEMAIN R,LV=(0),A=(1)  FREEMAIN KEY SAVE AREA         A45131 09294221
DONTFREE CLI   HTERMSW,X'FE'       USER TERMINATION REQUEST        3599 09295015
         BNE   HOUP10                   NO,RETURN                       09300000
         B     HGENP4A                  YES,TERMINATE                   09320000
HOUP10   TM    TYPMSG,X'30'        TEST FOR EOD MSG NEEDED         7653 09327017
         BNM   HLSTID              GO TEST FOR LAST ID IF          7653 09334017
         LA    1,HMSGPEOD              PROCESSING END AT EOD MSG   7653 09341017
HLSTMSG  SLL   1,8                                                 7653 09348017
         L     6,AST                                               7653 09355017
         L     15,HWRMSGA                                          7653 09362017
         BALR  14,15                                               7653 09369017
CLOSAFTR LM    13,14,HSAVE13                                            09380000
         LH    15,HCONCODE              LOAD CONDITION CODE IN REG15    09400000
         RETURN (2,12)                                                  09420000
HLSTID   BNO   CLOSAFTR            GO BACK IF NO MSG NEEDED        7653 09425017
         LA    1,HMSGPELR          PROCESSING END AT LAST ID MSG   7653 09430017
         B     HLSTMSG                                             7653 09435017
*                                                                       09440000
HMVKEY   CALL  HMOVE,(HOU2AD,HKEYA,HKEYLOU)                             09460000
         BR    12                                                       09480000
*                                                                       09500000
HSTOW    L     1,HDCBOUTA                                               09510017
         STOW  (1),HSTOWAR,A                                            09520017
         SLL   15,20                                                    09540000
         SRL   15,20                                                    09560000
         LTR   15,15                    TEST FOR ERROR                  09580000
         BCR   8,12                     NO,RETURN                       09600000
         LA    15,12                    YES,CONCODE 12                  09620000
         STH   15,HCONCODE              SAVE ERROR CONCODE              09640000
         LA    1,HMSGERS                WRITE MESSAGE                   09660000
         SLL   1,8                      AND TERMINATE                   09680000
         LA    4,10               MESSAGE ID FOR STOW ERROR        6598 09700013
HSTOW3   AR    1,4                                                      09720000
         L     15,HWRMSGA                                               09740000
         BALR  14,15                                                    09760000
         B     HOUP9                                                    09780000
*                                                                       09800000
HREAD    READ  HDECBIN,SF,HDCBIN,(5),'S'                                09820000
         OI    CHECKINP,X'F0'      MARK INP READ ISSUED          A50939 09825021
         ST    5,ACINAREA    SAVE ACTUAL INP BUFFER ADDRESS      A36114 09830021
         BR    12                                                       09840000
*                                                                       09860000
HPREDLEN CALL  HPRL,(TOTEDIT,HEDCUR,HEDSV)                              09880000
ANYBODY  TM    HCOPYSW,HCOPYMSK         IS EDIT REQUESTED               09900000
         BO    NOEDIT                   NO                              09920000
         CLC   TOTEDIT(2),HRLOU         YES-DOES EDIT EXCEED OUTLRECL   09940000
         BH    HPREDLN2                 YES--INVALID,TERMINATE          09960000
         TM    HOUORG,X'80'             NO-IS OUTPUT FIXED FORMAT       09980000
         BO    HABLE                    YES                             10000000
         TM    HOUORG,X'20'        NO RECFM=U                  @ZA10940 10010000
         BO    RECFMU              YES                         @ZA10940 10020000
         LH    R9,TOTEDIT          NO--GET EDIT COUNT          @ZA04424 10022000
         AH    R9,HH4              ADJUST FOR RDW              @ZA04424 10024000
         CH    R9,HRLOU            DOES EDIT EXCEED RECORD CNT @ZA04424 10026000
         BH    HPREDLN2            YES--INVALID,TERMINATE      @ZA04424 10028000
         TM    HINORG,X'40'        IS INPUT V OR VB ?          @ZA13747 10028400
         BNO   RECFMU              NO, BRANCH                  @ZA13747 10028800
         TM    HOUORG,X'40'        YES, IS OUTPUT V OR VB ?    @ZA07363 10029200
         BO    AROUND              YES GO TO PREPARE COUNT     @ZA07363 10029600
RECFMU   LH    9,TOTEDIT           NO,EDIT COUNT BECOMES LRECL @ZA10940 10030000
         B     COMMON              GO STORE LRECL AND RETURN       3599 10060015
NOEDIT   TM    HOUORG,X'40'        IS OUTPUT RECFM VARIABLE FORMAT 3599 10090015
         BO    AROUND              TES, GO PREPARE COUNT           3599 10120015
         TM    HOUORG,X'80'        IS OUTPUT FIXED FORMAT          3599 10150015
         BO    HABLE               YES, GO GET LRECL               3599 10180015
         B     AROUND                  FORMAT IS U               F25211 10210018
COMMON   STH   9,HRLPRE            DATA COUNT TO HRLPRE            3599 10240015
         BR    12                  RETURN TO CALLER                3599 10270015
AROUND   LH    9,HWK2              RECORD COUNT                    3599 10300015
         TM    HINORG,X'40'        IS INPUT RECFM V OR VB          3599 10330015
         BC    14,COMMON           IF NOT, BRANCH                  3599 10360015
         SH    9,HH4               IF INPUT IS V, ADJUST LRECL     3599 10390015
         B     COMMON              GO STORE RECORD COUNT AND RETURN3599 10420015
HABLE    LH    9,HRLOU             OUTPUT LRECL BECOMES COUNT      3599 10450015
         B     COMMON              GO STORE COUNT AND RETURN       3599 10480015
         BR    12                       RETURN                          10540000
HPREDLN2 LA    15,12                    LOAD CONCODE 12 IN REG15        10560000
         STH   15,HCONCODE              AND STORE                       10580000
         LA    1,HMSGECC                WRITE MESSAGE AND TERMINATE     10600000
         SLL   1,8                                                      10620000
         LA    4,3                                                      10640017
         B     HSTOW3                                                   10660000
*                                                                       10680000
HRIDTST  TM    HEODSW,HEODMSK           TEST FOR LAST REC OF GROUP      10700000
         BCR   1,12                     CHECK                           10720000
         NI    HRIDSW,X'00'                                             10740000
         L     9,HRDTCUR                FOR                             10760000
         LH    10,HRIDL(9)              IDENT FIELD                     10780000
         BCTR  10,0                     IN RECORDS                      10800000
         STC   10,HRIDTST2+1                                            10820000
         LH    11,HRIDST(9)                                             10840000
         AR    11,5                                                     10860000
HRIDTST2 CLC   HRID(1,9),0(11)                                          10880000
         BCR   7,12                                                     10900000
         OI    HRIDSW,X'FF'                                             10920000
         BR    12                                                       10940000
*                                                                       10960000
HTERMU   LH    15,HCONCODE                                              10980000
         B     HOUP9                                                    11000000
*                                                                       11020000
*    THIS SUBROUTINE CHECKS CONDITION CODES TO DETERMINE WHICH CODE     11040000
*    WILL BE PASSED BACK TO THE CALLING PROGRAM.                        11060000
*                                                                       11080000
HTSTTRM  SLL   15,20                    TEST FOR 16 IN R15              11100000
         SRL   15,20                                                    11120000
         LTR   1,1                                                      11140000
         BZ    HTSTTRM4                                                 11160000
         LA    0,16                                                     11180000
         CR    0,15                                                     11200000
         BNE   HTSTTRM2                                                 11220000
HTSTTRM1 LA    12,4(0,12)                                               11240000
         LTR   1,1                                                      11260000
         BZ    HTSTTRM2                                                 11280000
         BR    12                                                       11300000
HTSTTRM2 SRL   15,2                     ROUND DOWN                      11320000
         SLL   15,2                                                     11340000
         LH    R0,HCONCODE                                              11379221
         CR    0,15                     IF OLD CONCODE IS HIGH          11380000
         BCR   10,12                    OR EQUAL,RETURN                 11400000
         LA    0,16                                                     11420000
         CR    15,0                                                     11440000
         BNH   HTSTTRM3                                                 11460000
         LR    15,0                                                     11480000
HTSTTRM3 STH   15,HCONCODE              OTHERWISE STORE NEW CONCODE     11500000
         BR    12                       BEFORE RETURNING                11520000
HTSTTRM4 LA    0,12                                                     11540000
         CR    0,15                                                     11560000
         BH    HTSTTRM2                                                 11580017
         B     HTSTTRM1                                                 11600000
*                                                                       11620000
TOTMSG1  LA    1,30                    LOAD MESSAGE ID .           UL0H 11640017
         BAL   14,TOTMSG4              LINK TO WRITE ROUTINE       UL0H 11660017
         B     HTERMU                  BRANCH TO TERMINATE         UL0H 11680017
TOTMSG2  LA    1,31                    LOAD MESSAGE ID.            UL0H 11700017
         BAL   14,TOTMSG4              LINK TO WRITE ROUTINE       UL0H 11720017
         B     HOUP9                   BRANCH TO END OF PROCESSING UL0I 11740018
TOTMSG3  LA    1,32                    LOAD MESSAGE ID.            UL0H 11760017
         BAL   14,TOTMSG4              LINK TO WRITE ROUTINE       UL0H 11780017
         NI    TOTLEXSW,X'7F'                                      UL0H 11800017
         B     HOUP3B2                 CONTINUE                    UL0H 11820017
TOTMSG4  STM   14,15,R14SAVE           SAVE REG 14 & 15            UL0H 11840017
         LR    R15,R1             ***                            A35448 11860020
         SLL   R1,8               * CALCULATE MESSAGE ID         A35448 11880020
         AR    R1,R15             ***                            A35448 11900020
         L     15,HWRMSGA              LOAD WRITER ROUTINE ADDRESS UL0H 11920017
         BALR  14,15                   LINK                        UL0H 11940017
         L     R15,R14SAVE+4      GET RETURN CODE OF TOT ROUT.   A35448 11960020
         SR    R14,R14            ***                            A35448 11980020
         LA    R1,10              * CALCULATE ALPHA NUMERIC      A35448 12000020
         DR    R14,R1             *     EQUVALENT AND            A35448 12020020
         LA    R14,240(0,R14)     *    UPDATE MESSAGE TEXT       A35448 12040020
         LA    R15,240(0,R15)     *                              A35448 12060020
         L     R1,VADDR3          *                              A35448 12080020
         STC   R14,22(R1)         *                              A35448 12100020
         STC   R15,21(R1)         ***                            A35448 12120020
         LA    R1,25              ***                            A35448 12140020
         SLL   R1,8               * CALCULATE MEESAGE ID         A35448 12160020
         LA    R1,25(0,R1)        ***                            A35448 12180020
         L     R15,HWRMSGA             LOAD ADDRESS OF MSG WRITER  UL0I 12210018
         BALR  14,15                   LINK                        UL0H 12220017
         LM    14,15,R14SAVE           RESTORE REG 14 & 15         UL0H 12240017
         BR    14                      RETURN                      UL0H 12260017
HGENP4A  LA    1,HMSGTLR                                                12280017
         SLL   1,8                                                      12300017
         LA    4,5                                                      12320017
ERRORPNT AR    1,4                                                      12340017
         L     15,HWRMSGA                                               12360017
         BALR  14,15                                                    12380017
         B     HTERMU                                                   12400017
*                                                                       12720000
HEOD     OI    HINP3X+1,X'F0'           SET UP                          12740000
         CH    4,THREE             FINAL CHECK ?                 A50939 12746021
         BE    CHKOUT              YES, RETURN                   A50939 12752021
         LTR   4,4                      END OF DATA                     12760000
         BP    HOUP3C                   PROCESSING SWITCHES             12780000
         OI    HOUP3F+1,X'F0'                                           12800017
         OI    HOUP5A+1,X'F0'                                           12820000
         TM    HOUP5E+1,X'F0'           DO NOT WRITE EOD MESS IF LAST   12840000
         BO    HEODA                    REC ID MESS ALREADY WRITTEN     12860000
         NI    HRIDSW,X'00'                                             12880017
         ST    6,SIXSV                                                  12900000
         OI    TYPMSG,X'10'        SET SW FOR EOD MSG              7653 12910017
         CLI   REDANY,X'FF'            ANY RCDS IN SYSUT1 DATASET  6291 12920017
         BE    HOUP9                   NO, GO CLOSE DATASETS       6291 12930017
HEODA    S     8,HKEYLOU                END OF DATA                     13080000
         TM    HPOID,X'02'              ROUTINE FOR                     13100000
         BZ    HEOD1                    PDS                             13120000
         OI    HSTOWSW,X'FF'                                            13140000
HEOD1    TM    HOUORG,X'40'             END OF DATA                     13160000
         BZ    HEOD2                    FOR VARIABLE                    13180000
         AH    8,HH4                                                    13200000
HEOD2    B     HOUP2B                                                   13220000
*                                                                       13240000
HINER    EQU   *                        INPUT SYNAD ROUTINE             13260000
         ST    R10,SYNADSAV            SAVE REG 10               A22671 13264018
         STM   R3,R4,SYNADSAV+4        SAVE REGS 3AND4           A22671 13268018
         ST    R12,SYNADSAV+12         SAVE REG 12               A22671 13272018
         ST    R14,HSAVE14             SAVE REG14                A22671 13276018
         BAL   R14,SYNADAFR            LINK TO SYNADAF ROUTINE   A27717 13376019
         B     HOUER1                  TEST USER ERROR EXIT      A27717 13476019
HINER2   LA    15,12                    LOAD CONCODE 12 IN REG 15       13600000
         STH   15,HCONCODE              AND STORE                       13620000
         LA    1,HMSGUIE                WRITE ERROR MSG AND TERMINATE   13640000
         SLL   1,8                                                      13660000
         LA    4,8                      MESSAGE ID 8                    13680000
         B     HSTOW3                                                   13700000
HINER3   LA    R15,12                  LOAD CON CODE 12 IN REG 15A27717 13705019
         STH   R15,HCONCODE            AND STORE                 A27717 13710019
         B     HOUP9                                             A27717 13715019
*                                                                       13720000
HOUER    EQU   *                        OUTPUT SYNAD ROUTINE            13740000
         ST    R10,SYNADSAV            SAVE REG 10               A22671 13740618
         STM   R3,R4,SYNADSAV+4        SAVE REGS 3AND4           A22671 13741218
         ST    R12,SYNADSAV+12         SAVE REG 12               A22671 13741818
         ST    R14,HSAVE14             SAVE REG14                A22671 13742418
         BAL   R14,SYNADAFR            LINK TO SYNADAF ROUTINE   A27717 13742719
         TM    TOTLEXSW,X'80'          TOTALING EXIT ACTIVE        UL0I 13743018
         BZ    HOUER1                  NO - BRANCH                 UL0I 13746018
         ST    R0,TOTLAREA+8           STORE STATUS INFO ADDRESS   UL0I 13749018
         MVI   TOTLAREA+8,X'80'         SET FLAG BYTE              UL0I 13752018
         STM   R0,R1,SAVER01           SAVE REGS 0 AND 1           UL0I 13755018
         LA    R1,TOTLAREA             PARM LIST FOR TOTALING      UL0I 13758018
         L     R15,ADTOTEXR            LOAD ROUTINE ADDRESS AND    UL0I 13761018
         BALR  R14,R15                 LINK                        UL0I 13764018
         LM    R0,R1,SAVER01           RESTORE REGISTERS           UL0I 13767018
HOUER1   L     R10,HEXITTA             EXIT LIST                   UL0I 13770018
         LTR   10,10                                                    13780000
         BZ    HINER3A            NO EXIT LIST                   A48809 13800021
         CLI   56(10),X'40'            TEST FOR USER EXIT               13820017
         BE    HINER3A            NO EXIT, END PROCESSING        A48809 13840021
         LA    10,56(10)               YES-LINK TO USER                 13860021
         LR    4,0                                                      13880000
         LR    3,1                                                      13900000
         OI    IOERREXI,X'F0'     SET IOERREXI  BYTE             A48809 13910021
         LINK  EPLOC=(10),PARAM=((4),(3))                               13920000
HINER3A  SYNADRLS                 FRMAIN WORKAR AND REST REG 13  A48809 13930021
         TM    IOERREXI,X'F0'     USER EXIT ?                    A48809 13932021
         BNO   HINER3             NO, END PROCESSING             A48809 13934021
         SR    1,1                                                      13940000
         BAL   12,HTSTTRM               TEST TERMINATION REQUEST        13960000
         B     RETFSYN                 RETURN TO SYSTEM          A22671 13980018
         LA    1,HMSGTER                WRITE ERROR MSG AND TERMINATE   14000000
         SLL   1,8                                                      14020000
         LA    4,12                                                     14040017
         B     HOUP2J                                                   14060000
SYNADAFR STM   R14,R1,SAVER141          SAVE SYNAD PARAMETERS    A27717 14070019
         SYNADAF  ACSMETH=BSAM                                   A27717 14080019
SYNAFR1  L     R10,SYNADMSA            LOAD ADDRESS OF MSG       A27717 14090019
         MVC   10(79,R10),49(R1)       MOVE SYNAD INFO TO MSG    A27717 14100019
         LA    R1,50                   LOAD MSG OFFSET           A27717 14120019
         SLL   R1,8                                              A27717 14130019
         LA    R1,51(R1)               ADD MSG ID                A27717 14140019
         L     R15,HWRMSGA             LOAD WRITER ADDRESS       A27717 14150019
         BALR  R14,R15                 LINK TO WRITER            A27717 14160019
         LM    R14,R1,SAVER141         RESTORE SYNAD PARAMETRS   A27717 14170019
         BR    R14                     RETURN                    A27717 14180019
*                                                                A27717 14190019
SAVER141 DS    4F                                                A27717 14200019
SYNADMSA DC    V(SYNADMSG)                                       A27717 14210019
*                                                                A27717 14220019
* THIS ROUTINE RETURNS CONTROL TO THE SYSTEM IF THE USERS EXIT   A22671 14230018
* ACCEPTS THE BAD RECORD , AND RETURNS A RETURN CODE OF LESS     A22671 14280018
* THAN TWELVE                                                    A22671 14330018
RETFSYN  L     R10,SYNADSAV            RESTORE REG10             A22671 14380018
         LM    R3,R4,SYNADSAV+4        RESTORE REGS 3 AND 4      A22671 14430018
         L     R12,SYNADSAV+12         RESTORE REG12             A22671 14480018
         L     R14,HSAVE14             RESTORE REG 14            A22671 14530018
         RETURN  ,                                               A22671 14580018
*                                                                       14680000
INOUTSET L     3,HEXITTA                EXIT LIST                  6598 14687013
         CLI   48(3),X'40'             TEST FOR KEY EXIT                14694017
         BZ    TSTDEV2                  NO KEY EXIT                6598 14701013
         OI    KEYOUTSW,X'01'           TURN ON KEY EXIT           6598 14708013
TSTDEV2  SR    4,4                 SET UP TO DETERMINE             4028 14709015
         SR    5,5                     BUFFER LENGTH               4028 14710015
         L     12,HDCBOUTA                                         UL0H 14710617
         TM    17(12),X'20'            IS UT2 DEVICE=DA            UL0H 14711217
         BZ    TSTDEV1             IF NOT, BRANCH                  4028 14712015
         IC    5,16(12)                GET KEYLENGTH FOR OUTPUT         14713017
         STC   5,HKEYLOU+3         SAVE THE OUTPUT KEYLENGTH       4028 14714015
         OI    KEYOUTSW,X'02'       SET UT2 EQUALS DA SWITCH       4028 14715015
TSTDEV1  AH    5,62(12)                ADD OUTPUT BLKSI TO KEYLEN  UL0H 14715717
         L     12,HDCBINA                                          UL0H 14716417
         TM    17(12),X'20'            IS UT1 DEVICE=DA            UL0H 14717117
         BZ    NOINKEY             IF NOT, BRANCH                  4028 14718015
         IC    4,16(12)                GET KEYLENGTH FOR INPUT     UL0H 14719017
         STC   4,HKEYL+3           SAVE THE INPUT KEYLENGTH        4028 14720015
         OI    KEYOUTSW,X'04'      SET UT1 EQUALS DA SWITCH        4028 14721015
NOINKEY  AH    4,62(12)                ADD INP BLKSI TO KEYLEN     UL0H 14721817
         STH   4,24(12)                STORE INPUT BUFF LEN IN DCB UL0H 14722617
         L     12,HDCBOUTA                                         UL0H 14723417
         STH   5,24(12)                STORE OTPUT BUFF LEN IN DCB      14724217
         LR    0,4                COMPUTE TOTAL BUFFER SPACE NEEDED4028 14725017
         AR    0,5                 BY ADDING INPUT AND OUTPUT BUFFE4028 14726015
         SLL   0,1                 LENGTHS AND SHIFTING ONE TO MULT4028 14727015
         AH    0,HH2000            ADD 2000 BYTES              @ZA24341 14727599
         ST    0,REGSAV            BY 2 FOR DOUBLE BUFFS.          4028 14728015
*                                                                  4028 14729015
*        SAVE LENGTH OF GET MAIN IN REGSAV FOR THE FREEMAIN LATER  4028 14730015
*                                                                  4028 14731015
       GETMAIN R,LV=(0)                                            4028 14732015
         ST    1,HIN1AD            INPUT BUFF 1 ADDR               4028 14733015
         AR    1,4                 ADD IN BUFL FOR INPUT BUFF 2 ADD4028 14734015
         ST    1,HIN2AD            SAVE INPUT BUFF 2 ADDR          4028 14735015
         AR    1,4                 ADD IN BUFL FOR OUTPUT BUFF 1 AD4028 14736015
         ST    1,HOU1AD            SAVE OUTPUT BUFF1 ADDR          4028 14737015
         AR    1,5                 ADD OUTPUT BUFL FOR OUTPUT FUFF 4028 14738015
         ST    1,HOU2AD              2  ADDR AND SAVE IT.          4028 14739015
OMPREREC L      4,HDCBINA               ADDR OF SYSUT1 DCB              14749017
         L     5,HDCBOUTA              ADDR OF SYSUT2 DCB        A45145 14759021
         MVC   LRECLINP(2),LRECL(R4)   SAVE INPUT LRECL(BLKSI)   A45145 14769021
         MVC   HINORG(1),RECFM(4)       MOVE SYSUT1 RECFM          6598 14771013
         MVC   HOUORG(1),RECFM(5)       MOVE SYSUT2 RECFM          6598 14778013
         NI    HINORG,X'D0'            LEAVE ATTRIBUTES            6598 14785013
         NI    HOUORG,X'D0'            LEAVE ON ATTRIBUTES         6598 14792013
         CLC   HINORG(1),HOUORG         COMPARE RECFM'S            6598 14799013
         BNE   CMPREBLK                 RECFM'S NOT EQUAL          6598 14806013
         OI    KEYOUTSW,X'08'           TURN ON EQUAL RECFM BIT    6598 14813013
CMPREBLK CLC   BLKSI(2,4),BLKSI(5)      COMPARE B1KSIZES           6598 14820013
         BNE   TSTKEYL                  BLKSIZE NOT EQUAL          6598 14827013
         OI    KEYOUTSW,X'10'           TURN ON EQUAL BLKSIZE BIT  6598 14834013
TSTKEYL  TM    KEYOUTSW,X'06'           TST IF UT1 AND UT2 DA      6598 14841013
         BC    12,KEYUT2          UT1 AND UT2 NIT BOTH DA          6598 14848013
         CLC   KEYLE(1,4),KEYLE(5)      COMPARE KEYLENGTHS         6598 14855013
         BNE   KEYUT2                   UT1 AND UT2 KEYS NOT EQUAL 6598 14862013
         OI    KEYOUTSW,X'20'          TURN ON EQUAL KEY           6598 14869013
KEYUT2   TM    KEYOUTSW,X'02'           TEST UT2 FOR DA            6598 14876013
         BZ    NOKEYOUT                 SYSUT2 IS NOT DA           6598 14883013
         TM    KEYLE(5),X'FF'           TEST UT2 KEYLENGTH FOR ZERO6598 14890013
         BZ    NOKEYOUT                 SYSUT1 KEY IS ZERO         6598 14897013
         OI    KEYOUTSW,X'40'          TURN ON NOT ZERO            6598 14904013
NOKEYOUT TM    KEYOUTSW,X'04'           TEST SYSUT1 FOR DA         6598 14911013
         BZ    OTKEYVAL                 SYSUT1 NOT DA              6598 14918013
         TM    KEYLE(4),X'FF'           TEST UT1 KEYLENGTH FOR ZERO6598 14925013
         BZ    OTKEYVAL                 SYSUT1 KEY IS ZERO         6598 14932013
         OI    KEYOUTSW,X'80'          TURN ON KEY NOT ZERO        6598 14939013
OTKEYVAL TM    KEYOUTSW,X'43'          TEST FOR VALID KEYS         6598 14946013
         BO    BUFFMV              OUTPUT KEYS ARE VALID           4028 14956015
         TM    KEYOUTSW,X'FE'      TEST FOR VALID KEYS, NO EXIT    4028 14966015
         BO    BUFFMV              OUTPUT KEYS ARE VALID           4028 14976015
         TM    KEYOUTSW,X'42'      IS UT2 DA AND KEYLEN NOT ZERO   4028 14986015
         BO    ERROR               UT2 KEYS ARE NOT VALID               14996015
BUFFMV   MVC   HBLIN+2(2),BUFL(4)      MOVE SYSUT1 BUFFER LENGTH   6598 15044013
         MVC   HBLOU(2),BUFL(5)        MOVE SYSUT2 BUFFER LENGTH   6598 15051013
         TM    KEYOUTSW,X'08'      ARE THE RECFM'S EQUAL           3599 15059015
         BZ    UNEQREC             BRANCH IF UNEQUAL               3599 15067015
         TM    HINORG,X'40'        IS SYSUT1 RECFM V,VB, OR U      3599 15075015
         BO    OUTVARBL            YES, GO COMPARE BLKSIZE'S       3599 15083015
INFOUTF  TM    HCOPYSW,HCOPYMSK    IS EDITING REQUESTED            3599 15091015
         BZ    CKLRECL             YES, GO STORE LRECLS            3599 15099015
         CLC   LRECL(2,4),LRECL(5) ARE LRECLS EQUAL                3599 15107015
         BNE   ERROR                    LRECL'S NOT EQUAL          6598 15121013
         LH    8,LRECL(5)               SYSUT2 LRECL               6598 15128013
         LH    7,BLKSI(5)               SYSUT2 BLKSIZE             6598 15135013
         SR    6,6                                                 6598 15142013
         DR    6,8                                                 6598 15149013
         LTR   6,6                      CHECK REMAINDER            6598 15156013
         BZ    CKLRECL             NO REMAINDER, BRANCH            3599 15163015
         B     ERROR                   NOT A MULTIPLE              6598 15170013
OUTVARBL TM    HCOPYSW,HCOPYMSK         TEST IF FIELD SPECIFIED    6598 15177013
         BZ    CKLRECL             YES, GO SET UP LRECL FIELD      3599 15184015
         TM    HINORG,X'C0'            INPUT IS U-TYPE           F21533 15185018
         BO    INPUTU                  YES- BRANCH               F21533 15186018
         LH    8,LRECL(4)              LOAD INPUT LRECL          F21533 15187018
         AH    8,HH4                   ADD 4 FOR VB              F21533 15188018
OUTVAR1  CH    8,BLKSI(5)              COMPARE IN LRECL AND      F21533 15189018
*                                      OUTPUT BLKSIZE            F21533 15190018
         BH    ERROR                   SYSUT2 BLOCK TOOSMALL     F21533 15191018
         BZ    CKLRECL                 GO SET UP LRECL FIELD     F21533 15192018
         B     UNEQREC                                           F21533 15193018
INPUTU   CLC   BLKSI(2,4),BLKSI(5)     COMPARE SYSUT1 AND SYSUT2 F21533 15194018
         BH    ERROR                    SYSUT2 BLKSIZE TOO SMALL   6598 15198013
         BZ    CKLRECL             YES, GO SET UP LRECL FIELD      3599 15205015
UNEQREC  TM    HINORG,X'10'             TEST IF SYSUT1 BLOCKED     6598 15212013
         BZ    INNOTBLK                 SYSUT1 NOT BLOCKED         6598 15219013
         TM    HINORG,X'40'             TEST UT1 FOR VAR BLOCK     6598 15226013
         BZ    TSTUT2                   SYSUT1 IS FIX BLOCK        6598 15233013
         OI    RECFMSW,X'30'            TURN ON UT1 EQUAL TO VB    6598 15240013
INNOTBLK TM    HINORG,X'C0'             TEST UT1 FOR U TYPE        6598 15247013
         BM    FIXORVAR                 UT1 IS FIXED OR VAR        6598 15254013
         OI    RECFMSW,X'10'            TURN ON UT1 EQUAL TO U TYPE6598 15261013
FIXORVAR TM    HINORG,X'80'             TEST UT1 FOR FIXED         6598 15268013
         BO    TSTUT2                   UT1 IS FIXED               6598 15275013
         OI    RECFMSW,X'20'            TURN ON UT1 EQUAL TO VAR   6598 15282013
TSTUT2   TM    HOUORG,X'10'             TEST SYSUT2 FOR BLOCKED    6598 15289013
         BZ    OTNOTBLK                 SYSUT2 NOT BLOCKED         6598 15296013
         TM    HOUORG,X'40'             TEST UT2 FOR VAR BLK       6598 15303013
         BZ    SWSET                                               6598 15310013
         OI    RECFMSW,X'03'           UT2 IS A VARIBLE            6598 15317013
         B     SWSET                                               6598 15324013
OTNOTBLK TM    HOUORG,X'C0'             TEST UT2 FOR U TYPE        6598 15331013
         BM    OFXORVAR                 SYSUT2 IS FIXED OR VAR     6597 15338013
         OI    RECFMSW,X'01'            TURN ON UT2 EQUAL TO U TYPE6598 15345013
         B     SWSET                                               6598 15352013
OFXORVAR TM    HOUORG,X'80'             TEST UT2 FOR FIXED         6598 15359013
         BO    SWSET                                               6598 15366013
         OI    RECFMSW,X'02'            TURN ON UT2 EQUAL TO VAR   6598 15373013
SWSET    SR    6,6                                                 6598 15380013
         IC    6,RECFMSW                                           6598 15387013
*                  RECFM SW   1 BYTE                               6598 15394013
*        INPUT                            OUTPUT                   6598 15401013
*        (HALF BYTE)                     (HALF BYTE)               6598 15408013
*        0       FIXED OR FIXED BLK     0                          6598 15415013
*         1       UNDEFINED TYPE        1                          6598 15422013
*        2        VARIBLE TYPE          2                          6598 15429013
*        3       VARIBLE BLK TYPE       3                          6598 15436013
         SRDL  6,4                      MOVE SYSUT2 BITS TO REG 7  6598 15443013
         SRL   7,28                     RIGHT ALIGN UT2 BITS       6598 15450013
         LTR   6,6                      TST UT1 FOR F OR FB        6598 15457013
         BNE   VARIN                    UT1 IS A VARIBLE           6598 15464013
         LTR   7,7                      TEST UT2 FOR F OR FB       6598 15471013
         BZ    INFOUTF                  UT1 AND UT2 ARE F OR FB    6598 15478013
         B     FINVOUT                  UT1 IS F OR FB - UT2 IS VAR6598 15485013
VARIN    TM    HCOPYSW,HCOPYMSK         TEST IF FIELD SPECIFIED    6598 15492013
         BZ    CKLRECL             YES, GO SET UP LRECL FIELD      3599 15499015
         LTR   7,7                      TEST UT2 FOR F OR FB       6598 15506013
         BZ    ERROR                    VAR IN, F OR FB OUT        6598 15513013
         CH    6,HH2                   INPUT IS V OR VB          F21533 15515018
         BNL   VIN1                    YES - BRANCH              F21533 15517018
         LH    4,BLKSI(4)              LOAD BLKSIZE FOR U -TYPE  F21533 15519018
         B     VOUT1                                             F21533 15521018
VIN1 LH 4,LRECL(4)                     LOAD LRECL FOR V OR VB    F21533 15523018
         AH    4,HH4                   ADD 4 TO LRECL            F21533 15525018
VOUT1    LH    5,BLKSI(5)              LOAD OUTPUT BLOCKSIZE     F21533 15527018
FIXGOOD  AR    6,7                      ADD UT2 RECFM TO UT1 RECFM 6598 15534013
         SH    6,THREE                                             6598 15541013
         SRL   7,1                                                 6598 15548013
         CR    6,7                                                 6598 15555013
         BE    TST7ZRO                  UT1 IS R,V (0),OR U,VB (1) 6598 15562013
*  REG6     REG7   REG7(SHIFT)   REG6+REG7                         6598 15569013
*   0  F,FB 0        0         (6 NOT EQUAL 7)                     6598 15576013
*   1   U   1        0              1   F,FB TO U  OR U TO F,FB    6598 15583013
*   2   V   2        1              2   F,FB TO V  OR V TO F,FB    6598 15590013
*   3  VB   3        1              3   F,FB TO VB OR VB TOF,FB    6598 15597013
*                                   4   U TO VB OR VB TO U         6598 15604013
*                                   5   V TO VB OR VB TO V         6598 15611013
*                                                                  6598 15618013
         BH    TST7ONE                                             6598 15625013
         B     ADD8                UT1 IS U, AND UT2 IS V          3599 15629015
TST7ZRO  LTR   7,7                 TEST REG 7 FOR ZERO             3599 15633015
         BZ    MINUS8              UT1 IS V AND UT2 IS U           3599 15637015
ADD8     LA    4,8(4)              BUMP SYSUT1 LRECL OR BLKSIZE    3599 15641015
         B     COMPARE                                             3599 15645015
MINUS8   LA    5,8(5)              BUMP SYSUT2 BLKSIZE             3599 15649015
         B     COMPARE                                             3599 15653015
TST7ONE  LTR   7,7                      TEST 7 FOR ZERO            6598 15660013
         BZ    MINUS8                   SYSUT1 IS VB - SYSUT2 IS U 6598 15667013
         B     COMPARE             GO COMPARE BLKSIZES             3599 15677015
FINVOUT  TM    HCOPYSW,HCOPYMSK        TEST IF FIELD SPECIFIED     6598 15695013
         BZ    CKLRECL                                             3599 15705015
         LH    5,BLKSI(5)              SYSUT2 BLKSIZE              6598 15716013
         LH    4,LRECL(4)              SYSUT1 LRECL                6598 15723013
         BCT   7,ADD8              BRANCH IF UT2  IS V OR VB       3599 15733015
COMPARE  CR    5,4                                                 6598 15758013
         BL    ERROR                                               6598 15765013
CKLRECL  L     12,HDCBINA                                          UL0H 15768017
         LH    4,82(12)                INPUT LRECL                 UL0H 15771017
         L     12,HDCBOUTA                                         UL0H 15774017
         LH    5,82(12)                OUTPUT LRECL                UL0H 15777017
         LTR   4,4                 IS INPUT LRECL ZERO             3599 15780015
         BNE   CKLRECL2            IF NOT, STORE LRECL             3599 15785015
         L     12,HDCBINA                                          UL0H 15788017
         LH    4,62(12)                INPUT BLOCKSIZE             UL0H 15791017
         TM    36(12),X'40'            INPUT RECFM  V              UL0H 15794017
         BC    14,CKLRECL2         IF NOT, STRE BLKSIZE            3599 15800015
         SH    4,HH4               DECREMENT BLKSIZE BY 4 FOR LRECL3599 15805015
CKLRECL2 STH   4,HRLIN             STORE INPUT LRECL               3599 15810015
         LTR   5,5                 IS OUTPUT LRECL ZERO            3599 15815015
         BNE   CKLRECL4            IF NOT, GO STORE LRECL          3599 15820015
         L     12,HDCBOUTA                                         UL0H 15823017
         LH    5,62(12)                OUTPUT BLOCKSIZE            UL0H 15826017
         TM    36(12),X'40'            OUTPUT RECFM V              UL0H 15829017
         BC    14,CKLRECL4         IF NOT, STORE BLKSIZE           3599 15835015
         SH    5,HH4               DECREMENT BLKSI BY 4 FOR V      3599 15840015
CKLRECL4 STH   5,HRLOU             STORE LRECL                     3599 15845015
         TM    HINORG,X'C0'             TEST IF U TYPE             6598 15863013
         BC    12,NEXT                  BRANCH NOT U TYPE          6598 15870013
         NI    HINORG,X'1F'        TURN OFF U AND TRKOVRFL BITS    3599 15877015
         OI    HINORG,X'20'             TURN ON 2 BIT FOR U TYPE   6598 15884013
NEXT     TM    HOUORG,X'C0'             TEST IF U TYPE             6598 15891013
         BC    12,GOBACK                BRANCH NOT U TYPE          6598 15898013
         NI    HOUORG,X'1F'        TURN OFF U AND TRK OVRFL BITS   3599 15905015
         OI    HOUORG,X'20'             TURN ON 2 BIT FOR U TYPE   6598 15912013
GOBACK   BR    14                                                  6598 15919013
ERROR    LA    1,HMSGDCB               MESSAGE CODE                6598 15926013
         SLL   1,8                                                 6598 15933013
         LA    4,11                    MESSAGE ID                  6598 15940013
         LA    15,12                                               6598 15947013
         STH   15,HCONCODE             RETURN CODE OF 12           6598 15954013
         B     ERRORPNT                PRINT MESSAGE               6598 15961013
* FOR A CHANGE IN RECFM'S AND NO FIELD SPECIFIED, THE FOLLOWING HOLDS * 15968013
*  THE SYSUT2 BLKSIZE AND LRECL IS DEPENDENT ON SYSUT1 AND THE RECFM'S* 15975013
*  INPUT        OUTPUT    OUTPUT BLOCK                                * 15982013
*1 F OR FB      F OR FB     MULTIPLE OF LRECL AND LRECL'S EQUAL       * 15989013
*2 F OR FB        U        EQUAL OR GREATER THAN LRECL                * 15996013
*3 F OR FB        V        EQUAL OR GREATER THAN LRECL PLUS 4         * 16003013
*4 F OR FB        VB       EQUAL OR GREATER THAN LRECL PLUS 8         * 16010013
*5 U,V,UB       F OR FB    ILLEGAL                                    * 16017013
*6  U             U        EQUAL OR GREATER THAN INPUT BLKSIZE        * 16024013
*7  V             V              SAME AS ABOVE                        * 16031013
*   VB            VB             SAME AS ABOVE                        * 16038013
*7  U             V        EQUAL OR GREATER THAN INPUT BLK PLUS 4     * 16045013
*8  U             VB       EQUAL OR GREATER THAN INPUT BLK PLUS 8     * 16052013
*9  V             U        EQUAL OR GREATER THAN INPUT BLK MINUS 4    * 16059013
*A  V             VB       EQUAL OR GREATER THAN INPUT BLK PLUS 4     * 16066013
*B  VB            U        EQUAL OR GREATER THAN INPUT BLK MINUS 8    * 16073013
*C  VB            V        EQUAL OR GREATER THAN INPUT BLK MINUS 4    * 16080013
HINTB    DC    3F'0'                   INPUT BUFFER- WORK AREA     6598 16440013
HKEYL    EQU   HINTB                                                    16460000
HBLIN    EQU   HINTB+4                                                  16480000
HRLIN    EQU   HINTB+8                                                  16500000
HINORG   EQU   HINTB+10                                                 16520000
HOUTB    DC    3F'0'                    OUTPUT BUFFER- WORK AREA        16540000
HKEYLOU  EQU   HOUTB                                                    16560000
HBLOU    EQU   HOUTB+4                                                  16580000
HRLOU    EQU   HOUTB+8                                                  16600000
HOUORG   EQU   HOUTB+10                                                 16620000
HPOID    EQU   HOUTB+11                                                 16640000
*                                                                       16660000
HGENPRS  DS    18F                      WORK AREA                       16680000
HSAVE13  DS    2F                      REG 13 ,14 SAVE AREA      A22671 16700018
HSAVE14  DS    1F                       REG 14 SAVE AREA                16720000
HSTOWAR  DS    3F                                                       16740000
ACINAREA DS    1F            ACTUAL INP. BUFF ADDRESS            A36114 16750021
HIN1AD   DS    1F                       SYSUT1 BUFF1 ADDR SAVE AREA     16760000
HIN2AD   DS    1F                       SYSUT1 BUFF2 ADDR SAVE AREA     16780000
HOU1AD   DS    1F                       SYSUT2 BUFF1 ADDR SAVE AREA     16800000
HOU2AD   DS    1F                       SYSUT2 BUFF2 ADDR SAVE AREA     16820000
HEDSV    DS    1F                                                       16840000
HIXIN    DS    1F                                                       16860000
HIXOUT   DS    1F                                                       16880000
HBLOUAC  DS    1F                                                       16900000
HWK4     DC    F'0'                                                     16920000
HRDTSAV  DC    F'0'                                                     16940000
HRLPRE   DS    1H                                                       16960000
HWK2     DS    1H                                                       16980000
LRECLINP DS    1H                      INITIAL INP. LRECL        A45145 16990021
HKEYA    DS    1F                                                       17000000
LABPOLAT DS    2F                      LABEL POOL ADDRESSES             17006017
TOTLAREA DC    4F'0'                   TOTALING PARM LIST          UL0I 17012018
SAVER01  DC    2F'0'                                               UL0I 17018018
SYNADSAV DS    4F                      AREA TO SAVE REGS IN SYNADA22671 17022018
HEXITTA  DS    1F                       USER EXIT TABLE ADDR LOC   UL0H 17026017
HMDTCUR  DS    1F                                                       17040000
HEDCUR   DS    1F                                                       17060000
HRDTCUR  DS    1F                                                       17080000
HLITTA   DS    1F                                                       17100000
HCOPYSW  DS    0C                       COPY SWITCH                     17120000
HEODSW   DS    1C                       END OF DATA SWITCH              17140000
         EXTRN HDCBOUT                                                  17140317
         EXTRN HDCBIN                                                   17140617
HDCBOUTA DC    V(HDCBOUT)                                               17140917
VADDR3   DC    V(HMSGRETC)                                              17141217
HDCBINA  DC    V(HDCBIN)                                                17141517
ADTOTEXR DC    F'0'                                                     17141817
SIXTEEN  DC    H'16'                                                    17142117
FOUR     DC    H'4'                                                     17142417
EIGHT    DC    H'8'                                                     17142717
R14SAVE  DS    2F                                                       17143017
TOTLEXSW DC    X'00'                                                    17143317
LABPROSW DS    1C                      LABEL PROCESSING SWITCH          17143617
KEYOUTSW DC    X'00'                    ATTRIBUTE SWITCH           6598 17144013
THREE    DC    H'3'                     CONSTANT                   6598 17148013
RECFMSW  DC    X'00'                                               6598 17152013
HSTOWSW  DC    X'00'                    STOW SWITCH                     17160000
HRIDSW   DC    X'00'                                                    17180000
HTERMSW  DC    X'00'                    TERMINATION SWITCH              17200000
HEODAD   DC    A(HEOD)                                                  17210017
HINERAD  DC    A(HINER)                                           M2461 17213018
HOUERAD  DC    A(HOUER)                                           M2461 17216018
HWRMSGA  DC    V(HWRMSG)                MSG WRITER SUBR ADDR LOC        17220000
HCDWRA   DC    V(HCDWR)                 ALT ENTRY PT TO MSG WTR    7653 17230017
HCONCODE DC    H'0'                     CONDITION CODE SAVE AREA        17240000
HH0      DC    H'0'                                                     17260000
HH2      DC    H'2'                                                     17280000
HH4      DC    H'4'                                                     17300000
HH2000   DC    H'2000'                                         @ZA24341 17310000
TOTEDIT  DC    H'0'                                                     17320000
HALFWORK DS    1H                                                       17340000
SIXSV    DS    1F                       REG6 SAVE AREA                  17360000
REGSAV   DC    F'0'                SAVES LENGTH FOR BUFFER FREEMAIN3599 17380015
AST       DC   C'****'                                                  17400000
HCOPYMSK EQU   X'F0'                    COPY MASK                       17420000
HEODMSK  EQU   X'0F'                    END OF DATA MASK                17440000
HPTRMSK  EQU   X'00'                                                    17460000
BLANKS   DC    X'4040'                                                  17480000
CPYSWSAV DC    X'00'                                                    17500000
TYPMSG   DC    X'00'                                                    17520000
IOERREXI DC    X'00'              IOERROR EXIT BYTE              A48809 17530021
CHECKINP DC    X'00'               INPUT CHECK TESTBYTE          A50939 17533021
CHECKOUT DC    X'00'               OUTPUT CHECK TESTBYTE         A50939 17536021
HRIDL    EQU   0                                                        17540000
HRIDST   EQU   2                                                        17560000
HRID     EQU   4                                                        17570017
REDANY   DC    X'FF'    IF ANY RCDS IN SYSUT1 DATASET-TURN SW OFF  6291 17580017
HMEMBYT  EQU   0                                                        17600000
HMSGIIP  EQU   1                        MESSAGE CODES                   17620000
HMSGECC  EQU   2                                                        17640000
HMSGBNA  EQU   4                                                        17660000
HMSGTLR  EQU   5                                                        17680000
HMSGTKR  EQU   6                                                        17700000
HMSGTDR  EQU   7                                                        17720000
HMSGTER  EQU   8                                                        17740000
HMSGERS  EQU   9                                                        17760000
HMSGUOE  EQU   10                                                       17780000
HMSGUIE  EQU   11                                                       17800000
HMSGDCB  EQU   12                                                  6598 17810013
HMSGPELR EQU   13                                                       17820000
HMSGPEOD EQU   14                                                       17840000
HMSGBLK1 EQU   17                      NO INPUT BLKSIZE SPECIFIED 10696 17846014
HMSGBLK2 EQU   18                      NO OUTPUT BLKSIZE SPECIFIED10696 17852014
HINDD    EQU   24                                                       17860000
HOUDD    EQU   32                                                       17880000
         ENTRY HGENP                                                    17900000
         DCBD  DSORG=PS                                                 17920000
DDNAM    EQU   DCBDDNAM-IHADCB                                          17940000
OFLGS    EQU   DCBOFLGS-IHADCB                                          17960000
DSORG    EQU   DCBDSORG-IHADCB                                          17980000
BLKSI    EQU   DCBBLKSI-IHADCB                                          18000000
KEYLE    EQU   DCBKEYLE-IHADCB                                          18020000
BUFL     EQU   DCBBUFL-IHADCB                                           18040000
RECFM    EQU   DCBRECFM-IHADCB                                          18060000
LRECL    EQU   DCBLRECL-IHADCB                                          18080000
EODADOFS EQU   DCBEODAD+1-IHADCB                                        18086017
SYNADOFS EQU   DCBSYNAD-IHADCB                                          18092017
         END                                                            18100000
