*********************************************************************** 00020000
*                                                                     * 00040000
*                   * * *  I E B G E N E R  * * *                     * 00060000
*                                                                     * 00080000
*                         * * * * * * * * *                           * 00100000
*                                                                     * 00120000
*      THIS ROUTINE IS THE ROOT SEQMENT OF THE GENERATE UTILITY.      * 00140000
*      IT INITIALIZES SWITCHES, PROCESSES OR STORES INTERNAL PAR-     * 00160000
*      AMETERS, STORES OVERLAY PARAMETERS, WRITES HEADER, CONTROL     * 00180000
*      CARDS AND ERROR MESSAGES FOR ANALYSIS AND PROCESSING SEG-      * 00200000
*      MENTS AND GOVERNS FLOW OF CONTROL BETWEEN SEGMENTS.IT CON-     * 00220000
*      SISTS OF THE FOLLOWING FOUR SUBROUTINES:                       * 00240000
*                                                                     * 00260000
*              1.INITIALIZATION SUBROUTINE                            * 00280000
*              2.INTERNAL PARAMETER ANALYZER SUBROUTINE               * 00300000
*              3.MESSAGE WRITER SUBROUTINE                            * 00320000
*              4.CONTROL CARD WRITER SUBROUTINE                       * 00340000
*                                                                     * 00360000
*      A DETAILED DESCRIPTION OF EACH  SUBROUTINE PRECEDES  CODE      * 00380000
*      FOR THAT SUBROUTINE AS IT OCCURS IN THE CSECT.                 * 00400000
*                                                                     * 00420000
*                         * * * * * * * * *                           * 00440000
*                                                                     * 00460000
*                             E N T R Y                               * 00480000
*                                                                     * 00500000
*      THIS ROUTINE HAS EXTERNALLY REFERENCABLE VALUES  OR  NAMES     * 00520000
*      WHOSE SYMBOLS AND FUNCTIONS ARE:                               * 00540000
*                                                                     * 00560000
*                          I E B G E N E R                            * 00580000
*                                                                     * 00600000
*              THE ENTRY POINT TO THE UTILITY AND NAME                * 00620000
*              BY WHICH IT MAY BE CALLED FROM  LIBRARY.               * 00640000
*                                                                     * 00660000
*                          G E N E R A T E                            * 00680000
*                                                                     * 00700000
*              A SYNONYM FOR I E B G E N E R  AFTER THE               * 00720000
*              UTILITY IS LOADED IN MAIN STORAGE.                     * 00740000
*                                                                     * 00760000
*                            H W R M S G                              * 00780000
*                                                                     * 00800000
*              ENTRY TO THE MESSAGE WRITER SUBROUTINE.                * 00820000
*                                                                     * 00840000
*                             H C D W R                               * 00860000
*                                                                     * 00880000
*              ENTRY TO CONTROL CARD WRITER SUBROUTINE.               * 00900000
*                                                                     * 00920000
*********************************************************************** 00940000
         EJECT                                                          00960000
*********************************************************************** 00980000
*                                                                     * 01000000
*                             I N P U T                               * 01020000
*                                                                     * 01040000
*              TO BE CALLED FROM LIBRARY AND  EXECUTED,               * 01060000
*              THE  FOLLOWING  PARAMETERS  AND POINTERS               * 01080000
*              MUST BE SET UP BY THE INVOKING PROGRAM:                * 01100000
*                                                                     * 01120000
*              1.REGISTER 1 POINTS TO A THREE WORD LIST               * 01140000
*                                                                     * 01160000
*              2.THREE WORD LIST SET UP WITH HIGH ORDER               * 01180000
*                BYTE OF EACH WORD X'00'   EXCEPT  LAST               * 01200000
*                VALID POINTER WHICH IS X'80' AND WHERE               * 01220000
*                                                                     * 01240000
*                WORD 1 POINTS TO PARAMETER LIST---(NOT               * 01260000
*                USED)                                                * 01280000
*                WORD 2 POINTS TO DDNAME LIST OF DOUBLE               * 01300000
*                WORD ENTRIES POSITIONALLY DEPENDENT:                 * 01320000
*                                                                     * 01340000
*                          1.NOT USED                                 * 01360000
*                          2.NOT USED                                 * 01380000
*                          3.NOT USED                                 * 01400000
*                          4.NOT USED                                 * 01420000
*                          5.SYSIN                                    * 01440000
*                          6.SYSPRINT                                 * 01460000
*                          7.NOT USED                                 * 01480000
*                          8.SYSUT1                                   * 01500000
*                          9.SYSUT2                                   * 01520000
*                                                                     * 01540000
*                WORD 3 PERTAINS TO HEADER INFORMATION.               * 01560000
*********************************************************************** 01580000
         EJECT                                                          01600000
*********************************************************************** 01620000
*                                                                     * 01640000
*                             E X T R N                               * 01660000
*                                                                     * 01680000
*      THE ROOT SEGMENT REFERENCES THESE EXTERNALLY DEFINED NAMES     * 01700000
*      OR VALUES:                                                     * 01720000
*                               C C A                                 * 01740000
*                                                                     * 01760000
*              ENTRY TO THE CONTROL CARD ANALYZER SEG-                * 01780000
*              MENT (SEGMENT1).                                       * 01800000
*                                                                     * 01820000
*                            I E B G E N R 3                       VS0H 01840017
*                                                                     * 01860000
*              ENTRY TO THE PROCESSING SEGMENT (SEGMENT               * 01880000
*              2).                                                    * 01900000
*                           H M S G M D L                             * 01920000
*                                                                     * 01940000
*              THE ADDRESS OF THE STANDARD HEADER LINE.               * 01960000
*                                                                     * 01980000
*                         * * * * * * * * *                           * 02000000
*                                                                     * 02020000
*                   E R R O R   C O N D I T I O N                     * 02040000
*                                                                     * 02060000
*      ERRORS IN THE FORMAT OF THE INPUT PARAMETER  LISTS  RESULT     * 02080000
*      IN THE PRINTING OF A DIAGNOSTIC MESSAGE AND TERMINATION OF     * 02100000
*      PROCESSING AND RETURN VIA REGISTER 14.                         * 02120000
*                                                                     * 02140000
*                         * * * * * * * * *                           * 02160000
*                                                                     * 02180000
*                             N O T E S                               * 02200000
*                                                                     * 02220000
*      THIS ROUTINE, AND THE GENERATE UTILITY IN GENERAL,IS 'ONLY     * 02240000
*      LOADABLE'.IT IS NOT RE-ENTRANT.IT IS NOT RE-USABLE.            * 02260000
*                                                                     * 02280000
*********************************************************************** 02300000
         EJECT                                                          02320000
*                   INITIALIZATION ROUTINE                              02340000
*                                                                       02360000
* THIS ROUTINE IS EXECUTED EVERY TIME THE GENERATE PROGRAM IS EXECUTED. 02380000
* IT SETS SWITCHES, ASSIGNS DATA AREAS, ANALYZES LINKAGE PARAMETERS,    02400000
* OPENS SYSPRINT AND WRITES THE HEADER LINE WITH A USER SUPPLIED        02420000
* INITIAL NUMBER (IF ANY) ON SYSPRINT.                                  02440000
*                                                                       02460000
IEBGENER CSECT                                                          02480000
*A49604-49608,77320                                             YM00576 02480402
*C49620                                                         YM00576 02480802
*0000034200,073400-073600,077600-077800                            BS0H 02482017
*0000037000,039200,045400-046000,046400-046600,0469-047100,        UL0H 02482517
*0000047500,047700                                                 UL0H 02483017
*0000039600                                                        VS0H 02483517
*                                                                A23819 02483718
*                                                                A27717 02484119
*                                                                A28753 02484519
*                                                                A29000 02484919
*                                                                A30296 02485319
*A034101,034102,034103                                          YA01223 02485500
*056440,059350                                                   A38715 02485721
*A040102-040168,043100,077300                                    A45131 02485821
*C037000,039200,050400                                           A45131 02485921
*A034106-034142                                                  A48746 02486021
*C035400                                                         A48746 02486121
*A028700-028720                                                @ZA13753 02487700
R0       EQU   0                                                   BS0H 02491221
R1       EQU   1                                                        02492817
R2       EQU   2                                                        02494417
R3       EQU   3                                                        02496017
R4       EQU   4                                                   BS0H 02497617
R5       EQU   5                                                   BS0H 02499217
R6       EQU   6                                                   BS0H 02500817
R7       EQU   7                                                   BS0H 02502417
R8       EQU   8                                                   BS0H 02504017
R9       EQU   9                                                        02505617
R10      EQU   10                                                       02507217
R11      EQU   11                                                       02508817
R12      EQU   12                                                       02510417
R13      EQU   13                                                       02512017
RETREG   EQU   14                                                  BS0H 02513617
R14      EQU   14                                                       02515217
R15      EQU   15                                                       02516817
GENERATE SAVE  (14,12)                                                  02518400
         BALR  R2,0                                                     02520017
         USING IHADCB,8                                                 02540000
         USING *,R2                                                     02560017
HROOT    STM   R13,R14,HRSAVE13         SAVE 13 AND 14                  02580017
         LA    R13,HGENRS               LOAD SAVE AREA ADDR             02600017
         MVI   ZZCTRL,X'00'                                             02620000
         XC    HDDNAMES(40),HDDNAMES    ZERO OUT USER DD NAME TABLE     02640000
         L     R3,0(R1)      LOAD ADDR OF PARM LIST              PTM36A 02660017
         CLI   0(R1),X'80'              TEST FOR DD PARAMETER           02680017
         BE    HROOT4                   NO                              02700000
         L     R4,4(R1)      YES,LOAD DDNMLIST ADDR              PTM36A 02710017
         LTR   R4,R4                   TEST FOR OMITTED DDNAME   A23819 02713018
         BZ   HROOT2                   PARAMETER,IF ABSENT-BRANCHA23819 02716018
         LH    R8,0(R4)                 YES,STORE DD NAMES IN TABLE     02720017
         LTR   R8,R8                    CHECK IF LENGTH GR THAN ZERO?   02730017
         BC    12,HROOT2                IF 0 OR NEG LENGTH,SKIP         02760000
         LA    R9,72                    SET REG9=72                     02780017
         CR    R8,R9                    REG 8= 72?                      02800017
         BL    HROOT1                   IF R8 LESS THAN 72, BRANCH      02820000
         LR    R8,R9                    OTHERWISE SET R8= LENGTH OF 72  02840017
HROOT1   LA    R9,32                    SET REG9=32                     02860017
         CR    R8,R9         IS LIST SHORTER OR EQUAL TO 32?   @ZA13753 02870000
         BNH   HROOT2        YES,OMITT DDNAME LIST             @ZA13753 02872000
         SR    R8,R9                    REG8= LENGTH-32                 02880017
         BCTR  R8,R0                   DECREMENT REG8 BY 1              02900017
         STC   R8,HROOT1A+1             STORE EXACT LENGTH IN MOVE INST 02920017
HROOT1A  MVC   HDDNAMES(40),34(R4)      MOVE USER DD NAME IN TABLE      02940017
         SR    R8,R8                                                    02960017
         C     R8,HSODD                 TEST FOR NONSTAND DD NAME       02980017
         BE    HROOT2                   FOR SYSOUT                      03000000
         LA    R8,HSYSOUT               STORE NON-STANDARD              03020017
         MVC   DCBDDNAM(8),HSODD       SYSOUT DD NAME                   03040000
HROOT2   CLI   4(R1),X'80'              TEST FOR HDR PARAMETER          03060017
         BE    HROOT4                   NO                              03080000
         L     R5,8(R1)      YES,LOAD HEADER ADDR                PTM36A 03090017
         LH    R8,0(R5)                 YES,STORE HEADER ADDR           03100017
         LA    R9,4                     TEST FOR LENGTH LT 4            03110017
         CR    R8,R9                                                    03120017
         BL    HROOT4                   YES,USE STANDARD PAGE NO        03160000
         MVC   HHDR+103(4),2(R5)        NO,MOVE USER PAGE NO            03180017
         B     HROOT5                                                   03200000
HROOT4   MVC   HHDR+103(4),HC0001       MOVE STANDARD PAGE NO           03220000
HROOT5   LA    R8,HMSGHDR               SET REG8=0                      03240017
         SLL   R8,2                                                     03260017
         A     R8,HMSGMDLA              GET STANDARD HEADER             03280017
         L     R8,0(R8)                 ADDRESS IN REG 8                03300017
         MVC   HHDR(40),0(R8)           MOVE STANDARD HEADER            03320017
         OPEN  (HSYSOUT,OUTPUT)         OPEN SYSPRINT                   03340000
         LA    R14,HSYSOUT      ADDRR OF SYSPRINT DCB                   03360017
         TM    OFLGS(R14),X'10'     IS DCB OPEN                         03380017
         LA    R12,12                                            A29000 03390019
         BZ    HROOTX-2       NO IT IS NOT                              03400000
         TM    DFLG,X'10'               CHECK FOR INVALID BLKSIZE  BS0H 03405017
         BC    8,CONTWORK               IF NOT --                  BS0H 03410017
         LA    R0,HEADER          LOAD HEADER ADDRESS           YA01223 03410200
         LA    R1,HHDR            LOAD PRINT ROUTINE ADDRESS    YA01223 03410400
         BAL   R14,ZZPR           PRINT HEADER                  YA01223 03410500
         LA    R1,19              GET ERR MSG TEXT OF IEB319I    A48746 03410621
         SLL   R1,8               SHIFT LEFT                     A48746 03411221
         LA    R9,19              GET MSG IEB319I ID.            A48746 03411821
         AR    R1,R9              SET MAG CODE + ID              A48746 03412421
         LA    R15,HWRMSG         LOAD ERR MSG ID                A48746 03413021
         BALR  R14,R15            BRANCH TO ERROR PRINT          A48746 03413621
         LA    R12,12             LOAD CONDITION CODE IN R12     A48746 03414221
         CLOSE (HSYSOUT)                CLOSE SYSPRINT DCB         BS0H 03415017
         FREEPOOL  HSYSOUT                                         BS0H 03420017
         B     HROOTX-2                 RESTORE REGS AND RETURN    BS0H 03426017
CONTWORK LA    R0,HEADER                                           BS0H 03432017
         LA    R1,HHDR                                                  03442017
         BAL   R14,ZZPR                                                 03452017
         SR    R4,R4                                                    03462017
         LH    R8,0(R3)                 LOAD PARAM LIST LENGTH IN R8    03472017
         CR    R4,R8                    AND CHECK IF IT IS LESS THAN 0? 03482017
         B     HROOT6                   BRANCH                   A48746 03540021
         LA    R1,HMSGIIP               YES,GET ERROR MSG CODE NO.      03560017
         SLL   R1,8                                                     03580017
         LA    R9,2                    GET MSG ID.                 0037 03600017
         AR    R1,R9                    SET MSG CODE+ MSG ID            03620017
         LA    R15,HWRMSG               LOAD ERROR MSG ADDR IN REG 15   03640017
         BALR  R14,R15                  BRANCH TO ERROR MESSAGE         03660017
         B     HRTERMP                  GO TO TERMINATE PROCESSING      03680000
HROOT6   GETMAIN R,LV=104         GET 104 BYTE TABLE AREA        A45131 03700021
         ST    R1,HRTABA                SAVE TABLE ADDR                 03720017
         LA    R4,2                     SET REG 4=2                     03740017
         CR    R8,R4                    PARAM LIST LENGTH LESS THAN 2?  03760017
         BL    HROOT7                   YES, BRANCH                     03780000
         CLC   2(2,R3),HCIN             TEST FOR INTERNAL PARAMETERS    03800017
         BE    HROOT9                   IF INTERNAL PRAM PRESENT,BRANCH 03820000
HROOT7   CALL  CCA,(HSIDD)              ANALYZE INT.PRAM ON CTRL CARD   03840000
         B     HROOT7A                  NORMAL RETURN                   03860000
         B     HRTERMP                  ERROR RETURN                    03880000
HROOT7A  L     R3,HRTABA                                                03900017
         MVC   0(104,R3),0(R1)    MOVE TABLE BUILD BY IEBGSCAN   A45131 03920021
HROOT8   LA    R1,HRTABA                                                03940017
         CALL  IEBGENR3                                            VS0H 03960017
         LR    R12,R15                                                  03980017
         CLOSE (HSYSOUT)                CLOSE SYSPRINT                  04000000
         FREEPOOL  HSYSOUT                                         BS0H 04010017
         L     R3,HRTABA          LOAD TABLE ADDRESS             A45131 04010221
         LTR   R3,R3              DOES TABLE EXIST ?             A45131 04010421
         BZ    HROOTX-2           NO, RETURN TO SYSTEM           A45131 04010621
         TM    INPARM,X'FF'       INTERNAL PARAM PROC. ?         A45131 04010821
         BO    FRHRTABL           YES, DON'T TEST FOR TBL FREEM. A45131 04011021
         LH    R5,96(R3)          LOAD MAXNAME RESERVED CORE     A45131 04011221
         LTR   R5,R5              IS IT ZERO ?                   A45131 04011421
         BZ    TSTCMAXF           YES, TEST FOR MAXFLDS CORE     A45131 04011621
         L     R1,64(R3)          NO, GET ADDR. OF MAXNAME CORE  A45131 04011821
         LR    R0,R5              LOAD CORE LENGTH               A45131 04012021
         FREEMAIN R,LV=(0),A=(1)  MAXNAME CORE                   A45131 04012221
TSTCMAXF LH    R5,98(R3)          LOAD MAXFLDS RESERVED CORE     A45131 04012421
         LTR   R5,R5              IS IT ZERO ?                   A45131 04012621
         BZ    TSTCMAXG           YES, TEST MAXGPS CORE          A45131 04012821
         L     R1,68(R3)          NO, GET ADDRESSS PLUS FOUR     A45131 04013021
         LA    R4,8               CALCULATE                      A45131 04013221
         SR    R1,R4              RIGHT ADDRESS                  A45131 04013421
         LA    R0,8(R5)           LOAD GETMAIN LENGTH            A45131 04013621
         FREEMAIN R,LV=(0),A=(1)  MAXFLDS CORE                   A45131 04013821
TSTCMAXG LH    R5,100(R3)         LOAD MAXGPS RESERVED CORE      A45131 04014021
         LTR   R5,R5              IS IT ZERO ?                   A45131 04014221
         BZ    TSTCMAXL           YES, TEST MAXLITS RESER. CORE  A45131 04014421
         L     R1,72(R3)          NO, GET ADDRESS                A45131 04014621
         LR    R0,R5              LOAD CORE LENGTH               A45131 04014821
         FREEMAIN R,LV=(0),A=(1)  MAXGPS CORE                    A45131 04015021
TSTCMAXL LH    R5,102(R3)         LOAD MAXLITS RESERVED CORE     A45131 04015221
         LTR   R5,R5              IS IT ZERO ?                   A45131 04015421
         BZ    FRHRTABL           YES, FREE TABLE                A45131 04015621
         L     R1,76(R3)          NO, LOAD MAXLITS ADDRESS       A45131 04015821
         LR    R0,R5              LOAD LENGTH                    A45131 04016021
         FREEMAIN R,LV=(0),A=(1)  MAXLITS CORE                   A45131 04016221
FRHRTABL LR    R1,R3              LOAD TABLE ADDRESS             A45131 04016421
         LA    R0,104             LOAD TABLE LENGTH              A45131 04016621
         FREEMAIN R,LV=(0),A=(1)  TABLE CORE                     A45131 04016821
         LR    R15,R12                                                  04020017
HROOTX   LM    R13,R14,HRSAVE13         RESTORE REGS 13-14              04030017
         RETURN (2,12)                  RESTORE REGS 2-12 AND RETURN    04060000
*                                                                  BS0H 04061017
*                  DCB EXIT ROUTINE                                BS0H 04062017
*                                                                  BS0H 04063017
DCBOEXIT LA    R8,HSYSOUT         LOAD ADDRESS OF SYSPRINT DCB     BS0H 04064017
         LH    R5,DCBBLKSI              LOAD BLKSIZE               BS0H 04065017
         LTR   R5,R5                                               BS0H 04066017
         BC    8,FIXBLK                 IF NONE SPECIFIED --       BS0H 04067017
         SR    R4,R4                                               BS0H 04068017
         LH    R6,DCBLRECL                                       A28753 04069019
         DR    R4,R6                    TEST FOR MODULAR BLKSIZE   BS0H 04070017
         LTR   R4,R4                                               BS0H 04071017
         BCR   8,RETREG                 IF MODULAR --              BS0H 04072017
         MVI   DFLG,X'10'               SET BLKSIZE ERROR FLAG     BS0H 04073017
         MVC   DCBBLKSI(2),DCBLRECL     MOVE LRECL TO BLKSIZE      BS0H 04074017
         RETURN                                                         04075017
FIXBLK   MVI   DCBBLKSI+1,X'79'         INSERT BLKSIZE -- 121      BS0H 04076017
         RETURN                                                         04078017
*                                                                       04080000
*                                                                       04100000
*                   INTERNAL PARAMETER ANALYZER ROUTINE                 04120000
*                                                                       04140000
* THIS ROUTINE IS EXECUTED WHEN THE INVOKING ROUTINE SPECIFIES INTERNAL 04160000
* PARAMETERS. IT STORES AND INSPECTS THE PARAMETER TABLES SUPPLIED BY   04180000
* THE INVOKING ROUTINE. BASED ON THE PARAMETERS, IT SETS SWITCHES FOR   04200000
* PROCESSING.                                                           04220000
*                                                                       04240000
*                                                                       04260000
HROOT9   CALL  CCA,(HSIDD),VL           DUMMY CALL                      04280000
         L     R4,HRTABA                                                04300017
         OI    INPARM,X'FF'       SET INTERNAL PARAM. SWITCH     A45131 04310021
         LA    R9,8                     INTERNAL TABLE PROCESSING       04320017
         CR    R9,R8                    IF NO TABLES,TAKE               04340017
         BE    HROOT14                  STANDARD OPTIONS                04360000
         LA    R3,10(,R3)               INCREMENT XR                    04380017
         SR    R8,R8                                                    04400017
         C     R8,0(R3)                                                 04420017
         BNE   HROOT9A                  IF THERE IS NO EXIT TABLE,      04440000
         MVI   0(R4),X'40'              BLANK OUT EXIT AREA             04460017
         MVC   1(63,R4),0(R9)                                           04480017
         B     HROOT10                                                  04500000
HROOT9A  L     R9,0(R3)                 IF THERE IS AN EXIT TABLE,      04520017
         MVC   0(64,R4),0(R9)          MOVE IT TO EXIT AREA        UL0H 04540017
HROOT10  MVC   64(16,R4),4(R3)                                     UL0H 04560017
         XC    93(2,R4),93(R4)                                     UL0H 04580017
HROOT11  C     R8,64(R4)                                           UL0H 04600017
         BE    HROOT12                  IF THERE IS AN MDT ADDR,        04620000
         MVI   94(R4),X'02'            SET PO SWITCH               UL0H 04640017
HROOT12  C     R8,72(R4)                                           UL0H 04660017
         BNE   HROOT13                  IF THERE IS NO EDCB ADDR,       04680000
         OI    93(R4),X'F0'            SET COPY SWITCH             UL0H 04690017
HROOT13  C     R8,68(R4)                                           UL0H 04700017
         OI    93(R4),X'0F'            SET EOD SWITCH              UL0H 04710017
         BNE   HROOT8                   IF THERE IS NO RDT ADDR,        04740000
         MVC   1(63,R4),0(R4)          ZERO OUT ADDRESSES          UL0H 04750017
         XC    64(16,R4),64(R4)        AND                         UL0H 04760017
         XC    93(2,R4),93(R4)         SWITCHES                    UL0H 04770017
         B     HROOT8                                                   04780000
HROOT14  MVI   0(R4),X'40'              BLANK OUT EXITS                 04790017
         SR    R8,R8                                                    04830017
         B     HROOT11                                                  04880000
*                                                                       04900000
HRTERMP  CLOSE (HSYSOUT)                CLOSE SYSPRINT                  04920000
         FREEPOOL  HSYSOUT                                         BS0H 04930017
         LA    R15,12                   LOAD CONCODE                    04940017
         B     HROOTX                                                   04960000
SYSIOERR L     R2,ADDHROOT              ESTAB ADDRESSABILITY    YM00576 04960402
         USING HROOT,R2                                         YM00576 04960802
         SYNADAF ACSMETH=QSAM                                   YM00576 04962002
         MVC   IOERR1+23(26),49(R1)     MSG TO BUFFER            A27717 04964019
         MVC   IOERR2+12(53),75(R1)     PART 2 MSG TO BUFFER     A27717 04966019
         SYNADRLS                                                A27717 04968019
         LA    R1,IOERR1                                         A27717 04970019
         WTO   MF=(E,(1))                                        A27717 04972019
         LA    R1,IOERR2                                         A27717 04974019
         WTO   MF=(E,(1))                                        A27717 04976019
         B     HROOTX                   RETURN TO CALLER         A27717 04978019
*                                                                       04980000
         DS    0F                                                       04982019
OPTL     DC    X'85'                                               BS0H 04985017
         DC    AL3(DCBOEXIT)                                       BS0H 04990017
DFLG     DC    X'00'                                               BS0H 04995017
HRSAVE13 DS    2F                                                       05000000
HGENRS   DS    18F                                                      05020000
HRTABA   DC    F'0'               TABLE ADDRESS                  A45131 05040021
HDDNAMES DS    10F                                                      05060000
HHDR     DS    2C                                                       05080000
         DC    3CL32' '                                                 05100000
         DC    CL22'PAGE 0001'                                          05120000
         DC    AL1(55)                                                  05140000
HCIN     DC    C'IN'                                                    05160000
HC0001   DC    C'0001'                                                  05180000
IOERR1   WTO   'IEB351I I/O ERROR                            ',MF=L,   C05184019
               ROUTCDE=11,DESC=7                                 A27717 05188019
IOERR2   WTO   'IEB351I                                                C05192019
                     ',MF=L,ROUTCDE=11,DESC=7                    A27717 05196019
HSIDD    EQU   HDDNAMES                                                 05200000
HSODD    EQU   HDDNAMES+8                                               05220000
HMSGHDR  EQU   0                                                        05240000
HMSGIIP  EQU   1                                                        05260000
*                                                                       05280000
*                                                                       05300000
*                                                                       05320000
*                   MESSAGE WRITER SUBROUTINE                           05340000
*                                                                       05360000
* THIS SUBROUTINE IS EXECUTED EVERY TIME AN ERROR MESSAGE IS TO BE      05380000
* WRITTEN ON SYSPRINT. IT LOCATES THE PROPER MESSAGE IN THE MESSAGE     05400000
* MODULE AND WRITES IT.                                                 05420000
*                                                                       05440000
*                                                                       05460000
         USING HWRMSG,15                                                05480000
HWRMSG   LR    R0,R1                                                    05500017
         SLL   R0,24                                                    05520017
         SRL   R0,24                                                    05540017
         SRL   R1,6                                                     05560017
         A     R1,HMSGMDLA              MESS ADDR IN R1                 05580017
         L     R1,0(R1)                                                 05600017
         MVC   HMSGAREA+8(62),0(R1)    MOVE MESSAGE                UL0H 05620017
         CH    R0,HW51                 TEST FOR SYNAD MSG        A27717 05626019
         BNE   NORMMSG                 NO - NORMAL MSG           A27717 05632019
         MVI   SYNADIND,X'80'          SET SYNAD SWITCH          A27717 05638019
         MVC   HMSGAREA+70(27),62(R1)  MOVE REST OF SYNAD INF.   A38715 05644021
NORMMSG  C     R6,AST                  EOD MSG                   A27717 05650019
         BE    INAST                                                    05660000
         LA    R1,HMSGAREA              INSERT ID INTO PREFIX           05680017
         CVD   R0,HMDW                  CONVERT ID TO DECIMAL           05700017
         UNPK  HMSGAREA+4(2),HMDW+6(2)  UNPACK DECIMAL ID               05720000
         OI    HMSGAREA+5,X'F0'         REMOVE ZONE                     05740000
         CLI   SYNADIND,X'80'          SYNAD SWITCH SET          A27717 05746019
         BE    SYNMSG                  YES - BRANCH              A27717 05752019
         LA    R0,69                   LOAD LENGTH MINUS ONE       UL0H 05760017
         B     ZZPR                     BRANCH TO SUBROUTINE ZZPR       05780000
SYNMSG   MVI   SYNADIND,X'00'          RESET SYNAD SWITCH        A27717 05785019
         LA    R0,97                   LOAD PROPER MSG LENGTH    A27717 05790019
         B     ZZPR                    WRITE MSG                 A27717 05795019
INAST     LA    R1,HMSGAREA+8                                           05800017
         LA    R0,61                   LOAD LENGTH MINUS ONE       UL0H 05820017
         B     ZZPR                     BRANCH TO SUBROUTINE ZZPR       05840000
HMDW     DS    1D                                                       05860000
HW51     DC    H'51'                   NUMBER OF SYNAD MSG       A27717 05870019
HMSGMDLA DC    V(HMSGMDL)                                               05880000
HMSGAREA DC    C'IEB300I '                                              05900000
         DS    62C                     MESSAGE AREA                UL0H 05920017
         DS    27C      EXTENSION FOR SYNAD MESSAGE              A38715 05922021
SYNADIND DC    X'00'                   SYNAD SWITCH              A27717 05925019
         DS    0H                                                       05935019
         DROP  15                                                       05940000
*                                                                       05960000
*                   CONTROL CARD WRITER SUBROUTINE-                     05980000
*                                                                       06000000
* THIS SUBROUTINE IS EXECUTED EVERY TIME A CONTROL CARD IS READ BY THE  06020000
* CONTROL CARD SCANNER SUBROUTINE - IEBGSCAN. IT WRITES THE CONTROL     06040000
* CARDS ON SYSPRINT.                                                    06060000
*                                                                       06080000
*                                                                       06100000
         USING *,R15                   ESTABLISH BASE                   06120017
HCDWR    LA    R0,79                                                    06140017
         B     ZZPR                                                     06160000
         DROP  15                                                       06180000
*                                                                       06200000
ZZPR     BALR  R15,0                                                    06220017
         USING *,R15                   ESTABLISH BASE                   06240017
          STM  R14,R3,ZZSAVE            SAVE REGISTERS                  06260017
         BALR  R2,R0                   LOAD BASE                        06280017
         USING *,R2                                                     06300017
         DROP  15                                                       06320000
          TM   ZZSW,X'02'               SHOULD WE SET UP HEADER         06340000
          BO   ZZHEAD                   YES                             06360000
          TM   ZZSW,X'01'               SHOULD WE SKIP TO NEXT PAGE     06380000
          BO   ZZSKIP                   YES                             06400000
          CLC  ZZLINES(1),ZZLINCNT      IS THIS END OF PAGE             06420000
          BL   FULLPAGE                 YES                             06440000
          B    ZZCLEAR                  CLEAR PRINT BUFFER AND PRINT    06460000
PRNTRTRN  LM   R14,R3,ZZSAVE            RESTORE REGISTERS               06480017
          BR   R14                      RETURN                          06500017
ZZHEAD    MVC  ZZHDSAVE(121),0(R1)      MOVE HEADER AND LINE COUNT TO   06520017
*                                        SAVE AREA                      06540000
          BAL  R3,ZZPG                  GO TO ADD ONE TO PAGE NUMBER    06560017
*                                        AND PRINT HEADER               06580000
          B    PRNTRTRN                                                 06600000
*                                                                       06620000
ZZSKIP    CLI  ZZCTRL,C'-'              IS NEXT PRINT A TRIPLE SPACE    06640000
          BE   PRNTRTRN                 YES   RETURN WITHOUT PRINT      06660000
          BAL  R3,ZZPG                  GO TO PRINT HEADER              06680017
          B    PRNTRTRN                                                 06700000
FULLPAGE  BAL  R3,ZZPG                  GO PRINT HEADER                 06720017
          B    ZZCLEAR                  GO PRINT LINE                   06740000
*                           THIS ROUTINE ADDS ONE TO PAGE NO. AND       06760000
*                           PRINTS HEAD  SET CONTROL CHAR FOR NEXT PRNT 06780000
ZZPG     TM    ZZCTRL,X'FF'                                             06800000
         BZ    ZZNOADD                                                  06820000
         PACK  ZZCONVRT(8),ZZPGNO(4)   ADD ONE                          06840000
          CVB  R15,ZZCONVRT               TO                            06860017
          LA   R15,1(R15)                   PAGE                        06880017
          CVD  R15,ZZCONVRT                   NUMBER                    06900017
         UNPK  ZZPGNO(4),ZZCONVRT(8)         IN                         06920000
         OI    ZZPGNO+3,X'F0'                  HEADER                   06940000
ZZNOADD  MVI   ZZCTRL,C'1'                                              06960000
          MVI  ZZLINCNT,X'04'           INITIALIZE LINE COUNT TO 4      06980000
          MVC  ZZPRINT(120),ZZHDSAVE   MOVE HEADER INTO PRINT BUFFER    07000000
          ST   R3,SAVE3                 SAVE REGISTER 3                 07020017
          BAL  R3,ZZWRITE               GO TO WRITE HEADER              07040017
          MVI  ZZCTRL,C'-'              SET CONTROL TO TRIPLE SPACE     07060000
          L    R3,SAVE3                                                 07080017
          BR   R3                                                       07100017
ZZCLEAR   IC   R14,ZZLINCNT             THIS ROUTINE WILL               07120017
          LA   R14,1(R14)                  ADD ONE                      07140017
          STC  R14,ZZLINCNT             STORE NEW LINE COUNT            07160017
          MVI  ZZPRINT,C' '                                             07180000
         MVC   ZZPRINT+1(119),ZZPRINT      CLEAR PRINT BUFFER           07200000
          LM   R14,R15,ZZSAVE+8              TO BLANKS                  07220017
          EX   R14,ZZMOVE                  MOVE LINE TO BE PRINTED      07240017
          BAL  R3,ZZWRITE                    INTO BUFFER                07260017
          MVI  ZZCTRL,C' '                 SET CONTROL CHAR FOR NEXT    07280000
          B    PRNTRTRN                 PRINT LINE AND  RETURN          07300000
ZZMOVE    MVC  ZZPRINT(1),0(R15)        MOVE MESSAGE TO PRINT BUFFER    07320017
ZZWRITE  PUT   ZZDCB,ZZCTRL                                        BS0H 07350017
          BR   R3                                                       07370017
          DS   0D                                                       07400000
ZZSAVE    DS   10X                                                      07420000
ZZSW      DS   10X                                                      07440000
          DS    4X                                                      07460000
SAVE3     DS    4X                                                      07480000
ZZCTRL   DS    1X                       LOC FOR PRINTER CTRL CHAR       07500000
ZZPRINT  DS    121X                     PRINT BUFFER                    07520000
ZZHDSAVE DS    120X                     HEADER SAVE AREA                07540000
ZZCONVRT EQU   ZZSAVE+32                8 BYTE AREA ADDR TO CONVERT NO  07560000
ZZLINES  DS    1X                       LOC COUNTER FOR LINES PRINTED   07580000
ZZLINCNT DS    1X                       LOC FOR LINE COUNT              07600000
ZZDECB   DS    24X                      AREA FOR DECB                   07620000
SKIP     EQU   256                      CODE FOR SKIP A PAGE            07640000
HEADER   EQU   512                      CODE FOR HEADER                 07660000
ZZPGNO   EQU   ZZHDSAVE+103             LOC OF PAGE NO                  07680000
         DS    0F                                                       07700000
AST      DC    C'****'                                                  07720000
INPARM   DC    X'00'              INTERNAL PARAM. SWITCH         A45131 07730021
ADDHROOT DC    A(HROOT)                                         YM00576 07732002
*                                                                       07740000
HSYSOUT  DCB   DSORG=PS,MACRF=(PM),DDNAME=SYSPRINT,                BS0H*07760017
               RECFM=FBA,EXLST=OPTL,SYNAD=SYSIOERR,LRECL=121     A30296 07780019
*                                                                       07800000
ZZDCB    EQU   HSYSOUT                                                  07820000
         ENTRY GENERATE                                                 07840000
         ENTRY HWRMSG                                                   07860000
         ENTRY HCDWR                                                    07880000
         DCBD  DSORG=PS                                                 07900000
OFLGS    EQU   DCBOFLGS-IHADCB                                          07920000
         END   GENERATE                                                 07940000
