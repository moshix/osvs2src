         TITLE 'IEBGENS3-VARIABLE SPANNED RECORD PROCESSOR (RLS 17)'    00080017
*********************************************************************** 00160017
*                                                                     * 00240017
*                        * * * I E B G E N S 3 * * *                  * 00320017
*                              ***************                        * 00400017
*                                                                     * 00480017
*      THIS IS THE MODULE OF THE IEBGENER DATASET UTILITY, THAT       * 00560017
*      PROCESSES VARIABLE SPANNED RECORD DATASETS                     * 00640017
*      IT GETS CONTROL AFTER IEBGENR3 HAS OPENED THE DATASETS FOR     * 00720017
*      INPUT AND OUTPUT, AND FOUND THAT AT LEAST ONE OF THE DATASET   * 00800017
*      HAS A RECFM=VS OR RECFM=VBS                                    * 00880017
*      THIS MODULE USES THE BSAM ACCESS METHOD IF THERE IS NO CHANGE  * 00960017
*      IS REQUIRED OF ANY KIND IN BLOCKSIZE,LRECL OR RECFM            * 01040017
*      IN ALL OTHER CASES THE QSAM ACCESS METHOD IS USED              * 01120017
*      IT CONTROLS LINKAGE TO EDIT AND CONVERSION ROUTINES FOR        * 01200017
*      SPECIAL PROCESSING DICTATED BY THE IEBGENER CONTROL CARDS      * 01280017
*      AFTER PROCESSING IS COMPLETED IT WILL RETURN CONTROL TO        * 01360017
*      IEBGENR3                                                       * 01440017
*                                                                     * 01530017
*                         * * * * * * * * *                           * 01620017
*                                                                     * 01710017
*                             E N T R Y                               * 01800017
*                                                                     * 01890017
*      THE SUBROUTINE HAS ONE EXTERNALLY REFERENCABLE ENTRY POINT     * 01980017
*      WHOSE SYMBOLIC NAME IS:                                        * 02070017
*                            H G E N P S 3                              02160017
*                                                                     * 02250017
*                         * * * * * * * * *                           * 02340017
*                                                                     * 02430017
*                             I N P U T                               * 02520017
*                                                                     * 02610017
*      THE SUBROUTINE IS ENTERED WITH OP REGISTER 1  POINTING TO      * 02700017
*      A LIST IN WHICH ARE THE ADDRESSES OF TABLES CONSTRUCTED BY     * 02790017
*      THE I E B G S C A N SUBROUTINE ACCORDING TO THE PARAMETERS     * 02880017
*      SPECIFIED IN THE UTILITY CONTROL CARDS. MAIN  STORAGE  FOR     * 02970017
*      THESE TABLES IS GOTTEN AND RELEASED OUTSIDE THIS ROUTINE.      * 03060017
*                                                                     * 03150017
*********************************************************************** 03240017
         EJECT                                                          03330017
*********************************************************************** 03420017
*                                                                     * 03510017
*                             E X T R N                               * 03600017
*                                                                     * 03690017
*      THE SUBROUTINE REFERENCES THESE EXTERNALLY DEFINED  VALUES     * 03780017
*      OR SUBROUTINE NAMES:                                           * 03870017
*                             H M O V E                               * 03960017
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 04050017
*              TO MOVE RECORDS OF ANY SIZE IN CORE                    * 04140017
*                                                                     * 04230017
*                             H E D I T                               * 04320017
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 04410017
*              TO EXECUTE THE EDITING SPECIFIED BY THE                * 04500017
*              UTILITY CONTROL CARDS.                                 * 04590017
*                                                                     * 04680017
*                              H P R L                                * 04770017
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 04860017
*              TO ESTABLISH THE LENGTH OF AN OUTPUT RE-               * 04950017
*              CORD ACCORDING TO THE EDIT PARAMETERS.                 * 05040017
*                                                                     * 05130017
*                            H W R M S G                              * 05220017
*                                                                     * 05310017
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 05400017
*              TO WRITE MESSAGES ISSUED BY THIS ROUTINE               * 05490017
*              ON THE DEVICE SPECIFIED BY SYSPRINT  DD-               * 05580017
*              NAME.                                                  * 05670017
*                                                                     * 05760017
*                          D D E R R O R 1                            * 05850017
*                                                                     * 05940017
*              A MESSAGE USED AS A DIAGNOSTIC WHEN DATA               * 06030017
*              DEFINITION STATEMENT NAMES ARE IMPROPER-               * 06120017
*              LY SPECIFIED TO THE PROGRAM.                           * 06210017
*                                                                     * 06300017
*********************************************************************** 06390017
         EJECT                                                          06480017
*********************************************************************** 06570017
*                                                                     * 06660017
*                   E R R O R   C O N D I T I O N                     * 06750017
*                                                                     * 06840017
*      THE SUBROUTINE WILL TERMINATE PROCESSING, CAUSE AN APPROP-     * 06930017
*      RIATE DIAGNOSTIC MESSAGE TO BE PRINTED AND RETURN VIA REG-     * 07020017
*      ISTER 14 UPON RECOGNITION OF THE FOLLOWING TYPES OF ERROR:     * 07110017
*                                                                     * 07200017
*              1.PERMANENT I/O ERROR ON EITHER INPUT OR               * 07290017
*                OUTPUT DATA SET.                                     * 07380017
*              2.ANY CONTROL STATEMENT ERROR UNABLE  TO               * 07470017
*                BE DETERMINED AT CONTROL CARD  PROCES-               * 07560017
*                SING TIME,I.E.-PARAMETERS WHICH ARE AT               * 07650017
*                VARIANCE WITH INCOMING DATA.                         * 07740017
*             3.DATA FORMAT ERRORS NOT APPRENT TO THE                 * 07840017
*               QSAM ACCESS METHOD                                    * 07940017
*                                                                     * 08040017
*                         * * * * * * * * *                           * 08140017
*                                                                     * 08240017
*                             N O T E S                               * 08340017
*                                                                     * 08440017
*      THIS SUBROUTINE IS 'ONLY LOADABLE'.IT IS NOT RE-ENTRANT;IT     * 08540017
*      IS NOT RE-USABLE.                                              * 08640017
*                                                                     * 08740017
*********************************************************************** 08840017
         EJECT                                                          08940017
IEBGENS3 CSECT                                                          09040017
* THIS MODULE WAS CREATED IN RELEASE 17 FOR SUPPORT OF VRE            * 09110017
*561500,580700,820500                                            A22671 09130018
* 108800,110300                                                   M2461 09140018
* 382100                                                         A25958 09146019
* 552700-564700,588300-598300                                    A27717 09152019
*                                                                A33312 09156020
* 135600-138600                                                  A35449 09158020
*166100-167100,171100-172100,173100,623300-635300               PTM5314 09158420
*A626300-627100,629800-630700                                    A45131 09158521
*D403100,626300,626800,629800-631300                             A45131 09158621
*A173100-174700,176600-177080,623900                             A45145 09158821
*D173100,174100                                                  A45145 09159221
*C177100,840200                                                  A45145 09159621
*A283100,283600,533900                                           A48738 09160021
*D283100                                                         A48738 09170021
*A441600-442100,443100-443500,456700,458300,624500,              A48746 09180021
*A631100-633800,840250                                           A48746 09182021
*D443100,456700,458300,631000-633300                             A48746 09190021
*A578000,578800-579000                                           A48809 09192021
*C573500,575100                                                  A48809 09194021
*D591300                                                         A48809 09196021
*D443400-443460                                                @ZA03375 09198003
*   REGISTER ASSIGNMENT                                                 09200021
R0       EQU   0                                                        09210017
R1       EQU   1                                                        09260017
R2       EQU   2                                                        09310017
R3       EQU   3                                                        09360017
R4       EQU   4                                                        09410017
R5       EQU   5                                                        09460017
R6       EQU   6                                                        09510017
R7       EQU   7                                                        09560017
R8       EQU   8                                                        09610017
R9       EQU   9                                                        09660017
R10      EQU   10                                                       09710017
R11      EQU   11                                                       09760017
R12      EQU   12                                                       09810017
R13      EQU   13                                                       09860017
R14      EQU   14                                                       09910017
R15      EQU   15                                                       09960017
HGENPS3  SAVE  (14,12)                                                  10010017
         LR    R2,R15                                                   10060017
         USING HGENPS3,R2                                               10110017
         LA    R3,HGENPRS               LOAD WORK AREA ADDRESS          10160017
         ST    R3,8(R13)                AND STORE IT                    10210017
         STM   R13,R14,HSAVE13                                          10260017
         LA    R13,HGENPRS                                              10310017
         L     R3,0(R1)                 LOAD EXIT TABLE ADDRESS         10360017
         ST    R3,HEXITTA               STORE EXIT TABLE ADDRESS        10410017
         MVC   HMDTCUR(16),64(R3)       STOER SWITCHES                  10460017
         MVC   HMDTCUR+16(1),93(R3)     STORE PO SWITCH                 10510017
         MVC   HPOID(1),94(R3)                                          10560017
         MVC   LABPOLAT(8),80(R3)      MOVE LABEL POOL ADDRESSES        10610017
         MVC   TOTLAREA+12(4),88(R3)   MOVE TOTALING AREA ADDRESS  UL0I 10660018
         MVC   LABPROSW(1),92(R3)      MOVE LABEL PROCESSING SWITC      10710017
         L     R12,HDCBINA             LOAD SYSUT1DCB ADDRESS           10760017
         MVC   EODADOFS(3,R12),HEODAD+1 MOVE EODAD ROUT.ADD AND         10810017
         MVC   SYNADOFS+1(3,R12),HINERAD+1  PUT SYNAD ADDR IN DCB M2461 10880018
         L     R4,HDCBOUTA             STORE SYNAD ROUT,ADDRESS         10960017
         MVC   SYNADOFS+1(3,R4),HOUERAD+1  PUT SYNAD ADDR IN DCB  M2461 11030018
         ST    R4,TOTLAREA+4           STORE DCB ADDRESS IN LIST        11110017
         CLI   0(R3),X'40'             TOTALING SPECFIED                11160017
         BE    HGENP5A                 NO-BRANCH                        11210017
         OI    TOTLEXSW,X'80'          SET TOTALING EXIT SWITCH         11260017
         LR    R10,R3                                                   11310017
         LOAD  EPLOC=(10)              LOAD USER ROUTINE                11360017
         LOAD  EPLOC=(R10)             LOAD USER ROUTINE                11410017
         ST    R0,ADTOTEXR             STORE ADDRESS                    11460017
HGENP5A  TM    HPOID,X'02'             PDS?                             11510017
         BZ    HGENP5B                 NO-BRANCH                        11560017
         L     R10,HDCBOUTA            LOAD SYSUT2 DCB ADDRESS          11610017
         TM    RECFM(R10),X'48'        IS SYSUT2 VS                     11660017
         BNO   HGENP5B                 NO-BRANCH                        11710017
         LA    R1,29                   YES-SET ERROR OFFSET             11760017
         SLL   R1,8                    AND                              11810017
         LA    R4,29                   MSESAGE ID.                      11860017
         B     ERRORPNT                AND BRANCH                       11910017
HGENP5B  L     R1,GENCOPAD                                              11960017
         TM    0(R1),X'80'             STRAIGHT COPY?                   12010017
         BZ    S3COLDAT                NO-BRANCH                        12060017
         MVC   EODADOFS(3,R5),STHEODAD+1 MOVE EODAD TO DCB              12110017
         LH    R6,BLKSI(R5)            LOAD BLOCKSIZE                   12160017
         SR    R10,R10                 ADJUST BLOCK LENGTH              12210017
         IC    R10,16(R5)              FOR                              12260017
         AR    R6,R10                  POSSIBLE KEYS                    12310017
         LR    R10,R6                  MULTIPLY                         12360017
         SLL   R10,1                   BLOCKSIZE WITH THREE             12410017
         AR    R10,R6                  TO GET TOTAL BUFFER AREA         12460017
         ST    R10,LNGTHBFS            SAVE TOTAL LENGTH OF BUFFER UL0I 12480019
         GETMAIN  R,LV=(R10)              GET STORAGE                   12510017
         ST    R1,FIRSTBUF             STORE ADDRESS OF 1ST BUFFER      12560017
         AR    R1,R6                                                    12610017
         ST    R1,SECNDBUF             STORE ADDRESS OF 2ND BUFFER      12660017
         AR    R1,R6                                                    12710017
         ST    R1,THIRDBUF             STORE ADDRESS OF 3RD BUFFER      12760017
         L     R6,HDCBOUTA             LOAD OUTPUT DCB ADDRESS          12810017
         OI    BCNTRLSW,X'FF'          RESET BRANCH CONTROL SWITCHS     12860017
         L     R5,FIRSTBUF             LOAD INPUT BUFF ADDRESS          12910017
         BAL   R12,HREAD               LINK TO READ                     12960017
STRCOP1  SR    R4,R4                                                    13010017
         CHECK HDECBIN                 CHECK READ                       13060017
         TM    BCNTRLSW,X'01'          BRANCH REQUIRED                  13110017
         BO    STRCOP3                 YES BRANCH                       13160017
         TM    BCNTRLSW,X'02'          BRANCH REQUIRED                  13210017
         BO    STRCOP2                                                  13260017
         CHECK HDECBOUT                                                 13310017
STRCOP2  NI    BCNTRLSW,X'FD'          RESET 2ND BRANCH BIT             13360017
         CALL  HMOVE,(THIRDBUF,SECNDBUF,LNGTHBF2)                       13410017
         MVC   LNGTHBF3(4),LNGTHBF2    MOVE LENGTH OF DATA              13460017
STRCOP3  NI    BCNTRLSW,X'FE'          RESET 1ST BRANCH BIT             13510017
         L     R9,HDECBIN+8       GET SYSUT1 DCB ADDRESS         A35449 13560020
         L     R10,HDECBIN+16     GET SYSUT1 IOB ADDRESS         A35449 13610020
         LH    R10,14(R10)        GET RESIDUAL COUNT             A35449 13660020
         LH    R9,62(R9)           GET BLKSIZE FROM DCB          A35449 13710020
         SR    R9,R10             CALCULATE LENGTH LAST BLOCK    A35449 13760020
         ST    R9,LNGTHBF1        SAVE THIS LENGTH               A35449 13810020
         CALL  HMOVE,(SECNDBUF,FIRSTBUF,LNGTHBF1)                       13910017
         MVC   LNGTHBF2(4),LNGTHBF1    MOVE LENGTH                      13960017
         TM    BCNTRLSW,X'04'          BRANCH REQUIRED                  14010017
         BO    STRCOP4                 YES-BRANCH                       14060017
         L     R6,THIRDBUF                                              14110017
         BAL   R12,CHTOTEXT            TOTALING?                        14160017
         BAL   R12,HWRITE              WRITE                            14210017
STRCOP4  NI    BCNTRLSW,X'FB'          RESET THIRD BRANCH BIT           14260017
         L     R5,FIRSTBUF             LOAD INPUT BUFF ADDRESS          14310017
         BAL   R12,HREAD                                                14360017
         L     R5,SECNDBUF                                              14410017
         BAL   R12,TSTDATAX            TEST DATA EXIT                   14460017
         B     STRCOP1                                                  14510017
         LA    R1,HMSGTDR                                               14560017
         SLL   R1,8                                                     14610017
         LA    R4,7                                                     14660017
         B     HOUP2J                                                   14710017
********                                                                14760017
STRCPEOD L     R15,LNGTHBF1            LOAD LENGTH OF READ DATA         14770017
         LTR   R15,R15                 TEST FOR ZERO                    14780017
         BZ    OKMESG                  NO DATA READ - RETURN            14790017
         L     R15,LNGTHBF3            LOAD LENGTH OF WRITTEN DATA      14800017
         LTR   R15,R15                 TEST FOR ZERO                    14810017
         BZ    EODMVBF2                NO WRITES DONE - BRANCH          14820017
         CHECK  HDECBOUT               CHECK LATEST WRITE               14830017
EODMVBF2 CALL  HMOVE,(THIRDBUF,SECNDBUF,LNGTHBF2)                       14840017
         MVC   LNGTHBF3(4),LNGTHBF2                                     14910017
         L     R6,THIRDBUF                                              14960017
         BAL   R12,CHTOTEXT            CHECK TOTALING EXIT              15010017
         BAL   R12,HWRITE              WRITE LAST BLOCK                 15060017
         CHECK HDECBOUT                CHECK THE WRITE                  15110017
         L     R0,LNGTHBFS             LOAD TOTAL LENGTH OF BUFFER UL0I 15120019
         FREEMAIN  R,LV=(0),A=FIRSTBUF FREE BUFFER SPACE           UL0I 15130019
         B     OKMESG                  WRITE EOD MSG AND RETURN         15160017
*                                                                       15210017
HWRITE   L     R10,LNGTHBF3                                             15260017
         WRITE HDECBOUT,SF,HDCBOUT,(6),(10)                             15310017
         BR    R12                                                      15360017
GENCOPAD DC    V(GENS3COP)                                              15410017
FIRSTBUF DC    F'0'                                                     15460017
SECNDBUF DC    F'0'                                                     15510017
THIRDBUF DC    F'0'                                                     15560017
LNGTHBF1 DC    F'0'                                                     15610017
LNGTHBF2 DC    F'0'                                                     15660017
LNGTHBF3 DC    F'0'                                                     15710017
LNGTHBFS DC    F'0'                    TOTAL BUFFER LENGTH         UL0I 15730019
BCNTRLSW DC    X'FF'                                                    15760017
********                                                                15810017
S3COLDAT BAL   R14,INOUTSET                                             15860017
HINP1    L     R5,HIN1AD           PREPARE REGS FOR PROCESSING          15910017
         L     R6,HOU2AD           RECORDS BY LOADING BUFFER ADDRS      15960017
HINP1A   ST    R6,HOU2AD                INITIALIZE OUTPUT XR            16010017
         MVC   CPYSWSAV(1),HCOPYSW                                      16060017
         TM    HCOPYSW,X'FF'            EDITING WITH IDENT              16110017
         BO    HINP1A1                                                  16160017
         BM    HINP1A1                                                  16210017
         L     R9,HRDTCUR               YES                             16260017
         TM    0(R9),X'20'              EDITING THIS RECORD             16310017
         BO    HINP1A1                  YES                             16360017
         OI    HCOPYSW,HCOPYMSK         NO, SET COPY SWITCH             16410017
HINP1A1  L     R1,HDCBINA                                               16460017
         L     R5,HIN1AD                LOAD INPUT ADDRESS              16510017
         GET   (1),(5)                                                  16560017
         L     R11,HDCBINA   LOAD SYSUT1 DCB ADDRESS            PTM5314 16610020
         TM    RECFM(R11),X'80'    RECFM FIXED OR UNDEFINED ?   PTM5314 16660020
         BZ    GETVARLE           NO, GET LRECL OUT OF BLK.     PTM5314 16710020
         LH    R10,LRECL(R11)          FROM DCB                         16760017
         B     HINP3N                                                   16810017
GETVARLE LH    R10,0(R5)               FOR U AND V GET LRECL FROM       16860017
         LA    R5,4(,R5)     UPDATE POINTER TO REC.             PTM5314 16870020
HINP3N   ST    R10,HBLIN               WORK AREA AND STOR               16910017
         STH   R10,HRLIN                STORE RECORD LENGTH             16960017
         LH    R7,HRLIN                 RESET INPUT ARS                 17010017
         STH   R7,HWK2                                                  17060017
HINP7A   L     R12,HDCBINA             LOAD INPUT DCB ADDRESS           17260017
         CLC    HWK2(2),LRECLINP   IS REC CNT GR. THAN INL REC ? A45145 17310021
         BH    HINER2              YES--PERM INPUT ERROR         A45145 17410021
         TM    RECFM(12),X'80'     RECFM EQ. F OR U ?            A45145 17460021
         BO    TESTFU              YES, SKIP V TEST              A45145 17470021
         CLC   HWK2(2),HH4              IS REC CT LESS THAN 4           17510017
         BNH   HINER2                   YES--PERM INPUT ERROR           17610017
         B     HINP7A3             SKIP U TEST                   A45145 17660021
TESTFU   CLC   HWK2(2),HH0         LRECL EQ ZERO ?               A45145 17670021
         BE    TESTU               YES, TEST RECFM               A45145 17680021
         B     HINP7A3             CONT NORM PROCCESS.           A45145 17690021
TESTU    TM    HINORG,X'20'        INPUT RECFM=U ?               A45145 17700021
         BNO   HINER2              NO, PERM. INP. ERROR          A45145 17702021
         TM    17(12),X'50'        INPUT DEV. IS PAPER TAPE ?    A45145 17704021
         BNO   HINER2              NO, PERM. INP. ERROR          A45145 17706021
         B     HINP1A1             YES, GET NEXT RECORD          A45145 17708021
HINP7A3  TM    HCOPYSW,HCOPYMSK    PREDICT 1ST OUTPUT REC LENGTH A45145 17710021
         BZ    HINP8                    IF COPY,                        17810017
         BAL   R12,ANYBODY              SET HRLPRE                      17910017
HINP7B   NOP   HOUP1                                                    18010017
         OI    HINP7B+1,X'F0'           FIRST TIME THROUGH,             18110017
HINP7C   LA    R8,0                                                     18210017
         TM    HOUORG,X'80'             IF F-TYPE , DO NOT ADJUST       18310017
         BO    HOUP1                    XR AND ARS                      18410017
         LA    R8,4(,R8)                ADJUST XR AND ARS               18510017
         MVC   2(2,R6),HH0         ZERO THE RECORD BB FIELD             18610017
         B     HINP7B                   BEFORE OUTPUT                   18710017
HINP8    NOP   HOUP1                    IF EDIT,GO TO HPRL              18810017
         BAL   R12,HPREDLEN             PREDICT LENGTH OF FIRST REC GRP 18910017
         OI    HINP8+1,X'F0'                                            19010017
         B     HINP7B                                                   19110017
HOUP1    BAL   R12,ANYBODY              SET HRLPRE                      19210017
HOUP1A   B     HOUP4                   BYPASS PUT RTN 1ST TIME   A33312 19310020
         AH    R8,HRLPRE               ADD DATA COUNT            A33312 19410020
         B     HOUP2C                                                   19510017
HOUP2J   AR    R1,R4                                                    19610017
         L     R15,HWRMSGA                                              19710017
         BALR  R14,R15                                                  19810017
         B     HTERMU                   TERMINATE                       19910017
HOUP2C   TM    HOUORG,X'80'             IF F-TYPE LOAD RECORD           20010017
         BO    HOUP2E                   LENGTH IN DCB                   20110017
         B     HOUP3                                                    20210017
HOUP2E   TM    HOUORG,X'80'                                             20310017
         BZ    HOUP3                                                    20410017
         L     R10,HDCBOUTA            MODIFY DCB LENGTH                20510017
         LTR   R8,R8                                                    20610017
         BC    8,NOWRITE                                                20710017
         STH   R8,LRECL(R10)                                            20810017
         B     HOUP3                                                    20910017
HOUP3    ST    R8,HBLOUAC                                               21010017
         L     R6,HOU2AD                SET XR TO OUTPUT AREA           21110017
         BAL   R12,CHTOTEXT                                             21210017
         B     HOUP3B3                                                  21310017
CHTOTEXT TM    TOTLEXSW,X'80'          TEST TOTALING EXIT               21410017
         BZ    HOUP3B2                 NO EXT - BRANCH                  21510017
         ST    R6,TOTLAREA             POINTTOTAL ROUT. TO BUFFER  UL0I 21610018
         LA    R1,TOTLAREA             LOAD ADDRESS OF PARAMETERS       21710017
         L     R15,ADTOTEXR            LOAD ADDRESS OF USER ROUT.       21810017
         BALR  R14,R15                                                  21910017
         CH    R15,HCONCODE            UPDATE HIGHEST COND.CODE         22010017
         BL    HOUP3B1                 IF                               22110017
         STH   R15,HCONCODE            NESSECARY                        22210017
HOUP3B1  CH    R15,SIXTEEN             RETRN CODE = SIXTEEN?            22310017
         BE    TOTMSG1                 YES-TERMINATE                    22410017
         CH    R15,EIGHT               RETURN CODE=EIGHT?               22510017
         BE    TOTMSG2                 YES-GO TO END OF DATA            22610017
         CH    R15,FOUR                RETRNCODE=FOUR                   22710017
         BE    HOUP3B2                 YES-BRANCH                       22810017
         B     TOTMSG3                                                  22910017
HOUP3B2  BR    R12                                                      23010017
HOUP3B3  DS    0H                                                       23110017
         L     R1,HDCBOUTA                                              23210017
         PUT   (1),(6)                                                  23310017
         L     R10,HMDTCUR              LOAD MEMBER TRUE NAME           23510017
         MVC   HSTOWAR(8),2(R10)        LOAD MEMBER TRUE NAME           23710017
         XC    HSTOWAR+8(4),HSTOWAR+8   ZERO OUT C BYTE                 23910017
NOWRITE  EQU   *                                                        24110017
         TM    HSTOWSW,X'FF'           DISC OR TAPE ?                   24310017
         BZ    HOUP3F                  NO STOW, GO TO HOUP3F            24510017
HOUP3C   BAL   R12,HSTOW                STOW TRUE NAME                  24710017
         LH    R11,0(R10)               LOAD ALIAS COUNT                24910017
         LA    R10,10(,R10)             UPDATE MDT XR                   25110017
         LTR   R11,R11                                                  25310017
         BZ    HOUP3E                                                   25510017
HOUP3D   MVI   HSTOWAR+11,X'80'         SET ALIAS BIT IN C BYTE         25710017
         MVC   HSTOWAR(8),0(R10)        LOAD ALIAS                      25910017
         BAL   R12,HSTOW                STOW ALIAS                      26110017
         LA    R10,8(,R10)              UPDATE MDT XR                   26310017
         BCT   R11,HOUP3D                                               26510017
HOUP3E   ST    R10,HMDTCUR              STORE UPDATED MDT ADDRESS       26710017
         NI    HSTOWSW,X'00'            TURN OFF STOW SWITCH            26910017
HOUP3F   NOP   HOUP4F                   SWITCH FOR EOD                  27110017
         L     R6,HOU2AD                RESET OUTPUT XR                 27310017
         LA    R8,0                    RESET OUTPUT ARS                 27510017
         TM    HOUORG,X'80'            IF V OR U                        27710017
         BO    HOUP4B                  ADJUST                           27910017
         LA    R8,4(,R8)                AND ARS                         28110017
HOUP4    NOP   HOUP4F             BRANCH WHEN EOD IS REACHED     A48738 28310021
         NI    HOUP1A+1,X'0F'     RESET FIRST TIME SWITCH        A48738 28360021
         TM    HOUORG,X'80'             IF F-TYPE DO NOT                28410017
         BO    HOUP4B                   ADJUST XR AND ARS               28510017
HOUP4A   LH    R9,HRLPRE                LET RECORD COUNT                28610017
         LA    R9,4(,R9)                FIELD REFLECT                   28710017
         STH   R9,HALFWORK              PLACE LENGTH IN STORAGE         28810017
         MVC   0(2,R6),HALFWORK         MOVE LENGTH INTO CT FIELD       28910017
         MVC   2(2,R6),HH0         ZERO BLOCK BB FIELD                  29010017
         LA    R6,4(,R6)                DISPLACE PAST RECORD COUNT      29110017
HOUP4B   ST    R6,HIXOUT                STORE CURR REC ADDR FOR SYSUT1  29210017
         ST    R5,HIXIN                 AND SYSUT2                      29310017
         BAL   R12,TSTDATAX                                             29410017
         B     HOUP4C1                                                  29510017
TSTDATAX L     R9,HEXITTA              LOAD USER EXIT TABLE ADDRESS     29610017
         ST    R12,SAVER12                                              29710017
         LTR   R9,R9                    IF NO EXITS,                    29810017
         BZ    HOUP4C                   SKIP TEST                       29910017
         CLI   40(R9),X'40'                                             30010017
         BE    HOUP4C                   IF USER DATA EXIT,LINK          30110017
         LA    R9,40(R9)               SET UP ADDERSS                   30210017
         L     R12,HDCBINA                                              30310017
         LR    R11,R5                   USER EXIT TABLE                 30410017
         LINK  EPLOC=(9),PARAM=((11),(12))                              30510017
         SR    R1,R1                                                    30610017
         BAL   R12,HTSTTRM              TEST FOR TERMINATION REQ        30710017
         B     HOUP4C                   NO                              30810017
         LA    R1,HMSGTDR               YES                             30910017
         SLL   R1,8                                                     31010017
         LA    R4,7                     MESSAGE ID 7                    31110017
         B     HOUP2J                   WRITE MESSAGE AND TERMINATE     31210017
HOUP4C   L     R12,SAVER12                                              31310017
         BR    R12                                                      31410017
HOUP4C1  TM    HCOPYSW,HCOPYMSK        TEST COPY SWITCH                 31510017
         BZ    HOUP4D                                                   31610017
HOUP4M   BAL   R12,HRIDTST                                              31710017
         MVC   HWK4+2(2),HRLPRE                                         31810017
         CALL  HMOVE,(HIXOUT,HIXIN,HWK4) SYSUT1 BUFF2 TO SYSUT2 BUFF2   31910017
         B     HOUP4E                                                   32010017
HOUP4D   BAL   R12,HRIDTST              MOVE REC WITH EDITING           32110017
         MVC   HWK2(2),HRLPRE           HWK2=DATA COUNT                 32210017
HOUP4X   CALL  HEDIT,(HEDCUR,HIXOUT,HIXIN,HWK2,HLITTA)                  32310017
         B     HOUP4E                   NORMAL RETURN FROM EDITOR       32410017
         B     HPREDLN2                 ERROR RETURN FROM EDITOR        32510017
HOUP4E   AH    R6,HRLPRE                UPDATE XR                       32610017
HOUP4F   TM    HEODSW,HEODMSK           IF PROCESSING TO END AT EOD,    32710017
         BO    HOUP5A                   OMIT LAST RECORD CHECK          32810017
         CLI   HRIDSW,X'FF'             TEST FOR LAST REC OF GROUP      32910017
         BE    HOUP5B                                                   33010017
HOUP5A   NOP   HOUP9              GO CLOSE AT EOD                       33110017
         B     HINP1A1                                                  33210017
HOUP5B   L     R9,HRDTCUR                                               33310017
         ST    R9,HRDTSAV                                               33410017
         TM    HPOID,X'02'              PDS?                            33510017
         BZ    HOUP5D                   NO                              33610017
         TM    HMEMBYT(R9),X'0F'        END OF MEMBER?                  33710017
         BZ    HOUP5F                   NO                              33810017
         OI    HSTOWSW,X'FF'            SET STOW SWITCH                 33910017
HOUP5D   TM    0(R9),X'9F'              IF PDS,IS LAST CNTRL            34010017
         BZ    HOUP5D1                  CARD A MEMBER CARD              34110017
         BM    HOUP5D1                                                  34210017
         OI    HEODSW,HEODMSK           YES, PROCESS TO EOD             34310017
         B     HINP1A1                                                  34410017
HOUP5D1  TM    0(R9),X'8F'              SET UP                          34510017
         BZ    HOUP5F                   FOR                             34610017
         BM    HOUP5F                   END OF                          34710017
         OI    HEODSW,HEODMSK           DATA ROUTINES                   34810017
HOUP5E   NOP   HOUP9                                                    34910017
         OI    HOUP5E+1,X'F0'                                           35010017
         LA    R1,HMSGPELR              WRITE MESSAGE PROCESSING ENDED  35110017
         SLL   R1,8                     AT LAST REC ID                  35210017
         ST    R6,SIXSV                 SAVE REG6                       35310017
         L     R6,AST                   LOAD **** IN REG6               35410017
         L     R15,HWRMSGA              WRITE                           35510017
         BALR  R14,R15                  MESSAGE                         35610017
         L     R6,SIXSV                 RESTORE REG6                    35710017
       SR   R4,R4                                                       35810017
         B     HEOD                                                     35910017
HOUP5F   LA    R9,12(,R9)               UPDATE RDT XR                   36010017
         ST    R9,HRDTCUR               AND STORE                       36110017
         CLI   CPYSWSAV,X'00'           EDITING WITH IDENT              36210017
         BNE   HOUP5F1                  NO                              36310017
         B     HOUP5F2                  YES, CHECK LAST RECORD          36410017
HOUP5F1  TM    HCOPYSW,HCOPYMSK         EDITING                         36510017
         BO    HINP1A1                                                  36610017
         B     HOUP5G                                                   36710017
HOUP5F2  L     R9,HRDTSAV               CHECK LAST RECORD               36810017
         TM    0(R9),X'4F'              LAST IDENT                      36910017
         BZ    HOUP5F3                                                  37010017
         BM    HOUP5F3                                                  37110017
         L     R9,HEDCUR                YES                             37210017
HCHKFLD  TM    0(R9),X'80'              LAST FIELD THIS RECORD          37310017
         BO    HLSTFLD                  YES                             37410017
         LA    R9,8(,R9)                NO, INCREMENT IX                37510017
         B     HCHKFLD                  CHECK AGAIN                     37610017
HLSTFLD  TM    0(R9),X'81'              LAST RECORD FIELD               37710017
         BM    HCPYREV                  NO                              37810017
RAUNCH   OI    HEODSW,HEODMSK           YES,SET TO PROCESS EOD          37910017
         B     HOUP5E                   DO LAST WRITE                   38010017
HCPYREV  MVI   CPYSWSAV,X'FF'           RESET SWITCHES                  38110017
         OI    HEODSW,HEODMSK           PROCESS TO EOD                  38310017
         B     HOUP5G                                                   38410017
HOUP5F3  L     R9,HRDTCUR               GET NEXT RECORD                 38510017
         TM    0(R9),X'20'              EDITING                         38610017
         BO    HRESET1                  YES                             38710017
         OI    HCOPYSW,HCOPYMSK         NO,SET COPY SWITCH              38810017
         B     HRESET2                                                  38910017
HRESET1  MVI   HCOPYSW,X'00'            SET FOR EDITING                 39010017
HRESET2  L     R9,HRDTSAV               GET LAST RECORD                 39110017
         TM    0(R9),X'20'              WAS THERE EDITING               39210017
         BO    HOUP5G                   YES                             39310017
         L     R9,HRDTCUR               RELOAD RDT IX                   39410017
         B     HINP1A1                                                  39510017
HOUP5G   MVC   HEDCUR(4),HEDSV          GET NEXT EDT                    39610017
         L     R9,HRDTCUR               RELOAD RDT IX                   39710017
         BAL   R12,HPREDLEN                                             39810017
         B     HINP1A1                                                  39910017
HOUP9    L     R0,REGSAV               GET BUFFER CORE LENGTH AND       40010017
         LTR   R0,R0               WAS BUFFER CORE GOTTEN               40110017
         BZ    DONTFREE            IF NOT, BRANCH AROUN FREEMAIN        40210017
         L     R1,HIN1AD             BUFFER CORE ADDRESS FOR FREEMA     40410017
       FREEMAIN R,LV=(0),A=(1)                                          40510017
DONTFREE CLI   HTERMSW,X'FE'       USER TERMINATION REQUEST             40610017
         BNE   HOUP10                   NO,RETURN                       40710017
         B     HGENP4A                  YES,TERMINATE                   40810017
HOUP10   CLI   TYPMSG,X'10'                                             40910017
         BE    OKMESG                                                   41010017
CLOSAFTR LM    R13,R14,HSAVE13                                          41110017
         LH    R15,HCONCODE             LOAD CONDITION CODE IN REG15    41210017
         RETURN (2,12)                                                  41310017
*                                                                       41410017
*                                                                       41510017
HSTOW    L     R1,HDCBOUTA                                              41610017
         STOW  (1),HSTOWAR,A                                            41710017
         SLL   R15,20                                                   41810017
         SRL   R15,20                                                   41910017
         LTR   R15,R15                  TEST FOR ERROR                  42010017
         BCR   8,R12                    NO,RETURN                       42110017
         LA    R15,12                   YES,CONCODE 12                  42210017
         STH   R15,HCONCODE             SAVE ERROR CONCODE              42310017
         LA    R1,HMSGERS               WRITE MESSAGE                   42410017
         SLL   R1,8                     AND TERMINATE                   42510017
         LA    R4,10              MESSAGE ID FOR STOW ERROR             42610017
HSTOW3   AR    R1,R4                                                    42710017
         L     R15,HWRMSGA                                              42810017
         BALR  R14,R15                                                  42910017
         B     HOUP9                                                    43010017
*                                                                       43110017
HREAD    READ  HDECBIN,SF,HDCBIN,(5),'S'                                43210017
         BR    R12                                                      43310017
*                                                                       43410017
HPREDLEN CALL  HPRL,(TOTEDIT,HEDCUR,HEDSV)                              43510017
ANYBODY  TM    HCOPYSW,HCOPYMSK         IS EDIT REQUESTED               43610017
         BO    NOEDIT                   NO                              43710017
         CLC   TOTEDIT(2),HRLOU         YES-DOES EDIT EXCEED OUTLRECL   43810017
         BH    HPREDLN2                 YES--INVALID,TERMINATE          43910017
         TM    HOUORG,X'80'             NO-IS OUTPUT FIXED FORMAT       43990017
         BO    HABLE                    YES                             44070017
         LH    R9,TOTEDIT          NO, EDIT COUNT BECOMES LRECL         44150017
         TM    HOUORG,X'40'       OUTPUT VARIABLE ?              A48746 44160021
         BNO   COMMON             NO, UNDEFINED                  A48746 44170021
         LA    R9,4(R9)           YES, LOAD TOTAL EDIT PLUS FOUR A48746 44180021
         CH    R9,HRLOU           ED. PL. FOUR EXC. OUTP. LRCL.? A48746 44190021
         BH    HPREDLN2           YES, PERM OUTPUT ERROR         A48746 44200021
         LH    R9,TOTEDIT         NO, CONTINUE                   A48746 44210021
         B     COMMON              GO STORE LRECL AND RETURN            44230017
NOEDIT   CLC   HWK2(2),LRECLOUT   INP. REC. EXC. OUTP. LRECL ?   A48746 44310021
         BH    HPREDLN2           YES, PRINT MSG IEB309I         A48746 44330021
         TM    HINORG,X'40'       INPUT RECFM = V / VS ?         A48746 44332021
         BO    NOEDIT2            YES, CHECK OUTPUT              A48746 44334021
NOEDIT2  TM    HOUORG,X'40'       OUTPUT RECFM VARIABLE ?        A48746 44350021
         BO    AROUND              TES, GO PREPARE COUNT                44390017
         TM    HOUORG,X'80'        IS OUTPUT FIXED FORMAT               44470017
         BO    HABLE               YES, GO GET LRECL                    44550017
         LH    R9,HRLIN            NOT V OR F, FORMAT IS U              44630017
COMMON   STH   R9,HRLPRE           DATA COUNT TO HRLPRE                 44710017
         BR    R12                 RETURN TO CALLER                     44790017
AROUND   LH    R9,HWK2             RECORD COUNT                         44870017
         TM    HINORG,X'40'        IS INPUT RECFM V OR VB               44950017
         BC    14,COMMON           IF NOT, BRANCH                       45030017
         SH    R9,HH4              IF INPUT IS V, ADJUST LRECL          45110017
         B     COMMON              GO STORE RECORD COUNT AND RETURN     45190017
HABLE    LH    R9,HRLOU            OUTPUT LRECL BECOMES COUNT           45270017
         B     COMMON              GO STORE COUNT AND RETURN            45350017
         BR    R12                      RETURN                          45430017
HPREDLN2 LA    R15,12                   LOAD CONCODE 12 IN REG15        45510017
         STH   R15,HCONCODE             AND STORE                       45590017
         LA    R1,HMSGUOE         LOAD MSG IEB309I TEXT DISPL.   A48746 45670021
         SLL   R1,8                                                     45750017
         LA    R4,9               LOAD MSG IEB309I NUMBER        A48746 45830021
         B     HSTOW3                                                   45910017
*                                                                       45990017
HRIDTST  TM    HEODSW,HEODMSK           TEST FOR LAST REC OF GROUP      46070017
         BCR   1,R12                    CHECK                           46150017
         NI    HRIDSW,X'00'                                             46230017
         L     R9,HRDTCUR               FOR                             46310017
         LH    R10,HRIDL(R9)            IDENT FIELD                     46390017
         BCTR  R10,0                    IN RECORDS                      46470017
         STC   R10,HRIDTST2+1                                           46550017
         LH    R11,HRIDST(R9)                                           46630017
         AR    R11,R5                                                   46710017
HRIDTST2 CLC   HRID(1,R9),0(R11)                                        46790017
         BCR   7,R12                                                    46870017
         OI    HRIDSW,X'FF'                                             46950017
         BR    R12                                                      47030017
*                                                                       47110017
HTERMU   LH    R15,HCONCODE                                             47190017
         B     HOUP9                                                    47270017
*                                                                       47350017
*    THIS SUBROUTINE CHECKS CONDITION CODES TO DETERMINE WHICH CODE     47430017
*    WILL BE PASSED BACK TO THE CALLING PROGRAM.                        47510017
*                                                                       47590017
HTSTTRM  SLL   R15,20                   TEST FOR 16 IN R15              47670017
         SRL   R15,20                                                   47750017
         LTR   R1,R1                                                    47830017
         BZ    HTSTTRM4                                                 47910017
         LA    R0,16                                                    47990017
         CR    R0,R15                                                   48070017
         BNE   HTSTTRM2                                                 48150017
HTSTTRM1 LA    R12,4(,R12)                                              48230017
         LTR   R1,R1                                                    48310017
         BZ    HTSTTRM2                                                 48390017
         BR    R12                                                      48470017
HTSTTRM2 SRL   R15,2                    ROUND DOWN                      48550017
         SLL   R15,2                                                    48630017
         LH    R0,HCONCODE                                              48788421
         CR    R0,R15                   IF OLD CONCODE IS HIGH          48790017
         BCR   10,R12                   OR EQUAL,RETURN                 48870017
         LA    R0,16                                                    48950017
         CR    R15,R0                                                   49030017
         BNH   HTSTTRM3                                                 49110017
         LR    R15,R0                                                   49190017
HTSTTRM3 STH   R15,HCONCODE             OTHERWISE STORE NEW CONCODE     49270017
         BR    R12                      BEFORE RETURNING                49350017
HTSTTRM4 LA    R0,12                                                    49430017
         CR    R0,R15                                                   49510017
       BH     HTSTTRM2                                                  49590017
         B     HTSTTRM1                                                 49670017
*                                                                       49750017
TOTMSG1  LA    R1,30                   LOAD MSG INDICATION              49830017
         BAL   R14,TOTMSG4             LINK TO WRITE ROUTINE            49910017
         B     HTERMU                  BRANCH TO TERMINATE              49990017
TOTMSG2  LA    R1,31                   LOAD MSG INDICATION              50070017
         BAL   R14,TOTMSG4             LINK TO WRITE ROUTINE            50150017
         B     HOUP9                   BRANCH TO END OF PROCESSING UL0I 50230018
TOTMSG3  LA    R1,32                   LOAD MSG INDICATION              50310017
         BAL   R14,TOTMSG4             LINK TO WRITE ROUTINE            50390017
         NI    TOTLEXSW,X'7F'                                           50470017
         B     HOUP3B2                 CONTINUE                         50550017
TOTMSG4  STM   R14,R15,R14SAVE         SAVE REG 14 & 15                 50630017
         LR    R4,R1                   LOAD MSG INDICATION IN REG4      50710017
         SLL   R1,8                                                     50790017
         AR    R1,R4                                                    50870017
         L     R15,HWRMSGA             LOAD WRITER ROUTINE ADDRESS      50950017
         BALR  R14,R15                 LINK                             51030017
         L     R5,R14SAVE+4            LOAD RETURNCODE                  51110017
         SR    R4,R4                                                    51190017
         LA    R1,10                   DETERMINE FIRST                  51270017
         DR    R4,R1                   AND SECOND DIGIT                 51350017
         L     R1,VADDR3               LOAD ADDRESS OF MESSAGE          51430017
         LA    R4,240(R4)              MAKE                             51510017
         LA    R5,240(R5)              EBDIC-CODE                       51590017
         STC   R5,21(R1)               STORE FIRST DIGIT                51670017
         STC   R4,22(R1)               STORE SECOND DIGIT          UL0I 51750018
         LA    R1,25                   LOAD MSG CODE                    51830017
         SLL   R1,8                    AND                              51910017
         LA    R4,25                   OFFSET                           51990017
         AR    R1,R4                                                    52070017
         L     R15,HWRMSGA             LOAD ADDRESS OF MSG WRITER  UL0I 52110018
         BALR  R14,R15                 LINK                             52150017
         LM    R14,R15,R14SAVE         RESTORE REG 14 & 15              52230017
         BR    R14                     RETURN                           52310017
HGENP4A  LA    R1,HMSGTLR                                               52390017
         SLL   R1,8                                                     52470017
         LA    R4,5                                                     52550017
ERRORPNT AR    R1,R4                                                    52630017
         L     R15,HWRMSGA                                              52710017
         BALR  R14,R15                                                  52790017
         B     HTERMU                                                   52870017
*                                                                       52950017
HEOD     DS    0H                                                       53030017
         TM    HSTOWSW,X'FF'                                            53110017
         BC    5,HOUP3C                                                 53190017
         BP    HOUP3C                   PROCESSING SWITCHES             53270017
     OI    HOUP3F+1,X'F0'                                               53350017
         OI    HOUP4+1,X'F0'      SET EOD SWITCH                 A48738 53390021
         OI    HOUP5A+1,X'F0'                                           53430017
         TM    HOUP5E+1,X'F0'           DO NOT WRITE EOD MESS IF LAST   53510017
         BO    HEODA                    REC ID MESS ALREADY WRITTEN     53590017
     NI  HRIDSW,X'00'                                                   53670017
         ST    R6,SIXSV                                                 53750017
         MVI   TYPMSG,X'10'                                             53830017
         B     HEODA                                                    53910017
OKMESG   LA    R1,HMSGPEOD                                              53990017
         SLL   R1,8                                                     54070017
         L     R6,AST                                                   54150017
         L     R15,HWRMSGA                                              54230017
         BALR  R14,R15                                                  54310017
         B     CLOSAFTR                                                 54390017
HEODA    S     R8,HKEYLOU               END OF DATA                     54470017
         TM    HPOID,X'02'              ROUTINE FOR                     54550017
         BZ    HEOD1                    PDS                             54630017
         OI    HSTOWSW,X'FF'                                            54710017
HEOD1    TM    HOUORG,X'40'             END OF DATA                     54790017
         BZ    HEOD2                    FOR VARIABLE                    54870017
         AH    R8,HH4                                                   54950017
HEOD2    B     HOUP1A                                            A33312 55030020
*                                                                       55110017
HINER    EQU   *                        INPUT SYNAD ROUTINE             55190017
         ST    R10,SYNADSAV            SAVE REG 10               A22671 55200018
         STM   R3,R4,SYNADSAV+4        SAVE REGS 3AND4           A22671 55210018
         ST    R12,SYNADSAV+12         SAVE REG 12               A22671 55220018
         ST    R14,HSAVE14             SAVE REG14                A22671 55230018
         BAL   R14,SYNADAFR            LINK TO SYNADAF ROUTINE   A27717 55630019
         B     HOUER1                  TEST USER ERROR EXIT      A27717 56030019
HINER2   LA    R15,12                   LOAD CONCODE 12 IN REG 15       56550017
         STH   R15,HCONCODE             AND STORE                       56630017
         LA    R1,HMSGUIE               WRITE ERROR MSG AND TERMINATE   56710017
         SLL   R1,8                                                     56790017
         LA    R4,8                     MESSAGE ID 8                    56870017
         B     HSTOW3                                                   56950017
HINER3   LA    R15,12                  LOAD CON CODE 12 IN REG 15A27717 56970019
         STH   R15,HCONCODE            AND STORE                 A27717 56990019
         B     HOUP9                                             A27717 57010019
*                                                                       57030017
HOUER    EQU   *                        OUTPUT SYNAD ROUTINE            57110017
         ST    R10,SYNADSAV            SAVE REG 10               A22671 57112018
         STM   R3,R4,SYNADSAV+4        SAVE REGS 3AND4           A22671 57114018
         ST    R12,SYNADSAV+12         SAVE REG 12               A22671 57116018
         ST    R14,HSAVE14             SAVE REG14                A22671 57118018
         BAL   R14,SYNADAFR            LINK TO SYNADAF ROUTINE   A27717 57119019
         TM    TOTLEXSW,X'80'          TOTALING EXIT ACTIVE        UL0I 57120018
         BZ    HOUER1                  NO - BRANCH                 UL0I 57130018
         ST    R0,TOTLAREA+8           STORE STATUS INFO ADDRESS   UL0I 57140018
         MVI   TOTLAREA+8,X'80'         SET FLAG BYTE              UL0I 57150018
         STM   R0,R1,SAVER01           SAVE REGS 0 AND 1           UL0I 57160018
         LA    R1,TOTLAREA             PARM LIST FOR TOTALING      UL0I 57170018
         L     R15,ADTOTEXR            LOAD ROUTINE ADDRESS AND    UL0I 57180018
         BALR  R14,R15                 LINK                        UL0I 57190018
         LM    R0,R1,SAVER01           RESTORE REGISTERS           UL0I 57200018
HOUER1   L     R10,HEXITTA             EXIT LIST                   UL0I 57210018
         LTR   R10,R10                                                  57270017
         BZ    HINER3A                 SKIP TO SYNADRLS          A48809 57350021
         CLI   56(R10),X'40'           TEST FOR USER EXIT               57430017
         BE    HINER3A                 SKIP TO SYNADRLS          A48809 57510021
         LA    R10,56(R10)             YES-LINK TO USER                 57590017
         LR    R4,R0                                                    57670017
         LR    R3,R1                                                    57750017
         OI    IOERREXI,X'F0'     SET IOERREXI  BYTE             A48809 57800021
         LINK  EPLOC=(10),PARAM=((4),(3))                               57830017
HINER3A  SYNADRLS                 FRMAIN WORKAR AND REST REG 13  A48809 57880021
         TM    IOERREXI,X'F0'     USER EXIT ?                    A48809 57890021
         BNO   HINER3             NO, END PROCESSING             A48809 57900021
         SR    R1,R1                                                    57910017
         BAL   R12,HTSTTRM              TEST TERMINATION REQUEST        57990017
         B     RETFSYN                 RETURN TO SYSTEM          A22671 58070018
         LA    R1,HMSGTER               WRITE ERROR MSG AND TERMINATE   58150017
         SLL   R1,8                                                     58230017
          LA   R4,12                                                    58430017
         B     HOUP2J                                                   58630017
SYNADAFR STM   R14,R1,SAVER141          SAVE SYNAD PARAMETERS    A27717 58680019
         L     R10,GENCOPAD                                      A27717 58730019
         TM    0(R10),X'80'            TEST STRAIGHT COPY SWITCH A27717 58780019
         BZ      QSYNADAF              SWITCH NOT ON -QSAM-BRANCHA27717 58830019
         SYNADAF  ACSMETH=BSAM                                   A27717 58880019
         B     SYNAFR1                 BRANCH AROUND QSAM        A27717 58930019
QSYNADAF SYNADAF  ACSMETH=QSAM                                   A27717 58980019
SYNAFR1  L     R10,SYNADMSA            LOAD ADDRESS OF MSG       A27717 59030019
         MVC   10(79,R10),49(R1)        MOVE SYNAD INFO TO MSG   A27717 59080019
         LA    R1,50                   LOAD MSG OFFSET           A27717 59180019
         SLL   R1,8                                              A27717 59230019
         LA    R1,51(R1)               ADD MSG ID                A27717 59280019
         L     R15,HWRMSGA             LOAD WRITER ADDRESS       A27717 59330019
         BALR  R14,R15                 LINK TO WRITER            A27717 59380019
         LM    R14,R1,SAVER141         RESTORE SYNAD PARAMETRS   A27717 59430019
         BR    R14                     RETURN                    A27717 59480019
*                                                                A27717 59530019
SAVER141 DS    4F                                                A27717 59580019
SYNADMSA DC    V(SYNADMSG)                                       A27717 59630019
*                                                                A27717 59680019
* THIS ROUTINE RETURNS CONTROL TO THE SYSTEM IF THE USERS EXIT   A22671 59850018
* ACCEPTS THE BAD RECORD , AND RETURNS A RETURN CODE OF LESS     A22671 59870018
* THAN TWELVE                                                    A22671 59890018
RETFSYN  L     R10,SYNADSAV            RESTORE REG10             A22671 59910018
         LM    R3,R4,SYNADSAV+4        RESTORE REGS 3 AND 4      A22671 59930018
         L     R12,SYNADSAV+12         RESTORE REG12             A22671 59950018
         L     R14,HSAVE14             RESTORE REG 14            A22671 59970018
         RETURN  ,                                               A22671 59990018
*                                                                       60030017
INOUTSET L     R3,HEXITTA               EXIT LIST                       60230017
         CLI   48(R3),X'40'            TEST FOR KEY EXIT                60430017
         BZ    TSTDEV2                  NO KEY EXIT                     60630017
         LA    R1,27                   LOAD MSG OFFSET                  60730017
         SLL   R1,8                    AND                              60830017
         LA    R1,27(R1)               MSG ID.                          60930017
         L     R15,HWRMSGA                                              61030017
         BALR  R14,R15                 AND WRITE MSG.                   61130017
         LA    R15,4                   LOAD RETURN CODE = 4             61160017
         STH   R15,HCONCODE            STORE RETURN CODE                61190017
TSTDEV2  SR    R4,R4               SET UP TO DETERMINE                  61230017
         SR    R5,R5                   BUFFER LENGTH                    61330017
         L     R12,HDCBOUTA                                             61430017
         TM    17(R12),X'20'           IS UT2 DEVICE=DA                 61530017
         BZ    TSTDEV1             IF NOT, BRANCH                       61630017
         OI    KEYOUTSW,X'02'       SET UT2 EQUALS DA SWITCH            61730017
TSTDEV1  AH    R5,62(R12)              ADD OUTPUT BLKSI TO KEYLEN       61830017
         L     R12,HDCBINA                                              61930017
         TM    17(R12),X'20'           IS UT1 DEVICE=DA                 62030017
         BZ    NOINKEY             IF NOT, BRANCH                       62130017
         OI    KEYOUTSW,X'04'      SET UT1 EQUALS DA SWITCH             62230017
NOINKEY  L     R1,HDCBOUTA   LOAD SYSUT2 DCB ADDRESS            PTM5314 62330020
         LH    R4,LRECL(R12) LOAD LRECL SYSUT1                  PTM5314 62380020
         STH   R4,LRECLINP   STORE INPUT LRECL(BLKSI WHEN U)     A45145 62390021
         LH    R5,LRECL(R1)  LOAD LRECL SYSUT2                  PTM5314 62430020
         STH   R5,LRECLOUT        STORE OUTPUT LRECL             A48746 62450021
         TM    HCOPYSW,HCOPYMSK   IS IT STRAIGHT COPY   ?       PTM5314 62480020
         BZ    GETMAIN1      NO, DO NOT CHECK FOR INCONS.LRECL. PTM5314 62530020
         CR    R5,R4         LRECL UT2 GREATER UT1 LRECL  ?  L. PTM5314 62580020
         BE    GETMAIN1           NO, EQUAL                      A45131 62630021
         TM    RECFM(R1),X'80'    INPUT RECFM=U/F ?              A45131 62650021
         BO    SKWARNIN           YES, SKIP WARNING MESSAGE      A45131 62670021
         TM    RECFM(R12),X'80'   OUTPUT RECFM=U/F ?             A45131 62690021
         BO    SKWARNIN           YES, SKIP WARNING MESSAGE      A45131 62710021
         STM   R14,R0,SAVEPRI          WARNING                  PTM5314 62730020
         LA    R1,WARNING              MESSAGE                  PTM5314 62780020
          L    R15,HCDWRA              FOR INCONSISTENT         PTM5314 62830020
         BALR  R14,R15                 LRECL'S                  PTM5314 62880020
         LM    R14,R0,SAVEPRI                * GETMAIN          PTM5314 62930020
SKWARNIN CR    R5,R4              OUTP. LRECL GREATER            A45131 62980021
         BH    *+6                THEN INPUT LRECL ?             A45131 63010021
         LR    R5,R4              NO, SET GETM FOR UT1=UT2 LRECL A45131 63040021
         LR    R4,R5              YES, SET GETM FOR UT2=UT1 LRCL A45131 63070021
GETMAIN1 AR    R5,R4              ADD INPUT AND OUTPUT LRECL     A48746 63110021
         LA    R5,32(R5)          ADD 32 TO TOTAL                A48746 63120021
         ST    R5,REGSAV          STORE TOTAL BUFF. LENGTH       A48746 63122021
         GETMAIN R,LV=(5)         GETMAIN INPUT + OUTPUT BUFF.   A48746 63180021
         ST    R1,HIN1AD          STORE INPUT BUFFER ADDRESS     A48746 63230021
         AR    R1,R4              ACCOUNT   OUTPUT               A48746 63280021
         LA    R1,16(R1)          BUFFER ADDRESS                 A48746 63290021
         ST    R1,HOU2AD          STORE OUTPUT BUFFER ADDRESS    A48746 63330021
         NI    HOU2AD+3,X'F8'     ROUND DOWN TO ASS DBLW. BOUN.  A48746 63380021
OMPREREC L      R4,HDCBINA              ADDR OF SYSUT1 DCB              63630017
         L     R5,HDCBOUTA             ADDR OF SYSUT2 DCB               63730017
         MVC   HINORG(1),RECFM(R4)      MOVE SYSUT1 RECFM               63830017
         MVC   HOUORG(1),RECFM(R5)      MOVE SYSUT2 RECFM               63930017
         NI    HINORG,X'D8'            LEAVE ATTRIBUTES                 64030017
         NI    HOUORG,X'D8'            LEAVE ATTRIBUTES                 64130017
         CLC   HINORG(1),HOUORG         COMPARE RECFM'S                 64230017
         BNE   CMPREBLK                 RECFM'S NOT EQUAL               64330017
         OI    KEYOUTSW,X'08'           TURN ON EQUAL RECFM BIT         64430017
CMPREBLK CLC   BLKSI(2,R4),BLKSI(R5)    COMPARE B1KSIZES                64530017
         BNE   BUFFMV                  BLKSIZES NOT EQUAL               64630017
         OI    KEYOUTSW,X'10'           TURN ON EQUAL BLKSIZE BIT       64730017
BUFFMV   MVC   HBLIN+2(2),LRECL(R4)   MOVE INPUT AREA LENGTH            64830017
         MVC   HBLOU(2),LRECL(R5)      MOVE IUTPUT AREA LENGTH          65130017
         TM    KEYOUTSW,X'08'      ARE THE RECFM'S EQUAL                65430017
         BZ    UNEQREC             BRANCH IF UNEQUAL                    65730017
         TM    HINORG,X'40'        IS SYSUT1 RECFM V,VB, OR U           66030017
         BO    OUTVARBL            YES, GO COMPARE BLKSIZE'S            66330017
INFOUTF  TM    HCOPYSW,HCOPYMSK    IS EDITING REQUESTED                 66630017
         BZ    CKLRECL             YES, GO STORE LRECLS                 66930017
         CLC   LRECL(2,R4),LRECL(R5)                                    67230017
         BNE   ERROR                    LRECL'S NOT EQUAL               67630017
         B     CKLRECL                                                  68030017
OUTVARBL TM    HCOPYSW,HCOPYMSK         TEST IF FIELD SPECIFIED         68430017
         BZ    CKLRECL             YES, GO SET UP LRECL FIELD           68520017
         TM    HOUORG,X'48'            SYSUT2 SPANNED                   68610017
         BO    CKLRECL                 YES-BRANCH                       68700017
         CLC   BLKSI(2,R5),LRECL(R4)   COMP. SUT2 BLOCK TO SUT1         68790017
         BL    ERROR                   LRECL-LOW-BRANCH                 68880017
         B     CKLRECL                                                  68960017
         BH    ERROR                    SYSUT2 BLKSIZE TOO SMALL        69040017
         BZ    CKLRECL             YES, GO SET UP LRECL FIELD           69120017
UNEQREC  TM    HINORG,X'10'             TEST IF SYSUT1 BLOCKED          69210017
         BZ    INNOTBLK                 SYSUT1 NOT BLOCKED              69300017
         TM    HINORG,X'40'             TEST UT1 FOR VAR BLOCK          69390017
         BZ    TSTUT2                   SYSUT1 IS FIX BLOCK             69480017
         OI    RECFMSW,X'30'            TURN ON UT1 EQUAL TO VB         69570017
INNOTBLK TM    HINORG,X'C0'             TEST UT1 FOR U TYPE             69660017
         BM    FIXORVAR                 UT1 IS FIXED OR VAR             69750017
         OI    RECFMSW,X'10'            TURN ON UT1 EQUAL TO U TYPE     69840017
FIXORVAR TM    HINORG,X'80'             TEST UT1 FOR FIXED              69930017
         BO    TSTUT2                   UT1 IS FIXED                    70020017
         OI    RECFMSW,X'20'            TURN ON UT1 EQUAL TO VAR        70110017
TSTUT2   TM    HOUORG,X'10'             TEST SYSUT2 FOR BLOCKED         70200017
         BZ    OTNOTBLK                 SYSUT2 NOT BLOCKED              70290017
         TM    HOUORG,X'40'             TEST UT2 FOR VAR BLK            70380017
         BZ    SWSET                                                    70470017
         OI    RECFMSW,X'03'           UT2 IS A VARIBLE                 70560017
         B     SWSET                                                    70650017
OTNOTBLK TM    HOUORG,X'C0'             TEST UT2 FOR U TYPE             70740017
         BM    OFXORVAR                 SYSUT2 IS FIXED OR VAR     6597 70830017
         OI    RECFMSW,X'01'            TURN ON UT2 EQUAL TO U TYPE     70920017
         B     SWSET                                                    71010017
OFXORVAR TM    HOUORG,X'80'             TEST UT2 FOR FIXED              71100017
         BO    SWSET                                                    71190017
         OI    RECFMSW,X'02'            TURN ON UT2 EQUAL TO VAR        71280017
SWSET    SR    R6,R6                                                    71370017
         IC    R6,RECFMSW                                               71460017
*                  RECFM SW   1 BYTE                                    71550017
*        INPUT                            OUTPUT                        71640017
*        (HALF BYTE)                     (HALF BYTE)                    71730017
*        0       FIXED OR FIXED BLK     0                               71820017
*         1       UNDEFINED TYPE        1                               71910017
*        2        VARIBLE TYPE          2                               72000017
*        3       VARIBLE BLK TYPE       3                               72090017
         SRDL  R6,4                     MOVE SYSUT2 BITS TO REG 7       72180017
         SRL   R7,28                    RIGHT ALIGN UT2 BITS            72270017
         LTR   R6,R6                    TST UT1 FOR F OR FB             72360017
         BNE   VARIN                    UT1 IS A VARIBLE                72450017
         LTR   R7,R7                    TEST UT2 FOR F OR FB            72540017
         BZ    INFOUTF                  UT1 AND UT2 ARE F OR FB         72630017
         B     FINVOUT                  UT1 IS F OR FB - UT2 IS VAR     72720017
VARIN    TM    HCOPYSW,HCOPYMSK         TEST IF FIELD SPECIFIED         72810017
         BZ    CKLRECL             YES, GO SET UP LRECL FIELD           72900017
         LTR   R7,R7                    TEST UT2 FOR F OR FB            72990017
         BZ    ERROR                    VAR IN, F OR FB OUT             73080017
         LH    R4,LRECL(R4)            LOAD  SYSUT1 LRECL               73170017
         LH    R5,BLKSI(R5)            SUSUT2 BLKSOZE                   73260017
FIXGOOD  AR    R6,R7                    ADD UT2 RECFM TO UT1 RECFM      73350017
         SH    R6,THREE                                                 73440017
         SRL   R7,1                                                     73530017
         CR    R6,R7                                                    73620017
         BE    TST7ZRO                  UT1 IS R,V (0),OR U,VB (1)      73710017
*  REG6     REG7   REG7(SHIFT)   REG6+REG7                              73800017
*   0  F,FB 0        0         (6 NOT EQUAL 7)                          73890017
*   1   U   1        0              1   F,FB TO U  OR U TO F,FB         73980017
*   2   V   2        1              2   F,FB TO V  OR V TO F,FB         74070017
*   3  VB   3        1              3   F,FB TO VB OR VB TOF,FB         74160017
*                                   4   U TO VB OR VB TO U              74250017
*                                   5   V TO VB OR VB TO V              74340017
*                                                                       74430017
         BH    TST7ONE                                                  74520017
         B     ADD8                UT1 IS U, AND UT2 IS V               74610017
TST7ZRO  LTR   R7,R7               TEST REG 7 FOR ZERO                  74700017
         BZ    MINUS8              UT1 IS V AND UT2 IS U                74790017
ADD8     LA    R4,4(R4)                BUMP SYSUT1 LRECL                74880017
         B     COMPARE                                                  74970017
MINUS8  LA    R5,4(R5)                BUMP SYSUT2 BLOVKSIZE             75060017
         B     COMPARE                                                  75150017
TST7ONE  LTR   R7,R7                    TEST 7 FOR ZERO                 75240017
         BZ    MINUS8                   SYSUT1 IS VB - SYSUT2 IS U      75330017
         B     COMPARE             GO COMPARE BLKSIZES                  75420017
FINVOUT  TM    HCOPYSW,HCOPYMSK        TEST IF FIELD SPECIFIED          75510017
         BZ    CKLRECL                                                  75590017
         LH    R5,BLKSI(R5)            SYSUT2 BLKSIZE                   75670017
         LH    R4,LRECL(R4)            SYSUT1 LRECL                     75750017
         BCT   R7,ADD8             BRANCH IF UT2  IS V OR VB            75830017
COMPARE  TM    HOUORG,X'48'            IS OUTPUT SPANNED                75910017
         BO    CKLRECL                 YES-BR ANCH                      75990017
         CR    R5,R4                   COMPARE UT2 BLKSI-UT1 LRECL      76070017
         BL    ERROR                   LOW-BRANCH                       76150017
CKLRECL  L     R12,HDCBINA                                              76230017
         LH    R4,82(R12)              INPUT LRECL                      76310017
         L     R12,HDCBOUTA                                             76390017
         LH    R5,82(R12)              OUTPUT LRECL                     76470017
         LTR   R4,R4               IS INPUT LRECL ZERO                  76550017
         BNE   CKLRECL2            IF NOT, STORE LRECL                  76630017
         L     R12,HDCBINA                                              76710017
         LH    R4,62(R12)              INPUT BLOCKSIZE                  76790017
         TM    36(R12),X'40'           INPUT RECFM  V                   76870017
         BC    14,CKLRECL2         IF NOT, STRE BLKSIZE                 76950017
         SH    R4,HH4              DECREMENT BLKSIZE BY 4 FOR LRECL     77030017
CKLRECL2 STH   R4,HRLIN            STORE INPUT LRECL                    77110017
         LTR   R5,R5               IS OUTPUT LRECL ZERO                 77190017
         BNE   CKLRECL4            IF NOT, GO STORE LRECL               77270017
         L     R12,HDCBOUTA                                             77350017
         LH    R5,62(R12)              OUTPUT BLOCKSIZE                 77430017
         TM    36(R12),X'40'           OUTPUT RECFM V                   77510017
         BC    14,CKLRECL4         IF NOT, STORE BLKSIZE                77590017
         SH    R5,HH4              DECREMENT BLKSI BY 4 FOR V           77670017
CKLRECL4 STH   R5,HRLOU            STORE LRECL                          77750017
         TM    HINORG,X'C0'             TEST IF U TYPE                  77850017
         BC    12,NEXT                  BRANCH NOT U TYPE               77950017
         NI    HINORG,X'1F'        TURN OFF U AND TRKOVRFL BITS         78050017
         OI    HINORG,X'20'             TURN ON 2 BIT FOR U TYPE        78150017
NEXT     TM    HOUORG,X'C0'             TEST IF U TYPE                  78250017
         BC    12,GOBACK                BRANCH NOT U TYPE               78350017
         NI    HOUORG,X'1F'        TURN OFF U AND TRK OVRFL BITS        78450017
         OI    HOUORG,X'20'             TURN ON 2 BIT FOR U TYPE   6598 78530017
GOBACK   BR    R14                                                 6598 78610017
ERROR    LA    R1,HMSGDCB              MESSAGE CODE                6598 78690017
         SLL   R1,8                                                     78770017
         LA    R4,11                   MESSAGE ID                  6598 78850017
         LA    R15,12                                              6598 78930017
         STH   R15,HCONCODE            RETURN CODE OF 12           6598 79010017
         B     ERRORPNT                PRINT MESSAGE               6598 79090017
* FOR A CHANGE IN RECFM'S AND NO FIELD SPECIFIED, THE FOLLOWING HOLDS * 79170017
*  THE SYSUT2 BLKSIZE AND LRECL IS DEPENDENT ON SYSUT1 AND THE RECFM'S* 79250017
*  INPUT        OUTPUT    OUTPUT BLOCK                                * 79330017
* 1 F/FB        VS                                                      79410017
* 2  F/FB       VBS                                                     79490017
* 3  VS         VS                                                      79570017
* 4  VBS        VBS                                                     79650017
* 5  U          VS                                                      79730017
* 6  U          VBS                                                     79810017
* 8  VS         VBS                                                     79890017
* 9  VBS        U       EQAUL OR GREATER THAN SYSUT1LRECL               79970017
* A  VBS        VS                                                      80050017
* B  VS         V       EQUAL OR GREATER THEN SYSUT1 LRECL              80130017
* C  VBS        V       EQAUL OR GREATER THAN SYSUT1 LRECL              80210017
* D  VS         VB      EQAUL OR GREATER THAN SYSUT1 LRECL              80290017
* E  VBS        VB      EQAUL OR GREATER THAN SYSUT1 LRECL              80370017
* F  V          VS                                                      80450017
*10  V          VBS                                                     80530017
*11  VB         VS                                                      80610017
*12  VB         VBS                                                     80690017
HINTB    DC    3F'0'                   INPUT BUFFER- WORK AREA     6598 80770017
HKEYL    EQU   HINTB                                                    80850017
HBLIN    EQU   HINTB+4                                                  80930017
HRLIN    EQU   HINTB+8                                                  81010017
HINORG   EQU   HINTB+10                                                 81090017
HOUTB    DC    3F'0'                    OUTPUT BUFFER- WORK AREA        81170017
HKEYLOU  EQU   HOUTB                                                    81250017
HBLOU    EQU   HOUTB+4                                                  81330017
HRLOU    EQU   HOUTB+8                                                  81410017
HOUORG   EQU   HOUTB+10                                                 81490017
HPOID    EQU   HOUTB+11                                                 81570017
*                                                                       81650017
         DS    0D                                                       81730017
         DC    CL8'SUP.AREA'            SUPERZAP DEBUGGING              81810017
         DC    18F'0'                   AREA                            81890017
HGENPRS  DS    18F                      WORK AREA                       81970017
HSAVE13  DS    2F                      R13,R14 SAVE AREA         A22671 82050018
HSAVE14  DS    1F                       REG 14 SAVE AREA                82130017
HSTOWAR  DS    3F                                                       82210017
SAVEPRI  DS    4F            SAVE REG BEFORE PR. A MESS.        PTM5314 82260021
HIN1AD   DS    1F                       SYSUT1 BUFF1 ADDR SAVE AREA     82290017
HIN2AD   DS    1F                       SYSUT1 BUFF2 ADDR SAVE AREA     82370017
HOU1AD   DS    1F                       SYSUT2 BUFF1 ADDR SAVE AREA     82450017
HOU2AD   DS    1F                       SYSUT2 BUFF2 ADDR SAVE AREA     82530017
HEDSV    DS    1F                                                       82610017
HIXIN    DS    1F                                                       82690017
HIXOUT   DS    1F                                                       82770017
HBLOUAC  DS    1F                                                       82850017
HWK4     DC    F'0'                                                     82930017
HRDTSAV  DC    F'0'                                                     83010017
HRLPRE   DS    1H                                                       83090017
HWK2     DS    1H                                                       83170017
HKEYA    DS    1F                                                       83250017
LABPOLAT DS    2F                      LABEL POOL ADDRESSES             83330017
TOTLAREA DC    4F'0'                   TOTALING PARM LIST          UL0I 83380018
SAVER01  DC    2F'0'                                               UL0I 83430018
SYNADSAV DS    4F                      AREA TO SAVE REGS IN SYNADA22671 83460018
HEXITTA  DS    1F                       USER EXIT TABLE ADDR LOC        83490017
HMDTCUR  DS    1F                                                       83570017
HEDCUR   DS    1F                                                       83650017
HRDTCUR  DS    1F                                                       83730017
HLITTA   DS    1F                                                       83810017
HCOPYSW  DS    0C                       COPY SWITCH                     83890017
HEODSW   DS    1C                       END OF DATA SWITCH              83970017
LRECLINP DS    1H         INPUT LRECL(BLKSI WHEN RECFM=U)        A45145 84020021
LRECLOUT DC    H'0'               OUTPUT LRECL                   A48746 84025021
WARNING DC CL120'WARNING:INPUT AND OUTPUT LRECL ARE INCONSISTENT' M5314 84030021
         EXTRN HDCBOUT                                                  84050017
         EXTRN HDCBIN                                                   84130017
HDCBOUTA DC    V(HDCBOUT)                                               84210017
VADDR3   DC    V(HMSGRETC)                                              84290017
HDCBINA  DC    V(HDCBIN)                                                84370017
STHEODAD DC    A(STRCPEOD)                                              84450017
HEODAD   DC    A(HEOD)                                                  84530017
HINERAD  DC    A(HINER)                                           M2461 84550018
HOUERAD  DC    A(HOUER)                                           M2461 84570018
ADTOTEXR DC    F'0'                                                     84610017
SIXTEEN  DC    H'16'                                                    84690017
FOUR     DC    H'4'                                                     84770017
EIGHT    DC    H'8'                                                     84850017
R14SAVE  DS    2F                                                       84930017
SAVER12  DC    F'0'                                                     85010017
TOTLEXSW DC    X'00'                                                    85090017
LABPROSW DS    1C                      LABEL PROCESSING SWITCH          85170017
KEYOUTSW DC    X'00'                    ATTRIBUTE SWITCH           6598 85250017
THREE    DC    H'3'                     CONSTANT                   6598 85330017
RECFMSW  DC    X'00'                                               6598 85410017
HSTOWSW  DC    X'00'                    STOW SWITCH                     85490017
HRIDSW   DC    X'00'                                                    85570017
HTERMSW  DC    X'00'                    TERMINATION SWITCH              85650017
HWRMSGA  DC    V(HWRMSG)                MSG WRITER SUBR ADDR LOC        85730017
HCDWRA   DC    V(HCDWR)      ADDRESS  MESSAGE  ROUTINE          PTM5314 85780020
HCONCODE DC    H'0'                     CONDITION CODE SAVE AREA        85810017
HH0      DC    H'0'                                                     85890017
HH2      DC    H'2'                                                     85970017
HH4      DC    H'4'                                                     86050017
TOTEDIT  DC    H'0'                                                     86130017
HALFWORK DS    1H                                                       86210017
SIXSV    DS    1F                       REG6 SAVE AREA                  86290017
REGSAV   DC    F'0'                SAVES LENGTH FOR BUFFER FREEMAIN3599 86370017
AST       DC   C'****'                                                  86450017
HCOPYMSK EQU   X'F0'                    COPY MASK                       86530017
HEODMSK  EQU   X'0F'                    END OF DATA MASK                86610017
HPTRMSK  EQU   X'00'                                                    86690017
BLANKS   DC    X'4040'                                                  86770017
CPYSWSAV DC    X'00'                                                    86850017
TYPMSG   DC    X'00'                                                    86930017
IOERREXI DC    X'00'              IOERROR EXIT BYTE              A48809 86980021
HRIDL    EQU   0                                                        87010017
HRIDST   EQU   2                                                        87090017
HRID    EQU   4                                                         87170017
HMEMBYT  EQU   0                                                        87250017
HMSGIIP  EQU   1                        MESSAGE CODES                   87330017
HMSGECC  EQU   2                                                        87410017
HMSGBNA  EQU   4                                                        87490017
HMSGTLR  EQU   5                                                        87570017
HMSGTKR  EQU   6                                                        87650017
HMSGTDR  EQU   7                                                        87730017
HMSGTER  EQU   8                                                        87810017
HMSGERS  EQU   9                                                        87890017
HMSGUOE  EQU   10                                                       87970017
HMSGUIE  EQU   11                                                       88050017
HMSGDCB  EQU   12                                                  6598 88130017
HMSGPELR EQU   13                                                       88630017
HMSGPEOD EQU   14                                                       89130017
HMSGBLK1 EQU   17                      NO INPUT BLKSIZE SPECIFIED       89630017
HMSGBLK2 EQU   18                      NO OUTPUT BLKSIZE SPECIFIED      90130017
HINDD    EQU   24                                                       90630017
HOUDD    EQU   32                                                       91130017
         ENTRY HGENPS3                                                  91630017
         DCBD  DSORG=PS                                                 92130017
DDNAM    EQU   DCBDDNAM-IHADCB                                          92630017
OFLGS    EQU   DCBOFLGS-IHADCB                                          93130017
DSORG    EQU   DCBDSORG-IHADCB                                          93630017
BLKSI    EQU   DCBBLKSI-IHADCB                                          94130017
KEYLE    EQU   DCBKEYLE-IHADCB                                          94630017
BUFL     EQU   DCBBUFL-IHADCB                                           95130017
RECFM    EQU   DCBRECFM-IHADCB                                          95630017
LRECL    EQU   DCBLRECL-IHADCB                                          96130017
EODADOFS EQU   DCBEODAD+1-IHADCB                                        96630017
SYNADOFS EQU   DCBSYNAD-IHADCB                                          97130017
         END                                                            97630017
