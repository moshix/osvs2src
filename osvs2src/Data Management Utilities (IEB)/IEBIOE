  TITLE  'IEBIOE - IEBCOPY EXCP I/O ERROR ROUTINE'                      00400019
*D276000                                                         A34431 00450000
*C753000                                                         A41780 00500000
*A698100-698800,736100-736120                                    A44144 00510000
*C339000,374000,524000,577000,668000,711311                      A44144 00520000
*D711385-711445                                                  A44144 00530000
*A461500,461600,745500                                         @YA02574 00540002
*********************************************************************** 00550000
         SPACE 1                                                        00600000
IEBIOE   CSECT                                                          00800019
* 76000,676000-677000,708000-711000,714000,729000,753510         X010XX 01010000
*                                                                     * 01600019
*TITLE-  IEBIOE  I/O ERROR ANALYSIS ROUTINE FOR READ OR WRITE ERRORS. * 02000019
*              ON INPUT, OUTPUT OR SYSUT3 OR SYSUT4 DATA SETS.        * 02400019
*                                                                     * 02800019
*STATUS- CHANGE LEVEL 001                                             * 03200019
*                                                                     * 03600019
*FUNCTION/OPERATION-  ISSUES SYNADAF                                  * 04000019
*          PREPARES SYNADAF MESSAGE THEN GIVES IT                     * 04400019
*          ANALYSIS ERROR CONDITION                                   * 04800019
*          SETS PROPER SWITCHES                                       * 05200019
*          IN THE CASE OF AN UNLOAD OPERATION IT FLAGS THE       X010XX 05250000
*          UNLOADED DATASET AS NOT LOADABLE AND GIVES MESSAGE    X010XX 05300000
*          ISSUES SYNADRLS                                            * 05600019
*          RETURNS TO CALLER OR ENTERS TERMINATE ROUTINE              * 06000019
*                                                                     * 06400019
*ENTRY POINTS- IEBIOE                                                 * 06800019
*              IEBIOE2 -LOAD END OF FILE                         X010XX 06850000
*                      -UNLOAD BLOCKSIZE ERROR                   X010XX 06900000
*              IEBIOE3 -LOAD SYNAD ROUTINE                       X010XX 06950000
*              IEBIOE4 -UNLOAD SYNAD ROUTINE                     X010XX 07000000
*                                                                     * 07200019
*INPUT - IEBIOE-  REGISTER 5 POINTS TO IOB                       X010XX 07600000
*        IEBIOE3,IEBIOE4- PARAMETERS IN REGS 0 AND 1             X010XX 07650000
*                                                                     * 08000019
*OUTPUT- MESSAGES TO PRINTER                                          * 08400019
*        SWITCHES SET                                                 * 08800019
*                                                                     * 09200019
*EXITS-  RETURN TO CALLER IF 'SOFT' ERRORS.                           * 09600019
*        ENTER IEBVTM TERMINATE ROUTINE IF 'HARD' ERRORS.             * 10000019
*                                                                     * 10400019
*EXTERNAL ROUTINES- IEBVMS                                            * 10800019
*                                                                     * 11200019
*TABLES/WORK AREAS- SYNADAF BUFFER                                    * 11600019
*                                                                     * 12000019
*ATTRIBUTES- SERIALLY REUSEABLE                                       * 12400019
*                                                                     * 12800019
         EJECT                                                          13200019
*                                                                     * 13600019
*                         GENERAL REGISTERS                           * 14000019
*                                                                     * 14400019
         SPACE 1                                                        14800019
GR0   EQU 0                                                             15200019
GR1   EQU 1                                                             15600019
GR2   EQU 2                                                             16000019
GR3   EQU 3                                                             16400019
GR4   EQU 4                            IEBMCA POINTER                   16800019
GR5   EQU 5                            ADDRESS OF IOB                   17200019
GR6   EQU 6                                                             17600019
GR7   EQU 7                                                             18000019
GR8   EQU 8                                                             18400019
GR9   EQU 9                                                             18800019
GR10     EQU   10                      BASE REGISTER TO MESSAGE CSECT   19200019
GR11  EQU 11                                                            19600019
GR12     EQU   12                      MAIN BASE REGISTER               20000019
GR13     EQU   13                                                       20400019
GR14     EQU   14                                                       20800019
GR15     EQU   15                                                       20900019
         SPACE 1                                                        21000019
         USING IEBIOE,GR15             ADDRESSABILITY FOR SYNADAF       21100019
         USING IEBMCA,GR4              ADDRESABILITY TO MCA             21200019
         USING DXIOB,GR5               ADDRESSABILITY TO IOB            21300019
         SPACE 1                                                        21400019
         SAVE  (14,12),,*              STANDARD LINKAGE                 21500019
         SPACE 1                                                        21600019
*    THE FOLLOWING MACRO PLACES AN ERROR MESSAGE IN A DYNAMIC           21700019
*  BUFFER, OBTAINS A SAVE AREA, AND LINKS THE NEW SAVE AREA WITH        21800019
*  THE OLD ONE                                                          21900019
         SPACE 1                                                        22000019
         SYNADAF  ACSMETH=EXCP,PARM1=(GR5)                              22100019
         SPACE 1                                                        22200019
         DROP  GR15                                                     22300019
         BALR  GR12,GR0                INITIALIZE BASE REGISTER         22400019
         USING START,GR12              ESTABLISH ADDRESSABILITY         22500019
START    EQU   *                                                        22600019
         L     GR10,AMSG               LOAD PTR TO MSG CSECT            22700019
         USING IEBIOEMG,GR10           ADDRESSABILITY TO MESG'S         22800019
         SPACE 1                                                        22850000
         OI    IOEF2,SNDFUSED+IOEFENT  INDICATE SYNADAF ISSUED   X010XX 22860000
*                                        AND IOE ENTERED         X010XX 22870000
         SPACE 1                                                        22880000
         MVI   MSGBUF,BLANK                                             22900019
         MVC   MSGBUF+P1(L120),MSGBUF  CLEAR MSG BUFFER                 23000019
         CLI   RCBUF,RC4               RETURN CODE GT THAN 4            23100019
         BNL   SETUP                   YES, GO AROUND                   23200019
         MVI   RCBUF,RC4               SET RETURN CODE = 4              23300019
SETUP    EQU   *                                                        23400019
         MVC   MSGBUF+P1(L7),IEBPRFX   SET UP MSG NUMBER                23500019
         MVC   MSGBUF+P9(L9),TEXT5     I/O ERROR                        23600019
         MVC   MSGBUF+P42(L78),X50(GR1) MOVE SYNADAF MSG TO BUFFER      23700019
         SPACE 1                                                        23800019
         TM    WSFLAG,RDGSW            READING                          23900019
         BO    SETREAD                 YES, GO ON                       24000019
         TM    FORM,ERASE              ERASING                          24100019
         BO    SETERS                  YES, GO ON                       24200019
         TM    TAG,TAG6                READ BACK CHECKING               24300019
         BO    SETRDCK                 YES, GO ON                       24400019
         SPACE 1                                                        24500019
         MVC   MSGBUF+P19(L14),WCN     ERROR PREFIX=WRITE               24600019
         B     GIVEMESS                GIVE MESSAGE                     24700019
         SPACE 1                                                        24800019
SETREAD  EQU   *                                                        24900019
         MVC   MSGBUF+P19(L13),RCN     ERROR PREFIX=READ                25000019
         B     GIVEMESS                GIVE ERROR MESSAGE               25100019
         SPACE 1                                                        25200019
SETERS   EQU   *                                                        25300019
         MVC   MSGBUF+P19(L14),ERSCON  ERROR PREFIX=ERASE               25400019
         B     GIVEMESS                GIVE ERROR MESSAGE               25500019
         SPACE 1                                                        25600019
SETRDCK  EQU   *                                                        25700019
         MVC   MSGBUF+P19(L22),RBCN    ERROR PREFIX=READBACK CHECK      25800019
         SPACE 1                                                        25900019
GIVEMESS EQU   *                                                        26000019
         MVI   MSG1,IOERF+LASTMSG      SET SYNAD MESSAGE+LAST           26100019
         BAL   GR9,GOVMS               GO TO MESSAGE WRITER             26200019
         SPACE 1                                                        26300019
         TM    WSFLAG,RDGSW            ERROR READING                    26400019
         BNO   WRITERR                 NO, GO TO WRITE ERROR ROUTINE    26500019
         EJECT                                                          26600019
*                                                                       26700019
*     THIS SECTION HANDLES READ ERRORS BY GIVING CONTROL TO             26800019
*  APPROPRIATE ROUTINES                                                 26900019
*                                                                       27000019
*     NOTE THAT TESTING FOR TYPE OF READ DONE MUST BE THE SAME AS       27030019
*  THE LOGIC IN MODULE IEBDRD                                           27060019
         SPACE 2                                                        27100019
         TM    SENSE,SENSE3            ONE RECORD AT A TIME PROCESSING  27200019
         BZ    CHECKMOR                NO, GO AROUND                    27300019
         TM    SENSE,SENSE2            READING NOTELIST                 27400019
         BO    INMRERR                 YES, GO HANDLE                   27500019
         TM    SENSE,SENSE1            READING FROM SYSUT3       A34431 27520020
         BO    UT3READ                 YES, GO HANDLE            A34431 27540020
         B     INMRERR                 MUST BE A RC REQUEST ON   A34431 27560020
*                                       THE INPUT DATA SET       A34431 27580020
*                                       HANDLE AS A MEMBER READ  A34431 27600020
*                                       ERROR                    A34431 27620020
CHECKMOR EQU   *                                                        27700019
         TM    STATUS,STAT4            INPUT MEMBER ERROR               27800019
         BO    INMRERR                 YES, GO HANDLE                   27900019
         TM    STATUS,STAT1            INPUT DIRECTORY ERROR            28000019
         BO    INDRERR                 YES, GO HANDLE                   28100019
         TM    STATUS,STAT2            OUTPUT DIRECTORY ERROR           28200019
         BO    OTDRERR                 YES, GO HANDLE                   28300019
         B     UT4READ                 MUST BE A SYSUT4 ERROR           28400019
         EJECT                                                          28500019
*                                                                       28600019
*     THIS ROUTINE HANDLES INPUT DIRECTORY READ ERRORS                  28700019
*                                                                       28800019
         SPACE 2                                                        28900019
INDRERR  EQU   *                                                        29000019
         MVI   IOEF1,ERF2              INDICATE INPUT DIRECTORY READ    29100019
*                                         ERROR                         29200019
         B     EXIT                    GO TO EXIT ROUTINE               29300019
         EJECT                                                          29400019
*                                                                       29500019
*     THIS ROUTINE HANDLES INPUT MEMBER DATA READ ERRORS                29600019
*                                                                       29700019
         SPACE 2                                                        29800019
INMRERR  EQU   *                                                        29900019
         L     GR3,IDEAD               LOAD PTR TO MEMBER NAME          30000019
         SPACE 1                                                        30100019
         MVC   MSGBUF+P1(L7),NUMB0     SET UP MESSAGE                   30200019
         MVC   MSGBUF+P10(L24),TEXT5                                    30300019
         MVC   MSGBUF+P20(L7),TEXT1                                     30400019
         MVC   MSGBUF+P35(L8),X0(GR3)                                   30500019
         SPACE 1                                                        30600019
         MVI   MSG1,IOERF+LASTMSG      SET SYNAD MESSAGE+LAST           30700019
         BAL   GR9,GOVMS               GO TO MSG WRITER                 30800019
         SPACE 1                                                        30900019
         BAL   GR9,TESTSTAT            CHECK FOR HARD OR SOFT ERROR     31000019
*                                      RETURN+0 = SOFT ERROR            31100019
*                                      RETURN+4 = HARD ERROR            31200019
         B     IGNORE                  SOFT ERROR, IGNORE               31300019
         SPACE 1                                                        31400019
         BAL   GR7,XTRAMSG             GO PRINT ONE MORE ERROR          31500019
*                                        MESSAGE                        31600019
         MVI   IOEF1,ERF3              INDICATE MEMBER READ ERROR       31700019
         B     EXIT                    GO TO EXIT ROUTINE               31800019
         EJECT                                                          31900019
*                                                                       32000019
*     THIS SECTION HANDLES OUTPUT DIRECTORY READ ERRORS                 32100019
*                                                                       32200019
         SPACE 2                                                        32300019
OTDRERR  EQU   *                                                        32400019
         MVI   IOEF1,ERF4              INDICATE AS OD READ ERROR        32500019
         NI    IOEF2,FF-ERF10          TURN OFF ERF10                   32600019
         B     EXIT                    GO TO EXIT ROUTINE               32700019
         EJECT                                                          32800019
*                                                                       32900019
*     THIS ROUTINE HANDLES SYSUT3 READ ERRORS                           33000019
*                                                                       33100019
         SPACE 2                                                        33200019
UT3READ  EQU   *                                                        33300019
         MVC   MSGBUF+P1(L7),NUMB2     SET UP MESSAGE                   33400019
         MVC   MSGBUF+P10(L29),TEXT3                                    33500019
         MVC   MSGBUF+P40(L16),SUFFIX                                   33600019
         SPACE 1                                                        33700019
         MVI   MSG1,IOERF+LASTMSG      SET SYNAD MESSAGE+LAST           33800019
         BAL   GR9,GOVMS8              GO TO MSG WRITER          A44144 33900000
         SPACE 1                                                        34000019
         MVI   IOEF1,ERF8              FLAG AS SYSUT3 READ ERROR        34100019
         TM    ULLDST,UNLOAD           UNLOAD OPERATION          X010XX 34110000
         BO    IOE00785                YES - GO TO EXIT RTN BUT  X010XX 34120000
*                                        SKIP TEST UNLOAD        X010XX 34122000
         TM    SENSE,SENSE8       DID VTT REQUEST I/O            A33287 34130020
         BO    EXIT                    YES, EXIT TO VTM          A33287 34160020
         TM    COMDCDSW,COMPRESS       COMPRESS OPERATION               34200019
         BZ    FLAGIT1                 NO, GO AROUND                    34300019
         TM    TAG,TAG8                LOOKING FOR HOLES - MCM          34330019
         BO    FLAGIT1                 YES, GO AROUND                   34360019
         SPACE 1                                                        34400019
         MVC   MSGBUF+P1(L78),TEXT6    SET UP INVALID DIRECTORY MSG     34500019
         MVI   MSG1,IOERF+LASTMSG      SET SYNAD+LAST MSG               34600019
         BAL   GR9,GOVMS               ISSUE ERROR MSG                  34700019
         B     EXIT                    GO TO EXIT ROUTINE               34800019
         SPACE 1                                                        34900019
FLAGIT1  EQU   *                                                        35000019
         MVI   VTMFLG1,IOERROR         INDICATE IOERROR                 35100019
         L     GR3,TABAD               FLAG APPROPRIATE CTLTAB ENTRY    35200019
         LA    GR2,X10                    AS DON'T COPY                 35300019
         SR    GR3,GR2                                                  35400019
         OI    X0(GR3),SEBIT4                                           35500019
         B     IGNORE                  GO TO EXIT ROUTINE               35600019
         EJECT                                                          35700019
*                                                                       35800019
*     THIS ROUTINE HANDLES SYSUT4 READ ERRORS                           35900019
*                                                                       36000019
         SPACE 2                                                        36100019
UT4READ  EQU   *                                                        36200019
         NI    IOEF1,FF-ERF4           ASSURE ERF4=0                    36300019
         OI    IOEF2,ERF10             INDICATE ERROR READING           36400019
*                                         FROM SYSUT4                   36500019
         TM    FLG7,DM                 DIRECTORY MERGE PHASE            36600019
         BO    DONTSET                 YES, LEAVE ERF4=0                36700019
         OI    IOEF1,ERF4              INDICATE SYSUT4 ERROR NOT IN     36800019
*                                         DIRECTORY MERGE PHASE         36900019
         B     EXIT                    GO TO EXIT ROUTINE               37000019
DONTSET  EQU   *                                                        37100019
         MVI   MSG1+P1,WODINC          INCMP DIRECTORY MSG              37200019
         MVI   MSG1,LASTMSG            SET LAST MESSAGE                 37300019
         BAL   GR9,GOVMS12             GO TO MESSAGE WTR         A44144 37400000
         B     EXIT                    GO TO EXIT ROUTINE               37500019
         EJECT                                                          37600019
*                                                                       37700019
*     THIS SECTION HANDLES WRITE ERRORS BY GIVING CONTROL TO            37800019
*  APPROPRIATE ROUTINES                                                 37900019
*                                                                       38000019
*     NOTE THAT TESTING FOR TYPE OF WRITE DONE MUST BE THE SAME AS      38030019
*  THE LOGIC IN MODULE IEBDWR                                           38060019
         SPACE 2                                                        38100019
WRITERR  EQU   *                                                        38200019
         TM    FORM,ERASE              ERASE ERROR                      38300019
         BO    OTMERS                  YES, GO HANDLE                   38400019
         SPACE 1                                                        38500019
         TM    TAG,TAG4                WRITE UT3 ERROR                  38600019
         BO    UT3WRITE                YES, GO HANDLE                   38700019
         TM    TAG,TAG1                WRITING ODB'S TO OUTPUT          38800019
         BO    OTDWERR                 YES, GO HANDLE                   38900019
         TM    TAG,TAG2                WRITING MEMBER DATA              39000019
         BO    OTMWERR                 YES, GO HANDLE                   39100019
         B     UT4WRITE                MUST BE A UT4 WRITE ERROR        39200019
         EJECT                                                          39600019
*                                                                       39700019
*     THIS ROUTINE HANDLES OUTPUT DIRECTORY WRITE ERRORS                39800019
*                                                                       39900019
         SPACE 2                                                        40000019
OTDWERR  EQU   *                                                        40100019
         L     GR3,WRPCICNT            LOAD NUMBER PCI'S TAKEN          40200019
         LTR   GR3,GR3                 IS IT ZERO                       40300019
         BZ    USEPTR1                 YES GO AROUND                    40400019
         SPACE 1                                                        40500019
         L     GR7,WRPTR2              LOAD ADDRESS OF WRITE NOT        40600019
*                                         EXECUTED (ATLEAST ONE PCI     40700019
*                                         TAKEN)                        40800019
         B     FINDBLOK                GO AROUND                        40900019
USEPTR1  EQU   *                                                        41000019
         L     GR7,WRPTR1              LOAD ADDRESS OF WRITE NOT        41100019
*                                         EXECUTED (NO PCI'S TAKEN)     41200019
         SPACE 1                                                        41300019
FINDBLOK EQU   *                                                        41400019
         L     GR6,X0(GR0,GR7)         LOAD FAILING CCW (POINTS TO      41500019
*                                         BLOCK NOT WRITTEN)            41600019
         LA    GR6,FIRSTNAM(GR0,GR6)   BUMP TO FIRST NAME IN BLOCK      41700019
         SPACE 1                                                        41800019
         MVC   MSGBUF+P1(L7),NUMB3     SET UP MESSAGE                   41900019
         MVC   MSGBUF+P10(L59),TEXT4                                    42000019
         MVC   MSGBUF+P18(L8),X0(GR6)                                   42100019
         MVC   MSGBUF+P70(L16),SUFFIX                                   42200019
         SPACE 1                                                        42300019
         TM    TAG,TAG6                RDBACK CHECKING                  42400019
         BNO   CHKCCWS                 NO, GO AROUND                    42450019
         MVC   MSGBUF+P18(L8),ASTERICS MOVE **'S TO BUFFER              42500019
         B     ISSUEMSG                ISSUE MSG                        42550019
         SPACE 1                                                        42600019
*   THE NUMBER OF PCI'S TAKEN IS NOW INSPECTED TO SEE IF THE VALUE      42800019
*  IS ATLEAST 2.  IF IT IS NOT, NO FURTHER ERROR RECOVERY IS POSSIBLE   43000019
*  SINCE THE LOCATION 'LASTGB' MAY CONTAIN GARBAGE.                     43200019
         SPACE 1                                                        43400019
CHKCCWS  EQU   *                                                        43600019
         L     GR3,WRPCICNT            LOAD NUMBER OF PCI'S TAKEN       43800019
         CH    GR3,TWOPCIS             HAVE ATLEAST TWO PCI'S BEEN      44000019
*                                        TAKEN                          44200019
         BL    ISSUEMSG                NO, CAN'T DO ANY MORE            44400019
         SPACE 1                                                        44600019
         LA    GR2,LASTGB              LOAD POINTER TO MBBCCHHR OF      44800019
*                                        LAST SUCCESSFULLY WRITTEN      45000019
*                                        BLOCK                          45200019
         SPACE 1                                                        45800019
         L     GR1,IOBWGHT                                              45900019
         LA    GR5,ERRIOB              CHANGE BASE REGISTER FOR IOB     46000019
         ST    GR1,IOBWGHT             STORE DCB PTR IN ERRORIOB        46100019
         ST    GR4,MCAADDR             STORE ADDR. OF IEBMCA   @YA02574 46130002
*                                      IN ERRORIOB             @YA02574 46160002
         MVC   DXDAADDR(L8),X0(GR2)    MOVE ADDRESS OF LAST GOOD        46200019
*                                        ODB TO SEEK ADDRESS            46300019
         LA    GR7,CCWS                PTR TO CCW CHAIN                 46400019
         ST    GR7,IOBSIOCC            STORE IN IOB                     46500019
         L     GR8,FLG1                PTR TO FIRST BUFFER              46600019
         LA    GR8,X0(GR0,GR8)          CLEAR HIGH ORDER BYTE           46700019
         ST    GR8,RDWRT               STORE IN CCW                     46800019
         MVI   RDWRT,RKD               RESTORE RKD                      46900019
         LA    GR9,FINDLAST            SET UP FOR LATER BRANCH          47000019
         SPACE 1                                                        47100019
EXCP     EXCP  (GR5)                   READ/WRITE A SINGLE BLOCK        47200019
         WAIT  ECB=ERRECB              WAIT FOR I/O COMPLETION          47300019
         CLI   ERRECB,OKCODE           I/O OK                           47400019
         BNE   ISSUEMSG                NO, CAN'T DO ANY MORE            47500019
         BR    GR9                     RETURN OR NSI                    47600019
         SPACE 1                                                        47700019
*    THE LAST DE IN BLOCK IS SEARCHED FOR AND REPLACED WITH FF'S        47800019
         SPACE 1                                                        47900019
FINDLAST EQU   *                                                        48000019
         LA    GR1,X2                  INITIALIZE COUNT OF BYTES        48100019
*                                        USED IN DB TO 2                48200019
         LA    GR7,MASK1F              PLACE MASK OF X'1F' IN REGISTER  48300019
         LA    GR6,X10(GR0,GR8)        PTR TO FIRST DE IN BLOCK         48400019
CMPLOOP  EQU   *                                                        48500019
         CLC   X0(L8,GR8),X0(GR6)      LAST ENTRY                       48600019
         BNH   GOTLAST                 YES, GO ON                       48700019
         SR    GR11,GR11                                                48800019
         IC    GR11,X11(GR0,GR6)       GET C OF TTRC                    48900019
         NR    GR11,GR7                CLEAR ALIAS AND USER TTR         49000019
*                                        INFORMATION                    49100019
*                                      (GR11 NOW CONTAINS NO. HALF-     49200019
*                                      WORDS OF USER DATA)              49300019
         AR    GR11,GR11               GET NO. BYTES OF USER DATA       49400019
         LA    GR11,X12(GR0,GR11)      ADD NAME LENGTH+TTRC LENGTH      49500019
         AR    GR6,GR11                BUMP TO NEXT DE                  49600019
         AR    GR1,GR11                UP COUNT OF DB BYTES USED        49700019
         B     CMPLOOP                 CONTINUE CHECKING                49800019
         SPACE 1                                                        49900019
GOTLAST  EQU   *                                                        50000019
         MVC   WKA1(L8),X0(GR8)        SAVE OLD KEY                     50100019
         MVI   X0(GR8),FF              SET KEY=FF'S                     50200019
         MVC   X1(L7,GR8),X0(GR8)                                       50300019
         SPACE 1                                                        50400019
         MVC   X0(L8,GR6),X0(GR8)      SET LAST ENTRY = FF'S            50500019
         XC    X8(L4,GR6),X8(GR6)      ZERO TTR6 FIELD OF LAST ENTRY    50600019
         LA    GR1,X12(GR0,GR1)        UP COUNT OF DB BYTES USED TO     50700019
*                                        INCLUDE FF'S ENTRY             50800019
         STH   GR1,WKA1+P8             STORE DB BYTE COUNT              50900019
         MVC   X8(L2,GR8),WKA1+P8        IN UPDATED BLOCK               51000019
         MVI   RDWRT,WKD               CHANGE RKD CCW TO WKD            51100019
         BAL   GR9,EXCP                UPDATE ODB                       51200019
         SPACE 1                                                        51300019
         MVC   MSGBUF+P18(L8),WKA1     UPDATE MESSAGE                   51400019
         SPACE 1                                                        51500019
ISSUEMSG EQU   *                                                        51600019
         MVI   MSG1,IOERF+LASTMSG      SET SYNAD MESSAGE+LAST           51700019
         BAL   GR9,GOVMS               GO TO MESSAGE WRITER             51800019
         SPACE 1                                                        51900019
         MVI   IOEF1,ERF5              INDICATE OUTPUT DIRECTORY        52000019
*                                      WRITE ERROR ON OUTPUT            52100019
         MVI   MSG1+P1,PLAMPID         POSS LOSS OR INCMP DIR MSG       52200019
         MVI   MSG1,LASTMSG            SET LAST MESSAGE                 52300019
         BAL   GR9,GOVMS12             GO TO MESSAGE WTR         A44144 52400000
         B     EXIT                    GO TO EXIT ROUTINE               52500019
         EJECT                                                          52600019
*                                                                       52700019
*     THIS ROUTINE HANDLES OUTPUT MEMBER WRITE ERRORS                   52800019
*                                                                       52900019
         SPACE 2                                                        53000019
OTMWERR  EQU   *                                                        53100019
         LA    GR2,DXDAADDR            POINT TO IOB SEEK ADDRESS        53200019
         L     GR1,IOBWGHT             POINT TO DCB                     53300019
         L     GR15,VCCOTT             PTR TO CCOTT                     53400019
         BALR  GR14,GR15               CONVERT TO TTR                   53500019
         SPACE 1                                                        53600019
         MVC   MSGBUF+P1(L7),NUMB1     SET UP MESSAGE                   53700019
         MVC   MSGBUF+P10(L37),TEXT5                                    53800019
         UNPK  MSGBUF+P47(L7),WKA1(L4)                                  53900019
         TR    MSGBUF+P47(L6),TABLE-P240                                54000019
         MVI   MSGBUF+P53,BLANK                                         54100019
         TM    TAG,TAG6                ERROR ON RDBACK CHK              54200019
         BNO   DONTMOVE                NO, GO AROUND                    54300019
         MVC   MSGBUF+P54(L21),TEXT8                                    54400019
DONTMOVE EQU   *                                                        54500019
         SPACE 1                                                        54600019
         MVI   MSG1,IOERF+LASTMSG      SET SYNAD MESSAGE+LAST           54700019
         BAL   GR9,GOVMS               GO TO MESSAGE WRITER             54800019
         SPACE 1                                                        54900019
         TM    TAG,TAG6                ERROR DURING READBACK CHECK      55000019
         BNO   NOTRB                   NO, GO AROUND                    55100019
         SPACE 1                                                        55200019
         BAL   GR9,TESTSTAT            CHECK FOR HARD OR SOFT ERROR     55300019
*                                      RETURN+0 = SOFT ERROR            55400019
*                                      RETURN+4 = HARD ERROR            55500019
         B     IGNORE                  IGNORE SOFT ERROR                55600019
         SPACE 1                                                        55700019
NOTRB    EQU   *                                                        55800019
         BAL   GR7,XTRAMSG             GO PRINT ONE MORE ERROR          55900019
*                                        MESSAGE                        56000019
         MVI   IOEF1,ERF6              INDICATE MEMBER WRITE ERROR      56100019
         B     EXIT                    GO TO EXIT ROUTINE               56200019
         EJECT                                                          56300019
*                                                                       56400019
*     THIS ROUTINE HANDLES SYSUT3 WRITE ERRORS                          56500019
*                                                                       56600019
         SPACE 2                                                        56700019
UT3WRITE EQU   *                                                        56800019
         MVC   MSGBUF+P1(L7),NUMB2     SET UP MESSAGE                   56900019
         MVC   MSGBUF+P10(L29),TEXT3                                    57000019
         MVC   MSGBUF+P40(L16),SUFFIX                                   57100019
         L     GR3,ADWK                                                 57200019
         LA    GR3,X12(GR0,GR3)        GET PTR TO NAME                  57300019
         MVC   MSGBUF+P17(L8),X0(GR3)                                   57400019
         SPACE 1                                                        57500019
         MVI   MSG1,IOERF+LASTMSG      SET SYNAD+LAST MSG               57600019
         BAL   GR9,GOVMS8              GO TO MESSAGE WRITER      A44144 57700000
         SPACE 1                                                        57800019
         MVI   IOEF1,ERF7              INDICATE SYSUT3 WRITE ERROR      57900019
         TM    ULLDST,UNLOAD           UNLOAD OPERATION          X010XX 57910000
         BO    IOE00785                YES - GO TO EXIT RTN BUT  X010XX 57920000
*                                        SKIP TEST UNLOAD        X010XX 57922000
         TM    SENSE,SENSE8            DID VTT REQUEST I/O       A33287 57930020
         BO    EXIT                    YES, EXIT TO VTM          A33287 57960020
         TM    COMDCDSW,COMPRESS       COMPRESS OPERATION               58000019
         BZ    FLAGIT2                 NO, GO AROUND                    58100019
         SPACE 1                                                        58200019
         MVC   MSGBUF+P1(L78),TEXT6    SET UP INVALID DIRECTORY MSG     58300019
         MVI   MSG1,IOERF+LASTMSG      SET SYNAD+LAST MSG               58400019
         BAL   GR9,GOVMS               ISSUE ERROR MSG                  58500019
         B     EXIT                    GO TO EXIT ROUTINE               58600019
         SPACE 1                                                        58700019
FLAGIT2  EQU   *                                                        58800019
         MVI   VTMFLG1,IOERROR         INDICATE IOERROR                 58900019
         SPACE 1                                                        59000019
         TM    FLG7,COP                IN MEMBER COPY PHASE             59100019
         BO    CPYPHASE                YES, GO AROUND                   59200019
         SPACE 1                                                        59300019
*     NOTE THAT IF THIS IS THE BUILD PHASE, THE ONLY WAY TO FIND        59400019
*  THE APPROPRIATE CTLTAB ENTRY TO FLAG AS DON'T COPY IS THROUGH        59500019
*  IEBMBT'S SAVE AREA                                                   59600019
         SPACE 1                                                        59700019
         L     GR3,SV3+SV3TAB          GET PTR TO CTLTAB ENTRY          59800019
*                                      BEING BUILT                      59900019
         B     FLAGIT                  GO AROUND                        60000019
         SPACE 1                                                        60100019
CPYPHASE EQU   *                                                        60200019
         L     GR3,TABAD                                                60300019
         LA    GR2,X10                                                  60400019
         SR    GR3,GR2                 GET PTR TO ENTRY BEING           60500019
*                                         BUILT                         60600019
         SPACE 1                                                        60700019
FLAGIT   EQU   *                                                        60800019
         OI    X0(GR3),SEBIT4          FLAG ENTRY AS DON'T COPY         60900019
         B     IGNORE                  GO TO EXIT ROUTINE               61000019
         EJECT                                                          61100019
*                                                                       61200019
*     THIS ROUTINE HANDLES SYSUT4 WRITE ERRORS                          61300019
*                                                                       61400019
         SPACE 2                                                        61500019
UT4WRITE EQU   *                                                        61600019
         BAL   GR7,XTRAMSG             GIVE NO MEMBERS COPIED MSG       61700019
         MVI   IOEF1,ERF9              INDICATE SYSUT4 WRITE ERROR      61800019
         B     EXIT                    GO TO EXIT ROUTINE               61900019
         EJECT                                                          62000019
*                                                                       62100019
*     THIS ROUTINE TESTS FOR SOFT AND HARD ERRORS.  IF THE ERROR        62200019
*  IS SOFT, THE CALLER IS RETURNED TO AT REGISTER 9 +0.  IF THE ERROR   62300019
*  IS HARD, THE CALLER IS RETURNED TO AT REGISTER 9 +4.                 62400019
*                                                                       62500019
         SPACE 2                                                        62600019
TESTSTAT EQU   *                                                        62700019
         CLI   EVENTCB,PERMIO          ECB POSTED AS X'41'              62800019
*                                      (THIS IS THE ONLY TIME THAT      62900019
*                                      IOBCSW CONTENTS ARE USEFUL)      63000019
         BNE   HARDERR                 NO, HARD ERROR                   63100019
         SPACE 1                                                        63200019
         TM    IOBSTAT0,UCHECK         UNIT CHECK POSTED                63300019
*                                      (THIS BIT MUST BE ON TO          63400019
*                                      ASSURE IOB SENSE INFORMATION     63500019
*                                      HAS BEEN BEEN PROVIDED)          63600019
         BNO   HARDERR                 NO, HARD ERROR                   63700019
         SPACE 1                                                        63800019
         CLI   IOBSENS0,DATACK         DAT CHECK ONLY                   63900019
         BNE   HARDERR                 NO, HARD ERROR                   64000019
         SPACE 1                                                        64100019
         CLI   IOBSENS1,ZERO           SENSE BYTE1=0                    64200019
*                                      (THIS MUST BE ZERO SINCE WE      64300019
*                                      CAN'T HANDLE.  FOR EXAMPLE,      64400019
*                                      DATA CHECK IN COUNT FIELD        64500019
*                                      WOULD SET DATA CHECK IN SENSE    64600019
*                                      BYTE 0 AND DATA CHECK IN COUNT   64700019
*                                      FIELD IN SENSE BYTE1)            64800019
         BE    SOFTERR                 YES, SOFT ERROR                  64900019
         SPACE 1                                                        65000019
HARDERR  EQU   *                                                        65100019
         LA    GR9,X4(GR0,GR9)         BUMP RETURN ADDRESS BY 4         65200019
SOFTERR  EQU   *                                                        65300019
         BR    GR9                     RETURN                           65400019
         EJECT                                                          65500019
*                                                                       65600019
*   THIS ROUTINE PRINTS ONE OF TWO ADDITIONAL ERROR MESSAGES            65700019
*  AND IS USED BY OTMWERR AND INMRERR                                   65800019
*                                                                       65900019
         SPACE 2                                                        66000019
XTRAMSG  EQU   *                                                        66100019
         TM    COMDCDSW,COMPRESS       COMPRESS BEING DONE              66200019
         BZ    NOTCMPRS                NO, GO AROUND                    66300019
         SPACE 1                                                        66400019
         MVC   MSGBUF+P1(L78),TEXT6    SET UP DIRECTORY INVALID         66500019
*                                        MESSAGE                        66600019
         MVI   MSG1,IOERF+LASTMSG      SET SYNAD MESSAGE + LAST         66700019
         BAL   GR9,GOVMS8              ISSUE MESSAGE             A44144 66800000
         SPACE 1                                                        66900019
         BR    GR7                     RETURN                           67000019
         SPACE 1                                                        67100019
NOTCMPRS EQU   *                                                        67200019
         L     GR3,NXTINDS             LOAD PTR TO INDD TABLE           67300019
*                                        ENTRY                          67400019
         MVC   NAMEFLD(L8),X2(GR3)     MOVE INDD NAME FOR PRINTING      67500019
         MVI   PARAMS,NAME+MSGULLD     INDIC NAME TO BE PRINTED  X010XX 67600000
*                                        AND ' COPIED ' IN MSG   X010XX 67650000
         MVI   NAMEDISP,X36            SET OFFSET FOR NAME       X010XX 67700000
         MVI   COPDISP,OFF11           DISP OF ' COPIED ' IN MSG X010XX 67750000
         MVI   MSG1,LASTMSG+PBIT       SET LAST MSG+BUILD               67800019
         MVI   MSG1+P1,NOMBCPDM        NO MEMBERS COPIED FROM INDD MSG  67900019
         BAL   GR9,GOVMS               ISSUE MSG                        68000019
         SPACE 1                                                        68100019
         BR    GR7                     RETURN                           68200019
         EJECT                                                          68300019
*                                                                       68400019
*  THIS SECTION HANDLES ERASE ERRORS                                    68500019
*                                                                       68600019
         SPACE 2                                                        68700019
OTMERS   EQU   *                                                        68800019
         BAL   GR7,XTRAMSG             GIVE NO MEMBERS COPIED MSG       68900019
         SPACE 1                                                        69000019
         MVI   IOEF1,ERF6              INDICATE MEMBER WRITE ERROR      69100019
         B     EXIT                    GO TO EXIT ROUTINE               69200019
         EJECT                                                          69300019
*                                                                       69400019
*     THIS ROUTINE DOES ALL MESSAGE WRITING FOR IEBIOE.  CONTROL IS     69500019
* PASSED TO IEBVMS AND RETURN IS MADE TO THE CALLER                     69600019
*                                                                       69700019
         SPACE 2                                                        69800019
GOVMS12  EQU   *                                                 A44144 69810000
         MVI   RCBUF,RC12         HIGHEST RETURN CODE            A44144 69820000
         B     GOVMS              GO WRITE MSG                   A44144 69830000
GOVMS8   EQU   *                                                 A44144 69850000
         CLI   RCBUF,RC8               RETURN CODE 8 OR HIGHER   A44144 69860000
         BNL   GOVMS                   YES, GO AROUND            A44144 69870000
         MVI   RCBUF,RC8               SET RETURN CODE = 8       A44144 69880000
GOVMS    EQU   *                                                        69900019
         L     GR15,VIEBVMS            LOAD PTR TO VMS                  70000019
         BALR  GR14,GR15               PRINT MESSAGE                    70100019
         SPACE 1                                                        70200019
         MVI   MSGBUF,BLANK            CLEAR BUFFER                     70300019
         MVC   MSGBUF+P1(L120),MSGBUF                                   70400019
         SPACE 1                                                        70500019
         BR    GR9                     RETURN                           70600019
         EJECT                                                          70700019
*                                                                X010XX 70750000
*   THIS SECTION HANDLES-  END OF FILE WHEN LOADING              X010XX 70760000
*                          BLOCKSIZE ERROR WHEN UNLOADING        X010XX 70770000
*                                                                X010XX 70780000
         SPACE 2                                                        70790000
IEBIOE2  EQU   *                                                 X010XX 70792000
         ENTRY IEBIOE2                                           X010XX 70794000
         SPACE 1                                                        70796000
*   AT THIS ENTRY POINT REGISTERS ARE NOT SAVED AS CALLER IS NOT X010XX 70796400
* RETURNED TO AND SAVING MAY RESULT IN CORRUPTION OF IEBIOE'S    X010XX 70796800
* OWN CODE BECAUSE OF THE OVERLAY STRUCTURE                      X010XX 70797200
         SPACE 1                                                        70797600
         BALR  GR12,GR0                LOAD ADDR NEXT SEQ INSTR  X010XX 70798800
IOE00710 EQU   *                                                 X010XX 70799200
         LA    GR15,IOE00710-START                               X010XX 70799600
         SR    GR12,GR15               ESTABLISH ADDRESSABILITY  X010XX 70799700
         L     GR10,AMSG               LOAD POINTER TO MSG CSECT X010XX 70799800
         SPACE 1                                                        70799900
         LA    GR13,SV5                ADDR OF SAVE AREA FOR     X010XX 70843200
*                                        CALLED ROUTINES         X010XX 70845200
         SPACE 1                                                        70865200
         NI    IOEF2,FF-SNDFUSED       INDICATE NO SYNADAF USED  X010XX 70865600
         OI    IOEF2,IOEFENT           INDICATE IOE ENTERED      X010XX 70866000
         SPACE 1                                                        70866400
         MVI   MSGBUF,BLANK            CLEAR MESSAGE BUFFER      X010XX 70866500
         MVC   MSGBUF+P1(L120),MSGBUF                            X010XX 70874000
         SPACE 1                                                        70877700
         TM    IOEF2,VERPEST           UNLOAD BLOCKSIZE ERROR    X010XX 70887700
         BO    IOE00720                YES - SET UP APPROPR MSG  X010XX 70888100
         SPACE 1                                                        70888500
         MVC   MSGBUF+P1(L57),TEXT9    SET UP MSG - END OF FILE  X010XX 70888600
*                                        READ ON LOAD DATA SET   X010XX 70888700
         L     GR3,NXTINDS             POINT TO INDD SLOT        X010XX 70888800
         MVC   MSGBUF+P58(L8),X2(GR3)  MOVE IN NAME LOAD DATASET X010XX 70892500
         B     IOE00770                CONTIN IN LOAD/UNLOAD     X010XX 70894500
*                                        SYNAD ROUTINE           X010XX 70895000
         SPACE 1                                                        70895300
IOE00720 EQU   *                       SET UP FIRST PART         X010XX 70895700
         MVC   MSGBUF+P1(L78),TEXT11A  OF BLKSIZE ERROR MSG      X010XX 70896100
         L     GR3,IDEAD               PTR TO MEMBERNAME         X010XX 70896200
         MVC   MSGBUF+P45(L8),X0(GR3)  MOVE IN MEMBER NAME       X010XX 70922100
         L     GR3,NXTINDS             PTR TO INDD SLOT          X010XX 70932100
         MVC   MSGBUF+P68(L8),X2(GR3)  MOVE IN NAME INP DATASET  X010XX 70942100
         SPACE 1                                                        70944100
         MVI   MSG1,IOERF+LASTMSG      SET SYNAD MSG+LAST        X010XX 70946100
         BAL   GR9,GOVMS               GO TO MSG WRITER          X010XX 70948100
         SPACE 2                                                        70956700
         MVC   MSGBUF+P10(L56),TEXT11B SET UP 2ND PART OF MSG    X010XX 70958700
         SPACE 1                                                        70960700
         L     GR3,READNEXT            OBTAIN POINTER TO         X010XX 70962700
         LA    GR3,X12(GR3)            CCHHRKDD                  X010XX 70964700
         SPACE 1                                                        70965100
         UNPK  MSGBUF+P66(L11),X0(L6,GR3)    MAKE CCHHRKDD       X010XX 70965200
         UNPK  MSGBUF+P76(L7),X5(L4,GR3)     PRINTABLE           X010XX 70965300
         TR    MSGBUF+P66(L16),TABLE-P240                        X010XX 70965400
         MVI   MSGBUF+P82,BLANK                                  X010XX 70974000
         SPACE 1                                                        70974100
         B     IOE00770                CONTIN IN LOAD/UNLOAD     X010XX 70976100
*                                        SYNAD ROUTINE           X010XX 70978100
         EJECT                                                          70980100
*                                                                X010XX 70982100
*   LOAD SYNAD ROUTINE                                           X010XX 70982500
*                                                                X010XX 70982600
*   UNLOAD SYNAD ROUTINE                                         X010XX 70982700
*                                                                X010XX 71006100
         SPACE 2                                                        71016100
IEBIOE3  EQU   *                       LOAD SYNAD ROUTINE E.P.   X010XX 71026100
         ENTRY IEBIOE3                                           X010XX 71028100
         SPACE 1                                                        71028500
         OI    IOEF2,ENTIOE3           ENTERED THROUGH IEBIOE3   X010XX 71028900
         SPACE 1                                                        71029300
         BALR  GR15,GR0                LOAD ADDR NEXT SEQ INSTR  X010XX 71029700
         SPACE 1                                                        71037500
IEBIOE4  EQU   *                       UNLOAD SYNAD ROUTINE E.P. X010XX 71039500
         ENTRY IEBIOE4                                           X010XX 71041500
         USING IEBIOE4,GR15            ADDRESSABLTY FOR SYNADAF  X010XX 71043500
         SPACE 1                                                        71043900
*   AT THIS ENTRY POINT REGISTERS ARE NOT SAVED AS CALLER IS NOT X010XX 71044000
* RETURNED TO AND SAVING MAY RESULT IN CORRUPTION OF IEBIOE'S    X010XX 71044100
* OWN CODE BECAUSE OF THE OVERLAY STRUCTURE                      X010XX 71044200
         SPACE 1                                                        71044700
         TM    IOEF2,IOEFENT           ENTERED BEFORE            X010XX 71045100
         BO    IOE00730                YES - GO AROUND SYNADAF   X010XX 71045200
*                                      (ENTERED FOR 2ND TIME     X010XX 71045300
*                                      TRYING TO WRITE FLAGGED   X010XX 71047200
*                                      COPYR1 DESCRIPTOR RECORD) X010XX 71049200
         SPACE 1                                                        71050200
         LA    GR13,SV5                TO AVOID CORRUPTION OF    X010XX 71052200
*                                        IEBIOE'S OWN CODE WHEN  X010XX 71052600
*                                        SYNADAF LINKS SAVAREA'S X010XX 71053000
         SPACE 1                                                        71054900
*   THE FOLLOWING MACRO PLACES AN ERROR MESSAGE IN A DYNAMIC     X010XX 71058700
* BUFFER, OBTAINS A SAVE AREA, AND LINKS THE NEW SAVE AREA WITH  X010XX 71060600
* THE OLD ONE                                                    X010XX 71062500
         SPACE 1                                                        71064400
         SYNADAF  ACSMETH=BSAM                                   X010XX 71066300
         SPACE 1                                                        71068200
IOE00730 EQU   *                                                 X010XX 71070100
         SPACE 1                                                        71072000
         DROP  GR15                                              X010XX 71073900
         BALR  GR12,GR0                LOAD ADDR NEXT SEQ INSTR  X010XX 71075800
IOE00740 EQU   *                                                 X010XX 71077700
         LA    GR15,IOE00740-START                               X010XX 71079600
         SR    GR12,GR15               ESTABLISH ADDRESSABILITY  X010XX 71081500
         L     GR10,AMSG               LOAD PTR TO MSG CSECT     X010XX 71083400
         SPACE 1                                                        71085300
         TM    IOEF2,IOEFENT           ENTERED BEFORE            X010XX 71087200
         BO    IOE00800                YES - PREPARE EXIT TO VTM X010XX 71089100
*                                      (ENTERED FOR 2ND TIME AS  X010XX 71091000
*                                      RESULT OF ATTEMPT TO WRT  X010XX 71092900
*                                      FLAGGED COPYR1 DESCR REC) X010XX 71094800
         SPACE 1                                                        71096700
         OI    IOEF2,SNDFUSED+IOEFENT  INDICATE SYNADAF ISSUED   X010XX 71098600
*                                        AND IOE ENTERED         X010XX 71100500
         SPACE 1                                                        71102400
         MVI   MSGBUF,BLANK            CLEAR MESSAGE BUFFER      X010XX 71104300
         MVC   MSGBUF+P1(L120),MSGBUF                            X010XX 71106200
         SPACE 1                                                        71108100
         TM    IOEF2,ENTIOE3           ENTERED THROUGH IEBIOE3   X010XX 71110000
         BO    IOE00750                YES - ERROR PREFIX=LOAD   X010XX 71112000
         MVC   MSGBUF+P19(L15),ULCN    ERROR PREFIX=UNLOAD       X010XX 71114000
         B     IOE00760                GO AROUND                 X010XX 71116000
IOE00750 EQU   *                                                 X010XX 71116400
         MVC   MSGBUF+P19(L13),LDCN    ERROR PREFIX=LOAD         X010XX 71116800
         NI    IOEF2,FF-ENTIOE3        RESET ENTERED THROUGH     X010XX 71117200
*                                        IEBIOE3 SWITCH          X010XX 71117300
         SPACE 1                                                        71117600
IOE00760 EQU   *                                                 X010XX 71117700
         MVC   MSGBUF+P1(L7),IEBPRFX   SET UP MSG NUMBER         X010XX 71117800
         MVC   MSGBUF+P9(L9),TEXT5     I/O ERROR                 X010XX 71117900
         MVC   MSGBUF+P42(L78),X50(GR1) MOVE SNDF MSG TO BUFFER  X010XX 71124700
IOE00770 EQU   *                                                 X010XX 71126700
         MVI   MSG1,IOERF+LASTMSG      SET SYNAD MSG + LAST MSG  X010XX 71128700
         SPACE 1                                                        71130700
         BAL   GR9,GOVMS8              ISSUE MESSAGE             A44144 71131100
         SPACE 1                                                        71131500
         MVI   IOEF1,ERF3              FAKE ERROR READING MEMBER X010XX 71131600
*                                        FOR IEBVTM              X010XX 71138400
         EJECT                                                          71144900
*                                                                X010XX 71145400
*   THIS SECTION HANDLES EXIT LINKAGE AND EITHER RETURNS CONTROL X010XX 71152200
* TO THE CALLER OR IEBVTM                                        X010XX 71159000
*                                                                X010XX 71179500
*   IN THE CASE OF A HARD ERROR DURING UNLOAD OPERATION          X010XX 71189500
* THE UNLOADED DATA SET WILL BE FLAGGED AS NOT LOADABLE          X010XX 71199500
*                                                                X010XX 71199900
         SPACE 2                                                        71200019
EXIT     EQU   *                                                        71300019
         SPACE 2                                                        71350000
         TM    ULLDST,UNLOAD           UNLOAD SPECIFIED          X010XX 71360000
         BZ    IOE00800                NO - GO AROUND CODE FOR   X010XX 71370000
*                                        FLAGGING UNLOAD DATASET X010XX 71380000
         SPACE 1                                                        71390000
IOE00785 EQU   *                       SYSUT3 READ/WRITE ERROR   X010XX 71392000
*                                        OCCURRED DURING UNLOAD  X010XX 71394000
         SPACE 1                                                        71396000
         LA    GR2,ULOADDCB            POINTER TO DCB            X010XX 71398000
         USING IHADCB,GR2                                        X010XX 71398400
         TM    DCBOFLGS,OPEN           IS DCB OPEN               X010XX 71398800
         BZ    IOE00800                NO - GO AROUND CODE FOR   X010XX 71399200
*                                        FLAGGING UNLOAD DATASET X010XX 71403000
         SPACE 1                                                        71404600
*                                                                X010XX 71406200
*   PREPARE FOR WRITING FLAGGED COPYR1 DESCRIPTOR RECORD BY      X010XX 71407800
* CONSECUTIVELY CLOSING AND OPENING THE UNLOAD DCB               X010XX 71409400
*                                                                X010XX 71411000
         SPACE 1                                                        71422100
         CLOSE ((GR2),REREAD)                                    X010XX 71432100
         SPACE 1                                                        71437700
         L     GR3,DCBEXLST            GET ADDRESS OF EXITLIST   X010XX 71439400
         LA    GR3,X0(GR0,GR3)         CLEAR HIGH ORDER BYTE     X010XX 71441100
         NI    X0(GR3),DEACT           DEACTIVATE EXITLIST ENTRY X010XX 71442800
         SPACE 1                                                        71444500
         OPEN  ((GR2),OUTPUT)                                    X010XX 71446200
         SPACE 1                                                        71447900
         OI    X0(GR3),ACT             ACTIVATE EXITLIST ENTRY   X010XX 71449600
         SPACE 1                                                        71451300
         TM    DCBOFLGS,OPEN           IS DCB OPEN               X010XX 71453000
         BZ    IOE00800                NO - GO AROUND            X010XX 71454700
         SPACE 1                                                        71456400
         L     GR3,ACOPYR1             GR3 POINTS TO COPYR1      X010XX 71458100
*                                        IMAGE IN CORE           X010XX 71459800
         SPACE 1                                                        71461500
         OI    X8(GR3),CPR1FLAG        FLAG AS NOT LOADABLE      X010XX 71463200
         SPACE 1                                                        71465200
         WRITE DECBIOE,SF,(GR2),(GR3)  WRITE FLAGGED COPYR1      X010XX 71465600
         SPACE 1                                                        71465700
         CHECK DECBIOE                                           X010XX 71466000
         SPACE 1                                                        71466400
         MVC   MSGBUF+P1(L80),TEXT10   PREP MSG UNLOAD DATASET   X010XX 71466500
         MVC   MSGBUF+P40(L8),OUTNAME  FLAGGED AS NOT LOADABLE   X010XX 71466600
         MVI   MSG1,IOERF+LASTMSG      SET SYNAD MSG + LAST MSG  X010XX 71477700
         SPACE 1                                                        71487700
         BAL   GR9,GOVMS               ISSUE MESSAGE             X010XX 71488100
         SPACE 2                                                        71488500
IOE00800 EQU   *                                                 X010XX 71488600
         SPACE 2                                                        71488700
         MVI   VTMFLG1,IOERROR         SET IOERROR               X010XX 71488900
         OI    FLG7,SUPPRMSG+NOPRNBDB  SET INDICATORS TO SUPPRESS       71500019
*                                         PRINTING OF MEMBER NAMES      71600019
*                                         AND UNUSED DIRECTORY BLOCK    71700019
*                                         MESSAGES BY IEBVTM            71800019
         TM    IOEF1,ERF5              OUTPUT DIRECTORY WRITE ERROR     71810019
         BZ    NOTODBER                NO, GO AROUND                    71820019
         SPACE 1                                                        71830019
         NI    FLG7,FF-NOPRNBDB        TURN OFF DON'T PRINT UNUSED      71840019
*                                         DIRECTORY BLOCKS MSG          71850019
         SPACE 1                                                        71860019
NOTODBER EQU   *                                                        71870019
         BAL   GR9,SYNADRLS            RELEASE CORE                     71900019
         NI    IOEF2,FF-IOEFENT        RESET IOE ENTERED FLAG    X010XX 71950000
         L     GR15,VIEBVTM            LOAD POINTER TO VTM              72000019
         BALR  GR14,GR15               GO TO VTM  (NO RETURN)           72100019
         SPACE 4                                                        72200019
IGNORE   EQU   *                                                        72300019
         BAL   GR9,SYNADRLS            RELEASE CORE                     72400019
         NI    IOEF2,FF-IOEFENT        RESET IOE ENTERED FLAG    X010XX 72450000
         RETURN (14,12)                RETURN TO CALLER                 72500019
         SPACE 4                                                        72700019
*                                      RELEASE CORE OBTAINED BY         72800019
SYNADRLS EQU   *                         SYNADAF AND REST GR13   X010XX 72900000
         TM    IOEF2,SNDFUSED          WAS SYNADAF ISSUED        X010XX 72950000
         BCR   MASK8,GR9               NO - RETURN               X010XX 72960000
         SYNADRLS                                                X010XX 72970000
         NI    IOEF2,FF-SNDFUSED       RESET SYNADAF USED FLAG   X010XX 72980000
         BR    GR9                     RETURN                           73000019
         EJECT                                                          73100019
FIRSTNAM EQU   10                      OFFSET IN BUFFER TO FIRST        73200019
*                                         ENTRY IN BLOCK                73300019
OFF11    EQU   11                      DISP OF ' COPIED ' IN MSG X010XX 73360000
X36      EQU   X'36'                   DISP OF NAME IN MSG       X010XX 73370000
DATACK   EQU   X'08'                   DATA CHECK SENSE BIT             73400019
UCHECK   EQU   X'02'                   UNIT CHECK BIT IN CSW            73500019
PERMIO   EQU   X'41'                   ECB POST CODE - CSW OK           73600019
RC4      EQU   C'4'                                                     73608019
RC8      EQU   C'8'                                              A44144 73610000
RC12     EQU   X'FC'                                             A44144 73612000
BLANK    EQU   C' '                                                     73616019
OKCODE   EQU   X'7F'                                                    73624019
SV3TAB   EQU   64                                                       73632019
ZERO     EQU   0                                                        73640019
FF       EQU   X'FF'                                                    73648019
SIDEQMT  EQU   X'B1'                                                    73656019
SIDEQ    EQU   X'31'                                                    73664019
WKD      EQU   X'0D'                                                    73672019
RKD      EQU   X'0E'                                                    73680019
MASK1F   EQU   X'1F'                                                    73688019
MASK8    EQU   8                       MASK IN BCR INSTR         X010XX 73698000
CPR1FLAG EQU   X'80'                   TO FLG COPYR1 NOT LOADBLE X010XX 73698400
DEACT    EQU   X'80'                   TO DEACTIV EXITLIST ENTRY X010XX 73698500
ACT      EQU   X'05'                   TO ACTIV EXITLIST ENTRY   X010XX 73698600
OPEN     EQU   X'10'                   FOR TESTING DCBOFLGS      X010XX 73698800
TABLE    DC    C'0123456789ABCDEF'     TRANSLATE TABLE                  73700019
TWOPCIS  DC    H'2'                    USED TO COMPARE THE NUMBER OF    73760019
*                                        PCI'S TAKEN                    73820019
AMSG     DC    A(IEBIOEMG)             PTR TO MSG CSECT                 73900019
ERRIOB   EQU   *                                                        74000019
         DC    X'42'                    E                               74100019
         DC    AL3(0)                    R                              74200019
         DC    A(ERRECB)                I R                             74300019
         DC    6F'0'                     O O                            74400019
ERRSEEK  DC    2F'0'                      B R                           74500019
MCAADDR  DC    AL4(0)                   POINTER TO COMMON AREA @YA02574 74550002
ERRECB   DC    F'0'                     ERROR ECB                       74600019
         DS    0D                                                       74700019
CCWS     EQU   *                                                        74800019
         CCW   X'31',ERRSEEK+3,X'40',5                                  74900019
         CCW   X'08',CCWS,X'40',1                                       75000019
RDWRT    CCW   X'0E',0,X'00',264                                        75100019
PATCHLN  EQU   (*-IEBIOE)/20           5 PERCENT PATCH AREA LENGTH      75200019
PATCH    DC    XL(PATCHLN)'00'          PATCH AREA               A41780 75300000
         EJECT                                                          75301019
*   THE FOLLOWING EQUATES ARE USED TO REFER TO SYMBOLIC ADDRESS PLUS    75302019
* A CONSTANT                                                            75303019
P1       EQU   1                                                        75304019
P8       EQU   8                                                        75305019
P9       EQU   9                                                        75306019
P10      EQU   10                                                       75307019
P17      EQU   17                                                       75308019
P18      EQU   18                                                       75309019
P19      EQU   19                                                       75310019
P20      EQU   20                                                       75311019
P35      EQU   35                                                       75312019
P40      EQU   40                                                       75313019
P42      EQU   42                                                       75314019
P45      EQU   45                                                X010XX 75314400
P47      EQU   47                                                       75315019
P53      EQU   53                                                       75316019
P54      EQU   54                                                       75317019
P58      EQU   58                                                X010XX 75317400
P66      EQU   66                                                X010XX 75317800
P68      EQU   68                                                X010XX 75317900
P70      EQU   70                                                       75318019
P76      EQU   76                                                X010XX 75318400
P82      EQU   82                                                X010XX 75318800
P240     EQU   240                                                      75319019
         EJECT                                                          75320019
*   THE FOLLOWING EQUATES ARE USED IN INSTRUCTIONS REQUIRING LENGTH     75321019
* SPECIFICATIONS SUCH AS MVC                                            75322019
L2       EQU   2                                                        75323019
L3       EQU   3                                                        75324019
L4       EQU   4                                                        75325019
L6       EQU   6                                                        75326019
L7       EQU   7                                                        75327019
L8       EQU   8                                                        75328019
L9       EQU   9                                                        75329019
L11      EQU   11                                                X010XX 75329400
L13      EQU   13                                                       75330019
L14      EQU   14                                                       75331019
L15      EQU   15                                                X010XX 75331400
L16      EQU   16                                                       75332019
L17      EQU   17                                                X010XX 75332400
L21      EQU   21                                                       75333019
L22      EQU   22                                                       75334019
L24      EQU   24                                                       75335019
L29      EQU   29                                                       75336019
L37      EQU   37                                                       75337019
L52      EQU   52                                                X010XX 75337400
L56      EQU   56                                                X010XX 75337800
L57      EQU   57                                                X010XX 75337900
L59      EQU   59                                                       75338019
L78      EQU   78                                                       75339019
L80      EQU   80                                                X010XX 75339400
L120     EQU   120                                                      75340019
         EJECT                                                          75341019
*   THE FOLLOWING EQUATES ARE USED FOR OFFSETS WITH REGISTER NOTATION   75342019
X0       EQU   0                                                        75343019
X1       EQU   1                                                        75344019
X2       EQU   2                                                        75345019
X4       EQU   4                                                        75346019
X5       EQU   5                                                 X010XX 75346400
X8       EQU   8                                                        75347019
X10      EQU   10                                                       75348019
X11      EQU   11                                                       75349019
X12      EQU   12                                                       75350019
X50      EQU   50                                                       75352019
         EJECT                                                          75400019
IEBIOEMG CSECT                                                          75500019
*  THE FOLLOWING IS MESSAGE TEXT FOR ERROR MESSAGES ISSUED BY IEBIOE    75550019
ERSCON   DC    C'DURING ERASE -'                                        75600019
RBCN     DC    C'DURING READBACK CHECK-'                                75700019
RCN      DC    C'DURING READ -'                                         75800019
WCN      DC    C'DURING WRITE -'                                        75900019
LDCN     DC    C'DURING LOAD -'                                  X010XX 75950000
ULCN     DC    C'DURING UNLOAD -'                                X010XX 75960000
SUFFIX   DC    C'DUE TO '                                               76000019
TEXT5    DC    C'I/O ERROR '                                            76100019
TEXT2    DC    C'WRITING '                                              76200019
TEXT7    DC    C'MEMBER DATA AT TTR='                                   76300019
TEXT1    DC    C'READING'                                               76400019
TEXT8    DC    C'-(READ BACK CHECKING)'                                 76500019
TEXT3    DC    C'MEMBER ******** NOT PROCESSED'                         76600019
TEXT4    DC    C'MEMBERS XXXXXXXX THROUGH END OF DATA'                  76700019
         DC    C' SET ARE NOT ACCESSIBLE'                               76800019
TEXT9    DC    C'IEB183I  END OF FILE READ ON LOAD DATA SET '    X010XX 76850000
         DC    C'REFERENCED BY '                                 X010XX 76860000
TEXT10   DC    C'IEB182I  UNLOAD DATA SET REFERENCED BY'         X010XX 76870000
         DC    C'          HAS BEEN FLAGGED AS NOT LOADABLE'     X010XX 76880000
TEXT11A  DC    C'IEB184I  MEMBER DATA RECORD READ FOR MEMBER'    X010XX 76890000
         DC    C'          REFERENCED BY          IS'            X010XX 76892000
TEXT11B  DC    C'LONGER THAN DATA SET BLOCKSIZE '                X010XX 76894000
         DC    C'PLUS KEYLENGTH, CCHHRKDD='                      X010XX 76896000
NUMB0    DC    C'IEB100I'                                               76900019
NUMB1    DC    C'IEB101I'                                               77000019
NUMB2    DC    C'IEB102I'                                               77100019
NUMB3    DC    C'IEB103I'                                               77200019
IEBPRFX  DC    C'IEB139I'              SYNADAF MESSAGE NUMBER           77300019
TEXT6    DC    C'IEB171I  ** WARNING ** DIRECTORY MAY NOT '             77400019
         DC    C'REFLECT VALID LOCATION OF MEMBER DATA'                 77500019
ASTERICS DC    C'********'                                              77550019
         EJECT                                                          77600019
IECDSECT DSECT                                                          77700019
         IECDSECT                                                       77800019
         EJECT                                                          77900019
IEBMCA   DSECT                                                          78000019
         IEBMCA                                                         78100019
         EJECT                                                          78150000
         DCBD  DSORG=PO                                          X010XX 78160000
         END                                                            78200019
