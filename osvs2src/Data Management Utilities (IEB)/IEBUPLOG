ULOG     TITLE 'IEBUPDTE MESSAGE CSECT- IEBUPLOG'                       00020000
*TITLE- IEBUPDTE MESSAGE CSECT- IEBUPLOG                              * 00040000
*                                                                     * 00060000
*STATUS- CHANGE LEVEL 001                                             * 00080000
*                                                                     * 00100000
*FUNCTION/OPERATION- THIS MODULE IS ABLE TO CREATE AND UPDATE         * 00120000
*   SYMBOLIC LIBRARIES WHICH ARE EITHER PHYSICAL SEQUENTIAL OR        * 00140000
*   PARTITIONED DATA SETS CONTAINED ON DIRECT ACCESS OR TAPE VOLUMES. * 00160000
*                                                                     * 00180000
*   THIS MODULE HANDLES FIXED OR FIXED-BLOCKED RECORDS. IT HAS THE    * 00200000
*   ABITLITY TO HANDLE RECORD OF LOGICAL RECORD LENGTHS UP TO EIGHTY  * 00220000
*   BYTES. IF BLOCKSIZE AND/OR LOGICAL RECORD LENGTH ARE NOT GIVEN    * 00240000
*   BY OPEN TIME, UNBLOCKED RECORDS OF 80 BYTES IS ASSUMED AND A      * 00260000
*   WARNING MESSAGE IS GIVEN ON THE LOG OUT DEVICE.                   * 00280000
*                                                                     * 00300000
*   THIS MODULE CAN-                                                  * 00320000
*                                                                     * 00340000
*   1. CREATE A NEW PARTITIONED OR PHYSICAL SEQUENTIAL DATA SET       * 00360000
*                                                                     * 00380000
*   2. SEQUENCE THE NEW DATA SET OR RESEQUENCE AN OLD ONE             * 00400000
*                                                                     * 00420000
*   3. REPRODUCE OR REPLACE A MEMBER OR A DATA SET                    * 00440000
*                                                                     * 00460000
*   4. PRODUCE A PARTITIONED DATA SET FROM A PHYSICAL SEQUENTIAL      * 00480000
*   MASTER OR THE CONVERSE.                                           * 00500000
*                                                                     * 00520000
*   4. ADD A MEMBER TO A PARTITIONED DATA SET.                        * 00540000
*                                                                     * 00560000
*   5. ASSIGN AN ALIAS NAME TO ANY MEMBER UPDATED                     * 00580000
*                                                                     * 00600000
*   6. CHANGE RECORDS IN A DATA SET                                   * 00620000
*                                                                     * 00640000
*   7. HANDLE RECORDS WITH NON-STANDARD SEQUENCE NUMBER FIELDS AND    * 00660000
*   LENGTHS OF SEQUENCE NUMBERS FROM 1 TO 8 CHARACTERS.               * 00680000
*                                                                     * 00700000
*   8. UPDATE ONLY SPECIFIED PORTION OF DATA SET RECORDS.             * 00720000
*                                                                     * 00740000
*   9. UPDATE INPLACE DATA SETS OR MEMBERS ON DIRECT ACCESS VOLUMES.  * 00760000
*                                                                     * 00780000
*ENTRY POINTS- ENTERED FROM THE OPERATING SYSTEM AT 'IEBUPDTE'.       * 00800000
*                                                                     * 00820000
*INPUT- SYSIN WHICH CONSISTS OF CONTROL CARDS AND LOGICAL DATA        * 00840000
*   RECORDS FOR INSERTION OR REPLACEMENT, THE INPUT DATA SET.         * 00860000
*                                                                     * 00880000
*       SYSUT1 WHICH DEFINES THE 'OLD MASTER' DATA SET WHICH MAY BE   * 00900000
*   PARTITIONED OR PHYSICAL SEQUENTIAL IN ORGANIZATION.               * 00920000
*                                                                     * 00940000
*OUTPUT-SYSPRINT WHICH CONTAINS DIAGNOSTIC MESSAGES, THE CONTENTS OF  * 00960000
*   SYSIN AND-IF THE 'LIST=ALL' CONDITION IS PRIMED- THE ENTIRE       * 00980000
*   'NEW MASTER' IS LISTED ON THE DEVICE DESIGNATED.                  * 01000000
*                                                                     * 01020000
*       SYSUT2 WHICH DEFINES THE 'NEW MASTER' DATA SET. IT WILL BE A  * 01040000
*   COMPOSITE OF THE SYSIN AND SYSUT1 DATA SETS. IT CAN BE EITHER     * 01060000
*   PARTITIONED OR PHYSICAL SEQUENTIAL IN ORGANIZATION.               * 01080000
*                                                                     * 01100000
*EXITS- NORMAL- A RETURN IS GIVEN TO THE SCHEDULAR MODULE OF THE      * 01120000
*   OPERATING SYSTEM. CONDITION CODE RETURNED ON A SUCCESSFUL RUN     * 01140000
*   WILL BE ZERO.                                                     * 01160000
*                                                                     * 01180000
*EXITS- ERROR- IF AN ERROR OCCURS, A CODE IS STORED, A MESSAGE        * 01200000
*   GIVEN TO THE USER EXPLAINING THE ERROR CONDITION AND A            * 01220000
*   RETURN TO THE OPERATING SYSTEM SCHEDULAR MODULE IS GIVEN.         * 01240000
*   RETURN CODE GIVEN ARE-                                            * 01260000
*   00 NORMAL TERMINATION OF A SUCCESSFUL RUN                         * 01280000
*   04 ERROR WITHIN A MEMBER- WILL TRY TO PROCESS NEXT MEMBER IF PODS * 01300000
*   12 UNRECOVERABLE ERROR- TERMINATION OF JOB.                       * 01320000
*   16 ERROR IN LABEL HANDLING IN USERS ROUTINE- TERMINATION OF JOB   * 01340000
*                                                                     * 01360000
*EXTERNAL ROUTINES- I/O HANDLED AT READ/WRITE LEVEL, GETMAIN, LINK,   * 01380000
*   BLDL, FIND, STOW USED.                                            * 01400000
*                                                                     * 01420000
*TABLES/WORK AREAS-                                                   * 01440000
*   -KEYTAB- LIST OF VALID KEY WORDS USED ON CONTROL CARDS            * 01460000
*   -COMDTABL- LIST OF VALID COMMAND WORDS USED ON CONTROL CARDS      * 01480000
*   -SWITCHRD- BUFFER CONTAINING CONTROL CARD AND SWITCHES USED       * 01500000
*   BY CARD SCAN ROUTINE.                                             * 01520000
*   -LOGOUTAR- BUFFER WHICH IS USED BY LOG OUT ROUTINE FOR MESSAGES.  * 01540000
*   -STARTAB- TABLE OF SWITCHES WHICH ARE RESET TO ZERO UPON ENTRY    * 01560000
*   TO MODULE. ALL SWITCHES NEEDING REINITIALIZATION SHOULD BE PUT    * 01580000
*   INTO THIS TABLE.                                                  * 01600000
*                                                                     * 01620000
*ATTRIBUTES- SERIAL REUSABLE, BLOCK LOADS                               01640000
*                                                                     * 01660000
*  THIS CSECT-   1. WRITES MESSAGES OR RECORDS ON SYSPRINT            * 01680000
*                2. PRINTS A TITLE ON THE TOP OF EACH PAGE AND        * 01700000
*        NUMBERS THE PAGES.                                           * 01720000
*                3. MESSAGE TO BE PRINTED IS DETERMINED BY THE CODE   * 01740000
*        IN GR11. THIS CODE CORRESPONDS TO MESSAGE NUMBER. THE        * 01760000
*        ADDRESS OF ANY CONSTANT TO BE INSERTED INTO A MESSAGE IS     * 01780000
*        PASSED IN GR7.                                               * 01800000
*                4. ADDITIONAL MESSAGES MAY BE ADDED BY ASSIGNING     * 01820000
*        THEM A UNIQUE 2 DIGIT CODE, PUTTING THE MESSAGE IN THIS      * 01840000
*        CSECT, PUTTING AN EQUATE FOR THE MESSAGE SIZE IN THIS CSECT, * 01860000
*        PUTTING AN EQUATE FOR THE MESSAGE NUMBER IN THE COMMON       * 01880000
*        DSECT- IEBUPCON, AND ADDING THE MESSAGE CONSTANT CODE AND    * 01900000
*        HANDLER TO 'MSGSTART' TABLE BEFORE LAST ENTRY OF 'FF'.       * 01920000
*                5. SYSPRINT DCB IS CONTAINED IN THIS CSECT. SYSPRINT * 01940000
*        IS OPENED WHEN CSECT1 SETS 'PRIMESW' AND GIVES CONTROL TO    * 01960000
*        THIS CSECT TO OPEN SYSPRINT AND PRINT THE INITIAL HEADER     * 01980000
*        STATEMENT. ANY ERRORS IN OPENING SYSPRINT (USER HAS FORGOTTEN* 02000000
*        THE SYSPRINT DD STATEMENT OR HAS SPECIFIED INCORRECT BLOCK-  * 02020017
*        SIZE) RESULTS IN THIS CSECT SETTING THE 'LOGBADSW' AND       * 02040017
*        RETURNING TO THE INITIAL CSECT WHICH RETURNS CONTROL TO THE  * 02060017
*        OPERATING SYSTEM WITH A CONDITION CODE OF 12 IN REGISTER 15. * 02080017
*                6. FINAL TERMINATION OF THE PROGRAM IS INITIATED BY  * 02100000
*        THIS CSECT. WHEN 'QUITALL' SWITCH IS SET, THIS CSECT GIVES   * 02120000
*        THE LAST INFORMATION MESSAGE, GIVES THE IEBUPDAT END OF JOB  * 02140000
*        MESSAGE, CLOSES THE SYSPRINT DCB, AND RETURNS CONTROL TO THE * 02160000
*        OPERATING SYSTEM.                                            * 02180000
*                                                                     * 02200000
         EJECT                                                          02220000
*     SYMBOLIC REGISTER NOTATION   GR0 - GR15                           02240000
GR0      EQU   0                                                        02260000
GR1      EQU   1                                                        02280000
GR2      EQU   2                                                        02300000
GR3      EQU   3                                                        02320000
GR4      EQU   4                       REGISTER RESERVED FOR CSECT1     02340000
GR5      EQU   5                                                        02360000
GR6      EQU   6                                                        02380000
GR7      EQU   7                                                        02400000
GR8      EQU   8                                                        02420000
GR9      EQU   9                                                        02440000
GR10     EQU   10                                                       02460000
GR11     EQU   11                                                       02480000
GR12     EQU   12                                                       02500000
GR13     EQU   13                                                       02520000
GR14     EQU   14                                                       02540000
GR15     EQU   15                                                       02560000
         ENTRY SYNADMSG                                          A27716 02570019
         SPACE 1                                                        02580000
*********************************************************************   02600000
**       THIS IS THE GENERALIZED MESSAGE WRITER WHICH INCLUDES THE      02620000
**    ABILITY TO PRINT A HEADER ON EACH PAGE WITH ASCENDING PAGE        02640000
**    NUMBERS.                                                          02660000
*********************************************************************   02680000
         SPACE 1                                                        02700000
IEBUPLOG CSECT                                                          02720000
*1101046400,060200-062320,063000-096000                            UL0H 02723017
*1101098800                                                        UL0H 02724017
*1131020200-020800,031600,032600,042200,042800,044800,114000-114200BS0H 02726017
*1131059600-059800,073400,091800-092200,103800                     BS0H 02732017
* 063100,071500-072500,097800-098000,107400-107600,114200        A27716 02732319
* 036000                                                         A31438 02732619
*                                                                A23998 02732719
* 089112                                                         A32057 02732819
* 098800,105930                                                  A34086 02732920
         EXTRN SPSYNAD                 SYSPRINT SYNAD ROUTINE    A27716 02733019
* 105930                                                         A34086 02733520
*C097600                                                       @YA02555 02733702
*C 102800,103000                                               @ZA01692 02733802
*C 035600                                                      @ZA04364 02734040
         ENTRY  CLOSEPRT  ENTRY PT FROM SYSPRINT SYNAD ROUTINE   A27716 02738202
         SAVE  (14,12)                                                  02740000
         BALR  GR2,0                   ESTABLISH BASE ADDRESS REGISTER  02760000
         USING NEXT,GR2                                                 02780000
         USING IEBUPCON,GR12           DSECT POINTER                    02800000
NEXT     ST    GR13,SAVE13X            SAVE REGISTER 13                 02820000
         LA    GR13,REGSAVE            ADDRESS OF LOG REGISTER SAVE     02840000
         CLI   ASISMSW,X'0F'           WRITE RECORD SWITCH              02860000
         BE    LOADZERO                YES- CONTINUE                    02880000
         TM    PRIMESW,X'0F'           INITIAL ENTRY AND/OR HEADER      02900000
         BC    4,HEADIT                WRITE HEADER AND STATEMENT       02920000
         BC    1,PRIMEHD               INITIAL- OPEN DCB,WRITE HEADER   02940000
         TM    QUITALL,X'0F'           LAST ENTRY TO THIS ROUTINE       02960000
         BC    4,GIVECC                YES- GIVE CONDITION CODE MESSAGE 02980000
         B     MSGSTART                SELECT MESSAGE                   03000000
MSGWRTE  MVC   LOGOUTAR(7),IEBCON      MOVE IN CONSTANT IEB5  I         03020000
         MVC   LOGOUTAR+4(2),0(GR5)    MOVE IDENTIFYING NUMBER IN       03040000
         EX    GR6,MOVEMESS            MOVE THE MESSAGE TO PRINT BUFFER 03060000
         SPACE 1                                                        03080000
LOADZERO CLI   LINECNT,LINES           IS PAGE FULL                     03100000
         BE    HEADIT                  YES- WRITE HEADER                03120000
         LA    GR5,TEXTCTL             PRINT BUFFER                     03140000
WRITELOG PUT   DCBLOGR,(GR5)            WRITE MESSAGE OR RECORD    BS0H 03160017
         IC    GR14,LINECNT            OBTAIN LINE COUNT                03180000
         LA    GR14,1(GR14)            ADD 1 TO IT                      03200000
         MVI   ASISMSW,X'00'           CLEAR WRITE RECORD SWITCH        03220000
         STC   GR14,LINECNT            STORE NEW LINE COUNT             03240000
         MVI   TEXTCTL,C' '            SET FOR SINGLE SPACE             03280000
RETURNX  MVI   LOGOUTAR,C' '           CLEAR PRINT BUFFER               03300000
         MVC   LOGOUTAR+1(119),LOGOUTAR                                 03320000
         TM    QUITALL,X'0F'           TEST IF ERROR TERMINATION        03340000
         BC    8,GOBACK                NO- NORMAL RETURN                03360000
         BC    4,CLOSEPRT              HAVE GIVEN EOJ MESSAGE CLOSE DCB 03380000
         MVI   QUITALL,X'0E'           FLAG AS EOJ MESSAGE              03400000
         B     MSG19BLD                SAVE TIME BRANCH DIRECT TO MSG   03420000
GIVECC   LH    GR6,HICONCDE            LOAD CONDITION CODE              03440000
         CVD   GR6,INCREMWA            CONVERT RETURN CODE              03460000
         UNPK  LOGOUTAR+35(8),INCREMWA(8)    UNPACK RETURN CODE         03480000
         OI    LOGOUTAR+42,X'F0'       CLEAR GARBAGE BYTE               03500000
         MVI   QUITALL,X'0F'           SET QUIT FLAG TO FORCE EOJ MSG   03520000
         B     MSG18BLD                SAVE TIME BRANCH DIRECT          03540000
CLOSEPRT CLOSE (DCBLOGR)               CLOSE MESSAGE DCB       @ZA04364 03560040
         FREEPOOL DCBLOGR                                          BS0H 03570017
         LH    GR10,HICONCDE      SAVE CONDITIE CODE             A31438 03572019
         LA    GR0,DSECTSIZ       GET SIZE OF IEBUPCON           A31438 03574019
         LR    GR1,GR12           GET ADDRESS OF IEBUPCON        A31438 03576019
         L     GR13,SAVE13        ADDRESS SUPERVISOR REGISTERS   A37865 03576421
         FREEMAIN R,LV=(0),A=(1)  FREE AREA USED BY IEBUPCON     A31438 03578019
         LR    GR15,GR10          GET CONDITIE CODE              A31438 03600019
         RETURN  (14,12),T,RC=(15)                                      03620000
GOBACK   TM    DFLG,X'10'         TEST FOR BLKSIZE ERROR         A23998 03630018
         BC    1,GIVECC           GIVE LAST MSG AND QUIT         A23998 03640018
         L     GR13,SAVE13X       RESTORE REGS RETURN TO PROG           03650018
         RETURN  (14,12)                                                03660000
         SPACE 1                                                        03680000
RESTORMS LA    GR5,SAVEMESS            BUFFER ADDRESS                   03700000
         B     WRITELOG                WRITE THE MESSAGE                03720000
HEADIT   LA    GR3,RESTORMS            RETURN FROM HEADER PRINT         03740000
         MVC   MESSBUFF(120),LOGOUTAR  SAVE TILL HEADER IS PRINTED      03760000
         B     HDRPRINT                PRINT HEADER                     03780000
PRIMEHD  LA    GR11,DCBLOGR            ADDRESS OF PRINTER DCB           03800000
         ST    GR11,DCBLOG             STORE POINTER TO DCB             03820000
         MVC   BDDNAM(8,GR11),SYSPRNTN MOVE NAME INTO DCB               03840000
         MVI   DFLG,X'00'         INITIALIZE BLKSIZE ERROR FLAG    BS0H 03850017
         OPEN  (DCBLOGR,OUTPUT)        OPEN SYSPRINT DCB                03860000
         TM    BOFLGS(GR11),X'10'      IS OPEN BIT ON                   03880000
         BZ    ANERROR                 ERROR- DCB COULD NOT BE OPENED   03900000
         TM    DFLG,X'10'               TEST FOR BLKSIZE ERROR     BS0H 03906017
         BC    1,BLKSZERR         INVALID BLKSIZE                A23998 03913018
         LA    GR3,RETURNX             RETURN FROM PRINTING HEADER      03920000
HDRPRINT MVI   PRIMESW,X'00'           CLEAR PRIME SWITCH          3628 03930015
         MVI   LOGOUTAR,C' '           CLEAR PRINT BUFFER               04080000
         MVC   LOGOUTAR+1(119),LOGOUTAR                                 04100000
         MVI   TEXTCTL,C'1'            SKIP PAGE                        04120000
         MVC   LOGOUTAR+7(5),SYSINHD   MOVE IN SYSIN REFERENCE          04140000
         MVC   LOGOUTAR+40(10),NEWMASTR MOVE IN NEW MASTER REFERENCE    04160000
         MVC   LOGOUTAR+90(17),HDSAVE  LOG REFERENCE TO IEBUPDAT        04180000
         MVC   LOGOUTAR+108(4),PAGENO  MOVE IN PAGE NUMBER              04200000
         PUT   DCBLOGR,TEXTCTL          WRITE HEADER               BS0H 04220017
         MVI   ASISMSW,X'00'           CLEAR RECORD SWITCH              04240000
         MVI   LINECNT,X'04'           HEADER + 3 SPACES INITIAL LINE 4 04260000
         PACK  PGCONVRT(8),PAGENO(4)   PACK PAGE NUMBER            3628 04262015
         CVB   GR15,PGCONVRT           CONVERT TO BINARY           3628 04264015
         LA    GR15,1(GR15)            ADD ONE TO PAGE NUMBER      3628 04266015
         CVD   GR15,PGCONVRT           CONVERT TO DECIMAL          3628 04268015
         UNPK  PAGENO(4),PGCONVRT(8)   PUT IN UPDATED PAGE NUMBER  3628 04270015
         OI    PAGENO+3,C'0'           CONVERT LAST BYTE           3628 04272015
         MVI   TEXTCTL,C'-'            SET TO TRIPLE SPACE              04300000
         BR    GR3                     RETURN TO WRITE TEXT OR GO BACK  04320000
         SPACE 1                                                        04340000
ANERROR  MVI   LOGBADSW,X'0F'          FLAG AS DCBLOGR NOT OPENED       04360000
         B     GOBACK                  RETURN                           04380000
PRINEXIT L     GR11,DCBLOG              LOAD DCB ADDRESS           BS0H 04381017
         USING IHADCB,GR11                                         BS0H 04382017
         LH    GR5,DCBBLKSI             LOAD BLOCKSIZE             BS0H 04383017
         LTR   GR5,GR5                  IS BLOCKSIZE SPECIFIED     BS0H 04384017
         BC    2,TESTSIZE               IF SO CHECK FOR MODULARITY BS0H 04385017
         MVI   DCBBLKSI+1,X'79'         INSERT BLOCKSIZE           BS0H 04386017
         BCR   15,GR14                                             BS0H 04387017
TESTSIZE SR    GR4,GR4                  TEST FOR CORRECT BLKSIZE   BS0H 04388017
         LA    GR6,121                                             BS0H 04389017
         DR    GR4,GR6                                             BS0H 04390017
         LTR   GR4,GR4                                             BS0H 04391017
         BCR   8,GR14                   IF OK RETURN               BS0H 04392017
         MVI   DFLG,X'10'               SET ERROR FLAG             BS0H 04393017
         MVI   DCBBLKSI,X'00'     CLEAR BLKSIZE                  A23998 04393618
         MVI   DCBBLKSI+1,X'79'   INSERT BLKSIZE FOR ERR MSG     A23998 04394218
         BCR   15,GR14                                             BS0H 04395017
         DROP  GR11                                                BS0H 04396017
BLKSZERR LA    GR7,SYSPRNTN       DD NAME FOR MESSAGE            A23998 04396618
         LA    GR11,NTOPMSG       NOT OPEN MSG CONSTANT          A23998 04397218
         LA    GR15,12            CONDITION CODE                 A23998 04397818
         STH   GR15,HICONCDE      RETURN CON CODE OF 12          A23998 04398418
         B     MSGSTART           SELECT MESSAGE                 A23998 04399018
         SPACE 2                                                        04400000
HDSAVE   DC    C'IEBUPDTE LOG PAGE'                                     04420000
SYSINHD  DC    C'SYSIN'                                                 04440000
NEWMASTR DC    C'NEW MASTER'                                            04460000
         DS    0F                                                       04465018
DCBLST   DC    X'85'                                               BS0H 04470017
         DC    AL3(PRINEXIT)                                       BS0H 04480017
DFLG     DS    X                        BLOCKSIZE ERROR FLAG       BS0H 04490017
PGCONVRT DC    D'0'                    BUFFER FOR CONVERTING PAGE       04500000
SAVEMESS DC    C'-'                    TRIPLE SPACE                     04520000
MESSBUFF DS    CL120                   HOLDS MESSAGE WHILE HEADER PRINT 04540000
REGSAVE  DS    18F                     SAVE REGISTERS ON ENTRY          04560000
SAVE13X  DS    F                       HOLDS REGISTER 13 FOR THIS CSECT 04580000
MOVEMESS MVC   LOGOUTAR+8(1),2(GR5)    MOVE MESSAGE TO BUFFER           04600000
LINECNT  DC    X'00'                   LINES USED                       04620000
IEBCON   DC    C'IEB8  I'                                          UL0H 04628017
TOT      DC    C'TOTALING'                                         UL0H 04633017
USERLABL DC    C'USER LABEL'                                       UL0H 04638017
IHL      DC    C'INPUT HEADER'                                     UL0H 04640017
ITL      DC    C'INPUT TRAILER'                                    UL0H 04642017
OHL      DC    C'OUTPUT HEADER'                                    UL0H 04644017
OTL      DC    C'OUTPUT TRAILER'                                   UL0H 04646017
LBLS     DC    C' LABELS.'             USER LABEL MESSAGE FRAGMENT UL0H 04650017
DUBLWORD DS    D                                                   UL0H 04654017
LINES    EQU   56                      MAXIMUM LINES/PAGE               04660000
         EJECT                                                          04680000
*   DETERMINES MESSAGE TO BE PRINTED                                  * 04700000
*          MESSAGE CODE ADDRESS + OFFSET POINTS TO CORRECT MSGBLD AREA  04720000
*                                                                     * 04740000
MSGTEST  LA    GR5,X'FF'               END OF TEST                      04760000
NEXTCODE SR    GR3,GR3                 CLEAR REGISTER                   04780000
         IC    GR3,0(GR6)              GET MESSAGE NUMBER               04800000
         CR    GR3,GR11                CORRECT MESSAGE NUMBER           04820000
         BE    THATSIT                 YES- PREPARE TO ENTER ROUTINE    04840000
         CR    GR3,GR5                 END OF TEST TABLE                04860000
         BE    GOBACK                  IGNORE- INVALID MESSAGE CODE     04880000
         LA    GR6,2(GR6)              GET NEXT CODE                    04900000
         B     NEXTCODE                TEST THE NEXT CODE               04920000
THATSIT  SR    GR3,GR3                 CLEAR REGISTER                   04940000
         IC    GR3,1(GR6)              GET DISPLACEMENT                 04960000
         B     0(GR3,GR6)              ENTER MESSAGE HANDLER            04980000
         SPACE 1                                                        05000000
MSGSTART BAL   GR6,MSGTEST             LINK TO TEST MESSAGE NUMBER      05020000
         DC    X'01'                   MESSAGE NUMBER                   05040000
         DC    AL1(MSG01-MSGSTART-4)   ADDRESS OF MESSAGE 1             05060000
         DC    X'02'                                                    05080000
         DC    AL1(MSG02-MSGSTART-6)   ADDRESS OF MESSAGE 2  SYSIN I/O  05100000
         DC    X'03'                                                    05120000
         DC    AL1(MSG03-MSGSTART-8)   ADDRESS OF MESSAGE 3 SYSUT1 I/O  05140000
         DC    X'04'                                                    05160000
         DC    AL1(MSG04-MSGSTART-10)  ADDRESS OF MESSAGE 4 SYSUT2 I/O  05180000
         DC    X'05'                                                    05200000
         DC    AL1(MSG05-MSGSTART-12)  ADDRESS OF MESSAGE 5 CONTROL ERR 05220000
         DC    X'06'                                                    05240000
         DC    AL1(MSG06-MSGSTART-14)  ADDRESS OF MESSAGE 6 SEQUENCE ER 05260000
         DC    X'07'                                                    05280000
         DC    AL1(MSG07-MSGSTART-16)  ADDRESS OF MESSAGE 7 INVALID OP  05300000
         DC    X'08'                                                    05320000
         DC    AL1(MSG08-MSGSTART-18)  ADDRESS OF MESSAGE 8 TERMINATION 05340000
         DC    X'09'                                                    05360000
         DC    AL1(MSG09-MSGSTART-20)  ADDRESS OF MESSAGE 9 SCANNING    05380000
         DC    X'10'                                                    05400000
         DC    AL1(MSG10-MSGSTART-22)  ADDRESS OF MESSAGE 10 OUT DELETE 05420000
         DC    X'11'                                                    05440000
         DC    AL1(MSG11-MSGSTART-24)  ADDRESS OF MESSAGE 11 OUT NUMBER 05460000
         DC    X'12'                                                    05480000
         DC    AL1(MSG12-MSGSTART-26)  ADDRESS OF MESSAGE 12 DIRECT WRT 05500000
         DC    X'13'                                                    05520000
         DC    AL1(MSG13-MSGSTART-28)  ADDRESS OF MESSAGE 13 DIRECT FUL 05540000
         DC    X'14'                                                    05560000
         DC    AL1(MSG14-MSGSTART-30)  ADDRESS OF MESSAGE 14 DD NO OPEN 05580000
         DC    X'15'                                                    05600000
         DC    AL1(MSG15-MSGSTART-32)  ADDRESS OF MESSAGE 15 ONLY 1 PS  05620000
         DC    X'16'                                                    05640000
         DC    AL1(MSG16-MSGSTART-34)  ADDRESS OF MESSAGE 16 NAME FOUND 05660000
         DC    X'17'                                                    05680000
         DC    AL1(MSG17-MSGSTART-36)  ADDRESS OF MESSAGE 17 NOT FOUND  05700000
         DC    X'18'                                                    05720000
         DC    AL1(MSG18-MSGSTART-38)  ADDRESS OF MESSAGE 18 CONCODE    05740000
         DC    X'19'                                                    05760000
         DC    AL1(MSG19-MSGSTART-40)  ADDRESS OF MESSAGE 19  EOJ       05780000
         DC    X'20'                                                    05800000
         DC    AL1(MSG20-MSGSTART-42)  ADDRESS OF MESSAGE 20 INPLACE 1  05820000
         DC    X'21'                                                    05840000
         DC    AL1(MSG21-MSGSTART-44)  ADDRESS OF MESSAGE 21 INVALID NM 05860000
         DC    X'22'                                                    05880000
         DC    AL1(MSG22-MSGSTART-46)  ADDRESS OF MESSAGE 22 EXIT CODE  05900000
         DC    X'23'                                                    05920000
         DC    AL1(MSG23-MSGSTART-48)  ADDRESS OF MESSAGE 23 NULL SET   05940000
         DC    X'25'                                                    06000000
         DC    AL1(MSG25-MSGSTART-50)  ADDRESS OF MESSAGE 25 PS IGNUL0H 06020017
         DC    X'26'                                               UL0H 06040017
         DC    AL1(MSG26-MSGSTART-52)  ADDRESS OF MESSAGE 26 NAME AUL0H 06060017
         DC    X'27'                                               UL0H 06080017
         DC    AL1(MSG27-MSGSTART-54)  ADDRESS OF MESSAGE 27 INVALIUL0H 06100017
         DC    X'28'                                               UL0H 06120017
         DC    AL1(MSG28-MSGSTART-56)  ADDRESS OF MESSAGE 28 BAD PAGE   06140017
         DC    X'29'                                               UL0H 06160017
         DC    AL1(MSG29-MSGSTART-58)  ADDRESS OF MESSAGE 29 DDNAMEUL0H 06180017
         DC    X'30'                                               UL0H 06190017
         DC    AL1(MSG30-MSGSTART-60)  ADDRESS OF MESSAGE 30 LRECL UNEQ 06210017
         DC    X'31'                                               3341 06226016
         DC    AL1(MSG31-MSGSTART-62)  ADDRESS OF MSG BAD DSORGS   3341 06233017
         DC    X'32'                                               UL0H 06233217
         DC    AL1(MSG32-MSGSTART-64)                              UL0H 06233417
         DC    X'33'                                               UL0H 06233617
         DC    AL1(MSG33-MSGSTART-66)                              UL0H 06233817
         DC    X'34'                                               UL0H 06234017
         DC    AL1(MSG34-MSGSTART-68)                              UL0H 06234217
         DC    X'35'                                               UL0H 06234417
         DC    AL1(MSG35-MSGSTART-70)                              UL0H 06234617
         DC    X'36'                                               UL0H 06234817
         DC    AL1(MSG36-MSGSTART-72)                              UL0H 06235017
         DC    X'37'                                               UL0H 06235217
         DC    AL1(MSG37-MSGSTART-74)                              UL0H 06235417
         DC    X'38'                                               UL0H 06235617
         DC    AL1(MSG38-MSGSTART-76)                              UL0H 06235817
         DC    X'39'                                               UL0H 06236017
         DC    AL1(MSG39-MSGSTART-78)                              UL0H 06236217
         DC    X'40'                                               UL0H 06236417
         DC    AL1(MSG40-MSGSTART-80)                              UL0H 06236617
         DC    X'41'                                               UL0H 06236817
         DC    AL1(MSG41-MSGSTART-82)                              UL0H 06237017
         DC    X'42'                                               UL0H 06237217
         DC    AL1(MSG42-MSGSTART-84)                              UL0H 06237417
         DC    X'43'                                               UL0H 06237617
         DC    AL1(MSG43-MSGSTART-86)                              UL0H 06237817
         DC    X'44'                                               UL0H 06238217
         DC    AL1(MSG44-MSGSTART-88)                              UL0H 06238617
         DC    X'45'                                               UL0H 06239017
         DC    AL1(MSG45-MSGSTART-90)                              UL0H 06239417
         DC    X'46'                                               UL0H 06239617
         DC    AL1(MSG46-MSGSTART-92)                              UL0H 06239817
         DC    X'FF'                   END OF TABLE                     06240000
         DC    X'FF'                   LAST TABLE ENTRY                 06260000
         SPACE 1                                                        06280000
MSG01    B     MSG01BLD                BLOCKSIZE NOT GIVEN OR WRONGUL0H 06290017
         SPACE 1                                                   UL0H 06300017
MSG02    B     MSG02BLD I/O ERROR ON SYSIN,SYSUT1,SYSUT2 OR SYSPRINT    06306019
*                                                                A27716 06312019
         SPACE 1                                                   UL0H 06320017
MSG03    B     MSG03BLD                I/O ERROR ON SYSUT1         UL0H 06330017
         SPACE 1                                                   UL0H 06340017
MSG04    B     MSG04BLD                I/O ERROR ON SYSUT2         UL0H 06350017
         SPACE 1                                                   UL0H 06360017
MSG05    B     MSG05BLD                CONTROL STATEMENT ERROR     UL0H 06370017
         SPACE 1                                                   UL0H 06380017
MSG06    B     MSG06BLD                STATEMENT SEQUENCE ERROR    UL0H 06390017
         SPACE 1                                                   UL0H 06400017
MSG07    B     MSG07BLD                INVALID OPERATION           UL0H 06410017
         SPACE 1                                                   UL0H 06420017
MSG08    B     MSG08BLD                TERMINATION OF MEMBER UPDATEUL0H 06430017
         SPACE 1                                                   UL0H 06440017
MSG09    B     MSG09BLD                SCANNING FOR NEXT MEMBER    UL0H 06450017
         SPACE 1                                                   UL0H 06460017
MSG10    B     MSG10BLD                NO RECORDS IN DELETE RANGE  UL0H 06470017
         SPACE 1                                                   UL0H 06480017
MSG11    B     MSG11BLD                NO RECORDS IN NUMBER RANGE  UL0H 06490017
         SPACE 1                                                   UL0H 06500017
MSG12    B     MSG12BLD                DIRECTORY WRITE ERROR       UL0H 06510017
         SPACE 1                                                   UL0H 06520017
MSG13    B     MSG13BLD                OUTPUT DIRECTORY FULL       UL0H 06530017
         SPACE 1                                                   UL0H 06540017
MSG14    B     MSG14BLD                DD NAMED CANNOT BE OPENED   UL0H 06550017
         SPACE 1                                                        06560017
MSG15    B     MSG15BLD                CANNOT PROCESS MULTIPLE PS DUL0H 06570017
         SPACE 1                                                        06580017
MSG16    CLI   ASISMSW,X'0E'           SPECIAL BLDL/FIND MESSAGE   UL0H 06590017
         LA    GR5,IEBUPD16            MESSAGE ADDRESS             UL0H 06600017
         BE    SPCMSG16                YES- SET UP MESSAGE         UL0H 06610017
         B     MSG16BLD                NAME FOUND IN DIRECTORY STOWUL0H 06620017
         SPACE 1                                                        06630017
MSG17    CLI   ASISMSW,X'0E'           SPECIAL BLDL/FIND MESSAGE   UL0H 06640017
         LA    GR5,IEBUPD17            MESSAGE ADDRESS             UL0H 06650017
         BE    SPCMSG17                YES- SET UP MESSAGE         UL0H 06660017
         B     MSG17BLD                NAME NOT FOUND STOW MESSAGE UL0H 06670017
         SPACE 1                                                   UL0H 06680017
MSG18    B     MSG18BLD                HIGHEST CONDITION CODE      UL0H 06690017
         SPACE 1                                                   UL0H 06700017
MSG19    B     MSG19BLD                EOJ MESSAGE                 UL0H 06710017
         SPACE 1                                                   UL0H 06720017
MSG20    B     MSG20BLD                ONE UPDATE INPLACE PER PASS UL0H 06730017
         SPACE 1                                                   UL0H 06740017
MSG21    B     MSG21BLD                INVALID EXIT NAME           UL0H 06750017
         SPACE 1                                                        06760017
MSG22    B     MSG22BLD                EXIT RETURN CODE ENDED JOB (UL0H 06770017
         SPACE 1                                                        06780017
MSG23    B     MSG23BLD                NULL DATA SET IDENTIFIED    UL0H 06790017
         SPACE 1                                                        06800017
         SPACE 1                                                        06810017
MSG25    B     MSG25BLD                ALIAS IGNORE SEQUENTIAL DATAUL0H 06820017
         SPACE 1                                                        06830017
MSG26    B     MSG26BLD                MEMBER NAME ALIAS STOWED AS UL0H 06840017
         SPACE 1                                                        06850017
MSG27    B     MSG27BLD                INVALID INPUT PARAMETER     UL0H 06860017
         SPACE 1                                                        06870017
MSG28    B     MSG28BLD                PAGE NUMBER PARAMETER INVALIUL0H 06880017
         SPACE 1                                                        06890017
MSG29    B     MSG29BLD                DDNAME PARAMETER IS INVALID UL0H 06900017
         SPACE 1                                                        06910017
MSG30    B     MSG30BLD                OLD AND NEW MASTER LRECL UNEUL0H 06920017
*                                                                  3341 06930017
MSG31    B     MSG31BLD            OM AND NM INCOMPATIBLE DSORGS   3341 06940017
*                                                                  3341 06950017
MSG32    B     MSG32BLD                                            UL0H 06960017
MSG33    B     MSG33BLD                                            UL0H 06970017
MSG34    B     MSG34BLD                                            UL0H 06980017
MSG35    B     MSG35BLD                                            UL0H 06990017
MSG36    B     MSG36BLD                                            UL0H 07000017
MSG37    B     MSG37BLD                                            UL0H 07010017
MSG38    B     MSG38BLD                                            UL0H 07020017
MSG39    B     MSG39BLD                                            UL0H 07030017
MSG40    B     MSG40BLD                                            UL0H 07040017
MSG41    B     MSG41BLD                                            UL0H 07050017
MSG42    B     MSG42BLD                                            UL0H 07060017
MSG43    B     MSG43BLD                                            UL0H 07070017
MSG44    B     MSG44BLD                                            UL0H 07080017
MSG45    B     MSG45BLD                                            UL0H 07090017
MSG46    B     MSG46BLD                                            UL0H 07095017
         SPACE 1                                                        07100017
MSG01BLD LA    GR5,IEBUPD01            ADDRESS OF MESSAGE          UL0H 07110017
         LA    GR6,MSG01SIZ            SIZE OF MESSAGE             UL0H 07120017
         MVC   2(2,GR5),0(GR7)         MOVE IN CT/0M/NM REFERENCE  UL0H 07130017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07140017
MSG02BLD LA    GR5,IEBUPD02                                      A27716 07150019
         LA    GR6,MSG02SIZ                                      A27716 07160019
         B     MSGWRTE                                           A27716 07170019
MSG03BLD LA    GR5,IEBUPD03                                      A27716 07180019
         LA    GR6,MSG03SIZ                                      A27716 07190019
         B     MSGWRTE                                           A27716 07200019
MSG04BLD LA    GR5,IEBUPD04                                      A27716 07210019
         LA    GR6,MSG04SIZ                                      A27716 07220019
         B     MSGWRTE                                           A27716 07230019
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07260017
MSG05BLD LA    GR5,IEBUPD05            ADDRESS OF MESSAGE          UL0H 07270017
         LA    GR6,MSG05SIZ            SIZE OF MESSAGE             UL0H 07280017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07290017
MSG06BLD LA    GR5,IEBUPD06            ADDRESS OF MESSAGE          UL0H 07300017
         LA    GR6,MSG06SIZ            SIZE OF MESSAGE             UL0H 07310017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07320017
MSG07BLD LA    GR5,IEBUPD07            ADDRESS OF MESSAGE          UL0H 07330017
         LA    GR6,MSG07SIZ            SIZE OF MESSAGE             UL0H 07340017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07350017
MSG08BLD LA    GR5,IEBUPD08            ADDRESS OF MESSAGE          UL0H 07360017
         LA    GR6,MSG08SIZ            SIZE OF MESSAGE             UL0H 07370017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07380017
MSG09BLD LA    GR5,IEBUPD09            ADDRESS OF MESSAGE          UL0H 07390017
         LA    GR6,MSG09SIZ            SIZE OF MESSAGE             UL0H 07400017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07410017
MSG10BLD LA    GR5,IEBUPD10            ADDRESS OF MESSAGE          UL0H 07420017
         LA    GR6,MSG10SIZ            SIZE OF MESSAGE             UL0H 07430017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07440017
MSG11BLD LA    GR5,IEBUPD11            ADDRESS OF MESSAGE          UL0H 07450017
         LA    GR6,MSG11SIZ            SIZE OF MESSAGE             UL0H 07460017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07470017
MSG12BLD LA    GR5,IEBUPD12            ADDRESS OF MESSAGE          UL0H 07480017
         LA    GR6,MSG12SIZ            SIZE OF MESSAGE             UL0H 07490017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07500017
MSG13BLD LA    GR5,IEBUPD13            ADDRESS OF MESSAGE          UL0H 07510017
         LA    GR6,MSG13SIZ            SIZE OF MESSAGE             UL0H 07520017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07530017
MSG14BLD LA    GR5,IEBUPD14            ADDRESS OF MESSAGE          UL0H 07540017
         MVC   9(8,GR5),0(GR7)         MOVE IN DD NAME             UL0H 07550017
         LA    GR6,MSG14SIZ            SIZE OF MESSAGE             UL0H 07560017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07570017
MSG15BLD LA    GR5,IEBUPD15            ADDRESS OF MESSAGE          UL0H 07580017
         LA    GR6,MSG15SIZ            SIZE OF MESSAGE             UL0H 07590017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07600017
MSG16BLD LA    GR6,MSG16SIZ            SIZE OF MESSAGE             UL0H 07610017
         B     INSERTNM                INSERT THE NAME             UL0H 07620017
SPCMSG16 LA    GR6,MSG16ASZ            SPECIAL MESSAGE SIZE        UL0H 07630017
         B     INSERTNM                INSERT THE NAME             UL0H 07640017
SPCMSG17 LA    GR6,MSG17ASZ            SPECIAL MESSAGE SIZE        UL0H 07650017
         B     INSERTNM                INSERT THE NAME             UL0H 07660017
MSG17BLD LA    GR6,MSG17SIZ            SIZE OF MESSAGE             UL0H 07670017
INSERTNM MVC   15(8,GR5),0(GR7)        MOVE MEMBER NAME TO BUFFER  UL0H 07680017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07690017
MSG18BLD LA    GR5,IEBUPD18            ADDRESS OF MESSAGE          UL0H 07700017
         LA    GR6,MSG18SIZ            SIZE OF MESSAGE             UL0H 07710017
         B     MSGWRTE                 CONDITION CODE ALREADY IN BUUL0H 07720017
MSG19BLD LA    GR5,IEBUPD19            ADDRESS OF MESSAGE          UL0H 07730017
         LA    GR6,MSG19SIZ            SIZE OF MESSAGE             UL0H 07740017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07750017
MSG20BLD LA    GR5,IEBUPD20            ADDRESS OF MESSAGE          UL0H 07760017
         LA    GR6,MSG20SIZ            SIZE OF MESSAGE             UL0H 07770017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07780017
MSG21BLD LA    GR5,IEBUPD21            ADDRESS OF MESSAGE          UL0H 07790017
         LA    GR6,MSG21SIZ            SIZE OF MESSAGE             UL0H 07800017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07810017
MSG22BLD LA    GR5,IEBUPD22            ADDRESS OF MESSAGE          UL0H 07820017
         LA    GR6,MSG22SIZ            SIZE OF MESSAGE             UL0H 07830017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07840017
MSG23BLD LA    GR5,IEBUPD23            ADDRESS OF MESSAGE          UL0H 07850017
         LA    GR6,MSG23SIZ            SIZE OF MESSAGE             UL0H 07860017
         MVC   2(8,GR5),0(GR7)         MOVE IN DD NAME             UL0H 07870017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07880017
MSG25BLD LA    GR5,IEBUPD25            ADDRESS OF MESSAGE          UL0H 07890017
         LA    GR6,MSG25SIZ            SIZE OF MESSAGE             UL0H 07900017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07910017
MSG26BLD LA    GR5,IEBUPD26            ADDRESS OF MESSAGE          UL0H 07920017
         LA    GR6,MSG26SIZ            SIZE OF MESSAGE             UL0H 07930017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07940017
MSG27BLD LA    GR5,IEBUPD27            ADDRESS OF MESSAGE          UL0H 07950017
         LA    GR6,MSG27SIZ            SIZE OF MESSAGE             UL0H 07960017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07970017
MSG28BLD LA    GR5,IEBUPD28            ADDRESS OF MESSAGE          UL0H 07980017
         LA    GR6,MSG28SIZ            SIZE OF MESSAGE             UL0H 07990017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 08000017
MSG29BLD LA    GR5,IEBUPD29            ADDRESS OF MESSAGE          UL0H 08010017
         LA    GR6,MSG29SIZ            SIZE OF MESSAGE             UL0H 08020017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 08030017
MSG30BLD LA    GR5,IEBUPD30            ADDRESS OF MESSAGE          UL0H 08040017
         LA    GR6,MSG30SIZ            SIZE OF MESSAGE             UL0H 08050017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 08060017
MSG31BLD LA    GR5,IEBUPD31        ADDRESS OF MESSAGE              3341 08070017
         LA    GR6,MSG31SIZ        SIZE OF MESSAGE                 3341 08080017
         B     MSGWRTE             GIVE MESSAGE                    3341 08090017
MSG32BLD LA    GR5,IEBUPD32             ADDRESS OF MESSAGE         UL0H 08110017
         LA    GR6,MSG32SIZ             SIZE OF MESSAGE            UL0H 08130017
         MVC   2(8,GR5),USERRTN         MOVE USER ROUTINE AND ADDR UL0H 08150017
         MVC   31(22,GR5),30(GR5)      CLEAN UP MESSAGE AREA       UL0H 08188017
         SR    GR10,GR10               CLEAR BRANCH REGISTE        UL0H 08258017
         IC    GR10,USERRTN+8           PICK UP ROUTINE INDICATOR  UL0H 08268017
         B     *(GR10)                  BRANCH ON THAT CONSTANT    UL0H 08278017
         B     CIHL                     INPUT HEADER ROUTINE       UL0H 08288017
         B     CITL                     INPUT TRAILER ROUTINE      UL0H 08298017
         B     COHL                     OUTPUT HEADER ROUTINE      UL0H 08308017
         B     COTL                     OUTPUT TRAILER ROUTINE     UL0H 08318017
CIHL     MVC   31(12,GR5),IHL           BUILD INPUT HEADER         UL0H 08328017
         MVC   43(8,GR5),LBLS           LABELS MESSAGE             UL0H 08338017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08348017
CITL     MVC   31(13,GR5),ITL          BUILD INPUT TRAILER         UL0H 08358017
         MVC   44(8,GR5),LBLS           LABELS MESSAGE             UL0H 08368017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08378017
COHL     MVC   31(13,GR5),OHL           BUILD OUTPUT HEADER        UL0H 08388017
         MVC   44(8,GR5),LBLS           LABELS MESSAGE             UL0H 08398017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08408017
COTL     MVC   31(14,GR5),OTL           BUILD OUTPUT TRAILER       UL0H 08418017
         MVC   45(8,GR5),LBLS           LABELS MESSAGE             UL0H 08428017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08438017
MSG33BLD LA    GR5,IEBUPD33             ADDRESS OF MESSAGE         UL0H 08448017
         LA    GR6,MSG33SIZ             SIZE OF MESSAGE            UL0H 08458017
         SR    GR7,GR7                                             UL0H 08468017
         IC    GR7,USERCONT             NUMBER OF ENTRANCES TO USERUL0H 08478017
         CVD   GR7,DUBLWORD             CONVERT NO. TO DECIMAL     UL0H 08488017
         UNPK  2(1,GR5),DUBLWORD+7(1)   AND UNPACK IT              UL0H 08498017
         OI    2(GR5),X'F0'             SO THAT IT CAN BE PRINTED  UL0H 08508017
         MVC   17(8,GR5),USERRTN        MOVE USER RTN NAME TO MSG  UL0H 08518017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08528017
MSG34BLD LA    GR5,IEBUPD34             ADDRESS OF MESSAGE         UL0H 08538017
         LA    GR6,MSG34SIZ             SIZE OF MESSAGE            UL0H 08548017
         MVC   24(8,GR5),USERRTN        MOVE USER RTN NAME TO MSG  UL0H 08558017
         SR    GR7,GR7                                             UL0H 08568017
         IC    GR7,LBLRETCD             PICK UP USER RETURN CODE   UL0H 08578017
         CVD   GR7,DUBLWORD             CONVERT RETURN CODE        UL0H 08588017
         UNPK  37(3,GR5),DUBLWORD+6(2)  TO DECIMAL AND UNPAKE IT   UL0H 08598017
         OI    39(GR5),X'F0'            SO THAT IT CAN BE PRINTED  UL0H 08608017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08618017
MSG35BLD LA    GR5,IEBUPD35             ADDRESS OF MESSAGE         UL0H 08628017
         LA    GR6,MSG35SIZ             SIZE OF MESSAGE            UL0H 08638017
         B     *(GR7)                   GO TO PROPER BUILD ROUTINE UL0H 08648017
         B     TOTLS                    TOTALING BUILD MESSAGE     UL0H 08658017
         B     USRLBLS                  USER LABEL BUILD MSG       UL0H 08668017
TOTLS    MVC   4(8,GR5),TOT             MOVE IN TOTAL KEYWORD      UL0H 08678017
         B     MSGWRTE                  GIVE  MESSAGE              UL0H 08688017
USRLBLS  MVC   2(10,GR5),USERLABL       USER LABELS KEY WORD       UL0H 08698017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08708017
MSG36BLD LA    GR5,IEBUPD36             ADDRESS OF MESSAGE         UL0H 08718017
         LA    GR6,MSG36SIZ             MESSAGE SIZE               UL0H 08728017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08738017
MSG37BLD LA    GR5,IEBUPD37             ADDRESS OF MESSAGE         UL0H 08748017
         LA    GR6,MSG37SIZ             SIZE OF MESSAGE            UL0H 08758017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08768017
MSG38BLD LA    GR5,IEBUPD38             ADDRESS OF MESSAGE         UL0H 08778017
         LA    GR6,MSG38SIZ             SIZE OF MESSAGE            UL0H 08788017
         SR    GR7,GR7                                             UL0H 08798017
         IC    GR7,USYSNCNT             NUMBER OF LABELS CREATED   UL0H 08808017
         CVD   GR7,DUBLWORD             CONVERT TO DECIMAL         UL0H 08818017
         UNPK  2(1,GR5),DUBLWORD+7(1)   AND UNPAKE FOR PRINTING    UL0H 08828017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08838017
MSG39BLD LA    GR5,IEBUPD39             ADDRESS OF MESSAGE         UL0H 08848017
         LA    GR6,MSG39SIZ             MESSAGE SIZE               UL0H 08858017
         MVC   2(8,GR5),TOTALRTN        USER TOTAL ROUTINE NAME    UL0H 08868017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08878017
MSG40BLD LA    GR5,IEBUPD40             ADDRESS OF MESSAGE         UL0H 08888017
         LA    GR6,MSG40SIZ             SIZE OF MESSAGE            UL0H 08898017
         MVC   2(8,GR5),TOTALRTN        USER TOTAL ROUTINE NAME    UL0H 08908017
         SR    GR7,GR7                 PREPARE FOR HALF A LOAD     000H 08908818
         LH    GR7,TOTRTNCD            LOAD TOTAL RETURN CODE      000H 08909618
         CVD   GR7,DUBLWORD            CONVERT IT TO DECIMAL       000H 08910418
         UNPK  DUBLWORD+5(3),DUBLWORD+6(2)   PREPARE CODE        A32057 08910919
         OI    DUBLWORD+7,X'F0'        FIX SIGN TO PRINT OUT     A32057 08911419
         CLI   DUBLWORD+5,X'00'        IS CODE 3 CHARS LONG        000H 08912018
         BNE   RTNCD3L                 IF SO, MOVE TO MESSAGE      000H 08912818
         MVI   DUBLWORD+5,C' '         IF NOT, BLANK OUT THE ZERO  000H 08913618
         CLI   DUBLWORD+6,X'00'        IS CODE 2 CHARS LONG        000H 08914418
         BNE   RTNCD3L                 IF SO, MOVE TO MESSAGE      000H 08915218
         MVI   DUBLWORD+6,C' '         IF NOT, BLANK OUT THE ZERO  000H 08916018
RTNCD3L  MVC   IEBUPD40+71(3),DUBLWORD+5        MOVE RETURN CODE TO000H 08916818
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08918017
MSG41BLD LA    GR5,IEBUPD41             ADDRESS OF MESSAGE         UL0H 08928017
         LA    GR6,MSG41SIZ             SIZE OF MESSAGE            UL0H 08938017
         MVC   27(8,GR5),TOTALRTN      USER TOTAL ROUTINE NAME     ULOH 08948018
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08958017
MSG42BLD LA    GR5,IEBUPD42             ADDRESS OF MESSAGE         UL0H 08968017
         LA    GR6,MSG42SIZ             SIZE OF MESSAGE            UL0H 08978017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08988017
MSG43BLD LA    GR5,IEBUPD43             ADDRESS OF MESSAGE         UL0H 08998017
         LA    GR6,MSG43SIZ             SIZE OF MESSAGE            UL0H 09008017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 09018017
MSG44BLD LA    GR5,IEBUPD44             ADDRESS OF MESSAGE         UL0H 09028017
         LA    GR6,MSG44SIZ             SIZE OF MESSAGE            UL0H 09038017
         B     COMMONBD                COMMON BUILD ROUTINE FOR 445UL0H 09614117
MSG45BLD LA    GR5,IEBUPD45             ADDRESS OF MESSAGE         UL0H 09614417
         LA    GR6,MSG45SIZ             SIZE OF MESSAGE            UL0H 09614717
COMMONBD SR    GR10,GR10               CLEAR BRANCH REGISTER       UL0H 09615117
         IC    GR10,USERRTN+8          PICK UP BRANCH CONSTANT     UL0H 09615517
         B     *(GR10)                 BRANCH ON CONSTANT          UL0H 09615917
         B     NOHEADER                BUILD NO HEADER LABEL MSG   UL0H 09616317
         B     NOTRALER                BUILD NO TRAILER LABEL MSG  UL0H 09616717
         B     NOHEADER                BUILD NO KEADER LABEL MSG   UL0H 09617117
         B     NOTRALER                BUILD NO TRAILER LABEL MSG  UL0H 09617517
NOHEADER MVC   10(7,GR5),IHL+5         PICK UP 'HEADER'            UL0H 09617917
         B     MSGWRTE                  GIVE MESSAGE               UL0H 09618317
NOTRALER MVC   10(7,GR5),ITL+6         PICK UP 'TRAILER'           UL0H 09618717
         B     MSGWRTE                  GIVE MESSAGE               UL0H 09618917
MSG46BLD LA    GR5,IEBUPD46             ADDRESS OF MESSAGE         UL0H 09619117
         LA    GR6,MSG46SIZ             SIZE OF MESSAGE            UL0H 09619317
         B     MSGWRTE                  GIVE MESSAGE               UL0H 09619517
*                                                                     * 09620000
*                                 IEBUPDTE MESSAGES                   * 09640000
*   ALL MESSAGES ARE PRECEDED BY CONSTANT OF IEB5XXI WHERE XX IS EQUAL* 09660000
*   TO THE FIRST TWO NUMBERS IN EACH MESSAGE LISTED BELOW.  THE LOG   * 09680000
*   ROUTINE 'MSGWRTE' BUILDS THE PROPER CODE FOR EACH MESSAGE.        * 09700000
*                                                                     * 09720000
         SPACE 1                                                        09740000
IEBUPD01 DC    CL36'01CT LRECL AND BLKSIZE ASSUMED 80/80'      @YA02555 09760002
IEBUPD02 DC    CL2'02'  I/O ERROR MESSAGE                        A27716 09768019
         DC    CL10'I/O ERROR '                                  A27716 09776019
SYNADMSG DC    CL80' '      THE PART OF THE I/O ERROR MSG BUILT  A27716 09784019
*                        DYNAMICALLY BY THE SYNADAF ROUTINE      A27716 09792019
IEBUPD03 DC    CL37'03PERMANENT INPUT ERROR - FIND MACRO'        A27716 09800019
IEBUPD04 DC    CL37'04PERMANENT INPUT ERROR - BLDL MACRO'        A27716 09808019
IEBUPD05 DC    CL26'05CONTROL STATEMENT ERROR.'                         09820000
IEBUPD06 DC    CL27'06STATEMENT SEQUENCE ERROR.'                        09840000
IEBUPD07 DC    CL20'07INVALID OPERATION.'                               09860000
IEBUPD08 DC    CL34'08TERMINATED THIS MEMBER. IEBUPDTE'          A34086 09880020
         DC    CL22' WILL TRY NEXT MEMBER.'                             09900000
IEBUPD09 DC    CL26'09SCANNING FOR NEXT MEMBER'                         09920000
IEBUPD10 DC    C'10DELETE RANGE INVALID'                                09940000
IEBUPD11 DC    C'11NUMBER RANGE INVALID'                                09960000
IEBUPD12 DC    CL24'12DIRECTORY WRITE ERROR.'                           09980000
IEBUPD13 DC    CL24'13OUTPUT DIRECTORY FULL.'                           10000000
IEBUPD14 DC    C'14DDNAME         CANNOT BE '                           10020000
         DC    C'OPENED.'                                               10040000
IEBUPD15 DC    CL30'15CANNOT PROCESS MORE THAN ONE'                     10060000
         DC    CL22' PS DATA SET PER PASS.'                             10080000
IEBUPD16 DC    C'16MEMBER NAME (        ) FOUND '                       10100000
IEBUP16A DC    C'IN NM DIRECTORY. '    MEMBER IN OM DIRECTORY BAD 4 ADD 10120000
         DC    C'TTR IS NOW ALTERED.'                                   10140000
IEBUPD17 DC    C'17MEMBER NAME (        ) NOT '                         10160000
         DC    C'FOUND '                                                10180000
IEBUP17A DC    C'IN NM DIRECTORY.  STOWED '  MEMBER NOT FOUND BAD CHANG 10200000
         DC    C'WITH TTR.'                                             10220000
IEBUPD18 DC    CL28'18HIGHEST CONDITION CODE WAS'                       10240000
IEBUPD19 DC    C'19END OF JOB IEBUPDTE.'                                10260000
IEBUPD20 DC    C'20CANNOT PROCESS MORE THAN ONE FUNCTION'      @ZA01692 10280002
         DC    C' STMT WHEN UPDATE INPLACE IS SPECIFIED.'      @ZA01692 10300002
IEBUPD21 DC    CL32'21 INVALID EXIT NAME. JOB ENDED.'                   10320000
IEBUPD22 DC    C'22EXIT RETURN CODE ENDED JOB.'                         10340000
IEBUPD23 DC    CL26'23         HAS NO RECORDS.'                         10360000
IEBUPD25 DC    C'25ALIAS IGNORED- SEQUENTIAL DATA'                      10400000
         DC    C' SET.'                                                 10420000
IEBUPD26 DC    C'26MEMBER NAME FOUND IN OM '                            10440000
         DC    C'DIRECTORY AS AN ALIAS- CHANGED '                       10460000
         DC    C'TO TRUE NAME IN NM DIRECTORY.'                         10480000
IEBUPD27 DC    CL26'27INVALID INPUT PARAMETER.'                         10500000
IEBUPD28 DC    CL32'28PAGE NUMBER PARAMETER INVALID.'                   10520000
IEBUPD29 DC    CL32'29DDNAME PARAMETER IS INVALID.  '                   10540000
IEBUPD30 DC    C'30OLD AND NEW MASTER LRECL '                           10560000
         DC    C'UNEQUAL.'                                              10580000
IEBUPD31 DC    C'31 OLD AND NEW MASTER DSORGS INCOMPATIBLE'        3341 10590016
IEBUPD32 DC    CL31'32          IS PROCESSING USER '               UL0H 10590217
         DC    CL23' '                                             UL0H 10590617
IEBUPD33 DC    CL26'33  ENTRANCES TO         .'                    UL0H 10591017
IEBUPD34 DC    CL32'34LAST RETURN CODE FROM         '              UL0H 10591417
         DC    CL9' WAS    .'                                      UL0H 10591817
IEBUPD35 DC    CL42'35           SUPPORT ONLY ON PS DATA SETS.'    UL0H 10592217
IEBUPD36 DC    CL44'36TRAILER LABEL PROCESSING NOT SUPPORTED FOR'  UL0H 10592617
         DC    CL15' UPDATE=INPLACE'                             A34086 10593120
IEBUPD37 DC    CL41'37I/O ERROR WHILE PROCESSING USER LABELS.'     UL0H 10593717
IEBUPD38 DC    CL40'38  LABELS CREATED FROM INPUT STREAM.'         UL0H 10594117
IEBUPD39 DC    CL36'39         IS TAKING TOTALING EXITS.'          UL0H 10594517
IEBUPD40 DC    CL44'40         REQUESTED TERMINATION OF TOTALING'  UL0H 10594917
         DC    CL31' EXITS WITH RETURN CODE OF    .'               OOOH 10595318
IEBUPD41 DC    CL37'41INVALID RETURN CODE FROM         ,'          UL0H 10595717
         DC    CL28'TOTALING EXITS DISCONTINUED.'                  UL0H 10596117
IEBUPD42 DC    CL34'42TOTALING EXITS NOT SUPPORTED FOR'            UL0H 10596517
         DC    CL24' UPDATE=INPLACE.'                              ULOH 10596918
IEBUPD43 DC    CL20'43INVALID CORE SIZE.'                          UL0H 10597317
IEBUPD44 DC    CL25'44NO USER         LABELS '                     UL0H 10597717
         DC    CL24'EXIST ON INPUT DATA SET.'                      UL0H 10598117
IEBUPD45 DC    CL25'45NO USER         LABELS '                     UL0H 10598517
         DC    CL27'CREATED ON OUTPUT DATA SET.'                   UL0H 10598917
IEBUPD46 DC    CL34'46ALIAS IGNORED FOR UPDATE=INPLACE'            UL0H 10599417
IEBLASTM EQU   *                       KEEP EQUATE AFTER LAST MESSAGE   10600000
         EJECT                                                          10620000
*  TABLE OF SIZES OF MESSAGES                                         * 10640000
*      SIZE IS EQUAL TO TOTAL MESSAGE SIZE - 2 BYTES FOR THE INITIAL  * 10660000
*  MESSAGE NUMBER CODE - 1 BYTE SO COUNT WILL BE CORRECT FOR EXECUTE  * 10680000
*  WHICH MOVES THE MESSAGE TO THE PRINT BUFFER IN 'MSGWRTE' ROUTINE.  * 10700000
         SPACE 1                                                        10720000
MSG01SIZ EQU   IEBUPD02-IEBUPD01-3    SIZE OF MESSAGE 1          A27716 10730019
MSG02SIZ EQU   IEBUPD03-IEBUPD02-3    SIZE OF MESSAGE 2          A27716 10740019
MSG03SIZ EQU   IEBUPD04-IEBUPD03-3    SIZE OF MESSAGE 3          A27716 10750019
MSG04SIZ EQU   IEBUPD05-IEBUPD04-3    SIZE OF MESSAGE 4          A27716 10760019
MSG05SIZ EQU   IEBUPD06-IEBUPD05-3     SIZE OF MESSAGE 5                10780000
MSG06SIZ EQU   IEBUPD07-IEBUPD06-3     SIZE OF MESSAGE 6                10800000
MSG07SIZ EQU   IEBUPD08-IEBUPD07-3     SIZE OF MESSAGE 7                10820000
MSG08SIZ EQU   IEBUPD09-IEBUPD08-3     SIZE OF MESSAGE 8                10840000
MSG09SIZ EQU   IEBUPD10-IEBUPD09-3     SIZE OF MESSAGE 9                10860000
MSG10SIZ EQU   IEBUPD11-IEBUPD10-3     SIZE OF MESSAGE 10               10880000
MSG11SIZ EQU   IEBUPD12-IEBUPD11-3     SIZE OF MESSAGE 11               10900000
MSG12SIZ EQU   IEBUPD13-IEBUPD12-3     SIZE OF MESSAGE 12               10920000
MSG13SIZ EQU   IEBUPD14-IEBUPD13-3     SIZE OF MESSAGE 13               10940000
MSG14SIZ EQU   IEBUPD15-IEBUPD14-3     SIZE OF MESSAGE 14               10960000
MSG15SIZ EQU   IEBUPD16-IEBUPD15-3     SIZE OF MESSAGE 15               10980000
MSG16SIZ EQU   IEBUPD17-IEBUPD16-3     SIZE OF MESSAGE 16               11000000
MSG17SIZ EQU   IEBUPD18-IEBUPD17-3     SIZE OF MESSAGE 17               11020000
MSG18SIZ EQU   IEBUPD19-IEBUPD18-3     SIZE OF MESSAGE 18               11040000
MSG19SIZ EQU   IEBUPD20-IEBUPD19-3     SIZE OF MESSAGE 19               11060000
MSG20SIZ EQU   IEBUPD21-IEBUPD20-3     SIZE OF MESSAGE 20               11080000
MSG21SIZ EQU   IEBUPD22-IEBUPD21-3     SIZE OF MESSAGE 21               11100000
MSG22SIZ EQU   IEBUPD23-IEBUPD22-3     SIZE OF MESSAGE 22               11120000
MSG23SIZ EQU   IEBUPD25-IEBUPD23-3     SIZE OF MESSAGE 23          BS0H 11150017
MSG25SIZ EQU   IEBUPD26-IEBUPD25-3     SIZE OF MESSAGE 25               11180000
MSG26SIZ EQU   IEBUPD27-IEBUPD26-3     SIZE OF MESSAGE 26               11200000
MSG27SIZ EQU   IEBUPD28-IEBUPD27-3     SIZE OF MESSAGE 27               11220000
MSG28SIZ EQU   IEBUPD29-IEBUPD28-3     SIZE OF MESSAGE 28               11240000
MSG29SIZ EQU   IEBUPD30-IEBUPD29-3     SIZE OF MESSAGE 29               11260000
MSG30SIZ EQU   IEBUPD31-IEBUPD30-3      SIZE OF MESSAGE 30         3341 11270016
MSG31SIZ EQU   IEBUPD32-IEBUPD31-3                                 UL0H 11271017
MSG32SIZ EQU   IEBUPD33-IEBUPD32-3                                 UL0H 11272017
MSG33SIZ EQU   IEBUPD34-IEBUPD33-3                                 UL0H 11273017
MSG34SIZ EQU   IEBUPD35-IEBUPD34-3                                 UL0H 11274017
MSG35SIZ EQU   IEBUPD36-IEBUPD35-3                                 UL0H 11275017
MSG36SIZ EQU   IEBUPD37-IEBUPD36-3                                 UL0H 11276017
MSG37SIZ EQU   IEBUPD38-IEBUPD37-3                                 UL0H 11277017
MSG38SIZ EQU   IEBUPD39-IEBUPD38-3                                 UL0H 11278017
MSG39SIZ EQU   IEBUPD40-IEBUPD39-3                                 UL0H 11279017
MSG40SIZ EQU   IEBUPD41-IEBUPD40-3                                 UL0H 11280017
MSG41SIZ EQU   IEBUPD42-IEBUPD41-3                                 UL0H 11281017
MSG42SIZ EQU   IEBUPD43-IEBUPD42-3                                 UL0H 11282017
MSG43SIZ EQU   IEBUPD44-IEBUPD43-3                                 UL0H 11283017
MSG44SIZ EQU   IEBUPD45-IEBUPD44-3                                 UL0H 11284017
MSG45SIZ EQU   IEBUPD46-IEBUPD45-3                                 UL0H 11289017
MSG46SIZ EQU   IEBLASTM-IEBUPD46-3                                 UL0H 11294017
         SPACE 3                                                        11300000
MSG16ASZ EQU   IEBUP16A-IEBUPD16-3     SPECIAL BLDL/FIND ERROR MESSAGE  11320000
MSG17ASZ EQU   IEBUP17A-IEBUPD17-3     SPECIAL BLDL/FIND ERROR MESSAGE  11340000
         EJECT                                                          11360000
*  SYSPRINT DCB    WRITES THE LOG                                       11380000
DCBLOGR  DCB   DSORG=PS,MACRF=(PM),DDNAME=SYSPRINT,RECFM=FBA,      BS0H*11400017
               LRECL=121,EXLST=DCBLST,SYNAD=SPSYNAD              A27716 11420019
         EJECT                                                          11440000
         IEBUPCON                                                       11460000
         EJECT                                                          11480000
         DCBD  DSORG=PS                                                 11500000
BDDNAM   EQU   DCBDDNAM-IHADCB         DD NAME IN DCB 'BEFORE' OPEN     11520000
BOFLGS   EQU   DCBOFLGS-IHADCB         OPEN ERROR FIELD IN DCB          11540000
         END   IEBUPLOG                                                 11560000
