         TITLE '**********  ICKAA01:  ASSSIGN ALTERNATE TRACK  *********00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
ICKAA01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'ICKAA01   78.192'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  DS    0H                                                  0002 00022000
         USING @PSTART,@12                                         0002 00023000
         L     @00,@SIZDATD                                        0002 00024000
         GETMAIN  R,LV=(0)                                              00025000
         LR    @11,@01                                             0002 00026000
         USING @DATD,@11                                           0002 00027000
         ST    @13,@SA00001+4                                      0002 00028000
         LM    @00,@01,20(@13)                                     0002 00029000
         ST    @11,8(,@13)                                         0002 00030000
         LR    @13,@11                                             0002 00031000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00032000
         MVC   @PC00001(32),0(@01)                                 0002 00033000
*                                                                  0176 00034000
         EJECT                                                          00035000
*/*****  B E G I N    E X E C U T I O N  *****************************/ 00036000
*                                                                  0177 00037000
*    IF GDTDBG = NULLPTR                                           0177 00038000
*      THEN;                                                       0177 00039000
         L     @10,@PC00001                                        0177 00040000
         L     @10,GDTDBG(,@10)                                    0177 00041000
         LTR   @10,@10                                             0177 00042000
         BZ    @RT00177                                            0177 00043000
*      ELSE                                                        0179 00044000
*        CALL ICKDB010 (GDTTBL, 'AA00');                           0179 00045000
*                                                                  0179 00046000
         L     @10,@PC00001                                        0179 00047000
         ST    @10,@AL00001                                        0179 00048000
         LA    @15,@CC00539                                        0179 00049000
         ST    @15,@AL00001+4                                      0179 00050000
         MVI   @AL00001+4,X'80'                                    0179 00051000
         L     @15,GDTDBG(,@10)                                    0179 00052000
         LA    @01,@AL00001                                        0179 00053000
         BALR  @14,@15                                             0179 00054000
*/*  OBTAIN THE ADDRESSES OF THE LAST PRIMARY AND ALTERNATE          */ 00055000
*/*   TRACKS AND ALSO THE NUMBER OF TRACKS PER CYLINDER              */ 00056000
*    DO I = 1 TO INFOSET;                                          0180 00057000
@RT00177 LA    I,1                                                 0180 00058000
@DL00180 DS    0H                                                  0181 00059000
*      CALL ICKDVIN0 (GDTTBL                                       0181 00060000
*               ,VOLIB                                             0181 00061000
*               ,INFOVECT (I)                                      0181 00062000
*               ,POOLID                                            0181 00063000
*               ,INFOPTR (I)                                       0181 00064000
*               ,INFOLEN (I)                                       0181 00065000
*               ,RETCODE);                                         0181 00066000
         L     @10,@PC00001                                        0181 00067000
         ST    @10,@AL00001                                        0181 00068000
         L     @03,@PC00001+4                                      0181 00069000
         ST    @03,@AL00001+4                                      0181 00070000
         LR    @03,I                                               0181 00071000
         SLA   @03,2                                               0181 00072000
         LA    @03,INFOVECT-4(@03)                                 0181 00073000
         ST    @03,@AL00001+8                                      0181 00074000
         LA    @03,POOLID                                          0181 00075000
         ST    @03,@AL00001+12                                     0181 00076000
         LR    @03,I                                               0181 00077000
         SLA   @03,3                                               0181 00078000
         LA    @15,INFOPTR-8(@03)                                  0181 00079000
         ST    @15,@AL00001+16                                     0181 00080000
         LA    @03,INFOLEN-8(@03)                                  0181 00081000
         ST    @03,@AL00001+20                                     0181 00082000
         LA    @03,RETCODE                                         0181 00083000
         ST    @03,@AL00001+24                                     0181 00084000
         L     @15,GDTDIN(,@10)                                    0181 00085000
         LA    @01,@AL00001                                        0181 00086000
         BALR  @14,@15                                             0181 00087000
*    END;                                                          0182 00088000
         AH    I,@CH00171                                          0182 00089000
         CH    I,@CH00142                                          0182 00090000
         BNH   @DL00180                                            0182 00091000
*/*  INDICATE INITIALLY THAT ASSIGNMENT IS NOT COMPLETE              */ 00092000
*    ASSGNCOM = NOTCOMP;                                           0183 00093000
         NI    ASSGNCOM,B'01111111'                                0183 00094000
*/*  DO-WHILE ASSIGNMENT IS NOT COMPLETE                             */ 00095000
*    DO WHILE ASSGNCOM = NOTCOMP;                                  0184 00096000
         B     @DE00184                                            0184 00097000
@DL00184 DS    0H                                                  0185 00098000
*/*    INITIALIZE THE UNRECOVERABLE TRACK ADDRESS TO ZERO            */ 00099000
*      UNTRADDR = 0;                                               0185 00100000
         SLR   @10,@10                                             0185 00101000
         L     @15,@PC00001+24                                     0185 00102000
         ST    @10,UNTRADDR(,@15)                                  0185 00103000
*/*    SET CONDITION CODE INITIALLY TO INDICATE SUCCESSFUL COMPLETION*/ 00104000
*      CONDCODE = SUCCEEDS;                                        0186 00105000
         L     @15,@PC00001+28                                     0186 00106000
         ST    @10,CONDCODE(,@15)                                  0186 00107000
*/*    INDICATE INITIALLY THAT THE ALTERNATE FLAG IS SET ON          */ 00108000
*      TRACKTYP = ALTTRACK;                                        0187 00109000
         OI    TRACKTYP,B'10000000'                                0187 00110000
*/*    INDICATE INITIALLY THAT AN ASSIGNABLE ALTERNATE NOT FOUND     */ 00111000
*      ASSGNFLG = NOASSIGN;                                        0188 00112000
         NI    ASSGNFLG,B'01111111'                                0188 00113000
*/*    IF THERE ARE NO AVAILABLE ALTERNATE TRACKS (ALTCOUNT)         */ 00114000
*      IF ALTCOUNT = 0                                             0189 00115000
*/*      THEN INDICATE NO AVAILABLE ALTERNATE TRACKS LEFT            */ 00116000
*        THEN DO;    CONDCODE = NOALTS;  END;                      0189 00117000
         L     @14,@PC00001+12                                     0189 00118000
         C     @10,ALTCOUNT(,@14)                                  0189 00119000
         BNE   @RF00189                                            0189 00120000
         MVC   CONDCODE(4,@15),@CF00171                            0191 00121000
*/*    IF NO ERRORS FOUND (CONDCODE = 0)                             */ 00122000
*      IF CONDCODE = SUCCEEDS                                      0193 00123000
*/*      THEN                                                        */ 00124000
*        THEN DO;                                                  0193 00125000
*                                                                  0193 00126000
@RF00189 L     @10,@PC00001+28                                     0193 00127000
         L     @10,CONDCODE(,@10)                                  0193 00128000
         LTR   @10,@10                                             0193 00129000
         BNZ   @RF00193                                            0193 00130000
*/*        DO-WHILE LAST ALTERNATE TRACK NOT CHECKED                 */ 00131000
*          DO WHILE  ALTPTR <= LASTALT;                            0195 00132000
*                                                                  0195 00133000
         B     @DE00195                                            0195 00134000
@DL00195 DS    0H                                                  0196 00135000
*/*          READ HOME-ADDRESS (OF THE ALT TRACK TO OBTAIN           */ 00136000
*/*           DEFECT-FLAG) (UDEVOP)                                  */ 00137000
*            CALL ICKDVOP0 (GDTTBL                                 0196 00138000
*                   ,VOLIB                                         0196 00139000
*                   ,ACTRDHA                                       0196 00140000
*                   ,ALTPTR                                        0196 00141000
*                   ,RECNUM                                        0196 00142000
*                   ,POOLID                                        0196 00143000
*                   ,HAPTR                                         0196 00144000
*                   ,HALEN                                         0196 00145000
*                   ,RETCODE);                                     0196 00146000
         L     @10,@PC00001                                        0196 00147000
         ST    @10,@AL00001                                        0196 00148000
         L     @15,@PC00001+4                                      0196 00149000
         ST    @15,@AL00001+4                                      0196 00150000
         LA    @15,@CF00171                                        0196 00151000
         ST    @15,@AL00001+8                                      0196 00152000
         L     @15,@PC00001+16                                     0196 00153000
         ST    @15,@AL00001+12                                     0196 00154000
         LA    @15,RECNUM                                          0196 00155000
         ST    @15,@AL00001+16                                     0196 00156000
         LA    @15,POOLID                                          0196 00157000
         ST    @15,@AL00001+20                                     0196 00158000
         LA    @15,HAPTR                                           0196 00159000
         ST    @15,@AL00001+24                                     0196 00160000
         LA    @15,HALEN                                           0196 00161000
         ST    @15,@AL00001+28                                     0196 00162000
         LA    @15,RETCODE                                         0196 00163000
         ST    @15,@AL00001+32                                     0196 00164000
         L     @15,GDTDOP(,@10)                                    0196 00165000
         LA    @01,@AL00001                                        0196 00166000
         BALR  @14,@15                                             0196 00167000
*/*          IF THE READ OPERATION WAS UNSUCCESSFUL                  */ 00168000
*            IF RETCODE = CPFAILS                                  0197 00169000
*/*            THEN                                                  */ 00170000
*              THEN DO;                                            0197 00171000
*                                                                  0197 00172000
         LA    @10,4                                               0197 00173000
         C     @10,RETCODE                                         0197 00174000
         BNE   @RF00197                                            0197 00175000
*/*              SET FLAG TO INDICATE TRACK CANNOT BE ASSIGNED       */ 00176000
*                ASSGNFLG = NOASSIGN;                              0199 00177000
         NI    ASSGNFLG,B'01111111'                                0199 00178000
*/*              SET ADDRESS OF THE UNRECOVERABLE TRACK              */ 00179000
*                UNTRADDR = ALTPTR;                                0200 00180000
         L     @15,@PC00001+24                                     0200 00181000
         L     @14,@PC00001+16                                     0200 00182000
         MVC   UNTRADDR(4,@15),ALTPTR(@14)                         0200 00183000
*/*              INDICATE THAT AN UNRECOVERABLE TRACK WAS FOUND      */ 00184000
*                CONDCODE = UNTRFND;                               0201 00185000
         L     @15,@PC00001+28                                     0201 00186000
         ST    @10,CONDCODE(,@15)                                  0201 00187000
*/*              SET POINTER TO NEXT AVAILABLE ALTERNATE TRACK       */ 00188000
*/*               (ALTPTR)                                           */ 00189000
*                IF ALTPTRT = TRKSPCYL - 1                         0202 00190000
*                  THEN DO;                                        0202 00191000
*                                                                  0202 00192000
         L     @10,INFOPTR+8                                       0202 00193000
         L     @10,TRKSPCYL(,@10)                                  0202 00194000
         BCTR  @10,0                                               0202 00195000
         MVC   @ZT00002+2(2),ALTPTRT(@14)                          0202 00196000
         C     @10,@ZT00002                                        0202 00197000
         BNE   @RF00202                                            0202 00198000
*                    ALTPTRC = ALTPTRC + 1;                        0204 00199000
         LA    @10,1                                               0204 00200000
         MVC   @ZT00002+2(2),ALTPTRC(@14)                          0204 00201000
         AL    @10,@ZT00002                                        0204 00202000
         STH   @10,ALTPTRC(,@14)                                   0204 00203000
*                    ALTPTRT = 0;                                  0205 00204000
         SLR   @10,@10                                             0205 00205000
         STH   @10,ALTPTRT(,@14)                                   0205 00206000
*                    END;                                          0206 00207000
*                  ELSE DO;    ALTPTRT = ALTPTRT + 1; END;         0207 00208000
         B     @RC00202                                            0207 00209000
@RF00202 DS    0H                                                  0208 00210000
         L     @10,@PC00001+16                                     0208 00211000
         LA    @15,1                                               0208 00212000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0208 00213000
         AL    @15,@ZT00002                                        0208 00214000
         STH   @15,ALTPTRT(,@10)                                   0208 00215000
*/*              LEAVE                                               */ 00216000
*                GOTO ENDLOOP;                                     0210 00217000
         B     ENDLOOP                                             0210 00218000
*/*              END-THEN                                            */ 00219000
*                END;                                              0211 00220000
*/*            ELSE (UNRECOVERABLE TRACK NOT FOUND)                  */ 00221000
*              ELSE DO;                                            0212 00222000
@RF00197 DS    0H                                                  0213 00223000
*/*              IF ALTERNATE TRACK IS FLAGGED DEFECTIVE             */ 00224000
*                IF RETCODE = DFLAGONA | RETCODE = DFLAGONP        0213 00225000
*/*                THEN                                              */ 00226000
*                  THEN DO;                                        0213 00227000
*                                                                  0213 00228000
         L     @10,RETCODE                                         0213 00229000
         CH    @10,@CH00125                                        0213 00230000
         BE    @RT00213                                            0213 00231000
         CH    @10,@CH00122                                        0213 00232000
         BNE   @RF00213                                            0213 00233000
@RT00213 DS    0H                                                  0214 00234000
*/*                  SET FLAG TO INDICATE TRACK CANNOT BE ASSIGNED   */ 00235000
*                    ASSGNFLG = NOASSIGN;                          0215 00236000
         NI    ASSGNFLG,B'01111111'                                0215 00237000
*/*                  SET POINTER TO NEXT AVAILABLE ALTERNATE TRACK   */ 00238000
*/*                   (ALTPTR)                                       */ 00239000
*                    IF ALTPTRT = TRKSPCYL - 1                     0216 00240000
*                      THEN DO;                                    0216 00241000
*                                                                  0216 00242000
         L     @10,@PC00001+16                                     0216 00243000
         L     @01,INFOPTR+8                                       0216 00244000
         L     @15,TRKSPCYL(,@01)                                  0216 00245000
         BCTR  @15,0                                               0216 00246000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0216 00247000
         C     @15,@ZT00002                                        0216 00248000
         BNE   @RF00216                                            0216 00249000
*                        ALTPTRC = ALTPTRC + 1;                    0218 00250000
         LA    @15,1                                               0218 00251000
         MVC   @ZT00002+2(2),ALTPTRC(@10)                          0218 00252000
         AL    @15,@ZT00002                                        0218 00253000
         STH   @15,ALTPTRC(,@10)                                   0218 00254000
*                        ALTPTRT = 0;                              0219 00255000
         SLR   @15,@15                                             0219 00256000
         STH   @15,ALTPTRT(,@10)                                   0219 00257000
*                        END;                                      0220 00258000
*                      ELSE DO;    ALTPTRT = ALTPTRT + 1; END;     0221 00259000
         B     @RC00216                                            0221 00260000
@RF00216 DS    0H                                                  0222 00261000
         L     @10,@PC00001+16                                     0222 00262000
         LA    @15,1                                               0222 00263000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0222 00264000
         AL    @15,@ZT00002                                        0222 00265000
         STH   @15,ALTPTRT(,@10)                                   0222 00266000
*/*                  END-THEN                                        */ 00267000
*                    END;                                          0224 00268000
*/*                ELSE (ALTERNATE TRACK IS NOT FLAGGED DEFECTIVE)   */ 00269000
*                  ELSE DO;                                        0225 00270000
*                                                                  0225 00271000
         B     @RC00213                                            0225 00272000
@RF00213 DS    0H                                                  0226 00273000
*/*                  IF THE ALTERNATE FLAG IS NOT TURNED ON          */ 00274000
*                    IF RETCODE = DFLAGOFP                         0226 00275000
*/*                    THEN SAVE THIS INFORMATION                    */ 00276000
*                      THEN DO;    TRACKTYP = PRITRACK; END;       0226 00277000
         CLC   RETCODE(4),@CF00142                                 0226 00278000
         BNE   @RF00226                                            0226 00279000
         NI    TRACKTYP,B'01111111'                                0228 00280000
*/*                    ELSE INDICATE THE ALTERNATE FLAG IS SET ON    */ 00281000
*                      ELSE DO;    TRACKTYP = ALTTRACK; END;       0230 00282000
         B     @RC00226                                            0230 00283000
@RF00226 DS    0H                                                  0231 00284000
         OI    TRACKTYP,B'10000000'                                0231 00285000
*/*                  READ RECORD-ZERO (OF THE ALTERNATE TRACK TO     */ 00286000
*/*                   CHECK THAT IS IS NOT ASSIGNED TO A             */ 00287000
*/*                   PRIMARY TRACK)                                 */ 00288000
*                    CALL ICKDVOP0 (GDTTBL                         0233 00289000
*                           ,VOLIB                                 0233 00290000
*                           ,ACTRDRZ                               0233 00291000
*                           ,ALTPTR                                0233 00292000
*                           ,RECNUM                                0233 00293000
*                           ,POOLID                                0233 00294000
*                           ,RZPTR                                 0233 00295000
*                           ,RZLEN                                 0233 00296000
*                           ,RETCODE);                             0233 00297000
@RC00226 L     @10,@PC00001                                        0233 00298000
         ST    @10,@AL00001                                        0233 00299000
         L     @15,@PC00001+4                                      0233 00300000
         ST    @15,@AL00001+4                                      0233 00301000
         LA    @15,@CF00122                                        0233 00302000
         ST    @15,@AL00001+8                                      0233 00303000
         L     @15,@PC00001+16                                     0233 00304000
         ST    @15,@AL00001+12                                     0233 00305000
         LA    @15,RECNUM                                          0233 00306000
         ST    @15,@AL00001+16                                     0233 00307000
         LA    @15,POOLID                                          0233 00308000
         ST    @15,@AL00001+20                                     0233 00309000
         LA    @15,RZPTR                                           0233 00310000
         ST    @15,@AL00001+24                                     0233 00311000
         LA    @15,RZLEN                                           0233 00312000
         ST    @15,@AL00001+28                                     0233 00313000
         LA    @15,RETCODE                                         0233 00314000
         ST    @15,@AL00001+32                                     0233 00315000
         L     @15,GDTDOP(,@10)                                    0233 00316000
         LA    @01,@AL00001                                        0233 00317000
         BALR  @14,@15                                             0233 00318000
*/*                  IF THE READ OPERATION WAS UNSUCCESSFUL          */ 00319000
*                    IF RETCODE = CPFAILS                          0234 00320000
*/*                    THEN                                          */ 00321000
*                      THEN DO;                                    0234 00322000
*                                                                  0234 00323000
         LA    @10,4                                               0234 00324000
         C     @10,RETCODE                                         0234 00325000
         BNE   @RF00234                                            0234 00326000
*/*                      SET FLAG TO INDICATE TRK CANNOT BE ASSIGNED */ 00327000
*                        ASSGNFLG = NOASSIGN;                      0236 00328000
         NI    ASSGNFLG,B'01111111'                                0236 00329000
*/*                      SET ADDRESS OF THE UNRECOVERABLE TRACK      */ 00330000
*                        UNTRADDR = ALTPTR;                        0237 00331000
         L     @15,@PC00001+24                                     0237 00332000
         L     @14,@PC00001+16                                     0237 00333000
         MVC   UNTRADDR(4,@15),ALTPTR(@14)                         0237 00334000
*/*                      INDICATE THAT AN UNRECOVERABLE TRK WAS FOUND*/ 00335000
*                        CONDCODE = UNTRFND;                       0238 00336000
         L     @15,@PC00001+28                                     0238 00337000
         ST    @10,CONDCODE(,@15)                                  0238 00338000
*/*                      SET POINTER TO NEXT AVAILABLE ALTERNATE TRK */ 00339000
*                        IF ALTPTRT = TRKSPCYL - 1                 0239 00340000
*                          THEN DO;                                0239 00341000
*                                                                  0239 00342000
         L     @10,INFOPTR+8                                       0239 00343000
         L     @10,TRKSPCYL(,@10)                                  0239 00344000
         BCTR  @10,0                                               0239 00345000
         MVC   @ZT00002+2(2),ALTPTRT(@14)                          0239 00346000
         C     @10,@ZT00002                                        0239 00347000
         BNE   @RF00239                                            0239 00348000
*                            ALTPTRC = ALTPTRC + 1;                0241 00349000
         LA    @10,1                                               0241 00350000
         MVC   @ZT00002+2(2),ALTPTRC(@14)                          0241 00351000
         AL    @10,@ZT00002                                        0241 00352000
         STH   @10,ALTPTRC(,@14)                                   0241 00353000
*                            ALTPTRT = 0;                          0242 00354000
         SLR   @10,@10                                             0242 00355000
         STH   @10,ALTPTRT(,@14)                                   0242 00356000
*                            END;                                  0243 00357000
*                          ELSE DO;    ALTPTRT = ALTPTRT + 1;      0244 00358000
         B     @RC00239                                            0244 00359000
@RF00239 DS    0H                                                  0245 00360000
         L     @10,@PC00001+16                                     0245 00361000
         LA    @15,1                                               0245 00362000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0245 00363000
         AL    @15,@ZT00002                                        0245 00364000
         STH   @15,ALTPTRT(,@10)                                   0245 00365000
*                            END;                                  0246 00366000
*/*                      LEAVE                                       */ 00367000
*                        GOTO ENDLOOP;                             0247 00368000
         B     ENDLOOP                                             0247 00369000
*/*                      END-THEN                                    */ 00370000
*                        END;                                      0248 00371000
*/*                    ELSE (RECOVERABLE TRACK FOUND)                */ 00372000
*                      ELSE DO;                                    0249 00373000
@RF00234 DS    0H                                                  0250 00374000
*/*                      IF ALTERNATE TRACK IS FLAGGED DEFECTIVE     */ 00375000
*                        IF RETCODE = DFLAGONA | RETCODE = DFLAGONP     00376000
*/*                        THEN                                      */ 00377000
*                          THEN DO;                                0250 00378000
*                                                                  0250 00379000
         L     @10,RETCODE                                         0250 00380000
         CH    @10,@CH00125                                        0250 00381000
         BE    @RT00250                                            0250 00382000
         CH    @10,@CH00122                                        0250 00383000
         BNE   @RF00250                                            0250 00384000
@RT00250 DS    0H                                                  0251 00385000
*/*                          SET FLAG TO INDICATE TRACK CANNOT BE    */ 00386000
*/*                           ASSIGNED                               */ 00387000
*                            ASSGNFLG = NOASSIGN;                  0252 00388000
         NI    ASSGNFLG,B'01111111'                                0252 00389000
*/*                          SET POINTER TO NEXT AVAILABLE ALTERNATE */ 00390000
*/*                           TRACK (ALTPTR)                         */ 00391000
*                            IF ALTPTRT = TRKSPCYL - 1             0253 00392000
*                              THEN DO;                            0253 00393000
*                                                                  0253 00394000
         L     @10,@PC00001+16                                     0253 00395000
         L     @01,INFOPTR+8                                       0253 00396000
         L     @15,TRKSPCYL(,@01)                                  0253 00397000
         BCTR  @15,0                                               0253 00398000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0253 00399000
         C     @15,@ZT00002                                        0253 00400000
         BNE   @RF00253                                            0253 00401000
*                                ALTPTRC = ALTPTRC + 1;            0255 00402000
         LA    @15,1                                               0255 00403000
         MVC   @ZT00002+2(2),ALTPTRC(@10)                          0255 00404000
         AL    @15,@ZT00002                                        0255 00405000
         STH   @15,ALTPTRC(,@10)                                   0255 00406000
*                                ALTPTRT = 0;                      0256 00407000
         SLR   @15,@15                                             0256 00408000
         STH   @15,ALTPTRT(,@10)                                   0256 00409000
*                                END;                              0257 00410000
*                              ELSE DO;                            0258 00411000
*                                                                  0258 00412000
         B     @RC00253                                            0258 00413000
@RF00253 DS    0H                                                  0259 00414000
*                                ALTPTRT = ALTPTRT + 1;            0259 00415000
         L     @10,@PC00001+16                                     0259 00416000
         LA    @15,1                                               0259 00417000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0259 00418000
         AL    @15,@ZT00002                                        0259 00419000
         STH   @15,ALTPTRT(,@10)                                   0259 00420000
*                                END;                              0260 00421000
*/*                          END-THEN                                */ 00422000
*                            END;                                  0261 00423000
*/*                        ELSE (TRACK NOT FLAGGED DEFECTIVE)        */ 00424000
*                          ELSE DO;                                0262 00425000
         B     @RC00250                                            0262 00426000
@RF00250 DS    0H                                                  0263 00427000
*/*                          IF THE ALTERNATE TRACK IS POINTING TO   */ 00428000
*/*                           PRIMARY TRACK                          */ 00429000
*                            IF RZCCHHC <= FINPRIC &               0263 00430000
*                             RZCCHHT <= FINPRIT & RZCCHH >= 0     0263 00431000
*/*                            THEN                                  */ 00432000
*                              THEN DO;                            0263 00433000
*                                                                  0263 00434000
         L     @10,RZPTR                                           0263 00435000
         L     @15,INFOPTR+16                                      0263 00436000
         CLC   RZCCHHC(2,@10),FINPRIC(@15)                         0263 00437000
         BH    @RF00263                                            0263 00438000
         CLC   RZCCHHT(2,@10),FINPRIT(@15)                         0263 00439000
         BH    @RF00263                                            0263 00440000
         CLC   RZCCHH(4,@10),@CF00100                              0263 00441000
         BL    @RF00263                                            0263 00442000
*/*                              READ RECORD-ZERO OF PRIMARY TRACK   */ 00443000
*                                CALL ICKDVOP0 (GDTTBL             0265 00444000
*                                       ,VOLIB                     0265 00445000
*                                       ,ACTRDRZ                   0265 00446000
*                                       ,RZCCHH                    0265 00447000
*                                       ,RECNUM                    0265 00448000
*                                       ,POOLID                    0265 00449000
*                                       ,RZAPTR                    0265 00450000
*                                       ,RZLEN                     0265 00451000
*                                       ,RETCODE);                 0265 00452000
         L     @15,@PC00001                                        0265 00453000
         ST    @15,@AL00001                                        0265 00454000
         L     @14,@PC00001+4                                      0265 00455000
         ST    @14,@AL00001+4                                      0265 00456000
         LA    @14,@CF00122                                        0265 00457000
         ST    @14,@AL00001+8                                      0265 00458000
         ST    @10,@AL00001+12                                     0265 00459000
         LA    @10,RECNUM                                          0265 00460000
         ST    @10,@AL00001+16                                     0265 00461000
         LA    @10,POOLID                                          0265 00462000
         ST    @10,@AL00001+20                                     0265 00463000
         LA    @10,RZAPTR                                          0265 00464000
         ST    @10,@AL00001+24                                     0265 00465000
         LA    @10,RZLEN                                           0265 00466000
         ST    @10,@AL00001+28                                     0265 00467000
         LA    @10,RETCODE                                         0265 00468000
         ST    @10,@AL00001+32                                     0265 00469000
         L     @15,GDTDOP(,@15)                                    0265 00470000
         LA    @01,@AL00001                                        0265 00471000
         BALR  @14,@15                                             0265 00472000
*/*                              READ HOME-ADDRESS OF PRIMARY TRACK  */ 00473000
*                                CALL ICKDVOP0 (GDTTBL             0266 00474000
*                                       ,VOLIB                     0266 00475000
*                                       ,ACTRDHA                   0266 00476000
*                                       ,RZCCHH                    0266 00477000
*                                       ,RECNUM                    0266 00478000
*                                       ,POOLID                    0266 00479000
*                                       ,HAPTR                     0266 00480000
*                                       ,HALEN                     0266 00481000
*                                       ,RETCODE1);                0266 00482000
         L     @10,@PC00001                                        0266 00483000
         ST    @10,@AL00001                                        0266 00484000
         L     @15,@PC00001+4                                      0266 00485000
         ST    @15,@AL00001+4                                      0266 00486000
         LA    @15,@CF00171                                        0266 00487000
         ST    @15,@AL00001+8                                      0266 00488000
         L     @01,RZPTR                                           0266 00489000
         ST    @01,@AL00001+12                                     0266 00490000
         LA    @15,RECNUM                                          0266 00491000
         ST    @15,@AL00001+16                                     0266 00492000
         LA    @15,POOLID                                          0266 00493000
         ST    @15,@AL00001+20                                     0266 00494000
         LA    @15,HAPTR                                           0266 00495000
         ST    @15,@AL00001+24                                     0266 00496000
         LA    @15,HALEN                                           0266 00497000
         ST    @15,@AL00001+28                                     0266 00498000
         LA    @15,RETCODE1                                        0266 00499000
         ST    @15,@AL00001+32                                     0266 00500000
         L     @15,GDTDOP(,@10)                                    0266 00501000
         LA    @01,@AL00001                                        0266 00502000
         BALR  @14,@15                                             0266 00503000
*/*                              IF THE READ FAILS                   */ 00504000
*                                IF RETCODE = CPFAILS |            0267 00505000
*                                 RETCODE1 = CPFAILS               0267 00506000
*/*                                THEN                              */ 00507000
*                                  THEN DO;                        0267 00508000
*                                                                  0267 00509000
         LA    @10,4                                               0267 00510000
         C     @10,RETCODE                                         0267 00511000
         BE    @RT00267                                            0267 00512000
         C     @10,RETCODE1                                        0267 00513000
         BNE   @RF00267                                            0267 00514000
@RT00267 DS    0H                                                  0268 00515000
*/*                                  MAKE TRACK UNASSIGNABLE         */ 00516000
*                                    ASSGNFLG = NOASSIGN;          0269 00517000
         NI    ASSGNFLG,B'01111111'                                0269 00518000
*/*                                  SAVE UNRECOVERABLE TRACK ADDRESS*/ 00519000
*                                    UNTRADDR = RZCCHH;            0270 00520000
         L     @10,@PC00001+24                                     0270 00521000
         L     @01,RZPTR                                           0270 00522000
         MVC   UNTRADDR(4,@10),RZCCHH(@01)                         0270 00523000
*/*                                  INDICATE UNRECOVERABLE TRK FOUND*/ 00524000
*                                    CONDCODE = UNTRFND;           0271 00525000
         L     @10,@PC00001+28                                     0271 00526000
         MVC   CONDCODE(4,@10),@CF00050                            0271 00527000
*/*                                  POINT TO NEXT AVAILABLE TRACK   */ 00528000
*                                    IF ALTPTRT = TRKSPCYL - 1     0272 00529000
*                                      THEN DO;                    0272 00530000
*                                                                  0272 00531000
         L     @10,@PC00001+16                                     0272 00532000
         L     @01,INFOPTR+8                                       0272 00533000
         L     @15,TRKSPCYL(,@01)                                  0272 00534000
         BCTR  @15,0                                               0272 00535000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0272 00536000
         C     @15,@ZT00002                                        0272 00537000
         BNE   @RF00272                                            0272 00538000
*                                        ALTPTRC = ALTPTRC + 1;    0274 00539000
         LA    @15,1                                               0274 00540000
         MVC   @ZT00002+2(2),ALTPTRC(@10)                          0274 00541000
         AL    @15,@ZT00002                                        0274 00542000
         STH   @15,ALTPTRC(,@10)                                   0274 00543000
*                                        ALTPTRT = 0;              0275 00544000
         SLR   @15,@15                                             0275 00545000
         STH   @15,ALTPTRT(,@10)                                   0275 00546000
*                                        END;                      0276 00547000
*                                      ELSE DO;                    0277 00548000
         B     @RC00272                                            0277 00549000
@RF00272 DS    0H                                                  0278 00550000
*                                        ALTPTR = ALTPTRT + 1;     0278 00551000
         L     @10,@PC00001+16                                     0278 00552000
         LA    @15,1                                               0278 00553000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0278 00554000
         AL    @15,@ZT00002                                        0278 00555000
         ST    @15,ALTPTR(,@10)                                    0278 00556000
*                                        END;                      0279 00557000
*/*                                  LEAVE                           */ 00558000
*                                    GOTO ENDLOOP;                 0280 00559000
         B     ENDLOOP                                             0280 00560000
*/*                                  END-THEN                        */ 00561000
*                                    END;                          0281 00562000
*/*                                ELSE (PRIMARY R0 AVAILABLE)       */ 00563000
*                                  ELSE DO;                        0282 00564000
@RF00267 DS    0H                                                  0283 00565000
*/*                                  IF PRIMARY POINTING TO ALTERNATE*/ 00566000
*/*                                   AND IS DEFECTIVE               */ 00567000
*                                    IF RZACCHH = ALTPTR &         0283 00568000
*                                     (RETCODE = DFLAGONP |        0283 00569000
*                                     RETCODE = DFLAGONA) |        0283 00570000
*                                     (RETCODE1 = DFLAGONP |       0283 00571000
*                                     RETCODE1 = DFLAGONA)         0283 00572000
*/*                                    THEN                          */ 00573000
*                                      THEN DO;                    0283 00574000
         L     @10,@PC00001+16                                     0283 00575000
         L     @01,RZAPTR                                          0283 00576000
         CLC   RZACCHH(4,@01),ALTPTR(@10)                          0283 00577000
         BNE   @GL00006                                            0283 00578000
         L     @10,RETCODE                                         0283 00579000
         CH    @10,@CH00122                                        0283 00580000
         BE    @RT00283                                            0283 00581000
         CH    @10,@CH00125                                        0283 00582000
         BE    @RT00283                                            0283 00583000
@GL00006 L     @10,RETCODE1                                        0283 00584000
         CH    @10,@CH00122                                        0283 00585000
         BE    @RT00283                                            0283 00586000
         CH    @10,@CH00125                                        0283 00587000
         BNE   @RF00283                                            0283 00588000
@RT00283 DS    0H                                                  0284 00589000
*/*                                      INDICATE TRACK NOT          */ 00590000
*/*                                       ASSIGNABLE                 */ 00591000
*                                        ASSGNFLG = NOASSIGN;      0285 00592000
         NI    ASSGNFLG,B'01111111'                                0285 00593000
*/*                                      SET POINTER TO NEXT         */ 00594000
*/*                                       AVAILABLE TRACK            */ 00595000
*                                        IF ALTPTRT = TRKSPCYL - 1 0286 00596000
*                                          THEN DO;                0286 00597000
*                                                                  0286 00598000
         L     @10,@PC00001+16                                     0286 00599000
         L     @01,INFOPTR+8                                       0286 00600000
         L     @15,TRKSPCYL(,@01)                                  0286 00601000
         BCTR  @15,0                                               0286 00602000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0286 00603000
         C     @15,@ZT00002                                        0286 00604000
         BNE   @RF00286                                            0286 00605000
*                                            ALTPTRC = ALTPTRC + 1;     00606000
         LA    @15,1                                               0288 00607000
         MVC   @ZT00002+2(2),ALTPTRC(@10)                          0288 00608000
         AL    @15,@ZT00002                                        0288 00609000
         STH   @15,ALTPTRC(,@10)                                   0288 00610000
*                                            ALTPTRT = 0;          0289 00611000
         SLR   @15,@15                                             0289 00612000
         STH   @15,ALTPTRT(,@10)                                   0289 00613000
*                                            END;                  0290 00614000
*                                          ELSE DO;                0291 00615000
*                                                                  0291 00616000
         B     @RC00286                                            0291 00617000
@RF00286 DS    0H                                                  0292 00618000
*                                            ALTPTRT = ALTPTRT + 1;     00619000
         L     @10,@PC00001+16                                     0292 00620000
         LA    @15,1                                               0292 00621000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0292 00622000
         AL    @15,@ZT00002                                        0292 00623000
         STH   @15,ALTPTRT(,@10)                                   0292 00624000
*                                            END;                  0293 00625000
*/*                                      END-THEN                    */ 00626000
*                                        END;                      0294 00627000
*/*                                    ELSE                          */ 00628000
*                                      ELSE DO;                    0295 00629000
         B     @RC00283                                            0295 00630000
@RF00283 DS    0H                                                  0296 00631000
*/*                                      INDICATE TRACK ASSIGNABLE   */ 00632000
*                                        ASSGNFLG = ASSIGN;        0296 00633000
         OI    ASSGNFLG,B'10000000'                                0296 00634000
*/*                                      LEAVE                       */ 00635000
*                                        GOTO ENDLOOP;             0297 00636000
         B     ENDLOOP                                             0297 00637000
*/*                                      END-ELSE                    */ 00638000
*                                        END;                      0298 00639000
*/*                                  END-ELSE (PRIMARY R0 AVAILABLE) */ 00640000
*                                    END;                          0299 00641000
@RC00283 DS    0H                                                  0300 00642000
*/*                              END-THEN                            */ 00643000
*                                END;                              0300 00644000
*/*                            ELSE (TRACK NOT ASSIGNED TO PRIMARY)  */ 00645000
*                              ELSE DO;                            0301 00646000
*                                                                  0301 00647000
         B     @RC00263                                            0301 00648000
@RF00263 DS    0H                                                  0302 00649000
*/*                              INDICATE TRACK ASSIGNABLE           */ 00650000
*                                ASSGNFLG = ASSIGN;                0302 00651000
         OI    ASSGNFLG,B'10000000'                                0302 00652000
*/*                              LEAVE                               */ 00653000
*                                GOTO ENDLOOP;                     0303 00654000
         B     ENDLOOP                                             0303 00655000
*/*                              END-ELSE                            */ 00656000
*                                END;                              0304 00657000
*/*                          END-ELSE (TRACK NOT FLAGGED DEFECTIVE)  */ 00658000
*                            END;                                  0305 00659000
@RC00263 DS    0H                                                  0306 00660000
*/*                      END-ELSE (TRACK WAS RECOVERABLE)            */ 00661000
*                        END;                                      0306 00662000
@RC00250 DS    0H                                                  0307 00663000
*/*                  END-ELSE                                        */ 00664000
*                    END;                                          0307 00665000
*/*              END-ELSE                                            */ 00666000
*                END;                                              0308 00667000
@RC00213 DS    0H                                                  0309 00668000
*/*        END-WHILE                                                 */ 00669000
*          END;                                                    0309 00670000
@DE00195 L     @10,@PC00001+16                                     0309 00671000
         L     @01,INFOPTR                                         0309 00672000
         CLC   ALTPTR(4,@10),LASTALT(@01)                          0309 00673000
         BNH   @DL00195                                            0309 00674000
*          ENDLOOP:                                                0310 00675000
*/*        IF NO ERRORS FOUND                                        */ 00676000
*          IF CONDCODE = SUCCEEDS                                  0310 00677000
*/*          THEN                                                    */ 00678000
*            THEN DO;                                              0310 00679000
ENDLOOP  L     @10,@PC00001+28                                     0310 00680000
         L     @15,CONDCODE(,@10)                                  0310 00681000
         LTR   @15,@15                                             0310 00682000
         BNZ   @RF00310                                            0310 00683000
*/*            IF AN ASSIGNABLE TRACK HAS NOT BEEN FOUND             */ 00684000
*              IF ASSGNFLG = NOASSIGN                              0312 00685000
*/*              THEN INDICATE THERE ARE NO AVAILABLE ALTERNATE TRKS */ 00686000
*                THEN DO;    CONDCODE = NOALTS; END;               0312 00687000
         TM    ASSGNFLG,B'10000000'                                0312 00688000
         BNZ   @RF00312                                            0312 00689000
         MVC   CONDCODE(4,@10),@CF00171                            0314 00690000
*/*              ELSE                                                */ 00691000
*                ELSE DO;                                          0316 00692000
*                                                                  0316 00693000
         B     @RC00312                                            0316 00694000
@RF00312 DS    0H                                                  0317 00695000
*/*                SAVE THE CURRENT TRACK ADDRESS                    */ 00696000
*                  CTRADDR = ALTPTR;                               0317 00697000
         L     @10,@PC00001+16                                     0317 00698000
         MVC   CTRADDR(4),ALTPTR(@10)                              0317 00699000
*/*                IF THE ALTERNATE TRACK FLAG IS NOT SET ON         */ 00700000
*                  IF TRACKTYP = PRITRACK                          0318 00701000
*/*                  THEN                                            */ 00702000
*                    THEN DO;                                      0318 00703000
*                                                                  0318 00704000
         TM    TRACKTYP,B'10000000'                                0318 00705000
         BNZ   @RF00318                                            0318 00706000
*/*                    WRITE ALTERNATE HOME-ADDRESS (UDEVOP)         */ 00707000
*                      CALL ICKDVOP0 (GDTTBL                       0320 00708000
*                             ,VOLIB                               0320 00709000
*                             ,ACTWAHA                             0320 00710000
*                             ,ALTPTR                              0320 00711000
*                             ,RECNUM                              0320 00712000
*                             ,POOLID                              0320 00713000
*                             ,HAPTR                               0320 00714000
*                             ,HALEN                               0320 00715000
*                             ,RETCODE);                           0320 00716000
         L     @15,@PC00001                                        0320 00717000
         ST    @15,@AL00001                                        0320 00718000
         L     @14,@PC00001+4                                      0320 00719000
         ST    @14,@AL00001+4                                      0320 00720000
         LA    @14,@CF00125                                        0320 00721000
         ST    @14,@AL00001+8                                      0320 00722000
         ST    @10,@AL00001+12                                     0320 00723000
         LA    @10,RECNUM                                          0320 00724000
         ST    @10,@AL00001+16                                     0320 00725000
         LA    @10,POOLID                                          0320 00726000
         ST    @10,@AL00001+20                                     0320 00727000
         LA    @10,HAPTR                                           0320 00728000
         ST    @10,@AL00001+24                                     0320 00729000
         LA    @10,HALEN                                           0320 00730000
         ST    @10,@AL00001+28                                     0320 00731000
         LA    @10,RETCODE                                         0320 00732000
         ST    @10,@AL00001+32                                     0320 00733000
         L     @15,GDTDOP(,@15)                                    0320 00734000
         LA    @01,@AL00001                                        0320 00735000
         BALR  @14,@15                                             0320 00736000
*/*                    IF WRITE OPERATION FAILS                      */ 00737000
*                      IF RETCODE = CPFAILS                        0321 00738000
*/*                      THEN                                        */ 00739000
*                        THEN DO;                                  0321 00740000
*                                                                  0321 00741000
         CLC   RETCODE(4),@CF00050                                 0321 00742000
         BNE   @RF00321                                            0321 00743000
*/*                        INDICATE FAILURE                          */ 00744000
*                          CONDCODE = NOAASSOC;                    0323 00745000
         L     @10,@PC00001+28                                     0323 00746000
         MVC   CONDCODE(4,@10),@CF00142                            0323 00747000
*/*                        SAVE THE TRACK ADDRESS                    */ 00748000
*                          UNTRADDR = ALTPTR;                      0324 00749000
         L     @10,@PC00001+24                                     0324 00750000
         L     @15,@PC00001+16                                     0324 00751000
         MVC   UNTRADDR(4,@10),ALTPTR(@15)                         0324 00752000
*/*                        END-THEN                                  */ 00753000
*                          END;                                    0325 00754000
*/*                    END-THEN                                      */ 00755000
*                      END;                                        0326 00756000
@RF00321 DS    0H                                                  0327 00757000
*/*                END-ELSE                                          */ 00758000
*                  END;                                            0327 00759000
@RF00318 DS    0H                                                  0328 00760000
*/*            END-THEN                                              */ 00761000
*              END;                                                0328 00762000
@RC00312 DS    0H                                                  0329 00763000
*/*        END-THEN                                                  */ 00764000
*          END;                                                    0329 00765000
@RF00310 DS    0H                                                  0330 00766000
*/*    IF NO ERRORS FOUND (CONDCODE = 0)                             */ 00767000
*      IF CONDCODE = SUCCEEDS                                      0330 00768000
*/*      THEN                                                        */ 00769000
*        THEN DO;                                                  0330 00770000
*                                                                  0330 00771000
@RF00193 L     @10,@PC00001+28                                     0330 00772000
         L     @10,CONDCODE(,@10)                                  0330 00773000
         LTR   @10,@10                                             0330 00774000
         BNZ   @RF00330                                            0330 00775000
*/*        WRITE STANDARD-LENGTH RECORD-ZERO (ON THE PRIMARY TRACK   */ 00776000
*/*         ASSOCIATING IT WITH THE ALTERNATE TRACK) (UDEVOP)        */ 00777000
*          CALL ICKDVOP0 (GDTTBL                                   0332 00778000
*                 ,VOLIB                                           0332 00779000
*                 ,ACTWRZSL                                        0332 00780000
*                 ,PRCCHH                                          0332 00781000
*                 ,RECNUM                                          0332 00782000
*                 ,POOLID                                          0332 00783000
*                 ,ADDR (ALTPTR)                                   0332 00784000
*                 ,LENGTH (ALTPTR)                                 0332 00785000
*                 ,RETCODE);                                       0332 00786000
         L     @10,@PC00001                                        0332 00787000
         ST    @10,@AL00001                                        0332 00788000
         L     @15,@PC00001+4                                      0332 00789000
         ST    @15,@AL00001+4                                      0332 00790000
         LA    @15,@CF00282                                        0332 00791000
         ST    @15,@AL00001+8                                      0332 00792000
         L     @15,@PC00001+8                                      0332 00793000
         ST    @15,@AL00001+12                                     0332 00794000
         LA    @15,RECNUM                                          0332 00795000
         ST    @15,@AL00001+16                                     0332 00796000
         LA    @15,POOLID                                          0332 00797000
         ST    @15,@AL00001+20                                     0332 00798000
         L     @15,@PC00001+16                                     0332 00799000
         ST    @15,@AFTEMPS                                        0332 00800000
         LA    @15,@AFTEMPS                                        0332 00801000
         ST    @15,@AL00001+24                                     0332 00802000
         LA    @15,@CF00050                                        0332 00803000
         ST    @15,@AL00001+28                                     0332 00804000
         LA    @15,RETCODE                                         0332 00805000
         ST    @15,@AL00001+32                                     0332 00806000
         L     @15,GDTDOP(,@10)                                    0332 00807000
         LA    @01,@AL00001                                        0332 00808000
         BALR  @14,@15                                             0332 00809000
*/*        IF WRITE OPERATION FAILS                                  */ 00810000
*          IF RETCODE = CPFAILS                                    0333 00811000
*/*          THEN INDICATE ASSOCIATION OF ALTERNATE TO PRIMARY FAILS */ 00812000
*            THEN DO;    CONDCODE = NOPASSOC; END;                 0333 00813000
         CLC   RETCODE(4),@CF00050                                 0333 00814000
         BNE   @RF00333                                            0333 00815000
         L     @10,@PC00001+28                                     0335 00816000
         MVC   CONDCODE(4,@10),@CF00122                            0335 00817000
*/*        END-THEN                                                  */ 00818000
*          END;                                                    0337 00819000
@RF00333 DS    0H                                                  0338 00820000
*/*    IF NO ERRORS FOUND                                            */ 00821000
*      IF CONDCODE = SUCCEEDS                                      0338 00822000
*/*      THEN                                                        */ 00823000
*        THEN DO;                                                  0338 00824000
*                                                                  0338 00825000
@RF00330 L     @10,@PC00001+28                                     0338 00826000
         L     @10,CONDCODE(,@10)                                  0338 00827000
         LTR   @10,@10                                             0338 00828000
         BNZ   @RF00338                                            0338 00829000
*/*        WRITE STANDARD-LENGTH RECORD-ZERO (ON THE ALTERNATE TRACK */ 00830000
*/*         ASSOCIATING IT WITH THE PRIMARY TRACK) (UDEVOP)          */ 00831000
*          CALL ICKDVOP0 (GDTTBL                                   0340 00832000
*                 ,VOLIB                                           0340 00833000
*                 ,ACTWRZSL                                        0340 00834000
*                 ,ALTPTR                                          0340 00835000
*                 ,RECNUM                                          0340 00836000
*                 ,POOLID                                          0340 00837000
*                 ,ADDR (PRCCHH)                                   0340 00838000
*                 ,LENGTH (PRCCHH)                                 0340 00839000
*                 ,RETCODE);                                       0340 00840000
         L     @10,@PC00001                                        0340 00841000
         ST    @10,@AL00001                                        0340 00842000
         L     @15,@PC00001+4                                      0340 00843000
         ST    @15,@AL00001+4                                      0340 00844000
         LA    @15,@CF00282                                        0340 00845000
         ST    @15,@AL00001+8                                      0340 00846000
         L     @15,@PC00001+16                                     0340 00847000
         ST    @15,@AL00001+12                                     0340 00848000
         LA    @15,RECNUM                                          0340 00849000
         ST    @15,@AL00001+16                                     0340 00850000
         LA    @15,POOLID                                          0340 00851000
         ST    @15,@AL00001+20                                     0340 00852000
         L     @15,@PC00001+8                                      0340 00853000
         ST    @15,@AFTEMPS                                        0340 00854000
         LA    @15,@AFTEMPS                                        0340 00855000
         ST    @15,@AL00001+24                                     0340 00856000
         LA    @15,@CF00050                                        0340 00857000
         ST    @15,@AL00001+28                                     0340 00858000
         LA    @15,RETCODE                                         0340 00859000
         ST    @15,@AL00001+32                                     0340 00860000
         L     @15,GDTDOP(,@10)                                    0340 00861000
         LA    @01,@AL00001                                        0340 00862000
         BALR  @14,@15                                             0340 00863000
*/*        SAVE THE ADDRESS OF THE ALTERNATE TRACK THAT WAS ASSIGNED */ 00864000
*          ALTRACK = ALTPTR;                                       0341 00865000
         L     @10,@PC00001+20                                     0341 00866000
         L     @15,@PC00001+16                                     0341 00867000
         MVC   ALTRACK(4,@10),ALTPTR(@15)                          0341 00868000
*/*        DECREMENT ALTERNATE TRACK COUNT (ALTCOUNT)                */ 00869000
*          ALTCOUNT = ALTCOUNT - 1;                                0342 00870000
         L     @10,@PC00001+12                                     0342 00871000
         L     @14,ALTCOUNT(,@10)                                  0342 00872000
         BCTR  @14,0                                               0342 00873000
         ST    @14,ALTCOUNT(,@10)                                  0342 00874000
*/*        SET POINTER TO NEXT AVAILABLE ALTERNATE TRACK (ALTPTR)    */ 00875000
*          IF ALTPTRT = TRKSPCYL - 1                               0343 00876000
*            THEN DO;                                              0343 00877000
*                                                                  0343 00878000
         L     @10,INFOPTR+8                                       0343 00879000
         L     @10,TRKSPCYL(,@10)                                  0343 00880000
         BCTR  @10,0                                               0343 00881000
         MVC   @ZT00002+2(2),ALTPTRT(@15)                          0343 00882000
         C     @10,@ZT00002                                        0343 00883000
         BNE   @RF00343                                            0343 00884000
*              ALTPTRC = ALTPTRC + 1;                              0345 00885000
         LA    @10,1                                               0345 00886000
         MVC   @ZT00002+2(2),ALTPTRC(@15)                          0345 00887000
         AL    @10,@ZT00002                                        0345 00888000
         STH   @10,ALTPTRC(,@15)                                   0345 00889000
*              ALTPTRT = 0;                                        0346 00890000
         SLR   @10,@10                                             0346 00891000
         STH   @10,ALTPTRT(,@15)                                   0346 00892000
*              END;                                                0347 00893000
*            ELSE DO;    ALTPTRT = ALTPTRT + 1; END;               0348 00894000
         B     @RC00343                                            0348 00895000
@RF00343 DS    0H                                                  0349 00896000
         L     @10,@PC00001+16                                     0349 00897000
         LA    @15,1                                               0349 00898000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0349 00899000
         AL    @15,@ZT00002                                        0349 00900000
         STH   @15,ALTPTRT(,@10)                                   0349 00901000
*/*        IF WRITE OPERATION FAILS                                  */ 00902000
*          IF RETCODE = CPFAILS                                    0351 00903000
*/*          THEN                                                    */ 00904000
*            THEN DO;                                              0351 00905000
*                                                                  0351 00906000
@RC00343 CLC   RETCODE(4),@CF00050                                 0351 00907000
         BNE   @RF00351                                            0351 00908000
*/*            INDICATE ASSOCIATION OF THE PRIMARY TO THE ALTERNATE  */ 00909000
*/*             TRACK FAILS                                          */ 00910000
*              CONDCODE = NOAASSOC;                                0353 00911000
         L     @10,@PC00001+28                                     0353 00912000
         MVC   CONDCODE(4,@10),@CF00142                            0353 00913000
*/*            SAVE THE CURRENT TRACK ADDRESS FOR THE CALLER         */ 00914000
*              UNTRADDR = CTRADDR;                                 0354 00915000
         L     @10,@PC00001+24                                     0354 00916000
         MVC   UNTRADDR(4,@10),CTRADDR                             0354 00917000
*/*            END-THEN                                              */ 00918000
*              END;                                                0355 00919000
*/*          ELSE                                                    */ 00920000
*            ELSE DO;                                              0356 00921000
         B     @RC00351                                            0356 00922000
@RF00351 DS    0H                                                  0357 00923000
*/*            IF WRITE OPERATION IS SUCCESSFUL                      */ 00924000
*              IF (RETCODE = SUCCESS) | (RETCODE = DFLAGOFA)       0357 00925000
*/*              THEN INDICATE THAT ASSIGNMENT IS COMPLETE           */ 00926000
*                THEN ASSGNCOM = COMPLETE;                         0357 00927000
         L     @10,RETCODE                                         0357 00928000
         LTR   @10,@10                                             0357 00929000
         BZ    @RT00357                                            0357 00930000
         CH    @10,@CH00191                                        0357 00931000
         BNE   @RF00357                                            0357 00932000
@RT00357 DS    0H                                                  0358 00933000
         OI    ASSGNCOM,B'10000000'                                0358 00934000
*/*            END-ELSE                                              */ 00935000
*              END;                                                0359 00936000
@RF00357 DS    0H                                                  0360 00937000
*/*        END-THEN                                                  */ 00938000
*          END;                                                    0360 00939000
@RC00351 DS    0H                                                  0361 00940000
*/*    IF ERRORS WERE FOUND                                          */ 00941000
*      IF CONDCODE > SUCCEEDS                                      0361 00942000
*/*      THEN INDICATE THAT ASSIGNMENT IS COMPLETE (WITH ERROR)      */ 00943000
*        THEN ASSGNCOM = COMPLETE;                                 0361 00944000
@RF00338 L     @10,@PC00001+28                                     0361 00945000
         L     @10,CONDCODE(,@10)                                  0361 00946000
         LTR   @10,@10                                             0361 00947000
         BNP   @RF00361                                            0361 00948000
         OI    ASSGNCOM,B'10000000'                                0362 00949000
*/*  END-WHILE (ASSIGNMENT NOT COMPLETE)                             */ 00950000
*    END;                                                          0363 00951000
@RF00361 DS    0H                                                  0363 00952000
@DE00184 TM    ASSGNCOM,B'10000000'                                0363 00953000
         BZ    @DL00184                                            0363 00954000
*/*  END-PROCEDURE ASSIGN_ALTERNATE_TRACK                            */ 00955000
*    CALL ICKSAFP0 (GDTTBL                                         0364 00956000
*           ,POOLID);                                              0364 00957000
         L     @10,@PC00001                                        0364 00958000
         ST    @10,@AL00001                                        0364 00959000
         LA    @15,POOLID                                          0364 00960000
         ST    @15,@AL00001+4                                      0364 00961000
         MVI   @AL00001+4,X'80'                                    0364 00962000
         L     @15,GDTFPL(,@10)                                    0364 00963000
         LA    @01,@AL00001                                        0364 00964000
         BALR  @14,@15                                             0364 00965000
*    IF GDTDBG = NULLPTR                                           0365 00966000
*      THEN;                                                       0365 00967000
         L     @10,@PC00001                                        0365 00968000
         L     @10,GDTDBG(,@10)                                    0365 00969000
         LTR   @10,@10                                             0365 00970000
         BZ    @RT00365                                            0365 00971000
*      ELSE                                                        0367 00972000
*        CALL ICKDB010 (GDTTBL                                     0367 00973000
*          ,'AA99');                                               0367 00974000
         L     @10,@PC00001                                        0367 00975000
         ST    @10,@AL00001                                        0367 00976000
         LA    @15,@CC00544                                        0367 00977000
         ST    @15,@AL00001+4                                      0367 00978000
         MVI   @AL00001+4,X'80'                                    0367 00979000
         L     @15,GDTDBG(,@10)                                    0367 00980000
         LA    @01,@AL00001                                        0367 00981000
         BALR  @14,@15                                             0367 00982000
*    CALL ICKSAEP0(GDTTBL,MODID);                                  0368 00983000
*                                                                  0368 00984000
@RT00365 L     @10,@PC00001                                        0368 00985000
         ST    @10,@AL00001                                        0368 00986000
         LA    @15,MODID                                           0368 00987000
         ST    @15,@AL00001+4                                      0368 00988000
         MVI   @AL00001+4,X'80'                                    0368 00989000
         L     @15,GDTEPL(,@10)                                    0368 00990000
         LA    @01,@AL00001                                        0368 00991000
         BALR  @14,@15                                             0368 00992000
*    END ICKAA01                                                   0369 00993000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00994000
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        * 00995000
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        * 00996000
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        * 00997000
*;                                                                 0369 00998000
@DATA    DS    0H                                                       00999000
@CH00191 DC    H'7'                                                     01000000
@DATD    DSECT                                                          01001000
         DS    0F                                                       01002000
@SA00001 DS    18F                                                      01003000
@PC00001 DS    8F                                                       01004000
@AL00001 DS    9A                                                       01005000
@AFTEMPS DS    1F                                                       01006000
@ZTEMPS  DS    0F                                                       01007000
@ZT00002 DC    F'0'                                                     01008000
@ZTEMPND EQU   *                                                        01009000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         01010000
ICKAA01  CSECT                                                          01011000
         DS    0F                                                       01012000
@CF00100 DC    F'0'                                                     01013000
@CF00171 DC    F'1'                                                     01014000
@CH00171 EQU   @CF00171+2                                               01015000
@CF00122 DC    F'2'                                                     01016000
@CH00122 EQU   @CF00122+2                                               01017000
@CF00142 DC    F'3'                                                     01018000
@CH00142 EQU   @CF00142+2                                               01019000
@CF00050 DC    F'4'                                                     01020000
@CF00125 DC    F'6'                                                     01021000
@CH00125 EQU   @CF00125+2                                               01022000
@CF00282 DC    F'18'                                                    01023000
@DATD    DSECT                                                          01024000
         DS    0D                                                       01025000
LISTSCAN DS    A                                                        01026000
IOCSPTR  DS    A                                                        01027000
OPNPTR   DS    A                                                        01028000
DDSTRU   DS    A                                                        01029000
FSADDR   DS    A                                                        01030000
DMPINDEX DS    A                                                        01031000
RETCODE  DS    F                                                        01032000
RETCODE1 DS    F                                                        01033000
RECNUM   DS    F                                                        01034000
HAPTR    DS    A                                                        01035000
HALEN    DS    F                                                        01036000
RZPTR    DS    A                                                        01037000
RZAPTR   DS    A                                                        01038000
RZLEN    DS    F                                                        01039000
CTRADDR  DS    F                                                        01040000
LISTPTR  DS    A                                                        01041000
SETRC    DS    H                                                        01042000
TESTRC   DS    H                                                        01043000
LISTLN   DS    FL1                                                      01044000
ASSGNFLG DS    BL1                                                      01045000
ASSGNCOM DS    BL1                                                      01046000
TRACKTYP DS    BL1                                                      01047000
INFO     DS    CL8                                                      01048000
         ORG   INFO+0                                                   01049000
INFOPTR  DS    AL4                                                      01050000
INFOLEN  DS    FL4                                                      01051000
         ORG   INFO+24                                                  01052000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01053000
@ENDDATD EQU   *                                                        01054000
ICKAA01  CSECT                                                          01055000
         DS    0F                                                       01056000
@SIZDATD DC    AL1(0)                                                   01057000
         DC    AL3(@ENDDATD-@DATD)                                      01058000
         DS    0D                                                       01059000
@CC00539 DC    C'AA00'                                                  01060000
@CC00544 DC    C'AA99'                                                  01061000
MODID    DC    CL4'AA01'                                                01062000
POOLID   DC    CL4'AA01'                                                01063000
PTCHAA01 DS    CL256                                                    01064000
         ORG   PTCHAA01                                                 01065000
@NM00018 DC    256X'00'                                                 01066000
         ORG   PTCHAA01+256                                             01067000
INFOVECT DC    F'207'                                                   01068000
         DC    F'204'                                                   01069000
         DC    F'205'                                                   01070000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01071000
@01      EQU   01                                                       01072000
@02      EQU   02                                                       01073000
@03      EQU   03                                                       01074000
@04      EQU   04                                                       01075000
@05      EQU   05                                                       01076000
@06      EQU   06                                                       01077000
@07      EQU   07                                                       01078000
@08      EQU   08                                                       01079000
@09      EQU   09                                                       01080000
@10      EQU   10                                                       01081000
@11      EQU   11                                                       01082000
@12      EQU   12                                                       01083000
@13      EQU   13                                                       01084000
@14      EQU   14                                                       01085000
@15      EQU   15                                                       01086000
I        EQU   @02                                                      01087000
REG12    EQU   @12                                                      01088000
REG0     EQU   @00                                                      01089000
REG1     EQU   @01                                                      01090000
REG10    EQU   @10                                                      01091000
REG11    EQU   @11                                                      01092000
REG13    EQU   @13                                                      01093000
REG14    EQU   @14                                                      01094000
REG15    EQU   @15                                                      01095000
REG2     EQU   @02                                                      01096000
REG3     EQU   @03                                                      01097000
REG4     EQU   @04                                                      01098000
REG5     EQU   @05                                                      01099000
REG6     EQU   @06                                                      01100000
REG7     EQU   @07                                                      01101000
REG8     EQU   @08                                                      01102000
REG9     EQU   @09                                                      01103000
RTNREG   EQU   @15                                                      01104000
ICKSAEP0 EQU   0                                                        01105000
ICKSAFP0 EQU   0                                                        01106000
TRACE1   EQU   0                                                        01107000
OLDERID1 EQU   TRACE1                                                   01108000
TRACE2   EQU   0                                                        01109000
STAEPARM EQU   0                                                        01110000
STAEPFX  EQU   STAEPARM                                                 01111000
IOCSTR   EQU   0                                                        01112000
IOCDSO   EQU   IOCSTR+13                                                01113000
IOCRFM   EQU   IOCSTR+14                                                01114000
IOCMAC   EQU   IOCSTR+15                                                01115000
IOCMSG   EQU   IOCSTR+16                                                01116000
OPNAGL   EQU   0                                                        01117000
OPNOPT   EQU   OPNAGL                                                   01118000
OPNRFM   EQU   OPNAGL+1                                                 01119000
OPNTYP   EQU   OPNAGL+2                                                 01120000
OPNMOD   EQU   OPNAGL+3                                                 01121000
UVOLLIST EQU   0                                                        01122000
UVOLENT  EQU   UVOLLIST+2                                               01123000
ICKDVIN0 EQU   0                                                        01124000
ICKDVOP0 EQU   0                                                        01125000
DARGLIST EQU   0                                                        01126000
DARGSTID EQU   DARGLIST+8                                               01127000
DARGARY  EQU   DARGLIST+20                                              01128000
DARGINS  EQU   DARGARY                                                  01129000
DARGINL  EQU   DARGARY+2                                                01130000
FMTLIST  EQU   0                                                        01131000
FMTFLGS  EQU   FMTLIST                                                  01132000
FMTSPF   EQU   FMTLIST+2                                                01133000
FMTRFNO  EQU   FMTSPF                                                   01134000
FMTILEN  EQU   FMTRFNO                                                  01135000
FMTIOFF  EQU   FMTLIST+4                                                01136000
FMTTRBC  EQU   FMTIOFF                                                  01137000
FMTSTO   EQU   FMTTRBC                                                  01138000
FMTOCOL  EQU   FMTLIST+6                                                01139000
FMTCNVF  EQU   FMTLIST+10                                               01140000
ICKDB010 EQU   0                                                        01141000
DMPITM   EQU   0                                                        01142000
DMPARY   EQU   0                                                        01143000
LASTALT  EQU   0                                                        01144000
TRKSPCYL EQU   0                                                        01145000
FINPRI   EQU   0                                                        01146000
FINPRIC  EQU   FINPRI                                                   01147000
FINPRIT  EQU   FINPRI+2                                                 01148000
RZCCHH   EQU   0                                                        01149000
RZCCHHC  EQU   RZCCHH                                                   01150000
RZCCHHT  EQU   RZCCHH+2                                                 01151000
RZACCHH  EQU   0                                                        01152000
DMPTRM   EQU   0                                                        01153000
ICKDVCL0 EQU   0                                                        01154000
ICKDVON0 EQU   0                                                        01155000
ICKIOCL0 EQU   0                                                        01156000
ICKIOGT0 EQU   0                                                        01157000
ICKIOIT0 EQU   0                                                        01158000
ICKIOOP0 EQU   0                                                        01159000
ICKIOPT0 EQU   0                                                        01160000
ICKIOTM0 EQU   0                                                        01161000
ICKSACL0 EQU   0                                                        01162000
ICKSADE0 EQU   0                                                        01163000
ICKSAFS0 EQU   0                                                        01164000
ICKSAGP0 EQU   0                                                        01165000
ICKSAGS0 EQU   0                                                        01166000
ICKSALD0 EQU   0                                                        01167000
ICKSAPR0 EQU   0                                                        01168000
ICKSASC0 EQU   0                                                        01169000
ICKSASN0 EQU   0                                                        01170000
ICKSAST0 EQU   0                                                        01171000
ICKSATI0 EQU   0                                                        01172000
ICKSAVC0 EQU   0                                                        01173000
ICKSAWO0 EQU   0                                                        01174000
ICKTPEA0 EQU   0                                                        01175000
ICKTPES0 EQU   0                                                        01176000
ICKTPPR0 EQU   0                                                        01177000
ICKTPRE0 EQU   0                                                        01178000
ICKTPRS0 EQU   0                                                        01179000
LISTTEST EQU   0                                                        01180000
NEWERID1 EQU   5                                                        01181000
NEWERID2 EQU   5                                                        01182000
GDTTBL   EQU   0                                                        01183000
GDTTR1   EQU   GDTTBL+8                                                 01184000
GDTTR2   EQU   GDTTBL+12                                                01185000
GDTDIN   EQU   GDTTBL+44                                                01186000
GDTDOP   EQU   GDTTBL+48                                                01187000
GDTDBG   EQU   GDTTBL+52                                                01188000
GDTDVO   EQU   GDTTBL+56                                                01189000
GDTPRT   EQU   GDTTBL+60                                                01190000
GDTESS   EQU   GDTTBL+64                                                01191000
GDTESA   EQU   GDTTBL+68                                                01192000
GDTRST   EQU   GDTTBL+72                                                01193000
GDTRES   EQU   GDTTBL+76                                                01194000
GDTCAL   EQU   GDTTBL+80                                                01195000
GDTGSP   EQU   GDTTBL+84                                                01196000
GDTFSP   EQU   GDTTBL+88                                                01197000
GDTGPL   EQU   GDTTBL+92                                                01198000
GDTFPL   EQU   GDTTBL+96                                                01199000
GDTLOD   EQU   GDTTBL+100                                               01200000
GDTDEL   EQU   GDTTBL+104                                               01201000
GDTPRL   EQU   GDTTBL+108                                               01202000
GDTEPL   EQU   GDTTBL+112                                               01203000
GDTTIM   EQU   GDTTBL+116                                               01204000
GDTIIO   EQU   GDTTBL+120                                               01205000
GDTTIO   EQU   GDTTBL+124                                               01206000
GDTOPN   EQU   GDTTBL+136                                               01207000
GDTCLS   EQU   GDTTBL+140                                               01208000
GDTGET   EQU   GDTTBL+144                                               01209000
GDTPUT   EQU   GDTTBL+148                                               01210000
GDTSNP   EQU   GDTTBL+160                                               01211000
GDTWTO   EQU   GDTTBL+168                                               01212000
GDTSCR   EQU   GDTTBL+172                                               01213000
GDTVCK   EQU   GDTTBL+176                                               01214000
GDTDVC   EQU   GDTTBL+180                                               01215000
GDTSTE   EQU   GDTTBL+188                                               01216000
VOLIB    EQU   0                                                        01217000
PRCCHH   EQU   0                                                        01218000
ALTCOUNT EQU   0                                                        01219000
ALTPTR   EQU   0                                                        01220000
ALTPTRC  EQU   ALTPTR                                                   01221000
ALTPTRT  EQU   ALTPTR+2                                                 01222000
ALTRACK  EQU   0                                                        01223000
UNTRADDR EQU   0                                                        01224000
CONDCODE EQU   0                                                        01225000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01226000
GDTCVR   EQU   GDTTBL+184                                               01227000
GDTSPR   EQU   GDTTBL+164                                               01228000
GDTABH   EQU   GDTTBL+156                                               01229000
GDTABT   EQU   GDTTBL+152                                               01230000
GDTTOH   EQU   GDTTBL+132                                               01231000
GDTRIP   EQU   GDTTBL+128                                               01232000
GDTDVH   EQU   GDTTBL+40                                                01233000
GDTIOH   EQU   GDTTBL+36                                                01234000
GDTSAH   EQU   GDTTBL+32                                                01235000
GDTTPH   EQU   GDTTBL+28                                                01236000
GDTRIH   EQU   GDTTBL+24                                                01237000
GDTSTH   EQU   GDTTBL+20                                                01238000
GDTDBH   EQU   GDTTBL+16                                                01239000
GDTPRM   EQU   GDTTBL+4                                                 01240000
GDTHDR   EQU   GDTTBL                                                   01241000
RZACCHHT EQU   RZACCHH+2                                                01242000
RZACCHHC EQU   RZACCHH                                                  01243000
LASTALTT EQU   LASTALT+2                                                01244000
LASTALTC EQU   LASTALT                                                  01245000
@NM00017 EQU   DMPARY+15                                                01246000
DMPARYTP EQU   DMPARY+14                                                01247000
DMPARYEX EQU   DMPARY+12                                                01248000
DMPARYIC EQU   DMPARY+10                                                01249000
DMPARYSZ EQU   DMPARY+8                                                 01250000
DMPARYNM EQU   DMPARY                                                   01251000
@NM00016 EQU   DMPITM+15                                                01252000
DMPITMTP EQU   DMPITM+14                                                01253000
DMPITMLN EQU   DMPITM+12                                                01254000
DMPITMPT EQU   DMPITM+8                                                 01255000
DMPITMNM EQU   DMPITM                                                   01256000
@NM00015 EQU   FMTCNVF+1                                                01257000
FMTBS    EQU   FMTCNVF+1                                                01258000
FMTSS    EQU   FMTCNVF+1                                                01259000
FMTAL    EQU   FMTCNVF+1                                                01260000
FMTZS    EQU   FMTCNVF+1                                                01261000
@NM00014 EQU   FMTCNVF                                                  01262000
FMTPU    EQU   FMTCNVF                                                  01263000
FMTBD    EQU   FMTCNVF                                                  01264000
FMTBHD   EQU   FMTCNVF                                                  01265000
FMTBHA   EQU   FMTCNVF                                                  01266000
FMTBH    EQU   FMTCNVF                                                  01267000
FMTOLEN  EQU   FMTLIST+8                                                01268000
FMTRIO   EQU   FMTOCOL                                                  01269000
FMTSPT   EQU   FMTSTO                                                   01270000
FMTSTL   EQU   FMTILEN                                                  01271000
@NM00013 EQU   FMTFLGS+1                                                01272000
FMTHDF   EQU   FMTFLGS                                                  01273000
FMTDFF   EQU   FMTFLGS                                                  01274000
FMTSTF   EQU   FMTFLGS                                                  01275000
FMTREPF  EQU   FMTFLGS                                                  01276000
FMTBDF   EQU   FMTFLGS                                                  01277000
FMTIDF   EQU   FMTFLGS                                                  01278000
FMTSCF   EQU   FMTFLGS                                                  01279000
FMTEOLF  EQU   FMTFLGS                                                  01280000
DARGDTM  EQU   DARGARY+4                                                01281000
DARGPCT  EQU   DARGINL                                                  01282000
DARGREP  EQU   DARGINS                                                  01283000
@NM00012 EQU   DARGLIST+19                                              01284000
DARGIND  EQU   DARGLIST+18                                              01285000
DARGRETL EQU   DARGLIST+16                                              01286000
DARGCNT  EQU   DARGLIST+14                                              01287000
DARGILP  EQU   DARGLIST+12                                              01288000
DARGSENT EQU   DARGSTID+3                                               01289000
DARGSMOD EQU   DARGSTID                                                 01290000
DARGRETP EQU   DARGLIST+4                                               01291000
DARGDBP  EQU   DARGLIST                                                 01292000
UVOLVOL  EQU   UVOLENT+4                                                01293000
UVOLDEV  EQU   UVOLENT                                                  01294000
UVOLCNT  EQU   UVOLLIST                                                 01295000
OPNRSVD  EQU   OPNAGL+28                                                01296000
OPNVOL   EQU   OPNAGL+24                                                01297000
OPNBLK   EQU   OPNAGL+20                                                01298000
OPNREC   EQU   OPNAGL+16                                                01299000
OPNDSN   EQU   OPNAGL+12                                                01300000
OPNDDN   EQU   OPNAGL+8                                                 01301000
OPNIOC   EQU   OPNAGL+4                                                 01302000
@NM00011 EQU   OPNMOD                                                   01303000
OPNMODRC EQU   OPNMOD                                                   01304000
OPNMODAC EQU   OPNMOD                                                   01305000
@NM00010 EQU   OPNTYP                                                   01306000
OPNTYPSO EQU   OPNTYP                                                   01307000
OPNTYPSI EQU   OPNTYP                                                   01308000
@NM00009 EQU   OPNRFM                                                   01309000
OPNRFMBK EQU   OPNRFM                                                   01310000
OPNRFMSF EQU   OPNRFM                                                   01311000
OPNRFMUN EQU   OPNRFM                                                   01312000
OPNRFMVR EQU   OPNRFM                                                   01313000
OPNRFMFX EQU   OPNRFM                                                   01314000
@NM00008 EQU   OPNOPT                                                   01315000
OPNOPTJM EQU   OPNOPT                                                   01316000
OPNOPTKS EQU   OPNOPT                                                   01317000
OPNOPTBK EQU   OPNOPT                                                   01318000
OPNOPTUP EQU   OPNOPT                                                   01319000
OPNOPTOT EQU   OPNOPT                                                   01320000
OPNOPTIN EQU   OPNOPT                                                   01321000
IOCEXT   EQU   IOCSTR+36                                                01322000
IOCRRN   EQU   IOCSTR+32                                                01323000
@NM00007 EQU   IOCSTR+30                                                01324000
IOCPNM   EQU   IOCSTR+28                                                01325000
IOCCBP   EQU   IOCSTR+24                                                01326000
IOCDSN   EQU   IOCSTR+20                                                01327000
@NM00006 EQU   IOCSTR+17                                                01328000
@NM00005 EQU   IOCMSG                                                   01329000
IOCMSGOP EQU   IOCMSG                                                   01330000
IOCMACPA EQU   IOCMAC                                                   01331000
@NM00004 EQU   IOCMAC                                                   01332000
IOCMACBK EQU   IOCMAC                                                   01333000
IOCMACUP EQU   IOCMAC                                                   01334000
IOCMACOT EQU   IOCMAC                                                   01335000
IOCMACIN EQU   IOCMAC                                                   01336000
@NM00003 EQU   IOCRFM                                                   01337000
IOCRFMBK EQU   IOCRFM                                                   01338000
IOCRFMSF EQU   IOCRFM                                                   01339000
IOCRFMUN EQU   IOCRFM                                                   01340000
IOCRFMVR EQU   IOCRFM                                                   01341000
IOCRFMFX EQU   IOCRFM                                                   01342000
@NM00002 EQU   IOCDSO                                                   01343000
IOCDSOPS EQU   IOCDSO                                                   01344000
IOCKYL   EQU   IOCSTR+12                                                01345000
IOCTRN   EQU   IOCSTR+8                                                 01346000
IOCDLN   EQU   IOCSTR+4                                                 01347000
IOCDAD   EQU   IOCSTR                                                   01348000
STAEWORK EQU   STAEPARM+32                                              01349000
STARPTR  EQU   STAEPFX+28                                               01350000
STASPTR  EQU   STAEPFX+24                                               01351000
STALEN   EQU   STAEPFX+20                                               01352000
STAID    EQU   STAEPFX+16                                               01353000
STAEPA   EQU   STAEPFX+12                                               01354000
STAGDT   EQU   STAEPFX+8                                                01355000
STABPTR  EQU   STAEPFX+4                                                01356000
STAFPTR  EQU   STAEPFX                                                  01357000
NEWID2   EQU   TRACE2+95                                                01358000
OLDERID2 EQU   TRACE2                                                   01359000
NEWID1   EQU   TRACE1+95                                                01360000
CALLID   EQU   OLDERID1+90                                              01361000
@NM00001 EQU   OLDERID1                                                 01362000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01363000
@RC00202 EQU   ENDLOOP                                                  01364000
@RC00216 EQU   @RC00213                                                 01365000
@RC00239 EQU   ENDLOOP                                                  01366000
@RC00253 EQU   @RC00250                                                 01367000
@RC00272 EQU   ENDLOOP                                                  01368000
@RC00286 EQU   @RC00283                                                 01369000
@ENDDATA EQU   *                                                        01370000
         END   ICKAA01,(C'PLS1702',0701,78192)                          01371000
