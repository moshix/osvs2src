         TITLE '******************  ICKEX01:  DMS EXECUTIVE  ***********00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
ICKEX01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'ICKEX01   78.192'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @10,0                                               0002 00021000
@PSTART  LA    @12,4095(,@10)                                      0002 00022000
         USING @PSTART,@10                                         0002 00023000
         USING @PSTART+4095,@12                                    0002 00024000
         L     @00,@SIZDATD                                        0002 00025000
         GETMAIN  R,LV=(0)                                              00026000
         LR    @08,@01                                             0002 00027000
         LA    @09,4095(,@08)                                      0002 00028000
         USING @DATD,@08                                           0002 00029000
         USING @DATD+4095,@09                                      0002 00030000
         ST    @13,@SA00001+4                                      0002 00031000
         LM    @00,@01,20(@13)                                     0002 00032000
         ST    @08,8(,@13)                                         0002 00033000
         LR    @13,@08                                             0002 00034000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00035000
         MVC   @PC00001(4),0(@01)                                  0002 00036000
*                                      /*PATCH AREA FOR MAINTENANCE  */ 00037000
*        /************************************************************/ 00038000
*        /*                                                          */ 00039000
*        /*  CALL ICKDMS INITIALIZATION ROUTINE - SCANS INVOKER'S    */ 00040000
*        /*  PARAMETER LIST AND PERFORMS SYSTEM INITIALIZATION       */ 00041000
*        /*  FOR THE TEXT PROCESSOR AND THE INPUT/OUTPUT ADAPTER.    */ 00042000
*        /*  (SYSTEM ADAPTER INITIALIZATION HAS BEEN COMPLETED       */ 00043000
*        /*  BEFORE THE EXECUTIVE RECEIVES CONTROL).                 */ 00044000
*        /*                                                          */ 00045000
*        /************************************************************/ 00046000
*                                                                  0193 00047000
*        CALL ICKSACL0(GDTTBL,INITNAME);                           0193 00048000
         L     @11,@PC00001                                        0193 00049000
         ST    @11,@AL00001                                        0193 00050000
         LA    @03,@CC00483                                        0193 00051000
         ST    @03,@AL00001+4                                      0193 00052000
         MVI   @AL00001+4,X'80'                                    0193 00053000
         L     @15,GDTCAL(,@11)                                    0193 00054000
         LA    @01,@AL00001                                        0193 00055000
         BALR  @14,@15                                             0193 00056000
*        RESPECIFY RTNREG RSTD;                                    0194 00057000
*        TESTRC = RTNREG;                                          0195 00058000
         LR    TESTRC,RTNREG                                       0195 00059000
*        RESPECIFY RTNREG UNRSTD;                                  0196 00060000
*                                                                  0196 00061000
*        /************************************************************/ 00062000
*        /*                                                          */ 00063000
*        /*  SET THE ICKDMS SYSTEM CONDITION CODES -                 */ 00064000
*        /*    MAXIMUM COND CODE FOR ALL ICKDMS FUNCTION PROCESSING  */ 00065000
*        /*    LAST FUNCTION COND CODE FOR THE CURRENT FUNCTION      */ 00066000
*        /*                                                          */ 00067000
*        /************************************************************/ 00068000
*                                                                  0197 00069000
*        MAXCOND  = TESTRC;                                        0197 00070000
         STH   TESTRC,MAXCOND                                      0197 00071000
*        LASTCOND = TESTRC;                                        0198 00072000
         STH   TESTRC,LASTCOND                                     0198 00073000
*        /************************************************************/ 00074000
*        /*                                                          */ 00075000
*        /*  ROUTE CONTROL BETWEEN THE READER/INTERPRETER (PROCESS   */ 00076000
*        /*  THE ICKDMS COMMAND INPUT AND BUILD THE FDT) AND THE     */ 00077000
*        /*  SPECIFIED FUNCTION SUPPORT ROUTINE (THE FSR NAME IS     */ 00078000
*        /*  RETURNED FROM THE READER/INTERPRETER) UNTIL SYSIN       */ 00079000
*        /*  END-OF-FILE HAS BEEN ENCOUNTERED.                       */ 00080000
*        /*                                                          */ 00081000
*        /************************************************************/ 00082000
*                                                                  0199 00083000
*        CALL MAIN;                                                0199 00084000
*                                                                  0199 00085000
         BAL   @14,MAIN                                            0199 00086000
*        IF GDTDBG = NULLPTR                                       0200 00087000
*          THEN;                                                   0200 00088000
         L     @11,@PC00001                                        0200 00089000
         L     @11,GDTDBG(,@11)                                    0200 00090000
         LTR   @11,@11                                             0200 00091000
         BZ    @RT00200                                            0200 00092000
*          ELSE                                                    0202 00093000
*            CALL ICKDB010(GDTTBL,'EXMN');                         0202 00094000
*                                                                  0202 00095000
         L     @11,@PC00001                                        0202 00096000
         ST    @11,@AL00001                                        0202 00097000
         LA    @15,@CC00495                                        0202 00098000
         ST    @15,@AL00001+4                                      0202 00099000
         MVI   @AL00001+4,X'80'                                    0202 00100000
         L     @15,GDTDBG(,@11)                                    0202 00101000
         LA    @01,@AL00001                                        0202 00102000
         BALR  @14,@15                                             0202 00103000
*        /************************************************************/ 00104000
*        /*                                                          */ 00105000
*        /*  CALL ICKDMS TERMINATION ROUTINE - PERFORMS TERMINATION  */ 00106000
*        /*  FOR THE TEXT PROCESSOR AND THE INPUT/OUTPUT ADAPTER,    */ 00107000
*        /*  AND UPDATES THE INVOKER'S PARAMETER LIST.               */ 00108000
*        /*                                                          */ 00109000
*        /************************************************************/ 00110000
*                                                                  0203 00111000
*        CALL ICKSACL0(GDTTBL,TERMNAME,MAXCOND);                   0203 00112000
@RT00200 L     @11,@PC00001                                        0203 00113000
         ST    @11,@AL00001                                        0203 00114000
         LA    @03,@CC00485                                        0203 00115000
         ST    @03,@AL00001+4                                      0203 00116000
         LA    @03,MAXCOND                                         0203 00117000
         ST    @03,@AL00001+8                                      0203 00118000
         MVI   @AL00001+8,X'80'                                    0203 00119000
         L     @15,GDTCAL(,@11)                                    0203 00120000
         LA    @01,@AL00001                                        0203 00121000
         BALR  @14,@15                                             0203 00122000
*        RESPECIFY RTNREG RSTD;                                    0204 00123000
*        TESTRC = RTNREG;                                          0205 00124000
         LR    TESTRC,RTNREG                                       0205 00125000
*        RESPECIFY RTNREG UNRSTD;                                  0206 00126000
*                                                                  0206 00127000
*        /************************************************************/ 00128000
*        /*                                                          */ 00129000
*        /*  RETURN TO THE SYSTEM ADAPTER TO COMPLETE PROCESSING     */ 00130000
*        /*                                                          */ 00131000
*        /************************************************************/ 00132000
*                                                                  0207 00133000
*        CALL ICKSAEP0(GDTTBL,MODID,MAXCOND);                      0207 00134000
         L     @11,@PC00001                                        0207 00135000
         ST    @11,@AL00001                                        0207 00136000
         LA    @15,MODID                                           0207 00137000
         ST    @15,@AL00001+4                                      0207 00138000
         LA    @15,MAXCOND                                         0207 00139000
         ST    @15,@AL00001+8                                      0207 00140000
         MVI   @AL00001+8,X'80'                                    0207 00141000
         L     @15,GDTEPL(,@11)                                    0207 00142000
         LA    @01,@AL00001                                        0207 00143000
         BALR  @14,@15                                             0207 00144000
*/********************************************************************/ 00145000
*/*                                                                  */ 00146000
*/*  PROCEDURE NAME - MAIN                                           */ 00147000
*/*                                                                  */ 00148000
*/*  FUNCTION - ROUTE CONTROL BETWEEN THE READER/INTERPRETER (TO     */ 00149000
*/*             PROCESS THE ICKDMS INPUT COMMANDS AND BUILD THE      */ 00150000
*/*             FDT) AND THE SPECIFIED FUNCTION SUPPORT ROUTINE (THE */ 00151000
*/*             FSR NAME IS RETURNED FROM THE READER/INTERPRETER)    */ 00152000
*/*                                                                  */ 00153000
*/*             ROUTING IS CONTROLLED BY THE 'SWITCH' SWITCH WHICH   */ 00154000
*/*             IS INITIALIZED TO 'SWITCHRI' (R/I NEXT TO RECEIVE    */ 00155000
*/*             CONTROL) AND FOLLOWING THE CALLS TO THE READER/      */ 00156000
*/*             INTERPRETER AND FUNCTION ROUTINES IS UPDATED TO      */ 00157000
*/*             'SWITCHFS' AND 'SWITCHRI', RESPECITIVELY             */ 00158000
*/*                                                                  */ 00159000
*/*             THE SYSTEM CONDITION CODES ARE UPDATED BY THE        */ 00160000
*/*             READER/INTERPRETER AND FOLLOWING EACH CALL TO THE    */ 00161000
*/*             FUNCTION SUPPORT ROUTINE                             */ 00162000
*/*                                                                  */ 00163000
*/*  INPUT - MAXIMUM SYSTEM CONDITION CODE - INITIALIZED TO ZERO     */ 00164000
*/*          (NO EXCEPTIONAL CONDITIONS)                             */ 00165000
*/*                                                                  */ 00166000
*/*  OUTPUT - MAXIMUM SYSTEM CONDITION CODE - UPDATED AS A RESULT OF */ 00167000
*/*           READER/INTERPRETER AND FUNCTION ROUTINE PROCESSING     */ 00168000
*/*                                                                  */ 00169000
*/********************************************************************/ 00170000
*                                                                  0208 00171000
*MAIN:   PROCEDURE;                                                0208 00172000
@EL00001 L     @13,4(,@13)                                         0208 00173000
@EF00001 L     @00,@SIZDATD                                        0208 00174000
         LR    @01,@08                                             0208 00175000
         FREEMAIN R,LV=(0),A=(1)                                        00176000
@ER00001 LM    @14,@12,12(@13)                                     0208 00177000
         BR    @14                                                 0208 00178000
MAIN     STM   @14,@12,@SA00002                                    0208 00179000
*        OLDERID2 = NEWERID2;                                      0209 00180000
         L     @11,@PC00001                                        0209 00181000
         L     @11,GDTTR2(,@11)                                    0209 00182000
         MVC   @TS00001(95),NEWERID2(@11)                          0209 00183000
         MVC   OLDERID2(95,@11),@TS00001                           0209 00184000
*        NEWID2 = 'EX1M';                                          0210 00185000
*                                                                  0210 00186000
         MVC   NEWID2(4,@11),@CC00499                              0210 00187000
*        SWITCH = SWITCHRI;                                        0211 00188000
         NI    SWITCH,B'01111111'                                  0211 00189000
*        EOFCOND = NOEOF;                                          0212 00190000
*                                                                  0212 00191000
         SLR   EOFCOND,EOFCOND                                     0212 00192000
*        /************************************************************/ 00193000
*        /*                                                          */ 00194000
*        /*  LOOP THROUGH READER/INTERPRETER AND FUNCTION SUPPORT    */ 00195000
*        /*  ROUTINES UNTIL SYSTEM CONDITION CODES = 16 (TERMINATING */ 00196000
*        /*  CONDITION), OR UNTIL SYSIN END-OF-FILE HAS BEEN FOUND   */ 00197000
*        /*  BY THE READER/INTERPRETER (END-OF-FILE RETURN CODE)     */ 00198000
*        /*                                                          */ 00199000
*        /************************************************************/ 00200000
*                                                                  0213 00201000
*        DO WHILE (MAXCOND < CONDTERM & EOFCOND = NOEOF);          0213 00202000
*                                                                  0213 00203000
         B     @DE00213                                            0213 00204000
@DL00213 DS    0H                                                  0214 00205000
*          /**********************************************************/ 00206000
*          /*                                                        */ 00207000
*          /*  TEST SWITCH TO DETERMINE WHETHER READER/INTERPRETER   */ 00208000
*          /*  OR FUNCTION SUPPORT ROUTINE RECEIVES CONTROL          */ 00209000
*          /*                                                        */ 00210000
*          /**********************************************************/ 00211000
*                                                                  0214 00212000
*          IF SWITCH = SWITCHRI                                    0214 00213000
*            THEN                                                  0214 00214000
         TM    SWITCH,B'10000000'                                  0214 00215000
         BNZ   @RF00214                                            0214 00216000
*              DO;                                                 0215 00217000
*              /******************************************************/ 00218000
*              /*                                                    */ 00219000
*              /*  READER/INTERPRETER PROCESSING NEXT                */ 00220000
*              /*                                                    */ 00221000
*              /******************************************************/ 00222000
*                                                                  0216 00223000
*              CALL CALLRI;                                        0216 00224000
*                                                                  0216 00225000
         BAL   @14,CALLRI                                          0216 00226000
*              SWITCH = SWITCHFS;                                  0217 00227000
         OI    SWITCH,B'10000000'                                  0217 00228000
*              END;                                                0218 00229000
*                                                                  0218 00230000
*            ELSE                                                  0219 00231000
*              DO;                                                 0219 00232000
         B     @RC00214                                            0219 00233000
@RF00214 DS    0H                                                  0220 00234000
*              /******************************************************/ 00235000
*              /*                                                    */ 00236000
*              /*  FUNCTION SUPPORT ROUTINE (FSR) PROCESSING NEXT    */ 00237000
*              /*                                                    */ 00238000
*              /******************************************************/ 00239000
*                                                                  0220 00240000
*              CALL CALLFSR;                                       0220 00241000
*                                                                  0220 00242000
         BAL   @14,CALLFSR                                         0220 00243000
*              SWITCH = SWITCHRI;                                  0221 00244000
         NI    SWITCH,B'01111111'                                  0221 00245000
*              END;                                                0222 00246000
*                                                                  0222 00247000
*        END;                                                      0223 00248000
*                                                                  0223 00249000
@RC00214 DS    0H                                                  0223 00250000
@DE00213 LH    @11,MAXCOND                                         0223 00251000
         CH    @11,@CH00263                                        0223 00252000
         BNL   @DC00213                                            0223 00253000
         LTR   EOFCOND,EOFCOND                                     0223 00254000
         BZ    @DL00213                                            0223 00255000
@DC00213 DS    0H                                                  0224 00256000
*        RETURN;                                                   0224 00257000
@EL00002 DS    0H                                                  0224 00258000
@EF00002 DS    0H                                                  0224 00259000
@ER00002 LM    @14,@12,@SA00002                                    0224 00260000
         BR    @14                                                 0224 00261000
*/********************************************************************/ 00262000
*/*                                                                  */ 00263000
*/*  PROCEDURE NAME - CALLRI                                         */ 00264000
*/*                                                                  */ 00265000
*/*  FUNCTION - INVOKE THE READER/INTERPRETER TO PROCESS THE NEXT    */ 00266000
*/*             INPUT ICKDMS COMMAND.  THE POOL AREA NAME IN WHICH   */ 00267000
*/*             THE FDT WILL BE BUILT IS PASSED TO THE READER/       */ 00268000
*/*             INTERPRETER.  (THIS POOL AREA WILL BE RELEASED BY    */ 00269000
*/*             THE EXECUTIVE FOLLOWING FUNCTION PROCESSING)         */ 00270000
*/*                                                                  */ 00271000
*/*  INPUT - MAXIMUM AND LAST FUNCTION CONDITION CODES - TO CONTROL  */ 00272000
*/*          READER/INTERPRETER PROCESSING                           */ 00273000
*/*                                                                  */ 00274000
*/*  OUTPUT - FUNCTION SUPPORT ROUTINE NAME (RETURNED BY THE         */ 00275000
*/*           READER/INTERPRETER)                                    */ 00276000
*/*           FUNCTION DATA TABLE (BUILT BY THE READER/INTERPRETER)  */ 00277000
*/*                                                                  */ 00278000
*/********************************************************************/ 00279000
*                                                                  0225 00280000
*CALLRI: PROCEDURE;                                                0225 00281000
*                                                                  0225 00282000
CALLRI   STM   @14,@02,@SA00003                                    0225 00283000
         STM   @04,@12,@SA00003+20                                 0225 00284000
*        OLDERID2 = NEWERID2;                                      0226 00285000
         L     @11,@PC00001                                        0226 00286000
         L     @15,GDTTR2(,@11)                                    0226 00287000
         MVC   @TS00001(95),NEWERID2(@15)                          0226 00288000
         MVC   OLDERID2(95,@15),@TS00001                           0226 00289000
*        NEWID2 = 'EX1R';                                          0227 00290000
*                                                                  0227 00291000
         MVC   NEWID2(4,@15),@CC00505                              0227 00292000
*        IF GDTDBG = NULLPTR                                       0228 00293000
*          THEN;                                                   0228 00294000
         L     @11,GDTDBG(,@11)                                    0228 00295000
         LTR   @11,@11                                             0228 00296000
         BZ    @RT00228                                            0228 00297000
*          ELSE                                                    0230 00298000
*            CALL ICKDB010(GDTTBL,'EXRI');                         0230 00299000
*                                                                  0230 00300000
         L     @11,@PC00001                                        0230 00301000
         ST    @11,@AL00001                                        0230 00302000
         LA    @15,@CC00506                                        0230 00303000
         ST    @15,@AL00001+4                                      0230 00304000
         MVI   @AL00001+4,X'80'                                    0230 00305000
         L     @15,GDTDBG(,@11)                                    0230 00306000
         LA    @01,@AL00001                                        0230 00307000
         BALR  @14,@15                                             0230 00308000
*        /************************************************************/ 00309000
*        /*                                                          */ 00310000
*        /*  CALL THE READER/INTERPRETER                             */ 00311000
*        /*                                                          */ 00312000
*        /************************************************************/ 00313000
*                                                                  0231 00314000
*        CALL ICKSACL0(GDTTBL,RINAME,FTABPTR,AREANAME,MAXCOND,LASTCOND, 00315000
*SRNAME);                                                          0231 00316000
*                                                                  0231 00317000
@RT00228 L     @11,@PC00001                                        0231 00318000
         ST    @11,@AL00001                                        0231 00319000
         LA    @15,@CC00487                                        0231 00320000
         ST    @15,@AL00001+4                                      0231 00321000
         LA    @15,FTABPTR                                         0231 00322000
         ST    @15,@AL00001+8                                      0231 00323000
         LA    @15,@CC00479                                        0231 00324000
         ST    @15,@AL00001+12                                     0231 00325000
         LA    @15,MAXCOND                                         0231 00326000
         ST    @15,@AL00001+16                                     0231 00327000
         LA    @15,LASTCOND                                        0231 00328000
         ST    @15,@AL00001+20                                     0231 00329000
         LA    @15,FSRNAME                                         0231 00330000
         ST    @15,@AL00001+24                                     0231 00331000
         MVI   @AL00001+24,X'80'                                   0231 00332000
         L     @15,GDTCAL(,@11)                                    0231 00333000
         LA    @01,@AL00001                                        0231 00334000
         BALR  @14,@15                                             0231 00335000
*        /************************************************************/ 00336000
*        /*                                                          */ 00337000
*        /*  OBTAIN THE READER/INTERPRETER (END-OF-FILE) RETURN CODE */ 00338000
*        /*                                                          */ 00339000
*        /************************************************************/ 00340000
*                                                                  0232 00341000
*        RESPECIFY RTNREG RSTD;                                    0232 00342000
*        TESTRC = RTNREG;                                          0233 00343000
         LR    TESTRC,RTNREG                                       0233 00344000
*        RESPECIFY RTNREG UNRSTD;                                  0234 00345000
*                                                                  0234 00346000
*        EOFCOND = TESTRC;                                         0235 00347000
*                                                                  0235 00348000
         LR    EOFCOND,TESTRC                                      0235 00349000
*        RETURN;                                                   0236 00350000
*                                                                  0236 00351000
@EL00003 DS    0H                                                  0236 00352000
@EF00003 DS    0H                                                  0236 00353000
@ER00003 LM    @14,@02,@SA00003                                    0236 00354000
         LM    @04,@12,@SA00003+20                                 0236 00355000
         BR    @14                                                 0236 00356000
*        END CALLRI;                                               0237 00357000
*/********************************************************************/ 00358000
*/*                                                                  */ 00359000
*/*  PROCEDURE NAME - CALLFSR                                        */ 00360000
*/*                                                                  */ 00361000
*/*  FUNCTION - INVOKE THE FUNCTION SUPPORT ROUTINE (FSR) TO PROCESS */ 00362000
*/*             THE UTILITY FUNCTION DESIRED.  FOLLOWING FUNCTION    */ 00363000
*/*             PROCESSING, FREE THE AREA HELD BY THE FUNCTION DATA  */ 00364000
*/*             TABLE (UFPOOL MACRO), AND RESET THE TEXT PROCESSING  */ 00365000
*/*             OPTIONS TO THEIR DEFAULT VALUES (URESET MACRO)       */ 00366000
*/*                                                                  */ 00367000
*/*             THE LAST FUNCTION CONDITION CODE IS SET BY THE       */ 00368000
*/*             FUNCTION SUPPORT ROUTINE.  THE MAXIMUM CONDITION     */ 00369000
*/*             CODE IS UPDATED IF THE LAST FUNCTION CONDITION CODE  */ 00370000
*/*             IS GREATER THAN THE MAXIMUM CONDITION CODE           */ 00371000
*/*                                                                  */ 00372000
*/*  INPUT - FSR NAME (RETURNED FROM READER/INTERPRETER)             */ 00373000
*/*          FUNCTION DATA TABLE (FDT) (BUILT BY READER/INTERPRETER) */ 00374000
*/*                                                                  */ 00375000
*/*  OUTPUT - FUNCTION SUPPORT ROUTINE CONDITION CODE                */ 00376000
*/*           UPDATED MAXIMUM SYSTEM CONDITION CODE                  */ 00377000
*/*                                                                  */ 00378000
*/********************************************************************/ 00379000
*                                                                  0238 00380000
*CALLFSR: PROCEDURE;                                               0238 00381000
*                                                                  0238 00382000
CALLFSR  STM   @14,@12,@SA00004                                    0238 00383000
*        OLDERID2 = NEWERID2;                                      0239 00384000
         L     @11,@PC00001                                        0239 00385000
         L     @15,GDTTR2(,@11)                                    0239 00386000
         MVC   @TS00001(95),NEWERID2(@15)                          0239 00387000
         MVC   OLDERID2(95,@15),@TS00001                           0239 00388000
*        NEWID2 = 'EX1F';                                          0240 00389000
*                                                                  0240 00390000
         MVC   NEWID2(4,@15),@CC00510                              0240 00391000
*        IF GDTDBG = NULLPTR                                       0241 00392000
*          THEN;                                                   0241 00393000
         L     @11,GDTDBG(,@11)                                    0241 00394000
         LTR   @11,@11                                             0241 00395000
         BZ    @RT00241                                            0241 00396000
*          ELSE                                                    0243 00397000
*            CALL ICKDB010(GDTTBL,'EXFS');                         0243 00398000
*                                                                  0243 00399000
         L     @11,@PC00001                                        0243 00400000
         ST    @11,@AL00001                                        0243 00401000
         LA    @15,@CC00511                                        0243 00402000
         ST    @15,@AL00001+4                                      0243 00403000
         MVI   @AL00001+4,X'80'                                    0243 00404000
         L     @15,GDTDBG(,@11)                                    0243 00405000
         LA    @01,@AL00001                                        0243 00406000
         BALR  @14,@15                                             0243 00407000
*        /************************************************************/ 00408000
*        /*                                                          */ 00409000
*        /*  RESET THE LAST FUNCTION CONDITION CODE FOR CURRENT FSR  */ 00410000
*        /*                                                          */ 00411000
*        /************************************************************/ 00412000
*                                                                  0244 00413000
*        LASTCOND = CONDNONE;                                      0244 00414000
*                                                                  0244 00415000
@RT00241 SLR   @11,@11                                             0244 00416000
         STH   @11,LASTCOND                                        0244 00417000
*        /************************************************************/ 00418000
*        /*                                                          */ 00419000
*        /*  CALL THE FUNCTION SUPPORT ROUTINE (FSR)                 */ 00420000
*        /*                                                          */ 00421000
*        /************************************************************/ 00422000
*                                                                  0245 00423000
*        CALL ICKSACL0(GDTTBL,FSRNAME,FTABLE,LASTCOND);            0245 00424000
*                                                                  0245 00425000
         L     @11,@PC00001                                        0245 00426000
         ST    @11,@AL00001                                        0245 00427000
         LA    @15,FSRNAME                                         0245 00428000
         ST    @15,@AL00001+4                                      0245 00429000
         L     @01,FTABPTR                                         0245 00430000
         ST    @01,@AL00001+8                                      0245 00431000
         LA    @15,LASTCOND                                        0245 00432000
         ST    @15,@AL00001+12                                     0245 00433000
         MVI   @AL00001+12,X'80'                                   0245 00434000
         L     @15,GDTCAL(,@11)                                    0245 00435000
         LA    @01,@AL00001                                        0245 00436000
         BALR  @14,@15                                             0245 00437000
*        /************************************************************/ 00438000
*        /*                                                          */ 00439000
*        /*  UPDATE THE MAXIMUM SYSTEM CONDITION CODE                */ 00440000
*        /*                                                          */ 00441000
*        /************************************************************/ 00442000
*                                                                  0246 00443000
*        MAXCOND = MAX(MAXCOND,LASTCOND);                          0246 00444000
*                                                                  0246 00445000
         LH    @11,MAXCOND                                         0246 00446000
         LH    @15,LASTCOND                                        0246 00447000
         CR    @11,@15                                             0246 00448000
         BNL   *+6                                                      00449000
         LR    @11,@15                                             0246 00450000
         STH   @11,MAXCOND                                         0246 00451000
*        /************************************************************/ 00452000
*        /*                                                          */ 00453000
*        /*  FREE THE POOL AREA CONTAINING THE FUNCTION DATA TABLE   */ 00454000
*        /*  BUILT FOR THE JUST-COMPLETED FUNCTION SUPPORT ROUTINE   */ 00455000
*        /*                                                          */ 00456000
*        /************************************************************/ 00457000
*                                                                  0247 00458000
*        CALL ICKSAFP0(GDTTBL,AREANAME,ALL);                       0247 00459000
*                                                                  0247 00460000
         MVC   @AL00001+4(8),@AL00247                              0247 00461000
         L     @11,@PC00001                                        0247 00462000
         ST    @11,@AL00001                                        0247 00463000
         L     @15,GDTFPL(,@11)                                    0247 00464000
         LA    @01,@AL00001                                        0247 00465000
         BALR  @14,@15                                             0247 00466000
*        /************************************************************/ 00467000
*        /*                                                          */ 00468000
*        /*  RESET THE TEXT PROCESSING AREA BACK TO INITIAL DEFAULTS */ 00469000
*        /*  (DEFAULT PARAMETERS MAY HAVE BEEN OVERRIDDEN BY THE FSR)*/ 00470000
*        /*                                                          */ 00471000
*        /************************************************************/ 00472000
*                                                                  0248 00473000
*        CALL ICKTPRE0(GDTTBL,PRTFILE);                            0248 00474000
*                                                                  0248 00475000
*                                                                  0248 00476000
         L     @11,@PC00001                                        0248 00477000
         ST    @11,@AL00001                                        0248 00478000
         LA    @15,@CF00089                                        0248 00479000
         ST    @15,@AL00001+4                                      0248 00480000
         MVI   @AL00001+4,X'80'                                    0248 00481000
         L     @15,GDTRES(,@11)                                    0248 00482000
         LA    @01,@AL00001                                        0248 00483000
         BALR  @14,@15                                             0248 00484000
*        RETURN;                                                   0249 00485000
*                                                                  0249 00486000
@EL00004 DS    0H                                                  0249 00487000
@EF00004 DS    0H                                                  0249 00488000
@ER00004 LM    @14,@12,@SA00004                                    0249 00489000
         BR    @14                                                 0249 00490000
*        END CALLFSR;                                              0250 00491000
*                                                                  0250 00492000
*                                                                  0250 00493000
*      END MAIN;                                                   0251 00494000
*                                                                  0251 00495000
*                                                                  0251 00496000
*    END ICKEX01                                                   0252 00497000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00498000
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        * 00499000
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        * 00500000
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        * 00501000
*;                                                                 0252 00502000
@DATA    DS    0H                                                       00503000
@CH00263 DC    H'16'                                                    00504000
         DS    0F                                                       00505000
@AL00247 DC    A(@CC00479)             LIST WITH   2 ARGUMENT(S)        00506000
         DC    AL1(X'80')                                               00507000
         DC    AL3(@CC00132)                                            00508000
@DATD    DSECT                                                          00509000
         DS    0F                                                       00510000
@SA00001 DS    18F                                                      00511000
@PC00001 DS    1F                                                       00512000
@SA00002 DS    15F                                                      00513000
@SA00003 DS    14F                                                      00514000
@SA00004 DS    15F                                                      00515000
@AL00001 DS    7A                                                       00516000
@ZTEMPS  DS    C                                                        00517000
@ZTEMPND EQU   *                                                        00518000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00519000
ICKEX01  CSECT                                                          00520000
         DS    0F                                                       00521000
@CF00089 DC    F'0'                                                     00522000
@DATD    DSECT                                                          00523000
         DS    0D                                                       00524000
LISTSCAN DS    A                                                        00525000
IOCSPTR  DS    A                                                        00526000
OPNPTR   DS    A                                                        00527000
DDSTRU   DS    A                                                        00528000
FSADDR   DS    A                                                        00529000
DMPINDEX DS    A                                                        00530000
FTABPTR  DS    A                                                        00531000
LISTPTR  DS    A                                                        00532000
MAXCOND  DS    H                                                        00533000
LASTCOND DS    H                                                        00534000
SETRC    DS    H                                                        00535000
LISTLN   DS    FL1                                                      00536000
@TS00001 DS    CL95                                                     00537000
SWITCH   DS    BL1                                                      00538000
FSRNAME  DS    CL8                                                      00539000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00540000
@ENDDATD EQU   *                                                        00541000
ICKEX01  CSECT                                                          00542000
         DS    0F                                                       00543000
@SIZDATD DC    AL1(0)                                                   00544000
         DC    AL3(@ENDDATD-@DATD)                                      00545000
         DS    0D                                                       00546000
@CC00483 DC    C'ICKEX02 '                                              00547000
@CC00485 DC    C'ICKEX03 '                                              00548000
@CC00487 DC    C'ICKRI01 '                                              00549000
@CC00479 DC    C'EX00'                                                  00550000
@CC00495 DC    C'EXMN'                                                  00551000
@CC00499 DC    C'EX1M'                                                  00552000
@CC00505 DC    C'EX1R'                                                  00553000
@CC00506 DC    C'EXRI'                                                  00554000
@CC00510 DC    C'EX1F'                                                  00555000
@CC00511 DC    C'EXFS'                                                  00556000
@CC00132 DC    C'ALL'                                                   00557000
MODID    DC    CL4'EX01'                                                00558000
FIXAREA  DS    CL50                                                     00559000
         ORG   FIXAREA                                                  00560000
@NM00018 DC    50X'00'                                                  00561000
         ORG   FIXAREA+50                                               00562000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00563000
@01      EQU   01                                                       00564000
@02      EQU   02                                                       00565000
@03      EQU   03                                                       00566000
@04      EQU   04                                                       00567000
@05      EQU   05                                                       00568000
@06      EQU   06                                                       00569000
@07      EQU   07                                                       00570000
@08      EQU   08                                                       00571000
@09      EQU   09                                                       00572000
@10      EQU   10                                                       00573000
@11      EQU   11                                                       00574000
@12      EQU   12                                                       00575000
@13      EQU   13                                                       00576000
@14      EQU   14                                                       00577000
@15      EQU   15                                                       00578000
EOFCOND  EQU   @03                                                      00579000
TESTRC   EQU   @02                                                      00580000
RTNREG   EQU   @15                                                      00581000
REG0     EQU   @00                                                      00582000
REG1     EQU   @01                                                      00583000
REG10    EQU   @10                                                      00584000
REG11    EQU   @11                                                      00585000
REG12    EQU   @12                                                      00586000
REG13    EQU   @13                                                      00587000
REG14    EQU   @14                                                      00588000
REG15    EQU   @15                                                      00589000
REG2     EQU   @02                                                      00590000
REG3     EQU   @03                                                      00591000
REG4     EQU   @04                                                      00592000
REG5     EQU   @05                                                      00593000
REG6     EQU   @06                                                      00594000
REG7     EQU   @07                                                      00595000
REG8     EQU   @08                                                      00596000
REG9     EQU   @09                                                      00597000
ICKSACL0 EQU   0                                                        00598000
ICKSAEP0 EQU   0                                                        00599000
ICKSAFP0 EQU   0                                                        00600000
TRACE1   EQU   0                                                        00601000
OLDERID1 EQU   TRACE1                                                   00602000
TRACE2   EQU   0                                                        00603000
OLDERID2 EQU   TRACE2                                                   00604000
NEWID2   EQU   TRACE2+95                                                00605000
NEWERID2 EQU   5                                                        00606000
STAEPARM EQU   0                                                        00607000
STAEPFX  EQU   STAEPARM                                                 00608000
IOCSTR   EQU   0                                                        00609000
IOCDSO   EQU   IOCSTR+13                                                00610000
IOCRFM   EQU   IOCSTR+14                                                00611000
IOCMAC   EQU   IOCSTR+15                                                00612000
IOCMSG   EQU   IOCSTR+16                                                00613000
OPNAGL   EQU   0                                                        00614000
OPNOPT   EQU   OPNAGL                                                   00615000
OPNRFM   EQU   OPNAGL+1                                                 00616000
OPNTYP   EQU   OPNAGL+2                                                 00617000
OPNMOD   EQU   OPNAGL+3                                                 00618000
UVOLLIST EQU   0                                                        00619000
UVOLENT  EQU   UVOLLIST+2                                               00620000
ICKTPRE0 EQU   0                                                        00621000
DARGLIST EQU   0                                                        00622000
DARGSTID EQU   DARGLIST+8                                               00623000
DARGARY  EQU   DARGLIST+20                                              00624000
DARGINS  EQU   DARGARY                                                  00625000
DARGINL  EQU   DARGARY+2                                                00626000
FMTLIST  EQU   0                                                        00627000
FMTFLGS  EQU   FMTLIST                                                  00628000
FMTSPF   EQU   FMTLIST+2                                                00629000
FMTRFNO  EQU   FMTSPF                                                   00630000
FMTILEN  EQU   FMTRFNO                                                  00631000
FMTIOFF  EQU   FMTLIST+4                                                00632000
FMTTRBC  EQU   FMTIOFF                                                  00633000
FMTSTO   EQU   FMTTRBC                                                  00634000
FMTOCOL  EQU   FMTLIST+6                                                00635000
FMTCNVF  EQU   FMTLIST+10                                               00636000
ICKDB010 EQU   0                                                        00637000
DMPITM   EQU   0                                                        00638000
DMPARY   EQU   0                                                        00639000
FTABLE   EQU   0                                                        00640000
DMPTRM   EQU   0                                                        00641000
ICKDVCL0 EQU   0                                                        00642000
ICKDVIN0 EQU   0                                                        00643000
ICKDVON0 EQU   0                                                        00644000
ICKDVOP0 EQU   0                                                        00645000
ICKIOCL0 EQU   0                                                        00646000
ICKIOGT0 EQU   0                                                        00647000
ICKIOIT0 EQU   0                                                        00648000
ICKIOOP0 EQU   0                                                        00649000
ICKIOPT0 EQU   0                                                        00650000
ICKIOTM0 EQU   0                                                        00651000
ICKSADE0 EQU   0                                                        00652000
ICKSAFS0 EQU   0                                                        00653000
ICKSAGP0 EQU   0                                                        00654000
ICKSAGS0 EQU   0                                                        00655000
ICKSALD0 EQU   0                                                        00656000
ICKSAPR0 EQU   0                                                        00657000
ICKSASC0 EQU   0                                                        00658000
ICKSASN0 EQU   0                                                        00659000
ICKSAST0 EQU   0                                                        00660000
ICKSATI0 EQU   0                                                        00661000
ICKSAVC0 EQU   0                                                        00662000
ICKSAWO0 EQU   0                                                        00663000
ICKTPEA0 EQU   0                                                        00664000
ICKTPES0 EQU   0                                                        00665000
ICKTPPR0 EQU   0                                                        00666000
ICKTPRS0 EQU   0                                                        00667000
LISTTEST EQU   0                                                        00668000
NEWERID1 EQU   5                                                        00669000
GDTTBL   EQU   0                                                        00670000
GDTTR1   EQU   GDTTBL+8                                                 00671000
GDTTR2   EQU   GDTTBL+12                                                00672000
GDTDIN   EQU   GDTTBL+44                                                00673000
GDTDOP   EQU   GDTTBL+48                                                00674000
GDTDBG   EQU   GDTTBL+52                                                00675000
GDTDVO   EQU   GDTTBL+56                                                00676000
GDTPRT   EQU   GDTTBL+60                                                00677000
GDTESS   EQU   GDTTBL+64                                                00678000
GDTESA   EQU   GDTTBL+68                                                00679000
GDTRST   EQU   GDTTBL+72                                                00680000
GDTRES   EQU   GDTTBL+76                                                00681000
GDTCAL   EQU   GDTTBL+80                                                00682000
GDTGSP   EQU   GDTTBL+84                                                00683000
GDTFSP   EQU   GDTTBL+88                                                00684000
GDTGPL   EQU   GDTTBL+92                                                00685000
GDTFPL   EQU   GDTTBL+96                                                00686000
GDTLOD   EQU   GDTTBL+100                                               00687000
GDTDEL   EQU   GDTTBL+104                                               00688000
GDTPRL   EQU   GDTTBL+108                                               00689000
GDTEPL   EQU   GDTTBL+112                                               00690000
GDTTIM   EQU   GDTTBL+116                                               00691000
GDTIIO   EQU   GDTTBL+120                                               00692000
GDTTIO   EQU   GDTTBL+124                                               00693000
GDTOPN   EQU   GDTTBL+136                                               00694000
GDTCLS   EQU   GDTTBL+140                                               00695000
GDTGET   EQU   GDTTBL+144                                               00696000
GDTPUT   EQU   GDTTBL+148                                               00697000
GDTSNP   EQU   GDTTBL+160                                               00698000
GDTWTO   EQU   GDTTBL+168                                               00699000
GDTSCR   EQU   GDTTBL+172                                               00700000
GDTVCK   EQU   GDTTBL+176                                               00701000
GDTDVC   EQU   GDTTBL+180                                               00702000
GDTSTE   EQU   GDTTBL+188                                               00703000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00704000
GDTCVR   EQU   GDTTBL+184                                               00705000
GDTSPR   EQU   GDTTBL+164                                               00706000
GDTABH   EQU   GDTTBL+156                                               00707000
GDTABT   EQU   GDTTBL+152                                               00708000
GDTTOH   EQU   GDTTBL+132                                               00709000
GDTRIP   EQU   GDTTBL+128                                               00710000
GDTDVH   EQU   GDTTBL+40                                                00711000
GDTIOH   EQU   GDTTBL+36                                                00712000
GDTSAH   EQU   GDTTBL+32                                                00713000
GDTTPH   EQU   GDTTBL+28                                                00714000
GDTRIH   EQU   GDTTBL+24                                                00715000
GDTSTH   EQU   GDTTBL+20                                                00716000
GDTDBH   EQU   GDTTBL+16                                                00717000
GDTPRM   EQU   GDTTBL+4                                                 00718000
GDTHDR   EQU   GDTTBL                                                   00719000
@NM00017 EQU   DMPARY+15                                                00720000
DMPARYTP EQU   DMPARY+14                                                00721000
DMPARYEX EQU   DMPARY+12                                                00722000
DMPARYIC EQU   DMPARY+10                                                00723000
DMPARYSZ EQU   DMPARY+8                                                 00724000
DMPARYNM EQU   DMPARY                                                   00725000
@NM00016 EQU   DMPITM+15                                                00726000
DMPITMTP EQU   DMPITM+14                                                00727000
DMPITMLN EQU   DMPITM+12                                                00728000
DMPITMPT EQU   DMPITM+8                                                 00729000
DMPITMNM EQU   DMPITM                                                   00730000
@NM00015 EQU   FMTCNVF+1                                                00731000
FMTBS    EQU   FMTCNVF+1                                                00732000
FMTSS    EQU   FMTCNVF+1                                                00733000
FMTAL    EQU   FMTCNVF+1                                                00734000
FMTZS    EQU   FMTCNVF+1                                                00735000
@NM00014 EQU   FMTCNVF                                                  00736000
FMTPU    EQU   FMTCNVF                                                  00737000
FMTBD    EQU   FMTCNVF                                                  00738000
FMTBHD   EQU   FMTCNVF                                                  00739000
FMTBHA   EQU   FMTCNVF                                                  00740000
FMTBH    EQU   FMTCNVF                                                  00741000
FMTOLEN  EQU   FMTLIST+8                                                00742000
FMTRIO   EQU   FMTOCOL                                                  00743000
FMTSPT   EQU   FMTSTO                                                   00744000
FMTSTL   EQU   FMTILEN                                                  00745000
@NM00013 EQU   FMTFLGS+1                                                00746000
FMTHDF   EQU   FMTFLGS                                                  00747000
FMTDFF   EQU   FMTFLGS                                                  00748000
FMTSTF   EQU   FMTFLGS                                                  00749000
FMTREPF  EQU   FMTFLGS                                                  00750000
FMTBDF   EQU   FMTFLGS                                                  00751000
FMTIDF   EQU   FMTFLGS                                                  00752000
FMTSCF   EQU   FMTFLGS                                                  00753000
FMTEOLF  EQU   FMTFLGS                                                  00754000
DARGDTM  EQU   DARGARY+4                                                00755000
DARGPCT  EQU   DARGINL                                                  00756000
DARGREP  EQU   DARGINS                                                  00757000
@NM00012 EQU   DARGLIST+19                                              00758000
DARGIND  EQU   DARGLIST+18                                              00759000
DARGRETL EQU   DARGLIST+16                                              00760000
DARGCNT  EQU   DARGLIST+14                                              00761000
DARGILP  EQU   DARGLIST+12                                              00762000
DARGSENT EQU   DARGSTID+3                                               00763000
DARGSMOD EQU   DARGSTID                                                 00764000
DARGRETP EQU   DARGLIST+4                                               00765000
DARGDBP  EQU   DARGLIST                                                 00766000
UVOLVOL  EQU   UVOLENT+4                                                00767000
UVOLDEV  EQU   UVOLENT                                                  00768000
UVOLCNT  EQU   UVOLLIST                                                 00769000
OPNRSVD  EQU   OPNAGL+28                                                00770000
OPNVOL   EQU   OPNAGL+24                                                00771000
OPNBLK   EQU   OPNAGL+20                                                00772000
OPNREC   EQU   OPNAGL+16                                                00773000
OPNDSN   EQU   OPNAGL+12                                                00774000
OPNDDN   EQU   OPNAGL+8                                                 00775000
OPNIOC   EQU   OPNAGL+4                                                 00776000
@NM00011 EQU   OPNMOD                                                   00777000
OPNMODRC EQU   OPNMOD                                                   00778000
OPNMODAC EQU   OPNMOD                                                   00779000
@NM00010 EQU   OPNTYP                                                   00780000
OPNTYPSO EQU   OPNTYP                                                   00781000
OPNTYPSI EQU   OPNTYP                                                   00782000
@NM00009 EQU   OPNRFM                                                   00783000
OPNRFMBK EQU   OPNRFM                                                   00784000
OPNRFMSF EQU   OPNRFM                                                   00785000
OPNRFMUN EQU   OPNRFM                                                   00786000
OPNRFMVR EQU   OPNRFM                                                   00787000
OPNRFMFX EQU   OPNRFM                                                   00788000
@NM00008 EQU   OPNOPT                                                   00789000
OPNOPTJM EQU   OPNOPT                                                   00790000
OPNOPTKS EQU   OPNOPT                                                   00791000
OPNOPTBK EQU   OPNOPT                                                   00792000
OPNOPTUP EQU   OPNOPT                                                   00793000
OPNOPTOT EQU   OPNOPT                                                   00794000
OPNOPTIN EQU   OPNOPT                                                   00795000
IOCEXT   EQU   IOCSTR+36                                                00796000
IOCRRN   EQU   IOCSTR+32                                                00797000
@NM00007 EQU   IOCSTR+30                                                00798000
IOCPNM   EQU   IOCSTR+28                                                00799000
IOCCBP   EQU   IOCSTR+24                                                00800000
IOCDSN   EQU   IOCSTR+20                                                00801000
@NM00006 EQU   IOCSTR+17                                                00802000
@NM00005 EQU   IOCMSG                                                   00803000
IOCMSGOP EQU   IOCMSG                                                   00804000
IOCMACPA EQU   IOCMAC                                                   00805000
@NM00004 EQU   IOCMAC                                                   00806000
IOCMACBK EQU   IOCMAC                                                   00807000
IOCMACUP EQU   IOCMAC                                                   00808000
IOCMACOT EQU   IOCMAC                                                   00809000
IOCMACIN EQU   IOCMAC                                                   00810000
@NM00003 EQU   IOCRFM                                                   00811000
IOCRFMBK EQU   IOCRFM                                                   00812000
IOCRFMSF EQU   IOCRFM                                                   00813000
IOCRFMUN EQU   IOCRFM                                                   00814000
IOCRFMVR EQU   IOCRFM                                                   00815000
IOCRFMFX EQU   IOCRFM                                                   00816000
@NM00002 EQU   IOCDSO                                                   00817000
IOCDSOPS EQU   IOCDSO                                                   00818000
IOCKYL   EQU   IOCSTR+12                                                00819000
IOCTRN   EQU   IOCSTR+8                                                 00820000
IOCDLN   EQU   IOCSTR+4                                                 00821000
IOCDAD   EQU   IOCSTR                                                   00822000
STAEWORK EQU   STAEPARM+32                                              00823000
STARPTR  EQU   STAEPFX+28                                               00824000
STASPTR  EQU   STAEPFX+24                                               00825000
STALEN   EQU   STAEPFX+20                                               00826000
STAID    EQU   STAEPFX+16                                               00827000
STAEPA   EQU   STAEPFX+12                                               00828000
STAGDT   EQU   STAEPFX+8                                                00829000
STABPTR  EQU   STAEPFX+4                                                00830000
STAFPTR  EQU   STAEPFX                                                  00831000
NEWID1   EQU   TRACE1+95                                                00832000
CALLID   EQU   OLDERID1+90                                              00833000
@NM00001 EQU   OLDERID1                                                 00834000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00835000
@PB00002 EQU   @EL00001                                                 00836000
@ENDDATA EQU   *                                                        00837000
         END   ICKEX01,(C'PLS1708',0701,78192)                          00838000
