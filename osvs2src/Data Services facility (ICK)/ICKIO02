         TITLE '*************     ICKIO02  OPEN-CLOSE ROUTINES     *****00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
ICKIO02  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'ICKIO02   78.192'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @09,0                                               0002 00021000
@PSTART  LA    @10,4095(,@09)                                      0002 00022000
         LA    @12,4095(,@10)                                      0002 00023000
         USING @PSTART,@09                                         0002 00024000
         USING @PSTART+4095,@10                                    0002 00025000
         USING @PSTART+8190,@12                                    0002 00026000
         L     @00,@SIZDATD                                        0002 00027000
         GETMAIN  R,LV=(0)                                              00028000
         LR    @11,@01                                             0002 00029000
         USING @DATD,@11                                           0002 00030000
         ST    @13,@SA00001+4                                      0002 00031000
         LM    @00,@01,20(@13)                                     0002 00032000
         ST    @11,8(,@13)                                         0002 00033000
         LR    @13,@11                                             0002 00034000
         MVC   @PC00001(8),0(@01)                                  0002 00035000
*                                                                  0249 00036000
*        /************************************************************/ 00037000
*        /*                                                          */ 00038000
*        /* INITIALIZE THE RETURN CODE THAT IS RETURNED TO IO01.     */ 00039000
*        /*                                                          */ 00040000
*        /************************************************************/ 00041000
*                                                                  0250 00042000
*        TESTRC = 0;                                               0250 00043000
*                                                                  0250 00044000
         SLR   @08,@08                                             0250 00045000
         STH   @08,TESTRC                                          0250 00046000
*        /************************************************************/ 00047000
*        /*                                                          */ 00048000
*        /* INITIALIZE THE EXIT LIST FOR   DATA SETS                 */ 00049000
*        /*                                                          */ 00050000
*        /************************************************************/ 00051000
*                                                                  0251 00052000
*        DCBTLIST = DCBTLSTA;                                      0251 00053000
*                                                                  0251 00054000
         MVC   DCBTLIST(8),DCBTLSTA                                0251 00055000
*        /************************************************************/ 00056000
*        /*                                                          */ 00057000
*        /* INITIALIZE ERROR MESSAGE ARGUMENT LIST                   */ 00058000
*        /*                                                          */ 00059000
*        /************************************************************/ 00060000
*                                                                  0252 00061000
*        DDSTRU = ADDR (DMSGARG);                                  0252 00062000
         LA    @08,DMSGARG                                         0252 00063000
         ST    @08,DDSTRU                                          0252 00064000
*        DMSGARG = ''B;                                            0253 00065000
         XC    DMSGARG(44),DMSGARG                                 0253 00066000
*        DARGSMOD = 'IO0';                                         0254 00067000
*                                                                  0254 00068000
         MVC   DARGSMOD(3,@08),@CC00957                            0254 00069000
*        /************************************************************/ 00070000
*        /*                                                          */ 00071000
*        /* IF THE REQUEST IS OPEN, CONTROL BLOCKS ARE BUILT AND     */ 00072000
*        /* THE DATA SETS ARE OPENED.                                */ 00073000
*        /*                                                          */ 00074000
*        /************************************************************/ 00075000
*                                                                  0255 00076000
*        IF OCATYP = OCATYPOP                                      0255 00077000
*          THEN                                                    0255 00078000
         L     @08,@PC00001+4                                      0255 00079000
         CLI   OCATYP(@08),1                                       0255 00080000
         BNE   @RF00255                                            0255 00081000
*            DO;                                                   0256 00082000
*              CALL OPENRTN;                                       0257 00083000
         BAL   @14,OPENRTN                                         0257 00084000
*              RESPECIFY RTNREG RSTD;                              0258 00085000
*              TESTRC = RTNREG;                                    0259 00086000
         STH   RTNREG,TESTRC                                       0259 00087000
*              RESPECIFY RTNREG UNRSTD;                            0260 00088000
*            END;                                                  0261 00089000
*                                                                  0261 00090000
*        /************************************************************/ 00091000
*        /*                                                          */ 00092000
*        /* IF THE REQUEST IS CLOSE, THE CONTROL BLOCK AND WORKAREA  */ 00093000
*        /* STORAGE IS RELEASED AND THE DATA SETS ARE CLOSED.        */ 00094000
*        /*                                                          */ 00095000
*        /************************************************************/ 00096000
*                                                                  0262 00097000
*        IF OCATYP = OCATYPCL                                      0262 00098000
*          THEN                                                    0262 00099000
@RF00255 L     @08,@PC00001+4                                      0262 00100000
         CLI   OCATYP(@08),2                                       0262 00101000
         BNE   @RF00262                                            0262 00102000
*            DO;                                                   0263 00103000
*              CALL CLOSERTN;                                      0264 00104000
         BAL   @14,CLOSERTN                                        0264 00105000
*              RESPECIFY RTNREG RSTD;                              0265 00106000
*              TESTRC = RTNREG;                                    0266 00107000
         STH   RTNREG,TESTRC                                       0266 00108000
*              RESPECIFY RTNREG UNRSTD;                            0267 00109000
*            END;                                                  0268 00110000
*                                                                  0268 00111000
*        /************************************************************/ 00112000
*        /*                                                          */ 00113000
*        /* CONTROL RETURNS TO THE MAIN I/O ROUTINE WITH HIGHEST     */ 00114000
*        /* ERROR CODE ENCOUNTERED RETURNED.                         */ 00115000
*        /*                                                          */ 00116000
*        /************************************************************/ 00117000
*                                                                  0269 00118000
*        CALL ICKSAEP0(GDTTBL,MODID,TESTRC);                       0269 00119000
@RF00262 L     @08,@PC00001                                        0269 00120000
         ST    @08,@AL00001                                        0269 00121000
         LA    @15,MODID                                           0269 00122000
         ST    @15,@AL00001+4                                      0269 00123000
         LA    @15,TESTRC                                          0269 00124000
         ST    @15,@AL00001+8                                      0269 00125000
         MVI   @AL00001+8,X'80'                                    0269 00126000
         L     @15,GDTEPL(,@08)                                    0269 00127000
         LA    @01,@AL00001                                        0269 00128000
         BALR  @14,@15                                             0269 00129000
*                                                                  0270 00130000
*        /************************************************************/ 00131000
*        /*                                                          */ 00132000
*        /* PROCEDURE NAME - OPENRTN                                 */ 00133000
*        /*                                                          */ 00134000
*        /* FUNCTION - THIS PROCEDURE BUILDS THE IOCSTR AND          */ 00135000
*        /*            RETURNS THE ADDRESS TO THE CALLER.  CALLS     */ 00136000
*        /*            ARE ISSUED TO OTHER INTERNAL PROCEDURES TO    */ 00137000
*        /*            BUILD ALL REQUIRED OPEN CONTROL BLOCKS.       */ 00138000
*        /*            THE DATA SETS ARE THEN OPENED AND OPEN        */ 00139000
*        /*            CHECKING IS PERFORMED.                        */ 00140000
*        /*                                                          */ 00141000
*        /* INPUT -     OCARRAY DEFINING THE DATES TO BE OPENED.     */ 00142000
*        /*                                                          */ 00143000
*        /* OUTPUT -   CONTROL BLOCKS ARE BUILT, DATA SETS ARE       */ 00144000
*        /*            OPENED, ERROR DATE IS SET AND A RETURNED      */ 00145000
*        /*            IS RETURNED TO THE MAIN PROCEDURE.            */ 00146000
*        /*                                                          */ 00147000
*        /* ERRORS -   1. NO STORAGE FOR IOCSTR.                     */ 00148000
*        /*            2. ERROR FROM EXTERNAL DATE SET OPEN.         */ 00149000
*        /*                                                          */ 00150000
*        /************************************************************/ 00151000
*                                                                  0270 00152000
*OPENRTN:  PROC;                                                   0270 00153000
*                                                                  0270 00154000
         B     @PB00002                                            0270 00155000
OPENRTN  STM   @14,@12,@SA00002                                    0270 00156000
*        /************************************************************/ 00157000
*        /*                                                          */ 00158000
*        /* DECLARES USED ONLY BY THIS PROCEDURE                     */ 00159000
*        /*                                                          */ 00160000
*        /************************************************************/ 00161000
*                                                                  0271 00162000
*        /* RETURN CODE                                              */ 00163000
*        DCL OPENRC FIXED (15);                                    0271 00164000
*                                                                  0271 00165000
*        /* OPEN FLAGS                                               */ 00166000
*        DCL 1 OFLAGS BIT (8),                                     0272 00167000
*              2 ALROPEN BIT (1),      /* DATA SET ALREADY OPEN      */ 00168000
*              2 CKSYSIN BIT (1),      /* SYSTEM INPUT DNAME         */ 00169000
*              2 CKSYSOT BIT (1);      /* SYSTEM OUTPUT DNAME        */ 00170000
*                                                                  0272 00171000
*        /* COUNTER FOR EXTERNAL DATA SET SEARCH                     */ 00172000
*        DCL CKXTN FIXED (15);                                     0273 00173000
*                                                                  0273 00174000
*        /* EXTERNAL DATA SET ARGUMENT LIST                          */ 00175000
*        DCL 1 XTNLIST BASED (IODXTN),                             0274 00176000
*              2 XTNNUM FIXED (31),    /* NUMBER OF ENTRIES          */ 00177000
*              2 XTNENT (*),                                       0274 00178000
*                3 XDPTR PTR (31),     /* NAME POINTER               */ 00179000
*                3 XTNADR PTR (31),    /* ENTRY POINT ADDRESS        */ 00180000
*                3 XTNPRM FIXED (31);  /* PARAMETER                  */ 00181000
*                                                                  0274 00182000
*        /* POINTER TO THE NAME FIELD FOR OPEN                       */ 00183000
*        DCL XDADDR PTR (31);                                      0275 00184000
*                                                                  0275 00185000
*        /* EXTERNAL NAME TO BE PROCESSED BY EXTERNAL ROUTINE        */ 00186000
*        DCL 1 XTFIELD BDY (WORD) BASED (XDADDR),                  0276 00187000
*              2 XTFTYPE CHAR (2),     /* TYPE OF NAME               */ 00188000
*              2 XTNAME CHAR (8);      /* EXTERNAL PROCESSES DDNAME  */ 00189000
*                                                                  0276 00190000
*        /* ARGUMENT LIST PASSED TO OPEN SVC                         */ 00191000
*        DCL 1 OPENLIST BDY (WORD) BIT (128),                      0277 00192000
*              2 OPCBADDR (4) PTR (31),/* CONTROL BLOCK ADDRESS      */ 00193000
*                3 OPLEND BIT (1);     /* END OF LIST INDICATOR      */ 00194000
*                                                                  0277 00195000
*                                                                  0277 00196000
*        /* OPEN TYPE J ARGUMENT LIST                                */ 00197000
*        DCL 1 TJOPLIST BDY(WORD) BIT(128),                        0278 00198000
*              2 TJCBAD (4) PTR (31),                              0278 00199000
*                3 TJLEND BIT(1);                                  0278 00200000
*                                                                  0278 00201000
*        /* COUNTER OF NUMBER OF DATA SETS TO OPEN TYPE=J            */ 00202000
*        DCL TJNUMOP FIXED(15);                                    0279 00203000
*                                                                  0279 00204000
*        /* DATA CONTROL BLOCK (DCB) ADDRESS                         */ 00205000
*        DCL RETCBADR PTR(31);                                     0280 00206000
*        /* INITIALIZE DATA SET NAME IN IOCSTR TO BLANKS             */ 00207000
*        DCL BLANKDSN CHAR (44) BASED (IOCDSN);                    0281 00208000
*                                                                  0281 00209000
*        /* LENGTH OF STORAGE REQUIRED FOR IOCSTR PREFIX, IOCSTR     */ 00210000
*        /* IOCSEX AND DATA SET NAME                                 */ 00211000
*        DCL SIZEIOCS FIXED (31)                                   0282 00212000
*          INIT (LENGTH (IOCSPRE) + LENGTH (IOCSTR) +              0282 00213000
*                LENGTH (IOCSEX) + LENGTH (BLANKDSN));             0282 00214000
*                                                                  0282 00215000
*        /* IOCS PRE FIX  - CONTAINS CHARACTER STRING IOCS           */ 00216000
*        DCL IOCSPRE CHAR (4) BASED (IOCSPTR);                     0283 00217000
*                                                                  0283 00218000
*        /* OFFSET OF THE DATA SET NAME FROM BEGINNING OF IOCSTR     */ 00219000
*        DCL LENTODSN FIXED (15)                                   0284 00220000
*          INIT(LENGTH(IOCSTR) + LENGTH(IOCSEX));                  0284 00221000
*                                                                  0284 00222000
*        /* COUNTER OF NUMBER OF DATA SET TO OPEN                    */ 00223000
*        DCL NUMOPEN FIXED (15);                                   0285 00224000
*                                                                  0285 00225000
*        /* COUNTER OF CONTROL BLOCKS                                */ 00226000
*        DCL OPNCTR FIXED (15);                                    0286 00227000
*                                                                  0286 00228000
*        /* RETURN IOCS ADDRESS TO USER STORAGE                      */ 00229000
*        DCL RETIOCS PTR (31) BASED (OPNIOC);                      0287 00230000
*                                                                  0287 00231000
*        /* DNAME SUPPLIED BY THE USER                               */ 00232000
*        DCL OPDNAME CHAR (8) BASED (OPNDDN);                      0288 00233000
*                                                                  0288 00234000
*        /* DNAME OF DATA SET TO OPEN                                */ 00235000
*        DCL DTOOPEN CHAR (8);                                     0289 00236000
*                                                                  0289 00237000
*        /* ADDRESS OF NEXT IOCS TO BE PLACED IN CHAIN               */ 00238000
*        DCL NEXTADDR PTR (31);                                    0290 00239000
*                                                                  0290 00240000
*        /* SAVE RETURN CODE FROM THE OPEN SVC                       */ 00241000
*        DCL OPAMRC FIXED (15);                                    0291 00242000
*                                                                  0292 00243000
*        /************************************************************/ 00244000
*        /*                                                          */ 00245000
*        /* OPEN ALL DATA SETS DEFINED BY OPNAGL S                   */ 00246000
*        /*                                                          */ 00247000
*        /***********************************************************/  00248000
*                                                                  0292 00249000
*        OPENRC = 0;                                               0292 00250000
         SLR   @08,@08                                             0292 00251000
         STH   @08,OPENRC                                          0292 00252000
*        NUMOPEN = 0;                                              0293 00253000
         SLR   NUMOPEN,NUMOPEN                                     0293 00254000
*        TJNUMOP = 0;                                              0294 00255000
*                                                                  0294 00256000
         STH   @08,TJNUMOP                                         0294 00257000
*CKOLIST:                                                          0295 00258000
*        DO OPNCTR = 1 TO OCANUM;                                  0295 00259000
*                                                                  0295 00260000
CKOLIST  LA    @08,1                                               0295 00261000
         B     @DE00295                                            0295 00262000
@DL00295 DS    0H                                                  0296 00263000
*          /**********************************************************/ 00264000
*          /*                                                        */ 00265000
*          /* SET ADDRESSIBILITY TO THE OPNAGL.                      */ 00266000
*          /* INITIALIZE RETURN CODE USED FOR THIS DATA SET ONLY.    */ 00267000
*          /* INIT FLAG THAT DATA SET IS NOT ALREADY OPEN.           */ 00268000
*          /*                                                        */ 00269000
*          /**********************************************************/ 00270000
*                                                                  0296 00271000
*          OPNPTR = OCADDR (OPNCTR);                               0296 00272000
         SLA   @08,2                                               0296 00273000
         L     @15,@PC00001+4                                      0296 00274000
         L     OPNPTR,OCADDR-4(@08,@15)                            0296 00275000
*          TESTRC = 0;                                             0297 00276000
         SLR   @08,@08                                             0297 00277000
         STH   @08,TESTRC                                          0297 00278000
*          OFLAGS = '00'X;                                         0298 00279000
*                                                                  0298 00280000
         MVI   OFLAGS,X'00'                                        0298 00281000
*          /**********************************************************/ 00282000
*          /*                                                        */ 00283000
*          /* IF THE SYSTEM DNAME FOR INPUT (SYSIN/SYSIPT) OR        */ 00284000
*          /* OUTPUT (SYSPRINT/SYSLST) IS SPECIFIED THE DATA         */ 00285000
*          /* WILL BE READ TO OR WRITTEN FROM THE SYSTEM DATA SET.   */ 00286000
*          /*                                                        */ 00287000
*          /**********************************************************/ 00288000
*                                                                  0299 00289000
*          IF OPNDDN ^= NULLPTR                                    0299 00290000
*            THEN                                                  0299 00291000
         L     @15,OPNDDN(,OPNPTR)                                 0299 00292000
         CR    @15,@08                                             0299 00293000
         BE    @RF00299                                            0299 00294000
*              DO;                                                 0300 00295000
*                                                                  0300 00296000
*                IF OPDNAME (1:8) = INFILE (1:8)                   0301 00297000
*                  THEN                                            0301 00298000
         CLC   OPDNAME(8,@15),INFILE                               0301 00299000
         BNE   @RF00301                                            0301 00300000
*                    CKSYSIN = ON;                                 0302 00301000
         OI    CKSYSIN,B'01000000'                                 0302 00302000
*                IF OPDNAME (1:8) = OUTFILE (1:8)                  0303 00303000
*                  THEN                                            0303 00304000
@RF00301 L     @08,OPNDDN(,OPNPTR)                                 0303 00305000
         CLC   OPDNAME(8,@08),OUTFILE                              0303 00306000
         BNE   @RF00303                                            0303 00307000
*                    CKSYSOT = ON;                                 0304 00308000
*                                                                  0304 00309000
         OI    CKSYSOT,B'00100000'                                 0304 00310000
*              END;                                                0305 00311000
*                                                                  0305 00312000
@RF00303 DS    0H                                                  0306 00313000
*          /**********************************************************/ 00314000
*          /*                                                        */ 00315000
*          /* IF DATA SET IS SYSTEM INPUT CHECK IF ALREADY OPEN.     */ 00316000
*          /*                                                        */ 00317000
*          /**********************************************************/ 00318000
*                                                                  0306 00319000
*          IF OPNTYPSI = ON | CKSYSIN = ON                         0306 00320000
*            THEN                                                  0306 00321000
@RF00299 TM    OPNTYPSI(OPNPTR),B'10000000'                        0306 00322000
         BO    @RT00306                                            0306 00323000
         TM    CKSYSIN,B'01000000'                                 0306 00324000
         BNO   @RF00306                                            0306 00325000
@RT00306 DS    0H                                                  0307 00326000
*SYSINPUT:     DO;                                                 0307 00327000
*                                                                  0307 00328000
SYSINPUT DS    0H                                                  0308 00329000
*                IF IODICS ^= NULLPTR                              0308 00330000
*                  THEN                                            0308 00331000
*                                                                  0308 00332000
         L     @08,@PC00001                                        0308 00333000
         L     @08,GDTIOH(,@08)                                    0308 00334000
         L     @08,IODICS(,@08)                                    0308 00335000
         LTR   @08,@08                                             0308 00336000
         BZ    @RF00308                                            0308 00337000
*                    /************************************************/ 00338000
*                    /*                                              */ 00339000
*                    /* IF DATA SET IS ALREADY OPEN RETURN IOCS ADD  */ 00340000
*                    /* TO CALLER AND SET OPEN INDICATOR.            */ 00341000
*                    /*                                              */ 00342000
*                    /************************************************/ 00343000
*                                                                  0309 00344000
*                    DO;                                           0309 00345000
*                      RETIOCS = IODICS;                           0310 00346000
         L     @01,OPNIOC(,OPNPTR)                                 0310 00347000
         ST    @08,RETIOCS(,@01)                                   0310 00348000
*                      ALROPEN = ON;                               0311 00349000
         OI    ALROPEN,B'10000000'                                 0311 00350000
*                    END;                                          0312 00351000
*                                                                  0312 00352000
*                  ELSE                                            0313 00353000
*                                                                  0313 00354000
*                    /************************************************/ 00355000
*                    /*                                              */ 00356000
*                    /* NOT OPEN - SET INPUT OPTION AND DEFAULT DNAME*/ 00357000
*                    /*                                              */ 00358000
*                    /************************************************/ 00359000
*                                                                  0313 00360000
*                    DTOOPEN (1:8) = INFILE (1:8);                 0313 00361000
*                                                                  0313 00362000
         B     @RC00308                                            0313 00363000
@RF00308 MVC   DTOOPEN(8),INFILE                                   0313 00364000
*              END SYSINPUT;                                       0314 00365000
*                                                                  0314 00366000
@RC00308 DS    0H                                                  0315 00367000
*          /**********************************************************/ 00368000
*          /*                                                        */ 00369000
*          /* IF DATA SET SYSTEM OUTPUT CHECK IF ALREADY OPEN.       */ 00370000
*          /*                                                        */ 00371000
*          /**********************************************************/ 00372000
*                                                                  0315 00373000
*          IF OPNTYPSO = ON | CKSYSOT = ON                         0315 00374000
*            THEN                                                  0315 00375000
@RF00306 TM    OPNTYPSO(OPNPTR),B'01000000'                        0315 00376000
         BO    @RT00315                                            0315 00377000
         TM    CKSYSOT,B'00100000'                                 0315 00378000
         BNO   @RF00315                                            0315 00379000
@RT00315 DS    0H                                                  0316 00380000
*SYSOTPUT:     DO;                                                 0316 00381000
*                                                                  0316 00382000
SYSOTPUT DS    0H                                                  0317 00383000
*                IF IODOCS ^= NULLPTR                              0317 00384000
*                  THEN                                            0317 00385000
*                                                                  0317 00386000
         L     @08,@PC00001                                        0317 00387000
         L     @08,GDTIOH(,@08)                                    0317 00388000
         L     @08,IODOCS(,@08)                                    0317 00389000
         LTR   @08,@08                                             0317 00390000
         BZ    @RF00317                                            0317 00391000
*                    /************************************************/ 00392000
*                    /*                                              */ 00393000
*                    /* IF DATA SET ALREADY OPEN RETURN IOCS         */ 00394000
*                    /* ADDRESS TO CALLER AND SET OPENED INDICATOR   */ 00395000
*                    /*                                              */ 00396000
*                    /************************************************/ 00397000
*                                                                  0318 00398000
*                    DO;                                           0318 00399000
*                      RETIOCS = IODOCS;                           0319 00400000
         L     @01,OPNIOC(,OPNPTR)                                 0319 00401000
         ST    @08,RETIOCS(,@01)                                   0319 00402000
*                      ALROPEN = ON;                               0320 00403000
         OI    ALROPEN,B'10000000'                                 0320 00404000
*                    END;                                          0321 00405000
*                                                                  0321 00406000
*                  ELSE                                            0322 00407000
*                                                                  0322 00408000
*                    /************************************************/ 00409000
*                    /*                                              */ 00410000
*                    /* DATA SET NOT OPEN - SET OUTPUT OPTION        */ 00411000
*                    /* AND DEFAULT DNAME.                           */ 00412000
*                    /*                                              */ 00413000
*                    /************************************************/ 00414000
*                                                                  0322 00415000
*                    DTOOPEN (1:8) = OUTFILE (1:8);                0322 00416000
*                                                                  0322 00417000
         B     @RC00317                                            0322 00418000
@RF00317 MVC   DTOOPEN(8),OUTFILE                                  0322 00419000
*              END SYSOTPUT;                                       0323 00420000
*                                                                  0323 00421000
@RC00317 DS    0H                                                  0324 00422000
*          /**********************************************************/ 00423000
*          /*                                                        */ 00424000
*          /* IF DATA SET NOT ALREADY OPEN THEN AN IOCS MUST BE BUILT*/ 00425000
*          /*                                                        */ 00426000
*          /**********************************************************/ 00427000
*                                                                  0324 00428000
*          IF ALROPEN = OFF                                        0324 00429000
*            THEN                                                  0324 00430000
@RF00315 TM    ALROPEN,B'10000000'                                 0324 00431000
         BNZ   @RF00324                                            0324 00432000
*BLDIOCS:      DO;                                                 0325 00433000
*                                                                  0325 00434000
BLDIOCS  DS    0H                                                  0326 00435000
*                /****************************************************/ 00436000
*                /*                                                  */ 00437000
*                /* SAVE DNAME IF IT HAS NOT ALREADY BEEN SAVED      */ 00438000
*                /*                                                  */ 00439000
*                /****************************************************/ 00440000
*                                                                  0326 00441000
*                IF OPNTYPSI = OFF & OPNTYPSO = OFF                0326 00442000
*                  THEN                                            0326 00443000
         TM    OPNTYPSI(OPNPTR),B'11000000'                        0326 00444000
         BNZ   @RF00326                                            0326 00445000
*                    DTOOPEN (1:8) = OPDNAME (1:8);                0327 00446000
*                                                                  0327 00447000
         L     @08,OPNDDN(,OPNPTR)                                 0327 00448000
         MVC   DTOOPEN(8),OPDNAME(@08)                             0327 00449000
*                /****************************************************/ 00450000
*                /*                                                  */ 00451000
*                /* SET IOCSPTR TO ZERO.  IF NO STORAGE IS           */ 00452000
*                /* AVAILABLE THE PRINT ROUTINE WILL PRINT THE       */ 00453000
*                /* DNAME SINCE THERE IS NO DATA SET NAME YET.       */ 00454000
*                /*                                                  */ 00455000
*                /****************************************************/ 00456000
*                                                                  0328 00457000
*                IOCSPTR = NULLPTR;                                0328 00458000
*                                                                  0328 00459000
@RF00326 SLR   @08,@08                                             0328 00460000
         ST    @08,IOCSPTR                                         0328 00461000
*                /****************************************************/ 00462000
*                /*                                                  */ 00463000
*                /* GET A STORAGE POOL WITH A UNIQUE POOL ID.        */ 00464000
*                /*                                                  */ 00465000
*                /****************************************************/ 00466000
*                                                                  0329 00467000
*                IODINC = IODINC + 1;                              0329 00468000
*                                                                  0329 00469000
         L     @08,@PC00001                                        0329 00470000
         L     @15,GDTIOH(,@08)                                    0329 00471000
         LA    @14,1                                               0329 00472000
         AH    @14,IODINC(,@15)                                    0329 00473000
         STH   @14,IODINC(,@15)                                    0329 00474000
*                CALL ICKSAGP0 (GDTTBL,SIZEIOCS,IOCSPTR,IODSID,SETZERO) 00475000
         ST    @08,@AL00001                                        0330 00476000
         LA    @14,SIZEIOCS                                        0330 00477000
         ST    @14,@AL00001+4                                      0330 00478000
         LA    @14,IOCSPTR                                         0330 00479000
         ST    @14,@AL00001+8                                      0330 00480000
         LA    @15,IODSID(,@15)                                    0330 00481000
         ST    @15,@AL00001+12                                     0330 00482000
         LA    @15,@CC00141                                        0330 00483000
         ST    @15,@AL00001+16                                     0330 00484000
         MVI   @AL00001+16,X'80'                                   0330 00485000
         L     @15,GDTGPL(,@08)                                    0330 00486000
         LA    @01,@AL00001                                        0330 00487000
         BALR  @14,@15                                             0330 00488000
*                RESPECIFY RTNREG RSTD;                            0331 00489000
*                TESTRC = RTNREG;                                  0332 00490000
         STH   RTNREG,TESTRC                                       0332 00491000
*                RESPECIFY RTNREG UNRSTD;                          0333 00492000
*                                                                  0333 00493000
*                IF TESTRC = 4                                     0334 00494000
*                  THEN                                            0334 00495000
*                                                                  0334 00496000
         LH    @08,TESTRC                                          0334 00497000
         C     @08,@CF00040                                        0334 00498000
         BNE   @RF00334                                            0334 00499000
*                    /************************************************/ 00500000
*                    /*                                              */ 00501000
*                    /* IF STORAGE WAS NOT AVAILABLE SET ERROR DATA  */ 00502000
*                    /* PRINT MESSAGE AND RETURN                     */ 00503000
*                    /*                                              */ 00504000
*                    /************************************************/ 00505000
*                                                                  0335 00506000
*                    DO;                                           0335 00507000
*                      DARGSMOD = 'UV0';                           0336 00508000
         L     @08,DDSTRU                                          0336 00509000
         MVC   DARGSMOD(3,@08),@CC01006                            0336 00510000
*                      DARGSENT = NOCRSTID;                        0337 00511000
         MVI   DARGSENT(@08),X'04'                                 0337 00512000
*                      CALL BLDOCMSG (DTOOPEN);                    0338 00513000
         LA    @08,DTOOPEN                                         0338 00514000
         ST    @08,@AL00001                                        0338 00515000
         LA    @01,@AL00001                                        0338 00516000
         BAL   @14,BLDOCMSG                                        0338 00517000
*                      RETURN CODE (4);                            0339 00518000
         LA    @15,4                                               0339 00519000
         L     @14,@SA00002                                        0339 00520000
         LM    @00,@12,@SA00002+8                                  0339 00521000
         BR    @14                                                 0339 00522000
*                    END;                                          0340 00523000
*                                                                  0340 00524000
*                /****************************************************/ 00525000
*                /*                                                  */ 00526000
*                /* SET IOCS PREFIX CHARACTER STRING AND             */ 00527000
*                /* ADDRESSIBILITY TO IOCSTR.                        */ 00528000
*                /*                                                  */ 00529000
*                /****************************************************/ 00530000
*                                                                  0341 00531000
*                IOCSPRE = 'IOCS';                                 0341 00532000
@RF00334 L     @08,IOCSPTR                                         0341 00533000
         MVC   IOCSPRE(4,@08),@CC01008                             0341 00534000
*                IOCSPTR = IOCSPTR + LENGTH (IOCSPRE);             0342 00535000
*                                                                  0342 00536000
         AL    @08,@CF00040                                        0342 00537000
         ST    @08,IOCSPTR                                         0342 00538000
*                /****************************************************/ 00539000
*                /*                                                  */ 00540000
*                /* IOCS IS BUILT AND INITIALIZED TO ZERO.           */ 00541000
*                /* SET ADDRESSIBILITY TO EXTENTION, RETURN THE      */ 00542000
*                /* IOCS ADDRESS TO THE CALLER AND SAVE POOL ID.     */ 00543000
*                /*                                                  */ 00544000
*                /****************************************************/ 00545000
*                                                                  0343 00546000
*                RETIOCS = IOCSPTR;                                0343 00547000
         L     @01,OPNIOC(,OPNPTR)                                 0343 00548000
         ST    @08,RETIOCS(,@01)                                   0343 00549000
*                IOCEXT = IOCSPTR + LENGTH (IOCSTR);               0344 00550000
         LA    @15,40                                              0344 00551000
         ALR   @15,@08                                             0344 00552000
         ST    @15,IOCEXT(,@08)                                    0344 00553000
*                IOCDSN = IOCSPTR + LENTODSN;                      0345 00554000
         LH    @14,LENTODSN                                        0345 00555000
         ALR   @14,@08                                             0345 00556000
         ST    @14,IOCDSN(,@08)                                    0345 00557000
*                BLANKDSN = ' ';                                   0346 00558000
         MVI   BLANKDSN+1(@14),C' '                                0346 00559000
         MVC   BLANKDSN+2(42,@14),BLANKDSN+1(@14)                  0346 00560000
         MVI   BLANKDSN(@14),C' '                                  0346 00561000
*                IOCSID (1:4) = IODSID (1:4);                      0347 00562000
*                                                                  0347 00563000
         L     @14,@PC00001                                        0347 00564000
         L     @14,GDTIOH(,@14)                                    0347 00565000
         MVC   IOCSID(4,@15),IODSID(@14)                           0347 00566000
*                /****************************************************/ 00567000
*                /*                                                  */ 00568000
*                /* IF DATA SET IS SYSTEM INPUT,  SAVE IOCS ADDRESS  */ 00569000
*                /*                                                  */ 00570000
*                /****************************************************/ 00571000
*                                                                  0348 00572000
*                IF OPNTYPSI = ON                                  0348 00573000
*                  THEN                                            0348 00574000
         TM    OPNTYPSI(OPNPTR),B'10000000'                        0348 00575000
         BNO   @RF00348                                            0348 00576000
*                    DO;                                           0349 00577000
*                      IODICS = IOCSPTR;                           0350 00578000
         ST    @08,IODICS(,@14)                                    0350 00579000
*                      IOCINFND = ON;                              0351 00580000
         OI    IOCINFND(@15),B'00100000'                           0351 00581000
*                    END;                                          0352 00582000
*                                                                  0352 00583000
*                /****************************************************/ 00584000
*                /*                                                  */ 00585000
*                /* IF DATA SET IS SYSTEM OUTPUT, SAVE IOCS ADDRESS  */ 00586000
*                /*                                                  */ 00587000
*                /****************************************************/ 00588000
*                                                                  0353 00589000
*                IF OPNTYPSO = ON                                  0353 00590000
*                  THEN                                            0353 00591000
@RF00348 TM    OPNTYPSO(OPNPTR),B'01000000'                        0353 00592000
         BNO   @RF00353                                            0353 00593000
*                    DO;                                           0354 00594000
*                      IODOCS = IOCSPTR;                           0355 00595000
         L     @08,IOCSPTR                                         0355 00596000
         L     @15,@PC00001                                        0355 00597000
         L     @01,GDTIOH(,@15)                                    0355 00598000
         ST    @08,IODOCS(,@01)                                    0355 00599000
*                      IOCFLGSP = ON;                              0356 00600000
         L     @08,IOCEXT(,@08)                                    0356 00601000
         OI    IOCFLGSP(@08),B'00000010'                           0356 00602000
*                    END;                                          0357 00603000
*                                                                  0357 00604000
*                /****************************************************/ 00605000
*                /*                                                  */ 00606000
*                /* UPDATE IOCS CONTROL BLOCK CHAIN.                 */ 00607000
*                /* IF FIRST IOCS BUILT - SET ADDRESS IN IODATA.     */ 00608000
*                /*                                                  */ 00609000
*                /****************************************************/ 00610000
*                                                                  0358 00611000
*                IF IODIOC = NULLPTR                               0358 00612000
*                  THEN                                            0358 00613000
@RF00353 L     @08,@PC00001                                        0358 00614000
         L     @08,GDTIOH(,@08)                                    0358 00615000
         L     @15,IODIOC(,@08)                                    0358 00616000
         LTR   @15,@15                                             0358 00617000
         BNZ   @RF00358                                            0358 00618000
*                    IODIOC = IOCSPTR;                             0359 00619000
*                                                                  0359 00620000
         L     @15,IOCSPTR                                         0359 00621000
         ST    @15,IODIOC(,@08)                                    0359 00622000
*                  ELSE                                            0360 00623000
*                                                                  0360 00624000
*                    /************************************************/ 00625000
*                    /*                                              */ 00626000
*                    /* FIND LAST IOCS IN CHAIN.                     */ 00627000
*                    /*                                              */ 00628000
*                    /************************************************/ 00629000
*                                                                  0360 00630000
*                    DO;                                           0360 00631000
         B     @RC00358                                            0360 00632000
@RF00358 DS    0H                                                  0361 00633000
*                      NEXTADDR = IOCSPTR;                         0361 00634000
         L     @08,IOCSPTR                                         0361 00635000
         ST    @08,NEXTADDR                                        0361 00636000
*                      IOCSPTR = IODIOC;                           0362 00637000
*                                                                  0362 00638000
         L     @08,@PC00001                                        0362 00639000
         L     @08,GDTIOH(,@08)                                    0362 00640000
         L     @08,IODIOC(,@08)                                    0362 00641000
         ST    @08,IOCSPTR                                         0362 00642000
*                      DO WHILE IOCNIO ^= NULLPTR;                 0363 00643000
         B     @DE00363                                            0363 00644000
@DL00363 DS    0H                                                  0364 00645000
*                        IOCSPTR = IOCNIO;                         0364 00646000
         L     @08,IOCSPTR                                         0364 00647000
         L     @08,IOCEXT(,@08)                                    0364 00648000
         L     @08,IOCNIO(,@08)                                    0364 00649000
         ST    @08,IOCSPTR                                         0364 00650000
*                      END;                                        0365 00651000
*                                                                  0365 00652000
@DE00363 L     @08,IOCSPTR                                         0365 00653000
         L     @08,IOCEXT(,@08)                                    0365 00654000
         L     @15,IOCNIO(,@08)                                    0365 00655000
         LTR   @15,@15                                             0365 00656000
         BNZ   @DL00363                                            0365 00657000
*                      /**********************************************/ 00658000
*                      /*                                            */ 00659000
*                      /* SET ADDRESS OF NEW IOCS IN CHAIN.          */ 00660000
*                      /*                                            */ 00661000
*                      /**********************************************/ 00662000
*                                                                  0366 00663000
*                      IOCNIO = NEXTADDR;                          0366 00664000
         L     @15,NEXTADDR                                        0366 00665000
         ST    @15,IOCNIO(,@08)                                    0366 00666000
*                      IOCSPTR = NEXTADDR;                         0367 00667000
         ST    @15,IOCSPTR                                         0367 00668000
*                    END;                                          0368 00669000
*                                                                  0368 00670000
*                /****************************************************/ 00671000
*                /*                                                  */ 00672000
*                /* SET INPUT, OUTPUT OR UPDATE IN IOCS - DETERMINED */ 00673000
*                /* FROM THE OPNAGL OPTION FLAGS.                    */ 00674000
*                /* SET OPEN FOR INPUT AS DEFAULT                    */ 00675000
*                /****************************************************/ 00676000
*                                                                  0369 00677000
*                IF OPNOPTOT = ON | OPNTYPSO = ON                  0369 00678000
*                  THEN                                            0369 00679000
@RC00358 TM    OPNOPTOT(OPNPTR),B'01000000'                        0369 00680000
         BO    @RT00369                                            0369 00681000
         TM    OPNTYPSO(OPNPTR),B'01000000'                        0369 00682000
         BNO   @RF00369                                            0369 00683000
@RT00369 DS    0H                                                  0370 00684000
*                    IOCMACOT = ON;                                0370 00685000
*                                                                  0370 00686000
         L     @08,IOCSPTR                                         0370 00687000
         OI    IOCMACOT(@08),B'01000000'                           0370 00688000
*                  ELSE                                            0371 00689000
*                    DO;                                           0371 00690000
*                                                                  0371 00691000
         B     @RC00369                                            0371 00692000
@RF00369 DS    0H                                                  0372 00693000
*                      IF OPNOPTUP = ON                            0372 00694000
*                        THEN                                      0372 00695000
         TM    OPNOPTUP(OPNPTR),B'00100000'                        0372 00696000
         BNO   @RF00372                                            0372 00697000
*                          IOCMACUP = ON;                          0373 00698000
         L     @08,IOCSPTR                                         0373 00699000
         OI    IOCMACUP(@08),B'00100000'                           0373 00700000
*                        ELSE                                      0374 00701000
*                          IOCMACIN = ON;                          0374 00702000
*                                                                  0374 00703000
         B     @RC00372                                            0374 00704000
@RF00372 L     @08,IOCSPTR                                         0374 00705000
         OI    IOCMACIN(@08),B'10000000'                           0374 00706000
*                    END;                                          0375 00707000
*                                                                  0375 00708000
@RC00372 DS    0H                                                  0376 00709000
*        IF IODXTN ^= NULLPTR                                      0376 00710000
*          THEN                                                    0376 00711000
*                                                                  0376 00712000
@RC00369 L     @08,@PC00001                                        0376 00713000
         L     @08,GDTIOH(,@08)                                    0376 00714000
         L     @08,IODXTN(,@08)                                    0376 00715000
         LTR   @08,@08                                             0376 00716000
         BZ    @RF00376                                            0376 00717000
*            /********************************************************/ 00718000
*            /*                                                      */ 00719000
*            /* IF THERE IS AN EXTERNAL DATA SET LIST - CHECK        */ 00720000
*            /* IF THIS DATA SET IS EXTERNALLY CONTROLLED.           */ 00721000
*            /*                                                      */ 00722000
*            /********************************************************/ 00723000
*                                                                  0377 00724000
*CKEXLIST:   DO CKXTN = 1 TO XTNNUM;                               0377 00725000
*                                                                  0377 00726000
CKEXLIST LA    @08,1                                               0377 00727000
         B     @DE00377                                            0377 00728000
@DL00377 DS    0H                                                  0378 00729000
*              XDADDR = XDPTR (CKXTN);                             0378 00730000
*                                                                  0378 00731000
         MH    @08,@CH00036                                        0378 00732000
         L     @15,@PC00001                                        0378 00733000
         L     @01,GDTIOH(,@15)                                    0378 00734000
         L     @01,IODXTN(,@01)                                    0378 00735000
         AL    @01,@CF01493                                        0378 00736000
         L     @08,XDPTR-4(@08,@01)                                0378 00737000
         ST    @08,XDADDR                                          0378 00738000
*              IF XTFTYPE = 'DD'                                   0379 00739000
*                THEN                                              0379 00740000
*                                                                  0379 00741000
         CLC   XTFTYPE(2,@08),@CC01012                             0379 00742000
         BNE   @RF00379                                            0379 00743000
*                  /**************************************************/ 00744000
*                  /*                                                */ 00745000
*                  /* NAME IN LIST IS DDNAME                         */ 00746000
*                  /*                                                */ 00747000
*                  /**************************************************/ 00748000
*                                                                  0380 00749000
*EXISDD:           DO;                                             0380 00750000
*                                                                  0380 00751000
EXISDD   DS    0H                                                  0381 00752000
*                    IF XTNAME = DTOOPEN                           0381 00753000
*                      THEN                                        0381 00754000
*                                                                  0381 00755000
         L     @08,XDADDR                                          0381 00756000
         CLC   XTNAME(8,@08),DTOOPEN                               0381 00757000
         BNE   @RF00381                                            0381 00758000
*                        /********************************************/ 00759000
*                        /*                                          */ 00760000
*                        /* CALL EXTERNAL OPEN ROUTINE               */ 00761000
*                        /*                                          */ 00762000
*                        /********************************************/ 00763000
*                                                                  0382 00764000
*SETEXT:                 DO;                                       0382 00765000
SETEXT   DS    0H                                                  0383 00766000
*                          IOCFLGEX = ON;                          0383 00767000
         L     @08,IOCSPTR                                         0383 00768000
         L     @15,IOCEXT(,@08)                                    0383 00769000
         OI    IOCFLGEX(@15),B'10000000'                           0383 00770000
*                          IOCXAD = XTNADR (CKXTN);                0384 00771000
         LH    @14,CKXTN                                           0384 00772000
         MH    @14,@CH00036                                        0384 00773000
         L     @07,@PC00001                                        0384 00774000
         L     @01,GDTIOH(,@07)                                    0384 00775000
         L     @07,IODXTN(,@01)                                    0384 00776000
         LA    @01,0(@14,@07)                                      0384 00777000
         AL    @01,@CF01494                                        0384 00778000
         L     @06,XTNADR-8(,@01)                                  0384 00779000
         ST    @06,IOCXAD(,@15)                                    0384 00780000
*                          IOCXPM = XTNPRM (CKXTN);                0385 00781000
         L     @14,XTNPRM-12(@14,@07)                              0385 00782000
         ST    @14,IOCXPM(,@15)                                    0385 00783000
*                          BLANKDSN (1:8) = DTOOPEN (1:8);         0386 00784000
*                                                                  0386 00785000
         L     @01,IOCDSN(,@08)                                    0386 00786000
         MVC   BLANKDSN(8,@01),DTOOPEN                             0386 00787000
*                          EXTFLGFD = 0;                           0387 00788000
*                                                                  0387 00789000
         SLR   @15,@15                                             0387 00790000
         ST    @15,EXTFLGFD                                        0387 00791000
*                          IF IOCMACOT = ON                        0388 00792000
*                            THEN                                  0388 00793000
         TM    IOCMACOT(@08),B'01000000'                           0388 00794000
         BNO   @RF00388                                            0388 00795000
*                              EXTOPTOT = ON;                      0389 00796000
         OI    EXTOPTOT,B'01000000'                                0389 00797000
*                            ELSE                                  0390 00798000
*                              EXTOPTIN = ON;                      0390 00799000
*                                                                  0390 00800000
         B     @RC00388                                            0390 00801000
@RF00388 OI    EXTOPTIN,B'10000000'                                0390 00802000
*                          EXTTYPE = EXOPREQ;                      0391 00803000
@RC00388 MVI   EXTTYPE,X'00'                                       0391 00804000
*                          EXTOPTDD = ON;                          0392 00805000
*                                                                  0392 00806000
         OI    EXTOPTDD,B'00100000'                                0392 00807000
*                          CALL EXTRTN                             0393 00808000
*                            (IOEXPARM,EXTFLGFD,DTOOPEN);          0393 00809000
         L     @08,IOCSPTR                                         0393 00810000
         L     @08,IOCEXT(,@08)                                    0393 00811000
         L     @01,IOCXPM(,@08)                                    0393 00812000
         ST    @01,@AL00001                                        0393 00813000
         LA    @15,EXTFLGFD                                        0393 00814000
         ST    @15,@AL00001+4                                      0393 00815000
         LA    @15,DTOOPEN                                         0393 00816000
         ST    @15,@AL00001+8                                      0393 00817000
         MVI   @AL00001+8,X'80'                                    0393 00818000
         L     @15,IOCXAD(,@08)                                    0393 00819000
         LA    @01,@AL00001                                        0393 00820000
         BALR  @14,@15                                             0393 00821000
*                          RESPECIFY RTNREG RSTD;                  0394 00822000
*                          TESTRC = RTNREG;                        0395 00823000
         STH   RTNREG,TESTRC                                       0395 00824000
*                          RESPECIFY RTNREG UNRSTD;                0396 00825000
*                                                                  0396 00826000
*                          IF TESTRC = EXTOK                       0397 00827000
*                            THEN                                  0397 00828000
*                                                                  0397 00829000
         LH    @08,TESTRC                                          0397 00830000
         LTR   @08,@08                                             0397 00831000
         BNZ   @RF00397                                            0397 00832000
*                              /**************************************/ 00833000
*                              /*                                    */ 00834000
*                              /* SET IOCSTR VALUES                  */ 00835000
*                              /*                                    */ 00836000
*                              /**************************************/ 00837000
*                                                                  0398 00838000
*                              DO;                                 0398 00839000
*                                IOCMSGOP = ON;                    0399 00840000
         L     @08,IOCSPTR                                         0399 00841000
         OI    IOCMSGOP(@08),B'10000000'                           0399 00842000
*                                IOCDSOPS = ON;                    0400 00843000
         OI    IOCDSOPS(@08),B'10000000'                           0400 00844000
*                                IOCRFMVR = ON;                    0401 00845000
         OI    IOCRFMVR(@08),B'01000000'                           0401 00846000
*                                IOCTRN = 32760;                   0402 00847000
         MVC   IOCTRN(4,@08),@CF01017                              0402 00848000
*                              END;                                0403 00849000
*                            ELSE                                  0404 00850000
*                              OPENRC = 4;                         0404 00851000
*                                                                  0404 00852000
         B     @RC00397                                            0404 00853000
@RF00397 MVC   OPENRC(2),@CH00040                                  0404 00854000
*                        END SETEXT;                               0405 00855000
*                                                                  0405 00856000
@RC00397 DS    0H                                                  0406 00857000
*                  END EXISDD;                                     0406 00858000
*                                                                  0406 00859000
@RF00381 DS    0H                                                  0407 00860000
*            END CKEXLIST;                                         0407 00861000
*                                                                  0407 00862000
@RF00379 LA    @08,1                                               0407 00863000
         AH    @08,CKXTN                                           0407 00864000
@DE00377 STH   @08,CKXTN                                           0407 00865000
         L     @15,@PC00001                                        0407 00866000
         L     @01,GDTIOH(,@15)                                    0407 00867000
         L     @01,IODXTN(,@01)                                    0407 00868000
         C     @08,XTNNUM(,@01)                                    0407 00869000
         BNH   @DL00377                                            0407 00870000
*                IF IOCFLGEX = OFF                                 0408 00871000
*                  THEN                                            0408 00872000
*                                                                  0408 00873000
@RF00376 L     @08,IOCSPTR                                         0408 00874000
         L     @08,IOCEXT(,@08)                                    0408 00875000
         TM    IOCFLGEX(@08),B'10000000'                           0408 00876000
         BNZ   @RF00408                                            0408 00877000
*                    /************************************************/ 00878000
*                    /*                                              */ 00879000
*                    /* IF DATA SET IS NOT EXTERNALLY CONTROLLED A   */ 00880000
*                    /* CONTROL BLOCK MUST BE BUILT.                 */ 00881000
*                    /*                                              */ 00882000
*                    /************************************************/ 00883000
*                                                                  0409 00884000
*NOTEXT:             DO;                                           0409 00885000
*                                                                  0409 00886000
NOTEXT   DS    0H                                                  0410 00887000
*                      /**********************************************/ 00888000
*                      /*                                            */ 00889000
*                      /* GET DATA SET INFORMATION FROM JCL CARD AND */ 00890000
*                      /* OPNAGL.                                    */ 00891000
*                      /*                                            */ 00892000
*                      /* INFORMATION FOUND IN THE CALLED ROUTINE    */ 00893000
*                      /* IS SAVED IN THE IOCSTR AND IS USED TO      */ 00894000
*                      /* BUILD THE PROPER CONTROL BLOCKS FOR OPEN.  */ 00895000
*                      /*                                            */ 00896000
*                      /**********************************************/ 00897000
*                                                                  0410 00898000
*                      CALL DSDATA (DTOOPEN);                      0410 00899000
*                                                                  0410 00900000
         LA    @08,DTOOPEN                                         0410 00901000
         ST    @08,@AL00001                                        0410 00902000
         LA    @01,@AL00001                                        0410 00903000
         BAL   @14,DSDATA                                          0410 00904000
*                      /**********************************************/ 00905000
*                      /*                                            */ 00906000
*                      /* SAVE THE RETURN CODE FROM THE DATA SET     */ 00907000
*                      /* INFORMATION ROUTINE.                       */ 00908000
*                      /*                                            */ 00909000
*                      /**********************************************/ 00910000
*                                                                  0411 00911000
*                      RESPECIFY RTNREG RSTD;                      0411 00912000
*                      TESTRC = RTNREG;                            0412 00913000
         STH   RTNREG,TESTRC                                       0412 00914000
*                      RESPECIFY RTNREG UNRSTD;                    0413 00915000
*                                                                  0413 00916000
*                                                                  0413 00917000
*                      IF TESTRC = 0                               0414 00918000
*                        THEN                                      0414 00919000
*                                                                  0414 00920000
         LH    @08,TESTRC                                          0414 00921000
         LTR   @08,@08                                             0414 00922000
         BNZ   @RF00414                                            0414 00923000
*                        /********************************************/ 00924000
*                        /*                                          */ 00925000
*                        /* NO ERRORS HAVE BEEN DETECTED,            */ 00926000
*                        /* A DCB MUST BE BUILT                      */ 00927000
*                        /*                                          */ 00928000
*                        /********************************************/ 00929000
*                                                                  0415 00930000
*BLDCB:                  DO;                                       0415 00931000
*                                                                  0415 00932000
BLDCB    DS    0H                                                  0416 00933000
*                          CALL BUILDDBK(RETCBADR,DTOOPEN);        0416 00934000
*                                                                  0416 00935000
         LA    @08,RETCBADR                                        0416 00936000
         ST    @08,@AL00001                                        0416 00937000
         LA    @08,DTOOPEN                                         0416 00938000
         ST    @08,@AL00001+4                                      0416 00939000
         LA    @01,@AL00001                                        0416 00940000
         BAL   @14,BUILDDBK                                        0416 00941000
*                          RESPECIFY RTNREG RSTD;                  0417 00942000
*                          TESTRC = RTNREG;                        0418 00943000
         STH   RTNREG,TESTRC                                       0418 00944000
*                          RESPECIFY RTNREG UNRSTD;                0419 00945000
*                                                                  0419 00946000
*                          IF TESTRC = 0                           0420 00947000
*                            THEN                                  0420 00948000
*                                                                  0420 00949000
         LH    @08,TESTRC                                          0420 00950000
         LTR   @08,@08                                             0420 00951000
         BNZ   @RF00420                                            0420 00952000
*                              /**************************************/ 00953000
*                              /*                                    */ 00954000
*                              /* SET INFORMATION FOR OPEN           */ 00955000
*                              /*                                    */ 00956000
*                              /**************************************/ 00957000
*                                                                  0421 00958000
*                              DO;                                 0421 00959000
*                                IF OPNOPTJM = ON                  0422 00960000
*                                  THEN                            0422 00961000
         TM    OPNOPTJM(OPNPTR),B'00000100'                        0422 00962000
         BNO   @RF00422                                            0422 00963000
*                                    DO;                           0423 00964000
*                                     TJNUMOP = TJNUMOP + 1;       0424 00965000
         LA    @08,1                                               0424 00966000
         AH    @08,TJNUMOP                                         0424 00967000
         STH   @08,TJNUMOP                                         0424 00968000
*                                     TJIOCSAD(TJNUMOP) = IOCSPTR; 0425 00969000
         SLA   @08,2                                               0425 00970000
         L     @02,IOCSPTR                                         0425 00971000
         ST    @02,TJIOCSAD-4(@08)                                 0425 00972000
*                                     TJCBAD(TJNUMOP) = RETCBADR;  0426 00973000
         L     @02,RETCBADR                                        0426 00974000
         ST    @02,TJCBAD-4(@08)                                   0426 00975000
*                                    END;                          0427 00976000
*                                  ELSE                            0428 00977000
*                                    DO;                           0428 00978000
         B     @RC00422                                            0428 00979000
@RF00422 DS    0H                                                  0429 00980000
*                                     NUMOPEN = NUMOPEN + 1;       0429 00981000
         AL    NUMOPEN,@CF00161                                    0429 00982000
*                                     IOCSADDR (NUMOPEN) = IOCSPTR;     00983000
         LR    @08,NUMOPEN                                         0430 00984000
         SLA   @08,2                                               0430 00985000
         L     @02,IOCSPTR                                         0430 00986000
         ST    @02,IOCSADDR-4(@08)                                 0430 00987000
*                                     OPCBADDR (NUMOPEN) = RETCBADR;    00988000
         L     @02,RETCBADR                                        0431 00989000
         ST    @02,OPCBADDR-4(@08)                                 0431 00990000
*                                    END;                          0432 00991000
*                                                                  0432 00992000
*                              END;                                0433 00993000
*                                                                  0433 00994000
@RC00422 DS    0H                                                  0434 00995000
*                        END BLDCB;                                0434 00996000
*                                                                  0434 00997000
@RF00420 DS    0H                                                  0435 00998000
*                    END NOTEXT;                                   0435 00999000
*                                                                  0435 01000000
@RF00414 DS    0H                                                  0436 01001000
*              END BLDIOCS;                                        0436 01002000
*                                                                  0436 01003000
@RF00408 DS    0H                                                  0437 01004000
*          /**********************************************************/ 01005000
*          /*                                                        */ 01006000
*          /* IF AN ERROR WAS DETECTED BEFORE OPEN, PRINT MESSAGE    */ 01007000
*          /*                                                        */ 01008000
*          /**********************************************************/ 01009000
*                                                                  0437 01010000
*          IF TESTRC ^= 0                                          0437 01011000
*            THEN                                                  0437 01012000
@RF00324 LH    @08,TESTRC                                          0437 01013000
         LTR   @08,@08                                             0437 01014000
         BZ    @RF00437                                            0437 01015000
*              DO;                                                 0438 01016000
*                                                                  0438 01017000
*                /****************************************************/ 01018000
*                /*                                                  */ 01019000
*                /* IF MESSAGE TO PRINT - CALL PRINT ROUTINE         */ 01020000
*                /*                                                  */ 01021000
*                /****************************************************/ 01022000
*                                                                  0439 01023000
*                IF DARGSENT ^= 0                                  0439 01024000
*                  THEN                                            0439 01025000
         L     @08,DDSTRU                                          0439 01026000
         CLI   DARGSENT(@08),0                                     0439 01027000
         BE    @RF00439                                            0439 01028000
*                    CALL BLDOCMSG (DTOOPEN);                      0440 01029000
*                                                                  0440 01030000
*                                                                  0440 01031000
         LA    @08,DTOOPEN                                         0440 01032000
         ST    @08,@AL00001                                        0440 01033000
         LA    @01,@AL00001                                        0440 01034000
         BAL   @14,BLDOCMSG                                        0440 01035000
*                OPENRC = 4;                                       0441 01036000
*                                                                  0441 01037000
@RF00439 MVC   OPENRC(2),@CH00040                                  0441 01038000
*              END;                                                0442 01039000
*                                                                  0442 01040000
*        END CKOLIST;                                              0443 01041000
*                                                                  0443 01042000
@RF00437 LA    @08,1                                               0443 01043000
         AH    @08,OPNCTR                                          0443 01044000
@DE00295 STH   @08,OPNCTR                                          0443 01045000
         L     @02,@PC00001+4                                      0443 01046000
         SLR   @15,@15                                             0443 01047000
         IC    @15,OCANUM(,@02)                                    0443 01048000
         CR    @08,@15                                             0443 01049000
         BNH   @DL00295                                            0443 01050000
*        /************************************************************/ 01051000
*        /*                                                          */ 01052000
*        /* OPENLIST CONTAINS THE ADDRESSES OF ALL CONTROL BLOCKS    */ 01053000
*        /* TO BE OPENED.  OPEN AND SAVE RETURN CODE.                */ 01054000
*        /*                                                          */ 01055000
*        /************************************************************/ 01056000
*                                                                  0444 01057000
*        IF GDTDBG = NULLPTR                                       0444 01058000
*          THEN;                                                   0444 01059000
         L     @08,@PC00001                                        0444 01060000
         L     @08,GDTDBG(,@08)                                    0444 01061000
         LTR   @08,@08                                             0444 01062000
         BZ    @RT00444                                            0444 01063000
*          ELSE                                                    0446 01064000
*            CALL ICKDB010 (GDTTBL,'IO1O');                        0446 01065000
*                                                                  0446 01066000
         L     @08,@PC00001                                        0446 01067000
         ST    @08,@AL00001                                        0446 01068000
         LA    @02,@CC01024                                        0446 01069000
         ST    @02,@AL00001+4                                      0446 01070000
         MVI   @AL00001+4,X'80'                                    0446 01071000
         L     @15,GDTDBG(,@08)                                    0446 01072000
         LA    @01,@AL00001                                        0446 01073000
         BALR  @14,@15                                             0446 01074000
*        IF NUMOPEN ^= 0                                           0447 01075000
*          THEN                                                    0447 01076000
@RT00444 LTR   NUMOPEN,NUMOPEN                                     0447 01077000
         BZ    @RF00447                                            0447 01078000
*            DO;                                                   0448 01079000
*                                                                  0448 01080000
*                                                                  0448 01081000
*              OPLEND (NUMOPEN) = ON;                              0449 01082000
*                                                                  0449 01083000
*                                                                  0449 01084000
         LR    @08,NUMOPEN                                         0449 01085000
         SLA   @08,2                                               0449 01086000
         LA    @02,OPLEND-4(@08)                                   0449 01087000
         OI    0(@02),B'10000000'                                  0449 01088000
*              REG1 = ADDR (OPENLIST);                             0450 01089000
         LA    REG1,OPENLIST                                       0450 01090000
*LOPEN1:       GEN(OPEN  MF=(E,(REG1)));                           0451 01091000
LOPEN1   OPEN  MF=(E,(REG1))                                            01092000
*              RESPECIFY RTNREG RSTD;                              0452 01093000
*              TESTRC = RTNREG;                                    0453 01094000
         STH   RTNREG,TESTRC                                       0453 01095000
*              RESPECIFY RTNREG UNRSTD;                            0454 01096000
*              OPAMRC = TESTRC;                                    0455 01097000
*                                                                  0455 01098000
*                                                                  0455 01099000
         LH    @08,TESTRC                                          0455 01100000
         STH   @08,OPAMRC                                          0455 01101000
*              IF GDTDBG = NULLPTR                                 0456 01102000
*                THEN;                                             0456 01103000
         L     @08,@PC00001                                        0456 01104000
         L     @08,GDTDBG(,@08)                                    0456 01105000
         LTR   @08,@08                                             0456 01106000
         BZ    @RT00456                                            0456 01107000
*                ELSE                                              0458 01108000
*                  CALL ICKDB010 (GDTTBL,'IO20');                  0458 01109000
*                                                                  0458 01110000
         L     @08,@PC00001                                        0458 01111000
         ST    @08,@AL00001                                        0458 01112000
         LA    @02,@CC01027                                        0458 01113000
         ST    @02,@AL00001+4                                      0458 01114000
         MVI   @AL00001+4,X'80'                                    0458 01115000
         L     @15,GDTDBG(,@08)                                    0458 01116000
         LA    @01,@AL00001                                        0458 01117000
         BALR  @14,@15                                             0458 01118000
*            END;                                                  0459 01119000
*                                                                  0459 01120000
@RT00456 DS    0H                                                  0460 01121000
*        /************************************************************/ 01122000
*        /*                                                          */ 01123000
*        /* APPEND THE OPEN TYPE=J CONTROL BLOCKS LIST               */ 01124000
*        /* TO THE OPEN CONTROL BLOCKS LIST.                         */ 01125000
*        /*                                                          */ 01126000
*        /************************************************************/ 01127000
*                                                                  0460 01128000
*              DO OPNCTR = 1 TO TJNUMOP;                           0460 01129000
@RF00447 LA    @08,1                                               0460 01130000
         B     @DE00460                                            0460 01131000
@DL00460 DS    0H                                                  0461 01132000
*                  NUMOPEN = NUMOPEN + 1;                          0461 01133000
         AL    NUMOPEN,@CF00161                                    0461 01134000
*                  IOCSADDR(NUMOPEN) = TJIOCSAD(OPNCTR);           0462 01135000
         LR    @02,NUMOPEN                                         0462 01136000
         SLA   @02,2                                               0462 01137000
         LR    @15,@08                                             0462 01138000
         SLA   @15,2                                               0462 01139000
         L     @14,TJIOCSAD-4(@15)                                 0462 01140000
         ST    @14,IOCSADDR-4(@02)                                 0462 01141000
*                  OPCBADDR(NUMOPEN) = TJCBAD(OPNCTR);             0463 01142000
         L     @15,TJCBAD-4(@15)                                   0463 01143000
         ST    @15,OPCBADDR-4(@02)                                 0463 01144000
*              END;                                                0464 01145000
*                                                                  0464 01146000
         AL    @08,@CF00161                                        0464 01147000
@DE00460 STH   @08,OPNCTR                                          0464 01148000
         CH    @08,TJNUMOP                                         0464 01149000
         BNH   @DL00460                                            0464 01150000
*        /************************************************************/ 01151000
*        /*                                                          */ 01152000
*        /* TJOPLIST CONTAINS THE ADDRESSES OF ALL                   */ 01153000
*        /* CONTROL BLOCKS TO BE OPENED WITH A MODIFIED              */ 01154000
*        /* JFCB. OPEN TYPE=J AND SAVE RETURN CODE                   */ 01155000
*        /* ONLY IF OPEN RETURN CODE WAS RCOK                        */ 01156000
*        /*                                                          */ 01157000
*        /************************************************************/ 01158000
*                                                                  0465 01159000
*        IF TJNUMOP ^= 0                                           0465 01160000
*          THEN                                                    0465 01161000
         LH    @08,TJNUMOP                                         0465 01162000
         LTR   @08,@08                                             0465 01163000
         BZ    @RF00465                                            0465 01164000
*            DO;                                                   0466 01165000
*              TJLEND(TJNUMOP) = ON;                               0467 01166000
         SLA   @08,2                                               0467 01167000
         LA    @02,TJLEND-4(@08)                                   0467 01168000
         OI    0(@02),B'10000000'                                  0467 01169000
*              REG1 = ADDR(TJOPLIST);                              0468 01170000
*                                                                  0468 01171000
         LA    REG1,TJOPLIST                                       0468 01172000
*LOPENJ:       GEN (OPEN TYPE=J,MF=(E,(REG1)));                    0469 01173000
*                                                                  0469 01174000
LOPENJ   OPEN TYPE=J,MF=(E,(REG1))                                      01175000
*              RESPECIFY RTNREG RSTD;                              0470 01176000
*              TESTRC = RTNREG;                                    0471 01177000
         STH   RTNREG,TESTRC                                       0471 01178000
*              RESPECIFY RTNREG UNRSTD;                            0472 01179000
*                                                                  0472 01180000
*              IF OPAMRC = 0                                       0473 01181000
*                THEN OPAMRC = TESTRC;                             0473 01182000
*                                                                  0473 01183000
         LH    @08,OPAMRC                                          0473 01184000
         LTR   @08,@08                                             0473 01185000
         BNZ   @RF00473                                            0473 01186000
         LH    @08,TESTRC                                          0474 01187000
         STH   @08,OPAMRC                                          0474 01188000
*              IF GDTDBG = NULLPTR                                 0475 01189000
*                THEN;                                             0475 01190000
@RF00473 L     @08,@PC00001                                        0475 01191000
         L     @08,GDTDBG(,@08)                                    0475 01192000
         LTR   @08,@08                                             0475 01193000
         BZ    @RT00475                                            0475 01194000
*                ELSE                                              0477 01195000
*                  CALL ICKDB010 (GDTTBL,'IO3O');                  0477 01196000
*                                                                  0477 01197000
         L     @08,@PC00001                                        0477 01198000
         ST    @08,@AL00001                                        0477 01199000
         LA    @02,@CC01030                                        0477 01200000
         ST    @02,@AL00001+4                                      0477 01201000
         MVI   @AL00001+4,X'80'                                    0477 01202000
         L     @15,GDTDBG(,@08)                                    0477 01203000
         LA    @01,@AL00001                                        0477 01204000
         BALR  @14,@15                                             0477 01205000
*            END;                                                  0478 01206000
*                                                                  0478 01207000
@RT00475 DS    0H                                                  0479 01208000
*        /************************************************************/ 01209000
*        /*                                                          */ 01210000
*        /*       CHECK ALL CONTROL BLOCKS TO INSURE THAT THEY WERE  */ 01211000
*        /*       OPENED.                                            */ 01212000
*        /*                                                          */ 01213000
*        /************************************************************/ 01214000
*                                                                  0479 01215000
*CKOPEN: DO OPNCTR = 1 TO NUMOPEN;                                 0479 01216000
*                                                                  0479 01217000
@RF00465 DS    0H                                                  0479 01218000
CKOPEN   LA    @08,1                                               0479 01219000
         B     @DE00479                                            0479 01220000
@DL00479 DS    0H                                                  0480 01221000
*          IOCSPTR = IOCSADDR (OPNCTR);                            0480 01222000
*                                                                  0480 01223000
         SLA   @08,2                                               0480 01224000
         L     @08,IOCSADDR-4(@08)                                 0480 01225000
         ST    @08,IOCSPTR                                         0480 01226000
*          /**********************************************************/ 01227000
*          /*                                                        */ 01228000
*          /* CHECK IF OPENED SUCCESSFULLY AND OBTAIN INPUT          */ 01229000
*          /* WORK AREA, IF REQUIRED.                                */ 01230000
*          /*                                                        */ 01231000
*          /**********************************************************/ 01232000
*                                                                  0481 01233000
*          CALL CKNONOP;                                           0481 01234000
*                                                                  0481 01235000
         BAL   @14,CKNONOP                                         0481 01236000
*          IF IOCMSGOP = OFF                                       0482 01237000
*            THEN                                                  0482 01238000
         L     @08,IOCSPTR                                         0482 01239000
         TM    IOCMSGOP(@08),B'10000000'                           0482 01240000
         BNZ   @RF00482                                            0482 01241000
*              OPENRC = 4;                                         0483 01242000
*                                                                  0483 01243000
         MVC   OPENRC(2),@CH00040                                  0483 01244000
*        /************************************************************/ 01245000
*        /*                                                          */ 01246000
*        /* IF ERROR DETECTED PRINT ERROR MESSAGE AND SET ERROR RC   */ 01247000
*        /*                                                          */ 01248000
*        /************************************************************/ 01249000
*                                                                  0484 01250000
*        IF DARGSENT ^= 0                                          0484 01251000
*          THEN                                                    0484 01252000
@RF00482 L     @08,DDSTRU                                          0484 01253000
         CLI   DARGSENT(@08),0                                     0484 01254000
         BE    @RF00484                                            0484 01255000
*            CALL BLDOCMSG (DTOOPEN);                              0485 01256000
*                                                                  0485 01257000
         LA    @08,DTOOPEN                                         0485 01258000
         ST    @08,@AL00001                                        0485 01259000
         LA    @01,@AL00001                                        0485 01260000
         BAL   @14,BLDOCMSG                                        0485 01261000
*        END CKOPEN;                                               0486 01262000
*                                                                  0486 01263000
@RF00484 LA    @08,1                                               0486 01264000
         AH    @08,OPNCTR                                          0486 01265000
@DE00479 STH   @08,OPNCTR                                          0486 01266000
         CR    @08,NUMOPEN                                         0486 01267000
         BNH   @DL00479                                            0486 01268000
*        IF GDTDBG = NULLPTR                                       0487 01269000
*          THEN;                                                   0487 01270000
         L     @08,@PC00001                                        0487 01271000
         L     @08,GDTDBG(,@08)                                    0487 01272000
         LTR   @08,@08                                             0487 01273000
         BZ    @RT00487                                            0487 01274000
*          ELSE                                                    0489 01275000
*            CALL ICKDB010 (GDTTBL,'IO21');                        0489 01276000
*                                                                  0489 01277000
         L     @08,@PC00001                                        0489 01278000
         ST    @08,@AL00001                                        0489 01279000
         LA    @15,@CC01034                                        0489 01280000
         ST    @15,@AL00001+4                                      0489 01281000
         MVI   @AL00001+4,X'80'                                    0489 01282000
         L     @15,GDTDBG(,@08)                                    0489 01283000
         LA    @01,@AL00001                                        0489 01284000
         BALR  @14,@15                                             0489 01285000
*        RETURN CODE (OPENRC);                                     0490 01286000
*                                                                  0490 01287000
@RT00487 LH    @15,OPENRC                                          0490 01288000
         L     @14,@SA00002                                        0490 01289000
         LM    @00,@12,@SA00002+8                                  0490 01290000
         BR    @14                                                 0490 01291000
*        END OPENRTN;                                              0491 01292000
*                                                                  0492 01293000
*                                                                  0492 01294000
*                                                                  0492 01295000
*        /************************************************************/ 01296000
*        /*                                                          */ 01297000
*        /* PROCEDURE NAME - CKNONOP                                 */ 01298000
*        /*                                                          */ 01299000
*        /* FUNCTION - THIS PROCEDURE CHECKS IF THE  AOS             */ 01300000
*        /*            DATA SET WAS SUCCESSFULLY OPENED.             */ 01301000
*        /*            IT ALSO GETS STORAGE TO BE USED AS A WORKAREA */ 01302000
*        /*            FOR ISAM DATA SET WITH FIXED UNBLOCKED RECORDS*/ 01303000
*        /*            AND RKP  = 0.                                 */ 01304000
*        /*                                                          */ 01305000
*        /* INPUT -    IOCSTR - CONTAINING THE DATA SET INFORMATION  */ 01306000
*        /*                                                          */ 01307000
*        /* OUTPUT -   IOCSTR - UPDATED TO REFLECT OPEN CHECKING     */ 01308000
*        /*                     AND WORKAREA STORAGE OBTAINED.       */ 01309000
*        /*            DMSGARG - SET WHEN AN ERROR IS DETECTED.      */ 01310000
*        /*                                                          */ 01311000
*        /* ERRORS -   1. ABEND EXIT WAS TAKEN DURING OPEN.          */ 01312000
*        /*            2. DCB OPEN FLAG NOT SET AFTER THE OPEN.      */ 01313000
*        /*            3. STORAGE NOT AVAILABLE FOR WORKAREA.        */ 01314000
*        /*            4. RECORD SIZE GREATER THAN 32767.            */ 01315000
*        /*                                                          */ 01316000
*        /************************************************************/ 01317000
*                                                                  0492 01318000
*CKNONOP:  PROC;                                                   0492 01319000
*                                                                  0492 01320000
CKNONOP  STM   @14,@12,@SA00003                                    0492 01321000
*        DCBPTR = IOCCBA;                                          0493 01322000
         L     @08,IOCSPTR                                         0493 01323000
         L     @15,IOCEXT(,@08)                                    0493 01324000
         L     @14,IOCCBA(,@15)                                    0493 01325000
         ST    @14,DCBPTR                                          0493 01326000
*        DCBEXLSA = NULLPTR;                                       0494 01327000
*                                                                  0494 01328000
         SLR   @07,@07                                             0494 01329000
         STCM  @07,7,DCBEXLSA+28(@14)                              0494 01330000
*        IF DCBOFOPN = ON                                          0495 01331000
*          THEN                                                    0495 01332000
*                                                                  0495 01333000
         TM    DCBOFOPN+40(@14),B'00010000'                        0495 01334000
         BNO   @RF00495                                            0495 01335000
*            /********************************************************/ 01336000
*            /*                                                      */ 01337000
*            /* IF DCB IS OPEN SET OPEN FLAGS IN IOCS                */ 01338000
*            /*                                                      */ 01339000
*            /********************************************************/ 01340000
*                                                                  0496 01341000
*            DO;                                                   0496 01342000
*                                                                  0496 01343000
*              IOCMSGOP = ON;                                      0497 01344000
         OI    IOCMSGOP(@08),B'10000000'                           0497 01345000
*              IOCFLGOP = ON;                                      0498 01346000
*                                                                  0498 01347000
         OI    IOCFLGOP(@15),B'00001000'                           0498 01348000
*              IF LRECLX = ON                                      0499 01349000
*                THEN                                              0499 01350000
         TM    LRECLX+72(@14),B'10000000'                          0499 01351000
         BNO   @RF00499                                            0499 01352000
*                  /**************************************************/ 01353000
*                  /*                                                */ 01354000
*                  /* RECORD SIZE IS GREATER THAN 32767.             */ 01355000
*                  /* PRINT MESSAGE AND TURN OFF USER OPEN FLAG      */ 01356000
*                  /*                                                */ 01357000
*                  /**************************************************/ 01358000
*                  DO;                                             0500 01359000
*                    DARGSENT = RSZID;                             0501 01360000
         L     @01,DDSTRU                                          0501 01361000
         MVI   DARGSENT(@01),X'2C'                                 0501 01362000
*                    IOCMSGOP = OFF;                               0502 01363000
         NI    IOCMSGOP(@08),B'01111111'                           0502 01364000
*                    RETURN;                                       0503 01365000
@EL00003 DS    0H                                                  0503 01366000
@EF00003 DS    0H                                                  0503 01367000
@ER00003 LM    @14,@12,@SA00003                                    0503 01368000
         BR    @14                                                 0503 01369000
*                  END;                                            0504 01370000
*                                                                  0504 01371000
*              /******************************************************/ 01372000
*              /*                                                    */ 01373000
*              /* OBTAIN STORAGE IF INPUT WORKAREA REQUIRED          */ 01374000
*              /*                                                    */ 01375000
*              /******************************************************/ 01376000
*                                                                  0505 01377000
*              IF IOCMACIN = ON & IOCMACBK = ON |                  0505 01378000
*                 IOCMACUP = ON & IOCMACBK = ON                    0505 01379000
*                THEN                                              0505 01380000
@RF00499 L     @08,IOCSPTR                                         0505 01381000
         TM    IOCMACIN(@08),B'10010000'                           0505 01382000
         BO    @RT00505                                            0505 01383000
         TM    IOCMACUP(@08),B'00110000'                           0505 01384000
         BNO   @RF00505                                            0505 01385000
@RT00505 DS    0H                                                  0506 01386000
*                  DO;                                             0506 01387000
*                                                                  0506 01388000
*                    CALL ICKSAGP0 (GDTTBL,IOCTRN,IOCWKA,IOCSID);  0507 01389000
         L     @08,@PC00001                                        0507 01390000
         ST    @08,@AL00001                                        0507 01391000
         L     @15,IOCSPTR                                         0507 01392000
         LA    @14,IOCTRN(,@15)                                    0507 01393000
         ST    @14,@AL00001+4                                      0507 01394000
         L     @15,IOCEXT(,@15)                                    0507 01395000
         LA    @14,IOCWKA(,@15)                                    0507 01396000
         ST    @14,@AL00001+8                                      0507 01397000
         LA    @15,IOCSID(,@15)                                    0507 01398000
         ST    @15,@AL00001+12                                     0507 01399000
         MVI   @AL00001+12,X'80'                                   0507 01400000
         L     @15,GDTGPL(,@08)                                    0507 01401000
         LA    @01,@AL00001                                        0507 01402000
         BALR  @14,@15                                             0507 01403000
*                    RESPECIFY RTNREG RSTD;                        0508 01404000
*                    TESTRC = RTNREG;                              0509 01405000
         STH   RTNREG,TESTRC                                       0509 01406000
*                    RESPECIFY RTNREG UNRSTD;                      0510 01407000
*                                                                  0510 01408000
*                    /************************************************/ 01409000
*                    /*                                              */ 01410000
*                    /* IF STORAGE WAS NOT AVAILABLE PRINT ERROR     */ 01411000
*                    /* MESSAGE AND TURN OFF USER OPEN FLAG          */ 01412000
*                    /*                                              */ 01413000
*                    /************************************************/ 01414000
*                                                                  0511 01415000
*                    IF TESTRC = 4                                 0511 01416000
*                      THEN                                        0511 01417000
         LH    @08,TESTRC                                          0511 01418000
         C     @08,@CF00040                                        0511 01419000
         BNE   @RF00511                                            0511 01420000
*                        DO;                                       0512 01421000
*                                                                  0512 01422000
*                          DARGSMOD = 'UV0';                       0513 01423000
         L     @08,DDSTRU                                          0513 01424000
         MVC   DARGSMOD(3,@08),@CC01006                            0513 01425000
*                          DARGSENT = NOCRSTID;                    0514 01426000
         MVI   DARGSENT(@08),X'04'                                 0514 01427000
*                          IOCMSGOP = OFF;                         0515 01428000
*                                                                  0515 01429000
         L     @08,IOCSPTR                                         0515 01430000
         NI    IOCMSGOP(@08),B'01111111'                           0515 01431000
*                        END;                                      0516 01432000
*                  END;                                            0517 01433000
*            END;                                                  0518 01434000
*                                                                  0518 01435000
*          ELSE                                                    0519 01436000
*                                                                  0519 01437000
*            /********************************************************/ 01438000
*            /*                                                      */ 01439000
*            /* DCB OPEN FLAG NOT SET.  SET ERROR ID                 */ 01440000
*            /*                                                      */ 01441000
*            /********************************************************/ 01442000
*                                                                  0519 01443000
*            DO;                                                   0519 01444000
         B     @RC00495                                            0519 01445000
@RF00495 DS    0H                                                  0520 01446000
*              IF IOCINFAE = ON                                    0520 01447000
*                THEN                                              0520 01448000
         L     @08,IOCSPTR                                         0520 01449000
         L     @08,IOCEXT(,@08)                                    0520 01450000
         TM    IOCINFAE(@08),B'01000000'                           0520 01451000
         BNO   @RF00520                                            0520 01452000
*                  DO;                                             0521 01453000
*                    DARGSENT = ABEXSTID;                          0522 01454000
         L     @01,DDSTRU                                          0522 01455000
         MVI   DARGSENT(@01),X'18'                                 0522 01456000
*                    IOCINFAE = OFF;                               0523 01457000
         NI    IOCINFAE(@08),B'10111111'                           0523 01458000
*                  END;                                            0524 01459000
*                ELSE                                              0525 01460000
*                  DARGSENT = DOFGSTID;                            0525 01461000
         B     @RC00520                                            0525 01462000
@RF00520 L     @08,DDSTRU                                          0525 01463000
         MVI   DARGSENT(@08),X'0F'                                 0525 01464000
*            END;                                                  0526 01465000
*                                                                  0526 01466000
*        END CKNONOP;                                              0527 01467000
*                                                                  0527 01468000
         B     @EL00003                                            0527 01469000
*        /************************************************************/ 01470000
*        /*                                                          */ 01471000
*        /* PROCEDURE NAME - CLOSERTN                                */ 01472000
*        /*                                                          */ 01473000
*        /* FUNCTION - THIS PROCEDURE WILL CLOSE  DATA SETS          */ 01474000
*        /*            THAT WERE OPENED BY THE I/O ADAPER OPEN       */ 01475000
*        /*            ROUTINE.  STORAGE OBTAINED FOR THE DATA SET   */ 01476000
*        /*            WHETHER IT WAS OPENED OR NOT IS RELEASED.     */ 01477000
*        /*                                                          */ 01478000
*        /* INPUT -    OCARRAY - DEFINES THE DATA SETS THAT ARE TO   */ 01479000
*        /*                      ARE TO BE CLOSED.                   */ 01480000
*        /*                                                          */ 01481000
*        /* OUTPUT -   RETURN CODE IS SET FOR THE MAIN ROUTINE.      */ 01482000
*        /*                                                          */ 01483000
*        /************************************************************/ 01484000
*                                                                  0528 01485000
*CLOSERTN: PROC;                                                   0528 01486000
*                                                                  0528 01487000
CLOSERTN STM   @14,@12,@SA00004                                    0528 01488000
*        /* CLOSE RETURN CODE                                        */ 01489000
*        DCL CLOSERC FIXED (15);                                   0529 01490000
*        /* FLAGS USED IN CLOSE ROUTINE                              */ 01491000
*        DCL 1 CFLAGS CHAR (1),                                    0530 01492000
*              2 CSKIP BIT (1);        /* DO NOT CLOSE THIS FILE     */ 01493000
*        /* NUMBER DATA SETS TO CLOSE                                */ 01494000
*        DCL NUMCLOSE FIXED (15);                                  0531 01495000
*        /* NUMBER OF IOCS S TO BE FREED                             */ 01496000
*        DCL NUMFREE FIXED (15);                                   0532 01497000
*        /* ARGUMENT LIST SUPPLIED TO THE CLOSE SVC                  */ 01498000
*        DCL 1 CLOSLIST BDY (WORD),                                0533 01499000
*              2 CLCBADDR (4) PTR (31),/* CONTROL BLOCK ADDRESS      */ 01500000
*                3 CLOPT CHAR(1),      /* CLOSE OPTION               */ 01501000
*                  4 CLLEND BIT (1);   /* END OF LIST                */ 01502000
*        /* CLOSE DATA SET FREE IOCS COUNTER                         */ 01503000
*        DCL CLOCTR FIXED (15);                                    0534 01504000
*        /* ADDRESS OF IOCS TO BE DELETED                            */ 01505000
*        DCL DELEIOCS PTR (31);                                    0535 01506000
*        /* ADDRESS OF NEXT IOCS IN LIST                             */ 01507000
*        DCL NEXTIOCS PTR (31);                                    0536 01508000
*        /* VARIABLE TEXT FOR CLOSE MESSAGES                         */ 01509000
*        DCL CLVTEXT CHAR (8);                                     0537 01510000
*        /* RETURN CODE FROM CLOSE SVC                               */ 01511000
*        DCL AMCLRC FIXED (15);                                    0538 01512000
*        /* COUNTER USED TO FIND THE CORRECT IOCSTR BEING CLOSED     */ 01513000
*        DCL CLIOCTR FIXED (15);                                   0539 01514000
*        /* AREA TO PUT STORAGE IDENTIFIER                           */ 01515000
*        DCL IOCSID2 CHAR (4);                                     0540 01516000
*                                                                  0540 01517000
*        /* CLOSE ERROR CODE                                         */ 01518000
*        DCL CLREASON FIXED(15);                                   0541 01519000
*                                                                  0541 01520000
*        /* MACRO VARIABLE FOR CLOSE REWIND OPTION                   */ 01521000
*                                                                  0542 01522000
*        /************************************************************/ 01523000
*        /*                                                          */ 01524000
*        /* INITIALIZE COUNTERS                                      */ 01525000
*        /*                                                          */ 01526000
*        /************************************************************/ 01527000
*                                                                  0542 01528000
*        NUMFREE = 0;                                              0542 01529000
         SLR   @08,@08                                             0542 01530000
         STH   @08,NUMFREE                                         0542 01531000
*        NUMCLOSE = 0;                                             0543 01532000
         SLR   NUMCLOSE,NUMCLOSE                                   0543 01533000
*        CLOSERC = 0;                                              0544 01534000
         STH   @08,CLOSERC                                         0544 01535000
*        IOCSPTR = IODIOC;                                         0545 01536000
*                                                                  0545 01537000
         L     @08,@PC00001                                        0545 01538000
         L     @08,GDTIOH(,@08)                                    0545 01539000
         L     @08,IODIOC(,@08)                                    0545 01540000
         ST    @08,IOCSPTR                                         0545 01541000
*        /************************************************************/ 01542000
*        /*                                                          */ 01543000
*        /* A MAXIMUM OF FOUR DATA SETS ARE CLOSED AT ONE TIME.      */ 01544000
*        /* IOCSPTR HAS BEEN SET TO POINT TO THE FIRST IOCS IN THE   */ 01545000
*        /* CHAIN FOR A CLOSE ALL REQUEST.  IF REQUEST IS NOT        */ 01546000
*        /* CLOSE ALL IOCSPTR IS RESET.                              */ 01547000
*        /*                                                          */ 01548000
*        /************************************************************/ 01549000
*                                                                  0546 01550000
*BLDCLOSE:                                                         0546 01551000
*                                                                  0546 01552000
*        DO CLOCTR = 1 TO 4;                                       0546 01553000
*                                                                  0546 01554000
BLDCLOSE LA    CLOCTR,1                                            0546 01555000
@DL00546 DS    0H                                                  0547 01556000
*          TESTRC = 0;                                             0547 01557000
         SLR   @08,@08                                             0547 01558000
         STH   @08,TESTRC                                          0547 01559000
*          CSKIP = OFF;                                            0548 01560000
*                                                                  0548 01561000
         NI    CSKIP,B'01111111'                                   0548 01562000
*          /**********************************************************/ 01563000
*          /*                                                        */ 01564000
*          /* SET ADDRESS OF A POSSIBLE IOCS.  FOR A CLOSE ALL       */ 01565000
*          /* REQUEST IOCSPTR ALREADY POINTS TO AN IOCS.  IF         */ 01566000
*          /* REQUEST IS NOT CLOSE ALL, CLOCTR IS USED AS AN INDEX   */ 01567000
*          /* TO OBTAIN IOCS ADDRESS FROM OCARRAY.                   */ 01568000
*          /*                                                        */ 01569000
*          /* IF THE DATA SET IS THE DMS PRINT DATA SET AND CLOSE    */ 01570000
*          /* WAS NOT INITIATED BY TERMINATION  THEN THE DATA SET    */ 01571000
*          /* IS NOT CLOSED.                                         */ 01572000
*          /*                                                        */ 01573000
*          /**********************************************************/ 01574000
*                                                                  0549 01575000
*          IF OCAOPTCA = OFF                                       0549 01576000
*            THEN                                                  0549 01577000
         L     @15,@PC00001+4                                      0549 01578000
         TM    OCAOPTCA(@15),B'10000000'                           0549 01579000
         BNZ   @RF00549                                            0549 01580000
*              DO;                                                 0550 01581000
*                IOCSPTR = OCADDR (CLOCTR);                        0551 01582000
*                                                                  0551 01583000
         LR    @14,CLOCTR                                          0551 01584000
         SLA   @14,2                                               0551 01585000
         L     @15,OCADDR-4(@14,@15)                               0551 01586000
         ST    @15,IOCSPTR                                         0551 01587000
*                IF IOCSPTR ^= NULLPTR                             0552 01588000
*                  THEN                                            0552 01589000
         CR    @15,@08                                             0552 01590000
         BE    @RF00552                                            0552 01591000
*                    DO;                                           0553 01592000
*                                                                  0553 01593000
*                      IF IOCFLGSP = ON | IOCINFND = ON            0554 01594000
*                        THEN                                      0554 01595000
         L     @08,IOCEXT(,@15)                                    0554 01596000
         TM    IOCFLGSP(@08),B'00000010'                           0554 01597000
         BO    @RT00554                                            0554 01598000
         TM    IOCINFND(@08),B'00100000'                           0554 01599000
         BNO   @RF00554                                            0554 01600000
@RT00554 DS    0H                                                  0555 01601000
*                          CSKIP = ON;                             0555 01602000
*                                                                  0555 01603000
         OI    CSKIP,B'10000000'                                   0555 01604000
*                    END;                                          0556 01605000
*                                                                  0556 01606000
@RF00554 DS    0H                                                  0557 01607000
*              END;                                                0557 01608000
*                                                                  0557 01609000
@RF00552 DS    0H                                                  0558 01610000
*          /**********************************************************/ 01611000
*          /*                                                        */ 01612000
*          /* IF THE IOCS ADDRESS IS NOT ZERO THERE IS AN IOCS TO    */ 01613000
*          /* FREE.                                                  */ 01614000
*          /*                                                        */ 01615000
*          /**********************************************************/ 01616000
*                                                                  0558 01617000
*          IF IOCSPTR ^= NULLPTR & CSKIP = OFF                     0558 01618000
*            THEN                                                  0558 01619000
@RF00549 L     @08,IOCSPTR                                         0558 01620000
         LTR   @08,@08                                             0558 01621000
         BZ    @RF00558                                            0558 01622000
         TM    CSKIP,B'10000000'                                   0558 01623000
         BNZ   @RF00558                                            0558 01624000
*INOTZERO:     DO;                                                 0559 01625000
*                                                                  0559 01626000
INOTZERO DS    0H                                                  0560 01627000
*              /******************************************************/ 01628000
*              /*                                                    */ 01629000
*              /* THE ADDRESS OF THE IOCS IS SAVED.  THIS ADDRESS    */ 01630000
*              /* WILL BE USED AGAIN WHEN STORAGE IS FREED.          */ 01631000
*              /*                                                    */ 01632000
*              /******************************************************/ 01633000
*                                                                  0560 01634000
*              NUMFREE = NUMFREE + 1;                              0560 01635000
         LA    @08,1                                               0560 01636000
         AH    @08,NUMFREE                                         0560 01637000
         STH   @08,NUMFREE                                         0560 01638000
*              IOCSADDR (NUMFREE) = IOCSPTR;                       0561 01639000
*                                                                  0561 01640000
*                                                                  0561 01641000
         L     @15,IOCSPTR                                         0561 01642000
         SLA   @08,2                                               0561 01643000
         ST    @15,IOCSADDR-4(@08)                                 0561 01644000
*                IF IOCFLGOP = ON                                  0562 01645000
*                  THEN                                            0562 01646000
*                                                                  0562 01647000
         L     @08,IOCEXT(,@15)                                    0562 01648000
         TM    IOCFLGOP(@08),B'00001000'                           0562 01649000
         BNO   @RF00562                                            0562 01650000
*                    /************************************************/ 01651000
*                    /*                                              */ 01652000
*                    /* THE CLOSE MACRO MUST BE ISSUED FOR THE       */ 01653000
*                    /* DATA SET DEFINED BY THIS IOCSTR.             */ 01654000
*                    /*                                              */ 01655000
*                    /************************************************/ 01656000
*                                                                  0563 01657000
*DSTCLOSE:           DO;                                           0563 01658000
*                                                                  0563 01659000
DSTCLOSE DS    0H                                                  0564 01660000
*                      NUMCLOSE = NUMCLOSE + 1;                    0564 01661000
         AL    NUMCLOSE,@CF00161                                   0564 01662000
*                      CLCBADDR (NUMCLOSE) = IOCCBA;               0565 01663000
*                                                                  0565 01664000
         LR    @08,NUMCLOSE                                        0565 01665000
         SLA   @08,2                                               0565 01666000
         L     @15,IOCSPTR                                         0565 01667000
         L     @01,IOCEXT(,@15)                                    0565 01668000
         L     @14,IOCCBA(,@01)                                    0565 01669000
         ST    @14,CLCBADDR-4(@08)                                 0565 01670000
*                      /**********************************************/ 01671000
*                      /*                                            */ 01672000
*                      /* RESET  CONTROL BLOCK VALUES                */ 01673000
*                      /*                                            */ 01674000
*                      /**********************************************/ 01675000
*                        DCBPTR = IOCCBA;                          0566 01676000
         ST    @14,DCBPTR                                          0566 01677000
*                        DCBSYNAD = 0;                             0567 01678000
         LA    @08,52                                              0567 01679000
         ALR   @08,@14                                             0567 01680000
         SLR   @07,@07                                             0567 01681000
         ST    @07,DCBSYNAD(,@08)                                  0567 01682000
*                        DCBEXLSA = ADDR (DCBTLIST);               0568 01683000
*                                                                  0568 01684000
         LA    @07,DCBTLIST                                        0568 01685000
         STCM  @07,7,DCBEXLSA+28(@14)                              0568 01686000
*                        /********************************************/ 01687000
*                        /*                                          */ 01688000
*                        /* FOR BLOCKED PROCESSING SET               */ 01689000
*                        /* MAXIMUM BLOCKSIZE IN DCB                 */ 01690000
*                        /* BEFORE CLOSING DATA SET                  */ 01691000
*                        /*                                          */ 01692000
*                        /********************************************/ 01693000
*                                                                  0569 01694000
*                        IF IOCMACBK = ON                          0569 01695000
*                          THEN                                    0569 01696000
         TM    IOCMACBK(@15),B'00010000'                           0569 01697000
         BNO   @RF00569                                            0569 01698000
*                            DCBBLKSI = IOCTRN;                    0570 01699000
*                                                                  0570 01700000
         L     @15,IOCTRN(,@15)                                    0570 01701000
         STH   @15,DCBBLKSI(,@08)                                  0570 01702000
*                    END DSTCLOSE;                                 0571 01703000
*                                                                  0571 01704000
*                  ELSE                                            0572 01705000
*NOCAM:              DO;                                           0572 01706000
*                                                                  0572 01707000
         B     @RC00562                                            0572 01708000
@RF00562 DS    0H                                                  0572 01709000
NOCAM    DS    0H                                                  0573 01710000
*                      IF IOCFLGEX = ON                            0573 01711000
*                        THEN                                      0573 01712000
*                                                                  0573 01713000
         L     @08,IOCSPTR                                         0573 01714000
         L     @01,IOCEXT(,@08)                                    0573 01715000
         TM    IOCFLGEX(@01),B'10000000'                           0573 01716000
         BNO   @RF00573                                            0573 01717000
*                          /******************************************/ 01718000
*                          /*                                        */ 01719000
*                          /* USERS EXTERNAL ROUTINE IS CALLED TO    */ 01720000
*                          /* CLOSE THE DATA SET.                    */ 01721000
*                          /*                                        */ 01722000
*                          /******************************************/ 01723000
*                                                                  0574 01724000
*                          DO;                                     0574 01725000
*                                                                  0574 01726000
*                            EXTFLGFD = 0;                         0575 01727000
         SLR   @15,@15                                             0575 01728000
         ST    @15,EXTFLGFD                                        0575 01729000
*                            EXTOPTDD = ON;                        0576 01730000
         OI    EXTOPTDD,B'00100000'                                0576 01731000
*                            IF IOCMACOT = ON                      0577 01732000
*                              THEN                                0577 01733000
         TM    IOCMACOT(@08),B'01000000'                           0577 01734000
         BNO   @RF00577                                            0577 01735000
*                                EXTOPTOT = ON;                    0578 01736000
         OI    EXTOPTOT,B'01000000'                                0578 01737000
*                              ELSE                                0579 01738000
*                                EXTOPTIN = ON;                    0579 01739000
*                                                                  0579 01740000
         B     @RC00577                                            0579 01741000
@RF00577 OI    EXTOPTIN,B'10000000'                                0579 01742000
*                            EXTTYPE = EXCLREQ;                    0580 01743000
@RC00577 MVI   EXTTYPE,X'04'                                       0580 01744000
*                            CALL EXTRTN (IOEXPARM,EXTFLGFD,IOCDSN);    01745000
         L     @08,IOCSPTR                                         0581 01746000
         L     @15,IOCEXT(,@08)                                    0581 01747000
         L     @01,IOCXPM(,@15)                                    0581 01748000
         ST    @01,@AL00001                                        0581 01749000
         LA    @14,EXTFLGFD                                        0581 01750000
         ST    @14,@AL00001+4                                      0581 01751000
         LA    @08,IOCDSN(,@08)                                    0581 01752000
         ST    @08,@AL00001+8                                      0581 01753000
         MVI   @AL00001+8,X'80'                                    0581 01754000
         L     @15,IOCXAD(,@15)                                    0581 01755000
         LA    @01,@AL00001                                        0581 01756000
         BALR  @14,@15                                             0581 01757000
*                            RESPECIFY RTNREG RSTD;                0582 01758000
*                            TESTRC = RTNREG;                      0583 01759000
         STH   RTNREG,TESTRC                                       0583 01760000
*                            RESPECIFY RTNREG UNRSTD;              0584 01761000
*                                                                  0584 01762000
*                            IF TESTRC ^= 0                        0585 01763000
*                              THEN                                0585 01764000
*                                                                  0585 01765000
         LH    @08,TESTRC                                          0585 01766000
         LTR   @08,@08                                             0585 01767000
         BZ    @RF00585                                            0585 01768000
*                                /************************************/ 01769000
*                                /*                                  */ 01770000
*                                /* NON-ZERO RETURN CODE FROM        */ 01771000
*                                /* EXTERNAL ROUTINE.  SET ERROR CODE*/ 01772000
*                                /*                                  */ 01773000
*                                /************************************/ 01774000
*                                CLOSERC = 4;                      0586 01775000
*                                                                  0586 01776000
         MVC   CLOSERC(2),@CH00040                                 0586 01777000
*                          END;                                    0587 01778000
*                                                                  0587 01779000
@RF00585 DS    0H                                                  0588 01780000
*                    END NOCAM;                                    0588 01781000
*                                                                  0588 01782000
@RF00573 DS    0H                                                  0589 01783000
*              END INOTZERO;                                       0589 01784000
*                                                                  0589 01785000
@RC00562 DS    0H                                                  0590 01786000
*          /**********************************************************/ 01787000
*          /*                                                        */ 01788000
*          /* CHECK FOR MORE IOCSS DEFINING DATA SETS TO CLOSE       */ 01789000
*          /* IF CLOSE ALL HAS BEEN REQUESTED AND THERE ARE NO       */ 01790000
*          /* MORE IOCSS IN THE CHAIN THE LOOP IS ENDED.             */ 01791000
*          /*                                                        */ 01792000
*          /**********************************************************/ 01793000
*                                                                  0590 01794000
*          IF OCAOPTCA = ON                                        0590 01795000
*            THEN                                                  0590 01796000
@RF00558 L     @08,@PC00001+4                                      0590 01797000
         TM    OCAOPTCA(@08),B'10000000'                           0590 01798000
         BNO   @RF00590                                            0590 01799000
*              DO;                                                 0591 01800000
*                                                                  0591 01801000
*                /****************************************************/ 01802000
*                /*                                                  */ 01803000
*                /*       IF ALL DATA SETS IN CHAIN ARE BEING CLOSED */ 01804000
*                /*       THE NEXT IOCS ADDRESS IS OBTAINED.  IF     */ 01805000
*                /*       THIS ADDRESS IS ZERO ALL IOCSS HAVE        */ 01806000
*                /*       BEEN FOUND                                 */ 01807000
*                /*                                                  */ 01808000
*                /****************************************************/ 01809000
*                                                                  0592 01810000
*                IOCSPTR = IOCNIO;                                 0592 01811000
         L     @08,IOCSPTR                                         0592 01812000
         L     @08,IOCEXT(,@08)                                    0592 01813000
         L     @08,IOCNIO(,@08)                                    0592 01814000
         ST    @08,IOCSPTR                                         0592 01815000
*                IF IOCSPTR = NULLPTR                              0593 01816000
*                  THEN                                            0593 01817000
         LTR   @08,@08                                             0593 01818000
         BNZ   @RF00593                                            0593 01819000
*                    CLOCTR = 4;                                   0594 01820000
*                                                                  0594 01821000
         LA    CLOCTR,4                                            0594 01822000
*              END;                                                0595 01823000
*                                                                  0595 01824000
@RF00593 DS    0H                                                  0596 01825000
*        END BLDCLOSE;                                             0596 01826000
@RF00590 AL    CLOCTR,@CF00161                                     0596 01827000
         C     CLOCTR,@CF00040                                     0596 01828000
         BNH   @DL00546                                            0596 01829000
*        /************************************************************/ 01830000
*        /*                                                          */ 01831000
*        /*       THE END OF THE CLOSE LIST IS SET,  THE CLOSE       */ 01832000
*        /*       MACRO IS ISSUED AND THE RETURN CODE IS SAVED       */ 01833000
*        /*                                                          */ 01834000
*        /************************************************************/ 01835000
*                                                                  0597 01836000
*        IF NUMCLOSE ^= 0                                          0597 01837000
*          THEN                                                    0597 01838000
         SLR   @08,@08                                             0597 01839000
         CR    NUMCLOSE,@08                                        0597 01840000
         BE    @RF00597                                            0597 01841000
*            DO;                                                   0598 01842000
*                                                                  0598 01843000
*              IF GDTDBG = NULLPTR                                 0599 01844000
*                THEN;                                             0599 01845000
         L     @03,@PC00001                                        0599 01846000
         C     @08,GDTDBG(,@03)                                    0599 01847000
         BE    @RT00599                                            0599 01848000
*                ELSE                                              0601 01849000
*                  CALL ICKDB010 (GDTTBL,'IO1C');                  0601 01850000
*                                                                  0601 01851000
*                                                                  0601 01852000
*                                                                  0601 01853000
         L     @08,@PC00001                                        0601 01854000
         ST    @08,@AL00001                                        0601 01855000
         LA    @03,@CC01066                                        0601 01856000
         ST    @03,@AL00001+4                                      0601 01857000
         MVI   @AL00001+4,X'80'                                    0601 01858000
         L     @15,GDTDBG(,@08)                                    0601 01859000
         LA    @01,@AL00001                                        0601 01860000
         BALR  @14,@15                                             0601 01861000
*              CLLEND (NUMCLOSE) = ON;                             0602 01862000
@RT00599 LR    @08,NUMCLOSE                                        0602 01863000
         SLA   @08,2                                               0602 01864000
         LA    @03,CLLEND-4(@08)                                   0602 01865000
         OI    0(@03),B'10000000'                                  0602 01866000
*              REG1 = ADDR (CLOSLIST);                             0603 01867000
         LA    REG1,CLOSLIST                                       0603 01868000
*LCLOSE1:      GEN(CLOSE   MF=(E,(REG1)));                         0604 01869000
LCLOSE1  CLOSE   MF=(E,(REG1))                                          01870000
*              RESPECIFY RTNREG RSTD;                              0605 01871000
*              TESTRC = RTNREG;                                    0606 01872000
         STH   RTNREG,TESTRC                                       0606 01873000
*              RESPECIFY RTNREG UNRSTD;                            0607 01874000
*              AMCLRC = TESTRC;                                    0608 01875000
*                                                                  0608 01876000
         LH    @08,TESTRC                                          0608 01877000
         LR    AMCLRC,@08                                          0608 01878000
*            END;                                                  0609 01879000
*                                                                  0609 01880000
*        /************************************************************/ 01881000
*        /*                                                          */ 01882000
*        /* ALL DATA SETS ARE CHECKED TO SEE THAT THEY               */ 01883000
*        /* WERE SUCCESSFULLY CLOSED.                                */ 01884000
*        /*                                                          */ 01885000
*        /************************************************************/ 01886000
*                                                                  0610 01887000
*CKCLOSE:                                                          0610 01888000
*        DO CLOCTR = 1 TO NUMFREE;                                 0610 01889000
*                                                                  0610 01890000
@RF00597 DS    0H                                                  0610 01891000
CKCLOSE  LA    CLOCTR,1                                            0610 01892000
         B     @DE00610                                            0610 01893000
@DL00610 DS    0H                                                  0611 01894000
*          IOCSPTR = IOCSADDR (CLOCTR);                            0611 01895000
*                                                                  0611 01896000
         LR    @08,CLOCTR                                          0611 01897000
         SLA   @08,2                                               0611 01898000
         L     @08,IOCSADDR-4(@08)                                 0611 01899000
         ST    @08,IOCSPTR                                         0611 01900000
*          /**********************************************************/ 01901000
*          /*                                                        */ 01902000
*          /* FREE STORAGE UNIQUE TO THE ENVIRONMENT                 */ 01903000
*          /*                                                        */ 01904000
*          /**********************************************************/ 01905000
*                                                                  0612 01906000
*          CALL ENVFREE;                                           0612 01907000
*                                                                  0612 01908000
         BAL   @14,ENVFREE                                         0612 01909000
*          /**********************************************************/ 01910000
*          /*                                                        */ 01911000
*          /* PRINT ANY CLOSE ERROR MESSAGES                         */ 01912000
*          /*                                                        */ 01913000
*          /**********************************************************/ 01914000
*                                                                  0613 01915000
*          IF DARGSENT ^= 0                                        0613 01916000
*            THEN                                                  0613 01917000
         L     @08,DDSTRU                                          0613 01918000
         CLI   DARGSENT(@08),0                                     0613 01919000
         BE    @RF00613                                            0613 01920000
*              DO;                                                 0614 01921000
*                CLOSERC = 4;                                      0615 01922000
         MVC   CLOSERC(2),@CH00040                                 0615 01923000
*                CALL BLDOCMSG (CLVTEXT);                          0616 01924000
         LA    @08,CLVTEXT                                         0616 01925000
         ST    @08,@AL00001                                        0616 01926000
         LA    @01,@AL00001                                        0616 01927000
         BAL   @14,BLDOCMSG                                        0616 01928000
*              END;                                                0617 01929000
*                                                                  0617 01930000
*          /**********************************************************/ 01931000
*          /*                                                        */ 01932000
*          /* THE IOCS STORAGE AND ANY OTHER STORAGE THE DATA SET    */ 01933000
*          /* USED THAT WAS OBTAINED BY THE UGPOOL IS RELEASED AND   */ 01934000
*          /* THE IOCS CHAIN IS UPDATED.                             */ 01935000
*          /*                                                        */ 01936000
*          /**********************************************************/ 01937000
*                                                                  0618 01938000
*          DELEIOCS = IOCSPTR;                                     0618 01939000
@RF00613 L     @08,IOCSPTR                                         0618 01940000
         LR    DELEIOCS,@08                                        0618 01941000
*          NEXTIOCS = IOCNIO;                                      0619 01942000
*                                                                  0619 01943000
         L     @08,IOCEXT(,@08)                                    0619 01944000
         L     @15,IOCNIO(,@08)                                    0619 01945000
         ST    @15,NEXTIOCS                                        0619 01946000
*          /**********************************************************/ 01947000
*          /*                                                        */ 01948000
*          /* FREE THE STORAGE USED                                  */ 01949000
*          /*                                                        */ 01950000
*          /**********************************************************/ 01951000
*                                                                  0620 01952000
*          IOCSID2 = IOCSID;                                       0620 01953000
         MVC   IOCSID2(4),IOCSID(@08)                              0620 01954000
*          CALL ICKSAFP0 (GDTTBL,IOCSID2);                         0621 01955000
*                                                                  0621 01956000
         L     @08,@PC00001                                        0621 01957000
         ST    @08,@AL00001                                        0621 01958000
         LA    @15,IOCSID2                                         0621 01959000
         ST    @15,@AL00001+4                                      0621 01960000
         MVI   @AL00001+4,X'80'                                    0621 01961000
         L     @15,GDTFPL(,@08)                                    0621 01962000
         LA    @01,@AL00001                                        0621 01963000
         BALR  @14,@15                                             0621 01964000
*          /**********************************************************/ 01965000
*          /*                                                        */ 01966000
*          /*     UPDATE THE IOCS CHAIN POINTER.                     */ 01967000
*          /*                                                        */ 01968000
*          /**********************************************************/ 01969000
*                                                                  0622 01970000
*          IF IODIOC = DELEIOCS                                    0622 01971000
*            THEN                                                  0622 01972000
         L     @08,@PC00001                                        0622 01973000
         L     @08,GDTIOH(,@08)                                    0622 01974000
         C     DELEIOCS,IODIOC(,@08)                               0622 01975000
         BNE   @RF00622                                            0622 01976000
*              IODIOC = NEXTIOCS;                                  0623 01977000
*                                                                  0623 01978000
         L     @02,NEXTIOCS                                        0623 01979000
         ST    @02,IODIOC(,@08)                                    0623 01980000
*            ELSE                                                  0624 01981000
*              DO;                                                 0624 01982000
*                                                                  0624 01983000
         B     @RC00622                                            0624 01984000
@RF00622 DS    0H                                                  0625 01985000
*                IOCSPTR = IODIOC;                                 0625 01986000
*                                                                  0625 01987000
         L     @08,@PC00001                                        0625 01988000
         L     @08,GDTIOH(,@08)                                    0625 01989000
         L     @08,IODIOC(,@08)                                    0625 01990000
         ST    @08,IOCSPTR                                         0625 01991000
*                DO WHILE IOCNIO ^= DELEIOCS;                      0626 01992000
         B     @DE00626                                            0626 01993000
@DL00626 DS    0H                                                  0627 01994000
*                  IOCSPTR = IOCNIO;                               0627 01995000
         L     @08,IOCSPTR                                         0627 01996000
         L     @08,IOCEXT(,@08)                                    0627 01997000
         L     @08,IOCNIO(,@08)                                    0627 01998000
         ST    @08,IOCSPTR                                         0627 01999000
*                END;                                              0628 02000000
*                                                                  0628 02001000
@DE00626 L     @08,IOCSPTR                                         0628 02002000
         L     @08,IOCEXT(,@08)                                    0628 02003000
         C     DELEIOCS,IOCNIO(,@08)                               0628 02004000
         BNE   @DL00626                                            0628 02005000
*                IOCNIO = NEXTIOCS;                                0629 02006000
*                                                                  0629 02007000
         L     @02,NEXTIOCS                                        0629 02008000
         ST    @02,IOCNIO(,@08)                                    0629 02009000
*              END;                                                0630 02010000
*                                                                  0630 02011000
*        END CKCLOSE;                                              0631 02012000
*                                                                  0631 02013000
@RC00622 AL    CLOCTR,@CF00161                                     0631 02014000
@DE00610 CH    CLOCTR,NUMFREE                                      0631 02015000
         BNH   @DL00610                                            0631 02016000
*        IF GDTDBG = NULLPTR                                       0632 02017000
*          THEN;                                                   0632 02018000
         L     @08,@PC00001                                        0632 02019000
         L     @08,GDTDBG(,@08)                                    0632 02020000
         LTR   @08,@08                                             0632 02021000
         BZ    @RT00632                                            0632 02022000
*          ELSE                                                    0634 02023000
*            CALL ICKDB010 (GDTTBL,'IO2C');                        0634 02024000
*                                                                  0634 02025000
         L     @08,@PC00001                                        0634 02026000
         ST    @08,@AL00001                                        0634 02027000
         LA    @15,@CC01072                                        0634 02028000
         ST    @15,@AL00001+4                                      0634 02029000
         MVI   @AL00001+4,X'80'                                    0634 02030000
         L     @15,GDTDBG(,@08)                                    0634 02031000
         LA    @01,@AL00001                                        0634 02032000
         BALR  @14,@15                                             0634 02033000
*        RETURN CODE (CLOSERC);                                    0635 02034000
@RT00632 LH    @15,CLOSERC                                         0635 02035000
         L     @14,@SA00004                                        0635 02036000
         LM    @00,@12,@SA00004+8                                  0635 02037000
         BR    @14                                                 0635 02038000
*        END CLOSERTN;                                             0636 02039000
*                                                                  0636 02040000
*          /**********************************************************/ 02041000
*          /*                                                        */ 02042000
*          /* PROCEDURE NAME - ENVFREE                               */ 02043000
*          /*                                                        */ 02044000
*          /* FUNCTION - THIS PROCEDURE IS CALLED TO FREE            */ 02045000
*          /*            STORAGE USED FOR THE DATA SET THAT WAS NOT  */ 02046000
*          /*            OBTAINED WITH THE UGPOOL.                   */ 02047000
*          /*                                                        */ 02048000
*          /*            A CHECK IS MADE IF A CLOSE ABEND EXIT WAS   */ 02049000
*          /*            TAKEN.                                      */ 02050000
*          /*                                                        */ 02051000
*          /* INPUT -    IOCSTR DEFINING THE DATA SET.               */ 02052000
*          /*                                                        */ 02053000
*          /* OUTPUT -   DMSGARG - SET IF ERROR DETECTED.            */ 02054000
*          /*                                                        */ 02055000
*          /* ERRORS -   1. CLOSE ABEND EXIT TAKEN.                  */ 02056000
*          /*                                                        */ 02057000
*          /**********************************************************/ 02058000
*                                                                  0637 02059000
*ENVFREE:  PROC;                                                   0637 02060000
*                                                                  0637 02061000
ENVFREE  STM   @14,@12,@SA00005                                    0637 02062000
*          IF IOCINFAE = ON                                        0638 02063000
*            THEN                                                  0638 02064000
*                                                                  0638 02065000
         L     @08,IOCSPTR                                         0638 02066000
         L     @08,IOCEXT(,@08)                                    0638 02067000
         TM    IOCINFAE(@08),B'01000000'                           0638 02068000
         BNO   @RF00638                                            0638 02069000
*              /******************************************************/ 02070000
*              /*                                                    */ 02071000
*              /* ABEND EXIT TAKEN DURING CLOSE.  SET MESSAGE ID     */ 02072000
*              /*                                                    */ 02073000
*              /******************************************************/ 02074000
*                                                                  0639 02075000
*              DARGSENT = ABEXSTID;                                0639 02076000
*                                                                  0639 02077000
         L     @08,DDSTRU                                          0639 02078000
         MVI   DARGSENT(@08),X'18'                                 0639 02079000
*            /********************************************************/ 02080000
*            /*                                                      */ 02081000
*            /* THE IOCS DEFINES A  DATA SET.  IF THE                */ 02082000
*            /* DATA SET WAS OPENED (NOT EXTERNAL) THE BUFFER        */ 02083000
*            /* POOL STORAGE IS FREED.                               */ 02084000
*            /* POOL NOT FREED FOR BSAM DATA SET OR IF               */ 02085000
*            /* SOME ERROR CAUSED AREA NOT TO BE GOTTEN.             */ 02086000
*            /*                                                      */ 02087000
*            /********************************************************/ 02088000
*                                                                  0640 02089000
*          IF IOCFLGOP = ON & IOCMACBK = OFF & IOCCBUFF = OFF      0640 02090000
*            THEN                                                  0640 02091000
@RF00638 L     @08,IOCSPTR                                         0640 02092000
         L     @15,IOCEXT(,@08)                                    0640 02093000
         TM    IOCFLGOP(@15),B'00001000'                           0640 02094000
         BNO   @RF00640                                            0640 02095000
         TM    IOCMACBK(@08),B'00010000'                           0640 02096000
         BNZ   @RF00640                                            0640 02097000
         L     @08,DCBPTR                                          0640 02098000
         TM    IOCCBUFF+16(@08),B'00000001'                        0640 02099000
         BNZ   @RF00640                                            0640 02100000
*              DO;                                                 0641 02101000
*                                                                  0641 02102000
*                REG7 = IOCCBA;                                    0642 02103000
         L     REG7,IOCCBA(,@15)                                   0642 02104000
*LFREEP1:        GEN(FREEPOOL (REG7));                             0643 02105000
*                                                                  0643 02106000
LFREEP1  FREEPOOL (REG7)                                                02107000
*              END;                                                0644 02108000
*                                                                  0644 02109000
*        END ENVFREE;                                              0645 02110000
*                                                                  0645 02111000
*                                                                  0645 02112000
@EL00005 DS    0H                                                  0645 02113000
@EF00005 DS    0H                                                  0645 02114000
@ER00005 LM    @14,@12,@SA00005                                    0645 02115000
         BR    @14                                                 0645 02116000
*/********************************************************************/ 02117000
*/*                                                                  */ 02118000
*/* PROCEDURE NAME - DSDATA                                          */ 02119000
*/*                                                                  */ 02120000
*/* FUNCTION - THIS PROCEDURE CHECKS FOR AN ALTERNATE DDNAME,        */ 02121000
*/*            ISSUES THE DEVTYPE MACRO TO DETERMINE IF DATA SET     */ 02122000
*/*            RESIDES ON DIRECT ACCESS AND ISSUES THE RDJFCB MACRO  */ 02123000
*/*            TO DETERMINE THE DATA SET NAME AND IF THE DATA SET    */ 02124000
*/*            CLASS IS SYSOUT OR DD *.                              */ 02125000
*/*                                                                  */ 02126000
*/* INPUT -    THE OPNAGL BUILT BY THE CALLER DEFINING THE DATA SET  */ 02127000
*/*            TO OPEN.                                              */ 02128000
*/*                                                                  */ 02129000
*/* OUTPUT   - THE DATA FROM THE CONTROL BLOCKS READ IS PLACED       */ 02130000
*/*            IN THE IOCS.                                          */ 02131000
*/*                                                                  */ 02132000
*/* ERRORS   -   1. MISSING DD CARD.                                 */ 02133000
*/*                                                                  */ 02134000
*/********************************************************************/ 02135000
*                                                                  0646 02136000
*DSDATA: PROC (JFCDNAME) OPTIONS (SAVEAREA);                       0646 02137000
*                                                                  0646 02138000
DSDATA   STM   @14,@12,12(@13)                                     0646 02139000
         ST    @13,@SA00006+4                                      0646 02140000
         LA    @14,@SA00006                                        0646 02141000
         ST    @14,8(,@13)                                         0646 02142000
         LR    @13,@14                                             0646 02143000
         MVC   @PC00006(4),0(@01)                                  0646 02144000
*        /* RETURN CODE FROM THIS ROUTINE                            */ 02145000
*        DCL DSDRC FIXED (15);                                     0647 02146000
*                                                                  0647 02147000
*        /* DNAME ON JCL CARD TO LOCATE JCL DATA                     */ 02148000
*        DCL JFCDNAME CHAR (8);                                    0648 02149000
*                                                                  0648 02150000
*        /* SAVE THE DATA SET NAME FOR THE USER                      */ 02151000
*        DCL DSNAME CHAR (44) BASED (IOCDSN);                      0649 02152000
*                                                                  0649 02153000
*        /* COUNTER USED IN CHECKING FOR ALTERNATE DDNAMES           */ 02154000
*        DCL DDN FIXED (15);                                       0650 02155000
*        DCL CKDD FIXED (15);                                      0651 02156000
*                                                                  0651 02157000
*        /* THE ALTERNATE DD LIST PASSED AS ARGUMENT                 */ 02158000
*        DCL 1 ALTDLIST BASED (IODADD),                            0652 02159000
*              2 DDLLEN CHAR (2),      /* LIST LENGTH                */ 02160000
*              2 ALTDD (10) CHAR (8);  /* ALTERNATE DDNAMES          */ 02161000
*                                                                  0652 02162000
*        /* DDNAMES THAT MAY HAVE ALTERNATES (POSITIONAL)            */ 02163000
*        DCL DEFDD (10) CHAR (8) INIT ('SYSLIN ','        ',       0653 02164000
*        'SYSLMOD ','SYSLIB  ','SYSIN   ','SYSPRINT','SYSPUNCH',   0653 02165000
*        'SYSUT1  ','SYSUT2  ','SYSUT3  ');                        0653 02166000
*                                                                  0653 02167000
*        /* DCB USED FOR THE RDJFCB                                  */ 02168000
*        DCL READDCB CHAR (96) BASED (ADDR (WORKAREA) + 176);      0654 02169000
*                                                                  0654 02170000
*        DCL JFCBPTR PTR (31);         /* ADDRESS OF JFCB            */ 02171000
*                                                                  0655 02172000
*        /* EXIT LIST USED TO READ THE JFCB                          */ 02173000
*        DCL 1 DCBRLIST BDY (WORD),    /* DCB EXIT LIST              */ 02174000
*              2 DCBRLID CHAR (1),     /* LIST IDENTIFIER            */ 02175000
*              2 DCBRLPTR PTR (24);    /* BLOCK ADDRESS              */ 02176000
*                                                                  0656 02177000
*        DCL 1 DCBEXWRD PTR (31),      /* EXIT ARG LIST              */ 02178000
*              2 DCBEXEND BIT (1);     /* END OF LIST                */ 02179000
*                                                                  0657 02180000
*        DCL 1 DEVAREA BDY (WORD),     /* DEVTYPE AREA               */ 02181000
*              2 * CHAR (2),           /* NOT REFERENCED             */ 02182000
*              2 DEVWORD CHAR (1),     /* DEVIVE BYTE                */ 02183000
*                3 DEVTAPE BIT (1),    /* DEVICE IS TAPE             */ 02184000
*                3 * BIT (1),                                      0658 02185000
*                3 DEVTDA BIT (1),     /* DIRECT ACCESS              */ 02186000
*                3 * BIT (1),                                      0658 02187000
*                3 DEVTUR BIT (1),     /* UNIT RECORD DEVICE         */ 02188000
*              2 * CHAR (5);           /* NOT REFERENCED             */ 02189000
*                                                                  0658 02190000
*        /* DSNAME AND VOLSERS FOR JFCB MODFICATION                  */ 02191000
*        DCL MODJNM CHAR(44) BASED (OPNDSN);                       0659 02192000
*                                                                  0659 02193000
*        DCL 1 MODJVL BASED (OPNVOL),                              0660 02194000
*              2 MODJCNT FIXED(8),                                 0660 02195000
*              2 MODJSERS CHAR(30);                                0660 02196000
*                                                                  0660 02197000
*        /* INHIBIT JFCB WRITE BACK INDICATOR                        */ 02198000
*        DCL JFINHWB CHAR(1) INIT('08'X);                          0661 02199000
*                                                                  0661 02200000
*        /* VOLUME SERIAL NAME LENGTH                                */ 02201000
*        DCL VLSRL FIXED(15) CONSTANT(6);                          0662 02202000
*                                                                  0662 02203000
*        /* INCLUDE THE JFCB PLS DECLARE                             */ 02204000
*                                                                  0663 02205000
*                                                                  0663 02206000
*/* **************************************************************** */ 02207000
*/*                                                                  */ 02208000
*/*                    JOB FILE CONTROL BLOCK                        */ 02209000
*/*                                                                  */ 02210000
*/*  OS/VS2 RELEASE 3.0 AND 3.7 PTF, 03/16/77, LEVEL=1               */ 02211000
*/*                                                                  */ 02212000
*/*  METHOD OF ACCESS                                                */ 02213000
*/*      BAL  - A DSECT CARD SHOULD PRECEDE MACRO CALL.  USING ON    */ 02214000
*/*             INFMJFCB GIVES ADDRESSABILITY FOR ALL SYMBOLS.       */ 02215000
*/*      PL/S - DCL JFCBPTR PTR                                      */ 02216000
*/*                                                                  */ 02217000
*/*  F.E.'S                                                          */ 02218000
*/*      MICROFICHE LISTING - IEFJFCBN                               */ 02219000
*/*                                                                  */ 02220000
*/*  DEVELOPERS                                                      */ 02221000
*/*      BAL LISTING  - SPECIFY LIST=YES ON MACRO CALL.              */ 02222000
*/*      PL/S LISTING - SPECIFY %IHALIST='YES' BEFORE INCLUDE.       */ 02223000
*/*                                                                  */ 02224000
*/*      FOR INTEGRATION A LISTING SHOULD NOT BE REQUESTED.          */ 02225000
*/* **************************************************************** */ 02226000
*                                                                  0663 02227000
*DECLARE                                                           0663 02228000
*  1 INFMJFCB BASED(JFCBPTR) BDY(WORD),                            0663 02229000
*   2 JFCBDSNM CHAR(44) BDY(WORD), /* DATA SET NAME                  */ 02230000
*    3 JFCBQNAM CHAR(8) BDY(WORD), /* PROCESS QUEUE NAME SPECIFIED BY   02231000
*                                     THE QNAME KEYWORD  (TCAM)      */ 02232000
*   2 JFCBELNM CHAR(8) BDY(WORD),  /* ELEMENT NAME OR RELATIVE     0663 02233000
*                                     GENERATION NUMBER.  TYPE OF  0663 02234000
*                                     AREA (INDEX, PRIME OR OVERFLOW)   02235000
*                                     FOR AN INDEXED SEQUENTIAL DATA    02236000
*                                     SET ONLY.                      */ 02237000
*    3 JFCIPLTX CHAR(7) BDY(WORD), /* MODULE NAME OF NETWORK CONTROL    02238000
*                                     PROGRAM  (TCAM)          ICB391*/ 02239000
*   2 JFCBTSDM BIT(8),             /* JOB MANAGEMENT/DATA MANAGEMENT    02240000
*                                     INTERFACE                      */ 02241000
*    3 JFCCAT   BIT(1),            /* DATA SET IS CATALOGED          */ 02242000
*    3 JFCVSL   BIT(1),            /* VOLUME SERIAL LIST HAS BEEN  0663 02243000
*                                     CHANGED                        */ 02244000
*    3 JFCSDS   BIT(1),            /* DATA SET IS A SYSIN OR SYSOUT     02245000
*                                     DATA SET                       */ 02246000
*    3 JFCTTR   BIT(1),            /* A JOB STEP IS TO BE RESTARTED.    02247000
*                                     USE JFCBOTTR INSTEAD OF      0663 02248000
*                                     DS1LSTAR FIELD TO REPOSITION 0663 02249000
*                                     DATA SET IF AUTOMATIC STEP   0663 02250000
*                                     RESTART OCCURS.  (THIS JOB HAD    02251000
*                                     ABEND PROCESSING FOR A DATA SET   02252000
*                                     OPENED FOR MOD.)               */ 02253000
*    3 JFCNWRIT BIT(1),            /* DO NOT WRITE BACK THE JFCB   0663 02254000
*                                     DURING OPEN PROCESSING         */ 02255000
*    3 JFCNDSCB BIT(1),            /* DO NOT MERGE DSCB OR LABEL   0663 02256000
*                                     FIELDS INTO THIS JFCB          */ 02257000
*    3 JFCNDCB  BIT(1),            /* DO NOT MERGE DCB FIELDS INTO 0663 02258000
*                                     THIS JFCB                      */ 02259000
*    3 JFCPAT   BIT(1),            /* THE PATTERNING DSCB IS COMPLETE*/ 02260000
*   2 JFCBDSCB CHAR(3) BDY(WORD,2),/* TTR ADDRESS OF THE FORMAT 1  0663 02261000
*                                     DSCB FOR DATA SET PART ON THE     02262000
*                                     FIRST VOLUME OF THE DATA SET 0663 02263000
*                                                              ICB398*/ 02264000
*   2 JFCFCBID CHAR(4) BDY(WORD),  /* FORMS CONTROL BUFFER IMAGE   0663 02265000
*                                     IDENTIFICATION FOR THE 3211  0663 02266000
*                                     PRINTER OR DATA PROTECTION   0663 02267000
*                                     IMAGE IDENTIFICATION FOR THE 0663 02268000
*                                     3525 CARD PUNCH WITH THE READ     02269000
*                                     AND PRINT FEATURES OR FORMAT 0663 02270000
*                                     RECORD ID                MDC007*/ 02271000
*    3 JFCBFRID CHAR(4) BDY(WORD), /* LAST 4 CHARACTERS OF A PDS   0663 02272000
*                                     MEMBER TO BE USED IN THE     0663 02273000
*                                     INTERPRETATION OF DOCUMENTS  0663 02274000
*                                     READ BY 3886 DEVICE FOR THIS 0663 02275000
*                                     STEP                     MDC024*/ 02276000
*     4 JFCAMCRO CHAR(2) BDY(WORD), /* VSAM CHECKPOINT/RESTART OPTION   02277000
*                                     INDICATORS               ICB438*/ 02278000
*     4 JFCAMSTR FIXED(15) BDY(WORD,3), /* NUMBER OF STRINGS   ICB438*/ 02279000
*   2 JFCBADBF FIXED(15) BDY(WORD), /* NUMBER OF DATA BUFFERS  ICB438*/ 02280000
*   2 JFCNLREC FIXED(15) BDY(WORD,3), /* LOGICAL RECORD LENGTH FOR 0663 02281000
*                                     VSAM                     ICB438*/ 02282000
*   2 JFCVINDX FIXED(15) BDY(WORD), /* MASS STORAGE SYSTEM         0663 02283000
*                                     COMMUNICATOR (MSSC) VOLUME   0663 02284000
*                                     SELECTION INDEX              0663 02285000
*                                     (MDC308)               @Z30LP9A*/ 02286000
*   2 JFCBLTYP BIT(8) BDY(WORD,3), /* LABEL TYPE                     */ 02287000
*    3 JFCRSV38 BIT(1),            /* RESERVED                       */ 02288000
*    3 JFCBAL   BIT(1),            /* AMERICAN NATIONAL STANDARD TAPE   02289000
*                                     LABELS (AL OR IF BIT 4 IS ALSO    02290000
*                                     ON, AUL)                       */ 02291000
*    3 JFCBLTM  BIT(1),            /* UNLABELLED TAPE CREATED BY DOS    02292000
*                                     MAY HAVE LEADING TAPE MARK.  0663 02293000
*                                     OPEN/CLOSE/EOV AND RESTART MUST   02294000
*                                     SPACE OVER A TAPE MARK IF ONE     02295000
*                                     EXISTS.                  ICB398*/ 02296000
*    3 JFCBLP   BIT(1),            /* BYPASS LABEL PROCESSING        */ 02297000
*    3 JFCSUL   BIT(1),            /* USER LABEL                     */ 02298000
*    3 JFCNSL   BIT(1),            /* NONSTANDARD LABEL              */ 02299000
*    3 JFCSL    BIT(1),            /* STANDARD LABEL                 */ 02300000
*    3 JFCNL    BIT(1),            /* NO LABEL                       */ 02301000
*   2 JFCBOTTR CHAR(3) BDY(WORD,4),/* DASD MOD DATA SET - IF AUTOMATIC  02302000
*                                     STEP RESTART WAS REQUESTED, TTR   02303000
*                                     OF THE END-OF-DATA INDICATOR 0663 02304000
*                                     EXISTING WHEN THE DATA SET WAS    02305000
*                                     FIRST OPENED DURING THE      0663 02306000
*                                     ORIGINAL EXECUTION OF THE    0663 02307000
*                                     CURRENT STEP                   */ 02308000
*    3 JFCBUFOF PTR(8),            /* TAPE DATA SET - THIS FIELD   0663 02309000
*                                     CONTAINS THE BUFFER OFFSET (DCB   02310000
*                                     SUBPARAMETER VALUE)            */ 02311000
*     4 JFCBFOFL BIT(1),           /* IF 1, THE OFFSET EQUALS FOUR 0663 02312000
*                                     AND THE BUFFER OFFSET FIELD OF    02313000
*                                     EACH BLOCK (D-FORMAT RECORDS)     02314000
*                                     CONTAINS THE BLOCK LENGTH    0663 02315000
*                                     (SPECIFIED BY BUFOFF=L).     0663 02316000
*                                     IF 0, THE OFFSET IS AS       0663 02317000
*                                     SPECIFIED IN THE REMAINING   0663 02318000
*                                     SEVEN BITS AND THE BUFFER    0663 02319000
*                                     OFFSET FIELD OF EACH BLOCK DOES   02320000
*                                     NOT CONTAIN THE BLOCK LENGTH.  */ 02321000
*    3 JFCBFLSQ FIXED(15),         /* FOR MAGNETIC TAPE DEVICES,   0663 02322000
*                                     FILE SEQUENCE NUMBER           */ 02323000
*     4 JFCFUNC  BIT(8),           /* FUNCTION INDICATORS FOR THE  0663 02324000
*                                     3525 CARD PUNCH (SPECIFIED BY     02325000
*                                     THE FUNC PARAMETER)      ICB392*/ 02326000
*      5 JFCFNCBI BIT(1),          /* I - INTERPRET (PUNCH AND PRINT    02327000
*                                     TWO LINES)               ICB392*/ 02328000
*      5 JFCFNCBR BIT(1),          /* R - READ                 ICB392*/ 02329000
*      5 JFCFNCBP BIT(1),          /* P - PUNCH                ICB392*/ 02330000
*      5 JFCFNCBW BIT(1),          /* W - PRINT                ICB392*/ 02331000
*      5 JFCFNCBD BIT(1),          /* D - DATA PROTECTION      ICB392*/ 02332000
*      5 JFCFNCBX BIT(1),          /* X - THIS DATA SET IS TO BE   0663 02333000
*                                     PRINTED.  THIS MAY BE CODED  0663 02334000
*                                     WITH PW OR RPW TO DISTINGUISH     02335000
*                                     THE DATA SET TO BE PRINTED FROM   02336000
*                                     THE DATA SET TO BE PUNCHED.  0663 02337000
*                                                              ICB392*/ 02338000
*      5 JFCFNCBT BIT(1),          /* T - TWO-LINE PRINT SUPPORT   0663 02339000
*                                     REQUEST.  THE SECOND PRINT LINE   02340000
*                                     IS LOCATED ON CARD LINE THREE.    02341000
*                                                              ICB392*/ 02342000
*      5 JFCRSV31 BIT(1),          /* RESERVED                 ICB392*/ 02343000
*   2 JFCBVLSQ FIXED(15),          /* VOLUME SEQUENCE NUMBER         */ 02344000
*   2 JFCBMASK CHAR(8) BDY(WORD),  /* DATA MANAGEMENT TASK           */ 02345000
*    3 JFCBOPS1 CHAR(5),           /* OPEN ROUTINE INTERNAL SWITCHES */ 02346000
*    3 JFCBFLG1 BIT(8),            /* FLAG BYTE                      */ 02347000
*     4 JFCSTAND BIT(1),           /* VOLUME LABEL PROCESSING      0663 02348000
*                                     STANDARD                       */ 02349000
*     4 JFCSLCRE BIT(1),           /* CREATION OF A STANDARD LABEL 0663 02350000
*                                     IS NECESSARY                   */ 02351000
*     4 JFCSLDES BIT(1),           /* DESTRUCTION OF A STANDARD LABEL   02352000
*                                     IS NECESSARY                   */ 02353000
*     4 JFCDUAL  BIT(1),           /* DUAL-DENSITY CHECK DETECTED    */ 02354000
*     4 JFCOPEN  BIT(4),           /* OPEN ROUTINE INTERNAL SWITCHES */ 02355000
*      5 *        BIT(3),          /* OPEN ROUTINE INTERNAL SWITCHES */ 02356000
*      5 JFCBPWBP BIT(1),          /* PASSWORD BYPASS INDICATOR    0663 02357000
*                                                              MDC010*/ 02358000
*    3 JFCBFLG2 BIT(8),            /* FLAG BYTE OF OPEN SWITCHES     */ 02359000
*     4 JFCINOP  BIT(1),           /* TREAT THE INOUT OPTION OF OPEN    02360000
*                                     AS INPUT                       */ 02361000
*     4 JFCOUTOP BIT(1),           /* TREAT THE OUTIN OPTION OF OPEN    02362000
*                                     AS OUTPUT                      */ 02363000
*     4 JFCDEFER BIT(1),           /* SET ONLY IN A JFCB RECORDED IN    02364000
*                                     A DATA SET DESCRIPTOR RECORD 0663 02365000
*                                     (DSDR) BY THE CHECKPOINT     0663 02366000
*                                     ROUTINE.  INDICATES THAT THE 0663 02367000
*                                     DATA SET RELATED TO THE JFCB IS   02368000
*                                     BEING PROCESSED SEQUENTIALLY,     02369000
*                                     AT THE CHECKPOINT, ON A VOLUME    02370000
*                                     OTHER THAN THE VOLUME ON WHICH    02371000
*                                     PROCESSING BEGAN IN THE CURRENT   02372000
*                                     STEP.  WHEN RESTART OCCURS,  0663 02373000
*                                     THIS BIT CAUSES DEFERRED VOLUME   02374000
*                                     MOUNTING.                      */ 02375000
*      5 JFCNRPS  BIT(1),          /* USE BY OPEN ROUTINES - SET TO     02376000
*                                     INDICATE THAT THIS DATA SET  0663 02377000
*                                     RESIDES ON A NON-RPS DEVICE. 0663 02378000
*                                     RESET TO ZERO WHEN OPEN      0663 02379000
*                                     PROCESSING IS COMPLETED. ICB495*/ 02380000
*     4 JFCMODNW BIT(1),           /* DISPOSITION OF THIS DATA SET 0663 02381000
*                                     HAS BEEN CHANGED FROM MOD TO 0663 02382000
*                                     NEW.  DISPOSITION (IN JFCBIND2)   02383000
*                                     WILL BE RESTORED TO MOD AFTER     02384000
*                                     OPEN.                          */ 02385000
*     4 JFCSDRPS BIT(1),           /* USE SEARCH DIRECT FOR        0663 02386000
*                                     ROTATIONAL POSITION SENSING  0663 02387000
*                                     (RPS) DEVICES            ICB398*/ 02388000
*     4 JFCTRACE BIT(1),           /* GTF TRACE IS TO OCCUR DURING 0663 02389000
*                                     OPEN/CLOSE/EOV AND DYNAMIC   0663 02390000
*                                     ALLOCATION PROCESSING OF DCB 0663 02391000
*                                                              ICB392*/ 02392000
*     4 JFCBBUFF BIT(1),           /* INDICATOR TO OPEN THAT A     0663 02393000
*                                     NON-ZERO VALUE IN JFCBOTTR IS     02394000
*                                     NOT TO PREVENT THE NORMAL    0663 02395000
*                                     STORING BY OPEN OF A TTR IN  0663 02396000
*                                     JFCBOTTR.  BEFORE OPEN -     0663 02397000
*                                     JFCBUFOF (OFFSET 67) CONTAINS     02398000
*                                     A BUFFER OFFSET OR INVALID   0663 02399000
*                                     INFORMATION RESULTING FROM A 0663 02400000
*                                     JFCB-TO-JFCB MERGE.  AFTER   0663 02401000
*                                     OPEN - OPEN MAY HAVE STORED A     02402000
*                                     TTR IN JFCBOTTR (OFFSET 67), IN   02403000
*                                     WHICH CASE OPEN WILL HAVE SET     02404000
*                                     THIS BIT TO ZERO.              */ 02405000
*     4 JFCRCTLG BIT(1),           /* OPEN HAS UPDATED THE TTR.    0663 02406000
*                                     SCHEDULER STEP TERMINATION   0663 02407000
*                                     ROUTINE IS TO RECATALOG THIS 0663 02408000
*                                     DATA SET AND PLACE IN THE    0663 02409000
*                                     CATALOG ENTRY THE DSCB TTR   0663 02410000
*                                     CONTAINED IN JFCBDSCB IF THIS     02411000
*                                     DATA SET IS CATALOGED.   ICB398*/ 02412000
*    3 JFCBOPS2 BIT(8),            /* OPEN ROUTINE INTERNAL SWITCHES */ 02413000
*   2 JFCBCRDT CHAR(3) BDY(WORD),  /* DATA SET CREATION DATE (YDD, 0663 02414000
*                                     Y=YEAR AND DD=DAY)             */ 02415000
*   2 JFCBXPDT CHAR(3) BDY(WORD,4),/* DATA SET EXPIRATION DATE (YDD) */ 02416000
*   2 JFCBIND1 BIT(8),             /* INDICATOR BYTE 1               */ 02417000
*    3 JFCRLSE  BIT(2),            /* RELEASE EXTERNAL STORAGE       */ 02418000
*    3 JFCLOC   BIT(2),            /* DATA SET HAS BEEN LOCATED      */ 02419000
*    3 JFCADDED BIT(2),            /* NEW VOLUME HAS BEEN ADDED TO 0663 02420000
*                                     THE DATA SET                   */ 02421000
*    3 JFCGDG   BIT(1),            /* DATA SET IS A MEMBER OF A    0663 02422000
*                                     GENERATION DATA GROUP          */ 02423000
*    3 JFCPDS   BIT(1),            /* DATA SET IS A MEMBER OF A    0663 02424000
*                                     PARTITIONED DATA SET           */ 02425000
*   2 JFCBIND2 BIT(8),             /* INDICATOR BYTE 2               */ 02426000
*    3 JFCDISP  BIT(2),            /* BIT PATTERN FOR NEW, MOD, OLD  */ 02427000
*    3 JFCSECUR BIT(2),            /* DATA SET SECURITY              */ 02428000
*    3 JFCSHARE BIT(1),            /* SHARED DATA SET                */ 02429000
*    3 JFCENT   BIT(1),            /* DELETE THIS JFCB BEFORE      0663 02430000
*                                     ALLOCATION FOR A RESTARTED   0663 02431000
*                                     GENERATION DATA GROUP          */ 02432000
*    3 JFCREQ   BIT(1),            /* STORAGE VOLUME REQUESTED       */ 02433000
*    3 JFCTEMP  BIT(1),            /* TEMPORARY DATA SET             */ 02434000
*   2 JFCAMPTR PTR(31),            /* POINTER TO AMPBLK FOR        0663 02435000
*                                     ADDITIONAL VSAM PARAMETERS   0663 02436000
*                                                              ICB438*/ 02437000
*    3 JFCBUFRQ CHAR(1),           /* NUMBER OF BUFFERS REQUIRED FOR    02438000
*                                     EACH LINE (QTAM)               */ 02439000
*     4 JFCBUFNO CHAR(1),          /* NUMBER OF BUFFERS REQUIRED FOR    02440000
*                                     THIS DATA SET (ACCESS METHODS     02441000
*                                     OTHER THAN TCAM AND QTAM)      */ 02442000
*      5 JFCBUFIN BIT(4),          /* THE NUMBER OF BUFFERS ASSIGNED    02443000
*                                     INITIALLY FOR RECEIVING      0663 02444000
*                                     OPERATIONS FOR EACH LINE IN A     02445000
*                                     LINE GROUP  (TCAM)       MDC021*/ 02446000
*      5 JFCBFOUT BIT(4),          /* THE NUMBER OF BUFFERS ASSIGNED    02447000
*                                     INITIALLY FOR SENDING        0663 02448000
*                                     OPERATIONS FOR EACH LINE IN A     02449000
*                                     LINE GROUP  (TCAM)       MDC022*/ 02450000
*    3 JFCBGNCP PTR(8),            /* FOR GAM, THIS FIELD IS USED FOR   02451000
*                                     THE NUMBER OF IOB'S CONSTRUCTED   02452000
*                                     BY THE OPEN ROUTINE.  MAXIMUM     02453000
*                                     NUMBER IS 99.            MDC025*/ 02454000
*     4 JFCBHIAR CHAR(1),          /* BUFFER POOL LOCATION IN MAIN 0663 02455000
*                                     STORAGE (HIERARCHY)            */ 02456000
*      5 JFCBFALN CHAR(1),         /* BUFFER ALIGNMENT               */ 02457000
*       6 JFCBFTEK BIT(8),         /* BUFFERING TECHNIQUE            */ 02458000
*        7 JFCHIER  BIT(1),        /* BITS 0 AND 5 DESCRIBE MAIN   0663 02459000
*                                     STORAGE HIERARCHY.  BOTH BITS     02460000
*                                     OFF, HIERARCHY 0.  BIT 0 OFF 0663 02461000
*                                     AND BIT 5 ON, HIERARCHY 1.     */ 02462000
*        7 JFCBBFTA BIT(2),        /* A - FOR QSAM LOCATE MODE     0663 02463000
*                                     PROCESSING OF SPANNED RECORDS,    02464000
*                                     AUTOMATIC RECORD AREA        0663 02465000
*                                     CONSTRUCTION DURING LOGICAL  0663 02466000
*                                     RECORD INTERFACE PROCESSING. 0663 02467000
*                                     OPEN IS TO CONSTRUCT A RECORD     02468000
*                                     AREA IF IT AUTOMATICALLY     0663 02469000
*                                     CONSTRUCTS BUFFERS.            */ 02470000
*         8 JFCSIM   BIT(1),       /* S - SIMPLE BUFFERING           */ 02471000
*         8 JFCBBFTR BIT(1),       /* R - FOR BSAM CREATE BDAM     0663 02472000
*                                     PROCESSING OR BDAM PROCESSING     02473000
*                                     OF UNBLOCKED SPANNED RECORDS,     02474000
*                                     SOFTWARE TRACK OVERFLOW.  OPEN    02475000
*                                     FORMS A SEGMENT WORK AREA POOL    02476000
*                                     AND STORES THE ADDRESS OF THE     02477000
*                                     SEGMENT WORK AREA CONTROL BLOCK   02478000
*                                     IN THE DCBEOBW FIELD OF THE  0663 02479000
*                                     DATA CONTROL BLOCK.  WRITE USES   02480000
*                                     A SEGMENT WORK AREA TO WRITE A    02481000
*                                     RECORD AS ONE OR MORE SEGMENTS.   02482000
*                                     FOR BSAM INPUT PROCESSING OF 0663 02483000
*                                     UNBLOCKED SPANNED RECORDS WITH    02484000
*                                     KEYS, RECORD OFFSET PROCESSING.   02485000
*                                     READ READS ONE RECORD SEGMENT     02486000
*                                     INTO THE RECORD AREA.  THE   0663 02487000
*                                     FIRST SEGMENT OF A RECORD IS 0663 02488000
*                                     PRECEDED IN THE RECORD AREA BY    02489000
*                                     THE KEY.  SUBSEQUENT SEGMENTS     02490000
*                                     ARE AT AN OFFSET EQUAL TO THE     02491000
*                                     KEY LENGTH.                    */ 02492000
*        7 JFCEXC   BIT(1),        /* E - EXCHANGE BUFFERING         */ 02493000
*        7 JFCDYN   BIT(1),        /* DYNAMIC BUFFERING              */ 02494000
*        7 JFCHIER1 BIT(1),        /* HIERARCHY 1 MAIN STORAGE       */ 02495000
*        7 JFCDWORD BIT(1),        /* D - DOUBLE WORD BOUNDARY       */ 02496000
*        7 JFCFWORD BIT(1),        /* F - FULL WORD NOT A DOUBLE   0663 02497000
*                                     WORD BOUNDARY                  */ 02498000
*    3 JFCBUFL  FIXED(15) BDY(WORD,3), /* BUFFER LENGTH              */ 02499000
*   2 JFCEROPT BIT(8),             /* ERROR OPTION.  DISPOSITION OF     02500000
*                                     PERMANENT ERRORS IF USER     0663 02501000
*                                     RETURNS FROM A SYNCHRONOUS   0663 02502000
*                                     ERROR EXIT  (QSAM)             */ 02503000
*    3 JFCACC   BIT(1),            /* ACCEPT                         */ 02504000
*    3 JFCSKP   BIT(1),            /* SKIP                           */ 02505000
*    3 JFCABN   BIT(1),            /* ABNORMAL END OF TASK           */ 02506000
*    3 JFCTOPT  BIT(1),            /* ON-LINE TERMINAL TEST        0663 02507000
*                                     (BTAM)                   ICB349*/ 02508000
*    3 JFCRSV02 BIT(1),            /* RESERVED                       */ 02509000
*    3 JFCRSV03 BIT(1),            /* RESERVED                       */ 02510000
*    3 JFCRSV04 BIT(1),            /* RESERVED                       */ 02511000
*    3 JFCRSV05 BIT(1),            /* RESERVED                       */ 02512000
*   2 JFCTRTCH CHAR(1) BDY(WORD,2);/* TAPE RECORDING TECHNIQUE     0663 02513000
*                                     FOR 7-TRACK TAPE               */ 02514000
*                                                                  0663 02515000
*DECLARE                                                           0664 02516000
*  1 JFCKEYLE CHAR(1) DEF(JFCTRTCH) BDY(WORD,2),                   0664 02517000
*                                  /* DIRECT ACCESS KEY LENGTH       */ 02518000
*   2 JFCCODE  BIT(8) BDY(BYTE),   /* CONVERSION CODE (PAPER TAPE)   */ 02519000
*    3 JFCNOCON BIT(1),            /* N - NO CONVERSION              */ 02520000
*    3 JFCBCD   BIT(1),            /* I - IBM BCD                    */ 02521000
*    3 JFCFRI   BIT(1),            /* F - FRIDEN                     */ 02522000
*    3 JFCBUR   BIT(1),            /* B - BURROUGHS                  */ 02523000
*    3 JFCNCR   BIT(1),            /* C - NATIONAL CASH REGISTER     */ 02524000
*    3 JFCASCII BIT(1),            /* A - ASCII (8-TRACK)            */ 02525000
*    3 JFCTTY   BIT(1),            /* T - TELETYPE                   */ 02526000
*    3 JFCRSV32 BIT(1);            /* RESERVED                       */ 02527000
*                                                                  0664 02528000
*DECLARE                                                           0665 02529000
*  1 JFCSTACK BIT(8) DEF(JFCTRTCH) BDY(WORD,2),                    0665 02530000
*                                  /* STACKER SELECTION (CARD READER,   02531000
*                                     (CARD PUNCH)                   */ 02532000
*   2 JFCMODE  BIT(8) BDY(WORD,2), /* MODE OF OPERATION (CARD READER,   02533000
*                                     (CARD PUNCH)             ICB394*/ 02534000
*    3 JFCBIN   BIT(1),            /* C - COLUMN BINARY MODE         */ 02535000
*    3 JFCEBCD  BIT(1),            /* E - EBCDIC MODE                */ 02536000
*    3 JFCMODEO BIT(1),            /* O - OPTICAL MARK READ MODE   0665 02537000
*                                     (3505 ONLY)              ICB394*/ 02538000
*    3 JFCMODER BIT(1),            /* R - READ COLUMN ELIMINATE MODE    02539000
*                                     (3505 AND 3525 WITH READ     0665 02540000
*                                     FEATURE)                 ICB394*/ 02541000
*    3 JFCRSV06 BIT(1),            /* RESERVED                       */ 02542000
*    3 JFCRSV07 BIT(1),            /* RESERVED                       */ 02543000
*    3 JFCTWO   BIT(1),            /* 2 - STACKER TWO                */ 02544000
*    3 JFCONE   BIT(1);            /* 1 - STACKER ONE                */ 02545000
*                                                                  0665 02546000
*DECLARE                                                           0666 02547000
*  1 JFCSPPRT DEF(JFCTRTCH) BDY(WORD,2),                           0666 02548000
*   2 JFCPRTSP BIT(8) BDY(WORD,2), /* NORMAL PRINTER SPACING         */ 02549000
*   2 JFCDEN   BIT(8),             /* TAPE DENSITY - 2400/3400 SERIES   02550000
*                                     MAGNETIC TAPE UNITS            */ 02551000
*   2 JFCBABFS PTR(24) BDY(WORD,4),/* TOTAL BUFFER SIZE FOR ALL VSAM    02552000
*                                     BUFFERS                  ICB438*/ 02553000
*    3 JFCLIMCT CHAR(3) BDY(WORD,4),/* SEARCH LIMIT (BDAM)           */ 02554000
*     4 *        CHAR(1),          /* RESERVED                       */ 02555000
*     4 JFCTRKBL CHAR(2) BDY(WORD),/* DATA SET OPENED FOR MOD - IF 0666 02556000
*                                     AUTOMATIC STEP RESTART WAS   0666 02557000
*                                     REQUESTED, TRACK BALANCE     0666 02558000
*                                     EXISTING WHEN THE DATA SET WAS    02559000
*                                     FIRST OPENED DURING THE      0666 02560000
*                                     ORIGINAL EXECUTION OF THE    0666 02561000
*                                     CURRENT STEP                   */ 02562000
*   2 JFCDSORG BIT(16) BDY(WORD,3),/* DATA SET ORGANIZATION BEING  0666 02563000
*                                     USED                           */ 02564000
*    3 JFCDSRG1 BIT(8),            /* BYTE 1 OF JFCDSORG             */ 02565000
*     4 JFCORGIS BIT(1),           /* INDEXED SEQUENTIAL             */ 02566000
*     4 JFCORGPS BIT(1),           /* PHYSICAL SEQUENTIAL            */ 02567000
*     4 JFCORGDA BIT(1),           /* DIRECT                         */ 02568000
*     4 JFCORGCX BIT(1),           /* BTAM OR QTAM LINE GROUP  MDC011*/ 02569000
*     4 JFCORGCQ BIT(1),           /* QTAM DIRECT ACCESS MESSAGE   0666 02570000
*                                     QUEUE                    MDC012*/ 02571000
*     4 JFCORGMQ BIT(1),           /* QTAM PROBLEM PROGRAM MESSAGE 0666 02572000
*                                     QUEUE                    MDC013*/ 02573000
*     4 JFCORGPO BIT(1),           /* PARTITIONED                    */ 02574000
*     4 JFCORGU  BIT(1),           /* UNMOVABLE - THE DATA CONTAINS     02575000
*                                     LOCATION DEPENDENT INFORMATION */ 02576000
*    3 JFCDSRG2 BIT(8),            /* BYTE 2 OF JFCDSORG             */ 02577000
*     4 JFCORGGS BIT(1),           /* GRAPHICS                       */ 02578000
*     4 JFCORGTX BIT(1),           /* TCAM LINE GROUP          MDC014*/ 02579000
*     4 JFCORGTQ BIT(1),           /* TCAM MESSAGE QUEUE       MDC015*/ 02580000
*     4 JFCRSV13 BIT(1),           /* RESERVED, BINARY ZERO          */ 02581000
*     4 JFCORGAM BIT(1),           /* VSAM                     ICB438*/ 02582000
*     4 JFCORGTR BIT(1),           /* TCAM 3705                MDC016*/ 02583000
*     4 JFCRSV15 BIT(1),           /* RESERVED, BINARY ZERO          */ 02584000
*     4 JFCRSV16 BIT(1),           /* RESERVED, BINARY ZERO          */ 02585000
*   2 JFCRECFM BIT(8) BDY(WORD),   /* RECORD FORMAT                  */ 02586000
*    3 JFCRCFM  BIT(3),            /* RECORD FORMAT (USASI/USASCII)     02587000
*                                                              MDC023*/ 02588000
*     4 JFCFMREC BIT(2),           /* BITS INDICATING RECORD FORMAT  */ 02589000
*     4 JFCRFO   BIT(1),           /* T - TRACK OVERFLOW             */ 02590000
*    3 JFCRFB   BIT(1),            /* B - BLOCKED - MAY NOT OCCUR  0666 02591000
*                                     WITH UNDEFINED                 */ 02592000
*    3 JFCRFS   BIT(1),            /* S - FOR FIXED LENGTH RECORD  0666 02593000
*                                     FORMAT, STANDARD BLOCKS.  NO 0666 02594000
*                                     TRUNCATED BLOCKS OR UNFILLED 0666 02595000
*                                     TRACKS ARE EMBEDDED IN THE DATA   02596000
*                                     SET.                         0666 02597000
*                                     FOR VARIABLE LENGTH RECORD   0666 02598000
*                                     FORMAT, SPANNED RECORDS.       */ 02599000
*    3 JFCCHAR  BIT(2),            /* CONTROL CHARACTER              */ 02600000
*    3 *        BIT(1),            /* RESERVED                       */ 02601000
*   2 JFCOPTCD BIT(8) BDY(WORD,2), /* OPTION CODES                   */ 02602000
*    3 JFCWVCSP BIT(1),            /* QSAM-BSAM-BPAM - W - WRITE   0666 02603000
*                                     VALIDITY CHECK                 */ 02604000
*     4 JFCWVCIS BIT(1),           /* BISAM-QISAM - W - WRITE      0666 02605000
*                                     VALIDITY CHECK                 */ 02606000
*      5 JFCWVCBD BIT(1),          /* BDAM - W - WRITE VALIDITY    0666 02607000
*                                     CHECK                          */ 02608000
*       6 JFCSDNAM BIT(1),         /* TCAM - SOURCE OR DESTINATION 0666 02609000
*                                     NAME PRECEDES MESSAGE (AFTER 0666 02610000
*                                     CONTROL BYTE)                  */ 02611000
*    3 JFCALLOW BIT(1),            /* QSAM-BSAM-BPAM - U - ALLOW A 0666 02612000
*                                     DATA CHECK CAUSED BY AN      0666 02613000
*                                     INVALID CHARACTER (1403      0666 02614000
*                                     PRINTER WITH UCS FEATURE)      */ 02615000
*     4 JFCRSV17 BIT(1),           /* RESERVED                       */ 02616000
*      5 JFCOVER  BIT(1),          /* BDAM - TRACK OVERFLOW          */ 02617000
*       6 JFCWUMSG BIT(1),         /* TCAM - WORK UNIT IS A MESSAGE     02618000
*                                     (DEFAULT WORK UNIT IS A RECORD)*/ 02619000
*    3 JFCPCIBT BIT(1),            /* QSAM-BSAM-BPAM - C - CHAINED 0666 02620000
*                                     SCHEDULING USING THE PROGRAM 0666 02621000
*                                     CONTROLLED INTERRUPTION        */ 02622000
*     4 JFCMAST  BIT(1),           /* BISAM-QISAM - M - MASTER     0666 02623000
*                                     INDEXES                        */ 02624000
*      5 JFCEXT   BIT(1),          /* BDAM - E - EXTENDED SEARCH     */ 02625000
*       6 JFCCBWU  BIT(1),         /* TCAM - CONTROL BYTE PRECEDES 0666 02626000
*                                     WORK UNIT                      */ 02627000
*    3 JFCBCKPT BIT(1),            /* QSAM-BSAM-BPAM - BYPASS      0666 02628000
*                                     EMBEDDED DOS CHECKPOINT      0666 02629000
*                                     RECORDS ON TAPE         ICB398*/  02630000
*     4 JFCIND   BIT(1),           /* BISAM-QISAM - I - INDEPENDENT     02631000
*                                     OVERFLOW AREA                  */ 02632000
*      5 JFCFEED  BIT(1),          /* BDAM - F - FEEDBACK            */ 02633000
*    3 JFCRSV18 BIT(1),            /* RESERVED                       */ 02634000
*     4 JFCCYL   BIT(1),           /* BISAM-QISAM - Y - CYLINDER   0666 02635000
*                                     OVERFLOW AREA                  */ 02636000
*      5 JFCACT   BIT(1),          /* BDAM - A - ACTUAL ADRESSING    */ 02637000
*       6 JFCOPTQ  BIT(1),         /* USASI/USASCII - EBCDIC TO ASCII   02638000
*                                     OR ASCII TO EBCDIC TRANSLATION    02639000
*                                     REQUIRED                       */ 02640000
*    3 JFCREDUC BIT(1),            /* QSAM-BSAM-BPAM-EXCP - Z -    0666 02641000
*                                     USE REDUCED ERROR RECOVERY   0666 02642000
*                                     PROCEDURE (MAGNETIC TAPE)      */ 02643000
*     4 JFCRSV19 BIT(1),           /* RESERVED                       */ 02644000
*      5 JFCRSV20 BIT(1),          /* RESERVED                       */ 02645000
*       6 JFCSRCHD BIT(1),         /* QSAM-BSAM-BPAM - USE SEARCH  0666 02646000
*                                     DIRECT (SD) INSTEAD OF SEARCH     02647000
*                                     PREVIOUS ON ROTATIONAL POSITION   02648000
*                                     SENSING (RPS) DEVICE.  (DIRECT    02649000
*                                     ACCESS)                        */ 02650000
*    3 JFCRSV21 BIT(1),            /* RESERVED                       */ 02651000
*     4 JFCDEL   BIT(1),           /* BISAM-QISAM - L - DELETE     0666 02652000
*                                     OPTION                         */ 02653000
*      5 JFCRSV22 BIT(1),          /* RESERVED                       */ 02654000
*    3 JFCOPTJ  BIT(1),            /* QSAM-BSAM-BPAM - J - 3800    0666 02655000
*                                     CONTROL CHARACTER            0666 02656000
*                                     (MDC301)               @Z40MP9A*/ 02657000
*     4 JFCREORG BIT(1),           /* BISAM-QISAM - R -            0666 02658000
*                                     REORGANIZATION CRITERIA        */ 02659000
*      5 JFCREL   BIT(1),          /* BDAM - R - RELATIVE BLOCK    0666 02660000
*                                     ADDRESSING                     */ 02661000
*   2 JFCBLKSI FIXED(15) BDY(WORD,3), /* MAXIMUM BLOCK SIZE          */ 02662000
*    3 JFCBUFSI FIXED(15) BDY(WORD,3), /* MAXIMUM BUFFER SIZE        */ 02663000
*     4 JFCBAXBF FIXED(15) BDY(WORD,3), /* NUMBER OF INDEX BUFFERS 0666 02664000
*                                     (VSAM)                   ICB438*/ 02665000
*   2 JFCAMSYN CHAR(8) BDY(WORD),  /* MODULE NAME FOR SYNAD ROUTINE     02666000
*                                     FOR VSAM                 ICB438*/ 02667000
*    3 JFCLRECL FIXED(15) BDY(WORD), /* LOGICAL RECORD LENGTH        */ 02668000
*    3 JFCNCP   CHAR(1) BDY(WORD,3), /* NUMBER OF CHANNEL PROGRAMS.     02669000
*                                     NUMBER OF READ OR WRITE      0666 02670000
*                                     REQUESTS WHICH MAY BE ISSUED 0666 02671000
*                                     PRIOR TO A CHECK.  NUMBER OF 0666 02672000
*                                     IOB'S GENERATED.  (MAXIMUM   0666 02673000
*                                     NUMBER IS 99.)               0666 02674000
*                                     NOTE - GAM USES JFCBFTEK FOR 0666 02675000
*                                     THIS INFORMATION AND DOES    0666 02676000
*                                     NOT USE THIS FIELD AT ALL.     */ 02677000
*     4 JFCBUFMX CHAR(1),          /* THE MAXIMUM NUMBER OF BUFFERS     02678000
*                                     TO BE USED FOR DATA TRANSFER 0666 02679000
*                                     FOR EACH LINE IN THIS LINE   0666 02680000
*                                     GROUP  (TCAM)                  */ 02681000
*    3 JFCNTM   CHAR(1) BDY(WORD,4), /* THE NUMBER OF TRACKS THAT  0666 02682000
*                                     DETERMINE THE DEVELOPMENT OF A    02683000
*                                     MASTER INDEX.  MAXIMUM NUMBER     02684000
*                                     IS 99.  (ISAM)                 */ 02685000
*     4 JFCBFSEQ PTR(8),           /* TAPE POSITIONING INFORMATION 0666 02686000
*                                     FOR CHECKPOINT RESTART.  THIS     02687000
*                                     FIELD IS USED TO PASS A      0666 02688000
*                                     PHYSICAL FILE SEQUENCE COUNT 0666 02689000
*                                     FROM CHECKPOINT TO RESTART.  0666 02690000
*                                     THE COUNT TELLS THE PHYSICAL 0666 02691000
*                                     POSITION OF THE TAPE VOLUME  0666 02692000
*                                     THAT WAS BEING PROCESSED WHEN     02693000
*                                     THE CHECKPOINT WAS TAKEN.    0666 02694000
*                                                             SA60703*/ 02695000
*      5 JFCPCI   BIT(8),          /* PROGRAM-CONTROLLED INTERRUPTION   02696000
*                                     (PCI) FLAG BYTE (TCAM)         */ 02697000
*       6 JFCPCIX1 BIT(1),         /* PCI=(X,) RECEIVE OPERATIONS  0666 02698000
*                                                              ICB473*/ 02699000
*       6 JFCPCIX2 BIT(1),         /* PCI=(,X) SEND OPERATIONS     0666 02700000
*                                     X INDICATES THAT AFTER THE   0666 02701000
*                                     FIRST BUFFER IS FILLED (ON   0666 02702000
*                                     RECEIVE OPERATIONS) OR EMPTIED    02703000
*                                     (ON SEND OPERATIONS), A PCI  0666 02704000
*                                     OCCURS DURING THE FILLING OR 0666 02705000
*                                     EMPTYING OF THE NEXT BUFFER. 0666 02706000
*                                     THE FIRST BUFFER REMAINS     0666 02707000
*                                     ALLOCATED AND ANOTHER IS     0666 02708000
*                                     ALLOCATED.               ICB473*/ 02709000
*       6 JFCPCIA1 BIT(1),         /* PCI=(A,) RECEIVE OPERATIONS    */ 02710000
*       6 JFCPCIA2 BIT(1),         /* PCI=(,A) SEND OPERATIONS     0666 02711000
*                                     A INDICATES THAT AFTER THE   0666 02712000
*                                     FIRST BUFFER IS FILLED (ON   0666 02713000
*                                     RECEIVE OPERATIONS) OR EMPTIED    02714000
*                                     (ON SEND OPERATIONS), A PCI  0666 02715000
*                                     OCCURS DURING THE FILLING OR 0666 02716000
*                                     EMPTYING OF THE NEXT BUFFER. 0666 02717000
*                                     THE FIRST BUFFER IS DEALLOCATED.  02718000
*                                     A BUFFER IS ALLOCATED IN PLACE    02719000
*                                     OF THE DEALLOCATED BUFFER.     */ 02720000
*       6 JFCPCIN1 BIT(1),         /* PCI=(N,) RECEIVE OPERATIONS    */ 02721000
*       6 JFCPCIN2 BIT(1),         /* PCI=(,N) SEND OPERATIONS     0666 02722000
*                                     N INDICATES THAT NO PCI'S ARE     02723000
*                                     TAKEN DURING FILLING (ON     0666 02724000
*                                     RECEIVE OPERATIONS) OR EMPTYING   02725000
*                                     (ON SEND OPERATIONS) OF BUFFERS.  02726000
*                                     BUFFERS ARE DEALLOCATED AT THE    02727000
*                                     END OF TRANSMISSION.           */ 02728000
*       6 JFCPCIR1 BIT(1),         /* PCI=(R,) RECEIVE OPERATIONS    */ 02729000
*       6 JFCPCIR2 BIT(1),         /* PCI=(,R) SEND OPERATIONS     0666 02730000
*                                     R INDICATES THAT AFTER THE   0666 02731000
*                                     FIRST BUFFER IS FILLED (ON   0666 02732000
*                                     RECEIVE OPERATIONS) OR EMPTIED    02733000
*                                     (ON SEND OPERATIONS), A PCI  0666 02734000
*                                     OCCURS DURING THE FILLING OR 0666 02735000
*                                     EMPTYING OF EACH SUCCEEDING  0666 02736000
*                                     BUFFER.  THE COMPLETED BUFFER     02737000
*                                     IS DEALLOCATED, BUT NO NEW   0666 02738000
*                                     BUFFER IS ALLOCATED TO TAKE  0666 02739000
*                                     ITS PLACE.                     */ 02740000
*                                                                  0666 02741000
* /*******************************************************************/ 02742000
* /*                                                                 */ 02743000
* /*                     NORMAL 108 SEGMENT                          */ 02744000
* /*                                                                 */ 02745000
* /*******************************************************************/ 02746000
*                                                                  0666 02747000
*    3 JFCRESRV CHAR(4) BDY(WORD), /* FIRST BYTE CONTAINS NUMBER OF     02748000
*                                     BYTES FOR TIME OF DAY.  SECOND    02749000
*                                     BYTE CONTAINS NUMBER OF BYTES     02750000
*                                     FOR DATE.  THIRD BYTE CONTAINS    02751000
*                                     NUMBER OF BYTES FOR OUTSEQ.  0666 02752000
*                                     FOURTH BYTE CONTAINS NUMBER OF    02753000
*                                     BYTES IN.  (TCAM)              */ 02754000
*     4 JFCRKP   FIXED(15) BDY(WORD), /* THE RELATIVE POSITION OF THE   02755000
*                                     FIRST BYTE OF THE KEY WITHIN 0666 02756000
*                                     EACH LOGICAL RECORD.  MAXIMUM     02757000
*                                     VALUE IS LOGICAL RECORD LENGTH    02758000
*                                     MINUS KEY LENGTH.              */ 02759000
*     4 JFCCYLOF CHAR(1),          /* THE NUMBER OF TRACKS TO BE   0666 02760000
*                                     RESERVED ON EACH CYLINDER TO 0666 02761000
*                                     HOLD RECORDS THAT OVERFLOW   0666 02762000
*                                     FROM OTHER TRACKS ON THAT    0666 02763000
*                                     CYLINDER.  MAXIMUM VALUE IS  0666 02764000
*                                     99.                            */ 02765000
*     4 JFCDBUFN CHAR(1),          /* RESERVED                       */ 02766000
*   2 JFCINTVL CHAR(1) BDY(WORD);  /* INTENTIONAL DELAY, IN SECONDS,    02767000
*                                     BETWEEN PASSES THROUGH A     0666 02768000
*                                     POLLING LIST (QTAM)            */ 02769000
*                                                                  0666 02770000
* /*******************************************************************/ 02771000
* /*                                                                 */ 02772000
* /*                     END OF NORMAL 108 SEGMENT                   */ 02773000
* /*                                                                 */ 02774000
* /*******************************************************************/ 02775000
*                                                                  0667 02776000
* /*******************************************************************/ 02777000
* /*                                                                 */ 02778000
* /*                     108 PRINTER SEGMENT                         */ 02779000
* /*                                                                 */ 02780000
* /*     NOTE  THIS SEGMENT REPLACES THE NORMAL 108 SEGMENT IF       */ 02781000
* /*           THE DD STATEMENT USES THE UCS PARAMETER.              */ 02782000
* /*                                                                 */ 02783000
* /*******************************************************************/ 02784000
*                                                                  0667 02785000
*DECLARE                                                           0667 02786000
*  1 JFCUCSEG DEF(JFCRESRV) BDY(WORD),                             0667 02787000
*   2 JFCUCSID CHAR(4) BDY(WORD),  /* NAME OF THE UCS IMAGE TO BE  0667 02788000
*                                     LOADED                         */ 02789000
*   2 JFCUCSOP BIT(8),             /* OPERATION OF THE UCS IMAGE TO     02790000
*                                     BE LOADED                      */ 02791000
*    3 JFCBEXTP BIT(1),            /* JFCB EXTENSION PRESENT FOR 3800   02792000
*                                     DEVICE  (MDC302)       @Z40MP9A*/ 02793000
*    3 JFCFOLD  BIT(1),            /* UCS IMAGE IS TO BE LOADED IN 0667 02794000
*                                     THE FOLD MODE                  */ 02795000
*    3 JFCRSV25 BIT(1),            /* RESERVED                       */ 02796000
*    3 JFCVER   BIT(1),            /* UCS IMAGE IS TO BE VERIFIED    */ 02797000
*    3 JFCFCBAL BIT(1),            /* FORMS ARE TO BE ALIGNED        */ 02798000
*    3 JFCFCBVR BIT(1),            /* FORMS CONTROL BUFFER (FCB)   0667 02799000
*                                     IMAGE IS TO BE VERIFIED        */ 02800000
*    3 JFCRSV26 BIT(1),            /* RESERVED                       */ 02801000
*    3 JFCRSV27 BIT(1),            /* RESERVED                       */ 02802000
*                                                                  0667 02803000
* /*******************************************************************/ 02804000
* /*                                                                 */ 02805000
* /*                     END OF 108 PRINTER SEGMENT                  */ 02806000
* /*                                                                 */ 02807000
* /*******************************************************************/ 02808000
*                                                                  0667 02809000
*   2 JFCOUTLI PTR(24) BDY(WORD,2),/* SMF - SYSOUT LIMIT.  BINARY  0667 02810000
*                                     REPRESENTATION OF THE OUTLIM=     02811000
*                                     PARAMETER ON THE SYSOUT DD   0667 02812000
*                                     STATEMENT.  THE MAXIMUM NUMBER    02813000
*                                     OF LOGICAL RECORDS SPECIFIED 0667 02814000
*                                     FOR THIS OUTPUT DATA SET.      */ 02815000
*    3 JFCTHRSH CHAR(1),           /* RECORDS TO BE USED             */ 02816000
*     4 JFCCPRI  BIT(8),           /* PRIORITY BETWEEN SEND AND    0667 02817000
*                                     RECEIVE OPERATIONS (TCAM)      */ 02818000
*      5 JFCRSV53 BIT(1),          /* RESERVED                 MDC020*/ 02819000
*      5 JFCRSV54 BIT(1),          /* RESERVED                 MDC019*/ 02820000
*      5 JFCRSV55 BIT(1),          /* RESERVED                 MDC018*/ 02821000
*      5 JFCRSV33 BIT(1),          /* RESERVED                       */ 02822000
*      5 JFCRSV34 BIT(1),          /* RESERVED                       */ 02823000
*      5 JFCRECV  BIT(1),          /* RECEIVE PRIORITY         MDC018*/ 02824000
*      5 JFCEQUAL BIT(1),          /* EQUAL PRIORITY           MDC019*/ 02825000
*      5 JFCSEND  BIT(1),          /* SEND PRIORITY            MDC020*/ 02826000
*    3 JFCSOWA  FIXED(15),         /* LENGTH, IN BYTES, OF THE USER-    02827000
*                                     PROVIDED WORK AREA (QTAM)      */ 02828000
*   2 JFCBNTCS CHAR(1),            /* NUMBER OF OVERFLOW TRACKS      */ 02829000
*   2 JFCBNVOL CHAR(1),            /* NUMBER OF VOLUME SERIAL NUMBERS*/ 02830000
*   2 JFCBVOLS CHAR(30) BDY(WORD,3),/* THE FIRST FIVE VOLUME SERIAL     02831000
*                                     NUMBERS                        */ 02832000
*    3 JFCAVOLS (5) CHAR(6);       /* THE FIRST FIVE VOLUME SERIAL 0667 02833000
*                                     NUMBERS                @Z30LP9A*/ 02834000
*                                                                  0667 02835000
*DECLARE                                                           0668 02836000
*  1 JFCBS001 DEF(JFCBVOLS) BDY(WORD,3), /*                  @Z30LP9A*/ 02837000
*   2 *        CHAR(22),           /* FIRST 22 BYTES OF            0668 02838000
*                                     JFCBVOLS               @Z30LP9A*/ 02839000
*   2 JFCMSVGP CHAR(8) BDY(WORD),  /* MASS STORAGE VOLUME GROUP FROM    02840000
*                                     WHICH TO SELECT A VOLUME     0668 02841000
*                                     (MDC306)               @Z30LP9A*/ 02842000
*   2 JFCBEXTL CHAR(1),            /* LENGTH OF BLOCK OF EXTRA VOLUME   02843000
*                                     SERIAL NUMBERS (BEYOND FIVE)   */ 02844000
*   2 JFCBEXAD CHAR(3),            /* RELATIVE TRACK ADDRESS (TTR) 0668 02845000
*                                     OF FIRST JFCB EXTENSION BLOCK     02846000
*                                     FOR VOLUME SERIAL NUMBERS OR 0668 02847000
*                                     TTR OF JFCB EXTENSION BLOCK  0668 02848000
*                                     FOR 3800  (MDC303)     @Z40MP9A*/ 02849000
*   2 JFCBPQTY CHAR(3) BDY(WORD),  /* PRIMARY QUANTITY OF DIRECT   0668 02850000
*                                     ACCESS STORAGE REQUIRED        */ 02851000
*    3 JFCRUNIT CHAR(3),           /* UNIT TYPE (EBCDIC) OF A DEVICE    02852000
*                                     AT A REMOTE TERMINAL.  THE   0668 02853000
*                                     FIRST TWO CHARACTERS ARE RD  0668 02854000
*                                     (READER), PR (PRINTER) OR PU 0668 02855000
*                                     (PUNCH).  THE THIRD CHARACTER     02856000
*                                     IS A NUMBER FROM 1 TO 9. ICB387*/ 02857000
*   2 JFCBCTRI BIT(8),             /* SPACE PARAMETERS               */ 02858000
*    3 JFCBSPAC BIT(2),            /* SPACE MASK BITS                */ 02859000
*    3 JFCBMSGP BIT(1),            /* REQUEST IS FOR A MASS STORAGE     02860000
*                                     VOLUME GROUP (MSVGP) VOLUME  0668 02861000
*                                     (MDC307)               @Z30LP9A*/ 02862000
*    3 JFCRSV29 BIT(1),            /* RESERVED                       */ 02863000
*    3 JFCONTIG BIT(1),            /* CONTIG REQUEST                 */ 02864000
*    3 JFCMIXG  BIT(1),            /* MXIG REQUEST                   */ 02865000
*    3 JFCALX   BIT(1),            /* ALX REQUEST                    */ 02866000
*    3 JFCROUND BIT(1),            /* ROUND REQUEST                  */ 02867000
*   2 JFCBSQTY CHAR(3) BDY(WORD),  /* SECONDARY QUANTITY OF DIRECT 0668 02868000
*                                     ACCESS STORAGE REQUIRED        */ 02869000
*    3 JFCRQID  FIXED(15),         /* QUEUE IDENTIFICATION (QID) USED   02870000
*                                     BY ACCESS METHOD TO DETERMINE     02871000
*                                     THE REMOTE TERMINAL LOCATION 0668 02872000
*                                     FOR THIS JOB.            ICB387*/ 02873000
*   2 JFCFLGS1 BIT(8),             /* FLAG BYTE (ICB488)      SA53458*/ 02874000
*    3 JFCBDLET BIT(1),            /* IF ONE, DELETE THE DATA SET  0668 02875000
*                                     USED WHEN EXTENDING THE JOB  0668 02876000
*                                     QUEUE OR SPOOL DATA SETS     0668 02877000
*                                     (OS/VS1)  (MDC305)     @XM05457*/ 02878000
*    3 JFCTOPEN BIT(1),            /* TAPE DATA SET HAS BEEN OPENED     02879000
*                                                              MDC026*/ 02880000
*    3 JFCBADSP BIT(1),            /* AUTOMATIC DATA SET PROTECTION     02881000
*                                     INDICATOR  (MDC310)    @Z40RP9A*/ 02882000
*    3 JFCRSV42 BIT(1),            /* RESERVED  (MDC311)             */ 02883000
*    3 JFCBCEOV BIT(1),            /* IF ONE, CHKPT=EOV SPECIFIED FOR   02884000
*                                     THIS DATA SET (MDC312) @Z30JP9A*/ 02885000
*    3 JFCVRDS  BIT(1),            /* VIO DATA SET             MDC006*/ 02886000
*    3 JFCRSV45 BIT(1),            /* RESERVED                       */ 02887000
*    3 JFCBUAFF BIT(1),            /* UNIT AFFINITY SPECIFIED FOR  0668 02888000
*                                     THIS DATA SET (ICB488)  SA53458*/ 02889000
*   2 JFCBDQTY CHAR(3) BDY(WORD),  /* QUANTITY OF DIRECT ACCESS    0668 02890000
*                                     STORAGE REQUIRED FOR A       0668 02891000
*                                     DIRECTORY OR AN EMBEDDED INDEX    02892000
*                                     AREA                           */ 02893000
*   2 JFCBSPNM PTR(24) BDY(WORD,4),/* MAIN STORAGE ADDRESS OF THE  0668 02894000
*                                     JFCB WITH WHICH CYLINDERS ARE     02895000
*                                     SPLIT (OS/VS1)               0668 02896000
*                                     (MDC315)               @ZA18180*/ 02897000
*    3 JFCBFLG3 BIT(8),            /* FLAG BYTE (OS/VS2)           0668 02898000
*                                     (MDC316)               @ZA18180*/ 02899000
*     4 JFCDQDSP BIT(1),           /* REQUEST DEQUEUE OF TAPE VOLUME    02900000
*                                     WHEN DEMOUNTED               0668 02901000
*                                     (MDC317)               @ZA18180*/ 02902000
*     4 JFCBRV01 BIT(1),           /* RESERVED               @ZA18180*/ 02903000
*     4 JFCBRV02 BIT(1),           /* RESERVED               @ZA18180*/ 02904000
*     4 JFCBRV03 BIT(1),           /* RESERVED               @ZA18180*/ 02905000
*     4 JFCBRV04 BIT(1),           /* RESERVED               @ZA18180*/ 02906000
*     4 JFCBRV05 BIT(1),           /* RESERVED               @ZA18180*/ 02907000
*     4 JFCBRV06 BIT(1),           /* RESERVED               @ZA18180*/ 02908000
*     4 JFCBRV07 BIT(1),           /* RESERVED               @ZA18180*/ 02909000
*    3 JFCBRV08 FIXED(15),         /* RESERVED (OS/VS2)      @ZA18180*/ 02910000
*   2 JFCBABST FIXED(15),          /* RELATIVE ADDRESS OF FIRST TRACK   02911000
*                                     TO BE ALLOCATED                */ 02912000
*   2 JFCBSBNM PTR(24) BDY(WORD),  /* MAIN STORAGE ADDRESS OF THE  0668 02913000
*                                     JFCB FROM WHICH SPACE IS TO  0668 02914000
*                                     BE SUBALLOCATED                */ 02915000
*   2 JFCBDRLH CHAR(3) BDY(WORD,4),/* AVERAGE DATA BLOCK LENGTH      */ 02916000
*   2 JFCBVLCT CHAR(1),            /* VOLUME COUNT                   */ 02917000
*   2 JFCBSPTN CHAR(1),            /* NUMBER OF TRACKS PER CYLINDER     02918000
*                                     TO BE USED BY THIS DATA SET  0668 02919000
*                                     WHEN SPLIT CYLINDER IS       0668 02920000
*                                     INDICATED                      */ 02921000
*   2 JFCBEND  CHAR(0) BDY(WORD);                                  0668 02922000
*                                                                  0669 02923000
*        /* MACRO DECLARES USED BY THIS PROCEDURE                    */ 02924000
*                                                                  0669 02925000
*        /************************************************************/ 02926000
*        /*                                                          */ 02927000
*        /* THE RETURN CODE IS INITIALIZED.  IF AN ERROR IS DETECTED */ 02928000
*        /* IN THIS PROCEDURE AN ERROR CODE IS SET.  THIS RETURN     */ 02929000
*        /* CODE IS RETURNED TO THE CALLING PROCEDURE.               */ 02930000
*        /*                                                          */ 02931000
*        /************************************************************/ 02932000
*                                                                  0669 02933000
*        DSDRC = 0;                                                0669 02934000
*                                                                  0669 02935000
         SLR   @08,@08                                             0669 02936000
         STH   @08,DSDRC                                           0669 02937000
*        /************************************************************/ 02938000
*        /*                                                          */ 02939000
*        /* CHECK IF AN ALTERNATE DDNAME LIST HAS BEEN PROVIDED      */ 02940000
*        /*                                                          */ 02941000
*        /************************************************************/ 02942000
*                                                                  0670 02943000
*        IF IODADD ^= NULLPTR                                      0670 02944000
*          THEN                                                    0670 02945000
         L     @03,@PC00001                                        0670 02946000
         L     @03,GDTIOH(,@03)                                    0670 02947000
         C     @08,IODADD(,@03)                                    0670 02948000
         BE    @RF00670                                            0670 02949000
*DSCKALT:    DO;                                                   0671 02950000
*                                                                  0671 02951000
DSCKALT  DS    0H                                                  0672 02952000
*              /******************************************************/ 02953000
*              /*                                                    */ 02954000
*              /* AN ALTERNATE DDNAME LIST HAS BEEN PROVIDED.        */ 02955000
*              /* CALCULATE THE LENGTH OF THE LIST AND CHECK THE     */ 02956000
*              /* LIST OF DEFINED DDNAMES THAT MAY HAVE ALTERNATES.  */ 02957000
*              /*                                                    */ 02958000
*              /******************************************************/ 02959000
*                                                                  0672 02960000
*              DDN = DDLLEN/8;                                     0672 02961000
*                                                                  0672 02962000
         L     @08,@PC00001                                        0672 02963000
         L     @08,GDTIOH(,@08)                                    0672 02964000
         L     @08,IODADD(,@08)                                    0672 02965000
         SLR   @03,@03                                             0672 02966000
         ICM   @03,3,DDLLEN(@08)                                   0672 02967000
         SRL   @03,3                                               0672 02968000
         STH   @03,DDN                                             0672 02969000
*              DO CKDD = 1 TO DDN;                                 0673 02970000
*                                                                  0673 02971000
         LA    CKDD,1                                              0673 02972000
         B     @DE00673                                            0673 02973000
@DL00673 DS    0H                                                  0674 02974000
*                IF JFCDNAME = DEFDD (CKDD)                        0674 02975000
*                  THEN                                            0674 02976000
         L     @08,@PC00006                                        0674 02977000
         LR    @15,CKDD                                            0674 02978000
         SLA   @15,3                                               0674 02979000
         LA    @14,DEFDD-8(@15)                                    0674 02980000
         CLC   JFCDNAME(8,@08),0(@14)                              0674 02981000
         BNE   @RF00674                                            0674 02982000
*                    DO;                                           0675 02983000
*                                                                  0675 02984000
*                      /**********************************************/ 02985000
*                      /*                                            */ 02986000
*                      /* DDNAME MAY HAVE AN ALTERNATE.              */ 02987000
*                      /* IF CORRESPONDING DDNAME IN USER SUPPLIED   */ 02988000
*                      /* LIST IS NOT ZERO USE THE NEW DDNAME.       */ 02989000
*                      /*                                            */ 02990000
*                      /**********************************************/ 02991000
*                                                                  0676 02992000
*                      IF ALTDD (CKDD) ^= '0000000000000000'X      0676 02993000
*                        THEN                                      0676 02994000
         L     @14,@PC00001                                        0676 02995000
         L     @01,GDTIOH(,@14)                                    0676 02996000
         L     @14,IODADD(,@01)                                    0676 02997000
         ST    @15,@TF00001                                        0676 02998000
         ALR   @15,@14                                             0676 02999000
         AL    @15,@CF01498                                        0676 03000000
         CLC   ALTDD-2(8,@15),@CB01413                             0676 03001000
         BE    @RF00676                                            0676 03002000
*                          JFCDNAME = ALTDD (CKDD);                0677 03003000
*                                                                  0677 03004000
*                                                                  0677 03005000
         AL    @14,@TF00001                                        0677 03006000
         AL    @14,@CF01498                                        0677 03007000
         MVC   JFCDNAME(8,@08),ALTDD-2(@14)                        0677 03008000
*                    END;                                          0678 03009000
*                                                                  0678 03010000
@RF00676 DS    0H                                                  0679 03011000
*              END;                                                0679 03012000
*                                                                  0679 03013000
@RF00674 AL    CKDD,@CF00161                                       0679 03014000
@DE00673 CH    CKDD,DDN                                            0679 03015000
         BNH   @DL00673                                            0679 03016000
*            END DSCKALT;                                          0680 03017000
*                                                                  0680 03018000
*        /************************************************************/ 03019000
*        /*                                                          */ 03020000
*        /* GET DEVTYPE INFORMATION.  IF THE MACRO IS NOT            */ 03021000
*        /* SUCCESSFUL NO DD CARD WAS PRESENT.  SET ERROR CODES      */ 03022000
*        /* AND RETURN TO CALLING PROC IF NO DD CARD PRESENT.        */ 03023000
*        /*                                                          */ 03024000
*        /************************************************************/ 03025000
*                                                                  0681 03026000
*        REG6 = ADDR (JFCDNAME);                                   0681 03027000
@RF00670 L     REG6,@PC00006                                       0681 03028000
*        REG7 = ADDR (DEVAREA);                                    0682 03029000
         LA    REG7,DEVAREA                                        0682 03030000
*LDEVT1: GEN(DEVTYPE (REG6),(REG7));                               0683 03031000
LDEVT1   DEVTYPE (REG6),(REG7)                                          03032000
*        RESPECIFY RTNREG RSTD;                                    0684 03033000
*        TESTRC = RTNREG;                                          0685 03034000
         STH   RTNREG,TESTRC                                       0685 03035000
*        RESPECIFY RTNREG UNRSTD;                                  0686 03036000
*                                                                  0686 03037000
*        IF TESTRC ^= 0                                            0687 03038000
*          THEN                                                    0687 03039000
         LH    @08,TESTRC                                          0687 03040000
         LTR   @08,@08                                             0687 03041000
         BZ    @RF00687                                            0687 03042000
*            DO;                                                   0688 03043000
*                                                                  0688 03044000
*              DSDRC = 4;                                          0689 03045000
         MVC   DSDRC(2),@CH00040                                   0689 03046000
*              DARGSENT = NODDSTID;                                0690 03047000
         L     @08,DDSTRU                                          0690 03048000
         MVI   DARGSENT(@08),X'05'                                 0690 03049000
*              DSNAME (1:8) = JFCDNAME (1:8);                      0691 03050000
*                                                                  0691 03051000
         L     @08,IOCSPTR                                         0691 03052000
         L     @08,IOCDSN(,@08)                                    0691 03053000
         L     @03,@PC00006                                        0691 03054000
         MVC   DSNAME(8,@08),JFCDNAME(@03)                         0691 03055000
*            END;                                                  0692 03056000
*                                                                  0692 03057000
*          ELSE                                                    0693 03058000
*                                                                  0693 03059000
*            /********************************************************/ 03060000
*            /*                                                      */ 03061000
*            /* DD CARD DEFINING THE DATA SET TO OPEN FOUND          */ 03062000
*            /*                                                      */ 03063000
*            /********************************************************/ 03064000
*                                                                  0693 03065000
*RDJOK:      DO;                                                   0693 03066000
*                                                                  0693 03067000
         B     @RC00687                                            0693 03068000
@RF00687 DS    0H                                                  0693 03069000
RDJOK    DS    0H                                                  0694 03070000
*              /******************************************************/ 03071000
*              /*                                                    */ 03072000
*              /* IF DATA SET RESIDES ON DIRECT ACCESS DEVICE SET    */ 03073000
*              /* THE DIRECT ACCESS FLAG IN THE IOCS.                */ 03074000
*              /*                                                    */ 03075000
*              /******************************************************/ 03076000
*                                                                  0694 03077000
*              IF DEVTDA = ON                                      0694 03078000
*                THEN                                              0694 03079000
         TM    DEVTDA,B'00100000'                                  0694 03080000
         BNO   @RF00694                                            0694 03081000
*                  IOCDEVDA = ON;                                  0695 03082000
*                                                                  0695 03083000
         L     @08,IOCSPTR                                         0695 03084000
         L     @08,IOCEXT(,@08)                                    0695 03085000
         OI    IOCDEVDA(@08),B'10000000'                           0695 03086000
*              IF DEVTUR = ON                                      0696 03087000
*                THEN                                              0696 03088000
@RF00694 TM    DEVTUR,B'00001000'                                  0696 03089000
         BNO   @RF00696                                            0696 03090000
*                  IOCDEVUR = ON;                                  0697 03091000
*                                                                  0697 03092000
         L     @08,IOCSPTR                                         0697 03093000
         L     @08,IOCEXT(,@08)                                    0697 03094000
         OI    IOCDEVUR(@08),B'00100000'                           0697 03095000
*              /******************************************************/ 03096000
*              /*                                                    */ 03097000
*              /* READ THE JFCB AND SAVE THE VOLUME SERIAL NUMBER.   */ 03098000
*              /* A QSAM DCB IS MOVED TO A GETMAIN AREA.  THE DDNAME */ 03099000
*              /* OF THE JCL STATEMENT AND THE ADDRESS OF A          */ 03100000
*              /* EXIT LIST ARE PLACED                               */ 03101000
*              /* IN THE DCB.  THE ADDRESS OF THE DCB IS PLACED      */ 03102000
*              /* IN THE EXIT LIST AND THE EXECUTE FORM OF THE       */ 03103000
*              /* RDJFCB MACRO IS ISSUED.                            */ 03104000
*              /*                                                    */ 03105000
*              /******************************************************/ 03106000
*                                                                  0698 03107000
*              DCBPTR = ADDR (READDCB);                            0698 03108000
@RF00696 LA    @08,WORKAREA                                        0698 03109000
         LA    @03,176                                             0698 03110000
         ALR   @03,@08                                             0698 03111000
         ST    @03,DCBPTR                                          0698 03112000
*              GENADDR = ADDR (QSAMDCB);                           0699 03113000
         LA    @15,QSAMDCB                                         0699 03114000
         ST    @15,GENADDR                                         0699 03115000
*              READDCB (1:SIZEQSAM) = GENAREA (1:SIZEQSAM);        0700 03116000
         MVC   READDCB(96,@03),GENAREA(@15)                        0700 03117000
*              DCBEXLSA = ADDR (DCBRLIST);                         0701 03118000
         LA    @15,DCBRLIST                                        0701 03119000
         STCM  @15,7,DCBEXLSA+28(@03)                              0701 03120000
*              DCBDDNAM (1:8) = JFCDNAME (1:8);                    0702 03121000
         L     @15,@PC00006                                        0702 03122000
         MVC   DCBDDNAM+40(8,@03),JFCDNAME(@15)                    0702 03123000
*              DCBRLPTR = ADDR (WORKAREA);                         0703 03124000
         STCM  @08,7,DCBRLPTR                                      0703 03125000
*              DCBRLID = '87'X;                                    0704 03126000
         MVI   DCBRLID,X'87'                                       0704 03127000
*              DCBEXWRD = ADDR (READDCB);                          0705 03128000
         ST    @03,DCBEXWRD                                        0705 03129000
*              DCBEXEND = ON;                                      0706 03130000
*                                                                  0706 03131000
         OI    DCBEXEND,B'10000000'                                0706 03132000
*LRDJF1:       GEN(RDJFCB  MF=(E,DCBEXWRD));                       0707 03133000
*                                                                  0707 03134000
LRDJF1   RDJFCB  MF=(E,DCBEXWRD)                                        03135000
*              JFCBPTR = ADDR (WORKAREA);                          0708 03136000
*                                                                  0708 03137000
         LA    JFCBPTR,WORKAREA                                    0708 03138000
*              /******************************************************/ 03139000
*              /*                                                    */ 03140000
*              /* IF OPEN IS TO BE DONE WITH A MODIFIED              */ 03141000
*              /* JFCB, MOVE THE DSNAME AND VOLSERS FROM             */ 03142000
*              /* THE OPNAGL TO THE JFCB. SET FLAG TO                */ 03143000
*              /* INHIBIT WRITING THE JFCB BACK.                     */ 03144000
*              /*                                                    */ 03145000
*              /******************************************************/ 03146000
*                                                                  0709 03147000
*              IF OPNOPTJM = ON                                    0709 03148000
*                THEN                                              0709 03149000
         TM    OPNOPTJM(OPNPTR),B'00000100'                        0709 03150000
         BNO   @RF00709                                            0709 03151000
*                  DO;                                             0710 03152000
*                        JFCBDSNM = MODJNM;                        0711 03153000
         L     @08,OPNDSN(,OPNPTR)                                 0711 03154000
         MVC   JFCBDSNM(44,JFCBPTR),MODJNM(@08)                    0711 03155000
*                        JFCBNVOL = MODJCNT;                       0712 03156000
         L     @08,OPNVOL(,OPNPTR)                                 0712 03157000
         SLR   @15,@15                                             0712 03158000
         IC    @15,MODJCNT(,@08)                                   0712 03159000
         STC   @15,JFCBNVOL(,JFCBPTR)                              0712 03160000
*                        JFCBVOLS(1:MODJCNT*VLSRL) =               0713 03161000
*                          MODJSERS(1:MODJCNT*VLSRL);              0713 03162000
         MH    @15,@CH00115                                        0713 03163000
         BCTR  @15,0                                               0713 03164000
         EX    @15,@SM01499                                        0713 03165000
*                        JFCBTSDM = JFINHWB;                       0714 03166000
         MVC   JFCBTSDM(1,JFCBPTR),JFINHWB                         0714 03167000
*                  END;                                            0715 03168000
*                                                                  0715 03169000
*              /******************************************************/ 03170000
*              /*                                                    */ 03171000
*              /* SAVE THE DATA SET NAME IN THE IOCSTR.              */ 03172000
*              /*                                                    */ 03173000
*              /******************************************************/ 03174000
*                                                                  0716 03175000
*              DSNAME = JFCBDSNM;                                  0716 03176000
*                                                                  0716 03177000
@RF00709 L     @08,IOCSPTR                                         0716 03178000
         L     @01,IOCDSN(,@08)                                    0716 03179000
         MVC   DSNAME(44,@01),JFCBDSNM(JFCBPTR)                    0716 03180000
*              IF JFCSDS = ON                                      0717 03181000
*                THEN                                              0717 03182000
*                                                                  0717 03183000
         TM    JFCSDS(JFCBPTR),B'00100000'                         0717 03184000
         BNO   @RF00717                                            0717 03185000
*                  /**************************************************/ 03186000
*                  /*                                                */ 03187000
*                  /* SET IOCSTR VALUES FOR DD  / SYSOUT = A DATA SET*/ 03188000
*                  /*                                                */ 03189000
*                  /**************************************************/ 03190000
*                                                                  0718 03191000
*                  DO;                                             0718 03192000
*                    IOCDSOPS = ON;                                0719 03193000
         OI    IOCDSOPS(@08),B'10000000'                           0719 03194000
*                    IOCFLGIO = ON;                                0720 03195000
         L     @08,IOCEXT(,@08)                                    0720 03196000
         OI    IOCFLGIO(@08),B'00010000'                           0720 03197000
*                  END;                                            0721 03198000
*                                                                  0721 03199000
*            END RDJOK;                                            0722 03200000
*                                                                  0722 03201000
@RF00717 DS    0H                                                  0723 03202000
*        IF GDTDBG = NULLPTR                                       0723 03203000
*          THEN;                                                   0723 03204000
@RC00687 L     @08,@PC00001                                        0723 03205000
         L     @08,GDTDBG(,@08)                                    0723 03206000
         LTR   @08,@08                                             0723 03207000
         BZ    @RT00723                                            0723 03208000
*          ELSE                                                    0725 03209000
*            CALL ICKDB010 (GDTTBL,'IODS');                        0725 03210000
*                                                                  0725 03211000
         L     @08,@PC00001                                        0725 03212000
         ST    @08,@AL00001                                        0725 03213000
         LA    @03,@CC01422                                        0725 03214000
         ST    @03,@AL00001+4                                      0725 03215000
         MVI   @AL00001+4,X'80'                                    0725 03216000
         L     @15,GDTDBG(,@08)                                    0725 03217000
         LA    @01,@AL00001                                        0725 03218000
         BALR  @14,@15                                             0725 03219000
*        RETURN CODE (DSDRC);                                      0726 03220000
*                                                                  0726 03221000
@RT00723 LH    @15,DSDRC                                           0726 03222000
         L     @13,4(,@13)                                         0726 03223000
         L     @14,12(,@13)                                        0726 03224000
         LM    @00,@12,20(@13)                                     0726 03225000
         BR    @14                                                 0726 03226000
*        END DSDATA;                                               0727 03227000
*                                                                  0727 03228000
*/********************************************************************/ 03229000
*/*                                                                  */ 03230000
*/* PROCEDURE NAME - BUILDDBK                                        */ 03231000
*/*                                                                  */ 03232000
*/* FUNCTION - THIS PROCEDURE WILL BUILD A DCB FOR A  DATA           */ 03233000
*/*            SET AND PLACE ITS ADDRESS IN THE ARGUMENT LIST        */ 03234000
*/*            SUPPLIED TO THE OPEN SVC.  QSAM OR BSAM               */ 03235000
*/*            DCBS MAY BE BUILT USING THIS PROC.                    */ 03236000
*/*                                                                  */ 03237000
*/* INPUT -    THE IOCS POINTED TO BY IOCSPTR CONTAINS THE           */ 03238000
*/*            INFORMATION REQUIRED TO BUILD THE DCB.                */ 03239000
*/*                                                                  */ 03240000
*/* OUTPUT -   A DCB IS BUILT AND ITS ADDRESS IS PLACED IN THE OPEN  */ 03241000
*/*            ARGUMENT LIST.                                        */ 03242000
*/*                                                                  */ 03243000
*/* ERRORS -   IF NOT ENOUGH STORAGE IS AVAILABLE FOR THE DCB        */ 03244000
*/*            AN ERROR CONDITION IS SET.                            */ 03245000
*/*                                                                  */ 03246000
*/********************************************************************/ 03247000
*                                                                  0728 03248000
*BUILDDBK: PROC (RETDCBAD,DDDNAME) OPTIONS (SAVEAREA);             0728 03249000
*                                                                  0728 03250000
BUILDDBK STM   @14,@12,12(@13)                                     0728 03251000
         ST    @13,@SA00007+4                                      0728 03252000
         LA    @14,@SA00007                                        0728 03253000
         ST    @14,8(,@13)                                         0728 03254000
         LR    @13,@14                                             0728 03255000
         MVC   @PC00007(8),0(@01)                                  0728 03256000
*        /* RETURN CODE FROM THIS PROCEDURE                          */ 03257000
*        DCL BLDDRC FIXED (15);                                    0729 03258000
*                                                                  0729 03259000
*        /* DDNAME OF THE DATA SET TO BE OPENED                      */ 03260000
*        DCL DDDNAME CHAR (8);                                     0730 03261000
*                                                                  0730 03262000
*        /* AREA TO RETURN DCB ADDRESS AND OPEN OPTIONS              */ 03263000
*        DCL 1 RETDCBAD PTR (31),                                  0731 03264000
*              2 OPOPTION CHAR (1);    /* OPEN OPTIONS               */ 03265000
*                                                                  0731 03266000
*        /* OPEN TYPE J AREA FOR EXIT LIST AND JFCB                  */ 03267000
*        DCL 1 TYPJWA BASED (TYPJPTR) BDY(WORD),                   0732 03268000
*              2 TYPJEXLN,                                         0732 03269000
*                3 TYPJEX CHAR(1),                                 0732 03270000
*                3 TYPJEPT PTR (24),                               0732 03271000
*              2 TYPJEXLO CHAR (8),                                0732 03272000
*              2 TYPJFCB CHAR (176);                               0732 03273000
*                                                                  0732 03274000
*        /* JFCB EXIT LIST ENTRY INDICATOR                           */ 03275000
*        DCL TYPJEXON FIXED(8) INIT ('07'X);                       0733 03276000
*                                                                  0733 03277000
*        /* OPEN TYPE J AREA SIZE                                    */ 03278000
*        DCL TYPJWASZ FIXED(31) CONSTANT(196);                     0734 03279000
*                                                                  0734 03280000
*        /* UPDATE DECB LENGTH                                       */ 03281000
*        DCL DECBL FIXED(31) CONSTANT(24);                         0735 03282000
*                                                                  0735 03283000
*        /* LRECL=X RECORD SIZE                                      */ 03284000
*        DCL SZ32K FIXED(31) CONSTANT(32768);                      0736 03285000
*                                                                  0736 03286000
*        /* MACRO VARIABLES USED BY THIS PROCEDURE                   */ 03287000
*                                                                  0737 03288000
*        /************************************************************/ 03289000
*        /*                                                          */ 03290000
*        /* INITIALIZE RETURN CODE SET BY THIS PROCEDURE.            */ 03291000
*        /* IF AN ERROR IS DETECTED BY THIS PROCEDURE THE RCDATA     */ 03292000
*        /* STRUCTURE IS INITIALIZE AND AN ERROR RETURN CODE IS SET. */ 03293000
*        /*                                                          */ 03294000
*        /************************************************************/ 03295000
*                                                                  0737 03296000
*        BLDDRC = 0;                                               0737 03297000
*                                                                  0737 03298000
         SLR   BLDDRC,BLDDRC                                       0737 03299000
*        /************************************************************/ 03300000
*        /*                                                          */ 03301000
*        /* SET THE LENGTH AND THE ADDRESS OF THE DCB TO BE CREATED. */ 03302000
*        /* BSAM OR QSAM DCBS MAY BE BUILT.                          */ 03303000
*        /*                                                          */ 03304000
*        /************************************************************/ 03305000
*        RESPECIFY (REG5) RSTD;                                    0738 03306000
*                                                                  0738 03307000
*          IOCDSOPS = ON;                                          0739 03308000
*                                                                  0739 03309000
*                                                                  0739 03310000
         L     @08,IOCSPTR                                         0739 03311000
         OI    IOCDSOPS(@08),B'10000000'                           0739 03312000
*          /**********************************************************/ 03313000
*          /*                                                        */ 03314000
*          /* SET DCB SIZE AND DCB POINTER. MAY BE BSAM OR QSAM.     */ 03315000
*          /*                                                        */ 03316000
*          /**********************************************************/ 03317000
*                                                                  0740 03318000
*          IF OPNOPTBK = ON                                        0740 03319000
*            THEN                                                  0740 03320000
         TM    OPNOPTBK(OPNPTR),B'00010000'                        0740 03321000
         BNO   @RF00740                                            0740 03322000
*              DO;                                                 0741 03323000
*                POOLSIZE = SIZEBSAM;                              0742 03324000
         MVC   POOLSIZE(4),@CF00955                                0742 03325000
*                GENADDR = ADDR(BSAMDCB);                          0743 03326000
         LA    @04,BSAMDCB                                         0743 03327000
         ST    @04,GENADDR                                         0743 03328000
*                IOCMACBK = ON;                                    0744 03329000
         OI    IOCMACBK(@08),B'00010000'                           0744 03330000
*              END;                                                0745 03331000
*                                                                  0745 03332000
*            ELSE                                                  0746 03333000
*              DO;                                                 0746 03334000
         B     @RC00740                                            0746 03335000
@RF00740 DS    0H                                                  0747 03336000
*                POOLSIZE = SIZEQSAM;                              0747 03337000
         MVC   POOLSIZE(4),@CF00953                                0747 03338000
*                GENADDR = ADDR(QSAMDCB);                          0748 03339000
         LA    @08,QSAMDCB                                         0748 03340000
         ST    @08,GENADDR                                         0748 03341000
*              END;                                                0749 03342000
*                                                                  0749 03343000
*        RESPECIFY (REG5) UNRSTD;                                  0750 03344000
*                                                                  0750 03345000
@RC00740 DS    0H                                                  0751 03346000
*        /************************************************************/ 03347000
*        /*                                                          */ 03348000
*        /* IF OPEN TYPE J IS REQUIRED, GET SPACE                    */ 03349000
*        /* FOR A COPY OF THE EXIT LIST AND JFCB. IF                 */ 03350000
*        /* NOT ENOUGH SPACE IS AVAILABLE, SET ERROR                 */ 03351000
*        /* CONDITION AND RETURN TO CALLING PROCEDURE                */ 03352000
*        /*                                                          */ 03353000
*        /************************************************************/ 03354000
*                                                                  0751 03355000
*        IF OPNOPTJM = ON                                          0751 03356000
*          THEN                                                    0751 03357000
         TM    OPNOPTJM(OPNPTR),B'00000100'                        0751 03358000
         BNO   @RF00751                                            0751 03359000
*            DO;                                                   0752 03360000
*                                                                  0752 03361000
*              CALL ICKSAGP0  (GDTTBL,TYPJWASZ,TYPJPTR,IOCSID);    0753 03362000
*                                                                  0753 03363000
         L     @08,@PC00001                                        0753 03364000
         ST    @08,@AL00001                                        0753 03365000
         LA    @15,@CF01441                                        0753 03366000
         ST    @15,@AL00001+4                                      0753 03367000
         LA    @15,TYPJPTR                                         0753 03368000
         ST    @15,@AL00001+8                                      0753 03369000
         L     @01,IOCSPTR                                         0753 03370000
         L     @01,IOCEXT(,@01)                                    0753 03371000
         LA    @15,IOCSID(,@01)                                    0753 03372000
         ST    @15,@AL00001+12                                     0753 03373000
         MVI   @AL00001+12,X'80'                                   0753 03374000
         L     @15,GDTGPL(,@08)                                    0753 03375000
         LA    @01,@AL00001                                        0753 03376000
         BALR  @14,@15                                             0753 03377000
*              RESPECIFY RTNREG RSTD;                              0754 03378000
*              TESTRC = RTNREG;                                    0755 03379000
         STH   RTNREG,TESTRC                                       0755 03380000
*              RESPECIFY RTNREG UNRSTD;                            0756 03381000
*                                                                  0756 03382000
*              IF TESTRC = 4                                       0757 03383000
*                THEN                                              0757 03384000
         LH    @08,TESTRC                                          0757 03385000
         LA    @15,4                                               0757 03386000
         CR    @08,@15                                             0757 03387000
         BNE   @RF00757                                            0757 03388000
*                  DO;                                             0758 03389000
*                    DARGSMOD = 'UV0';                             0759 03390000
         L     @08,DDSTRU                                          0759 03391000
         MVC   DARGSMOD(3,@08),@CC01006                            0759 03392000
*                    BLDDRC = 4;                                   0760 03393000
         LR    BLDDRC,@15                                          0760 03394000
*                    DARGSENT = NOCRSTID;                          0761 03395000
         MVI   DARGSENT(@08),X'04'                                 0761 03396000
*                    RETURN CODE(BLDDRC);                          0762 03397000
         LR    @15,BLDDRC                                          0762 03398000
         L     @13,4(,@13)                                         0762 03399000
         L     @14,12(,@13)                                        0762 03400000
         LM    @00,@12,20(@13)                                     0762 03401000
         BR    @14                                                 0762 03402000
*                  END;                                            0763 03403000
*                                                                  0763 03404000
*              /******************************************************/ 03405000
*              /*                                                    */ 03406000
*              /* COPY MODIFIED JFCB AND EXIT LIST TO                */ 03407000
*              /* THE WORKAREA TO BE POINTED TO BY THE               */ 03408000
*              /* DCB EXIT LIST ADDRESS                              */ 03409000
*              /*                                                    */ 03410000
*              /******************************************************/ 03411000
*                                                                  0764 03412000
*              TYPJEX = TYPJEXON;                                  0764 03413000
@RF00757 L     @08,TYPJPTR                                         0764 03414000
         IC    @15,TYPJEXON                                        0764 03415000
         STC   @15,TYPJEX(,@08)                                    0764 03416000
*              TYPJEPT = ADDR(TYPJFCB);                            0765 03417000
         LA    @15,TYPJFCB(,@08)                                   0765 03418000
         STCM  @15,7,TYPJEPT(@08)                                  0765 03419000
*              TYPJEXLO = DCBTLIST;                                0766 03420000
         MVC   TYPJEXLO(8,@08),DCBTLIST                            0766 03421000
*              TYPJFCB = WORKAREA(1:LENGTH(TYPJFCB));              0767 03422000
*                                                                  0767 03423000
         MVC   TYPJFCB(176,@08),WORKAREA                           0767 03424000
*            END;                                                  0768 03425000
*                                                                  0768 03426000
*        /************************************************************/ 03427000
*        /*                                                          */ 03428000
*        /* GET STORAGE FOR THE DCB.  IF NOT ENOUGH STORAGE IS       */ 03429000
*        /* IS AVAILABLE, SET ERROR CONDITION AND RETURN TO CALLER.  */ 03430000
*        /*                                                          */ 03431000
*        /************************************************************/ 03432000
*                                                                  0769 03433000
*        CALL ICKSAGP0 (GDTTBL,POOLSIZE,DCBPTR,IOCSID);            0769 03434000
@RF00751 L     @08,@PC00001                                        0769 03435000
         ST    @08,@AL00001                                        0769 03436000
         LA    @15,POOLSIZE                                        0769 03437000
         ST    @15,@AL00001+4                                      0769 03438000
         LA    @15,DCBPTR                                          0769 03439000
         ST    @15,@AL00001+8                                      0769 03440000
         L     @01,IOCSPTR                                         0769 03441000
         L     @01,IOCEXT(,@01)                                    0769 03442000
         LA    @15,IOCSID(,@01)                                    0769 03443000
         ST    @15,@AL00001+12                                     0769 03444000
         MVI   @AL00001+12,X'80'                                   0769 03445000
         L     @15,GDTGPL(,@08)                                    0769 03446000
         LA    @01,@AL00001                                        0769 03447000
         BALR  @14,@15                                             0769 03448000
*        RESPECIFY RTNREG RSTD;                                    0770 03449000
*        TESTRC = RTNREG;                                          0771 03450000
         STH   RTNREG,TESTRC                                       0771 03451000
*        RESPECIFY RTNREG UNRSTD;                                  0772 03452000
*                                                                  0772 03453000
*        IF TESTRC = 4                                             0773 03454000
*          THEN                                                    0773 03455000
         LH    @08,TESTRC                                          0773 03456000
         LA    @15,4                                               0773 03457000
         CR    @08,@15                                             0773 03458000
         BNE   @RF00773                                            0773 03459000
*            DO;                                                   0774 03460000
*              DARGSMOD = 'UV0';                                   0775 03461000
         L     @08,DDSTRU                                          0775 03462000
         MVC   DARGSMOD(3,@08),@CC01006                            0775 03463000
*              BLDDRC = 4;                                         0776 03464000
         LR    BLDDRC,@15                                          0776 03465000
*              DARGSENT = NOCRSTID;                                0777 03466000
         MVI   DARGSENT(@08),X'04'                                 0777 03467000
*            END;                                                  0778 03468000
*                                                                  0778 03469000
*          /**********************************************************/ 03470000
*          /*                                                        */ 03471000
*          /* STORAGE FOR THE DCB HAS BEEN OBTAINED.  MOVE THE       */ 03472000
*          /* DEFINED DCB TO THE OBTAINED STORAGE.                   */ 03473000
*          /* UPDATE THE NUMBER OF CONTROL BLOCKS BUILT AND          */ 03474000
*          /* SET DCB ADDRESS IN OPEN LIST.                          */ 03475000
*          /*                                                        */ 03476000
*          /**********************************************************/ 03477000
*                                                                  0779 03478000
*          ELSE                                                    0779 03479000
*SETDCB:                                                           0779 03480000
*            DO;                                                   0779 03481000
*                                                                  0779 03482000
         B     @RC00773                                            0779 03483000
@RF00773 DS    0H                                                  0779 03484000
SETDCB   DS    0H                                                  0780 03485000
*              IOCCBA = DCBPTR;                                    0780 03486000
         L     @08,IOCSPTR                                         0780 03487000
         L     @15,IOCEXT(,@08)                                    0780 03488000
         L     @14,DCBPTR                                          0780 03489000
         ST    @14,IOCCBA(,@15)                                    0780 03490000
*              RETDCBAD = IOCCBA;                                  0781 03491000
*                                                                  0781 03492000
         L     @07,@PC00007                                        0781 03493000
         ST    @14,RETDCBAD(,@07)                                  0781 03494000
*              IOCCBL = POOLSIZE;                                  0782 03495000
*                                                                  0782 03496000
         L     @07,POOLSIZE                                        0782 03497000
         STH   @07,IOCCBL(,@15)                                    0782 03498000
*              /******************************************************/ 03499000
*              /*                                                    */ 03500000
*              /* SET DCB ADDR IN IOCSTR IF REQUESTED.               */ 03501000
*              /*                                                    */ 03502000
*              /******************************************************/ 03503000
*                                                                  0783 03504000
*              IF OPNMODRC = ON                                    0783 03505000
*                THEN                                              0783 03506000
         TM    OPNMODRC(OPNPTR),B'01000000'                        0783 03507000
         BNO   @RF00783                                            0783 03508000
*                  IOCCBP = IOCCBA;                                0784 03509000
*                                                                  0784 03510000
         ST    @14,IOCCBP(,@08)                                    0784 03511000
*              IHADCB (1:POOLSIZE) = GENAREA (1:POOLSIZE);         0785 03512000
*                                                                  0785 03513000
@RF00783 L     @08,DCBPTR                                          0785 03514000
         L     @15,POOLSIZE                                        0785 03515000
         BCTR  @15,0                                               0785 03516000
         L     @01,GENADDR                                         0785 03517000
         EX    @15,@SM01502                                        0785 03518000
*              DCBDDNAM (1:8) = DDDNAME (1:8);                     0786 03519000
*                                                                  0786 03520000
         L     @15,@PC00007+4                                      0786 03521000
         MVC   DCBDDNAM+40(8,@08),DDDNAME(@15)                     0786 03522000
*              /******************************************************/ 03523000
*              /*                                                    */ 03524000
*              /* EXIT LIST ADDRESS.                                 */ 03525000
*              /*                                                    */ 03526000
*              /******************************************************/ 03527000
*                                                                  0787 03528000
*              IF OPNOPTJM = ON                                    0787 03529000
*                THEN                                              0787 03530000
         TM    OPNOPTJM(OPNPTR),B'00000100'                        0787 03531000
         BNO   @RF00787                                            0787 03532000
*                 DCBEXLSA = TYPJPTR;                              0788 03533000
         MVC   DCBEXLSA+28(3,@08),TYPJPTR+1                        0788 03534000
*                ELSE                                              0789 03535000
*                 DCBEXLSA = ADDR (DCBTLIST);                      0789 03536000
*                                                                  0789 03537000
         B     @RC00787                                            0789 03538000
@RF00787 LA    @08,DCBTLIST                                        0789 03539000
         L     @01,DCBPTR                                          0789 03540000
         STCM  @08,7,DCBEXLSA+28(@01)                              0789 03541000
*              /******************************************************/ 03542000
*              /*                                                    */ 03543000
*              /* THE MACRF FLAGS ARE SET ACCORDING TO               */ 03544000
*              /* THE USAGE INDICATED AS FOLLOWS:                    */ 03545000
*              /*  QSAM OUTPUT - PUT/LOCATE                          */ 03546000
*              /*  BSAM OUTPUT - READ/POINT                          */ 03547000
*              /*                                                    */ 03548000
*              /******************************************************/ 03549000
*                                                                  0790 03550000
*              IF IOCMACOT = ON                                    0790 03551000
*                THEN                                              0790 03552000
@RC00787 L     @08,IOCSPTR                                         0790 03553000
         TM    IOCMACOT(@08),B'01000000'                           0790 03554000
         BNO   @RF00790                                            0790 03555000
*                  DO;                                             0791 03556000
*                                                                  0791 03557000
*                    IF OPNMODAC = ON                              0792 03558000
*                      THEN                                        0792 03559000
         TM    OPNMODAC(OPNPTR),B'10000000'                        0792 03560000
         BNO   @RF00792                                            0792 03561000
*                        IOCINFAC = ON;                            0793 03562000
*                                                                  0793 03563000
         L     @08,IOCEXT(,@08)                                    0793 03564000
         OI    IOCINFAC(@08),B'00001000'                           0793 03565000
*                    DCBSYN = IODOSOS;                             0794 03566000
*                                                                  0794 03567000
@RF00792 L     @08,DCBPTR                                          0794 03568000
         L     @15,@PC00001                                        0794 03569000
         L     @01,GDTIOH(,@15)                                    0794 03570000
         MVC   DCBSYN+52(3,@08),IODOSOS(@01)                       0794 03571000
*                    IF IOCMACBK = ON                              0795 03572000
*                      THEN                                        0795 03573000
         L     @01,IOCSPTR                                         0795 03574000
         TM    IOCMACBK(@01),B'00010000'                           0795 03575000
         BNO   @RF00795                                            0795 03576000
*                        DO;                                       0796 03577000
*                          OPOPTION = '0F'X;                       0797 03578000
         L     @15,@PC00007                                        0797 03579000
         MVI   OPOPTION(@15),X'0F'                                 0797 03580000
*                          DCBMRRD = OFF;                          0798 03581000
         AL    @08,@CF00669                                        0798 03582000
         NI    DCBMRRD(@08),B'11011111'                            0798 03583000
*                          DCBMRWRT = ON;                          0799 03584000
         OI    DCBMRWRT(@08),B'00100000'                           0799 03585000
*                          DCBMRPT1 = OFF;                         0800 03586000
         NI    DCBMRPT1(@08),B'11111011'                           0800 03587000
*                          DCBMRPT2 = ON;                          0801 03588000
         OI    DCBMRPT2(@08),B'00000100'                           0801 03589000
*                        END;                                      0802 03590000
*                      ELSE                                        0803 03591000
*                        DO;                                       0803 03592000
         B     @RC00795                                            0803 03593000
@RF00795 DS    0H                                                  0804 03594000
*                          OPOPTION = '0F'X;                       0804 03595000
         L     @08,@PC00007                                        0804 03596000
         MVI   OPOPTION(@08),X'0F'                                 0804 03597000
*                          DCBMRGET = OFF;                         0805 03598000
         LA    @08,40                                              0805 03599000
         AL    @08,DCBPTR                                          0805 03600000
         NI    DCBMRGET(@08),B'10111111'                           0805 03601000
*                          DCBMRPUT = ON;                          0806 03602000
         OI    DCBMRPUT(@08),B'01000000'                           0806 03603000
*                          DCBMRLCG = OFF;                         0807 03604000
         NI    DCBMRLCG(@08),B'11110111'                           0807 03605000
*                          DCBMRLCP = ON;                          0808 03606000
         OI    DCBMRLCP(@08),B'00001000'                           0808 03607000
*                        END;                                      0809 03608000
*                  END;                                            0810 03609000
*                                                                  0810 03610000
*                /****************************************************/ 03611000
*                /*                                                  */ 03612000
*                /* DATA SET USED FOR INPUT SET EODAD ADDRESS.       */ 03613000
*                /* SET INPUT SYNAD ROUTINE ADDRESS IN DCB.          */ 03614000
*                /*                                                  */ 03615000
*                /****************************************************/ 03616000
*                                                                  0811 03617000
*                ELSE                                              0811 03618000
*                  DO;                                             0811 03619000
         B     @RC00790                                            0811 03620000
@RF00790 DS    0H                                                  0812 03621000
*                    DCBEODA = IODEOD;                             0812 03622000
         L     @08,DCBPTR                                          0812 03623000
         L     @15,@PC00001                                        0812 03624000
         L     @15,GDTIOH(,@15)                                    0812 03625000
         MVC   DCBEODA+28(3,@08),IODEOD+1(@15)                     0812 03626000
*                    DCBSYN = IODOSSS;                             0813 03627000
         MVC   DCBSYN+52(3,@08),IODOSSS(@15)                       0813 03628000
*                  END;                                            0814 03629000
*                                                                  0814 03630000
*              /******************************************************/ 03631000
*              /*                                                    */ 03632000
*              /* SET DCB ERROPT FIELD.  -SKIP- FOR INPUT,           */ 03633000
*              /* AND -ABEND- FOR ALL OTHERS.                        */ 03634000
*              /*                                                    */ 03635000
*              /******************************************************/ 03636000
*                                                                  0815 03637000
*              IF IOCMACIN = ON                                    0815 03638000
*                THEN                                              0815 03639000
@RC00790 L     @08,IOCSPTR                                         0815 03640000
         TM    IOCMACIN(@08),B'10000000'                           0815 03641000
         BNO   @RF00815                                            0815 03642000
*                  DO;                                             0816 03643000
*                    DCBERABE = OFF;                               0817 03644000
*                    DCBERSKP = ON;                                0818 03645000
         L     @08,DCBPTR                                          0818 03646000
         OI    DCBERSKP+72(@08),B'01000000'                        0818 03647000
         NI    DCBERABE+72(@08),B'11011111'                        0818 03648000
*                  END;                                            0819 03649000
*                ELSE                                              0820 03650000
*                  DCBERABE = ON;                                  0820 03651000
*                                                                  0820 03652000
         B     @RC00815                                            0820 03653000
@RF00815 L     @08,DCBPTR                                          0820 03654000
         OI    DCBERABE+72(@08),B'00100000'                        0820 03655000
*              /******************************************************/ 03656000
*              /*                                                    */ 03657000
*              /* SET VALUES SET IN THE OPNAGL IN ANY DCB            */ 03658000
*              /*                                                    */ 03659000
*              /******************************************************/ 03660000
*                                                                  0821 03661000
*              /*   SAVE BLOCKSIZE FOR DEFAULT IN                    */ 03662000
*              /*   OPEN EXIT - WILL ONLY BE USED                    */ 03663000
*              /*   IF DCBBLKSI NOT PROVIDED BY                      */ 03664000
*              /*   OTHER MEANS                                      */ 03665000
*              IOCDLN = OPNBLK;                                    0821 03666000
*                                                                  0821 03667000
@RC00815 L     @08,OPNBLK(,OPNPTR)                                 0821 03668000
         L     @01,IOCSPTR                                         0821 03669000
         ST    @08,IOCDLN(,@01)                                    0821 03670000
*              IF OPNREC > SZ32K                                   0822 03671000
*                THEN                                              0822 03672000
         L     @08,OPNREC(,OPNPTR)                                 0822 03673000
         C     @08,@CF01444                                        0822 03674000
         BNH   @RF00822                                            0822 03675000
*                   /*************************************************/ 03676000
*                   /*                                               */ 03677000
*                   /* RECORD SIZE IS GREATER THAN                   */ 03678000
*                   /* MAXIMUM ALLOWED. SET LRECL=X                  */ 03679000
*                   /*                                               */ 03680000
*                   /*************************************************/ 03681000
*                   LRECLX = ON;                                   0823 03682000
         L     @08,DCBPTR                                          0823 03683000
         OI    LRECLX+72(@08),B'10000000'                          0823 03684000
*                ELSE                                              0824 03685000
*                  DO;                                             0824 03686000
*                                                                  0824 03687000
         B     @RC00822                                            0824 03688000
@RF00822 DS    0H                                                  0825 03689000
*                    /*   SET LRECL - WILL BE ZERO                   */ 03690000
*                    /*   IF NONE SPECIFIED BY CALLER.               */ 03691000
*                    DCBLRECL = OPNREC;                            0825 03692000
         L     @08,OPNREC(,OPNPTR)                                 0825 03693000
         L     @01,DCBPTR                                          0825 03694000
         STH   @08,DCBLRECL+72(,@01)                               0825 03695000
*                  END;                                            0826 03696000
*                                                                  0826 03697000
*              /* SET FIXED LENGTH RECFM IN DCB IF REQUESTED         */ 03698000
*              IF OPNRFMFX = ON                                    0827 03699000
*                THEN                                              0827 03700000
@RC00822 TM    OPNRFMFX(OPNPTR),B'10000000'                        0827 03701000
         BNO   @RF00827                                            0827 03702000
*                  DCBRECL = '10'B;                                0828 03703000
*                                                                  0828 03704000
         L     @08,DCBPTR                                          0828 03705000
         NI    DCBRECL+28(@08),B'10111111'                         0828 03706000
         OI    DCBRECL+28(@08),B'10000000'                         0828 03707000
*              /* SET VAR RECFM IN DCB IF REQUESTED.                 */ 03708000
*              IF OPNRFMVR = ON                                    0829 03709000
*                THEN                                              0829 03710000
@RF00827 TM    OPNRFMVR(OPNPTR),B'01000000'                        0829 03711000
         BNO   @RF00829                                            0829 03712000
*                  DCBRECL = '01'B;                                0830 03713000
*                                                                  0830 03714000
         L     @08,DCBPTR                                          0830 03715000
         NI    DCBRECL+28(@08),B'01111111'                         0830 03716000
         OI    DCBRECL+28(@08),B'01000000'                         0830 03717000
*              /* SET UND RECFM IN DCB IF REQUESTED.                 */ 03718000
*              IF OPNRFMUN = ON                                    0831 03719000
*                THEN                                              0831 03720000
@RF00829 TM    OPNRFMUN(OPNPTR),B'00100000'                        0831 03721000
         BNO   @RF00831                                            0831 03722000
*                  DCBRECL = '11'B;                                0832 03723000
*                                                                  0832 03724000
         L     @08,DCBPTR                                          0832 03725000
         OI    DCBRECL+28(@08),B'11000000'                         0832 03726000
*              /* SET VBS RECFM IN DCB IF REQUESTED.                 */ 03727000
*              IF OPNRFMSF = ON                                    0833 03728000
*                THEN                                              0833 03729000
@RF00831 TM    OPNRFMSF(OPNPTR),B'00010000'                        0833 03730000
         BNO   @RF00833                                            0833 03731000
*                  DO;                                             0834 03732000
*                    DCBRECL = '01'B;                              0835 03733000
         LA    @08,28                                              0835 03734000
         AL    @08,DCBPTR                                          0835 03735000
         NI    DCBRECL(@08),B'01111111'                            0835 03736000
         OI    DCBRECL(@08),B'01000000'                            0835 03737000
*                    DCBRECSB = ON;                                0836 03738000
         OI    DCBRECSB(@08),B'00001000'                           0836 03739000
*                  END;                                            0837 03740000
*                                                                  0837 03741000
*              /* SET BLOCKED RECFM IN DCB IF REQUESTED.             */ 03742000
*              IF OPNRFMBK = ON                                    0838 03743000
*                THEN                                              0838 03744000
@RF00833 TM    OPNRFMBK(OPNPTR),B'00001000'                        0838 03745000
         BNO   @RF00838                                            0838 03746000
*                  DCBRECBR = ON;                                  0839 03747000
*                                                                  0839 03748000
         L     @08,DCBPTR                                          0839 03749000
         OI    DCBRECBR+28(@08),B'00010000'                        0839 03750000
*            END SETDCB;                                           0840 03751000
*                                                                  0840 03752000
@RF00838 DS    0H                                                  0841 03753000
*        RETURN CODE (BLDDRC);                                     0841 03754000
*                                                                  0841 03755000
@RC00773 LR    @15,BLDDRC                                          0841 03756000
         L     @13,4(,@13)                                         0841 03757000
         L     @14,12(,@13)                                        0841 03758000
         LM    @00,@12,20(@13)                                     0841 03759000
         BR    @14                                                 0841 03760000
*        END BUILDDBK;                                             0842 03761000
*                                                                  0842 03762000
*                                                                  0842 03763000
@PB00007 DS    0H                                                  0843 03764000
*/********************************************************************/ 03765000
*/*                                                                  */ 03766000
*/* FUNCTION - THIS ROUTINE IS CALLED BY OPEN OR CLOSE IF AN         */ 03767000
*/*            ABEND OCCURS DURING THE SVC.                          */ 03768000
*/*                                                                  */ 03769000
*/* INPUT -    ABEND ARGUMENT LIST IS ADDRESSED BY REG 1.            */ 03770000
*/*                                                                  */ 03771000
*/* OUTPUT -   IGNORE RETURN CODE SET IN LIST AND ABEND EXIT FLAG SET*/ 03772000
*/*            IN THE IOCS DEFINING THE DATA SET.                    */ 03773000
*/*                                                                  */ 03774000
*/********************************************************************/ 03775000
*                                                                  0843 03776000
*ABEXRTN:                                                          0843 03777000
*                                                                  0843 03778000
*        SAVE14 = REG14;                                           0843 03779000
*                                                                  0843 03780000
ABEXRTN  LR    SAVE14,REG14                                        0843 03781000
*        ABEXPTR = REG1;                                           0844 03782000
         ST    REG1,ABEXPTR                                        0844 03783000
*        DCBPTR = ABDCBAD;                                         0845 03784000
         L     @08,ABEXPTR                                         0845 03785000
         L     @08,ABDCBAD(,@08)                                   0845 03786000
         ST    @08,DCBPTR                                          0845 03787000
*        DCB00 = '00'X;                                            0846 03788000
*                                                                  0846 03789000
         MVI   DCB00,X'00'                                         0846 03790000
*        DO EXITCTR = 1 TO 4;                                      0847 03791000
         LA    EXITCTR,1                                           0847 03792000
@DL00847 DS    0H                                                  0848 03793000
*          IOCSPTR = IOCSADDR (EXITCTR);                           0848 03794000
         LR    @08,EXITCTR                                         0848 03795000
         SLA   @08,2                                               0848 03796000
         L     @08,IOCSADDR-4(@08)                                 0848 03797000
         ST    @08,IOCSPTR                                         0848 03798000
*          IF IOCCBA = DCBPTR                                      0849 03799000
*            THEN                                                  0849 03800000
         L     @08,IOCEXT(,@08)                                    0849 03801000
         CLC   IOCCBA(4,@08),DCBPTR                                0849 03802000
         BNE   @RF00849                                            0849 03803000
*              DO;                                                 0850 03804000
*                IOCINFAE = ON;                                    0851 03805000
         OI    IOCINFAE(@08),B'01000000'                           0851 03806000
*                EXITCTR = 5;                                      0852 03807000
         LA    EXITCTR,5                                           0852 03808000
*              END;                                                0853 03809000
*        END;                                                      0854 03810000
*                                                                  0854 03811000
@RF00849 AL    EXITCTR,@CF00161                                    0854 03812000
         C     EXITCTR,@CF00040                                    0854 03813000
         BNH   @DL00847                                            0854 03814000
*        ABOPT = RCIGNORE;                                         0855 03815000
*                                                                  0855 03816000
         L     @08,ABEXPTR                                         0855 03817000
         MVI   ABOPT(@08),X'04'                                    0855 03818000
*        REG14 = SAVE14;                                           0856 03819000
         LR    REG14,SAVE14                                        0856 03820000
*        GEN(RETURN);                                              0857 03821000
*                                                                  0857 03822000
*                                                                  0857 03823000
         RETURN                                                         03824000
*/********************************************************************/ 03825000
*/*                                                                  */ 03826000
*/* FUNCTION - THIS ROUTINE IS CALLED BY THE OPEN SVC.               */ 03827000
*/*            IT CHECKS TO INSURE THAT VALID SYSIN AND SYSOUT       */ 03828000
*/*            DCB PARAMETERS HAVE BEEN SPECIFIED.                   */ 03829000
*/*            THE VALUES SUPPLIED BY THE JCL OR VTOC ARE EXTRACTED  */ 03830000
*/*            FROM THE DCB AND SAVED IN THE IOCSTR.                 */ 03831000
*/*                                                                  */ 03832000
*/* INPUT -    REG1 - ADDRESS OF DCB BEING OPENED.                   */ 03833000
*/*                                                                  */ 03834000
*/* OUTPUT -   IOCSTR IS UPDATED TO REFLECT INFORMATION EXTRACTED    */ 03835000
*/*            FROM THE DCB.                                         */ 03836000
*/*                                                                  */ 03837000
*/*            DCB IS UPDATED IF INVALID BLOCKSIZES WERE SPECIFIED.  */ 03838000
*/*                                                                  */ 03839000
*/*            DCB IS UPDATED IF THE DATA SET RECORD FORMAT IS       */ 03840000
*/*            VARIABLE SPANNED.  IF SPANNED INPUT THE FLAG IS SET   */ 03841000
*/*            TO HAVE OPEN OBTAIN A HIDDEN BUFFER,                  */ 03842000
*/*            UNLESS THE RECORD SIZE IS GREATER                     */ 03843000
*/*            THAN 32767. FOR SPANNED                               */ 03844000
*/*            OUTPUT THE MACRO FORM IS CHANGED TO DATA MODE         */ 03845000
*/*            PROCESSING.                                           */ 03846000
*/*                                                                  */ 03847000
*/* ERRORS - NONE                                                    */ 03848000
*/*                                                                  */ 03849000
*/********************************************************************/ 03850000
*                                                                  0858 03851000
*IRTOPEX:                                                          0858 03852000
*                                                                  0858 03853000
*        SAVE14 = REG14;                                           0858 03854000
IRTOPEX  LR    SAVE14,REG14                                        0858 03855000
*        DCBPTR = REG1;                                            0859 03856000
         ST    REG1,DCBPTR                                         0859 03857000
*        DCB00 = '00'X;                                            0860 03858000
*                                                                  0860 03859000
         MVI   DCB00,X'00'                                         0860 03860000
*        /************************************************************/ 03861000
*        /*                                                          */ 03862000
*        /* SEARCH THE IOCSBLT LIST TO FIND THE ADDRESS OF THE       */ 03863000
*        /* IOCS THAT MATCHES THE DCB BEING OPENED.                  */ 03864000
*        /*                                                          */ 03865000
*        /************************************************************/ 03866000
*                                                                  0861 03867000
*        DO EXITCTR = 1 TO 4;                                      0861 03868000
*                                                                  0861 03869000
         LA    EXITCTR,1                                           0861 03870000
@DL00861 DS    0H                                                  0862 03871000
*          IOCSPTR = IOCSADDR (EXITCTR);                           0862 03872000
*                                                                  0862 03873000
         LR    @08,EXITCTR                                         0862 03874000
         SLA   @08,2                                               0862 03875000
         L     @08,IOCSADDR-4(@08)                                 0862 03876000
         ST    @08,IOCSPTR                                         0862 03877000
*          IF IOCCBA = DCBPTR                                      0863 03878000
*            THEN                                                  0863 03879000
         L     @08,IOCEXT(,@08)                                    0863 03880000
         CLC   IOCCBA(4,@08),DCBPTR                                0863 03881000
         BNE   @RF00863                                            0863 03882000
*              EXITCTR = 5;                                        0864 03883000
*                                                                  0864 03884000
         LA    EXITCTR,5                                           0864 03885000
*        END;                                                      0865 03886000
*                                                                  0865 03887000
@RF00863 AL    EXITCTR,@CF00161                                    0865 03888000
         C     EXITCTR,@CF00040                                    0865 03889000
         BNH   @DL00861                                            0865 03890000
*        IF DCBBLKSI = 0                                           0866 03891000
*          THEN                                                    0866 03892000
         SLR   @08,@08                                             0866 03893000
         LA    @02,52                                              0866 03894000
         AL    @02,DCBPTR                                          0866 03895000
         CH    @08,DCBBLKSI(,@02)                                  0866 03896000
         BNE   @RF00866                                            0866 03897000
*            /********************************************************/ 03898000
*            /*                                                      */ 03899000
*            /* DCBBLKSI HAS NOT BEEN MERGED FROM THE JCL OR         */ 03900000
*            /* THE DATA SET LABEL - USE DEFAULT VALUE               */ 03901000
*            /*                                                      */ 03902000
*            /********************************************************/ 03903000
*            DO;                                                   0867 03904000
*              DCBBLKSI = IOCDLN;                                  0868 03905000
         L     @15,IOCSPTR                                         0868 03906000
         L     @14,IOCDLN(,@15)                                    0868 03907000
         STH   @14,DCBBLKSI(,@02)                                  0868 03908000
*              IOCDLN = 0;                                         0869 03909000
         ST    @08,IOCDLN(,@15)                                    0869 03910000
*            END;                                                  0870 03911000
*                                                                  0870 03912000
*        IF IOCFLGIO = ON | IOCFLGSP = ON                          0871 03913000
*          THEN                                                    0871 03914000
*                                                                  0871 03915000
@RF00866 L     @08,IOCSPTR                                         0871 03916000
         L     @08,IOCEXT(,@08)                                    0871 03917000
         TM    IOCFLGIO(@08),B'00010010'                           0871 03918000
         BZ    @RF00871                                            0871 03919000
*            /********************************************************/ 03920000
*            /*                                                      */ 03921000
*            /* DATA SET IS DD * OR SYSOUT = A.  INSURE THAT         */ 03922000
*            /* DATA SET WILL OPEN SUCCESSFULLY.                     */ 03923000
*            /*                                                      */ 03924000
*            /********************************************************/ 03925000
*                                                                  0872 03926000
*CKIODCB:    DO;                                                   0872 03927000
*                                                                  0872 03928000
CKIODCB  DS    0H                                                  0873 03929000
*              /******************************************************/ 03930000
*              /*                                                    */ 03931000
*              /* SET RECORD FORMAT TO BLOCKED RECORDS               */ 03932000
*              /*                                                    */ 03933000
*              /******************************************************/ 03934000
*                                                                  0873 03935000
*              DCBRECBR = ON;                                      0873 03936000
*                                                                  0873 03937000
         L     @08,DCBPTR                                          0873 03938000
         OI    DCBRECBR+28(@08),B'00010000'                        0873 03939000
*              IF IOCMACIN = ON                                    0874 03940000
*                THEN                                              0874 03941000
*                                                                  0874 03942000
         L     @08,IOCSPTR                                         0874 03943000
         TM    IOCMACIN(@08),B'10000000'                           0874 03944000
         BNO   @RF00874                                            0874 03945000
*                  /**************************************************/ 03946000
*                  /*                                                */ 03947000
*                  /* DD * HAS FIXED LENGTH RECORDS.  INSURE THAT    */ 03948000
*                  /* BLOCKSIZE IS A MULTIPLE OF LRECL.              */ 03949000
*                  /*                                                */ 03950000
*                  /**************************************************/ 03951000
*                                                                  0875 03952000
*IOISIN:           DO;                                             0875 03953000
*                                                                  0875 03954000
IOISIN   DS    0H                                                  0876 03955000
*                    IOCRFMFX = ON;                                0876 03956000
*                                                                  0876 03957000
         L     @08,IOCSPTR                                         0876 03958000
         OI    IOCRFMFX(@08),B'10000000'                           0876 03959000
*                    IF DCBBLKSI = 0 | DCBBLKSI//DCBLRECL ^= 0     0877 03960000
*                      THEN                                        0877 03961000
         SLR   @08,@08                                             0877 03962000
         L     @02,DCBPTR                                          0877 03963000
         LH    @15,DCBBLKSI+52(,@02)                               0877 03964000
         CR    @15,@08                                             0877 03965000
         BE    @RT00877                                            0877 03966000
         LR    @00,@15                                             0877 03967000
         SRDA  @00,32                                              0877 03968000
         LH    @02,DCBLRECL+72(,@02)                               0877 03969000
         DR    @00,@02                                             0877 03970000
         CR    @00,@08                                             0877 03971000
         BE    @RF00877                                            0877 03972000
@RT00877 DS    0H                                                  0878 03973000
*                        DCBBLKSI = DCBLRECL;                      0878 03974000
*                                                                  0878 03975000
         L     @08,DCBPTR                                          0878 03976000
         LH    @02,DCBLRECL+72(,@08)                               0878 03977000
         STH   @02,DCBBLKSI+52(,@08)                               0878 03978000
*                  END IOISIN;                                     0879 03979000
*                                                                  0879 03980000
*                ELSE                                              0880 03981000
*                                                                  0880 03982000
*                  /**************************************************/ 03983000
*                  /*                                                */ 03984000
*                  /* DATA SET IS SYSOUT = A.  CHECK ATTRIBUTES.     */ 03985000
*                  /*                                                */ 03986000
*                  /**************************************************/ 03987000
*                                                                  0880 03988000
*IOISOUT:          DO;                                             0880 03989000
*                                                                  0880 03990000
*                                                                  0880 03991000
         B     @RC00874                                            0880 03992000
@RF00874 DS    0H                                                  0880 03993000
IOISOUT  DS    0H                                                  0881 03994000
*                    IF IOCDEVUR = ON                              0881 03995000
*                      THEN                                        0881 03996000
*                                                                  0881 03997000
         L     @08,IOCSPTR                                         0881 03998000
         L     @08,IOCEXT(,@08)                                    0881 03999000
         TM    IOCDEVUR(@08),B'00100000'                           0881 04000000
         BNO   @RF00881                                            0881 04001000
*                        /********************************************/ 04002000
*                        /*                                          */ 04003000
*                        /* SET ERROPT = ACCEPT FOR UNIT RECORD      */ 04004000
*                        /*                                          */ 04005000
*                        /********************************************/ 04006000
*                                                                  0882 04007000
*                        DO;                                       0882 04008000
*                          DCBERABE = OFF;                         0883 04009000
*                          DCBERACC = ON;                          0884 04010000
         L     @08,DCBPTR                                          0884 04011000
         OI    DCBERACC+72(@08),B'10000000'                        0884 04012000
         NI    DCBERABE+72(@08),B'11011111'                        0884 04013000
*                        END;                                      0885 04014000
*                                                                  0885 04015000
*                    IF DCBRECL = '11'B                            0886 04016000
*                      THEN                                        0886 04017000
*                                                                  0886 04018000
@RF00881 L     @08,DCBPTR                                          0886 04019000
         TM    DCBRECL+28(@08),B'11000000'                         0886 04020000
         BNO   @RF00886                                            0886 04021000
*                        /********************************************/ 04022000
*                        /*                                          */ 04023000
*                        /* TURN OFF BLOCKED INDICATOR.  DEFAULT     */ 04024000
*                        /* BLOCK SIZE FOR RECFM=U IS 121.           */ 04025000
*                        /*                                          */ 04026000
*                        /********************************************/ 04027000
*                                                                  0887 04028000
*OUTISU:                 DO;                                       0887 04029000
*                                                                  0887 04030000
OUTISU   DS    0H                                                  0888 04031000
*                          DCBRECBR = OFF;                         0888 04032000
         L     @08,DCBPTR                                          0888 04033000
         NI    DCBRECBR+28(@08),B'11101111'                        0888 04034000
*                          IF DCBBLKSI < 121                       0889 04035000
*                            THEN                                  0889 04036000
         LA    @02,121                                             0889 04037000
         AL    @08,@CF00584                                        0889 04038000
         CH    @02,DCBBLKSI(,@08)                                  0889 04039000
         BNH   @RF00889                                            0889 04040000
*                              DCBBLKSI = 121;                     0890 04041000
*                                                                  0890 04042000
         STH   @02,DCBBLKSI(,@08)                                  0890 04043000
*                        END OUTISU;                               0891 04044000
*                                                                  0891 04045000
*                      /**********************************************/ 04046000
*                      /*                                            */ 04047000
*                      /* RECORD FORMAT OF DATA SET MUST BE V        */ 04048000
*                      /*                                            */ 04049000
*                      /**********************************************/ 04050000
*                                                                  0892 04051000
*                      ELSE                                        0892 04052000
*OUTISV:                 DO;                                       0892 04053000
*                                                                  0892 04054000
         B     @RC00886                                            0892 04055000
@RF00886 DS    0H                                                  0892 04056000
OUTISV   DS    0H                                                  0893 04057000
*                          IOCRFMVR = ON;                          0893 04058000
         L     @08,IOCSPTR                                         0893 04059000
         OI    IOCRFMVR(@08),B'01000000'                           0893 04060000
*                          DCBRECL = '01'B;                        0894 04061000
*                                                                  0894 04062000
         L     @08,DCBPTR                                          0894 04063000
         NI    DCBRECL+28(@08),B'01111111'                         0894 04064000
         OI    DCBRECL+28(@08),B'01000000'                         0894 04065000
*                          IF DCBLRECL < 125                       0895 04066000
*                            THEN                                  0895 04067000
         LA    @02,125                                             0895 04068000
         AL    @08,@CF00878                                        0895 04069000
         CH    @02,DCBLRECL(,@08)                                  0895 04070000
         BNH   @RF00895                                            0895 04071000
*                              DCBLRECL = 125;                     0896 04072000
*                                                                  0896 04073000
         STH   @02,DCBLRECL(,@08)                                  0896 04074000
*                          IF DCBBLKSI < DCBLRECL + 4              0897 04075000
*                            THEN                                  0897 04076000
@RF00895 L     @08,DCBPTR                                          0897 04077000
         LA    @02,52                                              0897 04078000
         ALR   @02,@08                                             0897 04079000
         LA    @15,4                                               0897 04080000
         AH    @15,DCBLRECL+72(,@08)                               0897 04081000
         CH    @15,DCBBLKSI(,@02)                                  0897 04082000
         BNH   @RF00897                                            0897 04083000
*                              DCBBLKSI = 629;                     0898 04084000
*                                                                  0898 04085000
         MVC   DCBBLKSI(2,@02),@CH01465                            0898 04086000
*                        END OUTISV;                               0899 04087000
*                                                                  0899 04088000
@RF00897 DS    0H                                                  0900 04089000
*                  END IOISOUT;                                    0900 04090000
*                                                                  0900 04091000
@RC00886 DS    0H                                                  0901 04092000
*            END CKIODCB;                                          0901 04093000
*                                                                  0901 04094000
@RC00874 DS    0H                                                  0902 04095000
*        /************************************************************/ 04096000
*        /*                                                          */ 04097000
*        /* IF BLOCK PROCESSING IS REQUESTED SET BLOCKED RECFM.      */ 04098000
*        /* IF ASA CONTROL REQUESTED,  SET THIS RECFM IN DCB.        */ 04099000
*        /*                                                          */ 04100000
*        /************************************************************/ 04101000
*                                                                  0902 04102000
*        IF DCBRECBR = ON                                          0902 04103000
*          THEN                                                    0902 04104000
@RF00871 L     @08,DCBPTR                                          0902 04105000
         TM    DCBRECBR+28(@08),B'00010000'                        0902 04106000
         BNO   @RF00902                                            0902 04107000
*            IOCRFMBK = ON;                                        0903 04108000
*                                                                  0903 04109000
         L     @08,IOCSPTR                                         0903 04110000
         OI    IOCRFMBK(@08),B'00001000'                           0903 04111000
*        IF IOCINFAC = ON                                          0904 04112000
*          THEN                                                    0904 04113000
@RF00902 L     @08,IOCSPTR                                         0904 04114000
         L     @08,IOCEXT(,@08)                                    0904 04115000
         TM    IOCINFAC(@08),B'00001000'                           0904 04116000
         BNO   @RF00904                                            0904 04117000
*            DCBRECCC = '10'B;                                     0905 04118000
*                                                                  0905 04119000
         L     @08,DCBPTR                                          0905 04120000
         NI    DCBRECCC+28(@08),B'11111101'                        0905 04121000
         OI    DCBRECCC+28(@08),B'00000100'                        0905 04122000
*        /************************************************************/ 04123000
*        /*                                                          */ 04124000
*        /* IF THE RECORD FORMAT IS UNDEFINED THE UNDEFINED RECFM    */ 04125000
*        /* FLAG ANS THE BLOCKSIZE ARE SET IN THE IOCS.              */ 04126000
*        /*                                                          */ 04127000
*        /************************************************************/ 04128000
*                                                                  0906 04129000
*        IF DCBRECL = '11'B                                        0906 04130000
*          THEN                                                    0906 04131000
@RF00904 L     @08,DCBPTR                                          0906 04132000
         TM    DCBRECL+28(@08),B'11000000'                         0906 04133000
         BNO   @RF00906                                            0906 04134000
*            DO;                                                   0907 04135000
*                                                                  0907 04136000
*              IOCTRN = DCBBLKSI;                                  0908 04137000
         L     @02,IOCSPTR                                         0908 04138000
         LH    @08,DCBBLKSI+52(,@08)                               0908 04139000
         ST    @08,IOCTRN(,@02)                                    0908 04140000
*              IOCRFMUN = ON;                                      0909 04141000
*                                                                  0909 04142000
         OI    IOCRFMUN(@02),B'00100000'                           0909 04143000
*            END;                                                  0910 04144000
*                                                                  0910 04145000
*                                                                  0910 04146000
*        /************************************************************/ 04147000
*        /*                                                          */ 04148000
*        /* IF RECORD FORMAT IS FIXED SET FIXED RECFM AND            */ 04149000
*        /* LRECL IN IOCS.                                           */ 04150000
*        /*                                                          */ 04151000
*        /************************************************************/ 04152000
*                                                                  0911 04153000
*        IF DCBRECL = '10'B                                        0911 04154000
*          THEN                                                    0911 04155000
@RF00906 L     @08,DCBPTR                                          0911 04156000
         TM    DCBRECL+28(@08),B'10000000'                         0911 04157000
         BNO   @RF00911                                            0911 04158000
         TM    DCBRECL+28(@08),B'01000000'                         0911 04159000
         BNZ   @RF00911                                            0911 04160000
*            DO;                                                   0912 04161000
*                                                                  0912 04162000
*              IF DCBLRECL = 0                                     0913 04163000
*                THEN                                              0913 04164000
         LA    @02,72                                              0913 04165000
         ALR   @02,@08                                             0913 04166000
         LH    @15,DCBLRECL(,@02)                                  0913 04167000
         LTR   @15,@15                                             0913 04168000
         BNZ   @RF00913                                            0913 04169000
*                  DCBLRECL = DCBBLKSI;                            0914 04170000
*                                                                  0914 04171000
         LH    @08,DCBBLKSI+52(,@08)                               0914 04172000
         STH   @08,DCBLRECL(,@02)                                  0914 04173000
*              IOCTRN = DCBLRECL;                                  0915 04174000
@RF00913 L     @08,IOCSPTR                                         0915 04175000
         L     @02,DCBPTR                                          0915 04176000
         LH    @02,DCBLRECL+72(,@02)                               0915 04177000
         ST    @02,IOCTRN(,@08)                                    0915 04178000
*              IOCRFMFX = ON;                                      0916 04179000
*                                                                  0916 04180000
         OI    IOCRFMFX(@08),B'10000000'                           0916 04181000
*            END;                                                  0917 04182000
*                                                                  0917 04183000
*        /************************************************************/ 04184000
*        /*                                                          */ 04185000
*        /* IF DATA SET RECFM IS VARIABLE SET VARIABLE FLAG IN IOCS. */ 04186000
*        /* SET LENGTH OF DATA (LRECL MINUS RDW) IN IOCS.            */ 04187000
*        /*                                                          */ 04188000
*        /************************************************************/ 04189000
*                                                                  0918 04190000
*        IF DCBRECL = '01'B                                        0918 04191000
*          THEN                                                    0918 04192000
@RF00911 L     @08,DCBPTR                                          0918 04193000
         TM    DCBRECL+28(@08),B'01000000'                         0918 04194000
         BNO   @RF00918                                            0918 04195000
         TM    DCBRECL+28(@08),B'10000000'                         0918 04196000
         BNZ   @RF00918                                            0918 04197000
*            DO;                                                   0919 04198000
*                                                                  0919 04199000
*              IF DCBLRECL = 0                                     0920 04200000
*                THEN                                              0920 04201000
         LA    @02,72                                              0920 04202000
         ALR   @02,@08                                             0920 04203000
         LH    @15,DCBLRECL(,@02)                                  0920 04204000
         LTR   @15,@15                                             0920 04205000
         BNZ   @RF00920                                            0920 04206000
*                  DCBLRECL = DCBBLKSI - 4;                        0921 04207000
*                                                                  0921 04208000
         LH    @08,DCBBLKSI+52(,@08)                               0921 04209000
         SL    @08,@CF00040                                        0921 04210000
         STH   @08,DCBLRECL(,@02)                                  0921 04211000
*              IOCRFMVR = ON;                                      0922 04212000
@RF00920 L     @08,IOCSPTR                                         0922 04213000
         OI    IOCRFMVR(@08),B'01000000'                           0922 04214000
*              IOCTRN = DCBLRECL - 4;                              0923 04215000
*                                                                  0923 04216000
         L     @02,DCBPTR                                          0923 04217000
         LA    @15,72                                              0923 04218000
         ALR   @15,@02                                             0923 04219000
         LH    @14,DCBLRECL(,@15)                                  0923 04220000
         SL    @14,@CF00040                                        0923 04221000
         ST    @14,IOCTRN(,@08)                                    0923 04222000
*              /******************************************************/ 04223000
*              /*                                                    */ 04224000
*              /* A HIDDEN BUFFER IS OBTAINED BY THE OPEN SVC        */ 04225000
*              /* FOR SPANNED RECORDS, UNLESS THE RECORD             */ 04226000
*              /* SIZE IS GREATER THAN 32767                         */ 04227000
*              /*                                                    */ 04228000
*              /******************************************************/ 04229000
*                                                                  0924 04230000
*              IF DCBRECSB = ON                                    0924 04231000
*                THEN                                              0924 04232000
         AL    @02,@CF00289                                        0924 04233000
         TM    DCBRECSB(@02),B'00001000'                           0924 04234000
         BNO   @RF00924                                            0924 04235000
*                  DO;                                             0925 04236000
*                                                                  0925 04237000
*                    IOCRFMSF = ON;                                0926 04238000
         OI    IOCRFMSF(@08),B'00010000'                           0926 04239000
*                    IF IOCMACBK = OFF & LRECLX = OFF              0927 04240000
*                      THEN                                        0927 04241000
         TM    IOCMACBK(@08),B'00010000'                           0927 04242000
         BNZ   @RF00927                                            0927 04243000
         TM    LRECLX(@15),B'10000000'                             0927 04244000
         BNZ   @RF00927                                            0927 04245000
*                         DCBBFT = '110'B;                         0928 04246000
*                                                                  0928 04247000
         NI    DCBBFT(@02),B'11101111'                             0928 04248000
         OI    DCBBFT(@02),B'01100000'                             0928 04249000
*                  END;                                            0929 04250000
*                                                                  0929 04251000
@RF00927 DS    0H                                                  0930 04252000
*            END;                                                  0930 04253000
*                                                                  0930 04254000
@RF00924 DS    0H                                                  0931 04255000
*        /************************************************************/ 04256000
*        /*                                                          */ 04257000
*        /* FOR BSAM PROCESSING, SET BLOCKSIZE AS IOCTRN             */ 04258000
*        /* AND SET LENGTH OF BLOCK TO PROCESS TO BLOCKSIZE          */ 04259000
*        /* IF DIFFERENT LENGTH, USER IS RESPONSIBLE TO              */ 04260000
*        /* UPDATE.                                                  */ 04261000
*        /*                                                          */ 04262000
*        /************************************************************/ 04263000
*                                                                  0931 04264000
*        IF IOCMACBK = ON                                          0931 04265000
*          THEN                                                    0931 04266000
@RF00918 L     @08,IOCSPTR                                         0931 04267000
         TM    IOCMACBK(@08),B'00010000'                           0931 04268000
         BNO   @RF00931                                            0931 04269000
*            DO;                                                   0932 04270000
*              IOCTRN = DCBBLKSI + DCBKEYLE;                       0933 04271000
         L     @02,DCBPTR                                          0933 04272000
         LH    @15,DCBBLKSI+52(,@02)                               0933 04273000
         SLR   @14,@14                                             0933 04274000
         IC    @14,DCBKEYLE+16(,@02)                               0933 04275000
         LR    @02,@15                                             0933 04276000
         ALR   @02,@14                                             0933 04277000
         ST    @02,IOCTRN(,@08)                                    0933 04278000
*              IOCDLN = DCBBLKSI;                                  0934 04279000
         ST    @15,IOCDLN(,@08)                                    0934 04280000
*              IOCKYL = DCBKEYLE;                                  0935 04281000
         STC   @14,IOCKYL(,@08)                                    0935 04282000
*            END;                                                  0936 04283000
*                                                                  0936 04284000
*        REG14 = SAVE14;                                           0937 04285000
@RF00931 LR    REG14,SAVE14                                        0937 04286000
*        GEN(BR    REG14);                                         0938 04287000
*                                                                  0938 04288000
*                                                                  0938 04289000
*                                                                  0938 04290000
         BR    REG14                                                    04291000
*        /************************************************************/ 04292000
*        /*                                                          */ 04293000
*        /* PROCEDURE NAME - BLDOCMSG                                */ 04294000
*        /*                                                          */ 04295000
*        /* FUNCTION - THIS PROCEDURE IS CALLED WHEN AN ERROR HAS    */ 04296000
*        /*            DETECTED AND AN ERROR IS TO BE WRITTEN.       */ 04297000
*        /*                                                          */ 04298000
*        /*            THE DATA ARGUMENT FOR THE TEXT PROCESSOR      */ 04299000
*        /*            IS BUILT AND PASSED TO A ROUTINE THAT WILL    */ 04300000
*        /*            CALL THE TEXT PROCESSOR.                      */ 04301000
*        /*                                                          */ 04302000
*        /* INPUT -    SAVESTID - STID OF MESSAGE TO PRINT           */ 04303000
*        /*            OPCTYP - TYPE OF OPERATION (OPEN/CLOSE)       */ 04304000
*        /*                                                          */ 04305000
*        /* OUTPUT -   DARGLIST - SET WITH MESSAGE INFORMATION       */ 04306000
*        /*                                                          */ 04307000
*        /************************************************************/ 04308000
*                                                                  0939 04309000
*BLDOCMSG: PROC (VARTEXT);                                         0939 04310000
*                                                                  0939 04311000
         B     @PB00008                                            0939 04312000
BLDOCMSG STM   @14,@12,@SA00008                                    0939 04313000
         MVC   @PC00008(4),0(@01)                                  0939 04314000
*        /* VARIABLE TEXT IF DATA SET NAME IS NOT PRESENT            */ 04315000
*        DCL VARTEXT CHAR (8);                                     0940 04316000
*                                                                  0940 04317000
*        /* AREA TO BUILD FIRST ERROR MESSAGE                        */ 04318000
*        DCL DMSGHEAD CHAR (28) BDY(WORD);                         0941 04319000
*                                                                  0941 04320000
*        /* DSNAME AREA                                              */ 04321000
*        DCL DSNCMP CHAR(44) BASED (IOCDSN);                       0942 04322000
*                                                                  0942 04323000
*        DCL VTOC CHAR(44) GENERATED; /* SPECIAL VTOC NAME           */ 04324000
*                                                                  0943 04325000
*        /* VTOC DSNAME AREA                                         */ 04326000
*        DCL DSNVTOC CHAR(44) INIT ('VTOC');                       0944 04327000
*                                                                  0944 04328000
*        /* VTOC DSNAME AREA ADDRESS                                 */ 04329000
*        DCL DSNVTOCP PTR(31) INIT (ADDR(DSNVTOC));                0945 04330000
*                                                                  0945 04331000
*        /************************************************************/ 04332000
*        /*                                                          */ 04333000
*        /* IF SYSPRINT/SYSLST IS NOT OPEN PROCESSING IS TERMINATED. */ 04334000
*        /*                                                          */ 04335000
*        /************************************************************/ 04336000
*                                                                  0946 04337000
*        IF IODOCS = NULLPTR | IODOCS -> IOCMSGOP = OFF &          0946 04338000
*         OCATYP = OCATYPOP                                        0946 04339000
*          THEN                                                    0946 04340000
         L     @08,@PC00001                                        0946 04341000
         L     @08,GDTIOH(,@08)                                    0946 04342000
         L     @08,IODOCS(,@08)                                    0946 04343000
         LTR   @08,@08                                             0946 04344000
         BZ    @RT00946                                            0946 04345000
         TM    IOCMSGOP(@08),B'10000000'                           0946 04346000
         BNZ   @RF00946                                            0946 04347000
         L     @08,@PC00001+4                                      0946 04348000
         CLI   OCATYP(@08),1                                       0946 04349000
         BNE   @RF00946                                            0946 04350000
@RT00946 DS    0H                                                  0947 04351000
*            DO;                                                   0947 04352000
*                                                                  0947 04353000
*              /******************************************************/ 04354000
*              /*                                                    */ 04355000
*              /* CHECK IF UABORT IS FOR NO SPACE OR OTHER ERROR     */ 04356000
*              /* RESULTING IN SYSPRINT/SYSLST NOT BEING OPEN AND    */ 04357000
*              /* SET CORRESPONDING RETURN CODE.                     */ 04358000
*              /*                                                    */ 04359000
*              /******************************************************/ 04360000
*                                                                  0948 04361000
*              IF DARGSMOD = 'UV0' & DARGSENT = NOCRSTID           0948 04362000
*                THEN                                              0948 04363000
*                                                                  0948 04364000
         L     @08,DDSTRU                                          0948 04365000
         CLC   DARGSMOD(3,@08),@CC01006                            0948 04366000
         BNE   @RF00948                                            0948 04367000
         CLI   DARGSENT(@08),4                                     0948 04368000
         BNE   @RF00948                                            0948 04369000
*                  DO;                                             0949 04370000
*                    RESPECIFY(REG13,REG14,REG15) RSTD;            0950 04371000
*                    REG15 = 28;                                   0951 04372000
         LA    REG15,28                                            0951 04373000
*                    REG14 = GDTABT;                               0952 04374000
         L     @08,@PC00001                                        0952 04375000
         L     REG14,GDTABT(,@08)                                  0952 04376000
*                    REG13 = GDTABH;                               0953 04377000
         L     REG13,GDTABH(,@08)                                  0953 04378000
*                    GEN(BR    REG14);                             0954 04379000
         BR    REG14                                                    04380000
*                    RESPECIFY(REG13,REG14,REG15)UNRSTD;           0955 04381000
*                  END;                                            0956 04382000
*                ELSE                                              0957 04383000
*                                                                  0957 04384000
*                  DO;                                             0957 04385000
         B     @RC00948                                            0957 04386000
@RF00948 DS    0H                                                  0958 04387000
*                    RESPECIFY(REG13,REG14,REG15) RSTD;            0958 04388000
*                    REG15 = 36;                                   0959 04389000
         LA    REG15,36                                            0959 04390000
*                    REG14 = GDTABT;                               0960 04391000
         L     @08,@PC00001                                        0960 04392000
         L     REG14,GDTABT(,@08)                                  0960 04393000
*                    REG13 = GDTABH;                               0961 04394000
         L     REG13,GDTABH(,@08)                                  0961 04395000
*                    GEN(BR    REG14);                             0962 04396000
         BR    REG14                                                    04397000
*                    RESPECIFY(REG13,REG14,REG15)UNRSTD;           0963 04398000
*                  END;                                            0964 04399000
*                                                                  0964 04400000
*            END;                                                  0965 04401000
*                                                                  0965 04402000
@RC00948 DS    0H                                                  0966 04403000
*        /************************************************************/ 04404000
*        /*                                                          */ 04405000
*        /* PRINT THE MAIN ERROR MESSAGE LINE                        */ 04406000
*        /*                                                          */ 04407000
*        /************************************************************/ 04408000
*                                                                  0966 04409000
*        DDSTRU = ADDR (DMSGHEAD);                                 0966 04410000
@RF00946 LA    @08,DMSGHEAD                                        0966 04411000
         ST    @08,DDSTRU                                          0966 04412000
*        DMSGHEAD = ''B;                                           0967 04413000
         XC    DMSGHEAD(28),DMSGHEAD                               0967 04414000
*        DARGSMOD = 'IO0';                                         0968 04415000
*                                                                  0968 04416000
         MVC   DARGSMOD(3,@08),@CC00957                            0968 04417000
*        IF OCATYP = OCATYPOP                                      0969 04418000
*          THEN                                                    0969 04419000
         L     @15,@PC00001+4                                      0969 04420000
         CLI   OCATYP(@15),1                                       0969 04421000
         BNE   @RF00969                                            0969 04422000
*            DARGSENT = OPENSTID;                                  0970 04423000
         MVI   DARGSENT(@08),X'01'                                 0970 04424000
*          ELSE                                                    0971 04425000
*            DARGSENT = CLOSSTID;                                  0971 04426000
*                                                                  0971 04427000
         B     @RC00969                                            0971 04428000
@RF00969 L     @08,DDSTRU                                          0971 04429000
         MVI   DARGSENT(@08),X'02'                                 0971 04430000
*        /************************************************************/ 04431000
*        /*                                                          */ 04432000
*        /* IF ERROR OCCURRED BEFORE DATA SET NAME WAS FOUND         */ 04433000
*        /* PRINT DNAME AS VARIABLE TEXT.  IF DSN PRESENT PRINT      */ 04434000
*        /* IT AS VARIABLE TEXT.                                     */ 04435000
*        /* IF DSNAME IS ALL X'04'S, USE 'VTOC' INSTEAD.             */ 04436000
*        /*                                                          */ 04437000
*        /************************************************************/ 04438000
*                                                                  0972 04439000
*        IF IOCSPTR = NULLPTR                                      0972 04440000
*          THEN                                                    0972 04441000
@RC00969 L     @08,IOCSPTR                                         0972 04442000
         LTR   @08,@08                                             0972 04443000
         BNZ   @RF00972                                            0972 04444000
*            DO;                                                   0973 04445000
*              DARGDBP = ADDR (VARTEXT);                           0974 04446000
         L     @08,DDSTRU                                          0974 04447000
         L     @15,@PC00008                                        0974 04448000
         ST    @15,DARGDBP(,@08)                                   0974 04449000
*              DARGILP = 8;                                        0975 04450000
         MVC   DARGILP(2,@08),@CH00157                             0975 04451000
*            END;                                                  0976 04452000
*          ELSE                                                    0977 04453000
*            DO;                                                   0977 04454000
         B     @RC00972                                            0977 04455000
@RF00972 DS    0H                                                  0978 04456000
*              IF DSNCMP = VTOC                                    0978 04457000
*                THEN                                              0978 04458000
         L     @08,IOCSPTR                                         0978 04459000
         L     @08,IOCDSN(,@08)                                    0978 04460000
         CLC   DSNCMP(44,@08),VTOC                                 0978 04461000
         BNE   @RF00978                                            0978 04462000
*                 DARGDBP = DSNVTOCP;                              0979 04463000
         L     @08,DSNVTOCP                                        0979 04464000
         L     @01,DDSTRU                                          0979 04465000
         ST    @08,DARGDBP(,@01)                                   0979 04466000
*                ELSE                                              0980 04467000
*                 DARGDBP = IOCDSN;                                0980 04468000
         B     @RC00978                                            0980 04469000
@RF00978 L     @08,IOCSPTR                                         0980 04470000
         L     @08,IOCDSN(,@08)                                    0980 04471000
         L     @01,DDSTRU                                          0980 04472000
         ST    @08,DARGDBP(,@01)                                   0980 04473000
*              DARGILP = 44;                                       0981 04474000
@RC00978 L     @08,DDSTRU                                          0981 04475000
         MVC   DARGILP(2,@08),@CH00516                             0981 04476000
*            END;                                                  0982 04477000
*                                                                  0982 04478000
*        CALL PRINTMSG;                                            0983 04479000
*                                                                  0983 04480000
@RC00972 BAL   @14,PRINTMSG                                        0983 04481000
*        /************************************************************/ 04482000
*        /*                                                          */ 04483000
*        /* SET SECONDARY ERROR MESSAGE DATA                         */ 04484000
*        /*                                                          */ 04485000
*        /************************************************************/ 04486000
*                                                                  0984 04487000
*        DDSTRU = ADDR (DMSGARG);                                  0984 04488000
*                                                                  0984 04489000
         LA    @08,DMSGARG                                         0984 04490000
         ST    @08,DDSTRU                                          0984 04491000
*        CALL PRINTMSG;                                            0985 04492000
*                                                                  0985 04493000
         BAL   @14,PRINTMSG                                        0985 04494000
*        /************************************************************/ 04495000
*        /*                                                          */ 04496000
*        /* SET NO ERROR INDICATOR AND SET DEFAULT MODULE ID         */ 04497000
*        /*                                                          */ 04498000
*        /************************************************************/ 04499000
*                                                                  0986 04500000
*        DMSGARG = ''B;                                            0986 04501000
         XC    DMSGARG(44),DMSGARG                                 0986 04502000
*        DARGSMOD = 'IO0';                                         0987 04503000
*                                                                  0987 04504000
         L     @08,DDSTRU                                          0987 04505000
         MVC   DARGSMOD(3,@08),@CC00957                            0987 04506000
*        END BLDOCMSG;                                             0988 04507000
*                                                                  0988 04508000
@EL00008 DS    0H                                                  0988 04509000
@EF00008 DS    0H                                                  0988 04510000
@ER00008 LM    @14,@12,@SA00008                                    0988 04511000
         BR    @14                                                 0988 04512000
*                                                                  0989 04513000
*        /************************************************************/ 04514000
*        /*                                                          */ 04515000
*        /* PROCEDURE NAME - PRINTMSG                                */ 04516000
*        /*                                                          */ 04517000
*        /* FUNCTION - THIS PROCEDURE CALLS THE TEXT PROCESSOR TO    */ 04518000
*        /*            PRINT A MESSAGE.                              */ 04519000
*        /*                                                          */ 04520000
*        /* INPUT -    DDSTRU CONTAINS THE ADDRESS OF THE ARGUMENT   */ 04521000
*        /*            CONTAINING THE MESSAGE DATA.                  */ 04522000
*        /*                                                          */ 04523000
*        /************************************************************/ 04524000
*                                                                  0989 04525000
*PRINTMSG: PROC;                                                   0989 04526000
*                                                                  0989 04527000
PRINTMSG STM   @14,@12,@SA00009                                    0989 04528000
*        /************************************************************/ 04529000
*        /*                                                          */ 04530000
*        /* CALL TEXT PROCESSOR TO HAVE MESSAGE PRINTED              */ 04531000
*        /*                                                          */ 04532000
*        /************************************************************/ 04533000
*                                                                  0990 04534000
*        CALL ICKTPPR0 (GDTTBL,PRTFILE,DDSTRU);                    0990 04535000
*                                                                  0990 04536000
         L     @08,@PC00001                                        0990 04537000
         ST    @08,@AL00001                                        0990 04538000
         LA    @15,@CF00090                                        0990 04539000
         ST    @15,@AL00001+4                                      0990 04540000
         LA    @15,DDSTRU                                          0990 04541000
         ST    @15,@AL00001+8                                      0990 04542000
         MVI   @AL00001+8,X'80'                                    0990 04543000
         L     @15,GDTPRT(,@08)                                    0990 04544000
         LA    @01,@AL00001                                        0990 04545000
         BALR  @14,@15                                             0990 04546000
*        /************************************************************/ 04547000
*        /*                                                          */ 04548000
*        /* REINITIALIZE ERROR MESSAGE TEXT ARGUMENT LIST            */ 04549000
*        /*                                                          */ 04550000
*        /************************************************************/ 04551000
*                                                                  0991 04552000
*        END PRINTMSG;                                             0991 04553000
*                                                                  0991 04554000
@EL00009 DS    0H                                                  0991 04555000
@EF00009 DS    0H                                                  0991 04556000
@ER00009 LM    @14,@12,@SA00009                                    0991 04557000
         BR    @14                                                 0991 04558000
*        END ICKIO02                                               0992 04559000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 04560000
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        * 04561000
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        * 04562000
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        * 04563000
*/*%INCLUDE SYSLIB  (DMSDF03 )                                        * 04564000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                        * 04565000
*/*%INCLUDE SYSLIB  (IHADCB  )                                        * 04566000
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                        * 04567000
*;                                                                 0992 04568000
@EL00001 L     @13,4(,@13)                                         0992 04569000
@EF00001 L     @00,@SIZDATD                                        0992 04570000
         LR    @01,@11                                             0992 04571000
         FREEMAIN R,LV=(0),A=(1)                                        04572000
@ER00001 LM    @14,@12,12(@13)                                     0992 04573000
         BR    @14                                                 0992 04574000
@DATA    DS    0H                                                       04575000
@CH00115 DC    H'6'                                                     04576000
@CH00157 DC    H'8'                                                     04577000
@CH00036 DC    H'12'                                                    04578000
@CH00516 DC    H'44'                                                    04579000
@CH01465 DC    H'629'                                                   04580000
@SM01499 MVC   JFCBVOLS(0,JFCBPTR),MODJSERS(@08)                        04581000
@SM01502 MVC   IHADCB(0,@08),GENAREA(@01)                               04582000
@DATD    DSECT                                                          04583000
         DS    0F                                                       04584000
@SA00001 DS    18F                                                      04585000
@PC00001 DS    2F                                                       04586000
@SA00002 DS    15F                                                      04587000
@SA00004 DS    15F                                                      04588000
@SA00008 DS    15F                                                      04589000
@PC00008 DS    1F                                                       04590000
@SA00006 DS    18F                                                      04591000
@PC00006 DS    1F                                                       04592000
@SA00007 DS    18F                                                      04593000
@PC00007 DS    2F                                                       04594000
@SA00003 DS    15F                                                      04595000
@SA00005 DS    15F                                                      04596000
@SA00009 DS    15F                                                      04597000
@AL00001 DS    5A                                                       04598000
@TF00001 DS    F                                                        04599000
ICKIO02  CSECT                                                          04600000
         DS    0F                                                       04601000
@CF00090 DC    F'0'                                                     04602000
@CF00161 DC    F'1'                                                     04603000
@CF00040 DC    F'4'                                                     04604000
@CH00040 EQU   @CF00040+2                                               04605000
@CF00289 DC    F'28'                                                    04606000
@CF00669 DC    F'40'                                                    04607000
@CF00584 DC    F'52'                                                    04608000
@CF00878 DC    F'72'                                                    04609000
@CF00955 DC    F'88'                                                    04610000
@CF00953 DC    F'96'                                                    04611000
@CF01441 DC    F'196'                                                   04612000
@CF01017 DC    F'32760'                                                 04613000
@CF01444 DC    F'32768'                                                 04614000
@CF01493 DC    F'-8'                                                    04615000
@CF01498 DC    F'-6'                                                    04616000
@CF01494 DC    F'-4'                                                    04617000
@DATD    DSECT                                                          04618000
         DS    0D                                                       04619000
LISTSCAN DS    A                                                        04620000
IOCSPTR  DS    A                                                        04621000
DDSTRU   DS    A                                                        04622000
FSADDR   DS    A                                                        04623000
DMPINDEX DS    A                                                        04624000
POOLSIZE DS    F                                                        04625000
EXTFLGFD DS    FL4                                                      04626000
         ORG   EXTFLGFD                                                 04627000
EXTTYPE  DS    FL1                                                      04628000
EXTOPT   DS    BL1                                                      04629000
         ORG   EXTOPT                                                   04630000
EXTOPTIN DS    BL1                                                      04631000
EXTOPTOT EQU   EXTOPT+0                                                 04632000
EXTOPTDD EQU   EXTOPT+0                                                 04633000
EXTOPTDS EQU   EXTOPT+0                                                 04634000
@NM00027 EQU   EXTOPT+0                                                 04635000
         ORG   EXTFLGFD+2                                               04636000
EXTPUTID DS    FL2                                                      04637000
         ORG   EXTFLGFD+4                                               04638000
DCBPTR   DS    AL4                                                      04639000
         ORG   DCBPTR                                                   04640000
DCB00    DS    CL1                                                      04641000
         ORG   DCBPTR+4                                                 04642000
ABEXPTR  DS    A                                                        04643000
TYPJPTR  DS    A                                                        04644000
GENADDR  DS    A                                                        04645000
XDADDR   DS    A                                                        04646000
RETCBADR DS    A                                                        04647000
NEXTADDR DS    A                                                        04648000
NEXTIOCS DS    A                                                        04649000
DCBEXWRD DS    AL4                                                      04650000
         ORG   DCBEXWRD                                                 04651000
DCBEXEND DS    BL1                                                      04652000
         ORG   DCBEXWRD+4                                               04653000
LISTPTR  DS    A                                                        04654000
TEMPADDR DS    A                                                        04655000
TEMPLEN  DS    F                                                        04656000
TESTRC   DS    H                                                        04657000
OPENRC   DS    H                                                        04658000
CKXTN    DS    H                                                        04659000
TJNUMOP  DS    H                                                        04660000
OPNCTR   DS    H                                                        04661000
OPAMRC   DS    H                                                        04662000
CLOSERC  DS    H                                                        04663000
NUMFREE  DS    H                                                        04664000
DSDRC    DS    H                                                        04665000
DDN      DS    H                                                        04666000
CLIOCTR  DS    H                                                        04667000
CLREASON DS    H                                                        04668000
SETRC    DS    H                                                        04669000
LISTLN   DS    FL1                                                      04670000
         DS    CL1                                                      04671000
DMSGARG  DS    CL44                                                     04672000
IOCSBLT  DS    BL16                                                     04673000
         ORG   IOCSBLT                                                  04674000
IOCSADDR DS    4A                                                       04675000
         ORG   IOCSBLT+16                                               04676000
TJIOCSBL DS    BL16                                                     04677000
         ORG   TJIOCSBL                                                 04678000
TJIOCSAD DS    4A                                                       04679000
         ORG   TJIOCSBL+16                                              04680000
WORKAREA DS    CL400                                                    04681000
DCBTLIST DS    CL8                                                      04682000
OFLAGS   DS    BL1                                                      04683000
         ORG   OFLAGS                                                   04684000
ALROPEN  DS    BL1                                                      04685000
CKSYSIN  EQU   OFLAGS+0                                                 04686000
CKSYSOT  EQU   OFLAGS+0                                                 04687000
         ORG   OFLAGS+1                                                 04688000
         DS    CL3                                                      04689000
OPENLIST DS    BL16                                                     04690000
         ORG   OPENLIST                                                 04691000
OPCBADDR DS    AL4                                                      04692000
         ORG   OPCBADDR+0                                               04693000
OPLEND   DS    BL1                                                      04694000
         ORG   OPENLIST+16                                              04695000
TJOPLIST DS    BL16                                                     04696000
         ORG   TJOPLIST                                                 04697000
TJCBAD   DS    AL4                                                      04698000
         ORG   TJCBAD+0                                                 04699000
TJLEND   DS    BL1                                                      04700000
         ORG   TJOPLIST+16                                              04701000
DTOOPEN  DS    CL8                                                      04702000
CFLAGS   DS    CL1                                                      04703000
         ORG   CFLAGS                                                   04704000
CSKIP    DS    BL1                                                      04705000
         ORG   CFLAGS+1                                                 04706000
         DS    CL3                                                      04707000
CLOSLIST DS    CL16                                                     04708000
         ORG   CLOSLIST                                                 04709000
CLCBADDR DS    AL4                                                      04710000
         ORG   CLCBADDR+0                                               04711000
CLOPT    DS    CL1                                                      04712000
         ORG   CLOPT+0                                                  04713000
CLLEND   DS    BL1                                                      04714000
         ORG   CLOSLIST+16                                              04715000
CLVTEXT  DS    CL8                                                      04716000
IOCSID2  DS    CL4                                                      04717000
DCBRLIST DS    CL4                                                      04718000
         ORG   DCBRLIST                                                 04719000
DCBRLID  DS    CL1                                                      04720000
DCBRLPTR DS    AL3                                                      04721000
         ORG   DCBRLIST+4                                               04722000
DEVAREA  DS    CL8                                                      04723000
         ORG   DEVAREA                                                  04724000
@NM00067 DS    CL2                                                      04725000
DEVWORD  DS    CL1                                                      04726000
         ORG   DEVWORD                                                  04727000
DEVTAPE  DS    BL1                                                      04728000
@NM00068 EQU   DEVWORD+0                                                04729000
DEVTDA   EQU   DEVWORD+0                                                04730000
@NM00069 EQU   DEVWORD+0                                                04731000
DEVTUR   EQU   DEVWORD+0                                                04732000
         ORG   DEVAREA+3                                                04733000
@NM00070 DS    CL5                                                      04734000
         ORG   DEVAREA+8                                                04735000
DMSGHEAD DS    CL28                                                     04736000
ICKIO02  CSECT                                                          04737000
         DS    0F                                                       04738000
@SIZDATD DC    AL1(0)                                                   04739000
         DC    AL3(@ENDDATD-@DATD)                                      04740000
         DS    0D                                                       04741000
SIZEIOCS DC    AL4(4+40+36+44)                                          04742000
DSNVTOCP DC    AL4(DSNVTOC)                                             04743000
LENTODSN DC    AL2(40+36)                                               04744000
TYPJEXON DC    XL1'07'                                                  04745000
@CC00141 DC    C'ZERO'                                                  04746000
@CC01008 DC    C'IOCS'                                                  04747000
@CC01024 DC    C'IO1O'                                                  04748000
@CC01027 DC    C'IO20'                                                  04749000
@CC01030 DC    C'IO3O'                                                  04750000
@CC01034 DC    C'IO21'                                                  04751000
@CC01066 DC    C'IO1C'                                                  04752000
@CC01072 DC    C'IO2C'                                                  04753000
@CC01422 DC    C'IODS'                                                  04754000
@CC00957 DC    C'IO0'                                                   04755000
@CC01006 DC    C'UV0'                                                   04756000
@CC01012 DC    C'DD'                                                    04757000
@CB01413 DC    X'0000000000000000'                                      04758000
         DS    CL1                                                      04759000
INITID   DS    CL4                                                      04760000
         ORG   INITID                                                   04761000
@NM00024 DC    CL2'IO'                                                  04762000
@NM00025 DC    H'0'                                                     04763000
         ORG   INITID+4                                                 04764000
MODID    DC    CL4'IO02'                                                04765000
FIXAREA  DS    CL400                                                    04766000
         ORG   FIXAREA                                                  04767000
@NM00026 DC    400X'00'                                                 04768000
         ORG   FIXAREA+400                                              04769000
OPENTEXT DC    CL5'OPEN'                                                04770000
CLTEXT   DC    CL5'CLOSE'                                               04771000
         DS    CL2                                                      04772000
DCBTLSTA DS    CL8                                                      04773000
         ORG   DCBTLSTA                                                 04774000
@NM00060 DC    X'05'                                                    04775000
@NM00061 DC    AL3(IRTOPEX)                                             04776000
@NM00062 DC    X'91'                                                    04777000
@NM00063 DC    AL3(ABEXRTN)                                             04778000
         ORG   DCBTLSTA+8                                               04779000
INFILE   DC    CL8'SYSIN   '                                            04780000
OUTFILE  DC    CL8'SYSPRINT'                                            04781000
JFINHWB  DC    X'08'                                                    04782000
DSNVTOC  DC    CL44'VTOC'                                               04783000
DEFDD    DC    CL8'SYSLIN '                                             04784000
         DC    CL8'        '                                            04785000
         DC    CL8'SYSLMOD '                                            04786000
         DC    CL8'SYSLIB  '                                            04787000
         DC    CL8'SYSIN   '                                            04788000
         DC    CL8'SYSPRINT'                                            04789000
         DC    CL8'SYSPUNCH'                                            04790000
         DC    CL8'SYSUT1  '                                            04791000
         DC    CL8'SYSUT2  '                                            04792000
         DC    CL8'SYSUT3  '                                            04793000
@DATD    DSECT                                                          04794000
ICKIO02 CSECT                                                           04795000
QSAMDCB DCB   DSORG=PS,MACRF=(GL)                                       04796000
BSAMDCB DCB   DSORG=PS,MACRF=(RP)                                       04797000
DUMAD   DC    AL4(0)                                                    04798000
@DATD    DSECT                                                          04799000
ICKIO02 CSECT                                                           04800000
VTOC    DC    44X'04'                                                   04801000
@DATD    DSECT                                                          04802000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04803000
@ENDDATD EQU   *                                                        04804000
ICKIO02  CSECT                                                          04805000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04806000
@01      EQU   01                                                       04807000
@02      EQU   02                                                       04808000
@03      EQU   03                                                       04809000
@04      EQU   04                                                       04810000
@05      EQU   05                                                       04811000
@06      EQU   06                                                       04812000
@07      EQU   07                                                       04813000
@08      EQU   08                                                       04814000
@09      EQU   09                                                       04815000
@10      EQU   10                                                       04816000
@11      EQU   11                                                       04817000
@12      EQU   12                                                       04818000
@13      EQU   13                                                       04819000
@14      EQU   14                                                       04820000
@15      EQU   15                                                       04821000
BLDDRC   EQU   @03                                                      04822000
JFCBPTR  EQU   @03                                                      04823000
CKDD     EQU   @03                                                      04824000
AMCLRC   EQU   @02                                                      04825000
DELEIOCS EQU   @02                                                      04826000
CLOCTR   EQU   @03                                                      04827000
NUMCLOSE EQU   @02                                                      04828000
NUMOPEN  EQU   @03                                                      04829000
SAVE14   EQU   @03                                                      04830000
EXITCTR  EQU   @02                                                      04831000
OPNPTR   EQU   @02                                                      04832000
RTNREG   EQU   @15                                                      04833000
REG1     EQU   @01                                                      04834000
REG5     EQU   @05                                                      04835000
REG6     EQU   @06                                                      04836000
REG7     EQU   @07                                                      04837000
REG13    EQU   @13                                                      04838000
REG14    EQU   @14                                                      04839000
REG15    EQU   @15                                                      04840000
REG0     EQU   @00                                                      04841000
REG10    EQU   @10                                                      04842000
REG11    EQU   @11                                                      04843000
REG12    EQU   @12                                                      04844000
REG2     EQU   @02                                                      04845000
REG3     EQU   @03                                                      04846000
REG4     EQU   @04                                                      04847000
REG8     EQU   @08                                                      04848000
REG9     EQU   @09                                                      04849000
ICKSAEP0 EQU   0                                                        04850000
ICKSAGP0 EQU   0                                                        04851000
ICKSAFP0 EQU   0                                                        04852000
TRACE1   EQU   0                                                        04853000
OLDERID1 EQU   TRACE1                                                   04854000
TRACE2   EQU   0                                                        04855000
STAEPARM EQU   0                                                        04856000
STAEPFX  EQU   STAEPARM                                                 04857000
IOCSTR   EQU   0                                                        04858000
IOCDLN   EQU   IOCSTR+4                                                 04859000
IOCTRN   EQU   IOCSTR+8                                                 04860000
IOCKYL   EQU   IOCSTR+12                                                04861000
IOCDSO   EQU   IOCSTR+13                                                04862000
IOCDSOPS EQU   IOCDSO                                                   04863000
IOCRFM   EQU   IOCSTR+14                                                04864000
IOCRFMFX EQU   IOCRFM                                                   04865000
IOCRFMVR EQU   IOCRFM                                                   04866000
IOCRFMUN EQU   IOCRFM                                                   04867000
IOCRFMSF EQU   IOCRFM                                                   04868000
IOCRFMBK EQU   IOCRFM                                                   04869000
IOCMAC   EQU   IOCSTR+15                                                04870000
IOCMACIN EQU   IOCMAC                                                   04871000
IOCMACOT EQU   IOCMAC                                                   04872000
IOCMACUP EQU   IOCMAC                                                   04873000
IOCMACBK EQU   IOCMAC                                                   04874000
IOCMSG   EQU   IOCSTR+16                                                04875000
IOCMSGOP EQU   IOCMSG                                                   04876000
IOCDSN   EQU   IOCSTR+20                                                04877000
IOCCBP   EQU   IOCSTR+24                                                04878000
IOCEXT   EQU   IOCSTR+36                                                04879000
OPNAGL   EQU   0                                                        04880000
OPNOPT   EQU   OPNAGL                                                   04881000
OPNOPTOT EQU   OPNOPT                                                   04882000
OPNOPTUP EQU   OPNOPT                                                   04883000
OPNOPTBK EQU   OPNOPT                                                   04884000
OPNOPTJM EQU   OPNOPT                                                   04885000
OPNRFM   EQU   OPNAGL+1                                                 04886000
OPNRFMFX EQU   OPNRFM                                                   04887000
OPNRFMVR EQU   OPNRFM                                                   04888000
OPNRFMUN EQU   OPNRFM                                                   04889000
OPNRFMSF EQU   OPNRFM                                                   04890000
OPNRFMBK EQU   OPNRFM                                                   04891000
OPNTYP   EQU   OPNAGL+2                                                 04892000
OPNTYPSI EQU   OPNTYP                                                   04893000
OPNTYPSO EQU   OPNTYP                                                   04894000
OPNMOD   EQU   OPNAGL+3                                                 04895000
OPNMODAC EQU   OPNMOD                                                   04896000
OPNMODRC EQU   OPNMOD                                                   04897000
OPNIOC   EQU   OPNAGL+4                                                 04898000
OPNDDN   EQU   OPNAGL+8                                                 04899000
OPNDSN   EQU   OPNAGL+12                                                04900000
OPNREC   EQU   OPNAGL+16                                                04901000
OPNBLK   EQU   OPNAGL+20                                                04902000
OPNVOL   EQU   OPNAGL+24                                                04903000
UVOLLIST EQU   0                                                        04904000
UVOLENT  EQU   UVOLLIST+2                                               04905000
ICKTPPR0 EQU   0                                                        04906000
DARGLIST EQU   0                                                        04907000
DARGDBP  EQU   DARGLIST                                                 04908000
DARGSTID EQU   DARGLIST+8                                               04909000
DARGSMOD EQU   DARGSTID                                                 04910000
DARGSENT EQU   DARGSTID+3                                               04911000
DARGILP  EQU   DARGLIST+12                                              04912000
DARGARY  EQU   DARGLIST+20                                              04913000
DARGINS  EQU   DARGARY                                                  04914000
DARGINL  EQU   DARGARY+2                                                04915000
FMTLIST  EQU   0                                                        04916000
FMTFLGS  EQU   FMTLIST                                                  04917000
FMTSPF   EQU   FMTLIST+2                                                04918000
FMTRFNO  EQU   FMTSPF                                                   04919000
FMTILEN  EQU   FMTRFNO                                                  04920000
FMTIOFF  EQU   FMTLIST+4                                                04921000
FMTTRBC  EQU   FMTIOFF                                                  04922000
FMTSTO   EQU   FMTTRBC                                                  04923000
FMTOCOL  EQU   FMTLIST+6                                                04924000
FMTCNVF  EQU   FMTLIST+10                                               04925000
ICKDB010 EQU   0                                                        04926000
DMPITM   EQU   0                                                        04927000
DMPARY   EQU   0                                                        04928000
IODATA   EQU   0                                                        04929000
IODIOC   EQU   IODATA                                                   04930000
IODADD   EQU   IODATA+8                                                 04931000
IODXTN   EQU   IODATA+12                                                04932000
IODSID   EQU   IODATA+16                                                04933000
IODINC   EQU   IODSID+2                                                 04934000
IODEOD   EQU   IODATA+20                                                04935000
IODOSS   EQU   IODATA+24                                                04936000
IODOSO   EQU   IODATA+28                                                04937000
IODICS   EQU   IODATA+32                                                04938000
IODOCS   EQU   IODATA+36                                                04939000
IOCSEX   EQU   0                                                        04940000
IOCCBA   EQU   IOCSEX                                                   04941000
IOCCBL   EQU   IOCSEX+8                                                 04942000
IOCWKA   EQU   IOCSEX+12                                                04943000
IOCXAD   EQU   IOCSEX+16                                                04944000
IOCXPM   EQU   IOCSEX+20                                                04945000
IOCNIO   EQU   IOCSEX+24                                                04946000
IOCSID   EQU   IOCSEX+28                                                04947000
IOCFLG   EQU   IOCSEX+32                                                04948000
IOCFLGEX EQU   IOCFLG                                                   04949000
IOCFLGIO EQU   IOCFLG                                                   04950000
IOCFLGOP EQU   IOCFLG                                                   04951000
IOCFLGSP EQU   IOCFLG                                                   04952000
IOCDEV   EQU   IOCSEX+33                                                04953000
IOCDEVDA EQU   IOCDEV                                                   04954000
IOCDEVUR EQU   IOCDEV                                                   04955000
IOCINF   EQU   IOCSEX+34                                                04956000
IOCINFAE EQU   IOCINF                                                   04957000
IOCINFND EQU   IOCINF                                                   04958000
IOCINFAC EQU   IOCINF                                                   04959000
EXTRTN   EQU   0                                                        04960000
IOEXPARM EQU   0                                                        04961000
IHADCB   EQU   0                                                        04962000
IHADCS00 EQU   0                                                        04963000
DCBFDAD  EQU   IHADCS00+5                                               04964000
IHADCS01 EQU   0                                                        04965000
DCBDVTBL EQU   IHADCS01                                                 04966000
IHADCS02 EQU   0                                                        04967000
IHADCS11 EQU   0                                                        04968000
DCBRELB  EQU   IHADCS11                                                 04969000
DCBKEYLE EQU   DCBRELB                                                  04970000
DCBREL   EQU   DCBRELB+1                                                04971000
DCBBUFCB EQU   IHADCS11+4                                               04972000
DCBDSORG EQU   IHADCS11+10                                              04973000
DCBDSRG1 EQU   DCBDSORG                                                 04974000
DCBDSRG2 EQU   DCBDSORG+1                                               04975000
DCBIOBAD EQU   IHADCS11+12                                              04976000
DCBODEB  EQU   DCBIOBAD                                                 04977000
DCBLNP   EQU   DCBODEB                                                  04978000
DCBQSLM  EQU   DCBLNP                                                   04979000
DCBIOBAA EQU   DCBODEB+1                                                04980000
IHADCS50 EQU   0                                                        04981000
DCBSVCXL EQU   IHADCS50                                                 04982000
DCBEODAD EQU   IHADCS50+4                                               04983000
DCBBFALN EQU   DCBEODAD                                                 04984000
DCBHIARC EQU   DCBBFALN                                                 04985000
DCBBFTEK EQU   DCBHIARC                                                 04986000
DCBBFT   EQU   DCBBFTEK                                                 04987000
DCBEODA  EQU   DCBEODAD+1                                               04988000
DCBEXLST EQU   IHADCS50+8                                               04989000
DCBRECFM EQU   DCBEXLST                                                 04990000
DCBRECLA EQU   DCBRECFM                                                 04991000
DCBRECL  EQU   DCBRECLA                                                 04992000
DCBRECBR EQU   DCBRECFM                                                 04993000
DCBRECSB EQU   DCBRECFM                                                 04994000
DCBRECCC EQU   DCBRECFM                                                 04995000
DCBEXLSA EQU   DCBEXLST+1                                               04996000
IHADCS24 EQU   0                                                        04997000
DCBDDNAM EQU   IHADCS24                                                 04998000
DCBOFLGS EQU   IHADCS24+8                                               04999000
DCBOFLWR EQU   DCBOFLGS                                                 05000000
DCBOFOPN EQU   DCBOFLGS                                                 05001000
DCBIFLG  EQU   IHADCS24+9                                               05002000
DCBIBPCT EQU   DCBIFLG                                                  05003000
DCBMACR  EQU   IHADCS24+10                                              05004000
DCBMACR1 EQU   DCBMACR                                                  05005000
DCBMRFE  EQU   DCBMACR1                                                 05006000
DCBMRGET EQU   DCBMRFE                                                  05007000
DCBMRAPG EQU   DCBMACR1                                                 05008000
DCBMRRD  EQU   DCBMRAPG                                                 05009000
DCBMRCI  EQU   DCBMACR1                                                 05010000
DCBMRMVG EQU   DCBMRCI                                                  05011000
DCBMRLCG EQU   DCBMACR1                                                 05012000
DCBMRABC EQU   DCBMACR1                                                 05013000
DCBMRPT1 EQU   DCBMRABC                                                 05014000
DCBMRSBG EQU   DCBMRPT1                                                 05015000
DCBMRCRL EQU   DCBMACR1                                                 05016000
DCBMRCHK EQU   DCBMRCRL                                                 05017000
DCBMRRDX EQU   DCBMRCHK                                                 05018000
DCBMRDMG EQU   DCBMACR1                                                 05019000
DCBMACR2 EQU   DCBMACR+1                                                05020000
DCBMRPUT EQU   DCBMACR2                                                 05021000
DCBMRWRT EQU   DCBMACR2                                                 05022000
DCBMRMVP EQU   DCBMACR2                                                 05023000
DCBMR5WD EQU   DCBMACR2                                                 05024000
DCBMRLDM EQU   DCBMR5WD                                                 05025000
DCBMRLCP EQU   DCBMRLDM                                                 05026000
DCBMR4WD EQU   DCBMACR2                                                 05027000
DCBMRPT2 EQU   DCBMR4WD                                                 05028000
DCBMRTMD EQU   DCBMRPT2                                                 05029000
DCBMR3WD EQU   DCBMACR2                                                 05030000
DCBMRCTL EQU   DCBMR3WD                                                 05031000
DCBMRSTK EQU   DCBMRCTL                                                 05032000
DCBMR1WD EQU   DCBMACR2                                                 05033000
DCBMRSWA EQU   DCBMR1WD                                                 05034000
DCBMRDMD EQU   DCBMRSWA                                                 05035000
IHADCS25 EQU   0                                                        05036000
DCBMACRF EQU   IHADCS25+2                                               05037000
DCBMACF1 EQU   DCBMACRF                                                 05038000
DCBMFFE  EQU   DCBMACF1                                                 05039000
DCBMFGET EQU   DCBMFFE                                                  05040000
DCBMFAPG EQU   DCBMACF1                                                 05041000
DCBMFRD  EQU   DCBMFAPG                                                 05042000
DCBMFCI  EQU   DCBMACF1                                                 05043000
DCBMFMVG EQU   DCBMFCI                                                  05044000
DCBMFLCG EQU   DCBMACF1                                                 05045000
DCBMFABC EQU   DCBMACF1                                                 05046000
DCBMFPT1 EQU   DCBMFABC                                                 05047000
DCBMFSBG EQU   DCBMFPT1                                                 05048000
DCBMFCRL EQU   DCBMACF1                                                 05049000
DCBMFCHK EQU   DCBMFCRL                                                 05050000
DCBMFDMG EQU   DCBMACF1                                                 05051000
DCBMACF2 EQU   DCBMACRF+1                                               05052000
DCBMFPUT EQU   DCBMACF2                                                 05053000
DCBMFWRT EQU   DCBMACF2                                                 05054000
DCBMFMVP EQU   DCBMACF2                                                 05055000
DCBMF5WD EQU   DCBMACF2                                                 05056000
DCBMFLDM EQU   DCBMF5WD                                                 05057000
DCBMFLCP EQU   DCBMFLDM                                                 05058000
DCBMF4WD EQU   DCBMACF2                                                 05059000
DCBMFPT2 EQU   DCBMF4WD                                                 05060000
DCBMFTMD EQU   DCBMFPT2                                                 05061000
DCBMF3WD EQU   DCBMACF2                                                 05062000
DCBMFCTL EQU   DCBMF3WD                                                 05063000
DCBMFSTK EQU   DCBMFCTL                                                 05064000
DCBMF1WD EQU   DCBMACF2                                                 05065000
DCBMFSWA EQU   DCBMF1WD                                                 05066000
DCBMFDMD EQU   DCBMFSWA                                                 05067000
DCBDEBAD EQU   IHADCS25+4                                               05068000
DCBIFLGS EQU   DCBDEBAD                                                 05069000
DCBIFPCT EQU   DCBIFLGS                                                 05070000
IHADCS26 EQU   0                                                        05071000
DCBWRITE EQU   IHADCS26                                                 05072000
DCBREAD  EQU   DCBWRITE                                                 05073000
DCBWRITA EQU   DCBREAD+1                                                05074000
IHADCS27 EQU   0                                                        05075000
DCBGET   EQU   IHADCS27                                                 05076000
DCBPUT   EQU   DCBGET                                                   05077000
DCBGETA  EQU   DCBPUT+1                                                 05078000
IHADCS36 EQU   0                                                        05079000
DCBGERR  EQU   IHADCS36                                                 05080000
DCBPERR  EQU   DCBGERR                                                  05081000
DCBCHECK EQU   DCBPERR                                                  05082000
DCBOPTCD EQU   DCBCHECK                                                 05083000
DCBOPTH  EQU   DCBOPTCD                                                 05084000
DCBOPTO  EQU   DCBOPTH                                                  05085000
DCBOPTZ  EQU   DCBOPTCD                                                 05086000
DCBGERRA EQU   DCBCHECK+1                                               05087000
DCBPERRA EQU   DCBGERRA                                                 05088000
DCBSYNAD EQU   IHADCS36+4                                               05089000
DCBCIND1 EQU   IHADCS36+8                                               05090000
DCBCIND2 EQU   IHADCS36+9                                               05091000
DCBBLKSI EQU   IHADCS36+10                                              05092000
DCBIOBA  EQU   IHADCS36+16                                              05093000
DCBCICB  EQU   DCBIOBA                                                  05094000
IHADCS52 EQU   0                                                        05095000
DCBDIRCT EQU   IHADCS52                                                 05096000
DCBQSWS  EQU   DCBDIRCT                                                 05097000
DCBUSASI EQU   DCBQSWS                                                  05098000
DCBQADFS EQU   DCBUSASI                                                 05099000
DCBBUFOF EQU   DCBDIRCT+1                                               05100000
IHADCS37 EQU   0                                                        05101000
DCBFLAG1 EQU   IHADCS37                                                 05102000
IHADCS38 EQU   0                                                        05103000
DCBEOBR  EQU   IHADCS38                                                 05104000
DCBLRECL EQU   IHADCS38+10                                              05105000
DCBPOINT EQU   IHADCS38+12                                              05106000
DCBCNTRL EQU   DCBPOINT                                                 05107000
IHADCS40 EQU   0                                                        05108000
DCBEOBAD EQU   IHADCS40                                                 05109000
DCBCCCW  EQU   IHADCS40+4                                               05110000
DCBRECAD EQU   DCBCCCW                                                  05111000
DCBRECBT EQU   DCBRECAD                                                 05112000
DCBRCREL EQU   DCBRECBT                                                 05113000
@NM00056 EQU   IHADCS40+12                                              05114000
DCBEROPT EQU   @NM00056                                                 05115000
DCBERACC EQU   DCBEROPT                                                 05116000
DCBERSKP EQU   DCBEROPT                                                 05117000
DCBERABE EQU   DCBEROPT                                                 05118000
ABEXLIST EQU   0                                                        05119000
ABOPT    EQU   ABEXLIST+3                                               05120000
ABDCBAD  EQU   ABEXLIST+4                                               05121000
GENAREA  EQU   0                                                        05122000
XTNLIST  EQU   0                                                        05123000
XTNNUM   EQU   XTNLIST                                                  05124000
XTNENT   EQU   XTNLIST+4                                                05125000
XDPTR    EQU   XTNENT                                                   05126000
XTNADR   EQU   XTNENT+4                                                 05127000
XTNPRM   EQU   XTNENT+8                                                 05128000
XTFIELD  EQU   0                                                        05129000
XTFTYPE  EQU   XTFIELD                                                  05130000
XTNAME   EQU   XTFIELD+2                                                05131000
BLANKDSN EQU   0                                                        05132000
IOCSPRE  EQU   0                                                        05133000
RETIOCS  EQU   0                                                        05134000
OPDNAME  EQU   0                                                        05135000
DSNAME   EQU   0                                                        05136000
ALTDLIST EQU   0                                                        05137000
DDLLEN   EQU   ALTDLIST                                                 05138000
ALTDD    EQU   ALTDLIST+2                                               05139000
READDCB  EQU   0                                                        05140000
MODJNM   EQU   0                                                        05141000
MODJVL   EQU   0                                                        05142000
MODJCNT  EQU   MODJVL                                                   05143000
MODJSERS EQU   MODJVL+1                                                 05144000
INFMJFCB EQU   0                                                        05145000
JFCBDSNM EQU   INFMJFCB                                                 05146000
JFCBELNM EQU   INFMJFCB+44                                              05147000
JFCBTSDM EQU   INFMJFCB+52                                              05148000
JFCSDS   EQU   JFCBTSDM                                                 05149000
JFCFCBID EQU   INFMJFCB+56                                              05150000
JFCBFRID EQU   JFCFCBID                                                 05151000
JFCBLTYP EQU   INFMJFCB+66                                              05152000
JFCBOTTR EQU   INFMJFCB+67                                              05153000
JFCBUFOF EQU   JFCBOTTR                                                 05154000
JFCBFLSQ EQU   JFCBOTTR+1                                               05155000
JFCFUNC  EQU   JFCBFLSQ                                                 05156000
JFCBMASK EQU   INFMJFCB+72                                              05157000
JFCBFLG1 EQU   JFCBMASK+5                                               05158000
JFCOPEN  EQU   JFCBFLG1                                                 05159000
JFCBFLG2 EQU   JFCBMASK+6                                               05160000
JFCDEFER EQU   JFCBFLG2                                                 05161000
JFCBIND1 EQU   INFMJFCB+86                                              05162000
JFCBIND2 EQU   INFMJFCB+87                                              05163000
JFCAMPTR EQU   INFMJFCB+88                                              05164000
JFCBUFRQ EQU   JFCAMPTR                                                 05165000
JFCBUFNO EQU   JFCBUFRQ                                                 05166000
JFCBGNCP EQU   JFCAMPTR+1                                               05167000
JFCBHIAR EQU   JFCBGNCP                                                 05168000
JFCBFALN EQU   JFCBHIAR                                                 05169000
JFCBFTEK EQU   JFCBFALN                                                 05170000
JFCBBFTA EQU   JFCBFTEK                                                 05171000
JFCEROPT EQU   INFMJFCB+92                                              05172000
JFCTRTCH EQU   INFMJFCB+93                                              05173000
TYPJWA   EQU   0                                                        05174000
TYPJEXLN EQU   TYPJWA                                                   05175000
TYPJEX   EQU   TYPJEXLN                                                 05176000
TYPJEPT  EQU   TYPJEXLN+1                                               05177000
TYPJEXLO EQU   TYPJWA+4                                                 05178000
TYPJFCB  EQU   TYPJWA+12                                                05179000
DSNCMP   EQU   0                                                        05180000
DMPTRM   EQU   0                                                        05181000
ICKDVCL0 EQU   0                                                        05182000
ICKDVIN0 EQU   0                                                        05183000
ICKDVON0 EQU   0                                                        05184000
ICKDVOP0 EQU   0                                                        05185000
ICKIOCL0 EQU   0                                                        05186000
ICKIOGT0 EQU   0                                                        05187000
ICKIOIT0 EQU   0                                                        05188000
ICKIOOP0 EQU   0                                                        05189000
ICKIOPT0 EQU   0                                                        05190000
ICKIOTM0 EQU   0                                                        05191000
ICKSACL0 EQU   0                                                        05192000
ICKSADE0 EQU   0                                                        05193000
ICKSAFS0 EQU   0                                                        05194000
ICKSAGS0 EQU   0                                                        05195000
ICKSALD0 EQU   0                                                        05196000
ICKSAPR0 EQU   0                                                        05197000
ICKSASC0 EQU   0                                                        05198000
ICKSASN0 EQU   0                                                        05199000
ICKSAST0 EQU   0                                                        05200000
ICKSATI0 EQU   0                                                        05201000
ICKSAVC0 EQU   0                                                        05202000
ICKSAWO0 EQU   0                                                        05203000
ICKTPEA0 EQU   0                                                        05204000
ICKTPES0 EQU   0                                                        05205000
ICKTPRE0 EQU   0                                                        05206000
ICKTPRS0 EQU   0                                                        05207000
LISTTEST EQU   0                                                        05208000
NEWERID1 EQU   5                                                        05209000
NEWERID2 EQU   5                                                        05210000
GDTTBL   EQU   0                                                        05211000
GDTTR1   EQU   GDTTBL+8                                                 05212000
GDTTR2   EQU   GDTTBL+12                                                05213000
GDTIOH   EQU   GDTTBL+36                                                05214000
GDTDIN   EQU   GDTTBL+44                                                05215000
GDTDOP   EQU   GDTTBL+48                                                05216000
GDTDBG   EQU   GDTTBL+52                                                05217000
GDTDVO   EQU   GDTTBL+56                                                05218000
GDTPRT   EQU   GDTTBL+60                                                05219000
GDTESS   EQU   GDTTBL+64                                                05220000
GDTESA   EQU   GDTTBL+68                                                05221000
GDTRST   EQU   GDTTBL+72                                                05222000
GDTRES   EQU   GDTTBL+76                                                05223000
GDTCAL   EQU   GDTTBL+80                                                05224000
GDTGSP   EQU   GDTTBL+84                                                05225000
GDTFSP   EQU   GDTTBL+88                                                05226000
GDTGPL   EQU   GDTTBL+92                                                05227000
GDTFPL   EQU   GDTTBL+96                                                05228000
GDTLOD   EQU   GDTTBL+100                                               05229000
GDTDEL   EQU   GDTTBL+104                                               05230000
GDTPRL   EQU   GDTTBL+108                                               05231000
GDTEPL   EQU   GDTTBL+112                                               05232000
GDTTIM   EQU   GDTTBL+116                                               05233000
GDTIIO   EQU   GDTTBL+120                                               05234000
GDTTIO   EQU   GDTTBL+124                                               05235000
GDTOPN   EQU   GDTTBL+136                                               05236000
GDTCLS   EQU   GDTTBL+140                                               05237000
GDTGET   EQU   GDTTBL+144                                               05238000
GDTPUT   EQU   GDTTBL+148                                               05239000
GDTABT   EQU   GDTTBL+152                                               05240000
GDTABH   EQU   GDTTBL+156                                               05241000
GDTSNP   EQU   GDTTBL+160                                               05242000
GDTWTO   EQU   GDTTBL+168                                               05243000
GDTSCR   EQU   GDTTBL+172                                               05244000
GDTVCK   EQU   GDTTBL+176                                               05245000
GDTDVC   EQU   GDTTBL+180                                               05246000
GDTSTE   EQU   GDTTBL+188                                               05247000
OCARRAY  EQU   0                                                        05248000
OCATYP   EQU   OCARRAY                                                  05249000
OCAOPT   EQU   OCARRAY+1                                                05250000
OCAOPTCA EQU   OCAOPT                                                   05251000
OCANUM   EQU   OCARRAY+2                                                05252000
OCADDR   EQU   OCARRAY+4                                                05253000
JFCDNAME EQU   0                                                        05254000
RETDCBAD EQU   0                                                        05255000
OPOPTION EQU   RETDCBAD                                                 05256000
DDDNAME  EQU   0                                                        05257000
VARTEXT  EQU   0                                                        05258000
LRECLX   EQU   DCBLRECL                                                 05259000
DCBSYN   EQU   DCBSYNAD+1                                               05260000
IODOSOS  EQU   IODOSO+1                                                 05261000
IODOSSS  EQU   IODOSS+1                                                 05262000
IOCCBUF  EQU   DCBBUFCB                                                 05263000
IOCCBUFF EQU   IOCCBUF                                                  05264000
JFCKEYLE EQU   JFCTRTCH                                                 05265000
JFCCODE  EQU   JFCKEYLE                                                 05266000
JFCSTACK EQU   JFCTRTCH                                                 05267000
JFCMODE  EQU   JFCSTACK                                                 05268000
JFCSPPRT EQU   JFCTRTCH                                                 05269000
JFCBABFS EQU   JFCSPPRT+2                                               05270000
JFCLIMCT EQU   JFCBABFS                                                 05271000
JFCDSORG EQU   JFCSPPRT+5                                               05272000
JFCDSRG1 EQU   JFCDSORG                                                 05273000
JFCDSRG2 EQU   JFCDSORG+1                                               05274000
JFCRECFM EQU   JFCSPPRT+7                                               05275000
JFCRCFM  EQU   JFCRECFM                                                 05276000
JFCOPTCD EQU   JFCSPPRT+8                                               05277000
JFCWVCSP EQU   JFCOPTCD                                                 05278000
JFCWVCIS EQU   JFCWVCSP                                                 05279000
JFCWVCBD EQU   JFCWVCIS                                                 05280000
JFCALLOW EQU   JFCOPTCD                                                 05281000
JFCRSV17 EQU   JFCALLOW                                                 05282000
JFCOVER  EQU   JFCRSV17                                                 05283000
JFCPCIBT EQU   JFCOPTCD                                                 05284000
JFCMAST  EQU   JFCPCIBT                                                 05285000
JFCEXT   EQU   JFCMAST                                                  05286000
JFCBCKPT EQU   JFCOPTCD                                                 05287000
JFCIND   EQU   JFCBCKPT                                                 05288000
JFCRSV18 EQU   JFCOPTCD                                                 05289000
JFCCYL   EQU   JFCRSV18                                                 05290000
JFCACT   EQU   JFCCYL                                                   05291000
JFCREDUC EQU   JFCOPTCD                                                 05292000
JFCRSV19 EQU   JFCREDUC                                                 05293000
JFCRSV20 EQU   JFCRSV19                                                 05294000
JFCRSV21 EQU   JFCOPTCD                                                 05295000
JFCDEL   EQU   JFCRSV21                                                 05296000
JFCOPTJ  EQU   JFCOPTCD                                                 05297000
JFCREORG EQU   JFCOPTJ                                                  05298000
JFCBLKSI EQU   JFCSPPRT+9                                               05299000
JFCBUFSI EQU   JFCBLKSI                                                 05300000
JFCAMSYN EQU   JFCSPPRT+11                                              05301000
JFCNCP   EQU   JFCAMSYN+2                                               05302000
JFCNTM   EQU   JFCAMSYN+3                                               05303000
JFCBFSEQ EQU   JFCNTM                                                   05304000
JFCPCI   EQU   JFCBFSEQ                                                 05305000
JFCRESRV EQU   JFCAMSYN+4                                               05306000
JFCUCSEG EQU   JFCRESRV                                                 05307000
JFCUCSOP EQU   JFCUCSEG+4                                               05308000
JFCOUTLI EQU   JFCUCSEG+5                                               05309000
JFCTHRSH EQU   JFCOUTLI                                                 05310000
JFCCPRI  EQU   JFCTHRSH                                                 05311000
JFCBNVOL EQU   JFCUCSEG+9                                               05312000
JFCBVOLS EQU   JFCUCSEG+10                                              05313000
JFCBS001 EQU   JFCBVOLS                                                 05314000
JFCBPQTY EQU   JFCBS001+34                                              05315000
JFCBCTRI EQU   JFCBS001+37                                              05316000
JFCBSQTY EQU   JFCBS001+38                                              05317000
JFCFLGS1 EQU   JFCBS001+41                                              05318000
JFCBSPNM EQU   JFCBS001+45                                              05319000
JFCBFLG3 EQU   JFCBSPNM                                                 05320000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05321000
JFCBEND  EQU   JFCBS001+58                                              05322000
JFCBSPTN EQU   JFCBS001+57                                              05323000
JFCBVLCT EQU   JFCBS001+56                                              05324000
JFCBDRLH EQU   JFCBS001+53                                              05325000
JFCBSBNM EQU   JFCBS001+50                                              05326000
JFCBABST EQU   JFCBS001+48                                              05327000
JFCBRV08 EQU   JFCBSPNM+1                                               05328000
JFCBRV07 EQU   JFCBFLG3                                                 05329000
JFCBRV06 EQU   JFCBFLG3                                                 05330000
JFCBRV05 EQU   JFCBFLG3                                                 05331000
JFCBRV04 EQU   JFCBFLG3                                                 05332000
JFCBRV03 EQU   JFCBFLG3                                                 05333000
JFCBRV02 EQU   JFCBFLG3                                                 05334000
JFCBRV01 EQU   JFCBFLG3                                                 05335000
JFCDQDSP EQU   JFCBFLG3                                                 05336000
JFCBDQTY EQU   JFCBS001+42                                              05337000
JFCBUAFF EQU   JFCFLGS1                                                 05338000
JFCRSV45 EQU   JFCFLGS1                                                 05339000
JFCVRDS  EQU   JFCFLGS1                                                 05340000
JFCBCEOV EQU   JFCFLGS1                                                 05341000
JFCRSV42 EQU   JFCFLGS1                                                 05342000
JFCBADSP EQU   JFCFLGS1                                                 05343000
JFCTOPEN EQU   JFCFLGS1                                                 05344000
JFCBDLET EQU   JFCFLGS1                                                 05345000
JFCRQID  EQU   JFCBSQTY                                                 05346000
JFCROUND EQU   JFCBCTRI                                                 05347000
JFCALX   EQU   JFCBCTRI                                                 05348000
JFCMIXG  EQU   JFCBCTRI                                                 05349000
JFCONTIG EQU   JFCBCTRI                                                 05350000
JFCRSV29 EQU   JFCBCTRI                                                 05351000
JFCBMSGP EQU   JFCBCTRI                                                 05352000
JFCBSPAC EQU   JFCBCTRI                                                 05353000
JFCRUNIT EQU   JFCBPQTY                                                 05354000
JFCBEXAD EQU   JFCBS001+31                                              05355000
JFCBEXTL EQU   JFCBS001+30                                              05356000
JFCMSVGP EQU   JFCBS001+22                                              05357000
@NM00074 EQU   JFCBS001                                                 05358000
JFCAVOLS EQU   JFCBVOLS                                                 05359000
JFCBNTCS EQU   JFCUCSEG+8                                               05360000
JFCSOWA  EQU   JFCOUTLI+1                                               05361000
JFCSEND  EQU   JFCCPRI                                                  05362000
JFCEQUAL EQU   JFCCPRI                                                  05363000
JFCRECV  EQU   JFCCPRI                                                  05364000
JFCRSV34 EQU   JFCCPRI                                                  05365000
JFCRSV33 EQU   JFCCPRI                                                  05366000
JFCRSV55 EQU   JFCCPRI                                                  05367000
JFCRSV54 EQU   JFCCPRI                                                  05368000
JFCRSV53 EQU   JFCCPRI                                                  05369000
JFCRSV27 EQU   JFCUCSOP                                                 05370000
JFCRSV26 EQU   JFCUCSOP                                                 05371000
JFCFCBVR EQU   JFCUCSOP                                                 05372000
JFCFCBAL EQU   JFCUCSOP                                                 05373000
JFCVER   EQU   JFCUCSOP                                                 05374000
JFCRSV25 EQU   JFCUCSOP                                                 05375000
JFCFOLD  EQU   JFCUCSOP                                                 05376000
JFCBEXTP EQU   JFCUCSOP                                                 05377000
JFCUCSID EQU   JFCUCSEG                                                 05378000
JFCINTVL EQU   JFCSPPRT+19                                              05379000
JFCDBUFN EQU   JFCRESRV+3                                               05380000
JFCCYLOF EQU   JFCRESRV+2                                               05381000
JFCRKP   EQU   JFCRESRV                                                 05382000
JFCPCIR2 EQU   JFCPCI                                                   05383000
JFCPCIR1 EQU   JFCPCI                                                   05384000
JFCPCIN2 EQU   JFCPCI                                                   05385000
JFCPCIN1 EQU   JFCPCI                                                   05386000
JFCPCIA2 EQU   JFCPCI                                                   05387000
JFCPCIA1 EQU   JFCPCI                                                   05388000
JFCPCIX2 EQU   JFCPCI                                                   05389000
JFCPCIX1 EQU   JFCPCI                                                   05390000
JFCBUFMX EQU   JFCNCP                                                   05391000
JFCLRECL EQU   JFCAMSYN                                                 05392000
JFCBAXBF EQU   JFCBUFSI                                                 05393000
JFCREL   EQU   JFCREORG                                                 05394000
JFCRSV22 EQU   JFCDEL                                                   05395000
JFCSRCHD EQU   JFCRSV20                                                 05396000
JFCOPTQ  EQU   JFCACT                                                   05397000
JFCFEED  EQU   JFCIND                                                   05398000
JFCCBWU  EQU   JFCEXT                                                   05399000
JFCWUMSG EQU   JFCOVER                                                  05400000
JFCSDNAM EQU   JFCWVCBD                                                 05401000
@NM00073 EQU   JFCRECFM                                                 05402000
JFCCHAR  EQU   JFCRECFM                                                 05403000
JFCRFS   EQU   JFCRECFM                                                 05404000
JFCRFB   EQU   JFCRECFM                                                 05405000
JFCRFO   EQU   JFCRCFM                                                  05406000
JFCFMREC EQU   JFCRCFM                                                  05407000
JFCRSV16 EQU   JFCDSRG2                                                 05408000
JFCRSV15 EQU   JFCDSRG2                                                 05409000
JFCORGTR EQU   JFCDSRG2                                                 05410000
JFCORGAM EQU   JFCDSRG2                                                 05411000
JFCRSV13 EQU   JFCDSRG2                                                 05412000
JFCORGTQ EQU   JFCDSRG2                                                 05413000
JFCORGTX EQU   JFCDSRG2                                                 05414000
JFCORGGS EQU   JFCDSRG2                                                 05415000
JFCORGU  EQU   JFCDSRG1                                                 05416000
JFCORGPO EQU   JFCDSRG1                                                 05417000
JFCORGMQ EQU   JFCDSRG1                                                 05418000
JFCORGCQ EQU   JFCDSRG1                                                 05419000
JFCORGCX EQU   JFCDSRG1                                                 05420000
JFCORGDA EQU   JFCDSRG1                                                 05421000
JFCORGPS EQU   JFCDSRG1                                                 05422000
JFCORGIS EQU   JFCDSRG1                                                 05423000
JFCTRKBL EQU   JFCLIMCT+1                                               05424000
@NM00072 EQU   JFCLIMCT                                                 05425000
JFCDEN   EQU   JFCSPPRT+1                                               05426000
JFCPRTSP EQU   JFCSPPRT                                                 05427000
JFCONE   EQU   JFCMODE                                                  05428000
JFCTWO   EQU   JFCMODE                                                  05429000
JFCRSV07 EQU   JFCMODE                                                  05430000
JFCRSV06 EQU   JFCMODE                                                  05431000
JFCMODER EQU   JFCMODE                                                  05432000
JFCMODEO EQU   JFCMODE                                                  05433000
JFCEBCD  EQU   JFCMODE                                                  05434000
JFCBIN   EQU   JFCMODE                                                  05435000
JFCRSV32 EQU   JFCCODE                                                  05436000
JFCTTY   EQU   JFCCODE                                                  05437000
JFCASCII EQU   JFCCODE                                                  05438000
JFCNCR   EQU   JFCCODE                                                  05439000
JFCBUR   EQU   JFCCODE                                                  05440000
JFCFRI   EQU   JFCCODE                                                  05441000
JFCBCD   EQU   JFCCODE                                                  05442000
JFCNOCON EQU   JFCCODE                                                  05443000
@NM00064 EQU   IOCCBUF                                                  05444000
@NM00023 EQU   OCARRAY+3                                                05445000
@NM00022 EQU   OCAOPT                                                   05446000
GDTCVR   EQU   GDTTBL+184                                               05447000
GDTSPR   EQU   GDTTBL+164                                               05448000
GDTTOH   EQU   GDTTBL+132                                               05449000
GDTRIP   EQU   GDTTBL+128                                               05450000
GDTDVH   EQU   GDTTBL+40                                                05451000
GDTSAH   EQU   GDTTBL+32                                                05452000
GDTTPH   EQU   GDTTBL+28                                                05453000
GDTRIH   EQU   GDTTBL+24                                                05454000
GDTSTH   EQU   GDTTBL+20                                                05455000
GDTDBH   EQU   GDTTBL+16                                                05456000
GDTPRM   EQU   GDTTBL+4                                                 05457000
GDTHDR   EQU   GDTTBL                                                   05458000
JFCRSV05 EQU   JFCEROPT                                                 05459000
JFCRSV04 EQU   JFCEROPT                                                 05460000
JFCRSV03 EQU   JFCEROPT                                                 05461000
JFCRSV02 EQU   JFCEROPT                                                 05462000
JFCTOPT  EQU   JFCEROPT                                                 05463000
JFCABN   EQU   JFCEROPT                                                 05464000
JFCSKP   EQU   JFCEROPT                                                 05465000
JFCACC   EQU   JFCEROPT                                                 05466000
JFCBUFL  EQU   JFCAMPTR+2                                               05467000
JFCFWORD EQU   JFCBFTEK                                                 05468000
JFCDWORD EQU   JFCBFTEK                                                 05469000
JFCHIER1 EQU   JFCBFTEK                                                 05470000
JFCDYN   EQU   JFCBFTEK                                                 05471000
JFCEXC   EQU   JFCBFTEK                                                 05472000
JFCBBFTR EQU   JFCBBFTA                                                 05473000
JFCSIM   EQU   JFCBBFTA                                                 05474000
JFCHIER  EQU   JFCBFTEK                                                 05475000
JFCBFOUT EQU   JFCBUFNO                                                 05476000
JFCBUFIN EQU   JFCBUFNO                                                 05477000
JFCTEMP  EQU   JFCBIND2                                                 05478000
JFCREQ   EQU   JFCBIND2                                                 05479000
JFCENT   EQU   JFCBIND2                                                 05480000
JFCSHARE EQU   JFCBIND2                                                 05481000
JFCSECUR EQU   JFCBIND2                                                 05482000
JFCDISP  EQU   JFCBIND2                                                 05483000
JFCPDS   EQU   JFCBIND1                                                 05484000
JFCGDG   EQU   JFCBIND1                                                 05485000
JFCADDED EQU   JFCBIND1                                                 05486000
JFCLOC   EQU   JFCBIND1                                                 05487000
JFCRLSE  EQU   JFCBIND1                                                 05488000
JFCBXPDT EQU   INFMJFCB+83                                              05489000
JFCBCRDT EQU   INFMJFCB+80                                              05490000
JFCBOPS2 EQU   JFCBMASK+7                                               05491000
JFCRCTLG EQU   JFCBFLG2                                                 05492000
JFCBBUFF EQU   JFCBFLG2                                                 05493000
JFCTRACE EQU   JFCBFLG2                                                 05494000
JFCSDRPS EQU   JFCBFLG2                                                 05495000
JFCMODNW EQU   JFCBFLG2                                                 05496000
JFCNRPS  EQU   JFCDEFER                                                 05497000
JFCOUTOP EQU   JFCBFLG2                                                 05498000
JFCINOP  EQU   JFCBFLG2                                                 05499000
JFCBPWBP EQU   JFCOPEN                                                  05500000
@NM00071 EQU   JFCOPEN                                                  05501000
JFCDUAL  EQU   JFCBFLG1                                                 05502000
JFCSLDES EQU   JFCBFLG1                                                 05503000
JFCSLCRE EQU   JFCBFLG1                                                 05504000
JFCSTAND EQU   JFCBFLG1                                                 05505000
JFCBOPS1 EQU   JFCBMASK                                                 05506000
JFCBVLSQ EQU   INFMJFCB+70                                              05507000
JFCRSV31 EQU   JFCFUNC                                                  05508000
JFCFNCBT EQU   JFCFUNC                                                  05509000
JFCFNCBX EQU   JFCFUNC                                                  05510000
JFCFNCBD EQU   JFCFUNC                                                  05511000
JFCFNCBW EQU   JFCFUNC                                                  05512000
JFCFNCBP EQU   JFCFUNC                                                  05513000
JFCFNCBR EQU   JFCFUNC                                                  05514000
JFCFNCBI EQU   JFCFUNC                                                  05515000
JFCBFOFL EQU   JFCBUFOF                                                 05516000
JFCNL    EQU   JFCBLTYP                                                 05517000
JFCSL    EQU   JFCBLTYP                                                 05518000
JFCNSL   EQU   JFCBLTYP                                                 05519000
JFCSUL   EQU   JFCBLTYP                                                 05520000
JFCBLP   EQU   JFCBLTYP                                                 05521000
JFCBLTM  EQU   JFCBLTYP                                                 05522000
JFCBAL   EQU   JFCBLTYP                                                 05523000
JFCRSV38 EQU   JFCBLTYP                                                 05524000
JFCVINDX EQU   INFMJFCB+64                                              05525000
JFCNLREC EQU   INFMJFCB+62                                              05526000
JFCBADBF EQU   INFMJFCB+60                                              05527000
JFCAMSTR EQU   JFCBFRID+2                                               05528000
JFCAMCRO EQU   JFCBFRID                                                 05529000
JFCBDSCB EQU   INFMJFCB+53                                              05530000
JFCPAT   EQU   JFCBTSDM                                                 05531000
JFCNDCB  EQU   JFCBTSDM                                                 05532000
JFCNDSCB EQU   JFCBTSDM                                                 05533000
JFCNWRIT EQU   JFCBTSDM                                                 05534000
JFCTTR   EQU   JFCBTSDM                                                 05535000
JFCVSL   EQU   JFCBTSDM                                                 05536000
JFCCAT   EQU   JFCBTSDM                                                 05537000
JFCIPLTX EQU   JFCBELNM                                                 05538000
JFCBQNAM EQU   JFCBDSNM                                                 05539000
ABRECAD  EQU   ABEXLIST+13                                              05540000
@NM00066 EQU   ABEXLIST+12                                              05541000
ABWKAREA EQU   ABEXLIST+8                                               05542000
ABOPTDLY EQU   ABOPT                                                    05543000
ABOPTIGN EQU   ABOPT                                                    05544000
ABOPTREC EQU   ABOPT                                                    05545000
@NM00065 EQU   ABOPT                                                    05546000
ABRTCD   EQU   ABEXLIST+2                                               05547000
ABSYSCD  EQU   ABEXLIST                                                 05548000
DCBEOB   EQU   IHADCS40+20                                              05549000
DCBPRECL EQU   IHADCS40+18                                              05550000
@NM00059 EQU   IHADCS40+16                                              05551000
@NM00058 EQU   @NM00056+1                                               05552000
@NM00057 EQU   DCBEROPT                                                 05553000
@NM00055 EQU   IHADCS40+10                                              05554000
@NM00054 EQU   IHADCS40+9                                               05555000
@NM00053 EQU   IHADCS40+8                                               05556000
DCBRECA  EQU   DCBRECAD+1                                               05557000
@NM00052 EQU   DCBRECBT                                                 05558000
DCBRCFGT EQU   DCBRCREL                                                 05559000
DCBRCTRU EQU   DCBRCREL                                                 05560000
DCBLCCW  EQU   DCBEOBAD                                                 05561000
DCBNOTE  EQU   DCBCNTRL                                                 05562000
@NM00051 EQU   IHADCS38+8                                               05563000
DCBEOBW  EQU   IHADCS38+4                                               05564000
DCBEOBRA EQU   DCBEOBR+1                                                05565000
DCBNCP   EQU   DCBEOBR                                                  05566000
@NM00050 EQU   DCBFLAG1                                                 05567000
DCBSTFLS EQU   DCBFLAG1                                                 05568000
DCBSTQCK EQU   DCBFLAG1                                                 05569000
DCBDIRCQ EQU   DCBBUFOF                                                 05570000
DCBQSTRU EQU   DCBUSASI                                                 05571000
@NM00049 EQU   DCBUSASI                                                 05572000
DCBQADF3 EQU   DCBQADFS                                                 05573000
DCBQADF2 EQU   DCBQADFS                                                 05574000
DCBQADF1 EQU   DCBQADFS                                                 05575000
DCBBLBP  EQU   DCBUSASI                                                 05576000
@NM00048 EQU   DCBUSASI                                                 05577000
DCBCICBA EQU   DCBCICB+1                                                05578000
@NM00047 EQU   DCBCICB                                                  05579000
DCBOFFSW EQU   IHADCS36+15                                              05580000
DCBOFFSR EQU   IHADCS36+14                                              05581000
DCBWCPL  EQU   IHADCS36+13                                              05582000
DCBWCPO  EQU   IHADCS36+12                                              05583000
DCBCNQSM EQU   DCBCIND2                                                 05584000
DCBCNFEO EQU   DCBCIND2                                                 05585000
DCBCNCHS EQU   DCBCIND2                                                 05586000
DCBCNBFP EQU   DCBCIND2                                                 05587000
DCBCNIOE EQU   DCBCIND2                                                 05588000
DCBCNCLO EQU   DCBCIND2                                                 05589000
DCBCNWRO EQU   DCBCIND2                                                 05590000
DCBCNSTO EQU   DCBCIND2                                                 05591000
DCBCNEXB EQU   DCBCIND1                                                 05592000
@NM00046 EQU   DCBCIND1                                                 05593000
DCBCNBRM EQU   DCBCIND1                                                 05594000
@NM00045 EQU   DCBCIND1                                                 05595000
DCBCNEVA EQU   DCBCIND1                                                 05596000
DCBCNEVB EQU   DCBCIND1                                                 05597000
DCBCNSRD EQU   DCBCIND1                                                 05598000
DCBCNTOV EQU   DCBCIND1                                                 05599000
DCBSYNA  EQU   DCBSYNAD+1                                               05600000
DCBIOBL  EQU   DCBSYNAD                                                 05601000
DCBCHCKA EQU   DCBPERRA                                                 05602000
DCBOPTJ  EQU   DCBOPTCD                                                 05603000
DCBOPTT  EQU   DCBOPTCD                                                 05604000
DCBSRCHD EQU   DCBOPTZ                                                  05605000
DCBOPTQ  EQU   DCBOPTCD                                                 05606000
DCBBCKPT EQU   DCBOPTO                                                  05607000
DCBOPTC  EQU   DCBOPTCD                                                 05608000
DCBOPTU  EQU   DCBOPTCD                                                 05609000
DCBOPTW  EQU   DCBOPTCD                                                 05610000
DCBPUTA  EQU   DCBGETA                                                  05611000
@NM00044 EQU   DCBPUT                                                   05612000
DCBREADA EQU   DCBWRITA                                                 05613000
@NM00043 EQU   DCBREAD                                                  05614000
DCBDEBA  EQU   DCBDEBAD+1                                               05615000
@NM00042 EQU   DCBIFLGS                                                 05616000
DCBIFIOE EQU   DCBIFLGS                                                 05617000
DCBCH12  EQU   DCBIFPCT                                                 05618000
DCBCH9   EQU   DCBIFPCT                                                 05619000
DCBIFEC  EQU   DCBIFLGS                                                 05620000
DCBMFSTI EQU   DCBMFDMD                                                 05621000
DCBMFAWR EQU   DCBMFSTK                                                 05622000
DCBMFUIP EQU   DCBMFTMD                                                 05623000
DCBMFIDW EQU   DCBMFLCP                                                 05624000
DCBMFWRK EQU   DCBMFMVP                                                 05625000
DCBMFRDQ EQU   DCBMFWRT                                                 05626000
DCBMFGTQ EQU   DCBMFPUT                                                 05627000
DCBMFSTL EQU   DCBMACF2                                                 05628000
DCBMFCK  EQU   DCBMFDMG                                                 05629000
DCBMFRDX EQU   DCBMFCHK                                                 05630000
DCBMFDBF EQU   DCBMFSBG                                                 05631000
DCBMFRDI EQU   DCBMFLCG                                                 05632000
DCBMFRDK EQU   DCBMFMVG                                                 05633000
DCBMFWRQ EQU   DCBMFRD                                                  05634000
DCBMFPTQ EQU   DCBMFGET                                                 05635000
DCBMFECP EQU   DCBMACF1                                                 05636000
DCBTIOT  EQU   IHADCS25                                                 05637000
DCBMRSTI EQU   DCBMRDMD                                                 05638000
DCBMRAWR EQU   DCBMRSTK                                                 05639000
DCBMRUIP EQU   DCBMRTMD                                                 05640000
DCBMRIDW EQU   DCBMRLCP                                                 05641000
DCBMRWRK EQU   DCBMRMVP                                                 05642000
DCBMRRDQ EQU   DCBMRWRT                                                 05643000
DCBMRGTQ EQU   DCBMRPUT                                                 05644000
DCBMRSTL EQU   DCBMACR2                                                 05645000
DCBMRCK  EQU   DCBMRDMG                                                 05646000
DCBPGFXA EQU   DCBMRRDX                                                 05647000
DCBMRDBF EQU   DCBMRSBG                                                 05648000
DCBMRRDI EQU   DCBMRLCG                                                 05649000
DCBMRRDK EQU   DCBMRMVG                                                 05650000
DCBMRWRQ EQU   DCBMRRD                                                  05651000
DCBMRPTQ EQU   DCBMRGET                                                 05652000
DCBMRECP EQU   DCBMACR1                                                 05653000
@NM00041 EQU   DCBIFLG                                                  05654000
DCBIBIOE EQU   DCBIFLG                                                  05655000
DCBICH12 EQU   DCBIBPCT                                                 05656000
DCBICH9  EQU   DCBIBPCT                                                 05657000
DCBIBEC  EQU   DCBIFLG                                                  05658000
DCBOFIOF EQU   DCBOFLGS                                                 05659000
DCBOFUEX EQU   DCBOFLGS                                                 05660000
DCBOFTM  EQU   DCBOFLGS                                                 05661000
DCBOFPPC EQU   DCBOFLGS                                                 05662000
DCBOFEOV EQU   DCBOFLGS                                                 05663000
DCBOFLRB EQU   DCBOFLGS                                                 05664000
DCBOFIOD EQU   DCBOFLWR                                                 05665000
DCBRECKL EQU   DCBRECFM                                                 05666000
DCBRECTO EQU   DCBRECLA                                                 05667000
DCBBFA   EQU   DCBBFTEK                                                 05668000
DCBH0    EQU   DCBBFTEK                                                 05669000
DCBBFTKD EQU   DCBBFTEK                                                 05670000
DCBBFTE  EQU   DCBBFT                                                   05671000
DCBBFTKR EQU   DCBBFT                                                   05672000
DCBBFTS  EQU   DCBBFT                                                   05673000
DCBH1    EQU   DCBBFTEK                                                 05674000
DCBSVCXA EQU   DCBSVCXL+1                                               05675000
@NM00040 EQU   DCBSVCXL                                                 05676000
DCBODEBA EQU   DCBIOBAA                                                 05677000
@NM00039 EQU   DCBQSLM                                                  05678000
DCBUPDBT EQU   DCBQSLM                                                  05679000
DCBUPDCM EQU   DCBQSLM                                                  05680000
DCB1DVDS EQU   DCBQSLM                                                  05681000
@NM00038 EQU   DCBDSRG2                                                 05682000
DCBDSGTR EQU   DCBDSRG2                                                 05683000
DCBACBM  EQU   DCBDSRG2                                                 05684000
@NM00037 EQU   DCBDSRG2                                                 05685000
DCBDSGTQ EQU   DCBDSRG2                                                 05686000
DCBDSGTX EQU   DCBDSRG2                                                 05687000
DCBDSGGS EQU   DCBDSRG2                                                 05688000
DCBDSGU  EQU   DCBDSRG1                                                 05689000
DCBDSGPO EQU   DCBDSRG1                                                 05690000
@NM00036 EQU   DCBDSRG1                                                 05691000
@NM00035 EQU   DCBDSRG1                                                 05692000
DCBDSGCX EQU   DCBDSRG1                                                 05693000
DCBDSGDA EQU   DCBDSRG1                                                 05694000
DCBDSGPS EQU   DCBDSRG1                                                 05695000
DCBDSGIS EQU   DCBDSRG1                                                 05696000
DCBBUFL  EQU   IHADCS11+8                                               05697000
DCBBUFCA EQU   DCBBUFCB+1                                               05698000
DCBBUFNO EQU   DCBBUFCB                                                 05699000
DCBDEVT  EQU   DCBREL                                                   05700000
@NM00034 EQU   IHADCS02+19                                              05701000
DCBDEN   EQU   IHADCS02+18                                              05702000
@NM00033 EQU   IHADCS02+17                                              05703000
DCBTRTCH EQU   IHADCS02+16                                              05704000
DCBBLKCT EQU   IHADCS02+12                                              05705000
@NM00032 EQU   IHADCS02                                                 05706000
DCBTRBAL EQU   IHADCS01+6                                               05707000
@NM00031 EQU   IHADCS01+5                                               05708000
@NM00030 EQU   IHADCS01+4                                               05709000
DCBDVTBA EQU   DCBDVTBL+1                                               05710000
@NM00029 EQU   DCBDVTBL                                                 05711000
DCBKEYCN EQU   IHADCS00+4                                               05712000
DCBRELAD EQU   IHADCS00                                                 05713000
@NM00028 EQU   IHADCB                                                   05714000
@NM00021 EQU   IOCSEX+35                                                05715000
IOCINFR1 EQU   IOCINF                                                   05716000
IOCINFQX EQU   IOCINF                                                   05717000
IOCINFPT EQU   IOCINF                                                   05718000
@NM00020 EQU   IOCDEV                                                   05719000
IOCDEVMT EQU   IOCDEV                                                   05720000
@NM00019 EQU   IOCFLG                                                   05721000
IOCFLGOE EQU   IOCFLG                                                   05722000
IOCFLGEF EQU   IOCFLG                                                   05723000
IOCFLGDF EQU   IOCFLG                                                   05724000
@NM00018 EQU   IOCSEX+10                                                05725000
IOCDEC   EQU   IOCSEX+4                                                 05726000
IODMID   EQU   IODSID                                                   05727000
IODMSG   EQU   IODATA+4                                                 05728000
@NM00017 EQU   DMPARY+15                                                05729000
DMPARYTP EQU   DMPARY+14                                                05730000
DMPARYEX EQU   DMPARY+12                                                05731000
DMPARYIC EQU   DMPARY+10                                                05732000
DMPARYSZ EQU   DMPARY+8                                                 05733000
DMPARYNM EQU   DMPARY                                                   05734000
@NM00016 EQU   DMPITM+15                                                05735000
DMPITMTP EQU   DMPITM+14                                                05736000
DMPITMLN EQU   DMPITM+12                                                05737000
DMPITMPT EQU   DMPITM+8                                                 05738000
DMPITMNM EQU   DMPITM                                                   05739000
@NM00015 EQU   FMTCNVF+1                                                05740000
FMTBS    EQU   FMTCNVF+1                                                05741000
FMTSS    EQU   FMTCNVF+1                                                05742000
FMTAL    EQU   FMTCNVF+1                                                05743000
FMTZS    EQU   FMTCNVF+1                                                05744000
@NM00014 EQU   FMTCNVF                                                  05745000
FMTPU    EQU   FMTCNVF                                                  05746000
FMTBD    EQU   FMTCNVF                                                  05747000
FMTBHD   EQU   FMTCNVF                                                  05748000
FMTBHA   EQU   FMTCNVF                                                  05749000
FMTBH    EQU   FMTCNVF                                                  05750000
FMTOLEN  EQU   FMTLIST+8                                                05751000
FMTRIO   EQU   FMTOCOL                                                  05752000
FMTSPT   EQU   FMTSTO                                                   05753000
FMTSTL   EQU   FMTILEN                                                  05754000
@NM00013 EQU   FMTFLGS+1                                                05755000
FMTHDF   EQU   FMTFLGS                                                  05756000
FMTDFF   EQU   FMTFLGS                                                  05757000
FMTSTF   EQU   FMTFLGS                                                  05758000
FMTREPF  EQU   FMTFLGS                                                  05759000
FMTBDF   EQU   FMTFLGS                                                  05760000
FMTIDF   EQU   FMTFLGS                                                  05761000
FMTSCF   EQU   FMTFLGS                                                  05762000
FMTEOLF  EQU   FMTFLGS                                                  05763000
DARGDTM  EQU   DARGARY+4                                                05764000
DARGPCT  EQU   DARGINL                                                  05765000
DARGREP  EQU   DARGINS                                                  05766000
@NM00012 EQU   DARGLIST+19                                              05767000
DARGIND  EQU   DARGLIST+18                                              05768000
DARGRETL EQU   DARGLIST+16                                              05769000
DARGCNT  EQU   DARGLIST+14                                              05770000
DARGRETP EQU   DARGLIST+4                                               05771000
UVOLVOL  EQU   UVOLENT+4                                                05772000
UVOLDEV  EQU   UVOLENT                                                  05773000
UVOLCNT  EQU   UVOLLIST                                                 05774000
OPNRSVD  EQU   OPNAGL+28                                                05775000
@NM00011 EQU   OPNMOD                                                   05776000
@NM00010 EQU   OPNTYP                                                   05777000
@NM00009 EQU   OPNRFM                                                   05778000
@NM00008 EQU   OPNOPT                                                   05779000
OPNOPTKS EQU   OPNOPT                                                   05780000
OPNOPTIN EQU   OPNOPT                                                   05781000
IOCRRN   EQU   IOCSTR+32                                                05782000
@NM00007 EQU   IOCSTR+30                                                05783000
IOCPNM   EQU   IOCSTR+28                                                05784000
@NM00006 EQU   IOCSTR+17                                                05785000
@NM00005 EQU   IOCMSG                                                   05786000
IOCMACPA EQU   IOCMAC                                                   05787000
@NM00004 EQU   IOCMAC                                                   05788000
@NM00003 EQU   IOCRFM                                                   05789000
@NM00002 EQU   IOCDSO                                                   05790000
IOCDAD   EQU   IOCSTR                                                   05791000
STAEWORK EQU   STAEPARM+32                                              05792000
STARPTR  EQU   STAEPFX+28                                               05793000
STASPTR  EQU   STAEPFX+24                                               05794000
STALEN   EQU   STAEPFX+20                                               05795000
STAID    EQU   STAEPFX+16                                               05796000
STAEPA   EQU   STAEPFX+12                                               05797000
STAGDT   EQU   STAEPFX+8                                                05798000
STABPTR  EQU   STAEPFX+4                                                05799000
STAFPTR  EQU   STAEPFX                                                  05800000
NEWID2   EQU   TRACE2+95                                                05801000
OLDERID2 EQU   TRACE2                                                   05802000
NEWID1   EQU   TRACE1+95                                                05803000
CALLID   EQU   OLDERID1+90                                              05804000
@NM00001 EQU   OLDERID1                                                 05805000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05806000
@RC00495 EQU   @EL00003                                                 05807000
@RC00520 EQU   @EL00003                                                 05808000
@RF00569 EQU   @RC00562                                                 05809000
@RF00640 EQU   @EL00005                                                 05810000
@PB00006 EQU   @PB00007                                                 05811000
@RC00795 EQU   @RC00790                                                 05812000
@RF00877 EQU   @RC00874                                                 05813000
@RF00889 EQU   @RC00886                                                 05814000
@PB00009 EQU   @EL00001                                                 05815000
@RF00505 EQU   @RC00495                                                 05816000
@RF00511 EQU   @RC00495                                                 05817000
@PB00005 EQU   @PB00006                                                 05818000
@PB00008 EQU   @PB00009                                                 05819000
@PB00004 EQU   @PB00005                                                 05820000
@PB00003 EQU   @PB00004                                                 05821000
@PB00002 EQU   @PB00003                                                 05822000
@ENDDATA EQU   *                                                        05823000
         END   ICKIO02,(C'PLS1715',0701,78192)                          05824000
