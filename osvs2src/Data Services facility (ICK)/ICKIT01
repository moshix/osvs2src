         TITLE '**********  ICKIT01:  INSPECT COMMAND CONTROLLER  ******00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
ICKIT01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'ICKIT01   78.198'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @09,0                                               0002 00021000
@PSTART  LA    @10,4095(,@09)                                      0002 00022000
         LA    @11,4095(,@10)                                      0002 00023000
         LA    @12,4095(,@11)                                      0002 00024000
         LA    @08,4095(,@12)                                      0002 00025000
         USING @PSTART,@09                                         0002 00026000
         USING @PSTART+4095,@10                                    0002 00027000
         USING @PSTART+8190,@11                                    0002 00028000
         USING @PSTART+12285,@12                                   0002 00029000
         USING @PSTART+16380,@08                                   0002 00030000
         L     @00,@SIZDATD                                        0002 00031000
         GETMAIN  R,LV=(0)                                              00032000
         LR    @07,@01                                             0002 00033000
         USING @DATD,@07                                           0002 00034000
         ST    @13,@SA00001+4                                      0002 00035000
         LM    @00,@01,20(@13)                                     0002 00036000
         ST    @07,8(,@13)                                         0002 00037000
         LR    @13,@07                                             0002 00038000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00039000
         MVC   @PC00001(12),0(@01)                                 0002 00040000
*                                                                  0199 00041000
         EJECT                                                          00042000
*                                                                  0200 00043000
*/*****  B E G I N    E X E C U T I O N  *****************************/ 00044000
*                                                                  0200 00045000
*    IF GDTDBG = NULLPTR                                           0200 00046000
*      THEN;                                                       0200 00047000
         L     @06,@PC00001                                        0200 00048000
         L     @06,GDTDBG(,@06)                                    0200 00049000
         LTR   @06,@06                                             0200 00050000
         BZ    @RT00200                                            0200 00051000
*      ELSE                                                        0202 00052000
*        CALL ICKDB010 (GDTTBL                                     0202 00053000
*          ,'IT00');                                               0202 00054000
*                                                                  0202 00055000
         L     @06,@PC00001                                        0202 00056000
         ST    @06,@AL00001                                        0202 00057000
         LA    @15,@CC00832                                        0202 00058000
         ST    @15,@AL00001+4                                      0202 00059000
         MVI   @AL00001+4,X'80'                                    0202 00060000
         L     @15,GDTDBG(,@06)                                    0202 00061000
         LA    @01,@AL00001                                        0202 00062000
         BALR  @14,@15                                             0202 00063000
*/*  ESTABLISH UPRINT ARGUMENT LIST                                  */ 00064000
*    PRTHDR = 'DARGLIST';                                          0203 00065000
@RT00200 MVC   PRTHDR(4),@CC00833                                  0203 00066000
*    PRTARGS = ''B;                                                0204 00067000
         XC    PRTARGS(52),PRTARGS                                 0204 00068000
*    DDSTRU = ADDR(PRTARGS);                                       0205 00069000
         LA    @06,PRTARGS                                         0205 00070000
         ST    @06,DDSTRU                                          0205 00071000
*    DARGSMOD = MSGMODZ;                                           0206 00072000
         MVC   DARGSMOD(3,@06),@CC00567                            0206 00073000
*/*  INDICATE INITIALLY A SUCCESSFUL COMPLETION (LASTCOND = 0)       */ 00074000
*    LASTCOND = LASTCC00;                                          0207 00075000
         L     @06,@PC00001+8                                      0207 00076000
         SLR   @15,@15                                             0207 00077000
         STH   @15,LASTCOND(,@06)                                  0207 00078000
*/*  CHECK_PARAMETERS                                                */ 00079000
*    CALL CHEKPARM;                                                0208 00080000
         BAL   @14,CHEKPARM                                        0208 00081000
*/*  IF NO SEVERE ERRORS FOUND                                       */ 00082000
*    IF LASTCOND < LASTCC12                                        0209 00083000
*/*    THEN ISSUE_OPEN_VOLUME                                        */ 00084000
*      THEN DO;    CALL OPENVOL; END;                              0209 00085000
         L     @06,@PC00001+8                                      0209 00086000
         LH    @06,LASTCOND(,@06)                                  0209 00087000
         CH    @06,@CH00265                                        0209 00088000
         BNL   @RF00209                                            0209 00089000
         BAL   @14,OPENVOL                                         0211 00090000
*/*  IF NO SEVERE ERRORS ENCOUNTERED                                 */ 00091000
*    IF LASTCOND < LASTCC12                                        0213 00092000
*/*    THEN                                                          */ 00093000
*      THEN DO;                                                    0213 00094000
*                                                                  0213 00095000
@RF00209 L     @06,@PC00001+8                                      0213 00096000
         LH    @06,LASTCOND(,@06)                                  0213 00097000
         CH    @06,@CH00265                                        0213 00098000
         BNL   @RF00213                                            0213 00099000
*/*      OBTAIN SETTING OF FIRST TIME INITIALIZATION FLAG (UDEVINFO) */ 00100000
*        CALL ICKDVIN0 (GDTTBL                                     0215 00101000
*                 ,VOLIB                                           0215 00102000
*                 ,VOLFINIT                                        0215 00103000
*                 ,POOLID                                          0215 00104000
*                 ,VIBPTR                                          0215 00105000
*                 ,VIBLEN                                          0215 00106000
*                 ,RETCODE);                                       0215 00107000
         L     @06,@PC00001                                        0215 00108000
         ST    @06,@AL00001                                        0215 00109000
         LA    @15,VOLIB                                           0215 00110000
         ST    @15,@AL00001+4                                      0215 00111000
         LA    @15,@CF00260                                        0215 00112000
         ST    @15,@AL00001+8                                      0215 00113000
         LA    @15,POOLID                                          0215 00114000
         ST    @15,@AL00001+12                                     0215 00115000
         LA    @15,VIBPTR                                          0215 00116000
         ST    @15,@AL00001+16                                     0215 00117000
         LA    @15,VIBLEN                                          0215 00118000
         ST    @15,@AL00001+20                                     0215 00119000
         LA    @15,RETCODE                                         0215 00120000
         ST    @15,@AL00001+24                                     0215 00121000
         L     @15,GDTDIN(,@06)                                    0215 00122000
         LA    @01,@AL00001                                        0215 00123000
         BALR  @14,@15                                             0215 00124000
*/*      IF THE VOLUME IS BEING INITIALIZED FOR THE FIRST TIME       */ 00125000
*        IF VIBFLAG = ON                                           0216 00126000
*/*        THEN                                                      */ 00127000
*          THEN DO;                                                0216 00128000
*                                                                  0216 00129000
         L     @06,VIBPTR                                          0216 00130000
         TM    VIBFLAG(@06),B'10000000'                            0216 00131000
         BNO   @RF00216                                            0216 00132000
*/*          ISSUE AN ERROR MESSAGE                                  */ 00133000
*            DARGSENT = MSGRTIN;                                   0218 00134000
         L     @06,DDSTRU                                          0218 00135000
         MVI   DARGSENT(@06),X'1B'                                 0218 00136000
*            CALL ICKTPPR0 (GDTTBL                                 0219 00137000
*                   ,PRTFILE                                       0219 00138000
*                   ,DDSTRU);                                      0219 00139000
         L     @06,@PC00001                                        0219 00140000
         ST    @06,@AL00001                                        0219 00141000
         LA    @15,@CF00094                                        0219 00142000
         ST    @15,@AL00001+4                                      0219 00143000
         LA    @15,DDSTRU                                          0219 00144000
         ST    @15,@AL00001+8                                      0219 00145000
         MVI   @AL00001+8,X'80'                                    0219 00146000
         L     @15,GDTPRT(,@06)                                    0219 00147000
         LA    @01,@AL00001                                        0219 00148000
         BALR  @14,@15                                             0219 00149000
*/*          INDICATE A SEVERE ERROR                                 */ 00150000
*            LASTCOND = LASTCC12;                                  0220 00151000
         L     @06,@PC00001+8                                      0220 00152000
         MVC   LASTCOND(2,@06),@CH00265                            0220 00153000
*/*          END-THEN                                                */ 00154000
*            END;                                                  0221 00155000
*/*      END-THEN                                                    */ 00156000
*        END;                                                      0222 00157000
@RF00216 DS    0H                                                  0223 00158000
         EJECT                                                          00159000
*/*  IF NO SEVERE ERRORS FOUND                                       */ 00160000
*    IF LASTCOND < LASTCC12                                        0223 00161000
*/*    THEN                                                          */ 00162000
*      THEN DO;                                                    0223 00163000
*                                                                  0223 00164000
@RF00213 L     @06,@PC00001+8                                      0223 00165000
         LH    @06,LASTCOND(,@06)                                  0223 00166000
         CH    @06,@CH00265                                        0223 00167000
         BNL   @RF00223                                            0223 00168000
*/*      OBTAIN_VOLUME_AUTHORIZATION                                 */ 00169000
*        CALL ICKVA01                                              0225 00170000
*              (GDTTBL                                             0225 00171000
*              ,VOLIB                                              0225 00172000
*              ,RETCODE);                                          0225 00173000
         L     @06,@PC00001                                        0225 00174000
         ST    @06,@AL00001                                        0225 00175000
         LA    @06,VOLIB                                           0225 00176000
         ST    @06,@AL00001+4                                      0225 00177000
         LA    @06,RETCODE                                         0225 00178000
         ST    @06,@AL00001+8                                      0225 00179000
         L     @15,@CV00837                                        0225 00180000
         LA    @01,@AL00001                                        0225 00181000
         BALR  @14,@15                                             0225 00182000
*/*      IF AUTHORIZATION IS NOT GRANTED                             */ 00183000
*        IF RETCODE = FAILURE                                      0226 00184000
*/*        THEN INDICATE A SEVERE ERROR (LASTCOND = 12)              */ 00185000
*          THEN DO;    LASTCOND = LASTCC12; END;                   0226 00186000
         CLC   RETCODE(4),@CF00165                                 0226 00187000
         BNE   @RF00226                                            0226 00188000
         L     @06,@PC00001+8                                      0228 00189000
         MVC   LASTCOND(2,@06),@CH00265                            0228 00190000
*/*      END-THEN                                                    */ 00191000
*        END;                                                      0230 00192000
@RF00226 DS    0H                                                  0231 00193000
         EJECT                                                          00194000
*/*  IF NO SEVERE ERRORS FOUND AND VERIFICATION IS REQUESTED         */ 00195000
*    IF (LASTCOND < LASTCC12) & (ADDR(VERFY) ^= NULLPTR)           0231 00196000
*/*    THEN                                                          */ 00197000
*      THEN DO;                                                    0231 00198000
*                                                                  0231 00199000
@RF00223 L     @06,@PC00001+8                                      0231 00200000
         LH    @06,LASTCOND(,@06)                                  0231 00201000
         CH    @06,@CH00265                                        0231 00202000
         BNL   @RF00231                                            0231 00203000
         SLR   @06,@06                                             0231 00204000
         L     @15,@PC00001+4                                      0231 00205000
         C     @06,FDTPTR+28(,@15)                                 0231 00206000
         BE    @RF00231                                            0231 00207000
*/*      IF THE OWNER ID IS TO BE VERIFIED                           */ 00208000
*        IF ADDR(VOWN) ^= NULLPTR                                  0233 00209000
*/*        THEN SET UP THE PROPER VALUE TO BE PASSED                 */ 00210000
*          THEN DO;    VALVOWN = VOWNVAL; END;                     0233 00211000
         L     @15,FDTPTR+36(,@15)                                 0233 00212000
         CR    @15,@06                                             0233 00213000
         BE    @RF00233                                            0233 00214000
         MVC   VALVOWN(14),VOWNVAL(@15)                            0235 00215000
*/*        ELSE INDICATE THAT THE OWNER ID NEED NOT BE VERIFIED      */ 00216000
*          ELSE DO;    VALVOWN = ' '; END;                         0237 00217000
         B     @RC00233                                            0237 00218000
@RF00233 DS    0H                                                  0238 00219000
         MVI   VALVOWN+1,C' '                                      0238 00220000
         MVC   VALVOWN+2(12),VALVOWN+1                             0238 00221000
         MVI   VALVOWN,C' '                                        0238 00222000
*/*      VERIFY_VOLUME_LABEL                                         */ 00223000
*        CALL   ICKVV01                                            0240 00224000
*               (GDTTBL                                            0240 00225000
*               ,VOLIB                                             0240 00226000
*               ,VSERVAL                                           0240 00227000
*               ,VALVOWN                                           0240 00228000
*               ,RETCODE);                                         0240 00229000
@RC00233 L     @06,@PC00001                                        0240 00230000
         ST    @06,@AL00001                                        0240 00231000
         LA    @06,VOLIB                                           0240 00232000
         ST    @06,@AL00001+4                                      0240 00233000
         L     @06,@PC00001+4                                      0240 00234000
         L     @06,FDTPTR+32(,@06)                                 0240 00235000
         LA    @06,VSERVAL(,@06)                                   0240 00236000
         ST    @06,@AL00001+8                                      0240 00237000
         LA    @06,VALVOWN                                         0240 00238000
         ST    @06,@AL00001+12                                     0240 00239000
         LA    @06,RETCODE                                         0240 00240000
         ST    @06,@AL00001+16                                     0240 00241000
         L     @15,@CV00839                                        0240 00242000
         LA    @01,@AL00001                                        0240 00243000
         BALR  @14,@15                                             0240 00244000
*/*      IF VERIFICATION FAILS                                       */ 00245000
*        IF RETCODE = FAILURE                                      0241 00246000
*/*        THEN INDICATE A SEVERE ERROR (LASTCOND = 12)              */ 00247000
*          THEN DO;    LASTCOND = LASTCC12; END;                   0241 00248000
         CLC   RETCODE(4),@CF00165                                 0241 00249000
         BNE   @RF00241                                            0241 00250000
         L     @06,@PC00001+8                                      0243 00251000
         MVC   LASTCOND(2,@06),@CH00265                            0243 00252000
*/*      IF VOLUME LABEL DOES NOT EXIST                              */ 00253000
*        IF RETCODE = NOLABEL                                      0245 00254000
*/*        THEN                                                      */ 00255000
*          THEN DO;                                                0245 00256000
*                                                                  0245 00257000
@RF00241 CLC   RETCODE(4),@CF00116                                 0245 00258000
         BNE   @RF00245                                            0245 00259000
*/*          ISSUE ERROR MESSAGE (MSGURVOL) (UPRINT)                 */ 00260000
*            DARGSENT = MSGURVOL;                                  0247 00261000
         L     @06,DDSTRU                                          0247 00262000
         MVI   DARGSENT(@06),X'10'                                 0247 00263000
*            CALL ICKTPPR0 (GDTTBL                                 0248 00264000
*                   ,PRTFILE                                       0248 00265000
*                   ,DDSTRU);                                      0248 00266000
         L     @06,@PC00001                                        0248 00267000
         ST    @06,@AL00001                                        0248 00268000
         LA    @15,@CF00094                                        0248 00269000
         ST    @15,@AL00001+4                                      0248 00270000
         LA    @15,DDSTRU                                          0248 00271000
         ST    @15,@AL00001+8                                      0248 00272000
         MVI   @AL00001+8,X'80'                                    0248 00273000
         L     @15,GDTPRT(,@06)                                    0248 00274000
         LA    @01,@AL00001                                        0248 00275000
         BALR  @14,@15                                             0248 00276000
*/*          INDICATE A SEVERE ERROR (LASTCOND = 12)                 */ 00277000
*            LASTCOND = LASTCC12;                                  0249 00278000
         L     @06,@PC00001+8                                      0249 00279000
         MVC   LASTCOND(2,@06),@CH00265                            0249 00280000
*/*          END-THEN                                                */ 00281000
*            END;                                                  0250 00282000
*/*      END-THEN                                                    */ 00283000
*        END;                                                      0251 00284000
@RF00245 DS    0H                                                  0252 00285000
         EJECT                                                          00286000
*/*  IF NO SEVERE ERRORS FOUND                                       */ 00287000
*    IF LASTCOND < LASTCC12                                        0252 00288000
*/*    THEN SET_NUMBER_OF_TRACKS                                     */ 00289000
*      THEN DO;    CALL SETTRACK; END;                             0252 00290000
@RF00231 L     @06,@PC00001+8                                      0252 00291000
         LH    @06,LASTCOND(,@06)                                  0252 00292000
         CH    @06,@CH00265                                        0252 00293000
         BNL   @RF00252                                            0252 00294000
         BAL   @14,SETTRACK                                        0254 00295000
*/*  IF NO SEVERE ERRORS                                             */ 00296000
*    IF LASTCOND < LASTCC12                                        0256 00297000
*/*    THEN                                                          */ 00298000
*      THEN DO;                                                    0256 00299000
@RF00252 L     @06,@PC00001+8                                      0256 00300000
         LH    @06,LASTCOND(,@06)                                  0256 00301000
         CH    @06,@CH00265                                        0256 00302000
         BNL   @RF00256                                            0256 00303000
*/*      INITIALIZE COUNT OF UNRECOVERABLE TRACKS TO 0               */ 00304000
*        COUNTUTR = 0;                                             0258 00305000
         SLR   @06,@06                                             0258 00306000
         ST    @06,COUNTUTR                                        0258 00307000
*/*      INITIALIZE COUNT OF AVAILABLE ALTERNATE TRACKS TO           */ 00308000
*/*      TO VALUE IN THE VTOC                                        */ 00309000
*        ALTCOUNT = TALCNT;                                        0259 00310000
         MVC   ALTCOUNT(4),TALCNT                                  0259 00311000
*/*      INITIALIZE POINTER TO NEXT AVAILABLE ALTERNATE TRACK TO     */ 00312000
*/*       THE FIRST ALTERNATE TRACK ON THE PACK                      */ 00313000
*        ALTPTR = FIRSTAL;                                         0260 00314000
         L     @06,INFOPTR+48                                      0260 00315000
         MVC   ALTPTR(4),FIRSTAL(@06)                              0260 00316000
*/*      END-THEN                                                    */ 00317000
*        END;                                                      0261 00318000
*/*  IF NO SEVERE ERRORS FOUND                                       */ 00319000
*    IF LASTCOND < LASTCC12                                        0262 00320000
*/*    THEN INSPECT_THE_TRACKS                                       */ 00321000
*      THEN DO;    CALL INSTRACK; END;                             0262 00322000
@RF00256 L     @06,@PC00001+8                                      0262 00323000
         LH    @06,LASTCOND(,@06)                                  0262 00324000
         CH    @06,@CH00265                                        0262 00325000
         BNL   @RF00262                                            0262 00326000
         BAL   @14,INSTRACK                                        0264 00327000
*/*  IF NO SEVERE ERRORS FOUND                                       */ 00328000
*    IF LASTCOND < LASTCC12                                        0266 00329000
*/*    THEN UPDATE_VTOC                                              */ 00330000
*      THEN DO;    CALL UPDVTOC; END;                              0266 00331000
@RF00262 L     @06,@PC00001+8                                      0266 00332000
         LH    @06,LASTCOND(,@06)                                  0266 00333000
         CH    @06,@CH00265                                        0266 00334000
         BNL   @RF00266                                            0266 00335000
         BAL   @14,UPDVTOC                                         0268 00336000
*/*  IF NO SEVERE ERRORS FOUND THUS FAR                              */ 00337000
*    IF LASTCOND < LASTCC12                                        0270 00338000
*/*    THEN PRODUCE_PACK_MAP                                         */ 00339000
*      THEN DO;                                                    0270 00340000
*                                                                  0270 00341000
@RF00266 L     @06,@PC00001+8                                      0270 00342000
         LH    @06,LASTCOND(,@06)                                  0270 00343000
         CH    @06,@CH00265                                        0270 00344000
         BNL   @RF00270                                            0270 00345000
*        IF ADDR(MAP) ^= NULLPTR                                   0272 00346000
*          THEN DO;    PRTFLG = ON; END;                           0272 00347000
         L     @06,@PC00001+4                                      0272 00348000
         L     @06,FDTPTR+44(,@06)                                 0272 00349000
         LTR   @06,@06                                             0272 00350000
         BZ    @RF00272                                            0272 00351000
         OI    PRTFLG,B'10000000'                                  0274 00352000
*          ELSE DO;    PRTFLG = OFF; END;                          0276 00353000
         B     @RC00272                                            0276 00354000
@RF00272 DS    0H                                                  0277 00355000
         NI    PRTFLG,B'01111111'                                  0277 00356000
*        IF ADDR (CHECK) ^= NULLPTR                                0279 00357000
*          THEN DO;    CHKFLG = ON; END;                           0279 00358000
@RC00272 L     @06,@PC00001+4                                      0279 00359000
         L     @06,FDTPTR+12(,@06)                                 0279 00360000
         LTR   @06,@06                                             0279 00361000
         BZ    @RF00279                                            0279 00362000
         OI    CHKFLG,B'10000000'                                  0281 00363000
*          ELSE DO;    CHKFLG = OFF; END;                          0283 00364000
         B     @RC00279                                            0283 00365000
@RF00279 DS    0H                                                  0284 00366000
         NI    CHKFLG,B'01111111'                                  0284 00367000
*        CALL ICKPP01                                              0286 00368000
*             (GDTTBL                                              0286 00369000
*             ,VOLIB                                               0286 00370000
*             ,PRTFLG                                              0286 00371000
*             ,CHKFLG                                              0286 00372000
*             ,VTOCLOC                                             0286 00373000
*             ,VTOCEXT                                             0286 00374000
*             ,TALCNT                                              0286 00375000
*             ,RETCODE);                                           0286 00376000
@RC00279 L     @06,@PC00001                                        0286 00377000
         ST    @06,@AL00001                                        0286 00378000
         LA    @06,VOLIB                                           0286 00379000
         ST    @06,@AL00001+4                                      0286 00380000
         LA    @06,PRTFLG                                          0286 00381000
         ST    @06,@AL00001+8                                      0286 00382000
         LA    @06,CHKFLG                                          0286 00383000
         ST    @06,@AL00001+12                                     0286 00384000
         LA    @06,VTOCLOC                                         0286 00385000
         ST    @06,@AL00001+16                                     0286 00386000
         LA    @06,VTOCEXT                                         0286 00387000
         ST    @06,@AL00001+20                                     0286 00388000
         LA    @06,TALCNT                                          0286 00389000
         ST    @06,@AL00001+24                                     0286 00390000
         LA    @06,RETCODE                                         0286 00391000
         ST    @06,@AL00001+28                                     0286 00392000
         L     @15,@CV00843                                        0286 00393000
         LA    @01,@AL00001                                        0286 00394000
         BALR  @14,@15                                             0286 00395000
*/*      END-THEN                                                    */ 00396000
*        END;                                                      0287 00397000
*/*  IF VOLUME WAS OPENED                                            */ 00398000
*    IF VOLIB ^= NULLPTR                                           0288 00399000
*/*    THEN CLOSE THE VOLUME (UDEVCLSE)                              */ 00400000
*      THEN DO;                                                    0288 00401000
*                                                                  0288 00402000
@RF00270 L     @06,VOLIB                                           0288 00403000
         LTR   @06,@06                                             0288 00404000
         BZ    @RF00288                                            0288 00405000
*        CALL ICKDVCL0 (GDTTBL                                     0290 00406000
*                 ,VOLIB                                           0290 00407000
*                 ,RETCODE);                                       0290 00408000
         L     @06,@PC00001                                        0290 00409000
         ST    @06,@AL00001                                        0290 00410000
         LA    @15,VOLIB                                           0290 00411000
         ST    @15,@AL00001+4                                      0290 00412000
         LA    @15,RETCODE                                         0290 00413000
         ST    @15,@AL00001+8                                      0290 00414000
         L     @15,GDTDVC(,@06)                                    0290 00415000
         LA    @01,@AL00001                                        0290 00416000
         BALR  @14,@15                                             0290 00417000
*/*      IF UNABLE TO CLOSE THE VOLUME                               */ 00418000
*        IF RETCODE = FAILURE                                      0291 00419000
*/*        THEN                                                      */ 00420000
*          THEN DO;                                                0291 00421000
*                                                                  0291 00422000
         CLC   RETCODE(4),@CF00165                                 0291 00423000
         BNE   @RF00291                                            0291 00424000
*/*          ISSUE ERROR MESSAGE (MSGCLSEA) (UPRINT)                 */ 00425000
*            DARGSENT = MSGCLSEA;                                  0293 00426000
         L     @06,DDSTRU                                          0293 00427000
         MVI   DARGSENT(@06),X'0B'                                 0293 00428000
*            CALL ICKTPPR0 (GDTTBL                                 0294 00429000
*                   ,PRTFILE                                       0294 00430000
*                   ,DDSTRU);                                      0294 00431000
         L     @06,@PC00001                                        0294 00432000
         ST    @06,@AL00001                                        0294 00433000
         LA    @15,@CF00094                                        0294 00434000
         ST    @15,@AL00001+4                                      0294 00435000
         LA    @15,DDSTRU                                          0294 00436000
         ST    @15,@AL00001+8                                      0294 00437000
         MVI   @AL00001+8,X'80'                                    0294 00438000
         L     @15,GDTPRT(,@06)                                    0294 00439000
         LA    @01,@AL00001                                        0294 00440000
         BALR  @14,@15                                             0294 00441000
*/*          INDICATE MINOR ERROR                                    */ 00442000
*            LASTCOND = MAX (LASTCOND,LASTCC04);                   0295 00443000
         L     @06,@PC00001+8                                      0295 00444000
         LH    @15,LASTCOND(,@06)                                  0295 00445000
         LA    @14,4                                               0295 00446000
         CR    @15,@14                                             0295 00447000
         BNL   *+6                                                      00448000
         LR    @15,@14                                             0295 00449000
         STH   @15,LASTCOND(,@06)                                  0295 00450000
*/*          END-THEN                                                */ 00451000
*            END;                                                  0296 00452000
*/*      END-THEN                                                    */ 00453000
*        END;                                                      0297 00454000
@RF00291 DS    0H                                                  0298 00455000
         EJECT                                                          00456000
*/*  RETURN TO THE EXECUTIVE                                         */ 00457000
*    DARGSMOD = MSGUNIV;                                           0298 00458000
@RF00288 L     @06,DDSTRU                                          0298 00459000
         MVC   DARGSMOD(3,@06),@CC00617                            0298 00460000
*    IF LASTCOND >= LASTCC12                                       0299 00461000
*      THEN DO;    DARGSENT = MSGUNIVB; END;                       0299 00462000
         L     @15,@PC00001+8                                      0299 00463000
         LH    @15,LASTCOND(,@15)                                  0299 00464000
         CH    @15,@CH00265                                        0299 00465000
         BL    @RF00299                                            0299 00466000
         MVI   DARGSENT(@06),X'03'                                 0301 00467000
*      ELSE DO;    DARGSENT = MSGUNIVA; END;                       0303 00468000
         B     @RC00299                                            0303 00469000
@RF00299 DS    0H                                                  0304 00470000
         L     @06,DDSTRU                                          0304 00471000
         MVI   DARGSENT(@06),X'01'                                 0304 00472000
*    DARGDBP = ADDR (LASTCOND);                                    0306 00473000
@RC00299 L     @06,DDSTRU                                          0306 00474000
         L     @15,@PC00001+8                                      0306 00475000
         ST    @15,DARGDBP(,@06)                                   0306 00476000
*    DARGILP = LENGTH (LASTCOND);                                  0307 00477000
         MVC   DARGILP(2,@06),@CH00116                             0307 00478000
*    CALL ICKTPPR0 (GDTTBL                                         0308 00479000
*           ,PRTFILE                                               0308 00480000
*           ,DDSTRU);                                              0308 00481000
         L     @06,@PC00001                                        0308 00482000
         ST    @06,@AL00001                                        0308 00483000
         LA    @15,@CF00094                                        0308 00484000
         ST    @15,@AL00001+4                                      0308 00485000
         LA    @15,DDSTRU                                          0308 00486000
         ST    @15,@AL00001+8                                      0308 00487000
         MVI   @AL00001+8,X'80'                                    0308 00488000
         L     @15,GDTPRT(,@06)                                    0308 00489000
         LA    @01,@AL00001                                        0308 00490000
         BALR  @14,@15                                             0308 00491000
*    IF GDTDBG = NULLPTR                                           0309 00492000
*      THEN;                                                       0309 00493000
         L     @06,@PC00001                                        0309 00494000
         L     @06,GDTDBG(,@06)                                    0309 00495000
         LTR   @06,@06                                             0309 00496000
         BZ    @RT00309                                            0309 00497000
*      ELSE                                                        0311 00498000
*        CALL ICKDB010 (GDTTBL                                     0311 00499000
*          ,'IT99');                                               0311 00500000
         L     @06,@PC00001                                        0311 00501000
         ST    @06,@AL00001                                        0311 00502000
         LA    @15,@CC00845                                        0311 00503000
         ST    @15,@AL00001+4                                      0311 00504000
         MVI   @AL00001+4,X'80'                                    0311 00505000
         L     @15,GDTDBG(,@06)                                    0311 00506000
         LA    @01,@AL00001                                        0311 00507000
         BALR  @14,@15                                             0311 00508000
*    CALL ICKSAFP0 (GDTTBL                                         0312 00509000
*           ,POOLID);                                              0312 00510000
@RT00309 L     @06,@PC00001                                        0312 00511000
         ST    @06,@AL00001                                        0312 00512000
         LA    @15,POOLID                                          0312 00513000
         ST    @15,@AL00001+4                                      0312 00514000
         MVI   @AL00001+4,X'80'                                    0312 00515000
         L     @15,GDTFPL(,@06)                                    0312 00516000
         LA    @01,@AL00001                                        0312 00517000
         BALR  @14,@15                                             0312 00518000
*    CALL ICKSAEP0(GDTTBL,MODID);                                  0313 00519000
         L     @06,@PC00001                                        0313 00520000
         ST    @06,@AL00001                                        0313 00521000
         LA    @15,MODID                                           0313 00522000
         ST    @15,@AL00001+4                                      0313 00523000
         MVI   @AL00001+4,X'80'                                    0313 00524000
         L     @15,GDTEPL(,@06)                                    0313 00525000
         LA    @01,@AL00001                                        0313 00526000
         BALR  @14,@15                                             0313 00527000
         EJECT                                                          00528000
*/*****  START OF SPECIFICATIONS  ************************************/ 00529000
*/*                                                                  */ 00530000
*/*  SUB-PROCEDURE NAME:  CHEKPARM                                   */ 00531000
*/*                                                                  */ 00532000
*/*  DESCRIPTIVE NAME:  CHECK PARAMETERS                             */ 00533000
*/*                                                                  */ 00534000
*/*  FUNCTION:                                                       */ 00535000
*/*                                                                  */ 00536000
*/*    THIS SUB-PROCEDURE CHECKS FOR INVALID COMBINATIONS OF         */ 00537000
*/*    KEYWORDS SUCH AS (NOCHECK, ASSIGN, AND ALLTRACKS).            */ 00538000
*/*    IT ALSO SETS PROPER VALUES FOR A TRACK SURFACE CHECK          */ 00539000
*/*    WHEN THE WHOLE PACK IS TO BE PROCESSED.                       */ 00540000
*/*                                                                  */ 00541000
*/*****  END OF SPECIFICATIONS  **************************************/ 00542000
*                                                                  0314 00543000
*                                                                  0314 00544000
*/*  SUB-PROCEDURE CHECK_PARAMETERS                                  */ 00545000
*    CHEKPARM:                                                     0314 00546000
*      PROCEDURE;                                                  0314 00547000
CHEKPARM STM   @14,@12,@SA00002                                    0314 00548000
*    OLDERID2 = NEWERID2;                                          0315 00549000
         L     @06,@PC00001                                        0315 00550000
         L     @15,GDTTR2(,@06)                                    0315 00551000
         MVC   @TS00001(95),NEWERID2(@15)                          0315 00552000
         MVC   OLDERID2(95,@15),@TS00001                           0315 00553000
*    NEWID2 = 'ITCP';                                              0316 00554000
         MVC   NEWID2(4,@15),@CC00849                              0316 00555000
*/*  IF NOCHECK, ASSIGN AND 'ALLTRACKS' ARE SPECIFIED                */ 00556000
*    IF (ADDR(NOCHK) ^= NULLPTR) & (ADDR(ASSGN) ^= NULLPTR) &      0317 00557000
*     (ADDR(ALLTK) ^= NULLPTR)                                     0317 00558000
*/*    THEN                                                          */ 00559000
*      THEN DO;                                                    0317 00560000
*                                                                  0317 00561000
         SLR   @15,@15                                             0317 00562000
         L     @14,@PC00001+4                                      0317 00563000
         C     @15,FDTPTR+16(,@14)                                 0317 00564000
         BE    @RF00317                                            0317 00565000
         C     @15,FDTPTR+56(,@14)                                 0317 00566000
         BE    @RF00317                                            0317 00567000
         C     @15,FDTPTR+68(,@14)                                 0317 00568000
         BE    @RF00317                                            0317 00569000
*/*      ISSUE ERROR MESSAGE (MSGNCATA) (UPRINT)                     */ 00570000
*        DARGSENT = MSGNCATA;                                      0319 00571000
         L     @01,DDSTRU                                          0319 00572000
         MVI   DARGSENT(@01),X'22'                                 0319 00573000
*        CALL ICKTPPR0 (GDTTBL                                     0320 00574000
*               ,PRTFILE                                           0320 00575000
*               ,DDSTRU);                                          0320 00576000
         ST    @06,@AL00001                                        0320 00577000
         LA    @15,@CF00094                                        0320 00578000
         ST    @15,@AL00001+4                                      0320 00579000
         LA    @15,DDSTRU                                          0320 00580000
         ST    @15,@AL00001+8                                      0320 00581000
         MVI   @AL00001+8,X'80'                                    0320 00582000
         L     @15,GDTPRT(,@06)                                    0320 00583000
         LA    @01,@AL00001                                        0320 00584000
         BALR  @14,@15                                             0320 00585000
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */ 00586000
*        LASTCOND = LASTCC12;                                      0321 00587000
         L     @06,@PC00001+8                                      0321 00588000
         MVC   LASTCOND(2,@06),@CH00265                            0321 00589000
*/*      END-THEN                                                    */ 00590000
*        END;                                                      0322 00591000
*/*  IF CHECK (N) AND 'ALLTRACKS' ARE SPECIFIED                      */ 00592000
*    IF (ADDR(CHECK) ^= NULLPTR) & (ADDR(ALLTK) ^= NULLPTR)        0323 00593000
*/*    THEN                                                          */ 00594000
*      THEN DO;                                                    0323 00595000
*                                                                  0323 00596000
@RF00317 SLR   @06,@06                                             0323 00597000
         L     @15,@PC00001+4                                      0323 00598000
         L     @14,FDTPTR+12(,@15)                                 0323 00599000
         CR    @14,@06                                             0323 00600000
         BE    @RF00323                                            0323 00601000
         C     @06,FDTPTR+68(,@15)                                 0323 00602000
         BE    @RF00323                                            0323 00603000
*/*      SET MAXIMUM NUMBER OF CYCLES AS REQUESTED OR TO LIMIT       */ 00604000
*        CYCLES = MIN (CHECKVAL, CYCMAXAL);                        0325 00605000
         L     @06,CHECKVAL(,@14)                                  0325 00606000
         LA    @15,10                                              0325 00607000
         CR    @06,@15                                             0325 00608000
         BNH   *+6                                                      00609000
         LR    @06,@15                                             0325 00610000
         ST    @06,CYCLES                                          0325 00611000
*/*      END-THEN                                                    */ 00612000
*        END;                                                      0326 00613000
*/*    ELSE NOT ALLTRACKS, SO USE REQUESTED VALUE                    */ 00614000
*      ELSE DO;    CYCLES = CHECKVAL; END;                         0327 00615000
         B     @RC00323                                            0327 00616000
@RF00323 DS    0H                                                  0328 00617000
         L     @06,@PC00001+4                                      0328 00618000
         L     @06,FDTPTR+12(,@06)                                 0328 00619000
         MVC   CYCLES(4),CHECKVAL(@06)                             0328 00620000
*/*  END-SUB-PROCEDURE CHECK_PARAMETERS                              */ 00621000
*    END CHEKPARM;                                                 0330 00622000
*                                                                  0330 00623000
@EL00002 DS    0H                                                  0330 00624000
@EF00002 DS    0H                                                  0330 00625000
@ER00002 LM    @14,@12,@SA00002                                    0330 00626000
         BR    @14                                                 0330 00627000
         EJECT                                                          00628000
*/*****  START OF SPECIFICATIONS  ************************************/ 00629000
*/*                                                                  */ 00630000
*/*  SUB-PROCEDURE NAME:  OPENVOL                                    */ 00631000
*/*                                                                  */ 00632000
*/*  DESCRIPTIVE NAME:  ISSUE OPEN VOLUME                            */ 00633000
*/*                                                                  */ 00634000
*/*  FUNCTION:                                                       */ 00635000
*/*                                                                  */ 00636000
*/*    THIS SUBPROCEDURE INVOKES THE DEVICE ADAPTER MODULE THAT      */ 00637000
*/*    OPENS THE VOLUME FOR SUBSEQUENT PROCESSING. IT ALSO ENSURES   */ 00638000
*/*    THAT THE VOLUME IS MOUNTED PRIVATE WHEN THE VOLUME IS ON-LINE.*/ 00639000
*/*                                                                  */ 00640000
*/*****  END OF SPECIFICATIONS  **************************************/ 00641000
*                                                                  0331 00642000
*                                                                  0331 00643000
*/*  SUB-PROCEDURE ISSUE_OPEN_VOLUME                                 */ 00644000
*    OPENVOL:                                                      0331 00645000
*      PROCEDURE;                                                  0331 00646000
OPENVOL  STM   @14,@12,@SA00003                                    0331 00647000
*    OLDERID2 = NEWERID2;                                          0332 00648000
         L     @06,@PC00001                                        0332 00649000
         L     @06,GDTTR2(,@06)                                    0332 00650000
         MVC   @TS00001(95),NEWERID2(@06)                          0332 00651000
         MVC   OLDERID2(95,@06),@TS00001                           0332 00652000
*    NEWID2 =  'ITOP';                                             0333 00653000
         MVC   NEWID2(4,@06),@CC00854                              0333 00654000
*/*  SET UP THE MSS PARAMETER AS A BLANK FIELD AS THIS COMMAND DOES  */ 00655000
*/*   NOT SUPPORT MSS STAGING PACK                                   */ 00656000
*    MSSDEV = ' ';                                                 0334 00657000
         MVI   MSSDEV+1,C' '                                       0334 00658000
         MVC   MSSDEV+2(6),MSSDEV+1                                0334 00659000
         MVI   MSSDEV,C' '                                         0334 00660000
*/*  SET UP THE CUU OR DD-NAME PARAMETER                             */ 00661000
*    IF (ADDR(DEVIC) ^= NULLPTR) & (ADDR(DNAME) = NULLPTR)         0335 00662000
*      THEN DO;                                                    0335 00663000
*                                                                  0335 00664000
         SLR   @06,@06                                             0335 00665000
         L     @15,@PC00001+4                                      0335 00666000
         L     @14,FDTPTR(,@15)                                    0335 00667000
         CR    @14,@06                                             0335 00668000
         BE    @RF00335                                            0335 00669000
         C     @06,FDTPTR+64(,@15)                                 0335 00670000
         BNE   @RF00335                                            0335 00671000
*        VIBNAME = DEVICVAL;                                       0337 00672000
         MVI   VIBNAME+3,C' '                                      0337 00673000
         MVC   VIBNAME+4(4),VIBNAME+3                              0337 00674000
         MVC   VIBNAME(3),DEVICVAL(@14)                            0337 00675000
*        VIBTYPE = CUUVAL;                                         0338 00676000
         ST    @06,VIBTYPE                                         0338 00677000
*        END;                                                      0339 00678000
*      ELSE DO;                                                    0340 00679000
*                                                                  0340 00680000
         B     @RC00335                                            0340 00681000
@RF00335 DS    0H                                                  0341 00682000
*        VIBNAME = DNAMEVAL;                                       0341 00683000
         L     @06,@PC00001+4                                      0341 00684000
         L     @06,FDTPTR+64(,@06)                                 0341 00685000
         MVC   VIBNAME(8),DNAMEVAL(@06)                            0341 00686000
*        VIBTYPE = DDNVAL;                                         0342 00687000
         MVC   VIBTYPE(4),@CF00165                                 0342 00688000
*        END;                                                      0343 00689000
*/*  IF DEVICETYPE IS SUPPLIED                                       */ 00690000
*    IF ADDR (DEVTY) ^= NULLPTR                                    0344 00691000
*/*    THEN PASS THE DEVICE TYPE                                     */ 00692000
*      THEN DO;    DEVTYPE = DEVTYVAL; END;                        0344 00693000
@RC00335 L     @06,@PC00001+4                                      0344 00694000
         L     @06,FDTPTR+72(,@06)                                 0344 00695000
         LTR   @06,@06                                             0344 00696000
         BZ    @RF00344                                            0344 00697000
         MVC   DEVTYPE(8),DEVTYVAL(@06)                            0346 00698000
*/*    ELSE INDICATE NO DEVICE TYPE SUPPLIED                         */ 00699000
*      ELSE DO;    DEVTYPE = ' '; END;                             0348 00700000
         B     @RC00344                                            0348 00701000
@RF00344 DS    0H                                                  0349 00702000
         MVI   DEVTYPE+1,C' '                                      0349 00703000
         MVC   DEVTYPE+2(6),DEVTYPE+1                              0349 00704000
         MVI   DEVTYPE,C' '                                        0349 00705000
*/*  OPEN THE VOLUME FOR PROCESSING (UDEVOPEN)                       */ 00706000
*    CALL ICKDVON0 (GDTTBL                                         0351 00707000
*             ,VIBNAME                                             0351 00708000
*             ,VIBTYPE                                             0351 00709000
*             ,DEVTYPE                                             0351 00710000
*             ,MSSDEV                                              0351 00711000
*             ,VOLIB                                               0351 00712000
*             ,RETCODE);                                           0351 00713000
@RC00344 L     @06,@PC00001                                        0351 00714000
         ST    @06,@AL00001                                        0351 00715000
         LA    @15,VIBNAME                                         0351 00716000
         ST    @15,@AL00001+4                                      0351 00717000
         LA    @15,VIBTYPE                                         0351 00718000
         ST    @15,@AL00001+8                                      0351 00719000
         LA    @15,DEVTYPE                                         0351 00720000
         ST    @15,@AL00001+12                                     0351 00721000
         LA    @15,MSSDEV                                          0351 00722000
         ST    @15,@AL00001+16                                     0351 00723000
         LA    @15,VOLIB                                           0351 00724000
         ST    @15,@AL00001+20                                     0351 00725000
         LA    @15,RETCODE                                         0351 00726000
         ST    @15,@AL00001+24                                     0351 00727000
         L     @15,GDTDVO(,@06)                                    0351 00728000
         LA    @01,@AL00001                                        0351 00729000
         BALR  @14,@15                                             0351 00730000
*/*  IF CUU OR DD-NAME IS INVALID                                    */ 00731000
*    IF RETCODE = INVALCUU                                         0352 00732000
*/*    THEN                                                          */ 00733000
*      THEN DO;                                                    0352 00734000
*                                                                  0352 00735000
         CLC   RETCODE(4),@CF00165                                 0352 00736000
         BNE   @RF00352                                            0352 00737000
*/*      ISSUE ERROR MESSAGE (MSGINCUU) (UPRINT)                     */ 00738000
*        DARGSENT = MSGINCUU;                                      0354 00739000
         L     @06,DDSTRU                                          0354 00740000
         MVI   DARGSENT(@06),X'18'                                 0354 00741000
*        CALL ICKTPPR0 (GDTTBL                                     0355 00742000
*               ,PRTFILE                                           0355 00743000
*               ,DDSTRU);                                          0355 00744000
         L     @06,@PC00001                                        0355 00745000
         ST    @06,@AL00001                                        0355 00746000
         LA    @15,@CF00094                                        0355 00747000
         ST    @15,@AL00001+4                                      0355 00748000
         LA    @15,DDSTRU                                          0355 00749000
         ST    @15,@AL00001+8                                      0355 00750000
         MVI   @AL00001+8,X'80'                                    0355 00751000
         L     @15,GDTPRT(,@06)                                    0355 00752000
         LA    @01,@AL00001                                        0355 00753000
         BALR  @14,@15                                             0355 00754000
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */ 00755000
*        LASTCOND = LASTCC12;                                      0356 00756000
         L     @06,@PC00001+8                                      0356 00757000
         MVC   LASTCOND(2,@06),@CH00265                            0356 00758000
*/*      END-THEN                                                    */ 00759000
*        END;                                                      0357 00760000
*/*  IF NO ERRORS FOUND SO FAR                                       */ 00761000
*    IF LASTCOND < LASTCC12                                        0358 00762000
*/*    THEN                                                          */ 00763000
*      THEN DO;                                                    0358 00764000
*                                                                  0358 00765000
@RF00352 L     @06,@PC00001+8                                      0358 00766000
         LH    @06,LASTCOND(,@06)                                  0358 00767000
         CH    @06,@CH00265                                        0358 00768000
         BNL   @RF00358                                            0358 00769000
*/*      IF UNABLE TO OPEN VOLUME                                    */ 00770000
*        IF RETCODE = NOOPEN                                       0360 00771000
*/*        THEN                                                      */ 00772000
*          THEN DO;                                                0360 00773000
*                                                                  0360 00774000
         CLC   RETCODE(4),@CF00116                                 0360 00775000
         BNE   @RF00360                                            0360 00776000
*/*          ISSUE ERROR MESSAGE (MSGNOPEN) (UPRINT)                 */ 00777000
*            DARGSENT = MSGNOPEN;                                  0362 00778000
         L     @06,DDSTRU                                          0362 00779000
         MVI   DARGSENT(@06),X'19'                                 0362 00780000
*            CALL ICKTPPR0 (GDTTBL                                 0363 00781000
*                   ,PRTFILE                                       0363 00782000
*                   ,DDSTRU);                                      0363 00783000
         L     @06,@PC00001                                        0363 00784000
         ST    @06,@AL00001                                        0363 00785000
         LA    @15,@CF00094                                        0363 00786000
         ST    @15,@AL00001+4                                      0363 00787000
         LA    @15,DDSTRU                                          0363 00788000
         ST    @15,@AL00001+8                                      0363 00789000
         MVI   @AL00001+8,X'80'                                    0363 00790000
         L     @15,GDTPRT(,@06)                                    0363 00791000
         LA    @01,@AL00001                                        0363 00792000
         BALR  @14,@15                                             0363 00793000
*/*          INDICATE SEVERE ERROR (LASTCOND = 12)                   */ 00794000
*            LASTCOND = LASTCC12;                                  0364 00795000
         L     @06,@PC00001+8                                      0364 00796000
         MVC   LASTCOND(2,@06),@CH00265                            0364 00797000
*/*          END-THEN                                                */ 00798000
*            END;                                                  0365 00799000
*/*      END-THEN                                                    */ 00800000
*        END;                                                      0366 00801000
@RF00360 DS    0H                                                  0367 00802000
*/*  IF NO ERRORS FOUND SO FAR                                       */ 00803000
*    IF LASTCOND < LASTCC12                                        0367 00804000
*/*    THEN                                                          */ 00805000
*      THEN DO;                                                    0367 00806000
*                                                                  0367 00807000
@RF00358 L     @06,@PC00001+8                                      0367 00808000
         LH    @06,LASTCOND(,@06)                                  0367 00809000
         CH    @06,@CH00265                                        0367 00810000
         BNL   @RF00367                                            0367 00811000
*/*      IF CUU WAS SPECIFIED FOR AN ON-LINE VOLUME                  */ 00812000
*        IF RETCODE = RCCUUONL                                     0369 00813000
*/*        THEN                                                      */ 00814000
*          THEN DO;                                                0369 00815000
*                                                                  0369 00816000
         CLC   RETCODE(4),@CF00136                                 0369 00817000
         BNE   @RF00369                                            0369 00818000
*/*          ISSUE AN ERROR MESSAGE (MSGLINE)                        */ 00819000
*            DARGSENT = MSGLINE;                                   0371 00820000
         L     @06,DDSTRU                                          0371 00821000
         MVI   DARGSENT(@06),X'31'                                 0371 00822000
*            CALL ICKTPPR0 (GDTTBL                                 0372 00823000
*                   ,PRTFILE                                       0372 00824000
*                   ,DDSTRU);                                      0372 00825000
         L     @06,@PC00001                                        0372 00826000
         ST    @06,@AL00001                                        0372 00827000
         LA    @15,@CF00094                                        0372 00828000
         ST    @15,@AL00001+4                                      0372 00829000
         LA    @15,DDSTRU                                          0372 00830000
         ST    @15,@AL00001+8                                      0372 00831000
         MVI   @AL00001+8,X'80'                                    0372 00832000
         L     @15,GDTPRT(,@06)                                    0372 00833000
         LA    @01,@AL00001                                        0372 00834000
         BALR  @14,@15                                             0372 00835000
*/*          INDICATE A SEVERE ERROR                                 */ 00836000
*            LASTCOND = LASTCC12;                                  0373 00837000
         L     @06,@PC00001+8                                      0373 00838000
         MVC   LASTCOND(2,@06),@CH00265                            0373 00839000
*/*          END-THEN                                                */ 00840000
*            END;                                                  0374 00841000
*/*      END-THEN                                                    */ 00842000
*        END;                                                      0375 00843000
@RF00369 DS    0H                                                  0376 00844000
*/*  IF NO ERRORS FOUND SO FAR                                       */ 00845000
*    IF LASTCOND < LASTCC12                                        0376 00846000
*/*    THEN                                                          */ 00847000
*      THEN DO;                                                    0376 00848000
*                                                                  0376 00849000
@RF00367 L     @06,@PC00001+8                                      0376 00850000
         LH    @06,LASTCOND(,@06)                                  0376 00851000
         CH    @06,@CH00265                                        0376 00852000
         BNL   @RF00376                                            0376 00853000
*/*      IF SUCCESSFUL IN OPENING THE VOLUME                         */ 00854000
*        IF RETCODE = SUCCESS                                      0378 00855000
*/*        THEN                                                      */ 00856000
*          THEN DO;                                                0378 00857000
*                                                                  0378 00858000
         L     @06,RETCODE                                         0378 00859000
         LTR   @06,@06                                             0378 00860000
         BNZ   @RF00378                                            0378 00861000
*/*          OBTAIN INFORMATION ABOUT TYPE OF MOUNTING (UDEVINFO)    */ 00862000
*            CALL ICKDVIN0 (GDTTBL                                 0380 00863000
*                     ,VOLIB                                       0380 00864000
*                     ,VOLPRVOL                                    0380 00865000
*                     ,POOLID                                      0380 00866000
*                     ,VIBPTR                                      0380 00867000
*                     ,VIBLEN                                      0380 00868000
*                     ,RETCODE);                                   0380 00869000
         L     @06,@PC00001                                        0380 00870000
         ST    @06,@AL00001                                        0380 00871000
         LA    @15,VOLIB                                           0380 00872000
         ST    @15,@AL00001+4                                      0380 00873000
         LA    @15,@CF00161                                        0380 00874000
         ST    @15,@AL00001+8                                      0380 00875000
         LA    @15,POOLID                                          0380 00876000
         ST    @15,@AL00001+12                                     0380 00877000
         LA    @15,VIBPTR                                          0380 00878000
         ST    @15,@AL00001+16                                     0380 00879000
         LA    @15,VIBLEN                                          0380 00880000
         ST    @15,@AL00001+20                                     0380 00881000
         LA    @15,RETCODE                                         0380 00882000
         ST    @15,@AL00001+24                                     0380 00883000
         L     @15,GDTDIN(,@06)                                    0380 00884000
         LA    @01,@AL00001                                        0380 00885000
         BALR  @14,@15                                             0380 00886000
*/*          IF THE VOLUME IS NOT MOUNTED PRIVATE AND DD-NAME        */ 00887000
*/*           IS SPECIFIED                                           */ 00888000
*            IF VIBPFLAG = OFF & VIBTYPE = DDNVAL                  0381 00889000
*/*            THEN                                                  */ 00890000
*              THEN DO;                                            0381 00891000
*                                                                  0381 00892000
         L     @06,VIBPTR                                          0381 00893000
         TM    VIBPFLAG(@06),B'10000000'                           0381 00894000
         BNZ   @RF00381                                            0381 00895000
         CLC   VIBTYPE(4),@CF00165                                 0381 00896000
         BNE   @RF00381                                            0381 00897000
*/*              ISSUE ERROR MESSAGE (MSGNPRIV) (UPRINT)             */ 00898000
*                DARGSENT = MSGNPRIV;                              0383 00899000
         L     @06,DDSTRU                                          0383 00900000
         MVI   DARGSENT(@06),X'1A'                                 0383 00901000
*                CALL ICKTPPR0 (GDTTBL                             0384 00902000
*                       ,PRTFILE                                   0384 00903000
*                       ,DDSTRU);                                  0384 00904000
         L     @06,@PC00001                                        0384 00905000
         ST    @06,@AL00001                                        0384 00906000
         LA    @15,@CF00094                                        0384 00907000
         ST    @15,@AL00001+4                                      0384 00908000
         LA    @15,DDSTRU                                          0384 00909000
         ST    @15,@AL00001+8                                      0384 00910000
         MVI   @AL00001+8,X'80'                                    0384 00911000
         L     @15,GDTPRT(,@06)                                    0384 00912000
         LA    @01,@AL00001                                        0384 00913000
         BALR  @14,@15                                             0384 00914000
*/*              INDICATE SEVERE ERROR (LASTCOND = 12)               */ 00915000
*                LASTCOND = LASTCC12;                              0385 00916000
         L     @06,@PC00001+8                                      0385 00917000
         MVC   LASTCOND(2,@06),@CH00265                            0385 00918000
*/*              END-THEN                                            */ 00919000
*                END;                                              0386 00920000
*/*          END-THEN (OPEN WAS SUCCESSFUL)                          */ 00921000
*            END;                                                  0387 00922000
*/*      END-THEN                                                    */ 00923000
*        END;                                                      0388 00924000
*/*  END-SUB-PROCEDURE ISSUE_OPEN_VOLUME                             */ 00925000
*    END OPENVOL;                                                  0389 00926000
@EL00003 DS    0H                                                  0389 00927000
@EF00003 DS    0H                                                  0389 00928000
@ER00003 LM    @14,@12,@SA00003                                    0389 00929000
         BR    @14                                                 0389 00930000
         EJECT                                                          00931000
*/*****  START OF SPECIFICATIONS  ************************************/ 00932000
*/*                                                                  */ 00933000
*/*  SUB-PROCEDURE NAME:  SETTRACK                                   */ 00934000
*/*                                                                  */ 00935000
*/*  DESCRIPTIVE NAME:  SET NUMBER OF TRACKS                         */ 00936000
*/*                                                                  */ 00937000
*/*  FUNCTION:                                                       */ 00938000
*/*                                                                  */ 00939000
*/*    THIS SUB-PROCEDURE OBTAINS THE PERTINENT INFORMATION ABOUT    */ 00940000
*/*    THE VOLUME AND DETERMINES THE ADDRESSES AND VALIDITY OF THE   */ 00941000
*/*    TRACKS THAT ARE TO BE PROCESSED FOR THIS INVOCATION OF THE    */ 00942000
*/*    INSPECT COMMAND.                                              */ 00943000
*/*                                                                  */ 00944000
*/*****  END OF SPECIFICATIONS  **************************************/ 00945000
*                                                                  0390 00946000
*                                                                  0390 00947000
*/*  SUB-PROCEDURE SET_NUMBER_OF_TRACKS                              */ 00948000
*    SETTRACK:                                                     0390 00949000
*      PROCEDURE;                                                  0390 00950000
*                                                                  0390 00951000
SETTRACK STM   @14,@12,@SA00004                                    0390 00952000
*    DECLARE                                                       0391 00953000
*      I1                             FIXED(31),                   0391 00954000
*      I5                             FIXED(31);                   0391 00955000
*                                                                  0391 00956000
*    OLDERID2 = NEWERID2;                                          0392 00957000
         L     @06,@PC00001                                        0392 00958000
         L     @06,GDTTR2(,@06)                                    0392 00959000
         MVC   @TS00001(95),NEWERID2(@06)                          0392 00960000
         MVC   OLDERID2(95,@06),@TS00001                           0392 00961000
*    NEWID2 = 'ITST';                                              0393 00962000
         MVC   NEWID2(4,@06),@CC00860                              0393 00963000
*/*  OBTAIN THE FOLLOWING INFORMATION FROM THE DIT (UDEVINFO):       */ 00964000
*/*   1. THRESHOLD                                                   */ 00965000
*/*   2. NUMBER OF TRACKS PER CYLINDER                               */ 00966000
*/*   3. TOTAL NUMBER OF PRIMARY TRACKS                              */ 00967000
*/*   4. TOTAL NUMBER OF ALTERNATE TRACKS                            */ 00968000
*/*   5. ADDRESS OF THE FIRST ALTERNATE TRACK                        */ 00969000
*/*   6. ADDRESS OF THE LAST ALTERNATE TRACK                         */ 00970000
*/*   7. ADDRESS OF THE LAST PRIMARY TRACK                           */ 00971000
*/*   8. MAXIMUM NUMBER OF POSSIBLE RECORDS ON A TRACK               */ 00972000
*    DO I1 = 1 TO INFOSET;                                         0394 00973000
*                                                                  0394 00974000
         LA    I1,1                                                0394 00975000
@DL00394 DS    0H                                                  0395 00976000
*      CALL ICKDVIN0 (GDTTBL                                       0395 00977000
*               ,VOLIB                                             0395 00978000
*               ,INFOVECT (I1)                                     0395 00979000
*               ,POOLID                                            0395 00980000
*               ,INFOPTR (I1)                                      0395 00981000
*               ,INFOLEN (I1)                                      0395 00982000
*               ,CONDCODE (I1));                                   0395 00983000
         L     @06,@PC00001                                        0395 00984000
         ST    @06,@AL00001                                        0395 00985000
         LA    @02,VOLIB                                           0395 00986000
         ST    @02,@AL00001+4                                      0395 00987000
         LR    @02,I1                                              0395 00988000
         SLA   @02,2                                               0395 00989000
         LA    @02,INFOVECT-4(@02)                                 0395 00990000
         ST    @02,@AL00001+8                                      0395 00991000
         LA    @02,POOLID                                          0395 00992000
         ST    @02,@AL00001+12                                     0395 00993000
         LR    @02,I1                                              0395 00994000
         MH    @02,@CH00265                                        0395 00995000
         LA    @15,INFOPTR-12(@02)                                 0395 00996000
         ST    @15,@AL00001+16                                     0395 00997000
         LA    @15,INFOLEN-12(@02)                                 0395 00998000
         ST    @15,@AL00001+20                                     0395 00999000
         LA    @02,CONDCODE-12(@02)                                0395 01000000
         ST    @02,@AL00001+24                                     0395 01001000
         L     @15,GDTDIN(,@06)                                    0395 01002000
         LA    @01,@AL00001                                        0395 01003000
         BALR  @14,@15                                             0395 01004000
*    END;                                                          0396 01005000
         AL    I1,@CF00165                                         0396 01006000
         CH    I1,@CH00161                                         0396 01007000
         BNH   @DL00394                                            0396 01008000
*/*  READ_VOLUME_LABEL (FOR THE VTOC LOCATION)                       */ 01009000
*    CALL ICKRL01                                                  0397 01010000
*         (GDTTBL                                                  0397 01011000
*         ,VOLIB                                                   0397 01012000
*         ,VOL1P                                                   0397 01013000
*         ,LABELS                                                  0397 01014000
*         ,RETCODE);                                               0397 01015000
         L     @06,@PC00001                                        0397 01016000
         ST    @06,@AL00001                                        0397 01017000
         LA    @06,VOLIB                                           0397 01018000
         ST    @06,@AL00001+4                                      0397 01019000
         LA    @06,VOL1P                                           0397 01020000
         ST    @06,@AL00001+8                                      0397 01021000
         LA    @06,LABELS                                          0397 01022000
         ST    @06,@AL00001+12                                     0397 01023000
         LA    @06,RETCODE                                         0397 01024000
         ST    @06,@AL00001+16                                     0397 01025000
         L     @15,@CV00861                                        0397 01026000
         LA    @01,@AL00001                                        0397 01027000
         BALR  @14,@15                                             0397 01028000
*    RESPECIFY VOL1 BASED (ADDR (VOL1P));                          0398 01029000
*/*  IF UNABLE TO READ THE VOLUME LABEL                              */ 01030000
*    IF RETCODE = NORVOLL                                          0399 01031000
*/*    THEN                                                          */ 01032000
*      THEN DO;                                                    0399 01033000
*                                                                  0399 01034000
         CLC   RETCODE(4),@CF00165                                 0399 01035000
         BNE   @RF00399                                            0399 01036000
*/*      ISSUE ERROR MESSAGE (MSGURVOL) (UPRINT)                     */ 01037000
*        DARGSENT = MSGURVOL;                                      0401 01038000
         L     @06,DDSTRU                                          0401 01039000
         MVI   DARGSENT(@06),X'10'                                 0401 01040000
*        CALL ICKTPPR0 (GDTTBL                                     0402 01041000
*               ,PRTFILE                                           0402 01042000
*               ,DDSTRU);                                          0402 01043000
         L     @06,@PC00001                                        0402 01044000
         ST    @06,@AL00001                                        0402 01045000
         LA    @15,@CF00094                                        0402 01046000
         ST    @15,@AL00001+4                                      0402 01047000
         LA    @15,DDSTRU                                          0402 01048000
         ST    @15,@AL00001+8                                      0402 01049000
         MVI   @AL00001+8,X'80'                                    0402 01050000
         L     @15,GDTPRT(,@06)                                    0402 01051000
         LA    @01,@AL00001                                        0402 01052000
         BALR  @14,@15                                             0402 01053000
*/*      INDICATE A SEVERE ERROR (LASTCOND = 12)                     */ 01054000
*        LASTCOND = LASTCC12;                                      0403 01055000
         L     @06,@PC00001+8                                      0403 01056000
         MVC   LASTCOND(2,@06),@CH00265                            0403 01057000
*/*      END-THEN                                                    */ 01058000
*        END;                                                      0404 01059000
*/*    ELSE SAVE THE VTOC LOCATION                                   */ 01060000
*      ELSE DO;    VTOCLOC = VOL1VTOC (1:4); END;                  0405 01061000
         B     @RC00399                                            0405 01062000
@RF00399 DS    0H                                                  0406 01063000
         LA    @06,VOL1P                                           0406 01064000
         MVC   VTOCLOC(4),VOL1VTOC(@06)                            0406 01065000
*/*  IF NO SEVERE ERRORS ENCOUNTERED (LASTCOND < 12)                 */ 01066000
*    IF LASTCOND < LASTCC12                                        0408 01067000
*/*    THEN                                                          */ 01068000
*      THEN DO;                                                    0408 01069000
*                                                                  0408 01070000
@RC00399 L     @06,@PC00001+8                                      0408 01071000
         LH    @06,LASTCOND(,@06)                                  0408 01072000
         CH    @06,@CH00265                                        0408 01073000
         BNL   @RF00408                                            0408 01074000
*/*      READ FORMAT4 DSCB (FOR VTOC EXTENT, TALCNT, TALPTR)         */ 01075000
*        RECNUM = 1;                                               0410 01076000
         MVC   RECNUM(4),@CF00165                                  0410 01077000
*        CALL ICKDVOP0 (GDTTBL                                     0411 01078000
*               ,VOLIB                                             0411 01079000
*               ,ACTRDN                                            0411 01080000
*               ,VTOCLOC                                           0411 01081000
*               ,RECNUM                                            0411 01082000
*               ,POOLID                                            0411 01083000
*               ,DATAPTR                                           0411 01084000
*               ,DATALEN                                           0411 01085000
*               ,RETCODE);                                         0411 01086000
         L     @06,@PC00001                                        0411 01087000
         ST    @06,@AL00001                                        0411 01088000
         LA    @15,VOLIB                                           0411 01089000
         ST    @15,@AL00001+4                                      0411 01090000
         LA    @15,@CF00265                                        0411 01091000
         ST    @15,@AL00001+8                                      0411 01092000
         LA    @15,VTOCLOC                                         0411 01093000
         ST    @15,@AL00001+12                                     0411 01094000
         LA    @15,RECNUM                                          0411 01095000
         ST    @15,@AL00001+16                                     0411 01096000
         LA    @15,POOLID                                          0411 01097000
         ST    @15,@AL00001+20                                     0411 01098000
         LA    @15,DATAPTR                                         0411 01099000
         ST    @15,@AL00001+24                                     0411 01100000
         LA    @15,DATALEN                                         0411 01101000
         ST    @15,@AL00001+28                                     0411 01102000
         LA    @15,RETCODE                                         0411 01103000
         ST    @15,@AL00001+32                                     0411 01104000
         L     @15,GDTDOP(,@06)                                    0411 01105000
         LA    @01,@AL00001                                        0411 01106000
         BALR  @14,@15                                             0411 01107000
*        F4PTR = DATAPTR;                                          0412 01108000
         MVC   F4PTR(4),DATAPTR                                    0412 01109000
*/*      IF READ OPERATION FAILS                                     */ 01110000
*        IF RETCODE = CPFAILS | RETCODE = NORECFND                 0413 01111000
*/*        THEN                                                      */ 01112000
*          THEN DO;                                                0413 01113000
*                                                                  0413 01114000
         L     @06,RETCODE                                         0413 01115000
         CH    @06,@CH00044                                        0413 01116000
         BE    @RT00413                                            0413 01117000
         CH    @06,@CH00165                                        0413 01118000
         BNE   @RF00413                                            0413 01119000
@RT00413 DS    0H                                                  0414 01120000
*/*          ISSUE ERROR MESSAGE (MSGRDSCB) (UPRINT)                 */ 01121000
*            DARGSENT = MSGRDSCB;                                  0415 01122000
         L     @06,DDSTRU                                          0415 01123000
         MVI   DARGSENT(@06),X'23'                                 0415 01124000
*            DARGCNT = 2;                                          0416 01125000
         LA    @15,2                                               0416 01126000
         STH   @15,DARGCNT(,@06)                                   0416 01127000
*            DARGINS (1) = 1;                                      0417 01128000
         MVC   DARGINS(2,@06),@CH00165                             0417 01129000
*            DARGINL (1) = LENGTH (VTOCLOCC);                      0418 01130000
         STH   @15,DARGINL(,@06)                                   0418 01131000
*            DARGDTM (1) = ADDR (VTOCLOCC);                        0419 01132000
         LA    @14,VTOCLOCC                                        0419 01133000
         ST    @14,DARGDTM(,@06)                                   0419 01134000
*            DARGINS (2) = 2;                                      0420 01135000
         STH   @15,DARGINS+8(,@06)                                 0420 01136000
*            DARGINL (2) = LENGTH (VTOCLOCT);                      0421 01137000
         STH   @15,DARGINL+8(,@06)                                 0421 01138000
*            DARGDTM (2) = ADDR (VTOCLOCT);                        0422 01139000
         LA    @15,VTOCLOCT                                        0422 01140000
         ST    @15,DARGDTM+8(,@06)                                 0422 01141000
*            CALL ICKTPPR0 (GDTTBL                                 0423 01142000
*                   ,PRTFILE                                       0423 01143000
*                   ,DDSTRU);                                      0423 01144000
         L     @06,@PC00001                                        0423 01145000
         ST    @06,@AL00001                                        0423 01146000
         LA    @15,@CF00094                                        0423 01147000
         ST    @15,@AL00001+4                                      0423 01148000
         LA    @15,DDSTRU                                          0423 01149000
         ST    @15,@AL00001+8                                      0423 01150000
         MVI   @AL00001+8,X'80'                                    0423 01151000
         L     @15,GDTPRT(,@06)                                    0423 01152000
         LA    @01,@AL00001                                        0423 01153000
         BALR  @14,@15                                             0423 01154000
*/*          INDICATE A SEVERE ERROR (LASTCOND = 12)                 */ 01155000
*            LASTCOND = LASTCC12;                                  0424 01156000
         L     @06,@PC00001+8                                      0424 01157000
         MVC   LASTCOND(2,@06),@CH00265                            0424 01158000
*/*          END-THEN                                                */ 01159000
*            END;                                                  0425 01160000
*/*        ELSE                                                      */ 01161000
*          ELSE DO;                                                0426 01162000
*                                                                  0426 01163000
         B     @RC00413                                            0426 01164000
@RF00413 DS    0H                                                  0427 01165000
*/*          SAVE THE NUMBER OF AVAILABLE ALTERNATE TRACKS           */ 01166000
*            TALCNT = DS4NOATK;                                    0427 01167000
         L     @06,F4PTR                                           0427 01168000
         MVC   @ZT00002+2(2),DS4NOATK(@06)                         0427 01169000
         L     @15,@ZT00002                                        0427 01170000
         ST    @15,TALCNT                                          0427 01171000
*/*          SAVE THE ADDRESS OF THE NEXT AVAILABLE ALTERNATE TRACK  */ 01172000
*            TALPTR = DS4HCCHH;                                    0428 01173000
         MVC   TALPTR(4),DS4HCCHH(@06)                             0428 01174000
*/*          COMPUTE THE VTOC EXTENT                                 */ 01175000
*            LOWRTA = (VTLOEXC * TRKSPCYL) + VTLOEXT;              0429 01176000
         L     @01,INFOPTR+12                                      0429 01177000
         L     @14,TRKSPCYL(,@01)                                  0429 01178000
         MVC   @ZT00002+2(2),VTLOEXC(@06)                          0429 01179000
         L     @01,@ZT00002                                        0429 01180000
         MR    @00,@14                                             0429 01181000
         MVC   @ZT00002+2(2),VTLOEXT(@06)                          0429 01182000
         AL    @01,@ZT00002                                        0429 01183000
         LR    LOWRTA,@01                                          0429 01184000
*            HIGHRTA = (VTHIEXC * TRKSPCYL) + VTHIEXT;             0430 01185000
         LR    @01,@14                                             0430 01186000
         MVC   @ZT00002+2(2),VTHIEXC(@06)                          0430 01187000
         M     @00,@ZT00002                                        0430 01188000
         MVC   @ZT00002+2(2),VTHIEXT(@06)                          0430 01189000
         AL    @01,@ZT00002                                        0430 01190000
         LR    HIGHRTA,@01                                         0430 01191000
*            VTOCEXT = (HIGHRTA - LOWRTA) + 1;                     0431 01192000
         LR    @06,HIGHRTA                                         0431 01193000
         SLR   @06,LOWRTA                                          0431 01194000
         AL    @06,@CF00165                                        0431 01195000
         ST    @06,VTOCEXT                                         0431 01196000
*/*          CHECK VALIDITY OF THE POINTER TO NEXT AVAILABLE         */ 01197000
*/*           ALTERNATE TRACK (TALPTR) AND THE NUMBER OF AVAILABLE   */ 01198000
*/*           ALTERNATE TRACKS (TALCNT)                              */ 01199000
*            IF (TALPTRC >= FIRSTALC & TALPTRT >= FIRSTALT &       0432 01200000
*             TALPTRC <= FINALTC & TALPTRT <= FINALTT) &           0432 01201000
*             (TALCNT <= TOTALALT & TALCNT >= 0)                   0432 01202000
*              THEN DO;    END;                                    0432 01203000
         L     @06,INFOPTR+48                                      0432 01204000
         CLC   TALPTRC(2),FIRSTALC(@06)                            0432 01205000
         BL    @RF00432                                            0432 01206000
         CLC   TALPTRT(2),FIRSTALT(@06)                            0432 01207000
         BL    @RF00432                                            0432 01208000
         L     @06,INFOPTR+60                                      0432 01209000
         CLC   TALPTRC(2),FINALTC(@06)                             0432 01210000
         BH    @RF00432                                            0432 01211000
         CLC   TALPTRT(2),FINALTT(@06)                             0432 01212000
         BH    @RF00432                                            0432 01213000
         L     @06,INFOPTR+36                                      0432 01214000
         C     @15,TOTALALT(,@06)                                  0432 01215000
         BH    @RF00432                                            0432 01216000
         LTR   @15,@15                                             0432 01217000
         BM    @RF00432                                            0432 01218000
*              ELSE DO;                                            0435 01219000
         B     @RC00432                                            0435 01220000
@RF00432 DS    0H                                                  0436 01221000
*/*              DETERMINE WHETHER MERELY NO MORE ALTERNATES LEFT    */ 01222000
*                IF TALCNT = 0  &  TALPTR = 0                      0436 01223000
*                  THEN DO;   /* NO MORE ALTERNATES                  */ 01224000
         SLR   @06,@06                                             0436 01225000
         C     @06,TALCNT                                          0436 01226000
         BNE   @RF00436                                            0436 01227000
         CL    @06,TALPTR                                          0436 01228000
         BNE   @RF00436                                            0436 01229000
*                    DARGSENT = MSGALTB;                           0438 01230000
         L     @06,DDSTRU                                          0438 01231000
         MVI   DARGSENT(@06),X'12'                                 0438 01232000
*                    LASTCOND = MAX(LASTCOND, LASTCC08);           0439 01233000
         L     @06,@PC00001+8                                      0439 01234000
         LH    @15,LASTCOND(,@06)                                  0439 01235000
         LA    @14,8                                               0439 01236000
         CR    @15,@14                                             0439 01237000
         BNL   *+6                                                      01238000
         LR    @15,@14                                             0439 01239000
         STH   @15,LASTCOND(,@06)                                  0439 01240000
*                    CALL ICKTPPR0 (GDTTBL                         0440 01241000
*                           ,PRTFILE                               0440 01242000
*                           ,DDSTRU);                              0440 01243000
         L     @06,@PC00001                                        0440 01244000
         ST    @06,@AL00001                                        0440 01245000
         LA    @15,@CF00094                                        0440 01246000
         ST    @15,@AL00001+4                                      0440 01247000
         LA    @15,DDSTRU                                          0440 01248000
         ST    @15,@AL00001+8                                      0440 01249000
         MVI   @AL00001+8,X'80'                                    0440 01250000
         L     @15,GDTPRT(,@06)                                    0440 01251000
         LA    @01,@AL00001                                        0440 01252000
         BALR  @14,@15                                             0440 01253000
*                    END;                                          0441 01254000
*                DARGSENT = MSGALTIP;                              0442 01255000
@RF00436 L     @06,DDSTRU                                          0442 01256000
         MVI   DARGSENT(@06),X'14'                                 0442 01257000
*                LASTCOND = LASTCC12;                              0443 01258000
         L     @06,@PC00001+8                                      0443 01259000
         MVC   LASTCOND(2,@06),@CH00265                            0443 01260000
*                CALL ICKTPPR0 (GDTTBL                             0444 01261000
*                       ,PRTFILE                                   0444 01262000
*                       ,DDSTRU);                                  0444 01263000
         L     @06,@PC00001                                        0444 01264000
         ST    @06,@AL00001                                        0444 01265000
         LA    @15,@CF00094                                        0444 01266000
         ST    @15,@AL00001+4                                      0444 01267000
         LA    @15,DDSTRU                                          0444 01268000
         ST    @15,@AL00001+8                                      0444 01269000
         MVI   @AL00001+8,X'80'                                    0444 01270000
         L     @15,GDTPRT(,@06)                                    0444 01271000
         LA    @01,@AL00001                                        0444 01272000
         BALR  @14,@15                                             0444 01273000
*                END;                                              0445 01274000
*/*          END-ELSE                                                */ 01275000
*            END;                                                  0446 01276000
@RC00432 DS    0H                                                  0447 01277000
*/*      END-THEN                                                    */ 01278000
*        END;                                                      0447 01279000
@RC00413 DS    0H                                                  0448 01280000
*/*  IF NO SEVERE ERRORS ENCOUNTERED (LASTCOND <12)                  */ 01281000
*    IF LASTCOND < LASTCC12                                        0448 01282000
*/*    THEN                                                          */ 01283000
*      THEN DO;                                                    0448 01284000
*                                                                  0448 01285000
@RF00408 L     @06,@PC00001+8                                      0448 01286000
         LH    @06,LASTCOND(,@06)                                  0448 01287000
         CH    @06,@CH00265                                        0448 01288000
         BNL   @RF00448                                            0448 01289000
*/*      IF ALLTRACKS IS SPECIFIED                                   */ 01290000
*        IF ADDR (ALLTK) ^= NULLPTR                                0450 01291000
*/*        THEN                                                      */ 01292000
*          THEN DO;                                                0450 01293000
*                                                                  0450 01294000
         L     @06,@PC00001+4                                      0450 01295000
         L     @06,FDTPTR+68(,@06)                                 0450 01296000
         LTR   @06,@06                                             0450 01297000
         BZ    @RF00450                                            0450 01298000
*/*          SET NUMBER OF TRACKS = TOTAL TRACKS ON PACK             */ 01299000
*            TRKNUMB = TOTALPRI + TOTALALT;                        0452 01300000
         L     @06,INFOPTR+24                                      0452 01301000
         L     @01,INFOPTR+36                                      0452 01302000
         L     @06,TOTALPRI(,@06)                                  0452 01303000
         AL    @06,TOTALALT(,@01)                                  0452 01304000
         ST    @06,TRKNUMB                                         0452 01305000
*/*          SET FLAG TO INDICATE THAT ALL THE TRACKS ARE TO BE      */ 01306000
*/*           INSPECTED                                              */ 01307000
*            TRKFLAG = ALLTRKS;                                    0453 01308000
         OI    TRKFLAG,B'10000000'                                 0453 01309000
*/*          END-THEN                                                */ 01310000
*            END;                                                  0454 01311000
*/*        ELSE (DISCRETE TRACKS ARE SPECIFIED)                      */ 01312000
*          ELSE DO;                                                0455 01313000
*                                                                  0455 01314000
         B     @RC00450                                            0455 01315000
@RF00450 DS    0H                                                  0456 01316000
*/*          SET FLAG TO INDICATE DISCRETE NUMBER OF TRACKS          */ 01317000
*/*           WERE SPECIFIED                                         */ 01318000
*            TRKFLAG = DISCRETE;                                   0456 01319000
         NI    TRKFLAG,B'01111111'                                 0456 01320000
*/*          SET UP A RUNNING COUNT OF TRACKS TO BE PROCESSED        */ 01321000
*            TRKCOUNT = TRACKCNT;                                  0457 01322000
         L     @06,@PC00001+4                                      0457 01323000
         L     @06,FDTPTR+52(,@06)                                 0457 01324000
         LH    TRKCOUNT,TRACKCNT(,@06)                             0457 01325000
*/*          INITIALIZE INDEX FOR VECTOR OF TRACK ADDRESSES TO BE    */ 01326000
*/*           PROCESSED                                              */ 01327000
*            J = 0;                                                0458 01328000
         SLR   J,J                                                 0458 01329000
*/*          DO-FOR THE NUMBER OF TRACKS SPECIFIED                   */ 01330000
*            DO I1 = 1 TO TRACKCNT;                                0459 01331000
*                                                                  0459 01332000
         LA    I1,1                                                0459 01333000
         B     @DE00459                                            0459 01334000
@DL00459 DS    0H                                                  0460 01335000
*/*            INCREMENT INDEX FOR VECTOR OF TRACKS TO BE BUILT FOR  */ 01336000
*/*             PROCESSING                                           */ 01337000
*              J = J + 1;                                          0460 01338000
         AL    J,@CF00165                                          0460 01339000
*/*            CONVERT THE TRACK ADDRESS TO BINARY (CCHH)            */ 01340000
*              CALL DCVTPROC (TRACKVAL (I1)                        0461 01341000
*                            ,TRKVECT (J)                          0461 01342000
*                            ,TRKLEGL);                            0461 01343000
         LR    @06,I1                                              0461 01344000
         MH    @06,@CH00246                                        0461 01345000
         L     @05,@PC00001+4                                      0461 01346000
         L     @05,FDTPTR+52(,@05)                                 0461 01347000
         AL    @05,@CF01067                                        0461 01348000
         LA    @06,TRACKVAL-3(@06,@05)                             0461 01349000
         ST    @06,@AL00001                                        0461 01350000
         LR    @06,J                                               0461 01351000
         SLA   @06,2                                               0461 01352000
         LA    @06,TRKVECT-4(@06)                                  0461 01353000
         ST    @06,@AL00001+4                                      0461 01354000
         LA    @06,TRKLEGL                                         0461 01355000
         ST    @06,@AL00001+8                                      0461 01356000
         LA    @01,@AL00001                                        0461 01357000
         BAL   @14,DCVTPROC                                        0461 01358000
*/*            IF TRACK ADDRESS IS LEGAL                             */ 01359000
*              IF TRKLEGL = LEGAL                                  0462 01360000
*/*              THEN                                                */ 01361000
*                THEN DO;                                          0462 01362000
*                                                                  0462 01363000
         TM    TRKLEGL,B'10000000'                                 0462 01364000
         BNO   @RF00462                                            0462 01365000
*/*                IF TRACK ADDRESS IS BEYOND LAST TRACK OF PACK     */ 01366000
*                  IF (TRKVECTC (J) > FINALTC) |                   0464 01367000
*                     (TRKVECTC(J)<=FINPRIC & TRKVECTT(J)>FINPRIT) |    01368000
*                     (TRKVECTC(J)>=FIRSTALC & TRKVECTT(J)>FINALTT)     01369000
*/*                  THEN                                            */ 01370000
*                    THEN DO;                                      0464 01371000
*                                                                  0464 01372000
         LR    @06,J                                               0464 01373000
         SLA   @06,2                                               0464 01374000
         L     @05,INFOPTR+60                                      0464 01375000
         LA    @01,TRKVECTC-4(@06)                                 0464 01376000
         CLC   0(2,@01),FINALTC(@05)                               0464 01377000
         BH    @RT00464                                            0464 01378000
         L     @05,INFOPTR+72                                      0464 01379000
         LA    @01,TRKVECTC-4(@06)                                 0464 01380000
         CLC   0(2,@01),FINPRIC(@05)                               0464 01381000
         BH    @GL00014                                            0464 01382000
         LA    @01,TRKVECTT-4(@06)                                 0464 01383000
         CLC   0(2,@01),FINPRIT(@05)                               0464 01384000
         BH    @RT00464                                            0464 01385000
@GL00014 LR    @06,J                                               0464 01386000
         SLA   @06,2                                               0464 01387000
         L     @05,INFOPTR+48                                      0464 01388000
         LA    @01,TRKVECTC-4(@06)                                 0464 01389000
         CLC   0(2,@01),FIRSTALC(@05)                              0464 01390000
         BL    @RF00464                                            0464 01391000
         L     @05,INFOPTR+60                                      0464 01392000
         LA    @01,TRKVECTT-4(@06)                                 0464 01393000
         CLC   0(2,@01),FINALTT(@05)                               0464 01394000
         BNH   @RF00464                                            0464 01395000
@RT00464 DS    0H                                                  0465 01396000
*/*                    ISSUE ERROR MESSAGE (MSGILLTR) (UPRINT)       */ 01397000
*                      DARGSENT = MSGILLTR;                        0466 01398000
         L     @06,DDSTRU                                          0466 01399000
         MVI   DARGSENT(@06),X'25'                                 0466 01400000
*                      DARGCNT = 1;                                0467 01401000
         LA    @05,1                                               0467 01402000
         STH   @05,DARGCNT(,@06)                                   0467 01403000
*                      DARGINS (1) = 1;                            0468 01404000
         STH   @05,DARGINS(,@06)                                   0468 01405000
*                      DARGINL (1) = LENGTH (TRACKVAL (I1));       0469 01406000
         MVC   DARGINL(2,@06),@CH00260                             0469 01407000
*                      DARGDTM (1) = ADDR (TRACKVAL (I1));         0470 01408000
         LR    @05,I1                                              0470 01409000
         MH    @05,@CH00246                                        0470 01410000
         L     @15,@PC00001+4                                      0470 01411000
         L     @01,FDTPTR+52(,@15)                                 0470 01412000
         AL    @01,@CF01067                                        0470 01413000
         LA    @05,TRACKVAL-3(@05,@01)                             0470 01414000
         ST    @05,DARGDTM(,@06)                                   0470 01415000
*                      CALL ICKTPPR0 (GDTTBL                       0471 01416000
*                             ,PRTFILE                             0471 01417000
*                             ,DDSTRU);                            0471 01418000
         L     @06,@PC00001                                        0471 01419000
         ST    @06,@AL00001                                        0471 01420000
         LA    @05,@CF00094                                        0471 01421000
         ST    @05,@AL00001+4                                      0471 01422000
         LA    @05,DDSTRU                                          0471 01423000
         ST    @05,@AL00001+8                                      0471 01424000
         MVI   @AL00001+8,X'80'                                    0471 01425000
         L     @15,GDTPRT(,@06)                                    0471 01426000
         LA    @01,@AL00001                                        0471 01427000
         BALR  @14,@15                                             0471 01428000
*/*                    INDICATE ERROR (LASTCOND = 8)                 */ 01429000
*                      LASTCOND = MAX(LASTCC08,LASTCOND);          0472 01430000
         L     @06,@PC00001+8                                      0472 01431000
         LH    @05,LASTCOND(,@06)                                  0472 01432000
         LA    @15,8                                               0472 01433000
         CR    @05,@15                                             0472 01434000
         BNL   *+6                                                      01435000
         LR    @05,@15                                             0472 01436000
         STH   @05,LASTCOND(,@06)                                  0472 01437000
*/*                    REDUCE TRACK-COUNT AND VECTOR-INDEX           */ 01438000
*                      TRKCOUNT = TRKCOUNT - 1;                    0473 01439000
         BCTR  TRKCOUNT,0                                          0473 01440000
*                      J = J - 1;                                  0474 01441000
         BCTR  J,0                                                 0474 01442000
*/*                    END-THEN                                      */ 01443000
*                      END;                                        0475 01444000
*/*                IF TRACK ADDRESS IS REPEATED                      */ 01445000
*/*                  THEN ELIMINATE FROM VECTOR OF TRACKS            */ 01446000
*                  DO I5 = 1 TO (J - 1);                           0476 01447000
@RF00464 LA    I5,1                                                0476 01448000
         B     @DE00476                                            0476 01449000
@DL00476 DS    0H                                                  0477 01450000
*                    IF TRKVECT (J) = TRKVECT (I5)                 0477 01451000
*                      THEN DO;                                    0477 01452000
         LR    @06,J                                               0477 01453000
         SLA   @06,2                                               0477 01454000
         LR    @15,I5                                              0477 01455000
         SLA   @15,2                                               0477 01456000
         L     @06,TRKVECT-4(@06)                                  0477 01457000
         CL    @06,TRKVECT-4(@15)                                  0477 01458000
         BNE   @RF00477                                            0477 01459000
*                        TRKCOUNT = TRKCOUNT - 1;                  0479 01460000
         BCTR  TRKCOUNT,0                                          0479 01461000
*                        J = J - 1;                                0480 01462000
         BCTR  J,0                                                 0480 01463000
*                        END;                                      0481 01464000
*                  END;                                            0482 01465000
@RF00477 AL    I5,@CF00165                                         0482 01466000
@DE00476 LR    @06,J                                               0482 01467000
         BCTR  @06,0                                               0482 01468000
         CR    I5,@06                                              0482 01469000
         BNH   @DL00476                                            0482 01470000
*/*                END-THEN (TRACK ADDRESS IS LEGAL)                 */ 01471000
*                  END;                                            0483 01472000
*/*              ELSE (TRACK ADDRESS IS ILLEGAL)                     */ 01473000
*                ELSE DO;                                          0484 01474000
*                                                                  0484 01475000
         B     @RC00462                                            0484 01476000
@RF00462 DS    0H                                                  0485 01477000
*/*                ISSUE ERROR MESSAGE (MSGILLTR) (UPRINT)           */ 01478000
*                  DARGSENT = MSGILLTR;                            0485 01479000
         L     @06,DDSTRU                                          0485 01480000
         MVI   DARGSENT(@06),X'25'                                 0485 01481000
*                  DARGCNT = 1;                                    0486 01482000
         LA    @05,1                                               0486 01483000
         STH   @05,DARGCNT(,@06)                                   0486 01484000
*                  DARGINS (1) = 1;                                0487 01485000
         STH   @05,DARGINS(,@06)                                   0487 01486000
*                  DARGINL (1) = LENGTH (TRACKVAL (I1));           0488 01487000
         MVC   DARGINL(2,@06),@CH00260                             0488 01488000
*                  DARGDTM (1) = ADDR (TRACKVAL (I1));             0489 01489000
         LR    @05,I1                                              0489 01490000
         MH    @05,@CH00246                                        0489 01491000
         L     @15,@PC00001+4                                      0489 01492000
         L     @01,FDTPTR+52(,@15)                                 0489 01493000
         AL    @01,@CF01067                                        0489 01494000
         LA    @05,TRACKVAL-3(@05,@01)                             0489 01495000
         ST    @05,DARGDTM(,@06)                                   0489 01496000
*                  CALL ICKTPPR0 (GDTTBL                           0490 01497000
*                         ,PRTFILE                                 0490 01498000
*                         ,DDSTRU);                                0490 01499000
         L     @06,@PC00001                                        0490 01500000
         ST    @06,@AL00001                                        0490 01501000
         LA    @05,@CF00094                                        0490 01502000
         ST    @05,@AL00001+4                                      0490 01503000
         LA    @05,DDSTRU                                          0490 01504000
         ST    @05,@AL00001+8                                      0490 01505000
         MVI   @AL00001+8,X'80'                                    0490 01506000
         L     @15,GDTPRT(,@06)                                    0490 01507000
         LA    @01,@AL00001                                        0490 01508000
         BALR  @14,@15                                             0490 01509000
*/*                INDICATE ERROR (LASTCOND = 8)                     */ 01510000
*                  LASTCOND = MAX(LASTCC08,LASTCOND);              0491 01511000
         L     @06,@PC00001+8                                      0491 01512000
         LH    @05,LASTCOND(,@06)                                  0491 01513000
         LA    @15,8                                               0491 01514000
         CR    @05,@15                                             0491 01515000
         BNL   *+6                                                      01516000
         LR    @05,@15                                             0491 01517000
         STH   @05,LASTCOND(,@06)                                  0491 01518000
*/*                REDUCE TRACK-COUNT AND VECTOR-INDEX               */ 01519000
*                  TRKCOUNT = TRKCOUNT - 1;                        0492 01520000
         BCTR  TRKCOUNT,0                                          0492 01521000
*                  J = J - 1;                                      0493 01522000
         BCTR  J,0                                                 0493 01523000
*/*                END-ELSE                                          */ 01524000
*                  END;                                            0494 01525000
*/*          END-FOR                                                 */ 01526000
*            END;                                                  0495 01527000
@RC00462 AL    I1,@CF00165                                         0495 01528000
@DE00459 L     @06,@PC00001+4                                      0495 01529000
         L     @06,FDTPTR+52(,@06)                                 0495 01530000
         CH    I1,TRACKCNT(,@06)                                   0495 01531000
         BNH   @DL00459                                            0495 01532000
*/*          IF NO SEVERE ERRORS ENCOUNTERED                         */ 01533000
*            IF LASTCOND < LASTCC12                                0496 01534000
*/*            THEN                                                  */ 01535000
*              THEN DO;                                            0496 01536000
*                                                                  0496 01537000
         L     @06,@PC00001+8                                      0496 01538000
         LH    @06,LASTCOND(,@06)                                  0496 01539000
         CH    @06,@CH00265                                        0496 01540000
         BNL   @RF00496                                            0496 01541000
*/*              IF RUNNING COUNT OF TRACKS TO BE PROCESSED IS ZERO  */ 01542000
*                IF TRKCOUNT = 0                                   0498 01543000
*/*                THEN                                              */ 01544000
*                  THEN DO;                                        0498 01545000
*                                                                  0498 01546000
         LTR   TRKCOUNT,TRKCOUNT                                   0498 01547000
         BNZ   @RF00498                                            0498 01548000
*/*                  ISSUE MESSAGE (MSGNOTRK) (UPRINT)               */ 01549000
*                    DARGSENT = MSGNOTRK;                          0500 01550000
         L     @06,DDSTRU                                          0500 01551000
         MVI   DARGSENT(@06),X'26'                                 0500 01552000
*                    CALL ICKTPPR0 (GDTTBL                         0501 01553000
*                           ,PRTFILE                               0501 01554000
*                           ,DDSTRU);                              0501 01555000
         L     @06,@PC00001                                        0501 01556000
         ST    @06,@AL00001                                        0501 01557000
         LA    @05,@CF00094                                        0501 01558000
         ST    @05,@AL00001+4                                      0501 01559000
         LA    @05,DDSTRU                                          0501 01560000
         ST    @05,@AL00001+8                                      0501 01561000
         MVI   @AL00001+8,X'80'                                    0501 01562000
         L     @15,GDTPRT(,@06)                                    0501 01563000
         LA    @01,@AL00001                                        0501 01564000
         BALR  @14,@15                                             0501 01565000
*/*                  INDICATE A SEVERE ERROR (LASTCOND = 12)         */ 01566000
*                    LASTCOND = LASTCC12;                          0502 01567000
         L     @06,@PC00001+8                                      0502 01568000
         MVC   LASTCOND(2,@06),@CH00265                            0502 01569000
*/*                  END-THEN                                        */ 01570000
*                    END;                                          0503 01571000
*/*              SET NUMBER OF TRACKS TO BE PROCESSED = RUNNING      */ 01572000
*/*               COUNT OF TRACKS                                    */ 01573000
*                TRKNUMB = TRKCOUNT;                               0504 01574000
@RF00498 ST    TRKCOUNT,TRKNUMB                                    0504 01575000
*/*              END-THEN                                            */ 01576000
*                END;                                              0505 01577000
*/*          END-ELSE (DISCRETE NUMBER OF TRACKS SPECIFIED)          */ 01578000
*            END;                                                  0506 01579000
*/*      END-THEN                                                    */ 01580000
*        END;                                                      0507 01581000
*/*  END-SUB-PROCEDURE SET_NUMBER_OF_TRACKS                          */ 01582000
*    END SETTRACK;                                                 0508 01583000
*                                                                  0508 01584000
@EL00004 DS    0H                                                  0508 01585000
@EF00004 DS    0H                                                  0508 01586000
@ER00004 LM    @14,@12,@SA00004                                    0508 01587000
         BR    @14                                                 0508 01588000
         EJECT                                                          01589000
*/*****  START OF SPECIFICATIONS  ************************************/ 01590000
*/*                                                                  */ 01591000
*/*  SUB-PROCEDURE NAME:  INSTRACK                                   */ 01592000
*/*                                                                  */ 01593000
*/*  DESCRIPTIVE NAME:  INSPECT THE TRACKS                           */ 01594000
*/*                                                                  */ 01595000
*/*  FUNCTION:                                                       */ 01596000
*/*                                                                  */ 01597000
*/*    THIS SUB-PROCEDURE WILL INSPECT THE SET OF TRACKS THAT ARE    */ 01598000
*/*    TO BE PROCESSED AS PER USER SPECIFICATIONS. EACH TRACK IS     */ 01599000
*/*    HANDLED SEPARATELY AND THE NECESSARY 'REPAIR' ACTION IS       */ 01600000
*/*    PERFORMED ON IT.                                              */ 01601000
*/*                                                                  */ 01602000
*/*****  END OF SPECIFICATIONS  **************************************/ 01603000
*                                                                  0509 01604000
*                                                                  0509 01605000
*/*  SUB-PROCEDURE INSPECT_THE_TRACKS                                */ 01606000
*    INSTRACK:                                                     0509 01607000
*      PROCEDURE;                                                  0509 01608000
*                                                                  0509 01609000
INSTRACK STM   @14,@12,@SA00005                                    0509 01610000
*    DECLARE                                                       0510 01611000
*      I2                         FIXED(31);                       0510 01612000
*                                                                  0510 01613000
*    OLDERID2 = NEWERID2;                                          0511 01614000
         L     @06,@PC00001                                        0511 01615000
         L     @15,GDTTR2(,@06)                                    0511 01616000
         MVC   @TS00001(95),NEWERID2(@15)                          0511 01617000
         MVC   OLDERID2(95,@15),@TS00001                           0511 01618000
*    NEWID2 = 'ITIN';                                              0512 01619000
*                                                                  0512 01620000
         MVC   NEWID2(4,@15),@CC00869                              0512 01621000
*/*  IF THERE ARE NO AVAILABLE ALTERNATE TRACKS                      */ 01622000
*    IF ALTCOUNT <= 0                                              0513 01623000
*/*    THEN (ASSIGNMENT NOT POSSIBLE)                                */ 01624000
*      THEN DO;                                                    0513 01625000
         L     @15,ALTCOUNT                                        0513 01626000
         LTR   @15,@15                                             0513 01627000
         BP    @RF00513                                            0513 01628000
*/*      INDICATE ASSIGNMENT NOT POSSIBLE                            */ 01629000
*        ALTFLAG = MORENO;                                         0515 01630000
         OI    ALTFLAG,B'10000000'                                 0515 01631000
*/*      ISSUE ERROR MESSAGE                                         */ 01632000
*        DARGSENT = MSGALTB;                                       0516 01633000
         L     @01,DDSTRU                                          0516 01634000
         MVI   DARGSENT(@01),X'12'                                 0516 01635000
*        CALL ICKTPPR0 (GDTTBL                                     0517 01636000
*               ,PRTFILE                                           0517 01637000
*               ,DDSTRU);                                          0517 01638000
         ST    @06,@AL00001                                        0517 01639000
         LA    @15,@CF00094                                        0517 01640000
         ST    @15,@AL00001+4                                      0517 01641000
         LA    @15,DDSTRU                                          0517 01642000
         ST    @15,@AL00001+8                                      0517 01643000
         MVI   @AL00001+8,X'80'                                    0517 01644000
         L     @15,GDTPRT(,@06)                                    0517 01645000
         LA    @01,@AL00001                                        0517 01646000
         BALR  @14,@15                                             0517 01647000
*/*      INDICATE AN ERROR                                           */ 01648000
*        LASTCOND = MAX (LASTCOND,LASTCC08);                       0518 01649000
         L     @06,@PC00001+8                                      0518 01650000
         LH    @15,LASTCOND(,@06)                                  0518 01651000
         LA    @14,8                                               0518 01652000
         CR    @15,@14                                             0518 01653000
         BNL   *+6                                                      01654000
         LR    @15,@14                                             0518 01655000
         STH   @15,LASTCOND(,@06)                                  0518 01656000
*/*      END-THEN                                                    */ 01657000
*        END;                                                      0519 01658000
*/*    ELSE INDICATE ASSIGNMENT POSSIBLE                             */ 01659000
*      ELSE DO;    ALTFLAG = MOREYES; END;                         0520 01660000
         B     @RC00513                                            0520 01661000
@RF00513 DS    0H                                                  0521 01662000
         NI    ALTFLAG,B'01111111'                                 0521 01663000
*/*  INDICATE INITIALLY THAT SPACE HAS NOT BEEN OBTAINED FOR RECORD  */ 01664000
*/*   TABLE                                                          */ 01665000
*    SPACEFLG = SPACENO;                                           0523 01666000
@RC00513 NI    SPACEFLG,B'01111111'                                0523 01667000
*/*  IF ALLTRACKS WAS SPECIFIED                                      */ 01668000
*    IF ADDR(ALLTK) ^= NULLPTR                                     0524 01669000
*/*    THEN SET UP THE CURRENT TRACK ADDRESS AS THE FIRST TRACK      */ 01670000
*/*     ON THE PACK                                                  */ 01671000
*      THEN DO;    CTRADDR = 0; END;                               0524 01672000
         SLR   @06,@06                                             0524 01673000
         L     @15,@PC00001+4                                      0524 01674000
         C     @06,FDTPTR+68(,@15)                                 0524 01675000
         BE    @RF00524                                            0524 01676000
         ST    @06,CTRADDR                                         0526 01677000
*/*    ELSE SET UP THE CURRENT TRACK ADDRESS AS THE FIRST            */ 01678000
*/*     OF THE VECTOR OF TRACK ADDRESSES ALREADY SET UP              */ 01679000
*      ELSE DO;    CTRADDR = TRKVECT(1); END;                      0528 01680000
         B     @RC00524                                            0528 01681000
@RF00524 DS    0H                                                  0529 01682000
         MVC   CTRADDR(4),TRKVECT                                  0529 01683000
*/*  DO-FOR ALL THE TRACKS TO BE PROCESSED                           */ 01684000
*    DO I2 = 1 TO TRKNUMB;                                         0531 01685000
*                                                                  0531 01686000
@RC00524 LA    I2,1                                                0531 01687000
         B     @DE00531                                            0531 01688000
@DL00531 DS    0H                                                  0532 01689000
*/*    IF THIS IS NOT THE FIRST TRACK IN THE LOOP                    */ 01690000
*      IF I2 > 1                                                   0532 01691000
*/*      THEN                                                        */ 01692000
*        THEN DO;                                                  0532 01693000
*                                                                  0532 01694000
         LA    @06,1                                               0532 01695000
         CR    I2,@06                                              0532 01696000
         BNH   @RF00532                                            0532 01697000
*/*        IF ALLTRACKS WAS SPECIFIED                                */ 01698000
*          IF ADDR(ALLTK) ^= NULLPTR                               0534 01699000
*/*          THEN INCREMENT TRACK ADDRESS                            */ 01700000
*            THEN DO;                                              0534 01701000
*                                                                  0534 01702000
         SLR   @03,@03                                             0534 01703000
         L     @15,@PC00001+4                                      0534 01704000
         C     @03,FDTPTR+68(,@15)                                 0534 01705000
         BE    @RF00534                                            0534 01706000
*              IF CTRADDRT = TRKSPCYL - 1                          0536 01707000
*                THEN DO;                                          0536 01708000
*                                                                  0536 01709000
         L     @01,INFOPTR+12                                      0536 01710000
         L     @15,TRKSPCYL(,@01)                                  0536 01711000
         BCTR  @15,0                                               0536 01712000
         MVC   @ZT00002+2(2),CTRADDRT                              0536 01713000
         C     @15,@ZT00002                                        0536 01714000
         BNE   @RF00536                                            0536 01715000
*                  CTRADDRC = CTRADDRC + 1;                        0538 01716000
         MVC   @ZT00002+2(2),CTRADDRC                              0538 01717000
         AL    @06,@ZT00002                                        0538 01718000
         STH   @06,CTRADDRC                                        0538 01719000
*                  CTRADDRT = 0;                                   0539 01720000
         STH   @03,CTRADDRT                                        0539 01721000
*                  END;                                            0540 01722000
*                ELSE DO;    CTRADDRT = CTRADDRT + 1; END;         0541 01723000
         B     @RC00536                                            0541 01724000
@RF00536 DS    0H                                                  0542 01725000
         MVC   @ZT00002+2(2),CTRADDRT                              0542 01726000
         L     @06,@ZT00002                                        0542 01727000
         LA    @06,1(,@06)                                         0542 01728000
         STH   @06,CTRADDRT                                        0542 01729000
*              END;                                                0544 01730000
*/*          ELSE OBTAIN NEXT TRACK ADDRESS FROM VECTOR              */ 01731000
*            ELSE DO;    CTRADDR = TRKVECT (I2); END;              0545 01732000
         B     @RC00534                                            0545 01733000
@RF00534 DS    0H                                                  0546 01734000
         LR    @06,I2                                              0546 01735000
         SLA   @06,2                                               0546 01736000
         L     @06,TRKVECT-4(@06)                                  0546 01737000
         ST    @06,CTRADDR                                         0546 01738000
*/*        END-THEN                                                  */ 01739000
*          END;                                                    0548 01740000
*                                                                  0548 01741000
*                                                                  0548 01742000
@RC00534 DS    0H                                                  0549 01743000
*/*    IF TRACK IS A PRIMARY TRACK                                   */ 01744000
*      IF CTRADDR <= FINPRI                                        0549 01745000
*/*      THEN SET FLAG TO INDICATE A PRIMARY TRACK                   */ 01746000
*        THEN DO;    TRACKTYP = PRITRACK; END;                     0549 01747000
@RF00532 L     @06,INFOPTR+72                                      0549 01748000
         CLC   CTRADDR(4),FINPRI(@06)                              0549 01749000
         BH    @RF00549                                            0549 01750000
         OI    TRACKTYP,B'10000000'                                0551 01751000
*/*      ELSE SET FLAG TO INDICATE AN ALTERNATE TRACK                */ 01752000
*        ELSE DO;    TRACKTYP = ALTTRACK; END;                     0553 01753000
         B     @RC00549                                            0553 01754000
@RF00549 DS    0H                                                  0554 01755000
         NI    TRACKTYP,B'01111111'                                0554 01756000
*/*    INDICATE INITIALLY THAT THE TRACK IS RECOVERABLE              */ 01757000
*      RCVRFLAG = RECOVER;                                         0556 01758000
@RC00549 OI    RCVRFLAG,B'10000000'                                0556 01759000
*/*    INDICATE INITIALLY THAT PROCESSING TO CONTINUE ON THIS TRACK  */ 01760000
*      CNTFLAG = CONTINUE;                                         0557 01761000
         OI    CNTFLAG,B'10000000'                                 0557 01762000
*/*    INDICATE INITIALLY THE TRACK CONTENTS NOT READ                */ 01763000
*      TRKREAD = READNO;                                           0558 01764000
         NI    TRKREAD,B'01111111'                                 0558 01765000
*/*    OBTAIN_TRACK_STATUS                                           */ 01766000
*      CALL OBTTRST (CTRADDR                                       0559 01767000
*                   ,DFLAGC                                        0559 01768000
*                   ,RZCCHH                                        0559 01769000
*                   ,TRACKTYP);                                    0559 01770000
         LA    @06,CTRADDR                                         0559 01771000
         ST    @06,@AL00001                                        0559 01772000
         LA    @06,DFLAGC                                          0559 01773000
         ST    @06,@AL00001+4                                      0559 01774000
         LA    @06,RZCCHH                                          0559 01775000
         ST    @06,@AL00001+8                                      0559 01776000
         LA    @06,TRACKTYP                                        0559 01777000
         ST    @06,@AL00001+12                                     0559 01778000
         LA    @01,@AL00001                                        0559 01779000
         BAL   @14,OBTTRST                                         0559 01780000
*/*    IF NO SEVERE ERRORS FOUND AND TRACK IS RECOVERABLE            */ 01781000
*      IF (LASTCOND < 12) & (RCVRFLAG = RECOVER)                   0560 01782000
*       & (CNTFLAG = CONTINUE)                                     0560 01783000
*/*      THEN                                                        */ 01784000
*        THEN DO;                                                  0560 01785000
*                                                                  0560 01786000
         L     @06,@PC00001+8                                      0560 01787000
         LH    @06,LASTCOND(,@06)                                  0560 01788000
         CH    @06,@CH00265                                        0560 01789000
         BNL   @RF00560                                            0560 01790000
         TM    RCVRFLAG,B'10000000'                                0560 01791000
         BNO   @RF00560                                            0560 01792000
         TM    CNTFLAG,B'10000000'                                 0560 01793000
         BNO   @RF00560                                            0560 01794000
*/*        INDICATE INITIALLY TRACK IS NOT ASSOCIATED                */ 01795000
*          ASSOCFLG = ASSOCNO;                                     0562 01796000
         NI    ASSOCFLG,B'01111111'                                0562 01797000
*/*        CHECK_ASSOCIATION                                         */ 01798000
*          CALL CHASSOC;                                           0563 01799000
         BAL   @14,CHASSOC                                         0563 01800000
*/*        END-THEN                                                  */ 01801000
*          END;                                                    0564 01802000
*/*    IF NO SEVERE ERRORS FOUND AND TRACK IS RECOVERABLE            */ 01803000
*      IF (LASTCOND < 12) & (RCVRFLAG = RECOVER)                   0565 01804000
*       & (CNTFLAG = CONTINUE)                                     0565 01805000
*/*      THEN                                                        */ 01806000
*        THEN DO;                                                  0565 01807000
*                                                                  0565 01808000
@RF00560 L     @06,@PC00001+8                                      0565 01809000
         LH    @06,LASTCOND(,@06)                                  0565 01810000
         CH    @06,@CH00265                                        0565 01811000
         BNL   @RF00565                                            0565 01812000
         TM    RCVRFLAG,B'10000000'                                0565 01813000
         BNO   @RF00565                                            0565 01814000
         TM    CNTFLAG,B'10000000'                                 0565 01815000
         BNO   @RF00565                                            0565 01816000
*/*        IF PRESERVE IS SPECIFIED AND CHECK OR ASSIGN IS SPECIFIED */ 01817000
*          IF ADDR(PRESV) ^= NULLPTR &                             0567 01818000
*           ^ (ADDR(CHECK) = NULLPTR & ADDR(ASSGN) = NULLPTR)      0567 01819000
*/*          THEN                                                    */ 01820000
*            THEN DO;                                              0567 01821000
*                                                                  0567 01822000
         SLR   @06,@06                                             0567 01823000
         L     @03,@PC00001+4                                      0567 01824000
         C     @06,FDTPTR+4(,@03)                                  0567 01825000
         BE    @RF00567                                            0567 01826000
         C     @06,FDTPTR+12(,@03)                                 0567 01827000
         BNE   @RT00567                                            0567 01828000
         C     @06,FDTPTR+56(,@03)                                 0567 01829000
         BE    @RF00567                                            0567 01830000
@RT00567 DS    0H                                                  0568 01831000
*/*            IF DEFECTIVE PRIMARY TRACK THAT IS ASSOCIATED         */ 01832000
*/*             OR A NONDEFECTIVE PRIMARY THAT IS NOT ASSOCIATED     */ 01833000
*              IF TRACKTYP = PRITRACK &                            0569 01834000
*               ((DFLAGC = DEFECTIV & ASSOCFLG = ASSOCYES) |       0569 01835000
*               (DFLAGC = NODEFECT & ASSOCFLG = ASSOCNO))          0569 01836000
*/*              THEN                                                */ 01837000
*                THEN DO;                                          0569 01838000
         TM    TRACKTYP,B'10000000'                                0569 01839000
         BNO   @RF00569                                            0569 01840000
         TM    DFLAGC,B'10000000'                                  0569 01841000
         BNO   @GL00025                                            0569 01842000
         TM    ASSOCFLG,B'10000000'                                0569 01843000
         BO    @RT00569                                            0569 01844000
@GL00025 TM    DFLAGC,B'10000000'                                  0569 01845000
         BNZ   @RF00569                                            0569 01846000
         TM    ASSOCFLG,B'10000000'                                0569 01847000
         BNZ   @RF00569                                            0569 01848000
@RT00569 DS    0H                                                  0570 01849000
*/*                READ_TRACK_CONTENTS                               */ 01850000
*                  CALL REATRACK                                   0571 01851000
*                       (CTRADDR                                   0571 01852000
*                       ,DFLAGC                                    0571 01853000
*                       ,TRKREAD);                                 0571 01854000
         LA    @06,CTRADDR                                         0571 01855000
         ST    @06,@AL00001                                        0571 01856000
         LA    @06,DFLAGC                                          0571 01857000
         ST    @06,@AL00001+4                                      0571 01858000
         LA    @06,TRKREAD                                         0571 01859000
         ST    @06,@AL00001+8                                      0571 01860000
         LA    @01,@AL00001                                        0571 01861000
         BAL   @14,REATRACK                                        0571 01862000
*/*                END-THEN                                          */ 01863000
*                  END;                                            0572 01864000
*/*            IF NON-DEFECTIVE ALTERNATE TRACK THAT IS ASSOCIATED   */ 01865000
*              IF TRACKTYP = ALTTRACK & DFLAGC = NODEFECT          0573 01866000
*               & ASSOCFLG = ASSOCYES                              0573 01867000
*/*              THEN                                                */ 01868000
*                THEN DO;                                          0573 01869000
@RF00569 TM    TRACKTYP,B'10000000'                                0573 01870000
         BNZ   @RF00573                                            0573 01871000
         TM    DFLAGC,B'10000000'                                  0573 01872000
         BNZ   @RF00573                                            0573 01873000
         TM    ASSOCFLG,B'10000000'                                0573 01874000
         BNO   @RF00573                                            0573 01875000
*                  CALL REATRACK                                   0575 01876000
*                       (RZCCHH                                    0575 01877000
*                       ,DFLAGC                                    0575 01878000
*                       ,TRKREAD);                                 0575 01879000
         LA    @06,RZCCHH                                          0575 01880000
         ST    @06,@AL00001                                        0575 01881000
         LA    @06,DFLAGC                                          0575 01882000
         ST    @06,@AL00001+4                                      0575 01883000
         LA    @06,TRKREAD                                         0575 01884000
         ST    @06,@AL00001+8                                      0575 01885000
         LA    @01,@AL00001                                        0575 01886000
         BAL   @14,REATRACK                                        0575 01887000
*/*                END-THEN                                          */ 01888000
*                  END;                                            0576 01889000
*/*            END-THEN                                              */ 01890000
*              END;                                                0577 01891000
@RF00573 DS    0H                                                  0578 01892000
*/*        END-THEN                                                  */ 01893000
*          END;                                                    0578 01894000
@RF00567 DS    0H                                                  0579 01895000
*/*    IF NO SEVERE ERRORS FOUND AND TRACK IS RECOVERABLE            */ 01896000
*      IF (LASTCOND < 12) & (RCVRFLAG = RECOVER)                   0579 01897000
*       & (CNTFLAG = CONTINUE)                                     0579 01898000
*/*      THEN                                                        */ 01899000
*        THEN DO;                                                  0579 01900000
*                                                                  0579 01901000
@RF00565 L     @06,@PC00001+8                                      0579 01902000
         LH    @06,LASTCOND(,@06)                                  0579 01903000
         CH    @06,@CH00265                                        0579 01904000
         BNL   @RF00579                                            0579 01905000
         TM    RCVRFLAG,B'10000000'                                0579 01906000
         BNO   @RF00579                                            0579 01907000
         TM    CNTFLAG,B'10000000'                                 0579 01908000
         BNO   @RF00579                                            0579 01909000
*/*        IF CHECK (N) IS SPECIFIED                                 */ 01910000
*          IF ADDR(CHECK) ^= NULLPTR                               0581 01911000
*/*          THEN                                                    */ 01912000
*            THEN DO;                                              0581 01913000
*                                                                  0581 01914000
         L     @06,@PC00001+4                                      0581 01915000
         L     @06,FDTPTR+12(,@06)                                 0581 01916000
         LTR   @06,@06                                             0581 01917000
         BZ    @RF00581                                            0581 01918000
*/*            VALIDATE_HOME-ADDRESS                                 */ 01919000
*              CALL VALHOME;                                       0583 01920000
         BAL   @14,VALHOME                                         0583 01921000
*/*            IF NO SEVERE ERRORS FOUND AND TRACK IS RECOVERABLE    */ 01922000
*              IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER)     0584 01923000
*               & (CNTFLAG = CONTINUE)                             0584 01924000
*/*              THEN                                                */ 01925000
*                THEN DO;                                          0584 01926000
*                                                                  0584 01927000
         L     @06,@PC00001+8                                      0584 01928000
         LH    @06,LASTCOND(,@06)                                  0584 01929000
         CH    @06,@CH00265                                        0584 01930000
         BNL   @RF00584                                            0584 01931000
         TM    RCVRFLAG,B'10000000'                                0584 01932000
         BNO   @RF00584                                            0584 01933000
         TM    CNTFLAG,B'10000000'                                 0584 01934000
         BNO   @RF00584                                            0584 01935000
*/*                ISSUE_CHECK_TRACK_SURFACE                         */ 01936000
*                  CALL CHEKTRAK;                                  0586 01937000
         BAL   @14,CHEKTRAK                                        0586 01938000
*/*                END-THEN                                          */ 01939000
*                  END;                                            0587 01940000
*/*            IF NO SEVERE ERRORS FOUND AND TRACK IS RECOVERABLE    */ 01941000
*              IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER)     0588 01942000
*               & (CNTFLAG = CONTINUE)                             0588 01943000
*/*              THEN                                                */ 01944000
*                THEN DO;                                          0588 01945000
*                                                                  0588 01946000
@RF00584 L     @06,@PC00001+8                                      0588 01947000
         LH    @06,LASTCOND(,@06)                                  0588 01948000
         CH    @06,@CH00265                                        0588 01949000
         BNL   @RF00588                                            0588 01950000
         TM    RCVRFLAG,B'10000000'                                0588 01951000
         BNO   @RF00588                                            0588 01952000
         TM    CNTFLAG,B'10000000'                                 0588 01953000
         BNO   @RF00588                                            0588 01954000
*/*                IF TRACK CHECKS OUT NON-DEFECTIVE                 */ 01955000
*                  IF TRSTATUS = TSCGOOD                           0590 01956000
*/*                  THEN                                            */ 01957000
*                    THEN DO;                                      0590 01958000
*                                                                  0590 01959000
         TM    TRSTATUS,B'10000000'                                0590 01960000
         BNO   @RF00590                                            0590 01961000
*/*                    IF DEFECT-FLAG IS FOUND TO BE SET             */ 01962000
*                      IF DFLAGC = DEFECTIV                        0592 01963000
*/*                      THEN                                        */ 01964000
*                        THEN DO;                                  0592 01965000
*                                                                  0592 01966000
         TM    DFLAGC,B'10000000'                                  0592 01967000
         BNO   @RF00592                                            0592 01968000
*/*                        IF RECLAIM IS SPECIFIED                   */ 01969000
*                          IF ADDR(RECLA) ^= NULLPTR               0594 01970000
*/*                          THEN                                    */ 01971000
*                            THEN DO;                              0594 01972000
*                                                                  0594 01973000
         L     @06,@PC00001+4                                      0594 01974000
         L     @06,FDTPTR+20(,@06)                                 0594 01975000
         LTR   @06,@06                                             0594 01976000
         BZ    @RF00594                                            0594 01977000
*/*                            IF TRACK IS AN ALTERNATE              */ 01978000
*                              IF TRACKTYP = ALTTRACK              0596 01979000
*/*                              THEN ISSUE_RECLAIM_ALTERNATE_TRACK  */ 01980000
*                                THEN DO;                          0596 01981000
*                                                                  0596 01982000
         TM    TRACKTYP,B'10000000'                                0596 01983000
         BNZ   @RF00596                                            0596 01984000
*                                  CALL RECATRAK;                  0598 01985000
         BAL   @14,RECATRAK                                        0598 01986000
*                                  END;                            0599 01987000
*/*                              ELSE ISSUE_RECLAIM_PRIMARY_TRACK    */ 01988000
*                                ELSE DO;                          0600 01989000
*                                                                  0600 01990000
         B     @RC00596                                            0600 01991000
@RF00596 DS    0H                                                  0601 01992000
*                                  CALL RECPTRAK;                  0601 01993000
         BAL   @14,RECPTRAK                                        0601 01994000
*                                  END;                            0602 01995000
*/*                            END-THEN (RECLAIM IS SPECIFIED)       */ 01996000
*                              END;                                0603 01997000
*/*                          ELSE (NORECLAIM IS SPECIFIED)           */ 01998000
*                            ELSE DO;                              0604 01999000
*                                                                  0604 02000000
         B     @RC00594                                            0604 02001000
@RF00594 DS    0H                                                  0605 02002000
*/*                            ISSUE_BUILD_PACK_MAP (FLAGGED         */ 02003000
*/*                             DEFECTIVE)                           */ 02004000
*                              PACKDEF = DEFECTIV;                 0605 02005000
         OI    PACKDEF,B'10000000'                                 0605 02006000
*                              PACKCHEK = NODEFECT;                0606 02007000
         NI    PACKCHEK,B'01111111'                                0606 02008000
*                              PACKRCVR = RCVRYES;                 0607 02009000
         NI    PACKRCVR,B'01111111'                                0607 02010000
*                              IF TRACKTYP = ALTTRACK              0608 02011000
*                                THEN DO;                          0608 02012000
*                                                                  0608 02013000
         TM    TRACKTYP,B'10000000'                                0608 02014000
         BNZ   @RF00608                                            0608 02015000
*                                  PACKTRK = ALTTRACK;             0610 02016000
         NI    PACKTRK,B'01111111'                                 0610 02017000
*                                  END;                            0611 02018000
*                                ELSE DO;                          0612 02019000
*                                                                  0612 02020000
         B     @RC00608                                            0612 02021000
@RF00608 DS    0H                                                  0613 02022000
*                                  PACKTRK = PRITRACK;             0613 02023000
         OI    PACKTRK,B'10000000'                                 0613 02024000
*                                  END;                            0614 02025000
*                              PACKTRAK = CTRADDR;                 0615 02026000
@RC00608 MVC   PACKTRAK(4),CTRADDR                                 0615 02027000
*                              PACKASC = RZCCHH;                   0616 02028000
         MVC   PACKASC(4),RZCCHH                                   0616 02029000
*                              CALL BILDPACK;                      0617 02030000
         BAL   @14,BILDPACK                                        0617 02031000
*/*                            IF ASSIGN IS SPECIFIED                */ 02032000
*/*                             AND ALTERNATE TRACKS AVAILABLE       */ 02033000
*/*                             AND UNASSOCIATED PRIMARY TRACK       */ 02034000
*                              IF ADDR(ASSGN) ^= NULLPTR &         0618 02035000
*                               ALTFLAG = MOREYES &                0618 02036000
*                               TRACKTYP = PRITRACK &              0618 02037000
*                               ASSOCFLG = ASSOCNO                 0618 02038000
*/*                              THEN (ASSIGNMENT ACCOMPLISHED)      */ 02039000
*                                THEN DO;                          0618 02040000
*                                                                  0618 02041000
         L     @06,@PC00001+4                                      0618 02042000
         L     @06,FDTPTR+56(,@06)                                 0618 02043000
         LTR   @06,@06                                             0618 02044000
         BZ    @RF00618                                            0618 02045000
         TM    ALTFLAG,B'10000000'                                 0618 02046000
         BNZ   @RF00618                                            0618 02047000
         TM    TRACKTYP,B'10000000'                                0618 02048000
         BNO   @RF00618                                            0618 02049000
         TM    ASSOCFLG,B'10000000'                                0618 02050000
         BNZ   @RF00618                                            0618 02051000
*/*                                ISSUE_ASSIGN_ALTERNATE_TRACK      */ 02052000
*                                  CALL ASSGNALT;                  0620 02053000
         BAL   @14,ASSGNALT                                        0620 02054000
*/*                                END-THEN (ASSIGN SPECIFIED)       */ 02055000
*                                  END;                            0621 02056000
*/*                              ELSE (ASSIGNMENT NOT COMPLETE)      */ 02057000
*                                ELSE DO;                          0622 02058000
         B     @RC00618                                            0622 02059000
@RF00618 DS    0H                                                  0623 02060000
*/*                                IF UN-ASSOCIATED PRIMARY TRACK    */ 02061000
*                                  IF TRACKTYP = PRITRACK &        0623 02062000
*                                   ASSOCFLG = ASSOCNO             0623 02063000
*/*                                  THEN                            */ 02064000
*                                    THEN DO;                      0623 02065000
         TM    TRACKTYP,B'10000000'                                0623 02066000
         BNO   @RF00623                                            0623 02067000
         TM    ASSOCFLG,B'10000000'                                0623 02068000
         BNZ   @RF00623                                            0623 02069000
*/*                                    ISSUE_DESCRIPTOR_MESSAGE      */ 02070000
*                                      CALL DESCMESS;              0625 02071000
         BAL   @14,DESCMESS                                        0625 02072000
*/*                                    END-THEN                      */ 02073000
*                                      END;                        0626 02074000
*/*                                IF TRACK CONTENTS WERE READ       */ 02075000
*                                  IF TRKREAD = READYES            0627 02076000
*/*                                  THEN WRITE_TRACK_CONTENTS       */ 02077000
*                                    THEN DO;                      0627 02078000
*                                                                  0627 02079000
@RF00623 TM    TRKREAD,B'10000000'                                 0627 02080000
         BNO   @RF00627                                            0627 02081000
*/*                                    IF ASSOCIATED ALTERNATE       */ 02082000
*                                      IF TRACKTYP = ALTTRACK &    0629 02083000
*                                       ASSOCFLG = ASSOCYES        0629 02084000
*/*                                      THEN                        */ 02085000
*                                        THEN DO;                  0629 02086000
         TM    TRACKTYP,B'10000000'                                0629 02087000
         BNZ   @RF00629                                            0629 02088000
         TM    ASSOCFLG,B'10000000'                                0629 02089000
         BNO   @RF00629                                            0629 02090000
*                                          CALL WRITRACK           0631 02091000
*                                               (RZCCHH);          0631 02092000
         LA    @06,RZCCHH                                          0631 02093000
         ST    @06,@AL00001                                        0631 02094000
         LA    @01,@AL00001                                        0631 02095000
         BAL   @14,WRITRACK                                        0631 02096000
*                                          END;                    0632 02097000
*                                        ELSE DO;                  0633 02098000
         B     @RC00629                                            0633 02099000
@RF00629 DS    0H                                                  0634 02100000
*                                          CALL WRITRACK           0634 02101000
*                                               (CTRADDR);         0634 02102000
         LA    @06,CTRADDR                                         0634 02103000
         ST    @06,@AL00001                                        0634 02104000
         LA    @01,@AL00001                                        0634 02105000
         BAL   @14,WRITRACK                                        0634 02106000
*                                          END;                    0635 02107000
*/*                                    END-THEN                      */ 02108000
*                                      END;                        0636 02109000
*/*                                END-ELSE                          */ 02110000
*                                  END;                            0637 02111000
*/*                            END-ELSE (NORECLAIM SPECIFIED)        */ 02112000
*                              END;                                0638 02113000
*/*                        END-THEN (DEFECT-FLAG IS FOUND TO BE SET) */ 02114000
*                          END;                                    0639 02115000
*/*                      ELSE (DEFECT-FLAG FOUND NOT TO BE SET)      */ 02116000
*                        ELSE DO;                                  0640 02117000
*                                                                  0640 02118000
         B     @RC00592                                            0640 02119000
@RF00592 DS    0H                                                  0641 02120000
*/*                        IF PRIMARY TRACK WITH INVALID R0          */ 02121000
*                          IF TRACKTYP = PRITRACK &                0641 02122000
*                           CTRADDR ^= RZCCHH                      0641 02123000
*/*                          THEN ISSUE_DESCRIPTOR_MESSAGE           */ 02124000
*                            THEN DO;                              0641 02125000
         TM    TRACKTYP,B'10000000'                                0641 02126000
         BNO   @RF00641                                            0641 02127000
         CLC   CTRADDR(4),RZCCHH                                   0641 02128000
         BE    @RF00641                                            0641 02129000
*                              RZACCHHX = 'FFFFFFFF'X;             0643 02130000
         MVC   RZACCHHX(4),@CB00881                                0643 02131000
*                              CALL DESCMESS;                      0644 02132000
         BAL   @14,DESCMESS                                        0644 02133000
*                              END;                                0645 02134000
*/*                        IF TRACK CONTENTS WERE READ               */ 02135000
*                          IF TRKREAD = READYES                    0646 02136000
*/*                          THEN WRITE_TRACK_CONTENTS               */ 02137000
*                            THEN DO;                              0646 02138000
*                                                                  0646 02139000
@RF00641 TM    TRKREAD,B'10000000'                                 0646 02140000
         BNO   @RF00646                                            0646 02141000
*/*                            IF AN ASSOCIATED ALTERNATE TRACK      */ 02142000
*                              IF TRACKTYP = ALTTRACK &            0648 02143000
*                               ASSOCFLG = ASSOCYES                0648 02144000
*/*                              THEN                                */ 02145000
*                                THEN DO;                          0648 02146000
         TM    TRACKTYP,B'10000000'                                0648 02147000
         BNZ   @RF00648                                            0648 02148000
         TM    ASSOCFLG,B'10000000'                                0648 02149000
         BNO   @RF00648                                            0648 02150000
*                                  CALL WRITRACK                   0650 02151000
*                                       (RZCCHH);                  0650 02152000
         LA    @06,RZCCHH                                          0650 02153000
         ST    @06,@AL00001                                        0650 02154000
         LA    @01,@AL00001                                        0650 02155000
         BAL   @14,WRITRACK                                        0650 02156000
*                                  END;                            0651 02157000
*                                ELSE DO;                          0652 02158000
         B     @RC00648                                            0652 02159000
@RF00648 DS    0H                                                  0653 02160000
*                                  CALL WRITRACK                   0653 02161000
*                                       (CTRADDR);                 0653 02162000
         LA    @06,CTRADDR                                         0653 02163000
         ST    @06,@AL00001                                        0653 02164000
         LA    @01,@AL00001                                        0653 02165000
         BAL   @14,WRITRACK                                        0653 02166000
*                                  END;                            0654 02167000
*/*                            END-THEN                              */ 02168000
*                              END;                                0655 02169000
*/*                        END-ELSE                                  */ 02170000
*                          END;                                    0656 02171000
*/*                    END-THEN (TRACK CHECKS OUT NON-DEFECTIVE)     */ 02172000
*                      END;                                        0657 02173000
*/*                  ELSE (TRACK CHECKS OUT DEFECTIVE)               */ 02174000
*                    ELSE DO;                                      0658 02175000
*                                                                  0658 02176000
         B     @RC00590                                            0658 02177000
@RF00590 DS    0H                                                  0659 02178000
*/*                    IF DEFECT-FLAG IS FOUND TO BE SET             */ 02179000
*                      IF DFLAGC = DEFECTIV                        0659 02180000
*/*                      THEN                                        */ 02181000
*                        THEN DO;                                  0659 02182000
*                                                                  0659 02183000
         TM    DFLAGC,B'10000000'                                  0659 02184000
         BNO   @RF00659                                            0659 02185000
*/*                        ISSUE_BUILD_PACK_MAP (FLAGGED DEFECTIVE)  */ 02186000
*                          PACKDEF = DEFECTIV;                     0661 02187000
         OI    PACKDEF,B'10000000'                                 0661 02188000
*                          PACKCHEK = NODEFECT;                    0662 02189000
         NI    PACKCHEK,B'01111111'                                0662 02190000
*                          PACKRCVR = RCVRYES;                     0663 02191000
         NI    PACKRCVR,B'01111111'                                0663 02192000
*                          PACKTRAK = CTRADDR;                     0664 02193000
         MVC   PACKTRAK(4),CTRADDR                                 0664 02194000
*                          PACKASC = RZCCHH;                       0665 02195000
         MVC   PACKASC(4),RZCCHH                                   0665 02196000
*                          IF TRACKTYP = ALTTRACK                  0666 02197000
*                            THEN DO;                              0666 02198000
*                                                                  0666 02199000
         TM    TRACKTYP,B'10000000'                                0666 02200000
         BNZ   @RF00666                                            0666 02201000
*                              PACKTRK = ALTTRACK;                 0668 02202000
         NI    PACKTRK,B'01111111'                                 0668 02203000
*                              END;                                0669 02204000
*                            ELSE DO;                              0670 02205000
*                                                                  0670 02206000
         B     @RC00666                                            0670 02207000
@RF00666 DS    0H                                                  0671 02208000
*                              PACKTRK = PRITRACK;                 0671 02209000
         OI    PACKTRK,B'10000000'                                 0671 02210000
*                              END;                                0672 02211000
*                          CALL BILDPACK;                          0673 02212000
@RC00666 BAL   @14,BILDPACK                                        0673 02213000
*/*                        ISSUE_BUILD_PACK_MAP (FOUND DEFECTIVE)    */ 02214000
*                          PACKDEF = NODEFECT;                     0674 02215000
         NI    PACKDEF,B'01111111'                                 0674 02216000
*                          PACKCHEK = DEFECTIV;                    0675 02217000
         OI    PACKCHEK,B'10000000'                                0675 02218000
*                          CALL BILDPACK;                          0676 02219000
         BAL   @14,BILDPACK                                        0676 02220000
*/*                        IF ASSIGN IS SPECIFIED                    */ 02221000
*/*                         AND ALTERNATES ARE AVAILABLE             */ 02222000
*                          IF ADDR(ASSGN) ^= NULLPTR &             0677 02223000
*                           ALTFLAG = MOREYES &                    0677 02224000
*                           TRACKTYP = PRITRACK &                  0677 02225000
*                           ASSOCFLG = ASSOCNO                     0677 02226000
*/*                          THEN (ASSIGNMENT ACCOMPLISHED)          */ 02227000
*                            THEN DO;                              0677 02228000
*                                                                  0677 02229000
         L     @06,@PC00001+4                                      0677 02230000
         L     @06,FDTPTR+56(,@06)                                 0677 02231000
         LTR   @06,@06                                             0677 02232000
         BZ    @RF00677                                            0677 02233000
         TM    ALTFLAG,B'10000000'                                 0677 02234000
         BNZ   @RF00677                                            0677 02235000
         TM    TRACKTYP,B'10000000'                                0677 02236000
         BNO   @RF00677                                            0677 02237000
         TM    ASSOCFLG,B'10000000'                                0677 02238000
         BNZ   @RF00677                                            0677 02239000
*/*                            ISSUE_ASSIGN_ALTERNATE_TRACK          */ 02240000
*                              CALL ASSGNALT;                      0679 02241000
         BAL   @14,ASSGNALT                                        0679 02242000
*/*                            END-THEN (ASSIGN SPECIFIED)           */ 02243000
*                              END;                                0680 02244000
*/*                          ELSE (ASSIGNMENT NOT COMPLETE)          */ 02245000
*                            ELSE DO;                              0681 02246000
         B     @RC00677                                            0681 02247000
@RF00677 DS    0H                                                  0682 02248000
*/*                            IF UN-ASSOCIATED PRIMARY TRACK        */ 02249000
*                              IF TRACKTYP = PRITRACK &            0682 02250000
*                               ASSOCFLG = ASSOCNO                 0682 02251000
*/*                              THEN                                */ 02252000
*                                THEN DO;                          0682 02253000
         TM    TRACKTYP,B'10000000'                                0682 02254000
         BNO   @RF00682                                            0682 02255000
         TM    ASSOCFLG,B'10000000'                                0682 02256000
         BNZ   @RF00682                                            0682 02257000
*/*                                ISSUE_DESCRIPTOR_MESSAGE          */ 02258000
*                                  CALL DESCMESS;                  0684 02259000
         BAL   @14,DESCMESS                                        0684 02260000
*/*                                END-THEN                          */ 02261000
*                                  END;                            0685 02262000
*/*                            IF TRACK CONTENTS WERE READ           */ 02263000
*                              IF TRKREAD = READYES                0686 02264000
*/*                              THEN WRITE_TRACK_CONTENTS           */ 02265000
*                                THEN DO;                          0686 02266000
*                                                                  0686 02267000
@RF00682 TM    TRKREAD,B'10000000'                                 0686 02268000
         BNO   @RF00686                                            0686 02269000
*/*                                IF AN ASSOCIATED ALTERNATE TRACK  */ 02270000
*                                  IF TRACKTYP = ALTTRACK &        0688 02271000
*                                   ASSOCFLG = ASSOCYES            0688 02272000
*/*                                  THEN                            */ 02273000
*                                    THEN DO;                      0688 02274000
         TM    TRACKTYP,B'10000000'                                0688 02275000
         BNZ   @RF00688                                            0688 02276000
         TM    ASSOCFLG,B'10000000'                                0688 02277000
         BNO   @RF00688                                            0688 02278000
*                                      CALL WRITRACK               0690 02279000
*                                           (RZCCHH);              0690 02280000
         LA    @06,RZCCHH                                          0690 02281000
         ST    @06,@AL00001                                        0690 02282000
         LA    @01,@AL00001                                        0690 02283000
         BAL   @14,WRITRACK                                        0690 02284000
*                                      END;                        0691 02285000
*                                    ELSE DO;                      0692 02286000
         B     @RC00688                                            0692 02287000
@RF00688 DS    0H                                                  0693 02288000
*                                      CALL WRITRACK               0693 02289000
*                                           (CTRADDR);             0693 02290000
         LA    @06,CTRADDR                                         0693 02291000
         ST    @06,@AL00001                                        0693 02292000
         LA    @01,@AL00001                                        0693 02293000
         BAL   @14,WRITRACK                                        0693 02294000
*                                      END;                        0694 02295000
*/*                                END-THEN                          */ 02296000
*                                  END;                            0695 02297000
*/*                            END-ELSE                              */ 02298000
*                              END;                                0696 02299000
*/*                        END-THEN (DEFECT-FLAG FOUND TO BE SET)    */ 02300000
*                          END;                                    0697 02301000
*/*                      ELSE (DEFECT-FLAG FOUND NOT TO BE SET)      */ 02302000
*                        ELSE DO;                                  0698 02303000
*                                                                  0698 02304000
         B     @RC00659                                            0698 02305000
@RF00659 DS    0H                                                  0699 02306000
*/*                        ISSUE_BUILD_PACK_MAP (FOUND DEFECTIVE)    */ 02307000
*                          PACKTRAK = CTRADDR;                     0699 02308000
         MVC   PACKTRAK(4),CTRADDR                                 0699 02309000
*                          PACKASC = RZCCHH;                       0700 02310000
         MVC   PACKASC(4),RZCCHH                                   0700 02311000
*                          PACKDEF = NODEFECT;                     0701 02312000
         NI    PACKDEF,B'01111111'                                 0701 02313000
*                          PACKCHEK = DEFECTIV;                    0702 02314000
         OI    PACKCHEK,B'10000000'                                0702 02315000
*                          PACKRCVR = RCVRYES;                     0703 02316000
         NI    PACKRCVR,B'01111111'                                0703 02317000
*                          IF TRACKTYP = ALTTRACK                  0704 02318000
*                            THEN DO;                              0704 02319000
*                                                                  0704 02320000
         TM    TRACKTYP,B'10000000'                                0704 02321000
         BNZ   @RF00704                                            0704 02322000
*                              PACKTRK = ALTTRACK;                 0706 02323000
         NI    PACKTRK,B'01111111'                                 0706 02324000
*                              END;                                0707 02325000
*                            ELSE DO;                              0708 02326000
*                                                                  0708 02327000
         B     @RC00704                                            0708 02328000
@RF00704 DS    0H                                                  0709 02329000
*                              PACKTRK = PRITRACK;                 0709 02330000
         OI    PACKTRK,B'10000000'                                 0709 02331000
*                              END;                                0710 02332000
*                          CALL BILDPACK;                          0711 02333000
@RC00704 BAL   @14,BILDPACK                                        0711 02334000
*/*                        IF ASSIGN IS SPECIFIED                    */ 02335000
*                          IF ADDR(ASSGN) ^= NULLPTR &             0712 02336000
*                           ALTFLAG = MOREYES                      0712 02337000
*/*                          THEN                                    */ 02338000
*                            THEN DO;                              0712 02339000
*                                                                  0712 02340000
         L     @06,@PC00001+4                                      0712 02341000
         L     @06,FDTPTR+56(,@06)                                 0712 02342000
         LTR   @06,@06                                             0712 02343000
         BZ    @RF00712                                            0712 02344000
         TM    ALTFLAG,B'10000000'                                 0712 02345000
         BNZ   @RF00712                                            0712 02346000
*/*                            ISSUE_MARK_TRACK_DEFECTIVE            */ 02347000
*                              CALL WRIHARZD(CTRADDR,TRACKTYP);    0714 02348000
         LA    @06,CTRADDR                                         0714 02349000
         ST    @06,@AL00001                                        0714 02350000
         LA    @06,TRACKTYP                                        0714 02351000
         ST    @06,@AL00001+4                                      0714 02352000
         LA    @01,@AL00001                                        0714 02353000
         BAL   @14,WRIHARZD                                        0714 02354000
*/*                            IF TRACK IS AN UNASSOCIATED ALTERNATE */ 02355000
*                              IF TRACKTYP = ALTTRACK &            0715 02356000
*                                 ASSOCFLG = ASSOCNO               0715 02357000
*/*                              THEN DECREMENT COUNT OF AVAILABLE   */ 02358000
*/*                               ALTERNATE TRACKS                   */ 02359000
*                                THEN DO;                          0715 02360000
         TM    TRACKTYP,B'10000000'                                0715 02361000
         BNZ   @RF00715                                            0715 02362000
         TM    ASSOCFLG,B'10000000'                                0715 02363000
         BNZ   @RF00715                                            0715 02364000
*                                  ALTCOUNT = ALTCOUNT - 1;        0717 02365000
         L     @06,ALTCOUNT                                        0717 02366000
         BCTR  @06,0                                               0717 02367000
         ST    @06,ALTCOUNT                                        0717 02368000
*                                  TALCNT = TALCNT - 1;            0718 02369000
         L     @06,TALCNT                                          0718 02370000
         BCTR  @06,0                                               0718 02371000
         ST    @06,TALCNT                                          0718 02372000
*                                  END;                            0719 02373000
*/*                            IF NO SEVERE ERRORS FOUND AND         */ 02374000
*/*                             TRACK IS RECOVERABLE                 */ 02375000
*                              IF (LASTCOND < LASTCC12) &          0720 02376000
*                               (RCVRFLAG = RECOVER) &             0720 02377000
*                               (CNTFLAG = CONTINUE)               0720 02378000
*/*                              THEN                                */ 02379000
*                                THEN DO;                          0720 02380000
*                                                                  0720 02381000
@RF00715 L     @06,@PC00001+8                                      0720 02382000
         LH    @06,LASTCOND(,@06)                                  0720 02383000
         CH    @06,@CH00265                                        0720 02384000
         BNL   @RF00720                                            0720 02385000
         TM    RCVRFLAG,B'10000000'                                0720 02386000
         BNO   @RF00720                                            0720 02387000
         TM    CNTFLAG,B'10000000'                                 0720 02388000
         BNO   @RF00720                                            0720 02389000
*/*                                IF TRACK IS AN ALTERNATE          */ 02390000
*                                  IF TRACKTYP = ALTTRACK          0722 02391000
*                                   & ASSOCFLG = ASSOCYES          0722 02392000
*/*                                  THEN                            */ 02393000
*/*                                   ISSUE_RE-ASSIGN_ALTERNATE_TRACK*/ 02394000
*                                    THEN DO;                      0722 02395000
*                                                                  0722 02396000
         TM    TRACKTYP,B'10000000'                                0722 02397000
         BNZ   @RF00722                                            0722 02398000
         TM    ASSOCFLG,B'10000000'                                0722 02399000
         BNO   @RF00722                                            0722 02400000
*                                      CALL RASGNALT;              0724 02401000
         BAL   @14,RASGNALT                                        0724 02402000
*                                      END;                        0725 02403000
*/*                                  ELSE                            */ 02404000
*                                    ELSE DO;                      0726 02405000
*                                                                  0726 02406000
         B     @RC00722                                            0726 02407000
@RF00722 DS    0H                                                  0727 02408000
*/*                                    IF TRACK IS A PRIMARY         */ 02409000
*                                      IF TRACKTYP = PRITRACK      0727 02410000
*/*                                      THEN                        */ 02411000
*                                        THEN DO;                  0727 02412000
         TM    TRACKTYP,B'10000000'                                0727 02413000
         BNO   @RF00727                                            0727 02414000
*/*                                        ISSUE_ASSIGN_ALTERNATE    */ 02415000
*/*                                         _TRACK                   */ 02416000
*                                          CALL ASSGNALT;          0729 02417000
         BAL   @14,ASSGNALT                                        0729 02418000
*/*                                        END-THEN                  */ 02419000
*                                          END;                    0730 02420000
*/*                                    END-ELSE                      */ 02421000
*                                      END;                        0731 02422000
*/*                                END-THEN                          */ 02423000
*                                  END;                            0732 02424000
*/*                            END-THEN (ASSIGN IS SPECIFIED)        */ 02425000
*                              END;                                0733 02426000
*/*                          ELSE (ASSIGNMENT NOT COMPLETE)          */ 02427000
*                            ELSE DO;                              0734 02428000
*                                                                  0734 02429000
         B     @RC00712                                            0734 02430000
@RF00712 DS    0H                                                  0735 02431000
*/*                            IF PRIMARY TRACK WITH INVALID R0      */ 02432000
*                              IF TRACKTYP = PRITRACK &            0735 02433000
*                               CTRADDR ^= RZCCHH                  0735 02434000
*/*                              THEN ISSUE_DESCRIPTOR_MESSAGE       */ 02435000
*                                THEN DO;                          0735 02436000
         TM    TRACKTYP,B'10000000'                                0735 02437000
         BNO   @RF00735                                            0735 02438000
         CLC   CTRADDR(4),RZCCHH                                   0735 02439000
         BE    @RF00735                                            0735 02440000
*                                  RZACCHHX = 'FFFFFFFF'X;         0737 02441000
         MVC   RZACCHHX(4),@CB00881                                0737 02442000
*                                  CALL DESCMESS;                  0738 02443000
         BAL   @14,DESCMESS                                        0738 02444000
*                                  END;                            0739 02445000
*/*                            IF TRACK CONTENTS WERE READ           */ 02446000
*                              IF TRKREAD = READYES                0740 02447000
*/*                              THEN WRITE_TRACK_CONTENTS           */ 02448000
*                                THEN DO;                          0740 02449000
*                                                                  0740 02450000
@RF00735 TM    TRKREAD,B'10000000'                                 0740 02451000
         BNO   @RF00740                                            0740 02452000
*/*                                IF AN ASSOCIATED ALTERNATE TRACK  */ 02453000
*                                  IF TRACKTYP = ALTTRACK &        0742 02454000
*                                   ASSOCFLG = ASSOCYES            0742 02455000
*/*                                  THEN                            */ 02456000
*                                    THEN DO;                      0742 02457000
         TM    TRACKTYP,B'10000000'                                0742 02458000
         BNZ   @RF00742                                            0742 02459000
         TM    ASSOCFLG,B'10000000'                                0742 02460000
         BNO   @RF00742                                            0742 02461000
*                                      CALL WRITRACK               0744 02462000
*                                           (RZCCHH);              0744 02463000
         LA    @06,RZCCHH                                          0744 02464000
         ST    @06,@AL00001                                        0744 02465000
         LA    @01,@AL00001                                        0744 02466000
         BAL   @14,WRITRACK                                        0744 02467000
*                                      END;                        0745 02468000
*                                    ELSE DO;                      0746 02469000
         B     @RC00742                                            0746 02470000
@RF00742 DS    0H                                                  0747 02471000
*                                      CALL WRITRACK               0747 02472000
*                                           (CTRADDR);             0747 02473000
         LA    @06,CTRADDR                                         0747 02474000
         ST    @06,@AL00001                                        0747 02475000
         LA    @01,@AL00001                                        0747 02476000
         BAL   @14,WRITRACK                                        0747 02477000
*                                      END;                        0748 02478000
*/*                                END-THEN                          */ 02479000
*                                  END;                            0749 02480000
*/*                            END-ELSE                              */ 02481000
*                              END;                                0750 02482000
*/*                        END-ELSE (DEFECT-FLAG NOT SET)            */ 02483000
*                          END;                                    0751 02484000
*/*                    END-ELSE (TRACK CHECKS OUT DEFECTIVE)         */ 02485000
*                      END;                                        0752 02486000
*/*                END-THEN (NO SEVERE ERRORS FOUND)                 */ 02487000
*                  END;                                            0753 02488000
*/*            END-THEN (CHECK IS SPECIFIED)                         */ 02489000
*              END;                                                0754 02490000
*/*          ELSE (NOCHECK IS SPECIFIED)                             */ 02491000
*            ELSE DO;                                              0755 02492000
*                                                                  0755 02493000
         B     @RC00581                                            0755 02494000
@RF00581 DS    0H                                                  0756 02495000
*/*            IF DEFECT-FLAG IS FOUND TO BE SET                     */ 02496000
*              IF DFLAGC = DEFECTIV                                0756 02497000
*/*              THEN                                                */ 02498000
*                THEN DO;                                          0756 02499000
*                                                                  0756 02500000
         TM    DFLAGC,B'10000000'                                  0756 02501000
         BNO   @RF00756                                            0756 02502000
*/*                ISSUE_BUILD_PACK_MAP (FLAGGED DEFECTIVE)          */ 02503000
*                  PACKDEF = DEFECTIV;                             0758 02504000
         OI    PACKDEF,B'10000000'                                 0758 02505000
*                  PACKCHEK = NODEFECT;                            0759 02506000
         NI    PACKCHEK,B'01111111'                                0759 02507000
*                  PACKRCVR = RCVRYES;                             0760 02508000
         NI    PACKRCVR,B'01111111'                                0760 02509000
*                  PACKTRAK = CTRADDR;                             0761 02510000
         MVC   PACKTRAK(4),CTRADDR                                 0761 02511000
*                  PACKASC = RZCCHH;                               0762 02512000
         MVC   PACKASC(4),RZCCHH                                   0762 02513000
*                  IF TRACKTYP = ALTTRACK                          0763 02514000
*                    THEN DO;                                      0763 02515000
*                                                                  0763 02516000
         TM    TRACKTYP,B'10000000'                                0763 02517000
         BNZ   @RF00763                                            0763 02518000
*                      PACKTRK = ALTTRACK;                         0765 02519000
         NI    PACKTRK,B'01111111'                                 0765 02520000
*                      END;                                        0766 02521000
*                    ELSE DO;                                      0767 02522000
*                                                                  0767 02523000
         B     @RC00763                                            0767 02524000
@RF00763 DS    0H                                                  0768 02525000
*                      PACKTRK = PRITRACK;                         0768 02526000
         OI    PACKTRK,B'10000000'                                 0768 02527000
*                      END;                                        0769 02528000
*                  CALL BILDPACK;                                  0770 02529000
@RC00763 BAL   @14,BILDPACK                                        0770 02530000
*/*                IF ASSIGN IS SPECIFIED                            */ 02531000
*/*                 (UN-CONDITIONAL ASSIGNMENT)                      */ 02532000
*                  IF ADDR(ASSGN) ^= NULLPTR & ALTFLAG = MOREYES   0771 02533000
*                   & TRACKTYP = PRITRACK                          0771 02534000
*/*                  THEN                                            */ 02535000
*                    THEN DO;                                      0771 02536000
*                                                                  0771 02537000
         L     @06,@PC00001+4                                      0771 02538000
         L     @06,FDTPTR+56(,@06)                                 0771 02539000
         LTR   @06,@06                                             0771 02540000
         BZ    @RF00771                                            0771 02541000
         TM    ALTFLAG,B'10000000'                                 0771 02542000
         BNZ   @RF00771                                            0771 02543000
         TM    TRACKTYP,B'10000000'                                0771 02544000
         BNO   @RF00771                                            0771 02545000
*/*                    VALIDATE_HOME-ADDRESS                         */ 02546000
*                      CALL VALHOME;                               0773 02547000
         BAL   @14,VALHOME                                         0773 02548000
*/*                    IF NO SEVERE ERRORS AND TRACK RECOVERABLE     */ 02549000
*                      IF LASTCOND < LASTCC12 & RCVRFLAG = RECOVER 0774 02550000
*                       & CNTFLAG = CONTINUE                       0774 02551000
*/*                      THEN                                        */ 02552000
*                        THEN DO;                                  0774 02553000
         L     @06,@PC00001+8                                      0774 02554000
         LH    @06,LASTCOND(,@06)                                  0774 02555000
         CH    @06,@CH00265                                        0774 02556000
         BNL   @RF00774                                            0774 02557000
         TM    RCVRFLAG,B'10000000'                                0774 02558000
         BNO   @RF00774                                            0774 02559000
         TM    CNTFLAG,B'10000000'                                 0774 02560000
         BNO   @RF00774                                            0774 02561000
*/*                        IF PRIMARY TRACK ASSOCIATED ALREADY       */ 02562000
*                          IF ASSOCFLG = ASSOCYES                  0776 02563000
*/*                          THEN                                    */ 02564000
*                            THEN DO;                              0776 02565000
         TM    ASSOCFLG,B'10000000'                                0776 02566000
         BNO   @RF00776                                            0776 02567000
*/*                            ISSUE_MARK_TRACK_DEFECTIVE            */ 02568000
*                              CALL WRIHARZD (RZCCHH,ALTTRACK);    0778 02569000
         LA    @06,RZCCHH                                          0778 02570000
         ST    @06,@AL00001                                        0778 02571000
         LA    @06,@CB00468                                        0778 02572000
         ST    @06,@AL00001+4                                      0778 02573000
         LA    @01,@AL00001                                        0778 02574000
         BAL   @14,WRIHARZD                                        0778 02575000
*/*                            END-THEN                              */ 02576000
*                              END;                                0779 02577000
*/*                        IF NO SEVERE ERRORS AND TRACK RECOVERABLE */ 02578000
*                          IF LASTCOND < LASTCC12 &                0780 02579000
*                           RCVRFLAG = RECOVER &                   0780 02580000
*                           CNTFLAG = CONTINUE                     0780 02581000
*/*                          THEN ISSUE_ASSIGN_ALTERNATE_TRACK       */ 02582000
*                            THEN DO;    CALL ASSGNALT; END;       0780 02583000
@RF00776 L     @06,@PC00001+8                                      0780 02584000
         LH    @06,LASTCOND(,@06)                                  0780 02585000
         CH    @06,@CH00265                                        0780 02586000
         BNL   @RF00780                                            0780 02587000
         TM    RCVRFLAG,B'10000000'                                0780 02588000
         BNO   @RF00780                                            0780 02589000
         TM    CNTFLAG,B'10000000'                                 0780 02590000
         BNO   @RF00780                                            0780 02591000
         BAL   @14,ASSGNALT                                        0782 02592000
*/*                        END-THEN                                  */ 02593000
*                          END;                                    0784 02594000
*/*                    END-THEN (ASSIGN SPECIFIED)                   */ 02595000
*                      END;                                        0785 02596000
*/*                  ELSE                                            */ 02597000
*                    ELSE DO;                                      0786 02598000
         B     @RC00771                                            0786 02599000
@RF00771 DS    0H                                                  0787 02600000
*/*                    IF UN-ASSOCIATED PRIMARY TRACK                */ 02601000
*                      IF TRACKTYP = PRITRACK &                    0787 02602000
*                       ASSOCFLG = ASSOCNO                         0787 02603000
*/*                      THEN                                        */ 02604000
*                        THEN DO;                                  0787 02605000
         TM    TRACKTYP,B'10000000'                                0787 02606000
         BNO   @RF00787                                            0787 02607000
         TM    ASSOCFLG,B'10000000'                                0787 02608000
         BNZ   @RF00787                                            0787 02609000
*/*                        ISSUE_DESCRIPTOR_MESSAGE                  */ 02610000
*                          CALL DESCMESS;                          0789 02611000
         BAL   @14,DESCMESS                                        0789 02612000
*/*                        END-THEN                                  */ 02613000
*                          END;                                    0790 02614000
*/*                    IF TRACK CONTENTS WERE READ                   */ 02615000
*                      IF TRKREAD = READYES                        0791 02616000
*/*                      THEN WRITE_TRACK_CONTENTS                   */ 02617000
*                        THEN DO;                                  0791 02618000
*                                                                  0791 02619000
@RF00787 TM    TRKREAD,B'10000000'                                 0791 02620000
         BNO   @RF00791                                            0791 02621000
*/*                        IF AN ASSOCIATED ALTERNATE TRACK          */ 02622000
*                          IF TRACKTYP = ALTTRACK &                0793 02623000
*                           ASSOCFLG = ASSOCYES                    0793 02624000
*/*                          THEN                                    */ 02625000
*                            THEN DO;                              0793 02626000
         TM    TRACKTYP,B'10000000'                                0793 02627000
         BNZ   @RF00793                                            0793 02628000
         TM    ASSOCFLG,B'10000000'                                0793 02629000
         BNO   @RF00793                                            0793 02630000
*                              CALL WRITRACK                       0795 02631000
*                                   (RZCCHH);                      0795 02632000
         LA    @06,RZCCHH                                          0795 02633000
         ST    @06,@AL00001                                        0795 02634000
         LA    @01,@AL00001                                        0795 02635000
         BAL   @14,WRITRACK                                        0795 02636000
*                              END;                                0796 02637000
*                            ELSE DO;                              0797 02638000
         B     @RC00793                                            0797 02639000
@RF00793 DS    0H                                                  0798 02640000
*                              CALL WRITRACK                       0798 02641000
*                                   (CTRADDR);                     0798 02642000
         LA    @06,CTRADDR                                         0798 02643000
         ST    @06,@AL00001                                        0798 02644000
         LA    @01,@AL00001                                        0798 02645000
         BAL   @14,WRITRACK                                        0798 02646000
*                              END;                                0799 02647000
*/*                        END-THEN                                  */ 02648000
*                          END;                                    0800 02649000
*/*                    END-ELSE                                      */ 02650000
*                      END;                                        0801 02651000
*/*                END-THEN (DEFECT-FLAG FOUND TO BE SET)            */ 02652000
*                  END;                                            0802 02653000
*/*              ELSE (DEFECT-FLAG FOUND NOT TO BE SET)              */ 02654000
*                ELSE DO;                                          0803 02655000
*                                                                  0803 02656000
         B     @RC00756                                            0803 02657000
@RF00756 DS    0H                                                  0804 02658000
*/*                IF ASSIGN IS SPECIFIED                            */ 02659000
*/*                 (UN-CONDITIONAL (RE-)ASSIGNMENT)                 */ 02660000
*                  IF ADDR(ASSGN) ^= NULLPTR & ALTFLAG = MOREYES   0804 02661000
*/*                  THEN                                            */ 02662000
*                    THEN DO;                                      0804 02663000
*                                                                  0804 02664000
         L     @06,@PC00001+4                                      0804 02665000
         L     @06,FDTPTR+56(,@06)                                 0804 02666000
         LTR   @06,@06                                             0804 02667000
         BZ    @RF00804                                            0804 02668000
         TM    ALTFLAG,B'10000000'                                 0804 02669000
         BNZ   @RF00804                                            0804 02670000
*/*                    ISSUE_MARK_TRACK_DEFECTIVE                    */ 02671000
*                      CALL WRIHARZD(CTRADDR,TRACKTYP);            0806 02672000
         LA    @06,CTRADDR                                         0806 02673000
         ST    @06,@AL00001                                        0806 02674000
         LA    @06,TRACKTYP                                        0806 02675000
         ST    @06,@AL00001+4                                      0806 02676000
         LA    @01,@AL00001                                        0806 02677000
         BAL   @14,WRIHARZD                                        0806 02678000
*/*                    IF TRACK IS AN UNASSOCIATED ALTERNATE         */ 02679000
*                      IF TRACKTYP = ALTTRACK & ASSOCFLG = ASSOCNO 0807 02680000
*/*                      THEN DECREMENT THE COUNT OF AVAILABLE       */ 02681000
*/*                       ALTERNATE TRACKS                           */ 02682000
*                        THEN DO;                                  0807 02683000
         TM    TRACKTYP,B'10000000'                                0807 02684000
         BNZ   @RF00807                                            0807 02685000
         TM    ASSOCFLG,B'10000000'                                0807 02686000
         BNZ   @RF00807                                            0807 02687000
*                          ALTCOUNT = ALTCOUNT - 1;                0809 02688000
         L     @06,ALTCOUNT                                        0809 02689000
         BCTR  @06,0                                               0809 02690000
         ST    @06,ALTCOUNT                                        0809 02691000
*                          TALCNT = TALCNT - 1;                    0810 02692000
         L     @06,TALCNT                                          0810 02693000
         BCTR  @06,0                                               0810 02694000
         ST    @06,TALCNT                                          0810 02695000
*                          END;                                    0811 02696000
*/*                    IF NO SEVERE ERRORS FOUND AND TRACK IS        */ 02697000
*/*                     FOUND TO BE RECOVERABLE                      */ 02698000
*                      IF (LASTCOND < LASTCC12)                    0812 02699000
*                       & (RCVRFLAG = RECOVER)                     0812 02700000
*                       & (CNTFLAG = CONTINUE)                     0812 02701000
*/*                      THEN                                        */ 02702000
*                        THEN DO;                                  0812 02703000
@RF00807 L     @06,@PC00001+8                                      0812 02704000
         LH    @06,LASTCOND(,@06)                                  0812 02705000
         CH    @06,@CH00265                                        0812 02706000
         BNL   @RF00812                                            0812 02707000
         TM    RCVRFLAG,B'10000000'                                0812 02708000
         BNO   @RF00812                                            0812 02709000
         TM    CNTFLAG,B'10000000'                                 0812 02710000
         BNO   @RF00812                                            0812 02711000
*/*                        IF TRACK IS AN ASSOCIATED ALTERNATE       */ 02712000
*                          IF TRACKTYP = ALTTRACK                  0814 02713000
*                           & ASSOCFLG = ASSOCYES                  0814 02714000
*/*                          THEN ISSUE_RE-ASSIGN_ALTERNATE_TRACK    */ 02715000
*                            THEN DO;                              0814 02716000
*                                                                  0814 02717000
         TM    TRACKTYP,B'10000000'                                0814 02718000
         BNZ   @RF00814                                            0814 02719000
         TM    ASSOCFLG,B'10000000'                                0814 02720000
         BNO   @RF00814                                            0814 02721000
*                              CALL RASGNALT;                      0816 02722000
         BAL   @14,RASGNALT                                        0816 02723000
*                              END;                                0817 02724000
*/*                          ELSE (PRIMARY TRACK)                    */ 02725000
*                            ELSE DO;                              0818 02726000
*                                                                  0818 02727000
         B     @RC00814                                            0818 02728000
@RF00814 DS    0H                                                  0819 02729000
*/*                            IF TRACK IS A PRIMARY TRACK           */ 02730000
*                              IF TRACKTYP = PRITRACK              0819 02731000
*/*                              THEN                                */ 02732000
*                                THEN DO;                          0819 02733000
         TM    TRACKTYP,B'10000000'                                0819 02734000
         BNO   @RF00819                                            0819 02735000
*/*                                ISSUE_ASSIGN_ALTERNATE_TRACK      */ 02736000
*                                  CALL ASSGNALT;                  0821 02737000
         BAL   @14,ASSGNALT                                        0821 02738000
*/*                                END-THEN                          */ 02739000
*                                  END;                            0822 02740000
*/*                            END-ELSE (PRIMARY TRACK)              */ 02741000
*                              END;                                0823 02742000
*/*                        END-THEN                                  */ 02743000
*                          END;                                    0824 02744000
*/*                    END-THEN (ASSIGN IS SPECIFIED)                */ 02745000
*                      END;                                        0825 02746000
*/*                  ELSE (ASSIGNMENT NOT COMPLETE)                  */ 02747000
*                    ELSE DO;                                      0826 02748000
         B     @RC00804                                            0826 02749000
@RF00804 DS    0H                                                  0827 02750000
*/*                    IF PRIMARY TRACK WITH INVALID R0              */ 02751000
*                      IF TRACKTYP = PRITRACK &                    0827 02752000
*                       CTRADDR ^= RZCCHH                          0827 02753000
*/*                      THEN ISSUE_DESCRIPTOR_MESSAGE               */ 02754000
*                        THEN DO;                                  0827 02755000
         TM    TRACKTYP,B'10000000'                                0827 02756000
         BNO   @RF00827                                            0827 02757000
         CLC   CTRADDR(4),RZCCHH                                   0827 02758000
         BE    @RF00827                                            0827 02759000
*                          RZACCHHX = 'FFFFFFFF'X;                 0829 02760000
         MVC   RZACCHHX(4),@CB00881                                0829 02761000
*                          CALL DESCMESS;                          0830 02762000
         BAL   @14,DESCMESS                                        0830 02763000
*                          END;                                    0831 02764000
*/*                    IF TRACK CONTENTS WERE READ                   */ 02765000
*                      IF TRKREAD = READYES                        0832 02766000
*/*                      THEN WRITE_TRACK_CONTENTS                   */ 02767000
*                        THEN DO;                                  0832 02768000
*                                                                  0832 02769000
@RF00827 TM    TRKREAD,B'10000000'                                 0832 02770000
         BNO   @RF00832                                            0832 02771000
*/*                        IF AN ASSOCIATED ALTERNATE TRACK          */ 02772000
*                          IF TRACKTYP = ALTTRACK &                0834 02773000
*                           ASSOCFLG = ASSOCYES                    0834 02774000
*/*                          THEN                                    */ 02775000
*                            THEN DO;                              0834 02776000
         TM    TRACKTYP,B'10000000'                                0834 02777000
         BNZ   @RF00834                                            0834 02778000
         TM    ASSOCFLG,B'10000000'                                0834 02779000
         BNO   @RF00834                                            0834 02780000
*                              CALL WRITRACK                       0836 02781000
*                                   (RZCCHH);                      0836 02782000
         LA    @06,RZCCHH                                          0836 02783000
         ST    @06,@AL00001                                        0836 02784000
         LA    @01,@AL00001                                        0836 02785000
         BAL   @14,WRITRACK                                        0836 02786000
*                              END;                                0837 02787000
*                            ELSE DO;                              0838 02788000
         B     @RC00834                                            0838 02789000
@RF00834 DS    0H                                                  0839 02790000
*                              CALL WRITRACK                       0839 02791000
*                                   (CTRADDR);                     0839 02792000
         LA    @06,CTRADDR                                         0839 02793000
         ST    @06,@AL00001                                        0839 02794000
         LA    @01,@AL00001                                        0839 02795000
         BAL   @14,WRITRACK                                        0839 02796000
*                              END;                                0840 02797000
*/*                        END-THEN                                  */ 02798000
*                          END;                                    0841 02799000
*/*                    END-ELSE                                      */ 02800000
*                      END;                                        0842 02801000
*/*                END-ELSE (DEFECT-FLAG FOUND NOT TO BE SET)        */ 02802000
*                  END;                                            0843 02803000
*/*            END-ELSE (NOCHECK IS SPECIFIED)                       */ 02804000
*              END;                                                0844 02805000
*/*        END-THEN (NO SEVERE ERRORS FOUND)                         */ 02806000
*          END;                                                    0845 02807000
*/*      ELSE                                                        */ 02808000
*        ELSE DO;                                                  0846 02809000
*                                                                  0846 02810000
         B     @RC00579                                            0846 02811000
@RF00579 DS    0H                                                  0847 02812000
*/*        IF A SEVERE ERROR FOUND                                   */ 02813000
*          IF LASTCOND >= LASTCC12                                 0847 02814000
*/*          THEN RETURN                                             */ 02815000
*            THEN DO;    RETURN; END;                              0847 02816000
         L     @06,@PC00001+8                                      0847 02817000
         LH    @06,LASTCOND(,@06)                                  0847 02818000
         CH    @06,@CH00265                                        0847 02819000
         BL    @RF00847                                            0847 02820000
@EL00005 DS    0H                                                  0849 02821000
@EF00005 DS    0H                                                  0849 02822000
@ER00005 LM    @14,@12,@SA00005                                    0849 02823000
         BR    @14                                                 0849 02824000
*/*        END-ELSE                                                  */ 02825000
*          END;                                                    0851 02826000
@RF00847 DS    0H                                                  0852 02827000
*/*  END-FOR (ALL THE TRACKS ARE EXHAUSTED)                          */ 02828000
*    END;                                                          0852 02829000
@RC00579 AL    I2,@CF00165                                         0852 02830000
@DE00531 C     I2,TRKNUMB                                          0852 02831000
         BNH   @DL00531                                            0852 02832000
*/*  END-SUB-PROCEDURE INSPECT_THE_TRACKS                            */ 02833000
*    END INSTRACK;                                                 0853 02834000
*                                                                  0853 02835000
         B     @EL00005                                            0853 02836000
         EJECT                                                          02837000
*/*****  START OF SPECIFICATIONS  ************************************/ 02838000
*/*                                                                  */ 02839000
*/*  SUB-PROCEDURE NAME:  UPDVTOC                                    */ 02840000
*/*                                                                  */ 02841000
*/*  DESCRIPTIVE NAME:  UPDATE VTOC                                  */ 02842000
*/*                                                                  */ 02843000
*/*  FUNCTION:                                                       */ 02844000
*/*                                                                  */ 02845000
*/*    THIS SUB-PROCEDURE WILL UPDATE THE VTOC WITH THE CURRENT      */ 02846000
*/*    VALUES OF THE POINTER TO THE NEXT AVAILABLE ALTERNATE TRACK   */ 02847000
*/*    AND ALSO THE NUMBER OF AVAILABLE ALTERNATE TRACKS.            */ 02848000
*/*                                                                  */ 02849000
*/*****  END OF SPECIFICATIONS  **************************************/ 02850000
*                                                                  0854 02851000
*                                                                  0854 02852000
*/*  SUB-PROCEDURE UPDATE_VTOC                                       */ 02853000
*    UPDVTOC:                                                      0854 02854000
*      PROCEDURE;                                                  0854 02855000
UPDVTOC  STM   @14,@12,@SA00006                                    0854 02856000
*    DCL RETCODE1            FIXED (31);                           0855 02857000
*    OLDERID2 = NEWERID2;                                          0856 02858000
         L     @06,@PC00001                                        0856 02859000
         L     @06,GDTTR2(,@06)                                    0856 02860000
         MVC   @TS00001(95),NEWERID2(@06)                          0856 02861000
         MVC   OLDERID2(95,@06),@TS00001                           0856 02862000
*    NEWID2 = 'ITUV';                                              0857 02863000
         MVC   NEWID2(4,@06),@CC00888                              0857 02864000
*/*  IF NO MORE ALTERNATE TRACKS WERE LEFT                           */ 02865000
*    IF ALTFLAG = MORENO                                           0858 02866000
*/*    THEN ZERO OUT THE FIELDS THAT CONTAIN NUMBER OF AVAILABLE     */ 02867000
*/*     ALTERNATE TRACKS AND POINTER TO THE NEXT AVAILABLE ALTERNATE */ 02868000
*/*     ALTERNATE TRACK                                              */ 02869000
*      THEN DO;                                                    0858 02870000
*                                                                  0858 02871000
         TM    ALTFLAG,B'10000000'                                 0858 02872000
         BNO   @RF00858                                            0858 02873000
*        TALPTR = 0;                                               0860 02874000
         SLR   @06,@06                                             0860 02875000
         ST    @06,TALPTR                                          0860 02876000
*        TALCNT = 0;                                               0861 02877000
         ST    @06,TALCNT                                          0861 02878000
*        END;                                                      0862 02879000
*/*  IF THE CURRENT POINTER TO THE NEXT AVAILABLE ALTERNATE TRACK    */ 02880000
*/*   POINTS BEYOND OR AT AN ALTERNATE TRACK WHOSE POINTER APPEARS   */ 02881000
*/*   IN THE VTOC                                                    */ 02882000
*    IF ALTPTR >= TALPTR & ALTFLAG = MOREYES                       0863 02883000
*/*    THEN UPDATE THE VALUES IN THE VTOC                            */ 02884000
*      THEN DO;                                                    0863 02885000
@RF00858 L     @06,ALTPTR                                          0863 02886000
         CL    @06,TALPTR                                          0863 02887000
         BL    @RF00863                                            0863 02888000
         TM    ALTFLAG,B'10000000'                                 0863 02889000
         BNZ   @RF00863                                            0863 02890000
*        TALPTR = ALTPTR;                                          0865 02891000
         ST    @06,TALPTR                                          0865 02892000
*        END;                                                      0866 02893000
*/*  IF THE NUMBER OF AVAILABLE ALTERNATE TRACKS IS LESSER THAN VTOC */ 02894000
*/*   VALUE                                                          */ 02895000
*    IF ALTCOUNT < TALCNT                                          0867 02896000
*/*    THEN UPDATE THE VTOC VALUE                                    */ 02897000
*      THEN DO;    TALCNT = ALTCOUNT; END;                         0867 02898000
@RF00863 L     @06,ALTCOUNT                                        0867 02899000
         C     @06,TALCNT                                          0867 02900000
         BNL   @RF00867                                            0867 02901000
         ST    @06,TALCNT                                          0869 02902000
*/*  SET THE NUMBER OF AVAILABLE ALTERNATE TRACKS                    */ 02903000
*    DS4NOATK = TALCNT;                                            0871 02904000
@RF00867 L     @06,F4PTR                                           0871 02905000
         MVC   DS4NOATK(2,@06),TALCNT+2                            0871 02906000
*/*  SET THE ADDRESS OF THE NEXT AVAILABLE ALTERNATE TRACK           */ 02907000
*    DS4HCCHH = TALPTR;                                            0872 02908000
         MVC   DS4HCCHH(4,@06),TALPTR                              0872 02909000
*/*  WRITE FORMAT4 DSCB (WITH THE UPDATED VALUES OF TALPTR,TALCNT)   */ 02910000
*    RECNUM = 1;                                                   0873 02911000
         MVC   RECNUM(4),@CF00165                                  0873 02912000
*    CALL ICKDVOP0 (GDTTBL                                         0874 02913000
*           ,VOLIB                                                 0874 02914000
*           ,ACTWDN                                                0874 02915000
*           ,VTOCLOC                                               0874 02916000
*           ,RECNUM                                                0874 02917000
*           ,POOLID                                                0874 02918000
*           ,F4PTR                                                 0874 02919000
*           ,LENGTH(FOR4DSCB)                                      0874 02920000
*           ,RETCODE1);                                            0874 02921000
         L     @06,@PC00001                                        0874 02922000
         ST    @06,@AL00001                                        0874 02923000
         LA    @15,VOLIB                                           0874 02924000
         ST    @15,@AL00001+4                                      0874 02925000
         LA    @15,@CF00298                                        0874 02926000
         ST    @15,@AL00001+8                                      0874 02927000
         LA    @15,VTOCLOC                                         0874 02928000
         ST    @15,@AL00001+12                                     0874 02929000
         LA    @15,RECNUM                                          0874 02930000
         ST    @15,@AL00001+16                                     0874 02931000
         LA    @15,POOLID                                          0874 02932000
         ST    @15,@AL00001+20                                     0874 02933000
         LA    @15,F4PTR                                           0874 02934000
         ST    @15,@AL00001+24                                     0874 02935000
         LA    @15,@CF00488                                        0874 02936000
         ST    @15,@AL00001+28                                     0874 02937000
         LA    @15,RETCODE1                                        0874 02938000
         ST    @15,@AL00001+32                                     0874 02939000
         L     @15,GDTDOP(,@06)                                    0874 02940000
         LA    @01,@AL00001                                        0874 02941000
         BALR  @14,@15                                             0874 02942000
*/*  IF WRITE OPERATION FAILS                                        */ 02943000
*    IF RETCODE1 = CPFAILS                                         0875 02944000
*/*    THEN                                                          */ 02945000
*      THEN DO;                                                    0875 02946000
*                                                                  0875 02947000
         CLC   RETCODE1(4),@CF00044                                0875 02948000
         BNE   @RF00875                                            0875 02949000
*/*      ISSUE ERROR MESSAGE (MSGWDSCB) (UPRINT)                     */ 02950000
*        DARGSENT = MSGWDSCB;                                      0877 02951000
         L     @06,DDSTRU                                          0877 02952000
         MVI   DARGSENT(@06),X'2E'                                 0877 02953000
*        DARGCNT = 2;                                              0878 02954000
         LA    @15,2                                               0878 02955000
         STH   @15,DARGCNT(,@06)                                   0878 02956000
*        DARGINS (1) = 1;                                          0879 02957000
         MVC   DARGINS(2,@06),@CH00165                             0879 02958000
*        DARGINL (1) = LENGTH (VTOCLOCC);                          0880 02959000
         STH   @15,DARGINL(,@06)                                   0880 02960000
*        DARGDTM (1) = ADDR (VTOCLOCC);                            0881 02961000
         LA    @14,VTOCLOCC                                        0881 02962000
         ST    @14,DARGDTM(,@06)                                   0881 02963000
*        DARGINS (2) = 2;                                          0882 02964000
         STH   @15,DARGINS+8(,@06)                                 0882 02965000
*        DARGINL (2) = LENGTH (VTOCLOCT);                          0883 02966000
         STH   @15,DARGINL+8(,@06)                                 0883 02967000
*        DARGDTM (2) = ADDR (VTOCLOCT);                            0884 02968000
         LA    @15,VTOCLOCT                                        0884 02969000
         ST    @15,DARGDTM+8(,@06)                                 0884 02970000
*        CALL ICKTPPR0 (GDTTBL                                     0885 02971000
*               ,PRTFILE                                           0885 02972000
*               ,DDSTRU);                                          0885 02973000
         L     @06,@PC00001                                        0885 02974000
         ST    @06,@AL00001                                        0885 02975000
         LA    @15,@CF00094                                        0885 02976000
         ST    @15,@AL00001+4                                      0885 02977000
         LA    @15,DDSTRU                                          0885 02978000
         ST    @15,@AL00001+8                                      0885 02979000
         MVI   @AL00001+8,X'80'                                    0885 02980000
         L     @15,GDTPRT(,@06)                                    0885 02981000
         LA    @01,@AL00001                                        0885 02982000
         BALR  @14,@15                                             0885 02983000
*/*      INDICATE A SEVERE ERROR (LASTCOND = 12)                     */ 02984000
*        LASTCOND = LASTCC12;                                      0886 02985000
         L     @06,@PC00001+8                                      0886 02986000
         MVC   LASTCOND(2,@06),@CH00265                            0886 02987000
*/*      END-THEN                                                    */ 02988000
*        END;                                                      0887 02989000
*/*  END-SUB-PROCEDURE UPDATE_VTOC                                   */ 02990000
*    END UPDVTOC;                                                  0888 02991000
*                                                                  0888 02992000
*                                                                  0888 02993000
@EL00006 DS    0H                                                  0888 02994000
@EF00006 DS    0H                                                  0888 02995000
@ER00006 LM    @14,@12,@SA00006                                    0888 02996000
         BR    @14                                                 0888 02997000
         EJECT                                                          02998000
*/*****  START OF SPECIFICATIONS  ************************************/ 02999000
*/*                                                                  */ 03000000
*/*  SUB-PROCEDURE NAME:  REATRACK                                   */ 03001000
*/*                                                                  */ 03002000
*/*  DESCRIPTIVE NAME:  READ TRACK CONTENTS                          */ 03003000
*/*                                                                  */ 03004000
*/*  FUNCTION:                                                       */ 03005000
*/*                                                                  */ 03006000
*/*    THIS SUB-PROCEDURE ISSUES SEVERAL CALLS TO THE DEVICE         */ 03007000
*/*    OPERATIONS FACILITY (UDEVOP) IN ORDER TO READ ALL THE         */ 03008000
*/*    RECORDS FROM THE TRACK. THESE RECORDS ARE PRESERVED IN        */ 03009000
*/*    MAIN STORAGE. IF AN ERROR IS ENCOUNTERED IN READING ANY       */ 03010000
*/*    RECORD THE READING PROCESS IS TERMINATED AND A SEVERE ERROR   */ 03011000
*/*    IS INDICATED.                                                 */ 03012000
*/*                                                                  */ 03013000
*/*****  END OF SPECIFICATIONS  **************************************/ 03014000
*                                                                  0889 03015000
*                                                                  0889 03016000
*/*  SUB-PROCEDURE READ_TRACK_CONTENTS                               */ 03017000
*    REATRACK:                                                     0889 03018000
*      PROCEDURE                                                   0889 03019000
*        (                                                         0889 03020000
*        RTRADDR,                                                  0889 03021000
*        DFLAG1,                                                   0889 03022000
*        STATE                                                     0889 03023000
*        );                                                        0889 03024000
REATRACK STM   @14,@12,@SA00007                                    0889 03025000
         MVC   @PC00007(12),0(@01)                                 0889 03026000
*    OLDERID2 = NEWERID2;                                          0890 03027000
         L     @06,@PC00001                                        0890 03028000
         L     @15,GDTTR2(,@06)                                    0890 03029000
         MVC   @TS00001(95),NEWERID2(@15)                          0890 03030000
         MVC   OLDERID2(95,@15),@TS00001                           0890 03031000
*    NEWID2 = 'ITRE';                                              0891 03032000
*                                                                  0891 03033000
         MVC   NEWID2(4,@15),@CC00898                              0891 03034000
*    DECLARE  /********  LOCAL PARAMETERS  ***************************/ 03035000
*                                                                  0892 03036000
*      IREAD                 FIXED(31),                            0892 03037000
*                                                                  0892 03038000
*      1 RTRADDR,            /* ADDRESS OF TRACK TO BE READ          */ 03039000
*                                                                  0892 03040000
*        2 RTRADDRC          /* CYLINDER NUMBER                      */ 03041000
*                            FIXED (16),                           0892 03042000
*                                                                  0892 03043000
*        2 RTRADDRT          /* TRACK NUMBER                         */ 03044000
*                            FIXED (16),                           0892 03045000
*                                                                  0892 03046000
*      DFLAG1                 /* DEFECT-FLAG INDICATOR               */ 03047000
*                            /* DEFECTIV: DEFECT-FLAG SET            */ 03048000
*                            /* NODEFECT: DEFECT-FLAG NOT SET        */ 03049000
*                            BIT (1),                              0892 03050000
*                                                                  0892 03051000
*      RETCODE2              /* RETURN CODE FROM CALLED PROGRAMS     */ 03052000
*                            FIXED (31),                           0892 03053000
*                                                                  0892 03054000
*      STATE                 /* FLAG TO INDICATE IF THE TRACK        */ 03055000
*                            /* CONTENTS WERE READ OR NOT.           */ 03056000
*                            /* READYES: CONTENTS WERE READ          */ 03057000
*                            /* READNO: CONTENTS WERE NOT READ       */ 03058000
*                            BIT (1);                              0892 03059000
*                                                                  0892 03060000
*/*  IF SPACE HAS NOT BEEN OBTAINED FOR A RECORD TABLE               */ 03061000
*    IF SPACEFLG = SPACENO                                         0893 03062000
*/*    THEN                                                          */ 03063000
*      THEN DO;                                                    0893 03064000
*                                                                  0893 03065000
         TM    SPACEFLG,B'10000000'                                0893 03066000
         BNZ   @RF00893                                            0893 03067000
*/*      COMPUTE THE LENGTH OF THE TABLE TO HOLD THE POINTERS TO THE */ 03068000
*/*      RECORDS READ FROM A TRACK                                   */ 03069000
*        RTABLEN = RTABLENS * MAXREC;                              0895 03070000
         L     @03,INFOPTR+84                                      0895 03071000
         L     @03,MAXREC(,@03)                                    0895 03072000
         MH    @03,@CH00265                                        0895 03073000
         ST    @03,RTABLEN                                         0895 03074000
*/*      GET STORAGE FOR THE TABLE THAT WILL HOLD THE POINTERS TO THE*/ 03075000
*/*       RECORDS AS THEY ARE READ INTO MAIN STORAGE                 */ 03076000
*        CALL ICKSAGP0 (GDTTBL                                     0896 03077000
*               ,RTABLEN                                           0896 03078000
*               ,RECPTR                                            0896 03079000
*               ,POOLID                                            0896 03080000
*               ,SETZERO);                                         0896 03081000
         ST    @06,@AL00001                                        0896 03082000
         LA    @03,RTABLEN                                         0896 03083000
         ST    @03,@AL00001+4                                      0896 03084000
         LA    @03,RECPTR                                          0896 03085000
         ST    @03,@AL00001+8                                      0896 03086000
         LA    @03,POOLID                                          0896 03087000
         ST    @03,@AL00001+12                                     0896 03088000
         LA    @03,@CC00145                                        0896 03089000
         ST    @03,@AL00001+16                                     0896 03090000
         MVI   @AL00001+16,X'80'                                   0896 03091000
         L     @15,GDTGPL(,@06)                                    0896 03092000
         LA    @01,@AL00001                                        0896 03093000
         BALR  @14,@15                                             0896 03094000
*        RESPECIFY RTNREG RSTD;                                    0897 03095000
*        TESTRC = RTNREG;                                          0898 03096000
         LR    TESTRC,RTNREG                                       0898 03097000
*        RESPECIFY RTNREG UNRSTD;                                  0899 03098000
*/*      IF UNABLE TO OBTAIN STORAGE                                 */ 03099000
*        IF TESTRC = 4                                             0900 03100000
*/*        THEN                                                      */ 03101000
*          THEN DO;                                                0900 03102000
*                                                                  0900 03103000
         CH    TESTRC,@CH00044                                     0900 03104000
         BNE   @RF00900                                            0900 03105000
*/*          ISSUE AN ERROR MESSAGE (MSGRTNOS) (UPRINT)              */ 03106000
*            DARGSENT = MSGRTNOS;                                  0902 03107000
         L     @06,DDSTRU                                          0902 03108000
         MVI   DARGSENT(@06),X'2B'                                 0902 03109000
*            CALL ICKTPPR0 (GDTTBL                                 0903 03110000
*                   ,PRTFILE                                       0903 03111000
*                   ,DDSTRU);                                      0903 03112000
         L     @06,@PC00001                                        0903 03113000
         ST    @06,@AL00001                                        0903 03114000
         LA    @15,@CF00094                                        0903 03115000
         ST    @15,@AL00001+4                                      0903 03116000
         LA    @15,DDSTRU                                          0903 03117000
         ST    @15,@AL00001+8                                      0903 03118000
         MVI   @AL00001+8,X'80'                                    0903 03119000
         L     @15,GDTPRT(,@06)                                    0903 03120000
         LA    @01,@AL00001                                        0903 03121000
         BALR  @14,@15                                             0903 03122000
*/*          INDICATE A SEVERE ERROR                                 */ 03123000
*            LASTCOND = LASTCC12;                                  0904 03124000
         L     @06,@PC00001+8                                      0904 03125000
         MVC   LASTCOND(2,@06),@CH00265                            0904 03126000
*/*          END-THEN                                                */ 03127000
*            END;                                                  0905 03128000
*/*        ELSE INDICATE THAT THE SPACE HAS BEEN OBTAINED            */ 03129000
*          ELSE DO;    SPACEFLG = SPACEYES; END;                   0906 03130000
         B     @RC00900                                            0906 03131000
@RF00900 DS    0H                                                  0907 03132000
         OI    SPACEFLG,B'10000000'                                0907 03133000
*/*      END-THEN                                                    */ 03134000
*        END;                                                      0909 03135000
@RC00900 DS    0H                                                  0910 03136000
*/*  IF NO SEVERE ERRORS                                             */ 03137000
*    IF LASTCOND < LASTCC12                                        0910 03138000
*/*    THEN                                                          */ 03139000
*      THEN DO;                                                    0910 03140000
*                                                                  0910 03141000
@RF00893 L     @06,@PC00001+8                                      0910 03142000
         LH    @06,LASTCOND(,@06)                                  0910 03143000
         CH    @06,@CH00265                                        0910 03144000
         BNL   @RF00910                                            0910 03145000
*/*      INITIALIZE RECORD NUMBER AND COUNT TO ZERO                  */ 03146000
*        IREAD = 0;                                                0912 03147000
         SLR   IREAD,IREAD                                         0912 03148000
*        RCDCNT = 0;                                               0913 03149000
         SLR   @06,@06                                             0913 03150000
         ST    @06,RCDCNT                                          0913 03151000
*/*      DO-UNTIL THERE IS NO DATA ON THE TRACK OR AN OVERFLOW       */ 03152000
*/*       RECORD WAS ENCOUNTERED                                     */ 03153000
*        CALL ICKSAFP0 (GDTTBL                                     0914 03154000
*               ,'ITRT');                                          0914 03155000
         L     @06,@PC00001                                        0914 03156000
         ST    @06,@AL00001                                        0914 03157000
         LA    @03,@CC00903                                        0914 03158000
         ST    @03,@AL00001+4                                      0914 03159000
         MVI   @AL00001+4,X'80'                                    0914 03160000
         L     @15,GDTFPL(,@06)                                    0914 03161000
         LA    @01,@AL00001                                        0914 03162000
         BALR  @14,@15                                             0914 03163000
*        DO UNTIL (RETCODE2 = NORECFND | RETCODE2 = OVERFLOW);     0915 03164000
*                                                                  0915 03165000
@DL00915 DS    0H                                                  0916 03166000
*/*        INCREMENT LOOP COUNTER                                    */ 03167000
*          IREAD = IREAD + 1;                                      0916 03168000
         LA    @06,1                                               0916 03169000
         ALR   IREAD,@06                                           0916 03170000
*/*        SET UP RECORD NUMBER FOR SEARCH ARGUMENT                  */ 03171000
*          IF IREAD = 1                                            0917 03172000
*            THEN DO;    RECNUM = IREAD; END;                      0917 03173000
         CR    IREAD,@06                                           0917 03174000
         BNE   @RF00917                                            0917 03175000
         ST    IREAD,RECNUM                                        0919 03176000
*            ELSE DO;    RECNUM = PRECNUM + 1; END;                0921 03177000
         B     @RC00917                                            0921 03178000
@RF00917 DS    0H                                                  0922 03179000
         LA    @06,1                                               0922 03180000
         AL    @06,PRECNUM                                         0922 03181000
         ST    @06,RECNUM                                          0922 03182000
*/*        READ RECORD N (N IS THE RECORD NUMBER) (UDEVOP)           */ 03183000
*          CALL ICKDVOP0 (GDTTBL                                   0924 03184000
*                 ,VOLIB                                           0924 03185000
*                 ,ACTRCKDN                                        0924 03186000
*                 ,RTRADDR                                         0924 03187000
*                 ,RECNUM                                          0924 03188000
*                 ,'ITRT'                                          0924 03189000
*                 ,DATAPTR                                         0924 03190000
*                 ,DATALEN                                         0924 03191000
*                 ,RETCODE2);                                      0924 03192000
@RC00917 L     @06,@PC00001                                        0924 03193000
         ST    @06,@AL00001                                        0924 03194000
         LA    @03,VOLIB                                           0924 03195000
         ST    @03,@AL00001+4                                      0924 03196000
         LA    @03,@CF00246                                        0924 03197000
         ST    @03,@AL00001+8                                      0924 03198000
         L     @03,@PC00007                                        0924 03199000
         ST    @03,@AL00001+12                                     0924 03200000
         LA    @03,RECNUM                                          0924 03201000
         ST    @03,@AL00001+16                                     0924 03202000
         LA    @03,@CC00903                                        0924 03203000
         ST    @03,@AL00001+20                                     0924 03204000
         LA    @03,DATAPTR                                         0924 03205000
         ST    @03,@AL00001+24                                     0924 03206000
         LA    @03,DATALEN                                         0924 03207000
         ST    @03,@AL00001+28                                     0924 03208000
         LA    @03,RETCODE2                                        0924 03209000
         ST    @03,@AL00001+32                                     0924 03210000
         L     @15,GDTDOP(,@06)                                    0924 03211000
         LA    @01,@AL00001                                        0924 03212000
         BALR  @14,@15                                             0924 03213000
*/*        IF READ OPERATION IS SUCCESSFUL                           */ 03214000
*          IF RETCODE2 ^= CPFAILS                                  0925 03215000
*/*          THEN (READ OPERATION SUCCESSFUL)                        */ 03216000
*            THEN DO;                                              0925 03217000
*                                                                  0925 03218000
         L     @06,RETCODE2                                        0925 03219000
         CH    @06,@CH00044                                        0925 03220000
         BE    @RF00925                                            0925 03221000
*/*            IF A RECORD EXISTS                                    */ 03222000
*              IF (RETCODE2 = SUCCESS) | (RETCODE2 = OVERFLOW)     0927 03223000
*/*              THEN                                                */ 03224000
*                THEN DO;                                          0927 03225000
*                                                                  0927 03226000
         LTR   @06,@06                                             0927 03227000
         BZ    @RT00927                                            0927 03228000
         CH    @06,@CH00260                                        0927 03229000
         BNE   @RF00927                                            0927 03230000
@RT00927 DS    0H                                                  0928 03231000
*                  RESPECIFY RTRECORD BASED (DATAPTR);             0929 03232000
*/*                IF FIRST RECORD READ                              */ 03233000
*                  IF IREAD = 1                                    0930 03234000
*/*                  THEN SAVE THE RECORD NUMBER                     */ 03235000
*                    THEN DO;    FRECNUM = RCNTR; END;             0930 03236000
         CH    IREAD,@CH00165                                      0930 03237000
         BNE   @RF00930                                            0930 03238000
         L     @06,DATAPTR                                         0932 03239000
         SLR   @03,@03                                             0932 03240000
         IC    @03,RCNTR(,@06)                                     0932 03241000
         ST    @03,FRECNUM                                         0932 03242000
*/*                  ELSE (NOT FIRST RECORD)                         */ 03243000
*                    ELSE DO;                                      0934 03244000
         B     @RC00930                                            0934 03245000
@RF00930 DS    0H                                                  0935 03246000
*/*                    IF WRAPAROUND OCCURED                         */ 03247000
*                      IF FRECNUM = RCNTR                          0935 03248000
*/*                      THEN LEAVE                                  */ 03249000
*                        THEN DO;    GOTO ENDLOOPI; END;           0935 03250000
         L     @06,FRECNUM                                         0935 03251000
         L     @03,DATAPTR                                         0935 03252000
         MVC   @ZT00003+3(1),RCNTR(@03)                            0935 03253000
         C     @06,@ZT00003                                        0935 03254000
         BNE   @RF00935                                            0935 03255000
         B     ENDLOOPI                                            0937 03256000
*/*                    END-ELSE (NOT FIRST RECORD)                   */ 03257000
*                      END;                                        0939 03258000
@RF00935 DS    0H                                                  0940 03259000
*/*                INCREMENT NUMBER OF RECORDS READ                  */ 03260000
*                  RCDCNT = RCDCNT + 1;                            0940 03261000
@RC00930 LA    @06,1                                               0940 03262000
         L     @03,RCDCNT                                          0940 03263000
         ALR   @03,@06                                             0940 03264000
         ST    @03,RCDCNT                                          0940 03265000
*/*                SAVE THE RECORD NUMBER OF THE RECORD READ         */ 03266000
*                  PRECNUM = RCNTR;                                0941 03267000
         L     @15,DATAPTR                                         0941 03268000
         SLR   @14,@14                                             0941 03269000
         IC    @14,RCNTR(,@15)                                     0941 03270000
         ST    @14,PRECNUM                                         0941 03271000
*/*                SET UP POINTER TO RECORD IN THE RECORD TABLE      */ 03272000
*                  RECTAPTR (RCDCNT) = DATAPTR;                    0942 03273000
         L     @14,RECPTR                                          0942 03274000
         MH    @03,@CH00265                                        0942 03275000
         LA    @01,0(@03,@14)                                      0942 03276000
         AL    @01,@CF01068                                        0942 03277000
         ST    @15,RECTAPTR(,@01)                                  0942 03278000
*/*                SET UP LENGTH OF RECORD IN THE RECORD TABLE       */ 03279000
*                  RECTALEN (RCDCNT) = DATALEN;                    0943 03280000
         L     @15,DATALEN                                         0943 03281000
         LA    @01,0(@03,@14)                                      0943 03282000
         AL    @01,@CF01069                                        0943 03283000
         ST    @15,RECTALEN-4(,@01)                                0943 03284000
*/*                IF TRACK IS AN OVERFLOW RECORD                    */ 03285000
*                  IF RETCODE2 = OVERFLOW                          0944 03286000
*/*                  THEN INDICATE OVERFLOW RECORD                   */ 03287000
*                    THEN DO;                                      0944 03288000
*                                                                  0944 03289000
         CLC   RETCODE2(4),@CF00260                                0944 03290000
         BNE   @RF00944                                            0944 03291000
*                      RECTAOFL(RCDCNT) = 1;                       0946 03292000
         AL    @14,@CF01070                                        0946 03293000
         STC   @06,RECTAOFL-8(@03,@14)                             0946 03294000
*                      END;                                        0947 03295000
*/*                  ELSE INDICATE A NORMAL RECORD                   */ 03296000
*                    ELSE DO;                                      0948 03297000
*                                                                  0948 03298000
         B     @RC00944                                            0948 03299000
@RF00944 DS    0H                                                  0949 03300000
*                      RECTAOFL(RCDCNT) = 0;                       0949 03301000
         L     @06,RCDCNT                                          0949 03302000
         MH    @06,@CH00265                                        0949 03303000
         SLR   @03,@03                                             0949 03304000
         L     @01,RECPTR                                          0949 03305000
         AL    @01,@CF01070                                        0949 03306000
         STC   @03,RECTAOFL-8(@06,@01)                             0949 03307000
*                      END;                                        0950 03308000
*/*                END-THEN                                          */ 03309000
*                  END;                                            0951 03310000
*/*            END-THEN                                              */ 03311000
*              END;                                                0952 03312000
*/*          ELSE                                                    */ 03313000
*            ELSE DO;                                              0953 03314000
*                                                                  0953 03315000
         B     @RC00925                                            0953 03316000
@RF00925 DS    0H                                                  0954 03317000
*/*            ISSUE ERROR MESSAGE (MSGNOREA) (UPRINT)               */ 03318000
*              DARGSENT = MSGNOREA;                                0954 03319000
         L     @06,DDSTRU                                          0954 03320000
         MVI   DARGSENT(@06),X'2C'                                 0954 03321000
*              DARGCNT = 3;                                        0955 03322000
         LA    @15,3                                               0955 03323000
         STH   @15,DARGCNT(,@06)                                   0955 03324000
*              DARGINS (1) = 1;                                    0956 03325000
         MVC   DARGINS(2,@06),@CH00165                             0956 03326000
*              DARGINL (1) = LENGTH (RTRADDRC);                    0957 03327000
         LA    @14,2                                               0957 03328000
         STH   @14,DARGINL(,@06)                                   0957 03329000
*              DARGDTM (1) = ADDR (RTRADDRC);                      0958 03330000
         L     @05,@PC00007                                        0958 03331000
         ST    @05,DARGDTM(,@06)                                   0958 03332000
*              DARGINS (2) = 2;                                    0959 03333000
         STH   @14,DARGINS+8(,@06)                                 0959 03334000
*              DARGINL (2) = LENGTH (RTRADDRT);                    0960 03335000
         STH   @14,DARGINL+8(,@06)                                 0960 03336000
*              DARGDTM (2) = ADDR (RTRADDRT);                      0961 03337000
         LA    @14,RTRADDRT(,@05)                                  0961 03338000
         ST    @14,DARGDTM+8(,@06)                                 0961 03339000
*              DARGINS (3) = 3;                                    0962 03340000
         STH   @15,DARGINS+16(,@06)                                0962 03341000
*              DARGINL (3) = LENGTH (RECNUM);                      0963 03342000
         MVC   DARGINL+16(2,@06),@CH00044                          0963 03343000
*              DARGDTM (3) = ADDR (RECNUM);                        0964 03344000
         LA    @15,RECNUM                                          0964 03345000
         ST    @15,DARGDTM+16(,@06)                                0964 03346000
*              CALL ICKTPPR0 (GDTTBL                               0965 03347000
*                     ,PRTFILE                                     0965 03348000
*                     ,DDSTRU);                                    0965 03349000
         L     @06,@PC00001                                        0965 03350000
         ST    @06,@AL00001                                        0965 03351000
         LA    @15,@CF00094                                        0965 03352000
         ST    @15,@AL00001+4                                      0965 03353000
         LA    @15,DDSTRU                                          0965 03354000
         ST    @15,@AL00001+8                                      0965 03355000
         MVI   @AL00001+8,X'80'                                    0965 03356000
         L     @15,GDTPRT(,@06)                                    0965 03357000
         LA    @01,@AL00001                                        0965 03358000
         BALR  @14,@15                                             0965 03359000
*/*            INDICATE AN ERROR (LASTCOND = 8)                      */ 03360000
*              LASTCOND = MAX(LASTCC08,LASTCOND);                  0966 03361000
         L     @06,@PC00001+8                                      0966 03362000
         LH    @15,LASTCOND(,@06)                                  0966 03363000
         LA    @14,8                                               0966 03364000
         CR    @15,@14                                             0966 03365000
         BNL   *+6                                                      03366000
         LR    @15,@14                                             0966 03367000
         STH   @15,LASTCOND(,@06)                                  0966 03368000
*/*            INDICATE PROCESSING SHOULD NOT CONTINUE ON THIS TRACK */ 03369000
*              CNTFLAG = NOCONT;                                   0967 03370000
         NI    CNTFLAG,B'01111111'                                 0967 03371000
*/*            RETURN                                                */ 03372000
*              RETURN;                                             0968 03373000
@EL00007 DS    0H                                                  0968 03374000
@EF00007 DS    0H                                                  0968 03375000
@ER00007 LM    @14,@12,@SA00007                                    0968 03376000
         BR    @14                                                 0968 03377000
*/*            END-ELSE                                              */ 03378000
*              END;                                                0969 03379000
*/*      END-UNTIL                                                   */ 03380000
*        END;                                                      0970 03381000
@RC00925 DS    0H                                                  0970 03382000
@DE00915 L     @06,RETCODE2                                        0970 03383000
         CH    @06,@CH00165                                        0970 03384000
         BE    @DC00915                                            0970 03385000
         CH    @06,@CH00260                                        0970 03386000
         BNE   @DL00915                                            0970 03387000
@DC00915 DS    0H                                                  0971 03388000
*        ENDLOOPI:                                                 0971 03389000
*/*      SET FLAG TO INDICATE THE TRACK CONTENTS WERE READ           */ 03390000
*        STATE = READYES;                                          0971 03391000
ENDLOOPI L     @06,@PC00007+8                                      0971 03392000
         OI    STATE(@06),B'10000000'                              0971 03393000
*/*      END-THEN (NO SEVERE ERRORS)                                 */ 03394000
*        END;                                                      0972 03395000
*/*  END-SUB-PROCEDURE READ_TRACK_CONTENTS                           */ 03396000
*    END REATRACK;                                                 0973 03397000
*                                                                  0973 03398000
         B     @EL00007                                            0973 03399000
         EJECT                                                          03400000
*/*****  START OF SPECIFICATIONS  ************************************/ 03401000
*/*                                                                  */ 03402000
*/*  SUB-PROCEDURE NAME:  WRITRACK                                   */ 03403000
*/*                                                                  */ 03404000
*/*  DESCRIPTIVE NAME:  WRITE TRACK CONTENTS                         */ 03405000
*/*                                                                  */ 03406000
*/*  FUNCTION:                                                       */ 03407000
*/*                                                                  */ 03408000
*/*    THIS SUB-PROCEDURE ISSUES SEVERAL CALLS TO THE DEVICE         */ 03409000
*/*    OPERATIONS FACILITY (UDEVOP) IN ORDER TO WRITE BACK ON A      */ 03410000
*/*    TRACK ALL THE RECORDS THAT HAVE BEEN PRESERVED IN MAIN        */ 03411000
*/*    STORAGE. IF AN ERROR IS ENCOUNTERED IN WRITING BACK ANY       */ 03412000
*/*    RECORD THE WRITING PROCESS IS TERMINATED AND A SEVERE ERROR   */ 03413000
*/*    IS INDICATED.                                                 */ 03414000
*/*                                                                  */ 03415000
*/*****  END OF SPECIFICATIONS  **************************************/ 03416000
*                                                                  0974 03417000
*                                                                  0974 03418000
*/*  SUB-PROCEDURE WRITE_TRACK_CONTENTS                              */ 03419000
*    WRITRACK:                                                     0974 03420000
*      PROCEDURE                                                   0974 03421000
*        (                                                         0974 03422000
*        WTRADDR                                                   0974 03423000
*        );                                                        0974 03424000
WRITRACK STM   @14,@12,@SA00008                                    0974 03425000
         MVC   @PC00008(4),0(@01)                                  0974 03426000
*    OLDERID2 = NEWERID2;                                          0975 03427000
         L     @06,@PC00001                                        0975 03428000
         L     @06,GDTTR2(,@06)                                    0975 03429000
         MVC   @TS00001(95),NEWERID2(@06)                          0975 03430000
         MVC   OLDERID2(95,@06),@TS00001                           0975 03431000
*    NEWID2 = 'ITWI';                                              0976 03432000
*                                                                  0976 03433000
         MVC   NEWID2(4,@06),@CC00912                              0976 03434000
*    DECLARE  /********  LOCAL PARAMETERS  ***************************/ 03435000
*                                                                  0977 03436000
*      I4                    FIXED(31),                            0977 03437000
*                                                                  0977 03438000
*      RETCODE3              FIXED (31),                           0977 03439000
*                                                                  0977 03440000
*      1 WTRADDR,            /* ADDRESS OF TRACK ON WHICH RECORDS    */ 03441000
*                            /* ARE TO BE WRITTEN                    */ 03442000
*                                                                  0977 03443000
*        2 WTRADDRC          /* CYLINDER NUMBER                      */ 03444000
*                            FIXED (16),                           0977 03445000
*                                                                  0977 03446000
*        2 WTRADDRT          /* TRACK NUMBER                         */ 03447000
*                            FIXED (16);                           0977 03448000
*                                                                  0977 03449000
*/*  DO-FOR ALL THE RECORDS THAT WERE PRESERVED                      */ 03450000
*    DO I4 = 1 TO RCDCNT;                                          0978 03451000
*                                                                  0978 03452000
         LA    I4,1                                                0978 03453000
         B     @DE00978                                            0978 03454000
@DL00978 DS    0H                                                  0979 03455000
*/*    SET UP RECORD NUMBER FOR SEARCH ARGUMENT                      */ 03456000
*      IF I4 = 1                                                   0979 03457000
*        THEN DO;    RECNUM = I4; END;                             0979 03458000
         CH    I4,@CH00165                                         0979 03459000
         BNE   @RF00979                                            0979 03460000
         ST    I4,RECNUM                                           0981 03461000
*        ELSE DO;    RECNUM = PRECNUM + 1; END;                    0983 03462000
         B     @RC00979                                            0983 03463000
@RF00979 DS    0H                                                  0984 03464000
         LA    @06,1                                               0984 03465000
         AL    @06,PRECNUM                                         0984 03466000
         ST    @06,RECNUM                                          0984 03467000
*/*    IF THE RECORD TO BE WRITTEN IS AN OVERFLOW RECORD             */ 03468000
*      IF RECTAOFL(I4) = 1                                         0986 03469000
*/*      THEN SET ACTION KEY TO WRITE THE OVERFLOW RECORD ON TRACK   */ 03470000
*        THEN DO;    WRACTION = ACTSCKDN; END;                     0986 03471000
@RC00979 LR    @06,I4                                              0986 03472000
         MH    @06,@CH00265                                        0986 03473000
         L     @03,RECPTR                                          0986 03474000
         AL    @03,@CF01070                                        0986 03475000
         SLR   @15,@15                                             0986 03476000
         IC    @15,RECTAOFL-8(@06,@03)                             0986 03477000
         CH    @15,@CH00165                                        0986 03478000
         BNE   @RF00986                                            0986 03479000
         MVC   WRACTION(4),@CF00278                                0988 03480000
*/*      ELSE SET ACTION KEY TO WRITE A NORMAL RECORD ON TRACK       */ 03481000
*        ELSE DO;    WRACTION = ACTWCKDN; END;                     0990 03482000
         B     @RC00986                                            0990 03483000
@RF00986 DS    0H                                                  0991 03484000
         MVC   WRACTION(4),@CF00260                                0991 03485000
*/*    WRITE RECORD N ( WHERE N IS THE RECORD NUMBER) (UDEVOP)       */ 03486000
*      CALL ICKDVOP0 (GDTTBL                                       0993 03487000
*             ,VOLIB                                               0993 03488000
*             ,WRACTION                                            0993 03489000
*             ,WTRADDR                                             0993 03490000
*             ,RECNUM                                              0993 03491000
*             ,'ITRT'                                              0993 03492000
*             ,RECTAPTR (I4)                                       0993 03493000
*             ,RECTALEN (I4)                                       0993 03494000
*             ,RETCODE3);                                          0993 03495000
@RC00986 L     @06,@PC00001                                        0993 03496000
         ST    @06,@AL00001                                        0993 03497000
         LA    @03,VOLIB                                           0993 03498000
         ST    @03,@AL00001+4                                      0993 03499000
         LA    @03,WRACTION                                        0993 03500000
         ST    @03,@AL00001+8                                      0993 03501000
         L     @03,@PC00008                                        0993 03502000
         ST    @03,@AL00001+12                                     0993 03503000
         LA    @03,RECNUM                                          0993 03504000
         ST    @03,@AL00001+16                                     0993 03505000
         LA    @03,@CC00903                                        0993 03506000
         ST    @03,@AL00001+20                                     0993 03507000
         L     @03,RECPTR                                          0993 03508000
         LR    @15,I4                                              0993 03509000
         MH    @15,@CH00265                                        0993 03510000
         LA    @01,0(@15,@03)                                      0993 03511000
         AL    @01,@CF01068                                        0993 03512000
         ST    @01,@AL00001+24                                     0993 03513000
         AL    @03,@CF01069                                        0993 03514000
         LA    @03,RECTALEN-4(@15,@03)                             0993 03515000
         ST    @03,@AL00001+28                                     0993 03516000
         LA    @03,RETCODE3                                        0993 03517000
         ST    @03,@AL00001+32                                     0993 03518000
         L     @15,GDTDOP(,@06)                                    0993 03519000
         LA    @01,@AL00001                                        0993 03520000
         BALR  @14,@15                                             0993 03521000
*/*    IF WRITE OPERATION FAILS                                      */ 03522000
*      IF RETCODE3 = CPFAILS                                       0994 03523000
*/*      THEN                                                        */ 03524000
*        THEN DO;                                                  0994 03525000
*                                                                  0994 03526000
         CLC   RETCODE3(4),@CF00044                                0994 03527000
         BNE   @RF00994                                            0994 03528000
*/*        ISSUE ERROR MESSAGE (MSGNOWRI) (UPRINT)                   */ 03529000
*          DARGSENT = MSGNOWRI;                                    0996 03530000
         L     @06,DDSTRU                                          0996 03531000
         MVI   DARGSENT(@06),X'2F'                                 0996 03532000
*          DARGCNT = 2;                                            0997 03533000
         LA    @15,2                                               0997 03534000
         STH   @15,DARGCNT(,@06)                                   0997 03535000
*          DARGINS (1) = 1;                                        0998 03536000
         MVC   DARGINS(2,@06),@CH00165                             0998 03537000
*          DARGINL (1) = LENGTH (WTRADDRC);                        0999 03538000
         STH   @15,DARGINL(,@06)                                   0999 03539000
*          DARGDTM (1) = ADDR (WTRADDRC);                          1000 03540000
         L     @14,@PC00008                                        1000 03541000
         ST    @14,DARGDTM(,@06)                                   1000 03542000
*          DARGINS (2) = 2;                                        1001 03543000
         STH   @15,DARGINS+8(,@06)                                 1001 03544000
*          DARGINL (2) = LENGTH (WTRADDRT);                        1002 03545000
         STH   @15,DARGINL+8(,@06)                                 1002 03546000
*          DARGDTM (2) = ADDR (WTRADDRT);                          1003 03547000
         LA    @15,WTRADDRT(,@14)                                  1003 03548000
         ST    @15,DARGDTM+8(,@06)                                 1003 03549000
*          CALL ICKTPPR0 (GDTTBL                                   1004 03550000
*                 ,PRTFILE                                         1004 03551000
*                 ,DDSTRU);                                        1004 03552000
         L     @06,@PC00001                                        1004 03553000
         ST    @06,@AL00001                                        1004 03554000
         LA    @15,@CF00094                                        1004 03555000
         ST    @15,@AL00001+4                                      1004 03556000
         LA    @15,DDSTRU                                          1004 03557000
         ST    @15,@AL00001+8                                      1004 03558000
         MVI   @AL00001+8,X'80'                                    1004 03559000
         L     @15,GDTPRT(,@06)                                    1004 03560000
         LA    @01,@AL00001                                        1004 03561000
         BALR  @14,@15                                             1004 03562000
*/*        INDICATE AN ERROR (LASTCOND = 8)                          */ 03563000
*          LASTCOND = MAX(LASTCC08,LASTCOND);                      1005 03564000
         L     @06,@PC00001+8                                      1005 03565000
         LH    @15,LASTCOND(,@06)                                  1005 03566000
         LA    @14,8                                               1005 03567000
         CR    @15,@14                                             1005 03568000
         BNL   *+6                                                      03569000
         LR    @15,@14                                             1005 03570000
         STH   @15,LASTCOND(,@06)                                  1005 03571000
*/*        INDICATE THE PROCESSING FOR THIS TRACK IS NOT TO CONTINUE */ 03572000
*          CNTFLAG = NOCONT;                                       1006 03573000
         NI    CNTFLAG,B'01111111'                                 1006 03574000
*          CALL ICKSAFP0 (GDTTBL                                   1007 03575000
*                 ,'ITRT');                                        1007 03576000
         L     @06,@PC00001                                        1007 03577000
         ST    @06,@AL00001                                        1007 03578000
         LA    @15,@CC00903                                        1007 03579000
         ST    @15,@AL00001+4                                      1007 03580000
         MVI   @AL00001+4,X'80'                                    1007 03581000
         L     @15,GDTFPL(,@06)                                    1007 03582000
         LA    @01,@AL00001                                        1007 03583000
         BALR  @14,@15                                             1007 03584000
*/*        RETURN                                                    */ 03585000
*          RETURN;                                                 1008 03586000
@EL00008 DS    0H                                                  1008 03587000
@EF00008 DS    0H                                                  1008 03588000
@ER00008 LM    @14,@12,@SA00008                                    1008 03589000
         BR    @14                                                 1008 03590000
*/*        END-THEN                                                  */ 03591000
*          END;                                                    1009 03592000
*/*      ELSE (WRITE OPERATION SUCCESSFUL)                           */ 03593000
*        ELSE DO;                                                  1010 03594000
@RF00994 DS    0H                                                  1011 03595000
*          RESPECIFY RTRECORD BASED (RECTAPTR(I4));                1011 03596000
*/*        SAVE THE RECORD NUMBER FOR SEARCH ARGUMENT FOR NEXT WRITE */ 03597000
*          PRECNUM = RCNTR;                                        1012 03598000
         LR    @06,I4                                              1012 03599000
         MH    @06,@CH00265                                        1012 03600000
         L     @03,RECPTR                                          1012 03601000
         AL    @03,@CF01068                                        1012 03602000
         L     @06,RECTAPTR(@06,@03)                               1012 03603000
         SLR   @03,@03                                             1012 03604000
         IC    @03,RCNTR(,@06)                                     1012 03605000
         ST    @03,PRECNUM                                         1012 03606000
*/*        END-ELSE (WRITE OPERATION SUCCESSFUL)                     */ 03607000
*          END;                                                    1013 03608000
*/*  END-FOR                                                         */ 03609000
*    END;                                                          1014 03610000
         AL    I4,@CF00165                                         1014 03611000
@DE00978 C     I4,RCDCNT                                           1014 03612000
         BNH   @DL00978                                            1014 03613000
*/*  END-SUB-PROCEDURE WRITE_TRACK_CONTENTS                          */ 03614000
*    END WRITRACK;                                                 1015 03615000
*                                                                  1015 03616000
         B     @EL00008                                            1015 03617000
         EJECT                                                          03618000
*/*****  START OF SPECIFICATIONS  ************************************/ 03619000
*/*                                                                  */ 03620000
*/*  SUB-PROCEDURE NAME:  OBTTRST                                    */ 03621000
*/*                                                                  */ 03622000
*/*  DESCRIPTIVE NAME:  OBTAIN TRACK STATUS                          */ 03623000
*/*                                                                  */ 03624000
*/*  FUNCTION:                                                       */ 03625000
*/*                                                                  */ 03626000
*/*    THIS SUB-PROCEDURE WILL OBTAIN THE STATUS OF THE TRACK        */ 03627000
*/*    AS INDICATED BY THE HOME-ADDRESS AND THE STANDARD-LENGTH      */ 03628000
*/*    RECORD-ZERO. THIS STATUS IS OBTAINED BY INVOKING A DEVICE     */ 03629000
*/*    ADAPTER FACILITY (UDEVOP).                                    */ 03630000
*/*                                                                  */ 03631000
*/*****  END OF SPECIFICATIONS  **************************************/ 03632000
*                                                                  1016 03633000
*                                                                  1016 03634000
*/*  SUB-PROCEDURE OBTAIN_TRACK_STATUS                               */ 03635000
*    OBTTRST:                                                      1016 03636000
*      PROCEDURE                                                   1016 03637000
*        (                                                         1016 03638000
*        TRKADDR,                                                  1016 03639000
*        DFLAG,                                                    1016 03640000
*        RZADDR,                                                   1016 03641000
*        OBTRTYPE                                                  1016 03642000
*        );                                                        1016 03643000
OBTTRST  STM   @14,@12,@SA00009                                    1016 03644000
         MVC   @PC00009(16),0(@01)                                 1016 03645000
*    OLDERID2 = NEWERID2;                                          1017 03646000
         L     @06,@PC00001                                        1017 03647000
         L     @15,GDTTR2(,@06)                                    1017 03648000
         MVC   @TS00001(95),NEWERID2(@15)                          1017 03649000
         MVC   OLDERID2(95,@15),@TS00001                           1017 03650000
*    NEWID2 =  'ITOT';                                             1018 03651000
*                                                                  1018 03652000
         MVC   NEWID2(4,@15),@CC00930                              1018 03653000
*    DECLARE  /********  LOCAL PARAMETERS  ***************************/ 03654000
*                                                                  1019 03655000
*      1 TRKADDR,            /* ADDRESS OF TRACK TO BE EXAMINED      */ 03656000
*                                                                  1019 03657000
*        2 TRKADDRC          /* CYLINDER NUMBER                      */ 03658000
*                            FIXED (16),                           1019 03659000
*                                                                  1019 03660000
*        2 TRKADDRH          /* TRACK NUMBER                         */ 03661000
*                            FIXED (16),                           1019 03662000
*                                                                  1019 03663000
*      DFLAG                 /* DEFECT-FLAG INDICATOR                */ 03664000
*                            /* DEFECTIV: DEFECT-FLAG SET            */ 03665000
*                            /* NODEFECT: DEFECT-FLAG NOT SET        */ 03666000
*                            BIT (1),                              1019 03667000
*                                                                  1019 03668000
*      OBTRTYPE              /* FLAG TO INDICATE IF THE TRACK IS     */ 03669000
*                            /* A PRIMARY OR AN ALTERNATE            */ 03670000
*                            /* PRITRACK: PRIMARY                    */ 03671000
*                            /* ALTTRACK: ALTERNATE                  */ 03672000
*                            BIT (1),                              1019 03673000
*                                                                  1019 03674000
*      RETCODE4              /* RETURN CODE FROM CALLED PROGRAMS     */ 03675000
*                            FIXED (31),                           1019 03676000
*                                                                  1019 03677000
*      RZADDR                /* CCHH FROM R0 COUNT FIELD             */ 03678000
*                            CHAR(4);                              1019 03679000
*                                                                  1019 03680000
*/*  READ HOME-ADDRESS (TO OBTAIN THE DEFECT-FLAG) (UDEVOP)          */ 03681000
*    CALL ICKDVOP0 (GDTTBL                                         1020 03682000
*           ,VOLIB                                                 1020 03683000
*           ,ACTRDHA                                               1020 03684000
*           ,TRKADDR                                               1020 03685000
*           ,RECNUM                                                1020 03686000
*           ,POOLID                                                1020 03687000
*           ,HAPTR                                                 1020 03688000
*           ,HALEN                                                 1020 03689000
*           ,RETCODE4);                                            1020 03690000
         ST    @06,@AL00001                                        1020 03691000
         LA    @15,VOLIB                                           1020 03692000
         ST    @15,@AL00001+4                                      1020 03693000
         LA    @15,@CF00165                                        1020 03694000
         ST    @15,@AL00001+8                                      1020 03695000
         L     @15,@PC00009                                        1020 03696000
         ST    @15,@AL00001+12                                     1020 03697000
         LA    @15,RECNUM                                          1020 03698000
         ST    @15,@AL00001+16                                     1020 03699000
         LA    @15,POOLID                                          1020 03700000
         ST    @15,@AL00001+20                                     1020 03701000
         LA    @15,HAPTR                                           1020 03702000
         ST    @15,@AL00001+24                                     1020 03703000
         LA    @15,HALEN                                           1020 03704000
         ST    @15,@AL00001+28                                     1020 03705000
         LA    @15,RETCODE4                                        1020 03706000
         ST    @15,@AL00001+32                                     1020 03707000
         L     @15,GDTDOP(,@06)                                    1020 03708000
         LA    @01,@AL00001                                        1020 03709000
         BALR  @14,@15                                             1020 03710000
*/*  IF READ OPERATION FAILS                                         */ 03711000
*    IF RETCODE4 = CPFAILS                                         1021 03712000
*/*    THEN                                                          */ 03713000
*      THEN DO;                                                    1021 03714000
*                                                                  1021 03715000
         CLC   RETCODE4(4),@CF00044                                1021 03716000
         BNE   @RF01021                                            1021 03717000
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */ 03718000
*        UNTRACK = TRKADDR;                                        1023 03719000
         L     @06,@PC00009                                        1023 03720000
         MVC   UNTRACK(4),TRKADDR(@06)                             1023 03721000
*        IF OBTRTYPE = PRITRACK                                    1024 03722000
*          THEN DO;    UNTRTYPE = PRITRACK; END;                   1024 03723000
         L     @06,@PC00009+12                                     1024 03724000
         TM    OBTRTYPE(@06),B'10000000'                           1024 03725000
         BNO   @RF01024                                            1024 03726000
         OI    UNTRTYPE,B'10000000'                                1026 03727000
*          ELSE DO;    UNTRTYPE = ALTTRACK; END;                   1028 03728000
         B     @RC01024                                            1028 03729000
@RF01024 DS    0H                                                  1029 03730000
         NI    UNTRTYPE,B'01111111'                                1029 03731000
*        CALL COUNTRKS;                                            1031 03732000
@RC01024 BAL   @14,COUNTRKS                                        1031 03733000
*/*      END-THEN                                                    */ 03734000
*        END;                                                      1032 03735000
*/*    ELSE (TRACK WAS NOT UNRECOVERABLE)                            */ 03736000
*      ELSE DO;                                                    1033 03737000
*                                                                  1033 03738000
         B     @RC01021                                            1033 03739000
@RF01021 DS    0H                                                  1034 03740000
*/*      IF THE DEFECT-FLAG IS FOUND TO BE SET                       */ 03741000
*        IF (RETCODE4 = DFLAGONP) | (RETCODE4 = DFLAGONA)          1034 03742000
*/*        THEN SAVE THE DEFECT-FLAG SETTING                         */ 03743000
*          THEN DO;    DFLAG = DEFECTIV; END;                      1034 03744000
         L     @06,RETCODE4                                        1034 03745000
         CH    @06,@CH00116                                        1034 03746000
         BE    @RT01034                                            1034 03747000
         CH    @06,@CH00119                                        1034 03748000
         BNE   @RF01034                                            1034 03749000
@RT01034 DS    0H                                                  1035 03750000
         L     @06,@PC00009+4                                      1036 03751000
         OI    DFLAG(@06),B'10000000'                              1036 03752000
*/*      IF THE DEFECT-FLAG IS FOUND NOT TO BE SET                   */ 03753000
*        IF (RETCODE4 = DFLAGOFP) | (RETCODE4 = DFLAGOFA)          1038 03754000
*/*        THEN SAVE THE DEFECT-FLAG RE-SETTING                      */ 03755000
*          THEN DO;    DFLAG = NODEFECT; END;                      1038 03756000
@RF01034 L     @06,RETCODE4                                        1038 03757000
         CH    @06,@CH00136                                        1038 03758000
         BE    @RT01038                                            1038 03759000
         CH    @06,@CH00185                                        1038 03760000
         BNE   @RF01038                                            1038 03761000
@RT01038 DS    0H                                                  1039 03762000
         L     @06,@PC00009+4                                      1040 03763000
         NI    DFLAG(@06),B'01111111'                              1040 03764000
*/*      READ STANDARD-LENGTH R0 (TO OBTAIN ASSOCIATION)             */ 03765000
*        CALL ICKDVOP0 (GDTTBL                                     1042 03766000
*               ,VOLIB                                             1042 03767000
*               ,ACTRDRZ                                           1042 03768000
*               ,TRKADDR                                           1042 03769000
*               ,RECNUM                                            1042 03770000
*               ,'ITRZ'                                            1042 03771000
*               ,RZPTR                                             1042 03772000
*               ,RZLEN                                             1042 03773000
*               ,RETCODE4);                                        1042 03774000
@RF01038 L     @06,@PC00001                                        1042 03775000
         ST    @06,@AL00001                                        1042 03776000
         LA    @15,VOLIB                                           1042 03777000
         ST    @15,@AL00001+4                                      1042 03778000
         LA    @15,@CF00116                                        1042 03779000
         ST    @15,@AL00001+8                                      1042 03780000
         L     @15,@PC00009                                        1042 03781000
         ST    @15,@AL00001+12                                     1042 03782000
         LA    @15,RECNUM                                          1042 03783000
         ST    @15,@AL00001+16                                     1042 03784000
         LA    @15,@CC00935                                        1042 03785000
         ST    @15,@AL00001+20                                     1042 03786000
         LA    @15,RZPTR                                           1042 03787000
         ST    @15,@AL00001+24                                     1042 03788000
         LA    @15,RZLEN                                           1042 03789000
         ST    @15,@AL00001+28                                     1042 03790000
         LA    @15,RETCODE4                                        1042 03791000
         ST    @15,@AL00001+32                                     1042 03792000
         L     @15,GDTDOP(,@06)                                    1042 03793000
         LA    @01,@AL00001                                        1042 03794000
         BALR  @14,@15                                             1042 03795000
*/*      IF READ OPERATION FAILS                                     */ 03796000
*        IF RETCODE4 = CPFAILS                                     1043 03797000
*/*        THEN                                                      */ 03798000
*          THEN DO;                                                1043 03799000
*                                                                  1043 03800000
         CLC   RETCODE4(4),@CF00044                                1043 03801000
         BNE   @RF01043                                            1043 03802000
*/*          COUNT_UNRECOVERABLE_TRACKS                              */ 03803000
*            UNTRACK = TRKADDR;                                    1045 03804000
         L     @06,@PC00009                                        1045 03805000
         MVC   UNTRACK(4),TRKADDR(@06)                             1045 03806000
*            IF OBTRTYPE = PRITRACK                                1046 03807000
*              THEN DO;    UNTRTYPE = PRITRACK; END;               1046 03808000
         L     @06,@PC00009+12                                     1046 03809000
         TM    OBTRTYPE(@06),B'10000000'                           1046 03810000
         BNO   @RF01046                                            1046 03811000
         OI    UNTRTYPE,B'10000000'                                1048 03812000
*              ELSE DO;    UNTRTYPE = ALTTRACK; END;               1050 03813000
         B     @RC01046                                            1050 03814000
@RF01046 DS    0H                                                  1051 03815000
         NI    UNTRTYPE,B'01111111'                                1051 03816000
*            CALL COUNTRKS;                                        1053 03817000
@RC01046 BAL   @14,COUNTRKS                                        1053 03818000
*/*          END-THEN                                                */ 03819000
*            END;                                                  1054 03820000
*/*        ELSE                                                      */ 03821000
*          ELSE DO;                                                1055 03822000
*                                                                  1055 03823000
         B     @RC01043                                            1055 03824000
@RF01043 DS    0H                                                  1056 03825000
*/*          SAVE THE ASSOCIATION ADDRESS                            */ 03826000
*            RZADDR = RZADDROB;                                    1056 03827000
         L     @06,@PC00009+8                                      1056 03828000
         L     @01,RZPTR                                           1056 03829000
         MVC   RZADDR(4,@06),RZADDROB(@01)                         1056 03830000
*/*          IF THE DEFECT-FLAG IS SET DUE TO RECOVERY               */ 03831000
*            IF (RETCODE4 = DFLAGONP) | (RETCODE4 = DFLAGONA)      1057 03832000
*/*            THEN SAVE THE DEFECT-FLAG SETTING                     */ 03833000
*              THEN DO;    DFLAG = DEFECTIV; END;                  1057 03834000
         L     @06,RETCODE4                                        1057 03835000
         CH    @06,@CH00116                                        1057 03836000
         BE    @RT01057                                            1057 03837000
         CH    @06,@CH00119                                        1057 03838000
         BNE   @RF01057                                            1057 03839000
@RT01057 DS    0H                                                  1058 03840000
         L     @06,@PC00009+4                                      1059 03841000
         OI    DFLAG(@06),B'10000000'                              1059 03842000
*/*          END-ELSE                                                */ 03843000
*            END;                                                  1061 03844000
@RF01057 DS    0H                                                  1062 03845000
*/*      FREE THE STORAGE OBTAINED BY UDEVOP                         */ 03846000
*        CALL ICKSAFP0 (GDTTBL                                     1062 03847000
*               ,'ITRZ');                                          1062 03848000
@RC01043 L     @06,@PC00001                                        1062 03849000
         ST    @06,@AL00001                                        1062 03850000
         LA    @15,@CC00935                                        1062 03851000
         ST    @15,@AL00001+4                                      1062 03852000
         MVI   @AL00001+4,X'80'                                    1062 03853000
         L     @15,GDTFPL(,@06)                                    1062 03854000
         LA    @01,@AL00001                                        1062 03855000
         BALR  @14,@15                                             1062 03856000
*/*      END-ELSE (READ HA WAS SUCCESSFUL)                           */ 03857000
*        END;                                                      1063 03858000
*/*  END-SUB-PROCEDURE OBTAIN_TRACK_STATUS                           */ 03859000
*    END OBTTRST;                                                  1064 03860000
*                                                                  1064 03861000
*                                                                  1064 03862000
*                                                                  1064 03863000
@EL00009 DS    0H                                                  1064 03864000
@EF00009 DS    0H                                                  1064 03865000
@ER00009 LM    @14,@12,@SA00009                                    1064 03866000
         BR    @14                                                 1064 03867000
         EJECT                                                          03868000
*/*****  START OF SPECIFICATIONS  ************************************/ 03869000
*/*                                                                  */ 03870000
*/*  SUB-PROCEDURE NAME:  ASSGNALT                                   */ 03871000
*/*                                                                  */ 03872000
*/*  DESCRIPTIVE NAME:  ISSUE ASSIGN ALTERNATE TRACK                 */ 03873000
*/*                                                                  */ 03874000
*/*  FUNCTION:                                                       */ 03875000
*/*                                                                  */ 03876000
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION THAT       */ 03877000
*/*    ASSIGNS AN ALTERNATE TRACK FOR A PRIMARY TRACK WHICH HAS      */ 03878000
*/*    BEEN FOUND TO BE DEFECTIVE. HOWEVER, BEFORE THE INVOCATION    */ 03879000
*/*    IT IS ASSURED THAT THE DEFECTIVE PRIMARY TRACK IS NOT         */ 03880000
*/*    ALREADY ASSIGNED AN ALTERNATE TRACK.                          */ 03881000
*/*                                                                  */ 03882000
*/*****  END OF SPECIFICATIONS  **************************************/ 03883000
*                                                                  1065 03884000
*/*  SUB-PROCEDURE ISSUE_ASSIGN_ALTERNATE_TRACK                      */ 03885000
*    ASSGNALT:                                                     1065 03886000
*      PROCEDURE;                                                  1065 03887000
*                                                                  1065 03888000
ASSGNALT STM   @14,@12,@SA00010                                    1065 03889000
*      DCL RETCODE5          /* RETURN CODE FROM CALLED PROGRAMS     */ 03890000
*                            FIXED (31);                           1066 03891000
*                                                                  1066 03892000
*    OLDERID2 = NEWERID2;                                          1067 03893000
         L     @06,@PC00001                                        1067 03894000
         L     @06,GDTTR2(,@06)                                    1067 03895000
         MVC   @TS00001(95),NEWERID2(@06)                          1067 03896000
         MVC   OLDERID2(95,@06),@TS00001                           1067 03897000
*    NEWID2 =  'ITAA';                                             1068 03898000
         MVC   NEWID2(4,@06),@CC00940                              1068 03899000
*/*  IF NO SEVERE ERRORS WERE FOUND (LASTCOND < 12)                  */ 03900000
*    IF LASTCOND < LASTCC12                                        1069 03901000
*/*    THEN                                                          */ 03902000
*      THEN DO;                                                    1069 03903000
*                                                                  1069 03904000
         L     @06,@PC00001+8                                      1069 03905000
         LH    @06,LASTCOND(,@06)                                  1069 03906000
         CH    @06,@CH00265                                        1069 03907000
         BNL   @RF01069                                            1069 03908000
*/*      SAVE THE NUMBER OF AVAILABLE ALTERNATE TRACKS               */ 03909000
*        SALTCNT = ALTCOUNT;                                       1071 03910000
         L     SALTCNT,ALTCOUNT                                    1071 03911000
*/*      DO-UNTIL ASSIGNMENT IS SUCCESSFUL                           */ 03912000
*        DO UNTIL (RETCODE5 = SUCCESS);                            1072 03913000
*                                                                  1072 03914000
@DL01072 DS    0H                                                  1073 03915000
*/*        ASSIGN_ALTERNATE_TRACK                                    */ 03916000
*          CALL ICKAA01                                            1073 03917000
*               (GDTTBL                                            1073 03918000
*               ,VOLIB                                             1073 03919000
*               ,CTRADDR                                           1073 03920000
*               ,ALTCOUNT                                          1073 03921000
*               ,ALTPTR                                            1073 03922000
*               ,ALTRACK                                           1073 03923000
*               ,UNTRACK                                           1073 03924000
*               ,RETCODE5);                                        1073 03925000
         L     @06,@PC00001                                        1073 03926000
         ST    @06,@AL00001                                        1073 03927000
         LA    @06,VOLIB                                           1073 03928000
         ST    @06,@AL00001+4                                      1073 03929000
         LA    @06,CTRADDR                                         1073 03930000
         ST    @06,@AL00001+8                                      1073 03931000
         LA    @06,ALTCOUNT                                        1073 03932000
         ST    @06,@AL00001+12                                     1073 03933000
         LA    @06,ALTPTR                                          1073 03934000
         ST    @06,@AL00001+16                                     1073 03935000
         LA    @06,ALTRACK                                         1073 03936000
         ST    @06,@AL00001+20                                     1073 03937000
         LA    @06,UNTRACK                                         1073 03938000
         ST    @06,@AL00001+24                                     1073 03939000
         LA    @06,RETCODE5                                        1073 03940000
         ST    @06,@AL00001+28                                     1073 03941000
         L     @15,@CV00941                                        1073 03942000
         LA    @01,@AL00001                                        1073 03943000
         BALR  @14,@15                                             1073 03944000
*/*        IF ASSIGNMENT IS SUCCESSFUL                               */ 03945000
*          IF RETCODE5 = SUCCESS                                   1074 03946000
*/*          THEN                                                    */ 03947000
*            THEN DO;                                              1074 03948000
*                                                                  1074 03949000
         L     @06,RETCODE5                                        1074 03950000
         LTR   @06,@06                                             1074 03951000
         BNZ   @RF01074                                            1074 03952000
*/*            ISSUE MESSAGE ABOUT THE ASSIGNMENT (MSGALTA) (UPRINT) */ 03953000
*              DARGSENT = MSGALTA;                                 1076 03954000
         L     @06,DDSTRU                                          1076 03955000
         MVI   DARGSENT(@06),X'11'                                 1076 03956000
*              DARGCNT = 4;                                        1077 03957000
         LA    @03,4                                               1077 03958000
         STH   @03,DARGCNT(,@06)                                   1077 03959000
*              DARGINS (1) = 1;                                    1078 03960000
         MVC   DARGINS(2,@06),@CH00165                             1078 03961000
*              DARGINL (1) = LENGTH (ALTRACKC);                    1079 03962000
         LA    @15,2                                               1079 03963000
         STH   @15,DARGINL(,@06)                                   1079 03964000
*              DARGDTM (1) = ADDR (ALTRACKC);                      1080 03965000
         LA    @14,ALTRACKC                                        1080 03966000
         ST    @14,DARGDTM(,@06)                                   1080 03967000
*              DARGINS (2) = 2;                                    1081 03968000
         STH   @15,DARGINS+8(,@06)                                 1081 03969000
*              DARGINL (2) = LENGTH (ALTRACKT);                    1082 03970000
         STH   @15,DARGINL+8(,@06)                                 1082 03971000
*              DARGDTM (2) = ADDR (ALTRACKT);                      1083 03972000
         LA    @14,ALTRACKT                                        1083 03973000
         ST    @14,DARGDTM+8(,@06)                                 1083 03974000
*              DARGINS (3) = 3;                                    1084 03975000
         MVC   DARGINS+16(2,@06),@CH00136                          1084 03976000
*              DARGINL (3) = LENGTH (CTRADDRC);                    1085 03977000
         STH   @15,DARGINL+16(,@06)                                1085 03978000
*              DARGDTM (3) = ADDR (CTRADDRC);                      1086 03979000
         LA    @14,CTRADDRC                                        1086 03980000
         ST    @14,DARGDTM+16(,@06)                                1086 03981000
*              DARGINS (4) = 4;                                    1087 03982000
         STH   @03,DARGINS+24(,@06)                                1087 03983000
*              DARGINL (4) = LENGTH (CTRADDRT);                    1088 03984000
         STH   @15,DARGINL+24(,@06)                                1088 03985000
*              DARGDTM (4) = ADDR (CTRADDRT);                      1089 03986000
         LA    @03,CTRADDRT                                        1089 03987000
         ST    @03,DARGDTM+24(,@06)                                1089 03988000
*              CALL ICKTPPR0 (GDTTBL                               1090 03989000
*                     ,PRTFILE                                     1090 03990000
*                     ,DDSTRU);                                    1090 03991000
         L     @06,@PC00001                                        1090 03992000
         ST    @06,@AL00001                                        1090 03993000
         LA    @03,@CF00094                                        1090 03994000
         ST    @03,@AL00001+4                                      1090 03995000
         LA    @03,DDSTRU                                          1090 03996000
         ST    @03,@AL00001+8                                      1090 03997000
         MVI   @AL00001+8,X'80'                                    1090 03998000
         L     @15,GDTPRT(,@06)                                    1090 03999000
         LA    @01,@AL00001                                        1090 04000000
         BALR  @14,@15                                             1090 04001000
*/*            ISSUE_BUILD_PACK_MAP                                  */ 04002000
*              PACKDEF = DEFECTIV;                                 1091 04003000
         OI    PACKDEF,B'10000000'                                 1091 04004000
*              PACKCHEK = NODEFECT;                                1092 04005000
         NI    PACKCHEK,B'01111111'                                1092 04006000
*              PACKRCVR = RCVRYES;                                 1093 04007000
         NI    PACKRCVR,B'01111111'                                1093 04008000
*              PACKTRK = PRITRACK;                                 1094 04009000
         OI    PACKTRK,B'10000000'                                 1094 04010000
*              PACKTRAK = CTRADDR;                                 1095 04011000
         MVC   PACKTRAK(4),CTRADDR                                 1095 04012000
*              PACKASC = ALTRACK;                                  1096 04013000
         MVC   PACKASC(4),ALTRACK                                  1096 04014000
*              CALL BILDPACK;                                      1097 04015000
         BAL   @14,BILDPACK                                        1097 04016000
*/*            IF THE TRACK CONTENTS WERE READ                       */ 04017000
*              IF TRKREAD = READYES                                1098 04018000
*/*              THEN WRITE_TRACK_CONTENTS (ON THE ASSIGNED ALT)     */ 04019000
*                THEN DO;                                          1098 04020000
*                                                                  1098 04021000
         TM    TRKREAD,B'10000000'                                 1098 04022000
         BNO   @RF01098                                            1098 04023000
*                  CALL WRITRACK                                   1100 04024000
*                       (CTRADDR);                                 1100 04025000
         LA    @06,CTRADDR                                         1100 04026000
         ST    @06,@AL00001                                        1100 04027000
         LA    @01,@AL00001                                        1100 04028000
         BAL   @14,WRITRACK                                        1100 04029000
*                  END;                                            1101 04030000
*/*            IF NO MORE ALTERNATE TRACKS ARE AVAILABLE             */ 04031000
*              IF ALTCOUNT <= 0                                    1102 04032000
*/*              THEN (NO MORE ASSIGNMENTS ARE POSSIBLE)             */ 04033000
*                THEN DO;                                          1102 04034000
@RF01098 L     @06,ALTCOUNT                                        1102 04035000
         LTR   @06,@06                                             1102 04036000
         BP    @RF01102                                            1102 04037000
*/*                INDICATE NO MORE ASSIGNMENT ARE POSSIBLE          */ 04038000
*                  ALTFLAG = MORENO;                               1104 04039000
         OI    ALTFLAG,B'10000000'                                 1104 04040000
*/*                ISSUE ERROR MESSAGE                               */ 04041000
*                  DARGSENT = MSGALTB;                             1105 04042000
         L     @06,DDSTRU                                          1105 04043000
         MVI   DARGSENT(@06),X'12'                                 1105 04044000
*                  CALL ICKTPPR0 (GDTTBL                           1106 04045000
*                         ,PRTFILE                                 1106 04046000
*                         ,DDSTRU);                                1106 04047000
         L     @06,@PC00001                                        1106 04048000
         ST    @06,@AL00001                                        1106 04049000
         LA    @03,@CF00094                                        1106 04050000
         ST    @03,@AL00001+4                                      1106 04051000
         LA    @03,DDSTRU                                          1106 04052000
         ST    @03,@AL00001+8                                      1106 04053000
         MVI   @AL00001+8,X'80'                                    1106 04054000
         L     @15,GDTPRT(,@06)                                    1106 04055000
         LA    @01,@AL00001                                        1106 04056000
         BALR  @14,@15                                             1106 04057000
*/*                INDICATE AN ERROR (LASTCOND = 8)                  */ 04058000
*                  LASTCOND = MAX(LASTCOND,LASTCC08);              1107 04059000
         L     @06,@PC00001+8                                      1107 04060000
         LH    @03,LASTCOND(,@06)                                  1107 04061000
         LA    @15,8                                               1107 04062000
         CR    @03,@15                                             1107 04063000
         BNL   *+6                                                      04064000
         LR    @03,@15                                             1107 04065000
         STH   @03,LASTCOND(,@06)                                  1107 04066000
*/*                END-THEN                                          */ 04067000
*                  END;                                            1108 04068000
*/*            IF PRIMARY TRACK WAS CYL 0 HEAD 0                     */ 04069000
*              IF CTRADDR = 0                                      1109 04070000
*/*              THEN ISSUE MESSAGE                                  */ 04071000
*                THEN DO;                                          1109 04072000
@RF01102 L     @06,CTRADDR                                         1109 04073000
         LTR   @06,@06                                             1109 04074000
         BNZ   @RF01109                                            1109 04075000
*                  DARGSENT = MSGFTRAK;                            1111 04076000
         L     @06,DDSTRU                                          1111 04077000
         MVI   DARGSENT(@06),X'30'                                 1111 04078000
*                  CALL ICKTPPR0 (GDTTBL                           1112 04079000
*                         ,PRTFILE                                 1112 04080000
*                         ,DDSTRU);                                1112 04081000
         L     @06,@PC00001                                        1112 04082000
         ST    @06,@AL00001                                        1112 04083000
         LA    @03,@CF00094                                        1112 04084000
         ST    @03,@AL00001+4                                      1112 04085000
         LA    @03,DDSTRU                                          1112 04086000
         ST    @03,@AL00001+8                                      1112 04087000
         MVI   @AL00001+8,X'80'                                    1112 04088000
         L     @15,GDTPRT(,@06)                                    1112 04089000
         LA    @01,@AL00001                                        1112 04090000
         BALR  @14,@15                                             1112 04091000
*                  END;                                            1113 04092000
*/*            LEAVE                                                 */ 04093000
*              GOTO ENDLOOP1;                                      1114 04094000
         B     ENDLOOP1                                            1114 04095000
*/*            END-THEN                                              */ 04096000
*              END;                                                1115 04097000
*/*          ELSE                                                    */ 04098000
*            ELSE DO;                                              1116 04099000
*                                                                  1116 04100000
@RF01074 DS    0H                                                  1117 04101000
*/*            IF AN UNRECOVERABLE TRACK HAS BEEN FOUND              */ 04102000
*              IF RETCODE5 = UNTRAAFF                              1117 04103000
*/*              THEN                                                */ 04104000
*                THEN DO;                                          1117 04105000
*                                                                  1117 04106000
         CLC   RETCODE5(4),@CF00044                                1117 04107000
         BNE   @RF01117                                            1117 04108000
*/*                COUNT_UNRECOVERABLE_TRACKS                        */ 04109000
*                  UNTRTYPE = ALTTRACK;                            1119 04110000
         NI    UNTRTYPE,B'01111111'                                1119 04111000
*                  CALL COUNTRKS;                                  1120 04112000
         BAL   @14,COUNTRKS                                        1120 04113000
*/*                IF A SEVERE ERROR HAS OCCURRED                    */ 04114000
*                  IF LASTCOND >= LASTCC12                         1121 04115000
*/*                  THEN LEAVE                                      */ 04116000
*                    THEN DO;    GOTO ENDLOOP1; END;               1121 04117000
         L     @06,@PC00001+8                                      1121 04118000
         LH    @06,LASTCOND(,@06)                                  1121 04119000
         CH    @06,@CH00265                                        1121 04120000
         BL    @RF01121                                            1121 04121000
         B     ENDLOOP1                                            1123 04122000
*/*                END-THEN                                          */ 04123000
*                  END;                                            1125 04124000
@RF01121 DS    0H                                                  1126 04125000
*/*            IF THERE ARE NO ALTERNATES LEFT                       */ 04126000
*              IF RETCODE5 = NOALTS                                1126 04127000
*/*              THEN                                                */ 04128000
*                THEN DO;                                          1126 04129000
*                                                                  1126 04130000
@RF01117 CLC   RETCODE5(4),@CF00165                                1126 04131000
         BNE   @RF01126                                            1126 04132000
*/*                ISSUE ERROR MESSAGE (MSGALTB) (UPRINT)            */ 04133000
*                  DARGSENT = MSGALTB;                             1128 04134000
         L     @06,DDSTRU                                          1128 04135000
         MVI   DARGSENT(@06),X'12'                                 1128 04136000
*                  CALL ICKTPPR0 (GDTTBL                           1129 04137000
*                         ,PRTFILE                                 1129 04138000
*                         ,DDSTRU);                                1129 04139000
         L     @06,@PC00001                                        1129 04140000
         ST    @06,@AL00001                                        1129 04141000
         LA    @03,@CF00094                                        1129 04142000
         ST    @03,@AL00001+4                                      1129 04143000
         LA    @03,DDSTRU                                          1129 04144000
         ST    @03,@AL00001+8                                      1129 04145000
         MVI   @AL00001+8,X'80'                                    1129 04146000
         L     @15,GDTPRT(,@06)                                    1129 04147000
         LA    @01,@AL00001                                        1129 04148000
         BALR  @14,@15                                             1129 04149000
*/*                INDICATE AN ERROR (LASTCOND = 8)                  */ 04150000
*                  LASTCOND = MAX(LASTCOND,LASTCC08);              1130 04151000
         L     @06,@PC00001+8                                      1130 04152000
         LH    @03,LASTCOND(,@06)                                  1130 04153000
         LA    @15,8                                               1130 04154000
         CR    @03,@15                                             1130 04155000
         BNL   *+6                                                      04156000
         LR    @03,@15                                             1130 04157000
         STH   @03,LASTCOND(,@06)                                  1130 04158000
*/*                INDICATE THERE ARE NO MORE ALTERNATES AVAILABLE   */ 04159000
*                  ALTFLAG = MORENO;                               1131 04160000
         OI    ALTFLAG,B'10000000'                                 1131 04161000
*/*                LEAVE                                             */ 04162000
*                  GOTO ENDLOOP1;                                  1132 04163000
         B     ENDLOOP1                                            1132 04164000
*/*                END-THEN                                          */ 04165000
*                  END;                                            1133 04166000
*/*            IF ASSOCIATION OF THE ALTERNATE TO THE PRIMARY FAILS  */ 04167000
*              IF RETCODE5 = NOPASSOC                              1134 04168000
*/*              THEN                                                */ 04169000
*                THEN DO;                                          1134 04170000
*                                                                  1134 04171000
@RF01126 CLC   RETCODE5(4),@CF00116                                1134 04172000
         BNE   @RF01134                                            1134 04173000
*/*                COUNT_UNRECOVERABLE_TRACKS                        */ 04174000
*                  UNTRACK = CTRADDR;                              1136 04175000
         MVC   UNTRACK(4),CTRADDR                                  1136 04176000
*                  UNTRTYPE = PRITRACK;                            1137 04177000
         OI    UNTRTYPE,B'10000000'                                1137 04178000
*                  CALL COUNTRKS;                                  1138 04179000
         BAL   @14,COUNTRKS                                        1138 04180000
*/*                LEAVE                                             */ 04181000
*                  GOTO ENDLOOP1;                                  1139 04182000
         B     ENDLOOP1                                            1139 04183000
*/*                END-THEN                                          */ 04184000
*                  END;                                            1140 04185000
*/*            IF ASSOCIATION OF THE PRIMARY TO THE ALTERNATE FAILS  */ 04186000
*              IF RETCODE5 = NOAASSOC                              1141 04187000
*/*              THEN                                                */ 04188000
*                THEN DO;                                          1141 04189000
*                                                                  1141 04190000
@RF01134 CLC   RETCODE5(4),@CF00136                                1141 04191000
         BNE   @RF01141                                            1141 04192000
*/*                COUNT_UNRECOVERABLE_TRACKS                        */ 04193000
*                  UNTRTYPE = ALTTRACK;                            1143 04194000
         NI    UNTRTYPE,B'01111111'                                1143 04195000
*                  CALL COUNTRKS;                                  1144 04196000
         BAL   @14,COUNTRKS                                        1144 04197000
*/*                IF A SEVERE ERROR HAS OCCURRED                    */ 04198000
*                  IF LASTCOND >= LASTCC12                         1145 04199000
*/*                  THEN LEAVE                                      */ 04200000
*                    THEN DO;    GOTO ENDLOOP1; END;               1145 04201000
         L     @06,@PC00001+8                                      1145 04202000
         LH    @06,LASTCOND(,@06)                                  1145 04203000
         CH    @06,@CH00265                                        1145 04204000
         BL    @RF01145                                            1145 04205000
         B     ENDLOOP1                                            1147 04206000
*/*                END-THEN                                          */ 04207000
*                  END;                                            1149 04208000
@RF01145 DS    0H                                                  1150 04209000
*/*          END-ELSE (ASSIGNMENT UNSUCCESSFUL)                      */ 04210000
*            END;                                                  1150 04211000
@RF01141 DS    0H                                                  1151 04212000
*/*      END-UNTIL                                                   */ 04213000
*        END;                                                      1151 04214000
@DE01072 L     @06,RETCODE5                                        1151 04215000
         LTR   @06,@06                                             1151 04216000
         BNZ   @DL01072                                            1151 04217000
*        ENDLOOP1:                                                 1152 04218000
*/*      IF THE NUMBER OF AVAILABLE ALTERNATE TRACKS WAS DECREMENTED */ 04219000
*        IF ALTCOUNT = SALTCNT - 1                                 1152 04220000
*/*        THEN UPDATE THE VTOC VALUE ALSO                           */ 04221000
*          THEN DO;    TALCNT = TALCNT - 1; END;                   1152 04222000
ENDLOOP1 LR    @06,SALTCNT                                         1152 04223000
         BCTR  @06,0                                               1152 04224000
         C     @06,ALTCOUNT                                        1152 04225000
         BNE   @RF01152                                            1152 04226000
         L     @06,TALCNT                                          1154 04227000
         BCTR  @06,0                                               1154 04228000
         ST    @06,TALCNT                                          1154 04229000
*/*      IF ASSIGNMENT WAS UNSUCCESSFUL BUT THE PRIMARY TRACK IS     */ 04230000
*/*       STILL RECOVERABLE                                          */ 04231000
*        IF ((RETCODE5 = NOALTS) | (RETCODE5 = NOAASSOC))          1156 04232000
*/*        THEN                                                      */ 04233000
*          THEN DO;                                                1156 04234000
*                                                                  1156 04235000
@RF01152 L     @06,RETCODE5                                        1156 04236000
         CH    @06,@CH00165                                        1156 04237000
         BE    @RT01156                                            1156 04238000
         CH    @06,@CH00136                                        1156 04239000
         BNE   @RF01156                                            1156 04240000
@RT01156 DS    0H                                                  1157 04241000
*/*          IF TRACK CONTENTS WERE READ                             */ 04242000
*            IF TRKREAD = READYES                                  1158 04243000
*/*            THEN                                                  */ 04244000
*              THEN DO;                                            1158 04245000
*                                                                  1158 04246000
         TM    TRKREAD,B'10000000'                                 1158 04247000
         BNO   @RF01158                                            1158 04248000
*/*              ISSUE_MARK_TRACK_NON-DEFECTIVE                      */ 04249000
*                CALL WRIHARZ;                                     1160 04250000
         BAL   @14,WRIHARZ                                         1160 04251000
*/*              IF SUB-PROCEDURE WAS SUCCESSFUL                     */ 04252000
*                IF SPROCODE = SUCCESS                             1161 04253000
*/*                THEN                                              */ 04254000
*                  THEN DO;                                        1161 04255000
*                                                                  1161 04256000
         LTR   SPROCODE,SPROCODE                                   1161 04257000
         BNZ   @RF01161                                            1161 04258000
*/*                  WRITE_TRACK_CONTENTS (BACK ON THE PRIMARY)      */ 04259000
*                    CALL WRITRACK (CTRADDR);                      1163 04260000
         LA    @06,CTRADDR                                         1163 04261000
         ST    @06,@AL00001                                        1163 04262000
         LA    @01,@AL00001                                        1163 04263000
         BAL   @14,WRITRACK                                        1163 04264000
*/*                  ISSUE MESSAGE (MSGALTE) (UPRINT)                */ 04265000
*                    DARGSENT = MSGALTE;                           1164 04266000
         L     @06,DDSTRU                                          1164 04267000
         MVI   DARGSENT(@06),X'27'                                 1164 04268000
*                    DARGCNT = 2;                                  1165 04269000
         LA    @15,2                                               1165 04270000
         STH   @15,DARGCNT(,@06)                                   1165 04271000
*                    DARGINS (1) = 1;                              1166 04272000
         MVC   DARGINS(2,@06),@CH00165                             1166 04273000
*                    DARGINL (1) = LENGTH (CTRADDRC);              1167 04274000
         STH   @15,DARGINL(,@06)                                   1167 04275000
*                    DARGDTM (1) = ADDR (CTRADDRC);                1168 04276000
         LA    @14,CTRADDRC                                        1168 04277000
         ST    @14,DARGDTM(,@06)                                   1168 04278000
*                    DARGINS (2) = 2;                              1169 04279000
         STH   @15,DARGINS+8(,@06)                                 1169 04280000
*                    DARGINL (2) = LENGTH (CTRADDRT);              1170 04281000
         STH   @15,DARGINL+8(,@06)                                 1170 04282000
*                    DARGDTM (2) = ADDR (CTRADDRT);                1171 04283000
         LA    @15,CTRADDRT                                        1171 04284000
         ST    @15,DARGDTM+8(,@06)                                 1171 04285000
*                    CALL ICKTPPR0 (GDTTBL                         1172 04286000
*                           ,PRTFILE                               1172 04287000
*                           ,DDSTRU);                              1172 04288000
         L     @06,@PC00001                                        1172 04289000
         ST    @06,@AL00001                                        1172 04290000
         LA    @15,@CF00094                                        1172 04291000
         ST    @15,@AL00001+4                                      1172 04292000
         LA    @15,DDSTRU                                          1172 04293000
         ST    @15,@AL00001+8                                      1172 04294000
         MVI   @AL00001+8,X'80'                                    1172 04295000
         L     @15,GDTPRT(,@06)                                    1172 04296000
         LA    @01,@AL00001                                        1172 04297000
         BALR  @14,@15                                             1172 04298000
*/*                  RETURN                                          */ 04299000
*                    RETURN;                                       1173 04300000
@EL00010 DS    0H                                                  1173 04301000
@EF00010 DS    0H                                                  1173 04302000
@ER00010 LM    @14,@12,@SA00010                                    1173 04303000
         BR    @14                                                 1173 04304000
*/*                  END-THEN                                        */ 04305000
*                    END;                                          1174 04306000
*/*                ELSE                                              */ 04307000
*                  ELSE DO;                                        1175 04308000
*                                                                  1175 04309000
@RF01161 DS    0H                                                  1176 04310000
*/*                  IF SUB-PROCEDURE FAILS BUT TRACK RECOVERED      */ 04311000
*                    IF SPROCODE = FAILRCV                         1176 04312000
*/*                    THEN                                          */ 04313000
*                      THEN DO;                                    1176 04314000
*                                                                  1176 04315000
         LA    @06,1                                               1176 04316000
         CR    SPROCODE,@06                                        1176 04317000
         BNE   @RF01176                                            1176 04318000
*/*                      ISSUE ERROR MESSAGE (MSGALTF) (UPRINT)      */ 04319000
*                        DARGSENT = MSGALTF;                       1178 04320000
         L     @15,DDSTRU                                          1178 04321000
         MVI   DARGSENT(@15),X'28'                                 1178 04322000
*                        DARGCNT = 2;                              1179 04323000
         LA    @14,2                                               1179 04324000
         STH   @14,DARGCNT(,@15)                                   1179 04325000
*                        DARGINS (1) = 1;                          1180 04326000
         STH   @06,DARGINS(,@15)                                   1180 04327000
*                        DARGINL (1) = LENGTH (CTRADDRC);          1181 04328000
         STH   @14,DARGINL(,@15)                                   1181 04329000
*                        DARGDTM (1) = ADDR (CTRADDRC);            1182 04330000
         LA    @06,CTRADDRC                                        1182 04331000
         ST    @06,DARGDTM(,@15)                                   1182 04332000
*                        DARGINS (2) = 2;                          1183 04333000
         STH   @14,DARGINS+8(,@15)                                 1183 04334000
*                        DARGINL (2) = LENGTH (CTRADDRT);          1184 04335000
         STH   @14,DARGINL+8(,@15)                                 1184 04336000
*                        DARGDTM (2) = ADDR (CTRADDRT);            1185 04337000
         LA    @06,CTRADDRT                                        1185 04338000
         ST    @06,DARGDTM+8(,@15)                                 1185 04339000
*                        CALL ICKTPPR0 (GDTTBL                     1186 04340000
*                               ,PRTFILE                           1186 04341000
*                               ,DDSTRU);                          1186 04342000
         L     @06,@PC00001                                        1186 04343000
         ST    @06,@AL00001                                        1186 04344000
         LA    @15,@CF00094                                        1186 04345000
         ST    @15,@AL00001+4                                      1186 04346000
         LA    @15,DDSTRU                                          1186 04347000
         ST    @15,@AL00001+8                                      1186 04348000
         MVI   @AL00001+8,X'80'                                    1186 04349000
         L     @15,GDTPRT(,@06)                                    1186 04350000
         LA    @01,@AL00001                                        1186 04351000
         BALR  @14,@15                                             1186 04352000
*/*                      RETURN                                      */ 04353000
*                        RETURN;                                   1187 04354000
         B     @EL00010                                            1187 04355000
*/*                      END-THEN                                    */ 04356000
*                        END;                                      1188 04357000
*/*                  END-ELSE                                        */ 04358000
*                    END;                                          1189 04359000
@RF01176 DS    0H                                                  1190 04360000
*/*              END-THEN (TRACK CONTENTS WERE READ)                 */ 04361000
*                END;                                              1190 04362000
*/*          END-THEN (ASSIGNMENT UNSUCCESSFUL BUT PRIMARY OKAY)     */ 04363000
*            END;                                                  1191 04364000
*/*      END-THEN                                                    */ 04365000
*        END;                                                      1192 04366000
*/*  END-SUB-PROCEDURE ISSUE_ASSIGN_ALTERNATE_TRACK                  */ 04367000
*    END ASSGNALT;                                                 1193 04368000
*                                                                  1193 04369000
*                                                                  1193 04370000
         B     @EL00010                                            1193 04371000
         EJECT                                                          04372000
*/*****  START OF SPECIFICATIONS  ************************************/ 04373000
*/*                                                                  */ 04374000
*/*  SUB-PROCEDURE NAME:  RASGNALT                                   */ 04375000
*/*                                                                  */ 04376000
*/*  DESCRIPTIVE NAME:  ISSUE RE-ASSIGN ALTERNATE TRACK              */ 04377000
*/*                                                                  */ 04378000
*/*  FUNCTION:                                                       */ 04379000
*/*                                                                  */ 04380000
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION WHICH      */ 04381000
*/*    RE-ASSIGNS AN ALTERNATE TRACK FOR A SUSPECT PRIMARY TRACK     */ 04382000
*/*    WHEN  IT HAS BEEN ESTABLISHED THAT THE ALTERNATE TRACK        */ 04383000
*/*    THAT IS CURRENTLY ASSIGNED TO THE PRIMARY TRACK IS ITSELF     */ 04384000
*/*    DEFECTIVE. HOWEVER, THIS IS DONE ONLY IF THE ALTERNATE TRACK  */ 04385000
*/*    IS INDEED ASSOCIATED WITH A PRIMARY TRACK.                    */ 04386000
*/*                                                                  */ 04387000
*/*****  END OF SPECIFICATIONS  **************************************/ 04388000
*                                                                  1194 04389000
*/*  SUB-PROCEDURE ISSUE_RE-ASSIGN_ALTERNATE_TRACK                   */ 04390000
*    RASGNALT:                                                     1194 04391000
*      PROCEDURE;                                                  1194 04392000
*                                                                  1194 04393000
RASGNALT STM   @14,@12,@SA00011                                    1194 04394000
*      DCL RETCODE6          /* RETUIRN CODE FROM CALLED PROGRAMS    */ 04395000
*                            FIXED (31);                           1195 04396000
*                                                                  1195 04397000
*    OLDERID2 = NEWERID2;                                          1196 04398000
         L     @06,@PC00001                                        1196 04399000
         L     @06,GDTTR2(,@06)                                    1196 04400000
         MVC   @TS00001(95),NEWERID2(@06)                          1196 04401000
         MVC   OLDERID2(95,@06),@TS00001                           1196 04402000
*    NEWID2 =  'ITRS';                                             1197 04403000
         MVC   NEWID2(4,@06),@CC00949                              1197 04404000
*/*  IF NO SEVERE ERRORS WERE FOUND (LASTCOND < 12)                  */ 04405000
*    IF LASTCOND < LASTCC12                                        1198 04406000
*/*    THEN                                                          */ 04407000
*      THEN DO;                                                    1198 04408000
*                                                                  1198 04409000
         L     @06,@PC00001+8                                      1198 04410000
         LH    @06,LASTCOND(,@06)                                  1198 04411000
         CH    @06,@CH00265                                        1198 04412000
         BNL   @RF01198                                            1198 04413000
*/*      SAVE THE NUMBER OF AVAILABLE ALTERNATE TRACKS               */ 04414000
*        SALTCNT = ALTCOUNT;                                       1200 04415000
         L     SALTCNT,ALTCOUNT                                    1200 04416000
*/*      DO-UNTIL RE-ASSIGNMENT IS SUCCESSFUL                        */ 04417000
*        DO UNTIL (RETCODE6 = SUCCESS);                            1201 04418000
*                                                                  1201 04419000
@DL01201 DS    0H                                                  1202 04420000
*/*        RE-ASSIGN_ALTERNATE_TRACK                                 */ 04421000
*          CALL ICKRA01                                            1202 04422000
*               (GDTTBL                                            1202 04423000
*               ,VOLIB                                             1202 04424000
*               ,RZCCHH                                            1202 04425000
*               ,CTRADDR                                           1202 04426000
*               ,ALTCOUNT                                          1202 04427000
*               ,ALTPTR                                            1202 04428000
*               ,ALTRACK                                           1202 04429000
*               ,UNTRACK                                           1202 04430000
*               ,RETCODE6);                                        1202 04431000
         L     @06,@PC00001                                        1202 04432000
         ST    @06,@AL00001                                        1202 04433000
         LA    @06,VOLIB                                           1202 04434000
         ST    @06,@AL00001+4                                      1202 04435000
         LA    @06,RZCCHH                                          1202 04436000
         ST    @06,@AL00001+8                                      1202 04437000
         LA    @06,CTRADDR                                         1202 04438000
         ST    @06,@AL00001+12                                     1202 04439000
         LA    @06,ALTCOUNT                                        1202 04440000
         ST    @06,@AL00001+16                                     1202 04441000
         LA    @06,ALTPTR                                          1202 04442000
         ST    @06,@AL00001+20                                     1202 04443000
         LA    @06,ALTRACK                                         1202 04444000
         ST    @06,@AL00001+24                                     1202 04445000
         LA    @06,UNTRACK                                         1202 04446000
         ST    @06,@AL00001+28                                     1202 04447000
         LA    @06,RETCODE6                                        1202 04448000
         ST    @06,@AL00001+32                                     1202 04449000
         L     @15,@CV00950                                        1202 04450000
         LA    @01,@AL00001                                        1202 04451000
         BALR  @14,@15                                             1202 04452000
*/*        IF RE-ASSIGNMENT IS SUCCESSFUL                            */ 04453000
*          IF RETCODE6 = SUCCESS                                   1203 04454000
*/*          THEN                                                    */ 04455000
*            THEN DO;                                              1203 04456000
*                                                                  1203 04457000
         L     @06,RETCODE6                                        1203 04458000
         LTR   @06,@06                                             1203 04459000
         BNZ   @RF01203                                            1203 04460000
*/*            ISSUE MESSAGE ABOUT THE RE-ASSIGNMENT (MSGALTC)       */ 04461000
*/*             (UPRINT)                                             */ 04462000
*              DARGSENT = MSGALTC;                                 1205 04463000
         L     @06,DDSTRU                                          1205 04464000
         MVI   DARGSENT(@06),X'13'                                 1205 04465000
*              DARGCNT = 4;                                        1206 04466000
         LA    @03,4                                               1206 04467000
         STH   @03,DARGCNT(,@06)                                   1206 04468000
*              DARGINS (1) = 1;                                    1207 04469000
         MVC   DARGINS(2,@06),@CH00165                             1207 04470000
*              DARGINL (1) = LENGTH (ALTRACKC);                    1208 04471000
         LA    @15,2                                               1208 04472000
         STH   @15,DARGINL(,@06)                                   1208 04473000
*              DARGDTM (1) = ADDR (ALTRACKC);                      1209 04474000
         LA    @14,ALTRACKC                                        1209 04475000
         ST    @14,DARGDTM(,@06)                                   1209 04476000
*              DARGINS (2) = 2;                                    1210 04477000
         STH   @15,DARGINS+8(,@06)                                 1210 04478000
*              DARGINL (2) = LENGTH (ALTRACKT);                    1211 04479000
         STH   @15,DARGINL+8(,@06)                                 1211 04480000
*              DARGDTM (2) = ADDR (ALTRACKT);                      1212 04481000
         LA    @14,ALTRACKT                                        1212 04482000
         ST    @14,DARGDTM+8(,@06)                                 1212 04483000
*              DARGINS (3) = 3;                                    1213 04484000
         MVC   DARGINS+16(2,@06),@CH00136                          1213 04485000
*              DARGINL (3) = LENGTH (RZCCHHC);                     1214 04486000
         STH   @15,DARGINL+16(,@06)                                1214 04487000
*              DARGDTM (3) = ADDR (RZCCHHC);                       1215 04488000
         LA    @14,RZCCHHC                                         1215 04489000
         ST    @14,DARGDTM+16(,@06)                                1215 04490000
*              DARGINS (4) = 4;                                    1216 04491000
         STH   @03,DARGINS+24(,@06)                                1216 04492000
*              DARGINL (4) = LENGTH (RZCCHHT);                     1217 04493000
         STH   @15,DARGINL+24(,@06)                                1217 04494000
*              DARGDTM (4) = ADDR (RZCCHHT);                       1218 04495000
         LA    @03,RZCCHHT                                         1218 04496000
         ST    @03,DARGDTM+24(,@06)                                1218 04497000
*              CALL ICKTPPR0 (GDTTBL                               1219 04498000
*                     ,PRTFILE                                     1219 04499000
*                     ,DDSTRU);                                    1219 04500000
         L     @06,@PC00001                                        1219 04501000
         ST    @06,@AL00001                                        1219 04502000
         LA    @03,@CF00094                                        1219 04503000
         ST    @03,@AL00001+4                                      1219 04504000
         LA    @03,DDSTRU                                          1219 04505000
         ST    @03,@AL00001+8                                      1219 04506000
         MVI   @AL00001+8,X'80'                                    1219 04507000
         L     @15,GDTPRT(,@06)                                    1219 04508000
         LA    @01,@AL00001                                        1219 04509000
         BALR  @14,@15                                             1219 04510000
*/*            ISSUE_BUILD_PACK_MAP                                  */ 04511000
*              PACKDEF = DEFECTIV;                                 1220 04512000
         OI    PACKDEF,B'10000000'                                 1220 04513000
*              PACKCHEK = NODEFECT;                                1221 04514000
         NI    PACKCHEK,B'01111111'                                1221 04515000
*              PACKRCVR = RCVRYES;                                 1222 04516000
         NI    PACKRCVR,B'01111111'                                1222 04517000
*              PACKTRK = PRITRACK;                                 1223 04518000
         OI    PACKTRK,B'10000000'                                 1223 04519000
*              PACKTRAK = RZCCHH;                                  1224 04520000
         MVC   PACKTRAK(4),RZCCHH                                  1224 04521000
*              PACKASC = ALTRACK;                                  1225 04522000
         MVC   PACKASC(4),ALTRACK                                  1225 04523000
*              CALL BILDPACK;                                      1226 04524000
         BAL   @14,BILDPACK                                        1226 04525000
*/*            IF NO MORE ALTERNATE TRACKS ARE AVAILABLE             */ 04526000
*              IF ALTCOUNT <= 0                                    1227 04527000
*/*              THEN ( NO MORE ASSIGNMENTS ARE POSSIBLE )           */ 04528000
*                THEN DO;                                          1227 04529000
         L     @06,ALTCOUNT                                        1227 04530000
         LTR   @06,@06                                             1227 04531000
         BP    @RF01227                                            1227 04532000
*/*                INDICATE NO MORE ASSIGNMENT ARE POSSIBLE          */ 04533000
*                  ALTFLAG = MORENO;                               1229 04534000
         OI    ALTFLAG,B'10000000'                                 1229 04535000
*/*                ISSUE ERROR MESSAGE                               */ 04536000
*                  DARGSENT = MSGALTB;                             1230 04537000
         L     @06,DDSTRU                                          1230 04538000
         MVI   DARGSENT(@06),X'12'                                 1230 04539000
*                  CALL ICKTPPR0 (GDTTBL                           1231 04540000
*                         ,PRTFILE                                 1231 04541000
*                         ,DDSTRU);                                1231 04542000
         L     @06,@PC00001                                        1231 04543000
         ST    @06,@AL00001                                        1231 04544000
         LA    @03,@CF00094                                        1231 04545000
         ST    @03,@AL00001+4                                      1231 04546000
         LA    @03,DDSTRU                                          1231 04547000
         ST    @03,@AL00001+8                                      1231 04548000
         MVI   @AL00001+8,X'80'                                    1231 04549000
         L     @15,GDTPRT(,@06)                                    1231 04550000
         LA    @01,@AL00001                                        1231 04551000
         BALR  @14,@15                                             1231 04552000
*/*                INDICATE AN ERROR (LASTCOND = 8)                  */ 04553000
*                  LASTCOND = MAX(LASTCOND,LASTCC08);              1232 04554000
         L     @06,@PC00001+8                                      1232 04555000
         LH    @03,LASTCOND(,@06)                                  1232 04556000
         LA    @15,8                                               1232 04557000
         CR    @03,@15                                             1232 04558000
         BNL   *+6                                                      04559000
         LR    @03,@15                                             1232 04560000
         STH   @03,LASTCOND(,@06)                                  1232 04561000
*/*                END-THEN                                          */ 04562000
*                  END;                                            1233 04563000
*/*            IF PRIMARY TRACK WAS CYL 0 HEAD 0                     */ 04564000
*              IF RZCCHH = 0                                       1234 04565000
*/*              THEN ISSUE MESSAGE                                  */ 04566000
*                THEN DO;                                          1234 04567000
@RF01227 L     @06,RZCCHH                                          1234 04568000
         LTR   @06,@06                                             1234 04569000
         BNZ   @RF01234                                            1234 04570000
*                  DARGSENT = MSGFTRAK;                            1236 04571000
         L     @06,DDSTRU                                          1236 04572000
         MVI   DARGSENT(@06),X'30'                                 1236 04573000
*                  CALL ICKTPPR0 (GDTTBL                           1237 04574000
*                         ,PRTFILE                                 1237 04575000
*                         ,DDSTRU);                                1237 04576000
         L     @06,@PC00001                                        1237 04577000
         ST    @06,@AL00001                                        1237 04578000
         LA    @03,@CF00094                                        1237 04579000
         ST    @03,@AL00001+4                                      1237 04580000
         LA    @03,DDSTRU                                          1237 04581000
         ST    @03,@AL00001+8                                      1237 04582000
         MVI   @AL00001+8,X'80'                                    1237 04583000
         L     @15,GDTPRT(,@06)                                    1237 04584000
         LA    @01,@AL00001                                        1237 04585000
         BALR  @14,@15                                             1237 04586000
*                  END;                                            1238 04587000
*/*            LEAVE                                                 */ 04588000
*              GOTO ENDLOOP2;                                      1239 04589000
         B     ENDLOOP2                                            1239 04590000
*/*            END-THEN                                              */ 04591000
*              END;                                                1240 04592000
*/*          ELSE (RE-ASSIGNMENT UNSUCCESSFUL)                       */ 04593000
*            ELSE DO;                                              1241 04594000
*                                                                  1241 04595000
@RF01203 DS    0H                                                  1242 04596000
*/*            IF AN UNRECOVERABLE TRACK HAS BEEN FOUND              */ 04597000
*              IF RETCODE6 = UNTRRAFF                              1242 04598000
*/*              THEN                                                */ 04599000
*                THEN DO;                                          1242 04600000
*                                                                  1242 04601000
         CLC   RETCODE6(4),@CF00255                                1242 04602000
         BNE   @RF01242                                            1242 04603000
*/*                COUNT_UNRECOVERABLE_TRACKS                        */ 04604000
*                  UNTRTYPE = ALTTRACK;                            1244 04605000
         NI    UNTRTYPE,B'01111111'                                1244 04606000
*                  CALL COUNTRKS;                                  1245 04607000
         BAL   @14,COUNTRKS                                        1245 04608000
*/*                IF A SEVERE ERROR HAS OCCURRED                    */ 04609000
*                  IF LASTCOND >= LASTCC12                         1246 04610000
*/*                  THEN LEAVE                                      */ 04611000
*                    THEN DO;    GOTO ENDLOOP2; END;               1246 04612000
         L     @06,@PC00001+8                                      1246 04613000
         LH    @06,LASTCOND(,@06)                                  1246 04614000
         CH    @06,@CH00265                                        1246 04615000
         BL    @RF01246                                            1246 04616000
         B     ENDLOOP2                                            1248 04617000
*/*                END-THEN                                          */ 04618000
*                  END;                                            1250 04619000
@RF01246 DS    0H                                                  1251 04620000
*/*            IF THERE ARE NO MORE ALTERNATES                       */ 04621000
*              IF RETCODE6 = NOALTS                                1251 04622000
*/*              THEN                                                */ 04623000
*                THEN DO;                                          1251 04624000
*                                                                  1251 04625000
@RF01242 CLC   RETCODE6(4),@CF00165                                1251 04626000
         BNE   @RF01251                                            1251 04627000
*/*                ISSUE ERROR MESSAGE (MSGALTB) (UPRINT)            */ 04628000
*                  DARGSENT = MSGALTB;                             1253 04629000
         L     @06,DDSTRU                                          1253 04630000
         MVI   DARGSENT(@06),X'12'                                 1253 04631000
*                  CALL ICKTPPR0 (GDTTBL                           1254 04632000
*                         ,PRTFILE                                 1254 04633000
*                         ,DDSTRU);                                1254 04634000
         L     @06,@PC00001                                        1254 04635000
         ST    @06,@AL00001                                        1254 04636000
         LA    @03,@CF00094                                        1254 04637000
         ST    @03,@AL00001+4                                      1254 04638000
         LA    @03,DDSTRU                                          1254 04639000
         ST    @03,@AL00001+8                                      1254 04640000
         MVI   @AL00001+8,X'80'                                    1254 04641000
         L     @15,GDTPRT(,@06)                                    1254 04642000
         LA    @01,@AL00001                                        1254 04643000
         BALR  @14,@15                                             1254 04644000
*/*                INDICATE AN ERROR (LASTCOND = 8)                  */ 04645000
*                  LASTCOND = MAX(LASTCOND,LASTCC08);              1255 04646000
         L     @06,@PC00001+8                                      1255 04647000
         LH    @03,LASTCOND(,@06)                                  1255 04648000
         LA    @15,8                                               1255 04649000
         CR    @03,@15                                             1255 04650000
         BNL   *+6                                                      04651000
         LR    @03,@15                                             1255 04652000
         STH   @03,LASTCOND(,@06)                                  1255 04653000
*/*                INDICATE THERE ARE NO MORE ALTERNATES AVAILABLE   */ 04654000
*                  ALTFLAG = MORENO;                               1256 04655000
         OI    ALTFLAG,B'10000000'                                 1256 04656000
*/*                LEAVE                                             */ 04657000
*                  GOTO ENDLOOP2;                                  1257 04658000
         B     ENDLOOP2                                            1257 04659000
*/*                END-THEN                                          */ 04660000
*                  END;                                            1258 04661000
*/*            IF ASSOCIATION OF THE NEW ALTERNATE TO THE PRIMARY FAI*/ 04662000
*              IF RETCODE6 = NOPASSOC                              1259 04663000
*/*              THEN                                                */ 04664000
*                THEN DO;                                          1259 04665000
*                                                                  1259 04666000
@RF01251 CLC   RETCODE6(4),@CF00116                                1259 04667000
         BNE   @RF01259                                            1259 04668000
*/*                COUNT_UNRECOVERABLE_TRACKS                        */ 04669000
*                  UNTRACK = RZCCHH;                               1261 04670000
         MVC   UNTRACK(4),RZCCHH                                   1261 04671000
*                  UNTRTYPE = PRITRACK;                            1262 04672000
         OI    UNTRTYPE,B'10000000'                                1262 04673000
*                  CALL COUNTRKS;                                  1263 04674000
         BAL   @14,COUNTRKS                                        1263 04675000
*/*                LEAVE                                             */ 04676000
*                  GOTO ENDLOOP2;                                  1264 04677000
         B     ENDLOOP2                                            1264 04678000
*/*                END-THEN                                          */ 04679000
*                  END;                                            1265 04680000
*/*            IF ASSOCIATION OF THE PRIMARY TO THE NEW ALTERNATE FAI*/ 04681000
*              IF RETCODE6 = NOAASSOC                              1266 04682000
*/*              THEN                                                */ 04683000
*                THEN DO;                                          1266 04684000
*                                                                  1266 04685000
@RF01259 CLC   RETCODE6(4),@CF00136                                1266 04686000
         BNE   @RF01266                                            1266 04687000
*/*                COUNT_UNRECOVERABLE_TRACKS                        */ 04688000
*                  UNTRTYPE = ALTTRACK;                            1268 04689000
         NI    UNTRTYPE,B'01111111'                                1268 04690000
*                  CALL COUNTRKS;                                  1269 04691000
         BAL   @14,COUNTRKS                                        1269 04692000
*/*                IF A  SEVERE ERROR HAS OCCURRED                   */ 04693000
*                  IF LASTCOND >= LASTCC12                         1270 04694000
*/*                  THEN LEAVE                                      */ 04695000
*                    THEN DO;    GOTO ENDLOOP2; END;               1270 04696000
         L     @06,@PC00001+8                                      1270 04697000
         LH    @06,LASTCOND(,@06)                                  1270 04698000
         CH    @06,@CH00265                                        1270 04699000
         BL    @RF01270                                            1270 04700000
         B     ENDLOOP2                                            1272 04701000
*/*                END-THEN                                          */ 04702000
*                  END;                                            1274 04703000
@RF01270 DS    0H                                                  1275 04704000
*/*            IF DISSOCIATION OF THE OLD ALTERNATE                  */ 04705000
*/*             FROM THE PRIMARY FAILS                               */ 04706000
*              IF RETCODE6 = NODISSOC                              1275 04707000
*/*              THEN                                                */ 04708000
*                THEN DO;                                          1275 04709000
*                                                                  1275 04710000
@RF01266 CLC   RETCODE6(4),@CF00044                                1275 04711000
         BNE   @RF01275                                            1275 04712000
*/*                COUNT_UNRECOVERABLE_TRACKS                        */ 04713000
*                  UNTRACK = CTRADDR;                              1277 04714000
         MVC   UNTRACK(4),CTRADDR                                  1277 04715000
*                  UNTRTYPE = ALTTRACK;                            1278 04716000
         NI    UNTRTYPE,B'01111111'                                1278 04717000
*                  CALL COUNTRKS;                                  1279 04718000
         BAL   @14,COUNTRKS                                        1279 04719000
*/*                IF A SEVERE ERROR HAS OCCURRED                    */ 04720000
*                  IF LASTCOND >= LASTCC12                         1280 04721000
*/*                  THEN LEAVE                                      */ 04722000
*                  THEN DO;    GOTO ENDLOOP2; END;                 1280 04723000
         L     @06,@PC00001+8                                      1280 04724000
         LH    @06,LASTCOND(,@06)                                  1280 04725000
         CH    @06,@CH00265                                        1280 04726000
         BL    @RF01280                                            1280 04727000
         B     ENDLOOP2                                            1282 04728000
*/*                END-THEN                                          */ 04729000
*                  END;                                            1284 04730000
@RF01280 DS    0H                                                  1285 04731000
*/*            END-ELSE (RE-ASSIGNMENT UNSUCCESSFUL)                 */ 04732000
*              END;                                                1285 04733000
@RF01275 DS    0H                                                  1286 04734000
*/*      END-UNTIL                                                   */ 04735000
*        END;                                                      1286 04736000
@DE01201 L     @06,RETCODE6                                        1286 04737000
         LTR   @06,@06                                             1286 04738000
         BNZ   @DL01201                                            1286 04739000
*        ENDLOOP2:                                                 1287 04740000
*/*      IF THE NUMBER OF AVAILABLE ALTERNATE TRACKS WAS DECREMENTED */ 04741000
*        IF ALTCOUNT = SALTCNT - 1                                 1287 04742000
*/*        THEN UPDATE THE VTOC VALUE ALSO                           */ 04743000
*          THEN DO;    TALCNT = TALCNT - 1; END;                   1287 04744000
ENDLOOP2 LR    @06,SALTCNT                                         1287 04745000
         BCTR  @06,0                                               1287 04746000
         C     @06,ALTCOUNT                                        1287 04747000
         BNE   @RF01287                                            1287 04748000
         L     @06,TALCNT                                          1289 04749000
         BCTR  @06,0                                               1289 04750000
         ST    @06,TALCNT                                          1289 04751000
*/*      IF ASSIGNMENT WAS UNSUCCESSFUL BUT THE OLD ALTERNATE TRACK  */ 04752000
*/*       IS STILL RECOVERABLE                                       */ 04753000
*        IF (RETCODE6 = NOALTS) | (RETCODE6 = NOAASSOC)            1291 04754000
*/*        THEN                                                      */ 04755000
*          THEN DO;                                                1291 04756000
*                                                                  1291 04757000
@RF01287 L     @06,RETCODE6                                        1291 04758000
         CH    @06,@CH00165                                        1291 04759000
         BE    @RT01291                                            1291 04760000
         CH    @06,@CH00136                                        1291 04761000
         BNE   @RF01291                                            1291 04762000
@RT01291 DS    0H                                                  1292 04763000
*/*          IF TRACK CONTENTS WERE READ                             */ 04764000
*            IF TRKREAD = READYES                                  1293 04765000
*/*            THEN                                                  */ 04766000
*              THEN DO;                                            1293 04767000
*                                                                  1293 04768000
         TM    TRKREAD,B'10000000'                                 1293 04769000
         BNO   @RF01293                                            1293 04770000
*/*              ISSUE_MARK_TRACK_NON-DEFECTIVE                      */ 04771000
*                CALL WRIHARZ;                                     1295 04772000
         BAL   @14,WRIHARZ                                         1295 04773000
*/*              IF SUCCESSFUL IN MARKING TRACK NON-DEFECTIVE        */ 04774000
*                IF SPROCODE = SUCCESS                             1296 04775000
*/*                THEN                                              */ 04776000
*                  THEN DO;                                        1296 04777000
*                                                                  1296 04778000
         LTR   SPROCODE,SPROCODE                                   1296 04779000
         BNZ   @RF01296                                            1296 04780000
*/*                  WRITE_TRACK_CONTENTS (BACK ON THE ALTERNATE)    */ 04781000
*                    CALL WRITRACK (RZCCHH);                       1298 04782000
         LA    @06,RZCCHH                                          1298 04783000
         ST    @06,@AL00001                                        1298 04784000
         LA    @01,@AL00001                                        1298 04785000
         BAL   @14,WRITRACK                                        1298 04786000
*/*                  ISSUE MESSAGE (MSGALTG) (UPRINT)                */ 04787000
*                    DARGSENT = MSGALTG;                           1299 04788000
         L     @06,DDSTRU                                          1299 04789000
         MVI   DARGSENT(@06),X'29'                                 1299 04790000
*                    DARGCNT = 2;                                  1300 04791000
         LA    @15,2                                               1300 04792000
         STH   @15,DARGCNT(,@06)                                   1300 04793000
*                    DARGINS (1) = 1;                              1301 04794000
         MVC   DARGINS(2,@06),@CH00165                             1301 04795000
*                    DARGINL (1) = LENGTH (CTRADDRC);              1302 04796000
         STH   @15,DARGINL(,@06)                                   1302 04797000
*                    DARGDTM (1) = ADDR (CTRADDRC);                1303 04798000
         LA    @14,CTRADDRC                                        1303 04799000
         ST    @14,DARGDTM(,@06)                                   1303 04800000
*                    DARGINS (2) = 2;                              1304 04801000
         STH   @15,DARGINS+8(,@06)                                 1304 04802000
*                    DARGINL (2) = LENGTH (CTRADDRT);              1305 04803000
         STH   @15,DARGINL+8(,@06)                                 1305 04804000
*                    DARGDTM (2) = ADDR (CTRADDRT);                1306 04805000
         LA    @15,CTRADDRT                                        1306 04806000
         ST    @15,DARGDTM+8(,@06)                                 1306 04807000
*                    CALL ICKTPPR0 (GDTTBL                         1307 04808000
*                           ,PRTFILE                               1307 04809000
*                           ,DDSTRU);                              1307 04810000
         L     @06,@PC00001                                        1307 04811000
         ST    @06,@AL00001                                        1307 04812000
         LA    @15,@CF00094                                        1307 04813000
         ST    @15,@AL00001+4                                      1307 04814000
         LA    @15,DDSTRU                                          1307 04815000
         ST    @15,@AL00001+8                                      1307 04816000
         MVI   @AL00001+8,X'80'                                    1307 04817000
         L     @15,GDTPRT(,@06)                                    1307 04818000
         LA    @01,@AL00001                                        1307 04819000
         BALR  @14,@15                                             1307 04820000
*/*                  RETURN                                          */ 04821000
*                    RETURN;                                       1308 04822000
@EL00011 DS    0H                                                  1308 04823000
@EF00011 DS    0H                                                  1308 04824000
@ER00011 LM    @14,@12,@SA00011                                    1308 04825000
         BR    @14                                                 1308 04826000
*/*                  END-THEN                                        */ 04827000
*                    END;                                          1309 04828000
*/*                ELSE                                              */ 04829000
*                  ELSE DO;                                        1310 04830000
*                                                                  1310 04831000
@RF01296 DS    0H                                                  1311 04832000
*/*                  IF DEFECT-FLAG IS SET DUE TO RECOVERY           */ 04833000
*                    IF SPROCODE = FAILRCV                         1311 04834000
*/*                    THEN                                          */ 04835000
*                      THEN DO;                                    1311 04836000
*                                                                  1311 04837000
         LA    @06,1                                               1311 04838000
         CR    SPROCODE,@06                                        1311 04839000
         BNE   @RF01311                                            1311 04840000
*/*                      ISSUE ERROR MESSAGE (MSGALTH) (UPRINT)      */ 04841000
*                        DARGSENT = MSGALTH;                       1313 04842000
         L     @15,DDSTRU                                          1313 04843000
         MVI   DARGSENT(@15),X'2A'                                 1313 04844000
*                        DARGCNT = 2;                              1314 04845000
         LA    @14,2                                               1314 04846000
         STH   @14,DARGCNT(,@15)                                   1314 04847000
*                        DARGINS (1) = 1;                          1315 04848000
         STH   @06,DARGINS(,@15)                                   1315 04849000
*                        DARGINL (1) = LENGTH (CTRADDRC);          1316 04850000
         STH   @14,DARGINL(,@15)                                   1316 04851000
*                        DARGDTM (1) = ADDR (CTRADDRC);            1317 04852000
         LA    @06,CTRADDRC                                        1317 04853000
         ST    @06,DARGDTM(,@15)                                   1317 04854000
*                        DARGINS (2) = 2;                          1318 04855000
         STH   @14,DARGINS+8(,@15)                                 1318 04856000
*                        DARGINL (2) = LENGTH (CTRADDRT);          1319 04857000
         STH   @14,DARGINL+8(,@15)                                 1319 04858000
*                        DARGDTM (2) = ADDR (CTRADDRT);            1320 04859000
         LA    @06,CTRADDRT                                        1320 04860000
         ST    @06,DARGDTM+8(,@15)                                 1320 04861000
*                        CALL ICKTPPR0 (GDTTBL                     1321 04862000
*                               ,PRTFILE                           1321 04863000
*                               ,DDSTRU);                          1321 04864000
         L     @06,@PC00001                                        1321 04865000
         ST    @06,@AL00001                                        1321 04866000
         LA    @15,@CF00094                                        1321 04867000
         ST    @15,@AL00001+4                                      1321 04868000
         LA    @15,DDSTRU                                          1321 04869000
         ST    @15,@AL00001+8                                      1321 04870000
         MVI   @AL00001+8,X'80'                                    1321 04871000
         L     @15,GDTPRT(,@06)                                    1321 04872000
         LA    @01,@AL00001                                        1321 04873000
         BALR  @14,@15                                             1321 04874000
*/*                      RETURN                                      */ 04875000
*                        RETURN;                                   1322 04876000
         B     @EL00011                                            1322 04877000
*/*                      END-THEN                                    */ 04878000
*                        END;                                      1323 04879000
*/*                  END-ELSE                                        */ 04880000
*                    END;                                          1324 04881000
@RF01311 DS    0H                                                  1325 04882000
*/*              END-THEN (TRACK CONTENTS WERE READ)                 */ 04883000
*                END;                                              1325 04884000
*/*          END-THEN (RE-ASSIGNMENT UNSUCCESSFUL BUT ALTERNATE OKAY)*/ 04885000
*            END;                                                  1326 04886000
*/*        ELSE                                                      */ 04887000
*          ELSE DO;                                                1327 04888000
*                                                                  1327 04889000
         B     @RC01291                                            1327 04890000
@RF01291 DS    0H                                                  1328 04891000
*/*          IF RE-ASSIGNMENT SUCCESSFUL OR DISSOCIATION OF THE OLD  */ 04892000
*/*           ALTERNATE FAILS AND TRACK CONTENTS WERE READ           */ 04893000
*            IF (RETCODE6 = SUCCESS | RETCODE6 = NODISSOC) &       1328 04894000
*             TRKREAD = READYES                                    1328 04895000
*/*            THEN WRITE_TRACK_CONTENTS (ON THE NEW ALTERNATE )     */ 04896000
*              THEN DO;                                            1328 04897000
*                                                                  1328 04898000
         L     @06,RETCODE6                                        1328 04899000
         LTR   @06,@06                                             1328 04900000
         BZ    @GL00078                                            1328 04901000
         CH    @06,@CH00044                                        1328 04902000
         BNE   @RF01328                                            1328 04903000
@GL00078 TM    TRKREAD,B'10000000'                                 1328 04904000
         BNO   @RF01328                                            1328 04905000
*                CALL WRITRACK                                     1330 04906000
*                     (RZCCHH);                                    1330 04907000
         LA    @06,RZCCHH                                          1330 04908000
         ST    @06,@AL00001                                        1330 04909000
         LA    @01,@AL00001                                        1330 04910000
         BAL   @14,WRITRACK                                        1330 04911000
*                END;                                              1331 04912000
*/*          END-ELSE                                                */ 04913000
*            END;                                                  1332 04914000
*/*      END-THEN                                                    */ 04915000
*        END;                                                      1333 04916000
*/*  END-SUB-PROCEDURE ISSUE_RE-ASSIGN_ALTERNATE_TRACK               */ 04917000
*    END RASGNALT;                                                 1334 04918000
*                                                                  1334 04919000
         B     @EL00011                                            1334 04920000
         EJECT                                                          04921000
*/*****  START OF SPECIFICATIONS  ************************************/ 04922000
*/*                                                                  */ 04923000
*/*  SUB-PROCEDURE NAME:  CHEKTRAK                                   */ 04924000
*/*                                                                  */ 04925000
*/*  DESCRIPTIVE NAME:  ISSUE CHECK TRACK SURFACE                    */ 04926000
*/*                                                                  */ 04927000
*/*  FUNCTION:                                                       */ 04928000
*/*                                                                  */ 04929000
*/*    THIS SUB-PROCEDURE WILL EFFECT THE INVOCATION OF THE          */ 04930000
*/*    TRACK SURFACE CHECKING FUNCTION. ALL THE CONDITION CODE       */ 04931000
*/*    PROCESSING AFTER THE INVOCATION IS HANDLED BY THIS            */ 04932000
*/*    SUB-PROCEDURE. THE STATUS OF THE TRACK IS THEN MADE           */ 04933000
*/*    AVAILABLE TO THE MAIN PROCEDURE.                              */ 04934000
*/*                                                                  */ 04935000
*/*****  END OF SPECIFICATIONS  **************************************/ 04936000
*                                                                  1335 04937000
*                                                                  1335 04938000
*/*  SUB-PROCEDURE ISSUE_CHECK_TRACK_SURFACE                         */ 04939000
*    CHEKTRAK:                                                     1335 04940000
*      PROCEDURE;                                                  1335 04941000
*                                                                  1335 04942000
CHEKTRAK STM   @14,@12,@SA00012                                    1335 04943000
*      DCL RETCODE7          /* RETURN CODE FROM CALLED PROGRAMS     */ 04944000
*                            FIXED (31);                           1336 04945000
*    OLDERID2 = NEWERID2;                                          1337 04946000
         L     @06,@PC00001                                        1337 04947000
         L     @15,GDTTR2(,@06)                                    1337 04948000
         MVC   @TS00001(95),NEWERID2(@15)                          1337 04949000
         MVC   OLDERID2(95,@15),@TS00001                           1337 04950000
*    NEWID2 =  'ITCK';                                             1338 04951000
         MVC   NEWID2(4,@15),@CC00957                              1338 04952000
*/*  CHECK_TRACK_SURFACE                                             */ 04953000
*    CALL ICKTA01                                                  1339 04954000
*         (GDTTBL                                                  1339 04955000
*         ,VOLIB                                                   1339 04956000
*         ,CTRADDR                                                 1339 04957000
*         ,CYCLES                                                  1339 04958000
*         ,RETCODE7);                                              1339 04959000
         ST    @06,@AL00001                                        1339 04960000
         LA    @06,VOLIB                                           1339 04961000
         ST    @06,@AL00001+4                                      1339 04962000
         LA    @06,CTRADDR                                         1339 04963000
         ST    @06,@AL00001+8                                      1339 04964000
         LA    @06,CYCLES                                          1339 04965000
         ST    @06,@AL00001+12                                     1339 04966000
         LA    @06,RETCODE7                                        1339 04967000
         ST    @06,@AL00001+16                                     1339 04968000
         L     @15,@CV00958                                        1339 04969000
         LA    @01,@AL00001                                        1339 04970000
         BALR  @14,@15                                             1339 04971000
*/*  IF SURFACE CHECKING FUNCTION FAILS                              */ 04972000
*    IF RETCODE7 = TSCFAILS                                        1340 04973000
*/*    THEN                                                          */ 04974000
*      THEN DO;                                                    1340 04975000
*                                                                  1340 04976000
         LA    @06,2                                               1340 04977000
         C     @06,RETCODE7                                        1340 04978000
         BNE   @RF01340                                            1340 04979000
*/*      ISSUE WARNING MESSAGE (MSGCHECK) (UPRINT)                   */ 04980000
*        DARGSENT = MSGCHECK;                                      1342 04981000
         L     @15,DDSTRU                                          1342 04982000
         MVI   DARGSENT(@15),X'0F'                                 1342 04983000
*        DARGCNT = 2;                                              1343 04984000
         STH   @06,DARGCNT(,@15)                                   1343 04985000
*        DARGINS (1) = 1;                                          1344 04986000
         MVC   DARGINS(2,@15),@CH00165                             1344 04987000
*        DARGINL (1) = LENGTH (CTRADDRC);                          1345 04988000
         STH   @06,DARGINL(,@15)                                   1345 04989000
*        DARGDTM (1) = ADDR (CTRADDRC);                            1346 04990000
         LA    @14,CTRADDRC                                        1346 04991000
         ST    @14,DARGDTM(,@15)                                   1346 04992000
*        DARGINS (2) = 2;                                          1347 04993000
         STH   @06,DARGINS+8(,@15)                                 1347 04994000
*        DARGINL (2) = LENGTH (CTRADDRT);                          1348 04995000
         STH   @06,DARGINL+8(,@15)                                 1348 04996000
*        DARGDTM (2) = ADDR (CTRADDRT);                            1349 04997000
         LA    @06,CTRADDRT                                        1349 04998000
         ST    @06,DARGDTM+8(,@15)                                 1349 04999000
*        CALL ICKTPPR0 (GDTTBL                                     1350 05000000
*               ,PRTFILE                                           1350 05001000
*               ,DDSTRU);                                          1350 05002000
         L     @06,@PC00001                                        1350 05003000
         ST    @06,@AL00001                                        1350 05004000
         LA    @15,@CF00094                                        1350 05005000
         ST    @15,@AL00001+4                                      1350 05006000
         LA    @15,DDSTRU                                          1350 05007000
         ST    @15,@AL00001+8                                      1350 05008000
         MVI   @AL00001+8,X'80'                                    1350 05009000
         L     @15,GDTPRT(,@06)                                    1350 05010000
         LA    @01,@AL00001                                        1350 05011000
         BALR  @14,@15                                             1350 05012000
*/*      INDICATE MINOR ERROR (LASTCOND = 4)                         */ 05013000
*        LASTCOND = MAX (LASTCOND,LASTCC04);                       1351 05014000
         L     @06,@PC00001+8                                      1351 05015000
         LH    @15,LASTCOND(,@06)                                  1351 05016000
         LA    @14,4                                               1351 05017000
         CR    @15,@14                                             1351 05018000
         BNL   *+6                                                      05019000
         LR    @15,@14                                             1351 05020000
         STH   @15,LASTCOND(,@06)                                  1351 05021000
*/*      INDICATE THE TRACK CHECKS OUT DEFECTIVE                     */ 05022000
*        TRSTATUS = TSCBAD;                                        1352 05023000
         NI    TRSTATUS,B'01111111'                                1352 05024000
*/*      END-THEN                                                    */ 05025000
*        END;                                                      1353 05026000
*/*    ELSE                                                          */ 05027000
*      ELSE DO;                                                    1354 05028000
*                                                                  1354 05029000
         B     @RC01340                                            1354 05030000
@RF01340 DS    0H                                                  1355 05031000
*/*      IF UNABLE TO OBTAIN STORAGE FOR BUFFER                      */ 05032000
*        IF RETCODE7 = TSCNOSTO                                    1355 05033000
*/*        THEN INDICATE SEVERE ERROR                                */ 05034000
*          THEN DO;    LASTCOND = LASTCC12; END;                   1355 05035000
         CLC   RETCODE7(4),@CF00136                                1355 05036000
         BNE   @RF01355                                            1355 05037000
         L     @06,@PC00001+8                                      1357 05038000
         MVC   LASTCOND(2,@06),@CH00265                            1357 05039000
*/*      IF TRACK CHECKS OUT GOOD                                    */ 05040000
*        IF RETCODE7 = TRACKOK                                     1359 05041000
*/*        THEN SAVE THE TRACK STATUS                                */ 05042000
*          THEN DO;    TRSTATUS = TSCGOOD; END;                    1359 05043000
@RF01355 L     @06,RETCODE7                                        1359 05044000
         LTR   @06,@06                                             1359 05045000
         BNZ   @RF01359                                            1359 05046000
         OI    TRSTATUS,B'10000000'                                1361 05047000
*/*      IF TRACK CHECKS OUT DEFECTIVE                               */ 05048000
*        IF RETCODE7 = TRACKDEF                                    1363 05049000
*/*        THEN SAVE THE TRACK STATUS                                */ 05050000
*          THEN DO;    TRSTATUS = TSCBAD; END;                     1363 05051000
@RF01359 CLC   RETCODE7(4),@CF00165                                1363 05052000
         BNE   @RF01363                                            1363 05053000
         NI    TRSTATUS,B'01111111'                                1365 05054000
*/*      END-ELSE                                                    */ 05055000
*        END;                                                      1367 05056000
@RF01363 DS    0H                                                  1368 05057000
*/*  WRITE STANDARD-LENGTH RECORD-ZERO (UDEVOP)                      */ 05058000
*    IF RZCCHH = CTRADDR                                           1368 05059000
*      THEN DO;    RZACTION = ACTWRZS; END;                        1368 05060000
@RC01340 CLC   RZCCHH(4),CTRADDR                                   1368 05061000
         BNE   @RF01368                                            1368 05062000
         MVC   RZACTION(4),@CF00161                                1370 05063000
*      ELSE DO;    RZACTION = ACTWRZSL; END;                       1372 05064000
         B     @RC01368                                            1372 05065000
@RF01368 DS    0H                                                  1373 05066000
         MVC   RZACTION(4),@CF00276                                1373 05067000
*    CALL ICKDVOP0 (GDTTBL                                         1375 05068000
*           ,VOLIB                                                 1375 05069000
*           ,RZACTION                                              1375 05070000
*           ,CTRADDR                                               1375 05071000
*           ,RECNUM                                                1375 05072000
*           ,POOLID                                                1375 05073000
*           ,ADDR (RZCCHH)                                         1375 05074000
*           ,LENGTH (RZCCHH)                                       1375 05075000
*           ,RETCODE7);                                            1375 05076000
@RC01368 L     @06,@PC00001                                        1375 05077000
         ST    @06,@AL00001                                        1375 05078000
         LA    @15,VOLIB                                           1375 05079000
         ST    @15,@AL00001+4                                      1375 05080000
         LA    @15,RZACTION                                        1375 05081000
         ST    @15,@AL00001+8                                      1375 05082000
         LA    @15,CTRADDR                                         1375 05083000
         ST    @15,@AL00001+12                                     1375 05084000
         LA    @15,RECNUM                                          1375 05085000
         ST    @15,@AL00001+16                                     1375 05086000
         LA    @15,POOLID                                          1375 05087000
         ST    @15,@AL00001+20                                     1375 05088000
         LA    @15,RZCCHH                                          1375 05089000
         ST    @15,@AFTEMPS                                        1375 05090000
         LA    @15,@AFTEMPS                                        1375 05091000
         ST    @15,@AL00001+24                                     1375 05092000
         LA    @15,@CF00044                                        1375 05093000
         ST    @15,@AL00001+28                                     1375 05094000
         LA    @15,RETCODE7                                        1375 05095000
         ST    @15,@AL00001+32                                     1375 05096000
         L     @15,GDTDOP(,@06)                                    1375 05097000
         LA    @01,@AL00001                                        1375 05098000
         BALR  @14,@15                                             1375 05099000
*/*  IF DEFECT-FLAG SET DUE TO RECOVERY                              */ 05100000
*    IF RETCODE7 = DFLAGONA | RETCODE7 = DFLAGONP                  1376 05101000
*/*    THEN INDICATE THAT THE TRACK CHECKS OUT DEFECTIVE ANYWAY      */ 05102000
*      THEN DO;    TRSTATUS = TSCBAD; END;                         1376 05103000
         L     @06,RETCODE7                                        1376 05104000
         CH    @06,@CH00119                                        1376 05105000
         BE    @RT01376                                            1376 05106000
         CH    @06,@CH00116                                        1376 05107000
         BNE   @RF01376                                            1376 05108000
@RT01376 DS    0H                                                  1377 05109000
         NI    TRSTATUS,B'01111111'                                1378 05110000
*/*    ELSE                                                          */ 05111000
*      ELSE DO;                                                    1380 05112000
*                                                                  1380 05113000
         B     @RC01376                                            1380 05114000
@RF01376 DS    0H                                                  1381 05115000
*/*      IF UNABLE TO WRITE THE RECORD 0                             */ 05116000
*        IF RETCODE7 = CPFAILS                                     1381 05117000
*/*        THEN COUNT_UNRECOVERABLE_TRACKS                           */ 05118000
*          THEN DO;                                                1381 05119000
*                                                                  1381 05120000
         CLC   RETCODE7(4),@CF00044                                1381 05121000
         BNE   @RF01381                                            1381 05122000
*            UNTRACK = CTRADDR;                                    1383 05123000
         MVC   UNTRACK(4),CTRADDR                                  1383 05124000
*            IF TRACKTYP = PRITRACK                                1384 05125000
*              THEN DO;    UNTRTYPE = PRITRACK; END;               1384 05126000
         TM    TRACKTYP,B'10000000'                                1384 05127000
         BNO   @RF01384                                            1384 05128000
         OI    UNTRTYPE,B'10000000'                                1386 05129000
*              ELSE DO;    UNTRTYPE = ALTTRACK; END;               1388 05130000
         B     @RC01384                                            1388 05131000
@RF01384 DS    0H                                                  1389 05132000
         NI    UNTRTYPE,B'01111111'                                1389 05133000
*            CALL COUNTRKS;                                        1391 05134000
@RC01384 BAL   @14,COUNTRKS                                        1391 05135000
*            END;                                                  1392 05136000
*/*      END-ELSE                                                    */ 05137000
*        END;                                                      1393 05138000
*/*  END-SUB-PROCEDURE ISSUE_CHECK_TRACK_SURFACE                     */ 05139000
*                                                                  1394 05140000
*                                                                  1394 05141000
*    END CHEKTRAK;                                                 1394 05142000
*                                                                  1394 05143000
@EL00012 DS    0H                                                  1394 05144000
@EF00012 DS    0H                                                  1394 05145000
@ER00012 LM    @14,@12,@SA00012                                    1394 05146000
         BR    @14                                                 1394 05147000
         EJECT                                                          05148000
*/*****  START OF SPECIFICATIONS  ************************************/ 05149000
*/*                                                                  */ 05150000
*/*  SUB-PROCEDURE NAME:  RECATRAK                                   */ 05151000
*/*                                                                  */ 05152000
*/*  DESCRIPTIVE NAME:  RECLAIM ALTERNATE TRACK                      */ 05153000
*/*                                                                  */ 05154000
*/*  FUNCTION:                                                       */ 05155000
*/*                                                                  */ 05156000
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION WHICH      */ 05157000
*/*    RECLAIMS AN ALTERNATE TRACK WHICH WAS FOUND TO BE WITHOUT     */ 05158000
*/*    DEFECT. THE CONDITION CODE PROCESSING AFTER THE INVOCATION    */ 05159000
*/*    IS ALSO HANDLED IN THIS SUB-PROCEDURE. APPROPRIATE MESSAGES   */ 05160000
*/*    ARE WRITTEN TO INDICATE THE RESULT OF THE RECLAMATION ATTEMPT.*/ 05161000
*/*                                                                  */ 05162000
*/*****  END OF SPECIFICATIONS  **************************************/ 05163000
*                                                                  1395 05164000
*                                                                  1395 05165000
*/*  SUB-PROCEDURE ISSUE_RECLAIM_ALTERNATE_TRACK                     */ 05166000
*    RECATRAK:                                                     1395 05167000
*      PROCEDURE;                                                  1395 05168000
*                                                                  1395 05169000
RECATRAK STM   @14,@12,@SA00013                                    1395 05170000
*      DCL RETCODE8          /* RETURN CODE FROM CALLED PROGRAMS     */ 05171000
*                            FIXED (31);                           1396 05172000
*                                                                  1396 05173000
*    OLDERID2 = NEWERID2;                                          1397 05174000
         L     @06,@PC00001                                        1397 05175000
         L     @03,GDTTR2(,@06)                                    1397 05176000
         MVC   @TS00001(95),NEWERID2(@03)                          1397 05177000
         MVC   OLDERID2(95,@03),@TS00001                           1397 05178000
*    NEWID2 = 'ITRA';                                              1398 05179000
         MVC   NEWID2(4,@03),@CC00963                              1398 05180000
*/*  SAVE THE NUMBER OF AVAILABLE ALTERNATE TRACKS                   */ 05181000
*    SALTCNT = ALTCOUNT;                                           1399 05182000
         L     SALTCNT,ALTCOUNT                                    1399 05183000
*/*  RECLAIM_ALTERNATE_TRACK                                         */ 05184000
*    CALL ICKRT01                                                  1400 05185000
*         (GDTTBL                                                  1400 05186000
*         ,VOLIB                                                   1400 05187000
*         ,CTRADDR                                                 1400 05188000
*         ,ALTCOUNT                                                1400 05189000
*         ,ALTPTR                                                  1400 05190000
*         ,RETCODE8);                                              1400 05191000
         ST    @06,@AL00001                                        1400 05192000
         LA    @06,VOLIB                                           1400 05193000
         ST    @06,@AL00001+4                                      1400 05194000
         LA    @06,CTRADDR                                         1400 05195000
         ST    @06,@AL00001+8                                      1400 05196000
         LA    @06,ALTCOUNT                                        1400 05197000
         ST    @06,@AL00001+12                                     1400 05198000
         LA    @06,ALTPTR                                          1400 05199000
         ST    @06,@AL00001+16                                     1400 05200000
         LA    @06,RETCODE8                                        1400 05201000
         ST    @06,@AL00001+20                                     1400 05202000
         L     @15,@CV00964                                        1400 05203000
         LA    @01,@AL00001                                        1400 05204000
         BALR  @14,@15                                             1400 05205000
*/*  IF RECLAMATION FAILS AND THE TRACK WAS FOUND TO BE UNRECOVERABLE*/ 05206000
*    IF RETCODE8 = REAFAIL                                         1401 05207000
*/*    THEN                                                          */ 05208000
*      THEN DO;                                                    1401 05209000
*                                                                  1401 05210000
         CLC   RETCODE8(4),@CF00116                                1401 05211000
         BNE   @RF01401                                            1401 05212000
*/*      ISSUE_BUILD_PACK_MAP (TRACK FLAGGED DEFECTIVE)              */ 05213000
*        PACKDEF  = DEFECTIV;                                      1403 05214000
         OI    PACKDEF,B'10000000'                                 1403 05215000
*        PACKCHEK = NODEFECT;                                      1404 05216000
         NI    PACKCHEK,B'01111111'                                1404 05217000
*        PACKRCVR = RCVRYES;                                       1405 05218000
         NI    PACKRCVR,B'01111111'                                1405 05219000
*        PACKTRK  = ALTTRACK;                                      1406 05220000
         NI    PACKTRK,B'01111111'                                 1406 05221000
*        PACKTRAK = CTRADDR;                                       1407 05222000
         MVC   PACKTRAK(4),CTRADDR                                 1407 05223000
*        PACKASC = RZCCHH;                                         1408 05224000
         MVC   PACKASC(4),RZCCHH                                   1408 05225000
*        CALL BILDPACK;                                            1409 05226000
         BAL   @14,BILDPACK                                        1409 05227000
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */ 05228000
*        UNTRACK = CTRADDR;                                        1410 05229000
         MVC   UNTRACK(4),CTRADDR                                  1410 05230000
*        UNTRTYPE = ALTTRACK;                                      1411 05231000
         NI    UNTRTYPE,B'01111111'                                1411 05232000
*        CALL COUNTRKS;                                            1412 05233000
         BAL   @14,COUNTRKS                                        1412 05234000
*/*      END-THEN (RECLAMATION FAILS)                                */ 05235000
*        END;                                                      1413 05236000
*/*    ELSE                                                          */ 05237000
*      ELSE DO;                                                    1414 05238000
*                                                                  1414 05239000
         B     @RC01401                                            1414 05240000
@RF01401 DS    0H                                                  1415 05241000
*/*      IF RECLAMATION IS SUCCESSFUL                                */ 05242000
*        IF RETCODE8 = SUCCESS                                     1415 05243000
*/*        THEN                                                      */ 05244000
*          THEN DO;                                                1415 05245000
*                                                                  1415 05246000
         L     @06,RETCODE8                                        1415 05247000
         LTR   @06,@06                                             1415 05248000
         BNZ   @RF01415                                            1415 05249000
*/*          SET ARGUMENT FOR PROPER MESSAGE (MSGRCLA)               */ 05250000
*            DARGSENT = MSGRCLA;                                   1417 05251000
         L     @06,DDSTRU                                          1417 05252000
         MVI   DARGSENT(@06),X'15'                                 1417 05253000
*/*          INDICATE THAT AN ALTERNATE TRACK IS AVAILABLE           */ 05254000
*            ALTFLAG = MOREYES;                                    1418 05255000
         NI    ALTFLAG,B'01111111'                                 1418 05256000
*/*          SAVE INDICATION THAT THE DEFECT-FLAG IS NOT SET         */ 05257000
*            DFLAGC = NODEFECT;                                    1419 05258000
         NI    DFLAGC,B'01111111'                                  1419 05259000
*/*          END-THEN                                                */ 05260000
*            END;                                                  1420 05261000
*/*        ELSE (RECLAMATION FAILS BUT TRACK RECOVERABLE)            */ 05262000
*          ELSE DO;                                                1421 05263000
*                                                                  1421 05264000
         B     @RC01415                                            1421 05265000
@RF01415 DS    0H                                                  1422 05266000
*/*          SET ARGUMENT FOR PROPER MESSAGE (MSGRCLAF)              */ 05267000
*            DARGSENT = MSGRCLAF;                                  1422 05268000
         L     @06,DDSTRU                                          1422 05269000
         MVI   DARGSENT(@06),X'1F'                                 1422 05270000
*/*          SAVE INDICATION THAT THE DEFECT-FLAG IS SET DUE TO      */ 05271000
*/*           RECOVERY                                               */ 05272000
*            DFLAGC = DEFECTIV;                                    1423 05273000
         OI    DFLAGC,B'10000000'                                  1423 05274000
*/*          ISSUE_BUILD_PACK_MAP                                    */ 05275000
*            PACKDEF = DEFECTIV;                                   1424 05276000
         OI    PACKDEF,B'10000000'                                 1424 05277000
*            PACKCHEK = NODEFECT;                                  1425 05278000
         NI    PACKCHEK,B'01111111'                                1425 05279000
*            PACKRCVR = RCVRYES;                                   1426 05280000
         NI    PACKRCVR,B'01111111'                                1426 05281000
*            PACKTRK = ALTTRACK;                                   1427 05282000
         NI    PACKTRK,B'01111111'                                 1427 05283000
*            PACKTRAK = CTRADDR;                                   1428 05284000
         MVC   PACKTRAK(4),CTRADDR                                 1428 05285000
*            PACKASC = RZCCHH;                                     1429 05286000
         MVC   PACKASC(4),RZCCHH                                   1429 05287000
*            CALL BILDPACK;                                        1430 05288000
         BAL   @14,BILDPACK                                        1430 05289000
*/*          END-ELSE                                                */ 05290000
*            END;                                                  1431 05291000
*/*      ISSUE MESSAGE (UPRINT)                                      */ 05292000
*        DARGCNT = 2;                                              1432 05293000
@RC01415 LA    @06,2                                               1432 05294000
         L     @03,DDSTRU                                          1432 05295000
         STH   @06,DARGCNT(,@03)                                   1432 05296000
*        DARGINS (1) = 1;                                          1433 05297000
         MVC   DARGINS(2,@03),@CH00165                             1433 05298000
*        DARGINL (1) = LENGTH (CTRADDRC);                          1434 05299000
         STH   @06,DARGINL(,@03)                                   1434 05300000
*        DARGDTM (1) = ADDR (CTRADDRC);                            1435 05301000
         LA    @15,CTRADDRC                                        1435 05302000
         ST    @15,DARGDTM(,@03)                                   1435 05303000
*        DARGINS (2) = 2;                                          1436 05304000
         STH   @06,DARGINS+8(,@03)                                 1436 05305000
*        DARGINL (2) = LENGTH (CTRADDRT);                          1437 05306000
         STH   @06,DARGINL+8(,@03)                                 1437 05307000
*        DARGDTM (2) = ADDR (CTRADDRT);                            1438 05308000
         LA    @06,CTRADDRT                                        1438 05309000
         ST    @06,DARGDTM+8(,@03)                                 1438 05310000
*        CALL ICKTPPR0 (GDTTBL                                     1439 05311000
*               ,PRTFILE                                           1439 05312000
*               ,DDSTRU);                                          1439 05313000
         L     @06,@PC00001                                        1439 05314000
         ST    @06,@AL00001                                        1439 05315000
         LA    @03,@CF00094                                        1439 05316000
         ST    @03,@AL00001+4                                      1439 05317000
         LA    @03,DDSTRU                                          1439 05318000
         ST    @03,@AL00001+8                                      1439 05319000
         MVI   @AL00001+8,X'80'                                    1439 05320000
         L     @15,GDTPRT(,@06)                                    1439 05321000
         LA    @01,@AL00001                                        1439 05322000
         BALR  @14,@15                                             1439 05323000
*/*      END-ELSE                                                    */ 05324000
*        END;                                                      1440 05325000
*/*  ADJUST THE NUMBER OF AVAILABLE ALTERNATE TRACKS                 */ 05326000
*    IF ALTCOUNT > SALTCNT                                         1441 05327000
*      THEN DO;                                                    1441 05328000
@RC01401 C     SALTCNT,ALTCOUNT                                    1441 05329000
         BNL   @RF01441                                            1441 05330000
*        IF CTRADDR >= TALPTR                                      1443 05331000
*          THEN DO;    TALCNT = TALCNT + 1; END;                   1443 05332000
         CLC   CTRADDR(4),TALPTR                                   1443 05333000
         BL    @RF01443                                            1443 05334000
         LA    @06,1                                               1445 05335000
         AL    @06,TALCNT                                          1445 05336000
         ST    @06,TALCNT                                          1445 05337000
*        IF (TALPTRT > 0 & CTRADDRC = TALPTRC &                    1447 05338000
*                          CTRADDRT = TALPTRT - 1) |               1447 05339000
*           (TALPTRT = 0 & CTRADDRC = TALPTRC - 1 &                1447 05340000
*                          CTRADDRT = TRKSPCYL - 1)                1447 05341000
*          THEN DO;                                                1447 05342000
@RF01443 MVC   @ZT00002+2(2),TALPTRT                               1447 05343000
         L     @06,@ZT00002                                        1447 05344000
         LTR   @06,@06                                             1447 05345000
         BNP   @GL00081                                            1447 05346000
         CLC   CTRADDRC(2),TALPTRC                                 1447 05347000
         BNE   @GL00081                                            1447 05348000
         BCTR  @06,0                                               1447 05349000
         MVC   @ZT00002+2(2),CTRADDRT                              1447 05350000
         C     @06,@ZT00002                                        1447 05351000
         BE    @RT01447                                            1447 05352000
@GL00081 MVC   @ZT00002+2(2),TALPTRT                               1447 05353000
         L     @06,@ZT00002                                        1447 05354000
         LTR   @06,@06                                             1447 05355000
         BNZ   @RF01447                                            1447 05356000
         MVC   @ZT00002+2(2),TALPTRC                               1447 05357000
         L     @06,@ZT00002                                        1447 05358000
         BCTR  @06,0                                               1447 05359000
         MVC   @ZT00002+2(2),CTRADDRC                              1447 05360000
         C     @06,@ZT00002                                        1447 05361000
         BNE   @RF01447                                            1447 05362000
         L     @06,INFOPTR+12                                      1447 05363000
         L     @06,TRKSPCYL(,@06)                                  1447 05364000
         BCTR  @06,0                                               1447 05365000
         MVC   @ZT00002+2(2),CTRADDRT                              1447 05366000
         C     @06,@ZT00002                                        1447 05367000
         BNE   @RF01447                                            1447 05368000
@RT01447 DS    0H                                                  1448 05369000
*            TALPTR = CTRADDR;                                     1449 05370000
         MVC   TALPTR(4),CTRADDR                                   1449 05371000
*            TALCNT = TALCNT + 1;                                  1450 05372000
         LA    @06,1                                               1450 05373000
         AL    @06,TALCNT                                          1450 05374000
         ST    @06,TALCNT                                          1450 05375000
*            END;                                                  1451 05376000
*        END;                                                      1452 05377000
*/*  END-SUB-PROCEDURE ISSUE_RECLAIM_ALTERNATE_TRACK                 */ 05378000
*    END RECATRAK;                                                 1453 05379000
*                                                                  1453 05380000
@EL00013 DS    0H                                                  1453 05381000
@EF00013 DS    0H                                                  1453 05382000
@ER00013 LM    @14,@12,@SA00013                                    1453 05383000
         BR    @14                                                 1453 05384000
         EJECT                                                          05385000
*/*****  START OF SPECIFICATIONS  ************************************/ 05386000
*/*                                                                  */ 05387000
*/*  SUB-PROCEDURE NAME:  RECPTRAK                                   */ 05388000
*/*                                                                  */ 05389000
*/*  DESCRIPTIVE NAME:  ISSUE RECLAIM PRIMARY TRACK                  */ 05390000
*/*                                                                  */ 05391000
*/*  FUNCTION:                                                       */ 05392000
*/*                                                                  */ 05393000
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION WHICH      */ 05394000
*/*    RECLAIMS A PRIMARY TRACK THAT HAS BEEN DETERMINED TO BE A     */ 05395000
*/*    USABLE TRACK. ALL THE CONDITION CODE PROCESSING AFTER THE     */ 05396000
*/*    INVOCATION IS HANDLED HERE.                                   */ 05397000
*/*    IN THE EVENT THAT AN ALTERNATE TRACK, ASSOCIATED WITH THIS    */ 05398000
*/*    PRIMARY TRACK, IS NOT SUCCESSFULLY DISSOCIATED BUT HAS ITS    */ 05399000
*/*    DEFECT-FLAG SET DUE TO ERROR RECOVERY, A WARNING MESSAGE      */ 05400000
*/*    ABOUT THAT TRACK IS POSTED AND PROCESSING CONTINUED, BUT      */ 05401000
*/*    NOTE THAT THE DATA WILL BE LOST IN THIS CASE.                 */ 05402000
*/*                                                                  */ 05403000
*/*****  END OF SPECIFICATIONS  **************************************/ 05404000
*                                                                  1454 05405000
*                                                                  1454 05406000
*/*  SUB-PROCEDURE ISSUE_RECLAIM_PRIMARY_TRACK                       */ 05407000
*    RECPTRAK:                                                     1454 05408000
*      PROCEDURE;                                                  1454 05409000
*                                                                  1454 05410000
RECPTRAK STM   @14,@12,@SA00014                                    1454 05411000
*      DCL RETCODE9          /* RETURN CODE FROM CALLED PROGRAMS     */ 05412000
*                            FIXED (31);                           1455 05413000
*                                                                  1455 05414000
*    OLDERID2 = NEWERID2;                                          1456 05415000
         L     @06,@PC00001                                        1456 05416000
         L     @15,GDTTR2(,@06)                                    1456 05417000
         MVC   @TS00001(95),NEWERID2(@15)                          1456 05418000
         MVC   OLDERID2(95,@15),@TS00001                           1456 05419000
*    NEWID2 = 'ITRP';                                              1457 05420000
         MVC   NEWID2(4,@15),@CC00969                              1457 05421000
*/*  IF NO SEVERE ERRORS FOUND, TRACK RECOVERABLE                    */ 05422000
*    IF (LASTCOND < LASTCC12) & (RCVRFLAG = RECOVER)               1458 05423000
*/*    THEN                                                          */ 05424000
*      THEN DO;                                                    1458 05425000
*                                                                  1458 05426000
         L     @15,@PC00001+8                                      1458 05427000
         LH    @15,LASTCOND(,@15)                                  1458 05428000
         CH    @15,@CH00265                                        1458 05429000
         BNL   @RF01458                                            1458 05430000
         TM    RCVRFLAG,B'10000000'                                1458 05431000
         BNO   @RF01458                                            1458 05432000
*/*      SAVE THE NUMBER OF AVAILABLE ALTERNATE TRACKS               */ 05433000
*        SALTCNT = ALTCOUNT;                                       1460 05434000
         L     SALTCNT,ALTCOUNT                                    1460 05435000
*/*      RECLAIM_PRIMARY_TRACK                                       */ 05436000
*        CALL ICKRP01                                              1461 05437000
*             (GDTTBL                                              1461 05438000
*             ,VOLIB                                               1461 05439000
*             ,CTRADDR                                             1461 05440000
*             ,RZCCHH                                              1461 05441000
*             ,ALTCOUNT                                            1461 05442000
*             ,ALTPTR                                              1461 05443000
*             ,RETCODE9);                                          1461 05444000
         ST    @06,@AL00001                                        1461 05445000
         LA    @06,VOLIB                                           1461 05446000
         ST    @06,@AL00001+4                                      1461 05447000
         LA    @06,CTRADDR                                         1461 05448000
         ST    @06,@AL00001+8                                      1461 05449000
         LA    @06,RZCCHH                                          1461 05450000
         ST    @06,@AL00001+12                                     1461 05451000
         LA    @06,ALTCOUNT                                        1461 05452000
         ST    @06,@AL00001+16                                     1461 05453000
         LA    @06,ALTPTR                                          1461 05454000
         ST    @06,@AL00001+20                                     1461 05455000
         LA    @06,RETCODE9                                        1461 05456000
         ST    @06,@AL00001+24                                     1461 05457000
         L     @15,@CV00970                                        1461 05458000
         LA    @01,@AL00001                                        1461 05459000
         BALR  @14,@15                                             1461 05460000
*/*      IF RECLAMATION SUCCEEDS                                     */ 05461000
*        IF RETCODE9 = SUCCESS                                     1462 05462000
*/*        THEN                                                      */ 05463000
*          THEN DO;                                                1462 05464000
*                                                                  1462 05465000
         L     @06,RETCODE9                                        1462 05466000
         LTR   @06,@06                                             1462 05467000
         BNZ   @RF01462                                            1462 05468000
*/*          SET MESSAGE ARGUMENT (MSGRCLP)                          */ 05469000
*            DARGSENT = MSGRCLP;                                   1464 05470000
         L     @06,DDSTRU                                          1464 05471000
         MVI   DARGSENT(@06),X'16'                                 1464 05472000
*/*          SAVE THE DEFECT-FLAG RESETTING                          */ 05473000
*            DFLAGC = NODEFECT;                                    1465 05474000
         NI    DFLAGC,B'01111111'                                  1465 05475000
*/*          IF THE PRIMARY WAS ASSOCIATED WITH AN ALTERNATE         */ 05476000
*            IF ASSOCFLG = ASSOCYES                                1466 05477000
*/*            THEN                                                  */ 05478000
*              THEN DO;                                            1466 05479000
         TM    ASSOCFLG,B'10000000'                                1466 05480000
         BNO   @RF01466                                            1466 05481000
*/*              INDICATE AN ALTERNATE TRACK EXISTS                  */ 05482000
*                ALTFLAG = MOREYES;                                1468 05483000
         NI    ALTFLAG,B'01111111'                                 1468 05484000
*/*              END-THEN                                            */ 05485000
*                END;                                              1469 05486000
*/*          IF PRESERVE IS SPECIFIED                                */ 05487000
*            IF ADDR(PRESV) ^= NULLPTR                             1470 05488000
*/*            THEN                                                  */ 05489000
*              THEN DO;                                            1470 05490000
*                                                                  1470 05491000
@RF01466 L     @06,@PC00001+4                                      1470 05492000
         L     @06,FDTPTR+4(,@06)                                  1470 05493000
         LTR   @06,@06                                             1470 05494000
         BZ    @RF01470                                            1470 05495000
*/*              IF TRACK WAS ASSOCIATED WITH AN ALTERNATE AND       */ 05496000
*/*               TRACK CONTENTS WERE READ                           */ 05497000
*                IF ASSOCFLG = ASSOCYES & TRKREAD = READYES        1472 05498000
*/*                THEN WRITE_TRACK_CONTENTS (ON THE PRIMARY)        */ 05499000
*                  THEN DO;                                        1472 05500000
*                                                                  1472 05501000
         TM    ASSOCFLG,B'10000000'                                1472 05502000
         BNO   @RF01472                                            1472 05503000
         TM    TRKREAD,B'10000000'                                 1472 05504000
         BNO   @RF01472                                            1472 05505000
*                    CALL WRITRACK                                 1474 05506000
*                         (CTRADDR);                               1474 05507000
         LA    @06,CTRADDR                                         1474 05508000
         ST    @06,@AL00001                                        1474 05509000
         LA    @01,@AL00001                                        1474 05510000
         BAL   @14,WRITRACK                                        1474 05511000
*                    END;                                          1475 05512000
*/*              END-THEN                                            */ 05513000
*                END;                                              1476 05514000
*/*          END-THEN                                                */ 05515000
*            END;                                                  1477 05516000
*/*        ELSE                                                      */ 05517000
*          ELSE DO;                                                1478 05518000
         B     @RC01462                                            1478 05519000
@RF01462 DS    0H                                                  1479 05520000
*/*          IF RECLAMATION FAILS AND TRACK IS UNRECOVERABLE         */ 05521000
*            IF RETCODE9 = REPFAIL                                 1479 05522000
*/*            THEN COUNT_UNRECOVERABLE_TRACKS (PRIMARY TRACK)       */ 05523000
*              THEN DO;                                            1479 05524000
*                                                                  1479 05525000
         CLC   RETCODE9(4),@CF00116                                1479 05526000
         BNE   @RF01479                                            1479 05527000
*                UNTRACK = CTRADDR;                                1481 05528000
         MVC   UNTRACK(4),CTRADDR                                  1481 05529000
*                UNTRTYPE = PRITRACK;                              1482 05530000
         OI    UNTRTYPE,B'10000000'                                1482 05531000
*                CALL COUNTRKS;                                    1483 05532000
         BAL   @14,COUNTRKS                                        1483 05533000
*                END;                                              1484 05534000
*/*          IF DISSOCIATION FAILS AND TRACK IS UNRECOVERABLE        */ 05535000
*            IF RETCODE9 = DISFAILU                                1485 05536000
*/*            THEN COUNT_UNRECOVERABLE_TRACKS (ALTERNATE TRACK)     */ 05537000
*              THEN DO;                                            1485 05538000
*                                                                  1485 05539000
@RF01479 CLC   RETCODE9(4),@CF00044                                1485 05540000
         BNE   @RF01485                                            1485 05541000
*                UNTRACK = RZCCHH;                                 1487 05542000
         MVC   UNTRACK(4),RZCCHH                                   1487 05543000
*                UNTRTYPE = ALTTRACK;                              1488 05544000
         NI    UNTRTYPE,B'01111111'                                1488 05545000
*                CALL COUNTRKS;                                    1489 05546000
         BAL   @14,COUNTRKS                                        1489 05547000
*                END;                                              1490 05548000
*/*          IF RECLAMATION FAILS BUT TRACK IS RECOVERED             */ 05549000
*            IF RETCODE9 = REPFAILR                                1491 05550000
*/*            THEN                                                  */ 05551000
*              THEN DO;                                            1491 05552000
*                                                                  1491 05553000
@RF01485 CLC   RETCODE9(4),@CF00165                                1491 05554000
         BNE   @RF01491                                            1491 05555000
*/*              SET MESSAGE ARGUMENT (MSGRCLPF)                     */ 05556000
*                DARGSENT = MSGRCLPF;                              1493 05557000
         L     @06,DDSTRU                                          1493 05558000
         MVI   DARGSENT(@06),X'20'                                 1493 05559000
*/*              ISSUE_BUILD_PACK_MAP (TRACK DEFECT-FLAG STILL SET)  */ 05560000
*                PACKDEF  = DEFECTIV;                              1494 05561000
         OI    PACKDEF,B'10000000'                                 1494 05562000
*                PACKCHEK = NODEFECT;                              1495 05563000
         NI    PACKCHEK,B'01111111'                                1495 05564000
*                PACKRCVR = RCVRYES;                               1496 05565000
         NI    PACKRCVR,B'01111111'                                1496 05566000
*                PACKTRK  = PRITRACK;                              1497 05567000
         OI    PACKTRK,B'10000000'                                 1497 05568000
*                PACKTRAK = CTRADDR;                               1498 05569000
         MVC   PACKTRAK(4),CTRADDR                                 1498 05570000
*                PACKASC = RZCCHH;                                 1499 05571000
         MVC   PACKASC(4),RZCCHH                                   1499 05572000
*                CALL BILDPACK;                                    1500 05573000
         BAL   @14,BILDPACK                                        1500 05574000
*/*              SAVE THE DEFECT-FLAG RESETTING                      */ 05575000
*                DFLAGC = DEFECTIV;                                1501 05576000
         OI    DFLAGC,B'10000000'                                  1501 05577000
*/*              END-THEN                                            */ 05578000
*                END;                                              1502 05579000
*/*          IF DISSOCIATION FAILS BUT TRACK RECOVERED               */ 05580000
*            IF RETCODE9 = DISFAILR                                1503 05581000
*/*            THEN                                                  */ 05582000
*              THEN DO;                                            1503 05583000
*                                                                  1503 05584000
@RF01491 CLC   RETCODE9(4),@CF00136                                1503 05585000
         BNE   @RF01503                                            1503 05586000
*/*              SAVE THE DEFECT-FLAG RESETTING                      */ 05587000
*                DFLAGC = NODEFECT;                                1505 05588000
         NI    DFLAGC,B'01111111'                                  1505 05589000
*/*              SET WARNING MESSAGE ARGUMENT (MSGDISPF)             */ 05590000
*                DARGSENT = MSGDISPF;                              1506 05591000
         L     @06,DDSTRU                                          1506 05592000
         MVI   DARGSENT(@06),X'21'                                 1506 05593000
*/*              ISSUE_BUILD_PACK_MAP (ALTERNATE TRACK DEF-FLAG SET) */ 05594000
*                PACKDEF  = DEFECTIV;                              1507 05595000
         OI    PACKDEF,B'10000000'                                 1507 05596000
*                PACKCHEK = NODEFECT;                              1508 05597000
         NI    PACKCHEK,B'01111111'                                1508 05598000
*                PACKRCVR = RCVRYES;                               1509 05599000
         NI    PACKRCVR,B'01111111'                                1509 05600000
*                PACKTRK  = ALTTRACK;                              1510 05601000
         NI    PACKTRK,B'01111111'                                 1510 05602000
*                PACKTRAK = RZCCHH;                                1511 05603000
         L     @06,RZCCHH                                          1511 05604000
         ST    @06,PACKTRAK                                        1511 05605000
*                PACKASC = RZCCHH;                                 1512 05606000
         ST    @06,PACKASC                                         1512 05607000
*                CALL BILDPACK;                                    1513 05608000
         BAL   @14,BILDPACK                                        1513 05609000
*/*              INDICATE MINOR ERROR (LASTCOND = 4)                 */ 05610000
*                LASTCOND = MAX (LASTCOND,LASTCC04);               1514 05611000
         L     @06,@PC00001+8                                      1514 05612000
         LH    @03,LASTCOND(,@06)                                  1514 05613000
         LA    @15,4                                               1514 05614000
         CR    @03,@15                                             1514 05615000
         BNL   *+6                                                      05616000
         LR    @03,@15                                             1514 05617000
         STH   @03,LASTCOND(,@06)                                  1514 05618000
*/*              END-THEN                                            */ 05619000
*                END;                                              1515 05620000
*/*          END-ELSE (RECLAMATION UNSUCCESSFUL)                     */ 05621000
*            END;                                                  1516 05622000
@RF01503 DS    0H                                                  1517 05623000
*/*      IF A MESSAGE ARGUMENT WAS SET                               */ 05624000
*        IF (DARGSENT = MSGRCLP) | (DARGSENT = MSGRCLPF)           1517 05625000
*         | (DARGSENT = MSGDISPF)                                  1517 05626000
*/*        THEN ISSUE MESSAGE (UPRINT)                               */ 05627000
*          THEN DO;                                                1517 05628000
*                                                                  1517 05629000
@RC01462 L     @06,DDSTRU                                          1517 05630000
         CLI   DARGSENT(@06),22                                    1517 05631000
         BE    @RT01517                                            1517 05632000
         CLI   DARGSENT(@06),32                                    1517 05633000
         BE    @RT01517                                            1517 05634000
         CLI   DARGSENT(@06),33                                    1517 05635000
         BNE   @RF01517                                            1517 05636000
@RT01517 DS    0H                                                  1518 05637000
*            DARGCNT = 2;                                          1519 05638000
         LA    @06,2                                               1519 05639000
         L     @03,DDSTRU                                          1519 05640000
         STH   @06,DARGCNT(,@03)                                   1519 05641000
*            DARGINS (1) = 1;                                      1520 05642000
         MVC   DARGINS(2,@03),@CH00165                             1520 05643000
*            DARGINL (1) = LENGTH (CTRADDRC);                      1521 05644000
         STH   @06,DARGINL(,@03)                                   1521 05645000
*            DARGDTM (1) = ADDR (CTRADDRC);                        1522 05646000
         LA    @15,CTRADDRC                                        1522 05647000
         ST    @15,DARGDTM(,@03)                                   1522 05648000
*            DARGINS (2) = 2;                                      1523 05649000
         STH   @06,DARGINS+8(,@03)                                 1523 05650000
*            DARGINL (2) = LENGTH (CTRADDRT);                      1524 05651000
         STH   @06,DARGINL+8(,@03)                                 1524 05652000
*            DARGDTM (2) = ADDR (CTRADDRT);                        1525 05653000
         LA    @06,CTRADDRT                                        1525 05654000
         ST    @06,DARGDTM+8(,@03)                                 1525 05655000
*            CALL ICKTPPR0 (GDTTBL                                 1526 05656000
*                   ,PRTFILE                                       1526 05657000
*                   ,DDSTRU);                                      1526 05658000
         L     @06,@PC00001                                        1526 05659000
         ST    @06,@AL00001                                        1526 05660000
         LA    @03,@CF00094                                        1526 05661000
         ST    @03,@AL00001+4                                      1526 05662000
         LA    @03,DDSTRU                                          1526 05663000
         ST    @03,@AL00001+8                                      1526 05664000
         MVI   @AL00001+8,X'80'                                    1526 05665000
         L     @15,GDTPRT(,@06)                                    1526 05666000
         LA    @01,@AL00001                                        1526 05667000
         BALR  @14,@15                                             1526 05668000
*            END;                                                  1527 05669000
*/*      ADJUST THE NUMBER OF AVAILABLE ALTERNATE TRACKS             */ 05670000
*        IF ALTCOUNT > SALTCNT                                     1528 05671000
*          THEN DO;                                                1528 05672000
@RF01517 C     SALTCNT,ALTCOUNT                                    1528 05673000
         BNL   @RF01528                                            1528 05674000
*            IF RZCCHH >= TALPTR                                   1530 05675000
*              THEN DO;    TALCNT = TALCNT + 1; END;               1530 05676000
         CLC   RZCCHH(4),TALPTR                                    1530 05677000
         BL    @RF01530                                            1530 05678000
         LA    @06,1                                               1532 05679000
         AL    @06,TALCNT                                          1532 05680000
         ST    @06,TALCNT                                          1532 05681000
*            IF (TALPTRT > 0 & RZCCHHC = TALPTRC &                 1534 05682000
*                              RZCCHHT = TALPTRT - 1) |            1534 05683000
*               (TALPTRT = 0 & RZCCHHC = TALPTRC - 1 &             1534 05684000
*                              RZCCHHT = TRKSPCYL - 1)             1534 05685000
*              THEN DO;                                            1534 05686000
@RF01530 MVC   @ZT00002+2(2),TALPTRT                               1534 05687000
         L     @06,@ZT00002                                        1534 05688000
         LTR   @06,@06                                             1534 05689000
         BNP   @GL00090                                            1534 05690000
         CLC   RZCCHHC(2),TALPTRC                                  1534 05691000
         BNE   @GL00090                                            1534 05692000
         BCTR  @06,0                                               1534 05693000
         MVC   @ZT00002+2(2),RZCCHHT                               1534 05694000
         C     @06,@ZT00002                                        1534 05695000
         BE    @RT01534                                            1534 05696000
@GL00090 MVC   @ZT00002+2(2),TALPTRT                               1534 05697000
         L     @06,@ZT00002                                        1534 05698000
         LTR   @06,@06                                             1534 05699000
         BNZ   @RF01534                                            1534 05700000
         MVC   @ZT00002+2(2),TALPTRC                               1534 05701000
         L     @06,@ZT00002                                        1534 05702000
         BCTR  @06,0                                               1534 05703000
         MVC   @ZT00002+2(2),RZCCHHC                               1534 05704000
         C     @06,@ZT00002                                        1534 05705000
         BNE   @RF01534                                            1534 05706000
         L     @06,INFOPTR+12                                      1534 05707000
         L     @06,TRKSPCYL(,@06)                                  1534 05708000
         BCTR  @06,0                                               1534 05709000
         MVC   @ZT00002+2(2),RZCCHHT                               1534 05710000
         C     @06,@ZT00002                                        1534 05711000
         BNE   @RF01534                                            1534 05712000
@RT01534 DS    0H                                                  1535 05713000
*                TALPTR = RZCCHH;                                  1536 05714000
         MVC   TALPTR(4),RZCCHH                                    1536 05715000
*                TALCNT = TALCNT + 1;                              1537 05716000
         LA    @06,1                                               1537 05717000
         AL    @06,TALCNT                                          1537 05718000
         ST    @06,TALCNT                                          1537 05719000
*                END;                                              1538 05720000
*            END;                                                  1539 05721000
*/*      END-THEN                                                    */ 05722000
*        END;                                                      1540 05723000
*/*  END-SUB-PROCEDURE ISSUE_RECLAIM_PRIMARY_TRACK                   */ 05724000
*    END RECPTRAK;                                                 1541 05725000
*                                                                  1541 05726000
@EL00014 DS    0H                                                  1541 05727000
@EF00014 DS    0H                                                  1541 05728000
@ER00014 LM    @14,@12,@SA00014                                    1541 05729000
         BR    @14                                                 1541 05730000
         EJECT                                                          05731000
*/*****  START OF SPECIFICATIONS  ************************************/ 05732000
*/*                                                                  */ 05733000
*/*  SUB-PROCEDURE NAME:  WRIHARZD                                   */ 05734000
*/*                                                                  */ 05735000
*/*  DESCRIPTIVE NAME:  ISSUE MARK TRACK DEFECTIVE                   */ 05736000
*/*                                                                  */ 05737000
*/*  FUNCTION:                                                       */ 05738000
*/*                                                                  */ 05739000
*/*    THIS SUB-PROCEDURE WILL MARK THE CURRENT TRACK THAT IS BEING  */ 05740000
*/*    PROCESSED, DEFECTIVE BY SETTING THE DEFECT-FLAG IN THE        */ 05741000
*/*    HOME-ADDRESS. IN ADDITION IT WILL ALSO WRITE THE STANDARD-    */ 05742000
*/*    LENGTH RECORD-ZERO AND CREATE THE PROPER PACK MAP ENTRY.      */ 05743000
*/*                                                                  */ 05744000
*/*****  END OF SPECIFICATIONS  **************************************/ 05745000
*                                                                  1542 05746000
*                                                                  1542 05747000
*/*  SUB-PROCEDURE ISSUE_MARK_TRACK_DEFECTIVE                        */ 05748000
*    WRIHARZD:                                                     1542 05749000
*      PROCEDURE                                                   1542 05750000
*        (                                                         1542 05751000
*        WRIADDR,                                                  1542 05752000
*        WRITRTYP                                                  1542 05753000
*        );                                                        1542 05754000
*                                                                  1542 05755000
WRIHARZD STM   @14,@12,@SA00015                                    1542 05756000
         MVC   @PC00015(8),0(@01)                                  1542 05757000
*    DECLARE  /********  LOCAL PARAMETERS  ***************************/ 05758000
*                                                                  1543 05759000
*      1 WRIADDR,            /* ADDRESS OF TRACK TO BE EXAMINED      */ 05760000
*                                                                  1543 05761000
*        2 WRIADDRC          /* CYLINDER NUMBER                      */ 05762000
*                            FIXED (16),                           1543 05763000
*                                                                  1543 05764000
*        2 WRIADDRH          /* TRACK NUMBER                         */ 05765000
*                            FIXED (16),                           1543 05766000
*                                                                  1543 05767000
*                                                                  1543 05768000
*      WRITRTYP              /* FLAG TO INDICATE IF THE TRACK IS     */ 05769000
*                            /* A PRIMARY OR AN ALTERNATE            */ 05770000
*                            /* PRITRACK: PRIMARY                    */ 05771000
*                            /* ALTTRACK: ALTERNATE                  */ 05772000
*                            BIT (1),                              1543 05773000
*                                                                  1543 05774000
*      RETCODEA              /* RETURN CODE FROM CALLED PROGRAMS     */ 05775000
*                            FIXED (31);                           1543 05776000
*                                                                  1543 05777000
*    OLDERID2 = NEWERID2;                                          1544 05778000
         L     @06,@PC00001                                        1544 05779000
         L     @06,GDTTR2(,@06)                                    1544 05780000
         MVC   @TS00001(95),NEWERID2(@06)                          1544 05781000
         MVC   OLDERID2(95,@06),@TS00001                           1544 05782000
*    NEWID2 = 'ITWD';                                              1545 05783000
         MVC   NEWID2(4,@06),@CC00981                              1545 05784000
*/*  IF TRACK IS PRIMARY                                             */ 05785000
*    IF WRITRTYP = PRITRACK                                        1546 05786000
*/*    THEN SET ACTION KEY TO WRITE A HOME-ADDRESS WITH THE          */ 05787000
*/*     DEFECT-FLAG SET ON A PRIMARY TRACK                           */ 05788000
*      THEN DO;    HAACTION = ACTWPHAD; END;                       1546 05789000
         L     @06,@PC00015+4                                      1546 05790000
         TM    WRITRTYP(@06),B'10000000'                           1546 05791000
         BNO   @RF01546                                            1546 05792000
         MVC   HAACTION(4),@CF00136                                1548 05793000
*/*    ELSE SET ACTION KEY TO WRITE A HOME-ADDRESS WITH THE          */ 05794000
*/*     DEFECT-FLAG SET ON AN ALTERNATE TRACK                        */ 05795000
*      ELSE DO;    HAACTION = ACTWAHAD; END;                       1550 05796000
         B     @RC01546                                            1550 05797000
@RF01546 DS    0H                                                  1551 05798000
         MVC   HAACTION(4),@CF00255                                1551 05799000
*/*  ISSUE CALL TO UDEVOP FOR THE PROPER ACTION                      */ 05800000
*    CALL ICKDVOP0 (GDTTBL                                         1553 05801000
*           ,VOLIB                                                 1553 05802000
*           ,HAACTION                                              1553 05803000
*           ,WRIADDR                                               1553 05804000
*           ,RECNUM                                                1553 05805000
*           ,POOLID                                                1553 05806000
*           ,DATAPTR                                               1553 05807000
*           ,DATALEN                                               1553 05808000
*           ,RETCODEA);                                            1553 05809000
@RC01546 L     @06,@PC00001                                        1553 05810000
         ST    @06,@AL00001                                        1553 05811000
         LA    @15,VOLIB                                           1553 05812000
         ST    @15,@AL00001+4                                      1553 05813000
         LA    @15,HAACTION                                        1553 05814000
         ST    @15,@AL00001+8                                      1553 05815000
         L     @15,@PC00015                                        1553 05816000
         ST    @15,@AL00001+12                                     1553 05817000
         LA    @15,RECNUM                                          1553 05818000
         ST    @15,@AL00001+16                                     1553 05819000
         LA    @15,POOLID                                          1553 05820000
         ST    @15,@AL00001+20                                     1553 05821000
         LA    @15,DATAPTR                                         1553 05822000
         ST    @15,@AL00001+24                                     1553 05823000
         LA    @15,DATALEN                                         1553 05824000
         ST    @15,@AL00001+28                                     1553 05825000
         LA    @15,RETCODEA                                        1553 05826000
         ST    @15,@AL00001+32                                     1553 05827000
         L     @15,GDTDOP(,@06)                                    1553 05828000
         LA    @01,@AL00001                                        1553 05829000
         BALR  @14,@15                                             1553 05830000
*/*  IF WRITE OPERATION FAILS                                        */ 05831000
*    IF RETCODEA = CPFAILS                                         1554 05832000
*/*    THEN                                                          */ 05833000
*      THEN DO;                                                    1554 05834000
*                                                                  1554 05835000
         CLC   RETCODEA(4),@CF00044                                1554 05836000
         BNE   @RF01554                                            1554 05837000
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */ 05838000
*        IF WRITRTYP = PRITRACK                                    1556 05839000
*          THEN DO;    UNTRTYPE = PRITRACK; END;                   1556 05840000
         L     @06,@PC00015+4                                      1556 05841000
         TM    WRITRTYP(@06),B'10000000'                           1556 05842000
         BNO   @RF01556                                            1556 05843000
         OI    UNTRTYPE,B'10000000'                                1558 05844000
*          ELSE DO;    UNTRTYPE = ALTTRACK; END;                   1560 05845000
         B     @RC01556                                            1560 05846000
@RF01556 DS    0H                                                  1561 05847000
         NI    UNTRTYPE,B'01111111'                                1561 05848000
*        UNTRACK = WRIADDR;                                        1563 05849000
@RC01556 L     @06,@PC00015                                        1563 05850000
         MVC   UNTRACK(4),WRIADDR(@06)                             1563 05851000
*        CALL COUNTRKS;                                            1564 05852000
         BAL   @14,COUNTRKS                                        1564 05853000
*/*      END-THEN (WRITE OPERATION FAILS)                            */ 05854000
*        END;                                                      1565 05855000
*/*    ELSE (WRITE OPERATION SUCCESSFUL)                             */ 05856000
*      ELSE DO;                                                    1566 05857000
*                                                                  1566 05858000
         B     @RC01554                                            1566 05859000
@RF01554 DS    0H                                                  1567 05860000
*/*      IF TRACK IS AN ALTERNATE TRACK                              */ 05861000
*        IF WRITRTYP = ALTTRACK                                    1567 05862000
*/*        THEN                                                      */ 05863000
*          THEN DO;                                                1567 05864000
*                                                                  1567 05865000
         L     @06,@PC00015+4                                      1567 05866000
         TM    WRITRTYP(@06),B'10000000'                           1567 05867000
         BNZ   @RF01567                                            1567 05868000
*/*          INDICATE ALTERNATE TRACK FOR PACK MAP ENTRY             */ 05869000
*            PACKTRK = ALTTRACK;                                   1569 05870000
         NI    PACKTRK,B'01111111'                                 1569 05871000
*/*          END-THEN                                                */ 05872000
*            END;                                                  1570 05873000
*/*        ELSE INDICATE PRIMARY TRACK FOR PACK MAP ENTRY            */ 05874000
*          ELSE DO;    PACKTRK = PRITRACK; END;                    1571 05875000
         B     @RC01567                                            1571 05876000
@RF01567 DS    0H                                                  1572 05877000
         OI    PACKTRK,B'10000000'                                 1572 05878000
*/*      ISSUE_BUILD_PACK_MAP                                        */ 05879000
*        PACKDEF = DEFECTIV;                                       1574 05880000
@RC01567 OI    PACKDEF,B'10000000'                                 1574 05881000
*        PACKCHEK = NODEFECT;                                      1575 05882000
         NI    PACKCHEK,B'01111111'                                1575 05883000
*        PACKRCVR = RCVRYES;                                       1576 05884000
         NI    PACKRCVR,B'01111111'                                1576 05885000
*        PACKTRAK = WRIADDR;                                       1577 05886000
         L     @06,@PC00015                                        1577 05887000
         MVC   @TF00001(4),WRIADDR(@06)                            1577 05888000
         L     @06,@TF00001                                        1577 05889000
         ST    @06,PACKTRAK                                        1577 05890000
*        PACKASC = WRIADDR;                                        1578 05891000
         ST    @06,PACKASC                                         1578 05892000
*        CALL BILDPACK;                                            1579 05893000
         BAL   @14,BILDPACK                                        1579 05894000
*/*      WRITE THE STANDARD-LENGTH RECORD-ZERO (UDEVOP)              */ 05895000
*        CALL ICKDVOP0 (GDTTBL                                     1580 05896000
*               ,VOLIB                                             1580 05897000
*               ,ACTWRZS                                           1580 05898000
*               ,WRIADDR                                           1580 05899000
*               ,RECNUM                                            1580 05900000
*               ,POOLID                                            1580 05901000
*               ,ADDR(WRIADDR)                                     1580 05902000
*               ,LENGTH(WRIADDR)                                   1580 05903000
*               ,RETCODEA);                                        1580 05904000
         L     @06,@PC00001                                        1580 05905000
         ST    @06,@AL00001                                        1580 05906000
         LA    @15,VOLIB                                           1580 05907000
         ST    @15,@AL00001+4                                      1580 05908000
         LA    @15,@CF00161                                        1580 05909000
         ST    @15,@AL00001+8                                      1580 05910000
         L     @15,@PC00015                                        1580 05911000
         ST    @15,@AL00001+12                                     1580 05912000
         LA    @14,RECNUM                                          1580 05913000
         ST    @14,@AL00001+16                                     1580 05914000
         LA    @14,POOLID                                          1580 05915000
         ST    @14,@AL00001+20                                     1580 05916000
         ST    @15,@AFTEMPS+4                                      1580 05917000
         LA    @15,@AFTEMPS+4                                      1580 05918000
         ST    @15,@AL00001+24                                     1580 05919000
         LA    @15,@CF00044                                        1580 05920000
         ST    @15,@AL00001+28                                     1580 05921000
         LA    @15,RETCODEA                                        1580 05922000
         ST    @15,@AL00001+32                                     1580 05923000
         L     @15,GDTDOP(,@06)                                    1580 05924000
         LA    @01,@AL00001                                        1580 05925000
         BALR  @14,@15                                             1580 05926000
*/*      IF WRITE OPERATION FAILS                                    */ 05927000
*        IF RETCODEA = CPFAILS                                     1581 05928000
*/*        THEN                                                      */ 05929000
*          THEN DO;                                                1581 05930000
*                                                                  1581 05931000
         CLC   RETCODEA(4),@CF00044                                1581 05932000
         BNE   @RF01581                                            1581 05933000
*/*          COUNT_UNRECOVERABLE_TRACKS                              */ 05934000
*            UNTRACK = WRIADDR;                                    1583 05935000
         L     @06,@PC00015                                        1583 05936000
         MVC   UNTRACK(4),WRIADDR(@06)                             1583 05937000
*            IF WRITRTYP = PRITRACK                                1584 05938000
*              THEN DO;    UNTRTYPE = PRITRACK; END;               1584 05939000
         L     @06,@PC00015+4                                      1584 05940000
         TM    WRITRTYP(@06),B'10000000'                           1584 05941000
         BNO   @RF01584                                            1584 05942000
         OI    UNTRTYPE,B'10000000'                                1586 05943000
*              ELSE DO;    UNTRTYPE = ALTTRACK; END;               1588 05944000
         B     @RC01584                                            1588 05945000
@RF01584 DS    0H                                                  1589 05946000
         NI    UNTRTYPE,B'01111111'                                1589 05947000
*            CALL COUNTRKS;                                        1591 05948000
@RC01584 BAL   @14,COUNTRKS                                        1591 05949000
*/*          END-THEN                                                */ 05950000
*            END;                                                  1592 05951000
*/*      END-ELSE (WRITE HOME-ADDRESS SUCCESSFUL)                    */ 05952000
*        END;                                                      1593 05953000
*/*  END-SUB-PROCEDURE ISSUE_MARK_TRACK_DEFECTIVE                    */ 05954000
*    END WRIHARZD;                                                 1594 05955000
*                                                                  1594 05956000
@EL00015 DS    0H                                                  1594 05957000
@EF00015 DS    0H                                                  1594 05958000
@ER00015 LM    @14,@12,@SA00015                                    1594 05959000
         BR    @14                                                 1594 05960000
         EJECT                                                          05961000
*/*****  START OF SPECIFICATIONS  ************************************/ 05962000
*/*                                                                  */ 05963000
*/*  SUB-PROCEDURE NAME:  WRIHARZ                                    */ 05964000
*/*                                                                  */ 05965000
*/*  DESCRIPTIVE NAME:  ISSUE MARK TRACK NON-DEFECTIVE               */ 05966000
*/*                                                                  */ 05967000
*/*  FUNCTION:                                                       */ 05968000
*/*                                                                  */ 05969000
*/*    THIS SUB-PROCEDURE WILL MARK THE CURRENT TRACK THAT IS BEING  */ 05970000
*/*    PROCESSED, NON-DEFECTIVE BY RESETTING THE DEFECT-FLAG IN THE  */ 05971000
*/*    HOME-ADDRESS. IN ADDITION IT WILL ALSO WRITE THE STANDARD-    */ 05972000
*/*    LENGTH RECORD-ZERO.                                           */ 05973000
*/*                                                                  */ 05974000
*/*****  END OF SPECIFICATIONS  **************************************/ 05975000
*                                                                  1595 05976000
*                                                                  1595 05977000
*/*  SUB-PROCEDURE ISSUE_MARK_TRACK_NON-DEFECTIVE                    */ 05978000
*    WRIHARZ:                                                      1595 05979000
*      PROCEDURE;                                                  1595 05980000
WRIHARZ  STM   @14,@01,@SA00016                                    1595 05981000
         STM   @03,@12,@SA00016+16                                 1595 05982000
*    DCL RETCODEB            /* RETURN CODE FROM CALLED PROGRAMS     */ 05983000
*                            FIXED (31);                           1596 05984000
*                                                                  1596 05985000
*    OLDERID2 = NEWERID2;                                          1597 05986000
         L     @06,@PC00001                                        1597 05987000
         L     @06,GDTTR2(,@06)                                    1597 05988000
         MVC   @TS00001(95),NEWERID2(@06)                          1597 05989000
         MVC   OLDERID2(95,@06),@TS00001                           1597 05990000
*    NEWID2 = 'ITWN';                                              1598 05991000
         MVC   NEWID2(4,@06),@CC00986                              1598 05992000
*/*  IF TRACK IS PRIMARY                                             */ 05993000
*    IF TRACKTYP = PRITRACK                                        1599 05994000
*/*    THEN SET ACTION KEY TO WRITE A HOME-ADDRESS WITH THE          */ 05995000
*/*     DEFECT-FLAG NOT SET ON A PRIMARY TRACK                       */ 05996000
*      THEN DO;    HAACTION = ACTWPHA; END;                        1599 05997000
         TM    TRACKTYP,B'10000000'                                1599 05998000
         BNO   @RF01599                                            1599 05999000
         MVC   HAACTION(4),@CF00044                                1601 06000000
*/*    ELSE SET ACTION KEY TO WRITE A HOME-ADDRESS WITH THE          */ 06001000
*/*     DEFECT-FLAG NOT SET ON AN ALTERNATE TRACK                    */ 06002000
*      ELSE DO;    HAACTION = ACTWAHA; END;                        1603 06003000
         B     @RC01599                                            1603 06004000
@RF01599 DS    0H                                                  1604 06005000
         MVC   HAACTION(4),@CF00119                                1604 06006000
*/*  ISSUE CALL TO UDEVOP FOR THE PROPER ACTION                      */ 06007000
*    CALL ICKDVOP0 (GDTTBL                                         1606 06008000
*           ,VOLIB                                                 1606 06009000
*           ,HAACTION                                              1606 06010000
*           ,CTRADDR                                               1606 06011000
*           ,RECNUM                                                1606 06012000
*           ,POOLID                                                1606 06013000
*           ,DATAPTR                                               1606 06014000
*           ,DATALEN                                               1606 06015000
*           ,RETCODEB);                                            1606 06016000
@RC01599 L     @06,@PC00001                                        1606 06017000
         ST    @06,@AL00001                                        1606 06018000
         LA    @15,VOLIB                                           1606 06019000
         ST    @15,@AL00001+4                                      1606 06020000
         LA    @15,HAACTION                                        1606 06021000
         ST    @15,@AL00001+8                                      1606 06022000
         LA    @15,CTRADDR                                         1606 06023000
         ST    @15,@AL00001+12                                     1606 06024000
         LA    @15,RECNUM                                          1606 06025000
         ST    @15,@AL00001+16                                     1606 06026000
         LA    @15,POOLID                                          1606 06027000
         ST    @15,@AL00001+20                                     1606 06028000
         LA    @15,DATAPTR                                         1606 06029000
         ST    @15,@AL00001+24                                     1606 06030000
         LA    @15,DATALEN                                         1606 06031000
         ST    @15,@AL00001+28                                     1606 06032000
         LA    @15,RETCODEB                                        1606 06033000
         ST    @15,@AL00001+32                                     1606 06034000
         L     @15,GDTDOP(,@06)                                    1606 06035000
         LA    @01,@AL00001                                        1606 06036000
         BALR  @14,@15                                             1606 06037000
*/*  IF WRITE OPERATION FAILS                                        */ 06038000
*    IF RETCODEB = CPFAILS                                         1607 06039000
*/*    THEN                                                          */ 06040000
*      THEN DO;                                                    1607 06041000
*                                                                  1607 06042000
         CLC   RETCODEB(4),@CF00044                                1607 06043000
         BNE   @RF01607                                            1607 06044000
*/*      INDICATE SUB-PROCEDURE FAILS                                */ 06045000
*        SPROCODE = FAILED;                                        1609 06046000
         LA    SPROCODE,2                                          1609 06047000
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */ 06048000
*        IF TRACKTYP = PRITRACK                                    1610 06049000
*          THEN DO;    UNTRTYPE = PRITRACK; END;                   1610 06050000
         TM    TRACKTYP,B'10000000'                                1610 06051000
         BNO   @RF01610                                            1610 06052000
         OI    UNTRTYPE,B'10000000'                                1612 06053000
*          ELSE DO;    UNTRTYPE = ALTTRACK; END;                   1614 06054000
         B     @RC01610                                            1614 06055000
@RF01610 DS    0H                                                  1615 06056000
         NI    UNTRTYPE,B'01111111'                                1615 06057000
*        UNTRACK = CTRADDR;                                        1617 06058000
@RC01610 MVC   UNTRACK(4),CTRADDR                                  1617 06059000
*        CALL COUNTRKS;                                            1618 06060000
         BAL   @14,COUNTRKS                                        1618 06061000
*/*      END-THEN (WRITE OPERATION FAILS)                            */ 06062000
*        END;                                                      1619 06063000
*/*    ELSE (WRITE OPERATION SUCCESSFUL OR TRACK RECOVERED)          */ 06064000
*      ELSE DO;                                                    1620 06065000
*                                                                  1620 06066000
         B     @RC01607                                            1620 06067000
@RF01607 DS    0H                                                  1621 06068000
*/*      IF DEFECT-FLAG SET DUE TO RECOVERY                          */ 06069000
*        IF RETCODEB = DFLAGONA | RETCODEB = DFLAGONP              1621 06070000
*/*        THEN INDICATE SUB-PROCEDURE FOUND TRACK RECOVERED         */ 06071000
*          THEN DO;    SPROCODE = FAILRCV; END;                    1621 06072000
         L     @06,RETCODEB                                        1621 06073000
         CH    @06,@CH00119                                        1621 06074000
         BE    @RT01621                                            1621 06075000
         CH    @06,@CH00116                                        1621 06076000
         BNE   @RF01621                                            1621 06077000
@RT01621 DS    0H                                                  1622 06078000
         LA    SPROCODE,1                                          1623 06079000
*/*        ELSE INDICATE SUB-PROCEDURE SUCCEEDED                     */ 06080000
*          ELSE DO;    SPROCODE = SUCCESS; END;                    1625 06081000
         B     @RC01621                                            1625 06082000
@RF01621 DS    0H                                                  1626 06083000
         SLR   SPROCODE,SPROCODE                                   1626 06084000
*/*      WRITE THE STANDARD-LENGTH RECORD-ZERO (UDEVOP)              */ 06085000
*        IF RZCCHH = CTRADDR                                       1628 06086000
*          THEN DO;    RZACTION = ACTWRZS; END;                    1628 06087000
@RC01621 CLC   RZCCHH(4),CTRADDR                                   1628 06088000
         BNE   @RF01628                                            1628 06089000
         MVC   RZACTION(4),@CF00161                                1630 06090000
*          ELSE DO;    RZACTION = ACTWRZSL; END;                   1632 06091000
         B     @RC01628                                            1632 06092000
@RF01628 DS    0H                                                  1633 06093000
         MVC   RZACTION(4),@CF00276                                1633 06094000
*        CALL ICKDVOP0 (GDTTBL                                     1635 06095000
*               ,VOLIB                                             1635 06096000
*               ,RZACTION                                          1635 06097000
*               ,CTRADDR                                           1635 06098000
*               ,RECNUM                                            1635 06099000
*               ,POOLID                                            1635 06100000
*               ,ADDR(RZCCHH)                                      1635 06101000
*               ,LENGTH(RZCCHH)                                    1635 06102000
*               ,RETCODEB);                                        1635 06103000
@RC01628 L     @06,@PC00001                                        1635 06104000
         ST    @06,@AL00001                                        1635 06105000
         LA    @15,VOLIB                                           1635 06106000
         ST    @15,@AL00001+4                                      1635 06107000
         LA    @15,RZACTION                                        1635 06108000
         ST    @15,@AL00001+8                                      1635 06109000
         LA    @15,CTRADDR                                         1635 06110000
         ST    @15,@AL00001+12                                     1635 06111000
         LA    @15,RECNUM                                          1635 06112000
         ST    @15,@AL00001+16                                     1635 06113000
         LA    @15,POOLID                                          1635 06114000
         ST    @15,@AL00001+20                                     1635 06115000
         LA    @15,RZCCHH                                          1635 06116000
         ST    @15,@AFTEMPS+8                                      1635 06117000
         LA    @15,@AFTEMPS+8                                      1635 06118000
         ST    @15,@AL00001+24                                     1635 06119000
         LA    @15,@CF00044                                        1635 06120000
         ST    @15,@AL00001+28                                     1635 06121000
         LA    @15,RETCODEB                                        1635 06122000
         ST    @15,@AL00001+32                                     1635 06123000
         L     @15,GDTDOP(,@06)                                    1635 06124000
         LA    @01,@AL00001                                        1635 06125000
         BALR  @14,@15                                             1635 06126000
*/*      IF WRITE OPERATION FAILS                                    */ 06127000
*        IF RETCODEB = CPFAILS                                     1636 06128000
*/*        THEN                                                      */ 06129000
*          THEN DO;                                                1636 06130000
*                                                                  1636 06131000
         CLC   RETCODEB(4),@CF00044                                1636 06132000
         BNE   @RF01636                                            1636 06133000
*/*          INDICATE SUB-PROCEDURE FAILS                            */ 06134000
*            SPROCODE = FAILED;                                    1638 06135000
         LA    SPROCODE,2                                          1638 06136000
*/*          COUNT_UNRECOVERABLE_TRACKS                              */ 06137000
*            UNTRACK = CTRADDR;                                    1639 06138000
         MVC   UNTRACK(4),CTRADDR                                  1639 06139000
*            IF TRACKTYP = PRITRACK                                1640 06140000
*              THEN DO;    UNTRTYPE = PRITRACK; END;               1640 06141000
         TM    TRACKTYP,B'10000000'                                1640 06142000
         BNO   @RF01640                                            1640 06143000
         OI    UNTRTYPE,B'10000000'                                1642 06144000
*              ELSE DO;    UNTRTYPE = ALTTRACK; END;               1644 06145000
         B     @RC01640                                            1644 06146000
@RF01640 DS    0H                                                  1645 06147000
         NI    UNTRTYPE,B'01111111'                                1645 06148000
*            CALL COUNTRKS;                                        1647 06149000
@RC01640 BAL   @14,COUNTRKS                                        1647 06150000
*/*          END-THEN                                                */ 06151000
*            END;                                                  1648 06152000
*/*        ELSE (WRITE R0 SUCCESSFUL OR TRACK RECOVERED)             */ 06153000
*          ELSE DO;                                                1649 06154000
*                                                                  1649 06155000
         B     @RC01636                                            1649 06156000
@RF01636 DS    0H                                                  1650 06157000
*/*          IF DEFECT-FLAG SET DUE TO RECOVERY                      */ 06158000
*            IF RETCODEB = DFLAGONA | RETCODEB = DFLAGONP          1650 06159000
*/*            THEN INDICATE SUB-PROCEDURE FOUND TRACK RECOVERED     */ 06160000
*              THEN DO;    SPROCODE = FAILRCV; END;                1650 06161000
         L     @06,RETCODEB                                        1650 06162000
         CH    @06,@CH00119                                        1650 06163000
         BE    @RT01650                                            1650 06164000
         CH    @06,@CH00116                                        1650 06165000
         BNE   @RF01650                                            1650 06166000
@RT01650 DS    0H                                                  1651 06167000
         LA    SPROCODE,1                                          1652 06168000
*/*            ELSE INDICATE SUB-PROCEDURE SUCCEEDED                 */ 06169000
*              ELSE DO;    SPROCODE = SUCCESS; END;                1654 06170000
         B     @RC01650                                            1654 06171000
@RF01650 DS    0H                                                  1655 06172000
         SLR   SPROCODE,SPROCODE                                   1655 06173000
*/*          END-ELSE (WRITE R0 SUCCESSFUL OR TRACK RECOVERED)       */ 06174000
*            END;                                                  1657 06175000
*/*      END-ELSE (WRITE HOME-ADDRESS SUCCESSFUL OR TRACK RECOVERED) */ 06176000
*        END;                                                      1658 06177000
*/*  END-SUB-PROCEDURE ISSUE_MARK_TRACK_NON-DEFECTIVE                */ 06178000
*    END WRIHARZ;                                                  1659 06179000
*                                                                  1659 06180000
@EL00016 DS    0H                                                  1659 06181000
@EF00016 DS    0H                                                  1659 06182000
@ER00016 LM    @14,@01,@SA00016                                    1659 06183000
         LM    @03,@12,@SA00016+16                                 1659 06184000
         BR    @14                                                 1659 06185000
         EJECT                                                          06186000
*/*****  START OF SPECIFICATIONS  ************************************/ 06187000
*/*                                                                  */ 06188000
*/*  SUB-PROCEDURE NAME:  COUNTRKS                                   */ 06189000
*/*                                                                  */ 06190000
*/*  DESCRIPTIVE NAME:  COUNT UNRECOVERABLE TRACKS                   */ 06191000
*/*                                                                  */ 06192000
*/*  FUNCTION:                                                       */ 06193000
*/*                                                                  */ 06194000
*/*    THIS SUB-PROCEDURE KEEPS TRACK OF THE NUMBER OF UNRECOVERABLE */ 06195000
*/*    TRACKS ENCOUNTERED. IT WILL CAUSE A TERMINATION IF THE NUMBER */ 06196000
*/*    OF TRACKS FOUND UNRECOVERABLE EXCEEDS A DESIGN THRESHOLD.     */ 06197000
*/*                                                                  */ 06198000
*/*****  END OF SPECIFICATIONS  **************************************/ 06199000
*                                                                  1660 06200000
*                                                                  1660 06201000
*/*  SUB-PROCEDURE COUNT_UNRECOVERABLE_TRACKS                        */ 06202000
*    COUNTRKS:                                                     1660 06203000
*      PROCEDURE;                                                  1660 06204000
COUNTRKS STM   @14,@12,@SA00017                                    1660 06205000
*      DCL RETCODEC          /* RETURN CODE FROM CALLED PROGRAMS     */ 06206000
*                            FIXED (31);                           1661 06207000
*                                                                  1661 06208000
*    OLDERID2 = NEWERID2;                                          1662 06209000
         L     @06,@PC00001                                        1662 06210000
         L     @06,GDTTR2(,@06)                                    1662 06211000
         MVC   @TS00001(95),NEWERID2(@06)                          1662 06212000
         MVC   OLDERID2(95,@06),@TS00001                           1662 06213000
*    NEWID2 =  'ITUT';                                             1663 06214000
         MVC   NEWID2(4,@06),@CC00991                              1663 06215000
*/*  IF THE UNRECOVERABLE TRACK IS THE ONE THAT IS BEING PROCESSED   */ 06216000
*/*   CURRENTLY                                                      */ 06217000
*    IF UNTRACK = CTRADDR                                          1664 06218000
*/*    THEN                                                          */ 06219000
*      THEN DO;                                                    1664 06220000
*                                                                  1664 06221000
         L     @06,CTRADDR                                         1664 06222000
         CL    @06,UNTRACK                                         1664 06223000
         BNE   @RF01664                                            1664 06224000
*/*      SET FLAG TO INDICATE TRACK WAS FOUND TO BE UNRECOVERABLE    */ 06225000
*        RCVRFLAG = NORCVR;                                        1666 06226000
         NI    RCVRFLAG,B'01111111'                                1666 06227000
*/*      IF THE TRACK IS THE FIRST ON PACK                           */ 06228000
*        IF CTRADDR = 0                                            1667 06229000
*/*        THEN INDICATE A SEVERE ERROR                              */ 06230000
*          THEN DO;    LASTCOND = LASTCC12; END;                   1667 06231000
         LTR   @06,@06                                             1667 06232000
         BNZ   @RF01667                                            1667 06233000
         L     @06,@PC00001+8                                      1669 06234000
         MVC   LASTCOND(2,@06),@CH00265                            1669 06235000
*/*      END-THEN                                                    */ 06236000
*        END;                                                      1671 06237000
@RF01667 DS    0H                                                  1672 06238000
*/*  IF TRACK IS AN ALTERNATE                                        */ 06239000
*    IF UNTRTYPE = ALTTRACK                                        1672 06240000
*/*    THEN                                                          */ 06241000
*      THEN DO;                                                    1672 06242000
*                                                                  1672 06243000
@RF01664 TM    UNTRTYPE,B'10000000'                                1672 06244000
         BNZ   @RF01672                                            1672 06245000
*/*      WRITE ALTERNATE HA WITH DEFECT-FLAG SET                     */ 06246000
*        CALL ICKDVOP0 (GDTTBL                                     1674 06247000
*               ,VOLIB                                             1674 06248000
*               ,ACTWAHAD                                          1674 06249000
*               ,UNTRACK                                           1674 06250000
*               ,RECNUM                                            1674 06251000
*               ,POOLID                                            1674 06252000
*               ,DATAPTR                                           1674 06253000
*               ,DATALEN                                           1674 06254000
*               ,RETCODEC);                                        1674 06255000
         L     @06,@PC00001                                        1674 06256000
         ST    @06,@AL00001                                        1674 06257000
         LA    @15,VOLIB                                           1674 06258000
         ST    @15,@AL00001+4                                      1674 06259000
         LA    @15,@CF00255                                        1674 06260000
         ST    @15,@AL00001+8                                      1674 06261000
         LA    @15,UNTRACK                                         1674 06262000
         ST    @15,@AL00001+12                                     1674 06263000
         LA    @15,RECNUM                                          1674 06264000
         ST    @15,@AL00001+16                                     1674 06265000
         LA    @15,POOLID                                          1674 06266000
         ST    @15,@AL00001+20                                     1674 06267000
         LA    @15,DATAPTR                                         1674 06268000
         ST    @15,@AL00001+24                                     1674 06269000
         LA    @15,DATALEN                                         1674 06270000
         ST    @15,@AL00001+28                                     1674 06271000
         LA    @15,RETCODEC                                        1674 06272000
         ST    @15,@AL00001+32                                     1674 06273000
         L     @15,GDTDOP(,@06)                                    1674 06274000
         LA    @01,@AL00001                                        1674 06275000
         BALR  @14,@15                                             1674 06276000
*/*      IF WRITE OPERATION IS SUCCESSFUL                            */ 06277000
*        IF RETCODEC = SUCCESS                                     1675 06278000
*/*        THEN                                                      */ 06279000
*          THEN DO;                                                1675 06280000
*                                                                  1675 06281000
         SLR   @06,@06                                             1675 06282000
         C     @06,RETCODEC                                        1675 06283000
         BNE   @RF01675                                            1675 06284000
*/*          ISSUE_BUILD_PACK_MAP (TRACK WITH DEFECT-FLAG SET)       */ 06285000
*            PACKDEF  = DEFECTIV;                                  1677 06286000
         OI    PACKDEF,B'10000000'                                 1677 06287000
*            PACKCHEK = NODEFECT;                                  1678 06288000
         NI    PACKCHEK,B'01111111'                                1678 06289000
*            PACKRCVR = RCVRYES;                                   1679 06290000
         NI    PACKRCVR,B'01111111'                                1679 06291000
*            PACKTRK  = ALTTRACK;                                  1680 06292000
         NI    PACKTRK,B'01111111'                                 1680 06293000
*            PACKTRAK = UNTRACK;                                   1681 06294000
         MVC   PACKTRAK(4),UNTRACK                                 1681 06295000
*            PACKASC = 0;                                          1682 06296000
         ST    @06,PACKASC                                         1682 06297000
*            CALL BILDPACK;                                        1683 06298000
         BAL   @14,BILDPACK                                        1683 06299000
*/*          RETURN                                                  */ 06300000
*            RETURN;                                               1684 06301000
@EL00017 DS    0H                                                  1684 06302000
@EF00017 DS    0H                                                  1684 06303000
@ER00017 LM    @14,@12,@SA00017                                    1684 06304000
         BR    @14                                                 1684 06305000
*/*          END-THEN                                                */ 06306000
*            END;                                                  1685 06307000
*/*      END-THEN                                                    */ 06308000
*        END;                                                      1686 06309000
@RF01675 DS    0H                                                  1687 06310000
*/*  ISSUE_BUILD_PACK_MAP (TRACK IS UNRECOVERABLE)                   */ 06311000
*    PACKDEF  = NODEFECT;                                          1687 06312000
@RF01672 NI    PACKDEF,B'01111111'                                 1687 06313000
*    PACKCHEK = NODEFECT;                                          1688 06314000
         NI    PACKCHEK,B'01111111'                                1688 06315000
*    PACKRCVR = RCVRNO;                                            1689 06316000
         OI    PACKRCVR,B'10000000'                                1689 06317000
*    IF UNTRTYPE = PRITRACK                                        1690 06318000
*      THEN DO;    PACKTRK = PRITRACK; END;                        1690 06319000
         TM    UNTRTYPE,B'10000000'                                1690 06320000
         BNO   @RF01690                                            1690 06321000
         OI    PACKTRK,B'10000000'                                 1692 06322000
*      ELSE DO;    PACKTRK = ALTTRACK; END;                        1694 06323000
         B     @RC01690                                            1694 06324000
@RF01690 DS    0H                                                  1695 06325000
         NI    PACKTRK,B'01111111'                                 1695 06326000
*    PACKTRAK = UNTRACK;                                           1697 06327000
@RC01690 MVC   PACKTRAK(4),UNTRACK                                 1697 06328000
*    PACKASC = 0;                                                  1698 06329000
         SLR   @06,@06                                             1698 06330000
         ST    @06,PACKASC                                         1698 06331000
*    CALL BILDPACK;                                                1699 06332000
         BAL   @14,BILDPACK                                        1699 06333000
*/*  INCREMENT COUNT OF UNRECOVERABLE TRACKS (COUNTUTR)              */ 06334000
*    COUNTUTR = COUNTUTR + 1;                                      1700 06335000
         LA    @06,1                                               1700 06336000
         AL    @06,COUNTUTR                                        1700 06337000
         ST    @06,COUNTUTR                                        1700 06338000
*/*  WRITE A WARNING MESSAGE (MSGAUTRK OR MSGPUTRK) (UPRINT)         */ 06339000
*    IF UNTRTYPE = PRITRACK                                        1701 06340000
*      THEN DO;    DARGSENT = MSGPUTRK; END;                       1701 06341000
         TM    UNTRTYPE,B'10000000'                                1701 06342000
         BNO   @RF01701                                            1701 06343000
         L     @06,DDSTRU                                          1703 06344000
         MVI   DARGSENT(@06),X'02'                                 1703 06345000
*      ELSE DO;    DARGSENT = MSGAUTRK; END;                       1705 06346000
         B     @RC01701                                            1705 06347000
@RF01701 DS    0H                                                  1706 06348000
         L     @06,DDSTRU                                          1706 06349000
         MVI   DARGSENT(@06),X'01'                                 1706 06350000
*    DARGCNT = 2;                                                  1708 06351000
@RC01701 LA    @06,2                                               1708 06352000
         L     @15,DDSTRU                                          1708 06353000
         STH   @06,DARGCNT(,@15)                                   1708 06354000
*    DARGINS (1) = 1;                                              1709 06355000
         MVC   DARGINS(2,@15),@CH00165                             1709 06356000
*    DARGINL (1) = LENGTH (UNTRACKC);                              1710 06357000
         STH   @06,DARGINL(,@15)                                   1710 06358000
*    DARGDTM (1) = ADDR (UNTRACKC);                                1711 06359000
         LA    @14,UNTRACKC                                        1711 06360000
         ST    @14,DARGDTM(,@15)                                   1711 06361000
*    DARGINS (2) = 2;                                              1712 06362000
         STH   @06,DARGINS+8(,@15)                                 1712 06363000
*    DARGINL (2) = LENGTH (UNTRACKT);                              1713 06364000
         STH   @06,DARGINL+8(,@15)                                 1713 06365000
*    DARGDTM (2) = ADDR (UNTRACKT);                                1714 06366000
         LA    @06,UNTRACKT                                        1714 06367000
         ST    @06,DARGDTM+8(,@15)                                 1714 06368000
*    CALL ICKTPPR0 (GDTTBL                                         1715 06369000
*           ,PRTFILE                                               1715 06370000
*           ,DDSTRU);                                              1715 06371000
         L     @06,@PC00001                                        1715 06372000
         ST    @06,@AL00001                                        1715 06373000
         LA    @15,@CF00094                                        1715 06374000
         ST    @15,@AL00001+4                                      1715 06375000
         LA    @15,DDSTRU                                          1715 06376000
         ST    @15,@AL00001+8                                      1715 06377000
         MVI   @AL00001+8,X'80'                                    1715 06378000
         L     @15,GDTPRT(,@06)                                    1715 06379000
         LA    @01,@AL00001                                        1715 06380000
         BALR  @14,@15                                             1715 06381000
*/*  INDICATE A MINOR ERROR                                          */ 06382000
*    LASTCOND = MAX (LASTCOND,LASTCC04);                           1716 06383000
         L     @06,@PC00001+8                                      1716 06384000
         LH    @15,LASTCOND(,@06)                                  1716 06385000
         LA    @14,4                                               1716 06386000
         CR    @15,@14                                             1716 06387000
         BNL   *+6                                                      06388000
         LR    @15,@14                                             1716 06389000
         STH   @15,LASTCOND(,@06)                                  1716 06390000
*/*  IF COUNT OF UNRECOVERABLE TRACKS MEETS THRESHOLD                */ 06391000
*    IF COUNTUTR >= THRESHLD                                       1717 06392000
*/*    THEN                                                          */ 06393000
*      THEN DO;                                                    1717 06394000
*                                                                  1717 06395000
         L     @06,COUNTUTR                                        1717 06396000
         L     @01,INFOPTR                                         1717 06397000
         C     @06,THRESHLD(,@01)                                  1717 06398000
         BL    @RF01717                                            1717 06399000
*/*      ISSUE ERROR MESSAGE (MSGTHRSH) (UPRINT)                     */ 06400000
*        DARGSENT = MSGTHRSH;                                      1719 06401000
         L     @06,DDSTRU                                          1719 06402000
         MVI   DARGSENT(@06),X'0E'                                 1719 06403000
*        CALL ICKTPPR0 (GDTTBL                                     1720 06404000
*               ,PRTFILE                                           1720 06405000
*               ,DDSTRU);                                          1720 06406000
         L     @06,@PC00001                                        1720 06407000
         ST    @06,@AL00001                                        1720 06408000
         LA    @15,@CF00094                                        1720 06409000
         ST    @15,@AL00001+4                                      1720 06410000
         LA    @15,DDSTRU                                          1720 06411000
         ST    @15,@AL00001+8                                      1720 06412000
         MVI   @AL00001+8,X'80'                                    1720 06413000
         L     @15,GDTPRT(,@06)                                    1720 06414000
         LA    @01,@AL00001                                        1720 06415000
         BALR  @14,@15                                             1720 06416000
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */ 06417000
*        LASTCOND = LASTCC12;                                      1721 06418000
         L     @06,@PC00001+8                                      1721 06419000
         MVC   LASTCOND(2,@06),@CH00265                            1721 06420000
*/*      END-THEN                                                    */ 06421000
*        END;                                                      1722 06422000
*/*  END-SUB-PROCEDURE COUNT_UNRECOVERABLE_TRACKS                    */ 06423000
*    END COUNTRKS;                                                 1723 06424000
*                                                                  1723 06425000
         B     @EL00017                                            1723 06426000
         EJECT                                                          06427000
*/*****  START OF SPECIFICATIONS  ************************************/ 06428000
*/*                                                                  */ 06429000
*/*  SUB-PROCEDURE NAME:  BILDPACK                                   */ 06430000
*/*                                                                  */ 06431000
*/*  DESCRIPTIVE NAME:  ISSUE BUILD PACK MAP                         */ 06432000
*/*                                                                  */ 06433000
*/*  FUNCTION:                                                       */ 06434000
*/*                                                                  */ 06435000
*/*    THIS SUB-PROCEDURE INVOKES THE ELEMENTARY FUNCTION THAT       */ 06436000
*/*    BUILDS A PACK MAP ENTRY.                                      */ 06437000
*/*                                                                  */ 06438000
*/*****  END OF SPECIFICATIONS  **************************************/ 06439000
*                                                                  1724 06440000
*                                                                  1724 06441000
*/*  SUB-PROCEDURE ISSUE_BUILD_PACK_MAP                              */ 06442000
*    BILDPACK:                                                     1724 06443000
*      PROCEDURE;                                                  1724 06444000
BILDPACK STM   @14,@12,@SA00018                                    1724 06445000
*    OLDERID2 = NEWERID2;                                          1725 06446000
         L     @06,@PC00001                                        1725 06447000
         L     @06,GDTTR2(,@06)                                    1725 06448000
         MVC   @TS00001(95),NEWERID2(@06)                          1725 06449000
         MVC   OLDERID2(95,@06),@TS00001                           1725 06450000
*    NEWID2 =  'ITBP';                                             1726 06451000
         MVC   NEWID2(4,@06),@CC00995                              1726 06452000
*/*  IF THERE IS NO STORAGE AVAILABLE TO BUILD ANOTHER ENTRY         */ 06453000
*    IF PACKENT = STORNO                                           1727 06454000
*/*    THEN RETURN                                                   */ 06455000
*      THEN DO;    RETURN; END;                                    1727 06456000
         TM    PACKENT,B'10000000'                                 1727 06457000
         BNO   @RF01727                                            1727 06458000
@EL00018 DS    0H                                                  1729 06459000
@EF00018 DS    0H                                                  1729 06460000
@ER00018 LM    @14,@12,@SA00018                                    1729 06461000
         BR    @14                                                 1729 06462000
*/*  BUILD_PACK_MAP                                                  */ 06463000
*    CALL ICKBM01                                                  1731 06464000
*         (GDTTBL                                                  1731 06465000
*         ,VOLIB                                                   1731 06466000
*         ,PACKTRAK                                                1731 06467000
*         ,PACKASC                                                 1731 06468000
*         ,PACKTRK                                                 1731 06469000
*         ,PACKDEF                                                 1731 06470000
*         ,PACKCHEK                                                1731 06471000
*         ,PACKRCVR                                                1731 06472000
*         ,RETCODE);                                               1731 06473000
@RF01727 L     @06,@PC00001                                        1731 06474000
         ST    @06,@AL00001                                        1731 06475000
         LA    @06,VOLIB                                           1731 06476000
         ST    @06,@AL00001+4                                      1731 06477000
         LA    @06,PACKTRAK                                        1731 06478000
         ST    @06,@AL00001+8                                      1731 06479000
         LA    @06,PACKASC                                         1731 06480000
         ST    @06,@AL00001+12                                     1731 06481000
         LA    @06,PACKTRK                                         1731 06482000
         ST    @06,@AL00001+16                                     1731 06483000
         LA    @06,PACKDEF                                         1731 06484000
         ST    @06,@AL00001+20                                     1731 06485000
         LA    @06,PACKCHEK                                        1731 06486000
         ST    @06,@AL00001+24                                     1731 06487000
         LA    @06,PACKRCVR                                        1731 06488000
         ST    @06,@AL00001+28                                     1731 06489000
         LA    @06,RETCODE                                         1731 06490000
         ST    @06,@AL00001+32                                     1731 06491000
         L     @15,@CV00996                                        1731 06492000
         LA    @01,@AL00001                                        1731 06493000
         BALR  @14,@15                                             1731 06494000
*/*  IF STORAGE IS NOT AVAILABLE                                     */ 06495000
*    IF RETCODE = FAILURE                                          1732 06496000
*/*    THEN                                                          */ 06497000
*      THEN DO;                                                    1732 06498000
*                                                                  1732 06499000
         CLC   RETCODE(4),@CF00165                                 1732 06500000
         BNE   @RF01732                                            1732 06501000
*/*      SET FLAG TO INDICATE NO STORAGE IS AVAILABLE                */ 06502000
*        PACKENT = STORNO;                                         1734 06503000
         OI    PACKENT,B'10000000'                                 1734 06504000
*/*      INDICATE AN ERROR (LASTCOND = 8)                            */ 06505000
*        LASTCOND = MAX(LASTCC08,LASTCOND);                        1735 06506000
         L     @06,@PC00001+8                                      1735 06507000
         LH    @15,LASTCOND(,@06)                                  1735 06508000
         LA    @14,8                                               1735 06509000
         CR    @15,@14                                             1735 06510000
         BNL   *+6                                                      06511000
         LR    @15,@14                                             1735 06512000
         STH   @15,LASTCOND(,@06)                                  1735 06513000
*/*      END-THEN                                                    */ 06514000
*        END;                                                      1736 06515000
*/*  END-SUB-PROCEDURE ISSUE_BUILD_PACK_MAP                          */ 06516000
*    END BILDPACK;                                                 1737 06517000
*                                                                  1737 06518000
         B     @EL00018                                            1737 06519000
         EJECT                                                          06520000
*/*****  START OF SPECIFICATIONS  ************************************/ 06521000
*/*                                                                  */ 06522000
*/*  SUB-PROCEDURE NAME:  CHASSOC                                    */ 06523000
*/*                                                                  */ 06524000
*/*  DESCRIPTIVE NAME:  CHECK_ASSOCIATION                            */ 06525000
*/*                                                                  */ 06526000
*/*  FUNCTION:                                                       */ 06527000
*/*                                                                  */ 06528000
*/*    THIS SUB-PROCEDURE SETS THE ASSOCIATION FLAG TO INDICATE      */ 06529000
*/*    IF A TRACK IS ASSOCIATED WITH ANOTHER TRACK.                  */ 06530000
*/*                                                                  */ 06531000
*/*****  END OF SPECIFICATIONS  **************************************/ 06532000
*                                                                  1738 06533000
*                                                                  1738 06534000
*/*  SUB-PROCEDURE CHECK_ASSOCIATION                                 */ 06535000
*    CHASSOC:                                                      1738 06536000
*      PROCEDURE;                                                  1738 06537000
CHASSOC  STM   @14,@12,@SA00019                                    1738 06538000
*    OLDERID2 = NEWERID2;                                          1739 06539000
         L     @06,@PC00001                                        1739 06540000
         L     @06,GDTTR2(,@06)                                    1739 06541000
         MVC   @TS00001(95),NEWERID2(@06)                          1739 06542000
         MVC   OLDERID2(95,@06),@TS00001                           1739 06543000
*    NEWID2 =  'ITCA';                                             1740 06544000
         MVC   NEWID2(4,@06),@CC01000                              1740 06545000
*/*  IF DEFECTIVE PRIMARY TRACK                                      */ 06546000
*    IF TRACKTYP = PRITRACK & DFLAGC = DEFECTIV                    1741 06547000
*/*    THEN                                                          */ 06548000
*      THEN DO;                                                    1741 06549000
*                                                                  1741 06550000
         TM    TRACKTYP,B'10000000'                                1741 06551000
         BNO   @RF01741                                            1741 06552000
         TM    DFLAGC,B'10000000'                                  1741 06553000
         BNO   @RF01741                                            1741 06554000
*/*      IF THE TRACK ASSOCIATION ADDRESS IS POINTING TO AN ALTERNATE*/ 06555000
*        IF (RZCCHHC >= FIRSTALC) & (RZCCHHC <= FINALTC)           1743 06556000
*         & (RZCCHHT >= FIRSTALT) & (RZCCHHT <= FINALTT)           1743 06557000
*/*        THEN                                                      */ 06558000
*          THEN DO;                                                1743 06559000
*                                                                  1743 06560000
         L     @06,INFOPTR+48                                      1743 06561000
         CLC   RZCCHHC(2),FIRSTALC(@06)                            1743 06562000
         BL    @RF01743                                            1743 06563000
         L     @15,INFOPTR+60                                      1743 06564000
         CLC   RZCCHHC(2),FINALTC(@15)                             1743 06565000
         BH    @RF01743                                            1743 06566000
         CLC   RZCCHHT(2),FIRSTALT(@06)                            1743 06567000
         BL    @RF01743                                            1743 06568000
         CLC   RZCCHHT(2),FINALTT(@15)                             1743 06569000
         BH    @RF01743                                            1743 06570000
*/*          OBTAIN_TRACK_STATUS (OF THE ALTERNATE TRACK)            */ 06571000
*            CALL OBTTRST (RZCCHH                                  1745 06572000
*                         ,DFLAGA                                  1745 06573000
*                         ,RZACCHH                                 1745 06574000
*                         ,ALTTRACK);                              1745 06575000
         LA    @06,RZCCHH                                          1745 06576000
         ST    @06,@AL00001                                        1745 06577000
         LA    @06,DFLAGA                                          1745 06578000
         ST    @06,@AL00001+4                                      1745 06579000
         LA    @06,RZACCHH                                         1745 06580000
         ST    @06,@AL00001+8                                      1745 06581000
         LA    @06,@CB00468                                        1745 06582000
         ST    @06,@AL00001+12                                     1745 06583000
         LA    @01,@AL00001                                        1745 06584000
         BAL   @14,OBTTRST                                         1745 06585000
*/*          IF NO SEVERE ERRORS FOUND (LASTCOND < 12)               */ 06586000
*            IF LASTCOND < LASTCC12                                1746 06587000
*/*            THEN                                                  */ 06588000
*              THEN DO;                                            1746 06589000
*                                                                  1746 06590000
         L     @06,@PC00001+8                                      1746 06591000
         LH    @06,LASTCOND(,@06)                                  1746 06592000
         CH    @06,@CH00265                                        1746 06593000
         BNL   @RF01746                                            1746 06594000
*/*              IF ASSOCIATION ADDRESS OF THE ALTERNATE IS POINTING */ 06595000
*/*               TO THE PRIMARY TRACK IN QUESTION AND THE ALTERNATE */ 06596000
*/*               TRACK IS NOT FLAGGED DEFECTIVE                     */ 06597000
*                IF (RZACCHH = CTRADDR) & (DFLAGA = NODEFECT)      1748 06598000
*/*                THEN INDICATE TRACK IS ASSOCIATED                 */ 06599000
*                  THEN DO;    ASSOCFLG = ASSOCYES; END;           1748 06600000
         CLC   RZACCHH(4),CTRADDR                                  1748 06601000
         BNE   @RF01748                                            1748 06602000
         TM    DFLAGA,B'10000000'                                  1748 06603000
         BNZ   @RF01748                                            1748 06604000
         OI    ASSOCFLG,B'10000000'                                1750 06605000
*/*                ELSE INDICATE TRACK IS NOT ASSOCIATED             */ 06606000
*                  ELSE DO;    ASSOCFLG = ASSOCNO; END;            1752 06607000
         B     @RC01748                                            1752 06608000
@RF01748 DS    0H                                                  1753 06609000
         NI    ASSOCFLG,B'01111111'                                1753 06610000
*/*              END-THEN (NO SEVERE ERRORS)                         */ 06611000
*                END;                                              1755 06612000
*/*          END-THEN (PRIMARY ASSOCIATED TO ALTERNATE)              */ 06613000
*            END;                                                  1756 06614000
*/*        ELSE INDICATE NO BACKWARD ASSOCIATION EXISTS              */ 06615000
*          ELSE DO;    RZACCHHX = 'FFFFFFFF'X; END;                1757 06616000
         B     @RC01743                                            1757 06617000
@RF01743 DS    0H                                                  1758 06618000
         MVC   RZACCHHX(4),@CB00881                                1758 06619000
*/*      END-THEN (DEFECTIVE PRIMARY TRACK)                          */ 06620000
*        END;                                                      1760 06621000
@RC01743 DS    0H                                                  1761 06622000
*/*  IF NON-DEFECTIVE ALTERNATE TRACK                                */ 06623000
*    IF TRACKTYP = ALTTRACK & DFLAGC = NODEFECT                    1761 06624000
*/*    THEN                                                          */ 06625000
*      THEN DO;                                                    1761 06626000
*                                                                  1761 06627000
@RF01741 TM    TRACKTYP,B'10000000'                                1761 06628000
         BNZ   @RF01761                                            1761 06629000
         TM    DFLAGC,B'10000000'                                  1761 06630000
         BNZ   @RF01761                                            1761 06631000
*/*      IF THE TRACK ASSOCIATION ADDRESS IS POINTING TO A PRIMARY   */ 06632000
*        IF (RZCCHHC <= FINPRIC) & (RZCCHHT <= FINPRIT)            1763 06633000
*         & (RZCCHHT >= 0)                                         1763 06634000
*/*        THEN                                                      */ 06635000
*          THEN DO;                                                1763 06636000
*                                                                  1763 06637000
         L     @06,INFOPTR+72                                      1763 06638000
         CLC   RZCCHHC(2),FINPRIC(@06)                             1763 06639000
         BH    @RF01763                                            1763 06640000
         CLC   RZCCHHT(2),FINPRIT(@06)                             1763 06641000
         BH    @RF01763                                            1763 06642000
*/*          OBTAIN_TRACK_STATUS (OF THE PRIMARY TRACK)              */ 06643000
*            CALL OBTTRST (RZCCHH                                  1765 06644000
*                         ,DFLAGA                                  1765 06645000
*                         ,RZACCHH                                 1765 06646000
*                         ,PRITRACK);                              1765 06647000
         LA    @06,RZCCHH                                          1765 06648000
         ST    @06,@AL00001                                        1765 06649000
         LA    @06,DFLAGA                                          1765 06650000
         ST    @06,@AL00001+4                                      1765 06651000
         LA    @06,RZACCHH                                         1765 06652000
         ST    @06,@AL00001+8                                      1765 06653000
         LA    @06,@CB00466                                        1765 06654000
         ST    @06,@AL00001+12                                     1765 06655000
         LA    @01,@AL00001                                        1765 06656000
         BAL   @14,OBTTRST                                         1765 06657000
*/*          IF NO SEVERE ERRORS FOUND (LASTCOND < 12)               */ 06658000
*            IF LASTCOND < LASTCC12                                1766 06659000
*/*            THEN                                                  */ 06660000
*              THEN DO;                                            1766 06661000
*                                                                  1766 06662000
         L     @06,@PC00001+8                                      1766 06663000
         LH    @06,LASTCOND(,@06)                                  1766 06664000
         CH    @06,@CH00265                                        1766 06665000
         BNL   @RF01766                                            1766 06666000
*/*              IF ASSOCIATION ADDRESS OF THE PRIMARY IS POINTING   */ 06667000
*/*               TO THE ALTERNATE TRACK IN QUESTION AND THE PRIMARY */ 06668000
*/*               TRACK IS FLAGGED DEFECTIVE                         */ 06669000
*                IF (RZACCHH = CTRADDR) & (DFLAGA = DEFECTIV)      1768 06670000
*/*                THEN INDICATE TRACK IS ASSOCIATED                 */ 06671000
*                  THEN DO;    ASSOCFLG = ASSOCYES; END;           1768 06672000
         CLC   RZACCHH(4),CTRADDR                                  1768 06673000
         BNE   @RF01768                                            1768 06674000
         TM    DFLAGA,B'10000000'                                  1768 06675000
         BNO   @RF01768                                            1768 06676000
         OI    ASSOCFLG,B'10000000'                                1770 06677000
*/*                ELSE INDICATE TRACK IS NOT ASSOCIATED             */ 06678000
*                  ELSE DO;    ASSOCFLG = ASSOCNO; END;            1772 06679000
         B     @RC01768                                            1772 06680000
@RF01768 DS    0H                                                  1773 06681000
         NI    ASSOCFLG,B'01111111'                                1773 06682000
*/*              END-THEN (NO SEVERE ERRORS)                         */ 06683000
*                END;                                              1775 06684000
*/*          END-THEN (ALTERNATE ASSOCIATED WITH PRIMARY)            */ 06685000
*            END;                                                  1776 06686000
*/*      END-THEN (NON-DEFECTIVE ALTERNATE TRACK)                    */ 06687000
*        END;                                                      1777 06688000
*/*  END-SUB-PROCEDURE CHECK_ASSOCIATION                             */ 06689000
*    END CHASSOC;                                                  1778 06690000
*                                                                  1778 06691000
@EL00019 DS    0H                                                  1778 06692000
@EF00019 DS    0H                                                  1778 06693000
@ER00019 LM    @14,@12,@SA00019                                    1778 06694000
         BR    @14                                                 1778 06695000
         EJECT                                                          06696000
*/*****  START OF SPECIFICATIONS  ************************************/ 06697000
*/*                                                                  */ 06698000
*/*  SUB-PROCEDURE NAME:  DESCMESS                                   */ 06699000
*/*                                                                  */ 06700000
*/*  DESCRIPTIVE NAME:  ISSUE DESCRIPTOR MESSAGE                     */ 06701000
*/*                                                                  */ 06702000
*/*  FUNCTION:                                                       */ 06703000
*/*                                                                  */ 06704000
*/*    THIS SUB-PROCEDURE ISSUES A WARNING MESSAGE ABOUT A TRACK     */ 06705000
*/*    DESCRIPTOR WHICH IS IMPROPERLY ASSOCIATED OR HAS ITS DEFECT   */ 06706000
*/*    FLAG SET ON WITHOUT A PROPER ASSOCIATION.                     */ 06707000
*/*                                                                  */ 06708000
*/*****  END OF SPECIFICATIONS  **************************************/ 06709000
*                                                                  1779 06710000
*                                                                  1779 06711000
*/*  SUB-PROCEDURE ISSUE_DESCRIPTOR_MESSAGE                          */ 06712000
*    DESCMESS:                                                     1779 06713000
*      PROCEDURE;                                                  1779 06714000
DESCMESS STM   @14,@12,@SA00020                                    1779 06715000
*    OLDERID2 = NEWERID2;                                          1780 06716000
         L     @06,@PC00001                                        1780 06717000
         L     @06,GDTTR2(,@06)                                    1780 06718000
         MVC   @TS00001(95),NEWERID2(@06)                          1780 06719000
         MVC   OLDERID2(95,@06),@TS00001                           1780 06720000
*    NEWID2 =  'ITDM';                                             1781 06721000
         MVC   NEWID2(4,@06),@CC01004                              1781 06722000
*/*  ISSUE ERROR MESSAGE (MSGMEDAL)                                  */ 06723000
*    DARGSENT = MSGMEDAL;                                          1782 06724000
         L     @06,DDSTRU                                          1782 06725000
         MVI   DARGSENT(@06),X'08'                                 1782 06726000
*    DARGCNT = 8;                                                  1783 06727000
         MVC   DARGCNT(2,@06),@CH00161                             1783 06728000
*    IF DFLAGC = DEFECTIV                                          1784 06729000
*      THEN DO;                                                    1784 06730000
         TM    DFLAGC,B'10000000'                                  1784 06731000
         BNO   @RF01784                                            1784 06732000
*        DARGINS (1) = 1;                                          1786 06733000
         LA    @15,1                                               1786 06734000
         STH   @15,DARGINS(,@06)                                   1786 06735000
*        DARGINL (1) = LENGTH ('D');                               1787 06736000
         STH   @15,DARGINL(,@06)                                   1787 06737000
*        DARGDTM (1) = ADDR ('D');                                 1788 06738000
         LA    @15,@CC01005                                        1788 06739000
         ST    @15,DARGDTM(,@06)                                   1788 06740000
*        END;                                                      1789 06741000
*      ELSE DO;                                                    1790 06742000
         B     @RC01784                                            1790 06743000
@RF01784 DS    0H                                                  1791 06744000
*        DARGINS (1) = 1;                                          1791 06745000
         LA    @06,1                                               1791 06746000
         L     @15,DDSTRU                                          1791 06747000
         STH   @06,DARGINS(,@15)                                   1791 06748000
*        DARGINL (1) = LENGTH ('N');                               1792 06749000
         STH   @06,DARGINL(,@15)                                   1792 06750000
*        DARGDTM (1) = ADDR ('N');                                 1793 06751000
         LA    @06,@CC01006                                        1793 06752000
         ST    @06,DARGDTM(,@15)                                   1793 06753000
*        END;                                                      1794 06754000
*    DARGINS (2) = 2;                                              1795 06755000
@RC01784 LA    @06,2                                               1795 06756000
         L     @15,DDSTRU                                          1795 06757000
         STH   @06,DARGINS+8(,@15)                                 1795 06758000
*    DARGINL (2) = LENGTH (CTRADDRC);                              1796 06759000
         STH   @06,DARGINL+8(,@15)                                 1796 06760000
*    DARGDTM (2) = ADDR (CTRADDRC);                                1797 06761000
         LA    @14,CTRADDRC                                        1797 06762000
         ST    @14,DARGDTM+8(,@15)                                 1797 06763000
*    DARGINS (3) = 3;                                              1798 06764000
         MVC   DARGINS+16(2,@15),@CH00136                          1798 06765000
*    DARGINL (3) = LENGTH (CTRADDRT);                              1799 06766000
         STH   @06,DARGINL+16(,@15)                                1799 06767000
*    DARGDTM (3) = ADDR (CTRADDRT);                                1800 06768000
         LA    @14,CTRADDRT                                        1800 06769000
         ST    @14,DARGDTM+16(,@15)                                1800 06770000
*    DARGINS (4) = 4;                                              1801 06771000
         MVC   DARGINS+24(2,@15),@CH00044                          1801 06772000
*    DARGINL (4) = LENGTH (RZCCHHC);                               1802 06773000
         STH   @06,DARGINL+24(,@15)                                1802 06774000
*    DARGDTM (4) = ADDR (RZCCHHC);                                 1803 06775000
         LA    @14,RZCCHHC                                         1803 06776000
         ST    @14,DARGDTM+24(,@15)                                1803 06777000
*    DARGINS (5) = 5;                                              1804 06778000
         MVC   DARGINS+32(2,@15),@CH00255                          1804 06779000
*    DARGINL (5) = LENGTH (RZCCHHT);                               1805 06780000
         STH   @06,DARGINL+32(,@15)                                1805 06781000
*    DARGDTM (5) = ADDR (RZCCHHT);                                 1806 06782000
         LA    @06,RZCCHHT                                         1806 06783000
         ST    @06,DARGDTM+32(,@15)                                1806 06784000
*    IF DFLAGA = DEFECTIV                                          1807 06785000
*      THEN DO;                                                    1807 06786000
         TM    DFLAGA,B'10000000'                                  1807 06787000
         BNO   @RF01807                                            1807 06788000
*        DARGINS (6) = 6;                                          1809 06789000
         MVC   DARGINS+40(2,@15),@CH00119                          1809 06790000
*        DARGINL (6) = LENGTH ('D');                               1810 06791000
         MVC   DARGINL+40(2,@15),@CH00165                          1810 06792000
*        DARGDTM (6) = ADDR ('D');                                 1811 06793000
         LA    @06,@CC01005                                        1811 06794000
         ST    @06,DARGDTM+40(,@15)                                1811 06795000
*        END;                                                      1812 06796000
*      ELSE DO;                                                    1813 06797000
         B     @RC01807                                            1813 06798000
@RF01807 DS    0H                                                  1814 06799000
*        DARGINS (6) = 6;                                          1814 06800000
         L     @06,DDSTRU                                          1814 06801000
         MVC   DARGINS+40(2,@06),@CH00119                          1814 06802000
*        DARGINL (6) = LENGTH ('N');                               1815 06803000
         MVC   DARGINL+40(2,@06),@CH00165                          1815 06804000
*        DARGDTM (6) = ADDR ('N');                                 1816 06805000
         LA    @15,@CC01006                                        1816 06806000
         ST    @15,DARGDTM+40(,@06)                                1816 06807000
*        END;                                                      1817 06808000
*    DARGINS (7) = 7;                                              1818 06809000
@RC01807 L     @06,DDSTRU                                          1818 06810000
         MVC   DARGINS+48(2,@06),@CH00185                          1818 06811000
*    DARGINL (7) = LENGTH (RZACCHHC);                              1819 06812000
         LA    @15,2                                               1819 06813000
         STH   @15,DARGINL+48(,@06)                                1819 06814000
*    DARGDTM (7) = ADDR (RZACCHHC);                                1820 06815000
         LA    @14,RZACCHHC                                        1820 06816000
         ST    @14,DARGDTM+48(,@06)                                1820 06817000
*    DARGINS (8) = 8;                                              1821 06818000
         MVC   DARGINS+56(2,@06),@CH00161                          1821 06819000
*    DARGINL (8) = LENGTH (RZACCHHT);                              1822 06820000
         STH   @15,DARGINL+56(,@06)                                1822 06821000
*    DARGDTM (8) = ADDR (RZACCHHT);                                1823 06822000
         LA    @15,RZACCHHT                                        1823 06823000
         ST    @15,DARGDTM+56(,@06)                                1823 06824000
*    CALL ICKTPPR0 (GDTTBL                                         1824 06825000
*           ,PRTFILE                                               1824 06826000
*           ,DDSTRU);                                              1824 06827000
         L     @06,@PC00001                                        1824 06828000
         ST    @06,@AL00001                                        1824 06829000
         LA    @15,@CF00094                                        1824 06830000
         ST    @15,@AL00001+4                                      1824 06831000
         LA    @15,DDSTRU                                          1824 06832000
         ST    @15,@AL00001+8                                      1824 06833000
         MVI   @AL00001+8,X'80'                                    1824 06834000
         L     @15,GDTPRT(,@06)                                    1824 06835000
         LA    @01,@AL00001                                        1824 06836000
         BALR  @14,@15                                             1824 06837000
*/*  INDICATE AN ERROR                                               */ 06838000
*    LASTCOND = MAX(LASTCOND,LASTCC08);                            1825 06839000
         L     @06,@PC00001+8                                      1825 06840000
         LH    @15,LASTCOND(,@06)                                  1825 06841000
         LA    @14,8                                               1825 06842000
         CR    @15,@14                                             1825 06843000
         BNL   *+6                                                      06844000
         LR    @15,@14                                             1825 06845000
         STH   @15,LASTCOND(,@06)                                  1825 06846000
*/*  IF TRACK IS A CRITICAL TRACK                                    */ 06847000
*    IF CTRADDR = 0 | (CTRADDR >= VTLOEX & CTRADDR <= VTHIEX)      1826 06848000
*/*    THEN (CRITICAL TRACK)                                         */ 06849000
*      THEN DO;                                                    1826 06850000
         L     @06,CTRADDR                                         1826 06851000
         LTR   @06,@06                                             1826 06852000
         BZ    @RT01826                                            1826 06853000
         L     @15,F4PTR                                           1826 06854000
         MVC   @TF00001(4),VTLOEX(@15)                             1826 06855000
         CL    @06,@TF00001                                        1826 06856000
         BL    @RF01826                                            1826 06857000
         MVC   @TF00001(4),VTHIEX(@15)                             1826 06858000
         CL    @06,@TF00001                                        1826 06859000
         BH    @RF01826                                            1826 06860000
@RT01826 DS    0H                                                  1827 06861000
*/*      ISSUE SEVERE ERROR MESSAGE                                  */ 06862000
*        DARGSENT = MSGMINV;                                       1828 06863000
         L     @06,DDSTRU                                          1828 06864000
         MVI   DARGSENT(@06),X'0C'                                 1828 06865000
*        DARGCNT = 2;                                              1829 06866000
         LA    @15,2                                               1829 06867000
         STH   @15,DARGCNT(,@06)                                   1829 06868000
*        DARGINS (1) = 1;                                          1830 06869000
         MVC   DARGINS(2,@06),@CH00165                             1830 06870000
*        DARGINL (1) = LENGTH (CTRADDRC);                          1831 06871000
         STH   @15,DARGINL(,@06)                                   1831 06872000
*        DARGDTM (1) = ADDR (CTRADDRC);                            1832 06873000
         LA    @14,CTRADDRC                                        1832 06874000
         ST    @14,DARGDTM(,@06)                                   1832 06875000
*        DARGINS (2) = 2;                                          1833 06876000
         STH   @15,DARGINS+8(,@06)                                 1833 06877000
*        DARGINL (2) = LENGTH (CTRADDRT);                          1834 06878000
         STH   @15,DARGINL+8(,@06)                                 1834 06879000
*        DARGDTM (2) = ADDR (CTRADDRT);                            1835 06880000
         LA    @15,CTRADDRT                                        1835 06881000
         ST    @15,DARGDTM+8(,@06)                                 1835 06882000
*        CALL ICKTPPR0 (GDTTBL                                     1836 06883000
*               ,PRTFILE                                           1836 06884000
*               ,DDSTRU);                                          1836 06885000
         L     @06,@PC00001                                        1836 06886000
         ST    @06,@AL00001                                        1836 06887000
         LA    @15,@CF00094                                        1836 06888000
         ST    @15,@AL00001+4                                      1836 06889000
         LA    @15,DDSTRU                                          1836 06890000
         ST    @15,@AL00001+8                                      1836 06891000
         MVI   @AL00001+8,X'80'                                    1836 06892000
         L     @15,GDTPRT(,@06)                                    1836 06893000
         LA    @01,@AL00001                                        1836 06894000
         BALR  @14,@15                                             1836 06895000
*/*      END-THEN                                                    */ 06896000
*        END;                                                      1837 06897000
*/*  END-SUB-PROCEDURE ISSUE_DESCRIPTOR_MESSAGE                      */ 06898000
*    END DESCMESS;                                                 1838 06899000
*                                                                  1838 06900000
@EL00020 DS    0H                                                  1838 06901000
@EF00020 DS    0H                                                  1838 06902000
@ER00020 LM    @14,@12,@SA00020                                    1838 06903000
         BR    @14                                                 1838 06904000
         EJECT                                                          06905000
*/*****  START OF SPECIFICATIONS  ************************************/ 06906000
*/*                                                                  */ 06907000
*/*  SUB-PROCEDURE NAME:  VALHOME                                    */ 06908000
*/*                                                                  */ 06909000
*/*  DESCRIPTIVE NAME:  VALIDATE HOME-ADDRESS                        */ 06910000
*/*                                                                  */ 06911000
*/*  FUNCTION:                                                       */ 06912000
*/*                                                                  */ 06913000
*/*    THIS SUB-PROCEDURE VALIDATES THE HOME-ADDRESS ON A TRACK      */ 06914000
*/*    BEFORE ANY FORMATTING WRITE OPERATION IS PERFORMED ON THE     */ 06915000
*/*    TRACK.                                                        */ 06916000
*/*                                                                  */ 06917000
*/*****  END OF SPECIFICATIONS  **************************************/ 06918000
*                                                                  1839 06919000
*                                                                  1839 06920000
*/*  SUB-PROCEDURE VALIDATE_HOME-ADDRESS                             */ 06921000
*    VALHOME:                                                      1839 06922000
*      PROCEDURE;                                                  1839 06923000
VALHOME  STM   @14,@12,@SA00021                                    1839 06924000
*      DCL RETCODED          /* RETURN CODE FROM CALLED PROGRAMS     */ 06925000
*                            FIXED (31);                           1840 06926000
*                                                                  1840 06927000
*    OLDERID2 = NEWERID2;                                          1841 06928000
         L     @06,@PC00001                                        1841 06929000
         L     @06,GDTTR2(,@06)                                    1841 06930000
         MVC   @TS00001(95),NEWERID2(@06)                          1841 06931000
         MVC   OLDERID2(95,@06),@TS00001                           1841 06932000
*    NEWID2 =  'ITVH';                                             1842 06933000
         MVC   NEWID2(4,@06),@CC01011                              1842 06934000
*/*  IF TRACK IS A PRIMARY TRACK                                     */ 06935000
*    IF TRACKTYP = PRITRACK                                        1843 06936000
*/*    THEN SET ACTION KEY FOR PRIMARY TRACK                         */ 06937000
*      THEN DO;    VAACTION = ACTVPHA; END;                        1843 06938000
         TM    TRACKTYP,B'10000000'                                1843 06939000
         BNO   @RF01843                                            1843 06940000
         MVC   VAACTION(4),@CF00267                                1845 06941000
*/*    ELSE SET ACTION KEY FOR ALTERNATE TRACK                       */ 06942000
*      ELSE DO;    VAACTION = ACTVAHA; END;                        1847 06943000
         B     @RC01843                                            1847 06944000
@RF01843 DS    0H                                                  1848 06945000
         MVC   VAACTION(4),@CF00274                                1848 06946000
*/*  VALIDATE HOME-ADDRESS (UDEVOP)                                  */ 06947000
*    CALL ICKDVOP0 (GDTTBL                                         1850 06948000
*           ,VOLIB                                                 1850 06949000
*           ,VAACTION                                              1850 06950000
*           ,CTRADDR                                               1850 06951000
*           ,RECNUM                                                1850 06952000
*           ,POOLID                                                1850 06953000
*           ,HAPTR                                                 1850 06954000
*           ,HALEN                                                 1850 06955000
*           ,RETCODED);                                            1850 06956000
@RC01843 L     @06,@PC00001                                        1850 06957000
         ST    @06,@AL00001                                        1850 06958000
         LA    @15,VOLIB                                           1850 06959000
         ST    @15,@AL00001+4                                      1850 06960000
         LA    @15,VAACTION                                        1850 06961000
         ST    @15,@AL00001+8                                      1850 06962000
         LA    @15,CTRADDR                                         1850 06963000
         ST    @15,@AL00001+12                                     1850 06964000
         LA    @15,RECNUM                                          1850 06965000
         ST    @15,@AL00001+16                                     1850 06966000
         LA    @15,POOLID                                          1850 06967000
         ST    @15,@AL00001+20                                     1850 06968000
         LA    @15,HAPTR                                           1850 06969000
         ST    @15,@AL00001+24                                     1850 06970000
         LA    @15,HALEN                                           1850 06971000
         ST    @15,@AL00001+28                                     1850 06972000
         LA    @15,RETCODED                                        1850 06973000
         ST    @15,@AL00001+32                                     1850 06974000
         L     @15,GDTDOP(,@06)                                    1850 06975000
         LA    @01,@AL00001                                        1850 06976000
         BALR  @14,@15                                             1850 06977000
*/*  IF VALIDATION FAILS                                             */ 06978000
*    IF RETCODED = CPFAILS                                         1851 06979000
*/*    THEN                                                          */ 06980000
*      THEN DO;                                                    1851 06981000
         CLC   RETCODED(4),@CF00044                                1851 06982000
         BNE   @RF01851                                            1851 06983000
*/*      COUNT_UNRECOVERABLE_TRACKS                                  */ 06984000
*        IF TRACKTYP = PRITRACK                                    1853 06985000
*          THEN DO;    UNTRTYPE = PRITRACK; END;                   1853 06986000
         TM    TRACKTYP,B'10000000'                                1853 06987000
         BNO   @RF01853                                            1853 06988000
         OI    UNTRTYPE,B'10000000'                                1855 06989000
*          ELSE DO;    UNTRTYPE = ALTTRACK; END;                   1857 06990000
         B     @RC01853                                            1857 06991000
@RF01853 DS    0H                                                  1858 06992000
         NI    UNTRTYPE,B'01111111'                                1858 06993000
*        UNTRACK = CTRADDR;                                        1860 06994000
@RC01853 MVC   UNTRACK(4),CTRADDR                                  1860 06995000
*        CALL COUNTRKS;                                            1861 06996000
         BAL   @14,COUNTRKS                                        1861 06997000
*/*      END-THEN                                                    */ 06998000
*        END;                                                      1862 06999000
*/*    ELSE                                                          */ 07000000
*      ELSE DO;                                                    1863 07001000
         B     @RC01851                                            1863 07002000
@RF01851 DS    0H                                                  1864 07003000
*/*      IF DEFECT FLAG IS SET                                       */ 07004000
*        IF RETCODED = DFLAGONP | RETCODED = DFLAGONA              1864 07005000
*/*        THEN SAVE THE DEFECT-FLAG SETTING                         */ 07006000
*          THEN DO;    DFLAGC = DEFECTIV; END;                     1864 07007000
         L     @06,RETCODED                                        1864 07008000
         CH    @06,@CH00116                                        1864 07009000
         BE    @RT01864                                            1864 07010000
         CH    @06,@CH00119                                        1864 07011000
         BNE   @RF01864                                            1864 07012000
@RT01864 DS    0H                                                  1865 07013000
         OI    DFLAGC,B'10000000'                                  1866 07014000
*/*        ELSE INDICATE THE DEFECT-FLAG IS NOT SET                  */ 07015000
*          ELSE DO;    DFLAGC = NODEFECT; END;                     1868 07016000
         B     @RC01864                                            1868 07017000
@RF01864 DS    0H                                                  1869 07018000
         NI    DFLAGC,B'01111111'                                  1869 07019000
*/*      END-ELSE                                                    */ 07020000
*        END;                                                      1871 07021000
*/*  END-SUB-PROCEDURE VALIDATE_HOME-ADDRESS                         */ 07022000
*    END VALHOME;                                                  1872 07023000
*                                                                  1872 07024000
@EL00021 DS    0H                                                  1872 07025000
@EF00021 DS    0H                                                  1872 07026000
@ER00021 LM    @14,@12,@SA00021                                    1872 07027000
         BR    @14                                                 1872 07028000
         EJECT                                                          07029000
*/*****  START OF SPECIFICATIONS  ************************************/ 07030000
*/*                                                                  */ 07031000
*/*  SUB-PROCEDURE NAME:  DCVTPROC                                   */ 07032000
*/*                                                                  */ 07033000
*/*  DESCRIPTIVE NAME:  DISCRETE-TRACK ADDRESS CONVERTOR             */ 07034000
*/*                                                                  */ 07035000
*/*  FUNCTION:                                                       */ 07036000
*/*                                                                  */ 07037000
*/*    CONVERTS A HEXADECIMAL DISCRETE-TRACK ADDRESS IN CHARACTER    */ 07038000
*/*    STRING FORM (9 BYTES LONG) TO INTERNAL HEXADECIMAL            */ 07039000
*/*    REPRESENTATION.                                               */ 07040000
*/*                                                                  */ 07041000
*/*                                                                  */ 07042000
*/*****  END OF SPECIFICATIONS  **************************************/ 07043000
*                                                                  1873 07044000
*                                                                  1873 07045000
*DCVTPROC:                                                         1873 07046000
*  PROCEDURE                                                       1873 07047000
*    (                                                             1873 07048000
*    DCVTSRCE,                                                     1873 07049000
*    DCVTCCHH,                                                     1873 07050000
*    DCVTLEGL                                                      1873 07051000
*    );                                                            1873 07052000
*                                                                  1873 07053000
DCVTPROC STM   @14,@12,@SA00022                                    1873 07054000
         MVC   @PC00022(12),0(@01)                                 1873 07055000
*DECLARE                                                           1874 07056000
*  DCVTSRCE                   CHAR(9),                             1874 07057000
*  1 DCVTCCHH                 FIXED(32),                           1874 07058000
*    2 DCVTCC                 FIXED(16),                           1874 07059000
*    2 DCVTHH                 FIXED(16),                           1874 07060000
*  DCVTLEGL                   BIT(1);                              1874 07061000
*                                                                  1874 07062000
*DECLARE                                                           1875 07063000
*  DCVTHEXC(16)               CHAR(1)  INIT                        1875 07064000
*                             ('0','1','2','3','4','5','6','7',    1875 07065000
*                                  '8','9','A','B','C','D','E','F'),    07066000
*  DCVTHEXN(16)               FIXED(8)  INIT                       1875 07067000
*                             (0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15),  07068000
*  DCVTSTR                    CHAR(9),                             1875 07069000
*  DCVTI                      FIXED(15);                           1875 07070000
*                                                                  1875 07071000
*OLDERID2 = NEWERID2;                                              1876 07072000
         L     @06,@PC00001                                        1876 07073000
         L     @06,GDTTR2(,@06)                                    1876 07074000
         MVC   @TS00001(95),NEWERID2(@06)                          1876 07075000
         MVC   OLDERID2(95,@06),@TS00001                           1876 07076000
*NEWID2 = 'ITDC';                                                  1877 07077000
*                                                                  1877 07078000
         MVC   NEWID2(4,@06),@CC01042                              1877 07079000
*DO DCVTI = 1 TO 9 WHILE(DCVTSRCE(DCVTI:DCVTI) ^= ':');            1878 07080000
         LA    DCVTI,1                                             1878 07081000
@DL01878 L     @06,@PC00022                                        1878 07082000
         ALR   @06,DCVTI                                           1878 07083000
         BCTR  @06,0                                               1878 07084000
         CLI   DCVTSRCE(@06),C':'                                  1878 07085000
         BE    @DC01878                                            1878 07086000
*END;                                                              1879 07087000
*                                                                  1879 07088000
         AL    DCVTI,@CF00165                                      1879 07089000
         CH    DCVTI,@CH00260                                      1879 07090000
         BNH   @DL01878                                            1879 07091000
@DC01878 DS    0H                                                  1880 07092000
*IF DCVTI = 1  |  DCVTI >= 9                                       1880 07093000
*  THEN DCVTLEGL = NO;                                             1880 07094000
         CH    DCVTI,@CH00165                                      1880 07095000
         BE    @RT01880                                            1880 07096000
         CH    DCVTI,@CH00260                                      1880 07097000
         BL    @RF01880                                            1880 07098000
@RT01880 DS    0H                                                  1881 07099000
         L     @06,@PC00022+8                                      1881 07100000
         NI    DCVTLEGL(@06),B'01111111'                           1881 07101000
*  ELSE DO;                                                        1882 07102000
         B     @RC01880                                            1882 07103000
@RF01880 DS    0H                                                  1883 07104000
*    DCVTSTR = DCVTSRCE(1:DCVTI-1);                                1883 07105000
         MVI   DCVTSTR+1,C' '                                      1883 07106000
         MVC   DCVTSTR+2(7),DCVTSTR+1                              1883 07107000
         LR    @06,DCVTI                                           1883 07108000
         BCTR  @06,0                                               1883 07109000
         BCTR  @06,0                                               1883 07110000
         L     @03,@PC00022                                        1883 07111000
         EX    @06,@SM01071                                        1883 07112000
*    CALL DCVTCNVT (DCVTSTR,DCVTCC);                               1884 07113000
         LA    @06,DCVTSTR                                         1884 07114000
         ST    @06,@AL00001                                        1884 07115000
         L     @06,@PC00022+4                                      1884 07116000
         ST    @06,@AL00001+4                                      1884 07117000
         LA    @01,@AL00001                                        1884 07118000
         BAL   @14,DCVTCNVT                                        1884 07119000
*    IF DCVTLEGL = YES                                             1885 07120000
*      THEN DO;                                                    1885 07121000
         L     @06,@PC00022+8                                      1885 07122000
         TM    DCVTLEGL(@06),B'10000000'                           1885 07123000
         BNO   @RF01885                                            1885 07124000
*        DCVTSTR = DCVTSRCE(DCVTI+1:9);                            1887 07125000
         MVI   DCVTSTR+1,C' '                                      1887 07126000
         MVC   DCVTSTR+2(7),DCVTSTR+1                              1887 07127000
         LA    @06,8                                               1887 07128000
         SLR   @06,DCVTI                                           1887 07129000
         L     @03,@PC00022                                        1887 07130000
         ALR   @03,DCVTI                                           1887 07131000
         EX    @06,@SM01071                                        1887 07132000
*        CALL DCVTCNVT (DCVTSTR,DCVTHH);                           1888 07133000
         LA    @06,DCVTSTR                                         1888 07134000
         ST    @06,@AL00001                                        1888 07135000
         L     @06,@PC00022+4                                      1888 07136000
         LA    @06,DCVTHH(,@06)                                    1888 07137000
         ST    @06,@AL00001+4                                      1888 07138000
         LA    @01,@AL00001                                        1888 07139000
         BAL   @14,DCVTCNVT                                        1888 07140000
*        END;                                                      1889 07141000
*    END;                                                          1890 07142000
*                                                                  1890 07143000
*DCVTCNVT:                                                         1891 07144000
*  PROCEDURE                                                       1891 07145000
*    (                                                             1891 07146000
*    DCVTCHRS,                                                     1891 07147000
*    DCVTNUM                                                       1891 07148000
*    );                                                            1891 07149000
*                                                                  1891 07150000
         B     @PB00023                                            1891 07151000
DCVTCNVT STM   @14,@12,12(@13)                                     1891 07152000
         MVC   @PC00023(8),0(@01)                                  1891 07153000
*DECLARE                                                           1892 07154000
*  DCVTCHRS                       CHAR(9),                         1892 07155000
*  DCVTNUM                        FIXED(16);                       1892 07156000
*                                                                  1892 07157000
*DECLARE                                                           1893 07158000
*  DCVTMULT                       FIXED(16),                       1893 07159000
*  (DCVTII,DCVTJJ)                FIXED(15);                       1893 07160000
*                                                                  1893 07161000
*DCVTNUM = 0;                                                      1894 07162000
         L     @06,@PC00023+4                                      1894 07163000
         SLR   @03,@03                                             1894 07164000
         STH   @03,DCVTNUM(,@06)                                   1894 07165000
*DCVTMULT = 1;                                                     1895 07166000
         LA    DCVTMULT,1                                          1895 07167000
*DO DCVTII = 9 TO 1 BY -1;                                         1896 07168000
         LA    DCVTII,9                                            1896 07169000
@DL01896 DS    0H                                                  1897 07170000
*  DCVTLEGL = NO;                                                  1897 07171000
         L     @06,@PC00022+8                                      1897 07172000
         NI    DCVTLEGL(@06),B'01111111'                           1897 07173000
*  IF DCVTCHRS(DCVTII:DCVTII) ^= ' '                               1898 07174000
*    THEN DO;                                                      1898 07175000
         L     @06,@PC00023                                        1898 07176000
         ALR   @06,DCVTII                                          1898 07177000
         BCTR  @06,0                                               1898 07178000
         CLI   DCVTCHRS(@06),C' '                                  1898 07179000
         BE    @RF01898                                            1898 07180000
*      DO DCVTJJ = 1 TO 16 WHILE (DCVTLEGL = NO);                  1900 07181000
         LA    DCVTJJ,1                                            1900 07182000
@DL01900 L     @06,@PC00022+8                                      1900 07183000
         TM    DCVTLEGL(@06),B'10000000'                           1900 07184000
         BNZ   @DC01900                                            1900 07185000
*        IF DCVTCHRS(DCVTII:DCVTII) = DCVTHEXC(DCVTJJ)             1901 07186000
*          THEN IF DCVTMULT <= 4096                                1901 07187000
         L     @05,@PC00023                                        1901 07188000
         ALR   @05,DCVTII                                          1901 07189000
         BCTR  @05,0                                               1901 07190000
         LA    @01,DCVTHEXC-1(DCVTJJ)                              1901 07191000
         CLC   DCVTCHRS(1,@05),0(@01)                              1901 07192000
         BNE   @RF01901                                            1901 07193000
*            THEN DO;                                              1902 07194000
         CL    DCVTMULT,@CF01056                                   1902 07195000
         BH    @RF01902                                            1902 07196000
*              DCVTNUM = DCVTNUM + (DCVTMULT * DCVTHEXN(DCVTJJ));  1904 07197000
         L     @05,@PC00023+4                                      1904 07198000
         SLR   @01,@01                                             1904 07199000
         IC    @01,DCVTHEXN-1(DCVTJJ)                              1904 07200000
         MR    @00,DCVTMULT                                        1904 07201000
         MVC   @ZT00002+2(2),DCVTNUM(@05)                          1904 07202000
         AL    @01,@ZT00002                                        1904 07203000
         STH   @01,DCVTNUM(,@05)                                   1904 07204000
*              DCVTMULT = DCVTMULT * 16;                           1905 07205000
         SLL   DCVTMULT,4                                          1905 07206000
*              DCVTLEGL = YES;                                     1906 07207000
         OI    DCVTLEGL(@06),B'10000000'                           1906 07208000
*              END;                                                1907 07209000
*      END;                                                        1908 07210000
@RF01902 DS    0H                                                  1908 07211000
@RF01901 AL    DCVTJJ,@CF00165                                     1908 07212000
         CH    DCVTJJ,@CH00272                                     1908 07213000
         BNH   @DL01900                                            1908 07214000
@DC01900 DS    0H                                                  1909 07215000
*      IF DCVTLEGL = NO                                            1909 07216000
*        THEN RETURN;                                              1909 07217000
         L     @06,@PC00022+8                                      1909 07218000
         TM    DCVTLEGL(@06),B'10000000'                           1909 07219000
         BZ    @RT01909                                            1909 07220000
*      END;                                                        1911 07221000
*END;                                                              1912 07222000
*                                                                  1912 07223000
@RF01898 BCTR  DCVTII,0                                            1912 07224000
         LTR   DCVTII,DCVTII                                       1912 07225000
         BP    @DL01896                                            1912 07226000
*END DCVTCNVT;                                                     1913 07227000
*                                                                  1913 07228000
@EL00023 DS    0H                                                  1913 07229000
@EF00023 DS    0H                                                  1913 07230000
@ER00023 LM    @14,@12,12(@13)                                     1913 07231000
         BR    @14                                                 1913 07232000
*END DCVTPROC;                                                     1914 07233000
*                                                                  1914 07234000
*                                                                  1914 07235000
@EL00022 DS    0H                                                  1914 07236000
@EF00022 DS    0H                                                  1914 07237000
@ER00022 LM    @14,@12,@SA00022                                    1914 07238000
         BR    @14                                                 1914 07239000
@PB00022 DS    0H                                                  1914 07240000
*/*  END-PROCEDURE INSPECT_COMMAND_CONTROLLER                        */ 07241000
*                                                                  1915 07242000
*    END ICKIT01                                                   1915 07243000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 07244000
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        * 07245000
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        * 07246000
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        * 07247000
*/*%INCLUDE SYSLIB  (DMSDF08 )                                        * 07248000
*/*%INCLUDE SYSLIB  (IECSDSL1)                                        * 07249000
*/*%INCLUDE SYSLIB  (ICKCSIT )                                        * 07250000
*;                                                                 1915 07251000
@DATA    DS    0H                                                       07252000
@CH00185 DC    H'7'                                                     07253000
@CH00272 DC    H'16'                                                    07254000
@SM01071 MVC   DCVTSTR(0),DCVTSRCE(@03)                                 07255000
@DATD    DSECT                                                          07256000
         DS    0F                                                       07257000
@SA00001 DS    18F                                                      07258000
@PC00001 DS    3F                                                       07259000
@SA00002 DS    15F                                                      07260000
@SA00003 DS    15F                                                      07261000
@SA00004 DS    15F                                                      07262000
@SA00005 DS    15F                                                      07263000
@SA00006 DS    15F                                                      07264000
@SA00022 DS    15F                                                      07265000
@PC00022 DS    3F                                                       07266000
@SA00009 DS    15F                                                      07267000
@PC00009 DS    4F                                                       07268000
@SA00019 DS    15F                                                      07269000
@SA00007 DS    15F                                                      07270000
@PC00007 DS    3F                                                       07271000
@SA00021 DS    15F                                                      07272000
@SA00012 DS    15F                                                      07273000
@SA00013 DS    15F                                                      07274000
@SA00014 DS    15F                                                      07275000
@SA00010 DS    15F                                                      07276000
@SA00020 DS    15F                                                      07277000
@SA00008 DS    15F                                                      07278000
@PC00008 DS    1F                                                       07279000
@SA00015 DS    15F                                                      07280000
@PC00015 DS    2F                                                       07281000
@SA00011 DS    15F                                                      07282000
@SA00017 DS    15F                                                      07283000
@SA00016 DS    14F                                                      07284000
@PC00023 DS    2F                                                       07285000
@SA00018 DS    0F                                                       07286000
         DS    15F                                                      07287000
@AL00001 DS    9A                                                       07288000
@TF00001 DS    F                                                        07289000
@AFTEMPS DS    3F                                                       07290000
@ZTEMPS  DS    0F                                                       07291000
@ZT00002 DC    F'0'                                                     07292000
@ZT00003 DC    F'0'                                                     07293000
@ZTEMPND EQU   *                                                        07294000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         07295000
ICKIT01  CSECT                                                          07296000
         DS    0F                                                       07297000
@CF00094 DC    F'0'                                                     07298000
@CF00165 DC    F'1'                                                     07299000
@CH00165 EQU   @CF00165+2                                               07300000
@CF00116 DC    F'2'                                                     07301000
@CH00116 EQU   @CF00116+2                                               07302000
@CF00136 DC    F'3'                                                     07303000
@CH00136 EQU   @CF00136+2                                               07304000
@CF00044 DC    F'4'                                                     07305000
@CH00044 EQU   @CF00044+2                                               07306000
@CF00255 DC    F'5'                                                     07307000
@CH00255 EQU   @CF00255+2                                               07308000
@CF00119 DC    F'6'                                                     07309000
@CH00119 EQU   @CF00119+2                                               07310000
@CF00161 DC    F'8'                                                     07311000
@CH00161 EQU   @CF00161+2                                               07312000
@CF00260 DC    F'9'                                                     07313000
@CH00260 EQU   @CF00260+2                                               07314000
@CF00246 DC    F'10'                                                    07315000
@CH00246 EQU   @CF00246+2                                               07316000
@CF00265 DC    F'12'                                                    07317000
@CH00265 EQU   @CF00265+2                                               07318000
@CF00267 DC    F'13'                                                    07319000
@CF00274 DC    F'17'                                                    07320000
@CF00276 DC    F'18'                                                    07321000
@CF00278 DC    F'19'                                                    07322000
@CF00298 DC    F'29'                                                    07323000
@CF00488 DC    F'96'                                                    07324000
@CF01056 DC    F'4096'                                                  07325000
@CF01068 DC    F'-12'                                                   07326000
@CF01069 DC    F'-8'                                                    07327000
@CF01067 DC    F'-7'                                                    07328000
@CF01070 DC    F'-4'                                                    07329000
@DATD    DSECT                                                          07330000
         DS    0D                                                       07331000
LISTSCAN DS    A                                                        07332000
IOCSPTR  DS    A                                                        07333000
OPNPTR   DS    A                                                        07334000
DDSTRU   DS    A                                                        07335000
FSADDR   DS    A                                                        07336000
DMPINDEX DS    A                                                        07337000
F4PTR    DS    A                                                        07338000
RETCODE  DS    F                                                        07339000
TALCNT   DS    F                                                        07340000
TALPTR   DS    FL4                                                      07341000
         ORG   TALPTR                                                   07342000
TALPTRC  DS    FL2                                                      07343000
TALPTRT  DS    FL2                                                      07344000
         ORG   TALPTR+4                                                 07345000
ALTCOUNT DS    F                                                        07346000
ALTPTR   DS    FL4                                                      07347000
         ORG   ALTPTR                                                   07348000
ALTPTRC  DS    FL2                                                      07349000
ALTPTRT  DS    FL2                                                      07350000
         ORG   ALTPTR+4                                                 07351000
VIBPTR   DS    A                                                        07352000
VIBLEN   DS    F                                                        07353000
RECNUM   DS    F                                                        07354000
DATAPTR  DS    A                                                        07355000
DATALEN  DS    F                                                        07356000
RZPTR    DS    A                                                        07357000
RZLEN    DS    F                                                        07358000
HAPTR    DS    A                                                        07359000
HALEN    DS    F                                                        07360000
VAACTION DS    F                                                        07361000
PACKTRAK DS    F                                                        07362000
PACKASC  DS    F                                                        07363000
PRECNUM  DS    F                                                        07364000
FRECNUM  DS    F                                                        07365000
VOLIB    DS    A                                                        07366000
COUNTUTR DS    F                                                        07367000
CTRADDR  DS    FL4                                                      07368000
         ORG   CTRADDR                                                  07369000
CTRADDRC DS    FL2                                                      07370000
CTRADDRT DS    FL2                                                      07371000
         ORG   CTRADDR+4                                                07372000
LABELS   DS    F                                                        07373000
VTOCEXT  DS    F                                                        07374000
UNTRACK  DS    FL4                                                      07375000
         ORG   UNTRACK                                                  07376000
UNTRACKC DS    FL2                                                      07377000
UNTRACKT DS    FL2                                                      07378000
         ORG   UNTRACK+4                                                07379000
RZCCHH   DS    FL4                                                      07380000
         ORG   RZCCHH                                                   07381000
RZCCHHC  DS    FL2                                                      07382000
RZCCHHT  DS    FL2                                                      07383000
         ORG   RZCCHH+4                                                 07384000
RZACCHH  DS    FL4                                                      07385000
         ORG   RZACCHH                                                  07386000
RZACCHHC DS    FL2                                                      07387000
RZACCHHT DS    FL2                                                      07388000
         ORG   RZACCHH+4                                                07389000
HAACTION DS    F                                                        07390000
RZACTION DS    F                                                        07391000
WRACTION DS    F                                                        07392000
CYCLES   DS    F                                                        07393000
TRKNUMB  DS    F                                                        07394000
RECPTR   DS    A                                                        07395000
RTABLEN  DS    F                                                        07396000
RCDCNT   DS    F                                                        07397000
ALTRACK  DS    FL4                                                      07398000
         ORG   ALTRACK                                                  07399000
ALTRACKC DS    FL2                                                      07400000
ALTRACKT DS    FL2                                                      07401000
         ORG   ALTRACK+4                                                07402000
VIBTYPE  DS    F                                                        07403000
RETCODE1 DS    F                                                        07404000
RETCODE2 DS    F                                                        07405000
RETCODE3 DS    F                                                        07406000
RETCODE4 DS    F                                                        07407000
RETCODE5 DS    F                                                        07408000
RETCODE6 DS    F                                                        07409000
RETCODE7 DS    F                                                        07410000
RETCODE8 DS    F                                                        07411000
RETCODE9 DS    F                                                        07412000
RETCODEA DS    F                                                        07413000
RETCODEB DS    F                                                        07414000
RETCODEC DS    F                                                        07415000
RETCODED DS    F                                                        07416000
I        DS    F                                                        07417000
LISTPTR  DS    A                                                        07418000
VOL1PTR  DS    A                                                        07419000
SETRC    DS    H                                                        07420000
LISTLN   DS    FL1                                                      07421000
@TS00001 DS    CL95                                                     07422000
         DS    CL2                                                      07423000
PRTSTR   DS    CL56                                                     07424000
         ORG   PRTSTR                                                   07425000
PRTHDR   DS    CL4                                                      07426000
PRTARGS  DS    CL52                                                     07427000
         ORG   PRTSTR+56                                                07428000
FOR4DSCB DS    CL96                                                     07429000
VOL1P    DS    CL80                                                     07430000
CHKFLG   DS    BL1                                                      07431000
ASSOCFLG DS    BL1                                                      07432000
SPACEFLG DS    BL1                                                      07433000
CNTFLAG  DS    BL1                                                      07434000
ALTFLAG  DS    BL1                                                      07435000
TRKLEGL  DS    BL1                                                      07436000
TRACKTYP DS    BL1                                                      07437000
UNTRTYPE DS    BL1                                                      07438000
PRTFLG   DS    BL1                                                      07439000
PACKENT  DS    BL1                                                      07440000
DFLAGC   DS    BL1                                                      07441000
DFLAGA   DS    BL1                                                      07442000
RCVRFLAG DS    BL1                                                      07443000
TRSTATUS DS    BL1                                                      07444000
TRKFLAG  DS    BL1                                                      07445000
TRKREAD  DS    BL1                                                      07446000
PACKDEF  DS    BL1                                                      07447000
PACKCHEK DS    BL1                                                      07448000
PACKRCVR DS    BL1                                                      07449000
PACKTRK  DS    BL1                                                      07450000
VALVOWN  DS    CL14                                                     07451000
VTOCLOC  DS    CL4                                                      07452000
         ORG   VTOCLOC                                                  07453000
VTOCLOCC DS    FL2                                                      07454000
VTOCLOCT DS    FL2                                                      07455000
         ORG   VTOCLOC+4                                                07456000
MSSDEV   DS    CL8                                                      07457000
VIBNAME  DS    CL8                                                      07458000
DEVTYPE  DS    CL8                                                      07459000
DCVTSTR  DS    CL9                                                      07460000
ASSGNTYP DS    BL1                                                      07461000
ATRKREAD DS    BL1                                                      07462000
PRGFLG   DS    BL1                                                      07463000
         DS    CL2                                                      07464000
INFO     DS    CL12                                                     07465000
         ORG   INFO+0                                                   07466000
INFOPTR  DS    AL4                                                      07467000
INFOLEN  DS    FL4                                                      07468000
CONDCODE DS    FL4                                                      07469000
         ORG   INFO+96                                                  07470000
TRKVECT  DS    FL4                                                      07471000
         ORG   TRKVECT+0                                                07472000
TRKVECTC DS    FL2                                                      07473000
TRKVECTT DS    FL2                                                      07474000
         ORG   TRKVECT+80                                               07475000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                07476000
@ENDDATD EQU   *                                                        07477000
ICKIT01  CSECT                                                          07478000
         DS    0F                                                       07479000
@SIZDATD DC    AL1(0)                                                   07480000
         DC    AL3(@ENDDATD-@DATD)                                      07481000
@CV00837 DC    V(ICKVA01)                                               07482000
@CV00839 DC    V(ICKVV01)                                               07483000
@CV00843 DC    V(ICKPP01)                                               07484000
@CV00861 DC    V(ICKRL01)                                               07485000
@CV00941 DC    V(ICKAA01)                                               07486000
@CV00950 DC    V(ICKRA01)                                               07487000
@CV00958 DC    V(ICKTA01)                                               07488000
@CV00964 DC    V(ICKRT01)                                               07489000
@CV00970 DC    V(ICKRP01)                                               07490000
@CV00996 DC    V(ICKBM01)                                               07491000
         DS    0D                                                       07492000
@CC00833 DC    C'DARGLIST'                                              07493000
@CC00145 DC    C'ZERO'                                                  07494000
@CC00832 DC    C'IT00'                                                  07495000
@CC00845 DC    C'IT99'                                                  07496000
@CC00849 DC    C'ITCP'                                                  07497000
@CC00854 DC    C'ITOP'                                                  07498000
@CC00860 DC    C'ITST'                                                  07499000
@CC00869 DC    C'ITIN'                                                  07500000
@CC00888 DC    C'ITUV'                                                  07501000
@CC00898 DC    C'ITRE'                                                  07502000
@CC00903 DC    C'ITRT'                                                  07503000
@CC00912 DC    C'ITWI'                                                  07504000
@CC00930 DC    C'ITOT'                                                  07505000
@CC00935 DC    C'ITRZ'                                                  07506000
@CC00940 DC    C'ITAA'                                                  07507000
@CC00949 DC    C'ITRS'                                                  07508000
@CC00957 DC    C'ITCK'                                                  07509000
@CC00963 DC    C'ITRA'                                                  07510000
@CC00969 DC    C'ITRP'                                                  07511000
@CC00981 DC    C'ITWD'                                                  07512000
@CC00986 DC    C'ITWN'                                                  07513000
@CC00991 DC    C'ITUT'                                                  07514000
@CC00995 DC    C'ITBP'                                                  07515000
@CC01000 DC    C'ITCA'                                                  07516000
@CC01004 DC    C'ITDM'                                                  07517000
@CC01011 DC    C'ITVH'                                                  07518000
@CC01042 DC    C'ITDC'                                                  07519000
@CC00567 DC    C'CC0'                                                   07520000
@CC00617 DC    C'UV0'                                                   07521000
@CC01005 EQU   @CC00833                                                 07522000
@CC01006 DC    C'N'                                                     07523000
@CB00881 DC    X'FFFFFFFF'                                              07524000
@CB00466 DC    B'10000000'                                              07525000
@CB00468 DC    B'00000000'                                              07526000
MODID    DC    CL4'IT01'                                                07527000
POOLID   DC    CL4'IT01'                                                07528000
PTCHIT01 DS    CL512                                                    07529000
         ORG   PTCHIT01                                                 07530000
@NM00027 DC    256X'00'                                                 07531000
@NM00028 DC    256X'00'                                                 07532000
         ORG   PTCHIT01+512                                             07533000
         DS    CL3                                                      07534000
INFOVECT DC    F'208'                                                   07535000
         DC    F'204'                                                   07536000
         DC    F'201'                                                   07537000
         DC    F'202'                                                   07538000
         DC    F'206'                                                   07539000
         DC    F'207'                                                   07540000
         DC    F'205'                                                   07541000
         DC    F'218'                                                   07542000
DCVTHEXC DC    CL1'0'                                                   07543000
         DC    CL1'1'                                                   07544000
         DC    CL1'2'                                                   07545000
         DC    CL1'3'                                                   07546000
         DC    CL1'4'                                                   07547000
         DC    CL1'5'                                                   07548000
         DC    CL1'6'                                                   07549000
         DC    CL1'7'                                                   07550000
         DC    CL1'8'                                                   07551000
         DC    CL1'9'                                                   07552000
         DC    CL1'A'                                                   07553000
         DC    CL1'B'                                                   07554000
         DC    CL1'C'                                                   07555000
         DC    CL1'D'                                                   07556000
         DC    CL1'E'                                                   07557000
         DC    CL1'F'                                                   07558000
DCVTHEXN DC    AL1(0)                                                   07559000
         DC    AL1(1)                                                   07560000
         DC    AL1(2)                                                   07561000
         DC    AL1(3)                                                   07562000
         DC    AL1(4)                                                   07563000
         DC    AL1(5)                                                   07564000
         DC    AL1(6)                                                   07565000
         DC    AL1(7)                                                   07566000
         DC    AL1(8)                                                   07567000
         DC    AL1(9)                                                   07568000
         DC    AL1(10)                                                  07569000
         DC    AL1(11)                                                  07570000
         DC    AL1(12)                                                  07571000
         DC    AL1(13)                                                  07572000
         DC    AL1(14)                                                  07573000
         DC    AL1(15)                                                  07574000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07575000
@01      EQU   01                                                       07576000
@02      EQU   02                                                       07577000
@03      EQU   03                                                       07578000
@04      EQU   04                                                       07579000
@05      EQU   05                                                       07580000
@06      EQU   06                                                       07581000
@07      EQU   07                                                       07582000
@08      EQU   08                                                       07583000
@09      EQU   09                                                       07584000
@10      EQU   10                                                       07585000
@11      EQU   11                                                       07586000
@12      EQU   12                                                       07587000
@13      EQU   13                                                       07588000
@14      EQU   14                                                       07589000
@15      EQU   15                                                       07590000
DCVTJJ   EQU   @04                                                      07591000
DCVTII   EQU   @03                                                      07592000
DCVTMULT EQU   @02                                                      07593000
DCVTI    EQU   @02                                                      07594000
I4       EQU   @02                                                      07595000
IREAD    EQU   @02                                                      07596000
I2       EQU   @02                                                      07597000
I5       EQU   @05                                                      07598000
I1       EQU   @03                                                      07599000
HIGHRTA  EQU   @03                                                      07600000
LOWRTA   EQU   @02                                                      07601000
J        EQU   @02                                                      07602000
TRKCOUNT EQU   @04                                                      07603000
SALTCNT  EQU   @02                                                      07604000
SPROCODE EQU   @02                                                      07605000
TESTRC   EQU   @02                                                      07606000
REG9     EQU   @09                                                      07607000
REG10    EQU   @10                                                      07608000
REG11    EQU   @11                                                      07609000
REG12    EQU   @12                                                      07610000
REG8     EQU   @08                                                      07611000
RTNREG   EQU   @15                                                      07612000
REG0     EQU   @00                                                      07613000
REG1     EQU   @01                                                      07614000
REG13    EQU   @13                                                      07615000
REG14    EQU   @14                                                      07616000
REG15    EQU   @15                                                      07617000
REG2     EQU   @02                                                      07618000
REG3     EQU   @03                                                      07619000
REG4     EQU   @04                                                      07620000
REG5     EQU   @05                                                      07621000
REG6     EQU   @06                                                      07622000
REG7     EQU   @07                                                      07623000
ICKSAEP0 EQU   0                                                        07624000
ICKSAGP0 EQU   0                                                        07625000
ICKSAFP0 EQU   0                                                        07626000
TRACE1   EQU   0                                                        07627000
OLDERID1 EQU   TRACE1                                                   07628000
TRACE2   EQU   0                                                        07629000
OLDERID2 EQU   TRACE2                                                   07630000
NEWID2   EQU   TRACE2+95                                                07631000
NEWERID2 EQU   5                                                        07632000
STAEPARM EQU   0                                                        07633000
STAEPFX  EQU   STAEPARM                                                 07634000
IOCSTR   EQU   0                                                        07635000
IOCDSO   EQU   IOCSTR+13                                                07636000
IOCRFM   EQU   IOCSTR+14                                                07637000
IOCMAC   EQU   IOCSTR+15                                                07638000
IOCMSG   EQU   IOCSTR+16                                                07639000
OPNAGL   EQU   0                                                        07640000
OPNOPT   EQU   OPNAGL                                                   07641000
OPNRFM   EQU   OPNAGL+1                                                 07642000
OPNTYP   EQU   OPNAGL+2                                                 07643000
OPNMOD   EQU   OPNAGL+3                                                 07644000
UVOLLIST EQU   0                                                        07645000
UVOLENT  EQU   UVOLLIST+2                                               07646000
ICKDVON0 EQU   0                                                        07647000
ICKDVIN0 EQU   0                                                        07648000
ICKDVOP0 EQU   0                                                        07649000
ICKDVCL0 EQU   0                                                        07650000
ICKTPPR0 EQU   0                                                        07651000
DARGLIST EQU   0                                                        07652000
DARGDBP  EQU   DARGLIST                                                 07653000
DARGSTID EQU   DARGLIST+8                                               07654000
DARGSMOD EQU   DARGSTID                                                 07655000
DARGSENT EQU   DARGSTID+3                                               07656000
DARGILP  EQU   DARGLIST+12                                              07657000
DARGCNT  EQU   DARGLIST+14                                              07658000
DARGARY  EQU   DARGLIST+20                                              07659000
DARGINS  EQU   DARGARY                                                  07660000
DARGINL  EQU   DARGARY+2                                                07661000
DARGDTM  EQU   DARGARY+4                                                07662000
FMTLIST  EQU   0                                                        07663000
FMTFLGS  EQU   FMTLIST                                                  07664000
FMTSPF   EQU   FMTLIST+2                                                07665000
FMTRFNO  EQU   FMTSPF                                                   07666000
FMTILEN  EQU   FMTRFNO                                                  07667000
FMTIOFF  EQU   FMTLIST+4                                                07668000
FMTTRBC  EQU   FMTIOFF                                                  07669000
FMTSTO   EQU   FMTTRBC                                                  07670000
FMTOCOL  EQU   FMTLIST+6                                                07671000
FMTCNVF  EQU   FMTLIST+10                                               07672000
ICKDB010 EQU   0                                                        07673000
DMPITM   EQU   0                                                        07674000
DMPARY   EQU   0                                                        07675000
VOL1     EQU   0                                                        07676000
VOL1VTOC EQU   VOL1+11                                                  07677000
VOL1OWNR EQU   VOL1+37                                                  07678000
IECSDSF4 EQU   0                                                        07679000
IECSDSL4 EQU   0                                                        07680000
DS4HCCHH EQU   IECSDSL4+8                                               07681000
DS4NOATK EQU   IECSDSL4+12                                              07682000
DS4DEVCT EQU   IECSDSL4+18                                              07683000
DS4DEVOV EQU   DS4DEVCT+6                                               07684000
DS4AMCAT EQU   IECSDSL4+40                                              07685000
DS4VSIND EQU   DS4AMCAT                                                 07686000
DS4VTOCE EQU   IECSDSL4+61                                              07687000
DEVIC    EQU   0                                                        07688000
DEVICVAL EQU   DEVIC+1                                                  07689000
PRESV    EQU   0                                                        07690000
CHECK    EQU   0                                                        07691000
CHECKVAL EQU   CHECK                                                    07692000
NOCHK    EQU   0                                                        07693000
RECLA    EQU   0                                                        07694000
VERFY    EQU   0                                                        07695000
VSER     EQU   0                                                        07696000
VSERVAL  EQU   VSER+1                                                   07697000
VOWN     EQU   0                                                        07698000
VOWNVAL  EQU   VOWN+1                                                   07699000
MAP      EQU   0                                                        07700000
TRACK    EQU   0                                                        07701000
TRACKCNT EQU   TRACK                                                    07702000
@NM00025 EQU   TRACK+2                                                  07703000
TRACKVAL EQU   @NM00025+1                                               07704000
ASSGN    EQU   0                                                        07705000
DNAME    EQU   0                                                        07706000
DNAMEVAL EQU   DNAME+1                                                  07707000
ALLTK    EQU   0                                                        07708000
DEVTY    EQU   0                                                        07709000
DEVTYVAL EQU   DEVTY+1                                                  07710000
THRESHLD EQU   0                                                        07711000
TRKSPCYL EQU   0                                                        07712000
TOTALPRI EQU   0                                                        07713000
TOTALALT EQU   0                                                        07714000
FIRSTAL  EQU   0                                                        07715000
FIRSTALC EQU   FIRSTAL                                                  07716000
FIRSTALT EQU   FIRSTAL+2                                                07717000
FINALT   EQU   0                                                        07718000
FINALTC  EQU   FINALT                                                   07719000
FINALTT  EQU   FINALT+2                                                 07720000
FINPRI   EQU   0                                                        07721000
FINPRIC  EQU   FINPRI                                                   07722000
FINPRIT  EQU   FINPRI+2                                                 07723000
MAXREC   EQU   0                                                        07724000
VIBFLAG  EQU   0                                                        07725000
VIBPFLAG EQU   0                                                        07726000
RZADDROB EQU   0                                                        07727000
RECTABLE EQU   0                                                        07728000
RECTAPTR EQU   RECTABLE                                                 07729000
RECTALEN EQU   RECTABLE+4                                               07730000
RECTAOFL EQU   RECTABLE+8                                               07731000
RTRECORD EQU   0                                                        07732000
RTCOUNT  EQU   RTRECORD                                                 07733000
RCNTR    EQU   RTCOUNT+4                                                07734000
DMPTRM   EQU   0                                                        07735000
HAIMAGE  EQU   0                                                        07736000
ICKIOCL0 EQU   0                                                        07737000
ICKIOGT0 EQU   0                                                        07738000
ICKIOIT0 EQU   0                                                        07739000
ICKIOOP0 EQU   0                                                        07740000
ICKIOPT0 EQU   0                                                        07741000
ICKIOTM0 EQU   0                                                        07742000
ICKSACL0 EQU   0                                                        07743000
ICKSADE0 EQU   0                                                        07744000
ICKSAFS0 EQU   0                                                        07745000
ICKSAGS0 EQU   0                                                        07746000
ICKSALD0 EQU   0                                                        07747000
ICKSAPR0 EQU   0                                                        07748000
ICKSASC0 EQU   0                                                        07749000
ICKSASN0 EQU   0                                                        07750000
ICKSAST0 EQU   0                                                        07751000
ICKSATI0 EQU   0                                                        07752000
ICKSAVC0 EQU   0                                                        07753000
ICKSAWO0 EQU   0                                                        07754000
ICKTPEA0 EQU   0                                                        07755000
ICKTPES0 EQU   0                                                        07756000
ICKTPRE0 EQU   0                                                        07757000
ICKTPRS0 EQU   0                                                        07758000
LISTTEST EQU   0                                                        07759000
NEWERID1 EQU   5                                                        07760000
NOAGN    EQU   0                                                        07761000
NOMAP    EQU   0                                                        07762000
NOPRE    EQU   0                                                        07763000
NOREC    EQU   0                                                        07764000
NOVER    EQU   0                                                        07765000
GDTTBL   EQU   0                                                        07766000
GDTTR1   EQU   GDTTBL+8                                                 07767000
GDTTR2   EQU   GDTTBL+12                                                07768000
GDTDIN   EQU   GDTTBL+44                                                07769000
GDTDOP   EQU   GDTTBL+48                                                07770000
GDTDBG   EQU   GDTTBL+52                                                07771000
GDTDVO   EQU   GDTTBL+56                                                07772000
GDTPRT   EQU   GDTTBL+60                                                07773000
GDTESS   EQU   GDTTBL+64                                                07774000
GDTESA   EQU   GDTTBL+68                                                07775000
GDTRST   EQU   GDTTBL+72                                                07776000
GDTRES   EQU   GDTTBL+76                                                07777000
GDTCAL   EQU   GDTTBL+80                                                07778000
GDTGSP   EQU   GDTTBL+84                                                07779000
GDTFSP   EQU   GDTTBL+88                                                07780000
GDTGPL   EQU   GDTTBL+92                                                07781000
GDTFPL   EQU   GDTTBL+96                                                07782000
GDTLOD   EQU   GDTTBL+100                                               07783000
GDTDEL   EQU   GDTTBL+104                                               07784000
GDTPRL   EQU   GDTTBL+108                                               07785000
GDTEPL   EQU   GDTTBL+112                                               07786000
GDTTIM   EQU   GDTTBL+116                                               07787000
GDTIIO   EQU   GDTTBL+120                                               07788000
GDTTIO   EQU   GDTTBL+124                                               07789000
GDTOPN   EQU   GDTTBL+136                                               07790000
GDTCLS   EQU   GDTTBL+140                                               07791000
GDTGET   EQU   GDTTBL+144                                               07792000
GDTPUT   EQU   GDTTBL+148                                               07793000
GDTSNP   EQU   GDTTBL+160                                               07794000
GDTWTO   EQU   GDTTBL+168                                               07795000
GDTSCR   EQU   GDTTBL+172                                               07796000
GDTVCK   EQU   GDTTBL+176                                               07797000
GDTDVC   EQU   GDTTBL+180                                               07798000
GDTSTE   EQU   GDTTBL+188                                               07799000
FDTTBL   EQU   0                                                        07800000
FDTPTR   EQU   FDTTBL+8                                                 07801000
LASTCOND EQU   0                                                        07802000
RTRADDR  EQU   0                                                        07803000
RTRADDRC EQU   RTRADDR                                                  07804000
RTRADDRT EQU   RTRADDR+2                                                07805000
DFLAG1   EQU   0                                                        07806000
STATE    EQU   0                                                        07807000
WTRADDR  EQU   0                                                        07808000
WTRADDRC EQU   WTRADDR                                                  07809000
WTRADDRT EQU   WTRADDR+2                                                07810000
TRKADDR  EQU   0                                                        07811000
DFLAG    EQU   0                                                        07812000
RZADDR   EQU   0                                                        07813000
OBTRTYPE EQU   0                                                        07814000
WRIADDR  EQU   0                                                        07815000
WRITRTYP EQU   0                                                        07816000
DCVTSRCE EQU   0                                                        07817000
DCVTCCHH EQU   0                                                        07818000
DCVTCC   EQU   DCVTCCHH                                                 07819000
DCVTHH   EQU   DCVTCCHH+2                                               07820000
DCVTLEGL EQU   0                                                        07821000
DCVTCHRS EQU   0                                                        07822000
DCVTNUM  EQU   0                                                        07823000
RZACCHHX EQU   RZACCHH                                                  07824000
VTOCEDS4 EQU   DS4VTOCE                                                 07825000
VTLOEX   EQU   VTOCEDS4+2                                               07826000
VTLOEXC  EQU   VTLOEX                                                   07827000
VTLOEXT  EQU   VTLOEX+2                                                 07828000
VTHIEX   EQU   VTOCEDS4+6                                               07829000
VTHIEXC  EQU   VTHIEX                                                   07830000
VTHIEXT  EQU   VTHIEX+2                                                 07831000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    07832000
@NM00026 EQU   VTOCEDS4                                                 07833000
WRIADDRH EQU   WRIADDR+2                                                07834000
WRIADDRC EQU   WRIADDR                                                  07835000
TRKADDRH EQU   TRKADDR+2                                                07836000
TRKADDRC EQU   TRKADDR                                                  07837000
FDTVERB  EQU   FDTTBL                                                   07838000
GDTCVR   EQU   GDTTBL+184                                               07839000
GDTSPR   EQU   GDTTBL+164                                               07840000
GDTABH   EQU   GDTTBL+156                                               07841000
GDTABT   EQU   GDTTBL+152                                               07842000
GDTTOH   EQU   GDTTBL+132                                               07843000
GDTRIP   EQU   GDTTBL+128                                               07844000
GDTDVH   EQU   GDTTBL+40                                                07845000
GDTIOH   EQU   GDTTBL+36                                                07846000
GDTSAH   EQU   GDTTBL+32                                                07847000
GDTTPH   EQU   GDTTBL+28                                                07848000
GDTRIH   EQU   GDTTBL+24                                                07849000
GDTSTH   EQU   GDTTBL+20                                                07850000
GDTDBH   EQU   GDTTBL+16                                                07851000
GDTPRM   EQU   GDTTBL+4                                                 07852000
GDTHDR   EQU   GDTTBL                                                   07853000
RTDATA   EQU   RTRECORD+12                                              07854000
RTKEY    EQU   RTRECORD+8                                               07855000
RCNTDL   EQU   RTCOUNT+6                                                07856000
RCNTKL   EQU   RTCOUNT+5                                                07857000
RCNTCCHH EQU   RTCOUNT                                                  07858000
DEVTYLEN EQU   DEVTY                                                    07859000
DNAMELEN EQU   DNAME                                                    07860000
TRACKLEN EQU   @NM00025                                                 07861000
VOWNLEN  EQU   VOWN                                                     07862000
VSERLEN  EQU   VSER                                                     07863000
DEVICLEN EQU   DEVIC                                                    07864000
DS4END   EQU   IECSDSL4+96                                              07865000
@NM00024 EQU   IECSDSL4+71                                              07866000
DS4F6PTR EQU   IECSDSL4+56                                              07867000
@NM00023 EQU   IECSDSL4+51                                              07868000
DS4R2TIM EQU   IECSDSL4+43                                              07869000
DS4VSCRA EQU   DS4AMCAT+1                                               07870000
@NM00022 EQU   DS4VSIND                                                 07871000
DS4VSBAD EQU   DS4VSIND                                                 07872000
DS4VSREF EQU   DS4VSIND                                                 07873000
DS4AMTIM EQU   IECSDSL4+32                                              07874000
DS4DEVDB EQU   DS4DEVCT+13                                              07875000
DS4DEVDT EQU   DS4DEVCT+12                                              07876000
DS4DEVTL EQU   DS4DEVCT+10                                              07877000
DS4DEVFG EQU   DS4DEVCT+9                                               07878000
DS4DEVK  EQU   DS4DEVCT+8                                               07879000
DS4DEVL  EQU   DS4DEVOV+1                                               07880000
DS4DEVI  EQU   DS4DEVOV                                                 07881000
DS4DEVTK EQU   DS4DEVCT+4                                               07882000
DS4DEVSZ EQU   DS4DEVCT                                                 07883000
@NM00021 EQU   IECSDSL4+16                                              07884000
DS4NOEXT EQU   IECSDSL4+15                                              07885000
DS4VTOCI EQU   IECSDSL4+14                                              07886000
DS4DSREC EQU   IECSDSL4+6                                               07887000
DS4HPCHR EQU   IECSDSL4+1                                               07888000
DS4IDFMT EQU   IECSDSL4                                                 07889000
@NM00020 EQU   IECSDSF4                                                 07890000
VOL1STDV EQU   VOL1+79                                                  07891000
@NM00019 EQU   VOL1+51                                                  07892000
VOL1OLDO EQU   VOL1OWNR+4                                               07893000
VOL1OEXT EQU   VOL1OWNR                                                 07894000
@NM00018 EQU   VOL1+16                                                  07895000
VOL1ACC  EQU   VOL1+10                                                  07896000
VOL1SER  EQU   VOL1+4                                                   07897000
VOL1NUM  EQU   VOL1+3                                                   07898000
VOL1ID   EQU   VOL1                                                     07899000
@NM00017 EQU   DMPARY+15                                                07900000
DMPARYTP EQU   DMPARY+14                                                07901000
DMPARYEX EQU   DMPARY+12                                                07902000
DMPARYIC EQU   DMPARY+10                                                07903000
DMPARYSZ EQU   DMPARY+8                                                 07904000
DMPARYNM EQU   DMPARY                                                   07905000
@NM00016 EQU   DMPITM+15                                                07906000
DMPITMTP EQU   DMPITM+14                                                07907000
DMPITMLN EQU   DMPITM+12                                                07908000
DMPITMPT EQU   DMPITM+8                                                 07909000
DMPITMNM EQU   DMPITM                                                   07910000
@NM00015 EQU   FMTCNVF+1                                                07911000
FMTBS    EQU   FMTCNVF+1                                                07912000
FMTSS    EQU   FMTCNVF+1                                                07913000
FMTAL    EQU   FMTCNVF+1                                                07914000
FMTZS    EQU   FMTCNVF+1                                                07915000
@NM00014 EQU   FMTCNVF                                                  07916000
FMTPU    EQU   FMTCNVF                                                  07917000
FMTBD    EQU   FMTCNVF                                                  07918000
FMTBHD   EQU   FMTCNVF                                                  07919000
FMTBHA   EQU   FMTCNVF                                                  07920000
FMTBH    EQU   FMTCNVF                                                  07921000
FMTOLEN  EQU   FMTLIST+8                                                07922000
FMTRIO   EQU   FMTOCOL                                                  07923000
FMTSPT   EQU   FMTSTO                                                   07924000
FMTSTL   EQU   FMTILEN                                                  07925000
@NM00013 EQU   FMTFLGS+1                                                07926000
FMTHDF   EQU   FMTFLGS                                                  07927000
FMTDFF   EQU   FMTFLGS                                                  07928000
FMTSTF   EQU   FMTFLGS                                                  07929000
FMTREPF  EQU   FMTFLGS                                                  07930000
FMTBDF   EQU   FMTFLGS                                                  07931000
FMTIDF   EQU   FMTFLGS                                                  07932000
FMTSCF   EQU   FMTFLGS                                                  07933000
FMTEOLF  EQU   FMTFLGS                                                  07934000
DARGPCT  EQU   DARGINL                                                  07935000
DARGREP  EQU   DARGINS                                                  07936000
@NM00012 EQU   DARGLIST+19                                              07937000
DARGIND  EQU   DARGLIST+18                                              07938000
DARGRETL EQU   DARGLIST+16                                              07939000
DARGRETP EQU   DARGLIST+4                                               07940000
UVOLVOL  EQU   UVOLENT+4                                                07941000
UVOLDEV  EQU   UVOLENT                                                  07942000
UVOLCNT  EQU   UVOLLIST                                                 07943000
OPNRSVD  EQU   OPNAGL+28                                                07944000
OPNVOL   EQU   OPNAGL+24                                                07945000
OPNBLK   EQU   OPNAGL+20                                                07946000
OPNREC   EQU   OPNAGL+16                                                07947000
OPNDSN   EQU   OPNAGL+12                                                07948000
OPNDDN   EQU   OPNAGL+8                                                 07949000
OPNIOC   EQU   OPNAGL+4                                                 07950000
@NM00011 EQU   OPNMOD                                                   07951000
OPNMODRC EQU   OPNMOD                                                   07952000
OPNMODAC EQU   OPNMOD                                                   07953000
@NM00010 EQU   OPNTYP                                                   07954000
OPNTYPSO EQU   OPNTYP                                                   07955000
OPNTYPSI EQU   OPNTYP                                                   07956000
@NM00009 EQU   OPNRFM                                                   07957000
OPNRFMBK EQU   OPNRFM                                                   07958000
OPNRFMSF EQU   OPNRFM                                                   07959000
OPNRFMUN EQU   OPNRFM                                                   07960000
OPNRFMVR EQU   OPNRFM                                                   07961000
OPNRFMFX EQU   OPNRFM                                                   07962000
@NM00008 EQU   OPNOPT                                                   07963000
OPNOPTJM EQU   OPNOPT                                                   07964000
OPNOPTKS EQU   OPNOPT                                                   07965000
OPNOPTBK EQU   OPNOPT                                                   07966000
OPNOPTUP EQU   OPNOPT                                                   07967000
OPNOPTOT EQU   OPNOPT                                                   07968000
OPNOPTIN EQU   OPNOPT                                                   07969000
IOCEXT   EQU   IOCSTR+36                                                07970000
IOCRRN   EQU   IOCSTR+32                                                07971000
@NM00007 EQU   IOCSTR+30                                                07972000
IOCPNM   EQU   IOCSTR+28                                                07973000
IOCCBP   EQU   IOCSTR+24                                                07974000
IOCDSN   EQU   IOCSTR+20                                                07975000
@NM00006 EQU   IOCSTR+17                                                07976000
@NM00005 EQU   IOCMSG                                                   07977000
IOCMSGOP EQU   IOCMSG                                                   07978000
IOCMACPA EQU   IOCMAC                                                   07979000
@NM00004 EQU   IOCMAC                                                   07980000
IOCMACBK EQU   IOCMAC                                                   07981000
IOCMACUP EQU   IOCMAC                                                   07982000
IOCMACOT EQU   IOCMAC                                                   07983000
IOCMACIN EQU   IOCMAC                                                   07984000
@NM00003 EQU   IOCRFM                                                   07985000
IOCRFMBK EQU   IOCRFM                                                   07986000
IOCRFMSF EQU   IOCRFM                                                   07987000
IOCRFMUN EQU   IOCRFM                                                   07988000
IOCRFMVR EQU   IOCRFM                                                   07989000
IOCRFMFX EQU   IOCRFM                                                   07990000
@NM00002 EQU   IOCDSO                                                   07991000
IOCDSOPS EQU   IOCDSO                                                   07992000
IOCKYL   EQU   IOCSTR+12                                                07993000
IOCTRN   EQU   IOCSTR+8                                                 07994000
IOCDLN   EQU   IOCSTR+4                                                 07995000
IOCDAD   EQU   IOCSTR                                                   07996000
STAEWORK EQU   STAEPARM+32                                              07997000
STARPTR  EQU   STAEPFX+28                                               07998000
STASPTR  EQU   STAEPFX+24                                               07999000
STALEN   EQU   STAEPFX+20                                               08000000
STAID    EQU   STAEPFX+16                                               08001000
STAEPA   EQU   STAEPFX+12                                               08002000
STAGDT   EQU   STAEPFX+8                                                08003000
STABPTR  EQU   STAEPFX+4                                                08004000
STAFPTR  EQU   STAEPFX                                                  08005000
NEWID1   EQU   TRACE1+95                                                08006000
CALLID   EQU   OLDERID1+90                                              08007000
@NM00001 EQU   OLDERID1                                                 08008000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      08009000
@RC00323 EQU   @EL00002                                                 08010000
@RF00376 EQU   @EL00003                                                 08011000
@RF00378 EQU   @EL00003                                                 08012000
@RF00381 EQU   @EL00003                                                 08013000
@RF00448 EQU   @EL00004                                                 08014000
@RC00450 EQU   @EL00004                                                 08015000
@RF00496 EQU   @EL00004                                                 08016000
@RC00536 EQU   @RC00534                                                 08017000
@RC00581 EQU   @RC00579                                                 08018000
@RC00756 EQU   @RC00579                                                 08019000
@RC00804 EQU   @RC00579                                                 08020000
@RF00832 EQU   @RC00579                                                 08021000
@RC00834 EQU   @RC00579                                                 08022000
@RF00875 EQU   @EL00006                                                 08023000
@RF00927 EQU   @RC00925                                                 08024000
@RC00944 EQU   @RC00925                                                 08025000
@RF00910 EQU   @EL00007                                                 08026000
@RC01021 EQU   @EL00009                                                 08027000
@RF01109 EQU   ENDLOOP1                                                 08028000
@RF01069 EQU   @EL00010                                                 08029000
@RF01156 EQU   @EL00010                                                 08030000
@RF01158 EQU   @EL00010                                                 08031000
@RF01234 EQU   ENDLOOP2                                                 08032000
@RF01198 EQU   @EL00011                                                 08033000
@RC01291 EQU   @EL00011                                                 08034000
@RF01328 EQU   @EL00011                                                 08035000
@RC01376 EQU   @EL00012                                                 08036000
@RF01381 EQU   @EL00012                                                 08037000
@RF01441 EQU   @EL00013                                                 08038000
@RF01447 EQU   @EL00013                                                 08039000
@RF01470 EQU   @RC01462                                                 08040000
@RF01472 EQU   @RC01462                                                 08041000
@RF01458 EQU   @EL00014                                                 08042000
@RF01528 EQU   @EL00014                                                 08043000
@RF01534 EQU   @EL00014                                                 08044000
@RC01554 EQU   @EL00015                                                 08045000
@RF01581 EQU   @EL00015                                                 08046000
@RC01607 EQU   @EL00016                                                 08047000
@RC01636 EQU   @EL00016                                                 08048000
@RC01650 EQU   @EL00016                                                 08049000
@RF01717 EQU   @EL00017                                                 08050000
@RF01732 EQU   @EL00018                                                 08051000
@RF01746 EQU   @RC01743                                                 08052000
@RC01748 EQU   @RC01743                                                 08053000
@RF01761 EQU   @EL00019                                                 08054000
@RF01763 EQU   @EL00019                                                 08055000
@RF01766 EQU   @EL00019                                                 08056000
@RC01768 EQU   @EL00019                                                 08057000
@RF01826 EQU   @EL00020                                                 08058000
@RC01851 EQU   @EL00021                                                 08059000
@RC01864 EQU   @EL00021                                                 08060000
@PB00021 EQU   @PB00022                                                 08061000
@RT01909 EQU   @EL00023                                                 08062000
@PB00023 EQU   @EL00022                                                 08063000
@RF00588 EQU   @RC00581                                                 08064000
@RC00590 EQU   @RC00581                                                 08065000
@RC00659 EQU   @RC00581                                                 08066000
@RC00712 EQU   @RC00581                                                 08067000
@RF00740 EQU   @RC00581                                                 08068000
@RC00742 EQU   @RC00581                                                 08069000
@RC00771 EQU   @RC00756                                                 08070000
@RF00791 EQU   @RC00756                                                 08071000
@RC00793 EQU   @RC00756                                                 08072000
@RF00812 EQU   @RC00804                                                 08073000
@RC00814 EQU   @RC00804                                                 08074000
@RF00819 EQU   @RC00804                                                 08075000
@RF01293 EQU   @RC01291                                                 08076000
@PB00020 EQU   @PB00021                                                 08077000
@RC01880 EQU   @PB00023                                                 08078000
@RF01885 EQU   @PB00023                                                 08079000
@RC00592 EQU   @RC00590                                                 08080000
@RF00646 EQU   @RC00590                                                 08081000
@RC00648 EQU   @RC00590                                                 08082000
@RC00677 EQU   @RC00659                                                 08083000
@RF00686 EQU   @RC00659                                                 08084000
@RC00688 EQU   @RC00659                                                 08085000
@RF00720 EQU   @RC00712                                                 08086000
@RC00722 EQU   @RC00712                                                 08087000
@RF00727 EQU   @RC00712                                                 08088000
@RF00774 EQU   @RC00771                                                 08089000
@RF00780 EQU   @RC00771                                                 08090000
@PB00019 EQU   @PB00020                                                 08091000
@RC00594 EQU   @RC00592                                                 08092000
@RC00618 EQU   @RC00592                                                 08093000
@RF00627 EQU   @RC00592                                                 08094000
@RC00629 EQU   @RC00592                                                 08095000
@PB00018 EQU   @PB00019                                                 08096000
@RC00596 EQU   @RC00594                                                 08097000
@PB00017 EQU   @PB00018                                                 08098000
@PB00016 EQU   @PB00017                                                 08099000
@PB00015 EQU   @PB00016                                                 08100000
@PB00014 EQU   @PB00015                                                 08101000
@PB00013 EQU   @PB00014                                                 08102000
@PB00012 EQU   @PB00013                                                 08103000
@PB00011 EQU   @PB00012                                                 08104000
@PB00010 EQU   @PB00011                                                 08105000
@PB00009 EQU   @PB00010                                                 08106000
@PB00008 EQU   @PB00009                                                 08107000
@PB00007 EQU   @PB00008                                                 08108000
@PB00006 EQU   @PB00007                                                 08109000
@PB00005 EQU   @PB00006                                                 08110000
@PB00004 EQU   @PB00005                                                 08111000
@PB00003 EQU   @PB00004                                                 08112000
@PB00002 EQU   @PB00003                                                 08113000
@ENDDATA EQU   *                                                        08114000
         END   ICKIT01,(C'PLS0842',0701,78198)                          08115000
