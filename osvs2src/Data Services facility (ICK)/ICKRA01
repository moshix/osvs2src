         TITLE '*********  ICKRA01:  RE-ASSIGN ALTERNATE TRACK  ********00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
ICKRA01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'ICKRA01   78.192'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  DS    0H                                                  0002 00022000
         USING @PSTART,@12                                         0002 00023000
         L     @00,@SIZDATD                                        0002 00024000
         GETMAIN  R,LV=(0)                                              00025000
         LR    @11,@01                                             0002 00026000
         USING @DATD,@11                                           0002 00027000
         ST    @13,@SA00001+4                                      0002 00028000
         LM    @00,@01,20(@13)                                     0002 00029000
         ST    @11,8(,@13)                                         0002 00030000
         LR    @13,@11                                             0002 00031000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00032000
         MVC   @PC00001(36),0(@01)                                 0002 00033000
*                                                                  0176 00034000
*/*****  B E G I N    E X E C U T I O N  *****************************/ 00035000
*                                                                  0177 00036000
*    IF GDTDBG = NULLPTR                                           0177 00037000
*      THEN;                                                       0177 00038000
         L     @10,@PC00001                                        0177 00039000
         L     @10,GDTDBG(,@10)                                    0177 00040000
         LTR   @10,@10                                             0177 00041000
         BZ    @RT00177                                            0177 00042000
*      ELSE                                                        0179 00043000
*        CALL ICKDB010 (GDTTBL, 'RA00');                           0179 00044000
*                                                                  0179 00045000
*                                                                  0179 00046000
         L     @10,@PC00001                                        0179 00047000
         ST    @10,@AL00001                                        0179 00048000
         LA    @15,@CC00543                                        0179 00049000
         ST    @15,@AL00001+4                                      0179 00050000
         MVI   @AL00001+4,X'80'                                    0179 00051000
         L     @15,GDTDBG(,@10)                                    0179 00052000
         LA    @01,@AL00001                                        0179 00053000
         BALR  @14,@15                                             0179 00054000
*/*  OBTAIN THE ADDRESSES OF THE LAST PRIMARY AND ALTERNATE          */ 00055000
*/*   TRACKS AND ALSO THE NUMBER OF TRACKS PER CYLINDER              */ 00056000
*    DO I = 1 TO INFOSET;                                          0180 00057000
@RT00177 LA    I,1                                                 0180 00058000
@DL00180 DS    0H                                                  0181 00059000
*      CALL ICKDVIN0 (GDTTBL                                       0181 00060000
*               ,VOLIB                                             0181 00061000
*               ,INFOVECT (I)                                      0181 00062000
*               ,POOLID                                            0181 00063000
*               ,INFOPTR (I)                                       0181 00064000
*               ,INFOLEN (I)                                       0181 00065000
*               ,RETCODE);                                         0181 00066000
         L     @10,@PC00001                                        0181 00067000
         ST    @10,@AL00001                                        0181 00068000
         L     @03,@PC00001+4                                      0181 00069000
         ST    @03,@AL00001+4                                      0181 00070000
         LR    @03,I                                               0181 00071000
         SLA   @03,2                                               0181 00072000
         LA    @03,INFOVECT-4(@03)                                 0181 00073000
         ST    @03,@AL00001+8                                      0181 00074000
         LA    @03,POOLID                                          0181 00075000
         ST    @03,@AL00001+12                                     0181 00076000
         LR    @03,I                                               0181 00077000
         SLA   @03,3                                               0181 00078000
         LA    @15,INFOPTR-8(@03)                                  0181 00079000
         ST    @15,@AL00001+16                                     0181 00080000
         LA    @03,INFOLEN-8(@03)                                  0181 00081000
         ST    @03,@AL00001+20                                     0181 00082000
         LA    @03,RETCODE                                         0181 00083000
         ST    @03,@AL00001+24                                     0181 00084000
         L     @15,GDTDIN(,@10)                                    0181 00085000
         LA    @01,@AL00001                                        0181 00086000
         BALR  @14,@15                                             0181 00087000
*    END;                                                          0182 00088000
         AH    I,@CH00173                                          0182 00089000
         CH    I,@CH00144                                          0182 00090000
         BNH   @DL00180                                            0182 00091000
*/*  INDICATE INITIALLY THAT ASSIGNMENT IS NOT COMPLETE              */ 00092000
*    ASSGNCOM = NOTCOMP;                                           0183 00093000
         NI    ASSGNCOM,B'01111111'                                0183 00094000
*/*  DO-WHILE ASSIGNMENT IS NOT COMPLETE                             */ 00095000
*    DO WHILE ASSGNCOM = NOTCOMP;                                  0184 00096000
         B     @DE00184                                            0184 00097000
@DL00184 DS    0H                                                  0185 00098000
*/*    INITIALIZE THE UNRECOVERABLE TRACK ADDRESS TO ZERO            */ 00099000
*      UNTRADDR = 0;                                               0185 00100000
         SLR   @10,@10                                             0185 00101000
         L     @15,@PC00001+28                                     0185 00102000
         ST    @10,UNTRADDR(,@15)                                  0185 00103000
*/*    SET CONDITION CODE INITIALLY TO INDICATE SUCCESSFUL COMPLETION*/ 00104000
*      CONDCODE = SUCCEEDS;                                        0186 00105000
         L     @15,@PC00001+32                                     0186 00106000
         ST    @10,CONDCODE(,@15)                                  0186 00107000
*/*    INDICATE INITIALLY THAT THE ALTERNATE FLAG IS SET ON          */ 00108000
*      TRACKTYP = ALTTRACK;                                        0187 00109000
         OI    TRACKTYP,B'10000000'                                0187 00110000
*/*    INDICATE INITIALLY THAT AN ASSIGNABLE ALTERNATE NOT FOUND     */ 00111000
*      ASSGNFLG = NOASSIGN;                                        0188 00112000
         NI    ASSGNFLG,B'01111111'                                0188 00113000
*/*    IF THERE ARE NO AVAILABLE ALTERNATE TRACKS (ALTCOUNT)         */ 00114000
*      IF ALTCOUNT = 0                                             0189 00115000
*/*      THEN INDICATE NO AVAILABLE ALTERNATE TRACKS LEFT            */ 00116000
*        THEN DO;    CONDCODE = NOALTS;  END;                      0189 00117000
         L     @14,@PC00001+16                                     0189 00118000
         C     @10,ALTCOUNT(,@14)                                  0189 00119000
         BNE   @RF00189                                            0189 00120000
         MVC   CONDCODE(4,@15),@CF00173                            0191 00121000
*/*    IF NO ERRORS FOUND (CONDCODE = 0)                             */ 00122000
*      IF CONDCODE = SUCCEEDS                                      0193 00123000
*/*      THEN                                                        */ 00124000
*        THEN DO;                                                  0193 00125000
*                                                                  0193 00126000
@RF00189 L     @10,@PC00001+32                                     0193 00127000
         L     @10,CONDCODE(,@10)                                  0193 00128000
         LTR   @10,@10                                             0193 00129000
         BNZ   @RF00193                                            0193 00130000
*/*        DO-WHILE LAST ALTERNATE TRACK IS NOT CHECKED              */ 00131000
*          DO WHILE  ALTPTR <= LASTALT;                            0195 00132000
*                                                                  0195 00133000
         B     @DE00195                                            0195 00134000
@DL00195 DS    0H                                                  0196 00135000
*/*          READ HOME-ADDRESS (OF THE ALT TRACK TO OBTAIN           */ 00136000
*/*           DEFECT-FLAG) (UDEVOP)                                  */ 00137000
*            CALL ICKDVOP0 (GDTTBL                                 0196 00138000
*                   ,VOLIB                                         0196 00139000
*                   ,ACTRDHA                                       0196 00140000
*                   ,ALTPTR                                        0196 00141000
*                   ,RECNUM                                        0196 00142000
*                   ,POOLID                                        0196 00143000
*                   ,HAPTR                                         0196 00144000
*                   ,HALEN                                         0196 00145000
*                   ,RETCODE);                                     0196 00146000
         L     @10,@PC00001                                        0196 00147000
         ST    @10,@AL00001                                        0196 00148000
         L     @15,@PC00001+4                                      0196 00149000
         ST    @15,@AL00001+4                                      0196 00150000
         LA    @15,@CF00173                                        0196 00151000
         ST    @15,@AL00001+8                                      0196 00152000
         L     @15,@PC00001+20                                     0196 00153000
         ST    @15,@AL00001+12                                     0196 00154000
         LA    @15,RECNUM                                          0196 00155000
         ST    @15,@AL00001+16                                     0196 00156000
         LA    @15,POOLID                                          0196 00157000
         ST    @15,@AL00001+20                                     0196 00158000
         LA    @15,HAPTR                                           0196 00159000
         ST    @15,@AL00001+24                                     0196 00160000
         LA    @15,HALEN                                           0196 00161000
         ST    @15,@AL00001+28                                     0196 00162000
         LA    @15,RETCODE                                         0196 00163000
         ST    @15,@AL00001+32                                     0196 00164000
         L     @15,GDTDOP(,@10)                                    0196 00165000
         LA    @01,@AL00001                                        0196 00166000
         BALR  @14,@15                                             0196 00167000
*/*          IF THE READ OPERATION WAS UNSUCCESSFUL                  */ 00168000
*            IF RETCODE = CPFAILS                                  0197 00169000
*/*            THEN                                                  */ 00170000
*              THEN DO;                                            0197 00171000
*                                                                  0197 00172000
         CLC   RETCODE(4),@CF00052                                 0197 00173000
         BNE   @RF00197                                            0197 00174000
*/*              SET FLAG TO INDICATE TRACK CANNOT BE ASSIGNED       */ 00175000
*                ASSGNFLG = NOASSIGN;                              0199 00176000
         NI    ASSGNFLG,B'01111111'                                0199 00177000
*/*              SET ADDRESS OF THE UNRECOVERABLE TRACK              */ 00178000
*                UNTRADDR = ALTPTR;                                0200 00179000
         L     @10,@PC00001+28                                     0200 00180000
         L     @15,@PC00001+20                                     0200 00181000
         MVC   UNTRADDR(4,@10),ALTPTR(@15)                         0200 00182000
*/*              INDICATE THAT AN UNRECOVERABLE TRACK WAS FOUND      */ 00183000
*                CONDCODE = UNTRFND;                               0201 00184000
         L     @10,@PC00001+32                                     0201 00185000
         MVC   CONDCODE(4,@10),@CF00263                            0201 00186000
*/*              SET POINTER TO NEXT AVAILABLE ALTERNATE TRACK       */ 00187000
*/*               (ALTPTR)                                           */ 00188000
*                IF ALTPTRT = TRKSPCYL - 1                         0202 00189000
*                  THEN DO;                                        0202 00190000
*                                                                  0202 00191000
         L     @10,INFOPTR+8                                       0202 00192000
         L     @10,TRKSPCYL(,@10)                                  0202 00193000
         BCTR  @10,0                                               0202 00194000
         MVC   @ZT00002+2(2),ALTPTRT(@15)                          0202 00195000
         C     @10,@ZT00002                                        0202 00196000
         BNE   @RF00202                                            0202 00197000
*                    ALTPTRC = ALTPTRC + 1;                        0204 00198000
         LA    @10,1                                               0204 00199000
         MVC   @ZT00002+2(2),ALTPTRC(@15)                          0204 00200000
         AL    @10,@ZT00002                                        0204 00201000
         STH   @10,ALTPTRC(,@15)                                   0204 00202000
*                    ALTPTRT = 0;                                  0205 00203000
         SLR   @10,@10                                             0205 00204000
         STH   @10,ALTPTRT(,@15)                                   0205 00205000
*                    END;                                          0206 00206000
*                  ELSE DO;    ALTPTRT = ALTPTRT + 1; END;         0207 00207000
         B     @RC00202                                            0207 00208000
@RF00202 DS    0H                                                  0208 00209000
         L     @10,@PC00001+20                                     0208 00210000
         LA    @15,1                                               0208 00211000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0208 00212000
         AL    @15,@ZT00002                                        0208 00213000
         STH   @15,ALTPTRT(,@10)                                   0208 00214000
*/*              LEAVE                                               */ 00215000
*                GOTO ENDLOOP;                                     0210 00216000
         B     ENDLOOP                                             0210 00217000
*/*              END-THEN                                            */ 00218000
*                END;                                              0211 00219000
*/*            ELSE (UNRECOVERABLE TRACK NOT FOUND)                  */ 00220000
*              ELSE DO;                                            0212 00221000
*                                                                  0212 00222000
@RF00197 DS    0H                                                  0213 00223000
*/*              IF ALTERNATE TRACK IS FLAGGED DEFECTIVE             */ 00224000
*                IF RETCODE = DFLAGONA | RETCODE = DFLAGONP        0213 00225000
*/*                THEN                                              */ 00226000
*                  THEN DO;                                        0213 00227000
*                                                                  0213 00228000
         L     @10,RETCODE                                         0213 00229000
         CH    @10,@CH00127                                        0213 00230000
         BE    @RT00213                                            0213 00231000
         CH    @10,@CH00124                                        0213 00232000
         BNE   @RF00213                                            0213 00233000
@RT00213 DS    0H                                                  0214 00234000
*/*                  SET FLAG TO INDICATE TRACK CANNOT BE ASSIGNED   */ 00235000
*                    ASSGNFLG = NOASSIGN;                          0215 00236000
         NI    ASSGNFLG,B'01111111'                                0215 00237000
*/*                  SET POINTER TO NEXT AVAILABLE ALTERNATE TRACK   */ 00238000
*/*                   (ALTPTR)                                       */ 00239000
*                    IF ALTPTRT = TRKSPCYL - 1                     0216 00240000
*                      THEN DO;                                    0216 00241000
*                                                                  0216 00242000
         L     @10,@PC00001+20                                     0216 00243000
         L     @01,INFOPTR+8                                       0216 00244000
         L     @15,TRKSPCYL(,@01)                                  0216 00245000
         BCTR  @15,0                                               0216 00246000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0216 00247000
         C     @15,@ZT00002                                        0216 00248000
         BNE   @RF00216                                            0216 00249000
*                        ALTPTRC = ALTPTRC + 1;                    0218 00250000
         LA    @15,1                                               0218 00251000
         MVC   @ZT00002+2(2),ALTPTRC(@10)                          0218 00252000
         AL    @15,@ZT00002                                        0218 00253000
         STH   @15,ALTPTRC(,@10)                                   0218 00254000
*                        ALTPTRT = 0;                              0219 00255000
         SLR   @15,@15                                             0219 00256000
         STH   @15,ALTPTRT(,@10)                                   0219 00257000
*                        END;                                      0220 00258000
*                      ELSE DO;    ALTPTRT = ALTPTRT + 1; END;     0221 00259000
         B     @RC00216                                            0221 00260000
@RF00216 DS    0H                                                  0222 00261000
         L     @10,@PC00001+20                                     0222 00262000
         LA    @15,1                                               0222 00263000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0222 00264000
         AL    @15,@ZT00002                                        0222 00265000
         STH   @15,ALTPTRT(,@10)                                   0222 00266000
*/*                  END-THEN                                        */ 00267000
*                    END;                                          0224 00268000
*/*                ELSE (ALTERNATE TRACK IS NOT FLAGGED DEFECTIVE)   */ 00269000
*                  ELSE DO;                                        0225 00270000
*                                                                  0225 00271000
         B     @RC00213                                            0225 00272000
@RF00213 DS    0H                                                  0226 00273000
*/*                  IF THE ALTERNATE FLAG IS NOT TURNED ON          */ 00274000
*                    IF RETCODE = DFLAGOFP                         0226 00275000
*/*                    THEN SAVE THIS INFORMATION                    */ 00276000
*                      THEN DO;    TRACKTYP = PRITRACK; END;       0226 00277000
         CLC   RETCODE(4),@CF00144                                 0226 00278000
         BNE   @RF00226                                            0226 00279000
         NI    TRACKTYP,B'01111111'                                0228 00280000
*/*                    ELSE RESET THE FLAG TO INDICATE THE ALTERNATE */ 00281000
*/*                     FLAG IS SET ON                               */ 00282000
*                      ELSE DO;    TRACKTYP = ALTTRACK; END;       0230 00283000
         B     @RC00226                                            0230 00284000
@RF00226 DS    0H                                                  0231 00285000
         OI    TRACKTYP,B'10000000'                                0231 00286000
*/*                  READ RECORD-ZERO (OF THE ALTERNATE TRACK TO     */ 00287000
*/*                   CHECK THAT IS IS NOT ASSIGNED TO A             */ 00288000
*/*                   PRIMARY TRACK)                                 */ 00289000
*                    CALL ICKDVOP0 (GDTTBL                         0233 00290000
*                           ,VOLIB                                 0233 00291000
*                           ,ACTRDRZ                               0233 00292000
*                           ,ALTPTR                                0233 00293000
*                           ,RECNUM                                0233 00294000
*                           ,POOLID                                0233 00295000
*                           ,RZPTR                                 0233 00296000
*                           ,RZLEN                                 0233 00297000
*                           ,RETCODE);                             0233 00298000
@RC00226 L     @10,@PC00001                                        0233 00299000
         ST    @10,@AL00001                                        0233 00300000
         L     @15,@PC00001+4                                      0233 00301000
         ST    @15,@AL00001+4                                      0233 00302000
         LA    @15,@CF00124                                        0233 00303000
         ST    @15,@AL00001+8                                      0233 00304000
         L     @15,@PC00001+20                                     0233 00305000
         ST    @15,@AL00001+12                                     0233 00306000
         LA    @15,RECNUM                                          0233 00307000
         ST    @15,@AL00001+16                                     0233 00308000
         LA    @15,POOLID                                          0233 00309000
         ST    @15,@AL00001+20                                     0233 00310000
         LA    @15,RZPTR                                           0233 00311000
         ST    @15,@AL00001+24                                     0233 00312000
         LA    @15,RZLEN                                           0233 00313000
         ST    @15,@AL00001+28                                     0233 00314000
         LA    @15,RETCODE                                         0233 00315000
         ST    @15,@AL00001+32                                     0233 00316000
         L     @15,GDTDOP(,@10)                                    0233 00317000
         LA    @01,@AL00001                                        0233 00318000
         BALR  @14,@15                                             0233 00319000
*/*                  IF THE READ OPERATION WAS UNSUCCESSFUL          */ 00320000
*                    IF RETCODE = CPFAILS                          0234 00321000
*/*                    THEN                                          */ 00322000
*                      THEN DO;                                    0234 00323000
*                                                                  0234 00324000
         CLC   RETCODE(4),@CF00052                                 0234 00325000
         BNE   @RF00234                                            0234 00326000
*/*                      SET FLAG TO INDICATE TRK CANNOT BE ASSIGNED */ 00327000
*                        ASSGNFLG = NOASSIGN;                      0236 00328000
         NI    ASSGNFLG,B'01111111'                                0236 00329000
*/*                      SET ADDRESS OF THE UNRECOVERABLE TRACK      */ 00330000
*                        UNTRADDR = ALTPTR;                        0237 00331000
         L     @10,@PC00001+28                                     0237 00332000
         L     @15,@PC00001+20                                     0237 00333000
         MVC   UNTRADDR(4,@10),ALTPTR(@15)                         0237 00334000
*/*                      INDICATE THAT AN UNRECOVERABLE TRK WAS FOUND*/ 00335000
*                        CONDCODE = UNTRFND;                       0238 00336000
         L     @10,@PC00001+32                                     0238 00337000
         MVC   CONDCODE(4,@10),@CF00263                            0238 00338000
*/*                      SET POINTER TO NEXT AVAILABLE ALTERNATE TRK */ 00339000
*                        IF ALTPTRT = TRKSPCYL - 1                 0239 00340000
*                          THEN DO;                                0239 00341000
*                                                                  0239 00342000
         L     @10,INFOPTR+8                                       0239 00343000
         L     @10,TRKSPCYL(,@10)                                  0239 00344000
         BCTR  @10,0                                               0239 00345000
         MVC   @ZT00002+2(2),ALTPTRT(@15)                          0239 00346000
         C     @10,@ZT00002                                        0239 00347000
         BNE   @RF00239                                            0239 00348000
*                            ALTPTRC = ALTPTRC + 1;                0241 00349000
         LA    @10,1                                               0241 00350000
         MVC   @ZT00002+2(2),ALTPTRC(@15)                          0241 00351000
         AL    @10,@ZT00002                                        0241 00352000
         STH   @10,ALTPTRC(,@15)                                   0241 00353000
*                            ALTPTRT = 0;                          0242 00354000
         SLR   @10,@10                                             0242 00355000
         STH   @10,ALTPTRT(,@15)                                   0242 00356000
*                            END;                                  0243 00357000
*                          ELSE DO;    ALTPTRT = ALTPTRT + 1;      0244 00358000
         B     @RC00239                                            0244 00359000
@RF00239 DS    0H                                                  0245 00360000
         L     @10,@PC00001+20                                     0245 00361000
         LA    @15,1                                               0245 00362000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0245 00363000
         AL    @15,@ZT00002                                        0245 00364000
         STH   @15,ALTPTRT(,@10)                                   0245 00365000
*                            END;                                  0246 00366000
*/*                      LEAVE                                       */ 00367000
*                        GOTO ENDLOOP;                             0247 00368000
         B     ENDLOOP                                             0247 00369000
*/*                      END-THEN                                    */ 00370000
*                        END;                                      0248 00371000
*/*                    ELSE (RECOVERABLE TRACK FOUND)                */ 00372000
*                      ELSE DO;                                    0249 00373000
*                                                                  0249 00374000
@RF00234 DS    0H                                                  0250 00375000
*/*                      IF ALTERNATE TRACK IS FLAGGED DEFECTIVE     */ 00376000
*                        IF RETCODE = DFLAGONA | RETCODE = DFLAGONP     00377000
*/*                        THEN                                      */ 00378000
*                          THEN DO;                                0250 00379000
*                                                                  0250 00380000
         L     @10,RETCODE                                         0250 00381000
         CH    @10,@CH00127                                        0250 00382000
         BE    @RT00250                                            0250 00383000
         CH    @10,@CH00124                                        0250 00384000
         BNE   @RF00250                                            0250 00385000
@RT00250 DS    0H                                                  0251 00386000
*/*                          SET FLAG TO INDICATE TRACK CANNOT BE    */ 00387000
*/*                           ASSIGNED                               */ 00388000
*                            ASSGNFLG = NOASSIGN;                  0252 00389000
         NI    ASSGNFLG,B'01111111'                                0252 00390000
*/*                          SET POINTER TO NEXT AVAILABLE ALTERNATE */ 00391000
*/*                           TRACK (ALTPTR)                         */ 00392000
*                            IF ALTPTRT = TRKSPCYL - 1             0253 00393000
*                              THEN DO;                            0253 00394000
*                                                                  0253 00395000
         L     @10,@PC00001+20                                     0253 00396000
         L     @01,INFOPTR+8                                       0253 00397000
         L     @15,TRKSPCYL(,@01)                                  0253 00398000
         BCTR  @15,0                                               0253 00399000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0253 00400000
         C     @15,@ZT00002                                        0253 00401000
         BNE   @RF00253                                            0253 00402000
*                                ALTPTRC = ALTPTRC + 1;            0255 00403000
         LA    @15,1                                               0255 00404000
         MVC   @ZT00002+2(2),ALTPTRC(@10)                          0255 00405000
         AL    @15,@ZT00002                                        0255 00406000
         STH   @15,ALTPTRC(,@10)                                   0255 00407000
*                                ALTPTRT = 0;                      0256 00408000
         SLR   @15,@15                                             0256 00409000
         STH   @15,ALTPTRT(,@10)                                   0256 00410000
*                                END;                              0257 00411000
*                              ELSE DO;                            0258 00412000
*                                                                  0258 00413000
         B     @RC00253                                            0258 00414000
@RF00253 DS    0H                                                  0259 00415000
*                                ALTPTRT = ALTPTRT + 1;            0259 00416000
         L     @10,@PC00001+20                                     0259 00417000
         LA    @15,1                                               0259 00418000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0259 00419000
         AL    @15,@ZT00002                                        0259 00420000
         STH   @15,ALTPTRT(,@10)                                   0259 00421000
*                                END;                              0260 00422000
*/*                          END-THEN                                */ 00423000
*                            END;                                  0261 00424000
*/*                        ELSE (TRACK NOT FLAGGED DEFECTIVE)        */ 00425000
*                          ELSE DO;                                0262 00426000
*                                                                  0262 00427000
         B     @RC00250                                            0262 00428000
@RF00250 DS    0H                                                  0263 00429000
*/*                          IF ALTERNATE TRACK POINTING TO PRIMARY  */ 00430000
*                            IF RZCCHHC <= FINPRIC &               0263 00431000
*                             RZCCHHT <= FINPRIT & RZCCHH >= 0     0263 00432000
*/*                            THEN (ALTERNATE POINTING TO PRIMARY)  */ 00433000
*                              THEN DO;                            0263 00434000
         L     @10,RZPTR                                           0263 00435000
         L     @15,INFOPTR+16                                      0263 00436000
         CLC   RZCCHHC(2,@10),FINPRIC(@15)                         0263 00437000
         BH    @RF00263                                            0263 00438000
         CLC   RZCCHHT(2,@10),FINPRIT(@15)                         0263 00439000
         BH    @RF00263                                            0263 00440000
         CLC   RZCCHH(4,@10),@CF00102                              0263 00441000
         BL    @RF00263                                            0263 00442000
*/*                              READ PRIMARY TRACK RECORD-ZERO      */ 00443000
*                                CALL ICKDVOP0 (GDTTBL             0265 00444000
*                                       ,VOLIB                     0265 00445000
*                                       ,ACTRDRZ                   0265 00446000
*                                       ,RZCCHH                    0265 00447000
*                                       ,RECNUM                    0265 00448000
*                                       ,POOLID                    0265 00449000
*                                       ,RZAPTR                    0265 00450000
*                                       ,RZLEN                     0265 00451000
*                                       ,RETCODE);                 0265 00452000
         L     @15,@PC00001                                        0265 00453000
         ST    @15,@AL00001                                        0265 00454000
         L     @14,@PC00001+4                                      0265 00455000
         ST    @14,@AL00001+4                                      0265 00456000
         LA    @14,@CF00124                                        0265 00457000
         ST    @14,@AL00001+8                                      0265 00458000
         ST    @10,@AL00001+12                                     0265 00459000
         LA    @10,RECNUM                                          0265 00460000
         ST    @10,@AL00001+16                                     0265 00461000
         LA    @10,POOLID                                          0265 00462000
         ST    @10,@AL00001+20                                     0265 00463000
         LA    @10,RZAPTR                                          0265 00464000
         ST    @10,@AL00001+24                                     0265 00465000
         LA    @10,RZLEN                                           0265 00466000
         ST    @10,@AL00001+28                                     0265 00467000
         LA    @10,RETCODE                                         0265 00468000
         ST    @10,@AL00001+32                                     0265 00469000
         L     @15,GDTDOP(,@15)                                    0265 00470000
         LA    @01,@AL00001                                        0265 00471000
         BALR  @14,@15                                             0265 00472000
*/*                              READ PRIMARY TRACK HOME-ADDRESS     */ 00473000
*                                CALL ICKDVOP0 (GDTTBL             0266 00474000
*                                       ,VOLIB                     0266 00475000
*                                       ,ACTRDHA                   0266 00476000
*                                       ,RZCCHH                    0266 00477000
*                                       ,RECNUM                    0266 00478000
*                                       ,POOLID                    0266 00479000
*                                       ,HAPTR                     0266 00480000
*                                       ,HALEN                     0266 00481000
*                                       ,RETCODE1);                0266 00482000
         L     @10,@PC00001                                        0266 00483000
         ST    @10,@AL00001                                        0266 00484000
         L     @15,@PC00001+4                                      0266 00485000
         ST    @15,@AL00001+4                                      0266 00486000
         LA    @15,@CF00173                                        0266 00487000
         ST    @15,@AL00001+8                                      0266 00488000
         L     @01,RZPTR                                           0266 00489000
         ST    @01,@AL00001+12                                     0266 00490000
         LA    @15,RECNUM                                          0266 00491000
         ST    @15,@AL00001+16                                     0266 00492000
         LA    @15,POOLID                                          0266 00493000
         ST    @15,@AL00001+20                                     0266 00494000
         LA    @15,HAPTR                                           0266 00495000
         ST    @15,@AL00001+24                                     0266 00496000
         LA    @15,HALEN                                           0266 00497000
         ST    @15,@AL00001+28                                     0266 00498000
         LA    @15,RETCODE1                                        0266 00499000
         ST    @15,@AL00001+32                                     0266 00500000
         L     @15,GDTDOP(,@10)                                    0266 00501000
         LA    @01,@AL00001                                        0266 00502000
         BALR  @14,@15                                             0266 00503000
*/*                              IF READ FAILS                       */ 00504000
*                                IF RETCODE = CPFAILS |            0267 00505000
*                                 RETCODE1 = CPFAILS               0267 00506000
*/*                                THEN                              */ 00507000
*                                  THEN DO;                        0267 00508000
*                                                                  0267 00509000
         LA    @10,4                                               0267 00510000
         C     @10,RETCODE                                         0267 00511000
         BE    @RT00267                                            0267 00512000
         C     @10,RETCODE1                                        0267 00513000
         BNE   @RF00267                                            0267 00514000
@RT00267 DS    0H                                                  0268 00515000
*/*                                  INDICATE TRACK UNASSIGNABLE     */ 00516000
*                                    ASSGNFLG = NOASSIGN;          0269 00517000
         NI    ASSGNFLG,B'01111111'                                0269 00518000
*/*                                  SAVE UNRECOVERABLE TRACK        */ 00519000
*                                    UNTRADDR = RZCCHH;            0270 00520000
         L     @10,@PC00001+28                                     0270 00521000
         L     @01,RZPTR                                           0270 00522000
         MVC   UNTRADDR(4,@10),RZCCHH(@01)                         0270 00523000
*/*                                  STATE UNRECOVERABLE TRACK FOUND */ 00524000
*                                    CONDCODE = UNTRFND;           0271 00525000
         L     @10,@PC00001+32                                     0271 00526000
         MVC   CONDCODE(4,@10),@CF00263                            0271 00527000
*/*                                  POINT TO NEXT TRACK             */ 00528000
*                                    IF ALTPTRT = TRKSPCYL - 1     0272 00529000
*                                      THEN DO;                    0272 00530000
*                                                                  0272 00531000
         L     @10,@PC00001+20                                     0272 00532000
         L     @01,INFOPTR+8                                       0272 00533000
         L     @15,TRKSPCYL(,@01)                                  0272 00534000
         BCTR  @15,0                                               0272 00535000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0272 00536000
         C     @15,@ZT00002                                        0272 00537000
         BNE   @RF00272                                            0272 00538000
*                                        ALTPTRC = ALTPTRC + 1;    0274 00539000
         LA    @15,1                                               0274 00540000
         MVC   @ZT00002+2(2),ALTPTRC(@10)                          0274 00541000
         AL    @15,@ZT00002                                        0274 00542000
         STH   @15,ALTPTRC(,@10)                                   0274 00543000
*                                        ALTPTRT = 0;              0275 00544000
         SLR   @15,@15                                             0275 00545000
         STH   @15,ALTPTRT(,@10)                                   0275 00546000
*                                        END;                      0276 00547000
*                                      ELSE DO;                    0277 00548000
         B     @RC00272                                            0277 00549000
@RF00272 DS    0H                                                  0278 00550000
*                                        ALTPTRT = ALTPTRT + 1;    0278 00551000
         L     @10,@PC00001+20                                     0278 00552000
         LA    @15,1                                               0278 00553000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0278 00554000
         AL    @15,@ZT00002                                        0278 00555000
         STH   @15,ALTPTRT(,@10)                                   0278 00556000
*                                        END;                      0279 00557000
*/*                                  LEAVE                           */ 00558000
*                                    GOTO ENDLOOP;                 0280 00559000
         B     ENDLOOP                                             0280 00560000
*/*                                  END-THEN                        */ 00561000
*                                    END;                          0281 00562000
*/*                                ELSE (PRIMARY R0 AVAILABLE)       */ 00563000
*                                  ELSE DO;                        0282 00564000
@RF00267 DS    0H                                                  0283 00565000
*/*                                  IF PRIMARY POINTING TO ALTERNATE*/ 00566000
*/*                                   AND IS DEFECTIVE               */ 00567000
*                                    IF RZACCHH = ALTPTR &         0283 00568000
*                                     (RETCODE = DFLAGONP |        0283 00569000
*                                     RETCODE = DFLAGONA) |        0283 00570000
*                                     (RETCODE1 = DFLAGONP |       0283 00571000
*                                     RETCODE1 = DFLAGONA)         0283 00572000
*/*                                    THEN (TRACK ASSIGNED)         */ 00573000
*                                      THEN DO;                    0283 00574000
         L     @10,@PC00001+20                                     0283 00575000
         L     @01,RZAPTR                                          0283 00576000
         CLC   RZACCHH(4,@01),ALTPTR(@10)                          0283 00577000
         BNE   @GL00006                                            0283 00578000
         L     @10,RETCODE                                         0283 00579000
         CH    @10,@CH00124                                        0283 00580000
         BE    @RT00283                                            0283 00581000
         CH    @10,@CH00127                                        0283 00582000
         BE    @RT00283                                            0283 00583000
@GL00006 L     @10,RETCODE1                                        0283 00584000
         CH    @10,@CH00124                                        0283 00585000
         BE    @RT00283                                            0283 00586000
         CH    @10,@CH00127                                        0283 00587000
         BNE   @RF00283                                            0283 00588000
@RT00283 DS    0H                                                  0284 00589000
*/*                                      INDICATE TRACK NOT          */ 00590000
*/*                                       ASSIGNABLE                 */ 00591000
*                                        ASSGNFLG = NOASSIGN;      0285 00592000
         NI    ASSGNFLG,B'01111111'                                0285 00593000
*/*                                      POINT TO NEXT AVAILABLE     */ 00594000
*/*                                       TRACK (ALTPTR)             */ 00595000
*                                        IF ALTPTRT = TRKSPCYL - 1 0286 00596000
*                                          THEN DO;                0286 00597000
*                                                                  0286 00598000
         L     @10,@PC00001+20                                     0286 00599000
         L     @01,INFOPTR+8                                       0286 00600000
         L     @15,TRKSPCYL(,@01)                                  0286 00601000
         BCTR  @15,0                                               0286 00602000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0286 00603000
         C     @15,@ZT00002                                        0286 00604000
         BNE   @RF00286                                            0286 00605000
*                                            ALTPTRC = ALTPTRC + 1;     00606000
         LA    @15,1                                               0288 00607000
         MVC   @ZT00002+2(2),ALTPTRC(@10)                          0288 00608000
         AL    @15,@ZT00002                                        0288 00609000
         STH   @15,ALTPTRC(,@10)                                   0288 00610000
*                                            ALTPTRT = 0;          0289 00611000
         SLR   @15,@15                                             0289 00612000
         STH   @15,ALTPTRT(,@10)                                   0289 00613000
*                                            END;                  0290 00614000
*                                          ELSE DO;                0291 00615000
*                                                                  0291 00616000
         B     @RC00286                                            0291 00617000
@RF00286 DS    0H                                                  0292 00618000
*                                            ALTPTRT = ALTPTRT + 1;     00619000
         L     @10,@PC00001+20                                     0292 00620000
         LA    @15,1                                               0292 00621000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0292 00622000
         AL    @15,@ZT00002                                        0292 00623000
         STH   @15,ALTPTRT(,@10)                                   0292 00624000
*                                            END;                  0293 00625000
*/*                                      END-THEN (TRACK ASSIGNED)   */ 00626000
*                                        END;                      0294 00627000
*/*                                    ELSE (TRACK ASSIGNABLE)       */ 00628000
*                                      ELSE DO;                    0295 00629000
         B     @RC00283                                            0295 00630000
@RF00283 DS    0H                                                  0296 00631000
*/*                                      INDICATE TRACK ASSIGNABLE   */ 00632000
*                                        ASSGNFLG = ASSIGN;        0296 00633000
         OI    ASSGNFLG,B'10000000'                                0296 00634000
*/*                                      LEAVE                       */ 00635000
*                                        GOTO ENDLOOP;             0297 00636000
         B     ENDLOOP                                             0297 00637000
*/*                                      END-ELSE (TRACK ASSIGNABLE) */ 00638000
*                                        END;                      0298 00639000
*/*                                  END-ELSE (PRIMARY R0 AVAILABLE) */ 00640000
*                                    END;                          0299 00641000
@RC00283 DS    0H                                                  0300 00642000
*/*                              END-THEN (TRACK POINTING TO PRIMARY)*/ 00643000
*                                END;                              0300 00644000
*/*                            ELSE (TRACK NOT POINTING TO PRIMARY)  */ 00645000
*                              ELSE DO;                            0301 00646000
*                                                                  0301 00647000
         B     @RC00263                                            0301 00648000
@RF00263 DS    0H                                                  0302 00649000
*/*                              INDICATE TRACK ASSIGNABLE           */ 00650000
*                                ASSGNFLG = ASSIGN;                0302 00651000
         OI    ASSGNFLG,B'10000000'                                0302 00652000
*/*                              LEAVE                               */ 00653000
*                                GOTO ENDLOOP;                     0303 00654000
         B     ENDLOOP                                             0303 00655000
*/*                              END-ELSE                            */ 00656000
*                                END;                              0304 00657000
*/*                          END-ELSE (TRACK NOT FLAGGED DEFECTIVE)  */ 00658000
*                            END;                                  0305 00659000
@RC00263 DS    0H                                                  0306 00660000
*/*                      END-ELSE (TRACK WAS RECOVERABLE)            */ 00661000
*                        END;                                      0306 00662000
@RC00250 DS    0H                                                  0307 00663000
*/*                  END-ELSE                                        */ 00664000
*                    END;                                          0307 00665000
*/*              END-ELSE                                            */ 00666000
*                END;                                              0308 00667000
@RC00213 DS    0H                                                  0309 00668000
*/*        END-WHILE                                                 */ 00669000
*          END;                                                    0309 00670000
@DE00195 L     @10,@PC00001+20                                     0309 00671000
         L     @01,INFOPTR                                         0309 00672000
         CLC   ALTPTR(4,@10),LASTALT(@01)                          0309 00673000
         BNH   @DL00195                                            0309 00674000
*          ENDLOOP:                                                0310 00675000
*/*        IF NO ERRORS FOUND                                        */ 00676000
*          IF CONDCODE = SUCCEEDS                                  0310 00677000
*/*          THEN                                                    */ 00678000
*            THEN DO;                                              0310 00679000
*                                                                  0310 00680000
ENDLOOP  L     @10,@PC00001+32                                     0310 00681000
         L     @15,CONDCODE(,@10)                                  0310 00682000
         LTR   @15,@15                                             0310 00683000
         BNZ   @RF00310                                            0310 00684000
*/*            IF AN ASSIGNABLE TRACK HAS NOT BEEN FOUND             */ 00685000
*              IF ASSGNFLG = NOASSIGN                              0312 00686000
*/*              THEN INDICATE THERE ARE NO AVAILABLE ALTERNATE TRKS */ 00687000
*                THEN DO;    CONDCODE = NOALTS; END;               0312 00688000
         TM    ASSGNFLG,B'10000000'                                0312 00689000
         BNZ   @RF00312                                            0312 00690000
         MVC   CONDCODE(4,@10),@CF00173                            0314 00691000
*/*              ELSE                                                */ 00692000
*                ELSE DO;                                          0316 00693000
*                                                                  0316 00694000
         B     @RC00312                                            0316 00695000
@RF00312 DS    0H                                                  0317 00696000
*/*                SAVE THE CURRENT TRACK ADDRESS                    */ 00697000
*                  CTRADDR = ALTPTR;                               0317 00698000
         L     @10,@PC00001+20                                     0317 00699000
         MVC   CTRADDR(4),ALTPTR(@10)                              0317 00700000
*/*                IF THE ALTERNATE FLAG IS NOT SET ON               */ 00701000
*                  IF TRACKTYP = PRITRACK                          0318 00702000
*/*                  THEN                                            */ 00703000
*                    THEN DO;                                      0318 00704000
*                                                                  0318 00705000
         TM    TRACKTYP,B'10000000'                                0318 00706000
         BNZ   @RF00318                                            0318 00707000
*/*                    WRITE ALTERNATE HOME-ADDRESS (UDEVOP)         */ 00708000
*                      CALL ICKDVOP0 (GDTTBL                       0320 00709000
*                             ,VOLIB                               0320 00710000
*                             ,ACTWAHA                             0320 00711000
*                             ,ALTPTR                              0320 00712000
*                             ,RECNUM                              0320 00713000
*                             ,POOLID                              0320 00714000
*                             ,HAPTR                               0320 00715000
*                             ,HALEN                               0320 00716000
*                             ,RETCODE);                           0320 00717000
         L     @15,@PC00001                                        0320 00718000
         ST    @15,@AL00001                                        0320 00719000
         L     @14,@PC00001+4                                      0320 00720000
         ST    @14,@AL00001+4                                      0320 00721000
         LA    @14,@CF00127                                        0320 00722000
         ST    @14,@AL00001+8                                      0320 00723000
         ST    @10,@AL00001+12                                     0320 00724000
         LA    @10,RECNUM                                          0320 00725000
         ST    @10,@AL00001+16                                     0320 00726000
         LA    @10,POOLID                                          0320 00727000
         ST    @10,@AL00001+20                                     0320 00728000
         LA    @10,HAPTR                                           0320 00729000
         ST    @10,@AL00001+24                                     0320 00730000
         LA    @10,HALEN                                           0320 00731000
         ST    @10,@AL00001+28                                     0320 00732000
         LA    @10,RETCODE                                         0320 00733000
         ST    @10,@AL00001+32                                     0320 00734000
         L     @15,GDTDOP(,@15)                                    0320 00735000
         LA    @01,@AL00001                                        0320 00736000
         BALR  @14,@15                                             0320 00737000
*/*                    IF WRITE OPERATION FAILS                      */ 00738000
*                      IF RETCODE = CPFAILS                        0321 00739000
*/*                      THEN                                        */ 00740000
*                        THEN DO;                                  0321 00741000
*                                                                  0321 00742000
         CLC   RETCODE(4),@CF00052                                 0321 00743000
         BNE   @RF00321                                            0321 00744000
*/*                        INDICATE FAILURE                          */ 00745000
*                          CONDCODE = NOAASSOC;                    0323 00746000
         L     @10,@PC00001+32                                     0323 00747000
         MVC   CONDCODE(4,@10),@CF00144                            0323 00748000
*/*                        SAVE THE TRACK ADDRESS                    */ 00749000
*                          UNTRADDR = ALTPTR;                      0324 00750000
         L     @10,@PC00001+28                                     0324 00751000
         L     @15,@PC00001+20                                     0324 00752000
         MVC   UNTRADDR(4,@10),ALTPTR(@15)                         0324 00753000
*/*                        END-THEN                                  */ 00754000
*                          END;                                    0325 00755000
*/*                    END-THEN                                      */ 00756000
*                      END;                                        0326 00757000
@RF00321 DS    0H                                                  0327 00758000
*/*                END-ELSE                                          */ 00759000
*                  END;                                            0327 00760000
@RF00318 DS    0H                                                  0328 00761000
*/*            END-THEN                                              */ 00762000
*              END;                                                0328 00763000
@RC00312 DS    0H                                                  0329 00764000
*/*        END-THEN                                                  */ 00765000
*          END;                                                    0329 00766000
@RF00310 DS    0H                                                  0330 00767000
*/*    IF NO ERRORS FOUND                                            */ 00768000
*      IF CONDCODE = SUCCEEDS                                      0330 00769000
*/*      THEN                                                        */ 00770000
*        THEN DO;                                                  0330 00771000
*                                                                  0330 00772000
@RF00193 L     @10,@PC00001+32                                     0330 00773000
         L     @10,CONDCODE(,@10)                                  0330 00774000
         LTR   @10,@10                                             0330 00775000
         BNZ   @RF00330                                            0330 00776000
*/*        WRITE STANDARD-LENGTH RECORD-ZERO (ON THE PRIMARY TRACK   */ 00777000
*/*         ASSOCIATING IT TO THE NEW ALTERNATE TRACK) (UDEVOP)      */ 00778000
*          CALL ICKDVOP0 (GDTTBL                                   0332 00779000
*                 ,VOLIB                                           0332 00780000
*                 ,ACTWRZS                                         0332 00781000
*                 ,PRCCHH                                          0332 00782000
*                 ,RECNUM                                          0332 00783000
*                 ,POOLID                                          0332 00784000
*                 ,ADDR (ALTPTR)                                   0332 00785000
*                 ,LENGTH (ALTPTR)                                 0332 00786000
*                 ,RETCODE);                                       0332 00787000
         L     @10,@PC00001                                        0332 00788000
         ST    @10,@AL00001                                        0332 00789000
         L     @15,@PC00001+4                                      0332 00790000
         ST    @15,@AL00001+4                                      0332 00791000
         LA    @15,@CF00169                                        0332 00792000
         ST    @15,@AL00001+8                                      0332 00793000
         L     @15,@PC00001+8                                      0332 00794000
         ST    @15,@AL00001+12                                     0332 00795000
         LA    @15,RECNUM                                          0332 00796000
         ST    @15,@AL00001+16                                     0332 00797000
         LA    @15,POOLID                                          0332 00798000
         ST    @15,@AL00001+20                                     0332 00799000
         L     @15,@PC00001+20                                     0332 00800000
         ST    @15,@AFTEMPS                                        0332 00801000
         LA    @15,@AFTEMPS                                        0332 00802000
         ST    @15,@AL00001+24                                     0332 00803000
         LA    @15,@CF00052                                        0332 00804000
         ST    @15,@AL00001+28                                     0332 00805000
         LA    @15,RETCODE                                         0332 00806000
         ST    @15,@AL00001+32                                     0332 00807000
         L     @15,GDTDOP(,@10)                                    0332 00808000
         LA    @01,@AL00001                                        0332 00809000
         BALR  @14,@15                                             0332 00810000
*/*        IF WRITE OPERATION FAILS                                  */ 00811000
*          IF RETCODE = CPFAILS                                    0333 00812000
*/*          THEN INDICATE ASSOCIATION OF THE NEW ALTERNATE TO THE   */ 00813000
*/*           PRIMARY TRACK FAILS                                    */ 00814000
*            THEN DO;    CONDCODE = NOPASSOC; END;                 0333 00815000
         CLC   RETCODE(4),@CF00052                                 0333 00816000
         BNE   @RF00333                                            0333 00817000
         L     @10,@PC00001+32                                     0335 00818000
         MVC   CONDCODE(4,@10),@CF00124                            0335 00819000
*/*        END-THEN                                                  */ 00820000
*          END;                                                    0337 00821000
@RF00333 DS    0H                                                  0338 00822000
*/*    IF NO ERRORS FOUND                                            */ 00823000
*      IF CONDCODE = SUCCEEDS                                      0338 00824000
*/*      THEN                                                        */ 00825000
*        THEN DO;                                                  0338 00826000
*                                                                  0338 00827000
@RF00330 L     @10,@PC00001+32                                     0338 00828000
         L     @10,CONDCODE(,@10)                                  0338 00829000
         LTR   @10,@10                                             0338 00830000
         BNZ   @RF00338                                            0338 00831000
*/*        WRITE STANDARD-LENGTH RECORD-ZERO (ON THE NEW ALTERNATE   */ 00832000
*/*         TRACK ASSOCIATING IT TO THE PRIMARY TRACK) (UDEVOP)      */ 00833000
*          CALL ICKDVOP0 (GDTTBL                                   0340 00834000
*                 ,VOLIB                                           0340 00835000
*                 ,ACTWRZS                                         0340 00836000
*                 ,ALTPTR                                          0340 00837000
*                 ,RECNUM                                          0340 00838000
*                 ,POOLID                                          0340 00839000
*                 ,ADDR (PRCCHH)                                   0340 00840000
*                 ,LENGTH (PRCCHH)                                 0340 00841000
*                 ,RETCODE);                                       0340 00842000
         L     @10,@PC00001                                        0340 00843000
         ST    @10,@AL00001                                        0340 00844000
         L     @15,@PC00001+4                                      0340 00845000
         ST    @15,@AL00001+4                                      0340 00846000
         LA    @15,@CF00169                                        0340 00847000
         ST    @15,@AL00001+8                                      0340 00848000
         L     @15,@PC00001+20                                     0340 00849000
         ST    @15,@AL00001+12                                     0340 00850000
         LA    @15,RECNUM                                          0340 00851000
         ST    @15,@AL00001+16                                     0340 00852000
         LA    @15,POOLID                                          0340 00853000
         ST    @15,@AL00001+20                                     0340 00854000
         L     @15,@PC00001+8                                      0340 00855000
         ST    @15,@AFTEMPS                                        0340 00856000
         LA    @15,@AFTEMPS                                        0340 00857000
         ST    @15,@AL00001+24                                     0340 00858000
         LA    @15,@CF00052                                        0340 00859000
         ST    @15,@AL00001+28                                     0340 00860000
         LA    @15,RETCODE                                         0340 00861000
         ST    @15,@AL00001+32                                     0340 00862000
         L     @15,GDTDOP(,@10)                                    0340 00863000
         LA    @01,@AL00001                                        0340 00864000
         BALR  @14,@15                                             0340 00865000
*/*        SAVE THE ADDRESS OF THE ALTERNATE TRACK THAT WAS ASSIGNED */ 00866000
*          ALTRACK = ALTPTR;                                       0341 00867000
         L     @10,@PC00001+24                                     0341 00868000
         L     @15,@PC00001+20                                     0341 00869000
         MVC   ALTRACK(4,@10),ALTPTR(@15)                          0341 00870000
*/*        DECREMENT ALTERNATE TRACK COUNT (ALTCOUNT)                */ 00871000
*          ALTCOUNT = ALTCOUNT - 1;                                0342 00872000
         L     @10,@PC00001+16                                     0342 00873000
         L     @14,ALTCOUNT(,@10)                                  0342 00874000
         BCTR  @14,0                                               0342 00875000
         ST    @14,ALTCOUNT(,@10)                                  0342 00876000
*/*        SET POINTER TO NEXT AVAILABLE ALTERNATE TRACK (ALTPTR)    */ 00877000
*          IF ALTPTRT = TRKSPCYL - 1                               0343 00878000
*            THEN DO;                                              0343 00879000
*                                                                  0343 00880000
         L     @10,INFOPTR+8                                       0343 00881000
         L     @10,TRKSPCYL(,@10)                                  0343 00882000
         BCTR  @10,0                                               0343 00883000
         MVC   @ZT00002+2(2),ALTPTRT(@15)                          0343 00884000
         C     @10,@ZT00002                                        0343 00885000
         BNE   @RF00343                                            0343 00886000
*                ALTPTRC = ALTPTRC + 1;                            0345 00887000
         LA    @10,1                                               0345 00888000
         MVC   @ZT00002+2(2),ALTPTRC(@15)                          0345 00889000
         AL    @10,@ZT00002                                        0345 00890000
         STH   @10,ALTPTRC(,@15)                                   0345 00891000
*                ALTPTRT = 0;                                      0346 00892000
         SLR   @10,@10                                             0346 00893000
         STH   @10,ALTPTRT(,@15)                                   0346 00894000
*                END;                                              0347 00895000
*              ELSE DO;    ALTPTRT = ALTPTRT + 1; END;             0348 00896000
         B     @RC00343                                            0348 00897000
@RF00343 DS    0H                                                  0349 00898000
         L     @10,@PC00001+20                                     0349 00899000
         LA    @15,1                                               0349 00900000
         MVC   @ZT00002+2(2),ALTPTRT(@10)                          0349 00901000
         AL    @15,@ZT00002                                        0349 00902000
         STH   @15,ALTPTRT(,@10)                                   0349 00903000
*/*        IF WRITE OPERATION FAILS                                  */ 00904000
*          IF RETCODE = CPFAILS                                    0351 00905000
*/*          THEN                                                    */ 00906000
*            THEN DO;                                              0351 00907000
*                                                                  0351 00908000
@RC00343 CLC   RETCODE(4),@CF00052                                 0351 00909000
         BNE   @RF00351                                            0351 00910000
*/*            INDICATE ASSOCIATION OF THE PRIMARY TO THE NEW        */ 00911000
*/*             ALTERNATE TRACK FAILS                                */ 00912000
*              CONDCODE = NOAASSOC;                                0353 00913000
         L     @10,@PC00001+32                                     0353 00914000
         MVC   CONDCODE(4,@10),@CF00144                            0353 00915000
*/*            SAVE THE TRACK ADDRESS FOR THE CALLER                 */ 00916000
*              UNTRADDR = CTRADDR;                                 0354 00917000
         L     @10,@PC00001+28                                     0354 00918000
         MVC   UNTRADDR(4,@10),CTRADDR                             0354 00919000
*/*            END-THEN                                              */ 00920000
*              END;                                                0355 00921000
*/*          ELSE                                                    */ 00922000
*            ELSE DO;                                              0356 00923000
*                                                                  0356 00924000
         B     @RC00351                                            0356 00925000
@RF00351 DS    0H                                                  0357 00926000
*/*            IF WRITE OPERATION IS SUCCESSFUL                      */ 00927000
*              IF (RETCODE = SUCCESS) | (RETCODE = DFLAGOFA)       0357 00928000
*/*              THEN INDICATE THAT ASSIGNMENT IS COMPLETE           */ 00929000
*                THEN DO;    ASSGNCOM = COMPLETE; END;             0357 00930000
         L     @10,RETCODE                                         0357 00931000
         LTR   @10,@10                                             0357 00932000
         BZ    @RT00357                                            0357 00933000
         CH    @10,@CH00193                                        0357 00934000
         BNE   @RF00357                                            0357 00935000
@RT00357 DS    0H                                                  0358 00936000
         OI    ASSGNCOM,B'10000000'                                0359 00937000
*/*            END-ELSE                                              */ 00938000
*              END;                                                0361 00939000
@RF00357 DS    0H                                                  0362 00940000
*/*          END-THEN                                                */ 00941000
*            END;                                                  0362 00942000
@RC00351 DS    0H                                                  0363 00943000
*/*    IF NO ERRORS FOUND                                            */ 00944000
*      IF CONDCODE = SUCCEEDS                                      0363 00945000
*/*      THEN                                                        */ 00946000
*        THEN DO;                                                  0363 00947000
*                                                                  0363 00948000
@RF00338 L     @10,@PC00001+32                                     0363 00949000
         L     @10,CONDCODE(,@10)                                  0363 00950000
         LTR   @10,@10                                             0363 00951000
         BNZ   @RF00363                                            0363 00952000
*/*        WRITE STANDARD-LENGTH RECORD-ZERO (OF THE OLD ALTERNATE   */ 00953000
*/*         TRACK TO DISSOCIATE IT FROM THE PRIMARY TRACK) (UDEVOP)  */ 00954000
*          CALL ICKDVOP0 (GDTTBL                                   0365 00955000
*                 ,VOLIB                                           0365 00956000
*                 ,ACTWRZS                                         0365 00957000
*                 ,ALCCHH                                          0365 00958000
*                 ,RECNUM                                          0365 00959000
*                 ,POOLID                                          0365 00960000
*                 ,ADDR (ALCCHH)                                   0365 00961000
*                 ,LENGTH (ALCCHH)                                 0365 00962000
*                 ,RETCODE);                                       0365 00963000
         L     @10,@PC00001                                        0365 00964000
         ST    @10,@AL00001                                        0365 00965000
         L     @15,@PC00001+4                                      0365 00966000
         ST    @15,@AL00001+4                                      0365 00967000
         LA    @15,@CF00169                                        0365 00968000
         ST    @15,@AL00001+8                                      0365 00969000
         L     @15,@PC00001+12                                     0365 00970000
         ST    @15,@AL00001+12                                     0365 00971000
         LA    @14,RECNUM                                          0365 00972000
         ST    @14,@AL00001+16                                     0365 00973000
         LA    @14,POOLID                                          0365 00974000
         ST    @14,@AL00001+20                                     0365 00975000
         ST    @15,@AFTEMPS                                        0365 00976000
         LA    @15,@AFTEMPS                                        0365 00977000
         ST    @15,@AL00001+24                                     0365 00978000
         LA    @15,@CF00052                                        0365 00979000
         ST    @15,@AL00001+28                                     0365 00980000
         LA    @15,RETCODE                                         0365 00981000
         ST    @15,@AL00001+32                                     0365 00982000
         L     @15,GDTDOP(,@10)                                    0365 00983000
         LA    @01,@AL00001                                        0365 00984000
         BALR  @14,@15                                             0365 00985000
*/*        IF WRITE OPERATION FAILS                                  */ 00986000
*          IF RETCODE = CPFAILS                                    0366 00987000
*/*          THEN INDICATE DISSOCIATION OF THE OLD ALTERNATE FROM    */ 00988000
*/*           THE PRIMARY TRACK FAILS                                */ 00989000
*            THEN DO;    CONDCODE = NODISSOC; END;                 0366 00990000
         LA    @10,4                                               0366 00991000
         C     @10,RETCODE                                         0366 00992000
         BNE   @RF00366                                            0366 00993000
         L     @15,@PC00001+32                                     0368 00994000
         ST    @10,CONDCODE(,@15)                                  0368 00995000
*/*      END-THEN                                                    */ 00996000
*        END;                                                      0370 00997000
@RF00366 DS    0H                                                  0371 00998000
*/*    IF ERRORS WERE FOUND                                          */ 00999000
*      IF CONDCODE > SUCCEEDS                                      0371 01000000
*/*      THEN INDICATE THAT ASSIGNMENT IS COMPLETE (WITH ERROR)      */ 01001000
*        THEN DO;    ASSGNCOM = COMPLETE; END;                     0371 01002000
@RF00363 L     @10,@PC00001+32                                     0371 01003000
         L     @10,CONDCODE(,@10)                                  0371 01004000
         LTR   @10,@10                                             0371 01005000
         BNP   @RF00371                                            0371 01006000
         OI    ASSGNCOM,B'10000000'                                0373 01007000
*/*  END-WHILE (ASSIGNMENT NOT COMPLETE)                             */ 01008000
*    END;                                                          0375 01009000
@RF00371 DS    0H                                                  0375 01010000
@DE00184 TM    ASSGNCOM,B'10000000'                                0375 01011000
         BZ    @DL00184                                            0375 01012000
*/*  END-PROCEDURE RE-ASSIGN_ALTERNATE_TRACK                         */ 01013000
*    CALL ICKSAFP0 (GDTTBL                                         0376 01014000
*           ,POOLID);                                              0376 01015000
         L     @10,@PC00001                                        0376 01016000
         ST    @10,@AL00001                                        0376 01017000
         LA    @15,POOLID                                          0376 01018000
         ST    @15,@AL00001+4                                      0376 01019000
         MVI   @AL00001+4,X'80'                                    0376 01020000
         L     @15,GDTFPL(,@10)                                    0376 01021000
         LA    @01,@AL00001                                        0376 01022000
         BALR  @14,@15                                             0376 01023000
*    IF GDTDBG = NULLPTR                                           0377 01024000
*      THEN;                                                       0377 01025000
         L     @10,@PC00001                                        0377 01026000
         L     @10,GDTDBG(,@10)                                    0377 01027000
         LTR   @10,@10                                             0377 01028000
         BZ    @RT00377                                            0377 01029000
*      ELSE                                                        0379 01030000
*        CALL ICKDB010 (GDTTBL                                     0379 01031000
*          ,'RA99');                                               0379 01032000
         L     @10,@PC00001                                        0379 01033000
         ST    @10,@AL00001                                        0379 01034000
         LA    @15,@CC00548                                        0379 01035000
         ST    @15,@AL00001+4                                      0379 01036000
         MVI   @AL00001+4,X'80'                                    0379 01037000
         L     @15,GDTDBG(,@10)                                    0379 01038000
         LA    @01,@AL00001                                        0379 01039000
         BALR  @14,@15                                             0379 01040000
*    CALL ICKSAEP0(GDTTBL,MODID);                                  0380 01041000
*                                                                  0380 01042000
*                                                                  0380 01043000
@RT00377 L     @10,@PC00001                                        0380 01044000
         ST    @10,@AL00001                                        0380 01045000
         LA    @15,MODID                                           0380 01046000
         ST    @15,@AL00001+4                                      0380 01047000
         MVI   @AL00001+4,X'80'                                    0380 01048000
         L     @15,GDTEPL(,@10)                                    0380 01049000
         LA    @01,@AL00001                                        0380 01050000
         BALR  @14,@15                                             0380 01051000
*    END ICKRA01                                                   0381 01052000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01053000
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        * 01054000
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        * 01055000
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        * 01056000
*;                                                                 0381 01057000
@DATA    DS    0H                                                       01058000
@CH00193 DC    H'7'                                                     01059000
@DATD    DSECT                                                          01060000
         DS    0F                                                       01061000
@SA00001 DS    18F                                                      01062000
@PC00001 DS    9F                                                       01063000
@AL00001 DS    9A                                                       01064000
@AFTEMPS DS    1F                                                       01065000
@ZTEMPS  DS    0F                                                       01066000
@ZT00002 DC    F'0'                                                     01067000
@ZTEMPND EQU   *                                                        01068000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         01069000
ICKRA01  CSECT                                                          01070000
         DS    0F                                                       01071000
@CF00102 DC    F'0'                                                     01072000
@CF00173 DC    F'1'                                                     01073000
@CH00173 EQU   @CF00173+2                                               01074000
@CF00124 DC    F'2'                                                     01075000
@CH00124 EQU   @CF00124+2                                               01076000
@CF00144 DC    F'3'                                                     01077000
@CH00144 EQU   @CF00144+2                                               01078000
@CF00052 DC    F'4'                                                     01079000
@CF00263 DC    F'5'                                                     01080000
@CF00127 DC    F'6'                                                     01081000
@CH00127 EQU   @CF00127+2                                               01082000
@CF00169 DC    F'8'                                                     01083000
@DATD    DSECT                                                          01084000
         DS    0D                                                       01085000
LISTSCAN DS    A                                                        01086000
IOCSPTR  DS    A                                                        01087000
OPNPTR   DS    A                                                        01088000
DDSTRU   DS    A                                                        01089000
FSADDR   DS    A                                                        01090000
DMPINDEX DS    A                                                        01091000
RETCODE  DS    F                                                        01092000
RETCODE1 DS    F                                                        01093000
RECNUM   DS    F                                                        01094000
HAPTR    DS    A                                                        01095000
HALEN    DS    F                                                        01096000
RZAPTR   DS    A                                                        01097000
RZPTR    DS    A                                                        01098000
RZLEN    DS    F                                                        01099000
CTRADDR  DS    F                                                        01100000
LISTPTR  DS    A                                                        01101000
SETRC    DS    H                                                        01102000
TESTRC   DS    H                                                        01103000
LISTLN   DS    FL1                                                      01104000
ASSGNFLG DS    BL1                                                      01105000
ASSGNCOM DS    BL1                                                      01106000
TRACKTYP DS    BL1                                                      01107000
INFO     DS    CL8                                                      01108000
         ORG   INFO+0                                                   01109000
INFOPTR  DS    AL4                                                      01110000
INFOLEN  DS    FL4                                                      01111000
         ORG   INFO+24                                                  01112000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01113000
@ENDDATD EQU   *                                                        01114000
ICKRA01  CSECT                                                          01115000
         DS    0F                                                       01116000
@SIZDATD DC    AL1(0)                                                   01117000
         DC    AL3(@ENDDATD-@DATD)                                      01118000
         DS    0D                                                       01119000
@CC00543 DC    C'RA00'                                                  01120000
@CC00548 DC    C'RA99'                                                  01121000
MODID    DC    CL4'RA01'                                                01122000
POOLID   DC    CL4'RA01'                                                01123000
PTCHRA01 DS    CL256                                                    01124000
         ORG   PTCHRA01                                                 01125000
@NM00018 DC    256X'00'                                                 01126000
         ORG   PTCHRA01+256                                             01127000
INFOVECT DC    F'207'                                                   01128000
         DC    F'204'                                                   01129000
         DC    F'205'                                                   01130000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01131000
@01      EQU   01                                                       01132000
@02      EQU   02                                                       01133000
@03      EQU   03                                                       01134000
@04      EQU   04                                                       01135000
@05      EQU   05                                                       01136000
@06      EQU   06                                                       01137000
@07      EQU   07                                                       01138000
@08      EQU   08                                                       01139000
@09      EQU   09                                                       01140000
@10      EQU   10                                                       01141000
@11      EQU   11                                                       01142000
@12      EQU   12                                                       01143000
@13      EQU   13                                                       01144000
@14      EQU   14                                                       01145000
@15      EQU   15                                                       01146000
I        EQU   @02                                                      01147000
REG12    EQU   @12                                                      01148000
REG0     EQU   @00                                                      01149000
REG1     EQU   @01                                                      01150000
REG10    EQU   @10                                                      01151000
REG11    EQU   @11                                                      01152000
REG13    EQU   @13                                                      01153000
REG14    EQU   @14                                                      01154000
REG15    EQU   @15                                                      01155000
REG2     EQU   @02                                                      01156000
REG3     EQU   @03                                                      01157000
REG4     EQU   @04                                                      01158000
REG5     EQU   @05                                                      01159000
REG6     EQU   @06                                                      01160000
REG7     EQU   @07                                                      01161000
REG8     EQU   @08                                                      01162000
REG9     EQU   @09                                                      01163000
RTNREG   EQU   @15                                                      01164000
ICKSAEP0 EQU   0                                                        01165000
ICKSAFP0 EQU   0                                                        01166000
TRACE1   EQU   0                                                        01167000
OLDERID1 EQU   TRACE1                                                   01168000
TRACE2   EQU   0                                                        01169000
STAEPARM EQU   0                                                        01170000
STAEPFX  EQU   STAEPARM                                                 01171000
IOCSTR   EQU   0                                                        01172000
IOCDSO   EQU   IOCSTR+13                                                01173000
IOCRFM   EQU   IOCSTR+14                                                01174000
IOCMAC   EQU   IOCSTR+15                                                01175000
IOCMSG   EQU   IOCSTR+16                                                01176000
OPNAGL   EQU   0                                                        01177000
OPNOPT   EQU   OPNAGL                                                   01178000
OPNRFM   EQU   OPNAGL+1                                                 01179000
OPNTYP   EQU   OPNAGL+2                                                 01180000
OPNMOD   EQU   OPNAGL+3                                                 01181000
UVOLLIST EQU   0                                                        01182000
UVOLENT  EQU   UVOLLIST+2                                               01183000
ICKDVIN0 EQU   0                                                        01184000
ICKDVOP0 EQU   0                                                        01185000
DARGLIST EQU   0                                                        01186000
DARGSTID EQU   DARGLIST+8                                               01187000
DARGARY  EQU   DARGLIST+20                                              01188000
DARGINS  EQU   DARGARY                                                  01189000
DARGINL  EQU   DARGARY+2                                                01190000
FMTLIST  EQU   0                                                        01191000
FMTFLGS  EQU   FMTLIST                                                  01192000
FMTSPF   EQU   FMTLIST+2                                                01193000
FMTRFNO  EQU   FMTSPF                                                   01194000
FMTILEN  EQU   FMTRFNO                                                  01195000
FMTIOFF  EQU   FMTLIST+4                                                01196000
FMTTRBC  EQU   FMTIOFF                                                  01197000
FMTSTO   EQU   FMTTRBC                                                  01198000
FMTOCOL  EQU   FMTLIST+6                                                01199000
FMTCNVF  EQU   FMTLIST+10                                               01200000
ICKDB010 EQU   0                                                        01201000
DMPITM   EQU   0                                                        01202000
DMPARY   EQU   0                                                        01203000
LASTALT  EQU   0                                                        01204000
TRKSPCYL EQU   0                                                        01205000
FINPRI   EQU   0                                                        01206000
FINPRIC  EQU   FINPRI                                                   01207000
FINPRIT  EQU   FINPRI+2                                                 01208000
RZCCHH   EQU   0                                                        01209000
RZCCHHC  EQU   RZCCHH                                                   01210000
RZCCHHT  EQU   RZCCHH+2                                                 01211000
RZACCHH  EQU   0                                                        01212000
DMPTRM   EQU   0                                                        01213000
ICKDVCL0 EQU   0                                                        01214000
ICKDVON0 EQU   0                                                        01215000
ICKIOCL0 EQU   0                                                        01216000
ICKIOGT0 EQU   0                                                        01217000
ICKIOIT0 EQU   0                                                        01218000
ICKIOOP0 EQU   0                                                        01219000
ICKIOPT0 EQU   0                                                        01220000
ICKIOTM0 EQU   0                                                        01221000
ICKSACL0 EQU   0                                                        01222000
ICKSADE0 EQU   0                                                        01223000
ICKSAFS0 EQU   0                                                        01224000
ICKSAGP0 EQU   0                                                        01225000
ICKSAGS0 EQU   0                                                        01226000
ICKSALD0 EQU   0                                                        01227000
ICKSAPR0 EQU   0                                                        01228000
ICKSASC0 EQU   0                                                        01229000
ICKSASN0 EQU   0                                                        01230000
ICKSAST0 EQU   0                                                        01231000
ICKSATI0 EQU   0                                                        01232000
ICKSAVC0 EQU   0                                                        01233000
ICKSAWO0 EQU   0                                                        01234000
ICKTPEA0 EQU   0                                                        01235000
ICKTPES0 EQU   0                                                        01236000
ICKTPPR0 EQU   0                                                        01237000
ICKTPRE0 EQU   0                                                        01238000
ICKTPRS0 EQU   0                                                        01239000
LISTTEST EQU   0                                                        01240000
NEWERID1 EQU   5                                                        01241000
NEWERID2 EQU   5                                                        01242000
GDTTBL   EQU   0                                                        01243000
GDTTR1   EQU   GDTTBL+8                                                 01244000
GDTTR2   EQU   GDTTBL+12                                                01245000
GDTDIN   EQU   GDTTBL+44                                                01246000
GDTDOP   EQU   GDTTBL+48                                                01247000
GDTDBG   EQU   GDTTBL+52                                                01248000
GDTDVO   EQU   GDTTBL+56                                                01249000
GDTPRT   EQU   GDTTBL+60                                                01250000
GDTESS   EQU   GDTTBL+64                                                01251000
GDTESA   EQU   GDTTBL+68                                                01252000
GDTRST   EQU   GDTTBL+72                                                01253000
GDTRES   EQU   GDTTBL+76                                                01254000
GDTCAL   EQU   GDTTBL+80                                                01255000
GDTGSP   EQU   GDTTBL+84                                                01256000
GDTFSP   EQU   GDTTBL+88                                                01257000
GDTGPL   EQU   GDTTBL+92                                                01258000
GDTFPL   EQU   GDTTBL+96                                                01259000
GDTLOD   EQU   GDTTBL+100                                               01260000
GDTDEL   EQU   GDTTBL+104                                               01261000
GDTPRL   EQU   GDTTBL+108                                               01262000
GDTEPL   EQU   GDTTBL+112                                               01263000
GDTTIM   EQU   GDTTBL+116                                               01264000
GDTIIO   EQU   GDTTBL+120                                               01265000
GDTTIO   EQU   GDTTBL+124                                               01266000
GDTOPN   EQU   GDTTBL+136                                               01267000
GDTCLS   EQU   GDTTBL+140                                               01268000
GDTGET   EQU   GDTTBL+144                                               01269000
GDTPUT   EQU   GDTTBL+148                                               01270000
GDTSNP   EQU   GDTTBL+160                                               01271000
GDTWTO   EQU   GDTTBL+168                                               01272000
GDTSCR   EQU   GDTTBL+172                                               01273000
GDTVCK   EQU   GDTTBL+176                                               01274000
GDTDVC   EQU   GDTTBL+180                                               01275000
GDTSTE   EQU   GDTTBL+188                                               01276000
VOLIB    EQU   0                                                        01277000
PRCCHH   EQU   0                                                        01278000
ALCCHH   EQU   0                                                        01279000
ALTCOUNT EQU   0                                                        01280000
ALTPTR   EQU   0                                                        01281000
ALTPTRC  EQU   ALTPTR                                                   01282000
ALTPTRT  EQU   ALTPTR+2                                                 01283000
ALTRACK  EQU   0                                                        01284000
UNTRADDR EQU   0                                                        01285000
CONDCODE EQU   0                                                        01286000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01287000
GDTCVR   EQU   GDTTBL+184                                               01288000
GDTSPR   EQU   GDTTBL+164                                               01289000
GDTABH   EQU   GDTTBL+156                                               01290000
GDTABT   EQU   GDTTBL+152                                               01291000
GDTTOH   EQU   GDTTBL+132                                               01292000
GDTRIP   EQU   GDTTBL+128                                               01293000
GDTDVH   EQU   GDTTBL+40                                                01294000
GDTIOH   EQU   GDTTBL+36                                                01295000
GDTSAH   EQU   GDTTBL+32                                                01296000
GDTTPH   EQU   GDTTBL+28                                                01297000
GDTRIH   EQU   GDTTBL+24                                                01298000
GDTSTH   EQU   GDTTBL+20                                                01299000
GDTDBH   EQU   GDTTBL+16                                                01300000
GDTPRM   EQU   GDTTBL+4                                                 01301000
GDTHDR   EQU   GDTTBL                                                   01302000
RZACCHHT EQU   RZACCHH+2                                                01303000
RZACCHHC EQU   RZACCHH                                                  01304000
LASTALTT EQU   LASTALT+2                                                01305000
LASTALTC EQU   LASTALT                                                  01306000
@NM00017 EQU   DMPARY+15                                                01307000
DMPARYTP EQU   DMPARY+14                                                01308000
DMPARYEX EQU   DMPARY+12                                                01309000
DMPARYIC EQU   DMPARY+10                                                01310000
DMPARYSZ EQU   DMPARY+8                                                 01311000
DMPARYNM EQU   DMPARY                                                   01312000
@NM00016 EQU   DMPITM+15                                                01313000
DMPITMTP EQU   DMPITM+14                                                01314000
DMPITMLN EQU   DMPITM+12                                                01315000
DMPITMPT EQU   DMPITM+8                                                 01316000
DMPITMNM EQU   DMPITM                                                   01317000
@NM00015 EQU   FMTCNVF+1                                                01318000
FMTBS    EQU   FMTCNVF+1                                                01319000
FMTSS    EQU   FMTCNVF+1                                                01320000
FMTAL    EQU   FMTCNVF+1                                                01321000
FMTZS    EQU   FMTCNVF+1                                                01322000
@NM00014 EQU   FMTCNVF                                                  01323000
FMTPU    EQU   FMTCNVF                                                  01324000
FMTBD    EQU   FMTCNVF                                                  01325000
FMTBHD   EQU   FMTCNVF                                                  01326000
FMTBHA   EQU   FMTCNVF                                                  01327000
FMTBH    EQU   FMTCNVF                                                  01328000
FMTOLEN  EQU   FMTLIST+8                                                01329000
FMTRIO   EQU   FMTOCOL                                                  01330000
FMTSPT   EQU   FMTSTO                                                   01331000
FMTSTL   EQU   FMTILEN                                                  01332000
@NM00013 EQU   FMTFLGS+1                                                01333000
FMTHDF   EQU   FMTFLGS                                                  01334000
FMTDFF   EQU   FMTFLGS                                                  01335000
FMTSTF   EQU   FMTFLGS                                                  01336000
FMTREPF  EQU   FMTFLGS                                                  01337000
FMTBDF   EQU   FMTFLGS                                                  01338000
FMTIDF   EQU   FMTFLGS                                                  01339000
FMTSCF   EQU   FMTFLGS                                                  01340000
FMTEOLF  EQU   FMTFLGS                                                  01341000
DARGDTM  EQU   DARGARY+4                                                01342000
DARGPCT  EQU   DARGINL                                                  01343000
DARGREP  EQU   DARGINS                                                  01344000
@NM00012 EQU   DARGLIST+19                                              01345000
DARGIND  EQU   DARGLIST+18                                              01346000
DARGRETL EQU   DARGLIST+16                                              01347000
DARGCNT  EQU   DARGLIST+14                                              01348000
DARGILP  EQU   DARGLIST+12                                              01349000
DARGSENT EQU   DARGSTID+3                                               01350000
DARGSMOD EQU   DARGSTID                                                 01351000
DARGRETP EQU   DARGLIST+4                                               01352000
DARGDBP  EQU   DARGLIST                                                 01353000
UVOLVOL  EQU   UVOLENT+4                                                01354000
UVOLDEV  EQU   UVOLENT                                                  01355000
UVOLCNT  EQU   UVOLLIST                                                 01356000
OPNRSVD  EQU   OPNAGL+28                                                01357000
OPNVOL   EQU   OPNAGL+24                                                01358000
OPNBLK   EQU   OPNAGL+20                                                01359000
OPNREC   EQU   OPNAGL+16                                                01360000
OPNDSN   EQU   OPNAGL+12                                                01361000
OPNDDN   EQU   OPNAGL+8                                                 01362000
OPNIOC   EQU   OPNAGL+4                                                 01363000
@NM00011 EQU   OPNMOD                                                   01364000
OPNMODRC EQU   OPNMOD                                                   01365000
OPNMODAC EQU   OPNMOD                                                   01366000
@NM00010 EQU   OPNTYP                                                   01367000
OPNTYPSO EQU   OPNTYP                                                   01368000
OPNTYPSI EQU   OPNTYP                                                   01369000
@NM00009 EQU   OPNRFM                                                   01370000
OPNRFMBK EQU   OPNRFM                                                   01371000
OPNRFMSF EQU   OPNRFM                                                   01372000
OPNRFMUN EQU   OPNRFM                                                   01373000
OPNRFMVR EQU   OPNRFM                                                   01374000
OPNRFMFX EQU   OPNRFM                                                   01375000
@NM00008 EQU   OPNOPT                                                   01376000
OPNOPTJM EQU   OPNOPT                                                   01377000
OPNOPTKS EQU   OPNOPT                                                   01378000
OPNOPTBK EQU   OPNOPT                                                   01379000
OPNOPTUP EQU   OPNOPT                                                   01380000
OPNOPTOT EQU   OPNOPT                                                   01381000
OPNOPTIN EQU   OPNOPT                                                   01382000
IOCEXT   EQU   IOCSTR+36                                                01383000
IOCRRN   EQU   IOCSTR+32                                                01384000
@NM00007 EQU   IOCSTR+30                                                01385000
IOCPNM   EQU   IOCSTR+28                                                01386000
IOCCBP   EQU   IOCSTR+24                                                01387000
IOCDSN   EQU   IOCSTR+20                                                01388000
@NM00006 EQU   IOCSTR+17                                                01389000
@NM00005 EQU   IOCMSG                                                   01390000
IOCMSGOP EQU   IOCMSG                                                   01391000
IOCMACPA EQU   IOCMAC                                                   01392000
@NM00004 EQU   IOCMAC                                                   01393000
IOCMACBK EQU   IOCMAC                                                   01394000
IOCMACUP EQU   IOCMAC                                                   01395000
IOCMACOT EQU   IOCMAC                                                   01396000
IOCMACIN EQU   IOCMAC                                                   01397000
@NM00003 EQU   IOCRFM                                                   01398000
IOCRFMBK EQU   IOCRFM                                                   01399000
IOCRFMSF EQU   IOCRFM                                                   01400000
IOCRFMUN EQU   IOCRFM                                                   01401000
IOCRFMVR EQU   IOCRFM                                                   01402000
IOCRFMFX EQU   IOCRFM                                                   01403000
@NM00002 EQU   IOCDSO                                                   01404000
IOCDSOPS EQU   IOCDSO                                                   01405000
IOCKYL   EQU   IOCSTR+12                                                01406000
IOCTRN   EQU   IOCSTR+8                                                 01407000
IOCDLN   EQU   IOCSTR+4                                                 01408000
IOCDAD   EQU   IOCSTR                                                   01409000
STAEWORK EQU   STAEPARM+32                                              01410000
STARPTR  EQU   STAEPFX+28                                               01411000
STASPTR  EQU   STAEPFX+24                                               01412000
STALEN   EQU   STAEPFX+20                                               01413000
STAID    EQU   STAEPFX+16                                               01414000
STAEPA   EQU   STAEPFX+12                                               01415000
STAGDT   EQU   STAEPFX+8                                                01416000
STABPTR  EQU   STAEPFX+4                                                01417000
STAFPTR  EQU   STAEPFX                                                  01418000
NEWID2   EQU   TRACE2+95                                                01419000
OLDERID2 EQU   TRACE2                                                   01420000
NEWID1   EQU   TRACE1+95                                                01421000
CALLID   EQU   OLDERID1+90                                              01422000
@NM00001 EQU   OLDERID1                                                 01423000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01424000
@RC00202 EQU   ENDLOOP                                                  01425000
@RC00216 EQU   @RC00213                                                 01426000
@RC00239 EQU   ENDLOOP                                                  01427000
@RC00253 EQU   @RC00250                                                 01428000
@RC00272 EQU   ENDLOOP                                                  01429000
@RC00286 EQU   @RC00283                                                 01430000
@ENDDATA EQU   *                                                        01431000
         END   ICKRA01,(C'PLS1721',0701,78192)                          01432000
