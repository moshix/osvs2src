         TITLE '**********  ICKRF01:  REFORMAT COMMAND CONTROLLER  *****00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
ICKRF01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'ICKRF01   78.192'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  DS    0H                                                  0002 00022000
         USING @PSTART,@12                                         0002 00023000
         L     @00,@SIZDATD                                        0002 00024000
         GETMAIN  R,LV=(0)                                              00025000
         LR    @11,@01                                             0002 00026000
         USING @DATD,@11                                           0002 00027000
         ST    @13,@SA00001+4                                      0002 00028000
         LM    @00,@01,20(@13)                                     0002 00029000
         ST    @11,8(,@13)                                         0002 00030000
         LR    @13,@11                                             0002 00031000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00032000
         MVC   @PC00001(12),0(@01)                                 0002 00033000
*                                                                  0192 00034000
         EJECT                                                          00035000
*                                                                  0193 00036000
*/*****  B E G I N    E X E C U T I O N  *****************************/ 00037000
*                                                                  0193 00038000
*    IF GDTDBG = NULLPTR                                           0193 00039000
*      THEN;                                                       0193 00040000
         L     @10,@PC00001                                        0193 00041000
         L     @10,GDTDBG(,@10)                                    0193 00042000
         LTR   @10,@10                                             0193 00043000
         BZ    @RT00193                                            0193 00044000
*      ELSE                                                        0195 00045000
*        CALL ICKDB010 (GDTTBL, 'RF00');                           0195 00046000
*                                                                  0195 00047000
         L     @10,@PC00001                                        0195 00048000
         ST    @10,@AL00001                                        0195 00049000
         LA    @15,@CC00576                                        0195 00050000
         ST    @15,@AL00001+4                                      0195 00051000
         MVI   @AL00001+4,X'80'                                    0195 00052000
         L     @15,GDTDBG(,@10)                                    0195 00053000
         LA    @01,@AL00001                                        0195 00054000
         BALR  @14,@15                                             0195 00055000
*/*  ESTABLISH UPRINT ARGUMENT LIST                                  */ 00056000
*    PRTHDR = 'DARGLIST';                                          0196 00057000
@RT00193 MVC   PRTHDR(4),@CC00577                                  0196 00058000
*    DDSTRU = ADDR(PRTARGS);                                       0197 00059000
         LA    @10,PRTARGS                                         0197 00060000
         ST    @10,DDSTRU                                          0197 00061000
*    PRTARGS = ''B;                                                0198 00062000
         XC    PRTARGS(20),PRTARGS                                 0198 00063000
*    DARGSMOD = MSGMODZ;                                           0199 00064000
         MVC   DARGSMOD(3,@10),@CC00525                            0199 00065000
*/*  INDICATE INITIALLY SUCCESSFUL COMPLETION (LASTCOND = 0)         */ 00066000
*    LASTCOND = LASTCC00;                                          0200 00067000
         L     @10,@PC00001+8                                      0200 00068000
         SLR   @15,@15                                             0200 00069000
         STH   @15,LASTCOND(,@10)                                  0200 00070000
*/*  ISSUE_OPEN_VOLUME                                               */ 00071000
*    CALL OPENVOL;                                                 0201 00072000
         BAL   @14,OPENVOL                                         0201 00073000
*/*  IF NO SEVERE ERRORS ENCOUNTERED                                 */ 00074000
*    IF LASTCOND < LASTCC12                                        0202 00075000
*/*    THEN                                                          */ 00076000
*      THEN DO;                                                    0202 00077000
*                                                                  0202 00078000
         L     @10,@PC00001+8                                      0202 00079000
         LH    @10,LASTCOND(,@10)                                  0202 00080000
         CH    @10,@CH00261                                        0202 00081000
         BNL   @RF00202                                            0202 00082000
*/*      OBTAIN SETTING OF FIRST TIME INITIALIZATION FLAG (UDEVINFO) */ 00083000
*        CALL ICKDVIN0 (GDTTBL                                     0204 00084000
*                 ,VOLIB                                           0204 00085000
*                 ,VOLFINIT                                        0204 00086000
*                 ,POOLID                                          0204 00087000
*                 ,VIBPTR                                          0204 00088000
*                 ,VIBLEN                                          0204 00089000
*                 ,RETCODE);                                       0204 00090000
         L     @10,@PC00001                                        0204 00091000
         ST    @10,@AL00001                                        0204 00092000
         LA    @15,VOLIB                                           0204 00093000
         ST    @15,@AL00001+4                                      0204 00094000
         LA    @15,@CF00256                                        0204 00095000
         ST    @15,@AL00001+8                                      0204 00096000
         LA    @15,POOLID                                          0204 00097000
         ST    @15,@AL00001+12                                     0204 00098000
         LA    @15,VIBPTR                                          0204 00099000
         ST    @15,@AL00001+16                                     0204 00100000
         LA    @15,VIBLEN                                          0204 00101000
         ST    @15,@AL00001+20                                     0204 00102000
         LA    @15,RETCODE                                         0204 00103000
         ST    @15,@AL00001+24                                     0204 00104000
         L     @15,GDTDIN(,@10)                                    0204 00105000
         LA    @01,@AL00001                                        0204 00106000
         BALR  @14,@15                                             0204 00107000
*/*      IF THE VOLUME IS BEING INITIALIZED FOR THE FIRST TIME       */ 00108000
*        IF VIBFLAG = ON                                           0205 00109000
*/*        THEN                                                      */ 00110000
*          THEN DO;                                                0205 00111000
*                                                                  0205 00112000
         L     @10,VIBPTR                                          0205 00113000
         TM    VIBFLAG(@10),B'10000000'                            0205 00114000
         BNO   @RF00205                                            0205 00115000
*/*          ISSUE AN ERROR MESSAGE                                  */ 00116000
*            DARGSENT = MSGRTIN;                                   0207 00117000
         L     @10,DDSTRU                                          0207 00118000
         MVI   DARGSENT(@10),X'1B'                                 0207 00119000
*            CALL ICKTPPR0 (GDTTBL                                 0208 00120000
*                   ,PRTFILE                                       0208 00121000
*                   ,DDSTRU);                                      0208 00122000
         L     @10,@PC00001                                        0208 00123000
         ST    @10,@AL00001                                        0208 00124000
         LA    @15,@CF00090                                        0208 00125000
         ST    @15,@AL00001+4                                      0208 00126000
         LA    @15,DDSTRU                                          0208 00127000
         ST    @15,@AL00001+8                                      0208 00128000
         MVI   @AL00001+8,X'80'                                    0208 00129000
         L     @15,GDTPRT(,@10)                                    0208 00130000
         LA    @01,@AL00001                                        0208 00131000
         BALR  @14,@15                                             0208 00132000
*/*          INDICATE A SEVERE ERROR                                 */ 00133000
*            LASTCOND = LASTCC12;                                  0209 00134000
         L     @10,@PC00001+8                                      0209 00135000
         MVC   LASTCOND(2,@10),@CH00261                            0209 00136000
*/*          END-THEN                                                */ 00137000
*            END;                                                  0210 00138000
*/*      END-THEN                                                    */ 00139000
*        END;                                                      0211 00140000
@RF00205 DS    0H                                                  0212 00141000
*/*  IF NO SEVERE ERRORS ENCOUNTERED                                 */ 00142000
*    IF LASTCOND < LASTCC12                                        0212 00143000
*/*    THEN                                                          */ 00144000
*      THEN DO;                                                    0212 00145000
*                                                                  0212 00146000
@RF00202 L     @10,@PC00001+8                                      0212 00147000
         LH    @10,LASTCOND(,@10)                                  0212 00148000
         CH    @10,@CH00261                                        0212 00149000
         BNL   @RF00212                                            0212 00150000
*/*      OBTAIN_VOLUME_AUTHORIZATION                                 */ 00151000
*        CALL ICKVA01                                              0214 00152000
*             (GDTTBL                                              0214 00153000
*             ,VOLIB                                               0214 00154000
*             ,RETCODE);                                           0214 00155000
         L     @10,@PC00001                                        0214 00156000
         ST    @10,@AL00001                                        0214 00157000
         LA    @10,VOLIB                                           0214 00158000
         ST    @10,@AL00001+4                                      0214 00159000
         LA    @10,RETCODE                                         0214 00160000
         ST    @10,@AL00001+8                                      0214 00161000
         L     @15,@CV00581                                        0214 00162000
         LA    @01,@AL00001                                        0214 00163000
         BALR  @14,@15                                             0214 00164000
*/*      IF VOLUME AUTHORIZATION NOT GRANTED                         */ 00165000
*        IF RETCODE = FAILURE                                      0215 00166000
*/*        THEN INDICATE A SEVERE ERROR                              */ 00167000
*          THEN LASTCOND = LASTCC12;                               0215 00168000
         CLC   RETCODE(4),@CF00161                                 0215 00169000
         BNE   @RF00215                                            0215 00170000
         L     @10,@PC00001+8                                      0216 00171000
         MVC   LASTCOND(2,@10),@CH00261                            0216 00172000
*/*      END-THEN                                                    */ 00173000
*        END;                                                      0217 00174000
@RF00215 DS    0H                                                  0218 00175000
*/*  IF NO SEVERE ERRORS ENCOUNTERED AND VERIFICATION IS REQUESTED   */ 00176000
*    IF (LASTCOND < LASTCC12) & (ADDR(VERFY) ^= NULLPTR)           0218 00177000
*/*    THEN                                                          */ 00178000
*      THEN DO;                                                    0218 00179000
*                                                                  0218 00180000
@RF00212 L     @10,@PC00001+8                                      0218 00181000
         LH    @10,LASTCOND(,@10)                                  0218 00182000
         CH    @10,@CH00261                                        0218 00183000
         BNL   @RF00218                                            0218 00184000
         SLR   @10,@10                                             0218 00185000
         L     @15,@PC00001+4                                      0218 00186000
         C     @10,FDTPTR+16(,@15)                                 0218 00187000
         BE    @RF00218                                            0218 00188000
*/*      IF THE OWNER ID IS TO BE VERIFIED                           */ 00189000
*        IF ADDR(VOWN) ^= NULLPTR                                  0220 00190000
*/*        THEN SET UP THE PROPER VALUE TO BE PASSED                 */ 00191000
*          THEN DO;    VALVOWN = VOWNVAL; END;                     0220 00192000
         L     @15,FDTPTR+24(,@15)                                 0220 00193000
         CR    @15,@10                                             0220 00194000
         BE    @RF00220                                            0220 00195000
         MVC   VALVOWN(14),VOWNVAL(@15)                            0222 00196000
*/*        ELSE INDICATE THAT THE OWNER ID NEED NOT BE VERIFIED      */ 00197000
*          ELSE DO;    VALVOWN = ' '; END;                         0224 00198000
         B     @RC00220                                            0224 00199000
@RF00220 DS    0H                                                  0225 00200000
         MVI   VALVOWN+1,C' '                                      0225 00201000
         MVC   VALVOWN+2(12),VALVOWN+1                             0225 00202000
         MVI   VALVOWN,C' '                                        0225 00203000
*/*      VERIFY_VOLUME_LABEL                                         */ 00204000
*        CALL   ICKVV01                                            0227 00205000
*               (GDTTBL                                            0227 00206000
*               ,VOLIB                                             0227 00207000
*               ,VSERVAL                                           0227 00208000
*               ,VALVOWN                                           0227 00209000
*               ,RETCODE);                                         0227 00210000
@RC00220 L     @10,@PC00001                                        0227 00211000
         ST    @10,@AL00001                                        0227 00212000
         LA    @10,VOLIB                                           0227 00213000
         ST    @10,@AL00001+4                                      0227 00214000
         L     @10,@PC00001+4                                      0227 00215000
         L     @10,FDTPTR+20(,@10)                                 0227 00216000
         LA    @10,VSERVAL(,@10)                                   0227 00217000
         ST    @10,@AL00001+8                                      0227 00218000
         LA    @10,VALVOWN                                         0227 00219000
         ST    @10,@AL00001+12                                     0227 00220000
         LA    @10,RETCODE                                         0227 00221000
         ST    @10,@AL00001+16                                     0227 00222000
         L     @15,@CV00583                                        0227 00223000
         LA    @01,@AL00001                                        0227 00224000
         BALR  @14,@15                                             0227 00225000
*/*      IF VERIFICATION FAILS                                       */ 00226000
*        IF RETCODE = FAILURE                                      0228 00227000
*/*        THEN INDICATE A SEVERE ERROR                              */ 00228000
*          THEN LASTCOND = LASTCC12;                               0228 00229000
         CLC   RETCODE(4),@CF00161                                 0228 00230000
         BNE   @RF00228                                            0228 00231000
         L     @10,@PC00001+8                                      0229 00232000
         MVC   LASTCOND(2,@10),@CH00261                            0229 00233000
*/*      IF VOLUME LABEL DOES NOT EXIST                              */ 00234000
*        IF RETCODE = NOLABEL                                      0230 00235000
*/*        THEN                                                      */ 00236000
*          THEN DO;                                                0230 00237000
*                                                                  0230 00238000
@RF00228 CLC   RETCODE(4),@CF00112                                 0230 00239000
         BNE   @RF00230                                            0230 00240000
*/*          ISSUE ERROR MESSAGE (MSGURVOL) (UPRINT)                 */ 00241000
*            DARGSENT = MSGURVOL;                                  0232 00242000
         L     @10,DDSTRU                                          0232 00243000
         MVI   DARGSENT(@10),X'10'                                 0232 00244000
*            CALL ICKTPPR0 (GDTTBL                                 0233 00245000
*                   ,PRTFILE                                       0233 00246000
*                   ,DDSTRU);                                      0233 00247000
         L     @10,@PC00001                                        0233 00248000
         ST    @10,@AL00001                                        0233 00249000
         LA    @15,@CF00090                                        0233 00250000
         ST    @15,@AL00001+4                                      0233 00251000
         LA    @15,DDSTRU                                          0233 00252000
         ST    @15,@AL00001+8                                      0233 00253000
         MVI   @AL00001+8,X'80'                                    0233 00254000
         L     @15,GDTPRT(,@10)                                    0233 00255000
         LA    @01,@AL00001                                        0233 00256000
         BALR  @14,@15                                             0233 00257000
*/*          INDICATE A SEVERE ERROR                                 */ 00258000
*            LASTCOND = LASTCC12;                                  0234 00259000
         L     @10,@PC00001+8                                      0234 00260000
         MVC   LASTCOND(2,@10),@CH00261                            0234 00261000
*/*          END-THEN                                                */ 00262000
*            END;                                                  0235 00263000
*/*      END-THEN                                                    */ 00264000
*        END;                                                      0236 00265000
@RF00230 DS    0H                                                  0237 00266000
*/*  IF NO SEVERE ERRORS ENCOUNTERED                                 */ 00267000
*    IF LASTCOND < LASTCC12                                        0237 00268000
*/*    THEN                                                          */ 00269000
*      THEN DO;                                                    0237 00270000
*                                                                  0237 00271000
@RF00218 L     @10,@PC00001+8                                      0237 00272000
         LH    @10,LASTCOND(,@10)                                  0237 00273000
         CH    @10,@CH00261                                        0237 00274000
         BNL   @RF00237                                            0237 00275000
*/*      READ_VOLUME_LABEL                                           */ 00276000
*        CALL ICKRL01                                              0239 00277000
*             (GDTTBL                                              0239 00278000
*             ,VOLIB                                               0239 00279000
*             ,VOL1P                                               0239 00280000
*             ,LABELS                                              0239 00281000
*             ,RETCODE);                                           0239 00282000
         L     @10,@PC00001                                        0239 00283000
         ST    @10,@AL00001                                        0239 00284000
         LA    @10,VOLIB                                           0239 00285000
         ST    @10,@AL00001+4                                      0239 00286000
         LA    @10,VOL1P                                           0239 00287000
         ST    @10,@AL00001+8                                      0239 00288000
         LA    @10,LABELS                                          0239 00289000
         ST    @10,@AL00001+12                                     0239 00290000
         LA    @10,RETCODE                                         0239 00291000
         ST    @10,@AL00001+16                                     0239 00292000
         L     @15,@CV00584                                        0239 00293000
         LA    @01,@AL00001                                        0239 00294000
         BALR  @14,@15                                             0239 00295000
*        RESPECIFY VOL1 BASED (ADDR(VOL1P));                       0240 00296000
*/*      IF UNABLE TO READ THE VOLUME LABEL                          */ 00297000
*        IF RETCODE = NORVOLL                                      0241 00298000
*/*        THEN                                                      */ 00299000
*          THEN DO;                                                0241 00300000
*                                                                  0241 00301000
         CLC   RETCODE(4),@CF00161                                 0241 00302000
         BNE   @RF00241                                            0241 00303000
*/*          ISSUE ERROR MESSAGE (MSGURVOL) (UPRINT)                 */ 00304000
*            DARGSENT = MSGURVOL;                                  0243 00305000
         L     @10,DDSTRU                                          0243 00306000
         MVI   DARGSENT(@10),X'10'                                 0243 00307000
*            CALL ICKTPPR0 (GDTTBL                                 0244 00308000
*                   ,PRTFILE                                       0244 00309000
*                   ,DDSTRU);                                      0244 00310000
         L     @10,@PC00001                                        0244 00311000
         ST    @10,@AL00001                                        0244 00312000
         LA    @15,@CF00090                                        0244 00313000
         ST    @15,@AL00001+4                                      0244 00314000
         LA    @15,DDSTRU                                          0244 00315000
         ST    @15,@AL00001+8                                      0244 00316000
         MVI   @AL00001+8,X'80'                                    0244 00317000
         L     @15,GDTPRT(,@10)                                    0244 00318000
         LA    @01,@AL00001                                        0244 00319000
         BALR  @14,@15                                             0244 00320000
*/*          INDICATE A SEVERE ERROR (LASTCOND = 12)                 */ 00321000
*            LASTCOND = LASTCC12;                                  0245 00322000
         L     @10,@PC00001+8                                      0245 00323000
         MVC   LASTCOND(2,@10),@CH00261                            0245 00324000
*/*          END-THEN                                                */ 00325000
*            END;                                                  0246 00326000
*/*      END-THEN                                                    */ 00327000
*        END;                                                      0247 00328000
@RF00241 DS    0H                                                  0248 00329000
*/*  IF NO SEVERE ERRORS ENCOUNTERED                                 */ 00330000
*    IF LASTCOND < LASTCC12                                        0248 00331000
*/*    THEN                                                          */ 00332000
*      THEN DO;                                                    0248 00333000
*                                                                  0248 00334000
@RF00237 L     @10,@PC00001+8                                      0248 00335000
         LH    @10,LASTCOND(,@10)                                  0248 00336000
         CH    @10,@CH00261                                        0248 00337000
         BNL   @RF00248                                            0248 00338000
*/*      IF NEW VOLUME-SERIAL OR OWNER-ID ARE SUPPLIED               */ 00339000
*        IF ADDR(VOLID) ^= NULLPTR | ADDR(OWNER) ^= NULLPTR        0250 00340000
*/*        THEN                                                      */ 00341000
*          THEN DO;                                                0250 00342000
*                                                                  0250 00343000
         SLR   @10,@10                                             0250 00344000
         L     @15,@PC00001+4                                      0250 00345000
         C     @10,FDTPTR+4(,@15)                                  0250 00346000
         BNE   @RT00250                                            0250 00347000
         C     @10,FDTPTR+8(,@15)                                  0250 00348000
         BE    @RF00250                                            0250 00349000
@RT00250 DS    0H                                                  0251 00350000
*/*          FOR SYSTEMS WITH RACF, CHECK PROPER LEVEL OF            */ 00351000
*/*           AUTHORIZATION                                          */ 00352000
*            CALL ICKSAVC0 (GDTTBL                                 0252 00353000
*                    ,VOL1SER                                      0252 00354000
*                    ,ALTER);                                      0252 00355000
         L     @10,@PC00001                                        0252 00356000
         ST    @10,@AL00001                                        0252 00357000
         LA    @03,VOL1P                                           0252 00358000
         LA    @03,VOL1SER(,@03)                                   0252 00359000
         ST    @03,@AL00001+4                                      0252 00360000
         LA    @03,@CC00151                                        0252 00361000
         ST    @03,@AL00001+8                                      0252 00362000
         MVI   @AL00001+8,X'80'                                    0252 00363000
         L     @15,GDTVCK(,@10)                                    0252 00364000
         LA    @01,@AL00001                                        0252 00365000
         BALR  @14,@15                                             0252 00366000
*            RESPECIFY RTNREG RSTD;                                0253 00367000
*            TESTRC = RTNREG;                                      0254 00368000
         LR    TESTRC,RTNREG                                       0254 00369000
*            RESPECIFY RTNREG UNRSTD;                              0255 00370000
*/*          IF USER ALLOWED TO ACCESS VOLUME                        */ 00371000
*            IF (TESTRC = 0) | (TESTRC = 4)                        0256 00372000
*/*            THEN                                                  */ 00373000
*              THEN DO;                                            0256 00374000
*                                                                  0256 00375000
         LTR   TESTRC,TESTRC                                       0256 00376000
         BZ    @RT00256                                            0256 00377000
         CH    TESTRC,@CH00040                                     0256 00378000
         BNE   @RF00256                                            0256 00379000
@RT00256 DS    0H                                                  0257 00380000
*/*              CHANGE_VOLUME_LABEL                                 */ 00381000
*                IF ADDR(OWNER) = NULLPTR                          0258 00382000
*                  THEN DO;    OWNERID = ' '; END;                 0258 00383000
         L     @10,@PC00001+4                                      0258 00384000
         L     @10,FDTPTR+8(,@10)                                  0258 00385000
         LTR   @10,@10                                             0258 00386000
         BNZ   @RF00258                                            0258 00387000
         MVI   OWNERID+1,C' '                                      0260 00388000
         MVC   OWNERID+2(12),OWNERID+1                             0260 00389000
         MVI   OWNERID,C' '                                        0260 00390000
*                  ELSE DO;    OWNERID = OWNERVAL; END;            0262 00391000
         B     @RC00258                                            0262 00392000
@RF00258 DS    0H                                                  0263 00393000
         L     @10,@PC00001+4                                      0263 00394000
         L     @10,FDTPTR+8(,@10)                                  0263 00395000
         MVC   OWNERID(14),OWNERVAL(@10)                           0263 00396000
*                IF ADDR(VOLID) = NULLPTR                          0265 00397000
*                  THEN DO;    VOLSER = ' '; END;                  0265 00398000
@RC00258 L     @10,@PC00001+4                                      0265 00399000
         L     @10,FDTPTR+4(,@10)                                  0265 00400000
         LTR   @10,@10                                             0265 00401000
         BNZ   @RF00265                                            0265 00402000
         MVI   VOLSER+1,C' '                                       0267 00403000
         MVC   VOLSER+2(4),VOLSER+1                                0267 00404000
         MVI   VOLSER,C' '                                         0267 00405000
*                  ELSE DO;    VOLSER = VOLIDVAL; END;             0269 00406000
         B     @RC00265                                            0269 00407000
@RF00265 DS    0H                                                  0270 00408000
         L     @10,@PC00001+4                                      0270 00409000
         L     @10,FDTPTR+4(,@10)                                  0270 00410000
         MVC   VOLSER(6),VOLIDVAL(@10)                             0270 00411000
*                CALL ICKCV01                                      0272 00412000
*                     (GDTTBL                                      0272 00413000
*                     ,VOLIB                                       0272 00414000
*                     ,VOLSER                                      0272 00415000
*                     ,OWNERID                                     0272 00416000
*                     ,VTOCLOC                                     0272 00417000
*                     ,RETCODE);                                   0272 00418000
@RC00265 L     @10,@PC00001                                        0272 00419000
         ST    @10,@AL00001                                        0272 00420000
         LA    @10,VOLIB                                           0272 00421000
         ST    @10,@AL00001+4                                      0272 00422000
         LA    @10,VOLSER                                          0272 00423000
         ST    @10,@AL00001+8                                      0272 00424000
         LA    @10,OWNERID                                         0272 00425000
         ST    @10,@AL00001+12                                     0272 00426000
         LA    @10,@CF00090                                        0272 00427000
         ST    @10,@AL00001+16                                     0272 00428000
         LA    @10,RETCODE                                         0272 00429000
         ST    @10,@AL00001+20                                     0272 00430000
         L     @15,@CV00587                                        0272 00431000
         LA    @01,@AL00001                                        0272 00432000
         BALR  @14,@15                                             0272 00433000
*/*              IF CHANGE OPERATION FAILS                           */ 00434000
*                IF RETCODE = FAILURE                              0273 00435000
*/*                THEN                                              */ 00436000
*                  THEN DO;                                        0273 00437000
*                                                                  0273 00438000
         CLC   RETCODE(4),@CF00161                                 0273 00439000
         BNE   @RF00273                                            0273 00440000
*/*                  ISSUE ERROR MESSAGE (MSGLABB) (UPRINT)          */ 00441000
*                    DARGSENT = MSGLABB;                           0275 00442000
         L     @10,DDSTRU                                          0275 00443000
         MVI   DARGSENT(@10),X'17'                                 0275 00444000
*                    CALL ICKTPPR0 (GDTTBL                         0276 00445000
*                           ,PRTFILE                               0276 00446000
*                           ,DDSTRU);                              0276 00447000
         L     @10,@PC00001                                        0276 00448000
         ST    @10,@AL00001                                        0276 00449000
         LA    @15,@CF00090                                        0276 00450000
         ST    @15,@AL00001+4                                      0276 00451000
         LA    @15,DDSTRU                                          0276 00452000
         ST    @15,@AL00001+8                                      0276 00453000
         MVI   @AL00001+8,X'80'                                    0276 00454000
         L     @15,GDTPRT(,@10)                                    0276 00455000
         LA    @01,@AL00001                                        0276 00456000
         BALR  @14,@15                                             0276 00457000
*/*                  INDICATE A SEVERE ERROR                         */ 00458000
*                    LASTCOND = LASTCC12;                          0277 00459000
         L     @10,@PC00001+8                                      0277 00460000
         MVC   LASTCOND(2,@10),@CH00261                            0277 00461000
*/*                  END-THEN                                        */ 00462000
*                    END;                                          0278 00463000
*/*              END-THEN (USER ALLOWED TO ACCESS VOLUME)            */ 00464000
*                END;                                              0279 00465000
*/*            ELSE (USER NOT ALLOWED TO CHANGE VOLUME LABEL)        */ 00466000
*              ELSE DO;                                            0280 00467000
*                                                                  0280 00468000
         B     @RC00256                                            0280 00469000
@RF00256 DS    0H                                                  0281 00470000
*/*              ISSUE ERROR MESSAGE (MSGVOLAU) (UPRINT)             */ 00471000
*                DARGSENT = MSGVOLAU;                              0281 00472000
         L     @10,DDSTRU                                          0281 00473000
         MVI   DARGSENT(@10),X'1D'                                 0281 00474000
*                CALL ICKTPPR0 (GDTTBL                             0282 00475000
*                       ,PRTFILE                                   0282 00476000
*                       ,DDSTRU);                                  0282 00477000
         L     @10,@PC00001                                        0282 00478000
         ST    @10,@AL00001                                        0282 00479000
         LA    @15,@CF00090                                        0282 00480000
         ST    @15,@AL00001+4                                      0282 00481000
         LA    @15,DDSTRU                                          0282 00482000
         ST    @15,@AL00001+8                                      0282 00483000
         MVI   @AL00001+8,X'80'                                    0282 00484000
         L     @15,GDTPRT(,@10)                                    0282 00485000
         LA    @01,@AL00001                                        0282 00486000
         BALR  @14,@15                                             0282 00487000
*/*              INDICATE SEVERE ERROR (LASTCOND = 12)               */ 00488000
*                LASTCOND = LASTCC12;                              0283 00489000
         L     @10,@PC00001+8                                      0283 00490000
         MVC   LASTCOND(2,@10),@CH00261                            0283 00491000
*/*              END-ELSE                                            */ 00492000
*                END;                                              0284 00493000
*/*          END-THEN                                                */ 00494000
*            END;                                                  0285 00495000
@RC00256 DS    0H                                                  0286 00496000
*/*      END-THEN                                                    */ 00497000
*        END;                                                      0286 00498000
@RF00250 DS    0H                                                  0287 00499000
*/*  IF NO SEVERE ERRORS ENCOUNTERED                                 */ 00500000
*    IF LASTCOND < LASTCC12                                        0287 00501000
*/*    THEN                                                          */ 00502000
*      THEN DO;                                                    0287 00503000
*                                                                  0287 00504000
@RF00248 L     @10,@PC00001+8                                      0287 00505000
         LH    @10,LASTCOND(,@10)                                  0287 00506000
         CH    @10,@CH00261                                        0287 00507000
         BNL   @RF00287                                            0287 00508000
*/*      IF IPL PROGRAM IS SUPPLIED                                  */ 00509000
*        IF ADDR(IPLDD) ^= NULLPTR                                 0289 00510000
*/*        THEN                                                      */ 00511000
*          THEN DO;                                                0289 00512000
*                                                                  0289 00513000
         L     @10,@PC00001+4                                      0289 00514000
         L     @10,FDTPTR+12(,@10)                                 0289 00515000
         LTR   @10,@10                                             0289 00516000
         BZ    @RF00289                                            0289 00517000
*/*          FOR SYSTEMS WITH RACF, CHECK PROPER LEVEL OF            */ 00518000
*/*           AUTHORIZATION                                          */ 00519000
*            CALL ICKSAVC0 (GDTTBL                                 0291 00520000
*                    ,VOL1SER                                      0291 00521000
*                    ,UPDATE);                                     0291 00522000
         L     @10,@PC00001                                        0291 00523000
         ST    @10,@AL00001                                        0291 00524000
         LA    @03,VOL1P                                           0291 00525000
         LA    @03,VOL1SER(,@03)                                   0291 00526000
         ST    @03,@AL00001+4                                      0291 00527000
         LA    @03,@CC00153                                        0291 00528000
         ST    @03,@AL00001+8                                      0291 00529000
         MVI   @AL00001+8,X'80'                                    0291 00530000
         L     @15,GDTVCK(,@10)                                    0291 00531000
         LA    @01,@AL00001                                        0291 00532000
         BALR  @14,@15                                             0291 00533000
*            RESPECIFY RTNREG RSTD;                                0292 00534000
*            TESTRC = RTNREG;                                      0293 00535000
         LR    TESTRC,RTNREG                                       0293 00536000
*            RESPECIFY RTNREG UNRSTD;                              0294 00537000
*/*          IF USER ALLOWED TO ACCESS VOLUME                        */ 00538000
*            IF (TESTRC = 0) | (TESTRC = 4)                        0295 00539000
*/*            THEN                                                  */ 00540000
*              THEN DO;                                            0295 00541000
*                                                                  0295 00542000
         LTR   TESTRC,TESTRC                                       0295 00543000
         BZ    @RT00295                                            0295 00544000
         CH    TESTRC,@CH00040                                     0295 00545000
         BNE   @RF00295                                            0295 00546000
@RT00295 DS    0H                                                  0296 00547000
*/*              WRITE_IPL_RECORDS                                   */ 00548000
*                IF ADDR(PURGE) = NULLPTR                          0297 00549000
*                  THEN DO;    PRGFLG = OFF; END;                  0297 00550000
         L     @10,@PC00001+4                                      0297 00551000
         L     @10,FDTPTR+32(,@10)                                 0297 00552000
         LTR   @10,@10                                             0297 00553000
         BNZ   @RF00297                                            0297 00554000
         NI    PRGFLG,B'01111111'                                  0299 00555000
*                  ELSE DO;    PRGFLG = ON; END;                   0301 00556000
         B     @RC00297                                            0301 00557000
@RF00297 DS    0H                                                  0302 00558000
         OI    PRGFLG,B'10000000'                                  0302 00559000
*/*              IF BOOTSTRAP RECORDS ARE SUPPLIED BY THE USER       */ 00560000
*                IF ADDR (BOOTS) ^= NULLPTR                        0304 00561000
*/*                THEN INDICATE THAT THE BOOTSTRAP RECS ARE SUPPLIED*/ 00562000
*                  THEN DO;    BOOTFLG = BOOTYES; END;             0304 00563000
@RC00297 L     @10,@PC00001+4                                      0304 00564000
         L     @10,FDTPTR+48(,@10)                                 0304 00565000
         LTR   @10,@10                                             0304 00566000
         BZ    @RF00304                                            0304 00567000
         OI    BOOTFLG,B'10000000'                                 0306 00568000
*/*                ELSE INDICATE THAT THEY ARE NOT SUPPLIED          */ 00569000
*                  ELSE DO;    BOOTFLG = BOOTNO; END;              0308 00570000
         B     @RC00304                                            0308 00571000
@RF00304 DS    0H                                                  0309 00572000
         NI    BOOTFLG,B'01111111'                                 0309 00573000
*                CALL ICKWI01                                      0311 00574000
*                     (GDTTBL                                      0311 00575000
*                     ,VOLIB                                       0311 00576000
*                     ,IPLDDVAL                                    0311 00577000
*                     ,PRGFLG                                      0311 00578000
*                     ,BOOTFLG                                     0311 00579000
*                     ,RETCODE);                                   0311 00580000
@RC00304 L     @10,@PC00001                                        0311 00581000
         ST    @10,@AL00001                                        0311 00582000
         LA    @10,VOLIB                                           0311 00583000
         ST    @10,@AL00001+4                                      0311 00584000
         L     @10,@PC00001+4                                      0311 00585000
         L     @10,FDTPTR+12(,@10)                                 0311 00586000
         LA    @10,IPLDDVAL(,@10)                                  0311 00587000
         ST    @10,@AL00001+8                                      0311 00588000
         LA    @10,PRGFLG                                          0311 00589000
         ST    @10,@AL00001+12                                     0311 00590000
         LA    @10,BOOTFLG                                         0311 00591000
         ST    @10,@AL00001+16                                     0311 00592000
         LA    @10,RETCODE                                         0311 00593000
         ST    @10,@AL00001+20                                     0311 00594000
         L     @15,@CV00588                                        0311 00595000
         LA    @01,@AL00001                                        0311 00596000
         BALR  @14,@15                                             0311 00597000
*/*              IF WRITE OPERATION FAILS                            */ 00598000
*                IF RETCODE = FAILURE                              0312 00599000
*/*                THEN                                              */ 00600000
*                  THEN DO;                                        0312 00601000
*                                                                  0312 00602000
         CLC   RETCODE(4),@CF00161                                 0312 00603000
         BNE   @RF00312                                            0312 00604000
*/*                  ISSUE ERROR MESSAGE (MSGIPLA) (UPRINT)          */ 00605000
*                    DARGSENT = MSGIPLA;                           0314 00606000
         L     @10,DDSTRU                                          0314 00607000
         MVI   DARGSENT(@10),X'09'                                 0314 00608000
*                    CALL ICKTPPR0 (GDTTBL                         0315 00609000
*                           ,PRTFILE                               0315 00610000
*                           ,DDSTRU);                              0315 00611000
         L     @10,@PC00001                                        0315 00612000
         ST    @10,@AL00001                                        0315 00613000
         LA    @15,@CF00090                                        0315 00614000
         ST    @15,@AL00001+4                                      0315 00615000
         LA    @15,DDSTRU                                          0315 00616000
         ST    @15,@AL00001+8                                      0315 00617000
         MVI   @AL00001+8,X'80'                                    0315 00618000
         L     @15,GDTPRT(,@10)                                    0315 00619000
         LA    @01,@AL00001                                        0315 00620000
         BALR  @14,@15                                             0315 00621000
*/*                  INDICATE AN ERROR                               */ 00622000
*                    LASTCOND = LASTCC08;                          0316 00623000
         L     @10,@PC00001+8                                      0316 00624000
         MVC   LASTCOND(2,@10),@CH00157                            0316 00625000
*/*                  END-THEN                                        */ 00626000
*                    END;                                          0317 00627000
*/*                ELSE (OPERATION SUCCESSFUL)                       */ 00628000
*                  ELSE DO;                                        0318 00629000
         B     @RC00312                                            0318 00630000
@RF00312 DS    0H                                                  0319 00631000
*/*                  IF USER VOLMES EXISTED AND WERE PURGED          */ 00632000
*                    IF LABELS > 0 & PRGFLG = ON                   0319 00633000
*/*                    THEN CHANGE_VOLUME_LABEL (TO UPDATE COUNT)    */ 00634000
*                      THEN DO;                                    0319 00635000
         L     @10,LABELS                                          0319 00636000
         LTR   @10,@10                                             0319 00637000
         BNP   @RF00319                                            0319 00638000
         TM    PRGFLG,B'10000000'                                  0319 00639000
         BNO   @RF00319                                            0319 00640000
*                        OWNERID = ' ';                            0321 00641000
         MVI   OWNERID+1,C' '                                      0321 00642000
         MVC   OWNERID+2(12),OWNERID+1                             0321 00643000
         MVI   OWNERID,C' '                                        0321 00644000
*                        VOLSER = ' ';                             0322 00645000
         MVI   VOLSER+1,C' '                                       0322 00646000
         MVC   VOLSER+2(4),VOLSER+1                                0322 00647000
         MVI   VOLSER,C' '                                         0322 00648000
*                        CALL ICKCV01                              0323 00649000
*                             (GDTTBL                              0323 00650000
*                             ,VOLIB                               0323 00651000
*                             ,VOLSER                              0323 00652000
*                             ,OWNERID                             0323 00653000
*                             ,VTOCLOC                             0323 00654000
*                             ,RETCODE);                           0323 00655000
         L     @10,@PC00001                                        0323 00656000
         ST    @10,@AL00001                                        0323 00657000
         LA    @10,VOLIB                                           0323 00658000
         ST    @10,@AL00001+4                                      0323 00659000
         LA    @10,VOLSER                                          0323 00660000
         ST    @10,@AL00001+8                                      0323 00661000
         LA    @10,OWNERID                                         0323 00662000
         ST    @10,@AL00001+12                                     0323 00663000
         LA    @10,@CF00090                                        0323 00664000
         ST    @10,@AL00001+16                                     0323 00665000
         LA    @10,RETCODE                                         0323 00666000
         ST    @10,@AL00001+20                                     0323 00667000
         L     @15,@CV00587                                        0323 00668000
         LA    @01,@AL00001                                        0323 00669000
         BALR  @14,@15                                             0323 00670000
*/*                      IF CHANGE OPERATION FAILS                   */ 00671000
*                        IF RETCODE = FAILURE                      0324 00672000
*/*                        THEN                                      */ 00673000
*                          THEN DO;                                0324 00674000
*                                                                  0324 00675000
         CLC   RETCODE(4),@CF00161                                 0324 00676000
         BNE   @RF00324                                            0324 00677000
*/*                          ISSUE ERROR MESSAGE (MSGLABB) (UPRINT)  */ 00678000
*                            DARGSENT = MSGLABB;                   0326 00679000
         L     @10,DDSTRU                                          0326 00680000
         MVI   DARGSENT(@10),X'17'                                 0326 00681000
*                            CALL ICKTPPR0 (GDTTBL                 0327 00682000
*                                   ,PRTFILE                       0327 00683000
*                                   ,DDSTRU);                      0327 00684000
         L     @10,@PC00001                                        0327 00685000
         ST    @10,@AL00001                                        0327 00686000
         LA    @15,@CF00090                                        0327 00687000
         ST    @15,@AL00001+4                                      0327 00688000
         LA    @15,DDSTRU                                          0327 00689000
         ST    @15,@AL00001+8                                      0327 00690000
         MVI   @AL00001+8,X'80'                                    0327 00691000
         L     @15,GDTPRT(,@10)                                    0327 00692000
         LA    @01,@AL00001                                        0327 00693000
         BALR  @14,@15                                             0327 00694000
*/*                          INDICATE A SEVERE ERROR                 */ 00695000
*                            LASTCOND = LASTCC12;                  0328 00696000
         L     @10,@PC00001+8                                      0328 00697000
         MVC   LASTCOND(2,@10),@CH00261                            0328 00698000
*/*                          END-THEN                                */ 00699000
*                            END;                                  0329 00700000
*/*                      END-THEN                                    */ 00701000
*                        END;                                      0330 00702000
*/*                  END-ELSE                                        */ 00703000
*                    END;                                          0331 00704000
*/*              END-THEN (USER ALLOWED ACCESS TO THE VOLUME)        */ 00705000
*                END;                                              0332 00706000
*/*            ELSE (USER NOT ALLOWED TO CHANGE VOLUME LABEL)        */ 00707000
*              ELSE DO;                                            0333 00708000
*                                                                  0333 00709000
         B     @RC00295                                            0333 00710000
@RF00295 DS    0H                                                  0334 00711000
*/*              ISSUE ERROR MESSAGE (MSGIPLAU) (UPRINT)             */ 00712000
*                DARGSENT = MSGIPLAU;                              0334 00713000
         L     @10,DDSTRU                                          0334 00714000
         MVI   DARGSENT(@10),X'1E'                                 0334 00715000
*                CALL ICKTPPR0 (GDTTBL                             0335 00716000
*                       ,PRTFILE                                   0335 00717000
*                       ,DDSTRU);                                  0335 00718000
         L     @10,@PC00001                                        0335 00719000
         ST    @10,@AL00001                                        0335 00720000
         LA    @15,@CF00090                                        0335 00721000
         ST    @15,@AL00001+4                                      0335 00722000
         LA    @15,DDSTRU                                          0335 00723000
         ST    @15,@AL00001+8                                      0335 00724000
         MVI   @AL00001+8,X'80'                                    0335 00725000
         L     @15,GDTPRT(,@10)                                    0335 00726000
         LA    @01,@AL00001                                        0335 00727000
         BALR  @14,@15                                             0335 00728000
*/*              INDICATE SEVERE ERROR (LASTCOND = 12)               */ 00729000
*                LASTCOND = LASTCC12;                              0336 00730000
         L     @10,@PC00001+8                                      0336 00731000
         MVC   LASTCOND(2,@10),@CH00261                            0336 00732000
*/*              END-ELSE                                            */ 00733000
*                END;                                              0337 00734000
*/*          END-THEN                                                */ 00735000
*            END;                                                  0338 00736000
@RC00295 DS    0H                                                  0339 00737000
*/*      END-THEN                                                    */ 00738000
*        END;                                                      0339 00739000
@RF00289 DS    0H                                                  0340 00740000
*/*  CLOSE THE VOLUME (UDEVCLSE)                                     */ 00741000
*    CALL ICKDVCL0 (GDTTBL                                         0340 00742000
*             ,VOLIB                                               0340 00743000
*             ,RETCODE);                                           0340 00744000
@RF00287 L     @10,@PC00001                                        0340 00745000
         ST    @10,@AL00001                                        0340 00746000
         LA    @15,VOLIB                                           0340 00747000
         ST    @15,@AL00001+4                                      0340 00748000
         LA    @15,RETCODE                                         0340 00749000
         ST    @15,@AL00001+8                                      0340 00750000
         L     @15,GDTDVC(,@10)                                    0340 00751000
         LA    @01,@AL00001                                        0340 00752000
         BALR  @14,@15                                             0340 00753000
*/*  IF UNABLE TO CLOSE THE VOLUME                                   */ 00754000
*    IF RETCODE = FAILURE                                          0341 00755000
*/*    THEN                                                          */ 00756000
*      THEN DO;                                                    0341 00757000
*                                                                  0341 00758000
         CLC   RETCODE(4),@CF00161                                 0341 00759000
         BNE   @RF00341                                            0341 00760000
*/*      ISSUE ERROR MESSAGE (MSGCLSEA) (UPRINT)                     */ 00761000
*        DARGSENT = MSGCLSEA;                                      0343 00762000
         L     @10,DDSTRU                                          0343 00763000
         MVI   DARGSENT(@10),X'0B'                                 0343 00764000
*        CALL ICKTPPR0 (GDTTBL                                     0344 00765000
*               ,PRTFILE                                           0344 00766000
*               ,DDSTRU);                                          0344 00767000
         L     @10,@PC00001                                        0344 00768000
         ST    @10,@AL00001                                        0344 00769000
         LA    @15,@CF00090                                        0344 00770000
         ST    @15,@AL00001+4                                      0344 00771000
         LA    @15,DDSTRU                                          0344 00772000
         ST    @15,@AL00001+8                                      0344 00773000
         MVI   @AL00001+8,X'80'                                    0344 00774000
         L     @15,GDTPRT(,@10)                                    0344 00775000
         LA    @01,@AL00001                                        0344 00776000
         BALR  @14,@15                                             0344 00777000
*/*      SET LASTCOND = 8 OR MAXIMUM ENCOUNTERED                     */ 00778000
*        LASTCOND = MAX (LASTCOND,8);                              0345 00779000
         L     @10,@PC00001+8                                      0345 00780000
         LH    @15,LASTCOND(,@10)                                  0345 00781000
         LA    @14,8                                               0345 00782000
         CR    @15,@14                                             0345 00783000
         BNL   *+6                                                      00784000
         LR    @15,@14                                             0345 00785000
         STH   @15,LASTCOND(,@10)                                  0345 00786000
*/*      END-THEN                                                    */ 00787000
*        END;                                                      0346 00788000
*/*  RETURN                                                          */ 00789000
*    DARGSMOD = MSGUNIV;                                           0347 00790000
@RF00341 L     @10,DDSTRU                                          0347 00791000
         MVC   DARGSMOD(3,@10),@CC00539                            0347 00792000
*    IF LASTCOND >= LASTCC12                                       0348 00793000
*      THEN DO;    DARGSENT = MSGUNIVB; END;                       0348 00794000
         L     @15,@PC00001+8                                      0348 00795000
         LH    @15,LASTCOND(,@15)                                  0348 00796000
         CH    @15,@CH00261                                        0348 00797000
         BL    @RF00348                                            0348 00798000
         MVI   DARGSENT(@10),X'03'                                 0350 00799000
*      ELSE DO;    DARGSENT = MSGUNIVA; END;                       0352 00800000
         B     @RC00348                                            0352 00801000
@RF00348 DS    0H                                                  0353 00802000
         L     @10,DDSTRU                                          0353 00803000
         MVI   DARGSENT(@10),X'01'                                 0353 00804000
*    DARGDBP = ADDR (LASTCOND);                                    0355 00805000
@RC00348 L     @10,DDSTRU                                          0355 00806000
         L     @15,@PC00001+8                                      0355 00807000
         ST    @15,DARGDBP(,@10)                                   0355 00808000
*    DARGILP = LENGTH (LASTCOND);                                  0356 00809000
         MVC   DARGILP(2,@10),@CH00112                             0356 00810000
*    CALL ICKTPPR0 (GDTTBL                                         0357 00811000
*           ,PRTFILE                                               0357 00812000
*           ,DDSTRU);                                              0357 00813000
         L     @10,@PC00001                                        0357 00814000
         ST    @10,@AL00001                                        0357 00815000
         LA    @15,@CF00090                                        0357 00816000
         ST    @15,@AL00001+4                                      0357 00817000
         LA    @15,DDSTRU                                          0357 00818000
         ST    @15,@AL00001+8                                      0357 00819000
         MVI   @AL00001+8,X'80'                                    0357 00820000
         L     @15,GDTPRT(,@10)                                    0357 00821000
         LA    @01,@AL00001                                        0357 00822000
         BALR  @14,@15                                             0357 00823000
*    IF GDTDBG = NULLPTR                                           0358 00824000
*      THEN;                                                       0358 00825000
         L     @10,@PC00001                                        0358 00826000
         L     @10,GDTDBG(,@10)                                    0358 00827000
         LTR   @10,@10                                             0358 00828000
         BZ    @RT00358                                            0358 00829000
*      ELSE                                                        0360 00830000
*        CALL ICKDB010 (GDTTBL                                     0360 00831000
*          ,'RF99');                                               0360 00832000
         L     @10,@PC00001                                        0360 00833000
         ST    @10,@AL00001                                        0360 00834000
         LA    @15,@CC00590                                        0360 00835000
         ST    @15,@AL00001+4                                      0360 00836000
         MVI   @AL00001+4,X'80'                                    0360 00837000
         L     @15,GDTDBG(,@10)                                    0360 00838000
         LA    @01,@AL00001                                        0360 00839000
         BALR  @14,@15                                             0360 00840000
*    CALL ICKSAFP0 (GDTTBL                                         0361 00841000
*           ,POOLID);                                              0361 00842000
@RT00358 L     @10,@PC00001                                        0361 00843000
         ST    @10,@AL00001                                        0361 00844000
         LA    @15,POOLID                                          0361 00845000
         ST    @15,@AL00001+4                                      0361 00846000
         MVI   @AL00001+4,X'80'                                    0361 00847000
         L     @15,GDTFPL(,@10)                                    0361 00848000
         LA    @01,@AL00001                                        0361 00849000
         BALR  @14,@15                                             0361 00850000
*     CALL ICKSAEP0(GDTTBL,MODID);                                 0362 00851000
*                                                                  0362 00852000
         L     @10,@PC00001                                        0362 00853000
         ST    @10,@AL00001                                        0362 00854000
         LA    @15,MODID                                           0362 00855000
         ST    @15,@AL00001+4                                      0362 00856000
         MVI   @AL00001+4,X'80'                                    0362 00857000
         L     @15,GDTEPL(,@10)                                    0362 00858000
         LA    @01,@AL00001                                        0362 00859000
         BALR  @14,@15                                             0362 00860000
         EJECT                                                          00861000
*/*****  START OF SPECIFICATIONS  ************************************/ 00862000
*/*                                                                  */ 00863000
*/*  SUB-PROCEDURE NAME:  OPENVOL                                    */ 00864000
*/*                                                                  */ 00865000
*/*  DESCRIPTIVE NAME:  ISSUE OPEN VOLUME                            */ 00866000
*/*                                                                  */ 00867000
*/*  FUNCTION:                                                       */ 00868000
*/*                                                                  */ 00869000
*/*    THIS SUBPROCEDURE INVOKES THE DEVICE ADAPTER MODULE THAT      */ 00870000
*/*    OPENS THE VOLUME FOR SUBSEQUENT PROCESSING. IT ALSO ENSURES   */ 00871000
*/*    THAT THE VOLUME IS MOUNTED PRIVATE WHEN THE VOLUME IS ON-LINE.*/ 00872000
*/*                                                                  */ 00873000
*/*****  END OF SPECIFICATIONS  **************************************/ 00874000
*                                                                  0363 00875000
*                                                                  0363 00876000
*/*  SUB-PROCEDURE ISSUE_OPEN_VOLUME                                 */ 00877000
*    OPENVOL:                                                      0363 00878000
*      PROCEDURE;                                                  0363 00879000
@EL00001 L     @13,4(,@13)                                         0363 00880000
@EF00001 L     @00,@SIZDATD                                        0363 00881000
         LR    @01,@11                                             0363 00882000
         FREEMAIN R,LV=(0),A=(1)                                        00883000
@ER00001 LM    @14,@12,12(@13)                                     0363 00884000
         BR    @14                                                 0363 00885000
OPENVOL  STM   @14,@12,@SA00002                                    0363 00886000
*    OLDERID2 = NEWERID2;                                          0364 00887000
         L     @10,@PC00001                                        0364 00888000
         L     @10,GDTTR2(,@10)                                    0364 00889000
         MVC   @TS00001(95),NEWERID2(@10)                          0364 00890000
         MVC   OLDERID2(95,@10),@TS00001                           0364 00891000
*    NEWID2 =  'RFOP';                                             0365 00892000
         MVC   NEWID2(4,@10),@CC00594                              0365 00893000
*/*  OPEN THE VOLUME FOR PROCESSING (UDEVOPEN)                       */ 00894000
*/*  SET UP MSS PARAMETER AS A BLANK FIELD SINCE THIS COMMAND DOES   */ 00895000
*/*   NOT SUPPORT MSS                                                */ 00896000
*    MSSDEV = ' ';                                                 0366 00897000
         MVI   MSSDEV+1,C' '                                       0366 00898000
         MVC   MSSDEV+2(6),MSSDEV+1                                0366 00899000
         MVI   MSSDEV,C' '                                         0366 00900000
*/*  SET UP THE CUU OR DD-NAME PARAMETER                             */ 00901000
*    IF (ADDR(DEVIC) ^= NULLPTR) & (ADDR(DNAME) = NULLPTR)         0367 00902000
*      THEN DO;                                                    0367 00903000
*                                                                  0367 00904000
         SLR   @10,@10                                             0367 00905000
         L     @15,@PC00001+4                                      0367 00906000
         L     @14,FDTPTR(,@15)                                    0367 00907000
         CR    @14,@10                                             0367 00908000
         BE    @RF00367                                            0367 00909000
         C     @10,FDTPTR+40(,@15)                                 0367 00910000
         BNE   @RF00367                                            0367 00911000
*        VIBNAME = DEVICVAL;                                       0369 00912000
         MVI   VIBNAME+3,C' '                                      0369 00913000
         MVC   VIBNAME+4(4),VIBNAME+3                              0369 00914000
         MVC   VIBNAME(3),DEVICVAL(@14)                            0369 00915000
*        VIBTYPE = CUUVAL;                                         0370 00916000
         ST    @10,VIBTYPE                                         0370 00917000
*        END;                                                      0371 00918000
*      ELSE DO;                                                    0372 00919000
*                                                                  0372 00920000
         B     @RC00367                                            0372 00921000
@RF00367 DS    0H                                                  0373 00922000
*        VIBNAME = DNAMEVAL;                                       0373 00923000
         L     @10,@PC00001+4                                      0373 00924000
         L     @10,FDTPTR+40(,@10)                                 0373 00925000
         MVC   VIBNAME(8),DNAMEVAL(@10)                            0373 00926000
*        VIBTYPE = DDNVAL;                                         0374 00927000
         MVC   VIBTYPE(4),@CF00161                                 0374 00928000
*        END;                                                      0375 00929000
*/*  IF DEVICETYPE IS SUPPLIED                                       */ 00930000
*    IF ADDR (DEVTY) ^= NULLPTR                                    0376 00931000
*/*    THEN PASS THE DEVICE TYPE                                     */ 00932000
*      THEN DO;    DEVTYPE = DEVTYVAL; END;                        0376 00933000
@RC00367 L     @10,@PC00001+4                                      0376 00934000
         L     @10,FDTPTR+44(,@10)                                 0376 00935000
         LTR   @10,@10                                             0376 00936000
         BZ    @RF00376                                            0376 00937000
         MVC   DEVTYPE(8),DEVTYVAL(@10)                            0378 00938000
*/*    ELSE INDICATE NO DEVICE TYPE SUPPLIED                         */ 00939000
*      ELSE DO;    DEVTYPE = ' '; END;                             0380 00940000
         B     @RC00376                                            0380 00941000
@RF00376 DS    0H                                                  0381 00942000
         MVI   DEVTYPE+1,C' '                                      0381 00943000
         MVC   DEVTYPE+2(6),DEVTYPE+1                              0381 00944000
         MVI   DEVTYPE,C' '                                        0381 00945000
*    CALL ICKDVON0 (GDTTBL                                         0383 00946000
*             ,VIBNAME                                             0383 00947000
*             ,VIBTYPE                                             0383 00948000
*             ,DEVTYPE                                             0383 00949000
*             ,MSSDEV                                              0383 00950000
*             ,VOLIB                                               0383 00951000
*             ,RETCODE);                                           0383 00952000
@RC00376 L     @10,@PC00001                                        0383 00953000
         ST    @10,@AL00001                                        0383 00954000
         LA    @15,VIBNAME                                         0383 00955000
         ST    @15,@AL00001+4                                      0383 00956000
         LA    @15,VIBTYPE                                         0383 00957000
         ST    @15,@AL00001+8                                      0383 00958000
         LA    @15,DEVTYPE                                         0383 00959000
         ST    @15,@AL00001+12                                     0383 00960000
         LA    @15,MSSDEV                                          0383 00961000
         ST    @15,@AL00001+16                                     0383 00962000
         LA    @15,VOLIB                                           0383 00963000
         ST    @15,@AL00001+20                                     0383 00964000
         LA    @15,RETCODE                                         0383 00965000
         ST    @15,@AL00001+24                                     0383 00966000
         L     @15,GDTDVO(,@10)                                    0383 00967000
         LA    @01,@AL00001                                        0383 00968000
         BALR  @14,@15                                             0383 00969000
*/*  IF CUU OR DD-NAME IS INVALID                                    */ 00970000
*    IF RETCODE = INVALCUU                                         0384 00971000
*/*    THEN                                                          */ 00972000
*      THEN DO;                                                    0384 00973000
*                                                                  0384 00974000
         CLC   RETCODE(4),@CF00161                                 0384 00975000
         BNE   @RF00384                                            0384 00976000
*/*      ISSUE ERROR MESSAGE (MSGINCUU) (UPRINT)                     */ 00977000
*        DARGSENT = MSGINCUU;                                      0386 00978000
         L     @10,DDSTRU                                          0386 00979000
         MVI   DARGSENT(@10),X'18'                                 0386 00980000
*        CALL ICKTPPR0 (GDTTBL                                     0387 00981000
*               ,PRTFILE                                           0387 00982000
*               ,DDSTRU);                                          0387 00983000
         L     @10,@PC00001                                        0387 00984000
         ST    @10,@AL00001                                        0387 00985000
         LA    @15,@CF00090                                        0387 00986000
         ST    @15,@AL00001+4                                      0387 00987000
         LA    @15,DDSTRU                                          0387 00988000
         ST    @15,@AL00001+8                                      0387 00989000
         MVI   @AL00001+8,X'80'                                    0387 00990000
         L     @15,GDTPRT(,@10)                                    0387 00991000
         LA    @01,@AL00001                                        0387 00992000
         BALR  @14,@15                                             0387 00993000
*/*      INDICATE SEVERE ERROR (LASTCOND = 12)                       */ 00994000
*        LASTCOND = LASTCC12;                                      0388 00995000
         L     @10,@PC00001+8                                      0388 00996000
         MVC   LASTCOND(2,@10),@CH00261                            0388 00997000
*/*      END-THEN                                                    */ 00998000
*        END;                                                      0389 00999000
*/*  IF NO ERRORS FOUND SO FAR                                       */ 01000000
*    IF LASTCOND < LASTCC12                                        0390 01001000
*/*    THEN                                                          */ 01002000
*      THEN DO;                                                    0390 01003000
*                                                                  0390 01004000
@RF00384 L     @10,@PC00001+8                                      0390 01005000
         LH    @10,LASTCOND(,@10)                                  0390 01006000
         CH    @10,@CH00261                                        0390 01007000
         BNL   @RF00390                                            0390 01008000
*/*      IF UNABLE TO OPEN VOLUME                                    */ 01009000
*        IF RETCODE = NOOPEN                                       0392 01010000
*/*        THEN                                                      */ 01011000
*          THEN DO;                                                0392 01012000
*                                                                  0392 01013000
         CLC   RETCODE(4),@CF00112                                 0392 01014000
         BNE   @RF00392                                            0392 01015000
*/*          ISSUE ERROR MESSAGE (MSGNOPEN) (UPRINT)                 */ 01016000
*            DARGSENT = MSGNOPEN;                                  0394 01017000
         L     @10,DDSTRU                                          0394 01018000
         MVI   DARGSENT(@10),X'19'                                 0394 01019000
*            CALL ICKTPPR0 (GDTTBL                                 0395 01020000
*                   ,PRTFILE                                       0395 01021000
*                   ,DDSTRU);                                      0395 01022000
         L     @10,@PC00001                                        0395 01023000
         ST    @10,@AL00001                                        0395 01024000
         LA    @15,@CF00090                                        0395 01025000
         ST    @15,@AL00001+4                                      0395 01026000
         LA    @15,DDSTRU                                          0395 01027000
         ST    @15,@AL00001+8                                      0395 01028000
         MVI   @AL00001+8,X'80'                                    0395 01029000
         L     @15,GDTPRT(,@10)                                    0395 01030000
         LA    @01,@AL00001                                        0395 01031000
         BALR  @14,@15                                             0395 01032000
*/*          INDICATE SEVERE ERROR (LASTCOND = 12)                   */ 01033000
*            LASTCOND = LASTCC12;                                  0396 01034000
         L     @10,@PC00001+8                                      0396 01035000
         MVC   LASTCOND(2,@10),@CH00261                            0396 01036000
*/*          END-THEN                                                */ 01037000
*            END;                                                  0397 01038000
*/*      END-THEN                                                    */ 01039000
*        END;                                                      0398 01040000
@RF00392 DS    0H                                                  0399 01041000
*/*  IF NO ERRORS FOUND SO FAR                                       */ 01042000
*    IF LASTCOND < LASTCC12                                        0399 01043000
*/*    THEN                                                          */ 01044000
*      THEN DO;                                                    0399 01045000
*                                                                  0399 01046000
@RF00390 L     @10,@PC00001+8                                      0399 01047000
         LH    @10,LASTCOND(,@10)                                  0399 01048000
         CH    @10,@CH00261                                        0399 01049000
         BNL   @RF00399                                            0399 01050000
*/*      IF CUU WAS SPECIFIED FOR AN ON-LINE VOLUME                  */ 01051000
*        IF RETCODE = RCCUUONL                                     0401 01052000
*/*        THEN                                                      */ 01053000
*          THEN DO;                                                0401 01054000
*                                                                  0401 01055000
         CLC   RETCODE(4),@CF00132                                 0401 01056000
         BNE   @RF00401                                            0401 01057000
*/*          ISSUE AN ERROR MESSAGE (MSGLINE)                        */ 01058000
*            DARGSENT = MSGLINE;                                   0403 01059000
         L     @10,DDSTRU                                          0403 01060000
         MVI   DARGSENT(@10),X'31'                                 0403 01061000
*            CALL ICKTPPR0 (GDTTBL                                 0404 01062000
*                   ,PRTFILE                                       0404 01063000
*                   ,DDSTRU);                                      0404 01064000
         L     @10,@PC00001                                        0404 01065000
         ST    @10,@AL00001                                        0404 01066000
         LA    @15,@CF00090                                        0404 01067000
         ST    @15,@AL00001+4                                      0404 01068000
         LA    @15,DDSTRU                                          0404 01069000
         ST    @15,@AL00001+8                                      0404 01070000
         MVI   @AL00001+8,X'80'                                    0404 01071000
         L     @15,GDTPRT(,@10)                                    0404 01072000
         LA    @01,@AL00001                                        0404 01073000
         BALR  @14,@15                                             0404 01074000
*/*          INDICATE A SEVERE ERROR                                 */ 01075000
*            LASTCOND = LASTCC12;                                  0405 01076000
         L     @10,@PC00001+8                                      0405 01077000
         MVC   LASTCOND(2,@10),@CH00261                            0405 01078000
*/*          END-THEN                                                */ 01079000
*            END;                                                  0406 01080000
*/*      END-THEN                                                    */ 01081000
*        END;                                                      0407 01082000
@RF00401 DS    0H                                                  0408 01083000
*/*  IF NO ERRORS FOUND SO FAR                                       */ 01084000
*    IF LASTCOND < LASTCC12                                        0408 01085000
*/*    THEN                                                          */ 01086000
*      THEN DO;                                                    0408 01087000
*                                                                  0408 01088000
@RF00399 L     @10,@PC00001+8                                      0408 01089000
         LH    @10,LASTCOND(,@10)                                  0408 01090000
         CH    @10,@CH00261                                        0408 01091000
         BNL   @RF00408                                            0408 01092000
*/*      IF SUCCESSFUL IN OPENING THE VOLUME                         */ 01093000
*        IF RETCODE = SUCCESS                                      0410 01094000
*/*        THEN                                                      */ 01095000
*          THEN DO;                                                0410 01096000
*                                                                  0410 01097000
         L     @10,RETCODE                                         0410 01098000
         LTR   @10,@10                                             0410 01099000
         BNZ   @RF00410                                            0410 01100000
*/*          OBTAIN INFORMATION ABOUT TYPE OF MOUNTING (UDEVINFO)    */ 01101000
*            CALL ICKDVIN0 (GDTTBL                                 0412 01102000
*                     ,VOLIB                                       0412 01103000
*                     ,VOLPRVOL                                    0412 01104000
*                     ,POOLID                                      0412 01105000
*                     ,VIBPTR                                      0412 01106000
*                     ,VIBLEN                                      0412 01107000
*                     ,RETCODE);                                   0412 01108000
         L     @10,@PC00001                                        0412 01109000
         ST    @10,@AL00001                                        0412 01110000
         LA    @15,VOLIB                                           0412 01111000
         ST    @15,@AL00001+4                                      0412 01112000
         LA    @15,@CF00157                                        0412 01113000
         ST    @15,@AL00001+8                                      0412 01114000
         LA    @15,POOLID                                          0412 01115000
         ST    @15,@AL00001+12                                     0412 01116000
         LA    @15,VIBPTR                                          0412 01117000
         ST    @15,@AL00001+16                                     0412 01118000
         LA    @15,VIBLEN                                          0412 01119000
         ST    @15,@AL00001+20                                     0412 01120000
         LA    @15,RETCODE                                         0412 01121000
         ST    @15,@AL00001+24                                     0412 01122000
         L     @15,GDTDIN(,@10)                                    0412 01123000
         LA    @01,@AL00001                                        0412 01124000
         BALR  @14,@15                                             0412 01125000
*/*          IF THE VOLUME IS NOT MOUNTED PRIVATE AND DD-NAME        */ 01126000
*/*           IS SPECIFIED                                           */ 01127000
*            IF VIBPFLAG = OFF & VIBTYPE = DDNVAL                  0413 01128000
*/*            THEN                                                  */ 01129000
*              THEN DO;                                            0413 01130000
*                                                                  0413 01131000
         L     @10,VIBPTR                                          0413 01132000
         TM    VIBPFLAG(@10),B'10000000'                           0413 01133000
         BNZ   @RF00413                                            0413 01134000
         CLC   VIBTYPE(4),@CF00161                                 0413 01135000
         BNE   @RF00413                                            0413 01136000
*/*              ISSUE ERROR MESSAGE (MSGNPRIV) (UPRINT)             */ 01137000
*                DARGSENT = MSGNPRIV;                              0415 01138000
         L     @10,DDSTRU                                          0415 01139000
         MVI   DARGSENT(@10),X'1A'                                 0415 01140000
*                CALL ICKTPPR0 (GDTTBL                             0416 01141000
*                       ,PRTFILE                                   0416 01142000
*                       ,DDSTRU);                                  0416 01143000
         L     @10,@PC00001                                        0416 01144000
         ST    @10,@AL00001                                        0416 01145000
         LA    @15,@CF00090                                        0416 01146000
         ST    @15,@AL00001+4                                      0416 01147000
         LA    @15,DDSTRU                                          0416 01148000
         ST    @15,@AL00001+8                                      0416 01149000
         MVI   @AL00001+8,X'80'                                    0416 01150000
         L     @15,GDTPRT(,@10)                                    0416 01151000
         LA    @01,@AL00001                                        0416 01152000
         BALR  @14,@15                                             0416 01153000
*/*              INDICATE SEVERE ERROR (LASTCOND = 12)               */ 01154000
*                LASTCOND = LASTCC12;                              0417 01155000
         L     @10,@PC00001+8                                      0417 01156000
         MVC   LASTCOND(2,@10),@CH00261                            0417 01157000
*/*              END-THEN                                            */ 01158000
*                END;                                              0418 01159000
*/*          END-THEN (OPEN WAS SUCCESSFUL)                          */ 01160000
*            END;                                                  0419 01161000
*/*      END-THEN                                                    */ 01162000
*        END;                                                      0420 01163000
*/*  END-SUB-PROCEDURE ISSUE_OPEN_VOLUME                             */ 01164000
*    END OPENVOL;                                                  0421 01165000
*                                                                  0421 01166000
@EL00002 DS    0H                                                  0421 01167000
@EF00002 DS    0H                                                  0421 01168000
@ER00002 LM    @14,@12,@SA00002                                    0421 01169000
         BR    @14                                                 0421 01170000
*    END ICKRF01                                                   0422 01171000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01172000
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        * 01173000
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        * 01174000
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        * 01175000
*/*%INCLUDE SYSLIB  (DMSDF08 )                                        * 01176000
*/*%INCLUDE SYSLIB  (ICKCSRF )                                        * 01177000
*;                                                                 0422 01178000
@DATA    DS    0H                                                       01179000
@CH00040 DC    H'4'                                                     01180000
@CH00261 DC    H'12'                                                    01181000
@DATD    DSECT                                                          01182000
         DS    0F                                                       01183000
@SA00001 DS    18F                                                      01184000
@PC00001 DS    3F                                                       01185000
@SA00002 DS    15F                                                      01186000
@AL00001 DS    7A                                                       01187000
@ZTEMPS  DS    C                                                        01188000
@ZTEMPND EQU   *                                                        01189000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         01190000
ICKRF01  CSECT                                                          01191000
         DS    0F                                                       01192000
@CF00090 DC    F'0'                                                     01193000
@CF00161 DC    F'1'                                                     01194000
@CF00112 DC    F'2'                                                     01195000
@CH00112 EQU   @CF00112+2                                               01196000
@CF00132 DC    F'3'                                                     01197000
@CF00157 DC    F'8'                                                     01198000
@CH00157 EQU   @CF00157+2                                               01199000
@CF00256 DC    F'9'                                                     01200000
@DATD    DSECT                                                          01201000
         DS    0D                                                       01202000
LISTSCAN DS    A                                                        01203000
IOCSPTR  DS    A                                                        01204000
OPNPTR   DS    A                                                        01205000
DDSTRU   DS    A                                                        01206000
FSADDR   DS    A                                                        01207000
DMPINDEX DS    A                                                        01208000
RETCODE  DS    F                                                        01209000
VIBPTR   DS    A                                                        01210000
VIBLEN   DS    F                                                        01211000
VOLIB    DS    A                                                        01212000
LABELS   DS    F                                                        01213000
VIBTYPE  DS    F                                                        01214000
LISTPTR  DS    A                                                        01215000
SETRC    DS    H                                                        01216000
LISTLN   DS    FL1                                                      01217000
@TS00001 DS    CL95                                                     01218000
         DS    CL2                                                      01219000
PRTSTR   DS    CL24                                                     01220000
         ORG   PRTSTR                                                   01221000
PRTHDR   DS    CL4                                                      01222000
PRTARGS  DS    CL20                                                     01223000
         ORG   PRTSTR+24                                                01224000
PRGFLG   DS    BL1                                                      01225000
BOOTFLG  DS    BL1                                                      01226000
VOLSER   DS    CL6                                                      01227000
OWNERID  DS    CL14                                                     01228000
VALVOWN  DS    CL14                                                     01229000
VOL1P    DS    CL80                                                     01230000
MSSDEV   DS    CL8                                                      01231000
VIBNAME  DS    CL8                                                      01232000
DEVTYPE  DS    CL8                                                      01233000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01234000
@ENDDATD EQU   *                                                        01235000
ICKRF01  CSECT                                                          01236000
         DS    0F                                                       01237000
@SIZDATD DC    AL1(0)                                                   01238000
         DC    AL3(@ENDDATD-@DATD)                                      01239000
@CV00581 DC    V(ICKVA01)                                               01240000
@CV00583 DC    V(ICKVV01)                                               01241000
@CV00584 DC    V(ICKRL01)                                               01242000
@CV00587 DC    V(ICKCV01)                                               01243000
@CV00588 DC    V(ICKWI01)                                               01244000
         DS    0D                                                       01245000
@CC00577 DC    C'DARGLIST'                                              01246000
@CC00151 DC    C'ALTR'                                                  01247000
@CC00153 DC    C'UPDT'                                                  01248000
@CC00576 DC    C'RF00'                                                  01249000
@CC00590 DC    C'RF99'                                                  01250000
@CC00594 DC    C'RFOP'                                                  01251000
@CC00525 DC    C'CC0'                                                   01252000
@CC00539 DC    C'UV0'                                                   01253000
MODID    DC    CL4'RF01'                                                01254000
POOLID   DC    CL4'RF01'                                                01255000
PTCHRF01 DS    CL512                                                    01256000
         ORG   PTCHRF01                                                 01257000
@NM00020 DC    256X'00'                                                 01258000
@NM00021 DC    256X'00'                                                 01259000
         ORG   PTCHRF01+512                                             01260000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01261000
@01      EQU   01                                                       01262000
@02      EQU   02                                                       01263000
@03      EQU   03                                                       01264000
@04      EQU   04                                                       01265000
@05      EQU   05                                                       01266000
@06      EQU   06                                                       01267000
@07      EQU   07                                                       01268000
@08      EQU   08                                                       01269000
@09      EQU   09                                                       01270000
@10      EQU   10                                                       01271000
@11      EQU   11                                                       01272000
@12      EQU   12                                                       01273000
@13      EQU   13                                                       01274000
@14      EQU   14                                                       01275000
@15      EQU   15                                                       01276000
TESTRC   EQU   @02                                                      01277000
REG12    EQU   @12                                                      01278000
RTNREG   EQU   @15                                                      01279000
REG0     EQU   @00                                                      01280000
REG1     EQU   @01                                                      01281000
REG10    EQU   @10                                                      01282000
REG11    EQU   @11                                                      01283000
REG13    EQU   @13                                                      01284000
REG14    EQU   @14                                                      01285000
REG15    EQU   @15                                                      01286000
REG2     EQU   @02                                                      01287000
REG3     EQU   @03                                                      01288000
REG4     EQU   @04                                                      01289000
REG5     EQU   @05                                                      01290000
REG6     EQU   @06                                                      01291000
REG7     EQU   @07                                                      01292000
REG8     EQU   @08                                                      01293000
REG9     EQU   @09                                                      01294000
ICKSAEP0 EQU   0                                                        01295000
ICKSAFP0 EQU   0                                                        01296000
ICKSAVC0 EQU   0                                                        01297000
TRACE1   EQU   0                                                        01298000
OLDERID1 EQU   TRACE1                                                   01299000
TRACE2   EQU   0                                                        01300000
OLDERID2 EQU   TRACE2                                                   01301000
NEWID2   EQU   TRACE2+95                                                01302000
NEWERID2 EQU   5                                                        01303000
STAEPARM EQU   0                                                        01304000
STAEPFX  EQU   STAEPARM                                                 01305000
IOCSTR   EQU   0                                                        01306000
IOCDSO   EQU   IOCSTR+13                                                01307000
IOCRFM   EQU   IOCSTR+14                                                01308000
IOCMAC   EQU   IOCSTR+15                                                01309000
IOCMSG   EQU   IOCSTR+16                                                01310000
OPNAGL   EQU   0                                                        01311000
OPNOPT   EQU   OPNAGL                                                   01312000
OPNRFM   EQU   OPNAGL+1                                                 01313000
OPNTYP   EQU   OPNAGL+2                                                 01314000
OPNMOD   EQU   OPNAGL+3                                                 01315000
UVOLLIST EQU   0                                                        01316000
UVOLENT  EQU   UVOLLIST+2                                               01317000
ICKDVON0 EQU   0                                                        01318000
ICKDVIN0 EQU   0                                                        01319000
ICKDVCL0 EQU   0                                                        01320000
ICKTPPR0 EQU   0                                                        01321000
DARGLIST EQU   0                                                        01322000
DARGDBP  EQU   DARGLIST                                                 01323000
DARGSTID EQU   DARGLIST+8                                               01324000
DARGSMOD EQU   DARGSTID                                                 01325000
DARGSENT EQU   DARGSTID+3                                               01326000
DARGILP  EQU   DARGLIST+12                                              01327000
DARGARY  EQU   DARGLIST+20                                              01328000
DARGINS  EQU   DARGARY                                                  01329000
DARGINL  EQU   DARGARY+2                                                01330000
FMTLIST  EQU   0                                                        01331000
FMTFLGS  EQU   FMTLIST                                                  01332000
FMTSPF   EQU   FMTLIST+2                                                01333000
FMTRFNO  EQU   FMTSPF                                                   01334000
FMTILEN  EQU   FMTRFNO                                                  01335000
FMTIOFF  EQU   FMTLIST+4                                                01336000
FMTTRBC  EQU   FMTIOFF                                                  01337000
FMTSTO   EQU   FMTTRBC                                                  01338000
FMTOCOL  EQU   FMTLIST+6                                                01339000
FMTCNVF  EQU   FMTLIST+10                                               01340000
ICKDB010 EQU   0                                                        01341000
DMPITM   EQU   0                                                        01342000
DMPARY   EQU   0                                                        01343000
VOL1     EQU   0                                                        01344000
VOL1SER  EQU   VOL1+4                                                   01345000
VOL1OWNR EQU   VOL1+37                                                  01346000
DEVIC    EQU   0                                                        01347000
DEVICVAL EQU   DEVIC+1                                                  01348000
VOLID    EQU   0                                                        01349000
VOLIDVAL EQU   VOLID+1                                                  01350000
OWNER    EQU   0                                                        01351000
OWNERVAL EQU   OWNER+1                                                  01352000
IPLDD    EQU   0                                                        01353000
IPLDDVAL EQU   IPLDD+1                                                  01354000
VERFY    EQU   0                                                        01355000
VSER     EQU   0                                                        01356000
VSERVAL  EQU   VSER+1                                                   01357000
VOWN     EQU   0                                                        01358000
VOWNVAL  EQU   VOWN+1                                                   01359000
PURGE    EQU   0                                                        01360000
DNAME    EQU   0                                                        01361000
DNAMEVAL EQU   DNAME+1                                                  01362000
DEVTY    EQU   0                                                        01363000
DEVTYVAL EQU   DEVTY+1                                                  01364000
BOOTS    EQU   0                                                        01365000
VIBFLAG  EQU   0                                                        01366000
VIBPFLAG EQU   0                                                        01367000
DMPTRM   EQU   0                                                        01368000
ICKDVOP0 EQU   0                                                        01369000
ICKIOCL0 EQU   0                                                        01370000
ICKIOGT0 EQU   0                                                        01371000
ICKIOIT0 EQU   0                                                        01372000
ICKIOOP0 EQU   0                                                        01373000
ICKIOPT0 EQU   0                                                        01374000
ICKIOTM0 EQU   0                                                        01375000
ICKSACL0 EQU   0                                                        01376000
ICKSADE0 EQU   0                                                        01377000
ICKSAFS0 EQU   0                                                        01378000
ICKSAGP0 EQU   0                                                        01379000
ICKSAGS0 EQU   0                                                        01380000
ICKSALD0 EQU   0                                                        01381000
ICKSAPR0 EQU   0                                                        01382000
ICKSASC0 EQU   0                                                        01383000
ICKSASN0 EQU   0                                                        01384000
ICKSAST0 EQU   0                                                        01385000
ICKSATI0 EQU   0                                                        01386000
ICKSAWO0 EQU   0                                                        01387000
ICKTPEA0 EQU   0                                                        01388000
ICKTPES0 EQU   0                                                        01389000
ICKTPRE0 EQU   0                                                        01390000
ICKTPRS0 EQU   0                                                        01391000
LISTTEST EQU   0                                                        01392000
NEWERID1 EQU   5                                                        01393000
NOBTS    EQU   0                                                        01394000
NOPRG    EQU   0                                                        01395000
NOVER    EQU   0                                                        01396000
GDTTBL   EQU   0                                                        01397000
GDTTR1   EQU   GDTTBL+8                                                 01398000
GDTTR2   EQU   GDTTBL+12                                                01399000
GDTDIN   EQU   GDTTBL+44                                                01400000
GDTDOP   EQU   GDTTBL+48                                                01401000
GDTDBG   EQU   GDTTBL+52                                                01402000
GDTDVO   EQU   GDTTBL+56                                                01403000
GDTPRT   EQU   GDTTBL+60                                                01404000
GDTESS   EQU   GDTTBL+64                                                01405000
GDTESA   EQU   GDTTBL+68                                                01406000
GDTRST   EQU   GDTTBL+72                                                01407000
GDTRES   EQU   GDTTBL+76                                                01408000
GDTCAL   EQU   GDTTBL+80                                                01409000
GDTGSP   EQU   GDTTBL+84                                                01410000
GDTFSP   EQU   GDTTBL+88                                                01411000
GDTGPL   EQU   GDTTBL+92                                                01412000
GDTFPL   EQU   GDTTBL+96                                                01413000
GDTLOD   EQU   GDTTBL+100                                               01414000
GDTDEL   EQU   GDTTBL+104                                               01415000
GDTPRL   EQU   GDTTBL+108                                               01416000
GDTEPL   EQU   GDTTBL+112                                               01417000
GDTTIM   EQU   GDTTBL+116                                               01418000
GDTIIO   EQU   GDTTBL+120                                               01419000
GDTTIO   EQU   GDTTBL+124                                               01420000
GDTOPN   EQU   GDTTBL+136                                               01421000
GDTCLS   EQU   GDTTBL+140                                               01422000
GDTGET   EQU   GDTTBL+144                                               01423000
GDTPUT   EQU   GDTTBL+148                                               01424000
GDTSNP   EQU   GDTTBL+160                                               01425000
GDTWTO   EQU   GDTTBL+168                                               01426000
GDTSCR   EQU   GDTTBL+172                                               01427000
GDTVCK   EQU   GDTTBL+176                                               01428000
GDTDVC   EQU   GDTTBL+180                                               01429000
GDTSTE   EQU   GDTTBL+188                                               01430000
FDTTBL   EQU   0                                                        01431000
FDTPTR   EQU   FDTTBL+8                                                 01432000
LASTCOND EQU   0                                                        01433000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01434000
FDTVERB  EQU   FDTTBL                                                   01435000
GDTCVR   EQU   GDTTBL+184                                               01436000
GDTSPR   EQU   GDTTBL+164                                               01437000
GDTABH   EQU   GDTTBL+156                                               01438000
GDTABT   EQU   GDTTBL+152                                               01439000
GDTTOH   EQU   GDTTBL+132                                               01440000
GDTRIP   EQU   GDTTBL+128                                               01441000
GDTDVH   EQU   GDTTBL+40                                                01442000
GDTIOH   EQU   GDTTBL+36                                                01443000
GDTSAH   EQU   GDTTBL+32                                                01444000
GDTTPH   EQU   GDTTBL+28                                                01445000
GDTRIH   EQU   GDTTBL+24                                                01446000
GDTSTH   EQU   GDTTBL+20                                                01447000
GDTDBH   EQU   GDTTBL+16                                                01448000
GDTPRM   EQU   GDTTBL+4                                                 01449000
GDTHDR   EQU   GDTTBL                                                   01450000
DEVTYLEN EQU   DEVTY                                                    01451000
DNAMELEN EQU   DNAME                                                    01452000
VOWNLEN  EQU   VOWN                                                     01453000
VSERLEN  EQU   VSER                                                     01454000
IPLDDLEN EQU   IPLDD                                                    01455000
OWNERLEN EQU   OWNER                                                    01456000
VOLIDLEN EQU   VOLID                                                    01457000
DEVICLEN EQU   DEVIC                                                    01458000
VOL1STDV EQU   VOL1+79                                                  01459000
@NM00019 EQU   VOL1+51                                                  01460000
VOL1OLDO EQU   VOL1OWNR+4                                               01461000
VOL1OEXT EQU   VOL1OWNR                                                 01462000
@NM00018 EQU   VOL1+16                                                  01463000
VOL1VTOC EQU   VOL1+11                                                  01464000
VOL1ACC  EQU   VOL1+10                                                  01465000
VOL1NUM  EQU   VOL1+3                                                   01466000
VOL1ID   EQU   VOL1                                                     01467000
@NM00017 EQU   DMPARY+15                                                01468000
DMPARYTP EQU   DMPARY+14                                                01469000
DMPARYEX EQU   DMPARY+12                                                01470000
DMPARYIC EQU   DMPARY+10                                                01471000
DMPARYSZ EQU   DMPARY+8                                                 01472000
DMPARYNM EQU   DMPARY                                                   01473000
@NM00016 EQU   DMPITM+15                                                01474000
DMPITMTP EQU   DMPITM+14                                                01475000
DMPITMLN EQU   DMPITM+12                                                01476000
DMPITMPT EQU   DMPITM+8                                                 01477000
DMPITMNM EQU   DMPITM                                                   01478000
@NM00015 EQU   FMTCNVF+1                                                01479000
FMTBS    EQU   FMTCNVF+1                                                01480000
FMTSS    EQU   FMTCNVF+1                                                01481000
FMTAL    EQU   FMTCNVF+1                                                01482000
FMTZS    EQU   FMTCNVF+1                                                01483000
@NM00014 EQU   FMTCNVF                                                  01484000
FMTPU    EQU   FMTCNVF                                                  01485000
FMTBD    EQU   FMTCNVF                                                  01486000
FMTBHD   EQU   FMTCNVF                                                  01487000
FMTBHA   EQU   FMTCNVF                                                  01488000
FMTBH    EQU   FMTCNVF                                                  01489000
FMTOLEN  EQU   FMTLIST+8                                                01490000
FMTRIO   EQU   FMTOCOL                                                  01491000
FMTSPT   EQU   FMTSTO                                                   01492000
FMTSTL   EQU   FMTILEN                                                  01493000
@NM00013 EQU   FMTFLGS+1                                                01494000
FMTHDF   EQU   FMTFLGS                                                  01495000
FMTDFF   EQU   FMTFLGS                                                  01496000
FMTSTF   EQU   FMTFLGS                                                  01497000
FMTREPF  EQU   FMTFLGS                                                  01498000
FMTBDF   EQU   FMTFLGS                                                  01499000
FMTIDF   EQU   FMTFLGS                                                  01500000
FMTSCF   EQU   FMTFLGS                                                  01501000
FMTEOLF  EQU   FMTFLGS                                                  01502000
DARGDTM  EQU   DARGARY+4                                                01503000
DARGPCT  EQU   DARGINL                                                  01504000
DARGREP  EQU   DARGINS                                                  01505000
@NM00012 EQU   DARGLIST+19                                              01506000
DARGIND  EQU   DARGLIST+18                                              01507000
DARGRETL EQU   DARGLIST+16                                              01508000
DARGCNT  EQU   DARGLIST+14                                              01509000
DARGRETP EQU   DARGLIST+4                                               01510000
UVOLVOL  EQU   UVOLENT+4                                                01511000
UVOLDEV  EQU   UVOLENT                                                  01512000
UVOLCNT  EQU   UVOLLIST                                                 01513000
OPNRSVD  EQU   OPNAGL+28                                                01514000
OPNVOL   EQU   OPNAGL+24                                                01515000
OPNBLK   EQU   OPNAGL+20                                                01516000
OPNREC   EQU   OPNAGL+16                                                01517000
OPNDSN   EQU   OPNAGL+12                                                01518000
OPNDDN   EQU   OPNAGL+8                                                 01519000
OPNIOC   EQU   OPNAGL+4                                                 01520000
@NM00011 EQU   OPNMOD                                                   01521000
OPNMODRC EQU   OPNMOD                                                   01522000
OPNMODAC EQU   OPNMOD                                                   01523000
@NM00010 EQU   OPNTYP                                                   01524000
OPNTYPSO EQU   OPNTYP                                                   01525000
OPNTYPSI EQU   OPNTYP                                                   01526000
@NM00009 EQU   OPNRFM                                                   01527000
OPNRFMBK EQU   OPNRFM                                                   01528000
OPNRFMSF EQU   OPNRFM                                                   01529000
OPNRFMUN EQU   OPNRFM                                                   01530000
OPNRFMVR EQU   OPNRFM                                                   01531000
OPNRFMFX EQU   OPNRFM                                                   01532000
@NM00008 EQU   OPNOPT                                                   01533000
OPNOPTJM EQU   OPNOPT                                                   01534000
OPNOPTKS EQU   OPNOPT                                                   01535000
OPNOPTBK EQU   OPNOPT                                                   01536000
OPNOPTUP EQU   OPNOPT                                                   01537000
OPNOPTOT EQU   OPNOPT                                                   01538000
OPNOPTIN EQU   OPNOPT                                                   01539000
IOCEXT   EQU   IOCSTR+36                                                01540000
IOCRRN   EQU   IOCSTR+32                                                01541000
@NM00007 EQU   IOCSTR+30                                                01542000
IOCPNM   EQU   IOCSTR+28                                                01543000
IOCCBP   EQU   IOCSTR+24                                                01544000
IOCDSN   EQU   IOCSTR+20                                                01545000
@NM00006 EQU   IOCSTR+17                                                01546000
@NM00005 EQU   IOCMSG                                                   01547000
IOCMSGOP EQU   IOCMSG                                                   01548000
IOCMACPA EQU   IOCMAC                                                   01549000
@NM00004 EQU   IOCMAC                                                   01550000
IOCMACBK EQU   IOCMAC                                                   01551000
IOCMACUP EQU   IOCMAC                                                   01552000
IOCMACOT EQU   IOCMAC                                                   01553000
IOCMACIN EQU   IOCMAC                                                   01554000
@NM00003 EQU   IOCRFM                                                   01555000
IOCRFMBK EQU   IOCRFM                                                   01556000
IOCRFMSF EQU   IOCRFM                                                   01557000
IOCRFMUN EQU   IOCRFM                                                   01558000
IOCRFMVR EQU   IOCRFM                                                   01559000
IOCRFMFX EQU   IOCRFM                                                   01560000
@NM00002 EQU   IOCDSO                                                   01561000
IOCDSOPS EQU   IOCDSO                                                   01562000
IOCKYL   EQU   IOCSTR+12                                                01563000
IOCTRN   EQU   IOCSTR+8                                                 01564000
IOCDLN   EQU   IOCSTR+4                                                 01565000
IOCDAD   EQU   IOCSTR                                                   01566000
STAEWORK EQU   STAEPARM+32                                              01567000
STARPTR  EQU   STAEPFX+28                                               01568000
STASPTR  EQU   STAEPFX+24                                               01569000
STALEN   EQU   STAEPFX+20                                               01570000
STAID    EQU   STAEPFX+16                                               01571000
STAEPA   EQU   STAEPFX+12                                               01572000
STAGDT   EQU   STAEPFX+8                                                01573000
STABPTR  EQU   STAEPFX+4                                                01574000
STAFPTR  EQU   STAEPFX                                                  01575000
NEWID1   EQU   TRACE1+95                                                01576000
CALLID   EQU   OLDERID1+90                                              01577000
@NM00001 EQU   OLDERID1                                                 01578000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01579000
@RF00273 EQU   @RC00256                                                 01580000
@RC00312 EQU   @RC00295                                                 01581000
@RF00319 EQU   @RC00295                                                 01582000
@RF00324 EQU   @RC00295                                                 01583000
@RF00408 EQU   @EL00002                                                 01584000
@RF00410 EQU   @EL00002                                                 01585000
@RF00413 EQU   @EL00002                                                 01586000
@PB00002 EQU   @EL00001                                                 01587000
@ENDDATA EQU   *                                                        01588000
         END   ICKRF01,(C'PLS1723',0701,78192)                          01589000
