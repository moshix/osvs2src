         TITLE '*********  ICKRI01:  READER/INTERPRETER MAIN MODULE   **00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
ICKRI01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'ICKRI01   78.192'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         LA    @09,4095(,@10)                                      0002 00024000
         LA    @08,4095(,@09)                                      0002 00025000
         LA    @07,4095(,@08)                                      0002 00026000
         USING @PSTART,@12                                         0002 00027000
         USING @PSTART+4095,@11                                    0002 00028000
         USING @PSTART+8190,@10                                    0002 00029000
         USING @PSTART+12285,@09                                   0002 00030000
         USING @PSTART+16380,@08                                   0002 00031000
         USING @PSTART+20475,@07                                   0002 00032000
         L     @00,@SIZDATD                                        0002 00033000
         GETMAIN  R,LV=(0)                                              00034000
         LR    @06,@01                                             0002 00035000
         USING @DATD,@06                                           0002 00036000
         ST    @13,@SA00001+4                                      0002 00037000
         LM    @00,@01,20(@13)                                     0002 00038000
         ST    @06,8(,@13)                                         0002 00039000
         LR    @13,@06                                             0002 00040000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00041000
         MVC   @PC00001(24),0(@01)                                 0002 00042000
*        GDTPTR=ADDR(GDTTBLX);                                     0310 00043000
*                                                                  0310 00044000
         L     @15,@PC00001                                        0310 00045000
         ST    @15,GDTPTR                                          0310 00046000
*        IF GDTDBG = NULLPTR                                       0311 00047000
*          THEN;                                                   0311 00048000
         L     @15,GDTDBG(,@15)                                    0311 00049000
         LTR   @15,@15                                             0311 00050000
         BZ    @RT00311                                            0311 00051000
*          ELSE                                                    0313 00052000
*            CALL ICKDB010(GDTTBL,'RIEX');                         0313 00053000
         L     @15,GDTPTR                                          0313 00054000
         ST    @15,@AL00001                                        0313 00055000
         LA    @14,@CC00787                                        0313 00056000
         ST    @14,@AL00001+4                                      0313 00057000
         MVI   @AL00001+4,X'80'                                    0313 00058000
         L     @15,GDTDBG(,@15)                                    0313 00059000
         LA    @01,@AL00001                                        0313 00060000
         BALR  @14,@15                                             0313 00061000
*        RISTATUS=0;                                               0314 00062000
@RT00311 SLR   @15,@15                                             0314 00063000
         STH   @15,RISTATUS                                        0314 00064000
*        VERBNAME=BLANK;                                           0315 00065000
         MVI   VERBNAME+1,C' '                                     0315 00066000
         MVC   VERBNAME+2(6),VERBNAME+1                            0315 00067000
         MVI   VERBNAME,C' '                                       0315 00068000
*        OPTSFLAG=OFF;                                             0316 00069000
         NI    OPTSFLAG,B'11011111'                                0316 00070000
*        UNITINDX=0;                                               0317 00071000
         STH   @15,UNITINDX                                        0317 00072000
*        CHAR1=BLANK;                                              0318 00073000
         MVI   CHAR1,C' '                                          0318 00074000
*        CONTNEXT=NO;                                              0319 00075000
         NI    CONTNEXT,B'11110111'                                0319 00076000
*        VLISTID1='RI';                                            0320 00077000
*                                                                  0320 00078000
         MVC   VLISTID1(2),@CC00788                                0320 00079000
*        DDSTRU=ADDR(PRNTAREA);                                    0321 00080000
         LA    @14,PRNTAREA                                        0321 00081000
         ST    @14,DDSTRU                                          0321 00082000
*        PRNTAREA=''B;                                             0322 00083000
*                                                                  0322 00084000
         XC    PRNTAREA(20),PRNTAREA                               0322 00085000
*        /************************************************************/ 00086000
*        /*                                                          */ 00087000
*        /* STORE INPUT PARAMETER DATA INTO R/I'S OWN DATA AREA      */ 00088000
*        /*                                                          */ 00089000
*        /************************************************************/ 00090000
*        POOLID=SPACEID;                                           0323 00091000
         L     @14,@PC00001+8                                      0323 00092000
         MVC   POOLID(4),SPACEID(@14)                              0323 00093000
*        MAXCC=DMSMAX;                                             0324 00094000
         L     @14,@PC00001+12                                     0324 00095000
         MVC   MAXCC(2),DMSMAX(@14)                                0324 00096000
*        LASTCC=DMSLAST;                                           0325 00097000
*                                                                  0325 00098000
         L     @14,@PC00001+16                                     0325 00099000
         MVC   LASTCC(2),DMSLAST(@14)                              0325 00100000
*        /************************************************************/ 00101000
*        /*                                                          */ 00102000
*        /*  CHECK TO SEE IF R/I INITIALIZATION NEEDS TO BE DONE     */ 00103000
*        /*  AND TERMINATE IF INITIALIZATION WAS NOT COMPLETED OKAY  */ 00104000
*        /*                                                          */ 00105000
*        /************************************************************/ 00106000
*        IF GDTRIH = NULLPTR                                       0326 00107000
*          THEN                                                    0326 00108000
         L     @01,GDTPTR                                          0326 00109000
         C     @15,GDTRIH(,@01)                                    0326 00110000
         BNE   @RF00326                                            0326 00111000
*            DO;                                                   0327 00112000
*                                                                  0327 00113000
*            CALL RIINIT;                                          0328 00114000
*                                                                  0328 00115000
         BAL   @14,RIINIT                                          0328 00116000
*            IF RISTATUS^=0                                        0329 00117000
*              THEN                                                0329 00118000
*                                                                  0329 00119000
         LH    @15,RISTATUS                                        0329 00120000
         LTR   @15,@15                                             0329 00121000
         BZ    @RF00329                                            0329 00122000
*                CALL ICKRI03(GDTTBL,COMMAREA);                    0330 00123000
*                                                                  0330 00124000
         L     @01,GDTPTR                                          0330 00125000
         ST    @01,@AL00001                                        0330 00126000
         LA    @15,COMMAREA                                        0330 00127000
         ST    @15,@AL00001+4                                      0330 00128000
         L     @15,@CV00514                                        0330 00129000
         LA    @01,@AL00001                                        0330 00130000
         BALR  @14,@15                                             0330 00131000
*            END;                                                  0331 00132000
*                                                                  0331 00133000
@RF00329 DS    0H                                                  0332 00134000
*        /************************************************************/ 00135000
*        /*                                                          */ 00136000
*        /* SCAN AND INTERPRET INPUT FUNCTION AND MODAL COMMANDS     */ 00137000
*        /* UNTIL A FUNCTION COMMAND TO BE EXECUTED IS FOUND.  THEN  */ 00138000
*        /* ENCODE THIS COMMAND INTO THE FUNCTION DATA TABLE (FDT).  */ 00139000
*        /*                                                          */ 00140000
*        /************************************************************/ 00141000
*        GOODCMD=NO;                                               0332 00142000
@RF00326 NI    GOODCMD,B'01111111'                                 0332 00143000
*        DO WHILE(RISTATUS=0 & GOODCMD=NO);                        0333 00144000
*                                                                  0333 00145000
         B     @DE00333                                            0333 00146000
@DL00333 DS    0H                                                  0334 00147000
*          CALL SCANCMD;                                           0334 00148000
*                                                                  0334 00149000
         BAL   @14,SCANCMD                                         0334 00150000
*          CALL ICKRI03(GDTTBL,COMMAREA);                          0335 00151000
*                                                                  0335 00152000
         L     @01,GDTPTR                                          0335 00153000
         ST    @01,@AL00001                                        0335 00154000
         LA    @15,COMMAREA                                        0335 00155000
         ST    @15,@AL00001+4                                      0335 00156000
         L     @15,@CV00514                                        0335 00157000
         LA    @01,@AL00001                                        0335 00158000
         BALR  @14,@15                                             0335 00159000
*        END;                                                      0336 00160000
*                                                                  0336 00161000
@DE00333 LH    @15,RISTATUS                                        0336 00162000
         LTR   @15,@15                                             0336 00163000
         BNZ   @DC00333                                            0336 00164000
         TM    GOODCMD,B'10000000'                                 0336 00165000
         BZ    @DL00333                                            0336 00166000
@DC00333 DS    0H                                                  0337 00167000
*        /************************************************************/ 00168000
*        /*                                                          */ 00169000
*        /* UPDATE PARAMETER DATA, PREPARING TO RETURN TO EXECUTIVE  */ 00170000
*        /*                                                          */ 00171000
*        /************************************************************/ 00172000
*        FDTLOC=FDTADDR;                                           0337 00173000
         L     @15,@PC00001+4                                      0337 00174000
         MVC   FDTLOC(4,@15),FDTADDR                               0337 00175000
*        FUNCNAME=FSRLNAME;                                        0338 00176000
         L     @15,@PC00001+20                                     0338 00177000
         MVC   FUNCNAME(8,@15),FSRLNAME                            0338 00178000
*        DMSMAX=MAXCC;                                             0339 00179000
         L     @15,@PC00001+12                                     0339 00180000
         MVC   DMSMAX(2,@15),MAXCC                                 0339 00181000
*        DMSLAST=LASTCC;                                           0340 00182000
*                                                                  0340 00183000
         L     @15,@PC00001+16                                     0340 00184000
         MVC   DMSLAST(2,@15),LASTCC                               0340 00185000
*        CALL ICKSAEP0(GDTTBL,MODID,RISTATUS);                     0341 00186000
*                                                                  0341 00187000
         L     @15,GDTPTR                                          0341 00188000
         ST    @15,@AL00001                                        0341 00189000
         LA    @14,MODID                                           0341 00190000
         ST    @14,@AL00001+4                                      0341 00191000
         LA    @14,RISTATUS                                        0341 00192000
         ST    @14,@AL00001+8                                      0341 00193000
         MVI   @AL00001+8,X'80'                                    0341 00194000
         L     @15,GDTEPL(,@15)                                    0341 00195000
         LA    @01,@AL00001                                        0341 00196000
         BALR  @14,@15                                             0341 00197000
*/********************************************************************/ 00198000
*/*                                                                  */ 00199000
*/*  PROCEDURE NAME - RIINIT                                         */ 00200000
*/*                                                                  */ 00201000
*/*  FUNCTION - THIS PROCEDURE OBTAINS AND INITIALIZES SPACE FOR THE */ 00202000
*/*             READER/INTERPRETER HISTORICAL DATA AREA (R/I HDA),   */ 00203000
*/*             OBTAINS SPACE FOR AND SETS UP REFERENCE TO THE UPRINT*/ 00204000
*/*             ARGUMENT STRUCTURE, AND LOADS THE DESCRIPTOR LOAD    */ 00205000
*/*             MODULE NAME TABLE.  FINALLY, IT SETS UP PARAMETER    */ 00206000
*/*             OPTION INPUT IF IT EXISTS.                           */ 00207000
*/*                                                                  */ 00208000
*/*  INPUT -                                                         */ 00209000
*/*          OPTSPTR - POINTER TO PARAMETER OPTIONS STRING           */ 00210000
*/*          OPTSLEN - LENGTH OF PARAMETER OPTIONS STRING            */ 00211000
*/*                                                                  */ 00212000
*/*  OUTPUT -                                                        */ 00213000
*/*          FIRSTCHR- SIGNALS THAT THE LOCATION AND LENGTH OF THE   */ 00214000
*/*                    INPUT CHARACTERS TO BE SCANNED ARE NOT TO BE  */ 00215000
*/*                    FOUND IN THE R/I HDA.                         */ 00216000
*/*          GDTRIH -  POINTER TO R/I HDA.                           */ 00217000
*/*          LEFTMGN - LEFT COMMAND STREAM SOURCE MARGIN TO BE USED  */ 00218000
*/*          RIGHTMGN- RIGHT COMMAND STREAM SOURCE MARGIN TO BE USED */ 00219000
*/*          OPNIOC -  OPEN FLAGS AND POINTERS SET WHEN OPENING THE  */ 00220000
*/*          OPNPTR    COMMAND INPUT STREAM FOR INPUT.               */ 00221000
*/*          OPNAGL                                                  */ 00222000
*/*          OPNTYPSI                                                */ 00223000
*/*          OPTSFLAG- FLAG NOTING THAT PARAMETER OPTIONS ARE        */ 00224000
*/*                    BEING SCANNED.                                */ 00225000
*/*          RECRDPTR- POINTER TO CHARACTER STRING TO BE SCANNED     */ 00226000
*/*          SCNLIMIT- POSITION OF LAST CHARACTER OF THE STRING TO   */ 00227000
*/*                    BE SCANNED.                                   */ 00228000
*/*          CHAR1 -   FIRST CHARACTER OF PARAMETER OPTIONS STRING   */ 00229000
*/*          SCANINDX- POSITION WITHIN CHARACTER STRING BEING        */ 00230000
*/*                    SCANNED AT WHICH TO BEGIN THE SCANNING.       */ 00231000
*/*          VERBNAME- VERB NAME GENERATED WHEN PARAMETER OPTIONS    */ 00232000
*/*                    ARE BEING SCANNED.                            */ 00233000
*/*          LASTCC -  LAST DMS SYSTEM CONDITION CODE                */ 00234000
*/*          RISTATUS- R/I INTERNAL STATUS CODE                      */ 00235000
*/*          LOADTPTR- POINTER TO DESCRIPTOR LOAD MODULE NAME TABLE  */ 00236000
*/*          KWTBLPTR- POINTER TO MODAL COMMAND KEYWORD AND VERB     */ 00237000
*/*                    SYMBOL TABLE                                  */ 00238000
*/*          FINALCHR- SIGNALS THAT EOF HAS NOT BEEN FOUND YET       */ 00239000
*/*                                                                  */ 00240000
*/********************************************************************/ 00241000
*RIINIT: PROCEDURE;                                                0342 00242000
@EL00001 L     @13,4(,@13)                                         0342 00243000
@EF00001 L     @00,@SIZDATD                                        0342 00244000
         LR    @01,@06                                             0342 00245000
         FREEMAIN R,LV=(0),A=(1)                                        00246000
@ER00001 LM    @14,@12,12(@13)                                     0342 00247000
         BR    @14                                                 0342 00248000
RIINIT   STM   @14,@12,@SA00002                                    0342 00249000
*        /************************************************************/ 00250000
*        /*                                                          */ 00251000
*        /* READER/INTERPRETER INITIALIZATION DATA DEFINITIONS       */ 00252000
*        /*                                                          */ 00253000
*        /************************************************************/ 00254000
*                                                                  0343 00255000
*        DCL OPTSPTR PTR(31)           /*POINTER TO PARAMETER OPTIONS*/ 00256000
*                    BASED(GDTPRM);                                0343 00257000
*                                                                  0343 00258000
*        /*PARAMETER OPTIONS CHARACTER STRING                        */ 00259000
*        DCL 1 PARMOPTS CHAR(*) BASED(OPTSPTR) BDY(HWORD),         0344 00260000
*              2 OPTSLEN FIXED(15);    /*LENGTH OF OPTIONS STRING    */ 00261000
*                                                                  0344 00262000
*        DCL LMGNDFLT FIXED(15)        /*LEFT COMMAND MARGIN DEFAULT */ 00263000
*                     CONSTANT(2);                                 0345 00264000
*        DCL RMGNDFLT FIXED(15)        /*RIGHT COMMAND MARGIN DEFAULT*/ 00265000
*                     CONSTANT(72);                                0346 00266000
*        DCL LTBLNAME CHAR(8)          /*LOAD NAME OF THE DESCRIPTOR */ 00267000
*                     INIT('ICKRILT ');/* LOAD MODULE NAME TABLE     */ 00268000
*        DCL KTBLNAME CHAR(8)          /*LOAD NAME OF TABLE OF       */ 00269000
*                     INIT('ICKRIKT ');/* MODAL KEYWORDS             */ 00270000
*        /************************************************************/ 00271000
*        /*                                                          */ 00272000
*        /*  ** RIINIT **  READER/INTERPRETER INITIALIZATION ROUTINE */ 00273000
*        /*                                                          */ 00274000
*        /************************************************************/ 00275000
*                                                                  0349 00276000
*        /************************************************************/ 00277000
*        /*                                                          */ 00278000
*        /*  OBTAIN SPACE FOR THE R/I HISTORICAL DATA AREA AND FOR   */ 00279000
*        /*  THE UPRINT ARGUMENT STRUCTURE , INITIALIZING THE SPACE  */ 00280000
*        /*  TO ZEROES.                                              */ 00281000
*        /*                                                          */ 00282000
*        /************************************************************/ 00283000
*        AMTTOGET=HDASIZE;                                         0349 00284000
*                                                                  0349 00285000
         MVC   AMTTOGET(4),@CF00685                                0349 00286000
*        CALL ICKSAGS0(GDTTBL,AMTTOGET,GDTRIH,SETZERO);            0350 00287000
         L     @15,GDTPTR                                          0350 00288000
         ST    @15,@AL00001                                        0350 00289000
         LA    @14,AMTTOGET                                        0350 00290000
         ST    @14,@AL00001+4                                      0350 00291000
         LA    @14,GDTRIH(,@15)                                    0350 00292000
         ST    @14,@AL00001+8                                      0350 00293000
         LA    @14,@CC00153                                        0350 00294000
         ST    @14,@AL00001+12                                     0350 00295000
         MVI   @AL00001+12,X'80'                                   0350 00296000
         L     @15,GDTGSP(,@15)                                    0350 00297000
         LA    @01,@AL00001                                        0350 00298000
         BALR  @14,@15                                             0350 00299000
*        RESPECIFY RTNREG RSTD;                                    0351 00300000
*        TESTRC = RTNREG;                                          0352 00301000
         STH   RTNREG,TESTRC                                       0352 00302000
*        RESPECIFY RTNREG UNRSTD;                                  0353 00303000
*                                                                  0353 00304000
*        IF TESTRC^=0                                              0354 00305000
*          THEN                                                    0354 00306000
         LH    @15,TESTRC                                          0354 00307000
         LTR   @15,@15                                             0354 00308000
         BZ    @RF00354                                            0354 00309000
*            DO;                                                   0355 00310000
*            LASTCC=TERMERR;                                       0356 00311000
         MVC   LASTCC(2),@CH00274                                  0356 00312000
*            RISTATUS=NOSPACE;                                     0357 00313000
         MVC   RISTATUS(2),@CH00278                                0357 00314000
*            END;                                                  0358 00315000
*                                                                  0358 00316000
*          /**********************************************************/ 00317000
*          /*                                                        */ 00318000
*          /* OBTAIN DESCRIPTOR LOAD MODULE NAME TABLE , OBTAIN THE  */ 00319000
*          /* MODAL COMMAND KEYWORD TABLE (CONTAINS THE KEYWORDS TO  */ 00320000
*          /* BE USED FOR MODAL COMMANDS - MAY BE IN ANY LANGUAGE),  */ 00321000
*          /* INITIALIZE COMMAND SOURCE MARGINS, AND OPEN SYSIN FILE.*/ 00322000
*          /*                                                        */ 00323000
*          /**********************************************************/ 00324000
*          ELSE                                                    0359 00325000
*            DO;                                                   0359 00326000
*                                                                  0359 00327000
         B     @RC00354                                            0359 00328000
@RF00354 DS    0H                                                  0360 00329000
*              CALL ICKSALD0(GDTTBL,LTBLNAME,LOADTPTR);            0360 00330000
         L     @15,GDTPTR                                          0360 00331000
         ST    @15,@AL00001                                        0360 00332000
         LA    @14,LTBLNAME                                        0360 00333000
         ST    @14,@AL00001+4                                      0360 00334000
         L     @01,GDTRIH(,@15)                                    0360 00335000
         LA    @14,LOADTPTR(,@01)                                  0360 00336000
         ST    @14,@AL00001+8                                      0360 00337000
         L     @15,GDTLOD(,@15)                                    0360 00338000
         LA    @01,@AL00001                                        0360 00339000
         BALR  @14,@15                                             0360 00340000
*              CALL ICKSALD0(GDTTBL,KTBLNAME,KWTBLPTR);            0361 00341000
*                                                                  0361 00342000
         L     @15,GDTPTR                                          0361 00343000
         ST    @15,@AL00001                                        0361 00344000
         LA    @14,KTBLNAME                                        0361 00345000
         ST    @14,@AL00001+4                                      0361 00346000
         L     @01,GDTRIH(,@15)                                    0361 00347000
         LA    @14,KWTBLPTR(,@01)                                  0361 00348000
         ST    @14,@AL00001+8                                      0361 00349000
         L     @15,GDTLOD(,@15)                                    0361 00350000
         LA    @01,@AL00001                                        0361 00351000
         BALR  @14,@15                                             0361 00352000
*              LEFTMGN=LMGNDFLT;                                   0362 00353000
         L     @15,GDTPTR                                          0362 00354000
         L     @14,GDTRIH(,@15)                                    0362 00355000
         MVC   LEFTMGN(2,@14),@CH00124                             0362 00356000
*              RIGHTMGN=RMGNDFLT;                                  0363 00357000
*                                                                  0363 00358000
         MVC   RIGHTMGN(2,@14),@CH00800                            0363 00359000
*              OPNPTR=ADDR(OPENAREA);                              0364 00360000
         LA    @05,OPENAREA                                        0364 00361000
         ST    @05,OPNPTR                                          0364 00362000
*              OPNAGL=''B;                                         0365 00363000
         XC    OPNAGL(32,@05),OPNAGL(@05)                          0365 00364000
*              OPNTYPSI=ON;                                        0366 00365000
         OI    OPNTYPSI(@05),B'10000000'                           0366 00366000
*              OPNIOC=ADDR(ADDRIOCS);                              0367 00367000
*                                                                  0367 00368000
         LA    @04,ADDRIOCS(,@14)                                  0367 00369000
         ST    @04,OPNIOC(,@05)                                    0367 00370000
*              CALL ICKIOOP0(GDTTBL,OPNAGL);                       0368 00371000
         ST    @15,@AL00001                                        0368 00372000
         ST    @05,@AL00001+4                                      0368 00373000
         MVI   @AL00001+4,X'80'                                    0368 00374000
         L     @15,GDTOPN(,@15)                                    0368 00375000
         LA    @01,@AL00001                                        0368 00376000
         BALR  @14,@15                                             0368 00377000
*              RESPECIFY RTNREG RSTD;                              0369 00378000
*              TESTRC = RTNREG;                                    0370 00379000
         STH   RTNREG,TESTRC                                       0370 00380000
*              RESPECIFY RTNREG UNRSTD;                            0371 00381000
*                                                                  0371 00382000
*              IF TESTRC ^= 0                                      0372 00383000
*                THEN                                              0372 00384000
         LH    @15,TESTRC                                          0372 00385000
         LTR   @15,@15                                             0372 00386000
         BZ    @RF00372                                            0372 00387000
*                  DO;                                             0373 00388000
*                  LASTCC=TERMERR;                                 0374 00389000
         MVC   LASTCC(2),@CH00274                                  0374 00390000
*                  RISTATUS=SKIPREST;                              0375 00391000
         MVC   RISTATUS(2),@CH00042                                0375 00392000
*                  END;                                            0376 00393000
*                ELSE                                              0377 00394000
*                                                                  0377 00395000
*                  /**************************************************/ 00396000
*                  /*                                                */ 00397000
*                  /*  IF A PARAMETER OPTIONS STRING EXISTS THEN SET */ 00398000
*                  /*  IT UP AS IF IT WERE THE PARAMETER SET OF A    */ 00399000
*                  /*  'PARM' COMMAND. ALSO PRINT THE OPTIONS.       */ 00400000
*                  /*                                                */ 00401000
*                  /**************************************************/ 00402000
*                  IF GDTPRM^=0 & OPTSPTR^=0 & OPTSLEN^=0          0377 00403000
*                    THEN                                          0377 00404000
         B     @RC00372                                            0377 00405000
@RF00372 SLR   @15,@15                                             0377 00406000
         L     @14,GDTPTR                                          0377 00407000
         L     @05,GDTPRM(,@14)                                    0377 00408000
         CR    @05,@15                                             0377 00409000
         BE    @RF00377                                            0377 00410000
         L     @05,OPTSPTR(,@05)                                   0377 00411000
         CR    @05,@15                                             0377 00412000
         BE    @RF00377                                            0377 00413000
         LH    @04,OPTSLEN(,@05)                                   0377 00414000
         CR    @04,@15                                             0377 00415000
         BE    @RF00377                                            0377 00416000
*                      DO;                                         0378 00417000
*                      OPTSFLAG=ON;                                0379 00418000
         OI    OPTSFLAG,B'00100000'                                0379 00419000
*                      MORTOCOM=NO;                                0380 00420000
*                      FIRSTCHR=NO;                                0381 00421000
         NI    MORTOCOM,B'11101011'                                0381 00422000
*                      RECRDPTR=OPTSPTR+2;                         0382 00423000
         AH    @05,@CH00124                                        0382 00424000
         ST    @05,RECRDPTR                                        0382 00425000
*                      SCNLIMIT=OPTSLEN+1;                         0383 00426000
         LA    @15,1                                               0383 00427000
         LR    @03,@04                                             0383 00428000
         ALR   @03,@15                                             0383 00429000
         STH   @03,SCNLIMIT                                        0383 00430000
*                      CHAR1=INREC(1);                             0384 00431000
         MVC   CHAR1(1),INREC(@05)                                 0384 00432000
*                      CHAR2=INREC(2);                             0385 00433000
         MVC   CHAR2(1),INREC+1(@05)                               0385 00434000
*                      SCANINDX=1;                                 0386 00435000
         STH   @15,SCANINDX                                        0386 00436000
*                      VERBNAME=PARMSYM;                           0387 00437000
*                                                                  0387 00438000
         L     @01,GDTRIH(,@14)                                    0387 00439000
         L     @01,KWTBLPTR(,@01)                                  0387 00440000
         MVC   VERBNAME(8),PARMSYM(@01)                            0387 00441000
*                      DARGDBP=RECRDPTR;                           0388 00442000
         L     @15,DDSTRU                                          0388 00443000
         ST    @05,DARGDBP(,@15)                                   0388 00444000
*                      DARGILP=OPTSLEN;                            0389 00445000
         STH   @04,DARGILP(,@15)                                   0389 00446000
*                      DARGSMOD=RISTID;                            0390 00447000
         MVC   DARGSMOD(3,@15),RISTID                              0390 00448000
*                      DARGSENT=INRECID;                           0391 00449000
*                                                                  0391 00450000
         MVI   DARGSENT(@15),X'27'                                 0391 00451000
*                      CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);       0392 00452000
*                                                                  0392 00453000
         ST    @14,@AL00001                                        0392 00454000
         LA    @15,@CF00102                                        0392 00455000
         ST    @15,@AL00001+4                                      0392 00456000
         LA    @15,DDSTRU                                          0392 00457000
         ST    @15,@AL00001+8                                      0392 00458000
         MVI   @AL00001+8,X'80'                                    0392 00459000
         L     @15,GDTPRT(,@14)                                    0392 00460000
         LA    @01,@AL00001                                        0392 00461000
         BALR  @14,@15                                             0392 00462000
*                      END;                                        0393 00463000
*                                                                  0393 00464000
*            END;                                                  0394 00465000
*                                                                  0394 00466000
*        END RIINIT;                                               0395 00467000
@EL00002 DS    0H                                                  0395 00468000
@EF00002 DS    0H                                                  0395 00469000
@ER00002 LM    @14,@12,@SA00002                                    0395 00470000
         BR    @14                                                 0395 00471000
*/********************************************************************/ 00472000
*/*                                                                  */ 00473000
*/*  PROCEDURE NAME - SCANCMD                                        */ 00474000
*/*                                                                  */ 00475000
*/*  FUNCTION - THIS ROUTINE SCANS THE INPUT COMMAND, USING THE      */ 00476000
*/*             COMMAND DESCRIPTOR AS A BASIS FOR SCANNING.  KEYWORDS*/ 00477000
*/*             ARE INTERPRETED AND SCALAR DATA IS EXTRACTED AND     */ 00478000
*/*             USED TO BUILD A FUNCTION DATA TABLE.  SYNTAX AND     */ 00479000
*/*             SEMANTIC CHECKING AND FDT BUILDING ARE DONE BASED    */ 00480000
*/*             UPON COMMAND DESCRIPTOR INFORMATION.                 */ 00481000
*/*                                                                  */ 00482000
*/*  INPUT -                                                         */ 00483000
*/*          OPTSFLAG- FLAG INDICATING WHETHER OR NOT A PARAMETER    */ 00484000
*/*                    OPTIONS STRING IS BEING CURRENTLY SCANNED     */ 00485000
*/*          RISTATUS- INTERNAL R/I STATUS CODE INDICATING WHETHER   */ 00486000
*/*                    OR NOT AN ERROR HAS OCCURRED.                 */ 00487000
*/*          CHAR1 -   MOST RECENT INPUT CHARACTER EXTRACTED         */ 00488000
*/*          COMMAND DESCRIPTOR - DATA STRUCTURE CONTAINING DATA     */ 00489000
*/*                               THAT DESCRIBES THE CURRENT COMMAND */ 00490000
*/*                               BEING SCANNED.                     */ 00491000
*/*          SUPERID - PUSHDOWN STACK OF PARAMETER ID#S OF           */ 00492000
*/*                    SUPERPARAMETERS OF SUBPARAMETER LISTS         */ 00493000
*/*                    CURRENTLY BEING SCANNED.                      */ 00494000
*/*          REPDEPTH- LEVEL OF "REPEATEDNESS" NESTING OF PARAMETER  */ 00495000
*/*                    LIST CURRENTLY BEING SCANNED.                 */ 00496000
*/*          PARMLVL - LEVEL OF SUBPARAMETER NESTING OF PARAMETER    */ 00497000
*/*                    LIST CURRENTLY BEING SCANNED.                 */ 00498000
*/*          SCANONLY- FLAG INDICATING WHETHER OR NOT THE CURRENT    */ 00499000
*/*                    COMMAND IS TO HAVE AN FDT BUILT OR IF IT IS   */ 00500000
*/*                    JUST BEING SCANNED FOR SYNTAX ERRORS.         */ 00501000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */ 00502000
*/*          SUBSYET - INDICATES WHETHER OR NOT ANY SUBPARAMETERS    */ 00503000
*/*                    HAVE BEEN FOUND YET IN CURRENT SUBPARM. LIST  */ 00504000
*/*          PPARMCNT- ARRAY OF COUNTS OF POSITIONAL SUBPARAMETERS   */ 00505000
*/*                    FOUND SO FAR IN CURRENT SUBPARM. LISTS        */ 00506000
*/*                                                                  */ 00507000
*/*  OUTPUT -                                                        */ 00508000
*/*          FUNCTION DATA TABLE                                     */ 00509000
*/*          FINALCHR- FLAG INDICATING THAT THE LAST INPUT CHAR.     */ 00510000
*/*                    HAS JUST BEEN EXTRACTED.                      */ 00511000
*/*          INQUOTED- FLAG INDICATING THAT THE R/I IS CURRENTLY     */ 00512000
*/*                    SCANNING WITHIN A QUOTED STRING.              */ 00513000
*/*          PARMLVL - (SEE 'INPUT')                                 */ 00514000
*/*          PPARMCNT- PUSHDOWN STACK OF COUNTS, EACH INDICATING     */ 00515000
*/*                    HOW MANY POSITIONAL PARAMETERS HAVE BEEN      */ 00516000
*/*                    FOUND AT A LEVEL OF PARAMETER LIST NESTING.   */ 00517000
*/*          SUPERID - (SEE 'INPUT')                                 */ 00518000
*/*          REPDEPTH- (SEE 'INPUT')                                 */ 00519000
*/*          SKIPPAST- INDICATES THAT INITIALLY NO COMMAND HAS JUST  */ 00520000
*/*                    BEEN BYPASSED DUE TO AN ERROR IN IT.          */ 00521000
*/*          EOFOK -   FLAG INDICATING WHETHER OR NOT THE SCAN IS    */ 00522000
*/*                    CURRENTLY AT A POINT WHERE THE OCCURRENCE OF  */ 00523000
*/*                    INPUT END-OF-FILE WOULD NOT BE AN ERROR.      */ 00524000
*/*          BLKLEFT - NUMBER OF BYTES OF SPACE REMAINING TO BE      */ 00525000
*/*                    ALLOCATED FOR FDT SCALAR DATA STRUCTURES.     */ 00526000
*/*          PARMID -  ID# OF PARAMETER CURRENTLY BEING EXAMINED     */ 00527000
*/*          FDTPTR -  PRIMARY FDT VECTOR OF POINTERS.               */ 00528000
*/*          ARRYPTR - POINTER TO AN INTERMEDIATE FDT POINTER VECTOR */ 00529000
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */ 00530000
*/*          SUBSYET - SEE 'INPUT'                                   */ 00531000
*/*                                                                  */ 00532000
*/********************************************************************/ 00533000
*SCANCMD:PROCEDURE;                                                0396 00534000
SCANCMD  STM   @14,@12,@SA00003                                    0396 00535000
*        /************************************************************/ 00536000
*        /*                                                          */ 00537000
*        /* SCANCMD PROCEDURE DATA DEFINITIONS                       */ 00538000
*        /*                                                          */ 00539000
*        /************************************************************/ 00540000
*        DCL STMTEND  BIT(1);          /*SIGNALS THAT THE END OF THE    00541000
*                                        COMMAND HAS BEEN FOUND      */ 00542000
*        DCL PRMFOUND BIT(1);          /*SIGNALS THAT NEXT PARAMETER    00543000
*                                        IS TO BE EXTRACTED          */ 00544000
*        DCL WORKPTR2 PTR(31);         /*VARIABLE TO CONTAIN       0399 00545000
*                                        A TEMPORARY POINTER VALUE   */ 00546000
*        DCL WORKPTR3 PTR(31);         /*VARIABLE TO CONTAIN       0400 00547000
*                                        A TEMPORARY POINTER VALUE   */ 00548000
*        DCL SETUPERR FIXED(31);       /*ERROR CODE FOR ERROR FOUND     00549000
*                                        DURING DESCRIPTOR SET-UP    */ 00550000
*                                                                  0401 00551000
*        /*STATIC ERROR MESSAGE CODES                                */ 00552000
*        DCL BADPOS   FIXED(31)        /*TOO MANY POSITIONAL PARM'S  */ 00553000
*                     CONSTANT(1);                                 0402 00554000
*        DCL TOOMANY  FIXED(31)        /*TOO MANY RIGHT PARENTHESES  */ 00555000
*                     CONSTANT(34);    /* AT COMMAND TERMINATION     */ 00556000
*        /************************************************************/ 00557000
*        /*                                                          */ 00558000
*        /*  ** SCANCMD **  SCAN INPUT COMMAND & BUILD FDT           */ 00559000
*        /*                                                          */ 00560000
*        /************************************************************/ 00561000
*                                                                  0404 00562000
*        IF GDTDBG = NULLPTR                                       0404 00563000
*          THEN;                                                   0404 00564000
         L     @01,GDTPTR                                          0404 00565000
         L     @15,GDTDBG(,@01)                                    0404 00566000
         LTR   @15,@15                                             0404 00567000
         BZ    @RT00404                                            0404 00568000
*          ELSE                                                    0406 00569000
*            CALL ICKDB010(GDTTBL,'RISC');                         0406 00570000
*                                                                  0406 00571000
         L     @15,GDTPTR                                          0406 00572000
         ST    @15,@AL00001                                        0406 00573000
         LA    @14,@CC00815                                        0406 00574000
         ST    @14,@AL00001+4                                      0406 00575000
         MVI   @AL00001+4,X'80'                                    0406 00576000
         L     @15,GDTDBG(,@15)                                    0406 00577000
         LA    @01,@AL00001                                        0406 00578000
         BALR  @14,@15                                             0406 00579000
*        STMTEND=NO;                                               0407 00580000
@RT00404 NI    STMTEND,B'01111111'                                 0407 00581000
*        FINALCHR=NO;                                              0408 00582000
         NI    FINALCHR,B'11111101'                                0408 00583000
*        PARMLVL=1;                                                0409 00584000
         LA    @15,1                                               0409 00585000
         STH   @15,PARMLVL                                         0409 00586000
*        PPARMCNT(1)=1;                                            0410 00587000
         STH   @15,PPARMCNT                                        0410 00588000
*        SUPERID(1)=0;                                             0411 00589000
         SLR   @15,@15                                             0411 00590000
         STH   @15,SUPERID                                         0411 00591000
*        REPDEPTH=0;                                               0412 00592000
         STH   @15,REPDEPTH                                        0412 00593000
*        SKIPPAST=NO;                                              0413 00594000
*        EOFOK=YES;                                                0414 00595000
         OI    EOFOK,B'01000000'                                   0414 00596000
         NI    SKIPPAST,B'11110111'                                0414 00597000
*        BLKLEFT=0;                                                0415 00598000
         ST    @15,BLKLEFT                                         0415 00599000
*        SCANONLY=NO;                                              0416 00600000
*                                                                  0416 00601000
         NI    SCANONLY,B'11101111'                                0416 00602000
*        /************************************************************/ 00603000
*        /*                                                          */ 00604000
*        /* EXTRACT THE COMMAND VERB (UNLESS NOW SCANNING PARAMETER  */ 00605000
*        /* OPTIONS) AND CALL 'ICKRI02' TO SET UP THE APPROPRIATE    */ 00606000
*        /* COMMAND DESCRIPTOR AND TO PREPARE FOR COMMAND SCANNING.  */ 00607000
*        /* IF AN ERROR IS ENCOUNTERED DOING THIS, BYPASS THE        */ 00608000
*        /* COMMAND.                                                 */ 00609000
*        /*                                                          */ 00610000
*        /************************************************************/ 00611000
*        IF OPTSFLAG=OFF                                           0417 00612000
*          THEN                                                    0417 00613000
*                                                                  0417 00614000
         TM    OPTSFLAG,B'00100000'                                0417 00615000
         BNZ   @RF00417                                            0417 00616000
*            CALL GETNEXT;                                         0418 00617000
*                                                                  0418 00618000
         BAL   @14,GETNEXT                                         0418 00619000
*          ELSE                                                    0419 00620000
*                                                                  0419 00621000
*            CALL SCANSEP(NO);                                     0419 00622000
*                                                                  0419 00623000
         B     @RC00417                                            0419 00624000
@RF00417 LA    @01,@AL00419                                        0419 00625000
         BAL   @14,SCANSEP                                         0419 00626000
*        IF RISTATUS=0                                             0420 00627000
*          THEN                                                    0420 00628000
@RC00417 LH    @15,RISTATUS                                        0420 00629000
         LTR   @15,@15                                             0420 00630000
         BNZ   @RF00420                                            0420 00631000
*            DO;                                                   0421 00632000
*                                                                  0421 00633000
*            CALL ICKRI02(GDTTBL,COMMAREA);                        0422 00634000
*                                                                  0422 00635000
         L     @01,GDTPTR                                          0422 00636000
         ST    @01,@AL00001                                        0422 00637000
         LA    @15,COMMAREA                                        0422 00638000
         ST    @15,@AL00001+4                                      0422 00639000
         L     @15,@CV00513                                        0422 00640000
         LA    @01,@AL00001                                        0422 00641000
         BALR  @14,@15                                             0422 00642000
*            IF RISTATUS^=0                                        0423 00643000
*              THEN                                                0423 00644000
         LH    @15,RISTATUS                                        0423 00645000
         LTR   @15,@15                                             0423 00646000
         BZ    @RF00423                                            0423 00647000
*                DO;                                               0424 00648000
*                SETUPERR=RISTATUS;                                0425 00649000
         ST    @15,SETUPERR                                        0425 00650000
*                IF SETUPERR=NOSPACE                               0426 00651000
*                  THEN                                            0426 00652000
*                                                                  0426 00653000
         CH    @15,@CH00278                                        0426 00654000
         BNE   @RF00426                                            0426 00655000
*                    CALL ERROR1(SETUPERR);                        0427 00656000
*                                                                  0427 00657000
         LA    @15,SETUPERR                                        0427 00658000
         ST    @15,@AL00001                                        0427 00659000
         LA    @01,@AL00001                                        0427 00660000
         BAL   @14,ERROR1                                          0427 00661000
*                  ELSE                                            0428 00662000
*                                                                  0428 00663000
*                    CALL ERROR2(SETUPERR,LENGTH(ERRFIELD),        0428 00664000
*                                ADDR(ERRFIELD));                  0428 00665000
*                                                                  0428 00666000
         B     @RC00426                                            0428 00667000
@RF00426 LA    @15,SETUPERR                                        0428 00668000
         ST    @15,@AL00001                                        0428 00669000
         LA    @15,@CF00282                                        0428 00670000
         ST    @15,@AL00001+4                                      0428 00671000
         LA    @15,ERRFIELD                                        0428 00672000
         ST    @15,@AFTEMPS+12                                     0428 00673000
         LA    @15,@AFTEMPS+12                                     0428 00674000
         ST    @15,@AL00001+8                                      0428 00675000
         LA    @01,@AL00001                                        0428 00676000
         BAL   @14,ERROR2                                          0428 00677000
*                END;                                              0429 00678000
@RC00426 DS    0H                                                  0430 00679000
*            END;                                                  0430 00680000
*                                                                  0430 00681000
@RF00423 DS    0H                                                  0431 00682000
*        /************************************************************/ 00683000
*        /*                                                          */ 00684000
*        /* SCAN THE PARAMETER SET, EXTRACTING ONE PARAMETER AT A    */ 00685000
*        /* TIME UNTIL THE STATEMENT END IS FOUND OR AN ERROR OCCURS.*/ 00686000
*        /*                                                          */ 00687000
*        /************************************************************/ 00688000
*DOLOOP5:DO WHILE(STMTEND=NO & RISTATUS=0);                        0431 00689000
@RF00420 DS    0H                                                  0431 00690000
DOLOOP5  B     @DE00431                                            0431 00691000
@DL00431 DS    0H                                                  0432 00692000
*          OLDERID2 = NEWERID2;                                    0432 00693000
         L     @01,GDTPTR                                          0432 00694000
         L     @15,GDTTR2(,@01)                                    0432 00695000
         MVC   @TS00001(95),NEWERID2(@15)                          0432 00696000
         MVC   OLDERID2(95,@15),@TS00001                           0432 00697000
*          NEWID2='RI01';                                          0433 00698000
         MVC   NEWID2(4,@15),@CC00706                              0433 00699000
*          IF CHAR1=ENDDELIM                                       0434 00700000
*            THEN                                                  0434 00701000
         CLI   CHAR1,C';'                                          0434 00702000
         BNE   @RF00434                                            0434 00703000
*DOGRP5:       DO;                                                 0435 00704000
DOGRP5   DS    0H                                                  0436 00705000
*                STMTEND=YES;                                      0436 00706000
*                                                                  0436 00707000
         OI    STMTEND,B'10000000'                                 0436 00708000
*                /****************************************************/ 00709000
*                /*                                                  */ 00710000
*                /* APPLY DEFAULTS AND PERFORM SEMANTIC CHECKING AT  */ 00711000
*                /* COMMAND TERMINATION.  ISSUE A WARNING IF TOO FEW */ 00712000
*                /* PARENTHESES APPEAR AT COMMAND END.               */ 00713000
*                /*                                                  */ 00714000
*                /****************************************************/ 00715000
*                IF PARMLVL > 1                                    0437 00716000
*                  THEN                                            0437 00717000
         LH    @15,PARMLVL                                         0437 00718000
         CH    @15,@CH00172                                        0437 00719000
         BNH   @RF00437                                            0437 00720000
*                    DO;                                           0438 00721000
*                    DARGSMOD=RISTID;                              0439 00722000
         L     @15,DDSTRU                                          0439 00723000
         MVC   DARGSMOD(3,@15),RISTID                              0439 00724000
*                    DARGSENT=TOOFEW;                              0440 00725000
*                                                                  0440 00726000
         MVI   DARGSENT(@15),X'23'                                 0440 00727000
*                    CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);         0441 00728000
*                                                                  0441 00729000
         L     @15,GDTPTR                                          0441 00730000
         ST    @15,@AL00001                                        0441 00731000
         LA    @14,@CF00102                                        0441 00732000
         ST    @14,@AL00001+4                                      0441 00733000
         LA    @14,DDSTRU                                          0441 00734000
         ST    @14,@AL00001+8                                      0441 00735000
         MVI   @AL00001+8,X'80'                                    0441 00736000
         L     @15,GDTPRT(,@15)                                    0441 00737000
         LA    @01,@AL00001                                        0441 00738000
         BALR  @14,@15                                             0441 00739000
*                    END;                                          0442 00740000
*                                                                  0442 00741000
*                DO WHILE(PARMLVL>0);                              0443 00742000
@RF00437 B     @DE00443                                            0443 00743000
@DL00443 DS    0H                                                  0444 00744000
*                  PARMID=SUPERID(PARMLVL);                        0444 00745000
         LH    @15,PARMLVL                                         0444 00746000
         ALR   @15,@15                                             0444 00747000
         LH    @15,SUPERID-2(@15)                                  0444 00748000
         STH   @15,PARMID                                          0444 00749000
*                  IF PARMID=0                                     0445 00750000
*                    THEN                                          0445 00751000
         LTR   @15,@15                                             0445 00752000
         BNZ   @RF00445                                            0445 00753000
*                      DO;                                         0446 00754000
*                                                                  0446 00755000
*                      CALL DEFAULTS;                              0447 00756000
         BAL   @14,DEFAULTS                                        0447 00757000
*                      CALL NEEDNOTS;                              0448 00758000
*                                                                  0448 00759000
         BAL   @14,NEEDNOTS                                        0448 00760000
*                      END;                                        0449 00761000
*                    ELSE                                          0450 00762000
*                      IF REPEATED=YES                             0450 00763000
*                        THEN                                      0450 00764000
         B     @RC00445                                            0450 00765000
@RF00445 LH    @15,PARMID                                          0450 00766000
         MH    @15,@CH00038                                        0450 00767000
         L     @01,WORKPTR                                         0450 00768000
         AL    @01,@CF01317                                        0450 00769000
         L     @01,PARMPTR(@15,@01)                                0450 00770000
         TM    REPEATED(@01),B'00100000'                           0450 00771000
         BNO   @RF00450                                            0450 00772000
*                          DO;                                     0451 00773000
*                                                                  0451 00774000
*                          CALL DEFAULTS;                          0452 00775000
         BAL   @14,DEFAULTS                                        0452 00776000
*                          CALL NEEDNOTS;                          0453 00777000
*                                                                  0453 00778000
         BAL   @14,NEEDNOTS                                        0453 00779000
*                          REPDEPTH=REPDEPTH-1;                    0454 00780000
         LH    @15,REPDEPTH                                        0454 00781000
         BCTR  @15,0                                               0454 00782000
         STH   @15,REPDEPTH                                        0454 00783000
*                          END;                                    0455 00784000
*                  PARMLVL=PARMLVL-1;                              0456 00785000
@RF00450 DS    0H                                                  0456 00786000
@RC00445 LH    @15,PARMLVL                                         0456 00787000
         BCTR  @15,0                                               0456 00788000
         STH   @15,PARMLVL                                         0456 00789000
*                END;                                              0457 00790000
*                                                                  0457 00791000
@DE00443 SLR   @15,@15                                             0457 00792000
         CH    @15,PARMLVL                                         0457 00793000
         BL    @DL00443                                            0457 00794000
*                /****************************************************/ 00795000
*                /*                                                  */ 00796000
*                /* IF FDT BUILDING HAS COMPLETED OKAY, THEN CHECK   */ 00797000
*                /* FOR PARAMETERS WITHIN THE FIRST LEVEL OF REPEATED*/ 00798000
*                /* SUBLIST NESTING.  THE POINTERS WHICH POINT TO THE*/ 00799000
*                /* SCALAR DATA OF THESE PARAMETERS ARE CURRENTLY IN */ 00800000
*                /* THE FORM OF LISTS OF POINTER VECTOR BLOCKS.      */ 00801000
*                /* REASSEMBLE EACH LIST INTO A SINGLE VECTOR OF PTRS*/ 00802000
*                /*                                                  */ 00803000
*                /****************************************************/ 00804000
*                IF RISTATUS=0 & SCANONLY=NO                       0458 00805000
*                  THEN                                            0458 00806000
         CH    @15,RISTATUS                                        0458 00807000
         BNE   @RF00458                                            0458 00808000
         TM    SCANONLY,B'00010000'                                0458 00809000
         BNZ   @RF00458                                            0458 00810000
*DOLOOP7:            DO PARMID=1 TO MAXID WHILE(RISTATUS=0);       0459 00811000
DOLOOP7  LA    @15,1                                               0459 00812000
         B     @DE00459                                            0459 00813000
@DL00459 SLR   @14,@14                                             0459 00814000
         CH    @14,RISTATUS                                        0459 00815000
         BNE   @DC00459                                            0459 00816000
*                      IF PARMPTR(PARMID)^=NULLPTR & OCCURNUM > 1  0460 00817000
*                        THEN                                      0460 00818000
*                                                                  0460 00819000
         MH    @15,@CH00038                                        0460 00820000
         L     @01,WORKPTR                                         0460 00821000
         AL    @01,@CF01317                                        0460 00822000
         L     @15,PARMPTR(@15,@01)                                0460 00823000
         CR    @15,@14                                             0460 00824000
         BE    @RF00460                                            0460 00825000
         CLC   OCCURNUM(3,@15),@CF00172+1                          0460 00826000
         BNH   @RF00460                                            0460 00827000
*                          /******************************************/ 00828000
*                          /*                                        */ 00829000
*                          /* CHECK ALL PARAMETERS WITHIN REPEATED   */ 00830000
*                          /* SUBLISTS TO SEE IF THEY ARE AT THE 1ST */ 00831000
*                          /* LEVEL OF REPEAT NESTING.               */ 00832000
*                          /*                                        */ 00833000
*                          /******************************************/ 00834000
*DOGRP6:                   DO;                                     0461 00835000
DOGRP6   DS    0H                                                  0462 00836000
*                          REPNEST=0;                              0462 00837000
         SLR   @15,@15                                             0462 00838000
         STH   @15,REPNEST                                         0462 00839000
*                          VLISTID=PARMID;                         0463 00840000
         LH    @15,PARMID                                          0463 00841000
         STH   @15,VLISTID                                         0463 00842000
*                          PARMID=SUPRPARM(PARMID);                0464 00843000
         MH    @15,@CH00038                                        0464 00844000
         L     @01,WORKPTR                                         0464 00845000
         AL    @01,@CF01318                                        0464 00846000
         LH    @15,SUPRPARM-8(@15,@01)                             0464 00847000
         STH   @15,PARMID                                          0464 00848000
*                          DO WHILE(PARMID^=0);                    0465 00849000
         B     @DE00465                                            0465 00850000
@DL00465 DS    0H                                                  0466 00851000
*                            IF REPEATED=YES                       0466 00852000
*                              THEN                                0466 00853000
         LH    @15,PARMID                                          0466 00854000
         MH    @15,@CH00038                                        0466 00855000
         L     @01,WORKPTR                                         0466 00856000
         AL    @01,@CF01317                                        0466 00857000
         L     @01,PARMPTR(@15,@01)                                0466 00858000
         TM    REPEATED(@01),B'00100000'                           0466 00859000
         BNO   @RF00466                                            0466 00860000
*                                REPNEST=REPNEST+1;                0467 00861000
         LH    @01,REPNEST                                         0467 00862000
         LA    @01,1(,@01)                                         0467 00863000
         STH   @01,REPNEST                                         0467 00864000
*                            PARMID=SUPRPARM(PARMID);              0468 00865000
@RF00466 LH    @15,PARMID                                          0468 00866000
         MH    @15,@CH00038                                        0468 00867000
         L     @01,WORKPTR                                         0468 00868000
         AL    @01,@CF01318                                        0468 00869000
         LH    @15,SUPRPARM-8(@15,@01)                             0468 00870000
         STH   @15,PARMID                                          0468 00871000
*                          END;                                    0469 00872000
@DE00465 LH    @15,PARMID                                          0469 00873000
         LTR   @15,@15                                             0469 00874000
         BNZ   @DL00465                                            0469 00875000
*                          PARMID=VLISTID;                         0470 00876000
         MVC   PARMID(2),VLISTID                                   0470 00877000
*                          IF REPNEST=1                            0471 00878000
*                            THEN                                  0471 00879000
*                                                                  0471 00880000
         CLC   REPNEST(2),@CH00172                                 0471 00881000
         BNE   @RF00471                                            0471 00882000
*                              /**************************************/ 00883000
*                              /*                                    */ 00884000
*                              /* FOR PARAMETERS HAVING THE LISTS OF */ 00885000
*                              /* POINTER BLOCKS, ALLOCATE ENOUGH    */ 00886000
*                              /* SPACE FOR A SINGLE PTR BLOCK AND   */ 00887000
*                              /* MOVE THE POINTERS FROM THE LIST    */ 00888000
*                              /* INTO THE SINGLE VECTOR OF POINTERS.*/ 00889000
*                              /* THEN FREE UP THE 'LIST' SPACE.     */ 00890000
*                              /*                                    */ 00891000
*                              /**************************************/ 00892000
*DOGRP7:                       DO;                                 0472 00893000
DOGRP7   DS    0H                                                  0473 00894000
*                              VECTRNUM=1;                         0473 00895000
         MVC   VECTRNUM(2),@CH00172                                0473 00896000
*                              ARRYPTR=FDTPTR(PARMID);             0474 00897000
         LH    @15,PARMID                                          0474 00898000
         SLA   @15,2                                               0474 00899000
         L     @01,FDTADDR                                         0474 00900000
         L     @15,FDTPTR-4(@15,@01)                               0474 00901000
         ST    @15,ARRYPTR                                         0474 00902000
*                              DO WHILE(VECTRPTR^=0);              0475 00903000
         B     @DE00475                                            0475 00904000
@DL00475 DS    0H                                                  0476 00905000
*                                VECTRNUM=VECTRNUM+1;              0476 00906000
         LH    @01,VECTRNUM                                        0476 00907000
         LA    @01,1(,@01)                                         0476 00908000
         STH   @01,VECTRNUM                                        0476 00909000
*                                ARRYPTR=VECTRPTR;                 0477 00910000
         LH    @15,VECTRLEN                                        0477 00911000
         AL    @15,ARRYPTR                                         0477 00912000
         L     @15,VECTRPTR(,@15)                                  0477 00913000
         ST    @15,ARRYPTR                                         0477 00914000
*                              END;                                0478 00915000
@DE00475 LH    @15,VECTRLEN                                        0478 00916000
         L     @14,ARRYPTR                                         0478 00917000
         ALR   @14,@15                                             0478 00918000
         L     @14,VECTRPTR(,@14)                                  0478 00919000
         LTR   @14,@14                                             0478 00920000
         BNZ   @DL00475                                            0478 00921000
*                              AMTTOGET=VECTRNUM*VECTRLEN;         0479 00922000
         MH    @15,VECTRNUM                                        0479 00923000
         ST    @15,AMTTOGET                                        0479 00924000
*                              WORKPTR2=FDTPTR(PARMID);            0480 00925000
*                                                                  0480 00926000
         L     @15,FDTADDR                                         0480 00927000
         LH    @14,PARMID                                          0480 00928000
         SLA   @14,2                                               0480 00929000
         L     @05,FDTPTR-4(@14,@15)                               0480 00930000
         ST    @05,WORKPTR2                                        0480 00931000
*                              CALL ICKSAGP0(GDTTBL,AMTTOGET,FDTPTR(PAR 00932000
*ID),                                                              0481 00933000
*                                     POOLID,SETZERO);             0481 00934000
         L     @05,GDTPTR                                          0481 00935000
         ST    @05,@AL00001                                        0481 00936000
         LA    @04,AMTTOGET                                        0481 00937000
         ST    @04,@AL00001+4                                      0481 00938000
         LA    @04,FDTPTR-4(@14,@15)                               0481 00939000
         ST    @04,@AL00001+8                                      0481 00940000
         LA    @04,POOLID                                          0481 00941000
         ST    @04,@AL00001+12                                     0481 00942000
         LA    @04,@CC00153                                        0481 00943000
         ST    @04,@AL00001+16                                     0481 00944000
         MVI   @AL00001+16,X'80'                                   0481 00945000
         L     @15,GDTGPL(,@05)                                    0481 00946000
         LA    @01,@AL00001                                        0481 00947000
         BALR  @14,@15                                             0481 00948000
*                              RESPECIFY RTNREG RSTD;              0482 00949000
*                              TESTRC = RTNREG;                    0483 00950000
         STH   RTNREG,TESTRC                                       0483 00951000
*                              RESPECIFY RTNREG UNRSTD;            0484 00952000
*                                                                  0484 00953000
*                              WORKPTR3=FDTPTR(PARMID);            0485 00954000
         LH    @15,PARMID                                          0485 00955000
         SLA   @15,2                                               0485 00956000
         L     @01,FDTADDR                                         0485 00957000
         L     @15,FDTPTR-4(@15,@01)                               0485 00958000
         ST    @15,WORKPTR3                                        0485 00959000
*                              IF TESTRC=0                         0486 00960000
*                                THEN                              0486 00961000
         LH    @15,TESTRC                                          0486 00962000
         LTR   @15,@15                                             0486 00963000
         BNZ   @RF00486                                            0486 00964000
*                                  DO INDEX=1 TO VECTRNUM;         0487 00965000
         LA    @15,1                                               0487 00966000
         B     @DE00487                                            0487 00967000
@DL00487 DS    0H                                                  0488 00968000
*                                    WORKPTR3->DATABLK(1:VECTRLEN)=     00969000
*                                      WORKPTR2->DATABLK(1:VECTRLEN);   00970000
         L     @14,WORKPTR3                                        0488 00971000
         LH    @05,VECTRLEN                                        0488 00972000
         LR    @04,@05                                             0488 00973000
         BCTR  @04,0                                               0488 00974000
         L     @03,WORKPTR2                                        0488 00975000
         EX    @04,@SM01319                                        0488 00976000
*                                    WORKPTR3=WORKPTR3+VECTRLEN;   0489 00977000
         ALR   @14,@05                                             0489 00978000
         ST    @14,WORKPTR3                                        0489 00979000
*                                    WORKPTR2=                     0490 00980000
*                                      (WORKPTR2+VECTRLEN)->VECTRPTR;   00981000
         ALR   @03,@05                                             0490 00982000
         L     @14,VECTRPTR(,@03)                                  0490 00983000
         ST    @14,WORKPTR2                                        0490 00984000
*                                  END;                            0491 00985000
         AL    @15,@CF00172                                        0491 00986000
@DE00487 STH   @15,INDEX                                           0491 00987000
         CH    @15,VECTRNUM                                        0491 00988000
         BNH   @DL00487                                            0491 00989000
*                                ELSE                              0492 00990000
*                                                                  0492 00991000
*                                  CALL ERROR1(NOSPACE);           0492 00992000
*                                                                  0492 00993000
         B     @RC00486                                            0492 00994000
@RF00486 LA    @01,@AL00492                                        0492 00995000
         BAL   @14,ERROR1                                          0492 00996000
*                              CALL ICKSAFP0(GDTTBL,RIPOOLID);     0493 00997000
*                                                                  0493 00998000
@RC00486 L     @15,GDTPTR                                          0493 00999000
         ST    @15,@AL00001                                        0493 01000000
         LA    @14,RIPOOLID                                        0493 01001000
         ST    @14,@AL00001+4                                      0493 01002000
         MVI   @AL00001+4,X'80'                                    0493 01003000
         L     @15,GDTFPL(,@15)                                    0493 01004000
         LA    @01,@AL00001                                        0493 01005000
         BALR  @14,@15                                             0493 01006000
*                              END DOGRP7;                         0494 01007000
*                          END DOGRP6;                             0495 01008000
@RF00471 DS    0H                                                  0496 01009000
*                    END DOLOOP7;                                  0496 01010000
*                                                                  0496 01011000
@RF00460 LA    @15,1                                               0496 01012000
         AH    @15,PARMID                                          0496 01013000
@DE00459 STH   @15,PARMID                                          0496 01014000
         L     @14,DESCPTR                                         0496 01015000
         CH    @15,MAXID(,@14)                                     0496 01016000
         BNH   @DL00459                                            0496 01017000
@DC00459 DS    0H                                                  0497 01018000
*                /****************************************************/ 01019000
*                /*                                                  */ 01020000
*                /* IN PREPARATION FOR PICKING UP THE NEXT COMMAND,  */ 01021000
*                /* BYPASS ALL CHARACTERS ASSOCIATED WITH THE CURRENT*/ 01022000
*                /* COMMAND.                                         */ 01023000
*                /*                                                  */ 01024000
*                /****************************************************/ 01025000
*                DO WHILE(MORTOCOM=YES & RISTATUS=0);              0497 01026000
*                                                                  0497 01027000
@RF00458 B     @DE00497                                            0497 01028000
@DL00497 DS    0H                                                  0498 01029000
*                  CALL NEXTCHAR;                                  0498 01030000
         BAL   @14,NEXTCHAR                                        0498 01031000
*                  CALL SKIPCMD;                                   0499 01032000
*                                                                  0499 01033000
         BAL   @14,SKIPCMD                                         0499 01034000
*                END;                                              0500 01035000
@DE00497 TM    MORTOCOM,B'00010000'                                0500 01036000
         BNO   @DC00497                                            0500 01037000
         LH    @15,RISTATUS                                        0500 01038000
         LTR   @15,@15                                             0500 01039000
         BZ    @DL00497                                            0500 01040000
@DC00497 DS    0H                                                  0501 01041000
*              END DOGRP5;                                         0501 01042000
*                                                                  0501 01043000
*            /********************************************************/ 01044000
*            /*                                                      */ 01045000
*            /* THE END OF THE CURRENT COMMAND HAS NOT BEEN REACHED  */ 01046000
*            /*                                                      */ 01047000
*            /********************************************************/ 01048000
*            ELSE                                                  0502 01049000
*              IF SUPERID(PARMLVL)=0                               0502 01050000
*                  THEN                                            0502 01051000
*                                                                  0502 01052000
         B     @RC00434                                            0502 01053000
@RF00434 LH    @15,PARMLVL                                         0502 01054000
         ALR   @15,@15                                             0502 01055000
         LH    @15,SUPERID-2(@15)                                  0502 01056000
         LTR   @15,@15                                             0502 01057000
         BNZ   @RF00502                                            0502 01058000
*                    /************************************************/ 01059000
*                    /*                                              */ 01060000
*                    /* IF FIRST-LEVEL PARAMETERS ARE BEING SCANNED  */ 01061000
*                    /* AND THE SCAN CURRENTLY POINTS TO A CLOSING   */ 01062000
*                    /* PARENTHESIS, THEN TOO MANY PARENTHESES HAVE  */ 01063000
*                    /* BEEN CODED AND WILL THEREFORE BE IGNORED.    */ 01064000
*                    /* A WARNING MESSAGE IS ISSUED.                 */ 01065000
*                    /*                                              */ 01066000
*                    /************************************************/ 01067000
*DOGRP10:            DO;                                           0503 01068000
DOGRP10  DS    0H                                                  0504 01069000
*                    OLDERID2 = NEWERID2;                          0504 01070000
         L     @01,GDTPTR                                          0504 01071000
         L     @15,GDTTR2(,@01)                                    0504 01072000
         MVC   @TS00001(95),NEWERID2(@15)                          0504 01073000
         MVC   OLDERID2(95,@15),@TS00001                           0504 01074000
*                    NEWID2='RI02';                                0505 01075000
         MVC   NEWID2(4,@15),@CC00836                              0505 01076000
*                    IF CHAR1 = CLOSING                            0506 01077000
*                      THEN                                        0506 01078000
         CLI   CHAR1,C')'                                          0506 01079000
         BNE   @RF00506                                            0506 01080000
*                        DO WHILE(RISTATUS=0 & CHAR1=CLOSING);     0507 01081000
         B     @DE00507                                            0507 01082000
@DL00507 DS    0H                                                  0508 01083000
*                          DARGSMOD=RISTID;                        0508 01084000
         L     @15,DDSTRU                                          0508 01085000
         MVC   DARGSMOD(3,@15),RISTID                              0508 01086000
*                          DARGSENT=TOOMANY;                       0509 01087000
*                                                                  0509 01088000
         MVI   DARGSENT(@15),X'22'                                 0509 01089000
*                          CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);   0510 01090000
*                                                                  0510 01091000
         L     @15,GDTPTR                                          0510 01092000
         ST    @15,@AL00001                                        0510 01093000
         LA    @14,@CF00102                                        0510 01094000
         ST    @14,@AL00001+4                                      0510 01095000
         LA    @14,DDSTRU                                          0510 01096000
         ST    @14,@AL00001+8                                      0510 01097000
         MVI   @AL00001+8,X'80'                                    0510 01098000
         L     @15,GDTPRT(,@15)                                    0510 01099000
         LA    @01,@AL00001                                        0510 01100000
         BALR  @14,@15                                             0510 01101000
*                          CALL NEXTCHAR;                          0511 01102000
         BAL   @14,NEXTCHAR                                        0511 01103000
*                          CALL SCANSEP(YES);                      0512 01104000
*                                                                  0512 01105000
         LA    @01,@AL00512                                        0512 01106000
         BAL   @14,SCANSEP                                         0512 01107000
*                        END;                                      0513 01108000
*                                                                  0513 01109000
@DE00507 LH    @15,RISTATUS                                        0513 01110000
         LTR   @15,@15                                             0513 01111000
         BNZ   @DC00507                                            0513 01112000
         CLI   CHAR1,C')'                                          0513 01113000
         BE    @DL00507                                            0513 01114000
@DC00507 DS    0H                                                  0514 01115000
*                    /**********************************************/   01116000
*                    /*                                            */   01117000
*                    /* IF COMMAND END HAS NOT BEEN FOUND, THEN    */   01118000
*                    /* EXTRACT A FIRST-LEVEL PARAMETER, AFTER     */   01119000
*                    /* CHECKING THE DESCRIPTOR LIST TO SEE IF IT  */   01120000
*                    /* IS TO BE A POSITIONAL OR KEYWORD PARAMETER.*/   01121000
*                    /*                                            */   01122000
*                    /**********************************************/   01123000
*                    IF RISTATUS^=0 | CHAR1=ENDDELIM               0514 01124000
*                      THEN;                                       0514 01125000
@RF00506 LH    @15,RISTATUS                                        0514 01126000
         LTR   @15,@15                                             0514 01127000
         BNZ   @RT00514                                            0514 01128000
         CLI   CHAR1,C';'                                          0514 01129000
         BE    @RT00514                                            0514 01130000
*                      ELSE                                        0516 01131000
*                                                                  0516 01132000
*                        /******************************************/   01133000
*                        /*                                        */   01134000
*                        /* IF NO LIST OF POSITIONAL PARAMETERS IS */   01135000
*                        /* SPECIFIED IN THE DESCRIPTOR, THEN ALL  */   01136000
*                        /* FIRST-LEVEL PARM'S ARE KEYWORD PARM'S. */   01137000
*                        /* ALSO, IF ALL FIRST-LEVEL POSITIONALS   */   01138000
*                        /* HAVE BEEN EXTRACTED, EXPECT A KEYWORD. */   01139000
*                        /* IF NEITHER OF THE ABOVE, EXPECT A      */   01140000
*                        /* POSITIONAL PARAMETER.                  */   01141000
*                        /*                                        */   01142000
*                        /******************************************/   01143000
*                        IF POSDSPL=0 |                            0516 01144000
*                           PPARMCNT(PARMLVL) > VPOSCNT            0516 01145000
*                          THEN                                    0516 01146000
*                                                                  0516 01147000
         L     @15,DESCPTR                                         0516 01148000
         CLI   POSDSPL(@15),0                                      0516 01149000
         BE    @RT00516                                            0516 01150000
         LH    @14,PARMLVL                                         0516 01151000
         ALR   @14,@14                                             0516 01152000
         SLR   @05,@05                                             0516 01153000
         IC    @05,POSDSPL(,@15)                                   0516 01154000
         ALR   @05,@05                                             0516 01155000
         ALR   @15,@05                                             0516 01156000
         LH    @14,PPARMCNT-2(@14)                                 0516 01157000
         CH    @14,VPOSCNT(,@15)                                   0516 01158000
         BNH   @RF00516                                            0516 01159000
@RT00516 DS    0H                                                  0517 01160000
*                            CALL KWDPARM;                         0517 01161000
*                                                                  0517 01162000
         BAL   @14,KWDPARM                                         0517 01163000
*                          ELSE                                    0518 01164000
*                            DO;                                   0518 01165000
         B     @RC00516                                            0518 01166000
@RF00516 DS    0H                                                  0519 01167000
*                            PARMID=                               0519 01168000
*                                VPOSID(PPARMCNT(PARMLVL));        0519 01169000
*                                                                  0519 01170000
         LH    @15,PARMLVL                                         0519 01171000
         ALR   @15,@15                                             0519 01172000
         LH    @15,PPARMCNT-2(@15)                                 0519 01173000
         ALR   @15,@15                                             0519 01174000
         L     @14,DESCPTR                                         0519 01175000
         SLR   @05,@05                                             0519 01176000
         IC    @05,POSDSPL(,@14)                                   0519 01177000
         ALR   @05,@05                                             0519 01178000
         ALR   @14,@05                                             0519 01179000
         LH    @15,VPOSID-2(@15,@14)                               0519 01180000
         STH   @15,PARMID                                          0519 01181000
*                            CALL POSPARM;                         0520 01182000
*                                                                  0520 01183000
         BAL   @14,POSPARM                                         0520 01184000
*                            END;                                  0521 01185000
*                    END DOGRP10;                                  0522 01186000
*                  ELSE                                            0523 01187000
*                                                                  0523 01188000
*                    /************************************************/ 01189000
*                    /*                                              */ 01190000
*                    /* IF A SUBPARAMETER LIST IS BEING SCANNED AND  */ 01191000
*                    /* THE SCAN CURRENTLY POINTS TO A CLOSING       */ 01192000
*                    /* PARENTHESIS, THEN THE CURRENT SUBPARAMETER   */ 01193000
*                    /* LIST SCAN IS FINISHED.  MAKE SURE THAT SOME  */ 01194000
*                    /* SUBPARAMETERS WERE FOUND.                    */ 01195000
*                    /*                                              */ 01196000
*                    /************************************************/ 01197000
*                    IF CHAR1=CLOSING                              0523 01198000
*                      THEN                                        0523 01199000
         B     @RC00502                                            0523 01200000
@RF00502 CLI   CHAR1,C')'                                          0523 01201000
         BNE   @RF00523                                            0523 01202000
*                        IF SUBSYET=NO                             0524 01203000
*                          THEN                                    0524 01204000
*                                                                  0524 01205000
         TM    SUBSYET,B'00010000'                                 0524 01206000
         BNZ   @RF00524                                            0524 01207000
*                            CALL ERROR2(BADELIM1,LENGTH(CHAR1),   0525 01208000
*                                        ADDR(CHAR1));             0525 01209000
*                                                                  0525 01210000
         MVC   @AL00001(8),@AL00525                                0525 01211000
         LA    @15,CHAR1                                           0525 01212000
         ST    @15,@AFTEMPS+12                                     0525 01213000
         LA    @15,@AFTEMPS+12                                     0525 01214000
         ST    @15,@AL00001+8                                      0525 01215000
         LA    @01,@AL00001                                        0525 01216000
         BAL   @14,ERROR2                                          0525 01217000
*                          ELSE                                    0526 01218000
*                            DO;                                   0526 01219000
         B     @RC00524                                            0526 01220000
@RF00524 DS    0H                                                  0527 01221000
*                              PARMID=SUPERID(PARMLVL);            0527 01222000
*                                                                  0527 01223000
         LH    @15,PARMLVL                                         0527 01224000
         ALR   @15,@15                                             0527 01225000
         LH    @15,SUPERID-2(@15)                                  0527 01226000
         STH   @15,PARMID                                          0527 01227000
*                              CALL NEXTCHAR;                      0528 01228000
*                                                                  0528 01229000
         BAL   @14,NEXTCHAR                                        0528 01230000
*                              IF RISTATUS=0                       0529 01231000
*                                THEN                              0529 01232000
         LH    @15,RISTATUS                                        0529 01233000
         LTR   @15,@15                                             0529 01234000
         BNZ   @RF00529                                            0529 01235000
*                                  IF REPEATED=NO                  0530 01236000
*                                    THEN                          0530 01237000
         LH    @15,PARMID                                          0530 01238000
         MH    @15,@CH00038                                        0530 01239000
         L     @01,WORKPTR                                         0530 01240000
         AL    @01,@CF01317                                        0530 01241000
         L     @01,PARMPTR(@15,@01)                                0530 01242000
         TM    REPEATED(@01),B'00100000'                           0530 01243000
         BNZ   @RF00530                                            0530 01244000
*                                      DO;                         0531 01245000
*                                                                  0531 01246000
*                                      CALL SCANSEP(YES);          0532 01247000
*                                                                  0532 01248000
         LA    @01,@AL00532                                        0532 01249000
         BAL   @14,SCANSEP                                         0532 01250000
*                                      PARMLVL=PARMLVL-1;          0533 01251000
         LH    @15,PARMLVL                                         0533 01252000
         BCTR  @15,0                                               0533 01253000
         STH   @15,PARMLVL                                         0533 01254000
*                                      END;                        0534 01255000
*                                                                  0534 01256000
*                                    /********************************/ 01257000
*                                    /*                              */ 01258000
*                                    /* WHEN CURRENTLY SCANNING      */ 01259000
*                                    /* WITHIN A REPEATED SUBPARM.   */ 01260000
*                                    /* LIST, TREAT EACH SUBLIST     */ 01261000
*                                    /* SEPARATELY, APPLYING DEFAULTS*/ 01262000
*                                    /* AND PERFORMING SEMANTIC      */ 01263000
*                                    /* CHECKING.                    */ 01264000
*                                    /*                              */ 01265000
*                                    /********************************/ 01266000
*                                    ELSE                          0535 01267000
*                                                                  0535 01268000
*                                      CALL INREPEAT;              0535 01269000
*                                                                  0535 01270000
         B     @RC00530                                            0535 01271000
@RF00530 BAL   @14,INREPEAT                                        0535 01272000
*                            END;                                  0536 01273000
*                                                                  0536 01274000
*                      /**********************************************/ 01275000
*                      /*                                            */ 01276000
*                      /* A SUBPARAMETER LIST HAS ADDITIONAL         */ 01277000
*                      /* SUBPARAMETERS TO BE SCANNED.               */ 01278000
*                      /*                                            */ 01279000
*                      /**********************************************/ 01280000
*                      ELSE                                        0537 01281000
*                                                                  0537 01282000
*                        /********************************************/ 01283000
*                        /*                                          */ 01284000
*                        /* EXAMINE THE DESCRIPTOR SUBPARM LIST FOR  */ 01285000
*                        /* THIS PARAMETER TO SEE IF A POSITIONAL    */ 01286000
*                        /* PARM. REMAINS TO BE EXTRACTED OR IF A    */ 01287000
*                        /* KEYWORD PARAMETER SHOULD BE PICKED UP.   */ 01288000
*                        /*                                          */ 01289000
*                        /********************************************/ 01290000
*DOGRP15:                DO;                                       0537 01291000
         B     @RC00523                                            0537 01292000
@RF00523 DS    0H                                                  0537 01293000
DOGRP15  DS    0H                                                  0538 01294000
*                          SUBSYET=YES;                            0538 01295000
         OI    SUBSYET,B'00010000'                                 0538 01296000
*                          PARMID=SUPERID(PARMLVL);                0539 01297000
         LH    @15,PARMLVL                                         0539 01298000
         ALR   @15,@15                                             0539 01299000
         LH    @14,SUPERID-2(@15)                                  0539 01300000
         STH   @14,PARMID                                          0539 01301000
*                          IF PPARMCNT(PARMLVL) <= SUBCOUNT        0540 01302000
*                            THEN                                  0540 01303000
         LH    @15,PPARMCNT-2(@15)                                 0540 01304000
         LA    @05,12                                              0540 01305000
         LR    @01,@14                                             0540 01306000
         MR    @00,@05                                             0540 01307000
         L     @14,WORKPTR                                         0540 01308000
         AL    @14,@CF01317                                        0540 01309000
         L     @14,PARMPTR(@01,@14)                                0540 01310000
         ALR   @05,@14                                             0540 01311000
         SLR   @04,@04                                             0540 01312000
         IC    @04,SUBDSPL(,@05)                                   0540 01313000
         ALR   @04,@04                                             0540 01314000
         ALR   @14,@04                                             0540 01315000
         CH    @15,SUBCOUNT(,@14)                                  0540 01316000
         BH    @RF00540                                            0540 01317000
*                              DO;                                 0541 01318000
*                              OLDERID2 = NEWERID2;                0542 01319000
         L     @01,GDTPTR                                          0542 01320000
         L     @05,GDTTR2(,@01)                                    0542 01321000
         MVC   @TS00001(95),NEWERID2(@05)                          0542 01322000
         MVC   OLDERID2(95,@05),@TS00001                           0542 01323000
*                              NEWID2='RI03';                      0543 01324000
         MVC   NEWID2(4,@05),@CC00842                              0543 01325000
*                              IF PARMTYPE(PPARMCNT(PARMLVL)) = 'K'     01326000
*                                THEN                              0544 01327000
*                                                                  0544 01328000
         SLA   @15,2                                               0544 01329000
         ALR   @14,@15                                             0544 01330000
         BCTR  @14,0                                               0544 01331000
         BCTR  @14,0                                               0544 01332000
         CLI   PARMTYPE-2(@14),C'K'                                0544 01333000
         BNE   @RF00544                                            0544 01334000
*                                  CALL KWDPARM;                   0545 01335000
*                                                                  0545 01336000
         BAL   @14,KWDPARM                                         0545 01337000
*                                ELSE                              0546 01338000
*                                  DO;                             0546 01339000
         B     @RC00544                                            0546 01340000
@RF00544 DS    0H                                                  0547 01341000
*                                  PARMID=SUBID(PPARMCNT(PARMLVL));     01342000
*                                                                  0547 01343000
         LH    @15,PARMLVL                                         0547 01344000
         ALR   @15,@15                                             0547 01345000
         LH    @15,PPARMCNT-2(@15)                                 0547 01346000
         SLA   @15,2                                               0547 01347000
         LA    @14,12                                              0547 01348000
         LR    @05,@14                                             0547 01349000
         MH    @05,PARMID                                          0547 01350000
         L     @01,WORKPTR                                         0547 01351000
         AL    @01,@CF01317                                        0547 01352000
         L     @05,PARMPTR(@05,@01)                                0547 01353000
         ALR   @14,@05                                             0547 01354000
         SLR   @04,@04                                             0547 01355000
         IC    @04,SUBDSPL(,@14)                                   0547 01356000
         ALR   @04,@04                                             0547 01357000
         ALR   @05,@04                                             0547 01358000
         LH    @15,SUBID-4(@15,@05)                                0547 01359000
         STH   @15,PARMID                                          0547 01360000
*                                  CALL POSPARM;                   0548 01361000
*                                                                  0548 01362000
         BAL   @14,POSPARM                                         0548 01363000
*                                  END;                            0549 01364000
*                              END;                                0550 01365000
*                                                                  0550 01366000
*                            /****************************************/ 01367000
*                            /*                                      */ 01368000
*                            /* IF NO SUBPARAMETERS OF THE CURRENT   */ 01369000
*                            /* SUPERPARAMETER REMAIN TO BE EXTRACTED*/ 01370000
*                            /* A SYNTAX ERROR HAS BEEN FOUND.       */ 01371000
*                            /*                                      */ 01372000
*                            /****************************************/ 01373000
*                            ELSE                                  0551 01374000
*                                                                  0551 01375000
*                              CALL ERROR2(BADPOS,LENGTH(ERRFIELD),     01376000
*                                          ADDR(ERRFIELD));        0551 01377000
*                                                                  0551 01378000
         B     @RC00540                                            0551 01379000
@RF00540 MVC   @AL00001(8),@AL00551                                0551 01380000
         LA    @15,ERRFIELD                                        0551 01381000
         ST    @15,@AFTEMPS+12                                     0551 01382000
         LA    @15,@AFTEMPS+12                                     0551 01383000
         ST    @15,@AL00001+8                                      0551 01384000
         LA    @01,@AL00001                                        0551 01385000
         BAL   @14,ERROR2                                          0551 01386000
*                        END DOGRP15;                              0552 01387000
@RC00540 DS    0H                                                  0553 01388000
*        END DOLOOP5;                                              0553 01389000
@RC00523 DS    0H                                                  0553 01390000
@RC00502 DS    0H                                                  0553 01391000
@RC00434 DS    0H                                                  0553 01392000
@DE00431 TM    STMTEND,B'10000000'                                 0553 01393000
         BNZ   @DC00431                                            0553 01394000
         LH    @15,RISTATUS                                        0553 01395000
         LTR   @15,@15                                             0553 01396000
         BZ    @DL00431                                            0553 01397000
@DC00431 DS    0H                                                  0554 01398000
*/********************************************************************/ 01399000
*/*                                                                  */ 01400000
*/*  PROCEDURE NAME - GETNEXT                                        */ 01401000
*/*                                                                  */ 01402000
*/*  FUNCTION - THIS PROCEDURE OBTAINS THE VERB NAME AND POINTER TO  */ 01403000
*/*             THE PARAMETER SET OF THE NEXT FUNCTION COMMAND.      */ 01404000
*/*             MODAL COMMANDS ARE INTERPRETED TO DETERMINE OF THE   */ 01405000
*/*             NEXT FUNCTION COMMAND FOUND IS TO BE RETURNED IN     */ 01406000
*/*             ENCODED FORM TO THE DMS EXECUTIVE FOR EXECUTION.     */ 01407000
*/*             FUNCTION COMMANDS WHICH ARE NOT TO BE ENCODED OR     */ 01408000
*/*             RETURNED WILL SIMPLY BE EXAMINED FOR CORRECT SYNTAX  */ 01409000
*/*             AND THEN BYPASSED.  WHEN REQUIRED, A NEW INPUT RECORD*/ 01410000
*/*             IS READ IN ORDER TO OBTAIN THE NEXT FUNCTION OR MODAL*/ 01411000
*/*             COMMAND SYNTACTIC UNIT.                              */ 01412000
*/*                                                                  */ 01413000
*/*  INPUT -                                                         */ 01414000
*/*          SCANONLY - FLAG INDICATING WHETHER OR NOT THE CURRENT   */ 01415000
*/*                     COMMAND IS TO BE ENCODED INTO AN FDT OR JUST */ 01416000
*/*                     SCANNED FOR SYNTAX CHECKING.                 */ 01417000
*/*          RISTATUS - INTERNAL R/I CODE SET TO NON-ZERO CODE WHEN  */ 01418000
*/*                     AN ERROR HAS BEEN FOUND DURING R/I SCANNING. */ 01419000
*/*          LASTCC -   LAST SYSTEM CONDITION CODE                   */ 01420000
*/*          MAXCC -    MAXIMUM SYSTEM CONDITION CODE SO FAR         */ 01421000
*/*          SYNUNIT -  MOST RECENTLY EXTRACTED SYNTACTIC UNIT       */ 01422000
*/*          NESTLVL -  CURRENT 'IF' COMMAND NESTING LEVEL           */ 01423000
*/*          SINGLCMD - FLAG INDICATING THAT A SINGLE COMMAND (NOT A */ 01424000
*/*                     DO-GROUP) FOLLOWS AN 'IF' OR 'ELSE' COMMAND  */ 01425000
*/*          IFNEXT -   FLAG INDICATING THAT AN 'IF' COMMAND FOLLOWS */ 01426000
*/*                     AN 'IF' OR 'ELSE' COMMAND                    */ 01427000
*/*          NULLDO -   NUMBER OF NULL 'DO' COMMANDS FOUND AT CURRENT*/ 01428000
*/*                     'IF' NESTING LEVEL (A NULLDO COUNT EXISTS FOR*/ 01429000
*/*                     EACH LEVEL OF 'IF' NESTING)                  */ 01430000
*/*          DOFLAG -   INDICATES WHETHER OR NOT A DO-GROUP IS BEING */ 01431000
*/*                     SCANNED AT CURRENT 'IF' NESTING LEVEL        */ 01432000
*/*          THENFLAG - INDICATES WHETHER OR NOT THE 'THEN' PATH     */ 01433000
*/*                     COMMANDS ARE CURRENTLY BEING SCANNED AT      */ 01434000
*/*                     CURRENT LEVEL OF 'IF' NESTING.               */ 01435000
*/*          ELSEFLAG - FLAG INDICATING WHETHER OR NOT THE 'ELSE'    */ 01436000
*/*                     PATH COMMANDS ARE CURRENTLY BEING SCANNED    */ 01437000
*/*                     AT CURRENT LEVEL OF 'IF' NESTING             */ 01438000
*/*          SKIPFLAG - INDICATES WHETHER OR NOT COMMANDS AT CURRENT */ 01439000
*/*                     LEVEL OF 'IF' NESTING ARE TO BE EXECUTED.    */ 01440000
*/*          UNITINDX - LENGTH OF MOST RECENTLY EXTRACTED SYNTACTIC  */ 01441000
*/*                     UNIT.                                        */ 01442000
*/*          GETVERB -  FLAG INDICATING WHETHER OR NOT THE NEXT      */ 01443000
*/*                     INPUT COMMAND VERB HAS BEEN EXTRACTED.       */ 01444000
*/*                                                                  */ 01445000
*/*  OUTPUT -                                                        */ 01446000
*/*          VERBNAME - NAME OF FUNCTION COMMAND VERB WHOSE PARAMETER*/ 01447000
*/*                     PARAMETER SET WILL NEXT BE SCANNED.          */ 01448000
*/*          SCANONLY - FLAG NOTING WHETHER OR NOT NEXT FUNCTION     */ 01449000
*/*                     COMMAND IS TO BE EXECUTED.                   */ 01450000
*/*          IFNEXT -   FLAG SET 'ON' WHEN COMMAND FOLLOWING A 'THEN'*/ 01451000
*/*                     OR 'ELSE' IS AN 'IF' MODAL COMMAND.          */ 01452000
*/*          SINGLCMD - FLAG SET 'ON' WHEN A SINGLE COMMAND (NOT A   */ 01453000
*/*                     DO-GROUP) FOLLOWS THE 'THEN' OR 'ELSE' JUST  */ 01454000
*/*                     SCANNED.                                     */ 01455000
*/*          MAXCC -    MAX. SYSTEM CONDITION CODE; RESET BASED UPON */ 01456000
*/*                     EVALUATION OF 'IF' MODAL COMMANDS            */ 01457000
*/*          LASTCC -   LAST SYSTEM CONDITION CODE; SET BASED UPON   */ 01458000
*/*                     EVALUATION OF 'IF' COMMANDS AND UPON MODAL   */ 01459000
*/*                     COMMAND ERRORS FOUND.                        */ 01460000
*/*          EOFOK -    FLAG SET 'ON' WHEN SCANNING BETWEEN COMMANDS */ 01461000
*/*                     TO SIGNAL THAT EOF MAY BE PROPERLY FOUND.    */ 01462000
*/*          GETVERB -  FLAG SET 'ON' WHEN THE NEXT COMMAND VERB HAS */ 01463000
*/*                     ALREADY BEEN EXTRACTED FOLLOWING A 'THEN' OR */ 01464000
*/*                     'ELSE'.                                      */ 01465000
*/*          RISTATUS - R/I INTERNAL STATUS CODE; SET TO A NON-ZERO  */ 01466000
*/*                     CODE WHEN ANY ERROR IS FOUND.                */ 01467000
*/*          NESTLVL -  LEVEL OF 'IF' NESTING AT WHICH SCANNING IS   */ 01468000
*/*                     CURRENTLY TAKING PLACE.                      */ 01469000
*/*          NULLDO -   NULL DO COMMANDS ENCOUNTERED WHILE SCANNING  */ 01470000
*/*                     AT CURRENT LEVEL OF 'IF' NESTING             */ 01471000
*/*          DOFLAG -   FLAG SET 'ON' WHEN SCANNING WITHIN A DO-GROUP*/ 01472000
*/*                     AT CURRENT LEVEL OF 'IF' NESTING             */ 01473000
*/*                                                                  */ 01474000
*/********************************************************************/ 01475000
*GETNEXT:PROCEDURE;                                                0554 01476000
         B     @PB00004                                            0554 01477000
GETNEXT  STM   @14,@12,@SA00004                                    0554 01478000
*        /************************************************************/ 01479000
*        /*                                                          */ 01480000
*        /* DATA DEFINITIONS FOR OBTAINING NEXT FUNCTION COMMAND     */ 01481000
*        /*                                                          */ 01482000
*        /************************************************************/ 01483000
*                                                                  0555 01484000
*        DCL RELATION CHAR(32);        /*FIELD TO CONTAIN EXTRACTED     01485000
*                                        'IF' COMMAND RELATIONAL   0555 01486000
*                                        EXPRESSION OR 'SET' COMMAND    01487000
*                                        ASSIGNMENT EXPRESSION.      */ 01488000
*        DCL RELSIZE  FIXED(15);       /*NUMBER OF EXTRACTED CHAR'S IN  01489000
*                                        ABOVE EXPRESSION.           */ 01490000
*        DCL PART1LEN FIXED(15);       /*LENGTH OF EITHER 'MAXCC' OR    01491000
*                                        'LASTCC' CONSTANT           */ 01492000
*                                                                  0557 01493000
*        DCL EQSIGN1  CHAR(1)          /*EQUAL SIGN                  */ 01494000
*                     CONSTANT('=');                               0558 01495000
*        DCL EQSIGN2  CHAR(2)          /*EQUAL SIGN                  */ 01496000
*                     CONSTANT('EQ');                              0559 01497000
*                                                                  0559 01498000
*        /*STATIC ERROR MESSAGE CODES                                */ 01499000
*        DCL BADELSE  FIXED(15)        /*IMPROPER 'ELSE' COMMAND     */ 01500000
*                     CONSTANT(28);                                0560 01501000
*        DCL BADDOEND FIXED(15)        /*IMPROPER 'DO' OR 'END'      */ 01502000
*                     CONSTANT(29);                                0561 01503000
*        DCL BADEXPR1 FIXED(15)        /*BAD EXPRESSION IN 'IF' CMD. */ 01504000
*                     CONSTANT(30);                                0562 01505000
*        DCL BADEXPR2 FIXED(15)        /*BAD EXPRESSION IN 'SET' CMD.*/ 01506000
*                     CONSTANT(31);                                0563 01507000
*        DCL NOTHEN   FIXED(15)        /*MISSING 'THEN' KEYWORD      */ 01508000
*                     CONSTANT(33);                                0564 01509000
*        DCL BADIFNST FIXED(15)        /*TOO MUCH 'IF' NESTING       */ 01510000
*                     CONSTANT(38);                                0565 01511000
*                                                                  0565 01512000
*        DCL 1 *,                                                  0566 01513000
*              2 NONMODAL BIT(1),      /*SIGNALS THAT A NON-MODAL  0566 01514000
*                                        COMMAND VERB HAS BEEN FOUND */ 01515000
*              2 REDOLVL0 BIT(1),      /*'IF' NESTING HAS RETURNED TO   01516000
*                                        A LEVEL OF ZERO FOLLOWING AN   01517000
*                                        'IF-THEN' MODAL COMMAND     */ 01518000
*              2 EXPREND  BIT(1),      /*SIGNALS THAT ALL OF THE   0566 01519000
*                                        RELATIONAL EXPRESSION HAS 0566 01520000
*                                        BEEN EXTRACTED.             */ 01521000
*              2 SINGLCMD BIT(1),      /*SIGNALS THAT A SINGLE COMMAND  01522000
*                                        (A NON-MODAL OR A 'SET' MODAL  01523000
*                                        COMMAND) FOLLOWS THE 'THEN'    01524000
*                                        OR 'ELSE' JUST SCANNED.     */ 01525000
*              2 IFNEXT   BIT(1),      /*AN 'IF' COMMAND FOLLOWS THE    01526000
*                                        THE CURRENT 'THEN' OR 'ELSE'*/ 01527000
*              2 GETVERB  BIT(1);      /*EXTRACT THE NEXT COMMAND VERB  01528000
*                                        BEFORE RESUMING SEARCH FOR     01529000
*                                        FUNCTION COMMAND.           */ 01530000
*        /************************************************************/ 01531000
*        /*                                                          */ 01532000
*        /*  ** GETNEXT ** GET NEXT FUNCTION COMMAND                 */ 01533000
*        /*                                                          */ 01534000
*        /************************************************************/ 01535000
*        IF GDTDBG = NULLPTR                                       0567 01536000
*          THEN;                                                   0567 01537000
         L     @01,GDTPTR                                          0567 01538000
         L     @15,GDTDBG(,@01)                                    0567 01539000
         LTR   @15,@15                                             0567 01540000
         BZ    @RT00567                                            0567 01541000
*          ELSE                                                    0569 01542000
*            CALL ICKDB010(GDTTBL,'RIGN');                         0569 01543000
*                                                                  0569 01544000
         L     @15,GDTPTR                                          0569 01545000
         ST    @15,@AL00001                                        0569 01546000
         LA    @14,@CC00868                                        0569 01547000
         ST    @14,@AL00001+4                                      0569 01548000
         MVI   @AL00001+4,X'80'                                    0569 01549000
         L     @15,GDTDBG(,@15)                                    0569 01550000
         LA    @01,@AL00001                                        0569 01551000
         BALR  @14,@15                                             0569 01552000
*        /************************************************************/ 01553000
*        /*                                                          */ 01554000
*        /* PICK UP THE FIRST COMMAND VERB ENCOUNTERED, BYPASSING    */ 01555000
*        /* DELIMITING SEPARATOR CHARACTERS WHICH SURROUND IT.       */ 01556000
*        /*                                                          */ 01557000
*        /************************************************************/ 01558000
*        NULLCMD=NO;                                               0570 01559000
@RT00567 NI    NULLCMD,B'10111111'                                 0570 01560000
*        COMMENT=NO;                                               0571 01561000
*        FIRSTCHR=YES;                                             0572 01562000
         OI    FIRSTCHR,B'00000100'                                0572 01563000
         NI    COMMENT,B'10111111'                                 0572 01564000
*        CHAR1=BLANK;                                              0573 01565000
*                                                                  0573 01566000
         MVI   CHAR1,C' '                                          0573 01567000
*        CALL SCANSEP(NO);                                         0574 01568000
         LA    @01,@AL00574                                        0574 01569000
         BAL   @14,SCANSEP                                         0574 01570000
*        CALL NXTFIELD(VERBFLD);                                   0575 01571000
         LA    @01,@AL00575                                        0575 01572000
         BAL   @14,NXTFIELD                                        0575 01573000
*        CALL SCANSEP(NO);                                         0576 01574000
*                                                                  0576 01575000
         LA    @01,@AL00576                                        0576 01576000
         BAL   @14,SCANSEP                                         0576 01577000
*        /************************************************************/ 01578000
*        /*                                                          */ 01579000
*        /* SCAN AND INTERPRET INPUT COMMANDS UNTIL A NON-MODAL      */ 01580000
*        /* (FUNCTION) COMMAND IS FOUND.  EACH PASS OF THE FOLLOWING */ 01581000
*        /* SECTION OF CODE BEGINS BY COMPUTING THE CURRENT MAXIMUM  */ 01582000
*        /* SYSTEM CONDITION CODE AND EXAMINING A VERB NAME JUST     */ 01583000
*        /* EXTRACTED.  APPROPRIATE FLAGS ARE SET BASED UPON THE     */ 01584000
*        /* MODAL STATEMENTS ENCOUNTERED.                            */ 01585000
*        /*                                                          */ 01586000
*        /************************************************************/ 01587000
*        NONMODAL=NO;                                              0577 01588000
*        IFNEXT=NO;                                                0578 01589000
*        SINGLCMD=NO;                                              0579 01590000
         NI    NONMODAL,B'01100111'                                0579 01591000
*DOLOOP10:DO WHILE(NONMODAL=NO & RISTATUS=0);                      0580 01592000
DOLOOP10 B     @DE00580                                            0580 01593000
@DL00580 DS    0H                                                  0581 01594000
*          EOFOK=NO;                                               0581 01595000
         NI    EOFOK,B'10111111'                                   0581 01596000
*          GETVERB=YES;                                            0582 01597000
*          REDOLVL0=NO;                                            0583 01598000
*                                                                  0583 01599000
         OI    GETVERB,B'00000100'                                 0583 01600000
         NI    REDOLVL0,B'10111111'                                0583 01601000
*          /**********************************************************/ 01602000
*          /*                                                        */ 01603000
*          /* IF CURRENTLY NO 'IF' MODAL COMMAND NESTING, CHECK      */ 01604000
*          /* THE EXTRACTED VERB NAME TO SEE IF IT IS A MODAL COMMAND*/ 01605000
*          /* VERB.  IF SO, INTERPRET THAT MODAL COMMAND, SETTING    */ 01606000
*          /* CONTROL FLAGS; IF NOT A MODAL, 'GETNEXT' IS FINISHED.  */ 01607000
*          /*                                                        */ 01608000
*          /**********************************************************/ 01609000
*          IF NESTLVL=0                                            0584 01610000
*            THEN                                                  0584 01611000
         L     @01,GDTPTR                                          0584 01612000
         L     @15,GDTRIH(,@01)                                    0584 01613000
         CLI   NESTLVL(@15),0                                      0584 01614000
         BNE   @RF00584                                            0584 01615000
*              IF SYNUNIT=IFSYM                                    0585 01616000
*                THEN                                              0585 01617000
*                                                                  0585 01618000
         L     @01,KWTBLPTR(,@15)                                  0585 01619000
         CLC   SYNUNIT(9),IFSYM(@01)                               0585 01620000
         BNE   @RF00585                                            0585 01621000
*                  CALL MODALIF;                                   0586 01622000
*                                                                  0586 01623000
         BAL   @14,MODALIF                                         0586 01624000
*                ELSE                                              0587 01625000
*                  IF SYNUNIT=SETSYM                               0587 01626000
*                    THEN                                          0587 01627000
*                                                                  0587 01628000
         B     @RC00585                                            0587 01629000
@RF00585 L     @01,GDTPTR                                          0587 01630000
         L     @01,GDTRIH(,@01)                                    0587 01631000
         L     @01,KWTBLPTR(,@01)                                  0587 01632000
         CLC   SYNUNIT(9),SETSYM(@01)                              0587 01633000
         BNE   @RF00587                                            0587 01634000
*                      CALL MODALSET;                              0588 01635000
*                                                                  0588 01636000
         BAL   @14,MODALSET                                        0588 01637000
*                    ELSE                                          0589 01638000
*                      IF SYNUNIT=DOSYM | SYNUNIT=ENDSYM           0589 01639000
*                        THEN                                      0589 01640000
*                                                                  0589 01641000
         B     @RC00587                                            0589 01642000
@RF00587 L     @01,GDTPTR                                          0589 01643000
         L     @01,GDTRIH(,@01)                                    0589 01644000
         L     @15,KWTBLPTR(,@01)                                  0589 01645000
         CLC   SYNUNIT(9),DOSYM(@15)                               0589 01646000
         BE    @RT00589                                            0589 01647000
         CLC   SYNUNIT(9),ENDSYM(@15)                              0589 01648000
         BNE   @RF00589                                            0589 01649000
@RT00589 DS    0H                                                  0590 01650000
*                          /******************************************/ 01651000
*                          /*                                        */ 01652000
*                          /* 'DO' AND 'END' COMMANDS ARE SIMPLY     */ 01653000
*                          /* IGNORED AT THIS LEVEL.                 */ 01654000
*                          /*                                        */ 01655000
*                          /******************************************/ 01656000
*                                                                  0590 01657000
*                          CALL BYPASTRM;                          0590 01658000
*                                                                  0590 01659000
         BAL   @14,BYPASTRM                                        0590 01660000
*                        ELSE                                      0591 01661000
*                          IF SYNUNIT=ELSESYM                      0591 01662000
*                            THEN                                  0591 01663000
*                                                                  0591 01664000
         B     @RC00589                                            0591 01665000
@RF00589 L     @01,GDTPTR                                          0591 01666000
         L     @01,GDTRIH(,@01)                                    0591 01667000
         L     @01,KWTBLPTR(,@01)                                  0591 01668000
         CLC   SYNUNIT(9),ELSESYM(@01)                             0591 01669000
         BNE   @RF00591                                            0591 01670000
*                              /**************************************/ 01671000
*                              /*                                    */ 01672000
*                              /* AN 'ELSE' STATEMENT IS IN ERROR IF */ 01673000
*                              /* IT APPEARS AT THIS LEVEL.          */ 01674000
*                              /*                                    */ 01675000
*                              /**************************************/ 01676000
*                              DO;                                 0592 01677000
*                              LASTCC=TERMERR;                     0593 01678000
         MVC   LASTCC(2),@CH00274                                  0593 01679000
*                              RISTATUS=BADELSE;                   0594 01680000
         MVC   RISTATUS(2),@CH00298                                0594 01681000
*                              END;                                0595 01682000
*                            ELSE                                  0596 01683000
*                              NONMODAL=YES;                       0596 01684000
*                                                                  0596 01685000
         B     @RC00591                                            0596 01686000
@RF00591 OI    NONMODAL,B'10000000'                                0596 01687000
*          /********************************************************/   01688000
*          /*                                                      */   01689000
*          /* WHEN WITHIN SOME LEVEL OF 'IF' COMMAND NESTING,      */   01690000
*          /* MODAL COMMANDS ARE CHECKED TO BE SURE THAT THEY OCCUR*/   01691000
*          /* PROPERLY IN THE MODAL COMMAND STRUCTURE.  IF OKAY,   */   01692000
*          /* THE COMMAND IS INTERPRETED AND CONTROL FLAGS ARE SET.*/   01693000
*          /* IF NOT A MODAL COMMAND, 'GETNEXT' IS FINISHED.       */   01694000
*          /*                                                      */   01695000
*          /********************************************************/   01696000
*          ELSE                                                    0597 01697000
*                                                                  0597 01698000
*            /******************************************************/   01699000
*            /*                                                    */   01700000
*            /* AN 'ELSE' COMMAND MUST HAVE A MATCHING 'IF-THEN'   */   01701000
*            /* MODAL COMMAND OR IT IS AN ERROR.                   */   01702000
*            /*                                                    */   01703000
*            /******************************************************/   01704000
*            IF SYNUNIT=ELSESYM                                    0597 01705000
*              THEN                                                0597 01706000
         B     @RC00584                                            0597 01707000
@RF00584 L     @01,GDTPTR                                          0597 01708000
         L     @15,GDTRIH(,@01)                                    0597 01709000
         L     @01,KWTBLPTR(,@15)                                  0597 01710000
         CLC   SYNUNIT(9),ELSESYM(@01)                             0597 01711000
         BNE   @RF00597                                            0597 01712000
*                IF THENFLAG(NESTLVL)=ON & DOFLAG(NESTLVL)=OFF     0598 01713000
*                  THEN                                            0598 01714000
*                                                                  0598 01715000
         SLR   @14,@14                                             0598 01716000
         IC    @14,NESTLVL(,@15)                                   0598 01717000
         ALR   @14,@14                                             0598 01718000
         ALR   @15,@14                                             0598 01719000
         TM    THENFLAG-2(@15),B'01000000'                         0598 01720000
         BNO   @RF00598                                            0598 01721000
         TM    DOFLAG-2(@15),B'10000000'                           0598 01722000
         BNZ   @RF00598                                            0598 01723000
*                    CALL MODLELSE;                                0599 01724000
*                                                                  0599 01725000
         BAL   @14,MODLELSE                                        0599 01726000
*                  ELSE                                            0600 01727000
*                    DO;                                           0600 01728000
         B     @RC00598                                            0600 01729000
@RF00598 DS    0H                                                  0601 01730000
*                    LASTCC=TERMERR;                               0601 01731000
         MVC   LASTCC(2),@CH00274                                  0601 01732000
*                    RISTATUS=BADELSE;                             0602 01733000
         MVC   RISTATUS(2),@CH00298                                0602 01734000
*                    END;                                          0603 01735000
*              ELSE                                                0604 01736000
*DOGRP20:        DO;                                               0604 01737000
         B     @RC00597                                            0604 01738000
@RF00597 DS    0H                                                  0604 01739000
DOGRP20  DS    0H                                                  0605 01740000
*                OLDERID2 = NEWERID2;                              0605 01741000
         L     @01,GDTPTR                                          0605 01742000
         L     @15,GDTTR2(,@01)                                    0605 01743000
         MVC   @TS00001(95),NEWERID2(@15)                          0605 01744000
         MVC   OLDERID2(95,@15),@TS00001                           0605 01745000
*                NEWID2='RI04';                                    0606 01746000
*                                                                  0606 01747000
         MVC   NEWID2(4,@15),@CC00878                              0606 01748000
*                /****************************************************/ 01749000
*                /*                                                  */ 01750000
*                /* IF THERE IS NO MATCHING 'ELSE' FOR ONE OR MORE   */ 01751000
*                /* 'THEN' KEYWORDS, THEN ADJUST THE 'IF' NESTING    */ 01752000
*                /* LEVEL ONE LESS DEEP FOR EACH NONMATCH            */ 01753000
*                /*                                                  */ 01754000
*                /****************************************************/ 01755000
*                DO WHILE(NESTLVL>0 & SINGLCMD=NO & IFNEXT=NO &    0607 01756000
*                         DOFLAG(NESTLVL)=OFF);                    0607 01757000
         B     @DE00607                                            0607 01758000
@DL00607 DS    0H                                                  0608 01759000
*                  NESTLVL=NESTLVL-1;                              0608 01760000
         L     @01,GDTPTR                                          0608 01761000
         L     @15,GDTRIH(,@01)                                    0608 01762000
         SLR   @14,@14                                             0608 01763000
         IC    @14,NESTLVL(,@15)                                   0608 01764000
         BCTR  @14,0                                               0608 01765000
         STC   @14,NESTLVL(,@15)                                   0608 01766000
*                END;                                              0609 01767000
@DE00607 L     @01,GDTPTR                                          0609 01768000
         L     @15,GDTRIH(,@01)                                    0609 01769000
         CLI   NESTLVL(@15),0                                      0609 01770000
         BNH   @DC00607                                            0609 01771000
         TM    SINGLCMD,B'00011000'                                0609 01772000
         BNZ   @DC00607                                            0609 01773000
         SLR   @14,@14                                             0609 01774000
         IC    @14,NESTLVL(,@15)                                   0609 01775000
         ALR   @14,@14                                             0609 01776000
         ALR   @15,@14                                             0609 01777000
         TM    DOFLAG-2(@15),B'10000000'                           0609 01778000
         BZ    @DL00607                                            0609 01779000
@DC00607 DS    0H                                                  0610 01780000
*                IF NESTLVL=0                                      0610 01781000
*                  THEN                                            0610 01782000
         L     @01,GDTPTR                                          0610 01783000
         L     @01,GDTRIH(,@01)                                    0610 01784000
         CLI   NESTLVL(@01),0                                      0610 01785000
         BNE   @RF00610                                            0610 01786000
*                    REDOLVL0=YES;                                 0611 01787000
         OI    REDOLVL0,B'01000000'                                0611 01788000
*                  ELSE                                            0612 01789000
*                    IF SYNUNIT=IFSYM                              0612 01790000
*                      THEN                                        0612 01791000
*                                                                  0612 01792000
         B     @RC00610                                            0612 01793000
@RF00610 L     @01,GDTPTR                                          0612 01794000
         L     @01,GDTRIH(,@01)                                    0612 01795000
         L     @01,KWTBLPTR(,@01)                                  0612 01796000
         CLC   SYNUNIT(9),IFSYM(@01)                               0612 01797000
         BNE   @RF00612                                            0612 01798000
*                        CALL MODALIF;                             0613 01799000
*                                                                  0613 01800000
         BAL   @14,MODALIF                                         0613 01801000
*                      ELSE                                        0614 01802000
*                                                                  0614 01803000
*                        /********************************************/ 01804000
*                        /*                                          */ 01805000
*                        /* AN 'END' COMMAND NULLIFIES A MATCHING    */ 01806000
*                        /* 'DO' COMMAND. HOWEVER, IT IS AN ERROR IF */ 01807000
*                        /* NO MATCHING 'DO' EXISTS.  IF ALL IS OKAY,*/ 01808000
*                        /* THE 'END' IS BYPASSED & SCANNING RESUMES */ 01809000
*                        /*                                          */ 01810000
*                        /********************************************/ 01811000
*                        IF SYNUNIT=ENDSYM                         0614 01812000
*                          THEN                                    0614 01813000
         B     @RC00612                                            0614 01814000
@RF00612 L     @01,GDTPTR                                          0614 01815000
         L     @15,GDTRIH(,@01)                                    0614 01816000
         L     @01,KWTBLPTR(,@15)                                  0614 01817000
         CLC   SYNUNIT(9),ENDSYM(@01)                              0614 01818000
         BNE   @RF00614                                            0614 01819000
*                            DO;                                   0615 01820000
*                            IF NULLDO(NESTLVL)=0                  0616 01821000
*                              THEN                                0616 01822000
         SLR   @14,@14                                             0616 01823000
         IC    @14,NESTLVL(,@15)                                   0616 01824000
         LR    @05,@14                                             0616 01825000
         ALR   @05,@05                                             0616 01826000
         SLR   @04,@04                                             0616 01827000
         IC    @04,NULLDO-2(@05,@15)                               0616 01828000
         CH    @04,@CH00102                                        0616 01829000
         BNE   @RF00616                                            0616 01830000
*                                IF DOFLAG(NESTLVL)=ON             0617 01831000
*                                  THEN                            0617 01832000
         ST    @05,@TF00001                                        0617 01833000
         ALR   @05,@15                                             0617 01834000
         TM    DOFLAG-2(@05),B'10000000'                           0617 01835000
         BNO   @RF00617                                            0617 01836000
*                                    DO;                           0618 01837000
*                                    DOFLAG(NESTLVL)=OFF;          0619 01838000
         LR    @01,@15                                             0619 01839000
         AL    @01,@TF00001                                        0619 01840000
         NI    DOFLAG-2(@01),B'01111111'                           0619 01841000
*                                    IF ELSEFLAG(NESTLVL)=ON       0620 01842000
*                                      THEN                        0620 01843000
         LR    @01,@15                                             0620 01844000
         AL    @01,@TF00001                                        0620 01845000
         TM    ELSEFLAG-2(@01),B'00100000'                         0620 01846000
         BNO   @RF00620                                            0620 01847000
*                                        NESTLVL=NESTLVL-1;        0621 01848000
         BCTR  @14,0                                               0621 01849000
         STC   @14,NESTLVL(,@15)                                   0621 01850000
*                                    END;                          0622 01851000
*                                  ELSE                            0623 01852000
*                                    DO;                           0623 01853000
         B     @RC00617                                            0623 01854000
@RF00617 DS    0H                                                  0624 01855000
*                                    LASTCC=TERMERR;               0624 01856000
         MVC   LASTCC(2),@CH00274                                  0624 01857000
*                                    RISTATUS=BADDOEND;            0625 01858000
         MVC   RISTATUS(2),@CH00300                                0625 01859000
*                                    END;                          0626 01860000
*                              ELSE                                0627 01861000
*                                NULLDO(NESTLVL)=NULLDO(NESTLVL)-1;     01862000
         B     @RC00616                                            0627 01863000
@RF00616 L     @01,GDTPTR                                          0627 01864000
         L     @15,GDTRIH(,@01)                                    0627 01865000
         SLR   @14,@14                                             0627 01866000
         IC    @14,NESTLVL(,@15)                                   0627 01867000
         ALR   @14,@14                                             0627 01868000
         SLR   @05,@05                                             0627 01869000
         IC    @05,NULLDO-2(@14,@15)                               0627 01870000
         BCTR  @05,0                                               0627 01871000
         STC   @05,NULLDO-2(@14,@15)                               0627 01872000
*                            IF SINGLCMD=YES                       0628 01873000
*                              THEN                                0628 01874000
@RC00616 TM    SINGLCMD,B'00010000'                                0628 01875000
         BNO   @RF00628                                            0628 01876000
*                                DO;                               0629 01877000
*                                LASTCC=TERMERR;                   0630 01878000
         MVC   LASTCC(2),@CH00274                                  0630 01879000
*                                RISTATUS=BADDOEND;                0631 01880000
         MVC   RISTATUS(2),@CH00300                                0631 01881000
*                                END;                              0632 01882000
*                              ELSE                                0633 01883000
*                                                                  0633 01884000
*                                CALL BYPASTRM;                    0633 01885000
*                                                                  0633 01886000
         B     @RC00628                                            0633 01887000
@RF00628 BAL   @14,BYPASTRM                                        0633 01888000
*                            END;                                  0634 01889000
*                          ELSE                                    0635 01890000
*                            IF SYNUNIT=SETSYM                     0635 01891000
*                              THEN                                0635 01892000
*                                                                  0635 01893000
         B     @RC00614                                            0635 01894000
@RF00614 L     @01,GDTPTR                                          0635 01895000
         L     @01,GDTRIH(,@01)                                    0635 01896000
         L     @01,KWTBLPTR(,@01)                                  0635 01897000
         CLC   SYNUNIT(9),SETSYM(@01)                              0635 01898000
         BNE   @RF00635                                            0635 01899000
*                                CALL MODALSET;                    0636 01900000
*                                                                  0636 01901000
         BAL   @14,MODALSET                                        0636 01902000
*                              ELSE                                0637 01903000
*                                                                  0637 01904000
*                                /************************************/ 01905000
*                                /*                                  */ 01906000
*                                /* A 'DO' COMMAND NOT FOLLOWING AN  */ 01907000
*                                /* 'IF' OR AN 'ELSE' COMMAND IS JUST*/ 01908000
*                                /* BYPASSED AFTER NOTING THAT THE   */ 01909000
*                                /* 'END' WILL BE BYPASSED TOO       */ 01910000
*                                /*                                  */ 01911000
*                                /************************************/ 01912000
*                                IF SYNUNIT=DOSYM                  0637 01913000
*                                  THEN                            0637 01914000
         B     @RC00635                                            0637 01915000
@RF00635 L     @01,GDTPTR                                          0637 01916000
         L     @15,GDTRIH(,@01)                                    0637 01917000
         L     @01,KWTBLPTR(,@15)                                  0637 01918000
         CLC   SYNUNIT(9),DOSYM(@01)                               0637 01919000
         BNE   @RF00637                                            0637 01920000
*                                    DO;                           0638 01921000
*                                    NULLDO(NESTLVL)=NULLDO(NESTLVL)+1; 01922000
*                                                                  0639 01923000
         SLR   @14,@14                                             0639 01924000
         IC    @14,NESTLVL(,@15)                                   0639 01925000
         ALR   @14,@14                                             0639 01926000
         LA    @05,1                                               0639 01927000
         ST    @14,@TF00001                                        0639 01928000
         ALR   @14,@15                                             0639 01929000
         MVC   @ZT00003+3(1),NULLDO-2(@14)                         0639 01930000
         AL    @05,@ZT00003                                        0639 01931000
         L     @14,@TF00001                                        0639 01932000
         STC   @05,NULLDO-2(@14,@15)                               0639 01933000
*                                    CALL BYPASTRM;                0640 01934000
*                                                                  0640 01935000
         BAL   @14,BYPASTRM                                        0640 01936000
*                                    END;                          0641 01937000
*                                  ELSE                            0642 01938000
*                                                                  0642 01939000
*                                    /********************************/ 01940000
*                                    /*                              */ 01941000
*                                    /* IF NOT A MODAL COMMAND, CHECK*/ 01942000
*                                    /* WHETHER THE CURRENT GROUP OF */ 01943000
*                                    /* FUNCTION COMMANDS ARE JUST   */ 01944000
*                                    /* BEING SCANNED OR NOT. ALSO,  */ 01945000
*                                    /* MOVE ONE 'IF' NESTING LEVEL  */ 01946000
*                                    /* LESS DEEP IF THIS NON-MODAL  */ 01947000
*                                    /* IS A SINGLE COMMAND FOLLOWING*/ 01948000
*                                    /* AN 'ELSE' COMMAND.           */ 01949000
*                                    /*                              */ 01950000
*                                    /********************************/ 01951000
*                                    DO;                           0642 01952000
         B     @RC00637                                            0642 01953000
@RF00637 DS    0H                                                  0643 01954000
*                                    IF SKIPFLAG(NESTLVL)=ON       0643 01955000
*                                      THEN                        0643 01956000
         L     @01,GDTPTR                                          0643 01957000
         L     @15,GDTRIH(,@01)                                    0643 01958000
         SLR   @14,@14                                             0643 01959000
         IC    @14,NESTLVL(,@15)                                   0643 01960000
         ALR   @14,@14                                             0643 01961000
         ALR   @15,@14                                             0643 01962000
         TM    SKIPFLAG-2(@15),B'00010000'                         0643 01963000
         BNO   @RF00643                                            0643 01964000
*                                        SCANONLY=YES;             0644 01965000
         OI    SCANONLY,B'00010000'                                0644 01966000
*                                    NONMODAL=YES;                 0645 01967000
@RF00643 OI    NONMODAL,B'10000000'                                0645 01968000
*                                    IF SINGLCMD=YES               0646 01969000
*                                      THEN                        0646 01970000
         TM    SINGLCMD,B'00010000'                                0646 01971000
         BNO   @RF00646                                            0646 01972000
*                                        DO;                       0647 01973000
*                                        SINGLCMD=NO;              0648 01974000
         NI    SINGLCMD,B'11101111'                                0648 01975000
*                                        IF ELSEFLAG(NESTLVL)=ON   0649 01976000
*                                          THEN                    0649 01977000
         L     @01,GDTPTR                                          0649 01978000
         L     @15,GDTRIH(,@01)                                    0649 01979000
         SLR   @14,@14                                             0649 01980000
         IC    @14,NESTLVL(,@15)                                   0649 01981000
         LR    @05,@14                                             0649 01982000
         ALR   @05,@05                                             0649 01983000
         ALR   @05,@15                                             0649 01984000
         TM    ELSEFLAG-2(@05),B'00100000'                         0649 01985000
         BNO   @RF00649                                            0649 01986000
*                                            NESTLVL=NESTLVL-1;    0650 01987000
         BCTR  @14,0                                               0650 01988000
         STC   @14,NESTLVL(,@15)                                   0650 01989000
*                                        END;                      0651 01990000
@RF00649 DS    0H                                                  0652 01991000
*                                    END;                          0652 01992000
@RF00646 DS    0H                                                  0653 01993000
*                END DOGRP20;                                      0653 01994000
*                                                                  0653 01995000
@RC00637 DS    0H                                                  0653 01996000
@RC00635 DS    0H                                                  0653 01997000
@RC00614 DS    0H                                                  0653 01998000
@RC00612 DS    0H                                                  0653 01999000
@RC00610 DS    0H                                                  0654 02000000
*          IF RISTATUS=0 & REDOLVL0=NO                             0654 02001000
*            THEN                                                  0654 02002000
@RC00597 DS    0H                                                  0654 02003000
@RC00584 LH    @15,RISTATUS                                        0654 02004000
         LTR   @15,@15                                             0654 02005000
         BNZ   @RF00654                                            0654 02006000
         TM    REDOLVL0,B'01000000'                                0654 02007000
         BNZ   @RF00654                                            0654 02008000
*DOGRP25:      DO;                                                 0655 02009000
DOGRP25  DS    0H                                                  0656 02010000
*              OLDERID2 = NEWERID2;                                0656 02011000
         L     @01,GDTPTR                                          0656 02012000
         L     @15,GDTTR2(,@01)                                    0656 02013000
         MVC   @TS00001(95),NEWERID2(@15)                          0656 02014000
         MVC   OLDERID2(95,@15),@TS00001                           0656 02015000
*              NEWID2='RI05';                                      0657 02016000
*                                                                  0657 02017000
         MVC   NEWID2(4,@15),@CC00881                              0657 02018000
*              /******************************************************/ 02019000
*              /*                                                    */ 02020000
*              /* IF THE LENGTH OF THE EXTRACTED COMMAND VERB NAME IS*/ 02021000
*              /* ZERO, THEN IT IS A NULL COMMAND.  IT IS THEN SIMPLY*/ 02022000
*              /* BYPASSED AND SCANNING RESUMES IN SEARCH OF THE     */ 02023000
*              /* NEXT FUNCTION COMMAND TO BE SCANNED.               */ 02024000
*              /*                                                    */ 02025000
*              /******************************************************/ 02026000
*              IF UNITINDX=0 & NONMODAL=YES                        0658 02027000
*                THEN                                              0658 02028000
         LH    @15,UNITINDX                                        0658 02029000
         LTR   @15,@15                                             0658 02030000
         BNZ   @RF00658                                            0658 02031000
         TM    NONMODAL,B'10000000'                                0658 02032000
         BNO   @RF00658                                            0658 02033000
*                  DO;                                             0659 02034000
*                  NULLCMD=YES;                                    0660 02035000
         OI    NULLCMD,B'01000000'                                 0660 02036000
*                  NONMODAL=NO;                                    0661 02037000
*                                                                  0661 02038000
         NI    NONMODAL,B'01111111'                                0661 02039000
*                  CALL BYPASTRM;                                  0662 02040000
*                                                                  0662 02041000
         BAL   @14,BYPASTRM                                        0662 02042000
*                  SCANONLY=NO;                                    0663 02043000
         NI    SCANONLY,B'11101111'                                0663 02044000
*                  END;                                            0664 02045000
*                                                                  0664 02046000
*              /******************************************************/ 02047000
*              /*                                                    */ 02048000
*              /* IF A GOOD FUNCTION COMMAND HAS NOT BEEN FOUND YET, */ 02049000
*              /* GET THE NEXT COMMAND VERB AND RESUME THE SCAN LOOP.*/ 02050000
*              /*                                                    */ 02051000
*              /******************************************************/ 02052000
*              IF NONMODAL=NO  & GETVERB=YES                       0665 02053000
*                THEN                                              0665 02054000
@RF00658 TM    GETVERB,B'00000100'                                 0665 02055000
         BNO   @RF00665                                            0665 02056000
         TM    NONMODAL,B'10000000'                                0665 02057000
         BNZ   @RF00665                                            0665 02058000
*                  DO;                                             0666 02059000
*                                                                  0666 02060000
*                  CALL SCANSEP(YES);                              0667 02061000
         LA    @01,@AL00667                                        0667 02062000
         BAL   @14,SCANSEP                                         0667 02063000
*                  CALL NXTFIELD(VERBFLD);                         0668 02064000
         LA    @01,@AL00668                                        0668 02065000
         BAL   @14,NXTFIELD                                        0668 02066000
*                  CALL SCANSEP(NO);                               0669 02067000
*                                                                  0669 02068000
         LA    @01,@AL00669                                        0669 02069000
         BAL   @14,SCANSEP                                         0669 02070000
*                  END;                                            0670 02071000
*                ELSE                                              0671 02072000
*                                                                  0671 02073000
*                  /**************************************************/ 02074000
*                  /*                                                */ 02075000
*                  /* IF A NON-MODAL, NON-NULL COMMAND HAS BEEN FOUND*/ 02076000
*                  /* THEN PICK IT UP AS THE FUNCTION COMMAND VERB   */ 02077000
*                  /* NAME IF IT DOESN'T EXCEED MAX. VERB NAME LENGTH*/ 02078000
*                  /*                                                */ 02079000
*                  /**************************************************/ 02080000
*                  IF UNITINDX <= VERBMAX                          0671 02081000
*                    THEN                                          0671 02082000
         B     @RC00665                                            0671 02083000
@RF00665 LH    @15,UNITINDX                                        0671 02084000
         CH    @15,@CH00042                                        0671 02085000
         BH    @RF00671                                            0671 02086000
*                      VERBNAME=SYNUNIT;                           0672 02087000
         MVC   VERBNAME(8),SYNUNIT                                 0672 02088000
*                    ELSE                                          0673 02089000
*                                                                  0673 02090000
*                      CALL ERROR2(BADVERB2,LENGTH(ERRFIELD),      0673 02091000
*                                  ADDR(ERRFIELD));                0673 02092000
*                                                                  0673 02093000
*                                                                  0673 02094000
         B     @RC00671                                            0673 02095000
@RF00671 MVC   @AL00001(8),@AL00673                                0673 02096000
         LA    @15,ERRFIELD                                        0673 02097000
         ST    @15,@AFTEMPS                                        0673 02098000
         LA    @15,@AFTEMPS                                        0673 02099000
         ST    @15,@AL00001+8                                      0673 02100000
         LA    @01,@AL00001                                        0673 02101000
         BAL   @14,ERROR2                                          0673 02102000
*              END DOGRP25;                                        0674 02103000
@RC00671 DS    0H                                                  0674 02104000
@RC00665 DS    0H                                                  0675 02105000
*        END DOLOOP10;                                             0675 02106000
@RF00654 DS    0H                                                  0675 02107000
@DE00580 TM    NONMODAL,B'10000000'                                0675 02108000
         BNZ   @DC00580                                            0675 02109000
         LH    @15,RISTATUS                                        0675 02110000
         LTR   @15,@15                                             0675 02111000
         BZ    @DL00580                                            0675 02112000
@DC00580 DS    0H                                                  0676 02113000
*/********************************************************************/ 02114000
*/*                                                                  */ 02115000
*/*  PROCEDURE NAME - MODALSET                                       */ 02116000
*/*                                                                  */ 02117000
*/*  FUNCTION - THIS ROUTINE SCANS AND INTERPRETS THE PART OF THE    */ 02118000
*/*             MODAL 'SET' COMMAND WHICH FOLLOWS THE VERB NAME      */ 02119000
*/*             'SET'.  IF THE SYNTAX IS OKAY, THE PROVIDED NUMBER   */ 02120000
*/*             IS ASSIGNED AS THE VALUE OF THE CONDITION CODE.      */ 02121000
*/*                                                                  */ 02122000
*/*  INPUT -                                                         */ 02123000
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING IS    */ 02124000
*/*                    CURRENTLY TAKING PLACE                        */ 02125000
*/*          ELSEFLAG- FLAG SET 'ON' WHILE SCANNING ELSE-PATH        */ 02126000
*/*                    COMMANDS AT CURRENT 'IF' NESTING LEVEL        */ 02127000
*/*          SKIPFLAG- FLAG SET 'ON' WHILE SCANNING COMMAND(S) WHICH */ 02128000
*/*                    IS NOT TO BE ENCODED INTO AN FDT & EXECUTED.  */ 02129000
*/*          RISTATUS- STATUS CODE SET TO A NON-ZERO CODE WHEN ANY   */ 02130000
*/*                    ERROR IS ENCOUNTERED.                         */ 02131000
*/*          LASTCC -  LAST SYSTEM COND. CODE; MAY BE RESET BY 'SET' */ 02132000
*/*                    COMMAND OR BY OCCURRENCE OF AN ERROR.         */ 02133000
*/*          MAXCC -   MAXIMUM SYSTEM COND. CODE; MAY BE RESET BY    */ 02134000
*/*                    'SET' COMMAND.                                */ 02135000
*/*          SYNUNIT - ALL OR PART OF 'SET' COMMAND ASSIGNMENT       */ 02136000
*/*                    EXPRESSION.                                   */ 02137000
*/*          UNITINDX- LENGTH OF ABOVE SEGMENT OF ASSIGNMENT EXPR.   */ 02138000
*/*          CNVRTWRD- CONVERTED DECIMAL NUMBER IN BINARY FORM FROM  */ 02139000
*/*                    'SET' COMMAND ASSIGNMENT EXPRESSION.          */ 02140000
*/*          SINGLCMD- FLAG SET 'ON' WHEN A SINGLE COMMAND FOLLOWS A */ 02141000
*/*                    'THEN' OR 'ELSE'                              */ 02142000
*/*          CHAR1 -   INPUT CHARACTER MOST RECENTLY EXTRACTED.      */ 02143000
*/*                                                                  */ 02144000
*/*  OUTPUT -                                                        */ 02145000
*/*          SINGLCMD- SEE 'INPUT'                                   */ 02146000
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING WILL  */ 02147000
*/*                    BE DONE FOLLOWING THIS 'SET' COMMAND.         */ 02148000
*/*          RISTATUS- SEE 'INPUT'                                   */ 02149000
*/*          SYNUNIT - DECIMAL NUMBER FROM 'SET' COMMAND TO BE       */ 02150000
*/*                    CONVERTED AND ASSIGNED AS THE COND. CODE VALUE*/ 02151000
*/*          UNITINDX- LENGTH OF DECIMAL NUMBER (EBCDIC FORM)        */ 02152000
*/*          LASTCC -  SEE 'INPUT'                                   */ 02153000
*/*          MAXCC -   SEE 'INPUT'                                   */ 02154000
*/*                                                                  */ 02155000
*/********************************************************************/ 02156000
*MODALSET:PROCEDURE;                                               0676 02157000
         B     @PB00005                                            0676 02158000
MODALSET STM   @14,@12,@SA00005                                    0676 02159000
*        /************************************************************/ 02160000
*        /*                                                          */ 02161000
*        /*  ** MODALSET **  INTERPRET MODAL 'SET' COMMAND           */ 02162000
*        /*                                                          */ 02163000
*        /************************************************************/ 02164000
*        IF GDTDBG = NULLPTR                                       0677 02165000
*          THEN;                                                   0677 02166000
         L     @01,GDTPTR                                          0677 02167000
         L     @15,GDTDBG(,@01)                                    0677 02168000
         LTR   @15,@15                                             0677 02169000
         BZ    @RT00677                                            0677 02170000
*          ELSE                                                    0679 02171000
*            CALL ICKDB010(GDTTBL,'RIMS');                         0679 02172000
*                                                                  0679 02173000
         L     @15,GDTPTR                                          0679 02174000
         ST    @15,@AL00001                                        0679 02175000
         LA    @14,@CC00885                                        0679 02176000
         ST    @14,@AL00001+4                                      0679 02177000
         MVI   @AL00001+4,X'80'                                    0679 02178000
         L     @15,GDTDBG(,@15)                                    0679 02179000
         LA    @01,@AL00001                                        0679 02180000
         BALR  @14,@15                                             0679 02181000
*        /************************************************************/ 02182000
*        /*                                                          */ 02183000
*        /* EXTRACT THE ELEMENTS OF THE ASSIGNMENT EXPRESSION (THERE */ 02184000
*        /* MAY OR MAY NOT BE DELIMITERS TO BE IGNORED SURROUNDING   */ 02185000
*        /* THE EQUAL SIGN), CHECKING TO BE SURE THAT THE MAXIMUM    */ 02186000
*        /* POSSIBLE LENGTH FOR SUCH AN EXPRESSION IS NOT EXCEEDED.  */ 02187000
*        /*                                                          */ 02188000
*        /************************************************************/ 02189000
*        RELATION=BLANK;                                           0680 02190000
@RT00677 MVI   RELATION+1,C' '                                     0680 02191000
         MVC   RELATION+2(30),RELATION+1                           0680 02192000
         MVI   RELATION,C' '                                       0680 02193000
*        RELSIZE=0;                                                0681 02194000
         SLR   @15,@15                                             0681 02195000
         STH   @15,RELSIZE                                         0681 02196000
*        EXPREND=NO;                                               0682 02197000
         NI    EXPREND,B'11011111'                                 0682 02198000
*        DO WHILE(EXPREND=NO);                                     0683 02199000
*                                                                  0683 02200000
         B     @DE00683                                            0683 02201000
@DL00683 DS    0H                                                  0684 02202000
*          CALL NXTFIELD(VERBFLD);                                 0684 02203000
         LA    @01,@AL00684                                        0684 02204000
         BAL   @14,NXTFIELD                                        0684 02205000
*          CALL SCANSEP(NO);                                       0685 02206000
*                                                                  0685 02207000
         LA    @01,@AL00685                                        0685 02208000
         BAL   @14,SCANSEP                                         0685 02209000
*          IF RELSIZE+UNITINDX = 0  |                              0686 02210000
*             RELSIZE+UNITINDX > MAX(MAXCCLN,LSTCCLN)+2+LENGTH(MXDECNUM 02211000
*            THEN                                                  0686 02212000
         LH    @15,RELSIZE                                         0686 02213000
         AH    @15,UNITINDX                                        0686 02214000
         LTR   @15,@15                                             0686 02215000
         BZ    @RT00686                                            0686 02216000
         L     @01,GDTPTR                                          0686 02217000
         L     @01,GDTRIH(,@01)                                    0686 02218000
         L     @14,KWTBLPTR(,@01)                                  0686 02219000
         SLR   @05,@05                                             0686 02220000
         IC    @05,MAXCCLN(,@14)                                   0686 02221000
         SLR   @04,@04                                             0686 02222000
         IC    @04,LSTCCLN(,@14)                                   0686 02223000
         CR    @05,@04                                             0686 02224000
         BNL   *+6                                                      02225000
         LR    @05,@04                                             0686 02226000
         AH    @05,@CH00038                                        0686 02227000
         CR    @15,@05                                             0686 02228000
         BNH   @RF00686                                            0686 02229000
@RT00686 DS    0H                                                  0687 02230000
*              RISTATUS=BADEXPR2;                                  0687 02231000
         MVC   RISTATUS(2),@CH00054                                0687 02232000
*            ELSE                                                  0688 02233000
*              DO;                                                 0688 02234000
         B     @RC00686                                            0688 02235000
@RF00686 DS    0H                                                  0689 02236000
*              RELATION(RELSIZE+1:RELSIZE+UNITINDX)=SYNUNIT;       0689 02237000
         LH    @15,RELSIZE                                         0689 02238000
         LA    @14,RELATION(@15)                                   0689 02239000
         LH    @05,UNITINDX                                        0689 02240000
         LR    @04,@05                                             0689 02241000
         BCTR  @04,0                                               0689 02242000
         EX    @04,@SM01324                                        0689 02243000
*              RELSIZE=RELSIZE+UNITINDX;                           0690 02244000
         ALR   @15,@05                                             0690 02245000
         STH   @15,RELSIZE                                         0690 02246000
*              END;                                                0691 02247000
*          IF RISTATUS^=0 | CHAR1=ENDDELIM                         0692 02248000
*            THEN                                                  0692 02249000
@RC00686 LH    @15,RISTATUS                                        0692 02250000
         LTR   @15,@15                                             0692 02251000
         BNZ   @RT00692                                            0692 02252000
         CLI   CHAR1,C';'                                          0692 02253000
         BNE   @RF00692                                            0692 02254000
@RT00692 DS    0H                                                  0693 02255000
*              EXPREND=YES;                                        0693 02256000
         OI    EXPREND,B'00100000'                                 0693 02257000
*        END;                                                      0694 02258000
*                                                                  0694 02259000
@RF00692 DS    0H                                                  0694 02260000
@DE00683 TM    EXPREND,B'00100000'                                 0694 02261000
         BZ    @DL00683                                            0694 02262000
*        IF RISTATUS=0                                             0695 02263000
*          THEN                                                    0695 02264000
*                                                                  0695 02265000
         LH    @15,RISTATUS                                        0695 02266000
         LTR   @15,@15                                             0695 02267000
         BNZ   @RF00695                                            0695 02268000
*            /********************************************************/ 02269000
*            /*                                                      */ 02270000
*            /* INTERPRET THE ASSIGNMENT EXPRESSION AND ASSIGN THE   */ 02271000
*            /* PROVIDED NUMBER AS THE VALUE OF THE LAST OR MAXIMUM  */ 02272000
*            /* SYSTEM CONDITION CODE (WHICHEVER IS SPECIFIED IN THE */ 02273000
*            /* ASSIGNMENT EXPRESSION.                               */ 02274000
*            /*                                                      */ 02275000
*            /********************************************************/ 02276000
*DOGRP27:    DO;                                                   0696 02277000
DOGRP27  DS    0H                                                  0697 02278000
*            IF RELATION(1:MAXCCLN)=MAXCCSYM                       0697 02279000
*              THEN                                                0697 02280000
         L     @01,GDTPTR                                          0697 02281000
         L     @01,GDTRIH(,@01)                                    0697 02282000
         L     @15,KWTBLPTR(,@01)                                  0697 02283000
         SLR   @14,@14                                             0697 02284000
         IC    @14,MAXCCLN(,@15)                                   0697 02285000
         LR    @05,@14                                             0697 02286000
         BCTR  @05,0                                               0697 02287000
         EX    @05,@SC01326                                        0697 02288000
         BNE   @RF00697                                            0697 02289000
*                PART1LEN=MAXCCLN;                                 0698 02290000
         STH   @14,PART1LEN                                        0698 02291000
*              ELSE                                                0699 02292000
*                IF RELATION(1:LSTCCLN)=LSTCCSYM                   0699 02293000
*                  THEN                                            0699 02294000
         B     @RC00697                                            0699 02295000
@RF00697 L     @01,GDTPTR                                          0699 02296000
         L     @01,GDTRIH(,@01)                                    0699 02297000
         L     @15,KWTBLPTR(,@01)                                  0699 02298000
         SLR   @14,@14                                             0699 02299000
         IC    @14,LSTCCLN(,@15)                                   0699 02300000
         LR    @05,@14                                             0699 02301000
         BCTR  @05,0                                               0699 02302000
         EX    @05,@SC01328                                        0699 02303000
         BNE   @RF00699                                            0699 02304000
*                    PART1LEN=LSTCCLN;                             0700 02305000
         STH   @14,PART1LEN                                        0700 02306000
*                  ELSE                                            0701 02307000
*                    RISTATUS=BADEXPR2;                            0701 02308000
         B     @RC00699                                            0701 02309000
@RF00699 MVC   RISTATUS(2),@CH00054                                0701 02310000
*            IF RELATION(PART1LEN+1)=EQSIGN1                       0702 02311000
*              THEN                                                0702 02312000
@RC00699 DS    0H                                                  0702 02313000
@RC00697 LH    @15,PART1LEN                                        0702 02314000
         LA    @14,RELATION(@15)                                   0702 02315000
         CLI   0(@14),C'='                                         0702 02316000
         BNE   @RF00702                                            0702 02317000
*                PART1LEN=PART1LEN+1;                              0703 02318000
         LA    @15,1(,@15)                                         0703 02319000
         STH   @15,PART1LEN                                        0703 02320000
*              ELSE                                                0704 02321000
*                IF RELATION(PART1LEN+1:PART1LEN+2)=EQSIGN2        0704 02322000
*                  THEN                                            0704 02323000
         B     @RC00702                                            0704 02324000
@RF00702 LH    @15,PART1LEN                                        0704 02325000
         LA    @14,RELATION(@15)                                   0704 02326000
         CLC   0(2,@14),@CC00853                                   0704 02327000
         BNE   @RF00704                                            0704 02328000
*                    PART1LEN=PART1LEN+2;                          0705 02329000
         LA    @15,2(,@15)                                         0705 02330000
         STH   @15,PART1LEN                                        0705 02331000
*                  ELSE                                            0706 02332000
*                    RISTATUS=BADEXPR2;                            0706 02333000
         B     @RC00704                                            0706 02334000
@RF00704 MVC   RISTATUS(2),@CH00054                                0706 02335000
*            IF RISTATUS=0                                         0707 02336000
*              THEN                                                0707 02337000
*                                                                  0707 02338000
@RC00704 DS    0H                                                  0707 02339000
@RC00702 LH    @15,RISTATUS                                        0707 02340000
         LTR   @15,@15                                             0707 02341000
         BNZ   @RF00707                                            0707 02342000
*                /****************************************************/ 02343000
*                /*                                                  */ 02344000
*                /* IF A NUMBER HAS BEEN PROPERLY CODED, THEN        */ 02345000
*                /* PLACE THE NUMBER INTO SYNUNIT IN PREPARATION FOR */ 02346000
*                /* CONVERSION AND CONVERT THE NUMBER.               */ 02347000
*                /*                                                  */ 02348000
*                /****************************************************/ 02349000
*                IF PART1LEN < RELSIZE                             0708 02350000
*                  THEN                                            0708 02351000
         LH    @15,PART1LEN                                        0708 02352000
         LH    @14,RELSIZE                                         0708 02353000
         CR    @15,@14                                             0708 02354000
         BNL   @RF00708                                            0708 02355000
*                    DO;                                           0709 02356000
*                    UNITINDX=RELSIZE-PART1LEN;                    0710 02357000
         SLR   @14,@15                                             0710 02358000
         STH   @14,UNITINDX                                        0710 02359000
*                    SYNUNIT=RELATION(PART1LEN+1:RELSIZE);         0711 02360000
*                                                                  0711 02361000
         MVI   SYNUNIT+1,C' '                                      0711 02362000
         MVC   SYNUNIT+2(253),SYNUNIT+1                            0711 02363000
         BCTR  @14,0                                               0711 02364000
         LA    @01,RELATION(@15)                                   0711 02365000
         EX    @14,@SM01330                                        0711 02366000
*                    CALL PACKCVB;                                 0712 02367000
*                                                                  0712 02368000
         BAL   @14,PACKCVB                                         0712 02369000
*                    IF RISTATUS^=0                                0713 02370000
*                      THEN                                        0713 02371000
         LH    @15,RISTATUS                                        0713 02372000
         LTR   @15,@15                                             0713 02373000
         BZ    @RF00713                                            0713 02374000
*                        RISTATUS=SKIPREST;                        0714 02375000
         MVC   RISTATUS(2),@CH00042                                0714 02376000
*                    END;                                          0715 02377000
*                  ELSE                                            0716 02378000
*                    RISTATUS=BADEXPR2;                            0716 02379000
         B     @RC00708                                            0716 02380000
@RF00708 MVC   RISTATUS(2),@CH00054                                0716 02381000
*            END DOGRP27;                                          0717 02382000
*                                                                  0717 02383000
@RC00708 DS    0H                                                  0717 02384000
@RF00707 DS    0H                                                  0718 02385000
*        /************************************************************/ 02386000
*        /*                                                          */ 02387000
*        /* IF NO ERROR HAS OCCURRED, ASSIGN THE PROVIDED VALUE AS   */ 02388000
*        /* THE NEW VALUE OF THE SPECIFIED CONDITION CODE.           */ 02389000
*        /* (HOWEVER, NEVER ASSIGN A VALUE HIGHER THAN 16).  IF THE  */ 02390000
*        /* 'SET' COMMAND HAS UPDATED 'LASTCC', THEN 'MAXCC' MAY     */ 02391000
*        /* ALSO HAVE TO BE UPDATED.                                 */ 02392000
*        /*                                                          */ 02393000
*        /************************************************************/ 02394000
*        IF RISTATUS ^= 0                                          0718 02395000
*          THEN                                                    0718 02396000
@RF00695 LH    @15,RISTATUS                                        0718 02397000
         LTR   @15,@15                                             0718 02398000
         BZ    @RF00718                                            0718 02399000
*            LASTCC=TERMERR;                                       0719 02400000
         MVC   LASTCC(2),@CH00274                                  0719 02401000
*          ELSE                                                    0720 02402000
*            DO;                                                   0720 02403000
         B     @RC00718                                            0720 02404000
@RF00718 DS    0H                                                  0721 02405000
*            IF SKIPFLAG(NESTLVL)=OFF                              0721 02406000
*              THEN                                                0721 02407000
         L     @01,GDTPTR                                          0721 02408000
         L     @15,GDTRIH(,@01)                                    0721 02409000
         SLR   @14,@14                                             0721 02410000
         IC    @14,NESTLVL(,@15)                                   0721 02411000
         ALR   @14,@14                                             0721 02412000
         ALR   @14,@15                                             0721 02413000
         TM    SKIPFLAG-2(@14),B'00010000'                         0721 02414000
         BNZ   @RF00721                                            0721 02415000
*                IF RELATION(1:MAXCCLN)=MAXCCSYM                   0722 02416000
*                  THEN                                            0722 02417000
         L     @15,KWTBLPTR(,@15)                                  0722 02418000
         SLR   @14,@14                                             0722 02419000
         IC    @14,MAXCCLN(,@15)                                   0722 02420000
         BCTR  @14,0                                               0722 02421000
         EX    @14,@SC01326                                        0722 02422000
         BNE   @RF00722                                            0722 02423000
*                    MAXCC=MIN(TERMERR,CNVRTWRD);                  0723 02424000
         L     @15,CNVRTWRD                                        0723 02425000
         LA    @14,16                                              0723 02426000
         CR    @15,@14                                             0723 02427000
         BNH   *+6                                                      02428000
         LR    @15,@14                                             0723 02429000
         STH   @15,MAXCC                                           0723 02430000
*                  ELSE                                            0724 02431000
*                    DO;                                           0724 02432000
         B     @RC00722                                            0724 02433000
@RF00722 DS    0H                                                  0725 02434000
*                    LASTCC=MIN(TERMERR,CNVRTWRD);                 0725 02435000
         L     @15,CNVRTWRD                                        0725 02436000
         LA    @14,16                                              0725 02437000
         CR    @15,@14                                             0725 02438000
         BNH   *+6                                                      02439000
         LR    @15,@14                                             0725 02440000
         STH   @15,LASTCC                                          0725 02441000
*                    MAXCC=MAX(MAXCC,LASTCC);                      0726 02442000
         LH    @14,MAXCC                                           0726 02443000
         CR    @14,@15                                             0726 02444000
         BNL   *+6                                                      02445000
         LR    @14,@15                                             0726 02446000
         STH   @14,MAXCC                                           0726 02447000
*                    END;                                          0727 02448000
*            IF MAXCC >= TERMERR                                   0728 02449000
*              THEN                                                0728 02450000
@RC00722 DS    0H                                                  0728 02451000
@RF00721 LH    @15,MAXCC                                           0728 02452000
         CH    @15,@CH00274                                        0728 02453000
         BL    @RF00728                                            0728 02454000
*                RISTATUS=SKIPREST;                                0729 02455000
         MVC   RISTATUS(2),@CH00042                                0729 02456000
*              ELSE                                                0730 02457000
*                                                                  0730 02458000
*                CALL BYPASTRM;                                    0730 02459000
*                                                                  0730 02460000
         B     @RC00728                                            0730 02461000
@RF00728 BAL   @14,BYPASTRM                                        0730 02462000
*            END;                                                  0731 02463000
*                                                                  0731 02464000
@RC00728 DS    0H                                                  0732 02465000
*        /************************************************************/ 02466000
*        /*                                                          */ 02467000
*        /* IF THIS 'SET' COMMAND IS A SINGLE COMMAND FOLLOWING AN   */ 02468000
*        /* 'ELSE' COMMAND, THEN ADJUST THE 'IF' NESTING LEVEL ONE   */ 02469000
*        /* LEVEL LESS DEEP.                                         */ 02470000
*        /*                                                          */ 02471000
*        /************************************************************/ 02472000
*        IF SINGLCMD=YES                                           0732 02473000
*          THEN                                                    0732 02474000
@RC00718 TM    SINGLCMD,B'00010000'                                0732 02475000
         BNO   @RF00732                                            0732 02476000
*            DO;                                                   0733 02477000
*            SINGLCMD=NO;                                          0734 02478000
         NI    SINGLCMD,B'11101111'                                0734 02479000
*            IF ELSEFLAG(NESTLVL)=ON                               0735 02480000
*              THEN                                                0735 02481000
         L     @01,GDTPTR                                          0735 02482000
         L     @15,GDTRIH(,@01)                                    0735 02483000
         SLR   @14,@14                                             0735 02484000
         IC    @14,NESTLVL(,@15)                                   0735 02485000
         LR    @05,@14                                             0735 02486000
         ALR   @05,@05                                             0735 02487000
         ALR   @05,@15                                             0735 02488000
         TM    ELSEFLAG-2(@05),B'00100000'                         0735 02489000
         BNO   @RF00735                                            0735 02490000
*                NESTLVL=NESTLVL-1;                                0736 02491000
         BCTR  @14,0                                               0736 02492000
         STC   @14,NESTLVL(,@15)                                   0736 02493000
*            END;                                                  0737 02494000
*                                                                  0737 02495000
*        END MODALSET;                                             0738 02496000
@EL00005 DS    0H                                                  0738 02497000
@EF00005 DS    0H                                                  0738 02498000
@ER00005 LM    @14,@12,@SA00005                                    0738 02499000
         BR    @14                                                 0738 02500000
*/********************************************************************/ 02501000
*/*                                                                  */ 02502000
*/*  PROCEDURE NAME - MODALIF                                        */ 02503000
*/*                                                                  */ 02504000
*/*  FUNCTION - THIS ROUTINE SCANS AND INTERPRETS THE PART OF THE    */ 02505000
*/*             MODAL 'IF' COMMAND WHICH FOLLOWS THE VERB NAME 'IF'. */ 02506000
*/*             IF THE SYNTAX OF THE RELATIONAL EXPRESSION TO BE     */ 02507000
*/*             EVALUATED IS OKAY, THEN THE EVALUATION IS DONE TO    */ 02508000
*/*             DETERMINE IF THE EXPRESSION IS TRUE OR FALSE. FLAGS  */ 02509000
*/*             TO CONTROL SELECTION OF FUNCTION COMMANDS TO BE      */ 02510000
*/*             EXECUTED ARE SET BASED UPON THE RESULT.  A CHECK IS  */ 02511000
*/*             ALSO MADE TO SEE IF A DO-GROUP OR A NESTING 'IF'     */ 02512000
*/*             COMMAND FOLLOWS THE 'THEN' KEYWORD.                  */ 02513000
*/*                                                                  */ 02514000
*/*  INPUT -                                                         */ 02515000
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING HAS   */ 02516000
*/*                    TAKING PLACE PREVIOUS TO THIS 'IF' COMMAND    */ 02517000
*/*          SKIPFLAG- FLAG SET 'ON' IF COMMANDS AT CURRENT LEVEL    */ 02518000
*/*                    OF 'IF' NESTING ARE JUST BEING SCANNED FOR    */ 02519000
*/*                    SYNTAX CHECKING.                              */ 02520000
*/*          RISTATUS- INTERNAL STATUS CODE; SET TO NON-ZERO CODE    */ 02521000
*/*                    WHEN ANY ERROR IS FOUND.                      */ 02522000
*/*          SYNUNIT - ALL OR PART OF 'IF' COMMAND EXPRESSION.       */ 02523000
*/*          UNITINDX- LENGTH OF ABOVE 'IF' COMMAND SEGMENT.         */ 02524000
*/*          LASTCC -  CURRENT VALUE OF LAST SYSTEM COND. CODE       */ 02525000
*/*          MAXCC -   CURRENT VALUE OF MAXIMUM SYSTEM COND. CODE    */ 02526000
*/*          CNVRTWRD- VALUE (CONVERTED TO BINARY FORM) TAKEN FROM   */ 02527000
*/*                    'IF' COMMAND RELATIONAL EXPRESSION TO BE      */ 02528000
*/*                    COMPARTED TO THE CONDITION CODE VALUE         */ 02529000
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED FROM COMMAND.  */ 02530000
*/*                                                                  */ 02531000
*/*  OUTPUT -                                                        */ 02532000
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING IS    */ 02533000
*/*                    TAKING PLACE AFTER THIS 'IF' COMMAND.         */ 02534000
*/*          RISTATUS- SEE 'INPUT'                                   */ 02535000
*/*          LASTCC -  SEE 'INPUT'                                   */ 02536000
*/*          DOFLAG -  SET 'ON' WHEN SCANNING WITHIN A DO-GROUP AT   */ 02537000
*/*                    THE CURRENT 'IF' NESTING LEVEL                */ 02538000
*/*          THENFLAG- SET 'ON' WHEN 'THEN-PATH' COMMANDS ARE BEING  */ 02539000
*/*                    SCANNED AT CURRENT 'IF' NESTING LEVEL         */ 02540000
*/*          SKIPFLAG- SET 'ON' WHEN 'THEN-PATH' COMMANDS ARE ONLY TO*/ 02541000
*/*                    BE SCANNED FOR CORRECT SYNTAX.                */ 02542000
*/*          IFNEXT -  FLAG SET 'ON' WHEN AN 'IF' COMMAND FOLLOWS    */ 02543000
*/*                    THE 'THEN' KEYWORD OF THE CURRENT 'IF' COMMAND*/ 02544000
*/*          SYNUNIT - ALL OR PART OF 'IF' COMMAND RELATIONAL EXPR.  */ 02545000
*/*          UNITINDX- LENGTH OF RELATIONAL EXPRESSION SEGMENT       */ 02546000
*/*          GETVERB - FLAG SET 'ON' WHEN THE NEXT COMMAND VERB IS   */ 02547000
*/*                    YET TO BE EXTRACTED.                          */ 02548000
*/*          SINGLCMD- FLAG SET 'ON' WHEN A SINGLE COMMAND RATHER    */ 02549000
*/*                    THAN A DO-GROUP FOLLOWS THE 'THEN' KEYWORD.   */ 02550000
*/*                                                                  */ 02551000
*/********************************************************************/ 02552000
*MODALIF:PROCEDURE;                                                0739 02553000
MODALIF  STM   @14,@12,@SA00006                                    0739 02554000
*        /************************************************************/ 02555000
*        /*                                                          */ 02556000
*        /* DATA DEFINITIONS FOR INTERPRETING MODAL 'IF' COMMAND     */ 02557000
*        /*                                                          */ 02558000
*        /************************************************************/ 02559000
*                                                                  0740 02560000
*        DCL CCVALUE  FIXED(15);       /*SYSTEM CONDITION CODE VALUE */ 02561000
*        DCL DIGITPOS FIXED(15);       /*POSITION WITHIN RELATIONAL     02562000
*                                        EXPRESSION WHERE NUMBER TO BE  02563000
*                                        COMPARED WITH THE CC APPEARS*/ 02564000
*        DCL RELOPER  CHAR(2);         /*EXTRACTED RELATIONAL      0742 02565000
*                                        OPERATOR                    */ 02566000
*                                                                  0742 02567000
*        DCL GTSIGN1  CHAR(1)          /*GREATER-THAN SIGN           */ 02568000
*                     CONSTANT('>');                               0743 02569000
*        DCL GTSIGN2  CHAR(2)          /*GREATER-THAN SIGN           */ 02570000
*                     CONSTANT('GT');                              0744 02571000
*        DCL LTSIGN1  CHAR(1)          /*LESS-THAN SIGN              */ 02572000
*                     CONSTANT('<');                               0745 02573000
*        DCL LTSIGN2  CHAR(2)          /*LESS-THAN SIGN              */ 02574000
*                     CONSTANT('LT');                              0746 02575000
*        DCL NESIGN1  CHAR(2)          /*NOT-EQUAL SIGN              */ 02576000
*                     CONSTANT('^=');                              0747 02577000
*        DCL NESIGN2  CHAR(2)          /*NOT-EQUAL SIGN              */ 02578000
*                     CONSTANT('NE');                              0748 02579000
*        DCL GESIGN1  CHAR(2)          /*GREATER-THAN-OR-EQUAL SIGN  */ 02580000
*                     CONSTANT('>=');                              0749 02581000
*        DCL GESIGN2  CHAR(2)          /*GREATER-THAN-OR-EQUAL SIGN  */ 02582000
*                     CONSTANT('GE');                              0750 02583000
*        DCL LESIGN1  CHAR(2)          /*LESS-THAN-OR-EQUAL SIGN     */ 02584000
*                     CONSTANT('<=');                              0751 02585000
*        DCL LESIGN2  CHAR(2)          /*LESS-THAN-OR-EQUAL SIGN     */ 02586000
*                     CONSTANT('LE');                              0752 02587000
*        /************************************************************/ 02588000
*        /*                                                          */ 02589000
*        /*  ** MODALIF **  INTERPRET THE MODAL 'IF' COMMAND         */ 02590000
*        /*                                                          */ 02591000
*        /************************************************************/ 02592000
*        IF GDTDBG = NULLPTR                                       0753 02593000
*          THEN;                                                   0753 02594000
         L     @01,GDTPTR                                          0753 02595000
         L     @15,GDTDBG(,@01)                                    0753 02596000
         LTR   @15,@15                                             0753 02597000
         BZ    @RT00753                                            0753 02598000
*          ELSE                                                    0755 02599000
*            CALL ICKDB010(GDTTBL,'RIMI');                         0755 02600000
*                                                                  0755 02601000
         L     @15,GDTPTR                                          0755 02602000
         ST    @15,@AL00001                                        0755 02603000
         LA    @14,@CC00917                                        0755 02604000
         ST    @14,@AL00001+4                                      0755 02605000
         MVI   @AL00001+4,X'80'                                    0755 02606000
         L     @15,GDTDBG(,@15)                                    0755 02607000
         LA    @01,@AL00001                                        0755 02608000
         BALR  @14,@15                                             0755 02609000
*        /************************************************************/ 02610000
*        /*                                                          */ 02611000
*        /* NOTE THAT THIS 'IF' COMMAND MEANS ONE LEVEL DEEPER OF    */ 02612000
*        /* 'IF' NESTING.                                            */ 02613000
*        /*                                                          */ 02614000
*        /************************************************************/ 02615000
*        NESTLVL=NESTLVL+1;                                        0756 02616000
@RT00753 L     @01,GDTPTR                                          0756 02617000
         L     @15,GDTRIH(,@01)                                    0756 02618000
         LA    @14,1                                               0756 02619000
         MVC   @ZT00003+3(1),NESTLVL(@15)                          0756 02620000
         AL    @14,@ZT00003                                        0756 02621000
         STC   @14,NESTLVL(,@15)                                   0756 02622000
*        IF NESTLVL > IFNSTMX                                      0757 02623000
*          THEN                                                    0757 02624000
         CLI   NESTLVL(@15),10                                     0757 02625000
         BNH   @RF00757                                            0757 02626000
*            DO;                                                   0758 02627000
*            RISTATUS=BADIFNST;                                    0759 02628000
         MVC   RISTATUS(2),@CH00860                                0759 02629000
*            LASTCC=TERMERR;                                       0760 02630000
         MVC   LASTCC(2),@CH00274                                  0760 02631000
*            RETURN;                                               0761 02632000
@EL00006 DS    0H                                                  0761 02633000
@EF00006 DS    0H                                                  0761 02634000
@ER00006 LM    @14,@12,@SA00006                                    0761 02635000
         BR    @14                                                 0761 02636000
*            END;                                                  0762 02637000
*        MODLFLGS(NESTLVL)=''B;                                    0763 02638000
@RF00757 L     @01,GDTPTR                                          0763 02639000
         L     @15,GDTRIH(,@01)                                    0763 02640000
         SLR   @14,@14                                             0763 02641000
         IC    @14,NESTLVL(,@15)                                   0763 02642000
         ALR   @14,@14                                             0763 02643000
         ST    @14,@TF00001                                        0763 02644000
         ALR   @14,@15                                             0763 02645000
         XC    MODLFLGS-2(2,@14),MODLFLGS-2(@14)                   0763 02646000
*        THENFLAG(NESTLVL)=ON;                                     0764 02647000
         AL    @15,@TF00001                                        0764 02648000
         OI    THENFLAG-2(@15),B'01000000'                         0764 02649000
*        IFNEXT=NO;                                                0765 02650000
*                                                                  0765 02651000
         NI    IFNEXT,B'11110111'                                  0765 02652000
*        /************************************************************/ 02653000
*        /*                                                          */ 02654000
*        /* EXTRACT THE ELEMENTS OF THE RELATIONAL EXPRESSION THAT   */ 02655000
*        /* FOLLOWS THE 'IF' VERB (THERE MAY OR MAY NOT BE DELIMITERS*/ 02656000
*        /* SURROUNDING THE COMPARISON SIGN), CHECKING TO BE SURE    */ 02657000
*        /* THAT THE MAXIMUM POSSIBLE LENGTH FOR SUCH AN EXPRESSION  */ 02658000
*        /* IS NOT EXCEEDED.                                         */ 02659000
*        /*                                                          */ 02660000
*        /************************************************************/ 02661000
*        RELATION=BLANK;                                           0766 02662000
         MVI   RELATION+1,C' '                                     0766 02663000
         MVC   RELATION+2(30),RELATION+1                           0766 02664000
         MVI   RELATION,C' '                                       0766 02665000
*        RELSIZE=0;                                                0767 02666000
         SLR   @15,@15                                             0767 02667000
         STH   @15,RELSIZE                                         0767 02668000
*        EXPREND=NO;                                               0768 02669000
         NI    EXPREND,B'11011111'                                 0768 02670000
*        DO WHILE(EXPREND=NO & RISTATUS=0);                        0769 02671000
*                                                                  0769 02672000
         B     @DE00769                                            0769 02673000
@DL00769 DS    0H                                                  0770 02674000
*          CALL NXTFIELD(VERBFLD);                                 0770 02675000
         LA    @01,@AL00770                                        0770 02676000
         BAL   @14,NXTFIELD                                        0770 02677000
*          CALL SCANSEP(NO);                                       0771 02678000
*                                                                  0771 02679000
         LA    @01,@AL00771                                        0771 02680000
         BAL   @14,SCANSEP                                         0771 02681000
*          IF RELSIZE+UNITINDX = 0  |                              0772 02682000
*             RELSIZE+UNITINDX > MAX(MAXCCLN,LSTCCLN)+2+LENGTH(MXDECNUM 02683000
*            THEN                                                  0772 02684000
         LH    @15,RELSIZE                                         0772 02685000
         AH    @15,UNITINDX                                        0772 02686000
         LTR   @15,@15                                             0772 02687000
         BZ    @RT00772                                            0772 02688000
         L     @01,GDTPTR                                          0772 02689000
         L     @01,GDTRIH(,@01)                                    0772 02690000
         L     @14,KWTBLPTR(,@01)                                  0772 02691000
         SLR   @05,@05                                             0772 02692000
         IC    @05,MAXCCLN(,@14)                                   0772 02693000
         SLR   @04,@04                                             0772 02694000
         IC    @04,LSTCCLN(,@14)                                   0772 02695000
         CR    @05,@04                                             0772 02696000
         BNL   *+6                                                      02697000
         LR    @05,@04                                             0772 02698000
         AH    @05,@CH00038                                        0772 02699000
         CR    @15,@05                                             0772 02700000
         BNH   @RF00772                                            0772 02701000
@RT00772 DS    0H                                                  0773 02702000
*              RISTATUS=BADEXPR1;                                  0773 02703000
         MVC   RISTATUS(2),@CH00302                                0773 02704000
*            ELSE                                                  0774 02705000
*              DO;                                                 0774 02706000
         B     @RC00772                                            0774 02707000
@RF00772 DS    0H                                                  0775 02708000
*              RELATION(RELSIZE+1:RELSIZE+UNITINDX)=SYNUNIT;       0775 02709000
         LH    @15,RELSIZE                                         0775 02710000
         LA    @14,RELATION(@15)                                   0775 02711000
         LH    @05,UNITINDX                                        0775 02712000
         LR    @04,@05                                             0775 02713000
         BCTR  @04,0                                               0775 02714000
         EX    @04,@SM01324                                        0775 02715000
*              RELSIZE=RELSIZE+UNITINDX;                           0776 02716000
*                                                                  0776 02717000
         ALR   @15,@05                                             0776 02718000
         STH   @15,RELSIZE                                         0776 02719000
*              /******************************************************/ 02720000
*              /*                                                    */ 02721000
*              /* THE FINAL CHARACTER IN THE LAST EXPRESSION ELEMENT */ 02722000
*              /* SHOULD ALWAYS BE A DECIMAL DIGIT; OTHERWISE, THE   */ 02723000
*              /* RELATIONAL EXPRESSION IS IN ERROR.                 */ 02724000
*              /*                                                    */ 02725000
*              /******************************************************/ 02726000
*              IF SYNUNIT(UNITINDX) >= '0' & SYNUNIT(UNITINDX) <= '9' | 02727000
*                 CHAR1=ENDDELIM                                   0777 02728000
*                THEN                                              0777 02729000
         LA    @04,SYNUNIT-1(@05)                                  0777 02730000
         CLI   0(@04),C'0'                                         0777 02731000
         BL    @GL00020                                            0777 02732000
         LA    @04,SYNUNIT-1(@05)                                  0777 02733000
         CLI   0(@04),C'9'                                         0777 02734000
         BNH   @RT00777                                            0777 02735000
@GL00020 CLI   CHAR1,C';'                                          0777 02736000
         BNE   @RF00777                                            0777 02737000
@RT00777 DS    0H                                                  0778 02738000
*                  EXPREND=YES;                                    0778 02739000
         OI    EXPREND,B'00100000'                                 0778 02740000
*              END;                                                0779 02741000
@RF00777 DS    0H                                                  0780 02742000
*        END;                                                      0780 02743000
@RC00772 DS    0H                                                  0780 02744000
@DE00769 TM    EXPREND,B'00100000'                                 0780 02745000
         BNZ   @DC00769                                            0780 02746000
         LH    @15,RISTATUS                                        0780 02747000
         LTR   @15,@15                                             0780 02748000
         BZ    @DL00769                                            0780 02749000
@DC00769 DS    0H                                                  0781 02750000
*        IF RISTATUS=0                                             0781 02751000
*          THEN                                                    0781 02752000
*                                                                  0781 02753000
         LH    @15,RISTATUS                                        0781 02754000
         LTR   @15,@15                                             0781 02755000
         BNZ   @RF00781                                            0781 02756000
*            /********************************************************/ 02757000
*            /*                                                      */ 02758000
*            /* DEPENDING UPON WHETHER THE EXPRESSION INVOLVES MAXCC */ 02759000
*            /* OR LASTCC, OBTAIN THE CURRENT CONDITION CODE TO BE   */ 02760000
*            /* USED IN THE COMPARISON.                              */ 02761000
*            /*                                                      */ 02762000
*            /********************************************************/ 02763000
*            IF RELATION(1:MAXCCLN)=MAXCCSYM                       0782 02764000
*              THEN                                                0782 02765000
         L     @01,GDTPTR                                          0782 02766000
         L     @01,GDTRIH(,@01)                                    0782 02767000
         L     @15,KWTBLPTR(,@01)                                  0782 02768000
         SLR   @14,@14                                             0782 02769000
         IC    @14,MAXCCLN(,@15)                                   0782 02770000
         LR    @05,@14                                             0782 02771000
         BCTR  @05,0                                               0782 02772000
         EX    @05,@SC01326                                        0782 02773000
         BNE   @RF00782                                            0782 02774000
*                DO;                                               0783 02775000
*                CCVALUE=MAXCC;                                    0784 02776000
         MVC   CCVALUE(2),MAXCC                                    0784 02777000
*                PART1LEN=MAXCCLN;                                 0785 02778000
         STH   @14,PART1LEN                                        0785 02779000
*                END;                                              0786 02780000
*              ELSE                                                0787 02781000
*                IF RELATION(1:LSTCCLN)=LSTCCSYM                   0787 02782000
*                  THEN                                            0787 02783000
         B     @RC00782                                            0787 02784000
@RF00782 L     @01,GDTPTR                                          0787 02785000
         L     @01,GDTRIH(,@01)                                    0787 02786000
         L     @15,KWTBLPTR(,@01)                                  0787 02787000
         SLR   @14,@14                                             0787 02788000
         IC    @14,LSTCCLN(,@15)                                   0787 02789000
         LR    @05,@14                                             0787 02790000
         BCTR  @05,0                                               0787 02791000
         EX    @05,@SC01328                                        0787 02792000
         BNE   @RF00787                                            0787 02793000
*                    DO;                                           0788 02794000
*                    CCVALUE=LASTCC;                               0789 02795000
         MVC   CCVALUE(2),LASTCC                                   0789 02796000
*                    PART1LEN=LSTCCLN;                             0790 02797000
         STH   @14,PART1LEN                                        0790 02798000
*                    END;                                          0791 02799000
*                  ELSE                                            0792 02800000
*                    RISTATUS=BADEXPR1;                            0792 02801000
         B     @RC00787                                            0792 02802000
@RF00787 MVC   RISTATUS(2),@CH00302                                0792 02803000
*        IF RISTATUS=0                                             0793 02804000
*          THEN                                                    0793 02805000
@RC00787 DS    0H                                                  0793 02806000
@RC00782 DS    0H                                                  0793 02807000
@RF00781 LH    @15,RISTATUS                                        0793 02808000
         LTR   @15,@15                                             0793 02809000
         BNZ   @RF00793                                            0793 02810000
*DOGRP30:    DO;                                                   0794 02811000
*                                                                  0794 02812000
DOGRP30  DS    0H                                                  0795 02813000
*            /********************************************************/ 02814000
*            /*                                                      */ 02815000
*            /* SKIP PAST THE OPERATOR OF THE RELATIONAL EXPRESSION  */ 02816000
*            /* AND CONVERT THE NUMBER TO WHICH THE CONDITION CODE   */ 02817000
*            /* VALUE IS TO BE COMPARED.                             */ 02818000
*            /*                                                      */ 02819000
*            /********************************************************/ 02820000
*            IF RELATION(PART1LEN+2) >= '0' &                      0795 02821000
*               RELATION(PART1LEN+2) <= '9'                        0795 02822000
*              THEN                                                0795 02823000
         LH    @15,PART1LEN                                        0795 02824000
         LA    @14,RELATION+1(@15)                                 0795 02825000
         CLI   0(@14),C'0'                                         0795 02826000
         BL    @RF00795                                            0795 02827000
         LA    @14,RELATION+1(@15)                                 0795 02828000
         CLI   0(@14),C'9'                                         0795 02829000
         BH    @RF00795                                            0795 02830000
*                DIGITPOS=PART1LEN+2;                              0796 02831000
         LA    @15,2(,@15)                                         0796 02832000
         STH   @15,DIGITPOS                                        0796 02833000
*              ELSE                                                0797 02834000
*                DIGITPOS=PART1LEN+3;                              0797 02835000
         B     @RC00795                                            0797 02836000
@RF00795 LH    @01,PART1LEN                                        0797 02837000
         LA    @01,3(,@01)                                         0797 02838000
         STH   @01,DIGITPOS                                        0797 02839000
*            IF DIGITPOS <= RELSIZE                                0798 02840000
*              THEN                                                0798 02841000
@RC00795 LH    @15,DIGITPOS                                        0798 02842000
         LH    @14,RELSIZE                                         0798 02843000
         CR    @15,@14                                             0798 02844000
         BH    @RF00798                                            0798 02845000
*                DO;                                               0799 02846000
*                UNITINDX=RELSIZE-DIGITPOS+1;                      0800 02847000
         SLR   @14,@15                                             0800 02848000
         LA    @01,1(,@14)                                         0800 02849000
         STH   @01,UNITINDX                                        0800 02850000
*                SYNUNIT=RELATION(DIGITPOS:RELSIZE);               0801 02851000
*                                                                  0801 02852000
         MVI   SYNUNIT+1,C' '                                      0801 02853000
         MVC   SYNUNIT+2(253),SYNUNIT+1                            0801 02854000
         LA    @01,RELATION-1(@15)                                 0801 02855000
         EX    @14,@SM01330                                        0801 02856000
*                CALL PACKCVB;                                     0802 02857000
*                                                                  0802 02858000
         BAL   @14,PACKCVB                                         0802 02859000
*                IF RISTATUS^=0                                    0803 02860000
*                  THEN                                            0803 02861000
         LH    @15,RISTATUS                                        0803 02862000
         LTR   @15,@15                                             0803 02863000
         BZ    @RF00803                                            0803 02864000
*                    RISTATUS=SKIPREST;                            0804 02865000
         MVC   RISTATUS(2),@CH00042                                0804 02866000
*                END;                                              0805 02867000
*              ELSE                                                0806 02868000
*                RISTATUS=BADEXPR1;                                0806 02869000
*                                                                  0806 02870000
         B     @RC00798                                            0806 02871000
@RF00798 MVC   RISTATUS(2),@CH00302                                0806 02872000
*            /********************************************************/ 02873000
*            /*                                                      */ 02874000
*            /* MATCH THE EXPRESSION'S OPERATOR WITH ONE OF THE      */ 02875000
*            /* OPERATORS ALLOWED; THEN PERFORM THE INDICATED        */ 02876000
*            /* COMPARISON BETWEEN THE CONDITION CODE & THE PROVIDED */ 02877000
*            /* VALUE.  IF A MATCHING OPERATOR IS NOT FOUND, IT IS   */ 02878000
*            /* AN ERROR.  IF THE COMPARISON IS FALSE, A FLAG IS SET */ 02879000
*            /* TO SIGNAL THAT COMMANDS ASSOCIATED WITH THE 'THEN    */ 02880000
*            /* PATH' ARE SIMPLY TO BE SCANNED FOR CORRECT SYNTAX.   */ 02881000
*            /*                                                      */ 02882000
*            /********************************************************/ 02883000
*            RELOPER=RELATION(PART1LEN+1:DIGITPOS-1);              0807 02884000
@RC00798 MVI   RELOPER+1,C' '                                      0807 02885000
         LH    @15,PART1LEN                                        0807 02886000
         LH    @14,DIGITPOS                                        0807 02887000
         SLR   @14,@15                                             0807 02888000
         BCTR  @14,0                                               0807 02889000
         BCTR  @14,0                                               0807 02890000
         LA    @01,RELATION(@15)                                   0807 02891000
         EX    @14,@SM01332                                        0807 02892000
*            IF RELOPER=GESIGN1 | RELOPER=GESIGN2                  0808 02893000
*              THEN                                                0808 02894000
         CLC   RELOPER(2),@CC00910                                 0808 02895000
         BE    @RT00808                                            0808 02896000
         CLC   RELOPER(2),@CC00912                                 0808 02897000
         BNE   @RF00808                                            0808 02898000
@RT00808 DS    0H                                                  0809 02899000
*                IF CCVALUE < CNVRTWRD                             0809 02900000
*                  THEN                                            0809 02901000
         LH    @15,CCVALUE                                         0809 02902000
         C     @15,CNVRTWRD                                        0809 02903000
         BNL   @RF00809                                            0809 02904000
*                    SKIPFLAG(NESTLVL)=ON;                         0810 02905000
         L     @01,GDTPTR                                          0810 02906000
         L     @15,GDTRIH(,@01)                                    0810 02907000
         SLR   @14,@14                                             0810 02908000
         IC    @14,NESTLVL(,@15)                                   0810 02909000
         ALR   @14,@14                                             0810 02910000
         ALR   @15,@14                                             0810 02911000
         OI    SKIPFLAG-2(@15),B'00010000'                         0810 02912000
*                  ELSE;                                           0811 02913000
@RF00809 DS    0H                                                  0812 02914000
*              ELSE                                                0812 02915000
*                IF RELOPER=LESIGN1 | RELOPER=LESIGN2              0812 02916000
*                  THEN                                            0812 02917000
         B     @RC00808                                            0812 02918000
@RF00808 CLC   RELOPER(2),@CC00914                                 0812 02919000
         BE    @RT00812                                            0812 02920000
         CLC   RELOPER(2),@CC00916                                 0812 02921000
         BNE   @RF00812                                            0812 02922000
@RT00812 DS    0H                                                  0813 02923000
*                    IF CCVALUE > CNVRTWRD                         0813 02924000
*                      THEN                                        0813 02925000
         LH    @15,CCVALUE                                         0813 02926000
         C     @15,CNVRTWRD                                        0813 02927000
         BNH   @RF00813                                            0813 02928000
*                        SKIPFLAG(NESTLVL)=ON;                     0814 02929000
         L     @01,GDTPTR                                          0814 02930000
         L     @15,GDTRIH(,@01)                                    0814 02931000
         SLR   @14,@14                                             0814 02932000
         IC    @14,NESTLVL(,@15)                                   0814 02933000
         ALR   @14,@14                                             0814 02934000
         ALR   @15,@14                                             0814 02935000
         OI    SKIPFLAG-2(@15),B'00010000'                         0814 02936000
*                      ELSE;                                       0815 02937000
@RF00813 DS    0H                                                  0816 02938000
*                  ELSE                                            0816 02939000
*                    IF RELOPER=NESIGN1 | RELOPER=NESIGN2          0816 02940000
*                      THEN                                        0816 02941000
         B     @RC00812                                            0816 02942000
@RF00812 CLC   RELOPER(2),@CC00906                                 0816 02943000
         BE    @RT00816                                            0816 02944000
         CLC   RELOPER(2),@CC00908                                 0816 02945000
         BNE   @RF00816                                            0816 02946000
@RT00816 DS    0H                                                  0817 02947000
*                        IF CCVALUE=CNVRTWRD                       0817 02948000
*                          THEN                                    0817 02949000
         LH    @15,CCVALUE                                         0817 02950000
         C     @15,CNVRTWRD                                        0817 02951000
         BNE   @RF00817                                            0817 02952000
*                            SKIPFLAG(NESTLVL)=ON;                 0818 02953000
         L     @01,GDTPTR                                          0818 02954000
         L     @15,GDTRIH(,@01)                                    0818 02955000
         SLR   @14,@14                                             0818 02956000
         IC    @14,NESTLVL(,@15)                                   0818 02957000
         ALR   @14,@14                                             0818 02958000
         ALR   @15,@14                                             0818 02959000
         OI    SKIPFLAG-2(@15),B'00010000'                         0818 02960000
*                          ELSE;                                   0819 02961000
@RF00817 DS    0H                                                  0820 02962000
*                      ELSE                                        0820 02963000
*                        IF RELOPER=GTSIGN1 | RELOPER=GTSIGN2      0820 02964000
*                          THEN                                    0820 02965000
         B     @RC00816                                            0820 02966000
@RF00816 CLI   RELOPER,C'>'                                        0820 02967000
         BE    @RT00820                                            0820 02968000
         CLC   RELOPER(2),@CC00900                                 0820 02969000
         BNE   @RF00820                                            0820 02970000
@RT00820 DS    0H                                                  0821 02971000
*                            IF CCVALUE <= CNVRTWRD                0821 02972000
*                              THEN                                0821 02973000
         LH    @15,CCVALUE                                         0821 02974000
         C     @15,CNVRTWRD                                        0821 02975000
         BH    @RF00821                                            0821 02976000
*                                SKIPFLAG(NESTLVL)=ON;             0822 02977000
         L     @01,GDTPTR                                          0822 02978000
         L     @15,GDTRIH(,@01)                                    0822 02979000
         SLR   @14,@14                                             0822 02980000
         IC    @14,NESTLVL(,@15)                                   0822 02981000
         ALR   @14,@14                                             0822 02982000
         ALR   @15,@14                                             0822 02983000
         OI    SKIPFLAG-2(@15),B'00010000'                         0822 02984000
*                              ELSE;                               0823 02985000
@RF00821 DS    0H                                                  0824 02986000
*                          ELSE                                    0824 02987000
*                            IF RELOPER=LTSIGN1 | RELOPER=LTSIGN2  0824 02988000
*                              THEN                                0824 02989000
         B     @RC00820                                            0824 02990000
@RF00820 CLI   RELOPER,C'<'                                        0824 02991000
         BE    @RT00824                                            0824 02992000
         CLC   RELOPER(2),@CC00904                                 0824 02993000
         BNE   @RF00824                                            0824 02994000
@RT00824 DS    0H                                                  0825 02995000
*                                IF CCVALUE >= CNVRTWRD            0825 02996000
*                                  THEN                            0825 02997000
         LH    @15,CCVALUE                                         0825 02998000
         C     @15,CNVRTWRD                                        0825 02999000
         BL    @RF00825                                            0825 03000000
*                                    SKIPFLAG(NESTLVL)=ON;         0826 03001000
         L     @01,GDTPTR                                          0826 03002000
         L     @15,GDTRIH(,@01)                                    0826 03003000
         SLR   @14,@14                                             0826 03004000
         IC    @14,NESTLVL(,@15)                                   0826 03005000
         ALR   @14,@14                                             0826 03006000
         ALR   @15,@14                                             0826 03007000
         OI    SKIPFLAG-2(@15),B'00010000'                         0826 03008000
*                                  ELSE;                           0827 03009000
@RF00825 DS    0H                                                  0828 03010000
*                              ELSE                                0828 03011000
*                                IF RELOPER=EQSIGN1 | RELOPER=EQSIGN2   03012000
*                                  THEN                            0828 03013000
         B     @RC00824                                            0828 03014000
@RF00824 CLI   RELOPER,C'='                                        0828 03015000
         BE    @RT00828                                            0828 03016000
         CLC   RELOPER(2),@CC00853                                 0828 03017000
         BNE   @RF00828                                            0828 03018000
@RT00828 DS    0H                                                  0829 03019000
*                                    IF CCVALUE ^= CNVRTWRD        0829 03020000
*                                      THEN                        0829 03021000
         LH    @15,CCVALUE                                         0829 03022000
         C     @15,CNVRTWRD                                        0829 03023000
         BE    @RF00829                                            0829 03024000
*                                        SKIPFLAG(NESTLVL)=ON;     0830 03025000
         L     @01,GDTPTR                                          0830 03026000
         L     @15,GDTRIH(,@01)                                    0830 03027000
         SLR   @14,@14                                             0830 03028000
         IC    @14,NESTLVL(,@15)                                   0830 03029000
         ALR   @14,@14                                             0830 03030000
         ALR   @15,@14                                             0830 03031000
         OI    SKIPFLAG-2(@15),B'00010000'                         0830 03032000
*                                      ELSE;                       0831 03033000
@RF00829 DS    0H                                                  0832 03034000
*                                  ELSE                            0832 03035000
*                                    RISTATUS=BADEXPR1;            0832 03036000
*                                                                  0832 03037000
         B     @RC00828                                            0832 03038000
@RF00828 MVC   RISTATUS(2),@CH00302                                0832 03039000
*            /********************************************************/ 03040000
*            /*                                                      */ 03041000
*            /* IF THIS 'IF' COMMAND IS JUST BEING SCANNED FOR SYNTAX*/ 03042000
*            /* CHECKING, THEN OVERRIDE THE RESULT OF THE RELATIONAL */ 03043000
*            /* EXPRESSION EVALUATION AND NOTE THAT ALL COMMANDS AT  */ 03044000
*            /* THIS DEEPER LEVEL ARE ALSO JUST TO BE SCANNED.       */ 03045000
*            /*                                                      */ 03046000
*            /********************************************************/ 03047000
*            IF NESTLVL>1 & SKIPFLAG(NESTLVL-1)=ON                 0833 03048000
*              THEN                                                0833 03049000
@RC00828 DS    0H                                                  0833 03050000
@RC00824 DS    0H                                                  0833 03051000
@RC00820 DS    0H                                                  0833 03052000
@RC00816 DS    0H                                                  0833 03053000
@RC00812 DS    0H                                                  0833 03054000
@RC00808 L     @01,GDTPTR                                          0833 03055000
         L     @15,GDTRIH(,@01)                                    0833 03056000
         CLI   NESTLVL(@15),1                                      0833 03057000
         BNH   @RF00833                                            0833 03058000
         SLR   @14,@14                                             0833 03059000
         IC    @14,NESTLVL(,@15)                                   0833 03060000
         ALR   @14,@14                                             0833 03061000
         ST    @14,@TF00001                                        0833 03062000
         ALR   @14,@15                                             0833 03063000
         TM    SKIPFLAG-4(@14),B'00010000'                         0833 03064000
         BNO   @RF00833                                            0833 03065000
*                SKIPFLAG(NESTLVL)=ON;                             0834 03066000
*                                                                  0834 03067000
         AL    @15,@TF00001                                        0834 03068000
         OI    SKIPFLAG-2(@15),B'00010000'                         0834 03069000
*            END DOGRP30;                                          0835 03070000
@RF00833 DS    0H                                                  0836 03071000
*        IF RISTATUS=0                                             0836 03072000
*          THEN                                                    0836 03073000
@RF00793 LH    @15,RISTATUS                                        0836 03074000
         LTR   @15,@15                                             0836 03075000
         BNZ   @RF00836                                            0836 03076000
*DOGRP35:    DO;                                                   0837 03077000
*                                                                  0837 03078000
DOGRP35  DS    0H                                                  0838 03079000
*            /********************************************************/ 03080000
*            /*                                                      */ 03081000
*            /* EXTRACT THE FIELD WHICH FOLLOWS THE RELATIONAL       */ 03082000
*            /* EXPRESSION AND MAKE SURE IT IS THE 'THEN' KEYWORD;   */ 03083000
*            /* OTHERWISE, A SYNTAX ERROR HAS BEEN FOUND.            */ 03084000
*            /*                                                      */ 03085000
*            /********************************************************/ 03086000
*                                                                  0838 03087000
*            CALL NXTFIELD(VERBFLD);                               0838 03088000
         LA    @01,@AL00838                                        0838 03089000
         BAL   @14,NXTFIELD                                        0838 03090000
*            CALL SCANSEP(NO);                                     0839 03091000
*                                                                  0839 03092000
         LA    @01,@AL00839                                        0839 03093000
         BAL   @14,SCANSEP                                         0839 03094000
*            IF RISTATUS=0 & SYNUNIT=THENSYM                       0840 03095000
*              THEN                                                0840 03096000
*                                                                  0840 03097000
         LH    @15,RISTATUS                                        0840 03098000
         LTR   @15,@15                                             0840 03099000
         BNZ   @RF00840                                            0840 03100000
         L     @01,GDTPTR                                          0840 03101000
         L     @01,GDTRIH(,@01)                                    0840 03102000
         L     @01,KWTBLPTR(,@01)                                  0840 03103000
         CLC   SYNUNIT(9),THENSYM(@01)                             0840 03104000
         BNE   @RF00840                                            0840 03105000
*                /****************************************************/ 03106000
*                /*                                                  */ 03107000
*                /* IF THE COMMAND-END DELIMITER IMMEDIATELY FOLLOWS */ 03108000
*                /* THE 'THEN' KEYWORD, THE 'THEN PATH' JUST CONSISTS*/ 03109000
*                /* OF A NULL COMMAND.  THE DELIMITER IS SIMPLY      */ 03110000
*                /* BYPASSED AND SCANNING CONTINUES.                 */ 03111000
*                /*                                                  */ 03112000
*                /****************************************************/ 03113000
*                IF CHAR1=ENDDELIM                                 0841 03114000
*                  THEN                                            0841 03115000
*                                                                  0841 03116000
         CLI   CHAR1,C';'                                          0841 03117000
         BNE   @RF00841                                            0841 03118000
*                    CALL BYPASTRM;                                0842 03119000
*                                                                  0842 03120000
         BAL   @14,BYPASTRM                                        0842 03121000
*                  ELSE                                            0843 03122000
*                                                                  0843 03123000
*                    /************************************************/ 03124000
*                    /*                                              */ 03125000
*                    /* EXTRACT THE VERB NAME OF THE COMMAND WHICH   */ 03126000
*                    /* FOLLOWS THE 'THEN' KEYWORD. IF IT IS A 'DO'  */ 03127000
*                    /* COMMAND, SET THE FLAG THAT INDICATES THAT A  */ 03128000
*                    /* 'DO GROUP' FOLLOWS AND SCAN UP TO THE NEXT   */ 03129000
*                    /* COMMAND VERB NAME.  IF NOT A 'DO', NOTE THAT */ 03130000
*                    /* THE NEXT COMMAND VERB NAME HAS ALREADY BEEN  */ 03131000
*                    /* EXTRACTED.  IF THAT VERB NAME IS NOT 'IF',   */ 03132000
*                    /* THEN A SINGLE COMMAND FOLLOWS THE 'THEN' AT  */ 03133000
*                    /* THIS NESTING LEVEL.                          */ 03134000
*                    /*                                              */ 03135000
*                    /************************************************/ 03136000
*                    DO;                                           0843 03137000
*                                                                  0843 03138000
         B     @RC00841                                            0843 03139000
@RF00841 DS    0H                                                  0844 03140000
*                    CALL NXTFIELD(VERBFLD);                       0844 03141000
         LA    @01,@AL00844                                        0844 03142000
         BAL   @14,NXTFIELD                                        0844 03143000
*                    CALL SCANSEP(NO);                             0845 03144000
*                                                                  0845 03145000
         LA    @01,@AL00845                                        0845 03146000
         BAL   @14,SCANSEP                                         0845 03147000
*                    IF RISTATUS=0 & SYNUNIT=DOSYM                 0846 03148000
*                      THEN                                        0846 03149000
         LH    @15,RISTATUS                                        0846 03150000
         LTR   @15,@15                                             0846 03151000
         BNZ   @RF00846                                            0846 03152000
         L     @01,GDTPTR                                          0846 03153000
         L     @01,GDTRIH(,@01)                                    0846 03154000
         L     @01,KWTBLPTR(,@01)                                  0846 03155000
         CLC   SYNUNIT(9),DOSYM(@01)                               0846 03156000
         BNE   @RF00846                                            0846 03157000
*                        DO;                                       0847 03158000
*                                                                  0847 03159000
*                        CALL BYPASTRM;                            0848 03160000
*                                                                  0848 03161000
         BAL   @14,BYPASTRM                                        0848 03162000
*                        DOFLAG(NESTLVL)=ON;                       0849 03163000
         L     @01,GDTPTR                                          0849 03164000
         L     @15,GDTRIH(,@01)                                    0849 03165000
         SLR   @14,@14                                             0849 03166000
         IC    @14,NESTLVL(,@15)                                   0849 03167000
         ALR   @14,@14                                             0849 03168000
         ALR   @15,@14                                             0849 03169000
         OI    DOFLAG-2(@15),B'10000000'                           0849 03170000
*                        END;                                      0850 03171000
*                      ELSE                                        0851 03172000
*                        DO;                                       0851 03173000
         B     @RC00846                                            0851 03174000
@RF00846 DS    0H                                                  0852 03175000
*                        GETVERB=NO;                               0852 03176000
         NI    GETVERB,B'11111011'                                 0852 03177000
*                        IF SYNUNIT ^= IFSYM                       0853 03178000
*                          THEN                                    0853 03179000
         L     @01,GDTPTR                                          0853 03180000
         L     @01,GDTRIH(,@01)                                    0853 03181000
         L     @01,KWTBLPTR(,@01)                                  0853 03182000
         CLC   SYNUNIT(9),IFSYM(@01)                               0853 03183000
         BE    @RF00853                                            0853 03184000
*                            SINGLCMD=YES;                         0854 03185000
         OI    SINGLCMD,B'00010000'                                0854 03186000
*                          ELSE                                    0855 03187000
*                            IFNEXT=YES;                           0855 03188000
         B     @RC00853                                            0855 03189000
@RF00853 OI    IFNEXT,B'00001000'                                  0855 03190000
*                        END;                                      0856 03191000
*                    END;                                          0857 03192000
*                                                                  0857 03193000
*              /******************************************************/ 03194000
*              /*                                                    */ 03195000
*              /* THE KEYWORD 'THEN' IS MISSING FROM 'IF' COMMAND    */ 03196000
*              /* OR SOME OTHER ERROR HAS ALREADY OCCURRED.          */ 03197000
*              /*                                                    */ 03198000
*              /******************************************************/ 03199000
*              ELSE                                                0858 03200000
*                IF RISTATUS=0                                     0858 03201000
*                  THEN                                            0858 03202000
         B     @RC00840                                            0858 03203000
@RF00840 LH    @15,RISTATUS                                        0858 03204000
         LTR   @15,@15                                             0858 03205000
         BNZ   @RF00858                                            0858 03206000
*                    DO;                                           0859 03207000
*                    LASTCC=TERMERR;                               0860 03208000
         MVC   LASTCC(2),@CH00274                                  0860 03209000
*                    RISTATUS=NOTHEN;                              0861 03210000
         MVC   RISTATUS(2),@CH00306                                0861 03211000
*                    END;                                          0862 03212000
*            END DOGRP35;                                          0863 03213000
@RF00858 DS    0H                                                  0863 03214000
@RC00840 DS    0H                                                  0864 03215000
*        IF RISTATUS ^= 0                                          0864 03216000
*          THEN                                                    0864 03217000
@RF00836 LH    @15,RISTATUS                                        0864 03218000
         LTR   @15,@15                                             0864 03219000
         BZ    @RF00864                                            0864 03220000
*            IF RISTATUS=EOFILE & EOFOK=YES                        0865 03221000
*              THEN;                                               0865 03222000
         CH    @15,@CH00118                                        0865 03223000
         BNE   @RF00865                                            0865 03224000
         TM    EOFOK,B'01000000'                                   0865 03225000
         BO    @RT00865                                            0865 03226000
*              ELSE                                                0867 03227000
*                LASTCC=TERMERR;                                   0867 03228000
*                                                                  0867 03229000
@RF00865 MVC   LASTCC(2),@CH00274                                  0867 03230000
*        END MODALIF;                                              0868 03231000
         B     @EL00006                                            0868 03232000
*/********************************************************************/ 03233000
*/*                                                                  */ 03234000
*/*  PROCEDURE NAME - MODLELSE                                       */ 03235000
*/*                                                                  */ 03236000
*/*  FUNCTION - THIS ROUTINE SETS UP TO SCAN AND INTERPRET WHAT      */ 03237000
*/*             FOLLOWS THE 'ELSE' COMMAND.  APPROPRIATE CONTROL     */ 03238000
*/*             FLAGS ARE SET AND A CHECK IS MADE TO SEE IF AN 'IF'  */ 03239000
*/*             COMMAND OR A DO-GROUP FOLLOWS THE 'ELSE' COMMAND.    */ 03240000
*/*                                                                  */ 03241000
*/*  INPUT -                                                         */ 03242000
*/*          SKIPFLAG- FLAG SET 'ON' WHEN COMMANDS ARE (HAVE BEEN)   */ 03243000
*/*                    GETTING SCANNED FOR SYNTAX CHECKING ONLY.     */ 03244000
*/*          NESTLVL - LEVEL OF 'IF' COMMAND NESTING AT WHICH        */ 03245000
*/*                    SCANNING IS CURRENTLY TAKING PLACE.           */ 03246000
*/*          CHAR1 -   CHARACTER MOST RECENTLY EXTRACTED.            */ 03247000
*/*          SYNUNIT - SYNTACTIC UNIT MOST RECENTLY EXTRACTED.       */ 03248000
*/*                                                                  */ 03249000
*/*  OUTPUT -                                                        */ 03250000
*/*          DOFLAG -  SET 'ON' WHEN SCANNING WITHIN A DO-GROUP AT   */ 03251000
*/*                    CURRENT 'IF' NESTING LEVEL                    */ 03252000
*/*          THENFLAG- SET 'ON' WHEN SCANNING 'THEN-PATH' COMMANDS   */ 03253000
*/*                    AT CURRENT 'IF' NESTING LEVEL                 */ 03254000
*/*          ELSEFLAG- SET 'ON' WHEN SCANNING 'ELSE-PATH' COMMANDS   */ 03255000
*/*                    AT CURRENT 'IF' NESTING LEVEL                 */ 03256000
*/*          SKIPFLAG- SEE 'INPUT'                                   */ 03257000
*/*          NESTLVL - CURRENT LEVEL OF 'IF' COMMAND NESTING         */ 03258000
*/*          IFNEXT -  FLAG SET 'ON' WHEN AN 'IF' COMMANDS FOLLOWS   */ 03259000
*/*                    THE 'ELSE' COMMAND VERB                       */ 03260000
*/*          GETVERB - FLAG SET 'ON' WHEN THE NEXT COMMAND VERB IS   */ 03261000
*/*                    YET TO BE EXTRACTED AFTER THE 'ELSE' COMMAND. */ 03262000
*/*          SINGLCMD- FLAG SET 'ON' WHEN A SINGLE COMMAND AS OPPOSED*/ 03263000
*/*                    TO A DO-GROUP FOLLOWS THE 'ELSE' COMMAND.     */ 03264000
*/*          LASTCC -  VALUE OF LAST SYSTEM CONDITION CODE; MAY BE   */ 03265000
*/*                    RESET IF SYNTAX ERROR IS FOUND IN 'ELSE' CMD. */ 03266000
*/*                                                                  */ 03267000
*/********************************************************************/ 03268000
*MODLELSE:PROCEDURE;                                               0869 03269000
MODLELSE STM   @14,@12,@SA00007                                    0869 03270000
*        /************************************************************/ 03271000
*        /*                                                          */ 03272000
*        /*  ** MODLELSE **  INTERPRET THE MODAL 'ELSE' COMMAND      */ 03273000
*        /*                                                          */ 03274000
*        /************************************************************/ 03275000
*        IF GDTDBG = NULLPTR                                       0870 03276000
*          THEN;                                                   0870 03277000
         L     @01,GDTPTR                                          0870 03278000
         L     @15,GDTDBG(,@01)                                    0870 03279000
         LTR   @15,@15                                             0870 03280000
         BZ    @RT00870                                            0870 03281000
*          ELSE                                                    0872 03282000
*            CALL ICKDB010(GDTTBL,'RIME');                         0872 03283000
*                                                                  0872 03284000
         L     @15,GDTPTR                                          0872 03285000
         ST    @15,@AL00001                                        0872 03286000
         LA    @14,@CC00927                                        0872 03287000
         ST    @14,@AL00001+4                                      0872 03288000
         MVI   @AL00001+4,X'80'                                    0872 03289000
         L     @15,GDTDBG(,@15)                                    0872 03290000
         LA    @01,@AL00001                                        0872 03291000
         BALR  @14,@15                                             0872 03292000
*        THENFLAG(NESTLVL)=OFF;                                    0873 03293000
@RT00870 DS    0H                                                  0874 03294000
*        ELSEFLAG(NESTLVL)=ON;                                     0874 03295000
*                                                                  0874 03296000
         L     @01,GDTPTR                                          0874 03297000
         L     @15,GDTRIH(,@01)                                    0874 03298000
         SLR   @14,@14                                             0874 03299000
         IC    @14,NESTLVL(,@15)                                   0874 03300000
         ALR   @14,@14                                             0874 03301000
         ST    @14,@TF00001                                        0874 03302000
         ALR   @14,@15                                             0874 03303000
         OI    ELSEFLAG-2(@14),B'00100000'                         0874 03304000
         NI    THENFLAG-2(@14),B'10111111'                         0874 03305000
*        /************************************************************/ 03306000
*        /*                                                          */ 03307000
*        /* IF WHAT FOLLOWED THE MATCHING 'THEN' FOR THIS 'ELSE' WAS */ 03308000
*        /* SCANNED ONLY (BECAUSE OF THE RESULT OF AN 'IF'           */ 03309000
*        /* EXPRESSION), THEN SET THE FLAG TO INDICATE THAT A        */ 03310000
*        /* FUNCTION COMMAND ASSOCIATED WITH THIS 'ELSE' MAY BE      */ 03311000
*        /* ACCEPTED FOR EXECUTION.                                  */ 03312000
*        /*                                                          */ 03313000
*        /************************************************************/ 03314000
*        IF SKIPFLAG(NESTLVL)=OFF                                  0875 03315000
*          THEN                                                    0875 03316000
         LR    @14,@15                                             0875 03317000
         AL    @14,@TF00001                                        0875 03318000
         TM    SKIPFLAG-2(@14),B'00010000'                         0875 03319000
         BNZ   @RF00875                                            0875 03320000
*            SKIPFLAG(NESTLVL)=ON;                                 0876 03321000
         AL    @15,@TF00001                                        0876 03322000
         OI    SKIPFLAG-2(@15),B'00010000'                         0876 03323000
*          ELSE                                                    0877 03324000
*            IF NESTLVL<=1 | SKIPFLAG(NESTLVL-1)=OFF               0877 03325000
*              THEN                                                0877 03326000
         B     @RC00875                                            0877 03327000
@RF00875 L     @01,GDTPTR                                          0877 03328000
         L     @15,GDTRIH(,@01)                                    0877 03329000
         CLI   NESTLVL(@15),1                                      0877 03330000
         BNH   @RT00877                                            0877 03331000
         SLR   @14,@14                                             0877 03332000
         IC    @14,NESTLVL(,@15)                                   0877 03333000
         ALR   @14,@14                                             0877 03334000
         ALR   @15,@14                                             0877 03335000
         TM    SKIPFLAG-4(@15),B'00010000'                         0877 03336000
         BNZ   @RF00877                                            0877 03337000
@RT00877 DS    0H                                                  0878 03338000
*                SKIPFLAG(NESTLVL)=OFF;                            0878 03339000
*                                                                  0878 03340000
         L     @01,GDTPTR                                          0878 03341000
         L     @15,GDTRIH(,@01)                                    0878 03342000
         SLR   @14,@14                                             0878 03343000
         IC    @14,NESTLVL(,@15)                                   0878 03344000
         ALR   @14,@14                                             0878 03345000
         ALR   @15,@14                                             0878 03346000
         NI    SKIPFLAG-2(@15),B'11101111'                         0878 03347000
*        /************************************************************/ 03348000
*        /*                                                          */ 03349000
*        /* IF THE COMMAND-END DELIMITER IMMEDIATELY FOLLOWS THE     */ 03350000
*        /* 'ELSE' KEYWORD, THE 'ELSE PATH' CONSISTS ONLY OF A NULL  */ 03351000
*        /* COMMAND.  THE COMMAND-END DELIMITER IS THEN BYPASSED AND */ 03352000
*        /* SCANNING CONTINUES.                                      */ 03353000
*        /*                                                          */ 03354000
*        /************************************************************/ 03355000
*        IF CHAR1=ENDDELIM                                         0879 03356000
*          THEN                                                    0879 03357000
@RF00877 DS    0H                                                  0879 03358000
@RC00875 CLI   CHAR1,C';'                                          0879 03359000
         BNE   @RF00879                                            0879 03360000
*            DO;                                                   0880 03361000
*            NESTLVL=NESTLVL-1;                                    0881 03362000
*                                                                  0881 03363000
         L     @01,GDTPTR                                          0881 03364000
         L     @15,GDTRIH(,@01)                                    0881 03365000
         SLR   @14,@14                                             0881 03366000
         IC    @14,NESTLVL(,@15)                                   0881 03367000
         BCTR  @14,0                                               0881 03368000
         STC   @14,NESTLVL(,@15)                                   0881 03369000
*            CALL BYPASTRM;                                        0882 03370000
*                                                                  0882 03371000
         BAL   @14,BYPASTRM                                        0882 03372000
*            END;                                                  0883 03373000
*          ELSE                                                    0884 03374000
*                                                                  0884 03375000
*            /********************************************************/ 03376000
*            /*                                                      */ 03377000
*            /* EXTRACT THE VERB NAME OF THE COMMAND WHICH FOLLOWS   */ 03378000
*            /* THE 'ELSE'.  IF IT IS A 'DO' COMMAND, SET THE FLAG   */ 03379000
*            /* THAT INDICATES THAT A 'DO GROUP' FOLLOWS AND SCAN UP */ 03380000
*            /* TO THE NEXT COMMAND VERB NAME.  IF NOT A 'DO', NOTE  */ 03381000
*            /* THAT THE NEXT COMMAND VERB NAME HAS ALREADY BEEN     */ 03382000
*            /* EXTRACTED.                                           */ 03383000
*            /*                                                      */ 03384000
*            /********************************************************/ 03385000
*            DO;                                                   0884 03386000
*                                                                  0884 03387000
         B     @RC00879                                            0884 03388000
@RF00879 DS    0H                                                  0885 03389000
*            CALL NXTFIELD(VERBFLD);                               0885 03390000
         LA    @01,@AL00885                                        0885 03391000
         BAL   @14,NXTFIELD                                        0885 03392000
*            CALL SCANSEP(NO);                                     0886 03393000
*                                                                  0886 03394000
         LA    @01,@AL00886                                        0886 03395000
         BAL   @14,SCANSEP                                         0886 03396000
*            IF SYNUNIT=DOSYM                                      0887 03397000
*              THEN                                                0887 03398000
         L     @01,GDTPTR                                          0887 03399000
         L     @01,GDTRIH(,@01)                                    0887 03400000
         L     @01,KWTBLPTR(,@01)                                  0887 03401000
         CLC   SYNUNIT(9),DOSYM(@01)                               0887 03402000
         BNE   @RF00887                                            0887 03403000
*                DO;                                               0888 03404000
*                                                                  0888 03405000
*                CALL BYPASTRM;                                    0889 03406000
*                                                                  0889 03407000
         BAL   @14,BYPASTRM                                        0889 03408000
*                DOFLAG(NESTLVL)=ON;                               0890 03409000
         L     @01,GDTPTR                                          0890 03410000
         L     @15,GDTRIH(,@01)                                    0890 03411000
         SLR   @14,@14                                             0890 03412000
         IC    @14,NESTLVL(,@15)                                   0890 03413000
         ALR   @14,@14                                             0890 03414000
         ALR   @15,@14                                             0890 03415000
         OI    DOFLAG-2(@15),B'10000000'                           0890 03416000
*                END;                                              0891 03417000
*              ELSE                                                0892 03418000
*                DO;                                               0892 03419000
         B     @RC00887                                            0892 03420000
@RF00887 DS    0H                                                  0893 03421000
*                GETVERB=NO;                                       0893 03422000
         NI    GETVERB,B'11111011'                                 0893 03423000
*                IF SYNUNIT^=IFSYM                                 0894 03424000
*                  THEN                                            0894 03425000
         L     @01,GDTPTR                                          0894 03426000
         L     @01,GDTRIH(,@01)                                    0894 03427000
         L     @01,KWTBLPTR(,@01)                                  0894 03428000
         CLC   SYNUNIT(9),IFSYM(@01)                               0894 03429000
         BE    @RF00894                                            0894 03430000
*                    SINGLCMD=YES;                                 0895 03431000
         OI    SINGLCMD,B'00010000'                                0895 03432000
*                  ELSE                                            0896 03433000
*                    IFNEXT=YES;                                   0896 03434000
         B     @RC00894                                            0896 03435000
@RF00894 OI    IFNEXT,B'00001000'                                  0896 03436000
*                END;                                              0897 03437000
@RC00894 DS    0H                                                  0898 03438000
*            END;                                                  0898 03439000
*                                                                  0898 03440000
@RC00887 DS    0H                                                  0899 03441000
*        IF RISTATUS ^= 0                                          0899 03442000
*          THEN                                                    0899 03443000
@RC00879 LH    @15,RISTATUS                                        0899 03444000
         LTR   @15,@15                                             0899 03445000
         BZ    @RF00899                                            0899 03446000
*            IF RISTATUS=EOFILE & EOFOK=YES                        0900 03447000
*              THEN;                                               0900 03448000
         CH    @15,@CH00118                                        0900 03449000
         BNE   @RF00900                                            0900 03450000
         TM    EOFOK,B'01000000'                                   0900 03451000
         BO    @RT00900                                            0900 03452000
*              ELSE                                                0902 03453000
*                LASTCC=TERMERR;                                   0902 03454000
*                                                                  0902 03455000
@RF00900 MVC   LASTCC(2),@CH00274                                  0902 03456000
*        END MODLELSE;                                             0903 03457000
@EL00007 DS    0H                                                  0903 03458000
@EF00007 DS    0H                                                  0903 03459000
@ER00007 LM    @14,@12,@SA00007                                    0903 03460000
         BR    @14                                                 0903 03461000
*/********************************************************************/ 03462000
*/*                                                                  */ 03463000
*/*  PROCEDURE NAME - BYPASTRM                                       */ 03464000
*/*                                                                  */ 03465000
*/*  FUNCTION - THIS ROUTINE BYPASSES THE COMMAND-END DELIMITER THAT */ 03466000
*/*             FOLLOWS A MODAL COMMAND OR INDICATES A NULL COMMAND  */ 03467000
*/*             AND ALSO SCANS PAST RECORDS WHICH FOLLOW THIS RECORD */ 03468000
*/*             IF CONTINUATION DELIMITERS ARE FOUND.  UPON EXIT FROM*/ 03469000
*/*             BYPASTRM, THE SCAN POINTS TO THE FIRST CHARACTER OF  */ 03470000
*/*             THE NEXT COMMAND VERB NAME.                          */ 03471000
*/*                                                                  */ 03472000
*/*  INPUT -                                                         */ 03473000
*/*          CHAR1 -   MOST RECENTLY EXTRACTED CHARACTER FROM THE    */ 03474000
*/*                    INPUT STREAM (SHOULD BE A SEMICOLON)          */ 03475000
*/*          MORTOCOM- FLAG SET 'ON' WHEN THE CURRENT RECORD IS      */ 03476000
*/*                    CONTINUED ON TO THE NEXT RECORD.              */ 03477000
*/*                                                                  */ 03478000
*/*  OUTPUT -                                                        */ 03479000
*/*          EOFOK -   FLAG SET 'ON' WHEN END-OF-FILE MAY CORRECTLY  */ 03480000
*/*                    ENCOUNTERED ON THE COMMAND INPUT STREAM.      */ 03481000
*/*          FIRSTCHR- FLAG SET 'ON' WHEN THE FIRST CHARACTER OF A   */ 03482000
*/*                    NEW RECORD IS TO BE OBTAINED NEXT.            */ 03483000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 03484000
*/*                    CODE IF END-OF-FILE IS FOUND WHILE SCANNING   */ 03485000
*/*                    UP TO THE NEXT COMMAND'S VERB NAME.           */ 03486000
*/*                                                                  */ 03487000
*/********************************************************************/ 03488000
*BYPASTRM:PROCEDURE;                                               0904 03489000
BYPASTRM STM   @14,@12,@SA00008                                    0904 03490000
*        /************************************************************/ 03491000
*        /*                                                          */ 03492000
*        /*  ** BYPASTRM **  BYPASS COMMAND-ENDING DELIMITER         */ 03493000
*        /*                                                          */ 03494000
*        /************************************************************/ 03495000
*        IF GDTDBG = NULLPTR                                       0905 03496000
*          THEN;                                                   0905 03497000
         L     @01,GDTPTR                                          0905 03498000
         L     @15,GDTDBG(,@01)                                    0905 03499000
         LTR   @15,@15                                             0905 03500000
         BZ    @RT00905                                            0905 03501000
*          ELSE                                                    0907 03502000
*            CALL ICKDB010(GDTTBL,'RIBT');                         0907 03503000
*                                                                  0907 03504000
         L     @15,GDTPTR                                          0907 03505000
         ST    @15,@AL00001                                        0907 03506000
         LA    @14,@CC00931                                        0907 03507000
         ST    @14,@AL00001+4                                      0907 03508000
         MVI   @AL00001+4,X'80'                                    0907 03509000
         L     @15,GDTDBG(,@15)                                    0907 03510000
         LA    @01,@AL00001                                        0907 03511000
         BALR  @14,@15                                             0907 03512000
*        DO WHILE(MORTOCOM=YES & RISTATUS=0);                      0908 03513000
*                                                                  0908 03514000
@RT00905 B     @DE00908                                            0908 03515000
@DL00908 DS    0H                                                  0909 03516000
*          CALL NEXTCHAR;                                          0909 03517000
         BAL   @14,NEXTCHAR                                        0909 03518000
*          CALL SKIPCMD;                                           0910 03519000
*                                                                  0910 03520000
         BAL   @14,SKIPCMD                                         0910 03521000
*        END;                                                      0911 03522000
@DE00908 TM    MORTOCOM,B'00010000'                                0911 03523000
         BNO   @DC00908                                            0911 03524000
         LH    @15,RISTATUS                                        0911 03525000
         LTR   @15,@15                                             0911 03526000
         BZ    @DL00908                                            0911 03527000
@DC00908 DS    0H                                                  0912 03528000
*        IF RISTATUS=0                                             0912 03529000
*          THEN                                                    0912 03530000
         LH    @15,RISTATUS                                        0912 03531000
         LTR   @15,@15                                             0912 03532000
         BNZ   @RF00912                                            0912 03533000
*            DO;                                                   0913 03534000
*            EOFOK=YES;                                            0914 03535000
         OI    EOFOK,B'01000000'                                   0914 03536000
*            FIRSTCHR=YES;                                         0915 03537000
         OI    FIRSTCHR,B'00000100'                                0915 03538000
*            CHAR1=BLANK;                                          0916 03539000
*                                                                  0916 03540000
         MVI   CHAR1,C' '                                          0916 03541000
*            CALL SCANSEP(NO);                                     0917 03542000
*                                                                  0917 03543000
         LA    @01,@AL00917                                        0917 03544000
         BAL   @14,SCANSEP                                         0917 03545000
*            END;                                                  0918 03546000
*        END BYPASTRM;                                             0919 03547000
*                                                                  0919 03548000
*                                                                  0919 03549000
@EL00008 DS    0H                                                  0919 03550000
@EF00008 DS    0H                                                  0919 03551000
@ER00008 LM    @14,@12,@SA00008                                    0919 03552000
         BR    @14                                                 0919 03553000
*        END GETNEXT;                                              0920 03554000
@EL00004 DS    0H                                                  0920 03555000
@EF00004 DS    0H                                                  0920 03556000
@ER00004 LM    @14,@12,@SA00004                                    0920 03557000
         BR    @14                                                 0920 03558000
*/********************************************************************/ 03559000
*/*                                                                  */ 03560000
*/*  PROCEDURE NAME - KWDPARM                                        */ 03561000
*/*                                                                  */ 03562000
*/*  FUNCTION - THIS ROUTINE EXTRACTS A KEYWORD AND THEN SEARCHES THE*/ 03563000
*/*             COMMAND DESCRIPTOR FOR A MATCH.  THEN, USING THE     */ 03564000
*/*             PARAMETER DESCRIPTION, THE ROUTINE SETS UP TO EXTRACT*/ 03565000
*/*             THIS PARAMETER'S SUBPARAMETERS OR DATA IF EITHER     */ 03566000
*/*             EXISTS.                                              */ 03567000
*/*                                                                  */ 03568000
*/*  INPUT -                                                         */ 03569000
*/*          COMMAND DESCRIPTOR FOR FUNCTION COMMAND BEING SCANNED.  */ 03570000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 03571000
*/*                    VALUE WHEN AN ERROR HAS OCCURRED.             */ 03572000
*/*          SUPERID - PARAMETER ID# OF PARAMETER WHOSE SUBPARAMETER */ 03573000
*/*                    LIST IS CURRENTLY BEING SCANNED (ID#=0 IF     */ 03574000
*/*                    FIRST-LEVEL PARM'S. ARE NOW BEING SCANNED).   */ 03575000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */ 03576000
*/*          SYNUNIT - CONTAINS THE KEYWORD JUST EXTRACTED           */ 03577000
*/*          UNITINDX- LENGTH OF KEYWORD JUST EXTRACTED.             */ 03578000
*/*          CHAR1 -   MOST RECENTLY EXTRACTED CHARACTER             */ 03579000
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */ 03580000
*/*                    SCANNING IS CURRENTLY TAKING PLACE.           */ 03581000
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARAMETER LIST NESTING   */ 03582000
*/*                    AT WHICH SCANNING IS CURRENTLY TAKING PLACE.  */ 03583000
*/*                                                                  */ 03584000
*/*  OUTPUT -                                                        */ 03585000
*/*          JUSTONE - FLAG SET 'ON' WHEN A SINGLE SCALAR LIST ITEM  */ 03586000
*/*                    HAS BEEN CODED FOR A PARAMETER                */ 03587000
*/*          PARMID -  ID# OF PARAMETER CURRENTLY BEING HANDLED.     */ 03588000
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */ 03589000
*/*                    SCANNING WILL TAKE PLACE AFTER THIS KEYWORD.  */ 03590000
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND IN      */ 03591000
*/*                    CURRENT SUBPARAMETER LIST.                    */ 03592000
*/*          SUPERID - SEE 'INPUT'                                   */ 03593000
*/*          SUBSYET - FLAG SET 'ON' WHEN AT LEAST ONE SUBPARAMETER  */ 03594000
*/*                    HAS BEEN FOUND IN THE CURRENT SUBLIST.        */ 03595000
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARM. LIST NESTING AT    */ 03596000
*/*                    WHICH SCANNING WILL TAKE PLACE FOLLOWING THIS */ 03597000
*/*                    KEYWORD.                                      */ 03598000
*/*          REPCOUNT- NUMBER OF REPEATED SUBLISTS FOUND AT CURRENT  */ 03599000
*/*                    REPEATED SUBLIST LEVEL.                       */ 03600000
*/*          REPLIMIT- MAXIMUM NUMBER OF REPEATED SUBLISTS ALLOWED   */ 03601000
*/*                    AT CURRENT LEVEL.                             */ 03602000
*/*          ARRYPTR - POINTER TO INTERMEDIATE POINTER VECTOR WHICH  */ 03603000
*/*                    CONTAINS PTRS TO DATA STRUCTURES FOR CURRENT  */ 03604000
*/*                    KEYWORD PARAMETER                             */ 03605000
*/*                                                                  */ 03606000
*/********************************************************************/ 03607000
*KWDPARM:PROCEDURE;                                                0921 03608000
KWDPARM  STM   @14,@12,@SA00009                                    0921 03609000
*        /************************************************************/ 03610000
*        /*                                                          */ 03611000
*        /* KWDPARM PROCEDURE DATA DECLARATIONS                      */ 03612000
*        /*                                                          */ 03613000
*        /************************************************************/ 03614000
*        DCL SUBTOTAL FIXED(15);       /*COUNT OF SUBPARAMETERS OF 0922 03615000
*                                        CURRENT PARAMETER           */ 03616000
*        DCL WORKVAR1 FIXED(15);       /*VARIABLE TO CONTAIN         */ 03617000
*                                      /*A TEMPORARY VALUE           */ 03618000
*        DCL KWDMATCH BIT(1);          /*SIGNALS THAT A MATCHING   0924 03619000
*                                        KEYWORD HAS BEEN FOUND      */ 03620000
*                                                                  0924 03621000
*        /*STATIC ERROR MESSAGE CODES                                */ 03622000
*        DCL BADELIM2 FIXED(31)        /*LEFT PARENTHESIS MISSING    */ 03623000
*                     CONSTANT(9);                                 0925 03624000
*        /************************************************************/ 03625000
*        /*                                                          */ 03626000
*        /*  ** KWDPARM **  EXTRACT A KEYWORD PARAMETER              */ 03627000
*        /*                                                          */ 03628000
*        /************************************************************/ 03629000
*        KWDMATCH=NO;                                              0926 03630000
         NI    KWDMATCH,B'01111111'                                0926 03631000
*        JUSTONE=NO;                                               0927 03632000
         NI    JUSTONE,B'11111110'                                 0927 03633000
*        ENDPAREN=YES;                                             0928 03634000
*                                                                  0928 03635000
         OI    ENDPAREN,B'10000000'                                0928 03636000
*        /************************************************************/ 03637000
*        /*                                                          */ 03638000
*        /* EXTRACT THE KEYWORD, CHECKING THAT IT DOESN'T EXCEED     */ 03639000
*        /* KEYWORD LENGTH LIMIT.                                    */ 03640000
*        /*                                                          */ 03641000
*        /************************************************************/ 03642000
*                                                                  0929 03643000
*        CALL NXTFIELD(KEYWORD);                                   0929 03644000
*                                                                  0929 03645000
         LA    @01,@AL00929                                        0929 03646000
         BAL   @14,NXTFIELD                                        0929 03647000
*        IF RISTATUS=0                                             0930 03648000
*          THEN                                                    0930 03649000
*                                                                  0930 03650000
         LH    @15,RISTATUS                                        0930 03651000
         LTR   @15,@15                                             0930 03652000
         BNZ   @RF00930                                            0930 03653000
*            /********************************************************/ 03654000
*            /*                                                      */ 03655000
*            /* SCAN KEYWORD DESCRIPTIONS IN THE COMMAND DESCRIPTOR, */ 03656000
*            /* SEARCHING FOR A MATCH WITH THE EXTRACTED KEYWORD     */ 03657000
*            /*                                                      */ 03658000
*            /********************************************************/ 03659000
*DOGRP40:    DO;                                                   0931 03660000
DOGRP40  DS    0H                                                  0932 03661000
*            IF SUPERID(PARMLVL)=0                                 0932 03662000
*              THEN                                                0932 03663000
*                                                                  0932 03664000
         LH    @15,PARMLVL                                         0932 03665000
         ALR   @15,@15                                             0932 03666000
         LH    @15,SUPERID-2(@15)                                  0932 03667000
         LTR   @15,@15                                             0932 03668000
         BNZ   @RF00932                                            0932 03669000
*                /****************************************************/ 03670000
*                /*                                                  */ 03671000
*                /* WHEN CURRENTLY SCANNING FIRST-LEVEL PARAMETERS,  */ 03672000
*                /* CHECK DESCRIPTION OF EVERY FIRST-LEVEL PARAMETER */ 03673000
*                /* FOR A KEYWORD NAME MATCH.                        */ 03674000
*                /*                                                  */ 03675000
*                /****************************************************/ 03676000
*                DO INDEX=1 TO MAXID WHILE(KWDMATCH=NO);           0933 03677000
         LA    @15,1                                               0933 03678000
         B     @DE00933                                            0933 03679000
@DL00933 TM    KWDMATCH,B'10000000'                                0933 03680000
         BNZ   @DC00933                                            0933 03681000
*                  IF PARMPTR(INDEX)^=0                            0934 03682000
*                    THEN                                          0934 03683000
         L     @14,WORKPTR                                         0934 03684000
         LA    @05,12                                              0934 03685000
         LR    @01,@15                                             0934 03686000
         MR    @00,@05                                             0934 03687000
         AL    @01,@CF01317                                        0934 03688000
         L     @04,PARMPTR(@01,@14)                                0934 03689000
         LTR   @04,@04                                             0934 03690000
         BZ    @RF00934                                            0934 03691000
*                      DO;                                         0935 03692000
*                      PARMID=INDEX;                               0936 03693000
         STH   @15,PARMID                                          0936 03694000
*                      IF LEVEL1=YES & KWDDSPL^=0                  0937 03695000
*                        THEN                                      0937 03696000
         ST    @14,@TF00001                                        0937 03697000
         MR    @14,@05                                             0937 03698000
         L     @01,@TF00001                                        0937 03699000
         AL    @01,@CF01317                                        0937 03700000
         L     @15,PARMPTR(@15,@01)                                0937 03701000
         TM    LEVEL1(@15),B'01000000'                             0937 03702000
         BNO   @RF00937                                            0937 03703000
         CLI   KWDDSPL(@15),0                                      0937 03704000
         BE    @RF00937                                            0937 03705000
*                          DO;                                     0938 03706000
*                            KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT);    03707000
         LA    @14,1                                               0939 03708000
         SLR   @05,@05                                             0939 03709000
         IC    @05,KWDDSPL(,@15)                                   0939 03710000
         ALR   @05,@05                                             0939 03711000
         ALR   @15,@05                                             0939 03712000
         ALR   @15,@14                                             0939 03713000
         ST    @15,KWDPTR                                          0939 03714000
*                            DO LISTINDX=1 TO KWDCOUNT             0940 03715000
*                                      WHILE(KWDMATCH=NO);         0940 03716000
         B     @DE00940                                            0940 03717000
@DL00940 TM    KWDMATCH,B'10000000'                                0940 03718000
         BNZ   @DC00940                                            0940 03719000
*                              IF UNITINDX=KWDLEN &                0941 03720000
*                                 KWDITEM(1:KWDLEN) = SYNUNIT(1:KWDLEN) 03721000
*                                THEN                              0941 03722000
         L     @15,KWDPTR                                          0941 03723000
         SLR   @14,@14                                             0941 03724000
         IC    @14,KWDLEN(,@15)                                    0941 03725000
         CH    @14,UNITINDX                                        0941 03726000
         BNE   @RF00941                                            0941 03727000
         BCTR  @14,0                                               0941 03728000
         EX    @14,@SC01338                                        0941 03729000
         BNE   @RF00941                                            0941 03730000
*                                  KWDMATCH=YES;                   0942 03731000
         OI    KWDMATCH,B'10000000'                                0942 03732000
*                                ELSE                              0943 03733000
*                                  KWDPTR=KWDPTR+KWDLEN+LENGTH(KWDLEN); 03734000
         B     @RC00941                                            0943 03735000
@RF00941 L     @15,KWDPTR                                          0943 03736000
         SLR   @14,@14                                             0943 03737000
         IC    @14,KWDLEN(,@15)                                    0943 03738000
         ALR   @14,@15                                             0943 03739000
         AL    @14,@CF00172                                        0943 03740000
         ST    @14,KWDPTR                                          0943 03741000
*                            END;                                  0944 03742000
@RC00941 LA    @14,1                                               0944 03743000
         AH    @14,LISTINDX                                        0944 03744000
@DE00940 STH   @14,LISTINDX                                        0944 03745000
         LH    @15,PARMID                                          0944 03746000
         MH    @15,@CH00038                                        0944 03747000
         LH    @05,PARMID                                          0944 03748000
         MH    @05,@CH00038                                        0944 03749000
         L     @01,WORKPTR                                         0944 03750000
         AL    @01,@CF01317                                        0944 03751000
         L     @01,PARMPTR(@05,@01)                                0944 03752000
         SLR   @05,@05                                             0944 03753000
         IC    @05,KWDDSPL(,@01)                                   0944 03754000
         ALR   @05,@05                                             0944 03755000
         L     @04,WORKPTR                                         0944 03756000
         AL    @04,@CF01317                                        0944 03757000
         AL    @05,PARMPTR(@15,@04)                                0944 03758000
         MVC   @ZT00003+3(1),KWDCOUNT(@05)                         0944 03759000
         C     @14,@ZT00003                                        0944 03760000
         BNH   @DL00940                                            0944 03761000
@DC00940 DS    0H                                                  0945 03762000
*                          END;                                    0945 03763000
*                      END;                                        0946 03764000
@RF00937 DS    0H                                                  0947 03765000
*                END;                                              0947 03766000
@RF00934 LA    @15,1                                               0947 03767000
         AH    @15,INDEX                                           0947 03768000
@DE00933 STH   @15,INDEX                                           0947 03769000
         L     @14,DESCPTR                                         0947 03770000
         CH    @15,MAXID(,@14)                                     0947 03771000
         BNH   @DL00933                                            0947 03772000
@DC00933 DS    0H                                                  0948 03773000
*              ELSE                                                0948 03774000
*                                                                  0948 03775000
*                /****************************************************/ 03776000
*                /*                                                  */ 03777000
*                /*  WHEN SCANNING A SUBPARAMETER LIST, CHECK FOR A  */ 03778000
*                /*  KEYWORD MATCH AMONG THE POSSIBLE SUBPARAMETERS  */ 03779000
*                /*  OF THE CURRENT SUPERPARAMETER.                  */ 03780000
*                /*                                                  */ 03781000
*                /****************************************************/ 03782000
*                DO;                                               0948 03783000
         B     @RC00932                                            0948 03784000
@RF00932 DS    0H                                                  0949 03785000
*                  OLDERID2 = NEWERID2;                            0949 03786000
         L     @01,GDTPTR                                          0949 03787000
         L     @15,GDTTR2(,@01)                                    0949 03788000
         MVC   @TS00001(95),NEWERID2(@15)                          0949 03789000
         MVC   OLDERID2(95,@15),@TS00001                           0949 03790000
*                  NEWID2='RI09';                                  0950 03791000
         MVC   NEWID2(4,@15),@CC00941                              0950 03792000
*                  SUBTOTAL=SUBCOUNT;                              0951 03793000
         LA    @15,12                                              0951 03794000
         LR    @14,@15                                             0951 03795000
         MH    @14,PARMID                                          0951 03796000
         L     @01,WORKPTR                                         0951 03797000
         AL    @01,@CF01317                                        0951 03798000
         L     @14,PARMPTR(@14,@01)                                0951 03799000
         ALR   @15,@14                                             0951 03800000
         SLR   @05,@05                                             0951 03801000
         IC    @05,SUBDSPL(,@15)                                   0951 03802000
         ALR   @05,@05                                             0951 03803000
         ALR   @14,@05                                             0951 03804000
         MVC   SUBTOTAL(2),SUBCOUNT(@14)                           0951 03805000
*                  DO INDEX=1 TO SUBTOTAL WHILE(KWDMATCH=NO);      0952 03806000
         LA    @15,1                                               0952 03807000
         B     @DE00952                                            0952 03808000
@DL00952 TM    KWDMATCH,B'10000000'                                0952 03809000
         BNZ   @DC00952                                            0952 03810000
*                    PARMID=SUBID(INDEX);                          0953 03811000
         SLA   @15,2                                               0953 03812000
         L     @14,WORKPTR                                         0953 03813000
         LA    @05,12                                              0953 03814000
         LR    @04,@05                                             0953 03815000
         MH    @04,PARMID                                          0953 03816000
         AL    @04,@CF01317                                        0953 03817000
         L     @04,PARMPTR(@04,@14)                                0953 03818000
         LR    @03,@04                                             0953 03819000
         ALR   @03,@05                                             0953 03820000
         SLR   @02,@02                                             0953 03821000
         IC    @02,SUBDSPL(,@03)                                   0953 03822000
         ALR   @02,@02                                             0953 03823000
         ALR   @04,@02                                             0953 03824000
         LH    @15,SUBID-4(@15,@04)                                0953 03825000
         STH   @15,PARMID                                          0953 03826000
*                    IF KWDDSPL ^= 0                               0954 03827000
*                      THEN                                        0954 03828000
         ST    @14,@TF00001                                        0954 03829000
         MR    @14,@05                                             0954 03830000
         L     @01,@TF00001                                        0954 03831000
         AL    @01,@CF01317                                        0954 03832000
         L     @15,PARMPTR(@15,@01)                                0954 03833000
         CLI   KWDDSPL(@15),0                                      0954 03834000
         BE    @RF00954                                            0954 03835000
*                        DO;                                       0955 03836000
*                          KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT); 0956 03837000
         LA    @14,1                                               0956 03838000
         SLR   @05,@05                                             0956 03839000
         IC    @05,KWDDSPL(,@15)                                   0956 03840000
         ALR   @05,@05                                             0956 03841000
         ALR   @15,@05                                             0956 03842000
         LR    @05,@15                                             0956 03843000
         ALR   @05,@14                                             0956 03844000
         ST    @05,KWDPTR                                          0956 03845000
*                          WORKVAR1=KWDCOUNT;                      0957 03846000
         SLR   @05,@05                                             0957 03847000
         IC    @05,KWDCOUNT(,@15)                                  0957 03848000
         STH   @05,WORKVAR1                                        0957 03849000
*                          DO LISTINDX=1 TO WORKVAR1               0958 03850000
*                                      WHILE(KWDMATCH=NO);         0958 03851000
         B     @DE00958                                            0958 03852000
@DL00958 TM    KWDMATCH,B'10000000'                                0958 03853000
         BNZ   @DC00958                                            0958 03854000
*                            IF UNITINDX=KWDLEN &                  0959 03855000
*                               KWDITEM(1:KWDLEN)=SYNUNIT(1:KWDLEN)     03856000
*                              THEN                                0959 03857000
         L     @15,KWDPTR                                          0959 03858000
         SLR   @14,@14                                             0959 03859000
         IC    @14,KWDLEN(,@15)                                    0959 03860000
         CH    @14,UNITINDX                                        0959 03861000
         BNE   @RF00959                                            0959 03862000
         BCTR  @14,0                                               0959 03863000
         EX    @14,@SC01338                                        0959 03864000
         BNE   @RF00959                                            0959 03865000
*                                KWDMATCH=YES;                     0960 03866000
         OI    KWDMATCH,B'10000000'                                0960 03867000
*                              ELSE                                0961 03868000
*                                KWDPTR=KWDPTR+KWDLEN+LENGTH(KWDLEN);   03869000
         B     @RC00959                                            0961 03870000
@RF00959 L     @15,KWDPTR                                          0961 03871000
         SLR   @14,@14                                             0961 03872000
         IC    @14,KWDLEN(,@15)                                    0961 03873000
         ALR   @14,@15                                             0961 03874000
         AL    @14,@CF00172                                        0961 03875000
         ST    @14,KWDPTR                                          0961 03876000
*                          END;                                    0962 03877000
@RC00959 LA    @14,1                                               0962 03878000
         AH    @14,LISTINDX                                        0962 03879000
@DE00958 STH   @14,LISTINDX                                        0962 03880000
         CH    @14,WORKVAR1                                        0962 03881000
         BNH   @DL00958                                            0962 03882000
@DC00958 DS    0H                                                  0963 03883000
*                        END;                                      0963 03884000
*                    IF KWDMATCH=NO                                0964 03885000
*                      THEN                                        0964 03886000
@RF00954 TM    KWDMATCH,B'10000000'                                0964 03887000
         BNZ   @RF00964                                            0964 03888000
*                        PARMID=SUPERID(PARMLVL);                  0965 03889000
         LH    @15,PARMLVL                                         0965 03890000
         ALR   @15,@15                                             0965 03891000
         LH    @15,SUPERID-2(@15)                                  0965 03892000
         STH   @15,PARMID                                          0965 03893000
*                  END;                                            0966 03894000
@RF00964 LA    @15,1                                               0966 03895000
         AH    @15,INDEX                                           0966 03896000
@DE00952 STH   @15,INDEX                                           0966 03897000
         CH    @15,SUBTOTAL                                        0966 03898000
         BNH   @DL00952                                            0966 03899000
@DC00952 DS    0H                                                  0967 03900000
*                END;                                              0967 03901000
*                                                                  0967 03902000
*            /********************************************************/ 03903000
*            /*                                                      */ 03904000
*            /* IF A MATCHING KEYWORD WAS FOUND, SET A FLAG NOTING   */ 03905000
*            /* THIS KEYWORD PARAMETER ID#, AND THEN USE THE KEYWORD */ 03906000
*            /* DESCRIPTOR DATA TO CONTROL SCANNING OF THE REMAINDER */ 03907000
*            /* OF THE PARAMETER                                     */ 03908000
*            /*                                                      */ 03909000
*            /********************************************************/ 03910000
*            IF KWDMATCH=YES                                       0968 03911000
*              THEN                                                0968 03912000
@RC00932 TM    KWDMATCH,B'10000000'                                0968 03913000
         BNO   @RF00968                                            0968 03914000
*DOGRP45:        DO;                                               0969 03915000
*                                                                  0969 03916000
DOGRP45  DS    0H                                                  0970 03917000
*                CALL SETFLAG;                                     0970 03918000
*                                                                  0970 03919000
         BAL   @14,SETFLAG                                         0970 03920000
*                IF RISTATUS ^= 0                                  0971 03921000
*                  THEN                                            0971 03922000
         LH    @15,RISTATUS                                        0971 03923000
         LTR   @15,@15                                             0971 03924000
         BNZ   @RT00971                                            0971 03925000
*                    RETURN;                                       0972 03926000
*                                                                  0972 03927000
*                /****************************************************/ 03928000
*                /*                                                  */ 03929000
*                /* SCAN PAST THE OPENING PARENTHESIS FOLLOWING THE  */ 03930000
*                /* KEYWORD, UNLESS IT IS A 'VALUE' KEYWORD          */ 03931000
*                /*                                                  */ 03932000
*                /****************************************************/ 03933000
*                IF SUBLIST=YES | SCLRDATA=YES                     0973 03934000
*                  THEN                                            0973 03935000
         LH    @15,PARMID                                          0973 03936000
         MH    @15,@CH00038                                        0973 03937000
         L     @01,WORKPTR                                         0973 03938000
         AL    @01,@CF01317                                        0973 03939000
         L     @01,PARMPTR(@15,@01)                                0973 03940000
         TM    SUBLIST(@01),B'10000010'                            0973 03941000
         BZ    @RF00973                                            0973 03942000
*DOGRP47:            DO;                                           0974 03943000
*                                                                  0974 03944000
DOGRP47  DS    0H                                                  0975 03945000
*                    CALL SCANSEP(NO);                             0975 03946000
*                                                                  0975 03947000
         LA    @01,@AL00975                                        0975 03948000
         BAL   @14,SCANSEP                                         0975 03949000
*                    IF CHAR1 ^= OPENING                           0976 03950000
*                      THEN                                        0976 03951000
*                                                                  0976 03952000
         CLI   CHAR1,C'('                                          0976 03953000
         BE    @RF00976                                            0976 03954000
*                        CALL ERROR2(BADELIM2,LENGTH(ERRFIELD),    0977 03955000
*                                    ADDR(ERRFIELD));              0977 03956000
*                                                                  0977 03957000
         MVC   @AL00001(8),@AL00977                                0977 03958000
         LA    @15,ERRFIELD                                        0977 03959000
         ST    @15,@AFTEMPS+4                                      0977 03960000
         LA    @15,@AFTEMPS+4                                      0977 03961000
         ST    @15,@AL00001+8                                      0977 03962000
         LA    @01,@AL00001                                        0977 03963000
         BAL   @14,ERROR2                                          0977 03964000
*                      ELSE                                        0978 03965000
*DOGRP50:                DO;                                       0978 03966000
*                                                                  0978 03967000
         B     @RC00976                                            0978 03968000
@RF00976 DS    0H                                                  0978 03969000
DOGRP50  DS    0H                                                  0979 03970000
*                        CALL NEXTCHAR;                            0979 03971000
         BAL   @14,NEXTCHAR                                        0979 03972000
*                        CALL SCANSEP(NO);                         0980 03973000
*                                                                  0980 03974000
         LA    @01,@AL00980                                        0980 03975000
         BAL   @14,SCANSEP                                         0980 03976000
*                        IF RISTATUS=0                             0981 03977000
*                          THEN                                    0981 03978000
*                                                                  0981 03979000
         LH    @15,RISTATUS                                        0981 03980000
         LTR   @15,@15                                             0981 03981000
         BNZ   @RF00981                                            0981 03982000
*                            /****************************************/ 03983000
*                            /*                                      */ 03984000
*                            /* IF SCALAR DATA IS TO BE EXTRACTED    */ 03985000
*                            /* FOLLOWING THE KEYWORD, THEN EXTRACT  */ 03986000
*                            /* DATA.  IF SUBPARAMETERS FOLLOW THE   */ 03987000
*                            /* KEYWORD, SET UP TO SCAN THEM         */ 03988000
*                            /*                                      */ 03989000
*                            /****************************************/ 03990000
*                            IF SCLRDATA=YES                       0982 03991000
*                              THEN                                0982 03992000
         LH    @15,PARMID                                          0982 03993000
         MH    @15,@CH00038                                        0982 03994000
         L     @01,WORKPTR                                         0982 03995000
         AL    @01,@CF01317                                        0982 03996000
         L     @01,PARMPTR(@15,@01)                                0982 03997000
         TM    SCLRDATA(@01),B'10000000'                           0982 03998000
         BNO   @RF00982                                            0982 03999000
*                                DO;                               0983 04000000
*                                                                  0983 04001000
*                                CALL GETDATA;                     0984 04002000
*                                                                  0984 04003000
         BAL   @14,GETDATA                                         0984 04004000
*                                IF RISTATUS=0                     0985 04005000
*                                  THEN                            0985 04006000
*                                                                  0985 04007000
         LH    @15,RISTATUS                                        0985 04008000
         LTR   @15,@15                                             0985 04009000
         BNZ   @RF00985                                            0985 04010000
*                                    /********************************/ 04011000
*                                    /*                              */ 04012000
*                                    /* IF IT EXISTS, BYPASS THE     */ 04013000
*                                    /* CLOSING PAREN FOLLOWING THE  */ 04014000
*                                    /* DATA.  THE PAREN IS REQUIRED */ 04015000
*                                    /* EXCEPT AT COMMAND END.       */ 04016000
*                                    /*                              */ 04017000
*                                    /********************************/ 04018000
*                                    IF CHAR1 ^= CLOSING           0986 04019000
*                                      THEN                        0986 04020000
         CLI   CHAR1,C')'                                          0986 04021000
         BE    @RF00986                                            0986 04022000
*                                        IF CHAR1=ENDDELIM         0987 04023000
*                                          THEN                    0987 04024000
         CLI   CHAR1,C';'                                          0987 04025000
         BNE   @RF00987                                            0987 04026000
*                                            ENDPAREN=NO;          0988 04027000
         NI    ENDPAREN,B'01111111'                                0988 04028000
*                                          ELSE                    0989 04029000
*                                                                  0989 04030000
*                                            CALL ERROR2(BADELIM3, 0989 04031000
*                                                    LENGTH(ERRFIELD),  04032000
*                                                    ADDR(ERRFIELD));   04033000
*                                                                  0989 04034000
         B     @RC00987                                            0989 04035000
@RF00987 MVC   @AL00001(8),@AL00989                                0989 04036000
         LA    @15,ERRFIELD                                        0989 04037000
         ST    @15,@AFTEMPS+4                                      0989 04038000
         LA    @15,@AFTEMPS+4                                      0989 04039000
         ST    @15,@AL00001+8                                      0989 04040000
         LA    @01,@AL00001                                        0989 04041000
         BAL   @14,ERROR2                                          0989 04042000
*                                      ELSE                        0990 04043000
*                                        DO;                       0990 04044000
*                                                                  0990 04045000
         B     @RC00986                                            0990 04046000
@RF00986 DS    0H                                                  0991 04047000
*                                        CALL NEXTCHAR;            0991 04048000
         BAL   @14,NEXTCHAR                                        0991 04049000
*                                        CALL SCANSEP(YES);        0992 04050000
*                                                                  0992 04051000
         LA    @01,@AL00992                                        0992 04052000
         BAL   @14,SCANSEP                                         0992 04053000
*                                        END;                      0993 04054000
*                                END;                              0994 04055000
*                                                                  0994 04056000
*                              /**************************************/ 04057000
*                              /*                                    */ 04058000
*                              /* THE 'VALUE' OF THIS PARAMETER IS A */ 04059000
*                              /* SUBPARAMETER LIST RATHER THAN A    */ 04060000
*                              /* SCALAR OR LIST OF SCALARS.         */ 04061000
*                              /*                                    */ 04062000
*                              /**************************************/ 04063000
*                              ELSE                                0995 04064000
*DOGRP55:                        DO;                               0995 04065000
         B     @RC00982                                            0995 04066000
@RF00982 DS    0H                                                  0995 04067000
DOGRP55  DS    0H                                                  0996 04068000
*                                PARMLVL=PARMLVL+1;                0996 04069000
         LA    @15,1                                               0996 04070000
         LH    @14,PARMLVL                                         0996 04071000
         ALR   @14,@15                                             0996 04072000
         STH   @14,PARMLVL                                         0996 04073000
*                                PPARMCNT(PARMLVL)=1;              0997 04074000
         ALR   @14,@14                                             0997 04075000
         STH   @15,PPARMCNT-2(@14)                                 0997 04076000
*                                SUPERID(PARMLVL)=PARMID;          0998 04077000
         LH    @05,PARMID                                          0998 04078000
         STH   @05,SUPERID-2(@14)                                  0998 04079000
*                                SUBSYET=NO;                       0999 04080000
*                                                                  0999 04081000
         NI    SUBSYET,B'11101111'                                 0999 04082000
*                                /**********************************/   04083000
*                                /*                                */   04084000
*                                /* IF THE SUBPARAMETER LIST MAY BE*/   04085000
*                                /* REPEATED, BYPASS DELIMITER(S)  */   04086000
*                                /* AND SET INDEXES AND COUNTS TO  */   04087000
*                                /* NOTE START OF REPEATED LISTS.  */   04088000
*                                /*                                */   04089000
*                                /**********************************/   04090000
*                                IF REPEATED=YES                   1000 04091000
*                                  THEN                            1000 04092000
         MH    @05,@CH00038                                        1000 04093000
         L     @01,WORKPTR                                         1000 04094000
         AL    @01,@CF01317                                        1000 04095000
         L     @01,PARMPTR(@05,@01)                                1000 04096000
         TM    REPEATED(@01),B'00100000'                           1000 04097000
         BNO   @RF01000                                            1000 04098000
*                                    DO;                           1001 04099000
*                                    REPDEPTH=REPDEPTH+1;          1002 04100000
         AH    @15,REPDEPTH                                        1002 04101000
         STH   @15,REPDEPTH                                        1002 04102000
*                                    IF CHAR1=OPENING              1003 04103000
*                                      THEN                        1003 04104000
         CLI   CHAR1,C'('                                          1003 04105000
         BNE   @RF01003                                            1003 04106000
*                                        DO;                       1004 04107000
*                                                                  1004 04108000
*                                        CALL NEXTCHAR;            1005 04109000
         BAL   @14,NEXTCHAR                                        1005 04110000
*                                        CALL SCANSEP(NO);         1006 04111000
*                                                                  1006 04112000
         LA    @01,@AL01006                                        1006 04113000
         BAL   @14,SCANSEP                                         1006 04114000
*                                        ONEREP(REPDEPTH)=NO;      1007 04115000
         LH    @01,REPDEPTH                                        1007 04116000
         LA    @15,ONEREP-1(@01)                                   1007 04117000
         NI    0(@15),B'01111111'                                  1007 04118000
*                                        END;                      1008 04119000
*                                      ELSE                        1009 04120000
*                                        ONEREP(REPDEPTH)=YES;     1009 04121000
         B     @RC01003                                            1009 04122000
@RF01003 LH    @01,REPDEPTH                                        1009 04123000
         LA    @15,ONEREP-1(@01)                                   1009 04124000
         OI    0(@15),B'10000000'                                  1009 04125000
*                                    REPCOUNT(REPDEPTH)=1;         1010 04126000
@RC01003 LH    @15,REPDEPTH                                        1010 04127000
         LR    @14,@15                                             1010 04128000
         ALR   @14,@14                                             1010 04129000
         LA    @05,1                                               1010 04130000
         STH   @05,REPCOUNT-2(@14)                                 1010 04131000
*                                    REPLIMIT(REPDEPTH)=REPMAX;    1011 04132000
         LA    @05,12                                              1011 04133000
         LR    @04,@05                                             1011 04134000
         MH    @04,PARMID                                          1011 04135000
         L     @01,WORKPTR                                         1011 04136000
         AL    @01,@CF01317                                        1011 04137000
         AL    @05,PARMPTR(@04,@01)                                1011 04138000
         SLR   @04,@04                                             1011 04139000
         IC    @04,REPMAX(,@05)                                    1011 04140000
         STH   @04,REPLIMIT-2(@14)                                 1011 04141000
*                                    ARRYPTR=                      1012 04142000
*                                        FDTPTR(SUPERID(PARMLVL)); 1012 04143000
         LH    @14,PARMLVL                                         1012 04144000
         ALR   @14,@14                                             1012 04145000
         LH    @14,SUPERID-2(@14)                                  1012 04146000
         SLA   @14,2                                               1012 04147000
         L     @01,FDTADDR                                         1012 04148000
         L     @14,FDTPTR-4(@14,@01)                               1012 04149000
         ST    @14,ARRYPTR                                         1012 04150000
*                                    HWORDARG=REPDEPTH-1;          1013 04151000
*                                                                  1013 04152000
         BCTR  @15,0                                               1013 04153000
         STH   @15,HWORDARG                                        1013 04154000
*                                    CALL DSPLCALC(HWORDARG);      1014 04155000
*                                                                  1014 04156000
         LA    @15,HWORDARG                                        1014 04157000
         ST    @15,@AL00001                                        1014 04158000
         LA    @01,@AL00001                                        1014 04159000
         BAL   @14,DSPLCALC                                        1014 04160000
*                                    REPTOTAL=1;                   1015 04161000
         LH    @15,ARRYDSPL                                        1015 04162000
         AL    @15,ARRYPTR                                         1015 04163000
         MVC   REPTOTAL(4,@15),@CF00172                            1015 04164000
*                                    END;                          1016 04165000
*                                                                  1016 04166000
*                                END DOGRP55;                      1017 04167000
*                        END DOGRP50;                              1018 04168000
*                    END DOGRP47;                                  1019 04169000
*                                                                  1019 04170000
*                  /**************************************************/ 04171000
*                  /*                                                */ 04172000
*                  /* WHEN A VALUE KEYWORD IS EXTRACTED, SCAN TO     */ 04173000
*                  /* THE NEXT SYNTACTIC UNIT                        */ 04174000
*                  /*                                                */ 04175000
*                  /**************************************************/ 04176000
*                  ELSE                                            1020 04177000
*                                                                  1020 04178000
*                    CALL SCANSEP(YES);                            1020 04179000
*                                                                  1020 04180000
         B     @RC00973                                            1020 04181000
@RF00973 LA    @01,@AL01020                                        1020 04182000
         BAL   @14,SCANSEP                                         1020 04183000
*                END DOGRP45;                                      1021 04184000
*                                                                  1021 04185000
*              /******************************************************/ 04186000
*              /*                                                    */ 04187000
*              /* IF NO MATCHING KEYWORD WAS FOUND, IT IS AN ERROR   */ 04188000
*              /*                                                    */ 04189000
*              /******************************************************/ 04190000
*              ELSE                                                1022 04191000
*                                                                  1022 04192000
*                CALL ERROR2(BADKWD2,LENGTH(ERRFIELD),ADDR(ERRFIELD));  04193000
*                                                                  1022 04194000
         B     @RC00968                                            1022 04195000
@RF00968 MVC   @AL00001(8),@AL01022                                1022 04196000
         LA    @15,ERRFIELD                                        1022 04197000
         ST    @15,@AFTEMPS+4                                      1022 04198000
         LA    @15,@AFTEMPS+4                                      1022 04199000
         ST    @15,@AL00001+8                                      1022 04200000
         LA    @01,@AL00001                                        1022 04201000
         BAL   @14,ERROR2                                          1022 04202000
*            END DOGRP40;                                          1023 04203000
*                                                                  1023 04204000
*        END KWDPARM;                                              1024 04205000
@EL00009 DS    0H                                                  1024 04206000
@EF00009 DS    0H                                                  1024 04207000
@ER00009 LM    @14,@12,@SA00009                                    1024 04208000
         BR    @14                                                 1024 04209000
*/********************************************************************/ 04210000
*/*                                                                  */ 04211000
*/*  PROCEDURE NAME - POSPARM                                        */ 04212000
*/*                                                                  */ 04213000
*/*  FUNCTION - THIS ROUTINE SETS UP TO EXTRACT SCALAR DATA          */ 04214000
*/*             ASSOCIATED WITH THE POSITIONAL PARAMETER OR PREPARES */ 04215000
*/*             TO SCAN A POSITIONAL PARAMETER'S SUBPARAMETER LIST.  */ 04216000
*/*                                                                  */ 04217000
*/*  INPUT -                                                         */ 04218000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 04219000
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND SO FAR  */ 04220000
*/*                    IN CURRENT SUBPARAMETER LIST.                 */ 04221000
*/*          CHAR1 -   MOST RECENTLY EXTRACTED INPUT CHARACTER       */ 04222000
*/*          RISTATUS- R/I STATUS CODE; SET TO NON-ZERO VALUE WHEN   */ 04223000
*/*                    AN ERROR IS FOUND.                            */ 04224000
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */ 04225000
*/*                    SCANNING IS CURRENTLY TAKING PLACE.           */ 04226000
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARM. LIST NESTING AT    */ 04227000
*/*                    WHICH SCANNING IS CURRENTLY TAKING PLACE.     */ 04228000
*/*                                                                  */ 04229000
*/*  OUTPUT -                                                        */ 04230000
*/*          JUSTONE - FLAG SET 'ON' WHEN A SINGLE SCALAR LIST ITEM  */ 04231000
*/*                    HAS BEEN CODED FOR A PARAMETER                */ 04232000
*/*          PARMID -  ID# OF PARAMETER CURRENTLY BEING HANDLED.     */ 04233000
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */ 04234000
*/*                    SCANNING WILL TAKE PLACE AFTER THIS PARAMETER */ 04235000
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND IN      */ 04236000
*/*                    CURRENT SUBPARAMETER LIST.                    */ 04237000
*/*          SUPERID - ID# OF PARAMETER WHOSE SUBPARAMETER LIST IS   */ 04238000
*/*                    CURRENTLY BEING SCANNED                       */ 04239000
*/*          SUBSYET - FLAG SET 'ON' WHEN AT LEAST ONE SUBPARAMETER  */ 04240000
*/*                    HAS BEEN FOUND IN THE CURRENT SUBLIST.        */ 04241000
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARM. LIST NESTING AT    */ 04242000
*/*                    WHICH SCANNING WILL TAKE PLACE FOLLOWING THIS */ 04243000
*/*                    POSITIONAL PARAMETER                          */ 04244000
*/*          REPCOUNT- NUMBER OF REPEATED SUBLISTS FOUND AT CURRENT  */ 04245000
*/*                    REPEATED SUBLIST LEVEL.                       */ 04246000
*/*          REPLIMIT- MAXIMUM NUMBER OF REPEATED SUBLISTS ALLOWED   */ 04247000
*/*                    AT CURRENT LEVEL.                             */ 04248000
*/*          ARRYPTR - POINTER TO INTERMEDIATE POINTER VECTOR WHICH  */ 04249000
*/*                    CONTAINS PTRS TO DATA STRUCTURES FOR CURRENT  */ 04250000
*/*                    POSITIONAL PARAMETER                          */ 04251000
*/*                                                                  */ 04252000
*/********************************************************************/ 04253000
*POSPARM:PROCEDURE;                                                1025 04254000
POSPARM  STM   @14,@12,@SA00010                                    1025 04255000
*        /************************************************************/ 04256000
*        /*                                                          */ 04257000
*        /*  ** POSPARM **  GET POSITIONAL PARAMETER VALUE           */ 04258000
*        /*                                                          */ 04259000
*        /************************************************************/ 04260000
*        IF GDTDBG = NULLPTR                                       1026 04261000
*          THEN;                                                   1026 04262000
         L     @01,GDTPTR                                          1026 04263000
         L     @15,GDTDBG(,@01)                                    1026 04264000
         LTR   @15,@15                                             1026 04265000
         BZ    @RT01026                                            1026 04266000
*          ELSE                                                    1028 04267000
*            CALL ICKDB010(GDTTBL,'RIPP');                         1028 04268000
*                                                                  1028 04269000
         L     @15,GDTPTR                                          1028 04270000
         ST    @15,@AL00001                                        1028 04271000
         LA    @14,@CC00956                                        1028 04272000
         ST    @14,@AL00001+4                                      1028 04273000
         MVI   @AL00001+4,X'80'                                    1028 04274000
         L     @15,GDTDBG(,@15)                                    1028 04275000
         LA    @01,@AL00001                                        1028 04276000
         BALR  @14,@15                                             1028 04277000
*        JUSTONE=NO;                                               1029 04278000
*                                                                  1029 04279000
@RT01026 NI    JUSTONE,B'11111110'                                 1029 04280000
*        /************************************************************/ 04281000
*        /*                                                          */ 04282000
*        /* SET A FLAG NOTING THAT THIS PARAMETER HAS BEEN FOUND     */ 04283000
*        /* AND INCREMENT COUNT OF POSITIONAL PARAMETERS.            */ 04284000
*        /*                                                          */ 04285000
*        /************************************************************/ 04286000
*                                                                  1030 04287000
*        CALL SETFLAG;                                             1030 04288000
*                                                                  1030 04289000
         BAL   @14,SETFLAG                                         1030 04290000
*        PPARMCNT(PARMLVL)=PPARMCNT(PARMLVL)+1;                    1031 04291000
*                                                                  1031 04292000
         LH    @15,PARMLVL                                         1031 04293000
         ALR   @15,@15                                             1031 04294000
         LA    @14,1                                               1031 04295000
         AH    @14,PPARMCNT-2(@15)                                 1031 04296000
         STH   @14,PPARMCNT-2(@15)                                 1031 04297000
*        /************************************************************/ 04298000
*        /*                                                          */ 04299000
*        /* IF THE VALUE OF THE POSITIONAL PARAMETER IS A LIST, THEN */ 04300000
*        /* EITHER EXTRACT A LIST OF SCALARS OR SET UP TO SCAN A     */ 04301000
*        /* LIST OF SUBPARAMETERS.                                   */ 04302000
*        /*                                                          */ 04303000
*        /************************************************************/ 04304000
*        IF CHAR1 = OPENING                                        1032 04305000
*          THEN                                                    1032 04306000
         CLI   CHAR1,C'('                                          1032 04307000
         BNE   @RF01032                                            1032 04308000
*DOGRP60:    DO;                                                   1033 04309000
*                                                                  1033 04310000
DOGRP60  DS    0H                                                  1034 04311000
*              CALL NEXTCHAR;                                      1034 04312000
         BAL   @14,NEXTCHAR                                        1034 04313000
*              CALL SCANSEP(NO);                                   1035 04314000
*                                                                  1035 04315000
         LA    @01,@AL01035                                        1035 04316000
         BAL   @14,SCANSEP                                         1035 04317000
*              IF RISTATUS^=0                                      1036 04318000
*                THEN                                              1036 04319000
         LH    @15,RISTATUS                                        1036 04320000
         LTR   @15,@15                                             1036 04321000
         BNZ   @RT01036                                            1036 04322000
*                  RETURN;                                         1037 04323000
*                                                                  1037 04324000
*              /******************************************************/ 04325000
*              /*                                                    */ 04326000
*              /* EXTRACT THE LIST OF SCALAR DATA ITEMS AND          */ 04327000
*              /* CHECK FOR PROPER PARENTHESES IF THE POSITIONAL     */ 04328000
*              /* PARAMETER IS A SCALAR LIST.                        */ 04329000
*              /*                                                    */ 04330000
*              /******************************************************/ 04331000
*              IF LIST=YES                                         1038 04332000
*                THEN                                              1038 04333000
         LH    @15,PARMID                                          1038 04334000
         MH    @15,@CH00038                                        1038 04335000
         L     @01,WORKPTR                                         1038 04336000
         AL    @01,@CF01317                                        1038 04337000
         L     @01,PARMPTR(@15,@01)                                1038 04338000
         TM    LIST(@01),B'00001000'                               1038 04339000
         BNO   @RF01038                                            1038 04340000
*                  DO;                                             1039 04341000
*                                                                  1039 04342000
*                  CALL GETDATA;                                   1040 04343000
*                                                                  1040 04344000
         BAL   @14,GETDATA                                         1040 04345000
*                  IF RISTATUS=0                                   1041 04346000
*                    THEN                                          1041 04347000
*                                                                  1041 04348000
         LH    @15,RISTATUS                                        1041 04349000
         LTR   @15,@15                                             1041 04350000
         BNZ   @RF01041                                            1041 04351000
*                      /**********************************************/ 04352000
*                      /*                                            */ 04353000
*                      /* IF IT EXISTS, BYPASS THE CLOSING PAREN     */ 04354000
*                      /* FOLLOWING THE DATA.  EXCEPT AT COMMAND     */ 04355000
*                      /* END, THE CLOSING PAREN IN REQUIRED.        */ 04356000
*                      /*                                            */ 04357000
*                      /**********************************************/ 04358000
*                      IF CHAR1^=CLOSING                           1042 04359000
*                        THEN                                      1042 04360000
         CLI   CHAR1,C')'                                          1042 04361000
         BE    @RF01042                                            1042 04362000
*                          IF CHAR1=ENDDELIM                       1043 04363000
*                            THEN                                  1043 04364000
         CLI   CHAR1,C';'                                          1043 04365000
         BNE   @RF01043                                            1043 04366000
*                              ENDPAREN=NO;                        1044 04367000
         NI    ENDPAREN,B'01111111'                                1044 04368000
*                            ELSE                                  1045 04369000
*                                                                  1045 04370000
*                              CALL ERROR2(BADELIM3,LENGTH(ERRFIELD),   04371000
*                                          ADDR(ERRFIELD));        1045 04372000
*                                                                  1045 04373000
         B     @RC01043                                            1045 04374000
@RF01043 MVC   @AL00001(8),@AL01045                                1045 04375000
         LA    @15,ERRFIELD                                        1045 04376000
         ST    @15,@AFTEMPS+8                                      1045 04377000
         LA    @15,@AFTEMPS+8                                      1045 04378000
         ST    @15,@AL00001+8                                      1045 04379000
         LA    @01,@AL00001                                        1045 04380000
         BAL   @14,ERROR2                                          1045 04381000
*                        ELSE                                      1046 04382000
*                          DO;                                     1046 04383000
*                                                                  1046 04384000
         B     @RC01042                                            1046 04385000
@RF01042 DS    0H                                                  1047 04386000
*                          CALL NEXTCHAR;                          1047 04387000
         BAL   @14,NEXTCHAR                                        1047 04388000
*                          CALL SCANSEP(YES);                      1048 04389000
*                                                                  1048 04390000
         LA    @01,@AL01048                                        1048 04391000
         BAL   @14,SCANSEP                                         1048 04392000
*                          END;                                    1049 04393000
*                  END;                                            1050 04394000
*                ELSE                                              1051 04395000
*                                                                  1051 04396000
*                  CALL ERROR2(BADELIM5,LENGTH(ERRFIELD),          1051 04397000
*                              ADDR(ERRFIELD));                    1051 04398000
*                                                                  1051 04399000
         B     @RC01038                                            1051 04400000
@RF01038 MVC   @AL00001(8),@AL01051                                1051 04401000
         LA    @15,ERRFIELD                                        1051 04402000
         ST    @15,@AFTEMPS+8                                      1051 04403000
         LA    @15,@AFTEMPS+8                                      1051 04404000
         ST    @15,@AL00001+8                                      1051 04405000
         LA    @01,@AL00001                                        1051 04406000
         BAL   @14,ERROR2                                          1051 04407000
*            END DOGRP60;                                          1052 04408000
*          ELSE                                                    1053 04409000
*                                                                  1053 04410000
*            /********************************************************/ 04411000
*            /*                                                      */ 04412000
*            /* IF THERE IS NO LEFT PARENTHESIS TO DELIMIT A SCALAR  */ 04413000
*            /* LIST, THEN THE LIST MUST BE JUST ONE SCALAR LONG.    */ 04414000
*            /* AN EXCEPTION IS WHEN A LIST OF LISTS IS INVOLVED, IN */ 04415000
*            /* WHICH CASE THE PARENTHESES FOR THE REPEATED LISTS    */ 04416000
*            /* MAY SERVE TO DELIMIT THE SCALAR LISTS.               */ 04417000
*            /*                                                      */ 04418000
*            /********************************************************/ 04419000
*            DO;                                                   1053 04420000
         B     @RC01032                                            1053 04421000
@RF01032 DS    0H                                                  1054 04422000
*            IF LIST=YES                                           1054 04423000
*              THEN                                                1054 04424000
         L     @15,WORKPTR                                         1054 04425000
         LH    @14,PARMID                                          1054 04426000
         LA    @05,12                                              1054 04427000
         LR    @01,@14                                             1054 04428000
         MR    @00,@05                                             1054 04429000
         LA    @04,0(@01,@15)                                      1054 04430000
         AL    @04,@CF01317                                        1054 04431000
         L     @04,PARMPTR(,@04)                                   1054 04432000
         TM    LIST(@04),B'00001000'                               1054 04433000
         BNO   @RF01054                                            1054 04434000
*                DO;                                               1055 04435000
*                TESTID=PARMID;                                    1056 04436000
         STH   @14,TESTID                                          1056 04437000
*                PARMID=SUPRPARM(PARMID);                          1057 04438000
         AL    @01,@CF01318                                        1057 04439000
         LH    @14,SUPRPARM-8(@01,@15)                             1057 04440000
         STH   @14,PARMID                                          1057 04441000
*                IF PARMID^=0 & REPEATED=YES & SUBCOUNT=1          1058 04442000
*                  THEN;                                           1058 04443000
         LTR   @14,@14                                             1058 04444000
         BZ    @RF01058                                            1058 04445000
         LR    @01,@14                                             1058 04446000
         MR    @00,@05                                             1058 04447000
         AL    @15,@CF01317                                        1058 04448000
         L     @04,PARMPTR(@01,@15)                                1058 04449000
         TM    REPEATED(@04),B'00100000'                           1058 04450000
         BNO   @RF01058                                            1058 04451000
         ALR   @05,@04                                             1058 04452000
         SLR   @15,@15                                             1058 04453000
         IC    @15,SUBDSPL(,@05)                                   1058 04454000
         ALR   @15,@15                                             1058 04455000
         ALR   @04,@15                                             1058 04456000
         CLC   SUBCOUNT(2,@04),@CH00172                            1058 04457000
         BE    @RT01058                                            1058 04458000
*                  ELSE                                            1060 04459000
*                    JUSTONE=YES;                                  1060 04460000
@RF01058 OI    JUSTONE,B'00000001'                                 1060 04461000
*                PARMID=TESTID;                                    1061 04462000
@RT01058 MVC   PARMID(2),TESTID                                    1061 04463000
*                END;                                              1062 04464000
*                                                                  1062 04465000
*            CALL GETDATA;                                         1063 04466000
*                                                                  1063 04467000
@RF01054 BAL   @14,GETDATA                                         1063 04468000
*            END;                                                  1064 04469000
*                                                                  1064 04470000
*        END POSPARM;                                              1065 04471000
*                                                                  1065 04472000
*                                                                  1065 04473000
@EL00010 DS    0H                                                  1065 04474000
@EF00010 DS    0H                                                  1065 04475000
@ER00010 LM    @14,@12,@SA00010                                    1065 04476000
         BR    @14                                                 1065 04477000
*        END SCANCMD;                                              1066 04478000
@EL00003 DS    0H                                                  1066 04479000
@EF00003 DS    0H                                                  1066 04480000
@ER00003 LM    @14,@12,@SA00003                                    1066 04481000
         BR    @14                                                 1066 04482000
*/********************************************************************/ 04483000
*/*                                                                  */ 04484000
*/*  PROCEDURE NAME - GETDATA                                        */ 04485000
*/*                                                                  */ 04486000
*/*  FUNCTION - THIS ROUTINE SETS UP TO EXTRACT THE SCALAR VALUE OR  */ 04487000
*/*             VALUES ASSOCIATED WITH A PARAMETER.                  */ 04488000
*/*                                                                  */ 04489000
*/*  INPUT -                                                         */ 04490000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 04491000
*/*          CHAR1 -   MOST RECENTLY EXTRACTED INPUT CHARACTER       */ 04492000
*/*          CHAR2 -   CHARACTER WHICH IS TO BE EXTRACTED NEXT       */ 04493000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO NON-ZERO     */ 04494000
*/*                    VALUE WHEN AN ERROR IS DETECTED.              */ 04495000
*/*          PWORD -   SWITCH SET TO INDICATE WHETHER A PASSWORD     */ 04496000
*/*                    SCALAR IS CURRENTLY BEING EXTRACTED, IS NOT   */ 04497000
*/*                    BEING EXTRACTED, OR WILL BE EXTRACTED NEXT.   */ 04498000
*/*          SCANONLY- FLAG SET 'ON' WHEN CURRENT COMMAND IS BEING   */ 04499000
*/*                    SCANNED FOR SYNTAX CHECKING ONLY.             */ 04500000
*/*          JUSTONE - FLAG SET 'ON' WHEN NO PARENTHESES HAVE BEEN   */ 04501000
*/*                    CODED TO DELIMIT A SCALAR LIST SINCE ONLY ONE */ 04502000
*/*                    LIST ELEMENT EXISTS.                          */ 04503000
*/*                                                                  */ 04504000
*/*  OUTPUT -                                                        */ 04505000
*/*          FUNCTION DATA TABLE DATA ENTRIES                        */ 04506000
*/*          SCLRCNT - COUNT OF SCALARS FOUND IN A SCALAR LIST       */ 04507000
*/*          PWORD -   SEE 'INPUT'                                   */ 04508000
*/*          PWORDSW - FLAG SET 'ON' WHEN A PASSWORD ITEM MAY FOLLOW */ 04509000
*/*                    THE PRIMARY SCALAR VALUE                      */ 04510000
*/*          ORGSIGN - CONTAINS A CHARACTER CODE INDICATING THE FORM */ 04511000
*/*                    IN WHICH A CONSTANT WAS SPECIFIED             */ 04512000
*/*                                                                  */ 04513000
*/********************************************************************/ 04514000
*GETDATA:PROCEDURE;                                                1067 04515000
GETDATA  STM   @14,@12,@SA00011                                    1067 04516000
*        /************************************************************/ 04517000
*        /*                                                          */ 04518000
*        /* GETDATA PROCEDURE DATA DEFINITIONS                       */ 04519000
*        /*                                                          */ 04520000
*        /************************************************************/ 04521000
*        DCL ENDVALUE BIT(1);          /*SIGNALS THAT ALL THE SCALAR    04522000
*                                        DATA HAS BEEN EXTRACTED     */ 04523000
*                                                                  1068 04524000
*        /*STATIC ERROR MESSAGE CODES                                */ 04525000
*        DCL BADNUM   FIXED(31)        /*IMPROPER NUMERICAL VALUE    */ 04526000
*                     CONSTANT(15);                                1069 04527000
*        DCL BADPWD   FIXED(31)        /*PASSWORD APPEARS IMPROPERLY */ 04528000
*                     CONSTANT(18);                                1070 04529000
*        /************************************************************/ 04530000
*        /*                                                          */ 04531000
*        /*  ** GETDATA **  EXTRACT SCALAR VALUE OR VALUES           */ 04532000
*        /*                                                          */ 04533000
*        /************************************************************/ 04534000
*        SCLRCNT=0;                                                1071 04535000
         SLR   @15,@15                                             1071 04536000
         STH   @15,SCLRCNT                                         1071 04537000
*        PWORD=NONE;                                               1072 04538000
         STH   @15,PWORD                                           1072 04539000
*        ENDVALUE=NO;                                              1073 04540000
         NI    ENDVALUE,B'01111111'                                1073 04541000
*        PWORDSW=OFF;                                              1074 04542000
         NI    PWORDSW,B'01111111'                                 1074 04543000
*        OLDERID2 = NEWERID2;                                      1075 04544000
         L     @01,GDTPTR                                          1075 04545000
         L     @15,GDTTR2(,@01)                                    1075 04546000
         MVC   @TS00001(95),NEWERID2(@15)                          1075 04547000
         MVC   OLDERID2(95,@15),@TS00001                           1075 04548000
*        NEWID2='RI11';                                            1076 04549000
*                                                                  1076 04550000
         MVC   NEWID2(4,@15),@CC00965                              1076 04551000
*        /************************************************************/ 04552000
*        /*                                                          */ 04553000
*        /*  EXTRACT DATA UNTIL THE ENTIRE SCALAR OR LIST OF         */ 04554000
*        /*  SCALARS HAS BEEN PICKED UP                              */ 04555000
*        /*                                                          */ 04556000
*        /************************************************************/ 04557000
*        DO WHILE(ENDVALUE=NO );                                   1077 04558000
*                                                                  1077 04559000
         B     @DE01077                                            1077 04560000
@DL01077 DS    0H                                                  1078 04561000
*          /**********************************************************/ 04562000
*          /*                                                        */ 04563000
*          /* NOTE WHETHER OR NOT A PASSWORD IS ALLOWED WITH         */ 04564000
*          /* THE CURRENT PARAMETER.  THEN USE THE PARAMETER         */ 04565000
*          /* DATA FORMAT TO EXTRACT THE CONSTANT.                   */ 04566000
*          /*                                                        */ 04567000
*          /**********************************************************/ 04568000
*          IF PWORDOPT=YES & PWORD=NONE                            1078 04569000
*            THEN                                                  1078 04570000
         LA    @15,12                                              1078 04571000
         LR    @14,@15                                             1078 04572000
         MH    @14,PARMID                                          1078 04573000
         L     @01,WORKPTR                                         1078 04574000
         AL    @01,@CF01317                                        1078 04575000
         AL    @15,PARMPTR(@14,@01)                                1078 04576000
         TM    PWORDOPT(@15),B'00000010'                           1078 04577000
         BNO   @RF01078                                            1078 04578000
         LH    @15,PWORD                                           1078 04579000
         LTR   @15,@15                                             1078 04580000
         BNZ   @RF01078                                            1078 04581000
*              PWORDSW=ON;                                         1079 04582000
         OI    PWORDSW,B'10000000'                                 1079 04583000
*            ELSE                                                  1080 04584000
*              PWORDSW=OFF;                                        1080 04585000
*                                                                  1080 04586000
         B     @RC01078                                            1080 04587000
@RF01078 NI    PWORDSW,B'01111111'                                 1080 04588000
*          ORGSIGN=BLANK;                                          1081 04589000
@RC01078 MVI   ORGSIGN,C' '                                        1081 04590000
*          IF NUMBER=YES |                                         1082 04591000
*             (ANYSTRNG=YES & (CHAR1=HEXSIGN | CHAR1=BINSIGN) &    1082 04592000
*              CHAR2=QUOTE & PWORD^=NEXT)                          1082 04593000
*                                                                  1082 04594000
*            /********************************************************/ 04595000
*            /*                                                      */ 04596000
*            /* EXTRACT A NUMBER IN DECIMAL FORM OR EXTRACT A NUMBER */ 04597000
*            /* OR STRING WHICH IS SPECIFIED IN BINARY OR HEX FORM.  */ 04598000
*            /*                                                      */ 04599000
*            /********************************************************/ 04600000
*            THEN                                                  1082 04601000
         LA    @15,12                                              1082 04602000
         LR    @14,@15                                             1082 04603000
         MH    @14,PARMID                                          1082 04604000
         L     @01,WORKPTR                                         1082 04605000
         AL    @01,@CF01317                                        1082 04606000
         AL    @15,PARMPTR(@14,@01)                                1082 04607000
         TM    NUMBER(@15),B'10000000'                             1082 04608000
         BO    @RT01082                                            1082 04609000
         TM    ANYSTRNG(@15),B'01000000'                           1082 04610000
         BNO   @RF01082                                            1082 04611000
         CLI   CHAR1,C'X'                                          1082 04612000
         BE    @GL00045                                            1082 04613000
         CLI   CHAR1,C'B'                                          1082 04614000
         BNE   @RF01082                                            1082 04615000
@GL00045 CLI   CHAR2,C''''                                         1082 04616000
         BNE   @RF01082                                            1082 04617000
         CLC   PWORD(2),@CH00172                                   1082 04618000
         BE    @RF01082                                            1082 04619000
@RT01082 DS    0H                                                  1083 04620000
*              IF CHAR1=HEXSIGN | CHAR1=BINSIGN                    1083 04621000
*                THEN                                              1083 04622000
         CLI   CHAR1,C'X'                                          1083 04623000
         BE    @RT01083                                            1083 04624000
         CLI   CHAR1,C'B'                                          1083 04625000
         BNE   @RF01083                                            1083 04626000
@RT01083 DS    0H                                                  1084 04627000
*                  DO;                                             1084 04628000
*                  ORGSIGN=CHAR1;                                  1085 04629000
*                                                                  1085 04630000
         MVC   ORGSIGN(1),CHAR1                                    1085 04631000
*                  CALL NEXTCHAR;                                  1086 04632000
*                                                                  1086 04633000
         BAL   @14,NEXTCHAR                                        1086 04634000
*                  IF RISTATUS=0                                   1087 04635000
*                    THEN                                          1087 04636000
         LH    @15,RISTATUS                                        1087 04637000
         LTR   @15,@15                                             1087 04638000
         BNZ   @RF01087                                            1087 04639000
*                      IF CHAR1=QUOTE                              1088 04640000
*                        THEN                                      1088 04641000
*                                                                  1088 04642000
         CLI   CHAR1,C''''                                         1088 04643000
         BNE   @RF01088                                            1088 04644000
*                          CALL GETQUOTD;                          1089 04645000
*                                                                  1089 04646000
         BAL   @14,GETQUOTD                                        1089 04647000
*                        ELSE                                      1090 04648000
*                                                                  1090 04649000
*                          CALL ERROR1(BADNUM);                    1090 04650000
*                                                                  1090 04651000
         B     @RC01088                                            1090 04652000
@RF01088 LA    @01,@AL01090                                        1090 04653000
         BAL   @14,ERROR1                                          1090 04654000
*                  END;                                            1091 04655000
*                ELSE                                              1092 04656000
*                                                                  1092 04657000
*                  CALL GETSIMPL;                                  1092 04658000
*                                                                  1092 04659000
         B     @RC01083                                            1092 04660000
@RF01083 BAL   @14,GETSIMPL                                        1092 04661000
*            /********************************************************/ 04662000
*            /*                                                      */ 04663000
*            /*  WHEN THE CONSTANT IS NOT A NUMBER, A HEX            */ 04664000
*            /*  STRING, OR A BIT STRING, EXTRACT IT AS A            */ 04665000
*            /*  CHARACTER STRING, CHECKING TO SEE IF IT IS WITHIN   */ 04666000
*            /*  APOSTROPHES.  ALSO CHECK TO SEE IF THE SCALAR IS    */ 04667000
*            /*  A PASSWORD.                                         */ 04668000
*            /*                                                      */ 04669000
*            /********************************************************/ 04670000
*            ELSE                                                  1093 04671000
*              DO;                                                 1093 04672000
         B     @RC01082                                            1093 04673000
@RF01082 DS    0H                                                  1094 04674000
*              OLDERID2 = NEWERID2;                                1094 04675000
         L     @01,GDTPTR                                          1094 04676000
         L     @15,GDTTR2(,@01)                                    1094 04677000
         MVC   @TS00001(95),NEWERID2(@15)                          1094 04678000
         MVC   OLDERID2(95,@15),@TS00001                           1094 04679000
*              NEWID2='RI12';                                      1095 04680000
         MVC   NEWID2(4,@15),@CC00968                              1095 04681000
*              IF PWORD=NEXT                                       1096 04682000
*                THEN                                              1096 04683000
         CLC   PWORD(2),@CH00172                                   1096 04684000
         BNE   @RF01096                                            1096 04685000
*                  PWORD=NOW;                                      1097 04686000
         MVC   PWORD(2),@CH00144                                   1097 04687000
*              IF CHAR1=QUOTE                                      1098 04688000
*                THEN                                              1098 04689000
*                                                                  1098 04690000
@RF01096 CLI   CHAR1,C''''                                         1098 04691000
         BNE   @RF01098                                            1098 04692000
*                  CALL GETQUOTD;                                  1099 04693000
*                                                                  1099 04694000
         BAL   @14,GETQUOTD                                        1099 04695000
*                ELSE                                              1100 04696000
*                                                                  1100 04697000
*                  CALL GETSIMPL;                                  1100 04698000
*                                                                  1100 04699000
         B     @RC01098                                            1100 04700000
@RF01098 BAL   @14,GETSIMPL                                        1100 04701000
*              END;                                                1101 04702000
*                                                                  1101 04703000
@RC01098 DS    0H                                                  1102 04704000
*          /**********************************************************/ 04705000
*          /*                                                        */ 04706000
*          /*  ADD THE EXTRACTED SCALAR TO THE FDT AND CHECK TO SEE  */ 04707000
*          /*  IF THE SCALAR VALUE OR VALUES HAVE BEEN COMPLETELY    */ 04708000
*          /*  EXTRACTED.                                            */ 04709000
*          /*                                                        */ 04710000
*          /**********************************************************/ 04711000
*          IF RISTATUS=0 & SCANONLY=NO                             1102 04712000
*            THEN                                                  1102 04713000
*                                                                  1102 04714000
@RC01082 LH    @15,RISTATUS                                        1102 04715000
         LTR   @15,@15                                             1102 04716000
         BNZ   @RF01102                                            1102 04717000
         TM    SCANONLY,B'00010000'                                1102 04718000
         BNZ   @RF01102                                            1102 04719000
*              CALL BUILDFDT;                                      1103 04720000
         BAL   @14,BUILDFDT                                        1103 04721000
*            ELSE                                                  1104 04722000
*              IF PWORD=NOW                                        1104 04723000
*                THEN                                              1104 04724000
         B     @RC01102                                            1104 04725000
@RF01102 CLC   PWORD(2),@CH00144                                   1104 04726000
         BNE   @RF01104                                            1104 04727000
*                  PWORD=NONE;                                     1105 04728000
*                                                                  1105 04729000
         SLR   @15,@15                                             1105 04730000
         STH   @15,PWORD                                           1105 04731000
*          IF (SCALAR=YES & PWORD=NONE) | (JUSTONE=YES & PWORD=NONE) |  04732000
*             CHAR1=CLOSING | CHAR1=ENDDELIM | RISTATUS ^= 0       1106 04733000
*            THEN                                                  1106 04734000
@RF01104 DS    0H                                                  1106 04735000
@RC01102 LH    @15,PARMID                                          1106 04736000
         MH    @15,@CH00038                                        1106 04737000
         L     @01,WORKPTR                                         1106 04738000
         AL    @01,@CF01317                                        1106 04739000
         L     @01,PARMPTR(@15,@01)                                1106 04740000
         TM    SCALAR(@01),B'00010000'                             1106 04741000
         BNO   @GL00053                                            1106 04742000
         LH    @15,PWORD                                           1106 04743000
         LTR   @15,@15                                             1106 04744000
         BZ    @RT01106                                            1106 04745000
@GL00053 TM    JUSTONE,B'00000001'                                 1106 04746000
         BNO   @GL00052                                            1106 04747000
         LH    @15,PWORD                                           1106 04748000
         LTR   @15,@15                                             1106 04749000
         BZ    @RT01106                                            1106 04750000
@GL00052 CLI   CHAR1,C')'                                          1106 04751000
         BE    @RT01106                                            1106 04752000
         CLI   CHAR1,C';'                                          1106 04753000
         BE    @RT01106                                            1106 04754000
         LH    @15,RISTATUS                                        1106 04755000
         LTR   @15,@15                                             1106 04756000
         BZ    @RF01106                                            1106 04757000
@RT01106 DS    0H                                                  1107 04758000
*              ENDVALUE=YES;                                       1107 04759000
         OI    ENDVALUE,B'10000000'                                1107 04760000
*        END;                                                      1108 04761000
@RF01106 DS    0H                                                  1108 04762000
@DE01077 TM    ENDVALUE,B'10000000'                                1108 04763000
         BZ    @DL01077                                            1108 04764000
*/********************************************************************/ 04765000
*/*                                                                  */ 04766000
*/*  PROCEDURE NAME -  GETSIMPL                                      */ 04767000
*/*                                                                  */ 04768000
*/*  FUNCTION - THIS ROUTINE EXTRACTS A SCALAR NOT ENCLOSED WITHIN   */ 04769000
*/*             APOSTROPHES AND CHECKS TO SEE IF A PASSWORD ITEM     */ 04770000
*/*             FOLLOWS THE PRIMARY SCALAR.                          */ 04771000
*/*                                                                  */ 04772000
*/*  INPUT -                                                         */ 04773000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 04774000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO NON-ZERO     */ 04775000
*/*                    VALUE WHEN AN ERROR IS DETECTED.              */ 04776000
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED                */ 04777000
*/*          CHAR2 -   INPUT CHARACTER TO BE EXTRACTED NEXT          */ 04778000
*/*          PWORD -   SWITCH INDICATING WHETHER A PASSWORD IS TO BE */ 04779000
*/*                    EXTRACTED NEXT, NOW, OR NOT AT ALL            */ 04780000
*/*          PWORDSW - FLAG SET 'ON' WHEN A PASSWORD MAY APPEAR      */ 04781000
*/*                    LEGITIMATELY                                  */ 04782000
*/*                                                                  */ 04783000
*/*  OUTPUT -                                                        */ 04784000
*/*          EXTRACTED SCALAR ITEM.                                  */ 04785000
*/*          PWORD -   SEE 'INPUT'                                   */ 04786000
*/*                                                                  */ 04787000
*/********************************************************************/ 04788000
*GETSIMPL:PROCEDURE;                                               1109 04789000
         B     @PB00012                                            1109 04790000
GETSIMPL STM   @14,@12,@SA00012                                    1109 04791000
*        /************************************************************/ 04792000
*        /*                                                          */ 04793000
*        /*  ** GETSIMPL **  EXTRACT AN UNQUOTED SCALAR              */ 04794000
*        /*                                                          */ 04795000
*        /************************************************************/ 04796000
*                                                                  1110 04797000
*        /************************************************************/ 04798000
*        /*                                                          */ 04799000
*        /* PICK UP THE UNQUOTED SCALAR                              */ 04800000
*        /*                                                          */ 04801000
*        /************************************************************/ 04802000
*                                                                  1110 04803000
*        CALL NXTFIELD(SIMPSCLR);                                  1110 04804000
         LA    @01,@AL01110                                        1110 04805000
         BAL   @14,NXTFIELD                                        1110 04806000
*        CALL SCANSEP(YES);                                        1111 04807000
*                                                                  1111 04808000
         LA    @01,@AL01111                                        1111 04809000
         BAL   @14,SCANSEP                                         1111 04810000
*        IF RISTATUS=0                                             1112 04811000
*          THEN                                                    1112 04812000
         LH    @15,RISTATUS                                        1112 04813000
         LTR   @15,@15                                             1112 04814000
         BNZ   @RF01112                                            1112 04815000
*            IF CHAR1=PWDDELIM                                     1113 04816000
*                                                                  1113 04817000
*              /******************************************************/ 04818000
*              /*                                                    */ 04819000
*              /*  WHEN THE ENDING DELIMITER OF THE SCALAR IS THE    */ 04820000
*              /*  DELIMITER INDICATING A FOLLOWING PASSWORD, NOTE   */ 04821000
*              /*  THAT THE PASSWORD IS TO BE EXTRACTED LATER.  ALSO */ 04822000
*              /*  CHECK TO SEE IF THE OCCURRENCE OR LACK OF         */ 04823000
*              /*  OCCURRENCE OF A PASSWORD DELIMITER IS AN ERROR.   */ 04824000
*              /*                                                    */ 04825000
*              /******************************************************/ 04826000
*              THEN                                                1113 04827000
         CLI   CHAR1,C'/'                                          1113 04828000
         BNE   @RF01113                                            1113 04829000
*                IF PWORDSW=ON                                     1114 04830000
*                  THEN                                            1114 04831000
         TM    PWORDSW,B'10000000'                                 1114 04832000
         BNO   @RF01114                                            1114 04833000
*                    DO;                                           1115 04834000
*                                                                  1115 04835000
*                    CALL NEXTCHAR;                                1116 04836000
         BAL   @14,NEXTCHAR                                        1116 04837000
*                    CALL SCANSEP(YES);                            1117 04838000
*                                                                  1117 04839000
         LA    @01,@AL01117                                        1117 04840000
         BAL   @14,SCANSEP                                         1117 04841000
*                    PWORD=NEXT;                                   1118 04842000
         MVC   PWORD(2),@CH00172                                   1118 04843000
*                    END;                                          1119 04844000
*                  ELSE                                            1120 04845000
*                                                                  1120 04846000
*                    CALL ERROR2(BADPWD,LENGTH(ERRFIELD),          1120 04847000
*                                ADDR(ERRFIELD));                  1120 04848000
*                                                                  1120 04849000
         B     @RC01114                                            1120 04850000
@RF01114 MVC   @AL00001(8),@AL01120                                1120 04851000
         LA    @15,ERRFIELD                                        1120 04852000
         ST    @15,@AFTEMPS+16                                     1120 04853000
         LA    @15,@AFTEMPS+16                                     1120 04854000
         ST    @15,@AL00001+8                                      1120 04855000
         LA    @01,@AL00001                                        1120 04856000
         BAL   @14,ERROR2                                          1120 04857000
*        END GETSIMPL;                                             1121 04858000
@EL00012 DS    0H                                                  1121 04859000
@EF00012 DS    0H                                                  1121 04860000
@ER00012 LM    @14,@12,@SA00012                                    1121 04861000
         BR    @14                                                 1121 04862000
*/********************************************************************/ 04863000
*/*                                                                  */ 04864000
*/*  PROCEDURE NAME - GETQUOTD                                       */ 04865000
*/*                                                                  */ 04866000
*/*  FUNCTION - THIS ROUTINE EXTRACTS A SCALAR THAT IS WITHIN        */ 04867000
*/*             APOSTROPHES AND CHECKS FOR A FOLLOWING PASSWORD.     */ 04868000
*/*                                                                  */ 04869000
*/*  INPUT -                                                         */ 04870000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 04871000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO NON-ZERO     */ 04872000
*/*                    VALUE WHEN AN ERROR IS DETECTED.              */ 04873000
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED                */ 04874000
*/*          CHAR2 -   INPUT CHARACTER TO BE EXTRACTED NEXT          */ 04875000
*/*          PWORDSW - FLAG SET 'ON' WHEN A PASSWORD MAY APPEAR      */ 04876000
*/*                    LEGITIMATELY                                  */ 04877000
*/*                                                                  */ 04878000
*/*  OUTPUT -                                                        */ 04879000
*/*          EXTRACTED SCALAR ITEM.                                  */ 04880000
*/*          PWORD -   SWITCH INDICATING WHEN A PASSWORD IS TO BE    */ 04881000
*/*                    EXTRACTED NEXT                                */ 04882000
*/*                                                                  */ 04883000
*/********************************************************************/ 04884000
*GETQUOTD:PROCEDURE;                                               1122 04885000
GETQUOTD STM   @14,@12,@SA00013                                    1122 04886000
*        /************************************************************/ 04887000
*        /*                                                          */ 04888000
*        /*  ** GETQUOTD **  EXTRACT SCALAR WITHIN APOSTROPHES       */ 04889000
*        /*                                                          */ 04890000
*        /************************************************************/ 04891000
*        IF GDTDBG = NULLPTR                                       1123 04892000
*          THEN;                                                   1123 04893000
         L     @01,GDTPTR                                          1123 04894000
         L     @15,GDTDBG(,@01)                                    1123 04895000
         LTR   @15,@15                                             1123 04896000
         BZ    @RT01123                                            1123 04897000
*          ELSE                                                    1125 04898000
*            CALL ICKDB010(GDTTBL,'RIGQ');                         1125 04899000
*                                                                  1125 04900000
         L     @15,GDTPTR                                          1125 04901000
         ST    @15,@AL00001                                        1125 04902000
         LA    @14,@CC00976                                        1125 04903000
         ST    @14,@AL00001+4                                      1125 04904000
         MVI   @AL00001+4,X'80'                                    1125 04905000
         L     @15,GDTDBG(,@15)                                    1125 04906000
         LA    @01,@AL00001                                        1125 04907000
         BALR  @14,@15                                             1125 04908000
*        /************************************************************/ 04909000
*        /*                                                          */ 04910000
*        /* BYPASS THE LEADING APOSTROPHE AND EXTRACT THE SCALAR     */ 04911000
*        /*                                                          */ 04912000
*        /************************************************************/ 04913000
*                                                                  1126 04914000
*        CALL NEXTCHAR;                                            1126 04915000
@RT01123 BAL   @14,NEXTCHAR                                        1126 04916000
*        CALL NXTFIELD(QUOTSCLR);                                  1127 04917000
         LA    @01,@AL01127                                        1127 04918000
         BAL   @14,NXTFIELD                                        1127 04919000
*        CALL SCANSEP(YES);                                        1128 04920000
*                                                                  1128 04921000
         LA    @01,@AL01128                                        1128 04922000
         BAL   @14,SCANSEP                                         1128 04923000
*        IF RISTATUS=0                                             1129 04924000
*          THEN                                                    1129 04925000
*                                                                  1129 04926000
         LH    @15,RISTATUS                                        1129 04927000
         LTR   @15,@15                                             1129 04928000
         BNZ   @RF01129                                            1129 04929000
*            /********************************************************/ 04930000
*            /*                                                      */ 04931000
*            /* WHEN A DELIMITER INDICATING A FOLLOWING PASSWORD IS  */ 04932000
*            /* FOUND, NOTE THAT THE PASSWORD IS TO BE EXTRACTED     */ 04933000
*            /* LATER.  ALSO CHECK WHETHER THE OCCURRENCE OR LACK OF */ 04934000
*            /* OCCURRENCE OF A PASSWORD DELIMITER IS AN ERROR.      */ 04935000
*            /*                                                      */ 04936000
*            /********************************************************/ 04937000
*            IF CHAR1=PWDDELIM                                     1130 04938000
*              THEN                                                1130 04939000
         CLI   CHAR1,C'/'                                          1130 04940000
         BNE   @RF01130                                            1130 04941000
*                IF PWORDSW=ON                                     1131 04942000
*                  THEN                                            1131 04943000
         TM    PWORDSW,B'10000000'                                 1131 04944000
         BNO   @RF01131                                            1131 04945000
*                    DO;                                           1132 04946000
*                                                                  1132 04947000
*                    CALL NEXTCHAR;                                1133 04948000
         BAL   @14,NEXTCHAR                                        1133 04949000
*                    CALL SCANSEP(YES);                            1134 04950000
*                                                                  1134 04951000
         LA    @01,@AL01134                                        1134 04952000
         BAL   @14,SCANSEP                                         1134 04953000
*                    PWORD=NEXT;                                   1135 04954000
         MVC   PWORD(2),@CH00172                                   1135 04955000
*                    END;                                          1136 04956000
*                  ELSE                                            1137 04957000
*                                                                  1137 04958000
*                    CALL ERROR2(BADPWD,LENGTH(ERRFIELD),          1137 04959000
*                                ADDR(ERRFIELD));                  1137 04960000
*                                                                  1137 04961000
         B     @RC01131                                            1137 04962000
@RF01131 MVC   @AL00001(8),@AL01137                                1137 04963000
         LA    @15,ERRFIELD                                        1137 04964000
         ST    @15,@AFTEMPS+20                                     1137 04965000
         LA    @15,@AFTEMPS+20                                     1137 04966000
         ST    @15,@AL00001+8                                      1137 04967000
         LA    @01,@AL00001                                        1137 04968000
         BAL   @14,ERROR2                                          1137 04969000
*        END GETQUOTD;                                             1138 04970000
*                                                                  1138 04971000
*                                                                  1138 04972000
@EL00013 DS    0H                                                  1138 04973000
@EF00013 DS    0H                                                  1138 04974000
@ER00013 LM    @14,@12,@SA00013                                    1138 04975000
         BR    @14                                                 1138 04976000
*        END GETDATA;                                              1139 04977000
@EL00011 DS    0H                                                  1139 04978000
@EF00011 DS    0H                                                  1139 04979000
@ER00011 LM    @14,@12,@SA00011                                    1139 04980000
         BR    @14                                                 1139 04981000
*/********************************************************************/ 04982000
*/*                                                                  */ 04983000
*/*  PROCEDURE NAME - BUILDFDT                                       */ 04984000
*/*                                                                  */ 04985000
*/*  FUNCTION - THIS ROUTINE PLACES EXTRACTED SCALARS INTO THE       */ 04986000
*/*             FUNCTION DATA TABLE (FDT), AFTER CONVERTING THEM IF  */ 04987000
*/*             NECESSARY.  THE ROUTINE IS PERFORMED ONCE FOR EACH   */ 04988000
*/*             SCALAR.  SPACE IS OBTAINED AS NECESSARY IN ORDER TO  */ 04989000
*/*             STORE THE SCALARS.  SEMANTIC CHECKING IS PERFORMED   */ 04990000
*/*             ON THE SCALAR ITEMS USING THE COMMAND DESCRIPTOR.    */ 04991000
*/*                                                                  */ 04992000
*/*  INPUT -                                                         */ 04993000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 04994000
*/*          PWORD -   SWITCH INDICATING WHETHER A PASSWORD IS NOW   */ 04995000
*/*                    BEING PLACED INTO THE FDT.                    */ 04996000
*/*          SYNUNIT - CONTAINS SCALAR ITEM TO BE PLACED INTO THE FDT*/ 04997000
*/*          UNITINDX- LENGTH OF SCALAR TO BE PLACED INTO THE FDT    */ 04998000
*/*          ORGSIGN - CONTAINS CODE INDICATING FORM IN WHICH THE    */ 04999000
*/*                    SCALAR WAS INPUT (HEX OR BINARY CONSTANT OR   */ 05000000
*/*                    NEITHER)                                      */ 05001000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 05002000
*/*                    VALUE WHEN AN ERROR IS DETECTED               */ 05003000
*/*          SCLRCNT - NUMBER OF SCALAR LIST ITEMS EXTRACTED UP UNTIL*/ 05004000
*/*                    NOW                                           */ 05005000
*/*          DATAPTR - POINTER TO SCALAR DATA STRUCTURE FOR CURRENT  */ 05006000
*/*                    PARAMETER                                     */ 05007000
*/*          SPACELFT- SPACE REMAINING FROM THAT ALLOCATED FOR A     */ 05008000
*/*                    SCALAR LIST DATA STRUCTURE                    */ 05009000
*/*          SPACEAMT- AMOUNT OF SPACE REQUIRED FOR EACH SCALAR ITEM */ 05010000
*/*                    IN THE SCALAR LIST DATA STRUCTURE             */ 05011000
*/*                                                                  */ 05012000
*/*  OUTPUT -                                                        */ 05013000
*/*          FUNCTION DATA TABLE (FDT) DATA ENTRIES                  */ 05014000
*/*          PWORD -   SEE 'INPUT'                                   */ 05015000
*/*          SCLRCNT - NUMBER OF SCALAR LIST ITEMS EXTRACTED         */ 05016000
*/*          SPACELFT- SEE 'INPUT'                                   */ 05017000
*/*                                                                  */ 05018000
*/********************************************************************/ 05019000
*BUILDFDT:PROCEDURE;                                               1140 05020000
BUILDFDT STM   @14,@12,@SA00014                                    1140 05021000
*        /************************************************************/ 05022000
*        /*                                                          */ 05023000
*        /* BUILDFDT PROCEDURE DATA DEFINITIONS                      */ 05024000
*        /*                                                          */ 05025000
*        /************************************************************/ 05026000
*                                                                  1141 05027000
*        /*FULLWORD BINARY CONSTANT DATA FORM                        */ 05028000
*                                                                  1141 05029000
*        DCL FULLWORD FIXED(31) BASED(DATAPTR);                    1141 05030000
*                                                                  1141 05031000
*        /*STRING CONSTANT DATA FORM                                 */ 05032000
*                                                                  1142 05033000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1142 05034000
*              2 STRINGLN FIXED(8),    /*LENGTH OF STRING            */ 05035000
*              2 STRING   CHAR(*);     /*THE STRING ITEM ITSELF      */ 05036000
*                                                                  1142 05037000
*        /*CHARACTER STRING (W/ PASSWORD) CONSTANT DATA FORM         */ 05038000
*                                                                  1143 05039000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1143 05040000
*              2 PASSWDLN FIXED(8),    /*LENGTH OF PASSWORD          */ 05041000
*              2 PASSWORD CHAR(8),     /*THE PASSWORD ITSELF         */ 05042000
*              2 CHARLN   FIXED(8),    /*CHAR. STRING LENGTH         */ 05043000
*              2 CHARS    CHAR(*);     /*THE CHARACTER STRING ITSELF */ 05044000
*                                                                  1143 05045000
*        /*DATA SET NAME CONSTANT DATA FORM                          */ 05046000
*                                                                  1144 05047000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1144 05048000
*              2 DSPWDLN  FIXED(8),    /*LENGTH OF PASSWORD          */ 05049000
*              2 DSPWORD  CHAR(8),     /*PASSWORD                    */ 05050000
*              2 STARPOS  FIXED(8),    /*ASTERISK POSITION           */ 05051000
*                                      /* IN GENERIC DSNAME          */ 05052000
*              2 UNQTFLG  BIT(1),      /*SET 'ON' IF DSNAME          */ 05053000
*                                      /* WAS INPUT WITHIN           */ 05054000
*                                      /* QUOTES IN THE TSO          */ 05055000
*                                      /* ENVIRONMENT                */ 05056000
*              2 MEMNAMLN FIXED(8),    /*MEMBER NAME LENGTH          */ 05057000
*              2 MEMNAME  CHAR(8),     /*MEMBER NAME                 */ 05058000
*              2 DSNAMELN FIXED(8),    /*LENGTH OF MAIN PART         */ 05059000
*                                      /* OF THE DSNAME              */ 05060000
*              2 DSNAME   CHAR(44);    /*MAIN PART OF DATA SET NAME  */ 05061000
*                                                                  1144 05062000
*        /*BINARY FULLWORD CONSTANT LIST DATA FORM                   */ 05063000
*                                                                  1145 05064000
*        DCL 1 * BASED(DATAPTR) BDY(WORD),                         1145 05065000
*              2 FULLWDCT FIXED(31),   /*NO. OF FULLWORDS IN THE LIST*/ 05066000
*              2 LFULLWD(*) FIXED(31); /*LIST OF FULLWORDS           */ 05067000
*                                                                  1145 05068000
*        /*STRING CONSTANT LIST DATA FORM                            */ 05069000
*                                                                  1146 05070000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1146 05071000
*              2 STRINGCT FIXED(15),   /*# OF STRINGS LISTED         */ 05072000
*              2 LSTRINGL FIXED(8),    /*LENGTH OF STRING            */ 05073000
*              2 LSTRING  CHAR(*);     /*SCALAR ITEM                 */ 05074000
*                                                                  1146 05075000
*        /*STRING (W/ PASSWORD) CONSTANT LIST DATA FORM              */ 05076000
*                                                                  1147 05077000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1147 05078000
*              2 CHARCT   FIXED(15),   /*# OF STRING SCALARS IN LIST */ 05079000
*              2 LCHRPWDL FIXED(8),    /*LENGTH OF PASSWORD          */ 05080000
*              2 LCHRPWD  CHAR(8),     /*PASSWORD AT END OF STRING   */ 05081000
*              2 LCHARLN  FIXED(8),    /*LENGTH OF STRING            */ 05082000
*              2 LCHAR    CHAR(*);     /*CHARACTER STRING ITEM       */ 05083000
*                                                                  1147 05084000
*        /*DATA SET NAME CONSTANT LIST DATA FORM                     */ 05085000
*                                                                  1148 05086000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1148 05087000
*              2 DSNAMECT FIXED(15),   /*# OF DSNAMES IN LIST        */ 05088000
*              2 * (*) BDY(HWORD),     /*ARRAY (LIST) OF DATA        */ 05089000
*                3 LDSNPWDL FIXED(8),  /*PASSWORD LENGTH             */ 05090000
*                3 LDSNPWD  CHAR(8),   /*PASSWORD AT END OF STRING   */ 05091000
*                3 LSTARPOS FIXED(8),  /*ASTERISK POSITION           */ 05092000
*                                      /* IN GENERIC DSNAME          */ 05093000
*                3 LUNQTFLG BIT(1),    /*SET 'ON' IF DSNAME          */ 05094000
*                                      /* WAS INPUT WITHIN           */ 05095000
*                                      /* QUOTES IN THE TSO          */ 05096000
*                                      /* ENVIRONMENT                */ 05097000
*                3 LMEMNAML FIXED(8),  /*MEMBER NAME LENGTH          */ 05098000
*                3 LMEMNAME CHAR(8),   /*MEMBER NAME (IF ANY)        */ 05099000
*                3 LDSNAMEL FIXED(8),  /*LENGTH OF DSNAME            */ 05100000
*                3 LDSNAME  CHAR(44);  /*MAIN PART OF DATA SET NAME  */ 05101000
*                                                                  1148 05102000
*        /*STATIC ERROR MESSAGE CODES                                */ 05103000
*                                                                  1149 05104000
*        DCL BADLIST  FIXED(31)        /*TOO MANY SCALARS IN LIST    */ 05105000
*                     CONSTANT(24);                                1149 05106000
*                                                                  1149 05107000
*        /*OTHER VARIABLES                                           */ 05108000
*                                                                  1150 05109000
*        DCL ELTPTR   PTR(31);         /*PTR TO FDT STORAGE AREA FOR    05110000
*                                        SCALAR LIST ELEMENT         */ 05111000
*        DCL DATALEN  FIXED(15);       /*AMOUNT OF EXTRACTED DATA TO    05112000
*                                        MOVE INTO AN FDT SLOT       */ 05113000
*        DCL CHSTRING BIT(1);          /*SET 'ON' IF INPUT           */ 05114000
*                                      /* CONSTANT IS NOT A          */ 05115000
*                                      /* DECIMAL, HEX, OR           */ 05116000
*                                      /* BINARY CONSTANT            */ 05117000
*        /************************************************************/ 05118000
*        /*                                                          */ 05119000
*        /*  ** BUILDFDT **  PLACE SCALAR INTO FUNCTION DATA TABLE   */ 05120000
*        /*                                                          */ 05121000
*        /************************************************************/ 05122000
*                                                                  1153 05123000
*        /************************************************************/ 05124000
*        /*                                                          */ 05125000
*        /* DETERMINE THE BASIC FORMAT OF THE CONSTANT.              */ 05126000
*        /* CONSTANTS ALLOWING PASSWORDS CANNOT BE CODED             */ 05127000
*        /* IN HEXADECIMAL FORMAT.                                   */ 05128000
*        /*                                                          */ 05129000
*        /************************************************************/ 05130000
*        IF ANYSTRNG=YES                                           1153 05131000
*          THEN                                                    1153 05132000
         LA    @15,12                                              1153 05133000
         LR    @14,@15                                             1153 05134000
         MH    @14,PARMID                                          1153 05135000
         L     @01,WORKPTR                                         1153 05136000
         AL    @01,@CF01317                                        1153 05137000
         AL    @15,PARMPTR(@14,@01)                                1153 05138000
         TM    ANYSTRNG(@15),B'01000000'                           1153 05139000
         BNO   @RF01153                                            1153 05140000
*            IF ORGSIGN=BLANK                                      1154 05141000
*              THEN                                                1154 05142000
         CLI   ORGSIGN,C' '                                        1154 05143000
         BNE   @RF01154                                            1154 05144000
*                CHSTRING=YES;                                     1155 05145000
         OI    CHSTRING,B'10000000'                                1155 05146000
*              ELSE                                                1156 05147000
*                IF PWORDOPT=YES                                   1156 05148000
*                  THEN                                            1156 05149000
         B     @RC01154                                            1156 05150000
@RF01154 LA    @15,12                                              1156 05151000
         LR    @14,@15                                             1156 05152000
         MH    @14,PARMID                                          1156 05153000
         L     @01,WORKPTR                                         1156 05154000
         AL    @01,@CF01317                                        1156 05155000
         AL    @15,PARMPTR(@14,@01)                                1156 05156000
         TM    PWORDOPT(@15),B'00000010'                           1156 05157000
         BNO   @RF01156                                            1156 05158000
*                    DO;                                           1157 05159000
*                                                                  1157 05160000
*                    CALL ERROR2(BADITEM,LENGTH(ERRFIELD),         1158 05161000
*                                ADDR(ERRFIELD));                  1158 05162000
*                                                                  1158 05163000
         MVC   @AL00001(8),@AL01158                                1158 05164000
         LA    @15,ERRFIELD                                        1158 05165000
         ST    @15,@AFTEMPS+32                                     1158 05166000
         LA    @15,@AFTEMPS+32                                     1158 05167000
         ST    @15,@AL00001+8                                      1158 05168000
         LA    @01,@AL00001                                        1158 05169000
         BAL   @14,ERROR2                                          1158 05170000
*                    RETURN;                                       1159 05171000
@EL00014 DS    0H                                                  1159 05172000
@EF00014 DS    0H                                                  1159 05173000
@ER00014 LM    @14,@12,@SA00014                                    1159 05174000
         BR    @14                                                 1159 05175000
*                    END;                                          1160 05176000
*                  ELSE                                            1161 05177000
*                    CHSTRING=NO;                                  1161 05178000
@RF01156 NI    CHSTRING,B'01111111'                                1161 05179000
*          ELSE                                                    1162 05180000
*            CHSTRING=NO;                                          1162 05181000
*                                                                  1162 05182000
         B     @RC01153                                            1162 05183000
@RF01153 NI    CHSTRING,B'01111111'                                1162 05184000
*        IF SCALAR=YES                                             1163 05185000
*                                                                  1163 05186000
*          /**********************************************************/ 05187000
*          /*                                                        */ 05188000
*          /* WHEN A SINGLE SCALAR (AS OPPOSED TO A SCALAR LIST)     */ 05189000
*          /* IS BEING PROCESSED, GET NECESSARY SPACE, CHECK TO SEE  */ 05190000
*          /* WHAT KIND OF SCALAR IT IS, AND STORE THE SCALAR AND    */ 05191000
*          /* ASSOCIATED DATA.                                       */ 05192000
*          /*                                                        */ 05193000
*          /**********************************************************/ 05194000
*          THEN                                                    1163 05195000
@RC01153 LH    @15,PARMID                                          1163 05196000
         MH    @15,@CH00038                                        1163 05197000
         L     @01,WORKPTR                                         1163 05198000
         AL    @01,@CF01317                                        1163 05199000
         L     @01,PARMPTR(@15,@01)                                1163 05200000
         TM    SCALAR(@01),B'00010000'                             1163 05201000
         BNO   @RF01163                                            1163 05202000
*            IF PWORD=NOW                                          1164 05203000
*                                                                  1164 05204000
*              /******************************************************/ 05205000
*              /*                                                    */ 05206000
*              /*  WHEN THE SCALAR IS A PASSWORD, STORE IT IN THE    */ 05207000
*              /*  ALREADY EXISTING DATA STRUCTURE (EITHER A CHAR.   */ 05208000
*              /*  STRING OR DATA SET NAME DATA STRUCTURE), FIRST    */ 05209000
*              /*  CHECKING THAT IT DOESN'T EXCEED THE LENGTH LIMIT. */ 05210000
*              /*  ALSO STORE THE LENGTH OF THE PASSWORD.            */ 05211000
*              /*                                                    */ 05212000
*              /******************************************************/ 05213000
*              THEN                                                1164 05214000
         CLC   PWORD(2),@CH00144                                   1164 05215000
         BNE   @RF01164                                            1164 05216000
*                IF UNITINDX > LENGTH(PASSWORD)                    1165 05217000
*                  THEN                                            1165 05218000
*                                                                  1165 05219000
         LH    @15,UNITINDX                                        1165 05220000
         CH    @15,@CH00042                                        1165 05221000
         BNH   @RF01165                                            1165 05222000
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1166 05223000
*                                ADDR(ERRFIELD));                  1166 05224000
*                                                                  1166 05225000
         MVC   @AL00001(8),@AL01166                                1166 05226000
         LA    @15,ERRFIELD                                        1166 05227000
         ST    @15,@AFTEMPS+32                                     1166 05228000
         LA    @15,@AFTEMPS+32                                     1166 05229000
         ST    @15,@AL00001+8                                      1166 05230000
         LA    @01,@AL00001                                        1166 05231000
         BAL   @14,ERROR2                                          1166 05232000
*                  ELSE                                            1167 05233000
*                    IF ANYSTRNG=YES                               1167 05234000
*                      THEN                                        1167 05235000
         B     @RC01165                                            1167 05236000
@RF01165 LA    @15,12                                              1167 05237000
         LR    @14,@15                                             1167 05238000
         MH    @14,PARMID                                          1167 05239000
         L     @01,WORKPTR                                         1167 05240000
         AL    @01,@CF01317                                        1167 05241000
         AL    @15,PARMPTR(@14,@01)                                1167 05242000
         TM    ANYSTRNG(@15),B'01000000'                           1167 05243000
         BNO   @RF01167                                            1167 05244000
*                        DO;                                       1168 05245000
*                        PWORD=NONE;                               1169 05246000
         SLR   @15,@15                                             1169 05247000
         STH   @15,PWORD                                           1169 05248000
*                        PASSWDLN=UNITINDX;                        1170 05249000
         L     @15,DATAPTR                                         1170 05250000
         MVC   PASSWDLN(1,@15),UNITINDX+1                          1170 05251000
*                        PASSWORD=SYNUNIT;                         1171 05252000
         MVC   PASSWORD(8,@15),SYNUNIT                             1171 05253000
*                        END;                                      1172 05254000
*                      ELSE                                        1173 05255000
*                        DO;                                       1173 05256000
         B     @RC01167                                            1173 05257000
@RF01167 DS    0H                                                  1174 05258000
*                        PWORD=NONE;                               1174 05259000
         SLR   @15,@15                                             1174 05260000
         STH   @15,PWORD                                           1174 05261000
*                        DSPWDLN=UNITINDX;                         1175 05262000
         L     @15,DATAPTR                                         1175 05263000
         MVC   DSPWDLN(1,@15),UNITINDX+1                           1175 05264000
*                        DSPWORD=SYNUNIT;                          1176 05265000
         MVC   DSPWORD(8,@15),SYNUNIT                              1176 05266000
*                        END;                                      1177 05267000
*                                                                  1177 05268000
*              /******************************************************/ 05269000
*              /*                                                    */ 05270000
*              /*  IF NOT A PASSWORD, ALLOCATE SPACE FOR THE SCALAR  */ 05271000
*              /*  AND ITS ASSOCIATED DATA.  THEN STORE THE SCALAR   */ 05272000
*              /*  AND ITS LENGTH INTO THIS DATA AREA BASED UPON     */ 05273000
*              /*  THE TYPE OF SCALAR THAT IT IS, CHECKING THAT THE  */ 05274000
*              /*  SCALAR LENGTH LIMIT IS NOT EXCEEDED.              */ 05275000
*              /*                                                    */ 05276000
*              /******************************************************/ 05277000
*              ELSE                                                1178 05278000
*DOGRP70:        DO;                                               1178 05279000
*                                                                  1178 05280000
         B     @RC01164                                            1178 05281000
@RF01164 DS    0H                                                  1178 05282000
DOGRP70  DS    0H                                                  1179 05283000
*                CALL GETSPACE;                                    1179 05284000
*                                                                  1179 05285000
         BAL   @14,GETSPACE                                        1179 05286000
*                IF CHSTRING=YES & UNITINDX > MAXLNGTH             1180 05287000
*                  THEN                                            1180 05288000
*                                                                  1180 05289000
         TM    CHSTRING,B'10000000'                                1180 05290000
         BNO   @RF01180                                            1180 05291000
         LA    @15,12                                              1180 05292000
         LR    @14,@15                                             1180 05293000
         MH    @14,PARMID                                          1180 05294000
         L     @01,WORKPTR                                         1180 05295000
         AL    @01,@CF01317                                        1180 05296000
         AL    @15,PARMPTR(@14,@01)                                1180 05297000
         LH    @14,UNITINDX                                        1180 05298000
         MVC   @ZT00003+3(1),MAXLNGTH(@15)                         1180 05299000
         C     @14,@ZT00003                                        1180 05300000
         BNH   @RF01180                                            1180 05301000
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1181 05302000
*                               ADDR(ERRFIELD));                   1181 05303000
*                                                                  1181 05304000
         MVC   @AL00001(8),@AL01181                                1181 05305000
         LA    @15,ERRFIELD                                        1181 05306000
         ST    @15,@AFTEMPS+32                                     1181 05307000
         LA    @15,@AFTEMPS+32                                     1181 05308000
         ST    @15,@AL00001+8                                      1181 05309000
         LA    @01,@AL00001                                        1181 05310000
         BAL   @14,ERROR2                                          1181 05311000
*                IF RISTATUS=0                                     1182 05312000
*                  THEN                                            1182 05313000
@RF01180 LH    @15,RISTATUS                                        1182 05314000
         LTR   @15,@15                                             1182 05315000
         BNZ   @RF01182                                            1182 05316000
*DOGRP75:            DO;                                           1183 05317000
DOGRP75  DS    0H                                                  1184 05318000
*                    IF CHSTRING=YES                               1184 05319000
*                                                                  1184 05320000
*                      /**********************************************/ 05321000
*                      /*                                            */ 05322000
*                      /*  WHEN THE SCALAR IS A CHARACTER STRING,    */ 05323000
*                      /*  STORE IT INTO THE FDT IN THE FORM OF A    */ 05324000
*                      /*  STRING OR A CHAR. STRING WITH PASSWORD    */ 05325000
*                      /*                                            */ 05326000
*                      /**********************************************/ 05327000
*                      THEN                                        1184 05328000
         TM    CHSTRING,B'10000000'                                1184 05329000
         BNO   @RF01184                                            1184 05330000
*                        DO;                                       1185 05331000
*                        IF PWORDOPT=YES                           1186 05332000
*                          THEN                                    1186 05333000
         LA    @15,12                                              1186 05334000
         LR    @14,@15                                             1186 05335000
         MH    @14,PARMID                                          1186 05336000
         L     @01,WORKPTR                                         1186 05337000
         AL    @01,@CF01317                                        1186 05338000
         AL    @15,PARMPTR(@14,@01)                                1186 05339000
         TM    PWORDOPT(@15),B'00000010'                           1186 05340000
         BNO   @RF01186                                            1186 05341000
*                            DO;                                   1187 05342000
*                            CHARLN=UNITINDX;                      1188 05343000
         L     @14,DATAPTR                                         1188 05344000
         MVC   CHARLN(1,@14),UNITINDX+1                            1188 05345000
*                            CHARS(1:MAXLNGTH)=SYNUNIT;            1189 05346000
         SLR   @05,@05                                             1189 05347000
         IC    @05,MAXLNGTH(,@15)                                  1189 05348000
         BCTR  @05,0                                               1189 05349000
         EX    @05,@SM01341                                        1189 05350000
*                            END;                                  1190 05351000
*                          ELSE                                    1191 05352000
*                            DO;                                   1191 05353000
         B     @RC01186                                            1191 05354000
@RF01186 DS    0H                                                  1192 05355000
*                            STRINGLN=UNITINDX;                    1192 05356000
         L     @15,DATAPTR                                         1192 05357000
         MVC   STRINGLN(1,@15),UNITINDX+1                          1192 05358000
*                            STRING(1:MAXLNGTH)=SYNUNIT;           1193 05359000
         LA    @14,12                                              1193 05360000
         LR    @05,@14                                             1193 05361000
         MH    @05,PARMID                                          1193 05362000
         L     @01,WORKPTR                                         1193 05363000
         AL    @01,@CF01317                                        1193 05364000
         AL    @14,PARMPTR(@05,@01)                                1193 05365000
         SLR   @05,@05                                             1193 05366000
         IC    @05,MAXLNGTH(,@14)                                  1193 05367000
         BCTR  @05,0                                               1193 05368000
         EX    @05,@SM01343                                        1193 05369000
*                            END;                                  1194 05370000
*                        END;                                      1195 05371000
*                                                                  1195 05372000
*                      /**********************************************/ 05373000
*                      /*                                            */ 05374000
*                      /*  WHEN THE CONSTANT IS HEX, BINARY,         */ 05375000
*                      /*  OR DECIMAL, THEN PERFORM                  */ 05376000
*                      /*  NECESSARY CONVERSION BEFORE STORING IT    */ 05377000
*                      /*  INTO THE FDT.                             */ 05378000
*                      /*                                            */ 05379000
*                      /**********************************************/ 05380000
*                      ELSE                                        1196 05381000
*                        IF NUMBER=YES | ANYSTRNG=YES              1196 05382000
*                          THEN                                    1196 05383000
*                                                                  1196 05384000
         B     @RC01184                                            1196 05385000
@RF01184 LA    @15,12                                              1196 05386000
         LR    @14,@15                                             1196 05387000
         MH    @14,PARMID                                          1196 05388000
         L     @01,WORKPTR                                         1196 05389000
         AL    @01,@CF01317                                        1196 05390000
         AL    @15,PARMPTR(@14,@01)                                1196 05391000
         TM    NUMBER(@15),B'11000000'                             1196 05392000
         BZ    @RF01196                                            1196 05393000
*                            CALL CONVERT;                         1197 05394000
*                                                                  1197 05395000
         BAL   @14,CONVERT                                         1197 05396000
*                          /******************************************/ 05397000
*                          /*                                        */ 05398000
*                          /* WHEN NONE OF THE ABOVE DATA TYPES, THE */ 05399000
*                          /* SCALAR MUST BE A DATA SET IDENTIFIER.  */ 05400000
*                          /* IT IS STORED IN DSNAME FORM AFTER      */ 05401000
*                          /* CHECKING DSNAME RESTRICTIONS.          */ 05402000
*                          /*                                        */ 05403000
*                          /******************************************/ 05404000
*                          ELSE                                    1198 05405000
*                                                                  1198 05406000
*                            CALL DSICKHK;                         1198 05407000
*                                                                  1198 05408000
         B     @RC01196                                            1198 05409000
@RF01196 BAL   @14,DSICKHK                                         1198 05410000
*                    END DOGRP75;                                  1199 05411000
*                END DOGRP70;                                      1200 05412000
*                                                                  1200 05413000
*          /**********************************************************/ 05414000
*          /*                                                        */ 05415000
*          /* WHEN THE SCALAR BEING HANDLED IS PART OF A SCALAR LIST,*/ 05416000
*          /* CHECK THAT THE LIST ELEMENT LIMIT IS NOT EXCEEDED,     */ 05417000
*          /* ALLOCATE SPACE FOR THE LIST DATA (IF NOT ALREADY DONE),*/ 05418000
*          /* CHECK TO SEE WHAT KIND OF SCALAR DATA IT IS, AND STORE */ 05419000
*          /* THE DATA INTO THE APPROPRIATE NEW OR EXISTING FDT AREA */ 05420000
*          /*                                                        */ 05421000
*          /**********************************************************/ 05422000
*          ELSE                                                    1201 05423000
*            IF PWORD^=NOW                                         1201 05424000
*              THEN                                                1201 05425000
*                                                                  1201 05426000
         B     @RC01163                                            1201 05427000
@RF01163 CLC   PWORD(2),@CH00144                                   1201 05428000
         BE    @RF01201                                            1201 05429000
*                /****************************************************/ 05430000
*                /*                                                  */ 05431000
*                /*  THE SCALAR IS NOT A PASSWORD.  IF THIS IS       */ 05432000
*                /*  FIRST SCALAR ENCOUNTERED IN THE LIST, OBTAIN    */ 05433000
*                /*  INITIAL FDT SPACE FOR STORING THE SCALARS AND   */ 05434000
*                /*  THEIR ASSOCIATED DATA.  IF NOT THE FIRST SCALAR,*/ 05435000
*                /*  ADDITIONAL SPACE MAY HAVE TO BE ALLOCATED.      */ 05436000
*                /*  ALSO, CHECK THAT THE SCALAR DOES NOT EXCEED ITS */ 05437000
*                /*  LENGTH LIMIT AND THAT TOO MANY SCALARS HAVE     */ 05438000
*                /*  BEEN CODED IN THIS CURRENT LIST.                */ 05439000
*                /*                                                  */ 05440000
*                /****************************************************/ 05441000
*DOGRP80:        DO;                                               1202 05442000
DOGRP80  DS    0H                                                  1203 05443000
*                SCLRCNT=SCLRCNT+1;                                1203 05444000
         LA    @15,1                                               1203 05445000
         AH    @15,SCLRCNT                                         1203 05446000
         STH   @15,SCLRCNT                                         1203 05447000
*                IF SCLRCNT > LISTMAX                              1204 05448000
*                  THEN                                            1204 05449000
*                                                                  1204 05450000
         LA    @14,12                                              1204 05451000
         LR    @05,@14                                             1204 05452000
         MH    @05,PARMID                                          1204 05453000
         L     @01,WORKPTR                                         1204 05454000
         AL    @01,@CF01317                                        1204 05455000
         AL    @14,PARMPTR(@05,@01)                                1204 05456000
         MVC   @ZT00003+3(1),LISTMAX(@14)                          1204 05457000
         C     @15,@ZT00003                                        1204 05458000
         BNH   @RF01204                                            1204 05459000
*                    CALL ERROR2(BADLIST,LENGTH(ERRFIELD),         1205 05460000
*                                ADDR(ERRFIELD));                  1205 05461000
*                                                                  1205 05462000
         MVC   @AL00001(8),@AL01205                                1205 05463000
         LA    @15,ERRFIELD                                        1205 05464000
         ST    @15,@AFTEMPS+32                                     1205 05465000
         LA    @15,@AFTEMPS+32                                     1205 05466000
         ST    @15,@AL00001+8                                      1205 05467000
         LA    @01,@AL00001                                        1205 05468000
         BAL   @14,ERROR2                                          1205 05469000
*                  ELSE                                            1206 05470000
*                    IF SCLRCNT=1                                  1206 05471000
*                      THEN                                        1206 05472000
         B     @RC01204                                            1206 05473000
@RF01204 CLC   SCLRCNT(2),@CH00172                                 1206 05474000
         BNE   @RF01206                                            1206 05475000
*                        DO;                                       1207 05476000
*                                                                  1207 05477000
*                        CALL GETSPACE;                            1208 05478000
*                                                                  1208 05479000
         BAL   @14,GETSPACE                                        1208 05480000
*                        ELTPTR=DATAPTR;                           1209 05481000
         MVC   ELTPTR(4),DATAPTR                                   1209 05482000
*                        END;                                      1210 05483000
*                      ELSE                                        1211 05484000
*                        DO;                                       1211 05485000
         B     @RC01206                                            1211 05486000
@RF01206 DS    0H                                                  1212 05487000
*                        SPACELFT=SPACELFT-SPACEAMT;               1212 05488000
         LH    @15,SPACELFT                                        1212 05489000
         SH    @15,SPACEAMT                                        1212 05490000
         STH   @15,SPACELFT                                        1212 05491000
*                        IF SPACELFT < 0                           1213 05492000
*                          THEN                                    1213 05493000
         LTR   @15,@15                                             1213 05494000
         BNM   @RF01213                                            1213 05495000
*                            DO;                                   1214 05496000
*                            ELTPTR=ELTPTR-DATAPTR;                1215 05497000
*                                                                  1215 05498000
         L     @15,ELTPTR                                          1215 05499000
         SL    @15,DATAPTR                                         1215 05500000
         ST    @15,ELTPTR                                          1215 05501000
*                            CALL MORSPACE;                        1216 05502000
*                                                                  1216 05503000
         BAL   @14,MORSPACE                                        1216 05504000
*                            ELTPTR=ELTPTR+DATAPTR;                1217 05505000
         L     @15,ELTPTR                                          1217 05506000
         AL    @15,DATAPTR                                         1217 05507000
         ST    @15,ELTPTR                                          1217 05508000
*                            END;                                  1218 05509000
*                        END;                                      1219 05510000
@RF01213 DS    0H                                                  1220 05511000
*                IF CHSTRING=YES & UNITINDX > MAXLNGTH             1220 05512000
*                  THEN                                            1220 05513000
*                                                                  1220 05514000
@RC01206 DS    0H                                                  1220 05515000
@RC01204 TM    CHSTRING,B'10000000'                                1220 05516000
         BNO   @RF01220                                            1220 05517000
         LA    @15,12                                              1220 05518000
         LR    @14,@15                                             1220 05519000
         MH    @14,PARMID                                          1220 05520000
         L     @01,WORKPTR                                         1220 05521000
         AL    @01,@CF01317                                        1220 05522000
         AL    @15,PARMPTR(@14,@01)                                1220 05523000
         LH    @14,UNITINDX                                        1220 05524000
         MVC   @ZT00003+3(1),MAXLNGTH(@15)                         1220 05525000
         C     @14,@ZT00003                                        1220 05526000
         BNH   @RF01220                                            1220 05527000
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1221 05528000
*                                ADDR(ERRFIELD));                  1221 05529000
*                                                                  1221 05530000
         MVC   @AL00001(8),@AL01221                                1221 05531000
         LA    @15,ERRFIELD                                        1221 05532000
         ST    @15,@AFTEMPS+32                                     1221 05533000
         LA    @15,@AFTEMPS+32                                     1221 05534000
         ST    @15,@AL00001+8                                      1221 05535000
         LA    @01,@AL00001                                        1221 05536000
         BAL   @14,ERROR2                                          1221 05537000
*                IF RISTATUS=0                                     1222 05538000
*                                                                  1222 05539000
*                  /**************************************************/ 05540000
*                  /*                                                */ 05541000
*                  /* STORE THE SCALAR INTO THE PROPER DATA STRUCTURE*/ 05542000
*                  /* TOGETHER WITH THE OTHER SCALARS OF THE LIST.   */ 05543000
*                  /*                                                */ 05544000
*                  /**************************************************/ 05545000
*                  THEN                                            1222 05546000
@RF01220 LH    @15,RISTATUS                                        1222 05547000
         LTR   @15,@15                                             1222 05548000
         BNZ   @RF01222                                            1222 05549000
*                    IF CHSTRING=YES                               1223 05550000
*                                                                  1223 05551000
*                      /**********************************************/ 05552000
*                      /*                                            */ 05553000
*                      /* WHEN THE SCALAR IS IN CHARACTER STRING FORM*/ 05554000
*                      /*  STORE IT INTO THE FDT IN THE FORM OF A    */ 05555000
*                      /*  STRING OR A CHAR. STRING WITH PASSWORD    */ 05556000
*                      /*                                            */ 05557000
*                      /**********************************************/ 05558000
*                      THEN                                        1223 05559000
         TM    CHSTRING,B'10000000'                                1223 05560000
         BNO   @RF01223                                            1223 05561000
*DOGRP85:                DO;                                       1224 05562000
DOGRP85  DS    0H                                                  1225 05563000
*                        IF PWORDOPT=YES                           1225 05564000
*                          THEN                                    1225 05565000
         LA    @15,12                                              1225 05566000
         LR    @14,@15                                             1225 05567000
         MH    @14,PARMID                                          1225 05568000
         L     @01,WORKPTR                                         1225 05569000
         AL    @01,@CF01317                                        1225 05570000
         AL    @15,PARMPTR(@14,@01)                                1225 05571000
         TM    PWORDOPT(@15),B'00000010'                           1225 05572000
         BNO   @RF01225                                            1225 05573000
*                            DO;                                   1226 05574000
*                            CHARCT=SCLRCNT;                       1227 05575000
         L     @01,DATAPTR                                         1227 05576000
         MVC   CHARCT(2,@01),SCLRCNT                               1227 05577000
*                            ELTPTR->LCHARLN=UNITINDX;             1228 05578000
         L     @14,ELTPTR                                          1228 05579000
         MVC   LCHARLN(1,@14),UNITINDX+1                           1228 05580000
*                            ELTPTR->LCHAR(1:MAXLNGTH)=            1229 05581000
*                                                 SYNUNIT;         1229 05582000
         SLR   @05,@05                                             1229 05583000
         IC    @05,MAXLNGTH(,@15)                                  1229 05584000
         BCTR  @05,0                                               1229 05585000
         EX    @05,@SM01345                                        1229 05586000
*                            END;                                  1230 05587000
*                          ELSE                                    1231 05588000
*                            DO;                                   1231 05589000
         B     @RC01225                                            1231 05590000
@RF01225 DS    0H                                                  1232 05591000
*                            STRINGCT=SCLRCNT;                     1232 05592000
         L     @01,DATAPTR                                         1232 05593000
         MVC   STRINGCT(2,@01),SCLRCNT                             1232 05594000
*                            ELTPTR->LSTRINGL=UNITINDX;            1233 05595000
         L     @15,ELTPTR                                          1233 05596000
         MVC   LSTRINGL(1,@15),UNITINDX+1                          1233 05597000
*                            ELTPTR->LSTRING(1:MAXLNGTH)=          1234 05598000
*                                                 SYNUNIT;         1234 05599000
         LA    @14,12                                              1234 05600000
         LR    @05,@14                                             1234 05601000
         MH    @05,PARMID                                          1234 05602000
         L     @01,WORKPTR                                         1234 05603000
         AL    @01,@CF01317                                        1234 05604000
         AL    @14,PARMPTR(@05,@01)                                1234 05605000
         SLR   @05,@05                                             1234 05606000
         IC    @05,MAXLNGTH(,@14)                                  1234 05607000
         BCTR  @05,0                                               1234 05608000
         EX    @05,@SM01347                                        1234 05609000
*                            END;                                  1235 05610000
*                        /********************************************/ 05611000
*                        /*                                          */ 05612000
*                        /* IF NO PASSWORD FOLLOWS THIS SCALAR, THEN */ 05613000
*                        /* POINT TO WHERE THE NEXT SCALAR LIST      */ 05614000
*                        /* ELEMENT WILL BE PLACED IN THE FDT.       */ 05615000
*                        /*                                          */ 05616000
*                        /********************************************/ 05617000
*                        IF PWORD ^= NEXT                          1236 05618000
*                          THEN                                    1236 05619000
@RC01225 CLC   PWORD(2),@CH00172                                   1236 05620000
         BE    @RF01236                                            1236 05621000
*                            ELTPTR=ELTPTR+SPACEAMT;               1237 05622000
         LH    @15,SPACEAMT                                        1237 05623000
         AL    @15,ELTPTR                                          1237 05624000
         ST    @15,ELTPTR                                          1237 05625000
*                        END DOGRP85;                              1238 05626000
*                                                                  1238 05627000
*                      /**********************************************/ 05628000
*                      /*                                            */ 05629000
*                      /*  IF THE SCALAR IS A DECIMAL, HEXADECIMAL,  */ 05630000
*                      /*  OR BINARY CONSTANT, THEN PERFORM THE      */ 05631000
*                      /*  NECESSARY CONVERSION BEFORE STORING IT    */ 05632000
*                      /*  INTO THE FDT.                             */ 05633000
*                      /*                                            */ 05634000
*                      /**********************************************/ 05635000
*                      ELSE                                        1239 05636000
*                        IF NUMBER=YES | ANYSTRNG=YES              1239 05637000
*                          THEN                                    1239 05638000
*                                                                  1239 05639000
         B     @RC01223                                            1239 05640000
@RF01223 LA    @15,12                                              1239 05641000
         LR    @14,@15                                             1239 05642000
         MH    @14,PARMID                                          1239 05643000
         L     @01,WORKPTR                                         1239 05644000
         AL    @01,@CF01317                                        1239 05645000
         AL    @15,PARMPTR(@14,@01)                                1239 05646000
         TM    NUMBER(@15),B'11000000'                             1239 05647000
         BZ    @RF01239                                            1239 05648000
*                            CALL CONVERT;                         1240 05649000
*                                                                  1240 05650000
         BAL   @14,CONVERT                                         1240 05651000
*                          /******************************************/ 05652000
*                          /*                                        */ 05653000
*                          /*  WHEN NONE OF THE ABOVE, THE SCALAR IS */ 05654000
*                          /*  A DATA SET NAME AND IS STORED IN      */ 05655000
*                          /*  DSID FORM IN THE FDT.  THE NAME MUST  */ 05656000
*                          /*  CONFORM TO DSNAME RESTRICTIONS.       */ 05657000
*                          /*                                        */ 05658000
*                          /******************************************/ 05659000
*                          ELSE                                    1241 05660000
*                                                                  1241 05661000
*                            CALL DSICKHK;                         1241 05662000
*                                                                  1241 05663000
         B     @RC01239                                            1241 05664000
@RF01239 BAL   @14,DSICKHK                                         1241 05665000
*                END DOGRP80;                                      1242 05666000
*                                                                  1242 05667000
*              /******************************************************/ 05668000
*              /*                                                    */ 05669000
*              /*  WHEN THE EXTRACTED SCALAR IS A PASSWORD ATTACHED  */ 05670000
*              /*  TO A SCALAR LIST ELEMENT, STORE IT IN THE DATA    */ 05671000
*              /*  AREA OF THE APPROPRIATE CHAR. STRING OR DSNAME    */ 05672000
*              /*                                                    */ 05673000
*              /******************************************************/ 05674000
*              ELSE                                                1243 05675000
*                DO;                                               1243 05676000
         B     @RC01201                                            1243 05677000
@RF01201 DS    0H                                                  1244 05678000
*                PWORD=NONE;                                       1244 05679000
         SLR   @15,@15                                             1244 05680000
         STH   @15,PWORD                                           1244 05681000
*                IF UNITINDX > LENGTH(PASSWORD)                    1245 05682000
*                  THEN                                            1245 05683000
*                                                                  1245 05684000
         LH    @15,UNITINDX                                        1245 05685000
         CH    @15,@CH00042                                        1245 05686000
         BNH   @RF01245                                            1245 05687000
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1246 05688000
*                                ADDR(ERRFIELD));                  1246 05689000
*                                                                  1246 05690000
         MVC   @AL00001(8),@AL01246                                1246 05691000
         LA    @15,ERRFIELD                                        1246 05692000
         ST    @15,@AFTEMPS+32                                     1246 05693000
         LA    @15,@AFTEMPS+32                                     1246 05694000
         ST    @15,@AL00001+8                                      1246 05695000
         LA    @01,@AL00001                                        1246 05696000
         BAL   @14,ERROR2                                          1246 05697000
*                  ELSE                                            1247 05698000
*                    IF ANYSTRNG=YES                               1247 05699000
*                      THEN                                        1247 05700000
         B     @RC01245                                            1247 05701000
@RF01245 LA    @15,12                                              1247 05702000
         LR    @14,@15                                             1247 05703000
         MH    @14,PARMID                                          1247 05704000
         L     @01,WORKPTR                                         1247 05705000
         AL    @01,@CF01317                                        1247 05706000
         AL    @15,PARMPTR(@14,@01)                                1247 05707000
         TM    ANYSTRNG(@15),B'01000000'                           1247 05708000
         BNO   @RF01247                                            1247 05709000
*                        DO;                                       1248 05710000
*                        ELTPTR->LCHRPWDL=UNITINDX;                1249 05711000
         L     @15,ELTPTR                                          1249 05712000
         MVC   LCHRPWDL(1,@15),UNITINDX+1                          1249 05713000
*                        ELTPTR->LCHRPWD=SYNUNIT;                  1250 05714000
         MVC   LCHRPWD(8,@15),SYNUNIT                              1250 05715000
*                        ELTPTR=ELTPTR+SPACEAMT;                   1251 05716000
         AH    @15,SPACEAMT                                        1251 05717000
         ST    @15,ELTPTR                                          1251 05718000
*                        END;                                      1252 05719000
*                      ELSE                                        1253 05720000
*                        DO;                                       1253 05721000
         B     @RC01247                                            1253 05722000
@RF01247 DS    0H                                                  1254 05723000
*                        LDSNPWDL(SCLRCNT)=UNITINDX;               1254 05724000
         L     @15,DATAPTR                                         1254 05725000
         LH    @14,SCLRCNT                                         1254 05726000
         MH    @14,@CH01296                                        1254 05727000
         LH    @05,UNITINDX                                        1254 05728000
         LA    @04,0(@14,@15)                                      1254 05729000
         AL    @04,@CF01349                                        1254 05730000
         STC   @05,LDSNPWDL-2(,@04)                                1254 05731000
*                        LDSNPWD(SCLRCNT)=SYNUNIT;                 1255 05732000
         ALR   @15,@14                                             1255 05733000
         AL    @15,@CF01350                                        1255 05734000
         MVC   LDSNPWD-3(8,@15),SYNUNIT                            1255 05735000
*                        END;                                      1256 05736000
*                END;                                              1257 05737000
*/********************************************************************/ 05738000
*/*                                                                  */ 05739000
*/*  PROCEDURE NAME - CONVERT                                        */ 05740000
*/*                                                                  */ 05741000
*/*  FUNCTION - THIS ROUTINE CONVERTS DECIMAL, BINARY, OR HEXADECIMAL*/ 05742000
*/*             CONSTANTS FROM EBCDIC FORM INTO THE PROPER INTERNAL  */ 05743000
*/*             FORM (FULLWORD BINARY OR HEXIDECIMAL DIGIT STRING,   */ 05744000
*/*             BASED UPON THE COMMAND DESCRIPTOR SPECIFICATION).    */ 05745000
*/*             THE CONSTANTS ARE CHECKED TO INSURE THAT THEY ARE    */ 05746000
*/*             SYNTACTICALLY AND SEMANTICALLY CORRECT AND ARE THEN  */ 05747000
*/*             PLACED INTO THE FDT IN CONVERTED FORM.               */ 05748000
*/*                                                                  */ 05749000
*/*  INPUT -                                                         */ 05750000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 05751000
*/*          SYNUNIT - CONTAINS THE CONSTANT IN EBCDIC FORM WHICH IS */ 05752000
*/*                    TO BE CONVERTED.                              */ 05753000
*/*          UNITINDX- LENGTH OF EBCDIC CONSTANT                     */ 05754000
*/*          ORGSIGN - CONTAINS CODE INDICATING FORM IN WHICH THE    */ 05755000
*/*                    SCALAR WAS INPUT (AS A HEX, BINARY OR DECIMAL */ 05756000
*/*                    CONSTANT).                                    */ 05757000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 05758000
*/*                    VALUE WHEN AN ERROR HAS BEEN DETECTED         */ 05759000
*/*                                                                  */ 05760000
*/*  OUTPUT -                                                        */ 05761000
*/*          FUNCTION DATA TABLE DATA ENTRIES.                       */ 05762000
*/*          SYNUNIT - CONSTANT IN CONVERTED FORM                    */ 05763000
*/*          CNVRTFLD- CONSTANT IN BINARY FULLWORD CONVERTED FORM    */ 05764000
*/*                                                                  */ 05765000
*/********************************************************************/ 05766000
*CONVERT:PROCEDURE;                                                1258 05767000
         B     @PB00015                                            1258 05768000
CONVERT  STM   @14,@12,@SA00015                                    1258 05769000
*        /************************************************************/ 05770000
*        /*                                                          */ 05771000
*        /* DATA DEFINITIONS FOR CONVERT ROUTINE                     */ 05772000
*        /*                                                          */ 05773000
*        /************************************************************/ 05774000
*                                                                  1259 05775000
*        DCL HEXTABLE(16) CHAR(1)      /*HEX DIGITS IN EBCDIC FORM   */ 05776000
*                         INIT('0','1','2','3','4','5','6','7',    1259 05777000
*                              '8','9','A','B','C','D','E','F');   1259 05778000
*        DCL WORKVAL  FIXED(31);       /*FULLWORD WORK AREA USED   1260 05779000
*                                        DURING CONVERSION           */ 05780000
*        DCL TWOPOWER FIXED(15);       /*COMPUTED POWER OF 2         */ 05781000
*        DCL CNVRTVAL FIXED(8);        /*1-BYTE WORK AREA USED     1262 05782000
*                                        DURING CONVERSION           */ 05783000
*        DCL DIGTINDX FIXED(15);       /*INDEX INDICATING CURRENT  1263 05784000
*                                        LENGTH OF CONVERTED PORTION    05785000
*                                        OF CONSTANT BEING CONVERTED */ 05786000
*                                                                  1263 05787000
*        DCL ZEROHALF BIT(8)           /*BIT MASK USED TO SET UPPER  */ 05788000
*                CONSTANT('00001111'B);/* HALF OF A BYTE TO ZEROES   */ 05789000
*        /************************************************************/ 05790000
*        /*                                                          */ 05791000
*        /*  ** CONVERT **  CONVERT DIGIT STRINGS TO INTERNAL FORM   */ 05792000
*        /*                                                          */ 05793000
*        /************************************************************/ 05794000
*        IF GDTDBG = NULLPTR                                       1265 05795000
*          THEN;                                                   1265 05796000
         L     @01,GDTPTR                                          1265 05797000
         L     @15,GDTDBG(,@01)                                    1265 05798000
         LTR   @15,@15                                             1265 05799000
         BZ    @RT01265                                            1265 05800000
*          ELSE                                                    1267 05801000
*            CALL ICKDB010(GDTTBL,'RICV');                         1267 05802000
*                                                                  1267 05803000
         L     @15,GDTPTR                                          1267 05804000
         ST    @15,@AL00001                                        1267 05805000
         LA    @14,@CC01062                                        1267 05806000
         ST    @14,@AL00001+4                                      1267 05807000
         MVI   @AL00001+4,X'80'                                    1267 05808000
         L     @15,GDTDBG(,@15)                                    1267 05809000
         LA    @01,@AL00001                                        1267 05810000
         BALR  @14,@15                                             1267 05811000
*        /************************************************************/ 05812000
*        /*                                                          */ 05813000
*        /* IF THE INPUT DIGIT STRING IS A DECIMAL NUMBER, CONVERT   */ 05814000
*        /* IT TO A BINARY FULLWORD.                                 */ 05815000
*        /*                                                          */ 05816000
*        /************************************************************/ 05817000
*        IF ORGSIGN=BLANK                                          1268 05818000
*          THEN                                                    1268 05819000
*                                                                  1268 05820000
@RT01265 CLI   ORGSIGN,C' '                                        1268 05821000
         BNE   @RF01268                                            1268 05822000
*            CALL PACKCVB;                                         1269 05823000
*                                                                  1269 05824000
         BAL   @14,PACKCVB                                         1269 05825000
*          ELSE                                                    1270 05826000
*DOGRP90:    DO;                                                   1270 05827000
*                                                                  1270 05828000
         B     @RC01268                                            1270 05829000
@RF01268 DS    0H                                                  1270 05830000
DOGRP90  DS    0H                                                  1271 05831000
*            /********************************************************/ 05832000
*            /*                                                      */ 05833000
*            /* IF THE DIGIT STRING IS A BINARY CONSTANT, CONVERT IT */ 05834000
*            /* INTO A STRING OF HEXADECIMAL DIGITS (NO LONGER IN    */ 05835000
*            /* EBCDIC FORM).  BEFORE CONVERSION, CHECK ALL THE      */ 05836000
*            /* DIGITS IN THE CONSTANT TO BE SURE THEY ARE BINARY    */ 05837000
*            /* DIGITS, AND IF THE STRING IS A BINARY NUMBER, THEN   */ 05838000
*            /* CHECK THAT IT DOESN'T EXCEED THE BINARY FULLWORD     */ 05839000
*            /* SIZE LIMIT.                                          */ 05840000
*            /*                                                      */ 05841000
*            /********************************************************/ 05842000
*            IF ORGSIGN=BINSIGN                                    1271 05843000
*              THEN                                                1271 05844000
         CLI   ORGSIGN,C'B'                                        1271 05845000
         BNE   @RF01271                                            1271 05846000
*                IF NUMBER=YES & UNITINDX > 32                     1272 05847000
*                  THEN                                            1272 05848000
*                                                                  1272 05849000
         LA    @15,12                                              1272 05850000
         LR    @14,@15                                             1272 05851000
         MH    @14,PARMID                                          1272 05852000
         L     @01,WORKPTR                                         1272 05853000
         AL    @01,@CF01317                                        1272 05854000
         AL    @15,PARMPTR(@14,@01)                                1272 05855000
         TM    NUMBER(@15),B'10000000'                             1272 05856000
         BNO   @RF01272                                            1272 05857000
         LH    @15,UNITINDX                                        1272 05858000
         CH    @15,@CH00218                                        1272 05859000
         BNH   @RF01272                                            1272 05860000
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1273 05861000
*                                ADDR(ERRFIELD));                  1273 05862000
*                                                                  1273 05863000
         MVC   @AL00001(8),@AL01273                                1273 05864000
         LA    @15,ERRFIELD                                        1273 05865000
         ST    @15,@AFTEMPS+24                                     1273 05866000
         LA    @15,@AFTEMPS+24                                     1273 05867000
         ST    @15,@AL00001+8                                      1273 05868000
         LA    @01,@AL00001                                        1273 05869000
         BAL   @14,ERROR2                                          1273 05870000
*                  ELSE                                            1274 05871000
*DOGRP95:            DO;                                           1274 05872000
         B     @RC01272                                            1274 05873000
@RF01272 DS    0H                                                  1274 05874000
DOGRP95  DS    0H                                                  1275 05875000
*                      OLDERID2 = NEWERID2;                        1275 05876000
         L     @01,GDTPTR                                          1275 05877000
         L     @15,GDTTR2(,@01)                                    1275 05878000
         MVC   @TS00001(95),NEWERID2(@15)                          1275 05879000
         MVC   OLDERID2(95,@15),@TS00001                           1275 05880000
*                      NEWID2='RI24';                              1276 05881000
*                                                                  1276 05882000
         MVC   NEWID2(4,@15),@CC01067                              1276 05883000
*                      /**********************************************/ 05884000
*                      /*                                            */ 05885000
*                      /* CHECK THE DIGITS ONE AT A TIME; IF A DIGIT */ 05886000
*                      /* IS A 1 OR 0 (X'F1' OR X'F0' IN EBCDIC) THEN*/ 05887000
*                      /* SET THE HIGHER ORDER 4 BITS TO ZEROES.     */ 05888000
*                      /*                                            */ 05889000
*                      /**********************************************/ 05890000
*                      DO INDEX=1 TO UNITINDX WHILE(RISTATUS=0);   1277 05891000
         LA    @15,1                                               1277 05892000
         B     @DE01277                                            1277 05893000
@DL01277 LH    @14,RISTATUS                                        1277 05894000
         LTR   @14,@14                                             1277 05895000
         BNZ   @DC01277                                            1277 05896000
*                        IF SYNUNIT(INDEX) ^= '1'  &               1278 05897000
*                           SYNUNIT(INDEX) ^= '0'                  1278 05898000
*                          THEN                                    1278 05899000
*                                                                  1278 05900000
         LA    @14,SYNUNIT-1(@15)                                  1278 05901000
         CLI   0(@14),C'1'                                         1278 05902000
         BE    @RF01278                                            1278 05903000
         LA    @14,SYNUNIT-1(@15)                                  1278 05904000
         CLI   0(@14),C'0'                                         1278 05905000
         BE    @RF01278                                            1278 05906000
*                            CALL ERROR2(BADDIGIT,LENGTH(ERRFIELD),     05907000
*                                        ADDR(ERRFIELD));          1279 05908000
*                                                                  1279 05909000
         MVC   @AL00001(8),@AL01279                                1279 05910000
         LA    @15,ERRFIELD                                        1279 05911000
         ST    @15,@AFTEMPS+24                                     1279 05912000
         LA    @15,@AFTEMPS+24                                     1279 05913000
         ST    @15,@AL00001+8                                      1279 05914000
         LA    @01,@AL00001                                        1279 05915000
         BAL   @14,ERROR2                                          1279 05916000
*                          ELSE                                    1280 05917000
*                            SYNUNIT(INDEX)=SYNUNIT(INDEX) & ZEROHALF;  05918000
         B     @RC01278                                            1280 05919000
@RF01278 LH    @01,INDEX                                           1280 05920000
         LA    @15,SYNUNIT-1(@01)                                  1280 05921000
         NI    0(@15),B'00001111'                                  1280 05922000
*                      END;                                        1281 05923000
@RC01278 LA    @15,1                                               1281 05924000
         AH    @15,INDEX                                           1281 05925000
@DE01277 STH   @15,INDEX                                           1281 05926000
         CH    @15,UNITINDX                                        1281 05927000
         BNH   @DL01277                                            1281 05928000
@DC01277 DS    0H                                                  1282 05929000
*                    IF RISTATUS=0                                 1282 05930000
*                      THEN                                        1282 05931000
*                                                                  1282 05932000
         LH    @15,RISTATUS                                        1282 05933000
         LTR   @15,@15                                             1282 05934000
         BNZ   @RF01282                                            1282 05935000
*                        /********************************************/ 05936000
*                        /*                                          */ 05937000
*                        /* CONVERT THE MODIFIED STRING INTO A HEX   */ 05938000
*                        /* DIGIT STRING INTERNALLY BY CONVERTING A  */ 05939000
*                        /* EACH BYTE'S WORTH OF BINARY DIGITS INTO A*/ 05940000
*                        /* VALUE BETWEEN 0 AND 255 (MULTIPLY THE    */ 05941000
*                        /* BINARY DIGITS BY POWERS OF 2 INCREASING  */ 05942000
*                        /* LOW ORDER TO HIGH ORDER).  STORE THE     */ 05943000
*                        /* STRING OF 1-BYTE VALUES BACK INTO THE    */ 05944000
*                        /* SAME WORK AREA THAT CONTAINS THE MODIFIED*/ 05945000
*                        /* DIGIT STRING.                            */ 05946000
*                        /*                                          */ 05947000
*                        /********************************************/ 05948000
*DOGRP100:               DO;                                       1283 05949000
DOGRP100 DS    0H                                                  1284 05950000
*                        WORKVAL=UNITINDX//8;                      1284 05951000
         LH    @00,UNITINDX                                        1284 05952000
         SRDA  @00,32                                              1284 05953000
         D     @00,@CF00042                                        1284 05954000
         ST    @00,WORKVAL                                         1284 05955000
*                        DIGTINDX=0;                               1285 05956000
*                                                                  1285 05957000
         SLR   @01,@01                                             1285 05958000
         STH   @01,DIGTINDX                                        1285 05959000
*                        /********************************************/ 05960000
*                        /*                                          */ 05961000
*                        /* IF THE NUMBER OF DIGITS IN THE STRING IS */ 05962000
*                        /* NOT A MULTIPLE OF 8, FIRST CONVERT JUST  */ 05963000
*                        /* THE ODD NUMBER OF DIGITS INTO A VALUE    */ 05964000
*                        /* BETWEEN 0 AND 255.                       */ 05965000
*                        /*                                          */ 05966000
*                        /********************************************/ 05967000
*                        IF WORKVAL ^= 0                           1286 05968000
*                          THEN                                    1286 05969000
         CR    @00,@01                                             1286 05970000
         BE    @RF01286                                            1286 05971000
*                            DO;                                   1287 05972000
*                              CNVRTVAL=0;                         1288 05973000
         MVI   CNVRTVAL,X'00'                                      1288 05974000
*                              TWOPOWER=1;                         1289 05975000
         MVC   TWOPOWER(2),@CH00172                                1289 05976000
*                              DO INDEX2=WORKVAL TO 1 BY -1;       1290 05977000
         STH   @00,INDEX2                                          1290 05978000
         B     @DE01290                                            1290 05979000
@DL01290 DS    0H                                                  1291 05980000
*                                CNVRTVAL=CNVRTVAL+                1291 05981000
*                                         DIGITVAL(INDEX2)*TWOPOWER;    05982000
         LH    @01,TWOPOWER                                        1291 05983000
         LR    @15,@00                                             1291 05984000
         SLR   @03,@03                                             1291 05985000
         IC    @03,DIGITVAL-1(@15)                                 1291 05986000
         MR    @02,@01                                             1291 05987000
         MVC   @ZT00003+3(1),CNVRTVAL                              1291 05988000
         AL    @03,@ZT00003                                        1291 05989000
         STC   @03,CNVRTVAL                                        1291 05990000
*                                TWOPOWER=TWOPOWER*2;              1292 05991000
         ALR   @01,@01                                             1292 05992000
         STH   @01,TWOPOWER                                        1292 05993000
*                              END;                                1293 05994000
         BCTR  @00,0                                               1293 05995000
         STH   @00,INDEX2                                          1293 05996000
@DE01290 LTR   @00,@00                                             1293 05997000
         BP    @DL01290                                            1293 05998000
*                              DIGITVAL(1)=CNVRTVAL;               1294 05999000
         MVC   DIGITVAL(1),CNVRTVAL                                1294 06000000
*                              DIGTINDX=1;                         1295 06001000
         MVC   DIGTINDX(2),@CH00172                                1295 06002000
*                            END;                                  1296 06003000
*                                                                  1296 06004000
*                        /********************************************/ 06005000
*                        /*                                          */ 06006000
*                        /* CONVERT EACH GROUP OF 8 BINARY DIGITS    */ 06007000
*                        /* INTO A ONE-BYTE VALUE, CREATING A STRING */ 06008000
*                        /* OF THESE VALUES.                         */ 06009000
*                        /*                                          */ 06010000
*                        /********************************************/ 06011000
*                        DO INDEX=WORKVAL+1 TO UNITINDX BY 8;      1297 06012000
@RF01286 LA    @15,1                                               1297 06013000
         AL    @15,WORKVAL                                         1297 06014000
         STH   @15,INDEX                                           1297 06015000
         B     @DE01297                                            1297 06016000
@DL01297 DS    0H                                                  1298 06017000
*                          CNVRTVAL=0;                             1298 06018000
         MVI   CNVRTVAL,X'00'                                      1298 06019000
*                          TWOPOWER=1;                             1299 06020000
         MVC   TWOPOWER(2),@CH00172                                1299 06021000
*                          DO INDEX2=INDEX+7 TO INDEX BY -1;       1300 06022000
         AH    @15,@CH00043                                        1300 06023000
         STH   @15,INDEX2                                          1300 06024000
         B     @DE01300                                            1300 06025000
@DL01300 DS    0H                                                  1301 06026000
*                            CNVRTVAL=CNVRTVAL+                    1301 06027000
*                                     DIGITVAL(INDEX2)*TWOPOWER;   1301 06028000
         LH    @14,TWOPOWER                                        1301 06029000
         SLR   @01,@01                                             1301 06030000
         IC    @01,DIGITVAL-1(@15)                                 1301 06031000
         MR    @00,@14                                             1301 06032000
         MVC   @ZT00003+3(1),CNVRTVAL                              1301 06033000
         AL    @01,@ZT00003                                        1301 06034000
         STC   @01,CNVRTVAL                                        1301 06035000
*                            TWOPOWER=TWOPOWER*2;                  1302 06036000
         ALR   @14,@14                                             1302 06037000
         STH   @14,TWOPOWER                                        1302 06038000
*                          END;                                    1303 06039000
         BCTR  @15,0                                               1303 06040000
         STH   @15,INDEX2                                          1303 06041000
@DE01300 CH    @15,INDEX                                           1303 06042000
         BNL   @DL01300                                            1303 06043000
*                          DIGTINDX=DIGTINDX+1;                    1304 06044000
         LA    @15,1                                               1304 06045000
         AH    @15,DIGTINDX                                        1304 06046000
         STH   @15,DIGTINDX                                        1304 06047000
*                          DIGITVAL(DIGTINDX)=CNVRTVAL;            1305 06048000
         SLR   @14,@14                                             1305 06049000
         IC    @14,CNVRTVAL                                        1305 06050000
         STC   @14,DIGITVAL-1(@15)                                 1305 06051000
*                        END;                                      1306 06052000
         LA    @15,8                                               1306 06053000
         AH    @15,INDEX                                           1306 06054000
         STH   @15,INDEX                                           1306 06055000
@DE01297 CH    @15,UNITINDX                                        1306 06056000
         BNH   @DL01297                                            1306 06057000
*                        END DOGRP100;                             1307 06058000
*                    END DOGRP95;                                  1308 06059000
*                                                                  1308 06060000
*                /****************************************************/ 06061000
*                /*                                                  */ 06062000
*                /* IF THE INPUT IS NOT A DECIMAL OR BINARY CONSTANT */ 06063000
*                /* THEN IT MUST BE A HEXADECIMAL CONSTANT.          */ 06064000
*                /*                                                  */ 06065000
*                /****************************************************/ 06066000
*                ELSE                                              1309 06067000
*                                                                  1309 06068000
*                  /**************************************************/ 06069000
*                  /*                                                */ 06070000
*                  /* IF THE HEXADECIMAL CONSTANT IS A HEXADECIMAL   */ 06071000
*                  /* NUMBER, AND IT EXCEEDS THE SIZE THAT WOULD     */ 06072000
*                  /* FIT INTO A BINARY FULLWORD AFTER CONVERSION,   */ 06073000
*                  /* THEN IT IS AN ERROR.  OTHERWISE, TAKE THE HEX  */ 06074000
*                  /* DIGITS (IN EBCDIC FORM) TWO AT A TIME AND      */ 06075000
*                  /* CONVERT EACH INTO A ONE-BYTE VALUE BETWEEN 0   */ 06076000
*                  /* AND 255 USING A CONVERSION TABLE.  CREATE A    */ 06077000
*                  /* STRING OF THESE 1-BYTE VALUES, WHICH WILL THEN */ 06078000
*                  /* BE A REPRESENTATION OF THE INPUT VALUE, STORING*/ 06079000
*                  /* THIS STRING BACK WHERE THE EBCDIC DIGITS WERE. */ 06080000
*                  /*                                                */ 06081000
*                  /**************************************************/ 06082000
*                  IF NUMBER=YES & UNITINDX > 8                    1309 06083000
*                    THEN                                          1309 06084000
*                                                                  1309 06085000
         B     @RC01271                                            1309 06086000
@RF01271 LA    @15,12                                              1309 06087000
         LR    @14,@15                                             1309 06088000
         MH    @14,PARMID                                          1309 06089000
         L     @01,WORKPTR                                         1309 06090000
         AL    @01,@CF01317                                        1309 06091000
         AL    @15,PARMPTR(@14,@01)                                1309 06092000
         TM    NUMBER(@15),B'10000000'                             1309 06093000
         BNO   @RF01309                                            1309 06094000
         LH    @15,UNITINDX                                        1309 06095000
         CH    @15,@CH00042                                        1309 06096000
         BNH   @RF01309                                            1309 06097000
*                      CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),      1310 06098000
*                                  ADDR(ERRFIELD));                1310 06099000
*                                                                  1310 06100000
         MVC   @AL00001(8),@AL01310                                1310 06101000
         LA    @15,ERRFIELD                                        1310 06102000
         ST    @15,@AFTEMPS+24                                     1310 06103000
         LA    @15,@AFTEMPS+24                                     1310 06104000
         ST    @15,@AL00001+8                                      1310 06105000
         LA    @01,@AL00001                                        1310 06106000
         BAL   @14,ERROR2                                          1310 06107000
*                    ELSE                                          1311 06108000
*DOGRP105:             DO;                                         1311 06109000
         B     @RC01309                                            1311 06110000
@RF01309 DS    0H                                                  1311 06111000
DOGRP105 DS    0H                                                  1312 06112000
*                        OLDERID2 = NEWERID2;                      1312 06113000
         L     @01,GDTPTR                                          1312 06114000
         L     @15,GDTTR2(,@01)                                    1312 06115000
         MVC   @TS00001(95),NEWERID2(@15)                          1312 06116000
         MVC   OLDERID2(95,@15),@TS00001                           1312 06117000
*                        NEWID2='RI27';                            1313 06118000
         MVC   NEWID2(4,@15),@CC01073                              1313 06119000
*                        DIGTINDX=0;                               1314 06120000
*                                                                  1314 06121000
         SLR   @15,@15                                             1314 06122000
         STH   @15,DIGTINDX                                        1314 06123000
*                        /********************************************/ 06124000
*                        /*                                          */ 06125000
*                        /* IF THERE ARE AN ODD NUMBER OF HEX DIGITS */ 06126000
*                        /* IN THE HEX CONSTANT, FIRST CONVERT JUST  */ 06127000
*                        /* THE SINGLE, HIGH-ORDER DIGIT INTO A ONE- */ 06128000
*                        /* BYTE VALUE.                              */ 06129000
*                        /*                                          */ 06130000
*                        /********************************************/ 06131000
*                        IF UNITINDX//2 ^= 0                       1315 06132000
*                          THEN                                    1315 06133000
         LH    @00,UNITINDX                                        1315 06134000
         SRDA  @00,32                                              1315 06135000
         D     @00,@CF00124                                        1315 06136000
         CR    @00,@15                                             1315 06137000
         BE    @RF01315                                            1315 06138000
*                            DO;                                   1316 06139000
*                              FOUND=NO;                           1317 06140000
*                                                                  1317 06141000
         NI    FOUND,B'11011111'                                   1317 06142000
*                              /**************************************/ 06143000
*                              /*                                    */ 06144000
*                              /* MATCH THE HEX DIGIT AGAINST THE    */ 06145000
*                              /* CONVERSION TABLE TO OBTAIN THE     */ 06146000
*                              /* VALUE OF THE DIGIT.  IF NO MATCH   */ 06147000
*                              /* IS FOUND, AN INVALID HEX DIGIT HAS */ 06148000
*                              /* BEEN FOUND.                        */ 06149000
*                              /*                                    */ 06150000
*                              /**************************************/ 06151000
*                              DO LISTINDX=1 TO 16 WHILE(FOUND=NO);     06152000
         LA    @15,1                                               1318 06153000
         STH   @15,LISTINDX                                        1318 06154000
@DL01318 TM    FOUND,B'00100000'                                   1318 06155000
         BNZ   @DC01318                                            1318 06156000
*                                IF SYNUNIT(1)=HEXTABLE(LISTINDX)  1319 06157000
*                                  THEN                            1319 06158000
         LA    @14,HEXTABLE-1(@15)                                 1319 06159000
         CLC   SYNUNIT(1),0(@14)                                   1319 06160000
         BNE   @RF01319                                            1319 06161000
*                                    DO;                           1320 06162000
*                                    FOUND=YES;                    1321 06163000
         OI    FOUND,B'00100000'                                   1321 06164000
*                                    DIGTINDX=1;                   1322 06165000
         MVC   DIGTINDX(2),@CH00172                                1322 06166000
*                                    DIGITVAL(1)=LISTINDX-1;       1323 06167000
         BCTR  @15,0                                               1323 06168000
         STC   @15,DIGITVAL                                        1323 06169000
*                                    END;                          1324 06170000
*                              END;                                1325 06171000
@RF01319 LA    @15,1                                               1325 06172000
         AH    @15,LISTINDX                                        1325 06173000
         STH   @15,LISTINDX                                        1325 06174000
         CH    @15,@CH00274                                        1325 06175000
         BNH   @DL01318                                            1325 06176000
@DC01318 DS    0H                                                  1326 06177000
*                              IF FOUND=NO                         1326 06178000
*                                THEN                              1326 06179000
*                                                                  1326 06180000
         TM    FOUND,B'00100000'                                   1326 06181000
         BNZ   @RF01326                                            1326 06182000
*                                  CALL ERROR2(BADDIGIT,           1327 06183000
*                                              LENGTH(ERRFIELD),   1327 06184000
*                                              ADDR(ERRFIELD));    1327 06185000
*                                                                  1327 06186000
         MVC   @AL00001(8),@AL01327                                1327 06187000
         LA    @15,ERRFIELD                                        1327 06188000
         ST    @15,@AFTEMPS+24                                     1327 06189000
         LA    @15,@AFTEMPS+24                                     1327 06190000
         ST    @15,@AL00001+8                                      1327 06191000
         LA    @01,@AL00001                                        1327 06192000
         BAL   @14,ERROR2                                          1327 06193000
*                            END;                                  1328 06194000
*                                                                  1328 06195000
@RF01326 DS    0H                                                  1329 06196000
*                        /********************************************/ 06197000
*                        /*                                          */ 06198000
*                        /* TAKE THE REMAINING STRING OF HEX DIGITS  */ 06199000
*                        /* TWO AT A TIME, MATCHING EACH DIGIT OF A  */ 06200000
*                        /* PAIR AGAINST THE CONVERSION TABLE TO GET */ 06201000
*                        /* THE VALUE OF THE HEX DIGIT.  MULTIPLY THE*/ 06202000
*                        /* VALUE OF THE HIGHER ORDER DIGIT OF EACH  */ 06203000
*                        /* PAIR BY 16 AND ADD THIS TO THE VALUE OF  */ 06204000
*                        /* THE LOWER ORDER DIGIT TO OBTAIN THE ONE- */ 06205000
*                        /* BYTE VALUE BETWEEN 0 AND 255.            */ 06206000
*                        /*                                          */ 06207000
*                        /********************************************/ 06208000
*DOLOOP15:               DO INDEX=DIGTINDX+1 TO UNITINDX BY 2      1329 06209000
*                           WHILE(RISTATUS=0);                     1329 06210000
@RF01315 DS    0H                                                  1329 06211000
DOLOOP15 LA    @15,1                                               1329 06212000
         AH    @15,DIGTINDX                                        1329 06213000
         STH   @15,INDEX                                           1329 06214000
         B     @DE01329                                            1329 06215000
@DL01329 LH    @15,RISTATUS                                        1329 06216000
         LTR   @15,@15                                             1329 06217000
         BNZ   @DC01329                                            1329 06218000
*                          FOUND=NO;                               1330 06219000
         NI    FOUND,B'11011111'                                   1330 06220000
*                          DO LISTINDX=1 TO 16 WHILE(FOUND=NO);    1331 06221000
         LA    @15,1                                               1331 06222000
         STH   @15,LISTINDX                                        1331 06223000
@DL01331 TM    FOUND,B'00100000'                                   1331 06224000
         BNZ   @DC01331                                            1331 06225000
*                            IF SYNUNIT(INDEX)=HEXTABLE(LISTINDX)  1332 06226000
*                              THEN                                1332 06227000
         LH    @01,INDEX                                           1332 06228000
         LA    @14,SYNUNIT-1(@01)                                  1332 06229000
         LA    @01,HEXTABLE-1(@15)                                 1332 06230000
         CLC   0(1,@14),0(@01)                                     1332 06231000
         BNE   @RF01332                                            1332 06232000
*                                DO;                               1333 06233000
*                                FOUND=YES;                        1334 06234000
         OI    FOUND,B'00100000'                                   1334 06235000
*                                CNVRTVAL=16*(LISTINDX-1);         1335 06236000
         BCTR  @15,0                                               1335 06237000
         SLA   @15,4                                               1335 06238000
         STC   @15,CNVRTVAL                                        1335 06239000
*                                END;                              1336 06240000
*                          END;                                    1337 06241000
@RF01332 LA    @15,1                                               1337 06242000
         AH    @15,LISTINDX                                        1337 06243000
         STH   @15,LISTINDX                                        1337 06244000
         CH    @15,@CH00274                                        1337 06245000
         BNH   @DL01331                                            1337 06246000
@DC01331 DS    0H                                                  1338 06247000
*                          IF FOUND=NO                             1338 06248000
*                            THEN                                  1338 06249000
*                                                                  1338 06250000
         TM    FOUND,B'00100000'                                   1338 06251000
         BNZ   @RF01338                                            1338 06252000
*                              CALL ERROR2(BADDIGIT,LENGTH(ERRFIELD),   06253000
*                                          ADDR(ERRFIELD));        1339 06254000
*                                                                  1339 06255000
         MVC   @AL00001(8),@AL01339                                1339 06256000
         LA    @15,ERRFIELD                                        1339 06257000
         ST    @15,@AFTEMPS+24                                     1339 06258000
         LA    @15,@AFTEMPS+24                                     1339 06259000
         ST    @15,@AL00001+8                                      1339 06260000
         LA    @01,@AL00001                                        1339 06261000
         BAL   @14,ERROR2                                          1339 06262000
*                            ELSE                                  1340 06263000
*                                                                  1340 06264000
*                              /**************************************/ 06265000
*                              /*                                    */ 06266000
*                              /* IF THE HIGHER ORDER DIGIT OF THE   */ 06267000
*                              /* PAIR WAS CONVERTED OKAY, THEN      */ 06268000
*                              /* CONVERT THE LOWER ORDER DIGIT AND  */ 06269000
*                              /* COMBINE THE TWO INTO A VALUE.      */ 06270000
*                              /*                                    */ 06271000
*                              /**************************************/ 06272000
*                              DO;                                 1340 06273000
         B     @RC01338                                            1340 06274000
@RF01338 DS    0H                                                  1341 06275000
*                                FOUND=NO;                         1341 06276000
         NI    FOUND,B'11011111'                                   1341 06277000
*                                DO LISTINDX=1 TO 16 WHILE(FOUND=NO);   06278000
         LA    @15,1                                               1342 06279000
         STH   @15,LISTINDX                                        1342 06280000
@DL01342 TM    FOUND,B'00100000'                                   1342 06281000
         BNZ   @DC01342                                            1342 06282000
*                                  IF SYNUNIT(INDEX+1)=            1343 06283000
*                                      HEXTABLE(LISTINDX)          1343 06284000
*                                    THEN                          1343 06285000
         LH    @01,INDEX                                           1343 06286000
         LA    @14,SYNUNIT(@01)                                    1343 06287000
         LA    @01,HEXTABLE-1(@15)                                 1343 06288000
         CLC   0(1,@14),0(@01)                                     1343 06289000
         BNE   @RF01343                                            1343 06290000
*                                      DO;                         1344 06291000
*                                      FOUND=YES;                  1345 06292000
         OI    FOUND,B'00100000'                                   1345 06293000
*                                      DIGTINDX=DIGTINDX+1;        1346 06294000
         LA    @14,1                                               1346 06295000
         AH    @14,DIGTINDX                                        1346 06296000
         STH   @14,DIGTINDX                                        1346 06297000
*                                      DIGITVAL(DIGTINDX)=         1347 06298000
*                                        CNVRTVAL+LISTINDX-1;      1347 06299000
         MVC   @ZT00003+3(1),CNVRTVAL                              1347 06300000
         AL    @15,@ZT00003                                        1347 06301000
         BCTR  @15,0                                               1347 06302000
         STC   @15,DIGITVAL-1(@14)                                 1347 06303000
*                                      END;                        1348 06304000
*                                END;                              1349 06305000
@RF01343 LA    @15,1                                               1349 06306000
         AH    @15,LISTINDX                                        1349 06307000
         STH   @15,LISTINDX                                        1349 06308000
         CH    @15,@CH00274                                        1349 06309000
         BNH   @DL01342                                            1349 06310000
@DC01342 DS    0H                                                  1350 06311000
*                                IF FOUND=NO                       1350 06312000
*                                  THEN                            1350 06313000
*                                                                  1350 06314000
         TM    FOUND,B'00100000'                                   1350 06315000
         BNZ   @RF01350                                            1350 06316000
*                                    CALL ERROR2(BADDIGIT,         1351 06317000
*                                                LENGTH(ERRFIELD), 1351 06318000
*                                                ADDR(ERRFIELD));  1351 06319000
*                                                                  1351 06320000
         MVC   @AL00001(8),@AL01351                                1351 06321000
         LA    @15,ERRFIELD                                        1351 06322000
         ST    @15,@AFTEMPS+24                                     1351 06323000
         LA    @15,@AFTEMPS+24                                     1351 06324000
         ST    @15,@AL00001+8                                      1351 06325000
         LA    @01,@AL00001                                        1351 06326000
         BAL   @14,ERROR2                                          1351 06327000
*                              END;                                1352 06328000
@RF01350 DS    0H                                                  1353 06329000
*                        END DOLOOP15;                             1353 06330000
@RC01338 LA    @15,2                                               1353 06331000
         AH    @15,INDEX                                           1353 06332000
         STH   @15,INDEX                                           1353 06333000
@DE01329 CH    @15,UNITINDX                                        1353 06334000
         BNH   @DL01329                                            1353 06335000
@DC01329 DS    0H                                                  1354 06336000
*                      END DOGRP105;                               1354 06337000
*              IF RISTATUS=0                                       1355 06338000
*                THEN                                              1355 06339000
*                                                                  1355 06340000
@RC01309 DS    0H                                                  1355 06341000
@RC01271 LH    @15,RISTATUS                                        1355 06342000
         LTR   @15,@15                                             1355 06343000
         BNZ   @RF01355                                            1355 06344000
*                  /**************************************************/ 06345000
*                  /*                                                */ 06346000
*                  /* IF THE BINARY OR HEX CONSTANT JUST CONVERTED   */ 06347000
*                  /* IS A NUMBER, MOVE THE CONVERTED NUMBER (STRING */ 06348000
*                  /* OF 1-BYTE VALUES) INTO A BINARY FULLWORD.      */ 06349000
*                  /*                                                */ 06350000
*                  /**************************************************/ 06351000
*                  IF NUMBER=YES                                   1356 06352000
*                    THEN                                          1356 06353000
         LA    @15,12                                              1356 06354000
         LR    @14,@15                                             1356 06355000
         MH    @14,PARMID                                          1356 06356000
         L     @01,WORKPTR                                         1356 06357000
         AL    @01,@CF01317                                        1356 06358000
         AL    @15,PARMPTR(@14,@01)                                1356 06359000
         TM    NUMBER(@15),B'10000000'                             1356 06360000
         BNO   @RF01356                                            1356 06361000
*                      DO;                                         1357 06362000
*                      OLDERID2 = NEWERID2;                        1358 06363000
         L     @01,GDTPTR                                          1358 06364000
         L     @15,GDTTR2(,@01)                                    1358 06365000
         MVC   @TS00001(95),NEWERID2(@15)                          1358 06366000
         MVC   OLDERID2(95,@15),@TS00001                           1358 06367000
*                      NEWID2='RI30';                              1359 06368000
         MVC   NEWID2(4,@15),@CC01076                              1359 06369000
*                      CNVRTFLD=SYNUNIT(1:DIGTINDX);               1360 06370000
         MVI   CNVRTFLD+1,C' '                                     1360 06371000
         MVC   CNVRTFLD+2(8),CNVRTFLD+1                            1360 06372000
         LH    @15,DIGTINDX                                        1360 06373000
         LR    @14,@15                                             1360 06374000
         BCTR  @14,0                                               1360 06375000
         EX    @14,@SM01351                                        1360 06376000
*                      CNVRTWRD=''B;                               1361 06377000
         SLR   @14,@14                                             1361 06378000
         ST    @14,CNVRTWRD                                        1361 06379000
*                      SYNUNIT(LENGTH(CNVRTWRD)+1-DIGTINDX:        1362 06380000
*                              LENGTH(CNVRTWRD))=CNVRTFLD;         1362 06381000
         LCR   @15,@15                                             1362 06382000
         AH    @15,@CH00260                                        1362 06383000
         LA    @14,SYNUNIT-1(@15)                                  1362 06384000
         LCR   @15,@15                                             1362 06385000
         AL    @15,@CF00052                                        1362 06386000
         EX    @15,@SM01353                                        1362 06387000
*                      END;                                        1363 06388000
*            END DOGRP90;                                          1364 06389000
*                                                                  1364 06390000
@RF01356 DS    0H                                                  1364 06391000
@RF01355 DS    0H                                                  1365 06392000
*        /************************************************************/ 06393000
*        /*                                                          */ 06394000
*        /* IF CONVERSION HAS PROCEEDED OKAY TO THIS POINT, THEN     */ 06395000
*        /* PERFORM FINAL SEMANTIC CHECKING OF THE VALUES AND MOVE   */ 06396000
*        /* THEM INTO THE FUNCTION DATA TABLE.                       */ 06397000
*        /*                                                          */ 06398000
*        /************************************************************/ 06399000
*        IF RISTATUS=0                                             1365 06400000
*          THEN                                                    1365 06401000
*                                                                  1365 06402000
@RC01268 LH    @15,RISTATUS                                        1365 06403000
         LTR   @15,@15                                             1365 06404000
         BNZ   @RF01365                                            1365 06405000
*            /********************************************************/ 06406000
*            /*                                                      */ 06407000
*            /* CHECK THAT THE CONVERTED NUMBER DOES NOT EXCEED THE  */ 06408000
*            /* DESIGNATED VALUE LIMITS FOR THIS PARAMETER.          */ 06409000
*            /*                                                      */ 06410000
*            /********************************************************/ 06411000
*            IF NUMBER=YES                                         1366 06412000
*              THEN                                                1366 06413000
         LA    @15,12                                              1366 06414000
         LR    @14,@15                                             1366 06415000
         MH    @14,PARMID                                          1366 06416000
         L     @01,WORKPTR                                         1366 06417000
         AL    @01,@CF01317                                        1366 06418000
         AL    @15,PARMPTR(@14,@01)                                1366 06419000
         TM    NUMBER(@15),B'10000000'                             1366 06420000
         BNO   @RF01366                                            1366 06421000
*                IF CNVRTWRD > HIVALUE  |  CNVRTWRD < LOWVALUE     1367 06422000
*                  THEN                                            1367 06423000
*                                                                  1367 06424000
         L     @14,CNVRTWRD                                        1367 06425000
         C     @14,HIVALUE(,@15)                                   1367 06426000
         BH    @RT01367                                            1367 06427000
         C     @14,LOWVALUE(,@15)                                  1367 06428000
         BNL   @RF01367                                            1367 06429000
@RT01367 DS    0H                                                  1368 06430000
*                    CALL ERROR2(BADNUMSZ,LENGTH(ERRFIELD),        1368 06431000
*                                ADDR(ERRFIELD));                  1368 06432000
*                                                                  1368 06433000
         MVC   @AL00001(8),@AL01368                                1368 06434000
         LA    @15,ERRFIELD                                        1368 06435000
         ST    @15,@AFTEMPS+24                                     1368 06436000
         LA    @15,@AFTEMPS+24                                     1368 06437000
         ST    @15,@AL00001+8                                      1368 06438000
         LA    @01,@AL00001                                        1368 06439000
         BAL   @14,ERROR2                                          1368 06440000
*                  ELSE                                            1369 06441000
*                    IF SCALAR=YES                                 1369 06442000
*                      THEN                                        1369 06443000
         B     @RC01367                                            1369 06444000
@RF01367 LH    @15,PARMID                                          1369 06445000
         MH    @15,@CH00038                                        1369 06446000
         L     @01,WORKPTR                                         1369 06447000
         AL    @01,@CF01317                                        1369 06448000
         L     @01,PARMPTR(@15,@01)                                1369 06449000
         TM    SCALAR(@01),B'00010000'                             1369 06450000
         BNO   @RF01369                                            1369 06451000
*                        FULLWORD=CNVRTWRD;                        1370 06452000
         L     @01,DATAPTR                                         1370 06453000
         MVC   FULLWORD(4,@01),CNVRTWRD                            1370 06454000
*                      ELSE                                        1371 06455000
*                        DO;                                       1371 06456000
         B     @RC01369                                            1371 06457000
@RF01369 DS    0H                                                  1372 06458000
*                        FULLWDCT=SCLRCNT;                         1372 06459000
         LH    @15,SCLRCNT                                         1372 06460000
         L     @14,DATAPTR                                         1372 06461000
         ST    @15,FULLWDCT(,@14)                                  1372 06462000
*                        LFULLWD(SCLRCNT)=CNVRTWRD;                1373 06463000
         SLA   @15,2                                               1373 06464000
         L     @05,CNVRTWRD                                        1373 06465000
         ST    @05,LFULLWD-4(@15,@14)                              1373 06466000
*                        END;                                      1374 06467000
*                                                                  1374 06468000
*              /******************************************************/ 06469000
*              /*                                                    */ 06470000
*              /* IF THE CONSTANT CONVERTED WAS A BIT STRING OR HEX  */ 06471000
*              /* STRING, CHECK THAT THE CONVERTED HEXADECIMAL DIGIT */ 06472000
*              /* STRING DOES NOT EXCEED THE MAXIMUM SCALAR LENGTH   */ 06473000
*              /* ALLOWED FOR THIS PARAMETER.  THEN PLACE THE STRING */ 06474000
*              /* INTO THE FDT.                                      */ 06475000
*              /*                                                    */ 06476000
*              /******************************************************/ 06477000
*              ELSE                                                1375 06478000
*                IF DIGTINDX > MAXLNGTH                            1375 06479000
*                  THEN                                            1375 06480000
*                                                                  1375 06481000
         B     @RC01366                                            1375 06482000
@RF01366 LA    @15,12                                              1375 06483000
         LR    @14,@15                                             1375 06484000
         MH    @14,PARMID                                          1375 06485000
         L     @01,WORKPTR                                         1375 06486000
         AL    @01,@CF01317                                        1375 06487000
         AL    @15,PARMPTR(@14,@01)                                1375 06488000
         LH    @14,DIGTINDX                                        1375 06489000
         MVC   @ZT00003+3(1),MAXLNGTH(@15)                         1375 06490000
         C     @14,@ZT00003                                        1375 06491000
         BNH   @RF01375                                            1375 06492000
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1376 06493000
*                                ADDR(ERRFIELD));                  1376 06494000
*                                                                  1376 06495000
         MVC   @AL00001(8),@AL01376                                1376 06496000
         LA    @15,ERRFIELD                                        1376 06497000
         ST    @15,@AFTEMPS+24                                     1376 06498000
         LA    @15,@AFTEMPS+24                                     1376 06499000
         ST    @15,@AL00001+8                                      1376 06500000
         LA    @01,@AL00001                                        1376 06501000
         BAL   @14,ERROR2                                          1376 06502000
*                  ELSE                                            1377 06503000
*                    IF SCALAR=YES                                 1377 06504000
*                      THEN                                        1377 06505000
         B     @RC01375                                            1377 06506000
@RF01375 LA    @15,12                                              1377 06507000
         LR    @14,@15                                             1377 06508000
         MH    @14,PARMID                                          1377 06509000
         L     @01,WORKPTR                                         1377 06510000
         AL    @01,@CF01317                                        1377 06511000
         L     @14,PARMPTR(@14,@01)                                1377 06512000
         TM    SCALAR(@14),B'00010000'                             1377 06513000
         BNO   @RF01377                                            1377 06514000
*                        DO;                                       1378 06515000
*                        STRINGLN=DIGTINDX;                        1379 06516000
         L     @05,DATAPTR                                         1379 06517000
         MVC   STRINGLN(1,@05),DIGTINDX+1                          1379 06518000
*                        WORKPTR3=ADDR(STRING);                    1380 06519000
         LA    @04,STRING(,@05)                                    1380 06520000
         ST    @04,WORKPTR3                                        1380 06521000
*                        RFY(DATABLK) BASED(WORKPTR3);             1381 06522000
*                        STRING(1)=BLANK;                          1382 06523000
         MVI   STRING(@05),C' '                                    1382 06524000
*                        IF MAXLNGTH > 1                           1383 06525000
*                          THEN                                    1383 06526000
         ALR   @14,@15                                             1383 06527000
         CLI   MAXLNGTH(@14),1                                     1383 06528000
         BNH   @RF01383                                            1383 06529000
*                            STRING(2:MAXLNGTH)=                   1384 06530000
*                               DATABLK(1:MAXLNGTH-1);             1384 06531000
         SLR   @15,@15                                             1384 06532000
         IC    @15,MAXLNGTH(,@14)                                  1384 06533000
         BCTR  @15,0                                               1384 06534000
         BCTR  @15,0                                               1384 06535000
         EX    @15,@SM01355                                        1384 06536000
*                        STRING(1:DIGTINDX)=                       1385 06537000
*                                SYNUNIT(1:DIGTINDX);              1385 06538000
@RF01383 L     @01,DATAPTR                                         1385 06539000
         LH    @15,DIGTINDX                                        1385 06540000
         BCTR  @15,0                                               1385 06541000
         EX    @15,@SM01357                                        1385 06542000
*                        END;                                      1386 06543000
*                      ELSE                                        1387 06544000
*                        DO;                                       1387 06545000
         B     @RC01377                                            1387 06546000
@RF01377 DS    0H                                                  1388 06547000
*                        STRINGCT=SCLRCNT;                         1388 06548000
         L     @01,DATAPTR                                         1388 06549000
         MVC   STRINGCT(2,@01),SCLRCNT                             1388 06550000
*                        WORKPTR3=ADDR(ELTPTR->LSTRING);           1389 06551000
         L     @15,ELTPTR                                          1389 06552000
         LA    @14,LSTRING(,@15)                                   1389 06553000
         ST    @14,WORKPTR3                                        1389 06554000
*                        ELTPTR->LSTRINGL=DIGTINDX;                1390 06555000
         MVC   LSTRINGL(1,@15),DIGTINDX+1                          1390 06556000
*                        ELTPTR->LSTRING(1)=BLANK;                 1391 06557000
         MVI   LSTRING(@15),C' '                                   1391 06558000
*                        IF MAXLNGTH > 1                           1392 06559000
*                          THEN                                    1392 06560000
         LA    @05,12                                              1392 06561000
         LR    @04,@05                                             1392 06562000
         MH    @04,PARMID                                          1392 06563000
         L     @01,WORKPTR                                         1392 06564000
         AL    @01,@CF01317                                        1392 06565000
         AL    @05,PARMPTR(@04,@01)                                1392 06566000
         CLI   MAXLNGTH(@05),1                                     1392 06567000
         BNH   @RF01392                                            1392 06568000
*                            ELTPTR->LSTRING(2:MAXLNGTH)=          1393 06569000
*                              WORKPTR3->DATABLK(1:MAXLNGTH-1);    1393 06570000
         SLR   @04,@04                                             1393 06571000
         IC    @04,MAXLNGTH(,@05)                                  1393 06572000
         BCTR  @04,0                                               1393 06573000
         BCTR  @04,0                                               1393 06574000
         EX    @04,@SM01359                                        1393 06575000
*                        ELTPTR->LSTRING(1:DIGTINDX)=              1394 06576000
*                              SYNUNIT(1:DIGTINDX);                1394 06577000
@RF01392 L     @15,ELTPTR                                          1394 06578000
         LH    @14,DIGTINDX                                        1394 06579000
         BCTR  @14,0                                               1394 06580000
         EX    @14,@SM01347                                        1394 06581000
*                        ELTPTR=ELTPTR+SPACEAMT;                   1395 06582000
         AH    @15,SPACEAMT                                        1395 06583000
         ST    @15,ELTPTR                                          1395 06584000
*                        END;                                      1396 06585000
*                                                                  1396 06586000
*        END CONVERT;                                              1397 06587000
@EL00015 DS    0H                                                  1397 06588000
@EF00015 DS    0H                                                  1397 06589000
@ER00015 LM    @14,@12,@SA00015                                    1397 06590000
         BR    @14                                                 1397 06591000
*/********************************************************************/ 06592000
*/*                                                                  */ 06593000
*/*  PROCEDURE NAME - DSICKHK                                        */ 06594000
*/*                                                                  */ 06595000
*/*  FUNCTION - THIS ROUTINE CHECKS DSNAME SYNTAX RESTRICTIONS ON    */ 06596000
*/*             AN EXTRACTED DSNAME ITEM, PARSES OUT THE             */ 06597000
*/*             MEMBER NAME (IF PRESENT), AND STORES THE             */ 06598000
*/*             NAME(S) INTO THE FDT.                                */ 06599000
*/*                                                                  */ 06600000
*/*  INPUT -                                                         */ 06601000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 06602000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 06603000
*/*                    VALUE WHEN AN ERROR IS DETECTED               */ 06604000
*/*          SYNUNIT - CONTAINS THE DSNAME TO BE EXAMINED AND STORED */ 06605000
*/*                    INTO THE FDT.                                 */ 06606000
*/*          UNITINDX- LENGTH OF THE DSNAME TO BE CHECKED            */ 06607000
*/*          SCLRCNT - COUNT OF ITEMS FOUND SO FAR IN A SCALAR LIST  */ 06608000
*/*                                                                  */ 06609000
*/*  OUTPUT -                                                        */ 06610000
*/*          FUNCTION DATA TABLE ENTRY.                              */ 06611000
*/*          RISTATUS- SEE 'INPUT'                                   */ 06612000
*/*                                                                  */ 06613000
*/********************************************************************/ 06614000
*DSICKHK:PROCEDURE;                                                1398 06615000
DSICKHK  STM   @14,@12,@SA00016                                    1398 06616000
*        /************************************************************/ 06617000
*        /*                                                          */ 06618000
*        /* DSICKHK DATA DEFINITIONS                                 */ 06619000
*        /*                                                          */ 06620000
*        /************************************************************/ 06621000
*        DCL NATCHAR1 CHAR(1)          /*NATIONAL CHARACTER          */ 06622000
*                     CONSTANT('@');                               1399 06623000
*        DCL NATCHAR2 CHAR(1)          /*NATIONAL CHARACTER          */ 06624000
*                     CONSTANT('#');                               1400 06625000
*        DCL NATCHAR3 CHAR(1)          /*NATIONAL CHARACTER          */ 06626000
*                     CONSTANT('$');                               1401 06627000
*        DCL HYPHEN   CHAR(1)          /*HYPHEN CHARACTER            */ 06628000
*                     CONSTANT('-');                               1402 06629000
*        DCL 1 TWLVZERO CHAR(1) STATIC,/*12-0 PUNCH CODE             */ 06630000
*              2 * FIXED(8) INIT('C0'X);                           1403 06631000
*        DCL PERIOD   CHAR(1)          /*PERIOD CHARACTER            */ 06632000
*                     CONSTANT('.');                               1404 06633000
*        DCL STAR     CHAR(1)          /*ASTERISK CHARACTER          */ 06634000
*                     CONSTANT('*');                               1405 06635000
*                                                                  1405 06636000
*        DCL SEGSTART FIXED(15);       /*STARTING POSITION OF A DATA    06637000
*                                        SET NAME SEGMENT            */ 06638000
*        DCL SEGEND   FIXED(15);       /*ENDING POSITION OF A DATA 1407 06639000
*                                        SET NAME SEGMENT            */ 06640000
*        DCL SEGLEN   FIXED(15);       /*LENGTH OF DSNAME            */ 06641000
*                                      /* SEGMENT                    */ 06642000
*        DCL STARLOC  FIXED(8);        /*ASTERISK LOCATION           */ 06643000
*                                      /* IN GENERIC DSNAME          */ 06644000
*        DCL MEMBIT   BIT(1);          /*SET 'ON' WHEN A             */ 06645000
*                                      /* MEMBER NAME IS             */ 06646000
*                                      /* BEING CHECKED              */ 06647000
*        DCL ONESTAR  BIT(1);          /*SET 'ON' WHEN AN            */ 06648000
*                                      /* ASTERISK HAS BEEN          */ 06649000
*                                      /* FOUND IN A DSNAME          */ 06650000
*        DCL WITHMEM  BIT(1);          /*SET 'ON' WHEN               */ 06651000
*                                      /*CHECKING ANY PART           */ 06652000
*                                      /*OF A DSNAME THAT            */ 06653000
*                                      /*HAS A MEMBER NAME           */ 06654000
*        /************************************************************/ 06655000
*        /*                                                          */ 06656000
*        /*  ** DSICKHK **  CHECK DSNAME SYNTAX RESTRICTIONS         */ 06657000
*        /*                                                          */ 06658000
*        /************************************************************/ 06659000
*        OLDERID2 = NEWERID2;                                      1413 06660000
         L     @01,GDTPTR                                          1413 06661000
         L     @15,GDTTR2(,@01)                                    1413 06662000
         MVC   @TS00001(95),NEWERID2(@15)                          1413 06663000
         MVC   OLDERID2(95,@15),@TS00001                           1413 06664000
*        NEWID2='RIID';                                            1414 06665000
*                                                                  1414 06666000
         MVC   NEWID2(4,@15),@CC01102                              1414 06667000
*        /************************************************************/ 06668000
*        /*                                                          */ 06669000
*        /* IF AN INPUT DSNAME HAS A MEMBER NAME IN PARENS,          */ 06670000
*        /* FIRST EXTRACT THE MEMBER NAME, CHECK FOR CORRECT         */ 06671000
*        /* SYNTAX, AND STORE IT IN THE FDT.                         */ 06672000
*        /*                                                          */ 06673000
*        /************************************************************/ 06674000
*        WITHMEM=NO;                                               1415 06675000
         NI    WITHMEM,B'01111111'                                 1415 06676000
*        MEMBIT=NO;                                                1416 06677000
         NI    MEMBIT,B'01111111'                                  1416 06678000
*        IF UNITINDX > 3  &  SYNUNIT(UNITINDX) = CLOSING           1417 06679000
*          THEN                                                    1417 06680000
         LH    @15,UNITINDX                                        1417 06681000
         CH    @15,@CH00144                                        1417 06682000
         BNH   @RF01417                                            1417 06683000
         LA    @14,SYNUNIT-1(@15)                                  1417 06684000
         CLI   0(@14),C')'                                         1417 06685000
         BNE   @RF01417                                            1417 06686000
*            DO INDEX2=1 TO UNITINDX WHILE(MEMBIT=NO);             1418 06687000
*                                                                  1418 06688000
         LA    @15,1                                               1418 06689000
         B     @DE01418                                            1418 06690000
@DL01418 TM    MEMBIT,B'10000000'                                  1418 06691000
         BNZ   @DC01418                                            1418 06692000
*              IF SYNUNIT(INDEX2)=OPENING                          1419 06693000
*                THEN                                              1419 06694000
*                                                                  1419 06695000
         LA    @14,SYNUNIT-1(@15)                                  1419 06696000
         CLI   0(@14),C'('                                         1419 06697000
         BNE   @RF01419                                            1419 06698000
*                  /**************************************************/ 06699000
*                  /*                                                */ 06700000
*                  /* UPON FINDING THE OPENING PARENTHESIS           */ 06701000
*                  /* DELIMITING THE MEMBER NAME, THE NAME           */ 06702000
*                  /* IS EXTRACTED.                                  */ 06703000
*                  /*                                                */ 06704000
*                  /**************************************************/ 06705000
*DOGRP106:         DO;                                             1420 06706000
DOGRP106 DS    0H                                                  1421 06707000
*                  SEGSTART=INDEX2+1;                              1421 06708000
         LA    @15,1                                               1421 06709000
         LH    @14,INDEX2                                          1421 06710000
         ALR   @14,@15                                             1421 06711000
         STH   @14,SEGSTART                                        1421 06712000
*                  SEGEND=UNITINDX-1;                              1422 06713000
         LH    @05,UNITINDX                                        1422 06714000
         BCTR  @05,0                                               1422 06715000
         STH   @05,SEGEND                                          1422 06716000
*                  SEGLEN=SEGEND-SEGSTART+1;                       1423 06717000
         SLR   @05,@14                                             1423 06718000
         ALR   @05,@15                                             1423 06719000
         STH   @05,SEGLEN                                          1423 06720000
*                  MEMBIT=YES;                                     1424 06721000
         OI    MEMBIT,B'10000000'                                  1424 06722000
*                  WITHMEM=YES;                                    1425 06723000
*                                                                  1425 06724000
         OI    WITHMEM,B'10000000'                                 1425 06725000
*                  CALL NAMESCAN;                                  1426 06726000
*                                                                  1426 06727000
         BAL   @14,NAMESCAN                                        1426 06728000
*                  /**************************************************/ 06729000
*                  /*                                                */ 06730000
*                  /* IF THE MEMBER NAME HAS NO SYNTAX               */ 06731000
*                  /* ERROR, STORE IT IN THE FDT.                    */ 06732000
*                  /*                                                */ 06733000
*                  /**************************************************/ 06734000
*                  IF RISTATUS=0                                   1427 06735000
*                    THEN                                          1427 06736000
         LH    @15,RISTATUS                                        1427 06737000
         LTR   @15,@15                                             1427 06738000
         BNZ   @RF01427                                            1427 06739000
*                      IF LIST=YES                                 1428 06740000
*                        THEN                                      1428 06741000
         LH    @15,PARMID                                          1428 06742000
         MH    @15,@CH00038                                        1428 06743000
         L     @01,WORKPTR                                         1428 06744000
         AL    @01,@CF01317                                        1428 06745000
         L     @01,PARMPTR(@15,@01)                                1428 06746000
         TM    LIST(@01),B'00001000'                               1428 06747000
         BNO   @RF01428                                            1428 06748000
*                          DO;                                     1429 06749000
*                          DSNAMECT=SCLRCNT;                       1430 06750000
         LH    @15,SCLRCNT                                         1430 06751000
         L     @14,DATAPTR                                         1430 06752000
         STH   @15,DSNAMECT(,@14)                                  1430 06753000
*                          LMEMNAML(SCLRCNT)=SEGLEN;               1431 06754000
         MH    @15,@CH01296                                        1431 06755000
         LH    @05,SEGLEN                                          1431 06756000
         LA    @04,0(@15,@14)                                      1431 06757000
         AL    @04,@CF01361                                        1431 06758000
         STC   @05,LMEMNAML-13(,@04)                               1431 06759000
*                          LMEMNAME(SCLRCNT)=                      1432 06760000
*                                SYNUNIT(SEGSTART:SEGEND);         1432 06761000
         ALR   @14,@15                                             1432 06762000
         AL    @14,@CF01362                                        1432 06763000
         MVI   LMEMNAME-13(@14),C' '                               1432 06764000
         MVC   LMEMNAME-12(6,@14),LMEMNAME-13(@14)                 1432 06765000
         LH    @15,SEGSTART                                        1432 06766000
         LH    @05,SEGEND                                          1432 06767000
         SLR   @05,@15                                             1432 06768000
         LA    @01,SYNUNIT-1(@15)                                  1432 06769000
         EX    @05,@SM01363                                        1432 06770000
*                          END;                                    1433 06771000
*                        ELSE                                      1434 06772000
*                          DO;                                     1434 06773000
         B     @RC01428                                            1434 06774000
@RF01428 DS    0H                                                  1435 06775000
*                          MEMNAMLN=SEGLEN;                        1435 06776000
         L     @15,DATAPTR                                         1435 06777000
         MVC   MEMNAMLN(1,@15),SEGLEN+1                            1435 06778000
*                          MEMNAME=                                1436 06779000
*                               SYNUNIT(SEGSTART:SEGEND);          1436 06780000
         MVI   MEMNAME+1(@15),C' '                                 1436 06781000
         MVC   MEMNAME+2(6,@15),MEMNAME+1(@15)                     1436 06782000
         LH    @14,SEGSTART                                        1436 06783000
         LH    @05,SEGEND                                          1436 06784000
         SLR   @05,@14                                             1436 06785000
         LA    @01,SYNUNIT-1(@14)                                  1436 06786000
         EX    @05,@SM01365                                        1436 06787000
*                          END;                                    1437 06788000
*                  UNITINDX=SEGSTART-2;                            1438 06789000
@RC01428 DS    0H                                                  1438 06790000
@RF01427 LH    @15,SEGSTART                                        1438 06791000
         BCTR  @15,0                                               1438 06792000
         BCTR  @15,0                                               1438 06793000
         STH   @15,UNITINDX                                        1438 06794000
*                  END DOGRP106;                                   1439 06795000
*            END;                                                  1440 06796000
*                                                                  1440 06797000
@RF01419 LA    @15,1                                               1440 06798000
         AH    @15,INDEX2                                          1440 06799000
@DE01418 STH   @15,INDEX2                                          1440 06800000
         CH    @15,UNITINDX                                        1440 06801000
         BNH   @DL01418                                            1440 06802000
@DC01418 DS    0H                                                  1441 06803000
*        /************************************************************/ 06804000
*        /*                                                          */ 06805000
*        /* THE DSNAME, EXCLUDING THE MEMBER NAME, MUST              */ 06806000
*        /* ADHERE TO DSNAME LENGTH LIMITATIONS.                     */ 06807000
*        /*                                                          */ 06808000
*        /************************************************************/ 06809000
*        IF UNITINDX > MAXLNGTH  |  UNITINDX < 1                   1441 06810000
*          THEN                                                    1441 06811000
@RF01417 LH    @15,UNITINDX                                        1441 06812000
         LA    @14,12                                              1441 06813000
         LR    @05,@14                                             1441 06814000
         MH    @05,PARMID                                          1441 06815000
         L     @01,WORKPTR                                         1441 06816000
         AL    @01,@CF01317                                        1441 06817000
         AL    @14,PARMPTR(@05,@01)                                1441 06818000
         MVC   @ZT00003+3(1),MAXLNGTH(@14)                         1441 06819000
         C     @15,@ZT00003                                        1441 06820000
         BH    @RT01441                                            1441 06821000
         LTR   @15,@15                                             1441 06822000
         BP    @RF01441                                            1441 06823000
@RT01441 DS    0H                                                  1442 06824000
*            RISTATUS=BADITEM;                                     1442 06825000
*                                                                  1442 06826000
         MVC   RISTATUS(2),@CH00052                                1442 06827000
*        /************************************************************/ 06828000
*        /*                                                          */ 06829000
*        /* A DSNAME MAY CONSIST OF 1 TO 8-CHAR SEGMENTS,            */ 06830000
*        /* SEPARATED BY PERIODS.  EACH SEGMENT IS CHECKED           */ 06831000
*        /* FOR SYNTAX ERRORS AFTER THE PERIODS HAVE BEEN            */ 06832000
*        /* FOUND WHICH DELIMIT THE SEGMENT.                         */ 06833000
*        /*                                                          */ 06834000
*        /************************************************************/ 06835000
*        STARLOC=0;                                                1443 06836000
@RF01441 MVI   STARLOC,X'00'                                       1443 06837000
*        ONESTAR=NO;                                               1444 06838000
         NI    ONESTAR,B'01111111'                                 1444 06839000
*        SEGEND=-1;                                                1445 06840000
         MVC   SEGEND(2),@CH01070                                  1445 06841000
*        MEMBIT=NO;                                                1446 06842000
*                                                                  1446 06843000
         NI    MEMBIT,B'01111111'                                  1446 06844000
*DOLOOP16:DO WHILE(RISTATUS=0 & SEGEND<UNITINDX);                  1447 06845000
DOLOOP16 B     @DE01447                                            1447 06846000
@DL01447 DS    0H                                                  1448 06847000
*          SEGSTART=SEGEND+2;                                      1448 06848000
         LA    @15,2                                               1448 06849000
         AH    @15,SEGEND                                          1448 06850000
         STH   @15,SEGSTART                                        1448 06851000
*          DO SEGEND=SEGSTART TO UNITINDX                          1449 06852000
*                               WHILE(SYNUNIT(SEGEND)^=PERIOD);    1449 06853000
         B     @DE01449                                            1449 06854000
@DL01449 LA    @14,SYNUNIT-1(@15)                                  1449 06855000
         CLI   0(@14),C'.'                                         1449 06856000
         BE    @DC01449                                            1449 06857000
*          END;                                                    1450 06858000
         AL    @15,@CF00172                                        1450 06859000
@DE01449 STH   @15,SEGEND                                          1450 06860000
         CH    @15,UNITINDX                                        1450 06861000
         BNH   @DL01449                                            1450 06862000
@DC01449 DS    0H                                                  1451 06863000
*          SEGEND=SEGEND-1;                                        1451 06864000
         LH    @15,SEGEND                                          1451 06865000
         BCTR  @15,0                                               1451 06866000
         STH   @15,SEGEND                                          1451 06867000
*          SEGLEN=SEGEND-SEGSTART+1;                               1452 06868000
*                                                                  1452 06869000
         LA    @14,1                                               1452 06870000
         LH    @05,SEGSTART                                        1452 06871000
         SLR   @15,@05                                             1452 06872000
         ALR   @15,@14                                             1452 06873000
         STH   @15,SEGLEN                                          1452 06874000
*          /**********************************************************/ 06875000
*          /*                                                        */ 06876000
*          /* IF THIS MAY BE A GENERIC DSNAME, CHECK FOR AN          */ 06877000
*          /* ASTERISK, BUT ALLOW JUST ONE OF THEM, IN PLACE         */ 06878000
*          /* OF A SINGLE DSNAME LEVEL.                              */ 06879000
*          /*                                                        */ 06880000
*          /**********************************************************/ 06881000
*          IF SYNUNIT(SEGSTART)=STAR                               1453 06882000
*            THEN                                                  1453 06883000
         LA    @04,SYNUNIT-1(@05)                                  1453 06884000
         CLI   0(@04),C'*'                                         1453 06885000
         BNE   @RF01453                                            1453 06886000
*              IF ONESTAR=NO & GENERIC=YES & SEGLEN=1 & SEGSTART^=1     06887000
*                THEN                                              1454 06888000
         TM    ONESTAR,B'10000000'                                 1454 06889000
         BNZ   @RF01454                                            1454 06890000
         LA    @04,12                                              1454 06891000
         LR    @03,@04                                             1454 06892000
         MH    @03,PARMID                                          1454 06893000
         L     @01,WORKPTR                                         1454 06894000
         AL    @01,@CF01317                                        1454 06895000
         AL    @04,PARMPTR(@03,@01)                                1454 06896000
         TM    GENERIC(@04),B'00010000'                            1454 06897000
         BNO   @RF01454                                            1454 06898000
         CR    @15,@14                                             1454 06899000
         BNE   @RF01454                                            1454 06900000
         CR    @05,@14                                             1454 06901000
         BE    @RF01454                                            1454 06902000
*                  DO;                                             1455 06903000
*                  ONESTAR=YES;                                    1456 06904000
         OI    ONESTAR,B'10000000'                                 1456 06905000
*                  STARLOC=SEGSTART;                               1457 06906000
         STC   @05,STARLOC                                         1457 06907000
*                  END;                                            1458 06908000
*                ELSE                                              1459 06909000
*                  RISTATUS=BADITEM;                               1459 06910000
         B     @RC01454                                            1459 06911000
@RF01454 MVC   RISTATUS(2),@CH00052                                1459 06912000
*            ELSE                                                  1460 06913000
*                                                                  1460 06914000
*              CALL NAMESCAN;                                      1460 06915000
*                                                                  1460 06916000
         B     @RC01453                                            1460 06917000
@RF01453 BAL   @14,NAMESCAN                                        1460 06918000
*        END DOLOOP16;                                             1461 06919000
*                                                                  1461 06920000
@RC01453 DS    0H                                                  1461 06921000
@DE01447 LH    @15,RISTATUS                                        1461 06922000
         LTR   @15,@15                                             1461 06923000
         BNZ   @DC01447                                            1461 06924000
         LH    @15,SEGEND                                          1461 06925000
         CH    @15,UNITINDX                                        1461 06926000
         BL    @DL01447                                            1461 06927000
@DC01447 DS    0H                                                  1462 06928000
*        /************************************************************/ 06929000
*        /*                                                          */ 06930000
*        /* IF THE DSNAME IS SYNTACTICALLY PROPER, STORE IT IN THE   */ 06931000
*        /* FDT--OTHERWISE, PRINT AN ERROR MESSAGE.                  */ 06932000
*        /*                                                          */ 06933000
*        /************************************************************/ 06934000
*        IF RISTATUS=0                                             1462 06935000
*          THEN                                                    1462 06936000
         LH    @15,RISTATUS                                        1462 06937000
         LTR   @15,@15                                             1462 06938000
         BNZ   @RF01462                                            1462 06939000
*            IF LIST=YES                                           1463 06940000
*              THEN                                                1463 06941000
         LH    @15,PARMID                                          1463 06942000
         MH    @15,@CH00038                                        1463 06943000
         L     @01,WORKPTR                                         1463 06944000
         AL    @01,@CF01317                                        1463 06945000
         L     @01,PARMPTR(@15,@01)                                1463 06946000
         TM    LIST(@01),B'00001000'                               1463 06947000
         BNO   @RF01463                                            1463 06948000
*                DO;                                               1464 06949000
*                DSNAMECT=SCLRCNT;                                 1465 06950000
         LH    @15,SCLRCNT                                         1465 06951000
         L     @14,DATAPTR                                         1465 06952000
         STH   @15,DSNAMECT(,@14)                                  1465 06953000
*                LSTARPOS(SCLRCNT)=STARLOC;                        1466 06954000
         MH    @15,@CH01296                                        1466 06955000
         SLR   @05,@05                                             1466 06956000
         IC    @05,STARLOC                                         1466 06957000
         LA    @04,0(@15,@14)                                      1466 06958000
         AL    @04,@CF01367                                        1466 06959000
         STC   @05,LSTARPOS-11(,@04)                               1466 06960000
*                LDSNAMEL(SCLRCNT)=UNITINDX;                       1467 06961000
         LH    @05,UNITINDX                                        1467 06962000
         LA    @04,0(@15,@14)                                      1467 06963000
         AL    @04,@CF01368                                        1467 06964000
         STC   @05,LDSNAMEL-22(,@04)                               1467 06965000
*                LDSNAME(SCLRCNT)=SYNUNIT(1:UNITINDX);             1468 06966000
         ALR   @14,@15                                             1468 06967000
         AL    @14,@CF01369                                        1468 06968000
         MVI   LDSNAME-22(@14),C' '                                1468 06969000
         MVC   LDSNAME-21(42,@14),LDSNAME-22(@14)                  1468 06970000
         BCTR  @05,0                                               1468 06971000
         EX    @05,@SM01370                                        1468 06972000
*                END;                                              1469 06973000
*              ELSE                                                1470 06974000
*                DO;                                               1470 06975000
         B     @RC01463                                            1470 06976000
@RF01463 DS    0H                                                  1471 06977000
*                DSNAMELN=UNITINDX;                                1471 06978000
         LH    @15,UNITINDX                                        1471 06979000
         L     @14,DATAPTR                                         1471 06980000
         STC   @15,DSNAMELN(,@14)                                  1471 06981000
*                STARPOS=STARLOC;                                  1472 06982000
         MVC   STARPOS(1,@14),STARLOC                              1472 06983000
*                DSNAME=SYNUNIT(1:UNITINDX);                       1473 06984000
         MVI   DSNAME+1(@14),C' '                                  1473 06985000
         MVC   DSNAME+2(42,@14),DSNAME+1(@14)                      1473 06986000
         BCTR  @15,0                                               1473 06987000
         EX    @15,@SM01372                                        1473 06988000
*                END;                                              1474 06989000
*          ELSE                                                    1475 06990000
*                                                                  1475 06991000
*            CALL ERROR2(BADITEM,LENGTH(ERRFIELD),                 1475 06992000
*                                    ADDR(ERRFIELD));              1475 06993000
         B     @RC01462                                            1475 06994000
@RF01462 MVC   @AL00001(8),@AL01475                                1475 06995000
         LA    @15,ERRFIELD                                        1475 06996000
         ST    @15,@AFTEMPS+28                                     1475 06997000
         LA    @15,@AFTEMPS+28                                     1475 06998000
         ST    @15,@AL00001+8                                      1475 06999000
         LA    @01,@AL00001                                        1475 07000000
         BAL   @14,ERROR2                                          1475 07001000
*/********************************************************************/ 07002000
*/*                                                                  */ 07003000
*/*  PROCEDURE NAME - NAMESCAN                                       */ 07004000
*/*                                                                  */ 07005000
*/*  FUNCTION - THIS ROUTINE CHECKS THAT DSNAME SEGMENTS AND         */ 07006000
*/*             MEMBER NAMES ADHERE TO RESTRICTIONS UPON             */ 07007000
*/*             LENGTH AND VALID CHARACTERS.                         */ 07008000
*/*                                                                  */ 07009000
*/*  INPUT -                                                         */ 07010000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 07011000
*/*          SYNUNIT  - CONTAINS THE SEGMENT OF CHARACTERS           */ 07012000
*/*                     TO BE CHECKED FOR VALIDITY                   */ 07013000
*/*          SEGSTART - THE POSITION OF THE 1ST SEGMENT CHAR         */ 07014000
*/*          SEGEND -   THE POSITION OF THE 2ND SEGMENT CHAR         */ 07015000
*/*          SEGLEN -   LENGTH OF SEGMENT TO BE CHECKED              */ 07016000
*/*          MEMBIT -   SET 'ON' IF A MEMBER NAME IS BEING           */ 07017000
*/*                     CHECKED.                                     */ 07018000
*/*                                                                  */ 07019000
*/*  OUTPUT -                                                        */ 07020000
*/*          RISTATUS - SET TO A NON-ZERO ERROR ID IF NAME           */ 07021000
*/*                     DOES NOT MEET SYNTAX REQUIREMENTS            */ 07022000
*/*                                                                  */ 07023000
*/********************************************************************/ 07024000
*NAMESCAN:PROCEDURE;                                               1476 07025000
         B     @PB00017                                            1476 07026000
NAMESCAN STM   @14,@12,@SA00017                                    1476 07027000
*        /************************************************************/ 07028000
*        /*                                                          */ 07029000
*        /*  ** NAMESCAN **  CHECK NAME SEGMENT SYNTAX               */ 07030000
*        /*                                                          */ 07031000
*        /************************************************************/ 07032000
*        IF GDTDBG = NULLPTR                                       1477 07033000
*          THEN;                                                   1477 07034000
         L     @01,GDTPTR                                          1477 07035000
         L     @15,GDTDBG(,@01)                                    1477 07036000
         LTR   @15,@15                                             1477 07037000
         BZ    @RT01477                                            1477 07038000
*          ELSE                                                    1479 07039000
*            CALL ICKDB010(GDTTBL,'RINS');                         1479 07040000
*                                                                  1479 07041000
         L     @15,GDTPTR                                          1479 07042000
         ST    @15,@AL00001                                        1479 07043000
         LA    @14,@CC01111                                        1479 07044000
         ST    @14,@AL00001+4                                      1479 07045000
         MVI   @AL00001+4,X'80'                                    1479 07046000
         L     @15,GDTDBG(,@15)                                    1479 07047000
         LA    @01,@AL00001                                        1479 07048000
         BALR  @14,@15                                             1479 07049000
*        /************************************************************/ 07050000
*        /*                                                          */ 07051000
*        /* IF THE SETMENT IS LESS THAN 1 OR GREATER THAN            */ 07052000
*        /* 8 CHARACTERS LONG OR IF THE BEGINNING CHARACTER          */ 07053000
*        /* OR THE SEGMENT IS NOT AN ALPHABETIC OR NATIONAL          */ 07054000
*        /* CHARACTER (OR NOT A DECIMAL DIGIT IF THIS 'NAME'         */ 07055000
*        /* MAY ACTUALLY BE A VOLUME SERIAL NUMBER), THEN            */ 07056000
*        /* THE DSNAME IS IN ERROR.                                  */ 07057000
*        /*                                                          */ 07058000
*        /************************************************************/ 07059000
*        IF SEGLEN >= 1  &  SEGLEN <= 8  &                         1480 07060000
*           (SYNUNIT(SEGSTART)>='A' & SYNUNIT(SEGSTART)<='Z' |     1480 07061000
*            SYNUNIT(SEGSTART)=NATCHAR1 |                          1480 07062000
*            SYNUNIT(SEGSTART)=NATCHAR2 |                          1480 07063000
*            SYNUNIT(SEGSTART)=NATCHAR3)                           1480 07064000
*          THEN                                                    1480 07065000
*                                                                  1480 07066000
@RT01477 LH    @15,SEGLEN                                          1480 07067000
         CH    @15,@CH00172                                        1480 07068000
         BL    @RF01480                                            1480 07069000
         CH    @15,@CH00042                                        1480 07070000
         BH    @RF01480                                            1480 07071000
         LH    @15,SEGSTART                                        1480 07072000
         LA    @14,SYNUNIT-1(@15)                                  1480 07073000
         CLI   0(@14),C'A'                                         1480 07074000
         BL    @GL00072                                            1480 07075000
         LA    @14,SYNUNIT-1(@15)                                  1480 07076000
         CLI   0(@14),C'Z'                                         1480 07077000
         BNH   @RT01480                                            1480 07078000
@GL00072 LH    @15,SEGSTART                                        1480 07079000
         LA    @14,SYNUNIT-1(@15)                                  1480 07080000
         CLI   0(@14),C'@'                                         1480 07081000
         BE    @RT01480                                            1480 07082000
         LA    @14,SYNUNIT-1(@15)                                  1480 07083000
         CLI   0(@14),C'#'                                         1480 07084000
         BE    @RT01480                                            1480 07085000
         LA    @14,SYNUNIT-1(@15)                                  1480 07086000
         CLI   0(@14),C'$'                                         1480 07087000
         BNE   @RF01480                                            1480 07088000
@RT01480 DS    0H                                                  1481 07089000
*            /********************************************************/ 07090000
*            /*                                                      */ 07091000
*            /* CHECK THAT THE REMAINING CHARACTERS IN THE           */ 07092000
*            /* SEGMENT ARE ALPHABETIC OR NATIONAL CHAR'S            */ 07093000
*            /* (OR HYPHEN OR TWELVE-ZERO CODE IF THE                */ 07094000
*            /* SEGMENT IS NOT A MEMBER NAME).                       */ 07095000
*            /*                                                      */ 07096000
*            /********************************************************/ 07097000
*            DO INDEX2=SEGSTART+1 TO SEGEND;                       1481 07098000
         LA    @15,1                                               1481 07099000
         AH    @15,SEGSTART                                        1481 07100000
         B     @DE01481                                            1481 07101000
@DL01481 DS    0H                                                  1482 07102000
*              IF SYNUNIT(INDEX2) >= 'A'  &  SYNUNIT(INDEX2) <= 'Z'  |  07103000
*                 SYNUNIT(INDEX2) >= '0'  &  SYNUNIT(INDEX2) <= '9'  |  07104000
*                 SYNUNIT(INDEX2)=NATCHAR1 |                       1482 07105000
*                 SYNUNIT(INDEX2)=NATCHAR2 |                       1482 07106000
*                 SYNUNIT(INDEX2)=NATCHAR3 |                       1482 07107000
*                 MEMBIT=NO & (SYNUNIT(INDEX2)=HYPHEN |            1482 07108000
*                              SYNUNIT(INDEX2)=TWLVZERO)           1482 07109000
*                THEN;                                             1482 07110000
         LA    @14,SYNUNIT-1(@15)                                  1482 07111000
         CLI   0(@14),C'A'                                         1482 07112000
         BL    @GL00078                                            1482 07113000
         LA    @14,SYNUNIT-1(@15)                                  1482 07114000
         CLI   0(@14),C'Z'                                         1482 07115000
         BNH   @RT01482                                            1482 07116000
@GL00078 LH    @15,INDEX2                                          1482 07117000
         LA    @14,SYNUNIT-1(@15)                                  1482 07118000
         CLI   0(@14),C'0'                                         1482 07119000
         BL    @GL00077                                            1482 07120000
         LA    @14,SYNUNIT-1(@15)                                  1482 07121000
         CLI   0(@14),C'9'                                         1482 07122000
         BNH   @RT01482                                            1482 07123000
@GL00077 LH    @15,INDEX2                                          1482 07124000
         LA    @14,SYNUNIT-1(@15)                                  1482 07125000
         CLI   0(@14),C'@'                                         1482 07126000
         BE    @RT01482                                            1482 07127000
         LA    @14,SYNUNIT-1(@15)                                  1482 07128000
         CLI   0(@14),C'#'                                         1482 07129000
         BE    @RT01482                                            1482 07130000
         LA    @14,SYNUNIT-1(@15)                                  1482 07131000
         CLI   0(@14),C'$'                                         1482 07132000
         BE    @RT01482                                            1482 07133000
         TM    MEMBIT,B'10000000'                                  1482 07134000
         BNZ   @RF01482                                            1482 07135000
         LA    @14,SYNUNIT-1(@15)                                  1482 07136000
         CLI   0(@14),C'-'                                         1482 07137000
         BE    @RT01482                                            1482 07138000
         LA    @14,SYNUNIT-1(@15)                                  1482 07139000
         CLC   0(1,@14),TWLVZERO                                   1482 07140000
         BE    @RT01482                                            1482 07141000
*                ELSE                                              1484 07142000
*                  RISTATUS=BADITEM;                               1484 07143000
@RF01482 MVC   RISTATUS(2),@CH00052                                1484 07144000
*            END;                                                  1485 07145000
@RT01482 LA    @15,1                                               1485 07146000
         AH    @15,INDEX2                                          1485 07147000
@DE01481 STH   @15,INDEX2                                          1485 07148000
         CH    @15,SEGEND                                          1485 07149000
         BNH   @DL01481                                            1485 07150000
*          ELSE                                                    1486 07151000
*            RISTATUS=BADITEM;                                     1486 07152000
*                                                                  1486 07153000
         B     @RC01480                                            1486 07154000
@RF01480 MVC   RISTATUS(2),@CH00052                                1486 07155000
*        /************************************************************/ 07156000
*        /*                                                          */ 07157000
*        /* IF THE NAME MAY BE A VOLUME SERIAL NUMBER, THEN          */ 07158000
*        /* ALLOW ANY CHARACTERS IN THE NAME.                        */ 07159000
*        /*                                                          */ 07160000
*        /************************************************************/ 07161000
*        IF VOLID=YES  &  UNITINDX <= 6  &  WITHMEM=NO             1487 07162000
*          THEN                                                    1487 07163000
@RC01480 LA    @15,12                                              1487 07164000
         LR    @14,@15                                             1487 07165000
         MH    @14,PARMID                                          1487 07166000
         L     @01,WORKPTR                                         1487 07167000
         AL    @01,@CF01317                                        1487 07168000
         AL    @15,PARMPTR(@14,@01)                                1487 07169000
         TM    VOLID(@15),B'00001000'                              1487 07170000
         BNO   @RF01487                                            1487 07171000
         LH    @15,UNITINDX                                        1487 07172000
         CH    @15,@CH00127                                        1487 07173000
         BH    @RF01487                                            1487 07174000
         TM    WITHMEM,B'10000000'                                 1487 07175000
         BNZ   @RF01487                                            1487 07176000
*            RISTATUS=0;                                           1488 07177000
*                                                                  1488 07178000
         SLR   @15,@15                                             1488 07179000
         STH   @15,RISTATUS                                        1488 07180000
*        END NAMESCAN;                                             1489 07181000
*                                                                  1489 07182000
*                                                                  1489 07183000
@EL00017 DS    0H                                                  1489 07184000
@EF00017 DS    0H                                                  1489 07185000
@ER00017 LM    @14,@12,@SA00017                                    1489 07186000
         BR    @14                                                 1489 07187000
*        END DSICKHK;                                              1490 07188000
@EL00016 DS    0H                                                  1490 07189000
@EF00016 DS    0H                                                  1490 07190000
@ER00016 LM    @14,@12,@SA00016                                    1490 07191000
         BR    @14                                                 1490 07192000
*/********************************************************************/ 07193000
*/*                                                                  */ 07194000
*/*  PROCEDURE NAME - GETSPACE                                       */ 07195000
*/*                                                                  */ 07196000
*/*  FUNCTION - THIS ROUTINE ALLOCATES SPACE FOR FUNCTION DATA       */ 07197000
*/*             TABLE (FDT) SCALAR DATA STRUCTURES, BASED UPON THE   */ 07198000
*/*             DATA TYPE AND DATA LIMITS SPECIFIED FOR THE PARAMETER*/ 07199000
*/*             BEING HANDLED.  THESE VALUES ARE TAKEN FROM THE      */ 07200000
*/*             COMMAND DESCRIPTOR.                                  */ 07201000
*/*                                                                  */ 07202000
*/*  INPUT -                                                         */ 07203000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 07204000
*/*          PARMID -  PARAMETER ID# OF CURRENT PARAMETER            */ 07205000
*/*          BLKLEFT - AMOUNT OF SPACE REMAINING IN LARGE BLOCK OF   */ 07206000
*/*                    STORAGE FROM WHICH SPACE FOR SCALAR DATA      */ 07207000
*/*                    STRUCTURES ARE ALLOCATED.                     */ 07208000
*/*          BLKPTR -  POINTER TO NEXT UNUSED AREA WHICH MAY BE      */ 07209000
*/*                    ALLOCATED FROM LARGE STORAGE AREA.            */ 07210000
*/*                                                                  */ 07211000
*/*  OUTPUT -                                                        */ 07212000
*/*          FUNCTION DATA TABLE POINTER VECTOR ENTRY                */ 07213000
*/*          SPACEAMT- AMOUNT OF STORAGE SPACE REQUIRED FOR STORAGE  */ 07214000
*/*                    OF A SINGLE SCALAR ITEM (AND ASSOCIATED ITEMS */ 07215000
*/*                    LIKE PASSWORD, LENGTH FIELDS, ETC)            */ 07216000
*/*          AMTTOGET- AMOUNT OF SPACE TO ALLOCATE FOR THE ENTIRE    */ 07217000
*/*                    SCALAR DATA STRUCTURE                         */ 07218000
*/*          BLKLEFT - SEE 'INPUT'                                   */ 07219000
*/*          DATAPTR - POINTER TO CURRENT SCALAR DATA STRUCTURE      */ 07220000
*/*          BLKPTR -  SEE 'INPUT'                                   */ 07221000
*/*          FDTPTR -  POINTER IN FDT USED FOR INDEXING TO THE SCALAR*/ 07222000
*/*                    DATA IN THE STRUCTURES BEING BUILT.           */ 07223000
*/*          ARRYPTR - POINTER TO INTERMEDIATE PTR VECTOR WHICH THEN */ 07224000
*/*                    POINTS TO THE SCALAR DATA STRUCTURE           */ 07225000
*/*          PTRLOC -  LOCATION OF FDT POINTER WHICH POINTS TO THE   */ 07226000
*/*                    SCALAR DATA STRUCTURE FOR A SCALAR LIST       */ 07227000
*/*                                                                  */ 07228000
*/********************************************************************/ 07229000
*GETSPACE:PROCEDURE;                                               1491 07230000
GETSPACE STM   @14,@12,@SA00018                                    1491 07231000
*        /************************************************************/ 07232000
*        /*                                                          */ 07233000
*        /*  ** GETSPACE **  ALLOCATE SPACE FOR FDT DATA ELEMENTS    */ 07234000
*        /*                                                          */ 07235000
*        /************************************************************/ 07236000
*                                                                  1492 07237000
*        /************************************************************/ 07238000
*        /*                                                          */ 07239000
*        /* COMPUTE THE SPACE REQUIRED FOR EACH SCALAR AND ITS       */ 07240000
*        /* ASSOCIATED DATA ITEMS (COUNT, LENGTH, ETC.)              */ 07241000
*        /*                                                          */ 07242000
*        /************************************************************/ 07243000
*        IF NUMBER=YES                                             1492 07244000
*          THEN                                                    1492 07245000
         LA    @15,12                                              1492 07246000
         LR    @14,@15                                             1492 07247000
         MH    @14,PARMID                                          1492 07248000
         L     @01,WORKPTR                                         1492 07249000
         AL    @01,@CF01317                                        1492 07250000
         AL    @15,PARMPTR(@14,@01)                                1492 07251000
         TM    NUMBER(@15),B'10000000'                             1492 07252000
         BNO   @RF01492                                            1492 07253000
*            SPACEAMT=0;                                           1493 07254000
         SLR   @15,@15                                             1493 07255000
         STH   @15,SPACEAMT                                        1493 07256000
*          ELSE                                                    1494 07257000
*            IF DSNAM=YES                                          1494 07258000
*              THEN                                                1494 07259000
         B     @RC01492                                            1494 07260000
@RF01492 LA    @15,12                                              1494 07261000
         LR    @14,@15                                             1494 07262000
         MH    @14,PARMID                                          1494 07263000
         L     @01,WORKPTR                                         1494 07264000
         AL    @01,@CF01317                                        1494 07265000
         AL    @15,PARMPTR(@14,@01)                                1494 07266000
         TM    DSNAM(@15),B'00100000'                              1494 07267000
         BNO   @RF01494                                            1494 07268000
*                SPACEAMT=LENGTH(PASSWORD)+LENGTH(MEMNAME)+        1495 07269000
*                         5*LENGTH(DSNAMELN);                      1495 07270000
         MVC   SPACEAMT(2),@CH00284                                1495 07271000
*              ELSE                                                1496 07272000
*                DO;                                               1496 07273000
         B     @RC01494                                            1496 07274000
@RF01494 DS    0H                                                  1497 07275000
*                SPACEAMT=LENGTH(CHARLN);                          1497 07276000
         LA    @15,1                                               1497 07277000
         STH   @15,SPACEAMT                                        1497 07278000
*                IF PWORDOPT=YES                                   1498 07279000
*                  THEN                                            1498 07280000
         LA    @14,12                                              1498 07281000
         LR    @05,@14                                             1498 07282000
         MH    @05,PARMID                                          1498 07283000
         L     @01,WORKPTR                                         1498 07284000
         AL    @01,@CF01317                                        1498 07285000
         AL    @14,PARMPTR(@05,@01)                                1498 07286000
         TM    PWORDOPT(@14),B'00000010'                           1498 07287000
         BNO   @RF01498                                            1498 07288000
*                    SPACEAMT=SPACEAMT+LENGTH(PASSWORD)+LENGTH(CHARLN); 07289000
         LA    @15,9(,@15)                                         1499 07290000
         STH   @15,SPACEAMT                                        1499 07291000
*                END;                                              1500 07292000
@RF01498 DS    0H                                                  1501 07293000
*        SPACEAMT=SPACEAMT+MAXLNGTH;                               1501 07294000
@RC01494 DS    0H                                                  1501 07295000
@RC01492 LA    @15,12                                              1501 07296000
         LR    @14,@15                                             1501 07297000
         MH    @14,PARMID                                          1501 07298000
         L     @01,WORKPTR                                         1501 07299000
         AL    @01,@CF01317                                        1501 07300000
         L     @14,PARMPTR(@14,@01)                                1501 07301000
         ALR   @15,@14                                             1501 07302000
         SLR   @05,@05                                             1501 07303000
         IC    @05,MAXLNGTH(,@15)                                  1501 07304000
         AH    @05,SPACEAMT                                        1501 07305000
         STH   @05,SPACEAMT                                        1501 07306000
*        IF LIST=YES                                               1502 07307000
*          THEN                                                    1502 07308000
         TM    LIST(@14),B'00001000'                               1502 07309000
         BNO   @RF01502                                            1502 07310000
*            DO;                                                   1503 07311000
*            IF SPACEAMT//2 ^= 0                                   1504 07312000
*              THEN                                                1504 07313000
         LR    @00,@05                                             1504 07314000
         SRDA  @00,32                                              1504 07315000
         D     @00,@CF00124                                        1504 07316000
         LTR   @00,@00                                             1504 07317000
         BZ    @RF01504                                            1504 07318000
*                SPACEAMT=SPACEAMT+1;                              1505 07319000
         LA    @05,1(,@05)                                         1505 07320000
         STH   @05,SPACEAMT                                        1505 07321000
*            AMTTOGET=SPACEAMT*MIN(4,LISTMAX)+FULLNGTH;            1506 07322000
*                                                                  1506 07323000
@RF01504 LA    @15,4                                               1506 07324000
         LA    @14,12                                              1506 07325000
         LR    @05,@14                                             1506 07326000
         MH    @05,PARMID                                          1506 07327000
         L     @01,WORKPTR                                         1506 07328000
         AL    @01,@CF01317                                        1506 07329000
         AL    @14,PARMPTR(@05,@01)                                1506 07330000
         SLR   @01,@01                                             1506 07331000
         IC    @01,LISTMAX(,@14)                                   1506 07332000
         CR    @01,@15                                             1506 07333000
         BNH   *+6                                                      07334000
         LR    @01,@15                                             1506 07335000
         MH    @01,SPACEAMT                                        1506 07336000
         ALR   @01,@15                                             1506 07337000
         ST    @01,AMTTOGET                                        1506 07338000
*            /********************************************************/ 07339000
*            /*                                                      */ 07340000
*            /* REQUEST SPACE FOR THE SCALAR LIST DATA STRUCTURE.    */ 07341000
*            /* SPACE IS OBTAINED EACH TIME A SCALAR LIST IS THE     */ 07342000
*            /* VALUE OF THE PARAMETER BEING SCANNED.                */ 07343000
*            /*                                                      */ 07344000
*            /********************************************************/ 07345000
*            CALL ICKSAGP0(GDTTBL,AMTTOGET,DATAPTR,POOLID,SETZERO);     07346000
         L     @15,GDTPTR                                          1507 07347000
         ST    @15,@AL00001                                        1507 07348000
         LA    @14,AMTTOGET                                        1507 07349000
         ST    @14,@AL00001+4                                      1507 07350000
         LA    @14,DATAPTR                                         1507 07351000
         ST    @14,@AL00001+8                                      1507 07352000
         LA    @14,POOLID                                          1507 07353000
         ST    @14,@AL00001+12                                     1507 07354000
         LA    @14,@CC00153                                        1507 07355000
         ST    @14,@AL00001+16                                     1507 07356000
         MVI   @AL00001+16,X'80'                                   1507 07357000
         L     @15,GDTGPL(,@15)                                    1507 07358000
         LA    @01,@AL00001                                        1507 07359000
         BALR  @14,@15                                             1507 07360000
*            RESPECIFY RTNREG RSTD;                                1508 07361000
*            TESTRC = RTNREG;                                      1509 07362000
         STH   RTNREG,TESTRC                                       1509 07363000
*            RESPECIFY RTNREG UNRSTD;                              1510 07364000
*                                                                  1510 07365000
*            END;                                                  1511 07366000
*                                                                  1511 07367000
*          /**********************************************************/ 07368000
*          /*                                                        */ 07369000
*          /* SPACE FOR SCALAR (NOT SCALAR LIST) DATA STRUCTURES IS  */ 07370000
*          /* ALLOCATED FROM A LARGE BLOCK OF SPACE ALREADY OBTAINED,*/ 07371000
*          /* RATHER THAN ISSUING A 'GET SPACE' REQUEST FOR EACH     */ 07372000
*          /* STRUCTURE.  IF SPACE IN THE BLOCK HAS ALL BEEN USED,   */ 07373000
*          /* ANOTHER LARGE BLOCK IS OBTAINED.                       */ 07374000
*          /*                                                        */ 07375000
*          /**********************************************************/ 07376000
*          ELSE                                                    1512 07377000
*            DO;                                                   1512 07378000
         B     @RC01502                                            1512 07379000
@RF01502 DS    0H                                                  1513 07380000
*            IF BLKLEFT-SPACEAMT < 0                               1513 07381000
*              THEN                                                1513 07382000
         L     @15,BLKLEFT                                         1513 07383000
         SH    @15,SPACEAMT                                        1513 07384000
         LTR   @15,@15                                             1513 07385000
         BNM   @RF01513                                            1513 07386000
*                DO;                                               1514 07387000
*                BLKLEFT='400'X;                                   1515 07388000
*                                                                  1515 07389000
         LA    @15,1024                                            1515 07390000
         ST    @15,BLKLEFT                                         1515 07391000
*                CALL ICKSAGP0(GDTTBL,BLKLEFT,BLKPTR,POOLID,SETZERO);   07392000
         L     @15,GDTPTR                                          1516 07393000
         ST    @15,@AL00001                                        1516 07394000
         LA    @14,BLKLEFT                                         1516 07395000
         ST    @14,@AL00001+4                                      1516 07396000
         LA    @14,BLKPTR                                          1516 07397000
         ST    @14,@AL00001+8                                      1516 07398000
         LA    @14,POOLID                                          1516 07399000
         ST    @14,@AL00001+12                                     1516 07400000
         LA    @14,@CC00153                                        1516 07401000
         ST    @14,@AL00001+16                                     1516 07402000
         MVI   @AL00001+16,X'80'                                   1516 07403000
         L     @15,GDTGPL(,@15)                                    1516 07404000
         LA    @01,@AL00001                                        1516 07405000
         BALR  @14,@15                                             1516 07406000
*                RESPECIFY RTNREG RSTD;                            1517 07407000
*                TESTRC = RTNREG;                                  1518 07408000
         STH   RTNREG,TESTRC                                       1518 07409000
*                RESPECIFY RTNREG UNRSTD;                          1519 07410000
*                                                                  1519 07411000
*                END;                                              1520 07412000
*              ELSE                                                1521 07413000
*                TESTRC=0;                                         1521 07414000
         B     @RC01513                                            1521 07415000
@RF01513 SLR   @15,@15                                             1521 07416000
         STH   @15,TESTRC                                          1521 07417000
*            DATAPTR=BLKPTR;                                       1522 07418000
@RC01513 L     @15,BLKPTR                                          1522 07419000
         ST    @15,DATAPTR                                         1522 07420000
*            BLKPTR=BLKPTR+SPACEAMT+(FULLNGTH-SPACEAMT//FULLNGTH); 1523 07421000
         LH    @14,SPACEAMT                                        1523 07422000
         LR    @05,@15                                             1523 07423000
         ALR   @05,@14                                             1523 07424000
         SRDA  @14,32                                              1523 07425000
         D     @14,@CF00052                                        1523 07426000
         LCR   @14,@14                                             1523 07427000
         AL    @14,@CF00052                                        1523 07428000
         ALR   @05,@14                                             1523 07429000
         ST    @05,BLKPTR                                          1523 07430000
*            BLKLEFT=BLKLEFT-(BLKPTR-DATAPTR);                     1524 07431000
         L     @04,DATAPTR                                         1524 07432000
         SLR   @04,@05                                             1524 07433000
         AL    @04,BLKLEFT                                         1524 07434000
         ST    @04,BLKLEFT                                         1524 07435000
*            END;                                                  1525 07436000
*                                                                  1525 07437000
*        /************************************************************/ 07438000
*        /*                                                          */ 07439000
*        /* CHECK THAT THE SPACE WAS ALLOCATED PROPERLY, THEN STORE  */ 07440000
*        /* THE AREA PTR IN THE FDT.  IF THE SCALAR IS ASSOCIATED    */ 07441000
*        /* WITH A PARAMETER IN A REPEATED LIST, CALCULATE THE FDT   */ 07442000
*        /* LOCATION OF THE POINTER WHERE THE SPACE ADDRESS IS TO BE */ 07443000
*        /* STORED.                                                  */ 07444000
*        /*                                                          */ 07445000
*        /************************************************************/ 07446000
*        IF TESTRC ^= 0                                            1526 07447000
*          THEN                                                    1526 07448000
*                                                                  1526 07449000
@RC01502 LH    @15,TESTRC                                          1526 07450000
         LTR   @15,@15                                             1526 07451000
         BZ    @RF01526                                            1526 07452000
*            CALL ERROR1(NOSPACE);                                 1527 07453000
*                                                                  1527 07454000
         LA    @01,@AL01527                                        1527 07455000
         BAL   @14,ERROR1                                          1527 07456000
*          ELSE                                                    1528 07457000
*            IF OCCURNUM < 2                                       1528 07458000
*              THEN                                                1528 07459000
         B     @RC01526                                            1528 07460000
@RF01526 LH    @15,PARMID                                          1528 07461000
         LR    @14,@15                                             1528 07462000
         MH    @14,@CH00038                                        1528 07463000
         L     @01,WORKPTR                                         1528 07464000
         AL    @01,@CF01317                                        1528 07465000
         L     @01,PARMPTR(@14,@01)                                1528 07466000
         CLC   OCCURNUM(3,@01),@CF00124+1                          1528 07467000
         BNL   @RF01528                                            1528 07468000
*                FDTPTR(PARMID)=DATAPTR;                           1529 07469000
         SLA   @15,2                                               1529 07470000
         L     @14,DATAPTR                                         1529 07471000
         L     @01,FDTADDR                                         1529 07472000
         ST    @14,FDTPTR-4(@15,@01)                               1529 07473000
*              ELSE                                                1530 07474000
*                DO;                                               1530 07475000
         B     @RC01528                                            1530 07476000
@RF01528 DS    0H                                                  1531 07477000
*                ARRYPTR=FDTPTR(PARMID);                           1531 07478000
*                                                                  1531 07479000
         LH    @15,PARMID                                          1531 07480000
         SLA   @15,2                                               1531 07481000
         L     @01,FDTADDR                                         1531 07482000
         L     @15,FDTPTR-4(@15,@01)                               1531 07483000
         ST    @15,ARRYPTR                                         1531 07484000
*                CALL DSPLCALC(REPDEPTH);                          1532 07485000
*                                                                  1532 07486000
         LA    @15,REPDEPTH                                        1532 07487000
         ST    @15,@AL00001                                        1532 07488000
         LA    @01,@AL00001                                        1532 07489000
         BAL   @14,DSPLCALC                                        1532 07490000
*                REPPTR=DATAPTR;                                   1533 07491000
         LH    @15,ARRYDSPL                                        1533 07492000
         AL    @15,ARRYPTR                                         1533 07493000
         MVC   REPPTR(4,@15),DATAPTR                               1533 07494000
*                IF LIST=YES                                       1534 07495000
*                  THEN                                            1534 07496000
         LH    @14,PARMID                                          1534 07497000
         MH    @14,@CH00038                                        1534 07498000
         L     @01,WORKPTR                                         1534 07499000
         AL    @01,@CF01317                                        1534 07500000
         L     @01,PARMPTR(@14,@01)                                1534 07501000
         TM    LIST(@01),B'00001000'                               1534 07502000
         BNO   @RF01534                                            1534 07503000
*                    PTRLOC=ADDR(REPPTR);                          1535 07504000
         ST    @15,PTRLOC                                          1535 07505000
*                END;                                              1536 07506000
@RF01534 DS    0H                                                  1537 07507000
*        SPACELFT=AMTTOGET-FULLNGTH-SPACEAMT;                      1537 07508000
*                                                                  1537 07509000
@RC01528 DS    0H                                                  1537 07510000
@RC01526 L     @15,AMTTOGET                                        1537 07511000
         SL    @15,@CF00052                                        1537 07512000
         SH    @15,SPACEAMT                                        1537 07513000
         STH   @15,SPACELFT                                        1537 07514000
*        END GETSPACE;                                             1538 07515000
@EL00018 DS    0H                                                  1538 07516000
@EF00018 DS    0H                                                  1538 07517000
@ER00018 LM    @14,@12,@SA00018                                    1538 07518000
         BR    @14                                                 1538 07519000
*/********************************************************************/ 07520000
*/*                                                                  */ 07521000
*/*  PROCEDURE NAME - MORSPACE                                       */ 07522000
*/*                                                                  */ 07523000
*/*  FUNCTION - THIS ROUTINE ALLOCATES ADDITIONAL SPACE FOR AN FDT   */ 07524000
*/*             SCALAR LIST DATA STRUCTURE.                          */ 07525000
*/*                                                                  */ 07526000
*/*  INPUT -                                                         */ 07527000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 07528000
*/*          AMTTOGET- AMOUNT OF SPACE LAST ALLOCATED FOR THIS       */ 07529000
*/*                    SCALAR LIST DATA STRUCTURE                    */ 07530000
*/*          SPACELFT- UNUSED SPACE REMAINING FROM LAST ALLOCATION   */ 07531000
*/*          SPACEAMT- AMOUNT OF SPACE REQUIRED FOR EACH LIST ELEMENT*/ 07532000
*/*                    IN THE DATA STRUCTURE                         */ 07533000
*/*          DATAPTR - POINTER TO CURRENT DATA STRUCTURE LOCATION    */ 07534000
*/*                                                                  */ 07535000
*/*  OUTPUT -                                                        */ 07536000
*/*          FUNCTION DATA TABLE POINTER VECTOR ENTRY                */ 07537000
*/*          AMTTOGET- NEW AMOUNT OF SPACE TO BE ALLOCATED, WHICH    */ 07538000
*/*                    ALLOWS FOR LARGER SCALAR LIST DATA STRUCTURE  */ 07539000
*/*          LISTADDR- LOCATION OF NEW BLOCK OF SPACE                */ 07540000
*/*          SPACELFT- AMOUNT OF SPACE REMAINING IN NEW STORAGE BLOCK*/ 07541000
*/*                                                                  */ 07542000
*/********************************************************************/ 07543000
*MORSPACE:PROCEDURE;                                               1539 07544000
MORSPACE STM   @14,@12,@SA00019                                    1539 07545000
*        /************************************************************/ 07546000
*        /*                                                          */ 07547000
*        /* 'MORSPACE' ROUTINE DATA DEFINITIONS                      */ 07548000
*        /*                                                          */ 07549000
*        /************************************************************/ 07550000
*                                                                  1540 07551000
*        DCL OLDPTR   PTR(31);         /*PTR TO DATA TO BE MOVED FROM   07552000
*                                        DATA BLK THAT WAS TOO SMALL */ 07553000
*        DCL FREEPTR  PTR(31);         /*PTR TO OLD BLOCK OF SPACE 1541 07554000
*                                        TO BE FREED UP AFTER ITS  1541 07555000
*                                        DATA HAS BEEN COPIED.       */ 07556000
*        DCL NEWPTR   PTR(31);         /*PTR TO NEWLY ALLOCATED,   1542 07557000
*                                        LARGER DATA BLOCK           */ 07558000
*        DCL MOVELEN  FIXED(15);       /*AMOUNT OF DATA TO BE MOVED     07559000
*                                        IN A SINGLE DATA MOVE       */ 07560000
*        DCL AMTUSED  FIXED(15);       /*AMOUNT OF OLD DATA BLOCK THAT  07561000
*                                        WAS 'STORED INTO' BEFORE  1544 07562000
*                                        SPACE RAN OUT.              */ 07563000
*        /************************************************************/ 07564000
*        /*                                                          */ 07565000
*        /*  ** MORSPACE **  ALLOCATE MORE SPACE FOR FDT DATA        */ 07566000
*        /*                                                          */ 07567000
*        /************************************************************/ 07568000
*        IF GDTDBG = NULLPTR                                       1545 07569000
*          THEN;                                                   1545 07570000
         L     @01,GDTPTR                                          1545 07571000
         L     @15,GDTDBG(,@01)                                    1545 07572000
         LTR   @15,@15                                             1545 07573000
         BZ    @RT01545                                            1545 07574000
*          ELSE                                                    1547 07575000
*            CALL ICKDB010(GDTTBL,'RIMC');                         1547 07576000
*                                                                  1547 07577000
         L     @15,GDTPTR                                          1547 07578000
         ST    @15,@AL00001                                        1547 07579000
         LA    @14,@CC01125                                        1547 07580000
         ST    @14,@AL00001+4                                      1547 07581000
         MVI   @AL00001+4,X'80'                                    1547 07582000
         L     @15,GDTDBG(,@15)                                    1547 07583000
         LA    @01,@AL00001                                        1547 07584000
         BALR  @14,@15                                             1547 07585000
*        /************************************************************/ 07586000
*        /*                                                          */ 07587000
*        /* COMPUTE AMOUNT OF SPACE USED IN OLD DATA BLOCK AND SIZE  */ 07588000
*        /* OF THE NEW, LARGER BLOCK TO BE OBTAINED.                 */ 07589000
*        /*                                                          */ 07590000
*        /************************************************************/ 07591000
*        AMTUSED=AMTTOGET-SPACELFT-SPACEAMT;                       1548 07592000
@RT01545 LH    @15,SPACEAMT                                        1548 07593000
         L     @14,AMTTOGET                                        1548 07594000
         LR    @05,@14                                             1548 07595000
         SH    @05,SPACELFT                                        1548 07596000
         SLR   @05,@15                                             1548 07597000
         STH   @05,AMTUSED                                         1548 07598000
*        OLDPTR=DATAPTR;                                           1549 07599000
         L     @05,DATAPTR                                         1549 07600000
         ST    @05,OLDPTR                                          1549 07601000
*        FREEPTR=DATAPTR;                                          1550 07602000
         ST    @05,FREEPTR                                         1550 07603000
*        AMTTOGET=AMTTOGET+SPACEAMT*2;                             1551 07604000
*                                                                  1551 07605000
         ALR   @15,@15                                             1551 07606000
         ALR   @14,@15                                             1551 07607000
         ST    @14,AMTTOGET                                        1551 07608000
*        /************************************************************/ 07609000
*        /*                                                          */ 07610000
*        /* REQUEST THE DESIRED SPACE.  IF OBTAINED OKAY, SET UP     */ 07611000
*        /* POINTER TO THE AREA.                                     */ 07612000
*        /*                                                          */ 07613000
*        /************************************************************/ 07614000
*                                                                  1552 07615000
*        CALL ICKSAGP0(GDTTBL,AMTTOGET,DATAPTR,POOLID,SETZERO);    1552 07616000
         L     @15,GDTPTR                                          1552 07617000
         ST    @15,@AL00001                                        1552 07618000
         LA    @14,AMTTOGET                                        1552 07619000
         ST    @14,@AL00001+4                                      1552 07620000
         LA    @14,DATAPTR                                         1552 07621000
         ST    @14,@AL00001+8                                      1552 07622000
         LA    @14,POOLID                                          1552 07623000
         ST    @14,@AL00001+12                                     1552 07624000
         LA    @14,@CC00153                                        1552 07625000
         ST    @14,@AL00001+16                                     1552 07626000
         MVI   @AL00001+16,X'80'                                   1552 07627000
         L     @15,GDTGPL(,@15)                                    1552 07628000
         LA    @01,@AL00001                                        1552 07629000
         BALR  @14,@15                                             1552 07630000
*        RESPECIFY RTNREG RSTD;                                    1553 07631000
*        TESTRC = RTNREG;                                          1554 07632000
         STH   RTNREG,TESTRC                                       1554 07633000
*        RESPECIFY RTNREG UNRSTD;                                  1555 07634000
*                                                                  1555 07635000
*        IF TESTRC ^= 0                                            1556 07636000
*          THEN                                                    1556 07637000
*                                                                  1556 07638000
         LH    @15,TESTRC                                          1556 07639000
         LTR   @15,@15                                             1556 07640000
         BZ    @RF01556                                            1556 07641000
*            CALL ERROR1(NOSPACE);                                 1557 07642000
*                                                                  1557 07643000
         LA    @01,@AL01557                                        1557 07644000
         BAL   @14,ERROR1                                          1557 07645000
*          ELSE                                                    1558 07646000
*DOGRP107:   DO;                                                   1558 07647000
         B     @RC01556                                            1558 07648000
@RF01556 DS    0H                                                  1558 07649000
DOGRP107 DS    0H                                                  1559 07650000
*            IF OCCURNUM < 2                                       1559 07651000
*              THEN                                                1559 07652000
         LH    @15,PARMID                                          1559 07653000
         LR    @14,@15                                             1559 07654000
         MH    @14,@CH00038                                        1559 07655000
         L     @01,WORKPTR                                         1559 07656000
         AL    @01,@CF01317                                        1559 07657000
         L     @01,PARMPTR(@14,@01)                                1559 07658000
         CLC   OCCURNUM(3,@01),@CF00124+1                          1559 07659000
         BNL   @RF01559                                            1559 07660000
*                FDTPTR(PARMID)=DATAPTR;                           1560 07661000
         SLA   @15,2                                               1560 07662000
         L     @14,DATAPTR                                         1560 07663000
         L     @01,FDTADDR                                         1560 07664000
         ST    @14,FDTPTR-4(@15,@01)                               1560 07665000
*              ELSE                                                1561 07666000
*                LISTADDR=DATAPTR;                                 1561 07667000
         B     @RC01559                                            1561 07668000
@RF01559 L     @01,PTRLOC                                          1561 07669000
         MVC   LISTADDR(4,@01),DATAPTR                             1561 07670000
*            SPACELFT=AMTTOGET-AMTUSED-SPACEAMT;                   1562 07671000
*                                                                  1562 07672000
@RC01559 L     @15,AMTTOGET                                        1562 07673000
         SH    @15,AMTUSED                                         1562 07674000
         SH    @15,SPACEAMT                                        1562 07675000
         STH   @15,SPACELFT                                        1562 07676000
*            /********************************************************/ 07677000
*            /*                                                      */ 07678000
*            /* MOVE DATA FROM THE OLD, SMALLER DATA BLOCK INTO THE  */ 07679000
*            /* NEW DATA BLOCK.  THEN FREE THE OLD DATA BLOCK.       */ 07680000
*            /*                                                      */ 07681000
*            /********************************************************/ 07682000
*            NEWPTR=DATAPTR;                                       1563 07683000
         MVC   NEWPTR(4),DATAPTR                                   1563 07684000
*            DO WHILE(AMTUSED > 0);                                1564 07685000
         B     @DE01564                                            1564 07686000
@DL01564 DS    0H                                                  1565 07687000
*              MOVELEN=MIN(256,AMTUSED);                           1565 07688000
         LH    @15,AMTUSED                                         1565 07689000
         LA    @14,256                                             1565 07690000
         CR    @14,@15                                             1565 07691000
         BNH   *+6                                                      07692000
         LR    @14,@15                                             1565 07693000
         STH   @14,MOVELEN                                         1565 07694000
*              NEWPTR->DATABLK(1:MOVELEN)=                         1566 07695000
*                OLDPTR->DATABLK(1:MOVELEN);                       1566 07696000
         L     @05,NEWPTR                                          1566 07697000
         LR    @04,@14                                             1566 07698000
         BCTR  @04,0                                               1566 07699000
         L     @03,OLDPTR                                          1566 07700000
         EX    @04,@SM01374                                        1566 07701000
*              NEWPTR=NEWPTR+MOVELEN;                              1567 07702000
         ALR   @05,@14                                             1567 07703000
         ST    @05,NEWPTR                                          1567 07704000
*              OLDPTR=OLDPTR+MOVELEN;                              1568 07705000
         ALR   @03,@14                                             1568 07706000
         ST    @03,OLDPTR                                          1568 07707000
*              AMTUSED=AMTUSED-MOVELEN;                            1569 07708000
         SLR   @15,@14                                             1569 07709000
         STH   @15,AMTUSED                                         1569 07710000
*            END;                                                  1570 07711000
*                                                                  1570 07712000
@DE01564 LH    @15,AMTUSED                                         1570 07713000
         LTR   @15,@15                                             1570 07714000
         BP    @DL01564                                            1570 07715000
*            CALL ICKSAFS0(GDTTBL,FREEPTR);                        1571 07716000
*                                                                  1571 07717000
         L     @15,GDTPTR                                          1571 07718000
         ST    @15,@AL00001                                        1571 07719000
         LA    @14,FREEPTR                                         1571 07720000
         ST    @14,@AL00001+4                                      1571 07721000
         L     @15,GDTFSP(,@15)                                    1571 07722000
         LA    @01,@AL00001                                        1571 07723000
         BALR  @14,@15                                             1571 07724000
*            END DOGRP107;                                         1572 07725000
*                                                                  1572 07726000
*        END MORSPACE;                                             1573 07727000
*                                                                  1573 07728000
*                                                                  1573 07729000
@EL00019 DS    0H                                                  1573 07730000
@EF00019 DS    0H                                                  1573 07731000
@ER00019 LM    @14,@12,@SA00019                                    1573 07732000
         BR    @14                                                 1573 07733000
*        END BUILDFDT;                                             1574 07734000
         B     @EL00014                                            1574 07735000
*/********************************************************************/ 07736000
*/*                                                                  */ 07737000
*/*  PROCEDURE NAME - INREPEAT                                       */ 07738000
*/*                                                                  */ 07739000
*/*  FUNCTION - THIS ROUTINE IS INVOKED WHEN THE END OF ONE OF THE   */ 07740000
*/*             SUBLISTS OF A REPEATED SUBPARAMETER LIST HAS BEEN    */ 07741000
*/*             REACHED.  DEFAULTS ARE APPLIED TO THE SUBLIST JUST   */ 07742000
*/*             COMPLETED, AND SEMANTIC CHECKING IS PERFORMED ON IT. */ 07743000
*/*             CHECKING IS THEN DONE TO SEE WHETHER ANOTHER SUBLIST */ 07744000
*/*             FOLLOWS OR WHETHER THIS WAS THE LAST OF THE SUBLISTS */ 07745000
*/*             AT THIS LEVEL OF REPEATED SUBLIST NESTING.  COUNTS   */ 07746000
*/*             INDICATING CURRENT SCAN POSITION AND THE SUBLIST     */ 07747000
*/*             OCCURRENCE TOTAL ARE ALSO UPDATED AT THIS TIME.      */ 07748000
*/*                                                                  */ 07749000
*/*  INPUT -                                                         */ 07750000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 07751000
*/*          SUPERID - PARAMETER ID# OF THE PARAMETER WHOSE REPEATED */ 07752000
*/*                    SUBLISTS ARE BEING SCANNED                    */ 07753000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */ 07754000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 07755000
*/*                    CODE WHEN AN ERROR IS FOUND.                  */ 07756000
*/*          CHAR1 -   MOST RECENTLY EXTRACTED INPUT CHARACTER       */ 07757000
*/*          REPCOUNT- NUMBER OF REPETITIONS OF THIS PARAMETER'S     */ 07758000
*/*                    SUBLIST FOUND THUS FAR                        */ 07759000
*/*          REPLIMIT- MAXIMUM REPETITIONS ALLOWED OF THIS PARM'S    */ 07760000
*/*                    SUBPARAMETER LIST                             */ 07761000
*/*          REPDEPTH- LEVEL OF REPEATED SUBLIST NESTING AT WHICH    */ 07762000
*/*                    SCANNING IS CURRENTLY TAKING PLACE            */ 07763000
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */ 07764000
*/*                    SCANNING IS CURRENTLY TAKING PLACE            */ 07765000
*/*                                                                  */ 07766000
*/*  OUTPUT -                                                        */ 07767000
*/*          PARMID -  PARAMETER ID# OF PARAMETER WHOSE REPEATED     */ 07768000
*/*                    SUBLISTS ARE BEING SCANNED.                   */ 07769000
*/*          PARMFLAG- FLAGS IN 'PARMINFO'; PARMFLAG(N) IS           */ 07770000
*/*                    SET 'ON' WHEN THE PARM WHOSE ID#=N            */ 07771000
*/*                    IS INPUT.                                     */ 07772000
*/*          SUBSYET - FLAG SET 'ON' WHEN AT LEAST 1 SUBPARAMETER    */ 07773000
*/*                    HAS BEEN FOUND IN CURRENT SUBPARM. LIST       */ 07774000
*/*          REPCOUNT- SEE 'INPUT'                                   */ 07775000
*/*          ARRYPTR - POINTER TO FDT POINTER VECTOR                 */ 07776000
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND IN      */ 07777000
*/*                    CURRENT SUBPARAMETER LIST.                    */ 07778000
*/*          PARMLVL - SEE 'INPUT'                                   */ 07779000
*/*          FUNCTION DATA TABLE DATA ENTRY                          */ 07780000
*/*                                                                  */ 07781000
*/********************************************************************/ 07782000
*INREPEAT:PROCEDURE;                                               1575 07783000
INREPEAT STM   @14,@12,@SA00020                                    1575 07784000
*        /************************************************************/ 07785000
*        /*                                                          */ 07786000
*        /* INREPEAT PROCEDURE DATA DEFINITIONS                      */ 07787000
*        /*                                                          */ 07788000
*        /************************************************************/ 07789000
*                                                                  1576 07790000
*        /* STATIC ERROR MESSAGE CODES                               */ 07791000
*        DCL REPERR   FIXED(31)        /*TOO MANY REPEATED SUBLISTS  */ 07792000
*                     CONSTANT(19);                                1576 07793000
*                                                                  1576 07794000
*        DCL SUBOCCUR FIXED(31);       /*NUMBER OF TIMES A PARAMETER    07795000
*                                        IN A REPEATED SUBLIST MAY 1577 07796000
*                                        APPEAR.                     */ 07797000
*          /**********************************************************/ 07798000
*          /*                                                        */ 07799000
*          /*  ** INREPEAT **  HANDLE REPEATED SUBLIST END           */ 07800000
*          /*                                                        */ 07801000
*          /**********************************************************/ 07802000
*          IF GDTDBG = NULLPTR                                     1578 07803000
*            THEN;                                                 1578 07804000
         L     @01,GDTPTR                                          1578 07805000
         L     @15,GDTDBG(,@01)                                    1578 07806000
         LTR   @15,@15                                             1578 07807000
         BZ    @RT01578                                            1578 07808000
*            ELSE                                                  1580 07809000
*              CALL ICKDB010(GDTTBL,'RIIR');                       1580 07810000
*                                                                  1580 07811000
         L     @15,GDTPTR                                          1580 07812000
         ST    @15,@AL00001                                        1580 07813000
         LA    @14,@CC01133                                        1580 07814000
         ST    @14,@AL00001+4                                      1580 07815000
         MVI   @AL00001+4,X'80'                                    1580 07816000
         L     @15,GDTDBG(,@15)                                    1580 07817000
         LA    @01,@AL00001                                        1580 07818000
         BALR  @14,@15                                             1580 07819000
*          /**********************************************************/ 07820000
*          /*                                                        */ 07821000
*          /* APPLY DEFAULTS AND PERFORM SEMANTIC CHECKING ON THE    */ 07822000
*          /* REPEATED SUBLIST JUST FINISHED.                        */ 07823000
*          /*                                                        */ 07824000
*          /**********************************************************/ 07825000
*                                                                  1581 07826000
*          CALL DEFAULTS;                                          1581 07827000
@RT01578 BAL   @14,DEFAULTS                                        1581 07828000
*          CALL NEEDNOTS;                                          1582 07829000
         BAL   @14,NEEDNOTS                                        1582 07830000
*          CALL SCANSEP(YES);                                      1583 07831000
*                                                                  1583 07832000
         LA    @01,@AL01583                                        1583 07833000
         BAL   @14,SCANSEP                                         1583 07834000
*          IF RISTATUS^=0 | ONEREP(REPDEPTH)=YES                   1584 07835000
*            THEN                                                  1584 07836000
         LH    @15,RISTATUS                                        1584 07837000
         LTR   @15,@15                                             1584 07838000
         BNZ   @RT01584                                            1584 07839000
         LH    @01,REPDEPTH                                        1584 07840000
         LA    @15,ONEREP-1(@01)                                   1584 07841000
         TM    0(@15),B'10000000'                                  1584 07842000
         BNO   @RF01584                                            1584 07843000
@RT01584 DS    0H                                                  1585 07844000
*              DO;                                                 1585 07845000
*              REPDEPTH=REPDEPTH-1;                                1586 07846000
         LH    @15,REPDEPTH                                        1586 07847000
         BCTR  @15,0                                               1586 07848000
         STH   @15,REPDEPTH                                        1586 07849000
*              PARMLVL=PARMLVL-1;                                  1587 07850000
         LH    @15,PARMLVL                                         1587 07851000
         BCTR  @15,0                                               1587 07852000
         STH   @15,PARMLVL                                         1587 07853000
*              RETURN;                                             1588 07854000
@EL00020 DS    0H                                                  1588 07855000
@EF00020 DS    0H                                                  1588 07856000
@ER00020 LM    @14,@12,@SA00020                                    1588 07857000
         BR    @14                                                 1588 07858000
*              END;                                                1589 07859000
*                                                                  1589 07860000
*          PARMID=SUPERID(PARMLVL);                                1590 07861000
*                                                                  1590 07862000
@RF01584 LH    @15,PARMLVL                                         1590 07863000
         ALR   @15,@15                                             1590 07864000
         LH    @15,SUPERID-2(@15)                                  1590 07865000
         STH   @15,PARMID                                          1590 07866000
*          /**********************************************************/ 07867000
*          /*                                                        */ 07868000
*          /* RESET PARAMETER OCCURRENCE FLAGS FOR PARAMETERS IN THE */ 07869000
*          /* SUBLIST JUST COMPLETED.                                */ 07870000
*          /*                                                        */ 07871000
*          /**********************************************************/ 07872000
*          DO LISTINDX=1 TO MAXID;                                 1591 07873000
         LA    @15,1                                               1591 07874000
         B     @DE01591                                            1591 07875000
@DL01591 DS    0H                                                  1592 07876000
*            IF PARMPTR(LISTINDX) ^= NULLPTR                       1592 07877000
*              THEN                                                1592 07878000
         LR    @14,@15                                             1592 07879000
         MH    @14,@CH00038                                        1592 07880000
         L     @01,WORKPTR                                         1592 07881000
         AL    @01,@CF01317                                        1592 07882000
         L     @14,PARMPTR(@14,@01)                                1592 07883000
         LTR   @14,@14                                             1592 07884000
         BZ    @RF01592                                            1592 07885000
*                DO;                                               1593 07886000
*                  OLDERID2 = NEWERID2;                            1594 07887000
         L     @01,GDTPTR                                          1594 07888000
         L     @14,GDTTR2(,@01)                                    1594 07889000
         MVC   @TS00001(95),NEWERID2(@14)                          1594 07890000
         MVC   OLDERID2(95,@14),@TS00001                           1594 07891000
*                  NEWID2='RI35';                                  1595 07892000
         MVC   NEWID2(4,@14),@CC01134                              1595 07893000
*                  TESTID=LISTINDX;                                1596 07894000
         STH   @15,TESTID                                          1596 07895000
*                  DO WHILE(TESTID^=0);                            1597 07896000
         B     @DE01597                                            1597 07897000
@DL01597 DS    0H                                                  1598 07898000
*                    IF SUPRPARM(TESTID)=PARMID                    1598 07899000
*                      THEN                                        1598 07900000
         L     @15,WORKPTR                                         1598 07901000
         LA    @14,12                                              1598 07902000
         LR    @05,@14                                             1598 07903000
         MH    @05,TESTID                                          1598 07904000
         AL    @05,@CF01318                                        1598 07905000
         LH    @05,SUPRPARM-8(@05,@15)                             1598 07906000
         CH    @05,PARMID                                          1598 07907000
         BNE   @RF01598                                            1598 07908000
*                        PARMFLAG(LISTINDX)=0;                     1599 07909000
         MH    @14,LISTINDX                                        1599 07910000
         SLR   @05,@05                                             1599 07911000
         BCTR  @15,0                                               1599 07912000
         BCTR  @15,0                                               1599 07913000
         STC   @05,PARMFLAG-10(@14,@15)                            1599 07914000
*                    TESTID=SUPRPARM(TESTID);                      1600 07915000
@RF01598 LH    @15,TESTID                                          1600 07916000
         MH    @15,@CH00038                                        1600 07917000
         L     @01,WORKPTR                                         1600 07918000
         AL    @01,@CF01318                                        1600 07919000
         LH    @15,SUPRPARM-8(@15,@01)                             1600 07920000
         STH   @15,TESTID                                          1600 07921000
*                  END;                                            1601 07922000
@DE01597 LH    @15,TESTID                                          1601 07923000
         LTR   @15,@15                                             1601 07924000
         BNZ   @DL01597                                            1601 07925000
*                END;                                              1602 07926000
*          END;                                                    1603 07927000
*                                                                  1603 07928000
@RF01592 LA    @15,1                                               1603 07929000
         AH    @15,LISTINDX                                        1603 07930000
@DE01591 STH   @15,LISTINDX                                        1603 07931000
         L     @14,DESCPTR                                         1603 07932000
         CH    @15,MAXID(,@14)                                     1603 07933000
         BNH   @DL01591                                            1603 07934000
*          /**********************************************************/ 07935000
*          /*                                                        */ 07936000
*          /* IF ANOTHER SUBLIST FOLLOWS, BYPASS DELIMITERS PREPARING*/ 07937000
*          /* TO SCAN NEW SUBLIST AND UPDATE LIST OCCURRENCE COUNTS. */ 07938000
*          /* ALSO CHECK TO BE SURE THAT TOO MANY SUBLISTS HAVE NOT  */ 07939000
*          /* BEEN INPUT.                                            */ 07940000
*          /*                                                        */ 07941000
*          /**********************************************************/ 07942000
*          IF CHAR1=OPENING                                        1604 07943000
*            THEN                                                  1604 07944000
         CLI   CHAR1,C'('                                          1604 07945000
         BNE   @RF01604                                            1604 07946000
*DOGRP108:     DO;                                                 1605 07947000
*                                                                  1605 07948000
DOGRP108 DS    0H                                                  1606 07949000
*                CALL NEXTCHAR;                                    1606 07950000
         BAL   @14,NEXTCHAR                                        1606 07951000
*                CALL SCANSEP(NO);                                 1607 07952000
*                                                                  1607 07953000
         LA    @01,@AL01607                                        1607 07954000
         BAL   @14,SCANSEP                                         1607 07955000
*                SUBSYET=NO;                                       1608 07956000
         NI    SUBSYET,B'11101111'                                 1608 07957000
*                REPCOUNT(REPDEPTH)=REPCOUNT(REPDEPTH)+1;          1609 07958000
         LH    @15,REPDEPTH                                        1609 07959000
         ALR   @15,@15                                             1609 07960000
         LA    @14,1                                               1609 07961000
         AH    @14,REPCOUNT-2(@15)                                 1609 07962000
         STH   @14,REPCOUNT-2(@15)                                 1609 07963000
*                IF REPCOUNT(REPDEPTH) > REPLIMIT(REPDEPTH)        1610 07964000
*                  THEN                                            1610 07965000
*                                                                  1610 07966000
         CH    @14,REPLIMIT-2(@15)                                 1610 07967000
         BNH   @RF01610                                            1610 07968000
*                    CALL ERROR1(REPERR);                          1611 07969000
*                                                                  1611 07970000
         LA    @01,@AL01611                                        1611 07971000
         BAL   @14,ERROR1                                          1611 07972000
*                  ELSE                                            1612 07973000
*DOGRP109:           DO;                                           1612 07974000
*                                                                  1612 07975000
         B     @RC01610                                            1612 07976000
@RF01610 DS    0H                                                  1612 07977000
DOGRP109 DS    0H                                                  1613 07978000
*                    /************************************************/ 07979000
*                    /*                                              */ 07980000
*                    /* IF THE CURRENT REPEATED LIST IS NOT NESTED   */ 07981000
*                    /* WITHIN ANY OTHER REPEATED SUBLIST, THEN A    */ 07982000
*                    /* LIST OF POINTER BLOCKS IS BEING MAINTAINED   */ 07983000
*                    /* TO POINT TO SCALAR DATA OF PARAMETERS WITHIN */ 07984000
*                    /* THIS REPEATED SUBLIST.  ALLOCATE ANOTHER     */ 07985000
*                    /* BLOCK OF POINTERS FOR EACH SUBPARM IN THE    */ 07986000
*                    /* SUBLIST IF ENOUGH REPETITIONS OF THE SUBLIST */ 07987000
*                    /* HAVE OCCURRED TO REQUIRE THIS.               */ 07988000
*                    /*                                              */ 07989000
*                    /************************************************/ 07990000
*                    SUBOCCUR=REPMAX;                              1613 07991000
         LA    @15,12                                              1613 07992000
         LR    @14,@15                                             1613 07993000
         MH    @14,PARMID                                          1613 07994000
         L     @01,WORKPTR                                         1613 07995000
         AL    @01,@CF01317                                        1613 07996000
         AL    @15,PARMPTR(@14,@01)                                1613 07997000
         SLR   @14,@14                                             1613 07998000
         IC    @14,REPMAX(,@15)                                    1613 07999000
         ST    @14,SUBOCCUR                                        1613 08000000
*                    IF REPDEPTH=1 &                               1614 08001000
*                       REPCOUNT(REPDEPTH)//(VECTRSIZ-1)=1         1614 08002000
*                      THEN                                        1614 08003000
         LH    @15,REPDEPTH                                        1614 08004000
         LA    @14,1                                               1614 08005000
         CR    @15,@14                                             1614 08006000
         BNE   @RF01614                                            1614 08007000
         ALR   @15,@15                                             1614 08008000
         LH    @00,REPCOUNT-2(@15)                                 1614 08009000
         SRDA  @00,32                                              1614 08010000
         D     @00,@CF00042                                        1614 08011000
         CR    @00,@14                                             1614 08012000
         BNE   @RF01614                                            1614 08013000
*DOLOOP17:               DO VLISTID=1 TO MAXID WHILE(RISTATUS=0);  1615 08014000
DOLOOP17 LA    @15,1                                               1615 08015000
         B     @DE01615                                            1615 08016000
@DL01615 SLR   @14,@14                                             1615 08017000
         CH    @14,RISTATUS                                        1615 08018000
         BNE   @DC01615                                            1615 08019000
*                          IF PARMPTR(VLISTID) ^= NULLPTR &        1616 08020000
*                             PARMPTR(VLISTID)->OCCURNUM = SUBOCCUR     08021000
*                            THEN                                  1616 08022000
         MH    @15,@CH00038                                        1616 08023000
         L     @01,WORKPTR                                         1616 08024000
         AL    @01,@CF01317                                        1616 08025000
         L     @15,PARMPTR(@15,@01)                                1616 08026000
         CR    @15,@14                                             1616 08027000
         BE    @RF01616                                            1616 08028000
         L     @15,OCCURNUM-1(,@15)                                1616 08029000
         LA    @15,0(,@15)                                         1616 08030000
         C     @15,SUBOCCUR                                        1616 08031000
         BNE   @RF01616                                            1616 08032000
*DOGRP111:                     DO;                                 1617 08033000
DOGRP111 DS    0H                                                  1618 08034000
*                                TESTID=VLISTID;                   1618 08035000
*                                                                  1618 08036000
         MVC   TESTID(2),VLISTID                                   1618 08037000
*                                /************************************/ 08038000
*                                /*                                  */ 08039000
*                                /* DETERMINE WHETHER THIS PARAMETER */ 08040000
*                                /* IS ONE OF THE PARM'S NEEDING MORE*/ 08041000
*                                /* DATA POINTERS & IF SO ADD ANOTHER*/ 08042000
*                                /* BLOCK OF POINTERS TO THE LIST.   */ 08043000
*                                /*                                  */ 08044000
*                                /************************************/ 08045000
*DOLOOP18:                       DO WHILE(TESTID^=0 & RISTATUS=0); 1619 08046000
DOLOOP18 B     @DE01619                                            1619 08047000
@DL01619 DS    0H                                                  1620 08048000
*                                  IF SUPRPARM(TESTID) = PARMID    1620 08049000
*                                    THEN                          1620 08050000
         LH    @15,TESTID                                          1620 08051000
         MH    @15,@CH00038                                        1620 08052000
         L     @01,WORKPTR                                         1620 08053000
         AL    @01,@CF01318                                        1620 08054000
         LH    @15,SUPRPARM-8(@15,@01)                             1620 08055000
         CH    @15,PARMID                                          1620 08056000
         BNE   @RF01620                                            1620 08057000
*                                      DO;                         1621 08058000
*                                        ARRYPTR=FDTPTR(VLISTID);  1622 08059000
         LH    @15,VLISTID                                         1622 08060000
         SLA   @15,2                                               1622 08061000
         L     @01,FDTADDR                                         1622 08062000
         L     @15,FDTPTR-4(@15,@01)                               1622 08063000
         ST    @15,ARRYPTR                                         1622 08064000
*                                        DO WHILE(VECTRPTR ^= 0);  1623 08065000
         B     @DE01623                                            1623 08066000
@DL01623 DS    0H                                                  1624 08067000
*                                          ARRYPTR=VECTRPTR;       1624 08068000
         LH    @15,VECTRLEN                                        1624 08069000
         AL    @15,ARRYPTR                                         1624 08070000
         L     @15,VECTRPTR(,@15)                                  1624 08071000
         ST    @15,ARRYPTR                                         1624 08072000
*                                        END;                      1625 08073000
@DE01623 LH    @15,VECTRLEN                                        1625 08074000
         AL    @15,ARRYPTR                                         1625 08075000
         L     @14,VECTRPTR(,@15)                                  1625 08076000
         LTR   @14,@14                                             1625 08077000
         BNZ   @DL01623                                            1625 08078000
*                                        AMTTOGET=VECTRSIZ*PTRLNGTH;    08079000
*                                                                  1626 08080000
         MVC   AMTTOGET(4),@CF01297                                1626 08081000
*                                        CALL ICKSAGP0(GDTTBL,AMTTOGET, 08082000
*                                               VECTRPTR,RIPOOLID, 1627 08083000
*                                               SETZERO);          1627 08084000
         L     @14,GDTPTR                                          1627 08085000
         ST    @14,@AL00001                                        1627 08086000
         LA    @05,AMTTOGET                                        1627 08087000
         ST    @05,@AL00001+4                                      1627 08088000
         ST    @15,@AL00001+8                                      1627 08089000
         LA    @15,RIPOOLID                                        1627 08090000
         ST    @15,@AL00001+12                                     1627 08091000
         LA    @15,@CC00153                                        1627 08092000
         ST    @15,@AL00001+16                                     1627 08093000
         MVI   @AL00001+16,X'80'                                   1627 08094000
         L     @15,GDTGPL(,@14)                                    1627 08095000
         LA    @01,@AL00001                                        1627 08096000
         BALR  @14,@15                                             1627 08097000
*                                        RESPECIFY RTNREG RSTD;    1628 08098000
*                                        TESTRC = RTNREG;          1629 08099000
         STH   RTNREG,TESTRC                                       1629 08100000
*                                        RESPECIFY RTNREG UNRSTD;  1630 08101000
*                                                                  1630 08102000
*                                        IF TESTRC^=0              1631 08103000
*                                          THEN                    1631 08104000
*                                                                  1631 08105000
         LH    @15,TESTRC                                          1631 08106000
         LTR   @15,@15                                             1631 08107000
         BZ    @RF01631                                            1631 08108000
*                                            CALL ERROR1(NOSPACE); 1632 08109000
*                                                                  1632 08110000
         LA    @01,@AL01632                                        1632 08111000
         BAL   @14,ERROR1                                          1632 08112000
*                                          ELSE                    1633 08113000
*                                            TESTID=0;             1633 08114000
         B     @RC01631                                            1633 08115000
@RF01631 SLR   @15,@15                                             1633 08116000
         STH   @15,TESTID                                          1633 08117000
*                                      END;                        1634 08118000
*                                    ELSE                          1635 08119000
*                                      TESTID=SUPRPARM(TESTID);    1635 08120000
         B     @RC01620                                            1635 08121000
@RF01620 LH    @15,TESTID                                          1635 08122000
         MH    @15,@CH00038                                        1635 08123000
         L     @01,WORKPTR                                         1635 08124000
         AL    @01,@CF01318                                        1635 08125000
         LH    @15,SUPRPARM-8(@15,@01)                             1635 08126000
         STH   @15,TESTID                                          1635 08127000
*                                END DOLOOP18;                     1636 08128000
@RC01620 DS    0H                                                  1636 08129000
@DE01619 SLR   @15,@15                                             1636 08130000
         CH    @15,TESTID                                          1636 08131000
         BE    @DC01619                                            1636 08132000
         CH    @15,RISTATUS                                        1636 08133000
         BE    @DL01619                                            1636 08134000
@DC01619 DS    0H                                                  1637 08135000
*                              END DOGRP111;                       1637 08136000
*                        END DOLOOP17;                             1638 08137000
*                                                                  1638 08138000
@RF01616 LA    @15,1                                               1638 08139000
         AH    @15,VLISTID                                         1638 08140000
@DE01615 STH   @15,VLISTID                                         1638 08141000
         L     @14,DESCPTR                                         1638 08142000
         CH    @15,MAXID(,@14)                                     1638 08143000
         BNH   @DL01615                                            1638 08144000
@DC01615 DS    0H                                                  1639 08145000
*                    /************************************************/ 08146000
*                    /*                                              */ 08147000
*                    /* INCREMENT THE COUNTER VALUE IN THE FDT THAT  */ 08148000
*                    /* PERTAINS TO THE NUMBER OF REPEATED SUBLIST   */ 08149000
*                    /* REPETITIONS.                                 */ 08150000
*                    /*                                              */ 08151000
*                    /************************************************/ 08152000
*                    ARRYPTR=FDTPTR(SUPERID(PARMLVL));             1639 08153000
@RF01614 LH    @15,PARMLVL                                         1639 08154000
         ALR   @15,@15                                             1639 08155000
         LH    @15,SUPERID-2(@15)                                  1639 08156000
         SLA   @15,2                                               1639 08157000
         L     @01,FDTADDR                                         1639 08158000
         L     @15,FDTPTR-4(@15,@01)                               1639 08159000
         ST    @15,ARRYPTR                                         1639 08160000
*                    HWORDARG=REPDEPTH-1;                          1640 08161000
*                                                                  1640 08162000
         LH    @15,REPDEPTH                                        1640 08163000
         BCTR  @15,0                                               1640 08164000
         STH   @15,HWORDARG                                        1640 08165000
*                    CALL DSPLCALC(HWORDARG);                      1641 08166000
*                                                                  1641 08167000
         LA    @15,HWORDARG                                        1641 08168000
         ST    @15,@AL00001                                        1641 08169000
         LA    @01,@AL00001                                        1641 08170000
         BAL   @14,DSPLCALC                                        1641 08171000
*                    REPTOTAL=REPTOTAL+1;                          1642 08172000
         LH    @15,ARRYDSPL                                        1642 08173000
         AL    @15,ARRYPTR                                         1642 08174000
         LA    @14,1                                               1642 08175000
         L     @05,REPTOTAL(,@15)                                  1642 08176000
         ALR   @05,@14                                             1642 08177000
         ST    @05,REPTOTAL(,@15)                                  1642 08178000
*                    PPARMCNT(PARMLVL)=1;                          1643 08179000
         LH    @15,PARMLVL                                         1643 08180000
         ALR   @15,@15                                             1643 08181000
         STH   @14,PPARMCNT-2(@15)                                 1643 08182000
*                  END DOGRP109;                                   1644 08183000
*              END DOGRP108;                                       1645 08184000
*            ELSE                                                  1646 08185000
*                                                                  1646 08186000
*              /******************************************************/ 08187000
*              /*                                                    */ 08188000
*              /* IF THE CURRENT SUBLIST IS THE LAST REPEATED LIST   */ 08189000
*              /* AT THIS LEVEL, RESET INDEXES AND COUNTS TO CONTINUE*/ 08190000
*              /* SCANNING PARAMETERS AT NEXT HIGHER LEVEL.          */ 08191000
*              /*                                                    */ 08192000
*              /******************************************************/ 08193000
*              IF CHAR1=CLOSING                                    1646 08194000
*                THEN                                              1646 08195000
         B     @RC01604                                            1646 08196000
@RF01604 CLI   CHAR1,C')'                                          1646 08197000
         BNE   @RF01646                                            1646 08198000
*                  DO;                                             1647 08199000
*                    OLDERID2 = NEWERID2;                          1648 08200000
         L     @01,GDTPTR                                          1648 08201000
         L     @15,GDTTR2(,@01)                                    1648 08202000
         MVC   @TS00001(95),NEWERID2(@15)                          1648 08203000
         MVC   OLDERID2(95,@15),@TS00001                           1648 08204000
*                    NEWID2='RI36';                                1649 08205000
         MVC   NEWID2(4,@15),@CC01145                              1649 08206000
*                    REPDEPTH=REPDEPTH-1;                          1650 08207000
*                                                                  1650 08208000
         LH    @15,REPDEPTH                                        1650 08209000
         BCTR  @15,0                                               1650 08210000
         STH   @15,REPDEPTH                                        1650 08211000
*                    CALL NEXTCHAR;                                1651 08212000
         BAL   @14,NEXTCHAR                                        1651 08213000
*                    CALL SCANSEP(YES);                            1652 08214000
*                                                                  1652 08215000
         LA    @01,@AL01652                                        1652 08216000
         BAL   @14,SCANSEP                                         1652 08217000
*                    PARMLVL=PARMLVL-1;                            1653 08218000
         LH    @15,PARMLVL                                         1653 08219000
         BCTR  @15,0                                               1653 08220000
         STH   @15,PARMLVL                                         1653 08221000
*                  END;                                            1654 08222000
*                ELSE                                              1655 08223000
*                                                                  1655 08224000
*                  /**************************************************/ 08225000
*                  /*                                                */ 08226000
*                  /* IF STATEMENT END HAS BEEN REACHED (EVEN THOUGH */ 08227000
*                  /* SOME CLOSING PARENTHESES ARE MISSING), APPLY   */ 08228000
*                  /* DEFAULTS FOR EACH LEVEL NOT EXPLICITLY CLOSED. */ 08229000
*                  /* ISSUE A WARNING MESSAGE ABOUT THE PARENTHESES. */ 08230000
*                  /*                                                */ 08231000
*                  /**************************************************/ 08232000
*                  IF CHAR1=ENDDELIM                               1655 08233000
*                    THEN                                          1655 08234000
         B     @RC01646                                            1655 08235000
@RF01646 CLI   CHAR1,C';'                                          1655 08236000
         BNE   @RF01655                                            1655 08237000
*                      DO;                                         1656 08238000
*                      PARMLVL=PARMLVL-1;                          1657 08239000
         LH    @15,PARMLVL                                         1657 08240000
         BCTR  @15,0                                               1657 08241000
         STH   @15,PARMLVL                                         1657 08242000
*                      REPDEPTH=REPDEPTH-1;                        1658 08243000
         LH    @14,REPDEPTH                                        1658 08244000
         BCTR  @14,0                                               1658 08245000
         STH   @14,REPDEPTH                                        1658 08246000
*                      IF PARMLVL=1                                1659 08247000
*                        THEN                                      1659 08248000
         CH    @15,@CH00172                                        1659 08249000
         BNE   @RF01659                                            1659 08250000
*                          DO;                                     1660 08251000
*                          DARGSMOD=RISTID;                        1661 08252000
         L     @15,DDSTRU                                          1661 08253000
         MVC   DARGSMOD(3,@15),RISTID                              1661 08254000
*                          DARGSENT=TOOFEW;                        1662 08255000
*                                                                  1662 08256000
         MVI   DARGSENT(@15),X'23'                                 1662 08257000
*                          CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);   1663 08258000
*                                                                  1663 08259000
         L     @15,GDTPTR                                          1663 08260000
         ST    @15,@AL00001                                        1663 08261000
         LA    @14,@CF00102                                        1663 08262000
         ST    @14,@AL00001+4                                      1663 08263000
         LA    @14,DDSTRU                                          1663 08264000
         ST    @14,@AL00001+8                                      1663 08265000
         MVI   @AL00001+8,X'80'                                    1663 08266000
         L     @15,GDTPRT(,@15)                                    1663 08267000
         LA    @01,@AL00001                                        1663 08268000
         BALR  @14,@15                                             1663 08269000
*                          END;                                    1664 08270000
*                      END;                                        1665 08271000
*                    ELSE                                          1666 08272000
*                                                                  1666 08273000
*                      CALL ERROR1(BADELIM4);                      1666 08274000
*                                                                  1666 08275000
         B     @RC01655                                            1666 08276000
@RF01655 LA    @01,@AL01666                                        1666 08277000
         BAL   @14,ERROR1                                          1666 08278000
*        END INREPEAT;                                             1667 08279000
         B     @EL00020                                            1667 08280000
*/********************************************************************/ 08281000
*/*                                                                  */ 08282000
*/*  PROCEDURE NAME - DEFAULTS                                       */ 08283000
*/*                                                                  */ 08284000
*/*  FUNCTION - THIS ROUTINE DETERMINES DEFAULT PARMS IN             */ 08285000
*/*             ADDITION TO THE PARAMETERS WHICH HAVE ACTUALLY BEEN  */ 08286000
*/*             CODED AS INPUT ON A COMMAND.  THE REQUIRED DEFAULT   */ 08287000
*/*             INFORMATION FOR A COMMAND IS CONTAINED IN THE COMMAND*/ 08288000
*/*             DESCRIPTOR.  A DEFAULT IS APPLIED AS LONG AS THERE   */ 08289000
*/*             IS NO SEMANTIC REQUIREMENT PROHIBITING IT DUE TO A   */ 08290000
*/*             PARAMETER WHICH HAS ALREADY BEEN INPUT.  DEFAULTS    */ 08291000
*/*             ARE APPLIED AT COMMAND END AND AT THE END OF EACH    */ 08292000
*/*             REPETITION OF A REPEATED SUBPARAMETER LIST (IN THE   */ 08293000
*/*             LATTER CASE, ONLY DEFAULTS APPLYING TO THAT SUBLIST  */ 08294000
*/*             ARE APPLIED).                                        */ 08295000
*/*                                                                  */ 08296000
*/*  INPUT -                                                         */ 08297000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */ 08298000
*/*          SUPERID - SUPERPARAMETER ID# OF PARAMETER WHOSE SUBLIST */ 08299000
*/*                    IS RECEIVING DEFAULTS (ID#=0 IF APPLYING      */ 08300000
*/*                    DEFAULTS FOR ENTIRE COMMAND).                 */ 08301000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 08302000
*/*                    CODE WHEN AN ERROR IS DETECTED.               */ 08303000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */ 08304000
*/*                                                                  */ 08305000
*/*  OUTPUT -                                                        */ 08306000
*/*          PARAMETER ID# OF A PARAMETER TO BE DEFAULTED            */ 08307000
*/*                                                                  */ 08308000
*/********************************************************************/ 08309000
*DEFAULTS:PROCEDURE;                                               1668 08310000
DEFAULTS STM   @14,@12,@SA00021                                    1668 08311000
*        /************************************************************/ 08312000
*        /*                                                          */ 08313000
*        /*  ** DEFAULTS **  APPLY DEFAULT PARAMETERS                */ 08314000
*        /*                                                          */ 08315000
*        /************************************************************/ 08316000
*        IF GDTDBG = NULLPTR                                       1669 08317000
*          THEN;                                                   1669 08318000
         L     @01,GDTPTR                                          1669 08319000
         L     @15,GDTDBG(,@01)                                    1669 08320000
         LTR   @15,@15                                             1669 08321000
         BZ    @RT01669                                            1669 08322000
*          ELSE                                                    1671 08323000
*            CALL ICKDB010(GDTTBL,'RIDF');                         1671 08324000
*                                                                  1671 08325000
         L     @15,GDTPTR                                          1671 08326000
         ST    @15,@AL00001                                        1671 08327000
         LA    @14,@CC01149                                        1671 08328000
         ST    @14,@AL00001+4                                      1671 08329000
         MVI   @AL00001+4,X'80'                                    1671 08330000
         L     @15,GDTDBG(,@15)                                    1671 08331000
         LA    @01,@AL00001                                        1671 08332000
         BALR  @14,@15                                             1671 08333000
*        /************************************************************/ 08334000
*        /*                                                          */ 08335000
*        /* UPON ENTRY TO THIS ROUTINE, THE CURRENT SUPERPARAMETER   */ 08336000
*        /* ID NUMBER WILL BE ZERO IF STATEMENT END HAS BEEN REACHED.*/ 08337000
*        /* OTHERWISE, THE ID# WILL BE THAT OF THE PARAMETER WHICH   */ 08338000
*        /* HAS THE REPEATED SUBPARAMETER LIST.                      */ 08339000
*        /*                                                          */ 08340000
*        /************************************************************/ 08341000
*                                                                  1672 08342000
*        /************************************************************/ 08343000
*        /*                                                          */ 08344000
*        /* IF 'DEFAULT GROUPS' ARE SPECIFIED, FIND THE              */ 08345000
*        /* GROUP(S) WHICH PERTAIN TO THE CURRENT SET OF             */ 08346000
*        /* PARAMETERS, AND SELECT DEFAULTS IF APPLICABLE.           */ 08347000
*        /*                                                          */ 08348000
*        /************************************************************/ 08349000
*        IF DGRPDSPL > 0                                           1672 08350000
*          THEN                                                    1672 08351000
@RT01669 L     @01,DESCPTR                                         1672 08352000
         CLI   DGRPDSPL(@01),0                                     1672 08353000
         BNH   @RF01672                                            1672 08354000
*DOGRP110:   DO;                                                   1673 08355000
DOGRP110 DS    0H                                                  1674 08356000
*              GRPPTR=ADDR(DGRPTOT)+LENGTH(DGRPTOT);               1674 08357000
*                                                                  1674 08358000
         L     @15,DESCPTR                                         1674 08359000
         SLR   @14,@14                                             1674 08360000
         IC    @14,DGRPDSPL(,@15)                                  1674 08361000
         ALR   @14,@14                                             1674 08362000
         ALR   @15,@14                                             1674 08363000
         AL    @15,@CF00124                                        1674 08364000
         ST    @15,GRPPTR                                          1674 08365000
*              /******************************************************/ 08366000
*              /*                                                    */ 08367000
*              /* EXAMINE EACH 'DEFAULT GROUP' SUBLIST,              */ 08368000
*              /* CHECKING TO SEE IF THE PARAMETER ELIGIBLE          */ 08369000
*              /* TO BE DEFAULTED IS PART OF THE SET OF              */ 08370000
*              /* PARAMETERS NOW BEING HANDLED.                      */ 08371000
*              /*                                                    */ 08372000
*              /******************************************************/ 08373000
*DOLOOP19:     DO LISTINDX=1 TO DGRPTOT;                           1675 08374000
DOLOOP19 LA    @15,1                                               1675 08375000
         B     @DE01675                                            1675 08376000
@DL01675 DS    0H                                                  1676 08377000
*                FOUND=NO;                                         1676 08378000
         NI    FOUND,B'11011111'                                   1676 08379000
*                TESTID=DGRPID(1);                                 1677 08380000
         L     @01,GRPPTR                                          1677 08381000
         MVC   TESTID(2),DGRPID(@01)                               1677 08382000
*                DO WHILE(TESTID^=0 & FOUND=NO);                   1678 08383000
         B     @DE01678                                            1678 08384000
@DL01678 DS    0H                                                  1679 08385000
*                  IF SUPRPARM(TESTID)=SUPERID(PARMLVL)            1679 08386000
*                    THEN                                          1679 08387000
         LH    @15,TESTID                                          1679 08388000
         MH    @15,@CH00038                                        1679 08389000
         LH    @14,PARMLVL                                         1679 08390000
         ALR   @14,@14                                             1679 08391000
         L     @01,WORKPTR                                         1679 08392000
         AL    @01,@CF01318                                        1679 08393000
         LH    @15,SUPRPARM-8(@15,@01)                             1679 08394000
         CH    @15,SUPERID-2(@14)                                  1679 08395000
         BNE   @RF01679                                            1679 08396000
*                      FOUND=YES;                                  1680 08397000
         OI    FOUND,B'00100000'                                   1680 08398000
*                    ELSE                                          1681 08399000
*                      DO;                                         1681 08400000
         B     @RC01679                                            1681 08401000
@RF01679 DS    0H                                                  1682 08402000
*                      TESTID=SUPRPARM(TESTID);                    1682 08403000
         L     @15,WORKPTR                                         1682 08404000
         LA    @14,12                                              1682 08405000
         LR    @05,@14                                             1682 08406000
         MH    @05,TESTID                                          1682 08407000
         AL    @05,@CF01318                                        1682 08408000
         LH    @05,SUPRPARM-8(@05,@15)                             1682 08409000
         STH   @05,TESTID                                          1682 08410000
*                      IF PARMPTR(TESTID)->REPEATED=YES            1683 08411000
*                        THEN                                      1683 08412000
         MR    @04,@14                                             1683 08413000
         AL    @15,@CF01317                                        1683 08414000
         L     @01,PARMPTR(@05,@15)                                1683 08415000
         TM    REPEATED(@01),B'00100000'                           1683 08416000
         BNO   @RF01683                                            1683 08417000
*                          TESTID=0;                               1684 08418000
         SLR   @15,@15                                             1684 08419000
         STH   @15,TESTID                                          1684 08420000
*                      END;                                        1685 08421000
@RF01683 DS    0H                                                  1686 08422000
*                END;                                              1686 08423000
*                                                                  1686 08424000
@RC01679 DS    0H                                                  1686 08425000
@DE01678 LH    @15,TESTID                                          1686 08426000
         LTR   @15,@15                                             1686 08427000
         BZ    @DC01678                                            1686 08428000
         TM    FOUND,B'00100000'                                   1686 08429000
         BZ    @DL01678                                            1686 08430000
@DC01678 DS    0H                                                  1687 08431000
*                /****************************************************/ 08432000
*                /*                                                  */ 08433000
*                /* IF THE ELIGIBLE PARAMETER IS PART OF THE         */ 08434000
*                /* CURRENT PARAMETER SET, TEST TO SEE IF            */ 08435000
*                /* ALL THE PARAMETERS IN THE GROUP WERE NOT         */ 08436000
*                /* CODED.  IF NONE WERE INPUT, DEFAULT THE          */ 08437000
*                /* FIRST PARAMETER IN THE SUBLIST.                  */ 08438000
*                /*                                                  */ 08439000
*                /****************************************************/ 08440000
*                IF FOUND=YES                                      1687 08441000
*                  THEN                                            1687 08442000
         TM    FOUND,B'00100000'                                   1687 08443000
         BNO   @RF01687                                            1687 08444000
*DOGRP113:           DO;                                           1688 08445000
DOGRP113 DS    0H                                                  1689 08446000
*                      FOUND=NO;                                   1689 08447000
         NI    FOUND,B'11011111'                                   1689 08448000
*                      DO INDEX3=1 TO DGRPCNT;                     1690 08449000
         LA    @15,1                                               1690 08450000
         B     @DE01690                                            1690 08451000
@DL01690 DS    0H                                                  1691 08452000
*                        IF PARMFLAG(DGRPID(INDEX3))^=0            1691 08453000
*                          THEN                                    1691 08454000
         ALR   @15,@15                                             1691 08455000
         L     @01,GRPPTR                                          1691 08456000
         LH    @15,DGRPID-2(@15,@01)                               1691 08457000
         MH    @15,@CH00038                                        1691 08458000
         L     @01,WORKPTR                                         1691 08459000
         BCTR  @01,0                                               1691 08460000
         BCTR  @01,0                                               1691 08461000
         SLR   @14,@14                                             1691 08462000
         IC    @14,PARMFLAG-10(@15,@01)                            1691 08463000
         CH    @14,@CH00102                                        1691 08464000
         BE    @RF01691                                            1691 08465000
*                            FOUND=YES;                            1692 08466000
         OI    FOUND,B'00100000'                                   1692 08467000
*                      END;                                        1693 08468000
@RF01691 LA    @15,1                                               1693 08469000
         AH    @15,INDEX3                                          1693 08470000
@DE01690 STH   @15,INDEX3                                          1693 08471000
         L     @14,GRPPTR                                          1693 08472000
         CH    @15,DGRPCNT(,@14)                                   1693 08473000
         BNH   @DL01690                                            1693 08474000
*                      IF FOUND=NO                                 1694 08475000
*                        THEN                                      1694 08476000
*                                                                  1694 08477000
         TM    FOUND,B'00100000'                                   1694 08478000
         BNZ   @RF01694                                            1694 08479000
*                          CALL SETDFLT(DGRPID(1));                1695 08480000
*                                                                  1695 08481000
         L     @01,GRPPTR                                          1695 08482000
         LA    @15,DGRPID(,@01)                                    1695 08483000
         ST    @15,@AL00001                                        1695 08484000
         LA    @01,@AL00001                                        1695 08485000
         BAL   @14,SETDFLT                                         1695 08486000
*                    END DOGRP113;                                 1696 08487000
@RF01694 DS    0H                                                  1697 08488000
*                GRPPTR=GRPPTR+LENGTH(DGRPCNT)+                    1697 08489000
*                        DGRPCNT*LENGTH(DGRPID(1));                1697 08490000
@RF01687 L     @15,GRPPTR                                          1697 08491000
         LA    @14,2                                               1697 08492000
         ALR   @14,@15                                             1697 08493000
         LH    @15,DGRPCNT(,@15)                                   1697 08494000
         ALR   @15,@15                                             1697 08495000
         ALR   @14,@15                                             1697 08496000
         ST    @14,GRPPTR                                          1697 08497000
*              END DOLOOP19;                                       1698 08498000
         LA    @15,1                                               1698 08499000
         AH    @15,LISTINDX                                        1698 08500000
@DE01675 STH   @15,LISTINDX                                        1698 08501000
         L     @14,DESCPTR                                         1698 08502000
         SLR   @05,@05                                             1698 08503000
         IC    @05,DGRPDSPL(,@14)                                  1698 08504000
         ALR   @05,@05                                             1698 08505000
         AL    @05,DESCPTR                                         1698 08506000
         CH    @15,DGRPTOT(,@05)                                   1698 08507000
         BNH   @DL01675                                            1698 08508000
*            END DOGRP110;                                         1699 08509000
*                                                                  1699 08510000
*        /************************************************************/ 08511000
*        /*                                                          */ 08512000
*        /* EXAMINE EACH PARAMETER TO SEE IF A DEFAULT               */ 08513000
*        /* CONSTANT IS PROVIDED FOR IT.  IF A DEFAULT IS            */ 08514000
*        /* PRESENT AND THE PARAMETER IS NOT ALREADY INPUT,          */ 08515000
*        /* THE PARM IS ELIGIBLE TO BE DEFAULTED.                    */ 08516000
*        /*                                                          */ 08517000
*        /************************************************************/ 08518000
*DOLOOP20:DO INDEX3=1 TO MAXID;                                    1700 08519000
@RF01672 DS    0H                                                  1700 08520000
DOLOOP20 LA    @15,1                                               1700 08521000
         B     @DE01700                                            1700 08522000
@DL01700 DS    0H                                                  1701 08523000
*          IF PARMPTR(INDEX3)^=0 & PARMFLAG(INDEX3)=0 &            1701 08524000
*             PARMPTR(INDEX3)->DEFAULT=YES                         1701 08525000
*            THEN                                                  1701 08526000
         SLR   @14,@14                                             1701 08527000
         L     @05,WORKPTR                                         1701 08528000
         MH    @15,@CH00038                                        1701 08529000
         LA    @01,0(@15,@05)                                      1701 08530000
         AL    @01,@CF01317                                        1701 08531000
         L     @04,PARMPTR(,@01)                                   1701 08532000
         CR    @04,@14                                             1701 08533000
         BE    @RF01701                                            1701 08534000
         ALR   @05,@15                                             1701 08535000
         BCTR  @05,0                                               1701 08536000
         BCTR  @05,0                                               1701 08537000
         MVC   @ZT00003+3(1),PARMFLAG-10(@05)                      1701 08538000
         C     @14,@ZT00003                                        1701 08539000
         BNE   @RF01701                                            1701 08540000
         TM    DEFAULT(@04),B'00000100'                            1701 08541000
         BNO   @RF01701                                            1701 08542000
*DOGRP115:     DO;                                                 1702 08543000
DOGRP115 DS    0H                                                  1703 08544000
*                TESTID=INDEX3;                                    1703 08545000
*                                                                  1703 08546000
         MVC   TESTID(2),INDEX3                                    1703 08547000
*                /****************************************************/ 08548000
*                /*                                                  */ 08549000
*                /* BE SURE THAT THE PARAMETER TO BE DEFAULTED IS    */ 08550000
*                /* PART OF THE SET OF PARAMETERS CURRENTLY BEING    */ 08551000
*                /* HANDLED.  IF SO, THEN SET THE DEFAULT.           */ 08552000
*                /*                                                  */ 08553000
*                /****************************************************/ 08554000
*DOLOOP22:       DO WHILE(TESTID^=0);                              1704 08555000
DOLOOP22 B     @DE01704                                            1704 08556000
@DL01704 DS    0H                                                  1705 08557000
*                  IF SUPRPARM(TESTID)=SUPERID(PARMLVL)            1705 08558000
*                    THEN                                          1705 08559000
         LH    @15,TESTID                                          1705 08560000
         MH    @15,@CH00038                                        1705 08561000
         LH    @14,PARMLVL                                         1705 08562000
         ALR   @14,@14                                             1705 08563000
         L     @01,WORKPTR                                         1705 08564000
         AL    @01,@CF01318                                        1705 08565000
         LH    @15,SUPRPARM-8(@15,@01)                             1705 08566000
         CH    @15,SUPERID-2(@14)                                  1705 08567000
         BNE   @RF01705                                            1705 08568000
*                      DO;                                         1706 08569000
*                      TESTID=0;                                   1707 08570000
*                                                                  1707 08571000
         SLR   @15,@15                                             1707 08572000
         STH   @15,TESTID                                          1707 08573000
*                      CALL SETDFLT(INDEX3);                       1708 08574000
*                                                                  1708 08575000
         LA    @15,INDEX3                                          1708 08576000
         ST    @15,@AL00001                                        1708 08577000
         LA    @01,@AL00001                                        1708 08578000
         BAL   @14,SETDFLT                                         1708 08579000
*                      END;                                        1709 08580000
*                    ELSE                                          1710 08581000
*                      DO;                                         1710 08582000
         B     @RC01705                                            1710 08583000
@RF01705 DS    0H                                                  1711 08584000
*                      TESTID=SUPRPARM(TESTID);                    1711 08585000
         L     @15,WORKPTR                                         1711 08586000
         LA    @14,12                                              1711 08587000
         LR    @05,@14                                             1711 08588000
         MH    @05,TESTID                                          1711 08589000
         AL    @05,@CF01318                                        1711 08590000
         LH    @05,SUPRPARM-8(@05,@15)                             1711 08591000
         STH   @05,TESTID                                          1711 08592000
*                      IF PARMPTR(TESTID)->REPEATED=YES            1712 08593000
*                        THEN                                      1712 08594000
         MR    @04,@14                                             1712 08595000
         AL    @15,@CF01317                                        1712 08596000
         L     @01,PARMPTR(@05,@15)                                1712 08597000
         TM    REPEATED(@01),B'00100000'                           1712 08598000
         BNO   @RF01712                                            1712 08599000
*                          TESTID=0;                               1713 08600000
         SLR   @15,@15                                             1713 08601000
         STH   @15,TESTID                                          1713 08602000
*                      END;                                        1714 08603000
@RF01712 DS    0H                                                  1715 08604000
*                END DOLOOP22;                                     1715 08605000
@RC01705 DS    0H                                                  1715 08606000
@DE01704 LH    @15,TESTID                                          1715 08607000
         LTR   @15,@15                                             1715 08608000
         BNZ   @DL01704                                            1715 08609000
*              END DOGRP115;                                       1716 08610000
*        END DOLOOP20;                                             1717 08611000
@RF01701 LA    @15,1                                               1717 08612000
         AH    @15,INDEX3                                          1717 08613000
@DE01700 STH   @15,INDEX3                                          1717 08614000
         L     @14,DESCPTR                                         1717 08615000
         CH    @15,MAXID(,@14)                                     1717 08616000
         BNH   @DL01700                                            1717 08617000
*/********************************************************************/ 08618000
*/*                                                                  */ 08619000
*/*  PROCEDURE NAME - SETDFLT                                        */ 08620000
*/*                                                                  */ 08621000
*/*  FUNCTION - THIS ROUTINE CHECKS A PARM THAT IS ELIGIBLE          */ 08622000
*/*             TO BE DEFAULTED TO SEE IF THE DEFAULT WILL           */ 08623000
*/*             CAUSE ANY CONFLICT WITH AN EXISTING INPUT            */ 08624000
*/*             PARAMETER.  IF NOT, THE DEFAULT PARAMETER            */ 08625000
*/*             IS ADDED TO THE FDT.                                 */ 08626000
*/*                                                                  */ 08627000
*/*  INPUT -                                                         */ 08628000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */ 08629000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */ 08630000
*/*          DFLTPARM - THE ID# OF THE PARAMETER TO BE DEFAULTED     */ 08631000
*/*                                                                  */ 08632000
*/*  OUTPUT -                                                        */ 08633000
*/*          ORGSIGN - FORM OF THE CONSTANT (HEX, BINARY             */ 08634000
*/*                    OR NEITHER) TO BE DEFAULTED.                  */ 08635000
*/*          PWORD -   SET 'OFF' TO SIGNAL THAT THE ITEM             */ 08636000
*/*                    BEING DEFAULTED IS NOT A PASSWORD.            */ 08637000
*/*          SYNUNIT - CONTAINS THE ITEM TO BE DEFAULTED.            */ 08638000
*/*          UNITINDX- LENGTH OF THE ITEM TO BE DEFAULTED.           */ 08639000
*/*                                                                  */ 08640000
*/********************************************************************/ 08641000
*SETDFLT:PROCEDURE(DFLTPARM);                                      1718 08642000
         B     @PB00022                                            1718 08643000
SETDFLT  STM   @14,@12,@SA00022                                    1718 08644000
         MVC   @PC00022(4),0(@01)                                  1718 08645000
*        /************************************************************/ 08646000
*        /*                                                          */ 08647000
*        /* DATA DEFINITIONS FOR SETDFLT ROUTINE                     */ 08648000
*        /*                                                          */ 08649000
*        /************************************************************/ 08650000
*                                                                  1719 08651000
*        DCL DFLTPARM FIXED(15);       /*ID# OF PARM TO BE           */ 08652000
*                                      /* DEFAULTED.                 */ 08653000
*        DCL WORKVAR2 FIXED(15);       /*VARIABLE TO CONTAIN         */ 08654000
*                                      /*A TEMPORARY VALUE           */ 08655000
*        DCL DEFLTPTR PTR(31);         /*VARIABLE TO CONTAIN         */ 08656000
*                                      /*PTR TO DEFAULT INFO         */ 08657000
*                                      /*IN THE DESCRIPTOR.          */ 08658000
*        DCL DFLTOK   BIT(1);          /*SIGNALS THAT PARM           */ 08659000
*                                      /* IDENTIFIED IN THE          */ 08660000
*                                      /* ABOVE LIST IS OK           */ 08661000
*                                      /* TO BE DEFAULTED.           */ 08662000
*        /************************************************************/ 08663000
*        /*                                                          */ 08664000
*        /*  ** SETDFLT **  APPLY DEFAULT PARAMETERS                 */ 08665000
*        /*                                                          */ 08666000
*        /************************************************************/ 08667000
*        IF GDTDBG = NULLPTR                                       1723 08668000
*          THEN;                                                   1723 08669000
         L     @01,GDTPTR                                          1723 08670000
         L     @15,GDTDBG(,@01)                                    1723 08671000
         LTR   @15,@15                                             1723 08672000
         BZ    @RT01723                                            1723 08673000
*          ELSE                                                    1725 08674000
*            CALL ICKDB010(GDTTBL,'RIST');                         1725 08675000
*                                                                  1725 08676000
         L     @15,GDTPTR                                          1725 08677000
         ST    @15,@AL00001                                        1725 08678000
         LA    @14,@CC01171                                        1725 08679000
         ST    @14,@AL00001+4                                      1725 08680000
         MVI   @AL00001+4,X'80'                                    1725 08681000
         L     @15,GDTDBG(,@15)                                    1725 08682000
         LA    @01,@AL00001                                        1725 08683000
         BALR  @14,@15                                             1725 08684000
*        /************************************************************/ 08685000
*        /*                                                          */ 08686000
*        /* THE PARAMETER TO BE DEFAULTED IS CHECKED TO              */ 08687000
*        /* INSURE THAT ITS PRESENCE WILL NOT CREATE A               */ 08688000
*        /* CONFLICT WITH AN EXISTING INPUT PARAMETER.               */ 08689000
*        /* SINCE KEYWORD SUPERPARM(S) OF THE DEFAULT PARM           */ 08690000
*        /* ARE TO BE DEFAULTED (AS NECESSARY) ALONG WITH            */ 08691000
*        /* IT, THESE SUPERPARM(S) ARE ALSO CHECKED FOR              */ 08692000
*        /* POTENTIAL CONFLICTS                                      */ 08693000
*        /*                                                          */ 08694000
*        /************************************************************/ 08695000
*        PARMID=DFLTPARM;                                          1726 08696000
@RT01723 L     @15,@PC00022                                        1726 08697000
         MVC   PARMID(2),DFLTPARM(@15)                             1726 08698000
*        DFLTOK=YES;                                               1727 08699000
         OI    DFLTOK,B'10000000'                                  1727 08700000
*        DO WHILE(DFLTOK=YES &                                     1728 08701000
*                   PARMID^=0 & PARMFLAG(PARMID)=0);               1728 08702000
*                                                                  1728 08703000
         B     @DE01728                                            1728 08704000
@DL01728 DS    0H                                                  1729 08705000
*          /**********************************************************/ 08706000
*          /*                                                        */ 08707000
*          /* FIRST, CHECK FOR A LIST OF CONFLICTING PARMS           */ 08708000
*          /* SPECIFICALLY ASSOCIATED WITH THE DEFAULT PARM,         */ 08709000
*          /* AND BE SURE THAT NO CONFLICTS WOULD EXIST.             */ 08710000
*          /*                                                        */ 08711000
*          /**********************************************************/ 08712000
*          IF NOTDSPL > 0                                          1729 08713000
*            THEN                                                  1729 08714000
         LH    @15,PARMID                                          1729 08715000
         MH    @15,@CH00038                                        1729 08716000
         L     @01,WORKPTR                                         1729 08717000
         AL    @01,@CF01317                                        1729 08718000
         L     @15,PARMPTR(@15,@01)                                1729 08719000
         CLI   NOTDSPL(@15),0                                      1729 08720000
         BNH   @RF01729                                            1729 08721000
*              DO;                                                 1730 08722000
*                WORKVAR2=NOTCOUNT;                                1731 08723000
         SLR   @14,@14                                             1731 08724000
         IC    @14,NOTDSPL(,@15)                                   1731 08725000
         ALR   @14,@14                                             1731 08726000
         ALR   @15,@14                                             1731 08727000
         MVC   WORKVAR2(2),NOTCOUNT(@15)                           1731 08728000
*                DO INDEX2=1 TO WORKVAR2;                          1732 08729000
         LA    @15,1                                               1732 08730000
         B     @DE01732                                            1732 08731000
@DL01732 DS    0H                                                  1733 08732000
*                  IF PARMFLAG(NOTID(INDEX2)) ^= 0                 1733 08733000
*                    THEN                                          1733 08734000
         L     @14,WORKPTR                                         1733 08735000
         LA    @05,12                                              1733 08736000
         ALR   @15,@15                                             1733 08737000
         LR    @04,@05                                             1733 08738000
         MH    @04,PARMID                                          1733 08739000
         AL    @04,@CF01317                                        1733 08740000
         L     @04,PARMPTR(@04,@14)                                1733 08741000
         SLR   @03,@03                                             1733 08742000
         IC    @03,NOTDSPL(,@04)                                   1733 08743000
         ALR   @03,@03                                             1733 08744000
         ALR   @04,@03                                             1733 08745000
         MH    @05,NOTID-2(@15,@04)                                1733 08746000
         BCTR  @14,0                                               1733 08747000
         BCTR  @14,0                                               1733 08748000
         SLR   @15,@15                                             1733 08749000
         IC    @15,PARMFLAG-10(@05,@14)                            1733 08750000
         CH    @15,@CH00102                                        1733 08751000
         BE    @RF01733                                            1733 08752000
*                      DFLTOK=NO;                                  1734 08753000
         NI    DFLTOK,B'01111111'                                  1734 08754000
*                END;                                              1735 08755000
@RF01733 LA    @15,1                                               1735 08756000
         AH    @15,INDEX2                                          1735 08757000
@DE01732 STH   @15,INDEX2                                          1735 08758000
         CH    @15,WORKVAR2                                        1735 08759000
         BNH   @DL01732                                            1735 08760000
*              END;                                                1736 08761000
*                                                                  1736 08762000
*          /**********************************************************/ 08763000
*          /*                                                        */ 08764000
*          /* THEN CHECK FOR THE OCCURRENCE OF THIS DEFAULT          */ 08765000
*          /* PARAMETER IN A 'NOT GROUP' (A SET OF MUTUALLY          */ 08766000
*          /* EXCLUSIVE PARMS), AND BE SURE THAT NO OTHER            */ 08767000
*          /* PARAMETER IN THE GROUP IS INPUT                        */ 08768000
*          /*                                                        */ 08769000
*          /**********************************************************/ 08770000
*          IF DFLTOK=YES & NTGRPPTR(PARMID)^=NULLPTR               1737 08771000
*            THEN                                                  1737 08772000
@RF01729 TM    DFLTOK,B'10000000'                                  1737 08773000
         BNO   @RF01737                                            1737 08774000
         LH    @15,PARMID                                          1737 08775000
         MH    @15,@CH00038                                        1737 08776000
         L     @01,WORKPTR                                         1737 08777000
         AL    @01,@CF01376                                        1737 08778000
         L     @15,NTGRPPTR-4(@15,@01)                             1737 08779000
         LTR   @15,@15                                             1737 08780000
         BZ    @RF01737                                            1737 08781000
*              DO;                                                 1738 08782000
*                WORKPTR2=GRPPTR;                                  1739 08783000
         MVC   WORKPTR2(4),GRPPTR                                  1739 08784000
*                GRPPTR=NTGRPPTR(PARMID);                          1740 08785000
         ST    @15,GRPPTR                                          1740 08786000
*                DO INDEX2=1 TO NTGRPCNT;                          1741 08787000
         LA    @15,1                                               1741 08788000
         B     @DE01741                                            1741 08789000
@DL01741 DS    0H                                                  1742 08790000
*                  IF PARMFLAG(NTGRPID(INDEX2))^=0 &               1742 08791000
*                     NTGRPID(INDEX2)^=PARMID                      1742 08792000
*                    THEN                                          1742 08793000
         ALR   @15,@15                                             1742 08794000
         L     @01,GRPPTR                                          1742 08795000
         LH    @15,NTGRPID-2(@15,@01)                              1742 08796000
         LR    @14,@15                                             1742 08797000
         MH    @14,@CH00038                                        1742 08798000
         L     @01,WORKPTR                                         1742 08799000
         BCTR  @01,0                                               1742 08800000
         BCTR  @01,0                                               1742 08801000
         SLR   @00,@00                                             1742 08802000
         IC    @00,PARMFLAG-10(@14,@01)                            1742 08803000
         CH    @00,@CH00102                                        1742 08804000
         BE    @RF01742                                            1742 08805000
         CH    @15,PARMID                                          1742 08806000
         BE    @RF01742                                            1742 08807000
*                      DFLTOK=NO;                                  1743 08808000
         NI    DFLTOK,B'01111111'                                  1743 08809000
*                END;                                              1744 08810000
@RF01742 LA    @15,1                                               1744 08811000
         AH    @15,INDEX2                                          1744 08812000
@DE01741 STH   @15,INDEX2                                          1744 08813000
         L     @14,GRPPTR                                          1744 08814000
         CH    @15,NTGRPCNT(,@14)                                  1744 08815000
         BNH   @DL01741                                            1744 08816000
*                GRPPTR=WORKPTR2;                                  1745 08817000
         MVC   GRPPTR(4),WORKPTR2                                  1745 08818000
*              END;                                                1746 08819000
*          PARMID=SUPRPARM(PARMID);                                1747 08820000
@RF01737 LH    @15,PARMID                                          1747 08821000
         MH    @15,@CH00038                                        1747 08822000
         L     @01,WORKPTR                                         1747 08823000
         AL    @01,@CF01318                                        1747 08824000
         LH    @15,SUPRPARM-8(@15,@01)                             1747 08825000
         STH   @15,PARMID                                          1747 08826000
*        END;                                                      1748 08827000
*                                                                  1748 08828000
@DE01728 TM    DFLTOK,B'10000000'                                  1748 08829000
         BNO   @DC01728                                            1748 08830000
         LH    @15,PARMID                                          1748 08831000
         SLR   @14,@14                                             1748 08832000
         CR    @15,@14                                             1748 08833000
         BE    @DC01728                                            1748 08834000
         MH    @15,@CH00038                                        1748 08835000
         L     @01,WORKPTR                                         1748 08836000
         ALR   @01,@15                                             1748 08837000
         BCTR  @01,0                                               1748 08838000
         BCTR  @01,0                                               1748 08839000
         MVC   @ZT00003+3(1),PARMFLAG-10(@01)                      1748 08840000
         C     @14,@ZT00003                                        1748 08841000
         BE    @DL01728                                            1748 08842000
@DC01728 DS    0H                                                  1749 08843000
*        /************************************************************/ 08844000
*        /*                                                          */ 08845000
*        /* IF NO CONFLICTS WILL OCCUR BY DEFAULTING THIS            */ 08846000
*        /* PARAMETER, NOTE THE PARM'S (AND SUPERPARM'S)             */ 08847000
*        /* OCCURRENCE IN THE PARMFLAG TABLE AND IN THE FDT.         */ 08848000
*        /*                                                          */ 08849000
*        /************************************************************/ 08850000
*        IF DFLTOK=YES                                             1749 08851000
*          THEN                                                    1749 08852000
         TM    DFLTOK,B'10000000'                                  1749 08853000
         BNO   @RF01749                                            1749 08854000
*DOGRP145:   DO;                                                   1750 08855000
DOGRP145 DS    0H                                                  1751 08856000
*            OLDERID2 = NEWERID2;                                  1751 08857000
         L     @01,GDTPTR                                          1751 08858000
         L     @15,GDTTR2(,@01)                                    1751 08859000
         MVC   @TS00001(95),NEWERID2(@15)                          1751 08860000
         MVC   OLDERID2(95,@15),@TS00001                           1751 08861000
*            NEWID2='RI44';                                        1752 08862000
         MVC   NEWID2(4,@15),@CC01174                              1752 08863000
*            PARMID=DFLTPARM;                                      1753 08864000
         L     @15,@PC00022                                        1753 08865000
         MVC   PARMID(2),DFLTPARM(@15)                             1753 08866000
*            DO WHILE(PARMID^=0 & PARMFLAG(PARMID)=0);             1754 08867000
*                                                                  1754 08868000
         B     @DE01754                                            1754 08869000
@DL01754 DS    0H                                                  1755 08870000
*              CALL SETFLAG;                                       1755 08871000
*                                                                  1755 08872000
         BAL   @14,SETFLAG                                         1755 08873000
*              PARMID=SUPRPARM(PARMID);                            1756 08874000
         LH    @15,PARMID                                          1756 08875000
         MH    @15,@CH00038                                        1756 08876000
         L     @01,WORKPTR                                         1756 08877000
         AL    @01,@CF01318                                        1756 08878000
         LH    @15,SUPRPARM-8(@15,@01)                             1756 08879000
         STH   @15,PARMID                                          1756 08880000
*            END;                                                  1757 08881000
@DE01754 LH    @15,PARMID                                          1757 08882000
         SLR   @14,@14                                             1757 08883000
         CR    @15,@14                                             1757 08884000
         BE    @DC01754                                            1757 08885000
         MH    @15,@CH00038                                        1757 08886000
         L     @01,WORKPTR                                         1757 08887000
         ALR   @01,@15                                             1757 08888000
         BCTR  @01,0                                               1757 08889000
         BCTR  @01,0                                               1757 08890000
         MVC   @ZT00003+3(1),PARMFLAG-10(@01)                      1757 08891000
         C     @14,@ZT00003                                        1757 08892000
         BE    @DL01754                                            1757 08893000
@DC01754 DS    0H                                                  1758 08894000
*            PARMID=DFLTPARM;                                      1758 08895000
*                                                                  1758 08896000
         L     @15,@PC00022                                        1758 08897000
         LH    @15,DFLTPARM(,@15)                                  1758 08898000
         STH   @15,PARMID                                          1758 08899000
*            /********************************************************/ 08900000
*            /*                                                      */ 08901000
*            /* IF A DEFAULT CONSTANT IS PROVIDED, PERFORM           */ 08902000
*            /* NECESSARY CONVERSION AND PLACE IT IN THE FDT         */ 08903000
*            /*                                                      */ 08904000
*            /********************************************************/ 08905000
*            IF DEFAULT=YES & SCANONLY=NO                          1759 08906000
*              THEN                                                1759 08907000
         MH    @15,@CH00038                                        1759 08908000
         L     @01,WORKPTR                                         1759 08909000
         AL    @01,@CF01317                                        1759 08910000
         L     @01,PARMPTR(@15,@01)                                1759 08911000
         TM    DEFAULT(@01),B'00000100'                            1759 08912000
         BNO   @RF01759                                            1759 08913000
         TM    SCANONLY,B'00010000'                                1759 08914000
         BNZ   @RF01759                                            1759 08915000
*DOGRP150:       DO;                                               1760 08916000
DOGRP150 DS    0H                                                  1761 08917000
*                SCLRCNT=0;                                        1761 08918000
         SLR   @15,@15                                             1761 08919000
         STH   @15,SCLRCNT                                         1761 08920000
*                ORGSIGN=BLANK;                                    1762 08921000
         MVI   ORGSIGN,C' '                                        1762 08922000
*                PWORD=NONE;                                       1763 08923000
*                                                                  1763 08924000
         STH   @15,PWORD                                           1763 08925000
*                /****************************************************/ 08926000
*                /*                                                  */ 08927000
*                /* IF THE CONSTANT IS A HEX OR BINARY               */ 08928000
*                /* CONSTANT, EXTRACT THE BINARY OR HEX              */ 08929000
*                /* DESIGNATION CHAR. AND REMOVE DELIMITING          */ 08930000
*                /* APOSTROPHES BEFORE PLACING THE VALUE IN          */ 08931000
*                /* THE FDT.  OTHERWISE, PLACE THE CONSTANT          */ 08932000
*                /* INTO THE FDT IN ITS PROVIDED FORM.               */ 08933000
*                /*                                                  */ 08934000
*                /****************************************************/ 08935000
*                DEFLTPTR=PARMPTR(PARMID)+LENGTH(PARMDATA)+        1764 08936000
*                          LENGTH(DSCRPTR2);                       1764 08937000
         LA    @15,12                                              1764 08938000
         LR    @14,@15                                             1764 08939000
         MH    @14,PARMID                                          1764 08940000
         L     @01,WORKPTR                                         1764 08941000
         AL    @01,@CF01317                                        1764 08942000
         L     @14,PARMPTR(@14,@01)                                1764 08943000
         LA    @05,24                                              1764 08944000
         ALR   @05,@14                                             1764 08945000
         ST    @05,DEFLTPTR                                        1764 08946000
*                RESPECIFY(DEFLT) BASED(DEFLTPTR);                 1765 08947000
*                IF (NUMBER=YES | ANYSTRNG=YES) & DEFLTLEN > 3 &   1766 08948000
*                   (DEFLTVAL(1)=BINSIGN | DEFLTVAL(1)=HEXSIGN) &  1766 08949000
*                   DEFLTVAL(2)=QUOTE & DEFLTVAL(DEFLTLEN)=QUOTE   1766 08950000
*                  THEN                                            1766 08951000
         ALR   @14,@15                                             1766 08952000
         TM    NUMBER(@14),B'11000000'                             1766 08953000
         BZ    @RF01766                                            1766 08954000
         CLI   DEFLTLEN(@05),3                                     1766 08955000
         BNH   @RF01766                                            1766 08956000
         CLI   DEFLTVAL(@05),C'B'                                  1766 08957000
         BE    @GL00099                                            1766 08958000
         CLI   DEFLTVAL(@05),C'X'                                  1766 08959000
         BNE   @RF01766                                            1766 08960000
@GL00099 L     @15,DEFLTPTR                                        1766 08961000
         CLI   DEFLTVAL+1(@15),C''''                               1766 08962000
         BNE   @RF01766                                            1766 08963000
         SLR   @14,@14                                             1766 08964000
         IC    @14,DEFLTLEN(,@15)                                  1766 08965000
         ALR   @14,@15                                             1766 08966000
         CLI   DEFLTVAL-1(@14),C''''                               1766 08967000
         BNE   @RF01766                                            1766 08968000
*                    DO;                                           1767 08969000
*                    ORGSIGN=DEFLTVAL(1);                          1768 08970000
         MVC   ORGSIGN(1),DEFLTVAL(@15)                            1768 08971000
*                    SYNUNIT=DEFLTVAL(3:DEFLTLEN-1);               1769 08972000
         MVI   SYNUNIT+1,C' '                                      1769 08973000
         MVC   SYNUNIT+2(253),SYNUNIT+1                            1769 08974000
         L     @01,DEFLTPTR                                        1769 08975000
         SLR   @14,@14                                             1769 08976000
         IC    @14,DEFLTLEN(,@01)                                  1769 08977000
         LR    @05,@14                                             1769 08978000
         SL    @05,@CF00052                                        1769 08979000
         EX    @05,@SM01377                                        1769 08980000
*                    UNITINDX=DEFLTLEN-3;                          1770 08981000
         SL    @14,@CF00144                                        1770 08982000
         STH   @14,UNITINDX                                        1770 08983000
*                    END;                                          1771 08984000
*                  ELSE                                            1772 08985000
*                    DO;                                           1772 08986000
         B     @RC01766                                            1772 08987000
@RF01766 DS    0H                                                  1773 08988000
*                    OLDERID2 = NEWERID2;                          1773 08989000
         L     @01,GDTPTR                                          1773 08990000
         L     @15,GDTTR2(,@01)                                    1773 08991000
         MVC   @TS00001(95),NEWERID2(@15)                          1773 08992000
         MVC   OLDERID2(95,@15),@TS00001                           1773 08993000
*                    NEWID2='RI45';                                1774 08994000
         MVC   NEWID2(4,@15),@CC01178                              1774 08995000
*                    SYNUNIT=DEFLTVAL(1:DEFLTLEN);                 1775 08996000
         MVI   SYNUNIT+1,C' '                                      1775 08997000
         MVC   SYNUNIT+2(253),SYNUNIT+1                            1775 08998000
         L     @15,DEFLTPTR                                        1775 08999000
         SLR   @14,@14                                             1775 09000000
         IC    @14,DEFLTLEN(,@15)                                  1775 09001000
         LR    @05,@14                                             1775 09002000
         BCTR  @05,0                                               1775 09003000
         EX    @05,@SM01379                                        1775 09004000
*                    UNITINDX=DEFLTLEN;                            1776 09005000
         STH   @14,UNITINDX                                        1776 09006000
*                    END;                                          1777 09007000
*                                                                  1777 09008000
*                CALL BUILDFDT;                                    1778 09009000
*                                                                  1778 09010000
@RC01766 BAL   @14,BUILDFDT                                        1778 09011000
*                END DOGRP150;                                     1779 09012000
*            END DOGRP145;                                         1780 09013000
*                                                                  1780 09014000
*        END SETDFLT;                                              1781 09015000
*                                                                  1781 09016000
*                                                                  1781 09017000
@EL00022 DS    0H                                                  1781 09018000
@EF00022 DS    0H                                                  1781 09019000
@ER00022 LM    @14,@12,@SA00022                                    1781 09020000
         BR    @14                                                 1781 09021000
*        END DEFAULTS;                                             1782 09022000
@EL00021 DS    0H                                                  1782 09023000
@EF00021 DS    0H                                                  1782 09024000
@ER00021 LM    @14,@12,@SA00021                                    1782 09025000
         BR    @14                                                 1782 09026000
*/********************************************************************/ 09027000
*/*                                                                  */ 09028000
*/*  PROCEDURE NAME - NEEDNOTS                                       */ 09029000
*/*                                                                  */ 09030000
*/*  FUNCTION - THIS ROUTINE CHECKS PARAMETERS TO INSURE THAT CERTAIN*/ 09031000
*/*             SEMANTIC REQUIREMENTS HAVE NOT BEEN VIOLATED.  EACH  */ 09032000
*/*             INPUT PARAMETER IS EXAMINED, CHECKING THAT OTHER     */ 09033000
*/*             PARAMETERS HAVE BEEN INPUT WHICH MUST BE PRESENT WHEN*/ 09034000
*/*             THIS PARAMETER IS PRESENT, AND CHECKING THAT CERTAIN */ 09035000
*/*             PARAMETERS ARE NOT INPUT WHICH MUST NOT BE PRESENT   */ 09036000
*/*             WHEN THIS PARAMETER IS PRESENT.  THIS ROUTINE IS     */ 09037000
*/*             CALLED WHEN SCANNING OF A REPEATED SUBPARAMETER LIST */ 09038000
*/*             REPETITION HAS JUST BEEN COMPLETED (ONLY REQUIREMENTS*/ 09039000
*/*             WITHIN THE SUBLIST ARE CHECKED) AND THE ROUTINE IS   */ 09040000
*/*             CALLED AT COMMAND TERMINATION (AT WHICH TIME ALL THE */ 09041000
*/*             PARAMETER RELATIONSHIPS ARE CHECKED EXCEPT THOSE     */ 09042000
*/*             INVOLVING PARAMETERS WITHIN A REPEATED SUBLIST).     */ 09043000
*/*             'NEED' AND 'NOT' RELATIONSHIPS ARE NOT ALLOWED       */ 09044000
*/*             BETWEEN A PARAMETER WITHIN A REPEATED SUBLIST AND A  */ 09045000
*/*             PARAMETER NOT WITHIN THAT SAME SUBLIST. THE SEMANTIC */ 09046000
*/*             REQUIREMENTS ARE CHECKED AFTER DEFAULTS ARE APPLIED. */ 09047000
*/*                                                                  */ 09048000
*/*  INPUT -                                                         */ 09049000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 09050000
*/*          SUPERID - ID# OF THE PARAMETER WHOSE SUBLIST IS BEING   */ 09051000
*/*                    CHECKED FOR SEMANTIC CORRECTNESS; ID#=0 IF    */ 09052000
*/*                    CHECKING THE COMMAND AS A WHOLE               */ 09053000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */ 09054000
*/*                                                                  */ 09055000
*/*  OUTPUT -  NONE                                                  */ 09056000
*/*                                                                  */ 09057000
*/********************************************************************/ 09058000
*NEEDNOTS:PROCEDURE;                                               1783 09059000
NEEDNOTS STM   @14,@12,@SA00023                                    1783 09060000
*        /************************************************************/ 09061000
*        /*                                                          */ 09062000
*        /* NEEDNOTS PROCEDURE DATA DEFINITIONS                      */ 09063000
*        /*                                                          */ 09064000
*        /************************************************************/ 09065000
*                                                                  1784 09066000
*        /* STATIC ERROR MESSAGE CODES                               */ 09067000
*        DCL MISSPARM FIXED(31)        /*REQUIRED PARM IS MISSING    */ 09068000
*                     CONSTANT(26);                                1784 09069000
*        DCL BADPARM  FIXED(31)        /*PARAMETER IS PRESENT WHICH  */ 09070000
*                     CONSTANT(27);    /* IS NOT ALLOWED             */ 09071000
*                                                                  1785 09072000
*        DCL WORKVAR3 FIXED(15);       /*VARIABLE TO CONTAIN         */ 09073000
*                                      /*A TEMPORARY VALUE           */ 09074000
*        DCL FOUNDONE BIT(1);          /*FLAG SET TO AVOID PRINTING     09075000
*                                        THE SAME ERROR MSG TWICE    */ 09076000
*        /************************************************************/ 09077000
*        /*                                                          */ 09078000
*        /*  ** NEEDNOTS **  CHECK 'NEED' AND 'NOT' REQUIREMENTS     */ 09079000
*        /*                                                          */ 09080000
*        /************************************************************/ 09081000
*        IF GDTDBG = NULLPTR                                       1788 09082000
*          THEN;                                                   1788 09083000
         L     @01,GDTPTR                                          1788 09084000
         L     @15,GDTDBG(,@01)                                    1788 09085000
         LTR   @15,@15                                             1788 09086000
         BZ    @RT01788                                            1788 09087000
*          ELSE                                                    1790 09088000
*            CALL ICKDB010(GDTTBL,'RINN');                         1790 09089000
*                                                                  1790 09090000
         L     @15,GDTPTR                                          1790 09091000
         ST    @15,@AL00001                                        1790 09092000
         LA    @14,@CC01186                                        1790 09093000
         ST    @14,@AL00001+4                                      1790 09094000
         MVI   @AL00001+4,X'80'                                    1790 09095000
         L     @15,GDTDBG(,@15)                                    1790 09096000
         LA    @01,@AL00001                                        1790 09097000
         BALR  @14,@15                                             1790 09098000
*        /************************************************************/ 09099000
*        /*                                                          */ 09100000
*        /* IF AT COMMAND END, CHECK VERB LEVEL 'NEED                */ 09101000
*        /* GROUPS'.  THAT IS, CHECK FOR GROUPS OF PARMS             */ 09102000
*        /* (WHICH DON'T APPEAR WITHIN REPEATED SUBLISTS)            */ 09103000
*        /* ONE OF WHICH MUST BE INPUT.                              */ 09104000
*        /*                                                          */ 09105000
*        /************************************************************/ 09106000
*        IF SUPERID(PARMLVL)=0 & VNGRPDSP>0                        1791 09107000
*          THEN                                                    1791 09108000
@RT01788 LH    @15,PARMLVL                                         1791 09109000
         ALR   @15,@15                                             1791 09110000
         LH    @15,SUPERID-2(@15)                                  1791 09111000
         LTR   @15,@15                                             1791 09112000
         BNZ   @RF01791                                            1791 09113000
         L     @01,DESCPTR                                         1791 09114000
         CLI   VNGRPDSP(@01),0                                     1791 09115000
         BNH   @RF01791                                            1791 09116000
*DOGRP155:   DO;                                                   1792 09117000
DOGRP155 DS    0H                                                  1793 09118000
*              GRPPTR=ADDR(VNGRPTOT)+LENGTH(VNGRPTOT);             1793 09119000
         L     @15,DESCPTR                                         1793 09120000
         SLR   @14,@14                                             1793 09121000
         IC    @14,VNGRPDSP(,@15)                                  1793 09122000
         ALR   @14,@14                                             1793 09123000
         ALR   @15,@14                                             1793 09124000
         AL    @15,@CF00124                                        1793 09125000
         ST    @15,GRPPTR                                          1793 09126000
*DOLOOP35:     DO LISTINDX=1 TO VNGRPTOT;                          1794 09127000
DOLOOP35 LA    @15,1                                               1794 09128000
         B     @DE01794                                            1794 09129000
@DL01794 DS    0H                                                  1795 09130000
*                FOUNDONE=NO;                                      1795 09131000
*                                                                  1795 09132000
         NI    FOUNDONE,B'01111111'                                1795 09133000
*                /****************************************************/ 09134000
*                /*                                                  */ 09135000
*                /* CHECK EACH 'NEED GROUP' SUBLIST TO BE            */ 09136000
*                /* SURE AT LEAST ONE OF THE PARAMETERS OF           */ 09137000
*                /* IDENTIFIED IN THE SUBLIST IS INPUT.              */ 09138000
*                /*                                                  */ 09139000
*                /****************************************************/ 09140000
*                DO INDEX2=1 TO VNGRPCNT;                          1796 09141000
         LA    @15,1                                               1796 09142000
         B     @DE01796                                            1796 09143000
@DL01796 DS    0H                                                  1797 09144000
*                  IF PARMFLAG(VNGRPID(INDEX2))^=0                 1797 09145000
*                    THEN                                          1797 09146000
         ALR   @15,@15                                             1797 09147000
         L     @01,GRPPTR                                          1797 09148000
         LH    @15,VNGRPID-2(@15,@01)                              1797 09149000
         MH    @15,@CH00038                                        1797 09150000
         L     @01,WORKPTR                                         1797 09151000
         BCTR  @01,0                                               1797 09152000
         BCTR  @01,0                                               1797 09153000
         SLR   @14,@14                                             1797 09154000
         IC    @14,PARMFLAG-10(@15,@01)                            1797 09155000
         CH    @14,@CH00102                                        1797 09156000
         BE    @RF01797                                            1797 09157000
*                      FOUNDONE=YES;                               1798 09158000
         OI    FOUNDONE,B'10000000'                                1798 09159000
*                END;                                              1799 09160000
@RF01797 LA    @15,1                                               1799 09161000
         AH    @15,INDEX2                                          1799 09162000
@DE01796 STH   @15,INDEX2                                          1799 09163000
         L     @14,GRPPTR                                          1799 09164000
         CH    @15,VNGRPCNT(,@14)                                  1799 09165000
         BNH   @DL01796                                            1799 09166000
*                IF FOUNDONE=NO                                    1800 09167000
*                  THEN                                            1800 09168000
*                                                                  1800 09169000
         TM    FOUNDONE,B'10000000'                                1800 09170000
         BNZ   @RF01800                                            1800 09171000
*                    CALL ERRSETUP(MISSPARM,VNGRPID(1));           1801 09172000
*                                                                  1801 09173000
         LA    @15,@CF00294                                        1801 09174000
         ST    @15,@AL00001                                        1801 09175000
         L     @01,GRPPTR                                          1801 09176000
         LA    @15,VNGRPID(,@01)                                   1801 09177000
         ST    @15,@AL00001+4                                      1801 09178000
         LA    @01,@AL00001                                        1801 09179000
         BAL   @14,ERRSETUP                                        1801 09180000
*                GRPPTR=GRPPTR+LENGTH(VNGRPCNT)+                   1802 09181000
*                            VNGRPCNT*LENGTH(VNGRPID(1));          1802 09182000
@RF01800 L     @15,GRPPTR                                          1802 09183000
         LA    @14,2                                               1802 09184000
         ALR   @14,@15                                             1802 09185000
         LH    @15,VNGRPCNT(,@15)                                  1802 09186000
         ALR   @15,@15                                             1802 09187000
         ALR   @14,@15                                             1802 09188000
         ST    @14,GRPPTR                                          1802 09189000
*              END DOLOOP35;                                       1803 09190000
         LA    @15,1                                               1803 09191000
         AH    @15,LISTINDX                                        1803 09192000
@DE01794 STH   @15,LISTINDX                                        1803 09193000
         L     @14,DESCPTR                                         1803 09194000
         SLR   @05,@05                                             1803 09195000
         IC    @05,VNGRPDSP(,@14)                                  1803 09196000
         ALR   @05,@05                                             1803 09197000
         AL    @05,DESCPTR                                         1803 09198000
         CH    @15,VNGRPTOT(,@05)                                  1803 09199000
         BNH   @DL01794                                            1803 09200000
*            END DOGRP155;                                         1804 09201000
*                                                                  1804 09202000
*        /************************************************************/ 09203000
*        /*                                                          */ 09204000
*        /* CHECK EACH PARAMETER TO SEE IF IT IS PART OF THE         */ 09205000
*        /* SET OF PARAMETERS CURRENTLY BEING HANDLED.  IF           */ 09206000
*        /* SO, CHECK THE LIST(S) OF REQUIRED PARAMETERS             */ 09207000
*        /* AND CONFLICTING PARAMETERS ASSOCIATED WITH EACH          */ 09208000
*        /* PARAMETER TO SEE IF ANY ERRORS EXIST.                    */ 09209000
*        /*                                                          */ 09210000
*        /************************************************************/ 09211000
*DOLOOP40:DO PARMID=1 TO MAXID;                                    1805 09212000
@RF01791 DS    0H                                                  1805 09213000
DOLOOP40 LA    @15,1                                               1805 09214000
         B     @DE01805                                            1805 09215000
@DL01805 DS    0H                                                  1806 09216000
*          IF PARMFLAG(PARMID)^=0                                  1806 09217000
*            THEN                                                  1806 09218000
         MH    @15,@CH00038                                        1806 09219000
         L     @01,WORKPTR                                         1806 09220000
         BCTR  @01,0                                               1806 09221000
         BCTR  @01,0                                               1806 09222000
         SLR   @14,@14                                             1806 09223000
         IC    @14,PARMFLAG-10(@15,@01)                            1806 09224000
         CH    @14,@CH00102                                        1806 09225000
         BE    @RF01806                                            1806 09226000
*DOGRP170:     DO;                                                 1807 09227000
DOGRP170 DS    0H                                                  1808 09228000
*                FOUND=NO;                                         1808 09229000
         NI    FOUND,B'11011111'                                   1808 09230000
*                TESTID=PARMID;                                    1809 09231000
         MVC   TESTID(2),PARMID                                    1809 09232000
*                DO WHILE(TESTID^=0 & FOUND=NO);                   1810 09233000
         B     @DE01810                                            1810 09234000
@DL01810 DS    0H                                                  1811 09235000
*                  IF SUPRPARM(TESTID)=SUPERID(PARMLVL)            1811 09236000
*                    THEN                                          1811 09237000
         LH    @15,TESTID                                          1811 09238000
         MH    @15,@CH00038                                        1811 09239000
         LH    @14,PARMLVL                                         1811 09240000
         ALR   @14,@14                                             1811 09241000
         L     @01,WORKPTR                                         1811 09242000
         AL    @01,@CF01318                                        1811 09243000
         LH    @15,SUPRPARM-8(@15,@01)                             1811 09244000
         CH    @15,SUPERID-2(@14)                                  1811 09245000
         BNE   @RF01811                                            1811 09246000
*                      FOUND=YES;                                  1812 09247000
         OI    FOUND,B'00100000'                                   1812 09248000
*                    ELSE                                          1813 09249000
*                      DO;                                         1813 09250000
         B     @RC01811                                            1813 09251000
@RF01811 DS    0H                                                  1814 09252000
*                      TESTID=SUPRPARM(TESTID);                    1814 09253000
         L     @15,WORKPTR                                         1814 09254000
         LA    @14,12                                              1814 09255000
         LR    @05,@14                                             1814 09256000
         MH    @05,TESTID                                          1814 09257000
         AL    @05,@CF01318                                        1814 09258000
         LH    @05,SUPRPARM-8(@05,@15)                             1814 09259000
         STH   @05,TESTID                                          1814 09260000
*                      IF PARMPTR(TESTID)->REPEATED=YES            1815 09261000
*                        THEN                                      1815 09262000
         MR    @04,@14                                             1815 09263000
         AL    @15,@CF01317                                        1815 09264000
         L     @01,PARMPTR(@05,@15)                                1815 09265000
         TM    REPEATED(@01),B'00100000'                           1815 09266000
         BNO   @RF01815                                            1815 09267000
*                          TESTID=0;                               1816 09268000
         SLR   @15,@15                                             1816 09269000
         STH   @15,TESTID                                          1816 09270000
*                      END;                                        1817 09271000
@RF01815 DS    0H                                                  1818 09272000
*                END;                                              1818 09273000
*                                                                  1818 09274000
@RC01811 DS    0H                                                  1818 09275000
@DE01810 LH    @15,TESTID                                          1818 09276000
         LTR   @15,@15                                             1818 09277000
         BZ    @DC01810                                            1818 09278000
         TM    FOUND,B'00100000'                                   1818 09279000
         BZ    @DL01810                                            1818 09280000
@DC01810 DS    0H                                                  1819 09281000
*                IF FOUND=YES                                      1819 09282000
*                  THEN                                            1819 09283000
         TM    FOUND,B'00100000'                                   1819 09284000
         BNO   @RF01819                                            1819 09285000
*DOGRP160:           DO;                                           1820 09286000
*                                                                  1820 09287000
DOGRP160 DS    0H                                                  1821 09288000
*                    /************************************************/ 09289000
*                    /*                                              */ 09290000
*                    /* IF 'NEED GROUPS' EXIST FOR THIS              */ 09291000
*                    /* PARAMETER, CHECK TO INSURE THAT AT           */ 09292000
*                    /* LEAST ONE PARAMETER IN EACH GROUP            */ 09293000
*                    /* IS INPUT (A 'GROUP' MAY BE JUST A            */ 09294000
*                    /* SINGLE PARAMETER THAT IS ALWAYS              */ 09295000
*                    /* REQUIRED).                                   */ 09296000
*                    /*                                              */ 09297000
*                    /************************************************/ 09298000
*                    IF NGRPDSPL > 0                               1821 09299000
*                      THEN                                        1821 09300000
         LH    @15,PARMID                                          1821 09301000
         MH    @15,@CH00038                                        1821 09302000
         L     @01,WORKPTR                                         1821 09303000
         AL    @01,@CF01317                                        1821 09304000
         L     @01,PARMPTR(@15,@01)                                1821 09305000
         CLI   NGRPDSPL(@01),0                                     1821 09306000
         BNH   @RF01821                                            1821 09307000
*DOGRP165:               DO;                                       1822 09308000
DOGRP165 DS    0H                                                  1823 09309000
*                          GRPPTR=ADDR(NGRPTOT)+                   1823 09310000
*                                          LENGTH(NGRPTOT);        1823 09311000
         LH    @15,PARMID                                          1823 09312000
         MH    @15,@CH00038                                        1823 09313000
         L     @01,WORKPTR                                         1823 09314000
         AL    @01,@CF01317                                        1823 09315000
         L     @15,PARMPTR(@15,@01)                                1823 09316000
         SLR   @14,@14                                             1823 09317000
         IC    @14,NGRPDSPL(,@15)                                  1823 09318000
         ALR   @14,@14                                             1823 09319000
         ALR   @15,@14                                             1823 09320000
         LA    @14,2                                               1823 09321000
         ALR   @14,@15                                             1823 09322000
         ST    @14,GRPPTR                                          1823 09323000
*                          WORKVAR3=NGRPTOT;                       1824 09324000
         MVC   WORKVAR3(2),NGRPTOT(@15)                            1824 09325000
*DOLOOP42:                 DO LISTINDX=1 TO WORKVAR3;              1825 09326000
DOLOOP42 LA    @15,1                                               1825 09327000
         B     @DE01825                                            1825 09328000
@DL01825 DS    0H                                                  1826 09329000
*                            FOUNDONE=NO;                          1826 09330000
         NI    FOUNDONE,B'01111111'                                1826 09331000
*                            DO INDEX2=1 TO NGRPCNT;               1827 09332000
         LA    @15,1                                               1827 09333000
         B     @DE01827                                            1827 09334000
@DL01827 DS    0H                                                  1828 09335000
*                              IF PARMFLAG(NGRPID(INDEX2))^=0      1828 09336000
*                                THEN                              1828 09337000
         ALR   @15,@15                                             1828 09338000
         L     @01,GRPPTR                                          1828 09339000
         LH    @15,NGRPID-2(@15,@01)                               1828 09340000
         MH    @15,@CH00038                                        1828 09341000
         L     @01,WORKPTR                                         1828 09342000
         BCTR  @01,0                                               1828 09343000
         BCTR  @01,0                                               1828 09344000
         SLR   @14,@14                                             1828 09345000
         IC    @14,PARMFLAG-10(@15,@01)                            1828 09346000
         CH    @14,@CH00102                                        1828 09347000
         BE    @RF01828                                            1828 09348000
*                                  FOUNDONE=YES;                   1829 09349000
         OI    FOUNDONE,B'10000000'                                1829 09350000
*                            END;                                  1830 09351000
@RF01828 LA    @15,1                                               1830 09352000
         AH    @15,INDEX2                                          1830 09353000
@DE01827 STH   @15,INDEX2                                          1830 09354000
         L     @14,GRPPTR                                          1830 09355000
         CH    @15,NGRPCNT(,@14)                                   1830 09356000
         BNH   @DL01827                                            1830 09357000
*                            IF FOUNDONE=NO                        1831 09358000
*                              THEN                                1831 09359000
*                                                                  1831 09360000
         TM    FOUNDONE,B'10000000'                                1831 09361000
         BNZ   @RF01831                                            1831 09362000
*                                CALL ERRSETUP(MISSPARM,           1832 09363000
*                                              NGRPID(1));         1832 09364000
*                                                                  1832 09365000
         LA    @15,@CF00294                                        1832 09366000
         ST    @15,@AL00001                                        1832 09367000
         L     @01,GRPPTR                                          1832 09368000
         LA    @15,NGRPID(,@01)                                    1832 09369000
         ST    @15,@AL00001+4                                      1832 09370000
         LA    @01,@AL00001                                        1832 09371000
         BAL   @14,ERRSETUP                                        1832 09372000
*                            GRPPTR=GRPPTR+LENGTH(NGRPCNT)+        1833 09373000
*                               NGRPCNT*LENGTH(NGRPID(1));         1833 09374000
@RF01831 L     @15,GRPPTR                                          1833 09375000
         LA    @14,2                                               1833 09376000
         ALR   @14,@15                                             1833 09377000
         LH    @15,NGRPCNT(,@15)                                   1833 09378000
         ALR   @15,@15                                             1833 09379000
         ALR   @14,@15                                             1833 09380000
         ST    @14,GRPPTR                                          1833 09381000
*                          END DOLOOP42;                           1834 09382000
         LA    @15,1                                               1834 09383000
         AH    @15,LISTINDX                                        1834 09384000
@DE01825 STH   @15,LISTINDX                                        1834 09385000
         CH    @15,WORKVAR3                                        1834 09386000
         BNH   @DL01825                                            1834 09387000
*                        END DOGRP165;                             1835 09388000
*                                                                  1835 09389000
*                    /************************************************/ 09390000
*                    /*                                              */ 09391000
*                    /* IF A LIST OF PARAMETERS EXISTS               */ 09392000
*                    /* NOTING PARAMETERS WHICH CONFLICT             */ 09393000
*                    /* WITH THIS PARTICULAR PARAMETER,              */ 09394000
*                    /* CHECK THAT NONE OF THEM WERE INPUT           */ 09395000
*                    /*                                              */ 09396000
*                    /************************************************/ 09397000
*                    FOUNDONE=NO;                                  1836 09398000
@RF01821 NI    FOUNDONE,B'01111111'                                1836 09399000
*                    IF NOTDSPL > 0                                1837 09400000
*                      THEN                                        1837 09401000
         LH    @15,PARMID                                          1837 09402000
         MH    @15,@CH00038                                        1837 09403000
         L     @01,WORKPTR                                         1837 09404000
         AL    @01,@CF01317                                        1837 09405000
         L     @15,PARMPTR(@15,@01)                                1837 09406000
         CLI   NOTDSPL(@15),0                                      1837 09407000
         BNH   @RF01837                                            1837 09408000
*                        DO;                                       1838 09409000
*                          WORKVAR3=NOTCOUNT;                      1839 09410000
         SLR   @14,@14                                             1839 09411000
         IC    @14,NOTDSPL(,@15)                                   1839 09412000
         ALR   @14,@14                                             1839 09413000
         ALR   @15,@14                                             1839 09414000
         MVC   WORKVAR3(2),NOTCOUNT(@15)                           1839 09415000
*                          DO LISTINDX=1 TO WORKVAR3               1840 09416000
*                                      WHILE(FOUNDONE=NO);         1840 09417000
         LA    @15,1                                               1840 09418000
         B     @DE01840                                            1840 09419000
@DL01840 TM    FOUNDONE,B'10000000'                                1840 09420000
         BNZ   @DC01840                                            1840 09421000
*                            IF PARMFLAG(NOTID(LISTINDX)) ^= 0     1841 09422000
*                              THEN                                1841 09423000
*                                                                  1841 09424000
         L     @14,WORKPTR                                         1841 09425000
         LA    @05,12                                              1841 09426000
         ALR   @15,@15                                             1841 09427000
         LR    @04,@05                                             1841 09428000
         MH    @04,PARMID                                          1841 09429000
         AL    @04,@CF01317                                        1841 09430000
         L     @04,PARMPTR(@04,@14)                                1841 09431000
         SLR   @03,@03                                             1841 09432000
         IC    @03,NOTDSPL(,@04)                                   1841 09433000
         ALR   @03,@03                                             1841 09434000
         ALR   @04,@03                                             1841 09435000
         MH    @05,NOTID-2(@15,@04)                                1841 09436000
         BCTR  @14,0                                               1841 09437000
         BCTR  @14,0                                               1841 09438000
         SLR   @15,@15                                             1841 09439000
         IC    @15,PARMFLAG-10(@05,@14)                            1841 09440000
         CH    @15,@CH00102                                        1841 09441000
         BE    @RF01841                                            1841 09442000
*                                CALL ERRSETUP(BADPARM,            1842 09443000
*                                              PARMID);            1842 09444000
*                                                                  1842 09445000
         LA    @15,@CF00296                                        1842 09446000
         ST    @15,@AL00001                                        1842 09447000
         LA    @15,PARMID                                          1842 09448000
         ST    @15,@AL00001+4                                      1842 09449000
         LA    @01,@AL00001                                        1842 09450000
         BAL   @14,ERRSETUP                                        1842 09451000
*                          END;                                    1843 09452000
@RF01841 LA    @15,1                                               1843 09453000
         AH    @15,LISTINDX                                        1843 09454000
@DE01840 STH   @15,LISTINDX                                        1843 09455000
         CH    @15,WORKVAR3                                        1843 09456000
         BNH   @DL01840                                            1843 09457000
@DC01840 DS    0H                                                  1844 09458000
*                        END;                                      1844 09459000
*                                                                  1844 09460000
*                    /************************************************/ 09461000
*                    /*                                              */ 09462000
*                    /* IF THE CURRENT PARAMETER IS ONE OF           */ 09463000
*                    /* THE PARMS IDENTIFIED IN A 'NOT               */ 09464000
*                    /* GROUPS' SUBLIST (A SET OF MUTUALLY           */ 09465000
*                    /* EXCLUSIVE PARAMETERS), THEN CHECK TO         */ 09466000
*                    /* BE SURE NONE OF THE OTHER PARAMETERS         */ 09467000
*                    /* IDENTIFIED IN THE SUBLIST WERE INPUT         */ 09468000
*                    /*                                              */ 09469000
*                    /************************************************/ 09470000
*                    IF NTGRPPTR(PARMID) ^= 0                      1845 09471000
*                      THEN                                        1845 09472000
@RF01837 LH    @15,PARMID                                          1845 09473000
         MH    @15,@CH00038                                        1845 09474000
         L     @01,WORKPTR                                         1845 09475000
         AL    @01,@CF01376                                        1845 09476000
         L     @15,NTGRPPTR-4(@15,@01)                             1845 09477000
         LTR   @15,@15                                             1845 09478000
         BZ    @RF01845                                            1845 09479000
*                        DO;                                       1846 09480000
*                          GRPPTR=NTGRPPTR(PARMID);                1847 09481000
         ST    @15,GRPPTR                                          1847 09482000
*                          DO LISTINDX=1 TO NTGRPCNT               1848 09483000
*                                      WHILE(FOUNDONE=NO);         1848 09484000
         LA    @15,1                                               1848 09485000
         B     @DE01848                                            1848 09486000
@DL01848 TM    FOUNDONE,B'10000000'                                1848 09487000
         BNZ   @DC01848                                            1848 09488000
*                            IF PARMFLAG(NTGRPID(LISTINDX)) ^= 0  &     09489000
*                               NTGRPID(LISTINDX) ^= PARMID        1849 09490000
*                              THEN                                1849 09491000
*                                                                  1849 09492000
         ALR   @15,@15                                             1849 09493000
         L     @01,GRPPTR                                          1849 09494000
         LH    @15,NTGRPID-2(@15,@01)                              1849 09495000
         LR    @14,@15                                             1849 09496000
         MH    @14,@CH00038                                        1849 09497000
         L     @01,WORKPTR                                         1849 09498000
         BCTR  @01,0                                               1849 09499000
         BCTR  @01,0                                               1849 09500000
         SLR   @00,@00                                             1849 09501000
         IC    @00,PARMFLAG-10(@14,@01)                            1849 09502000
         CH    @00,@CH00102                                        1849 09503000
         BE    @RF01849                                            1849 09504000
         CH    @15,PARMID                                          1849 09505000
         BE    @RF01849                                            1849 09506000
*                                CALL ERRSETUP(BADPARM,            1850 09507000
*                                               PARMID);           1850 09508000
*                                                                  1850 09509000
         LA    @15,@CF00296                                        1850 09510000
         ST    @15,@AL00001                                        1850 09511000
         LA    @15,PARMID                                          1850 09512000
         ST    @15,@AL00001+4                                      1850 09513000
         LA    @01,@AL00001                                        1850 09514000
         BAL   @14,ERRSETUP                                        1850 09515000
*                          END;                                    1851 09516000
@RF01849 LA    @15,1                                               1851 09517000
         AH    @15,LISTINDX                                        1851 09518000
@DE01848 STH   @15,LISTINDX                                        1851 09519000
         L     @14,GRPPTR                                          1851 09520000
         CH    @15,NTGRPCNT(,@14)                                  1851 09521000
         BNH   @DL01848                                            1851 09522000
@DC01848 DS    0H                                                  1852 09523000
*                        END;                                      1852 09524000
*                    END DOGRP160;                                 1853 09525000
@RF01845 DS    0H                                                  1854 09526000
*              END DOGRP170;                                       1854 09527000
@RF01819 DS    0H                                                  1855 09528000
*        END DOLOOP40;                                             1855 09529000
@RF01806 LA    @15,1                                               1855 09530000
         AH    @15,PARMID                                          1855 09531000
@DE01805 STH   @15,PARMID                                          1855 09532000
         L     @14,DESCPTR                                         1855 09533000
         CH    @15,MAXID(,@14)                                     1855 09534000
         BNH   @DL01805                                            1855 09535000
*/********************************************************************/ 09536000
*/*                                                                  */ 09537000
*/*  PROCEDURE NAME - ERRSETUP                                       */ 09538000
*/*                                                                  */ 09539000
*/*  FUNCTION - THIS ROUTINE SEARCHES FOR A KEYWORD TO BE INSERTED   */ 09540000
*/*             INTO AN ERROR MESSAGE CONCERNING REQUIRED PARAMETERS */ 09541000
*/*             WHICH ARE MISSING OR INVALID COMBINATIONS OF PARM'S. */ 09542000
*/*                                                                  */ 09543000
*/*  INPUT -                                                         */ 09544000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */ 09545000
*/*          ERRPRMID- PARAMETER ID# OF PARAMETER WHICH IS IN ERROR  */ 09546000
*/*          ERRMSGID- MESSAGE ID# OF MESSAGE INTO WHICH THE KEYWORD */ 09547000
*/*                    IS TO BE INSERTED                             */ 09548000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */ 09549000
*/*                                                                  */ 09550000
*/*  OUTPUT -                                                        */ 09551000
*/*          ERRMSGID- SEE 'INPUT'                                   */ 09552000
*/*          ERRFIELD- CONTAINS THE KEYWORD TO BE INSERTED INTO THE  */ 09553000
*/*                    ERROR MESSAGE                                 */ 09554000
*/*                                                                  */ 09555000
*/********************************************************************/ 09556000
*ERRSETUP:PROCEDURE(ERRMSGID,          /*STATIC ERROR MESSAGE CODE   */ 09557000
*                   ERRPRMID);         /*PARM ID# OF INVALID PARM.   */ 09558000
         B     @PB00024                                            1856 09559000
ERRSETUP STM   @14,@12,@SA00024                                    1856 09560000
         MVC   @PC00024(8),0(@01)                                  1856 09561000
*        /************************************************************/ 09562000
*        /*                                                          */ 09563000
*        /* ERRSETUP ROUTINE DATA DEFINITIONS                        */ 09564000
*        /*                                                          */ 09565000
*        /************************************************************/ 09566000
*        DCL ERRMSGID FIXED(31);       /*STATIC ERROR MESSAGE CODE   */ 09567000
*        DCL ERRPRMID FIXED(15);       /*PARAMETER ID# OR MISSING OR    09568000
*                                        INCONSISTENT PARAMETER      */ 09569000
*        /************************************************************/ 09570000
*        /*                                                          */ 09571000
*        /*  ** ERRSETUP **  SET UP KEYWORD NAME FOR ERROR MESSAGE   */ 09572000
*        /*                                                          */ 09573000
*        /************************************************************/ 09574000
*                                                                  1859 09575000
*        FOUNDONE=YES;                                             1859 09576000
         OI    FOUNDONE,B'10000000'                                1859 09577000
*        TESTID=PARMID;                                            1860 09578000
         MVC   TESTID(2),PARMID                                    1860 09579000
*        PARMID=ERRPRMID;                                          1861 09580000
         L     @15,@PC00024+4                                      1861 09581000
         MVC   PARMID(2),ERRPRMID(@15)                             1861 09582000
*        DO WHILE(PARMID ^= 0);                                    1862 09583000
         B     @DE01862                                            1862 09584000
@DL01862 DS    0H                                                  1863 09585000
*          IF KWDDSPL ^= 0                                         1863 09586000
*            THEN                                                  1863 09587000
         LH    @15,PARMID                                          1863 09588000
         MH    @15,@CH00038                                        1863 09589000
         L     @01,WORKPTR                                         1863 09590000
         AL    @01,@CF01317                                        1863 09591000
         L     @15,PARMPTR(@15,@01)                                1863 09592000
         CLI   KWDDSPL(@15),0                                      1863 09593000
         BE    @RF01863                                            1863 09594000
*              DO;                                                 1864 09595000
*              KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT);             1865 09596000
         SLR   @14,@14                                             1865 09597000
         IC    @14,KWDDSPL(,@15)                                   1865 09598000
         ALR   @14,@14                                             1865 09599000
         ALR   @15,@14                                             1865 09600000
         AL    @15,@CF00172                                        1865 09601000
         ST    @15,KWDPTR                                          1865 09602000
*              ERRFIELD=BLANK;                                     1866 09603000
         MVI   ERRFIELD+1,C' '                                     1866 09604000
         MVC   ERRFIELD+2(18),ERRFIELD+1                           1866 09605000
         MVI   ERRFIELD,C' '                                       1866 09606000
*              ERRFIELD=KWDITEM(1:KWDLEN);                         1867 09607000
         MVI   ERRFIELD+1,C' '                                     1867 09608000
         MVC   ERRFIELD+2(18),ERRFIELD+1                           1867 09609000
         SLR   @14,@14                                             1867 09610000
         IC    @14,KWDLEN(,@15)                                    1867 09611000
         BCTR  @14,0                                               1867 09612000
         EX    @14,@SM01381                                        1867 09613000
*              PARMID=0;                                           1868 09614000
         SLR   @15,@15                                             1868 09615000
         STH   @15,PARMID                                          1868 09616000
*              END;                                                1869 09617000
*            ELSE                                                  1870 09618000
*              PARMID=SUPRPARM(PARMID);                            1870 09619000
         B     @RC01863                                            1870 09620000
@RF01863 LH    @15,PARMID                                          1870 09621000
         MH    @15,@CH00038                                        1870 09622000
         L     @01,WORKPTR                                         1870 09623000
         AL    @01,@CF01318                                        1870 09624000
         LH    @15,SUPRPARM-8(@15,@01)                             1870 09625000
         STH   @15,PARMID                                          1870 09626000
*        END;                                                      1871 09627000
*                                                                  1871 09628000
@RC01863 DS    0H                                                  1871 09629000
@DE01862 LH    @15,PARMID                                          1871 09630000
         LTR   @15,@15                                             1871 09631000
         BNZ   @DL01862                                            1871 09632000
*        CALL ERROR2(ERRMSGID,LENGTH(ERRFIELD),ADDR(ERRFIELD));    1872 09633000
*                                                                  1872 09634000
         L     @15,@PC00024                                        1872 09635000
         ST    @15,@AL00001                                        1872 09636000
         LA    @15,@CF00282                                        1872 09637000
         ST    @15,@AL00001+4                                      1872 09638000
         LA    @15,ERRFIELD                                        1872 09639000
         ST    @15,@AFTEMPS+36                                     1872 09640000
         LA    @15,@AFTEMPS+36                                     1872 09641000
         ST    @15,@AL00001+8                                      1872 09642000
         LA    @01,@AL00001                                        1872 09643000
         BAL   @14,ERROR2                                          1872 09644000
*        PARMID=TESTID;                                            1873 09645000
*                                                                  1873 09646000
         MVC   PARMID(2),TESTID                                    1873 09647000
*        END ERRSETUP;                                             1874 09648000
*                                                                  1874 09649000
*                                                                  1874 09650000
@EL00024 DS    0H                                                  1874 09651000
@EF00024 DS    0H                                                  1874 09652000
@ER00024 LM    @14,@12,@SA00024                                    1874 09653000
         BR    @14                                                 1874 09654000
*        END NEEDNOTS;                                             1875 09655000
@EL00023 DS    0H                                                  1875 09656000
@EF00023 DS    0H                                                  1875 09657000
@ER00023 LM    @14,@12,@SA00023                                    1875 09658000
         BR    @14                                                 1875 09659000
*/********************************************************************/ 09660000
*/*                                                                  */ 09661000
*/*  PROCEDURE NAME - SKIPCMD                                        */ 09662000
*/*                                                                  */ 09663000
*/*  FUNCTION - THIS ROUTINE BYPASSES CHARACTERS UNTIL A COMMAND-END */ 09664000
*/*             DELIMITER IS FOUND WHICH DOES NOT APPEAR WITHIN A    */ 09665000
*/*             COMMENT.  IT IS INVOKED WHEN A SYNTAX OR SEMANTIC    */ 09666000
*/*             ERROR HAS BEEN FOUND WHICH REQUIRES THAT THE CURRENT */ 09667000
*/*             COMMAND BE BYPASSED.                                 */ 09668000
*/*                                                                  */ 09669000
*/*  INPUT -                                                         */ 09670000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 09671000
*/*                    CODE WHEN AN ERROR IS DETECTED.               */ 09672000
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED.               */ 09673000
*/*          CHAR2 -   NEXT INPUT CHARACTER TO BE EXTRACTED.         */ 09674000
*/*                                                                  */ 09675000
*/*  OUTPUT -                                                        */ 09676000
*/*          SKIPPAST- FLAG SET 'ON' TO SIGNAL THAT THE COMMAND HAS  */ 09677000
*/*                    BEEN BYPASSED.                                */ 09678000
*/*                                                                  */ 09679000
*/********************************************************************/ 09680000
*SKIPCMD:PROCEDURE;                                                1876 09681000
SKIPCMD  STM   @14,@12,@SA00025                                    1876 09682000
*        /************************************************************/ 09683000
*        /*                                                          */ 09684000
*        /* SKIPCMD PROCEDURE DATA DEFINITIONS                       */ 09685000
*        /*                                                          */ 09686000
*        /************************************************************/ 09687000
*        DCL SKIPDONE BIT(1);          /*THE COMMAND HAS BEEN      1877 09688000
*                                        COMPLETELY BYPASSED.        */ 09689000
*        /************************************************************/ 09690000
*        /*                                                          */ 09691000
*        /*  ** SKIPCMD **  BYPASS CURRENT COMMAND                   */ 09692000
*        /*                                                          */ 09693000
*        /************************************************************/ 09694000
*        IF GDTDBG = NULLPTR                                       1878 09695000
*          THEN;                                                   1878 09696000
         L     @01,GDTPTR                                          1878 09697000
         L     @15,GDTDBG(,@01)                                    1878 09698000
         LTR   @15,@15                                             1878 09699000
         BZ    @RT01878                                            1878 09700000
*          ELSE                                                    1880 09701000
*            CALL ICKDB010(GDTTBL,'RISK');                         1880 09702000
*                                                                  1880 09703000
         L     @15,GDTPTR                                          1880 09704000
         ST    @15,@AL00001                                        1880 09705000
         LA    @14,@CC01213                                        1880 09706000
         ST    @14,@AL00001+4                                      1880 09707000
         MVI   @AL00001+4,X'80'                                    1880 09708000
         L     @15,GDTDBG(,@15)                                    1880 09709000
         LA    @01,@AL00001                                        1880 09710000
         BALR  @14,@15                                             1880 09711000
*        COMMENT=NO;                                               1881 09712000
@RT01878 NI    COMMENT,B'10111111'                                 1881 09713000
*        SKIPDONE=NO;                                              1882 09714000
         NI    SKIPDONE,B'01111111'                                1882 09715000
*        SKIPPAST=YES;                                             1883 09716000
*                                                                  1883 09717000
         OI    SKIPPAST,B'00001000'                                1883 09718000
*        /************************************************************/ 09719000
*        /*                                                          */ 09720000
*        /* SCAN PAST CHARACTERS UNTIL THE COMMAND-END DELIMITER IS  */ 09721000
*        /* FOUND.  THE DELIMITER WILL NEVER BE WITHIN A COMMENT.    */ 09722000
*        /*                                                          */ 09723000
*        /************************************************************/ 09724000
*        DO WHILE(SKIPDONE=NO & RISTATUS^=EOFILE & RISTATUS^=SKIPREST); 09725000
         B     @DE01884                                            1884 09726000
@DL01884 DS    0H                                                  1885 09727000
*          IF COMMENT=NO                                           1885 09728000
*            THEN                                                  1885 09729000
         TM    COMMENT,B'01000000'                                 1885 09730000
         BNZ   @RF01885                                            1885 09731000
*              IF CHAR1=ENDDELIM                                   1886 09732000
*                THEN                                              1886 09733000
         CLI   CHAR1,C';'                                          1886 09734000
         BNE   @RF01886                                            1886 09735000
*                  SKIPDONE=YES;                                   1887 09736000
*                                                                  1887 09737000
         OI    SKIPDONE,B'10000000'                                1887 09738000
*                /****************************************************/ 09739000
*                /*                                                  */ 09740000
*                /* IF NOT COMMAND END, THEN CONTINUE SCANNING,      */ 09741000
*                /* CHECKING TO SEE IF THE BEGINNING OF A COMMENT    */ 09742000
*                /* HAS BEEN FOUND.                                  */ 09743000
*                /*                                                  */ 09744000
*                /****************************************************/ 09745000
*                ELSE                                              1888 09746000
*                  IF CHAR1=COMSTART(1) & CHAR2=COMSTART(2)        1888 09747000
*                    THEN                                          1888 09748000
         B     @RC01886                                            1888 09749000
@RF01886 CLC   CHAR1(1),COMSTART                                   1888 09750000
         BNE   @RF01888                                            1888 09751000
         CLC   CHAR2(1),COMSTART+1                                 1888 09752000
         BNE   @RF01888                                            1888 09753000
*                      DO;                                         1889 09754000
*                                                                  1889 09755000
*                      CALL NEXTCHAR;                              1890 09756000
*                                                                  1890 09757000
         BAL   @14,NEXTCHAR                                        1890 09758000
*                      COMMENT=YES;                                1891 09759000
         OI    COMMENT,B'01000000'                                 1891 09760000
*                      END;                                        1892 09761000
*                    ELSE;                                         1893 09762000
@RF01888 DS    0H                                                  1894 09763000
*            ELSE                                                  1894 09764000
*                                                                  1894 09765000
*              /******************************************************/ 09766000
*              /*                                                    */ 09767000
*              /* IF CURRENTLY BYPASSING CHARACTERS WITHIN A COMMENT,*/ 09768000
*              /* CHECK FOR THE COMMENT-END DELIMITER WHICH SIGNALS  */ 09769000
*              /* END OF COMMENT.  IF AN R/I-GENERATED SEMICOLON IS  */ 09770000
*              /* FOUND IN MID-COMMENT, CONSIDER THAT TO BE THE END  */ 09771000
*              /* OF THE COMMAND.                                    */ 09772000
*              /*                                                    */ 09773000
*              /******************************************************/ 09774000
*              IF CHAR1=COMEND(1) & CHAR2=COMEND(2)                1894 09775000
*                THEN                                              1894 09776000
         B     @RC01885                                            1894 09777000
@RF01885 CLC   CHAR1(1),COMEND                                     1894 09778000
         BNE   @RF01894                                            1894 09779000
         CLC   CHAR2(1),COMEND+1                                   1894 09780000
         BNE   @RF01894                                            1894 09781000
*                  DO;                                             1895 09782000
*                  COMMENT=NO;                                     1896 09783000
*                                                                  1896 09784000
         NI    COMMENT,B'10111111'                                 1896 09785000
*                  CALL NEXTCHAR;                                  1897 09786000
*                                                                  1897 09787000
         BAL   @14,NEXTCHAR                                        1897 09788000
*                  END;                                            1898 09789000
*                ELSE                                              1899 09790000
*                  IF CHAR1=ENDDELIM &                             1899 09791000
*                     (OPTSFLAG=ON | MORTOCOM=NO) &                1899 09792000
*                     SCANINDX >= SCNLIMIT                         1899 09793000
*                    THEN                                          1899 09794000
         B     @RC01894                                            1899 09795000
@RF01894 CLI   CHAR1,C';'                                          1899 09796000
         BNE   @RF01899                                            1899 09797000
         TM    OPTSFLAG,B'00100000'                                1899 09798000
         BO    @GL00108                                            1899 09799000
         TM    MORTOCOM,B'00010000'                                1899 09800000
         BNZ   @RF01899                                            1899 09801000
@GL00108 LH    @15,SCANINDX                                        1899 09802000
         CH    @15,SCNLIMIT                                        1899 09803000
         BL    @RF01899                                            1899 09804000
*                      SKIPDONE=YES;                               1900 09805000
*                                                                  1900 09806000
         OI    SKIPDONE,B'10000000'                                1900 09807000
*          /**********************************************************/ 09808000
*          /*                                                        */ 09809000
*          /* IF THE END OF THE COMMAND HAS NOT YET BEEN FOUND, GET  */ 09810000
*          /* THE NEXT INPUT CHARACTER.                              */ 09811000
*          /*                                                        */ 09812000
*          /**********************************************************/ 09813000
*          IF SKIPDONE=NO                                          1901 09814000
*            THEN                                                  1901 09815000
*                                                                  1901 09816000
@RF01899 DS    0H                                                  1901 09817000
@RC01894 DS    0H                                                  1901 09818000
@RC01885 TM    SKIPDONE,B'10000000'                                1901 09819000
         BNZ   @RF01901                                            1901 09820000
*              CALL NEXTCHAR;                                      1902 09821000
*                                                                  1902 09822000
         BAL   @14,NEXTCHAR                                        1902 09823000
*        END;                                                      1903 09824000
*                                                                  1903 09825000
@RF01901 DS    0H                                                  1903 09826000
@DE01884 TM    SKIPDONE,B'10000000'                                1903 09827000
         BNZ   @DC01884                                            1903 09828000
         LH    @15,RISTATUS                                        1903 09829000
         CH    @15,@CH00118                                        1903 09830000
         BE    @DC01884                                            1903 09831000
         CH    @15,@CH00042                                        1903 09832000
         BNE   @DL01884                                            1903 09833000
@DC01884 DS    0H                                                  1904 09834000
*        END SKIPCMD;                                              1904 09835000
@EL00025 DS    0H                                                  1904 09836000
@EF00025 DS    0H                                                  1904 09837000
@ER00025 LM    @14,@12,@SA00025                                    1904 09838000
         BR    @14                                                 1904 09839000
*/********************************************************************/ 09840000
*/*                                                                  */ 09841000
*/*  PROCEDURE NAME - SETFLAG                                        */ 09842000
*/*                                                                  */ 09843000
*/*  FUNCTION - THIS PROCEDURE SETS A FLAG IN AN ARRAY OF FLAGS TO   */ 09844000
*/*             TO NOTE THAT A GIVEN PARAMETER HAS BEEN INPUT.  THE  */ 09845000
*/*             NTH FLAG IS SET 'ON' WHEN THE PARAMETER WHOSE ID#=N  */ 09846000
*/*             HAS BEEN FOUND AS INPUT (EITHER EXTRACTED FROM THE   */ 09847000
*/*             INPUT RECORD OR INPUT BY DEFAULT).  ALSO, THE FDT    */ 09848000
*/*             VECTOR POINTER FOR THE PARAMETER IS SET TO A NON-NULL*/ 09849000
*/*             VALUE TO SIGNAL THE FSR THAT THE PARAMETER IS INPUT. */ 09850000
*/*                                                                  */ 09851000
*/*  INPUT -                                                         */ 09852000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */ 09853000
*/*          PARMID -  ID# OF THE PARAMETER BEING ACKNOWLEDGED       */ 09854000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */ 09855000
*/*                                                                  */ 09856000
*/*  OUTPUT -                                                        */ 09857000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.                  */ 09858000
*/*          FUNCTION DATA TABLE POINTER VECTOR ENTRY                */ 09859000
*/*          ARRYPTR - POINTER TO FDT PTR VECTOR FOR THIS PARAMETER  */ 09860000
*/*                                                                  */ 09861000
*/********************************************************************/ 09862000
*SETFLAG:PROCEDURE;                                                1905 09863000
SETFLAG  STM   @14,@12,@SA00026                                    1905 09864000
*        /************************************************************/ 09865000
*        /*                                                          */ 09866000
*        /*  ** SETFLAG **  SET PARAMETER OCCURRENCE FLAG            */ 09867000
*        /*                                                          */ 09868000
*        /************************************************************/ 09869000
*        IF GDTDBG = NULLPTR                                       1906 09870000
*          THEN;                                                   1906 09871000
         L     @01,GDTPTR                                          1906 09872000
         L     @15,GDTDBG(,@01)                                    1906 09873000
         LTR   @15,@15                                             1906 09874000
         BZ    @RT01906                                            1906 09875000
*          ELSE                                                    1908 09876000
*            CALL ICKDB010(GDTTBL,'RISF');                         1908 09877000
*                                                                  1908 09878000
         L     @15,GDTPTR                                          1908 09879000
         ST    @15,@AL00001                                        1908 09880000
         LA    @14,@CC01217                                        1908 09881000
         ST    @14,@AL00001+4                                      1908 09882000
         MVI   @AL00001+4,X'80'                                    1908 09883000
         L     @15,GDTDBG(,@15)                                    1908 09884000
         LA    @01,@AL00001                                        1908 09885000
         BALR  @14,@15                                             1908 09886000
*        /************************************************************/ 09887000
*        /*                                                          */ 09888000
*        /* IF THE FLAG IS ALREADY SET, THE PARAMETER HAS ALREADY    */ 09889000
*        /* BEEN INPUT AND AN ERROR HAS OCCURRED.                    */ 09890000
*        /*                                                          */ 09891000
*        /************************************************************/ 09892000
*        IF PARMFLAG(PARMID)=1                                     1909 09893000
*          THEN                                                    1909 09894000
*                                                                  1909 09895000
@RT01906 LH    @15,PARMID                                          1909 09896000
         MH    @15,@CH00038                                        1909 09897000
         L     @01,WORKPTR                                         1909 09898000
         BCTR  @01,0                                               1909 09899000
         BCTR  @01,0                                               1909 09900000
         SLR   @14,@14                                             1909 09901000
         IC    @14,PARMFLAG-10(@15,@01)                            1909 09902000
         CH    @14,@CH00172                                        1909 09903000
         BNE   @RF01909                                            1909 09904000
*            CALL ERROR2(BADKWD3,LENGTH(ERRFIELD),ADDR(ERRFIELD)); 1910 09905000
*                                                                  1910 09906000
         MVC   @AL00001(8),@AL01910                                1910 09907000
         LA    @15,ERRFIELD                                        1910 09908000
         ST    @15,@AFTEMPS+40                                     1910 09909000
         LA    @15,@AFTEMPS+40                                     1910 09910000
         ST    @15,@AL00001+8                                      1910 09911000
         LA    @01,@AL00001                                        1910 09912000
         BAL   @14,ERROR2                                          1910 09913000
*          ELSE                                                    1911 09914000
*            PARMFLAG(PARMID)=1;                                   1911 09915000
*                                                                  1911 09916000
         B     @RC01909                                            1911 09917000
@RF01909 LH    @15,PARMID                                          1911 09918000
         MH    @15,@CH00038                                        1911 09919000
         LA    @14,1                                               1911 09920000
         L     @01,WORKPTR                                         1911 09921000
         BCTR  @01,0                                               1911 09922000
         BCTR  @01,0                                               1911 09923000
         STC   @14,PARMFLAG-10(@15,@01)                            1911 09924000
*        /************************************************************/ 09925000
*        /*                                                          */ 09926000
*        /* SET THE PARAMETER'S DATA POINTER TO A NON-ZERO VALUE TO  */ 09927000
*        /* SIGNAL THE FSR THAT THE PARAMETER HAS BEEN INPUT.        */ 09928000
*        /* CALCULATE THE POINTER LOCATION FOR PARAMETERS THAT ARE   */ 09929000
*        /* PART OF A REPEATED SUBPARAMETER LIST.                    */ 09930000
*        /*                                                          */ 09931000
*        /************************************************************/ 09932000
*        IF OCCURNUM > 1                                           1912 09933000
*          THEN                                                    1912 09934000
@RC01909 LH    @15,PARMID                                          1912 09935000
         LR    @14,@15                                             1912 09936000
         MH    @14,@CH00038                                        1912 09937000
         L     @01,WORKPTR                                         1912 09938000
         AL    @01,@CF01317                                        1912 09939000
         L     @01,PARMPTR(@14,@01)                                1912 09940000
         CLC   OCCURNUM(3,@01),@CF00172+1                          1912 09941000
         BNH   @RF01912                                            1912 09942000
*            DO;                                                   1913 09943000
*            ARRYPTR=FDTPTR(PARMID);                               1914 09944000
*                                                                  1914 09945000
         SLA   @15,2                                               1914 09946000
         L     @01,FDTADDR                                         1914 09947000
         L     @15,FDTPTR-4(@15,@01)                               1914 09948000
         ST    @15,ARRYPTR                                         1914 09949000
*            CALL DSPLCALC(REPDEPTH);                              1915 09950000
*                                                                  1915 09951000
         LA    @15,REPDEPTH                                        1915 09952000
         ST    @15,@AL00001                                        1915 09953000
         LA    @01,@AL00001                                        1915 09954000
         BAL   @14,DSPLCALC                                        1915 09955000
*            REPPTR=ADDR(REPPTR);                                  1916 09956000
         LH    @15,ARRYDSPL                                        1916 09957000
         AL    @15,ARRYPTR                                         1916 09958000
         ST    @15,REPPTR(,@15)                                    1916 09959000
*            END;                                                  1917 09960000
*          ELSE                                                    1918 09961000
*            IF REPEATED=NO                                        1918 09962000
*              THEN                                                1918 09963000
         B     @RC01912                                            1918 09964000
@RF01912 LH    @15,PARMID                                          1918 09965000
         LR    @14,@15                                             1918 09966000
         MH    @14,@CH00038                                        1918 09967000
         L     @01,WORKPTR                                         1918 09968000
         AL    @01,@CF01317                                        1918 09969000
         L     @01,PARMPTR(@14,@01)                                1918 09970000
         TM    REPEATED(@01),B'00100000'                           1918 09971000
         BNZ   @RF01918                                            1918 09972000
*                FDTPTR(PARMID)=ADDR(FDTPTR(PARMID));              1919 09973000
*                                                                  1919 09974000
         L     @14,FDTADDR                                         1919 09975000
         SLA   @15,2                                               1919 09976000
         LA    @05,FDTPTR-4(@15,@14)                               1919 09977000
         ST    @05,FDTPTR-4(@15,@14)                               1919 09978000
*        END SETFLAG;                                              1920 09979000
@EL00026 DS    0H                                                  1920 09980000
@EF00026 DS    0H                                                  1920 09981000
@ER00026 LM    @14,@12,@SA00026                                    1920 09982000
         BR    @14                                                 1920 09983000
*/********************************************************************/ 09984000
*/*                                                                  */ 09985000
*/*  PROCEDURE NAME - PACKCVB                                        */ 09986000
*/*                                                                  */ 09987000
*/*  FUNCTION - THIS ROUTINE CONVERTS DECIMAL DIGITS IN EBCDIC FORM  */ 09988000
*/*             INTO FULLWORD BINARY FORM, AFTER CHECKING THAT THE   */ 09989000
*/*             DECIMAL NUMBER IS SPECIFIED CORRECTLY.               */ 09990000
*/*                                                                  */ 09991000
*/*  INPUT -                                                         */ 09992000
*/*          SYNUNIT - CONTAINS DECIMAL NUMBER IN EBCDIC FORM        */ 09993000
*/*          UNITINDX- LENGTH OF DECIMAL NUMBER IN EBCDIC FORM       */ 09994000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 09995000
*/*                    CODE WHEN AN ERROR IS FOUND.                  */ 09996000
*/*                                                                  */ 09997000
*/*  OUTPUT -                                                        */ 09998000
*/*          CNVRTWRD- CONVERTED NUMBER IN FULLWORD BINARY FORM      */ 09999000
*/*                                                                  */ 10000000
*/********************************************************************/ 10001000
*PACKCVB:PROCEDURE;                                                1921 10002000
PACKCVB  STM   @14,@12,@SA00027                                    1921 10003000
*        /************************************************************/ 10004000
*        /*                                                          */ 10005000
*        /* PACKCVB PROCEDURE DATA DEFINITIONS                       */ 10006000
*        /*                                                          */ 10007000
*        /************************************************************/ 10008000
*        DCL CVBNUM FIXED(31) REG(8);  /*REGISTER TO CONTAIN CONVERTED  10009000
*                                        FULLWORD NUMBERS            */ 10010000
*        /************************************************************/ 10011000
*        /*                                                          */ 10012000
*        /* ** PACKCVB **  CONVERT DECIMAL NUMBER TO BINARY FULLWORD */ 10013000
*        /*                                                          */ 10014000
*        /************************************************************/ 10015000
*        IF GDTDBG = NULLPTR                                       1923 10016000
*          THEN;                                                   1923 10017000
         L     @01,GDTPTR                                          1923 10018000
         L     @15,GDTDBG(,@01)                                    1923 10019000
         LTR   @15,@15                                             1923 10020000
         BZ    @RT01923                                            1923 10021000
*          ELSE                                                    1925 10022000
*            CALL ICKDB010(GDTTBL,'RIPC');                         1925 10023000
*                                                                  1925 10024000
         L     @15,GDTPTR                                          1925 10025000
         ST    @15,@AL00001                                        1925 10026000
         LA    @14,@CC01222                                        1925 10027000
         ST    @14,@AL00001+4                                      1925 10028000
         MVI   @AL00001+4,X'80'                                    1925 10029000
         L     @15,GDTDBG(,@15)                                    1925 10030000
         LA    @01,@AL00001                                        1925 10031000
         BALR  @14,@15                                             1925 10032000
*        ERRFIELD=SYNUNIT(1:UNITINDX);                             1926 10033000
@RT01923 MVI   ERRFIELD+1,C' '                                     1926 10034000
         MVC   ERRFIELD+2(18),ERRFIELD+1                           1926 10035000
         LH    @15,UNITINDX                                        1926 10036000
         LR    @14,@15                                             1926 10037000
         BCTR  @14,0                                               1926 10038000
         EX    @14,@SM01383                                        1926 10039000
*        /************************************************************/ 10040000
*        /*                                                          */ 10041000
*        /* RIGHT-JUSTIFY THE DECIMAL DIGITS IN 'CNVRTFLD'; THEN     */ 10042000
*        /* CHECK THE DIGITS TO BE SURE THEY REPRESENT AN ACCEPTABLE */ 10043000
*        /* DECIMAL NUMBER.                                          */ 10044000
*        /*                                                          */ 10045000
*        /************************************************************/ 10046000
*        CNVRTFLD=BLANK;                                           1927 10047000
         MVI   CNVRTFLD+1,C' '                                     1927 10048000
         MVC   CNVRTFLD+2(8),CNVRTFLD+1                            1927 10049000
         MVI   CNVRTFLD,C' '                                       1927 10050000
*        IF UNITINDX <= LENGTH(MXDECNUM)                           1928 10051000
*          THEN                                                    1928 10052000
         LA    @14,10                                              1928 10053000
         CR    @15,@14                                             1928 10054000
         BH    @RF01928                                            1928 10055000
*            DO;                                                   1929 10056000
*            CNVRTFLD(LENGTH(MXDECNUM)-UNITINDX+1:LENGTH(MXDECNUM))=    10057000
*                  SYNUNIT(1:UNITINDX);                            1930 10058000
         LA    @05,10                                              1930 10059000
         SLR   @05,@15                                             1930 10060000
         LA    @04,CNVRTFLD(@05)                                   1930 10061000
         SLR   @14,@15                                             1930 10062000
         LA    @15,9                                               1930 10063000
         SLR   @15,@14                                             1930 10064000
         EX    @15,@SM01385                                        1930 10065000
*            IF CNVRTFLD <= MXDECNUM                               1931 10066000
*              THEN                                                1931 10067000
         CLC   CNVRTFLD(10),@CC00674                               1931 10068000
         BH    @RF01931                                            1931 10069000
*                DO INDEX=LENGTH(MXDECNUM)-UNITINDX+1 TO           1932 10070000
*                        LENGTH(MXDECNUM) WHILE(RISTATUS=0);       1932 10071000
         AL    @14,@CF00172                                        1932 10072000
         B     @DE01932                                            1932 10073000
@DL01932 LH    @15,RISTATUS                                        1932 10074000
         LTR   @15,@15                                             1932 10075000
         BNZ   @DC01932                                            1932 10076000
*                  IF CNVRTFLD(INDEX) < '0' |                      1933 10077000
*                     CNVRTFLD(INDEX) > '9'                        1933 10078000
*                    THEN                                          1933 10079000
*                                                                  1933 10080000
         LA    @15,CNVRTFLD-1(@14)                                 1933 10081000
         CLI   0(@15),C'0'                                         1933 10082000
         BL    @RT01933                                            1933 10083000
         LA    @15,CNVRTFLD-1(@14)                                 1933 10084000
         CLI   0(@15),C'9'                                         1933 10085000
         BNH   @RF01933                                            1933 10086000
@RT01933 DS    0H                                                  1934 10087000
*                      CALL ERROR2(BADDIGIT,LENGTH(ERRFIELD),      1934 10088000
*                                  ADDR(ERRFIELD));                1934 10089000
*                                                                  1934 10090000
         MVC   @AL00001(8),@AL01934                                1934 10091000
         LA    @15,ERRFIELD                                        1934 10092000
         ST    @15,@AFTEMPS+44                                     1934 10093000
         LA    @15,@AFTEMPS+44                                     1934 10094000
         ST    @15,@AL00001+8                                      1934 10095000
         LA    @01,@AL00001                                        1934 10096000
         BAL   @14,ERROR2                                          1934 10097000
*                END;                                              1935 10098000
@RF01933 LA    @14,1                                               1935 10099000
         AH    @14,INDEX                                           1935 10100000
@DE01932 STH   @14,INDEX                                           1935 10101000
         CH    @14,@CH00040                                        1935 10102000
         BNH   @DL01932                                            1935 10103000
@DC01932 DS    0H                                                  1936 10104000
*              ELSE                                                1936 10105000
*                                                                  1936 10106000
*                CALL ERROR2(BADNUMSZ,LENGTH(ERRFIELD),ADDR(ERRFIELD)); 10107000
*                                                                  1936 10108000
         B     @RC01931                                            1936 10109000
@RF01931 MVC   @AL00001(8),@AL01936                                1936 10110000
         LA    @15,ERRFIELD                                        1936 10111000
         ST    @15,@AFTEMPS+44                                     1936 10112000
         LA    @15,@AFTEMPS+44                                     1936 10113000
         ST    @15,@AL00001+8                                      1936 10114000
         LA    @01,@AL00001                                        1936 10115000
         BAL   @14,ERROR2                                          1936 10116000
*            END;                                                  1937 10117000
*          ELSE                                                    1938 10118000
*                                                                  1938 10119000
*            CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),ADDR(ERRFIELD));     10120000
*                                                                  1938 10121000
         B     @RC01928                                            1938 10122000
@RF01928 MVC   @AL00001(8),@AL01938                                1938 10123000
         LA    @15,ERRFIELD                                        1938 10124000
         ST    @15,@AFTEMPS+44                                     1938 10125000
         LA    @15,@AFTEMPS+44                                     1938 10126000
         ST    @15,@AL00001+8                                      1938 10127000
         LA    @01,@AL00001                                        1938 10128000
         BAL   @14,ERROR2                                          1938 10129000
*        IF RISTATUS=0                                             1939 10130000
*          THEN                                                    1939 10131000
*                                                                  1939 10132000
@RC01928 LH    @15,RISTATUS                                        1939 10133000
         LTR   @15,@15                                             1939 10134000
         BNZ   @RF01939                                            1939 10135000
*            /********************************************************/ 10136000
*            /*                                                      */ 10137000
*            /* PERFORM THE CONVERSION FROM EBCDIC TO BINARY FULLWORD*/ 10138000
*            /*                                                      */ 10139000
*            /********************************************************/ 10140000
*            DO;                                                   1940 10141000
*            SYNUNIT=CNVRTFLD;                                     1941 10142000
         MVI   SYNUNIT+10,C' '                                     1941 10143000
         MVC   SYNUNIT+11(244),SYNUNIT+10                          1941 10144000
         MVC   SYNUNIT(10),CNVRTFLD                                1941 10145000
*            RESPECIFY(CVBNUM) RSTD;                               1942 10146000
*            GEN(PACK   CNVRTFLD(8),SYNUNIT(10));                  1943 10147000
         PACK   CNVRTFLD(8),SYNUNIT(10)                                 10148000
*            GEN(CVB    CVBNUM,CNVRTFLD);                          1944 10149000
         CVB    CVBNUM,CNVRTFLD                                         10150000
*            CNVRTWRD=CVBNUM;                                      1945 10151000
         ST    CVBNUM,CNVRTWRD                                     1945 10152000
*            RESPECIFY(CVBNUM) UNRSTD;                             1946 10153000
*            END;                                                  1947 10154000
*                                                                  1947 10155000
*        END PACKCVB;                                              1948 10156000
@EL00027 DS    0H                                                  1948 10157000
@EF00027 DS    0H                                                  1948 10158000
@ER00027 LM    @14,@12,@SA00027                                    1948 10159000
         BR    @14                                                 1948 10160000
*/********************************************************************/ 10161000
*/*                                                                  */ 10162000
*/*  PROCEDURE NAME - NXTFIELD                                       */ 10163000
*/*                                                                  */ 10164000
*/*  FUNCTION - THIS ROUTINE EXTRACTS THE NEXT FIELD (VERB, KEYWORD, */ 10165000
*/*             OR SCALAR) FROM THE INPUT COMMAND.  CHECKS ARE MADE  */ 10166000
*/*             TO INSURE THAT LENGTH LIMITS ARE NOT EXCEEDED.       */ 10167000
*/*                                                                  */ 10168000
*/*  INPUT -                                                         */ 10169000
*/*          FLDTYPE - CONTAINS CODE INDICATING THE TYPE OF FIELD    */ 10170000
*/*                    TO BE EXTRACTED                               */ 10171000
*/*          CHAR1 -   MOST RECENTLY EXTRACTED CHARACTER             */ 10172000
*/*          CHAR2 -   NEXT INPUT CHARACTER TO BE EXTRACTED.         */ 10173000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 10174000
*/*                    CODE WHEN AN ERROR IS FOUND.                  */ 10175000
*/*                                                                  */ 10176000
*/*  OUTPUT -                                                        */ 10177000
*/*          SYNUNIT - THE EXTRACTED SYNTACTIC UNIT (FIELD)          */ 10178000
*/*          UNITINDX- LENGTH OF THE EXTRACTED FIELD                 */ 10179000
*/*          EOFOK -   FLAG SET 'ON' WHEN INPUT END-OF-FILE MAY      */ 10180000
*/*                    LEGITIMATELY BE ENCOUNTERED.                  */ 10181000
*/*          ERRFIELD- FIRST 20 CHARACTERS OF EXTRACTED FIELD WHICH  */ 10182000
*/*                    MAY BE USED IN AN ERROR MESSAGE LATER         */ 10183000
*/*                                                                  */ 10184000
*/********************************************************************/ 10185000
*NXTFIELD:PROCEDURE(FLDTYPE);          /*PARAMETER INDICATES THE TYPE   10186000
*                                        OF FIELD TO BE EXTRACTED.   */ 10187000
NXTFIELD STM   @14,@12,@SA00028                                    1949 10188000
         MVC   @PC00028(4),0(@01)                                  1949 10189000
*        /************************************************************/ 10190000
*        /*                                                          */ 10191000
*        /* NXTFIELD PROCEDURE DATA DEFINITIONS                      */ 10192000
*        /*                                                          */ 10193000
*        /************************************************************/ 10194000
*        DCL FLDTYPE  FIXED(31);       /*TYPE OF DATA FIELD EXPECTED    10195000
*                                        TO BE EXTRACTED NEXT        */ 10196000
*        DCL PARENCNT FIXED(15);       /*NO. OF UNMATCHED            */ 10197000
*                                      /* LEFT PARENTHESES           */ 10198000
*                                      /* FOUND IN DSNAME            */ 10199000
*                                      /* NOW BEING SCANNED          */ 10200000
*                                                                  1952 10201000
*        /* STATIC ERROR MESSAGE CODE                                */ 10202000
*        DCL QUOTSEMI FIXED(31)        /*SEMICOLON APPEARS WITHIN A  */ 10203000
*                     CONSTANT(23);    /* QUOTED STRING              */ 10204000
*        /************************************************************/ 10205000
*        /*                                                          */ 10206000
*        /*  ** NXTFIELD **  EXTRACT NEXT FIELD FROM INPUT RECORD    */ 10207000
*        /*                                                          */ 10208000
*        /************************************************************/ 10209000
*                                                                  1953 10210000
*        DELIM=NO;                                                 1953 10211000
         NI    DELIM,B'11110111'                                   1953 10212000
*        UNITINDX=0;                                               1954 10213000
         SLR   @15,@15                                             1954 10214000
         STH   @15,UNITINDX                                        1954 10215000
*        SYNUNIT=BLANK;                                            1955 10216000
         MVI   SYNUNIT+1,C' '                                      1955 10217000
         MVC   SYNUNIT+2(253),SYNUNIT+1                            1955 10218000
         MVI   SYNUNIT,C' '                                        1955 10219000
*        IF RISTATUS=0                                             1956 10220000
*          THEN                                                    1956 10221000
         CH    @15,RISTATUS                                        1956 10222000
         BNE   @RF01956                                            1956 10223000
*            EOFOK=NO;                                             1957 10224000
*                                                                  1957 10225000
         NI    EOFOK,B'10111111'                                   1957 10226000
*        /************************************************************/ 10227000
*        /*                                                          */ 10228000
*        /* IF A SIMPLE SCALAR FIELD IS TO BE EXTRACTED, THEN EXTRACT*/ 10229000
*        /* CHARACTERS UNTIL THE FIELD IS DELIMITED BY END-OF-FILE   */ 10230000
*        /* OR BY A DELIMITING CHARACTER                             */ 10231000
*        /*                                                          */ 10232000
*        /************************************************************/ 10233000
*        IF FLDTYPE=SIMPSCLR                                       1958 10234000
*          THEN                                                    1958 10235000
@RF01956 L     @15,@PC00028                                        1958 10236000
         CLC   FLDTYPE(4,@15),@CF00144                             1958 10237000
         BNE   @RF01958                                            1958 10238000
*            DO;                                                   1959 10239000
*            OLDERID2 = NEWERID2;                                  1960 10240000
         L     @01,GDTPTR                                          1960 10241000
         L     @15,GDTTR2(,@01)                                    1960 10242000
         MVC   @TS00001(95),NEWERID2(@15)                          1960 10243000
         MVC   OLDERID2(95,@15),@TS00001                           1960 10244000
*            NEWID2='RI49';                                        1961 10245000
         MVC   NEWID2(4,@15),@CC01230                              1961 10246000
*            PARENCNT=0;                                           1962 10247000
         SLR   @15,@15                                             1962 10248000
         STH   @15,PARENCNT                                        1962 10249000
*            DO WHILE(DELIM=NO & RISTATUS=0);                      1963 10250000
         B     @DE01963                                            1963 10251000
@DL01963 DS    0H                                                  1964 10252000
*              IF CHAR1=BLANK |                                    1964 10253000
*                 CHAR1=COMMA |                                    1964 10254000
*                 CHAR1=OPENING & DSNAM=NO |                       1964 10255000
*                 CHAR1=CLOSING & PARENCNT=0 |                     1964 10256000
*                 CHAR1=ENDDELIM |                                 1964 10257000
*                 CHAR1=PWDDELIM |                                 1964 10258000
*                 CHAR1=COMSTART(1) & CHAR2=COMSTART(2)            1964 10259000
*                THEN                                              1964 10260000
         CLI   CHAR1,C' '                                          1964 10261000
         BE    @RT01964                                            1964 10262000
         CLI   CHAR1,C','                                          1964 10263000
         BE    @RT01964                                            1964 10264000
         CLI   CHAR1,C'('                                          1964 10265000
         BNE   @GL00117                                            1964 10266000
         LA    @15,12                                              1964 10267000
         LR    @14,@15                                             1964 10268000
         MH    @14,PARMID                                          1964 10269000
         L     @01,WORKPTR                                         1964 10270000
         AL    @01,@CF01317                                        1964 10271000
         AL    @15,PARMPTR(@14,@01)                                1964 10272000
         TM    DSNAM(@15),B'00100000'                              1964 10273000
         BZ    @RT01964                                            1964 10274000
@GL00117 CLI   CHAR1,C')'                                          1964 10275000
         BNE   @GL00116                                            1964 10276000
         LH    @15,PARENCNT                                        1964 10277000
         LTR   @15,@15                                             1964 10278000
         BZ    @RT01964                                            1964 10279000
@GL00116 CLI   CHAR1,C';'                                          1964 10280000
         BE    @RT01964                                            1964 10281000
         CLI   CHAR1,C'/'                                          1964 10282000
         BE    @RT01964                                            1964 10283000
         CLC   CHAR1(1),COMSTART                                   1964 10284000
         BNE   @RF01964                                            1964 10285000
         CLC   CHAR2(1),COMSTART+1                                 1964 10286000
         BNE   @RF01964                                            1964 10287000
@RT01964 DS    0H                                                  1965 10288000
*                  DELIM=YES;                                      1965 10289000
         OI    DELIM,B'00001000'                                   1965 10290000
*                ELSE                                              1966 10291000
*                  DO;                                             1966 10292000
         B     @RC01964                                            1966 10293000
@RF01964 DS    0H                                                  1967 10294000
*                    UNITINDX=UNITINDX+1;                          1967 10295000
         LA    @15,1                                               1967 10296000
         AH    @15,UNITINDX                                        1967 10297000
         STH   @15,UNITINDX                                        1967 10298000
*                    IF UNITINDX > UNITMAX                         1968 10299000
*                      THEN                                        1968 10300000
*                                                                  1968 10301000
         CH    @15,@CH00681                                        1968 10302000
         BNH   @RF01968                                            1968 10303000
*                        CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),    1969 10304000
*                                    ADDR(SYNUNIT));               1969 10305000
*                                                                  1969 10306000
         MVC   @AL00001(8),@AL01969                                1969 10307000
         LA    @15,SYNUNIT                                         1969 10308000
         ST    @15,@AFTEMPS+48                                     1969 10309000
         LA    @15,@AFTEMPS+48                                     1969 10310000
         ST    @15,@AL00001+8                                      1969 10311000
         LA    @01,@AL00001                                        1969 10312000
         BAL   @14,ERROR2                                          1969 10313000
*                      ELSE                                        1970 10314000
*                                                                  1970 10315000
*                        /********************************************/ 10316000
*                        /*                                          */ 10317000
*                        /* SAVE THE CHARACTER AND NOTE IF           */ 10318000
*                        /* IT IS A MEMBER NAME DELIMITER            */ 10319000
*                        /* (A PARENTHESIS)                          */ 10320000
*                        /*                                          */ 10321000
*                        /********************************************/ 10322000
*                        DO;                                       1970 10323000
         B     @RC01968                                            1970 10324000
@RF01968 DS    0H                                                  1971 10325000
*                        SYNUNIT(UNITINDX)=CHAR1;                  1971 10326000
         LH    @01,UNITINDX                                        1971 10327000
         LA    @15,SYNUNIT-1(@01)                                  1971 10328000
         MVC   0(1,@15),CHAR1                                      1971 10329000
*                        IF CHAR1=OPENING                          1972 10330000
*                          THEN                                    1972 10331000
         CLI   CHAR1,C'('                                          1972 10332000
         BNE   @RF01972                                            1972 10333000
*                            PARENCNT=PARENCNT+1;                  1973 10334000
         LH    @01,PARENCNT                                        1973 10335000
         LA    @01,1(,@01)                                         1973 10336000
         STH   @01,PARENCNT                                        1973 10337000
*                          ELSE                                    1974 10338000
*                            IF CHAR1=CLOSING                      1974 10339000
*                              THEN                                1974 10340000
         B     @RC01972                                            1974 10341000
@RF01972 CLI   CHAR1,C')'                                          1974 10342000
         BNE   @RF01974                                            1974 10343000
*                                PARENCNT=PARENCNT-1;              1975 10344000
*                                                                  1975 10345000
         LH    @15,PARENCNT                                        1975 10346000
         BCTR  @15,0                                               1975 10347000
         STH   @15,PARENCNT                                        1975 10348000
*                        CALL NEXTCHAR;                            1976 10349000
*                                                                  1976 10350000
@RF01974 DS    0H                                                  1976 10351000
@RC01972 BAL   @14,NEXTCHAR                                        1976 10352000
*                        END;                                      1977 10353000
*                  END;                                            1978 10354000
@RC01968 DS    0H                                                  1979 10355000
*            END;                                                  1979 10356000
@RC01964 DS    0H                                                  1979 10357000
@DE01963 TM    DELIM,B'00001000'                                   1979 10358000
         BNZ   @DC01963                                            1979 10359000
         LH    @15,RISTATUS                                        1979 10360000
         LTR   @15,@15                                             1979 10361000
         BZ    @DL01963                                            1979 10362000
@DC01963 DS    0H                                                  1980 10363000
*            END;                                                  1980 10364000
*                                                                  1980 10365000
*          /**********************************************************/ 10366000
*          /*                                                        */ 10367000
*          /* IF A KEYWORD FIELD IS TO BE EXTRACTED, THEN PICK UP    */ 10368000
*          /* CHARACTERS UNTIL THE FIELD IS DELIMITED BY END-OF-FILE */ 10369000
*          /* OR BY A DELIMITING CHARACTER.  CHECK THAT THE MAXIMUM  */ 10370000
*          /* KEYWORD LENGTH IS NOT EXCEEDED.                        */ 10371000
*          /*                                                        */ 10372000
*          /**********************************************************/ 10373000
*          ELSE                                                    1981 10374000
*            IF FLDTYPE=KEYWORD                                    1981 10375000
*              THEN                                                1981 10376000
         B     @RC01958                                            1981 10377000
@RF01958 L     @15,@PC00028                                        1981 10378000
         CLC   FLDTYPE(4,@15),@CF00124                             1981 10379000
         BNE   @RF01981                                            1981 10380000
*                DO;                                               1982 10381000
*                OLDERID2 = NEWERID2;                              1983 10382000
         L     @01,GDTPTR                                          1983 10383000
         L     @15,GDTTR2(,@01)                                    1983 10384000
         MVC   @TS00001(95),NEWERID2(@15)                          1983 10385000
         MVC   OLDERID2(95,@15),@TS00001                           1983 10386000
*                NEWID2='RI50';                                    1984 10387000
         MVC   NEWID2(4,@15),@CC01231                              1984 10388000
*                DO WHILE(DELIM=NO & RISTATUS=0);                  1985 10389000
         B     @DE01985                                            1985 10390000
@DL01985 DS    0H                                                  1986 10391000
*                  IF CHAR1=BLANK | CHAR1=COMMA |                  1986 10392000
*                     CHAR1=OPENING | CHAR1=CLOSING |              1986 10393000
*                     CHAR1=COMSTART(1) & CHAR2=COMSTART(2) |      1986 10394000
*                     CHAR1=ENDDELIM                               1986 10395000
*                    THEN                                          1986 10396000
         CLI   CHAR1,C' '                                          1986 10397000
         BE    @RT01986                                            1986 10398000
         CLI   CHAR1,C','                                          1986 10399000
         BE    @RT01986                                            1986 10400000
         CLI   CHAR1,C'('                                          1986 10401000
         BE    @RT01986                                            1986 10402000
         CLI   CHAR1,C')'                                          1986 10403000
         BE    @RT01986                                            1986 10404000
         CLC   CHAR1(1),COMSTART                                   1986 10405000
         BNE   @GL00124                                            1986 10406000
         CLC   CHAR2(1),COMSTART+1                                 1986 10407000
         BE    @RT01986                                            1986 10408000
@GL00124 CLI   CHAR1,C';'                                          1986 10409000
         BNE   @RF01986                                            1986 10410000
@RT01986 DS    0H                                                  1987 10411000
*                      DELIM=YES;                                  1987 10412000
         OI    DELIM,B'00001000'                                   1987 10413000
*                    ELSE                                          1988 10414000
*                      DO;                                         1988 10415000
         B     @RC01986                                            1988 10416000
@RF01986 DS    0H                                                  1989 10417000
*                        UNITINDX=UNITINDX+1;                      1989 10418000
         LA    @15,1                                               1989 10419000
         AH    @15,UNITINDX                                        1989 10420000
         STH   @15,UNITINDX                                        1989 10421000
*                        IF UNITINDX > KWDMAX                      1990 10422000
*                          THEN                                    1990 10423000
*                                                                  1990 10424000
         CH    @15,@CH00282                                        1990 10425000
         BNH   @RF01990                                            1990 10426000
*                            CALL ERROR2(BADKWD2,LENGTH(ERRFIELD), 1991 10427000
*                                        ADDR(SYNUNIT));           1991 10428000
*                                                                  1991 10429000
         MVC   @AL00001(8),@AL01991                                1991 10430000
         LA    @15,SYNUNIT                                         1991 10431000
         ST    @15,@AFTEMPS+48                                     1991 10432000
         LA    @15,@AFTEMPS+48                                     1991 10433000
         ST    @15,@AL00001+8                                      1991 10434000
         LA    @01,@AL00001                                        1991 10435000
         BAL   @14,ERROR2                                          1991 10436000
*                          ELSE                                    1992 10437000
*                            DO;                                   1992 10438000
         B     @RC01990                                            1992 10439000
@RF01990 DS    0H                                                  1993 10440000
*                            SYNUNIT(UNITINDX)=CHAR1;              1993 10441000
*                                                                  1993 10442000
         LH    @01,UNITINDX                                        1993 10443000
         LA    @15,SYNUNIT-1(@01)                                  1993 10444000
         MVC   0(1,@15),CHAR1                                      1993 10445000
*                            CALL NEXTCHAR;                        1994 10446000
*                                                                  1994 10447000
         BAL   @14,NEXTCHAR                                        1994 10448000
*                            END;                                  1995 10449000
*                      END;                                        1996 10450000
@RC01990 DS    0H                                                  1997 10451000
*                END;                                              1997 10452000
@RC01986 DS    0H                                                  1997 10453000
@DE01985 TM    DELIM,B'00001000'                                   1997 10454000
         BNZ   @DC01985                                            1997 10455000
         LH    @15,RISTATUS                                        1997 10456000
         LTR   @15,@15                                             1997 10457000
         BZ    @DL01985                                            1997 10458000
@DC01985 DS    0H                                                  1998 10459000
*                END;                                              1998 10460000
*                                                                  1998 10461000
*              /******************************************************/ 10462000
*              /*                                                    */ 10463000
*              /* IF A SCALAR FIELD DELIMITED BY APOSTROPHES IS TO BE*/ 10464000
*              /* EXTRACTED, THEN PICK UP CHARACTERS UNTIL THE FIELD */ 10465000
*              /* IS DELIMITED BY END-OF-FILE OR BY A DELIMITING     */ 10466000
*              /* INPUT CHARACTER.                                   */ 10467000
*              /*                                                    */ 10468000
*              /******************************************************/ 10469000
*              ELSE                                                1999 10470000
*                IF FLDTYPE=QUOTSCLR                               1999 10471000
*                  THEN                                            1999 10472000
         B     @RC01981                                            1999 10473000
@RF01981 L     @15,@PC00028                                        1999 10474000
         CLC   FLDTYPE(4,@15),@CF00052                             1999 10475000
         BNE   @RF01999                                            1999 10476000
*DOGRP182:           DO;                                           2000 10477000
DOGRP182 DS    0H                                                  2001 10478000
*                    OLDERID2 = NEWERID2;                          2001 10479000
         L     @01,GDTPTR                                          2001 10480000
         L     @15,GDTTR2(,@01)                                    2001 10481000
         MVC   @TS00001(95),NEWERID2(@15)                          2001 10482000
         MVC   OLDERID2(95,@15),@TS00001                           2001 10483000
*                    NEWID2='RI51';                                2002 10484000
         MVC   NEWID2(4,@15),@CC01234                              2002 10485000
*                    DO WHILE(DELIM=NO & RISTATUS=0);              2003 10486000
*                                                                  2003 10487000
         B     @DE02003                                            2003 10488000
@DL02003 DS    0H                                                  2004 10489000
*                      IF CHAR1=QUOTE & CHAR2^=QUOTE               2004 10490000
*                        THEN                                      2004 10491000
         CLI   CHAR1,C''''                                         2004 10492000
         BNE   @RF02004                                            2004 10493000
         CLI   CHAR2,C''''                                         2004 10494000
         BE    @RF02004                                            2004 10495000
*                          DELIM=YES;                              2005 10496000
         OI    DELIM,B'00001000'                                   2005 10497000
*                        ELSE                                      2006 10498000
*                                                                  2006 10499000
*                          /******************************************/ 10500000
*                          /*                                        */ 10501000
*                          /* ACCEPT THE CHARACTER AS PART OF THE    */ 10502000
*                          /* SCALAR.  ISSUE AN ERROR MESSAGE IF THE */ 10503000
*                          /* SCALAR HAS EXCEEDED THE LENGTH LIMIT.  */ 10504000
*                          /* ISSUE A WARNING MESSAGE IF THE CHAR.   */ 10505000
*                          /* IS A SEMICOLON.                        */ 10506000
*                          /*                                        */ 10507000
*                          /******************************************/ 10508000
*                          DO;                                     2006 10509000
         B     @RC02004                                            2006 10510000
@RF02004 DS    0H                                                  2007 10511000
*                            IF CHAR1=ENDDELIM                     2007 10512000
*                              THEN                                2007 10513000
         CLI   CHAR1,C';'                                          2007 10514000
         BNE   @RF02007                                            2007 10515000
*                                DO;                               2008 10516000
*                                DARGSMOD=RISTID;                  2009 10517000
         L     @15,DDSTRU                                          2009 10518000
         MVC   DARGSMOD(3,@15),RISTID                              2009 10519000
*                                DARGSENT=QUOTSEMI;                2010 10520000
*                                                                  2010 10521000
         MVI   DARGSENT(@15),X'17'                                 2010 10522000
*                                CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);  10523000
*                                                                  2011 10524000
         L     @15,GDTPTR                                          2011 10525000
         ST    @15,@AL00001                                        2011 10526000
         LA    @14,@CF00102                                        2011 10527000
         ST    @14,@AL00001+4                                      2011 10528000
         LA    @14,DDSTRU                                          2011 10529000
         ST    @14,@AL00001+8                                      2011 10530000
         MVI   @AL00001+8,X'80'                                    2011 10531000
         L     @15,GDTPRT(,@15)                                    2011 10532000
         LA    @01,@AL00001                                        2011 10533000
         BALR  @14,@15                                             2011 10534000
*                                END;                              2012 10535000
*                            UNITINDX=UNITINDX+1;                  2013 10536000
@RF02007 LA    @15,1                                               2013 10537000
         AH    @15,UNITINDX                                        2013 10538000
         STH   @15,UNITINDX                                        2013 10539000
*                            IF UNITINDX > UNITMAX                 2014 10540000
*                              THEN                                2014 10541000
*                                                                  2014 10542000
         CH    @15,@CH00681                                        2014 10543000
         BNH   @RF02014                                            2014 10544000
*                                CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD), 10545000
*                                            ADDR(SYNUNIT));       2015 10546000
*                                                                  2015 10547000
         MVC   @AL00001(8),@AL02015                                2015 10548000
         LA    @15,SYNUNIT                                         2015 10549000
         ST    @15,@AFTEMPS+48                                     2015 10550000
         LA    @15,@AFTEMPS+48                                     2015 10551000
         ST    @15,@AL00001+8                                      2015 10552000
         LA    @01,@AL00001                                        2015 10553000
         BAL   @14,ERROR2                                          2015 10554000
*                              ELSE                                2016 10555000
*                                SYNUNIT(UNITINDX)=CHAR1;          2016 10556000
         B     @RC02014                                            2016 10557000
@RF02014 LH    @01,UNITINDX                                        2016 10558000
         LA    @15,SYNUNIT-1(@01)                                  2016 10559000
         MVC   0(1,@15),CHAR1                                      2016 10560000
*                          END;                                    2017 10561000
*                                                                  2017 10562000
@RC02014 DS    0H                                                  2018 10563000
*                      /**********************************************/ 10564000
*                      /*                                            */ 10565000
*                      /* IF A DOUBLE APOSTROPHE IS FOUND, SKIP PAST */ 10566000
*                      /* BOTH OF THEM AND THEN CONTINUE SCANNING.   */ 10567000
*                      /*                                            */ 10568000
*                      /**********************************************/ 10569000
*                      IF CHAR1=QUOTE & CHAR2=QUOTE                2018 10570000
*                        THEN                                      2018 10571000
*                                                                  2018 10572000
@RC02004 CLI   CHAR1,C''''                                         2018 10573000
         BNE   @RF02018                                            2018 10574000
         CLI   CHAR2,C''''                                         2018 10575000
         BNE   @RF02018                                            2018 10576000
*                          CALL NEXTCHAR;                          2019 10577000
*                                                                  2019 10578000
         BAL   @14,NEXTCHAR                                        2019 10579000
*                      /**********************************************/ 10580000
*                      /*                                            */ 10581000
*                      /* BYPASS THE CHARACTER JUST EXTRACTED, UNLESS*/ 10582000
*                      /* AN ERROR CONDITION HAS BEEN ENCOUNTERED OR */ 10583000
*                      /* THE END OF THE CURRENT COMMAND HAS JUST    */ 10584000
*                      /* BEEN REACHED.                              */ 10585000
*                      /*                                            */ 10586000
*                      /**********************************************/ 10587000
*                      IF RISTATUS=0                               2020 10588000
*                        THEN                                      2020 10589000
@RF02018 LH    @15,RISTATUS                                        2020 10590000
         LTR   @15,@15                                             2020 10591000
         BNZ   @RF02020                                            2020 10592000
*                          IF CHAR1=ENDDELIM &                     2021 10593000
*                             (OPTSFLAG=ON | MORTOCOM=NO) &        2021 10594000
*                             SCANINDX >= SCNLIMIT                 2021 10595000
*                            THEN                                  2021 10596000
         CLI   CHAR1,C';'                                          2021 10597000
         BNE   @RF02021                                            2021 10598000
         TM    OPTSFLAG,B'00100000'                                2021 10599000
         BO    @GL00133                                            2021 10600000
         TM    MORTOCOM,B'00010000'                                2021 10601000
         BNZ   @RF02021                                            2021 10602000
@GL00133 LH    @15,SCANINDX                                        2021 10603000
         CH    @15,SCNLIMIT                                        2021 10604000
         BL    @RF02021                                            2021 10605000
*                              DELIM=YES;                          2022 10606000
         OI    DELIM,B'00001000'                                   2022 10607000
*                            ELSE                                  2023 10608000
*                                                                  2023 10609000
*                              CALL NEXTCHAR;                      2023 10610000
*                                                                  2023 10611000
         B     @RC02021                                            2023 10612000
@RF02021 BAL   @14,NEXTCHAR                                        2023 10613000
*                    END;                                          2024 10614000
@RC02021 DS    0H                                                  2024 10615000
@RF02020 DS    0H                                                  2024 10616000
@DE02003 TM    DELIM,B'00001000'                                   2024 10617000
         BNZ   @DC02003                                            2024 10618000
         LH    @15,RISTATUS                                        2024 10619000
         LTR   @15,@15                                             2024 10620000
         BZ    @DL02003                                            2024 10621000
@DC02003 DS    0H                                                  2025 10622000
*                    END DOGRP182;                                 2025 10623000
*                                                                  2025 10624000
*                  /**************************************************/ 10625000
*                  /*                                                */ 10626000
*                  /* WHEN A VERB FIELD IS TO BE EXTRACTED, PICK     */ 10627000
*                  /* UP CHARACTERS UNTIL THE FIELD IS DELIMITED BY  */ 10628000
*                  /* END-OF-FILE OR BY A DELIMITING CHARACTER.      */ 10629000
*                  /* CHECK THAT THE MAXIMUM VERB LENGTH HAS NOT     */ 10630000
*                  /* BEEN EXCEEDED.                                 */ 10631000
*                  /*                                                */ 10632000
*                  /**************************************************/ 10633000
*                  ELSE                                            2026 10634000
*                    DO WHILE(DELIM=NO & RISTATUS=0);              2026 10635000
         B     @RC01999                                            2026 10636000
@RF01999 B     @DE02026                                            2026 10637000
@DL02026 DS    0H                                                  2027 10638000
*                      IF CHAR1=BLANK | CHAR1=COMMA |              2027 10639000
*                         CHAR1=COMSTART(1) & CHAR2=COMSTART(2) |  2027 10640000
*                         CHAR1=ENDDELIM                           2027 10641000
*                        THEN                                      2027 10642000
         CLI   CHAR1,C' '                                          2027 10643000
         BE    @RT02027                                            2027 10644000
         CLI   CHAR1,C','                                          2027 10645000
         BE    @RT02027                                            2027 10646000
         CLC   CHAR1(1),COMSTART                                   2027 10647000
         BNE   @GL00137                                            2027 10648000
         CLC   CHAR2(1),COMSTART+1                                 2027 10649000
         BE    @RT02027                                            2027 10650000
@GL00137 CLI   CHAR1,C';'                                          2027 10651000
         BNE   @RF02027                                            2027 10652000
@RT02027 DS    0H                                                  2028 10653000
*                          DELIM=YES;                              2028 10654000
         OI    DELIM,B'00001000'                                   2028 10655000
*                        ELSE                                      2029 10656000
*                          DO;                                     2029 10657000
         B     @RC02027                                            2029 10658000
@RF02027 DS    0H                                                  2030 10659000
*                            UNITINDX=UNITINDX+1;                  2030 10660000
         LA    @15,1                                               2030 10661000
         AH    @15,UNITINDX                                        2030 10662000
         STH   @15,UNITINDX                                        2030 10663000
*                            IF UNITINDX > UNITMAX                 2031 10664000
*                              THEN                                2031 10665000
*                                                                  2031 10666000
         CH    @15,@CH00681                                        2031 10667000
         BNH   @RF02031                                            2031 10668000
*                                CALL ERROR2(BADVERB2,LENGTH(ERRFIELD), 10669000
*                                            ADDR(SYNUNIT));       2032 10670000
*                                                                  2032 10671000
         MVC   @AL00001(8),@AL02032                                2032 10672000
         LA    @15,SYNUNIT                                         2032 10673000
         ST    @15,@AFTEMPS+48                                     2032 10674000
         LA    @15,@AFTEMPS+48                                     2032 10675000
         ST    @15,@AL00001+8                                      2032 10676000
         LA    @01,@AL00001                                        2032 10677000
         BAL   @14,ERROR2                                          2032 10678000
*                              ELSE                                2033 10679000
*                                DO;                               2033 10680000
         B     @RC02031                                            2033 10681000
@RF02031 DS    0H                                                  2034 10682000
*                                SYNUNIT(UNITINDX)=CHAR1;          2034 10683000
*                                                                  2034 10684000
         LH    @01,UNITINDX                                        2034 10685000
         LA    @15,SYNUNIT-1(@01)                                  2034 10686000
         MVC   0(1,@15),CHAR1                                      2034 10687000
*                                CALL NEXTCHAR;                    2035 10688000
*                                                                  2035 10689000
         BAL   @14,NEXTCHAR                                        2035 10690000
*                                END;                              2036 10691000
*                          END;                                    2037 10692000
@RC02031 DS    0H                                                  2038 10693000
*                    END;                                          2038 10694000
*                                                                  2038 10695000
@RC02027 DS    0H                                                  2038 10696000
@DE02026 TM    DELIM,B'00001000'                                   2038 10697000
         BNZ   @DC02026                                            2038 10698000
         LH    @15,RISTATUS                                        2038 10699000
         LTR   @15,@15                                             2038 10700000
         BZ    @DL02026                                            2038 10701000
@DC02026 DS    0H                                                  2039 10702000
*        /************************************************************/ 10703000
*        /*                                                          */ 10704000
*        /* AN ERROR HAS OCCURRED WHEN NO CHARACTERS OF THE          */ 10705000
*        /* SYNTACTICAL UNIT WERE FOUND BEFORE HITTING A DELIMITER   */ 10706000
*        /*                                                          */ 10707000
*        /************************************************************/ 10708000
*        IF UNITINDX=0 & RISTATUS=0                                2039 10709000
*          THEN                                                    2039 10710000
@RC01999 DS    0H                                                  2039 10711000
@RC01981 DS    0H                                                  2039 10712000
@RC01958 SLR   @15,@15                                             2039 10713000
         CH    @15,UNITINDX                                        2039 10714000
         BNE   @RF02039                                            2039 10715000
         CH    @15,RISTATUS                                        2039 10716000
         BNE   @RF02039                                            2039 10717000
*            IF FLDTYPE^=VERBFLD                                   2040 10718000
*              THEN                                                2040 10719000
*                                                                  2040 10720000
         L     @15,@PC00028                                        2040 10721000
         CLC   FLDTYPE(4,@15),@CF00172                             2040 10722000
         BE    @RF02040                                            2040 10723000
*                CALL ERROR2(BADELIM1,LENGTH(CHAR1),ADDR(CHAR1));  2041 10724000
*                                                                  2041 10725000
         MVC   @AL00001(8),@AL02041                                2041 10726000
         LA    @15,CHAR1                                           2041 10727000
         ST    @15,@AFTEMPS+48                                     2041 10728000
         LA    @15,@AFTEMPS+48                                     2041 10729000
         ST    @15,@AL00001+8                                      2041 10730000
         LA    @01,@AL00001                                        2041 10731000
         BAL   @14,ERROR2                                          2041 10732000
*              ELSE;                                               2042 10733000
*                                                                  2042 10734000
@RF02040 DS    0H                                                  2043 10735000
*          /**********************************************************/ 10736000
*          /*                                                        */ 10737000
*          /* IF CHARACTERS WERE EXTRACTED FOR THIS UNIT, SAVE UP TO */ 10738000
*          /* THE FIRST 20 OF THEM FOR POSSIBLE LATER USE IN AN      */ 10739000
*          /* ERROR MESSAGE.                                         */ 10740000
*          /*                                                        */ 10741000
*          /**********************************************************/ 10742000
*          ELSE                                                    2043 10743000
*            ERRFIELD=SYNUNIT;                                     2043 10744000
*                                                                  2043 10745000
*                                                                  2043 10746000
         B     @RC02039                                            2043 10747000
@RF02039 MVC   ERRFIELD(20),SYNUNIT                                2043 10748000
*        END NXTFIELD;                                             2044 10749000
@EL00028 DS    0H                                                  2044 10750000
@EF00028 DS    0H                                                  2044 10751000
@ER00028 LM    @14,@12,@SA00028                                    2044 10752000
         BR    @14                                                 2044 10753000
*/********************************************************************/ 10754000
*/*                                                                  */ 10755000
*/*  PROCEDURE NAME - SCANSEP                                        */ 10756000
*/*                                                                  */ 10757000
*/*  FUNCTION - THIS ROUTINE SCANS PAST THE COMMA(S) AND/OR BLANK(S) */ 10758000
*/*             AND/OR COMMENT(S) WHICH OPTIONALLY SEPARATE COMMAND  */ 10759000
*/*             SYNTACTIC UNITS.                                     */ 10760000
*/*                                                                  */ 10761000
*/*  INPUT -                                                         */ 10762000
*/*          WITHCOM - FLAG SET 'OFF' WHEN A COMMA SHOULD NOT APPEAR */ 10763000
*/*                    AS PART OF THE SEPARATOR                      */ 10764000
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED                */ 10765000
*/*          CHAR2 -   INPUT CHARACTER TO BE EXTRACTED NEXT          */ 10766000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 10767000
*/*                    CODE WHEN AN ERROR IS FOUND                   */ 10768000
*/*          SCANONLY- FLAG SET 'ON' WHEN THE CURRENT COMMAND IS     */ 10769000
*/*                    BEING SCANNED FOR SYNTAX CHECKING ONLY.       */ 10770000
*/*                                                                  */ 10771000
*/*  OUTPUT - NONE                                                   */ 10772000
*/*                                                                  */ 10773000
*/********************************************************************/ 10774000
*SCANSEP:PROCEDURE(WITHCOM);           /*PARAMETER SIGNALS WHETHER 2045 10775000
*                                        A COMMA IS TO BE CONSIDERED    10776000
*                                        PART OF THE SEPARATOR OR NOT*/ 10777000
SCANSEP  STM   @14,@12,@SA00029                                    2045 10778000
         MVC   @PC00029(4),0(@01)                                  2045 10779000
*        /************************************************************/ 10780000
*        /*                                                          */ 10781000
*        /* SCANSEP PROCEDURE DATA DEFINITIONS                       */ 10782000
*        /*                                                          */ 10783000
*        /************************************************************/ 10784000
*                                                                  2046 10785000
*        /* STATIC ERROR MESSAGE CODE                                */ 10786000
*        DCL COMMAERR FIXED(31)        /*DOUBLE COMMA                */ 10787000
*                     CONSTANT(7);                                 2046 10788000
*                                                                  2046 10789000
*        DCL COMMASW  BIT(1);          /*SIGNALS THAT A COMMA HAS BEEN  10790000
*                                        FOUND IN THIS SEPARATOR     */ 10791000
*        DCL WITHCOM  BIT(1);          /*SIGNALS THAT A COMMA MAY  2048 10792000
*                                        APPEAR IN THIS SEPARATOR    */ 10793000
*        /************************************************************/ 10794000
*        /*                                                          */ 10795000
*        /*  ** SCANSEP **  SCAN PAST SEPARATOR CHARACTERS           */ 10796000
*        /*                                                          */ 10797000
*        /************************************************************/ 10798000
*        IF WITHCOM=YES                                            2049 10799000
*          THEN                                                    2049 10800000
         L     @15,@PC00029                                        2049 10801000
         TM    WITHCOM(@15),B'10000000'                            2049 10802000
         BNO   @RF02049                                            2049 10803000
*            COMMASW=OFF;                                          2050 10804000
         NI    COMMASW,B'01111111'                                 2050 10805000
*          ELSE                                                    2051 10806000
*            COMMASW=ON;                                           2051 10807000
         B     @RC02049                                            2051 10808000
@RF02049 OI    COMMASW,B'10000000'                                 2051 10809000
*        DELIM=NO;                                                 2052 10810000
@RC02049 NI    DELIM,B'11110111'                                   2052 10811000
*        COMMENT=NO;                                               2053 10812000
         NI    COMMENT,B'10111111'                                 2053 10813000
*        DO WHILE(DELIM=NO & RISTATUS=0);                          2054 10814000
*                                                                  2054 10815000
         B     @DE02054                                            2054 10816000
@DL02054 DS    0H                                                  2055 10817000
*          /**********************************************************/ 10818000
*          /*                                                        */ 10819000
*          /* IF NOT CURRENTLY BYPASSING A COMMENT, LOOK FOR A CHAR. */ 10820000
*          /* OTHER THAN A SEPARATOR CHARACTER OR THE BEGINNING OF A */ 10821000
*          /* COMMENT TO SIGNAL THE BEGINNING OF THE NEXT SYNTACTIC  */ 10822000
*          /* UNIT.  IF MORE THAN ONE COMMA HAS BEEN FOUND, ISSUE A  */ 10823000
*          /* WARNING MESSAGE STATING THAT IT WILL BE IGNORED.       */ 10824000
*          /*                                                        */ 10825000
*          /**********************************************************/ 10826000
*          IF COMMENT=NO                                           2055 10827000
*            THEN                                                  2055 10828000
         TM    COMMENT,B'01000000'                                 2055 10829000
         BNZ   @RF02055                                            2055 10830000
*              IF CHAR1 ^= BLANK                                   2056 10831000
*                THEN                                              2056 10832000
         CLI   CHAR1,C' '                                          2056 10833000
         BE    @RF02056                                            2056 10834000
*                  IF CHAR1=COMMA                                  2057 10835000
*                    THEN                                          2057 10836000
         CLI   CHAR1,C','                                          2057 10837000
         BNE   @RF02057                                            2057 10838000
*                      IF COMMASW=ON                               2058 10839000
*                        THEN                                      2058 10840000
         TM    COMMASW,B'10000000'                                 2058 10841000
         BNO   @RF02058                                            2058 10842000
*                          DO;                                     2059 10843000
*                          DARGSMOD=RISTID;                        2060 10844000
         L     @15,DDSTRU                                          2060 10845000
         MVC   DARGSMOD(3,@15),RISTID                              2060 10846000
*                          DARGSENT=COMMAERR;                      2061 10847000
*                                                                  2061 10848000
         MVI   DARGSENT(@15),X'07'                                 2061 10849000
*                          CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);   2062 10850000
*                                                                  2062 10851000
         L     @15,GDTPTR                                          2062 10852000
         ST    @15,@AL00001                                        2062 10853000
         LA    @14,@CF00102                                        2062 10854000
         ST    @14,@AL00001+4                                      2062 10855000
         LA    @14,DDSTRU                                          2062 10856000
         ST    @14,@AL00001+8                                      2062 10857000
         MVI   @AL00001+8,X'80'                                    2062 10858000
         L     @15,GDTPRT(,@15)                                    2062 10859000
         LA    @01,@AL00001                                        2062 10860000
         BALR  @14,@15                                             2062 10861000
*                          END;                                    2063 10862000
*                        ELSE                                      2064 10863000
*                          COMMASW=ON;                             2064 10864000
         B     @RC02058                                            2064 10865000
@RF02058 OI    COMMASW,B'10000000'                                 2064 10866000
*                    ELSE                                          2065 10867000
*                      IF CHAR1=COMSTART(1) & CHAR2=COMSTART(2)    2065 10868000
*                        THEN                                      2065 10869000
         B     @RC02057                                            2065 10870000
@RF02057 CLC   CHAR1(1),COMSTART                                   2065 10871000
         BNE   @RF02065                                            2065 10872000
         CLC   CHAR2(1),COMSTART+1                                 2065 10873000
         BNE   @RF02065                                            2065 10874000
*                          DO;                                     2066 10875000
*                          COMMENT=YES;                            2067 10876000
*                                                                  2067 10877000
         OI    COMMENT,B'01000000'                                 2067 10878000
*                          CALL NEXTCHAR;                          2068 10879000
*                                                                  2068 10880000
         BAL   @14,NEXTCHAR                                        2068 10881000
*                          END;                                    2069 10882000
*                        ELSE                                      2070 10883000
*                          DELIM=YES;                              2070 10884000
         B     @RC02065                                            2070 10885000
@RF02065 OI    DELIM,B'00001000'                                   2070 10886000
*                ELSE;                                             2071 10887000
*                                                                  2071 10888000
@RF02056 DS    0H                                                  2072 10889000
*            /********************************************************/ 10890000
*            /*                                                      */ 10891000
*            /* IF CURRENTLY BYPASSING A COMMENT, LOOK FOR THE ENDING*/ 10892000
*            /* COMMENT DELIMITER.  ALSO TEST TO SEE IF THE END OF   */ 10893000
*            /* THE CURRENT COMMAND HAS BEEN FOUND WHILE SCANNING    */ 10894000
*            /* WITHIN THE COMMENT.                                  */ 10895000
*            /*                                                      */ 10896000
*            /********************************************************/ 10897000
*            ELSE                                                  2072 10898000
*              IF CHAR1=COMEND(1) & CHAR2=COMEND(2)                2072 10899000
*                THEN                                              2072 10900000
         B     @RC02055                                            2072 10901000
@RF02055 CLC   CHAR1(1),COMEND                                     2072 10902000
         BNE   @RF02072                                            2072 10903000
         CLC   CHAR2(1),COMEND+1                                   2072 10904000
         BNE   @RF02072                                            2072 10905000
*                  DO;                                             2073 10906000
*                  COMMENT=NO;                                     2074 10907000
*                                                                  2074 10908000
         NI    COMMENT,B'10111111'                                 2074 10909000
*                  CALL NEXTCHAR;                                  2075 10910000
*                                                                  2075 10911000
         BAL   @14,NEXTCHAR                                        2075 10912000
*                  END;                                            2076 10913000
*                ELSE                                              2077 10914000
*                  IF CHAR1=ENDDELIM &                             2077 10915000
*                     (OPTSFLAG=ON | MORTOCOM=NO) &                2077 10916000
*                     SCANINDX >= SCNLIMIT                         2077 10917000
*                    THEN                                          2077 10918000
         B     @RC02072                                            2077 10919000
@RF02072 CLI   CHAR1,C';'                                          2077 10920000
         BNE   @RF02077                                            2077 10921000
         TM    OPTSFLAG,B'00100000'                                2077 10922000
         BO    @GL00145                                            2077 10923000
         TM    MORTOCOM,B'00010000'                                2077 10924000
         BNZ   @RF02077                                            2077 10925000
@GL00145 LH    @15,SCANINDX                                        2077 10926000
         CH    @15,SCNLIMIT                                        2077 10927000
         BL    @RF02077                                            2077 10928000
*                      DELIM=YES;                                  2078 10929000
*                                                                  2078 10930000
         OI    DELIM,B'00001000'                                   2078 10931000
*          /**********************************************************/ 10932000
*          /*                                                        */ 10933000
*          /* SCAN THE INPUT CHARACTERS ONE AT A TIME -- IF, AFTER   */ 10934000
*          /* A CHARACTER HAS BEEN CHECKED, THE NEXT SYNTACTIC UNIT  */ 10935000
*          /* HAS NOT BEEN REACHED, PICK UP THE NEXT CHARACTER.      */ 10936000
*          /*                                                        */ 10937000
*          /**********************************************************/ 10938000
*          IF DELIM=NO                                             2079 10939000
*            THEN                                                  2079 10940000
*                                                                  2079 10941000
@RF02077 DS    0H                                                  2079 10942000
@RC02072 DS    0H                                                  2079 10943000
@RC02055 TM    DELIM,B'00001000'                                   2079 10944000
         BNZ   @RF02079                                            2079 10945000
*              CALL NEXTCHAR;                                      2080 10946000
*                                                                  2080 10947000
         BAL   @14,NEXTCHAR                                        2080 10948000
*        END;                                                      2081 10949000
*                                                                  2081 10950000
@RF02079 DS    0H                                                  2081 10951000
@DE02054 TM    DELIM,B'00001000'                                   2081 10952000
         BNZ   @DC02054                                            2081 10953000
         LH    @15,RISTATUS                                        2081 10954000
         LTR   @15,@15                                             2081 10955000
         BZ    @DL02054                                            2081 10956000
@DC02054 DS    0H                                                  2082 10957000
*        END SCANSEP;                                              2082 10958000
@EL00029 DS    0H                                                  2082 10959000
@EF00029 DS    0H                                                  2082 10960000
@ER00029 LM    @14,@12,@SA00029                                    2082 10961000
         BR    @14                                                 2082 10962000
*/********************************************************************/ 10963000
*/*                                                                  */ 10964000
*/*  PROCEDURE NAME - NEXTCHAR                                       */ 10965000
*/*                                                                  */ 10966000
*/*  FUNCTION - THIS ROUTINE EXTRACTS THE NEXT CHARACTER (PRIMARY    */ 10967000
*/*             CHARACTER) FROM THE INPUT STREAM AND MAKES THE       */ 10968000
*/*             CHARACTER LOGICALLY FOLLOWING IT (SECONDARY CHAR.)   */ 10969000
*/*             AVAILABLE FOR REFERENCE. (THE NEXT INVOCATION OF     */ 10970000
*/*             'NEXTCHAR' WILL TREAT THIS SECONDARY CHARACTER AS THE*/ 10971000
*/*             PRIMARY CHARACTER). A NEW RECORD IS OBTAINED, IF     */ 10972000
*/*             NECESSARY, TO PICK UP THE SECONDARY CHAR., AND THIS  */ 10973000
*/*             NEW RECORD IS PREPARED FOR SCANNING BEFORE PROCESSING*/ 10974000
*/*             OF IT BEGINS.                                        */ 10975000
*/*                                                                  */ 10976000
*/*  INPUT -                                                         */ 10977000
*/*          FINALCHR- FLAG SET 'ON' WHEN INPUT END-OF-FILE HAS BEEN */ 10978000
*/*                    REACHED.                                      */ 10979000
*/*          FIRSTCHR- FLAG SET 'ON' WHEN THE LOCATION AND LENGTH OF */ 10980000
*/*                    THE INPUT CHARACTERS TO BE SCANNED ARE        */ 10981000
*/*                    SPECIFIED IN THE R/I HISTORICAL DATA AREA.    */ 10982000
*/*          INRECPTR- PTR IN R/I HDA POINTING TO INPUT CHARACTERS   */ 10983000
*/*                    NOT COMPLETELY SCANNED BY PREVIOUS INVOCATION */ 10984000
*/*                    OF THE READER/INTERPRETER.                    */ 10985000
*/*          INRECLEN- LENGTH OF ABOVE UNSCANNED STRING.             */ 10986000
*/*          SCANINDX- INDEX INDICATING THE OFFSET INTO THE CURRENT  */ 10987000
*/*                    INPUT RECORD OF THE LAST CHARACTER EXTRACTED. */ 10988000
*/*          SCNLIMIT- OFFSET INTO THE CURRENT INPUT RECORD OF THE   */ 10989000
*/*                    FINAL CHARACTER IN THE RECORD TO BE EXTRACTED.*/ 10990000
*/*          INREC -   CONTAINS THE CURRENT INPUT RECORD             */ 10991000
*/*          OPTSFLAG- FLAG SET 'ON' WHEN CURRENTLY SCANNING WITHIN  */ 10992000
*/*                    THE PARAMETER OPTIONS STRING                  */ 10993000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 10994000
*/*                    VALUE WHEN AN ERROR IS FOUND.                 */ 10995000
*/*                                                                  */ 10996000
*/*  OUTPUT -                                                        */ 10997000
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED.               */ 10998000
*/*          CHAR2 -   INPUT CHARACTER WHICH LOGICALLY FOLLOWS THE   */ 10999000
*/*                    CHARACTER JUST EXTRACTED.                     */ 11000000
*/*          FINALCHR- SEE 'INPUT'                                   */ 11001000
*/*          RISTATUS- SEE 'INPUT'                                   */ 11002000
*/*          FIRSTCHR- SEE 'INPUT'                                   */ 11003000
*/*          RECRDPTR- POINTER TO CURRENT INPUT RECORD               */ 11004000
*/*          SCNLIMIT- SEE 'INPUT'                                   */ 11005000
*/*          SCANINDX- SEE 'INPUT'                                   */ 11006000
*/*                                                                  */ 11007000
*/********************************************************************/ 11008000
*NEXTCHAR:PROCEDURE;                                               2083 11009000
NEXTCHAR STM   @14,@12,@SA00030                                    2083 11010000
*        /************************************************************/ 11011000
*        /*                                                          */ 11012000
*        /*  ** NEXTCHAR **  GET NEXT COMMAND CHARACTER              */ 11013000
*        /*                                                          */ 11014000
*        /************************************************************/ 11015000
*                                                                  2084 11016000
*        /************************************************************/ 11017000
*        /*                                                          */ 11018000
*        /* NOTE WHETHER END-OF-FILE HAS BEEN REACHED OR NOT         */ 11019000
*        /*                                                          */ 11020000
*        /************************************************************/ 11021000
*        IF FINALCHR=YES                                           2084 11022000
*          THEN                                                    2084 11023000
         TM    FINALCHR,B'00000010'                                2084 11024000
         BNO   @RF02084                                            2084 11025000
*            DO;                                                   2085 11026000
*            OLDERID2 = NEWERID2;                                  2086 11027000
         L     @01,GDTPTR                                          2086 11028000
         L     @15,GDTTR2(,@01)                                    2086 11029000
         MVC   @TS00001(95),NEWERID2(@15)                          2086 11030000
         MVC   OLDERID2(95,@15),@TS00001                           2086 11031000
*            NEWID2='RI56';                                        2087 11032000
         MVC   NEWID2(4,@15),@CC01245                              2087 11033000
*            RISTATUS=EOFILE;                                      2088 11034000
         MVC   RISTATUS(2),@CH00118                                2088 11035000
*            END;                                                  2089 11036000
*          ELSE                                                    2090 11037000
*DOGRP185:   DO;                                                   2090 11038000
*                                                                  2090 11039000
         B     @RC02084                                            2090 11040000
@RF02084 DS    0H                                                  2090 11041000
DOGRP185 DS    0H                                                  2091 11042000
*            /********************************************************/ 11043000
*            /*                                                      */ 11044000
*            /* IF THE FIRST CHARACTER OF A NEW COMMAND IS TO BE     */ 11045000
*            /* EXTRACTED, THEN PREPARE TO OBTAIN THE NEXT INPUT     */ 11046000
*            /* RECORD (PREPARATION INCLUDES WRITING A BLANK OUTPUT  */ 11047000
*            /* RECORD, UNLESS A NULL COMMAND WAS JUST ENCOUNTERED). */ 11048000
*            /* OTHERWISE, JUST POINT TO THE NEXT CHARACTER OF THE   */ 11049000
*            /* CURRENT RECORD.                                      */ 11050000
*            /*                                                      */ 11051000
*            /********************************************************/ 11052000
*            IF FIRSTCHR=YES                                       2091 11053000
*              THEN                                                2091 11054000
         TM    FIRSTCHR,B'00000100'                                2091 11055000
         BNO   @RF02091                                            2091 11056000
*                DO;                                               2092 11057000
*                OLDERID2 = NEWERID2;                              2093 11058000
         L     @15,GDTPTR                                          2093 11059000
         L     @14,GDTTR2(,@15)                                    2093 11060000
         MVC   @TS00001(95),NEWERID2(@14)                          2093 11061000
         MVC   OLDERID2(95,@14),@TS00001                           2093 11062000
*                NEWID2='RI57';                                    2094 11063000
         MVC   NEWID2(4,@14),@CC01248                              2094 11064000
*                FIRSTCHR=NO;                                      2095 11065000
         NI    FIRSTCHR,B'11111011'                                2095 11066000
*                SCNLIMIT=0;                                       2096 11067000
         SLR   @14,@14                                             2096 11068000
         STH   @14,SCNLIMIT                                        2096 11069000
*                SCANINDX=1;                                       2097 11070000
         MVC   SCANINDX(2),@CH00172                                2097 11071000
*                MORTOCOM=YES;                                     2098 11072000
*                                                                  2098 11073000
         OI    MORTOCOM,B'00010000'                                2098 11074000
*                IF NULLCMD=NO                                     2099 11075000
*                  THEN                                            2099 11076000
         TM    NULLCMD,B'01000000'                                 2099 11077000
         BNZ   @RF02099                                            2099 11078000
*                    DO;                                           2100 11079000
*                    DARGSMOD=RISTID;                              2101 11080000
         L     @14,DDSTRU                                          2101 11081000
         MVC   DARGSMOD(3,@14),RISTID                              2101 11082000
*                    DARGSENT=INRECID;                             2102 11083000
         MVI   DARGSENT(@14),X'27'                                 2102 11084000
*                    BLANKFLD=BLANK;                               2103 11085000
         MVI   BLANKFLD+1,C' '                                     2103 11086000
         MVC   BLANKFLD+2(8),BLANKFLD+1                            2103 11087000
         MVI   BLANKFLD,C' '                                       2103 11088000
*                    DARGDBP=ADDR(BLANKFLD);                       2104 11089000
         LA    @05,BLANKFLD                                        2104 11090000
         ST    @05,DARGDBP(,@14)                                   2104 11091000
*                    DARGILP=LENGTH(BLANKFLD);                     2105 11092000
*                                                                  2105 11093000
         MVC   DARGILP(2,@14),@CH00040                             2105 11094000
*                    CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);         2106 11095000
*                                                                  2106 11096000
         ST    @15,@AL00001                                        2106 11097000
         LA    @14,@CF00102                                        2106 11098000
         ST    @14,@AL00001+4                                      2106 11099000
         LA    @14,DDSTRU                                          2106 11100000
         ST    @14,@AL00001+8                                      2106 11101000
         MVI   @AL00001+8,X'80'                                    2106 11102000
         L     @15,GDTPRT(,@15)                                    2106 11103000
         LA    @01,@AL00001                                        2106 11104000
         BALR  @14,@15                                             2106 11105000
*                    END;                                          2107 11106000
*                  ELSE                                            2108 11107000
*                    NULLCMD=NO;                                   2108 11108000
         B     @RC02099                                            2108 11109000
@RF02099 NI    NULLCMD,B'10111111'                                 2108 11110000
*                END;                                              2109 11111000
*              ELSE                                                2110 11112000
*                SCANINDX=SCANINDX+1;                              2110 11113000
*                                                                  2110 11114000
         B     @RC02091                                            2110 11115000
@RF02091 LH    @01,SCANINDX                                        2110 11116000
         LA    @01,1(,@01)                                         2110 11117000
         STH   @01,SCANINDX                                        2110 11118000
*            /********************************************************/ 11119000
*            /*                                                      */ 11120000
*            /* EXTRACT THE NEXT INPUT CHARACTER & ALSO OBTAIN THE   */ 11121000
*            /* INPUT CHARACTER WHICH LOGICALLY FOLLOWS THIS NEXT    */ 11122000
*            /* CHARACTER (GET THE NEXT RECORD IF NECESSARY).        */ 11123000
*            /*                                                      */ 11124000
*            /********************************************************/ 11125000
*            IF SCNLIMIT > 0                                       2111 11126000
*              THEN                                                2111 11127000
@RC02091 LH    @15,SCNLIMIT                                        2111 11128000
         LTR   @15,@15                                             2111 11129000
         BNP   @RF02111                                            2111 11130000
*                CHAR1=INREC(SCANINDX);                            2112 11131000
         LH    @01,SCANINDX                                        2112 11132000
         L     @15,RECRDPTR                                        2112 11133000
         ALR   @15,@01                                             2112 11134000
         BCTR  @15,0                                               2112 11135000
         MVC   CHAR1(1),INREC(@15)                                 2112 11136000
*            IF SCANINDX >= SCNLIMIT                               2113 11137000
*              THEN                                                2113 11138000
*                                                                  2113 11139000
@RF02111 LH    @15,SCANINDX                                        2113 11140000
         CH    @15,SCNLIMIT                                        2113 11141000
         BL    @RF02113                                            2113 11142000
*                /****************************************************/ 11143000
*                /*                                                  */ 11144000
*                /* OBTAIN THE NEXT INPUT RECORD IN ORDER TO PICK UP */ 11145000
*                /* THE SECOND INPUT CHARACTER                       */ 11146000
*                /*                                                  */ 11147000
*                /****************************************************/ 11148000
*DOGRP190:       DO;                                               2114 11149000
*                                                                  2114 11150000
DOGRP190 DS    0H                                                  2115 11151000
*                  /**************************************************/ 11152000
*                  /*                                                */ 11153000
*                  /* FABRICATE A COMMAND-END DELIMITER IF SCANNING  */ 11154000
*                  /* HAS REACHED THE END OF A NON-CONTINUED COMMAND.*/ 11155000
*                  /*                                                */ 11156000
*                  /**************************************************/ 11157000
*                  IF OPTSFLAG=ON | MORTOCOM=NO                    2115 11158000
*                    THEN                                          2115 11159000
         TM    OPTSFLAG,B'00100000'                                2115 11160000
         BO    @RT02115                                            2115 11161000
         TM    MORTOCOM,B'00010000'                                2115 11162000
         BNZ   @RF02115                                            2115 11163000
@RT02115 DS    0H                                                  2116 11164000
*                      DO;                                         2116 11165000
*                      CHAR1=ENDDELIM;                             2117 11166000
         MVI   CHAR1,C';'                                          2117 11167000
*                      CHAR2=BLANK;                                2118 11168000
         MVI   CHAR2,C' '                                          2118 11169000
*                      END;                                        2119 11170000
*                    ELSE                                          2120 11171000
*                      IF SCANINDX > SCNLIMIT                      2120 11172000
*                        THEN                                      2120 11173000
         B     @RC02115                                            2120 11174000
@RF02115 LH    @15,SCANINDX                                        2120 11175000
         CH    @15,SCNLIMIT                                        2120 11176000
         BNH   @RF02120                                            2120 11177000
*                          CHAR1=BLANK;                            2121 11178000
*                                                                  2121 11179000
         MVI   CHAR1,C' '                                          2121 11180000
*                  /**************************************************/ 11181000
*                  /*                                                */ 11182000
*                  /* READ IN RECORD(S), STRIPPING CHARACTERS NOT TO */ 11183000
*                  /* BE SCANNED FROM BOTH ENDS OF THE NEW RECORD -- */ 11184000
*                  /* READ IN RECORDS UNTIL ONE IS READ WHICH HAS    */ 11185000
*                  /* CHARACTERS LEFT TO BE SCANNED AFTER STRIPPING. */ 11186000
*                  /* READ NO MORE RECORDS IF A 'READ' CONDITION HAS */ 11187000
*                  /* BEEN FOUND OR IF THE CURRENT COMMAND IS NOT    */ 11188000
*                  /* CONTINUED ON TO THE NEXT INPUT RECORD.         */ 11189000
*                  /*                                                */ 11190000
*                  /**************************************************/ 11191000
*                  INCOMM=NO;                                      2122 11192000
@RF02120 DS    0H                                                  2122 11193000
@RC02115 NI    INCOMM,B'11011111'                                  2122 11194000
*                  DO WHILE(SCNLIMIT-SCANINDX <= 0 &               2123 11195000
*                           OPTSFLAG=OFF & MORTOCOM=YES &          2123 11196000
*                           RISTATUS^=EOFILE & RISTATUS^=SKIPREST);     11197000
*                                                                  2123 11198000
         B     @DE02123                                            2123 11199000
@DL02123 DS    0H                                                  2124 11200000
*                    CALL GETRECRD;                                2124 11201000
*                                                                  2124 11202000
         BAL   @14,GETRECRD                                        2124 11203000
*                  END;                                            2125 11204000
*                                                                  2125 11205000
@DE02123 LH    @15,SCNLIMIT                                        2125 11206000
         SH    @15,SCANINDX                                        2125 11207000
         LTR   @15,@15                                             2125 11208000
         BP    @DC02123                                            2125 11209000
         TM    OPTSFLAG,B'00100000'                                2125 11210000
         BNZ   @DC02123                                            2125 11211000
         TM    MORTOCOM,B'00010000'                                2125 11212000
         BNO   @DC02123                                            2125 11213000
         LH    @15,RISTATUS                                        2125 11214000
         CH    @15,@CH00118                                        2125 11215000
         BE    @DC02123                                            2125 11216000
         CH    @15,@CH00042                                        2125 11217000
         BNE   @DL02123                                            2125 11218000
@DC02123 DS    0H                                                  2126 11219000
*                  /**************************************************/ 11220000
*                  /*                                                */ 11221000
*                  /* IF NO MORE INPUT RECORDS REMAIN, SET VALUES TO */ 11222000
*                  /* INDICATE THIS CONDITION.                       */ 11223000
*                  /*                                                */ 11224000
*                  /**************************************************/ 11225000
*                  IF RISTATUS = EOFILE                            2126 11226000
*                    THEN                                          2126 11227000
         CLC   RISTATUS(2),@CH00118                                2126 11228000
         BNE   @RF02126                                            2126 11229000
*                      DO;                                         2127 11230000
*                      OLDERID2 = NEWERID2;                        2128 11231000
         L     @01,GDTPTR                                          2128 11232000
         L     @15,GDTTR2(,@01)                                    2128 11233000
         MVC   @TS00001(95),NEWERID2(@15)                          2128 11234000
         MVC   OLDERID2(95,@15),@TS00001                           2128 11235000
*                      NEWID2='RI59';                              2129 11236000
         MVC   NEWID2(4,@15),@CC01252                              2129 11237000
*                      CHAR2=BLANK;                                2130 11238000
         MVI   CHAR2,C' '                                          2130 11239000
*                      FINALCHR=YES;                               2131 11240000
         OI    FINALCHR,B'00000010'                                2131 11241000
*                      RISTATUS=0;                                 2132 11242000
         SLR   @15,@15                                             2132 11243000
         STH   @15,RISTATUS                                        2132 11244000
*                      END;                                        2133 11245000
*                END DOGRP190;                                     2134 11246000
*                                                                  2134 11247000
@RF02126 DS    0H                                                  2135 11248000
*            /********************************************************/ 11249000
*            /*                                                      */ 11250000
*            /* EXTRACT THE 2ND INPUT CHARACTER FROM THE RECORD NOW  */ 11251000
*            /* POINTED TO, UNLESS A NEW RECORD WAS NOT OBTAINED     */ 11252000
*            /*                                                      */ 11253000
*            /********************************************************/ 11254000
*            IF FINALCHR=NO  &  SCANINDX < SCNLIMIT                2135 11255000
*              THEN                                                2135 11256000
@RF02113 TM    FINALCHR,B'00000010'                                2135 11257000
         BNZ   @RF02135                                            2135 11258000
         LH    @15,SCANINDX                                        2135 11259000
         CH    @15,SCNLIMIT                                        2135 11260000
         BNL   @RF02135                                            2135 11261000
*                CHAR2=INREC(SCANINDX+1);                          2136 11262000
         L     @01,RECRDPTR                                        2136 11263000
         ALR   @01,@15                                             2136 11264000
         MVC   CHAR2(1),INREC(@01)                                 2136 11265000
*            END DOGRP185;                                         2137 11266000
*/********************************************************************/ 11267000
*/*                                                                  */ 11268000
*/*  PROCEDURE NAME - GETRECRD                                       */ 11269000
*/*                                                                  */ 11270000
*/*  FUNCTION - THIS ROUTINE OBTAINS THE NEXT INPUT RECORD, PRINTS   */ 11271000
*/*             THE RECORD AND SETS UP REFERENCE TO IT TO ALLOW      */ 11272000
*/*             SCANNING TO CONTINUE.  IF NO INPUT RECORDS REMAIN,   */ 11273000
*/*             THE R/I INTERNAL STATUS CODE IS SET TO SIGNAL EOF.   */ 11274000
*/*                                                                  */ 11275000
*/*  INPUT -                                                         */ 11276000
*/*          IOCDAD -  ADDRESS OF RECORD JUST READ                   */ 11277000
*/*          IOCDLN -  LENGTH OF RECORD JUST READ                    */ 11278000
*/*                                                                  */ 11279000
*/*  OUTPUT -                                                        */ 11280000
*/*          RECRDPTR- POINTER TO RECORD JUST READ                   */ 11281000
*/*          SCNLIMIT- LENGTH OF RECORD JUST READ                    */ 11282000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 11283000
*/*                    CODE IF EOF OR AN I/O ERROR OCCURS.           */ 11284000
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */ 11285000
*/*                                                                  */ 11286000
*/********************************************************************/ 11287000
*                                                                  2138 11288000
*GETRECRD:PROCEDURE;                                               2138 11289000
         B     @PB00031                                            2138 11290000
GETRECRD STM   @14,@12,@SA00031                                    2138 11291000
*        /************************************************************/ 11292000
*        /*                                                          */ 11293000
*        /*  ** GETRECRD **  GET NEXT INPUT RECORD                   */ 11294000
*        /*                                                          */ 11295000
*        /************************************************************/ 11296000
*        IF GDTDBG = NULLPTR                                       2139 11297000
*          THEN;                                                   2139 11298000
         L     @01,GDTPTR                                          2139 11299000
         L     @15,GDTDBG(,@01)                                    2139 11300000
         LTR   @15,@15                                             2139 11301000
         BZ    @RT02139                                            2139 11302000
*          ELSE                                                    2141 11303000
*            CALL ICKDB010(GDTTBL,'RIGR');                         2141 11304000
*                                                                  2141 11305000
         L     @15,GDTPTR                                          2141 11306000
         ST    @15,@AL00001                                        2141 11307000
         LA    @14,@CC01256                                        2141 11308000
         ST    @14,@AL00001+4                                      2141 11309000
         MVI   @AL00001+4,X'80'                                    2141 11310000
         L     @15,GDTDBG(,@15)                                    2141 11311000
         LA    @01,@AL00001                                        2141 11312000
         BALR  @14,@15                                             2141 11313000
*        /************************************************************/ 11314000
*        /*                                                          */ 11315000
*        /*  REQUEST NEXT RECORD AND NOTE IF THE RECORD COULD NOT    */ 11316000
*        /*  BE OBTAINED.  ANY ABNORMAL CONDITION OTHER THAN END-OF- */ 11317000
*        /*  FILE IS TREATED AS AN I/O ERROR                         */ 11318000
*        /*                                                          */ 11319000
*        /************************************************************/ 11320000
*                                                                  2142 11321000
*        CALL ICKIOGT0(GDTTBL,ADDRIOCS);                           2142 11322000
@RT02139 L     @15,GDTPTR                                          2142 11323000
         ST    @15,@AL00001                                        2142 11324000
         L     @01,GDTRIH(,@15)                                    2142 11325000
         LA    @14,ADDRIOCS(,@01)                                  2142 11326000
         ST    @14,@AL00001+4                                      2142 11327000
         MVI   @AL00001+4,X'80'                                    2142 11328000
         L     @15,GDTGET(,@15)                                    2142 11329000
         LA    @01,@AL00001                                        2142 11330000
         BALR  @14,@15                                             2142 11331000
*        RESPECIFY RTNREG RSTD;                                    2143 11332000
*        TESTRC = RTNREG;                                          2144 11333000
         STH   RTNREG,TESTRC                                       2144 11334000
*        RESPECIFY RTNREG UNRSTD;                                  2145 11335000
*                                                                  2145 11336000
*        IF TESTRC^=0                                              2146 11337000
*          THEN                                                    2146 11338000
         LH    @15,TESTRC                                          2146 11339000
         LTR   @15,@15                                             2146 11340000
         BZ    @RF02146                                            2146 11341000
*            IF TESTRC=16                                          2147 11342000
*              THEN                                                2147 11343000
         CH    @15,@CH00274                                        2147 11344000
         BNE   @RF02147                                            2147 11345000
*                RISTATUS=EOFILE;                                  2148 11346000
         MVC   RISTATUS(2),@CH00118                                2148 11347000
*              ELSE                                                2149 11348000
*                DO;                                               2149 11349000
         B     @RC02147                                            2149 11350000
@RF02147 DS    0H                                                  2150 11351000
*                LASTCC=TERMERR;                                   2150 11352000
         MVC   LASTCC(2),@CH00274                                  2150 11353000
*                RISTATUS=SKIPREST;                                2151 11354000
         MVC   RISTATUS(2),@CH00042                                2151 11355000
*                END;                                              2152 11356000
*                                                                  2152 11357000
*          /**********************************************************/ 11358000
*          /*                                                        */ 11359000
*          /*  WHEN RECORD IS OBTAINED, PRINT IT AND SET IT UP FOR   */ 11360000
*          /*  SCANNING                                              */ 11361000
*          /*                                                        */ 11362000
*          /**********************************************************/ 11363000
*          ELSE                                                    2153 11364000
*            DO;                                                   2153 11365000
         B     @RC02146                                            2153 11366000
@RF02146 DS    0H                                                  2154 11367000
*            RECRDPTR=ADDRIOCS->IOCDAD;                            2154 11368000
         L     @15,GDTPTR                                          2154 11369000
         L     @01,GDTRIH(,@15)                                    2154 11370000
         L     @14,ADDRIOCS(,@01)                                  2154 11371000
         L     @05,IOCDAD(,@14)                                    2154 11372000
         ST    @05,RECRDPTR                                        2154 11373000
*            SCNLIMIT=ADDRIOCS->IOCDLN;                            2155 11374000
*                                                                  2155 11375000
         L     @14,IOCDLN(,@14)                                    2155 11376000
         STH   @14,SCNLIMIT                                        2155 11377000
*            /********************************************************/ 11378000
*            /*                                                      */ 11379000
*            /* SET UP PRINT ROUTINE DATA STRUCTURES                 */ 11380000
*            /*                                                      */ 11381000
*            /********************************************************/ 11382000
*            DARGDBP=RECRDPTR;                                     2156 11383000
         L     @04,DDSTRU                                          2156 11384000
         ST    @05,DARGDBP(,@04)                                   2156 11385000
*            DARGILP=SCNLIMIT;                                     2157 11386000
         STH   @14,DARGILP(,@04)                                   2157 11387000
*            DARGSMOD=RISTID;                                      2158 11388000
         MVC   DARGSMOD(3,@04),RISTID                              2158 11389000
*            DARGSENT=INRECID;                                     2159 11390000
*                                                                  2159 11391000
         MVI   DARGSENT(@04),X'27'                                 2159 11392000
*            CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);                 2160 11393000
*                                                                  2160 11394000
         ST    @15,@AL00001                                        2160 11395000
         LA    @14,@CF00102                                        2160 11396000
         ST    @14,@AL00001+4                                      2160 11397000
         LA    @14,DDSTRU                                          2160 11398000
         ST    @14,@AL00001+8                                      2160 11399000
         MVI   @AL00001+8,X'80'                                    2160 11400000
         L     @15,GDTPRT(,@15)                                    2160 11401000
         LA    @01,@AL00001                                        2160 11402000
         BALR  @14,@15                                             2160 11403000
*            CALL SCANENDS;                                        2161 11404000
*                                                                  2161 11405000
         BAL   @14,SCANENDS                                        2161 11406000
*            END;                                                  2162 11407000
*/********************************************************************/ 11408000
*/*                                                                  */ 11409000
*/*  PROCEDURE NAME - SCANENDS                                       */ 11410000
*/*                                                                  */ 11411000
*/*  FUNCTION - THIS ROUTINE SCANS BOTH ENDS OF A NEW INPUT RECORD,  */ 11412000
*/*             CHECKING FOR CHARACTERS WHICH SHOULD NOT BE INCLUDED */ 11413000
*/*             IN THE NORMAL COMMAND SCANNING.  ONLY THOSE CHAR'S   */ 11414000
*/*             WITHIN THE SPECIFIED SOURCE MARGINS ARE ELIGIBLE FOR */ 11415000
*/*             SCANNING.  ALSO, LEADING BLANKS AND COMMENTS ARE     */ 11416000
*/*             IGNORED IF THE PREVIOUS RECORD ENDED WITH A FIELD    */ 11417000
*/*             CONTINUATION CHARACTER (A PLUS SIGN); IF THE NEW     */ 11418000
*/*             RECORD ENDS WITH A CONTINUATION CHARACTER, THEN ALL  */ 11419000
*/*             CHARACTERS INCLUDING AND FOLLOWING IT ARE IGNORED.   */ 11420000
*/*                                                                  */ 11421000
*/*  INPUT -                                                         */ 11422000
*/*          LEFTMGN - LEFT INPUT COMMAND SOURCE MARGIN              */ 11423000
*/*          RIGHTMGN- RIGHT INPUT COMMAND SOURCE MARGIN             */ 11424000
*/*          SCNLIMIT- LENGTH OF NEW INPUT RECORD                    */ 11425000
*/*          CONTNEXT- FLAG SET 'ON' IF PREVIOUS RECORD ENDED WITH   */ 11426000
*/*                    A FIELD CONTINUATION DELIMITER                */ 11427000
*/*          INREC -   CONTAINS THE NEW INPUT RECORD                 */ 11428000
*/*                                                                  */ 11429000
*/*  OUTPUT -                                                        */ 11430000
*/*          SCANINDX- OFFSET INTO NEW RECORD AT WHICH NORMAL        */ 11431000
*/*                    SCANNING IS TO BEGIN                          */ 11432000
*/*          SCNLIMIT- OFFSET INTO NEW RECORD AT WHICH NORMAL        */ 11433000
*/*                    SCANNING IS TO END                            */ 11434000
*/*          CONTNEXT- FLAG SET 'ON' IF NEW RECORD ENDS WITH THE     */ 11435000
*/*                    FIELD CONTINUATION DELIMITER                  */ 11436000
*/*          MORTOCOM- FLAG SET 'ON' WHEN THE NEW RECORD IS TO BE    */ 11437000
*/*                    CONTINUED ON TO THE NEXT INPUT RECORD.        */ 11438000
*/*                                                                  */ 11439000
*/********************************************************************/ 11440000
*                                                                  2163 11441000
*SCANENDS:PROCEDURE;                                               2163 11442000
         B     @PB00032                                            2163 11443000
SCANENDS STM   @14,@12,@SA00032                                    2163 11444000
*        /************************************************************/ 11445000
*        /*                                                          */ 11446000
*        /* SCANENDS PROCEDURE DATA DEFINITIONS                      */ 11447000
*        /*                                                          */ 11448000
*        /************************************************************/ 11449000
*        DCL ENDFOUND BIT(1);          /*SIGNALS THAT THE FINAL CHAR.   11450000
*                                        TO BE SCANNED IN THE NEW  2164 11451000
*                                        RECORD HAS BEEN DETERMINED. */ 11452000
*        DCL SKIPLEAD BIT(1);          /*SIGNALS THAT LEADING BLANKS    11453000
*                                        ARE TO BE SKIPPED BEFORE  2165 11454000
*                                        SCANNING THE NEW RECORD.    */ 11455000
*        /************************************************************/ 11456000
*        /*                                                          */ 11457000
*        /*  ** SCANENDS **  SCAN RECORD FOR CONTINUATION INDICATION */ 11458000
*        /*                                                          */ 11459000
*        /************************************************************/ 11460000
*        IF GDTDBG = NULLPTR                                       2166 11461000
*          THEN;                                                   2166 11462000
         L     @01,GDTPTR                                          2166 11463000
         L     @15,GDTDBG(,@01)                                    2166 11464000
         LTR   @15,@15                                             2166 11465000
         BZ    @RT02166                                            2166 11466000
*          ELSE                                                    2168 11467000
*            CALL ICKDB010(GDTTBL,'RISE');                         2168 11468000
*                                                                  2168 11469000
         L     @15,GDTPTR                                          2168 11470000
         ST    @15,@AL00001                                        2168 11471000
         LA    @14,@CC01263                                        2168 11472000
         ST    @14,@AL00001+4                                      2168 11473000
         MVI   @AL00001+4,X'80'                                    2168 11474000
         L     @15,GDTDBG(,@15)                                    2168 11475000
         LA    @01,@AL00001                                        2168 11476000
         BALR  @14,@15                                             2168 11477000
*        /************************************************************/ 11478000
*        /*                                                          */ 11479000
*        /* INITIALIZE LEFT AND RIGHT SCANNING LIMITS OF NEW RECORD. */ 11480000
*        /* THEN SCAN BACKWARD FROM THE END OF THE NEW RECORD,       */ 11481000
*        /* CHECKING FOR A CONTINUATION DELIMITER                    */ 11482000
*        /*                                                          */ 11483000
*        /************************************************************/ 11484000
*        SCANINDX=LEFTMGN;                                         2169 11485000
@RT02166 L     @01,GDTPTR                                          2169 11486000
         L     @15,GDTRIH(,@01)                                    2169 11487000
         MVC   SCANINDX(2),LEFTMGN(@15)                            2169 11488000
*        SCNLIMIT=MIN(RIGHTMGN,SCNLIMIT);                          2170 11489000
         LH    @15,RIGHTMGN(,@15)                                  2170 11490000
         LH    @14,SCNLIMIT                                        2170 11491000
         CR    @15,@14                                             2170 11492000
         BNH   *+6                                                      11493000
         LR    @15,@14                                             2170 11494000
         STH   @15,SCNLIMIT                                        2170 11495000
*        IF CONTNEXT=YES                                           2171 11496000
*          THEN                                                    2171 11497000
         TM    CONTNEXT,B'00001000'                                2171 11498000
         BNO   @RF02171                                            2171 11499000
*            DO;                                                   2172 11500000
*            SKIPLEAD=YES;                                         2173 11501000
         OI    SKIPLEAD,B'10000000'                                2173 11502000
*            CONTNEXT=NO;                                          2174 11503000
         NI    CONTNEXT,B'11110111'                                2174 11504000
*            END;                                                  2175 11505000
*          ELSE                                                    2176 11506000
*            SKIPLEAD=NO;                                          2176 11507000
         B     @RC02171                                            2176 11508000
@RF02171 NI    SKIPLEAD,B'01111111'                                2176 11509000
*        MORTOCOM=NO;                                              2177 11510000
@RC02171 NI    MORTOCOM,B'11101111'                                2177 11511000
*        ENDFOUND=NO;                                              2178 11512000
         NI    ENDFOUND,B'01111111'                                2178 11513000
*        DO INDEX=SCNLIMIT TO SCANINDX BY -1 WHILE(ENDFOUND=NO);   2179 11514000
*                                                                  2179 11515000
         LH    @15,SCNLIMIT                                        2179 11516000
         STH   @15,INDEX                                           2179 11517000
         B     @DE02179                                            2179 11518000
@DL02179 TM    ENDFOUND,B'10000000'                                2179 11519000
         BNZ   @DC02179                                            2179 11520000
*          /**********************************************************/ 11521000
*          /*                                                        */ 11522000
*          /* SEARCH FOR THE LAST NON-BLANK CHARACTER OF THE NEW     */ 11523000
*          /* RECORD, WHICH MAY INDICATE FIELD AND/OR COMMAND        */ 11524000
*          /* CONTINUATION OR SIMPLY THE SCANNING LIMIT OF THE RECORD*/ 11525000
*          /*                                                        */ 11526000
*          /**********************************************************/ 11527000
*          IF INREC(INDEX) ^= BLANK                                2180 11528000
*            THEN                                                  2180 11529000
         L     @14,RECRDPTR                                        2180 11530000
         ALR   @15,@14                                             2180 11531000
         BCTR  @15,0                                               2180 11532000
         CLI   INREC(@15),C' '                                     2180 11533000
         BE    @RF02180                                            2180 11534000
*              IF INREC(INDEX) = CMDCONT  |  INREC(INDEX) = FLDCONT     11535000
*                                                                  2181 11536000
*                /****************************************************/ 11537000
*                /*                                                  */ 11538000
*                /* A CONTINUATION DELIMITER DENOTES THAT THIS       */ 11539000
*                /* COMMAND CONTINUES ON TO THE NEXT RECORD.         */ 11540000
*                /*                                                  */ 11541000
*                /****************************************************/ 11542000
*                THEN                                              2181 11543000
         LH    @15,INDEX                                           2181 11544000
         ALR   @15,@14                                             2181 11545000
         BCTR  @15,0                                               2181 11546000
         CLI   INREC(@15),C'-'                                     2181 11547000
         BE    @RT02181                                            2181 11548000
         LH    @15,INDEX                                           2181 11549000
         ALR   @14,@15                                             2181 11550000
         BCTR  @14,0                                               2181 11551000
         CLI   INREC(@14),C'+'                                     2181 11552000
         BNE   @RF02181                                            2181 11553000
@RT02181 DS    0H                                                  2182 11554000
*                  DO;                                             2182 11555000
*                                                                  2182 11556000
*                  /**************************************************/ 11557000
*                  /*                                                */ 11558000
*                  /* IF FIELD CONTINUATION IS INDICATED, NOTE THAT  */ 11559000
*                  /* LEADING COMMENTS AND BLANKS ARE TO BE IGNORED  */ 11560000
*                  /* IN THE NEXT RECORD(S) UNTIL A NON-BLANK OR     */ 11561000
*                  /* COMMAND TERMINATION IS FOUND, UNLESS THE SCAN  */ 11562000
*                  /* IS ALREADY IN MID-COMMENT.                     */ 11563000
*                  /*                                                */ 11564000
*                  /**************************************************/ 11565000
*                  IF INREC(INDEX)=FLDCONT                         2183 11566000
*                    THEN                                          2183 11567000
         LH    @01,INDEX                                           2183 11568000
         L     @15,RECRDPTR                                        2183 11569000
         ALR   @15,@01                                             2183 11570000
         BCTR  @15,0                                               2183 11571000
         CLI   INREC(@15),C'+'                                     2183 11572000
         BNE   @RF02183                                            2183 11573000
*                      CONTNEXT=YES;                               2184 11574000
         OI    CONTNEXT,B'00001000'                                2184 11575000
*                  MORTOCOM=YES;                                   2185 11576000
@RF02183 OI    MORTOCOM,B'00010000'                                2185 11577000
*                  ENDFOUND=YES;                                   2186 11578000
         OI    ENDFOUND,B'10000000'                                2186 11579000
*                  SCNLIMIT=INDEX-1;                               2187 11580000
         LH    @15,INDEX                                           2187 11581000
         BCTR  @15,0                                               2187 11582000
         STH   @15,SCNLIMIT                                        2187 11583000
*                  END;                                            2188 11584000
*                                                                  2188 11585000
*                /****************************************************/ 11586000
*                /*                                                  */ 11587000
*                /* WHEN NOT ONE OF THE ABOVE DELIMITERS, THE SCAN   */ 11588000
*                /* LIMIT HAS BEEN FOUND.                            */ 11589000
*                /*                                                  */ 11590000
*                /****************************************************/ 11591000
*                ELSE                                              2189 11592000
*                  ENDFOUND=YES;                                   2189 11593000
         B     @RC02181                                            2189 11594000
@RF02181 OI    ENDFOUND,B'10000000'                                2189 11595000
*        END;                                                      2190 11596000
*                                                                  2190 11597000
@RC02181 DS    0H                                                  2190 11598000
@RF02180 SLR   @15,@15                                             2190 11599000
         BCTR  @15,0                                               2190 11600000
         AH    @15,INDEX                                           2190 11601000
         STH   @15,INDEX                                           2190 11602000
@DE02179 CH    @15,SCANINDX                                        2190 11603000
         BNL   @DL02179                                            2190 11604000
@DC02179 DS    0H                                                  2191 11605000
*        /************************************************************/ 11606000
*        /*                                                          */ 11607000
*        /* BYPASS LEADING BLANKS AND/OR COMMENTS IF A FIELD         */ 11608000
*        /* CONTINUATION DELIMITER WAS FOUND ENDING THE PRECEDING    */ 11609000
*        /* INPUT RECORD.                                            */ 11610000
*        /*                                                          */ 11611000
*        /************************************************************/ 11612000
*        IF SKIPLEAD=YES & COMMENT=NO                              2191 11613000
*          THEN                                                    2191 11614000
         TM    SKIPLEAD,B'10000000'                                2191 11615000
         BNO   @RF02191                                            2191 11616000
         TM    COMMENT,B'01000000'                                 2191 11617000
         BNZ   @RF02191                                            2191 11618000
*DOGRP195:   DO;                                                   2192 11619000
DOGRP195 DS    0H                                                  2193 11620000
*              OLDERID2 = NEWERID2;                                2193 11621000
         L     @01,GDTPTR                                          2193 11622000
         L     @15,GDTTR2(,@01)                                    2193 11623000
         MVC   @TS00001(95),NEWERID2(@15)                          2193 11624000
         MVC   OLDERID2(95,@15),@TS00001                           2193 11625000
*              NEWID2='RI60';                                      2194 11626000
         MVC   NEWID2(4,@15),@CC01266                              2194 11627000
*DOLOOP45:     DO INDEX=SCANINDX TO SCNLIMIT WHILE(SKIPLEAD=YES);  2195 11628000
DOLOOP45 LH    @15,SCANINDX                                        2195 11629000
         B     @DE02195                                            2195 11630000
@DL02195 TM    SKIPLEAD,B'10000000'                                2195 11631000
         BNO   @DC02195                                            2195 11632000
*                IF INREC(INDEX) ^= BLANK                          2196 11633000
*                  THEN                                            2196 11634000
*                                                                  2196 11635000
         L     @14,RECRDPTR                                        2196 11636000
         ALR   @15,@14                                             2196 11637000
         BCTR  @15,0                                               2196 11638000
         CLI   INREC(@15),C' '                                     2196 11639000
         BE    @RF02196                                            2196 11640000
*                    /************************************************/ 11641000
*                    /*                                              */ 11642000
*                    /* IF BYPASSING A LEADING COMMENT, LOOK FOR THE */ 11643000
*                    /* DELIMITER WHICH ENDS THE COMMENT.            */ 11644000
*                    /*                                              */ 11645000
*                    /************************************************/ 11646000
*                    IF INCOMM=YES                                 2197 11647000
*                      THEN                                        2197 11648000
         TM    INCOMM,B'00100000'                                  2197 11649000
         BNO   @RF02197                                            2197 11650000
*                        IF INDEX < SCNLIMIT &                     2198 11651000
*                           INREC(INDEX:INDEX+1) = COMEND          2198 11652000
*                          THEN                                    2198 11653000
         LH    @15,INDEX                                           2198 11654000
         CH    @15,SCNLIMIT                                        2198 11655000
         BNL   @RF02198                                            2198 11656000
         ALR   @14,@15                                             2198 11657000
         BCTR  @14,0                                               2198 11658000
         CLC   INREC(2,@14),COMEND                                 2198 11659000
         BNE   @RF02198                                            2198 11660000
*                            DO;                                   2199 11661000
*                            OLDERID2 = NEWERID2;                  2200 11662000
         L     @01,GDTPTR                                          2200 11663000
         L     @14,GDTTR2(,@01)                                    2200 11664000
         MVC   @TS00001(95),NEWERID2(@14)                          2200 11665000
         MVC   OLDERID2(95,@14),@TS00001                           2200 11666000
*                            NEWID2='RI61';                        2201 11667000
         MVC   NEWID2(4,@14),@CC01269                              2201 11668000
*                            INDEX=INDEX+1;                        2202 11669000
         LA    @15,1(,@15)                                         2202 11670000
         STH   @15,INDEX                                           2202 11671000
*                            INCOMM=NO;                            2203 11672000
         NI    INCOMM,B'11011111'                                  2203 11673000
*                            END;                                  2204 11674000
*                          ELSE;                                   2205 11675000
*                                                                  2205 11676000
@RF02198 DS    0H                                                  2206 11677000
*                      /**********************************************/ 11678000
*                      /*                                            */ 11679000
*                      /* WHEN BYPASSING LEADING BLANKS, CHECK FOR   */ 11680000
*                      /* LEADING COMMENTS AND FOR A NON-BLANK       */ 11681000
*                      /* CHARACTER INDICATING STARTING SCAN POSITION*/ 11682000
*                      /*                                            */ 11683000
*                      /**********************************************/ 11684000
*                      ELSE                                        2206 11685000
*                        IF INDEX < SCNLIMIT &                     2206 11686000
*                           INREC(INDEX:INDEX+1) = COMSTART        2206 11687000
*                          THEN                                    2206 11688000
         B     @RC02197                                            2206 11689000
@RF02197 LH    @15,INDEX                                           2206 11690000
         CH    @15,SCNLIMIT                                        2206 11691000
         BNL   @RF02206                                            2206 11692000
         L     @01,RECRDPTR                                        2206 11693000
         ALR   @01,@15                                             2206 11694000
         BCTR  @01,0                                               2206 11695000
         CLC   INREC(2,@01),COMSTART                               2206 11696000
         BNE   @RF02206                                            2206 11697000
*                            DO;                                   2207 11698000
*                            OLDERID2 = NEWERID2;                  2208 11699000
         L     @01,GDTPTR                                          2208 11700000
         L     @14,GDTTR2(,@01)                                    2208 11701000
         MVC   @TS00001(95),NEWERID2(@14)                          2208 11702000
         MVC   OLDERID2(95,@14),@TS00001                           2208 11703000
*                            NEWID2='RI62';                        2209 11704000
         MVC   NEWID2(4,@14),@CC01270                              2209 11705000
*                            INCOMM=YES;                           2210 11706000
         OI    INCOMM,B'00100000'                                  2210 11707000
*                            INDEX=INDEX+1;                        2211 11708000
         LA    @15,1(,@15)                                         2211 11709000
         STH   @15,INDEX                                           2211 11710000
*                            END;                                  2212 11711000
*                          ELSE                                    2213 11712000
*                            DO;                                   2213 11713000
         B     @RC02206                                            2213 11714000
@RF02206 DS    0H                                                  2214 11715000
*                            SKIPLEAD=NO;                          2214 11716000
         NI    SKIPLEAD,B'01111111'                                2214 11717000
*                            SCANINDX=INDEX;                       2215 11718000
         MVC   SCANINDX(2),INDEX                                   2215 11719000
*                            END;                                  2216 11720000
*              END DOLOOP45;                                       2217 11721000
@RC02206 DS    0H                                                  2217 11722000
@RC02197 DS    0H                                                  2217 11723000
@RF02196 LA    @15,1                                               2217 11724000
         AH    @15,INDEX                                           2217 11725000
@DE02195 STH   @15,INDEX                                           2217 11726000
         CH    @15,SCNLIMIT                                        2217 11727000
         BNH   @DL02195                                            2217 11728000
@DC02195 DS    0H                                                  2218 11729000
*              /******************************************************/ 11730000
*              /*                                                    */ 11731000
*              /* IF ONLY BLANKS AND COMMENTS WERE FOUND IN THIS     */ 11732000
*              /* RECORD FOLLOWING FIELD CONTINUATION, THEN CHECK TO */ 11733000
*              /* SEE IF THE RECORD IS CONTINUED.  IF SO, NOTE THAT  */ 11734000
*              /* IT SHOULD STILL BE CONSIDERED FIELD CONTINUATION.  */ 11735000
*              /* IF NOT CONTINUED, SET 'CHAR2' TO BE BLANK UNTIL THE*/ 11736000
*              /* NEXT CALL TO 'NEXTCHAR' CAN FABRICATE A SEMICOLON. */ 11737000
*              /*                                                    */ 11738000
*              /******************************************************/ 11739000
*              IF SKIPLEAD=YES                                     2218 11740000
*                THEN                                              2218 11741000
         TM    SKIPLEAD,B'10000000'                                2218 11742000
         BNO   @RF02218                                            2218 11743000
*                  DO;                                             2219 11744000
*                  SCANINDX=INDEX+1;                               2220 11745000
         LH    @01,INDEX                                           2220 11746000
         LA    @01,1(,@01)                                         2220 11747000
         STH   @01,SCANINDX                                        2220 11748000
*                  IF MORTOCOM=YES                                 2221 11749000
*                    THEN                                          2221 11750000
         TM    MORTOCOM,B'00010000'                                2221 11751000
         BNO   @RF02221                                            2221 11752000
*                      CONTNEXT=YES;                               2222 11753000
         OI    CONTNEXT,B'00001000'                                2222 11754000
*                    ELSE                                          2223 11755000
*                      CHAR2=BLANK;                                2223 11756000
         B     @RC02221                                            2223 11757000
@RF02221 MVI   CHAR2,C' '                                          2223 11758000
*                  END;                                            2224 11759000
@RC02221 DS    0H                                                  2225 11760000
*            END DOGRP195;                                         2225 11761000
*                                                                  2225 11762000
@RF02218 DS    0H                                                  2226 11763000
*        /************************************************************/ 11764000
*        /*                                                          */ 11765000
*        /* ADJUST STARTING SCAN POSITION IN PREPARATION FOR         */ 11766000
*        /* INCREMENTING OF THE SCAN POSITION POINTER.  ADJUST ENDING*/ 11767000
*        /* SCAN LIMIT IF COMMAND CONTINUATION IS NOT INDICATED IN   */ 11768000
*        /* PREPARATION FOR FABRICATING A COMMAND-ENDING DELIMITER.  */ 11769000
*        /*                                                          */ 11770000
*        /************************************************************/ 11771000
*        SCANINDX=SCANINDX-1;                                      2226 11772000
@RF02191 LH    @15,SCANINDX                                        2226 11773000
         BCTR  @15,0                                               2226 11774000
         STH   @15,SCANINDX                                        2226 11775000
*        IF MORTOCOM=NO                                            2227 11776000
*          THEN                                                    2227 11777000
         TM    MORTOCOM,B'00010000'                                2227 11778000
         BNZ   @RF02227                                            2227 11779000
*            SCNLIMIT=SCNLIMIT+1;                                  2228 11780000
*                                                                  2228 11781000
         LH    @01,SCNLIMIT                                        2228 11782000
         LA    @01,1(,@01)                                         2228 11783000
         STH   @01,SCNLIMIT                                        2228 11784000
*        END SCANENDS;                                             2229 11785000
*                                                                  2229 11786000
*                                                                  2229 11787000
@EL00032 DS    0H                                                  2229 11788000
@EF00032 DS    0H                                                  2229 11789000
@ER00032 LM    @14,@12,@SA00032                                    2229 11790000
         BR    @14                                                 2229 11791000
*        END GETRECRD;                                             2230 11792000
*                                                                  2230 11793000
*                                                                  2230 11794000
@EL00031 DS    0H                                                  2230 11795000
@EF00031 DS    0H                                                  2230 11796000
@ER00031 LM    @14,@12,@SA00031                                    2230 11797000
         BR    @14                                                 2230 11798000
*        END NEXTCHAR;                                             2231 11799000
@EL00030 DS    0H                                                  2231 11800000
@EF00030 DS    0H                                                  2231 11801000
@ER00030 LM    @14,@12,@SA00030                                    2231 11802000
         BR    @14                                                 2231 11803000
*/********************************************************************/ 11804000
*/*                                                                  */ 11805000
*/*  PROCEDURE NAME - DSPLCALC                                       */ 11806000
*/*                                                                  */ 11807000
*/*  FUNCTION - THIS ROUTINE CALCULATES THE OFFSET INTO THE CURRENT  */ 11808000
*/*             PARAMETER'S FDT POINTER VECTOR AT WHICH A VALUE IS   */ 11809000
*/*             TO BE INSERTED.  THE VALUE IS ONE WHICH IS RELATED   */ 11810000
*/*             THE FDT POINTER STRUCTURE USED FOR REPEATED SUBLISTS */ 11811000
*/*             AND THE OFFSET IS BASED UPON THE CURRENT REPEATED    */ 11812000
*/*             SUBLIST NESTING LEVEL AND THE MAXIMUM NUMBER OF      */ 11813000
*/*             SUBLIST REPETITIONS ALLOWED.                         */ 11814000
*/*                                                                  */ 11815000
*/*  INPUT -                                                         */ 11816000
*/*          DEPTH -   CURRENT LEVEL OF REPEATED SUBLIST NESTING     */ 11817000
*/*          REPLIMIT- LIST CONTAINING THE MAXIMUM NUMBER OF SUBLIST */ 11818000
*/*                    REPETITIONS ALLOWED AT EACH REPEATEDNESS LEVEL*/ 11819000
*/*          ARRYPTR - POINTER IN MAIN FDT POINTER VECTOR WHICH      */ 11820000
*/*                    POINTS TO CURRENT PARAMETER'S SECONDARY PTR   */ 11821000
*/*                    VECTOR.                                       */ 11822000
*/*                                                                  */ 11823000
*/*  OUTPUT -                                                        */ 11824000
*/*          ARRYPTR - POINTER TO SECONDARY POINTER VECTOR, THE      */ 11825000
*/*                    DISPLACEMENT INTO WHICH A VALUE WILL BE       */ 11826000
*/*                    INSERTED AFTER THE RETURN FROM 'DSPLCALC'     */ 11827000
*/*          ARRYDSPL- THE CALCULATED DISPLACEMENT                   */ 11828000
*/*                                                                  */ 11829000
*/********************************************************************/ 11830000
*DSPLCALC:PROCEDURE(DEPTH);                                        2232 11831000
DSPLCALC STM   @14,@12,@SA00033                                    2232 11832000
         MVC   @PC00033(4),0(@01)                                  2232 11833000
*        /************************************************************/ 11834000
*        /*                                                          */ 11835000
*        /* DSPLCALC PROCEDURE DATA DEFINITIONS                      */ 11836000
*        /*                                                          */ 11837000
*        /************************************************************/ 11838000
*        DCL DEPTH FIXED(15);          /*DEPTH OF REPEATED LIST    2233 11839000
*                                        NESTING WITH WHICH THE COUNT   11840000
*                                        OR POINTER IS ASSOCIATED    */ 11841000
*        DCL FACTOR   FIXED(15);       /*MULTIPLICATION FACTOR USED IN  11842000
*                                        CALCULATING ARRAY OFFSETS   */ 11843000
*        /************************************************************/ 11844000
*        /*                                                          */ 11845000
*        /*  ** DSPLCALC ** CALCULATE DISPLACEMENT INTO PTR ARRAY    */ 11846000
*        /*                                                          */ 11847000
*        /************************************************************/ 11848000
*        IF GDTDBG = NULLPTR                                       2235 11849000
*          THEN;                                                   2235 11850000
         L     @01,GDTPTR                                          2235 11851000
         L     @15,GDTDBG(,@01)                                    2235 11852000
         LTR   @15,@15                                             2235 11853000
         BZ    @RT02235                                            2235 11854000
*          ELSE                                                    2237 11855000
*            CALL ICKDB010(GDTTBL,'RICK');                         2237 11856000
*                                                                  2237 11857000
         L     @15,GDTPTR                                          2237 11858000
         ST    @15,@AL00001                                        2237 11859000
         LA    @14,@CC01277                                        2237 11860000
         ST    @14,@AL00001+4                                      2237 11861000
         MVI   @AL00001+4,X'80'                                    2237 11862000
         L     @15,GDTDBG(,@15)                                    2237 11863000
         LA    @01,@AL00001                                        2237 11864000
         BALR  @14,@15                                             2237 11865000
*        ARRYDSPL=0;                                               2238 11866000
@RT02235 SLR   @15,@15                                             2238 11867000
         STH   @15,ARRYDSPL                                        2238 11868000
*        IF DEPTH=0                                                2239 11869000
*          THEN                                                    2239 11870000
         L     @14,@PC00033                                        2239 11871000
         CH    @15,DEPTH(,@14)                                     2239 11872000
         BNE   @RF02239                                            2239 11873000
*            ARRYPTR=ADDR(FDTPTR(PARMID));                         2240 11874000
         LH    @15,PARMID                                          2240 11875000
         SLA   @15,2                                               2240 11876000
         L     @01,FDTADDR                                         2240 11877000
         LA    @15,FDTPTR-4(@15,@01)                               2240 11878000
         ST    @15,ARRYPTR                                         2240 11879000
*          ELSE                                                    2241 11880000
*            DO INDEX=1 TO DEPTH;                                  2241 11881000
         B     @RC02239                                            2241 11882000
@RF02239 LA    @15,1                                               2241 11883000
         B     @DE02241                                            2241 11884000
@DL02241 DS    0H                                                  2242 11885000
*              FACTOR=1;                                           2242 11886000
         LA    @14,1                                               2242 11887000
         STH   @14,FACTOR                                          2242 11888000
*              DO LISTINDX=(INDEX+1) TO DEPTH;                     2243 11889000
         ALR   @15,@14                                             2243 11890000
         B     @DE02243                                            2243 11891000
@DL02243 DS    0H                                                  2244 11892000
*                FACTOR=FACTOR*REPLIMIT(LISTINDX);                 2244 11893000
         LR    @14,@15                                             2244 11894000
         ALR   @14,@14                                             2244 11895000
         LH    @05,FACTOR                                          2244 11896000
         MH    @05,REPLIMIT-2(@14)                                 2244 11897000
         STH   @05,FACTOR                                          2244 11898000
*              END;                                                2245 11899000
         AL    @15,@CF00172                                        2245 11900000
@DE02243 STH   @15,LISTINDX                                        2245 11901000
         L     @14,@PC00033                                        2245 11902000
         CH    @15,DEPTH(,@14)                                     2245 11903000
         BNH   @DL02243                                            2245 11904000
*              ARRYDSPL=ARRYDSPL+FACTOR*PTRLNGTH*(REPCOUNT(INDEX)-1);   11905000
         LH    @01,FACTOR                                          2246 11906000
         SLA   @01,2                                               2246 11907000
         LH    @15,INDEX                                           2246 11908000
         LR    @14,@15                                             2246 11909000
         ALR   @14,@14                                             2246 11910000
         LH    @14,REPCOUNT-2(@14)                                 2246 11911000
         BCTR  @14,0                                               2246 11912000
         MR    @00,@14                                             2246 11913000
         AH    @01,ARRYDSPL                                        2246 11914000
         STH   @01,ARRYDSPL                                        2246 11915000
*            END;                                                  2247 11916000
*                                                                  2247 11917000
         AL    @15,@CF00172                                        2247 11918000
@DE02241 STH   @15,INDEX                                           2247 11919000
         L     @14,@PC00033                                        2247 11920000
         CH    @15,DEPTH(,@14)                                     2247 11921000
         BNH   @DL02241                                            2247 11922000
*        /************************************************************/ 11923000
*        /*                                                          */ 11924000
*        /* IF THE DATA POINTER IS FOR A PARAMETER IN A REPEATED     */ 11925000
*        /* PARAMETER LIST (1ST LEVEL OF REPEATEDNESS), THEN THE     */ 11926000
*        /* POINTER VECTOR IS BEING MAINTAINED AS A LIST OF VECTOR   */ 11927000
*        /* BLOCKS.  SET UP TO POINT TO THE PROPER DATA POINTER IN   */ 11928000
*        /* THE PROPER BLOCK IN THE LIST.                            */ 11929000
*        /*                                                          */ 11930000
*        /************************************************************/ 11931000
*        IF DEPTH=1                                                2248 11932000
*          THEN                                                    2248 11933000
@RC02239 LA    @15,1                                               2248 11934000
         L     @14,@PC00033                                        2248 11935000
         CH    @15,DEPTH(,@14)                                     2248 11936000
         BNE   @RF02248                                            2248 11937000
*            DO;                                                   2249 11938000
*              OLDERID2 = NEWERID2;                                2250 11939000
         L     @01,GDTPTR                                          2250 11940000
         L     @14,GDTTR2(,@01)                                    2250 11941000
         MVC   @TS00001(95),NEWERID2(@14)                          2250 11942000
         MVC   OLDERID2(95,@14),@TS00001                           2250 11943000
*              NEWID2='RI66';                                      2251 11944000
         MVC   NEWID2(4,@14),@CC01278                              2251 11945000
*              VECTRNUM=ARRYDSPL/VECTRLEN+1;                       2252 11946000
         LH    @14,ARRYDSPL                                        2252 11947000
         LH    @05,VECTRLEN                                        2252 11948000
         LR    @00,@14                                             2252 11949000
         SRDA  @00,32                                              2252 11950000
         DR    @00,@05                                             2252 11951000
         ALR   @01,@15                                             2252 11952000
         STH   @01,VECTRNUM                                        2252 11953000
*              ARRYDSPL=ARRYDSPL//VECTRLEN;                        2253 11954000
         SRDA  @14,32                                              2253 11955000
         DR    @14,@05                                             2253 11956000
         STH   @14,ARRYDSPL                                        2253 11957000
*              DO INDEX2=1 TO VECTRNUM-1;                          2254 11958000
         LA    @15,1                                               2254 11959000
         B     @DE02254                                            2254 11960000
@DL02254 DS    0H                                                  2255 11961000
*                ARRYPTR=VECTRPTR;                                 2255 11962000
         LH    @14,VECTRLEN                                        2255 11963000
         AL    @14,ARRYPTR                                         2255 11964000
         L     @14,VECTRPTR(,@14)                                  2255 11965000
         ST    @14,ARRYPTR                                         2255 11966000
*              END;                                                2256 11967000
         AL    @15,@CF00172                                        2256 11968000
@DE02254 STH   @15,INDEX2                                          2256 11969000
         LH    @14,VECTRNUM                                        2256 11970000
         BCTR  @14,0                                               2256 11971000
         CR    @15,@14                                             2256 11972000
         BNH   @DL02254                                            2256 11973000
*            END;                                                  2257 11974000
*                                                                  2257 11975000
*        END DSPLCALC;                                             2258 11976000
@EL00033 DS    0H                                                  2258 11977000
@EF00033 DS    0H                                                  2258 11978000
@ER00033 LM    @14,@12,@SA00033                                    2258 11979000
         BR    @14                                                 2258 11980000
*/********************************************************************/ 11981000
*/*                                                                  */ 11982000
*/*  PROCEDURE NAME - ERROR1                                         */ 11983000
*/*                                                                  */ 11984000
*/*  FUNCTION - THIS ROUTINE HANDLES A SYNTAX OR SEMANTIC ERROR WHICH*/ 11985000
*/*             REQUIRES SKIPPING OF THE CURRENT INPUT COMMAND. THIS */ 11986000
*/*             TYPE OF ERROR WILL ALLOW SCANNING TO CONTINUE WITH   */ 11987000
*/*             THE NEXT COMMAND.  THE ERROR MESSAGE CONSISTS        */ 11988000
*/*             ENTIRELY OF STATIC TEXT.                             */ 11989000
*/*                                                                  */ 11990000
*/*  INPUT -                                                         */ 11991000
*/*          ERRCODE1- ERROR CODE WHICH IDENTIFIES THE ERROR AND     */ 11992000
*/*                    WILL BE USED AS PART OF THE MESSAGE ID        */ 11993000
*/*          SCANONLY- FLAG SET 'ON' WHEN CURRENT RECORD IS BEING    */ 11994000
*/*                    SCANNED FOR SYNTAX CHECKING PURPOSES ONLY     */ 11995000
*/*          SKIPPAST- FLAG SET 'ON' TO SIGNAL THAT CURRENT COMMAND  */ 11996000
*/*                    HAS BEEN SKIPPED                              */ 11997000
*/*                                                                  */ 11998000
*/*  OUTPUT -                                                        */ 11999000
*/*          PRINTED ERROR MESSAGE.                                  */ 12000000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO THE ERROR    */ 12001000
*/*                    CODE VALUE                                    */ 12002000
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */ 12003000
*/*          SCANONLY- SEE 'INPUT'                                   */ 12004000
*/*                                                                  */ 12005000
*/********************************************************************/ 12006000
*ERROR1: PROCEDURE(ERRCODE1);                                      2259 12007000
ERROR1   STM   @14,@12,@SA00034                                    2259 12008000
         MVC   @PC00034(4),0(@01)                                  2259 12009000
*        /************************************************************/ 12010000
*        /*                                                          */ 12011000
*        /* ERROR1 PROCEDURE DATA DEFINITIONS                        */ 12012000
*        /*                                                          */ 12013000
*        /************************************************************/ 12014000
*        DCL ERRCODE1 FIXED(31);       /*STATIC ERROR MESSAGE CODE   */ 12015000
*        /************************************************************/ 12016000
*        /*                                                          */ 12017000
*        /*  ** ERROR1 **  HANDLE SYNTAX OR SEMANTIC ERROR           */ 12018000
*        /*                                                          */ 12019000
*        /************************************************************/ 12020000
*        IF GDTDBG = NULLPTR                                       2261 12021000
*          THEN;                                                   2261 12022000
         L     @01,GDTPTR                                          2261 12023000
         L     @15,GDTDBG(,@01)                                    2261 12024000
         LTR   @15,@15                                             2261 12025000
         BZ    @RT02261                                            2261 12026000
*          ELSE                                                    2263 12027000
*            CALL ICKDB010(GDTTBL,'RIE1');                         2263 12028000
*                                                                  2263 12029000
         L     @15,GDTPTR                                          2263 12030000
         ST    @15,@AL00001                                        2263 12031000
         LA    @14,@CC01284                                        2263 12032000
         ST    @14,@AL00001+4                                      2263 12033000
         MVI   @AL00001+4,X'80'                                    2263 12034000
         L     @15,GDTDBG(,@15)                                    2263 12035000
         LA    @01,@AL00001                                        2263 12036000
         BALR  @14,@15                                             2263 12037000
*        IF SCANONLY=NO                                            2264 12038000
*          THEN                                                    2264 12039000
@RT02261 TM    SCANONLY,B'00010000'                                2264 12040000
         BNZ   @RF02264                                            2264 12041000
*            LASTCC=BADERROR;                                      2265 12042000
         MVC   LASTCC(2),@CH00038                                  2265 12043000
*        RISTATUS=ERRCODE1;                                        2266 12044000
@RF02264 L     @15,@PC00034                                        2266 12045000
         L     @15,ERRCODE1(,@15)                                  2266 12046000
         STH   @15,RISTATUS                                        2266 12047000
*        IF ERRCODE1^=NOSPACE                                      2267 12048000
*          THEN                                                    2267 12049000
         CH    @15,@CH00278                                        2267 12050000
         BE    @RF02267                                            2267 12051000
*            DO;                                                   2268 12052000
*            DARGSMOD=RISTID;                                      2269 12053000
         L     @14,DDSTRU                                          2269 12054000
         MVC   DARGSMOD(3,@14),RISTID                              2269 12055000
*            DARGSENT=ERRCODE1;                                    2270 12056000
         STC   @15,DARGSENT(,@14)                                  2270 12057000
*            END;                                                  2271 12058000
*          ELSE                                                    2272 12059000
*            DO;                                                   2272 12060000
         B     @RC02267                                            2272 12061000
@RF02267 DS    0H                                                  2273 12062000
*            DARGSMOD='UV0';                                       2273 12063000
         L     @15,DDSTRU                                          2273 12064000
         MVC   DARGSMOD(3,@15),@CC01285                            2273 12065000
*            DARGSENT=4;                                           2274 12066000
         MVI   DARGSENT(@15),X'04'                                 2274 12067000
*            END;                                                  2275 12068000
*                                                                  2275 12069000
*        CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);                     2276 12070000
*                                                                  2276 12071000
@RC02267 L     @15,GDTPTR                                          2276 12072000
         ST    @15,@AL00001                                        2276 12073000
         LA    @14,@CF00102                                        2276 12074000
         ST    @14,@AL00001+4                                      2276 12075000
         LA    @14,DDSTRU                                          2276 12076000
         ST    @14,@AL00001+8                                      2276 12077000
         MVI   @AL00001+8,X'80'                                    2276 12078000
         L     @15,GDTPRT(,@15)                                    2276 12079000
         LA    @01,@AL00001                                        2276 12080000
         BALR  @14,@15                                             2276 12081000
*        /************************************************************/ 12082000
*        /*                                                          */ 12083000
*        /* SCAN UP TO THE NEXT COMMAND FOLLOWING THE COMMAND THAT   */ 12084000
*        /* CONTAINS THE ERROR, IF THIS HAS NOT ALREADY BEEN DONE.   */ 12085000
*        /*                                                          */ 12086000
*        /************************************************************/ 12087000
*        IF SKIPPAST=NO                                            2277 12088000
*          THEN                                                    2277 12089000
         TM    SKIPPAST,B'00001000'                                2277 12090000
         BNZ   @RF02277                                            2277 12091000
*            DO;                                                   2278 12092000
*                                                                  2278 12093000
*              CALL SKIPCMD;                                       2279 12094000
*                                                                  2279 12095000
         BAL   @14,SKIPCMD                                         2279 12096000
*              DO WHILE(MORTOCOM=YES & RISTATUS^=EOFILE &          2280 12097000
*                       RISTATUS^=SKIPREST);                       2280 12098000
*                                                                  2280 12099000
         B     @DE02280                                            2280 12100000
@DL02280 DS    0H                                                  2281 12101000
*                CALL NEXTCHAR;                                    2281 12102000
         BAL   @14,NEXTCHAR                                        2281 12103000
*                CALL SKIPCMD;                                     2282 12104000
*                                                                  2282 12105000
         BAL   @14,SKIPCMD                                         2282 12106000
*              END;                                                2283 12107000
@DE02280 TM    MORTOCOM,B'00010000'                                2283 12108000
         BNO   @DC02280                                            2283 12109000
         LH    @15,RISTATUS                                        2283 12110000
         CH    @15,@CH00118                                        2283 12111000
         BE    @DC02280                                            2283 12112000
         CH    @15,@CH00042                                        2283 12113000
         BNE   @DL02280                                            2283 12114000
@DC02280 DS    0H                                                  2284 12115000
*            END;                                                  2284 12116000
*                                                                  2284 12117000
*        END ERROR1;                                               2285 12118000
@EL00034 DS    0H                                                  2285 12119000
@EF00034 DS    0H                                                  2285 12120000
@ER00034 LM    @14,@12,@SA00034                                    2285 12121000
         BR    @14                                                 2285 12122000
*/********************************************************************/ 12123000
*/*                                                                  */ 12124000
*/*  PROCEDURE NAME - ERROR2                                         */ 12125000
*/*                                                                  */ 12126000
*/*  FUNCTION - THIS ROUTINE HANDLES A SYNTAX OR SEMANTIC ERROR      */ 12127000
*/*             WHICH REQUIRES SKIPPING OF THE CURRENT INPUT COMMAND.*/ 12128000
*/*             THIS TYPE OF ERROR WILL ALLOW SCANNING TO CONTINUE   */ 12129000
*/*             WITH THE NEXT COMMAND.  THE ERROR MESSAGE CONSISTS   */ 12130000
*/*             OF STATIC TEXT WITH AN ITEM FROM THE COMMAND TO HELP */ 12131000
*/*             IDENTIFY THE SOURCE OF THE ERROR.                    */ 12132000
*/*                                                                  */ 12133000
*/*  INPUT -                                                         */ 12134000
*/*          ERRCODE2- ERROR CODE WHICH IDENTIFIES THE ERROR AND     */ 12135000
*/*                    WHICH IS USED AS PART OF THE MESSAGE ID.      */ 12136000
*/*          INSRTLEN- LENGTH OF THE COMMAND ITEM TO BE INSERTED     */ 12137000
*/*                    INTO THE MESSAGE                              */ 12138000
*/*          INSRTPTR- POINTER TO THE COMMAND ITEM TO BE INSERTED    */ 12139000
*/*                    INTO THE MESSAGE.                             */ 12140000
*/*          SCANONLY- FLAG SET 'ON' WHEN CURRENT RECORD IS BEING    */ 12141000
*/*                    SCANNED FOR SYNTAX CHECKING PURPOSES ONLY.    */ 12142000
*/*          SKIPPAST- FLAG SET 'ON' TO SIGNAL THAT CURRENT COMMAND  */ 12143000
*/*                    HAS BEEN SKIPPED.                             */ 12144000
*/*                                                                  */ 12145000
*/*  OUTPUT -                                                        */ 12146000
*/*          PRINTED ERROR MESSAGE.                                  */ 12147000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO THE NON-ZERO */ 12148000
*/*                    ERROR MESSAGE CODE VALUE                      */ 12149000
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */ 12150000
*/*          SCANONLY- SEE 'INPUT'                                   */ 12151000
*/*                                                                  */ 12152000
*/********************************************************************/ 12153000
*ERROR2: PROCEDURE(ERRCODE2,           /*STATIC ERROR MESSAGE ID#    */ 12154000
*                  INSRTLEN,           /*INSERT DATA ITEM LENGTH     */ 12155000
*                  INSRTPTR);          /*INSERT DATA ITEM ADDRESS    */ 12156000
ERROR2   STM   @14,@12,@SA00035                                    2286 12157000
         MVC   @PC00035(12),0(@01)                                 2286 12158000
*        /************************************************************/ 12159000
*        /*                                                          */ 12160000
*        /* ERROR2 PROCEDURE DATA DEFINITIONS                        */ 12161000
*        /*                                                          */ 12162000
*        /************************************************************/ 12163000
*        DCL ERRCODE2 FIXED(31);       /*STATIC ERROR MESSAGE CODE   */ 12164000
*        DCL INSRTLEN FIXED(31);       /*LENGTH OF DATA ITEM TO BE 2288 12165000
*                                        INSERTED INTO ERROR MESSAGE */ 12166000
*        DCL INSRTPTR PTR(31);         /*PTR TO DATA ITEM TO BE    2289 12167000
*                                        INSERTED INTO ERROR MESSAGE */ 12168000
*        /************************************************************/ 12169000
*        /*                                                          */ 12170000
*        /*  ** ERROR2 **  HANDLE SYNTAX OR SEMANTIC ERROR           */ 12171000
*        /*                                                          */ 12172000
*        /************************************************************/ 12173000
*        IF GDTDBG = NULLPTR                                       2290 12174000
*          THEN;                                                   2290 12175000
         L     @01,GDTPTR                                          2290 12176000
         L     @15,GDTDBG(,@01)                                    2290 12177000
         LTR   @15,@15                                             2290 12178000
         BZ    @RT02290                                            2290 12179000
*          ELSE                                                    2292 12180000
*            CALL ICKDB010(GDTTBL,'RIE2');                         2292 12181000
*                                                                  2292 12182000
         L     @15,GDTPTR                                          2292 12183000
         ST    @15,@AL00001                                        2292 12184000
         LA    @14,@CC01295                                        2292 12185000
         ST    @14,@AL00001+4                                      2292 12186000
         MVI   @AL00001+4,X'80'                                    2292 12187000
         L     @15,GDTDBG(,@15)                                    2292 12188000
         LA    @01,@AL00001                                        2292 12189000
         BALR  @14,@15                                             2292 12190000
*        IF SCANONLY=NO                                            2293 12191000
*          THEN                                                    2293 12192000
@RT02290 TM    SCANONLY,B'00010000'                                2293 12193000
         BNZ   @RF02293                                            2293 12194000
*            LASTCC=BADERROR;                                      2294 12195000
         MVC   LASTCC(2),@CH00038                                  2294 12196000
*        RISTATUS=ERRCODE2;                                        2295 12197000
@RF02293 L     @15,@PC00035                                        2295 12198000
         L     @15,ERRCODE2(,@15)                                  2295 12199000
         STH   @15,RISTATUS                                        2295 12200000
*        DARGDBP=INSRTPTR;                                         2296 12201000
         L     @14,DDSTRU                                          2296 12202000
         L     @05,@PC00035+8                                      2296 12203000
         MVC   DARGDBP(4,@14),INSRTPTR(@05)                        2296 12204000
*        DARGILP=INSRTLEN;                                         2297 12205000
         L     @05,@PC00035+4                                      2297 12206000
         MVC   DARGILP(2,@14),INSRTLEN+2(@05)                      2297 12207000
*        DARGSMOD=RISTID;                                          2298 12208000
         MVC   DARGSMOD(3,@14),RISTID                              2298 12209000
*        DARGSENT=ERRCODE2;                                        2299 12210000
*                                                                  2299 12211000
         STC   @15,DARGSENT(,@14)                                  2299 12212000
*        CALL ICKTPPR0(GDTTBL,PRTFILE,DDSTRU);                     2300 12213000
*                                                                  2300 12214000
         L     @15,GDTPTR                                          2300 12215000
         ST    @15,@AL00001                                        2300 12216000
         LA    @14,@CF00102                                        2300 12217000
         ST    @14,@AL00001+4                                      2300 12218000
         LA    @14,DDSTRU                                          2300 12219000
         ST    @14,@AL00001+8                                      2300 12220000
         MVI   @AL00001+8,X'80'                                    2300 12221000
         L     @15,GDTPRT(,@15)                                    2300 12222000
         LA    @01,@AL00001                                        2300 12223000
         BALR  @14,@15                                             2300 12224000
*        /************************************************************/ 12225000
*        /*                                                          */ 12226000
*        /* SCAN UP TO THE NEXT COMMAND FOLLOWING THE COMMAND THAT   */ 12227000
*        /* CONTAINS THE ERROR, IF THIS HAS NOT ALREADY BEEN DONE.   */ 12228000
*        /*                                                          */ 12229000
*        /************************************************************/ 12230000
*        IF SKIPPAST=NO                                            2301 12231000
*          THEN                                                    2301 12232000
         TM    SKIPPAST,B'00001000'                                2301 12233000
         BNZ   @RF02301                                            2301 12234000
*            DO;                                                   2302 12235000
*                                                                  2302 12236000
*              CALL SKIPCMD;                                       2303 12237000
*                                                                  2303 12238000
         BAL   @14,SKIPCMD                                         2303 12239000
*              DO WHILE(MORTOCOM=YES & RISTATUS^=EOFILE &          2304 12240000
*                       RISTATUS^=SKIPREST);                       2304 12241000
*                                                                  2304 12242000
         B     @DE02304                                            2304 12243000
@DL02304 DS    0H                                                  2305 12244000
*                CALL NEXTCHAR;                                    2305 12245000
         BAL   @14,NEXTCHAR                                        2305 12246000
*                CALL SKIPCMD;                                     2306 12247000
*                                                                  2306 12248000
         BAL   @14,SKIPCMD                                         2306 12249000
*              END;                                                2307 12250000
@DE02304 TM    MORTOCOM,B'00010000'                                2307 12251000
         BNO   @DC02304                                            2307 12252000
         LH    @15,RISTATUS                                        2307 12253000
         CH    @15,@CH00118                                        2307 12254000
         BE    @DC02304                                            2307 12255000
         CH    @15,@CH00042                                        2307 12256000
         BNE   @DL02304                                            2307 12257000
@DC02304 DS    0H                                                  2308 12258000
*            END;                                                  2308 12259000
*                                                                  2308 12260000
*        END ERROR2;                                               2309 12261000
*                                                                  2309 12262000
*                                                                  2309 12263000
@EL00035 DS    0H                                                  2309 12264000
@EF00035 DS    0H                                                  2309 12265000
@ER00035 LM    @14,@12,@SA00035                                    2309 12266000
         BR    @14                                                 2309 12267000
*        END ICKRI01                                               2310 12268000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 12269000
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        * 12270000
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        * 12271000
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        * 12272000
*/*%INCLUDE SYSLIB  (DMSDF05 )                                        * 12273000
*/*%INCLUDE SYSLIB  (DMSDF06 )                                        * 12274000
*;                                                                 2310 12275000
@DATA    DS    0H                                                       12276000
@CH00260 DC    H'5'                                                     12277000
@CH00043 DC    H'7'                                                     12278000
@CH00274 DC    H'16'                                                    12279000
@CH00298 DC    H'28'                                                    12280000
@CH00300 DC    H'29'                                                    12281000
@CH00302 DC    H'30'                                                    12282000
@CH00054 DC    H'31'                                                    12283000
@CH00218 DC    H'32'                                                    12284000
@CH00306 DC    H'33'                                                    12285000
@CH00860 DC    H'38'                                                    12286000
@CH01296 DC    H'66'                                                    12287000
@CH00800 DC    H'72'                                                    12288000
@CH00118 DC    H'100'                                                   12289000
@CH00681 DC    H'255'                                                   12290000
@CH01070 DC    H'-1'                                                    12291000
@SM01319 MVC   DATABLK(0,@14),DATABLK(@03)                              12292000
@SM01324 MVC   0(0,@14),SYNUNIT                                         12293000
@SC01326 CLC   RELATION(0),MAXCCSYM(@15)                                12294000
@SC01328 CLC   RELATION(0),LSTCCSYM(@15)                                12295000
@SM01330 MVC   SYNUNIT(0),0(@01)                                        12296000
@SM01332 MVC   RELOPER(0),0(@01)                                        12297000
@SC01338 CLC   KWDITEM(0,@15),SYNUNIT                                   12298000
@SM01341 MVC   CHARS(0,@14),SYNUNIT                                     12299000
@SM01343 MVC   STRING(0,@15),SYNUNIT                                    12300000
@SM01345 MVC   LCHAR(0,@14),SYNUNIT                                     12301000
@SM01347 MVC   LSTRING(0,@15),SYNUNIT                                   12302000
@SM01351 MVC   CNVRTFLD(0),SYNUNIT                                      12303000
@SM01353 MVC   0(0,@14),CNVRTFLD                                        12304000
@SM01355 MVC   STRING+1(0,@05),DATABLK(@04)                             12305000
@SM01357 MVC   STRING(0,@01),SYNUNIT                                    12306000
@SM01359 MVC   LSTRING+1(0,@15),DATABLK(@14)                            12307000
@SM01363 MVC   LMEMNAME-14(0,@14),0(@01)                                12308000
@SM01365 MVC   MEMNAME(0,@15),0(@01)                                    12309000
@SM01370 MVC   LDSNAME-23(0,@14),SYNUNIT                                12310000
@SM01372 MVC   DSNAME(0,@14),SYNUNIT                                    12311000
@SM01374 MVC   DATABLK(0,@05),DATABLK(@03)                              12312000
@SM01377 MVC   SYNUNIT(0),DEFLTVAL+2(@15)                               12313000
@SM01379 MVC   SYNUNIT(0),DEFLTVAL(@15)                                 12314000
@SM01381 MVC   ERRFIELD(0),KWDITEM(@15)                                 12315000
@SM01383 MVC   ERRFIELD(0),SYNUNIT                                      12316000
@SM01385 MVC   0(0,@04),SYNUNIT                                         12317000
         DS    0F                                                       12318000
@AL00419 EQU   *                       LIST WITH   1 ARGUMENT(S)        12319000
@AL00574 EQU   *                       LIST WITH   1 ARGUMENT(S)        12320000
@AL00576 EQU   *                       LIST WITH   1 ARGUMENT(S)        12321000
@AL00669 EQU   *                       LIST WITH   1 ARGUMENT(S)        12322000
@AL00685 EQU   *                       LIST WITH   1 ARGUMENT(S)        12323000
@AL00771 EQU   *                       LIST WITH   1 ARGUMENT(S)        12324000
@AL00839 EQU   *                       LIST WITH   1 ARGUMENT(S)        12325000
@AL00845 EQU   *                       LIST WITH   1 ARGUMENT(S)        12326000
@AL00886 EQU   *                       LIST WITH   1 ARGUMENT(S)        12327000
@AL00917 EQU   *                       LIST WITH   1 ARGUMENT(S)        12328000
@AL00975 EQU   *                       LIST WITH   1 ARGUMENT(S)        12329000
@AL00980 EQU   *                       LIST WITH   1 ARGUMENT(S)        12330000
@AL01006 EQU   *                       LIST WITH   1 ARGUMENT(S)        12331000
@AL01035 EQU   *                       LIST WITH   1 ARGUMENT(S)        12332000
@AL01607 DC    A(@CB00475)             LIST WITH   1 ARGUMENT(S)        12333000
@AL00512 EQU   *                       LIST WITH   1 ARGUMENT(S)        12334000
@AL00532 EQU   *                       LIST WITH   1 ARGUMENT(S)        12335000
@AL00667 EQU   *                       LIST WITH   1 ARGUMENT(S)        12336000
@AL00992 EQU   *                       LIST WITH   1 ARGUMENT(S)        12337000
@AL01020 EQU   *                       LIST WITH   1 ARGUMENT(S)        12338000
@AL01048 EQU   *                       LIST WITH   1 ARGUMENT(S)        12339000
@AL01111 EQU   *                       LIST WITH   1 ARGUMENT(S)        12340000
@AL01117 EQU   *                       LIST WITH   1 ARGUMENT(S)        12341000
@AL01128 EQU   *                       LIST WITH   1 ARGUMENT(S)        12342000
@AL01134 EQU   *                       LIST WITH   1 ARGUMENT(S)        12343000
@AL01583 EQU   *                       LIST WITH   1 ARGUMENT(S)        12344000
@AL01652 DC    A(@CB00473)             LIST WITH   1 ARGUMENT(S)        12345000
@AL00525 EQU   *                       LIST WITH   2 ARGUMENT(S)        12346000
@AL02041 DC    A(@CF00127)             LIST WITH   2 ARGUMENT(S)        12347000
         DC    A(@CF00172)                                              12348000
@AL00551 EQU   *                       LIST WITH   2 ARGUMENT(S)        12349000
@AL00575 EQU   *                       LIST WITH   1 ARGUMENT(S)        12350000
@AL00668 EQU   *                       LIST WITH   1 ARGUMENT(S)        12351000
@AL00684 EQU   *                       LIST WITH   1 ARGUMENT(S)        12352000
@AL00770 EQU   *                       LIST WITH   1 ARGUMENT(S)        12353000
@AL00838 EQU   *                       LIST WITH   1 ARGUMENT(S)        12354000
@AL00844 EQU   *                       LIST WITH   1 ARGUMENT(S)        12355000
@AL00885 DC    A(@CF00172)             LIST WITH   1 ARGUMENT(S)        12356000
@AL00673 EQU   *                       LIST WITH   2 ARGUMENT(S)        12357000
@AL02032 DC    A(@CF00282)             LIST WITH   2 ARGUMENT(S)        12358000
         DC    A(@CF00282)                                              12359000
@AL00977 DC    A(@CF00041)             LIST WITH   2 ARGUMENT(S)        12360000
         DC    A(@CF00282)                                              12361000
@AL00989 EQU   *                       LIST WITH   2 ARGUMENT(S)        12362000
@AL01045 DC    A(@CF00040)             LIST WITH   2 ARGUMENT(S)        12363000
         DC    A(@CF00282)                                              12364000
@AL01022 EQU   *                       LIST WITH   2 ARGUMENT(S)        12365000
@AL01991 DC    A(@CF00038)             LIST WITH   2 ARGUMENT(S)        12366000
         DC    A(@CF00282)                                              12367000
@AL01051 DC    A(@CF00269)             LIST WITH   2 ARGUMENT(S)        12368000
         DC    A(@CF00282)                                              12369000
@AL01090 DC    A(@CF00174)             LIST WITH   1 ARGUMENT(S)        12370000
@AL01110 DC    A(@CF00144)             LIST WITH   1 ARGUMENT(S)        12371000
@AL01120 EQU   *                       LIST WITH   2 ARGUMENT(S)        12372000
@AL01137 EQU   *                       LIST WITH   2 ARGUMENT(S)        12373000
@AL00492 EQU   *                       LIST WITH   1 ARGUMENT(S)        12374000
@AL01527 EQU   *                       LIST WITH   1 ARGUMENT(S)        12375000
@AL01557 EQU   *                       LIST WITH   1 ARGUMENT(S)        12376000
@AL01632 DC    A(@CF00278)             LIST WITH   1 ARGUMENT(S)        12377000
         DC    A(@CF00282)                                              12378000
@AL01158 EQU   *                       LIST WITH   2 ARGUMENT(S)        12379000
@AL01475 EQU   *                       LIST WITH   2 ARGUMENT(S)        12380000
@AL01127 DC    A(@CF00052)             LIST WITH   1 ARGUMENT(S)        12381000
         DC    A(@CF00282)                                              12382000
@AL01166 EQU   *                       LIST WITH   2 ARGUMENT(S)        12383000
@AL01181 EQU   *                       LIST WITH   2 ARGUMENT(S)        12384000
@AL01221 EQU   *                       LIST WITH   2 ARGUMENT(S)        12385000
@AL01246 EQU   *                       LIST WITH   2 ARGUMENT(S)        12386000
@AL01273 EQU   *                       LIST WITH   2 ARGUMENT(S)        12387000
@AL01310 EQU   *                       LIST WITH   2 ARGUMENT(S)        12388000
@AL01376 EQU   *                       LIST WITH   2 ARGUMENT(S)        12389000
@AL01938 EQU   *                       LIST WITH   2 ARGUMENT(S)        12390000
@AL01969 EQU   *                       LIST WITH   2 ARGUMENT(S)        12391000
@AL02015 EQU   *                       LIST WITH   2 ARGUMENT(S)        12392000
@AL00929 DC    A(@CF00124)             LIST WITH   1 ARGUMENT(S)        12393000
         DC    A(@CF00282)                                              12394000
@AL01205 DC    A(@CF00290)             LIST WITH   2 ARGUMENT(S)        12395000
         DC    A(@CF00282)                                              12396000
@AL01279 EQU   *                       LIST WITH   2 ARGUMENT(S)        12397000
@AL01327 EQU   *                       LIST WITH   2 ARGUMENT(S)        12398000
@AL01339 EQU   *                       LIST WITH   2 ARGUMENT(S)        12399000
@AL01351 EQU   *                       LIST WITH   2 ARGUMENT(S)        12400000
@AL01934 DC    A(@CF00284)             LIST WITH   2 ARGUMENT(S)        12401000
         DC    A(@CF00282)                                              12402000
@AL01368 EQU   *                       LIST WITH   2 ARGUMENT(S)        12403000
@AL01936 DC    A(@CF00286)             LIST WITH   2 ARGUMENT(S)        12404000
         DC    A(@CF00282)                                              12405000
@AL01611 DC    A(@CF00280)             LIST WITH   1 ARGUMENT(S)        12406000
@AL01666 DC    A(@CF00039)             LIST WITH   1 ARGUMENT(S)        12407000
@AL01910 DC    A(@CF00271)             LIST WITH   2 ARGUMENT(S)        12408000
         DC    A(@CF00282)                                              12409000
@DATD    DSECT                                                          12410000
         DS    0F                                                       12411000
@SA00001 DS    18F                                                      12412000
@PC00001 DS    6F                                                       12413000
@SA00002 DS    15F                                                      12414000
@SA00003 DS    15F                                                      12415000
@SA00004 DS    15F                                                      12416000
@SA00029 DS    15F                                                      12417000
@PC00029 DS    1F                                                       12418000
@SA00034 DS    15F                                                      12419000
@PC00034 DS    1F                                                       12420000
@SA00035 DS    15F                                                      12421000
@PC00035 DS    3F                                                       12422000
@SA00021 DS    15F                                                      12423000
@SA00023 DS    15F                                                      12424000
@SA00030 DS    15F                                                      12425000
@SA00025 DS    15F                                                      12426000
@SA00009 DS    15F                                                      12427000
@SA00010 DS    15F                                                      12428000
@SA00020 DS    15F                                                      12429000
@SA00028 DS    15F                                                      12430000
@PC00028 DS    1F                                                       12431000
@SA00006 DS    15F                                                      12432000
@SA00005 DS    15F                                                      12433000
@SA00008 DS    15F                                                      12434000
@SA00007 DS    15F                                                      12435000
@SA00027 DS    15F                                                      12436000
@SA00026 DS    15F                                                      12437000
@SA00011 DS    15F                                                      12438000
@SA00033 DS    15F                                                      12439000
@PC00033 DS    1F                                                       12440000
@SA00013 DS    15F                                                      12441000
@SA00012 DS    15F                                                      12442000
@SA00014 DS    15F                                                      12443000
@SA00018 DS    15F                                                      12444000
@SA00015 DS    15F                                                      12445000
@SA00016 DS    15F                                                      12446000
@SA00019 DS    15F                                                      12447000
@SA00017 DS    15F                                                      12448000
@SA00022 DS    15F                                                      12449000
@PC00022 DS    1F                                                       12450000
@SA00024 DS    15F                                                      12451000
@PC00024 DS    2F                                                       12452000
@SA00031 DS    15F                                                      12453000
@SA00032 DS    15F                                                      12454000
@AL00001 DS    5A                                                       12455000
@TF00001 DS    F                                                        12456000
@AFTEMPS DS    13F                                                      12457000
@ZTEMPS  DS    0F                                                       12458000
@ZT00003 DC    F'0'                                                     12459000
@ZTEMPND EQU   *                                                        12460000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         12461000
ICKRI01  CSECT                                                          12462000
         DS    0F                                                       12463000
@CF00102 DC    F'0'                                                     12464000
@CH00102 EQU   @CF00102+2                                               12465000
@CF00172 DC    F'1'                                                     12466000
@CH00172 EQU   @CF00172+2                                               12467000
@CF00124 DC    F'2'                                                     12468000
@CH00124 EQU   @CF00124+2                                               12469000
@CF00144 DC    F'3'                                                     12470000
@CH00144 EQU   @CF00144+2                                               12471000
@CF00052 DC    F'4'                                                     12472000
@CH00052 EQU   @CF00052+2                                               12473000
@CF00127 DC    F'6'                                                     12474000
@CH00127 EQU   @CF00127+2                                               12475000
@CF00042 DC    F'8'                                                     12476000
@CH00042 EQU   @CF00042+2                                               12477000
@CF00041 DC    F'9'                                                     12478000
@CF00040 DC    F'10'                                                    12479000
@CH00040 EQU   @CF00040+2                                               12480000
@CF00039 DC    F'11'                                                    12481000
@CF00038 DC    F'12'                                                    12482000
@CH00038 EQU   @CF00038+2                                               12483000
@CF00269 DC    F'13'                                                    12484000
@CF00271 DC    F'14'                                                    12485000
@CF00174 DC    F'15'                                                    12486000
@CF00278 DC    F'18'                                                    12487000
@CH00278 EQU   @CF00278+2                                               12488000
@CF00280 DC    F'19'                                                    12489000
@CF00282 DC    F'20'                                                    12490000
@CH00282 EQU   @CF00282+2                                               12491000
@CF00284 DC    F'21'                                                    12492000
@CH00284 EQU   @CF00284+2                                               12493000
@CF00286 DC    F'22'                                                    12494000
@CF00290 DC    F'24'                                                    12495000
@CF00294 DC    F'26'                                                    12496000
@CF00296 DC    F'27'                                                    12497000
@CF01297 DC    F'36'                                                    12498000
@CF00685 DC    F'48'                                                    12499000
@CF01349 DC    F'-64'                                                   12500000
@CF01350 DC    F'-63'                                                   12501000
@CF01367 DC    F'-55'                                                   12502000
@CF01361 DC    F'-53'                                                   12503000
@CF01362 DC    F'-52'                                                   12504000
@CF01368 DC    F'-44'                                                   12505000
@CF01369 DC    F'-43'                                                   12506000
@CF01317 DC    F'-12'                                                   12507000
@CF01376 DC    F'-8'                                                    12508000
@CF01318 DC    F'-4'                                                    12509000
@DATD    DSECT                                                          12510000
         DS    0D                                                       12511000
LISTSCAN DS    A                                                        12512000
IOCSPTR  DS    A                                                        12513000
OPNPTR   DS    A                                                        12514000
DDSTRU   DS    A                                                        12515000
FSADDR   DS    A                                                        12516000
DMPINDEX DS    A                                                        12517000
GRPPTR   DS    A                                                        12518000
KWDPTR   DS    A                                                        12519000
DATAPTR  DS    A                                                        12520000
PTRLOC   DS    A                                                        12521000
ARRYPTR  DS    A                                                        12522000
AMTTOGET DS    F                                                        12523000
BLKLEFT  DS    F                                                        12524000
BLKPTR   DS    A                                                        12525000
GDTPTR   DS    A                                                        12526000
WORKPTR2 DS    A                                                        12527000
WORKPTR3 DS    A                                                        12528000
SETUPERR DS    F                                                        12529000
ELTPTR   DS    A                                                        12530000
WORKVAL  DS    F                                                        12531000
OLDPTR   DS    A                                                        12532000
FREEPTR  DS    A                                                        12533000
NEWPTR   DS    A                                                        12534000
SUBOCCUR DS    F                                                        12535000
DEFLTPTR DS    A                                                        12536000
LISTPTR  DS    A                                                        12537000
TESTRC   DS    H                                                        12538000
PARMID   DS    H                                                        12539000
TESTID   DS    H                                                        12540000
ARRYDSPL DS    H                                                        12541000
REPNEST  DS    H                                                        12542000
VECTRNUM DS    H                                                        12543000
UNITINDX DS    H                                                        12544000
SCLRCNT  DS    H                                                        12545000
PWORD    DS    H                                                        12546000
PARMLVL  DS    H                                                        12547000
REPDEPTH DS    H                                                        12548000
SPACELFT DS    H                                                        12549000
SPACEAMT DS    H                                                        12550000
INDEX    DS    H                                                        12551000
INDEX2   DS    H                                                        12552000
INDEX3   DS    H                                                        12553000
LISTINDX DS    H                                                        12554000
HWORDARG DS    H                                                        12555000
RELSIZE  DS    H                                                        12556000
PART1LEN DS    H                                                        12557000
CCVALUE  DS    H                                                        12558000
DIGITPOS DS    H                                                        12559000
SUBTOTAL DS    H                                                        12560000
WORKVAR1 DS    H                                                        12561000
TWOPOWER DS    H                                                        12562000
DIGTINDX DS    H                                                        12563000
SEGSTART DS    H                                                        12564000
SEGEND   DS    H                                                        12565000
SEGLEN   DS    H                                                        12566000
MOVELEN  DS    H                                                        12567000
AMTUSED  DS    H                                                        12568000
WORKVAR2 DS    H                                                        12569000
WORKVAR3 DS    H                                                        12570000
PARENCNT DS    H                                                        12571000
FACTOR   DS    H                                                        12572000
DATALEN  DS    H                                                        12573000
SETRC    DS    H                                                        12574000
CNVRTVAL DS    FL1                                                      12575000
STARLOC  DS    FL1                                                      12576000
LISTLN   DS    FL1                                                      12577000
@TS00001 DS    CL95                                                     12578000
COMMAREA DS    CL55                                                     12579000
         ORG   COMMAREA                                                 12580000
RECRDPTR DS    AL4                                                      12581000
FDTADDR  DS    AL4                                                      12582000
DESCPTR  DS    AL4                                                      12583000
WORKPTR  DS    AL4                                                      12584000
RISTATUS DS    FL2                                                      12585000
SCANINDX DS    FL2                                                      12586000
SCNLIMIT DS    FL2                                                      12587000
LASTCC   DS    FL2                                                      12588000
MAXCC    DS    FL2                                                      12589000
FSRLNAME DS    CL8                                                      12590000
POOLID   DS    CL4                                                      12591000
VERBNAME DS    CL8                                                      12592000
DESCNAME DS    CL8                                                      12593000
GOODCMD  DS    BL1                                                      12594000
EOFOK    EQU   COMMAREA+54                                              12595000
OPTSFLAG EQU   COMMAREA+54                                              12596000
SCANONLY EQU   COMMAREA+54                                              12597000
SKIPPAST EQU   COMMAREA+54                                              12598000
@NM00018 EQU   COMMAREA+54                                              12599000
         ORG   COMMAREA+55                                              12600000
         DS    CL1                                                      12601000
RIPOOLID DS    CL4                                                      12602000
         ORG   RIPOOLID                                                 12603000
VLISTID1 DS    CL2                                                      12604000
VLISTID  DS    FL2                                                      12605000
         ORG   RIPOOLID+4                                               12606000
ORGSIGN  DS    CL1                                                      12607000
         DS    CL3                                                      12608000
SYNUNIT  DS    CL255                                                    12609000
BLANKFLD DS    CL10                                                     12610000
ERRFIELD DS    CL20                                                     12611000
CHAR1    DS    CL1                                                      12612000
CHAR2    DS    CL1                                                      12613000
         DS    CL5                                                      12614000
CNVRTFLD DS    CL10                                                     12615000
SCANSWS  DS    CL2                                                      12616000
         ORG   SCANSWS                                                  12617000
PWORDSW  DS    BL1                                                      12618000
COMMENT  EQU   SCANSWS+0                                                12619000
INCOMM   EQU   SCANSWS+0                                                12620000
MORTOCOM EQU   SCANSWS+0                                                12621000
CONTNEXT EQU   SCANSWS+0                                                12622000
FIRSTCHR EQU   SCANSWS+0                                                12623000
FINALCHR EQU   SCANSWS+0                                                12624000
JUSTONE  EQU   SCANSWS+0                                                12625000
ENDPAREN DS    BL1                                                      12626000
NULLCMD  EQU   SCANSWS+1                                                12627000
FOUND    EQU   SCANSWS+1                                                12628000
SUBSYET  EQU   SCANSWS+1                                                12629000
DELIM    EQU   SCANSWS+1                                                12630000
         ORG   SCANSWS+2                                                12631000
OPENAREA DS    BL32                                                     12632000
PRNTAREA DS    BL20                                                     12633000
STMTEND  DS    BL1                                                      12634000
RELATION DS    CL32                                                     12635000
@NM00046 DS    CL1                                                      12636000
         ORG   @NM00046                                                 12637000
NONMODAL DS    BL1                                                      12638000
REDOLVL0 EQU   @NM00046+0                                               12639000
EXPREND  EQU   @NM00046+0                                               12640000
SINGLCMD EQU   @NM00046+0                                               12641000
IFNEXT   EQU   @NM00046+0                                               12642000
GETVERB  EQU   @NM00046+0                                               12643000
         ORG   @NM00046+1                                               12644000
RELOPER  DS    CL2                                                      12645000
KWDMATCH DS    BL1                                                      12646000
ENDVALUE DS    BL1                                                      12647000
CHSTRING DS    BL1                                                      12648000
MEMBIT   DS    BL1                                                      12649000
ONESTAR  DS    BL1                                                      12650000
WITHMEM  DS    BL1                                                      12651000
DFLTOK   DS    BL1                                                      12652000
FOUNDONE DS    BL1                                                      12653000
SKIPDONE DS    BL1                                                      12654000
COMMASW  DS    BL1                                                      12655000
ENDFOUND DS    BL1                                                      12656000
SKIPLEAD DS    BL1                                                      12657000
PRMFOUND DS    BL1                                                      12658000
         DS    CL1                                                      12659000
SUPERID  DS    10H                                                      12660000
PPARMCNT DS    10H                                                      12661000
REPCOUNT DS    3H                                                       12662000
REPLIMIT DS    3H                                                       12663000
ONEREP   DS    3BL1                                                     12664000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                12665000
@ENDDATD EQU   *                                                        12666000
ICKRI01  CSECT                                                          12667000
         DS    0F                                                       12668000
@SIZDATD DC    AL1(0)                                                   12669000
         DC    AL3(@ENDDATD-@DATD)                                      12670000
@CV00513 DC    V(ICKRI02)                                               12671000
@CV00514 DC    V(ICKRI03)                                               12672000
         DS    0D                                                       12673000
VECTRLEN DC    AL2(4*9-4)                                               12674000
@CC00674 DC    C'2147483647'                                            12675000
@CC00153 DC    C'ZERO'                                                  12676000
@CC00706 DC    C'RI01'                                                  12677000
@CC00787 DC    C'RIEX'                                                  12678000
@CC00815 DC    C'RISC'                                                  12679000
@CC00836 DC    C'RI02'                                                  12680000
@CC00842 DC    C'RI03'                                                  12681000
@CC00868 DC    C'RIGN'                                                  12682000
@CC00878 DC    C'RI04'                                                  12683000
@CC00881 DC    C'RI05'                                                  12684000
@CC00885 DC    C'RIMS'                                                  12685000
@CC00917 DC    C'RIMI'                                                  12686000
@CC00927 DC    C'RIME'                                                  12687000
@CC00931 DC    C'RIBT'                                                  12688000
@CC00941 DC    C'RI09'                                                  12689000
@CC00956 DC    C'RIPP'                                                  12690000
@CC00965 DC    C'RI11'                                                  12691000
@CC00968 DC    C'RI12'                                                  12692000
@CC00976 DC    C'RIGQ'                                                  12693000
@CC01062 DC    C'RICV'                                                  12694000
@CC01067 DC    C'RI24'                                                  12695000
@CC01073 DC    C'RI27'                                                  12696000
@CC01076 DC    C'RI30'                                                  12697000
@CC01102 DC    C'RIID'                                                  12698000
@CC01111 DC    C'RINS'                                                  12699000
@CC01125 DC    C'RIMC'                                                  12700000
@CC01133 DC    C'RIIR'                                                  12701000
@CC01134 DC    C'RI35'                                                  12702000
@CC01145 DC    C'RI36'                                                  12703000
@CC01149 DC    C'RIDF'                                                  12704000
@CC01171 DC    C'RIST'                                                  12705000
@CC01174 DC    C'RI44'                                                  12706000
@CC01178 DC    C'RI45'                                                  12707000
@CC01186 DC    C'RINN'                                                  12708000
@CC01213 DC    C'RISK'                                                  12709000
@CC01217 DC    C'RISF'                                                  12710000
@CC01222 DC    C'RIPC'                                                  12711000
@CC01230 DC    C'RI49'                                                  12712000
@CC01231 DC    C'RI50'                                                  12713000
@CC01234 DC    C'RI51'                                                  12714000
@CC01245 DC    C'RI56'                                                  12715000
@CC01248 DC    C'RI57'                                                  12716000
@CC01252 DC    C'RI59'                                                  12717000
@CC01256 DC    C'RIGR'                                                  12718000
@CC01263 DC    C'RISE'                                                  12719000
@CC01266 DC    C'RI60'                                                  12720000
@CC01269 DC    C'RI61'                                                  12721000
@CC01270 DC    C'RI62'                                                  12722000
@CC01277 DC    C'RICK'                                                  12723000
@CC01278 DC    C'RI66'                                                  12724000
@CC01284 DC    C'RIE1'                                                  12725000
@CC01295 DC    C'RIE2'                                                  12726000
@CC01285 DC    C'UV0'                                                   12727000
@CC00788 EQU   @CC00706                                                 12728000
@CC00853 DC    C'EQ'                                                    12729000
@CC00900 DC    C'GT'                                                    12730000
@CC00904 DC    C'LT'                                                    12731000
@CC00906 DC    C'^='                                                    12732000
@CC00908 DC    C'NE'                                                    12733000
@CC00910 DC    C'>='                                                    12734000
@CC00912 DC    C'GE'                                                    12735000
@CC00914 DC    C'<='                                                    12736000
@CC00916 DC    C'LE'                                                    12737000
@CB00473 DC    B'10000000'                                              12738000
@CB00475 DC    B'00000000'                                              12739000
COMSTART DC    CL2'/*'                                                  12740000
COMEND   DC    CL2'*/'                                                  12741000
MODID    DC    CL4'RI01'                                                12742000
FIXAREA  DS    CL1024                                                   12743000
         ORG   FIXAREA                                                  12744000
@NM00038 DS    CL256                                                    12745000
         ORG   @NM00038                                                 12746000
@NM00039 DC    256X'00'                                                 12747000
         ORG   FIXAREA+256                                              12748000
@NM00040 DS    CL256                                                    12749000
         ORG   @NM00040                                                 12750000
@NM00041 DC    256X'00'                                                 12751000
         ORG   FIXAREA+512                                              12752000
@NM00042 DS    CL256                                                    12753000
         ORG   @NM00042                                                 12754000
@NM00043 DC    256X'00'                                                 12755000
         ORG   FIXAREA+768                                              12756000
@NM00044 DS    CL256                                                    12757000
         ORG   @NM00044                                                 12758000
@NM00045 DC    256X'00'                                                 12759000
         ORG   FIXAREA+1024                                             12760000
LTBLNAME DC    CL8'ICKRILT '                                            12761000
KTBLNAME DC    CL8'ICKRIKT '                                            12762000
TWLVZERO DS    CL1                                                      12763000
         ORG   TWLVZERO                                                 12764000
@NM00055 DC    XL1'C0'                                                  12765000
         ORG   TWLVZERO+1                                               12766000
HEXTABLE DC    CL1'0'                                                   12767000
         DC    CL1'1'                                                   12768000
         DC    CL1'2'                                                   12769000
         DC    CL1'3'                                                   12770000
         DC    CL1'4'                                                   12771000
         DC    CL1'5'                                                   12772000
         DC    CL1'6'                                                   12773000
         DC    CL1'7'                                                   12774000
         DC    CL1'8'                                                   12775000
         DC    CL1'9'                                                   12776000
         DC    CL1'A'                                                   12777000
         DC    CL1'B'                                                   12778000
         DC    CL1'C'                                                   12779000
         DC    CL1'D'                                                   12780000
         DC    CL1'E'                                                   12781000
         DC    CL1'F'                                                   12782000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       12783000
@01      EQU   01                                                       12784000
@02      EQU   02                                                       12785000
@03      EQU   03                                                       12786000
@04      EQU   04                                                       12787000
@05      EQU   05                                                       12788000
@06      EQU   06                                                       12789000
@07      EQU   07                                                       12790000
@08      EQU   08                                                       12791000
@09      EQU   09                                                       12792000
@10      EQU   10                                                       12793000
@11      EQU   11                                                       12794000
@12      EQU   12                                                       12795000
@13      EQU   13                                                       12796000
@14      EQU   14                                                       12797000
@15      EQU   15                                                       12798000
RTNREG   EQU   @15                                                      12799000
CVBNUM   EQU   @08                                                      12800000
REG0     EQU   @00                                                      12801000
REG1     EQU   @01                                                      12802000
REG10    EQU   @10                                                      12803000
REG11    EQU   @11                                                      12804000
REG12    EQU   @12                                                      12805000
REG13    EQU   @13                                                      12806000
REG14    EQU   @14                                                      12807000
REG15    EQU   @15                                                      12808000
REG2     EQU   @02                                                      12809000
REG3     EQU   @03                                                      12810000
REG4     EQU   @04                                                      12811000
REG5     EQU   @05                                                      12812000
REG6     EQU   @06                                                      12813000
REG7     EQU   @07                                                      12814000
REG8     EQU   @08                                                      12815000
REG9     EQU   @09                                                      12816000
GDTTBL   EQU   0                                                        12817000
GDTPRM   EQU   GDTTBL+4                                                 12818000
GDTTR1   EQU   GDTTBL+8                                                 12819000
GDTTR2   EQU   GDTTBL+12                                                12820000
GDTRIH   EQU   GDTTBL+24                                                12821000
GDTDIN   EQU   GDTTBL+44                                                12822000
GDTDOP   EQU   GDTTBL+48                                                12823000
GDTDBG   EQU   GDTTBL+52                                                12824000
GDTDVO   EQU   GDTTBL+56                                                12825000
GDTPRT   EQU   GDTTBL+60                                                12826000
GDTESS   EQU   GDTTBL+64                                                12827000
GDTESA   EQU   GDTTBL+68                                                12828000
GDTRST   EQU   GDTTBL+72                                                12829000
GDTRES   EQU   GDTTBL+76                                                12830000
GDTCAL   EQU   GDTTBL+80                                                12831000
GDTGSP   EQU   GDTTBL+84                                                12832000
GDTFSP   EQU   GDTTBL+88                                                12833000
GDTGPL   EQU   GDTTBL+92                                                12834000
GDTFPL   EQU   GDTTBL+96                                                12835000
GDTLOD   EQU   GDTTBL+100                                               12836000
GDTDEL   EQU   GDTTBL+104                                               12837000
GDTPRL   EQU   GDTTBL+108                                               12838000
GDTEPL   EQU   GDTTBL+112                                               12839000
GDTTIM   EQU   GDTTBL+116                                               12840000
GDTIIO   EQU   GDTTBL+120                                               12841000
GDTTIO   EQU   GDTTBL+124                                               12842000
GDTOPN   EQU   GDTTBL+136                                               12843000
GDTCLS   EQU   GDTTBL+140                                               12844000
GDTGET   EQU   GDTTBL+144                                               12845000
GDTPUT   EQU   GDTTBL+148                                               12846000
GDTSNP   EQU   GDTTBL+160                                               12847000
GDTWTO   EQU   GDTTBL+168                                               12848000
GDTSCR   EQU   GDTTBL+172                                               12849000
GDTVCK   EQU   GDTTBL+176                                               12850000
GDTDVC   EQU   GDTTBL+180                                               12851000
GDTSTE   EQU   GDTTBL+188                                               12852000
ICKSALD0 EQU   0                                                        12853000
ICKSAEP0 EQU   0                                                        12854000
ICKSAGS0 EQU   0                                                        12855000
ICKSAFS0 EQU   0                                                        12856000
ICKSAGP0 EQU   0                                                        12857000
ICKSAFP0 EQU   0                                                        12858000
TRACE1   EQU   0                                                        12859000
OLDERID1 EQU   TRACE1                                                   12860000
TRACE2   EQU   0                                                        12861000
OLDERID2 EQU   TRACE2                                                   12862000
NEWID2   EQU   TRACE2+95                                                12863000
NEWERID2 EQU   5                                                        12864000
STAEPARM EQU   0                                                        12865000
STAEPFX  EQU   STAEPARM                                                 12866000
ICKIOOP0 EQU   0                                                        12867000
ICKIOGT0 EQU   0                                                        12868000
IOCSTR   EQU   0                                                        12869000
IOCDAD   EQU   IOCSTR                                                   12870000
IOCDLN   EQU   IOCSTR+4                                                 12871000
IOCDSO   EQU   IOCSTR+13                                                12872000
IOCRFM   EQU   IOCSTR+14                                                12873000
IOCMAC   EQU   IOCSTR+15                                                12874000
IOCMSG   EQU   IOCSTR+16                                                12875000
OPNAGL   EQU   0                                                        12876000
OPNOPT   EQU   OPNAGL                                                   12877000
OPNRFM   EQU   OPNAGL+1                                                 12878000
OPNTYP   EQU   OPNAGL+2                                                 12879000
OPNTYPSI EQU   OPNTYP                                                   12880000
OPNMOD   EQU   OPNAGL+3                                                 12881000
OPNIOC   EQU   OPNAGL+4                                                 12882000
UVOLLIST EQU   0                                                        12883000
UVOLENT  EQU   UVOLLIST+2                                               12884000
ICKTPPR0 EQU   0                                                        12885000
DARGLIST EQU   0                                                        12886000
DARGDBP  EQU   DARGLIST                                                 12887000
DARGSTID EQU   DARGLIST+8                                               12888000
DARGSMOD EQU   DARGSTID                                                 12889000
DARGSENT EQU   DARGSTID+3                                               12890000
DARGILP  EQU   DARGLIST+12                                              12891000
DARGARY  EQU   DARGLIST+20                                              12892000
DARGINS  EQU   DARGARY                                                  12893000
DARGINL  EQU   DARGARY+2                                                12894000
FMTLIST  EQU   0                                                        12895000
FMTFLGS  EQU   FMTLIST                                                  12896000
FMTSPF   EQU   FMTLIST+2                                                12897000
FMTRFNO  EQU   FMTSPF                                                   12898000
FMTILEN  EQU   FMTRFNO                                                  12899000
FMTIOFF  EQU   FMTLIST+4                                                12900000
FMTTRBC  EQU   FMTIOFF                                                  12901000
FMTSTO   EQU   FMTTRBC                                                  12902000
FMTOCOL  EQU   FMTLIST+6                                                12903000
FMTCNVF  EQU   FMTLIST+10                                               12904000
ICKDB010 EQU   0                                                        12905000
DMPITM   EQU   0                                                        12906000
DMPARY   EQU   0                                                        12907000
HDAREA   EQU   0                                                        12908000
LEFTMGN  EQU   HDAREA                                                   12909000
RIGHTMGN EQU   HDAREA+2                                                 12910000
LOADTPTR EQU   HDAREA+4                                                 12911000
KWTBLPTR EQU   HDAREA+8                                                 12912000
ADDRIOCS EQU   HDAREA+12                                                12913000
NESTLVL  EQU   HDAREA+16                                                12914000
MODLFLGS EQU   HDAREA+18                                                12915000
NULLDO   EQU   MODLFLGS                                                 12916000
DOFLAG   EQU   MODLFLGS+1                                               12917000
THENFLAG EQU   MODLFLGS+1                                               12918000
ELSEFLAG EQU   MODLFLGS+1                                               12919000
SKIPFLAG EQU   MODLFLGS+1                                               12920000
VERBDATA EQU   0                                                        12921000
MAXID    EQU   VERBDATA+10                                              12922000
POSDSPL  EQU   VERBDATA+20                                              12923000
DGRPDSPL EQU   VERBDATA+21                                              12924000
VNGRPDSP EQU   VERBDATA+22                                              12925000
NTGRPDSP EQU   VERBDATA+23                                              12926000
@NM00020 EQU   0                                                        12927000
VPOSCNT  EQU   @NM00020                                                 12928000
VPOSID   EQU   @NM00020+2                                               12929000
DGRPTOT  EQU   0                                                        12930000
@NM00021 EQU   0                                                        12931000
DGRPCNT  EQU   @NM00021                                                 12932000
DGRPID   EQU   @NM00021+2                                               12933000
VNGRPTOT EQU   0                                                        12934000
@NM00022 EQU   0                                                        12935000
VNGRPCNT EQU   @NM00022                                                 12936000
VNGRPID  EQU   @NM00022+2                                               12937000
@NM00023 EQU   0                                                        12938000
NTGRPCNT EQU   @NM00023                                                 12939000
NTGRPID  EQU   @NM00023+2                                               12940000
PARMDATA EQU   0                                                        12941000
OCCURNUM EQU   PARMDATA+1                                               12942000
IDDSPL   EQU   PARMDATA+4                                               12943000
KWDDSPL  EQU   PARMDATA+5                                               12944000
NOTDSPL  EQU   PARMDATA+6                                               12945000
NGRPDSPL EQU   PARMDATA+7                                               12946000
PDEDSPL  EQU   PARMDATA+8                                               12947000
SCLRDATA EQU   PARMDATA+11                                              12948000
LEVEL1   EQU   PARMDATA+11                                              12949000
REPEATED EQU   PARMDATA+11                                              12950000
SCALAR   EQU   PARMDATA+11                                              12951000
LIST     EQU   PARMDATA+11                                              12952000
DEFAULT  EQU   PARMDATA+11                                              12953000
SUBLIST  EQU   PARMDATA+11                                              12954000
DSCRPTR1 EQU   0                                                        12955000
SUBDSPL  EQU   DSCRPTR1+2                                               12956000
REPMAX   EQU   DSCRPTR1+3                                               12957000
DSCRPTR2 EQU   0                                                        12958000
HIVALUE  EQU   DSCRPTR2                                                 12959000
LOWVALUE EQU   DSCRPTR2+4                                               12960000
MAXLNGTH EQU   DSCRPTR2+8                                               12961000
LISTMAX  EQU   DSCRPTR2+9                                               12962000
NUMBER   EQU   DSCRPTR2+11                                              12963000
ANYSTRNG EQU   DSCRPTR2+11                                              12964000
DSNAM    EQU   DSCRPTR2+11                                              12965000
GENERIC  EQU   DSCRPTR2+11                                              12966000
VOLID    EQU   DSCRPTR2+11                                              12967000
PWORDOPT EQU   DSCRPTR2+11                                              12968000
DEFLT    EQU   0                                                        12969000
DEFLTLEN EQU   DEFLT                                                    12970000
DEFLTVAL EQU   DEFLT+1                                                  12971000
@NM00028 EQU   0                                                        12972000
@NM00029 EQU   @NM00028+2                                               12973000
KWDCOUNT EQU   0                                                        12974000
@NM00030 EQU   0                                                        12975000
KWDLEN   EQU   @NM00030                                                 12976000
KWDITEM  EQU   @NM00030+1                                               12977000
@NM00031 EQU   0                                                        12978000
SUBCOUNT EQU   @NM00031                                                 12979000
@NM00032 EQU   @NM00031+2                                               12980000
PARMTYPE EQU   @NM00032                                                 12981000
SUBID    EQU   @NM00032+2                                               12982000
NGRPTOT  EQU   0                                                        12983000
@NM00033 EQU   0                                                        12984000
NGRPCNT  EQU   @NM00033                                                 12985000
NGRPID   EQU   @NM00033+2                                               12986000
@NM00034 EQU   0                                                        12987000
NOTCOUNT EQU   @NM00034                                                 12988000
NOTID    EQU   @NM00034+2                                               12989000
@NM00035 EQU   0                                                        12990000
@NM00036 EQU   @NM00035+2                                               12991000
FDTTBL   EQU   0                                                        12992000
FDTPTR   EQU   FDTTBL+8                                                 12993000
PARMINFO EQU   0                                                        12994000
PARMPTR  EQU   PARMINFO                                                 12995000
NTGRPPTR EQU   PARMINFO+4                                               12996000
SUPRPARM EQU   PARMINFO+8                                               12997000
PARMFLAG EQU   PARMINFO+10                                              12998000
LISTADDR EQU   0                                                        12999000
REPTOTAL EQU   0                                                        13000000
REPPTR   EQU   0                                                        13001000
VECTRPTR EQU   0                                                        13002000
KWDTABLE EQU   0                                                        13003000
PARMSYM  EQU   KWDTABLE+1                                               13004000
SETSYM   EQU   KWDTABLE+11                                              13005000
IFSYM    EQU   KWDTABLE+21                                              13006000
THENSYM  EQU   KWDTABLE+31                                              13007000
ELSESYM  EQU   KWDTABLE+41                                              13008000
DOSYM    EQU   KWDTABLE+51                                              13009000
ENDSYM   EQU   KWDTABLE+61                                              13010000
LSTCCLN  EQU   KWDTABLE+70                                              13011000
LSTCCSYM EQU   KWDTABLE+71                                              13012000
MAXCCLN  EQU   KWDTABLE+80                                              13013000
MAXCCSYM EQU   KWDTABLE+81                                              13014000
DATABLK  EQU   0                                                        13015000
INREC    EQU   0                                                        13016000
OPTSPTR  EQU   0                                                        13017000
PARMOPTS EQU   0                                                        13018000
OPTSLEN  EQU   PARMOPTS                                                 13019000
FULLWORD EQU   0                                                        13020000
@NM00047 EQU   0                                                        13021000
STRINGLN EQU   @NM00047                                                 13022000
STRING   EQU   @NM00047+1                                               13023000
@NM00048 EQU   0                                                        13024000
PASSWDLN EQU   @NM00048                                                 13025000
PASSWORD EQU   @NM00048+1                                               13026000
CHARLN   EQU   @NM00048+9                                               13027000
CHARS    EQU   @NM00048+10                                              13028000
@NM00049 EQU   0                                                        13029000
DSPWDLN  EQU   @NM00049                                                 13030000
DSPWORD  EQU   @NM00049+1                                               13031000
STARPOS  EQU   @NM00049+9                                               13032000
MEMNAMLN EQU   @NM00049+11                                              13033000
MEMNAME  EQU   @NM00049+12                                              13034000
DSNAMELN EQU   @NM00049+20                                              13035000
DSNAME   EQU   @NM00049+21                                              13036000
@NM00050 EQU   0                                                        13037000
FULLWDCT EQU   @NM00050                                                 13038000
LFULLWD  EQU   @NM00050+4                                               13039000
@NM00051 EQU   0                                                        13040000
STRINGCT EQU   @NM00051                                                 13041000
LSTRINGL EQU   @NM00051+2                                               13042000
LSTRING  EQU   @NM00051+3                                               13043000
@NM00052 EQU   0                                                        13044000
CHARCT   EQU   @NM00052                                                 13045000
LCHRPWDL EQU   @NM00052+2                                               13046000
LCHRPWD  EQU   @NM00052+3                                               13047000
LCHARLN  EQU   @NM00052+11                                              13048000
LCHAR    EQU   @NM00052+12                                              13049000
@NM00053 EQU   0                                                        13050000
DSNAMECT EQU   @NM00053                                                 13051000
@NM00054 EQU   @NM00053+2                                               13052000
LDSNPWDL EQU   @NM00054                                                 13053000
LDSNPWD  EQU   @NM00054+1                                               13054000
LSTARPOS EQU   @NM00054+9                                               13055000
LMEMNAML EQU   @NM00054+11                                              13056000
LMEMNAME EQU   @NM00054+12                                              13057000
LDSNAMEL EQU   @NM00054+20                                              13058000
LDSNAME  EQU   @NM00054+21                                              13059000
DMPTRM   EQU   0                                                        13060000
ICKDVCL0 EQU   0                                                        13061000
ICKDVIN0 EQU   0                                                        13062000
ICKDVON0 EQU   0                                                        13063000
ICKDVOP0 EQU   0                                                        13064000
ICKIOCL0 EQU   0                                                        13065000
ICKIOIT0 EQU   0                                                        13066000
ICKIOPT0 EQU   0                                                        13067000
ICKIOTM0 EQU   0                                                        13068000
ICKSACL0 EQU   0                                                        13069000
ICKSADE0 EQU   0                                                        13070000
ICKSAPR0 EQU   0                                                        13071000
ICKSASC0 EQU   0                                                        13072000
ICKSASN0 EQU   0                                                        13073000
ICKSAST0 EQU   0                                                        13074000
ICKSATI0 EQU   0                                                        13075000
ICKSAVC0 EQU   0                                                        13076000
ICKSAWO0 EQU   0                                                        13077000
ICKTPEA0 EQU   0                                                        13078000
ICKTPES0 EQU   0                                                        13079000
ICKTPRE0 EQU   0                                                        13080000
ICKTPRS0 EQU   0                                                        13081000
LISTTEST EQU   0                                                        13082000
NEWERID1 EQU   5                                                        13083000
NTGRPTOT EQU   0                                                        13084000
GDTTBLX  EQU   0                                                        13085000
FDTLOC   EQU   0                                                        13086000
SPACEID  EQU   0                                                        13087000
DMSMAX   EQU   0                                                        13088000
DMSLAST  EQU   0                                                        13089000
FUNCNAME EQU   0                                                        13090000
DFLTPARM EQU   0                                                        13091000
ERRMSGID EQU   0                                                        13092000
ERRPRMID EQU   0                                                        13093000
FLDTYPE  EQU   0                                                        13094000
WITHCOM  EQU   0                                                        13095000
DEPTH    EQU   0                                                        13096000
ERRCODE1 EQU   0                                                        13097000
ERRCODE2 EQU   0                                                        13098000
INSRTLEN EQU   0                                                        13099000
INSRTPTR EQU   0                                                        13100000
RISTID   EQU   MODID                                                    13101000
DIGITVAL EQU   SYNUNIT                                                  13102000
CNVRTWRD EQU   SYNUNIT                                                  13103000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    13104000
LUNQTFLG EQU   @NM00054+10                                              13105000
UNQTFLG  EQU   @NM00049+10                                              13106000
ENDSMLN  EQU   KWDTABLE+60                                              13107000
DOSMLN   EQU   KWDTABLE+50                                              13108000
ELSESMLN EQU   KWDTABLE+40                                              13109000
THENSMLN EQU   KWDTABLE+30                                              13110000
IFSMLN   EQU   KWDTABLE+20                                              13111000
SETSMLN  EQU   KWDTABLE+10                                              13112000
PARMSMLN EQU   KWDTABLE                                                 13113000
@NM00037 EQU   PARMINFO+11                                              13114000
FDTVERB  EQU   FDTTBL                                                   13115000
PDEOFST2 EQU   @NM00036+4                                               13116000
PDEPCLID EQU   @NM00036+2                                               13117000
PDEPRMID EQU   @NM00036                                                 13118000
PDECNT   EQU   @NM00035                                                 13119000
PDEOFST1 EQU   @NM00029+2                                               13120000
IDNUM    EQU   @NM00029                                                 13121000
ICKOUNT  EQU   @NM00028                                                 13122000
@NM00027 EQU   DSCRPTR2+11                                              13123000
USERID   EQU   DSCRPTR2+11                                              13124000
@NM00026 EQU   DSCRPTR2+10                                              13125000
PCLDSPL2 EQU   DSCRPTR1                                                 13126000
@NM00025 EQU   PARMDATA+11                                              13127000
@NM00024 EQU   PARMDATA+10                                              13128000
KWDGRPID EQU   PARMDATA+9                                               13129000
PDEFLEN  EQU   PARMDATA                                                 13130000
LOADNAME EQU   VERBDATA+12                                              13131000
PARMCNT  EQU   VERBDATA+8                                               13132000
VDATALEN EQU   VERBDATA+6                                               13133000
PCLDSPL1 EQU   VERBDATA+4                                               13134000
DESCID   EQU   VERBDATA                                                 13135000
@NM00019 EQU   MODLFLGS+1                                               13136000
@NM00017 EQU   DMPARY+15                                                13137000
DMPARYTP EQU   DMPARY+14                                                13138000
DMPARYEX EQU   DMPARY+12                                                13139000
DMPARYIC EQU   DMPARY+10                                                13140000
DMPARYSZ EQU   DMPARY+8                                                 13141000
DMPARYNM EQU   DMPARY                                                   13142000
@NM00016 EQU   DMPITM+15                                                13143000
DMPITMTP EQU   DMPITM+14                                                13144000
DMPITMLN EQU   DMPITM+12                                                13145000
DMPITMPT EQU   DMPITM+8                                                 13146000
DMPITMNM EQU   DMPITM                                                   13147000
@NM00015 EQU   FMTCNVF+1                                                13148000
FMTBS    EQU   FMTCNVF+1                                                13149000
FMTSS    EQU   FMTCNVF+1                                                13150000
FMTAL    EQU   FMTCNVF+1                                                13151000
FMTZS    EQU   FMTCNVF+1                                                13152000
@NM00014 EQU   FMTCNVF                                                  13153000
FMTPU    EQU   FMTCNVF                                                  13154000
FMTBD    EQU   FMTCNVF                                                  13155000
FMTBHD   EQU   FMTCNVF                                                  13156000
FMTBHA   EQU   FMTCNVF                                                  13157000
FMTBH    EQU   FMTCNVF                                                  13158000
FMTOLEN  EQU   FMTLIST+8                                                13159000
FMTRIO   EQU   FMTOCOL                                                  13160000
FMTSPT   EQU   FMTSTO                                                   13161000
FMTSTL   EQU   FMTILEN                                                  13162000
@NM00013 EQU   FMTFLGS+1                                                13163000
FMTHDF   EQU   FMTFLGS                                                  13164000
FMTDFF   EQU   FMTFLGS                                                  13165000
FMTSTF   EQU   FMTFLGS                                                  13166000
FMTREPF  EQU   FMTFLGS                                                  13167000
FMTBDF   EQU   FMTFLGS                                                  13168000
FMTIDF   EQU   FMTFLGS                                                  13169000
FMTSCF   EQU   FMTFLGS                                                  13170000
FMTEOLF  EQU   FMTFLGS                                                  13171000
DARGDTM  EQU   DARGARY+4                                                13172000
DARGPCT  EQU   DARGINL                                                  13173000
DARGREP  EQU   DARGINS                                                  13174000
@NM00012 EQU   DARGLIST+19                                              13175000
DARGIND  EQU   DARGLIST+18                                              13176000
DARGRETL EQU   DARGLIST+16                                              13177000
DARGCNT  EQU   DARGLIST+14                                              13178000
DARGRETP EQU   DARGLIST+4                                               13179000
UVOLVOL  EQU   UVOLENT+4                                                13180000
UVOLDEV  EQU   UVOLENT                                                  13181000
UVOLCNT  EQU   UVOLLIST                                                 13182000
OPNRSVD  EQU   OPNAGL+28                                                13183000
OPNVOL   EQU   OPNAGL+24                                                13184000
OPNBLK   EQU   OPNAGL+20                                                13185000
OPNREC   EQU   OPNAGL+16                                                13186000
OPNDSN   EQU   OPNAGL+12                                                13187000
OPNDDN   EQU   OPNAGL+8                                                 13188000
@NM00011 EQU   OPNMOD                                                   13189000
OPNMODRC EQU   OPNMOD                                                   13190000
OPNMODAC EQU   OPNMOD                                                   13191000
@NM00010 EQU   OPNTYP                                                   13192000
OPNTYPSO EQU   OPNTYP                                                   13193000
@NM00009 EQU   OPNRFM                                                   13194000
OPNRFMBK EQU   OPNRFM                                                   13195000
OPNRFMSF EQU   OPNRFM                                                   13196000
OPNRFMUN EQU   OPNRFM                                                   13197000
OPNRFMVR EQU   OPNRFM                                                   13198000
OPNRFMFX EQU   OPNRFM                                                   13199000
@NM00008 EQU   OPNOPT                                                   13200000
OPNOPTJM EQU   OPNOPT                                                   13201000
OPNOPTKS EQU   OPNOPT                                                   13202000
OPNOPTBK EQU   OPNOPT                                                   13203000
OPNOPTUP EQU   OPNOPT                                                   13204000
OPNOPTOT EQU   OPNOPT                                                   13205000
OPNOPTIN EQU   OPNOPT                                                   13206000
IOCEXT   EQU   IOCSTR+36                                                13207000
IOCRRN   EQU   IOCSTR+32                                                13208000
@NM00007 EQU   IOCSTR+30                                                13209000
IOCPNM   EQU   IOCSTR+28                                                13210000
IOCCBP   EQU   IOCSTR+24                                                13211000
IOCDSN   EQU   IOCSTR+20                                                13212000
@NM00006 EQU   IOCSTR+17                                                13213000
@NM00005 EQU   IOCMSG                                                   13214000
IOCMSGOP EQU   IOCMSG                                                   13215000
IOCMACPA EQU   IOCMAC                                                   13216000
@NM00004 EQU   IOCMAC                                                   13217000
IOCMACBK EQU   IOCMAC                                                   13218000
IOCMACUP EQU   IOCMAC                                                   13219000
IOCMACOT EQU   IOCMAC                                                   13220000
IOCMACIN EQU   IOCMAC                                                   13221000
@NM00003 EQU   IOCRFM                                                   13222000
IOCRFMBK EQU   IOCRFM                                                   13223000
IOCRFMSF EQU   IOCRFM                                                   13224000
IOCRFMUN EQU   IOCRFM                                                   13225000
IOCRFMVR EQU   IOCRFM                                                   13226000
IOCRFMFX EQU   IOCRFM                                                   13227000
@NM00002 EQU   IOCDSO                                                   13228000
IOCDSOPS EQU   IOCDSO                                                   13229000
IOCKYL   EQU   IOCSTR+12                                                13230000
IOCTRN   EQU   IOCSTR+8                                                 13231000
STAEWORK EQU   STAEPARM+32                                              13232000
STARPTR  EQU   STAEPFX+28                                               13233000
STASPTR  EQU   STAEPFX+24                                               13234000
STALEN   EQU   STAEPFX+20                                               13235000
STAID    EQU   STAEPFX+16                                               13236000
STAEPA   EQU   STAEPFX+12                                               13237000
STAGDT   EQU   STAEPFX+8                                                13238000
STABPTR  EQU   STAEPFX+4                                                13239000
STAFPTR  EQU   STAEPFX                                                  13240000
NEWID1   EQU   TRACE1+95                                                13241000
CALLID   EQU   OLDERID1+90                                              13242000
@NM00001 EQU   OLDERID1                                                 13243000
GDTCVR   EQU   GDTTBL+184                                               13244000
GDTSPR   EQU   GDTTBL+164                                               13245000
GDTABH   EQU   GDTTBL+156                                               13246000
GDTABT   EQU   GDTTBL+152                                               13247000
GDTTOH   EQU   GDTTBL+132                                               13248000
GDTRIP   EQU   GDTTBL+128                                               13249000
GDTDVH   EQU   GDTTBL+40                                                13250000
GDTIOH   EQU   GDTTBL+36                                                13251000
GDTSAH   EQU   GDTTBL+32                                                13252000
GDTTPH   EQU   GDTTBL+28                                                13253000
GDTSTH   EQU   GDTTBL+20                                                13254000
GDTDBH   EQU   GDTTBL+16                                                13255000
GDTHDR   EQU   GDTTBL                                                   13256000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      13257000
@RC00354 EQU   @EL00002                                                 13258000
@RF00377 EQU   @EL00002                                                 13259000
@RC00372 EQU   @EL00002                                                 13260000
@RC00516 EQU   @RC00502                                                 13261000
@RT00514 EQU   @RC00502                                                 13262000
@RC00524 EQU   @RC00523                                                 13263000
@RC00530 EQU   @RC00523                                                 13264000
@RF00529 EQU   @RC00523                                                 13265000
@RC00544 EQU   @RC00540                                                 13266000
@RC00591 EQU   @RC00584                                                 13267000
@RC00589 EQU   @RC00584                                                 13268000
@RC00587 EQU   @RC00584                                                 13269000
@RC00585 EQU   @RC00584                                                 13270000
@RC00598 EQU   @RC00597                                                 13271000
@RC00617 EQU   @RC00616                                                 13272000
@RC00628 EQU   @RC00614                                                 13273000
@RF00713 EQU   @RC00708                                                 13274000
@RF00732 EQU   @EL00005                                                 13275000
@RF00735 EQU   @EL00005                                                 13276000
@RF00803 EQU   @RC00798                                                 13277000
@RC00841 EQU   @RC00840                                                 13278000
@RC00846 EQU   @RC00840                                                 13279000
@RC00853 EQU   @RC00840                                                 13280000
@RT00865 EQU   @EL00006                                                 13281000
@RF00864 EQU   @EL00006                                                 13282000
@RT00900 EQU   @EL00007                                                 13283000
@RF00899 EQU   @EL00007                                                 13284000
@RF00912 EQU   @EL00008                                                 13285000
@PB00008 EQU   @EL00004                                                 13286000
@RT00971 EQU   @EL00009                                                 13287000
@RF00930 EQU   @EL00009                                                 13288000
@RC00968 EQU   @EL00009                                                 13289000
@RT01036 EQU   @EL00010                                                 13290000
@RC01032 EQU   @EL00010                                                 13291000
@PB00010 EQU   @EL00003                                                 13292000
@RC01083 EQU   @RC01082                                                 13293000
@RC01114 EQU   @EL00012                                                 13294000
@RF01113 EQU   @EL00012                                                 13295000
@RF01112 EQU   @EL00012                                                 13296000
@RC01131 EQU   @EL00013                                                 13297000
@RF01130 EQU   @EL00013                                                 13298000
@RF01129 EQU   @EL00013                                                 13299000
@PB00013 EQU   @EL00011                                                 13300000
@RC01154 EQU   @RC01153                                                 13301000
@RC01272 EQU   @RC01271                                                 13302000
@RF01282 EQU   @RC01271                                                 13303000
@RC01377 EQU   @EL00015                                                 13304000
@RC01375 EQU   @EL00015                                                 13305000
@RC01366 EQU   @EL00015                                                 13306000
@RF01365 EQU   @EL00015                                                 13307000
@RC01454 EQU   @RC01453                                                 13308000
@RF01487 EQU   @EL00017                                                 13309000
@PB00017 EQU   @EL00016                                                 13310000
@RC01556 EQU   @EL00019                                                 13311000
@PB00019 EQU   @EL00014                                                 13312000
@RC01631 EQU   @RC01620                                                 13313000
@RC01655 EQU   @EL00020                                                 13314000
@RC01646 EQU   @EL00020                                                 13315000
@RC01604 EQU   @EL00020                                                 13316000
@RF01749 EQU   @EL00022                                                 13317000
@RF01759 EQU   @EL00022                                                 13318000
@PB00022 EQU   @EL00021                                                 13319000
@PB00024 EQU   @EL00023                                                 13320000
@RC01886 EQU   @RC01885                                                 13321000
@RF01918 EQU   @EL00026                                                 13322000
@RC01912 EQU   @EL00026                                                 13323000
@RC01931 EQU   @RC01928                                                 13324000
@RF01939 EQU   @EL00027                                                 13325000
@RC02039 EQU   @EL00028                                                 13326000
@RC02056 EQU   @RC02055                                                 13327000
@RC02099 EQU   @RC02091                                                 13328000
@RF02227 EQU   @EL00032                                                 13329000
@PB00032 EQU   @EL00031                                                 13330000
@PB00031 EQU   @EL00030                                                 13331000
@RF02248 EQU   @EL00033                                                 13332000
@RF02277 EQU   @EL00034                                                 13333000
@RF02301 EQU   @EL00035                                                 13334000
@PB00035 EQU   @EL00001                                                 13335000
@RF00620 EQU   @RC00617                                                 13336000
@PB00007 EQU   @PB00008                                                 13337000
@RC00973 EQU   @RC00968                                                 13338000
@PB00009 EQU   @PB00010                                                 13339000
@RC01038 EQU   @RC01032                                                 13340000
@RC01088 EQU   @RC01083                                                 13341000
@RF01087 EQU   @RC01083                                                 13342000
@PB00012 EQU   @PB00013                                                 13343000
@RC01369 EQU   @RC01366                                                 13344000
@RC01367 EQU   @RC01366                                                 13345000
@RC01462 EQU   @PB00017                                                 13346000
@PB00018 EQU   @PB00019                                                 13347000
@RC01610 EQU   @RC01604                                                 13348000
@RF01659 EQU   @RC01655                                                 13349000
@RC02065 EQU   @RC02056                                                 13350000
@RC02057 EQU   @RC02056                                                 13351000
@RC02084 EQU   @PB00031                                                 13352000
@RF02135 EQU   @PB00031                                                 13353000
@RC02146 EQU   @PB00032                                                 13354000
@PB00034 EQU   @PB00035                                                 13355000
@PB00006 EQU   @PB00007                                                 13356000
@PB00004 EQU   @PB00009                                                 13357000
@RC00976 EQU   @RC00973                                                 13358000
@RC00982 EQU   @RC00973                                                 13359000
@RF00981 EQU   @RC00973                                                 13360000
@RF01000 EQU   @RC00973                                                 13361000
@RC01042 EQU   @RC01038                                                 13362000
@RF01041 EQU   @RC01038                                                 13363000
@RC01463 EQU   @RC01462                                                 13364000
@PB00016 EQU   @PB00018                                                 13365000
@RC02058 EQU   @RC02057                                                 13366000
@RC02147 EQU   @RC02146                                                 13367000
@PB00033 EQU   @PB00034                                                 13368000
@PB00005 EQU   @PB00006                                                 13369000
@RC00986 EQU   @RC00982                                                 13370000
@RF00985 EQU   @RC00982                                                 13371000
@RC01043 EQU   @RC01042                                                 13372000
@PB00015 EQU   @PB00016                                                 13373000
@PB00030 EQU   @PB00033                                                 13374000
@RC00987 EQU   @RC00986                                                 13375000
@RC01201 EQU   @PB00015                                                 13376000
@RC01163 EQU   @PB00015                                                 13377000
@RC01247 EQU   @PB00015                                                 13378000
@RC01245 EQU   @PB00015                                                 13379000
@PB00029 EQU   @PB00030                                                 13380000
@RC01164 EQU   @RC01163                                                 13381000
@RF01182 EQU   @RC01163                                                 13382000
@RC01196 EQU   @RC01163                                                 13383000
@RC01184 EQU   @RC01163                                                 13384000
@RC01239 EQU   @RC01201                                                 13385000
@RC01223 EQU   @RC01201                                                 13386000
@RF01222 EQU   @RC01201                                                 13387000
@PB00028 EQU   @PB00029                                                 13388000
@RC01167 EQU   @RC01164                                                 13389000
@RC01165 EQU   @RC01164                                                 13390000
@RC01186 EQU   @RC01184                                                 13391000
@RF01236 EQU   @RC01223                                                 13392000
@PB00027 EQU   @PB00028                                                 13393000
@PB00026 EQU   @PB00027                                                 13394000
@PB00025 EQU   @PB00026                                                 13395000
@PB00023 EQU   @PB00025                                                 13396000
@PB00021 EQU   @PB00023                                                 13397000
@PB00020 EQU   @PB00021                                                 13398000
@PB00014 EQU   @PB00020                                                 13399000
@PB00011 EQU   @PB00014                                                 13400000
@PB00003 EQU   @PB00011                                                 13401000
@PB00002 EQU   @PB00003                                                 13402000
@ENDDATA EQU   *                                                        13403000
         END   ICKRI01,(C'PLS1726',0701,78192)                          13404000
