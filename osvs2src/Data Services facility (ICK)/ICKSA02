         TITLE '*******    ICKSA02  SYSTEM ADAPTER SERVICE MODULE      *00001000
                ******* '                                               00002000
ICKSA02 CSECT                                                           00003000
MAINENT DS    0H                                                        00004000
        USING *,REG15                                                   00005000
        B     PROLOG                                                    00006000
        DC    AL2(BEGIN-MAINENT)                                        00007000
        DC    C'ICKSA02 '                                               00008000
ICKSACL DS    0H                      UCALL ENTRY POINT                 00009000
        USING *,REG15                                                   00010000
        B     PROLOG                                                    00011000
        DC    AL2(DMSSACL1-ICKSACL)                                     00012000
        ENTRY ICKSACL                                                   00013000
ICKSALD DS    0H                      ULOAD ENTRY POINT                 00014000
        USING *,REG15                                                   00015000
        B     PROLOG                                                    00016000
        DC    AL2(DMSSALD1-ICKSALD)                                     00017000
        ENTRY ICKSALD                                                   00018000
ICKSADE DS    0H                      UDELETE ENTRY POINT               00019000
        USING *,REG15                                                   00020000
        B     PROLOG                                                    00021000
        DC    AL2(DMSSADE1-ICKSADE)                                     00022000
        ENTRY ICKSADE                                                   00023000
ICKSAGS DS    0H                      UGSPACE ENTRY POINT               00024000
        USING *,REG15                                                   00025000
        B     PROLOG                                                    00026000
        DC    AL2(DMSSAGS1-ICKSAGS)                                     00027000
        ENTRY ICKSAGS                                                   00028000
ICKSAFS DS    0H                      UFSPACE ENTRY POINT               00029000
        USING *,REG15                                                   00030000
        B     PROLOG                                                    00031000
        DC    AL2(DMSSAFS1-ICKSAFS)                                     00032000
        ENTRY ICKSAFS                                                   00033000
ICKSAGP DS    0H                      UGPOOL ENTRY POINT                00034000
        USING *,REG15                                                   00035000
        B     PROLOG                                                    00036000
        DC    AL2(DMSSAGP1-ICKSAGP)                                     00037000
        ENTRY ICKSAGP                                                   00038000
ICKSAFP DS    0H                      UFPOOL ENTRY POINT                00039000
        USING *,REG15                                                   00040000
        B     PROLOG                                                    00041000
        DC    AL2(DMSSAFP1-ICKSAFP)                                     00042000
        ENTRY ICKSAFP                                                   00043000
ICKSATI DS    0H                      UTIME ENTRY POINT                 00044000
        USING *,REG15                                                   00045000
        B     PROLOG                                                    00046000
        DC    AL2(DMSSATI1-ICKSATI)                                     00047000
        ENTRY ICKSATI                                                   00048000
ICKSASN DS    0H                      USNAP ENTRY POINT                 00049000
        USING *,REG15                                                   00050000
        B     PROLOG                                                    00051000
        DC    AL2(DMSSASN1-ICKSASN)                                     00052000
        ENTRY ICKSASN                                                   00053000
        DROP  REG15                                                     00054000
PROLOG  STM   REG14,REG12,12(REG13)                                     00055000
        BALR  REG10,0                                                   00056000
PSTART  LA    REG12,4095(REG10)                                         00057000
        USING PSTART,REG10                                              00058000
        USING PSTART+4095,REG12                                         00059000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00060000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00061000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00062000
        LA    REG14,*+14              RETURN ADDRESS                    00063000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00064000
        DC    A(MODID)                MODULE ID ADDRESS                 00065000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00066000
        LR    REG11,REG1                                                00067000
        USING @DATD,REG11                                               00068000
        LM    REG15,REG1,16(REG13)                                      00069000
        ST    REG13,@SA00001+4                                          00070000
        ST    REG11,8(REG13)                                            00071000
        LR    REG13,REG11                                               00072000
        AH    REG15,4(REG15)                                            00073000
        BR    REG15                                                     00074000
BEGIN   DS    0H                                                        00075000
*                                                                  0222 00076000
*        /************************************************************/ 00077000
*        /************************************************************/ 00078000
*        /*                                                          */ 00079000
*        /* UCALL ENTRY POINT                                        */ 00080000
*        /*                                                          */ 00081000
*        /************************************************************/ 00082000
*        /************************************************************/ 00083000
*                                                                  0223 00084000
*DMSSACL:  ENTRY(GDTTBLX,CLNAMEX);                                 0223 00085000
*                                                                  0223 00086000
@EC00223 DS    0H                                                  0224 00087000
*DMSSACL1:                                                         0224 00088000
*                                                                  0224 00089000
*        DCL CLNAME CHAR(8) BASED;     /* ENTRY POINT NAME FOR UCALL */ 00090000
*                                                                  0224 00091000
DMSSACL1 DS    0H                                                  0225 00092000
*        RESPECIFY CLNAME BASED(PARMPTR2);                         0225 00093000
*                                      /* BASE CLNAME                */ 00094000
*        DCL CLENTPT PTR(31);          /* ENTRY POINT CALLED RTN     */ 00095000
*                                                                  0226 00096000
*                                                                  0226 00097000
*        /************************************************************/ 00098000
*        /*                                                          */ 00099000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */ 00100000
*        /*                                                          */ 00101000
*        /************************************************************/ 00102000
*                                                                  0227 00103000
*        RESPECIFY (REG1PTR) RSTD;                                 0227 00104000
*        GDTPR = ADDR1;                                            0228 00105000
         L     GDTPR,ADDR1(,REG1PTR)                               0228 00106000
*        PARMPTR2 = ADDR2;                                         0229 00107000
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0229 00108000
*        RESPECIFY (REG1PTR) UNRSTD;                               0230 00109000
*                                                                  0230 00110000
*        OLDERID2 = NEWERID2;                                      0231 00111000
         L     @02,GDTTR2(,GDTPR)                                  0231 00112000
         MVC   @TS00001(95),NEWERID2(@02)                          0231 00113000
         MVC   OLDERID2(95,@02),@TS00001                           0231 00114000
*        NEWID2 = 'SACL';                                          0232 00115000
*                                                                  0232 00116000
         MVC   NEWID2(4,@02),@CC00579                              0232 00117000
*        /************************************************************/ 00118000
*        /*                                                          */ 00119000
*        /* ISSUE CALL TO FINDNAME RTN TO GET ENTRY POINT            */ 00120000
*        /*                                                          */ 00121000
*        /************************************************************/ 00122000
*                                                                  0233 00123000
*        TEMPEPN = CLNAME;                                         0233 00124000
         MVC   TEMPEPN(8),CLNAME(PARMPTR2)                         0233 00125000
*        RESPECIFY (REG0) RSTD;                                    0234 00126000
*        CALL FINDNAME(TEMPEPN,CLENTPT);                           0235 00127000
*                                                                  0235 00128000
         LA    @01,TEMPEPN                                         0235 00129000
         ST    @01,@AL00001                                        0235 00130000
         LA    @01,CLENTPT                                         0235 00131000
         ST    @01,@AL00001+4                                      0235 00132000
         LA    @01,@AL00001                                        0235 00133000
         BAL   @14,FINDNAME                                        0235 00134000
*        /************************************************************/ 00135000
*        /*                                                          */ 00136000
*        /* TEMPORARILY STORE THE ADDRESS OF THE ENTRY POINT TO BE   */ 00137000
*        /* BRANCHED TO INTO REGISTER 2,                             */ 00138000
*        /* STORE THE OLD SAVEAREA POINTER INTO REGISTER 3, AND CHECK*/ 00139000
*        /* WHETHER OR NOT THIS MODULE'S AUTOMATIC STORAGE AREA IS TO*/ 00140000
*        /* BE FREED.                                                */ 00141000
*        /*                                                          */ 00142000
*        /************************************************************/ 00143000
*                                                                  0236 00144000
*        RESPECIFY (REG0,REG1,REG2,REG3,REG13,REG14,REG15) RSTD;   0236 00145000
*        REG2 = CLENTPT;                                           0237 00146000
         L     REG2,CLENTPT                                        0237 00147000
*        GEN(L     REG3,4(REG13));                                 0238 00148000
         L     REG3,4(REG13)                                            00149000
*        STATUS(3) = STATUS(3) - 1;                                0239 00150000
*                                                                  0239 00151000
         L     @07,GDTSAH(,GDTPR)                                  0239 00152000
         L     @07,AUTOPTR(,@07)                                   0239 00153000
         LH    @06,STATUS+24(,@07)                                 0239 00154000
         BCTR  @06,0                                               0239 00155000
         STH   @06,STATUS+24(,@07)                                 0239 00156000
*        /************************************************************/ 00157000
*        /*                                                          */ 00158000
*        /* CHECK IF ANY OTHER ACTIVE CALLERS OF ICKSA02             */ 00159000
*        /*                                                          */ 00160000
*        /************************************************************/ 00161000
*                                                                  0240 00162000
*        IF STATUS(3) > 0                                          0240 00163000
*          THEN                                                    0240 00164000
*                                                                  0240 00165000
         LTR   @06,@06                                             0240 00166000
         BNP   @RF00240                                            0240 00167000
*            /********************************************************/ 00168000
*            /*                                                      */ 00169000
*            /* FREE THE AREA                                        */ 00170000
*            /*                                                      */ 00171000
*            /********************************************************/ 00172000
*                                                                  0241 00173000
*            DO;                                                   0241 00174000
*              TEMPPTR = REG11 - 8;                                0242 00175000
         LR    @07,REG11                                           0242 00176000
         SL    @07,@CF00154                                        0242 00177000
         ST    @07,TEMPPTR                                         0242 00178000
*              REG0 = AUTOSIZE;                                    0243 00179000
         L     REG0,AUTOSIZE(,@07)                                 0243 00180000
*              REG1 = TEMPPTR;                                     0244 00181000
         LR    REG1,@07                                            0244 00182000
*LFREMN0:      GEN(FREEMAIN R,LV=(0),A=(1));                       0245 00183000
LFREMN0  FREEMAIN R,LV=(0),A=(1)                                        00184000
*            END;                                                  0246 00185000
*                                                                  0246 00186000
*        /************************************************************/ 00187000
*        /*                                                          */ 00188000
*        /* RESTORE OLD SAVEAREA POINTER,                            */ 00189000
*        /* LOAD THE ADDRESS OF THE ENTRY POINT TO BE BRANCHED TO    */ 00190000
*        /* INTO REGISTER 15, AND RESTORE REGISTERS EXCLUDING        */ 00191000
*        /* REGISTER 15 WHICH IS USED IN THE BRANCH                  */ 00192000
*        /*                                                          */ 00193000
*        /* PREPARE FOR LINKAGE BY ADJUSTING THE ADDRESS LIST FOR    */ 00194000
*        /* THE PARAMETER LIST RECEIVED (ADDRESS OF MODULE NAME      */ 00195000
*        /* TO BE CALLED IS NO LONGER NEEDED) AND EXECUTE A BRANCH   */ 00196000
*        /* ON REGISTER 15.                                          */ 00197000
*        /*                                                          */ 00198000
*        /************************************************************/ 00199000
*                                                                  0247 00200000
*        REG13 = REG3;                                             0247 00201000
@RF00240 LR    REG13,REG3                                          0247 00202000
*        REG15 = REG2;                                             0248 00203000
         LR    REG15,REG2                                          0248 00204000
*        GENERATE;                                                 0249 00205000
        L     REG14,12(REG13)                                           00206000
        LM    REG0,REG12,20(REG13)                                      00207000
        MVC   4(4,REG1),0(REG1)                                         00208000
        LA    REG1,4(REG1)                                              00209000
        BR    REG15                                                     00210000
*        RESPECIFY(REG0,REG1,REG2,REG3,REG13,REG14,REG15) UNRSTD;  0250 00211000
*        /************************************************************/ 00212000
*        /************************************************************/ 00213000
*        /*                                                          */ 00214000
*        /* ULOAD ENTRY POINT                                        */ 00215000
*        /*                                                          */ 00216000
*        /************************************************************/ 00217000
*        /************************************************************/ 00218000
*                                                                  0251 00219000
*DMSSALD:  ENTRY(GDTTBLX,LDMODX,LDPOINTX);                         0251 00220000
*                                                                  0251 00221000
@EC00251 DS    0H                                                  0252 00222000
*DMSSALD1:                                                         0252 00223000
*                                                                  0252 00224000
*        DCL LDMOD CHAR(8) BASED;      /* MODULE NAME FOR ULOAD      */ 00225000
*                                                                  0252 00226000
DMSSALD1 DS    0H                                                  0253 00227000
*        DCL LDPOINT PTR(31) BASED;    /* MODULE ADDRESS FOR ULOAD   */ 00228000
*                                                                  0253 00229000
*        RESPECIFY LDMOD BASED(PARMPTR2);                          0254 00230000
*                                      /* BASE LDMOD                 */ 00231000
*                                                                  0255 00232000
*        RESPECIFY LDPOINT BASED(PARMPTR3);                        0255 00233000
*                                      /* BASE LDPOINT               */ 00234000
*                                                                  0256 00235000
*        /************************************************************/ 00236000
*        /*                                                          */ 00237000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */ 00238000
*        /*                                                          */ 00239000
*        /************************************************************/ 00240000
*                                                                  0256 00241000
*        RESPECIFY (REG1PTR) RSTD;                                 0256 00242000
*        GDTPR = ADDR1;                                            0257 00243000
         L     GDTPR,ADDR1(,REG1PTR)                               0257 00244000
*        PARMPTR2 = ADDR2;                                         0258 00245000
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0258 00246000
*        PARMPTR3 = ADDR3;                                         0259 00247000
         L     PARMPTR3,ADDR3+8(,REG1PTR)                          0259 00248000
*        RESPECIFY (REG1PTR) UNRSTD;                               0260 00249000
*                                                                  0260 00250000
*        OLDERID2 = NEWERID2;                                      0261 00251000
         L     @15,GDTTR2(,GDTPR)                                  0261 00252000
         MVC   @TS00001(95),NEWERID2(@15)                          0261 00253000
         MVC   OLDERID2(95,@15),@TS00001                           0261 00254000
*        NEWID2 = 'SALD';                                          0262 00255000
*                                                                  0262 00256000
         MVC   NEWID2(4,@15),@CC00598                              0262 00257000
*        /************************************************************/ 00258000
*        /*                                                          */ 00259000
*        /*  ISSUE CALL TO FINDNAME RTN TO GET MODULE ENRTY POINT    */ 00260000
*        /*  IF MODULE IS LOADED THEN ONLY UP USE COUNT BY ONE       */ 00261000
*        /*  IF NOT IN LOAD LIST LOAD THE MODULE MAKE USE COUNT      */ 00262000
*        /*  ONE AND RETURN ENTRY POINT EITHER CONDITION             */ 00263000
*        /*                                                          */ 00264000
*        /************************************************************/ 00265000
*                                                                  0263 00266000
*        TEMPEPN = LDMOD;                                          0263 00267000
         MVC   TEMPEPN(8),LDMOD(PARMPTR2)                          0263 00268000
*        CALL FINDNAME(TEMPEPN,LDPOINT);                           0264 00269000
*                                                                  0264 00270000
         LA    @03,TEMPEPN                                         0264 00271000
         ST    @03,@AL00001                                        0264 00272000
         ST    PARMPTR3,@AL00001+4                                 0264 00273000
         LA    @01,@AL00001                                        0264 00274000
         BAL   @14,FINDNAME                                        0264 00275000
*        /************************************************************/ 00276000
*        /*                                                          */ 00277000
*        /* RETURN CONTROL TO THE ULOAD CALLER                       */ 00278000
*        /*                                                          */ 00279000
*        /************************************************************/ 00280000
*                                                                  0265 00281000
*        CALL ICKSAEP0(GDTTBL,MODID);                              0265 00282000
         ST    GDTPR,@AL00001                                      0265 00283000
         LA    @15,MODID                                           0265 00284000
         ST    @15,@AL00001+4                                      0265 00285000
         MVI   @AL00001+4,X'80'                                    0265 00286000
         L     @15,GDTEPL(,GDTPR)                                  0265 00287000
         LA    @01,@AL00001                                        0265 00288000
         BALR  @14,@15                                             0265 00289000
*        /************************************************************/ 00290000
*        /************************************************************/ 00291000
*        /*                                                          */ 00292000
*        /* UDELETE ENTRY POINT                                      */ 00293000
*        /*                                                          */ 00294000
*        /************************************************************/ 00295000
*        /************************************************************/ 00296000
*                                                                  0266 00297000
*DMSSADE:  ENTRY(GDTTBLX,DEMODX);                                  0266 00298000
*                                                                  0266 00299000
@EC00266 DS    0H                                                  0267 00300000
*DMSSADE1:                                                         0267 00301000
*                                                                  0267 00302000
*        DCL DEMOD CHAR(8) BASED;      /* MODULE NAME FOR UDELETE    */ 00303000
*                                                                  0267 00304000
DMSSADE1 DS    0H                                                  0268 00305000
*        RESPECIFY DEMOD BASED(PARMPTR2);                          0268 00306000
*                                      /* BASE DEMOD                 */ 00307000
*                                                                  0269 00308000
*        /************************************************************/ 00309000
*        /*                                                          */ 00310000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */ 00311000
*        /*                                                          */ 00312000
*        /************************************************************/ 00313000
*                                                                  0269 00314000
*        RESPECIFY (REG1PTR) RSTD;                                 0269 00315000
*        GDTPR = ADDR1;                                            0270 00316000
         L     GDTPR,ADDR1(,REG1PTR)                               0270 00317000
*        PARMPTR2 = ADDR2;                                         0271 00318000
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0271 00319000
*        RESPECIFY (REG1PTR) UNRSTD;                               0272 00320000
*                                                                  0272 00321000
*                                                                  0272 00322000
*        OLDERID2 = NEWERID2;                                      0273 00323000
         L     @15,GDTTR2(,GDTPR)                                  0273 00324000
         MVC   @TS00001(95),NEWERID2(@15)                          0273 00325000
         MVC   OLDERID2(95,@15),@TS00001                           0273 00326000
*        NEWID2 = 'SADE';                                          0274 00327000
*                                                                  0274 00328000
*                                                                  0274 00329000
         MVC   NEWID2(4,@15),@CC00610                              0274 00330000
*        /************************************************************/ 00331000
*        /*                                                          */ 00332000
*        /*  UDELETE RTN NOW WILL SEARCH LLBLK(S)                    */ 00333000
*        /*  FOR MATCH OF NAME AND REDUCE USE CTR BY ONE             */ 00334000
*        /*  UNLESS ITS ZERO ALREADY.THIS SHOULD NOT HAPPEN.         */ 00335000
*        /*                                                          */ 00336000
*        /************************************************************/ 00337000
*                                                                  0275 00338000
*        IX = 0;                                                   0275 00339000
         SLR   IX,IX                                               0275 00340000
*        LOOPCTL = OFF;                                            0276 00341000
         NI    LOOPCTL,B'01111111'                                 0276 00342000
*        NAMEFND = OFF;                                            0277 00343000
         NI    NAMEFND,B'01111111'                                 0277 00344000
*        DO WHILE LOOPCTL = OFF;                                   0278 00345000
         B     @DE00278                                            0278 00346000
@DL00278 DS    0H                                                  0279 00347000
*          IF IX = 0                                               0279 00348000
*                                                                  0279 00349000
*          /**********************************************************/ 00350000
*          /*                                                        */ 00351000
*          /*    FIRST TIME USE POINTER IN SYSTEM                    */ 00352000
*          /*    HIST SAVE AREA TO LOAD LIST BLOCK                   */ 00353000
*          /*                                                        */ 00354000
*          /**********************************************************/ 00355000
*                                                                  0279 00356000
*            THEN                                                  0279 00357000
         LTR   IX,IX                                               0279 00358000
         BNZ   @RF00279                                            0279 00359000
*              P = LLBLKPTR;                                       0280 00360000
         L     @02,GDTSAH(,GDTPR)                                  0280 00361000
         L     P,LLBLKPTR(,@02)                                    0280 00362000
*            ELSE;                                                 0281 00363000
*                                                                  0281 00364000
@RF00279 DS    0H                                                  0282 00365000
*          DO IX = 1 TO LLSLTCNT BY 1 WHILE LOOPCTL = OFF;         0282 00366000
*                                                                  0282 00367000
         LA    IX,1                                                0282 00368000
@DL00282 TM    LOOPCTL,B'10000000'                                 0282 00369000
         BNZ   @DC00282                                            0282 00370000
*          /**********************************************************/ 00371000
*          /*                                                        */ 00372000
*          /*  LOOK FOR MATCH OF NAME IN LLBLK                       */ 00373000
*          /*  WHEN FOUND REDUCE USE CTR BY ONE                      */ 00374000
*          /*                                                        */ 00375000
*          /**********************************************************/ 00376000
*                                                                  0283 00377000
*            IF DEMOD = LLNAME(IX)                                 0283 00378000
*              THEN                                                0283 00379000
         LR    @15,IX                                              0283 00380000
         SLA   @15,4                                               0283 00381000
         ST    @15,@TF00001                                        0283 00382000
         ALR   @15,P                                               0283 00383000
         AL    @15,@CF00812                                        0283 00384000
         CLC   DEMOD(8,PARMPTR2),LLNAME-8(@15)                     0283 00385000
         BNE   @RF00283                                            0283 00386000
*                DO;                                               0284 00387000
*                  LOOPCTL = ON;                                   0285 00388000
         OI    LOOPCTL,B'10000000'                                 0285 00389000
*                  NAMEFND = ON;                                   0286 00390000
         OI    NAMEFND,B'10000000'                                 0286 00391000
*                    IF LLUSECTR(IX) = 0                           0287 00392000
*                      THEN                                        0287 00393000
         L     @01,@TF00001                                        0287 00394000
         SLR   @00,@00                                             0287 00395000
         IC    @00,LLUSECTR-16(@01,P)                              0287 00396000
         C     @00,@CF00087                                        0287 00397000
         BNE   @RF00287                                            0287 00398000
*                        NAMEFND = OFF;                            0288 00399000
         NI    NAMEFND,B'01111111'                                 0288 00400000
*                      ELSE                                        0289 00401000
*                        LLUSECTR(IX) = LLUSECTR(IX)-1;            0289 00402000
         B     @RC00287                                            0289 00403000
@RF00287 LR    @15,IX                                              0289 00404000
         SLA   @15,4                                               0289 00405000
         SLR   @14,@14                                             0289 00406000
         IC    @14,LLUSECTR-16(@15,P)                              0289 00407000
         BCTR  @14,0                                               0289 00408000
         STC   @14,LLUSECTR-16(@15,P)                              0289 00409000
*                END;                                              0290 00410000
*              ELSE;                                               0291 00411000
@RF00283 DS    0H                                                  0292 00412000
*          END;                                                    0292 00413000
@RC00283 AL    IX,@CF00158                                         0292 00414000
         C     IX,@CF00278                                         0292 00415000
         BNH   @DL00282                                            0292 00416000
@DC00282 DS    0H                                                  0293 00417000
*            IF LLNXTBLK = 0                                       0293 00418000
*                                                                  0293 00419000
*            /********************************************************/ 00420000
*            /*                                                      */ 00421000
*            /*     WHEN ZERO THIS IS LAST LLBLK                     */ 00422000
*            /*                                                      */ 00423000
*            /********************************************************/ 00424000
*                                                                  0293 00425000
*              THEN                                                0293 00426000
         L     @15,LLNXTBLK(,P)                                    0293 00427000
         LTR   @15,@15                                             0293 00428000
         BNZ   @RF00293                                            0293 00429000
*                LOOPCTL = ON;                                     0294 00430000
         OI    LOOPCTL,B'10000000'                                 0294 00431000
*              ELSE                                                0295 00432000
*                P = LLNXTBLK;                                     0295 00433000
         B     @RC00293                                            0295 00434000
@RF00293 L     P,LLNXTBLK(,P)                                      0295 00435000
*        END;                                                      0296 00436000
*                                                                  0296 00437000
*                                                                  0296 00438000
@RC00293 DS    0H                                                  0296 00439000
@DE00278 TM    LOOPCTL,B'10000000'                                 0296 00440000
         BZ    @DL00278                                            0296 00441000
*        /************************************************************/ 00442000
*        /*                                                          */ 00443000
*        /* RETURN TO THE UDELETE CALLER                             */ 00444000
*        /*                                                          */ 00445000
*        /************************************************************/ 00446000
*                                                                  0297 00447000
*        CALL ICKSAEP0(GDTTBL,MODID);                              0297 00448000
         ST    GDTPR,@AL00001                                      0297 00449000
         LA    @15,MODID                                           0297 00450000
         ST    @15,@AL00001+4                                      0297 00451000
         MVI   @AL00001+4,X'80'                                    0297 00452000
         L     @15,GDTEPL(,GDTPR)                                  0297 00453000
         LA    @01,@AL00001                                        0297 00454000
         BALR  @14,@15                                             0297 00455000
*        /************************************************************/ 00456000
*        /************************************************************/ 00457000
*        /*                                                          */ 00458000
*        /* UGSPACE ENTRY POINT                                      */ 00459000
*        /*                                                          */ 00460000
*        /************************************************************/ 00461000
*        /************************************************************/ 00462000
*                                                                  0298 00463000
*DMSSAGS:  ENTRY(GDTTBLX,GSSIZEX,GSPOINTX,GSINITX,GSSPIDX);        0298 00464000
*                                                                  0298 00465000
@EC00298 DS    0H                                                  0299 00466000
*DMSSAGS1:                                                         0299 00467000
*                                                                  0299 00468000
*        DCL GSSIZE FIXED(31) BASED;   /* SPACE SIZE FOR UGSPACE     */ 00469000
*                                                                  0299 00470000
DMSSAGS1 DS    0H                                                  0300 00471000
*        DCL GSPOINT PTR(31) BASED;    /* SPACE ADDR FOR UGSPACE     */ 00472000
*                                                                  0300 00473000
*        DCL GSINIT CHAR(4) BASED;     /* UGSPACE INIT ARGUMENT      */ 00474000
*                                                                  0301 00475000
*        DCL GSSPID FIXED(8) BASED;    /*UGSPACE SUBPOOL ID          */ 00476000
*                                                                  0302 00477000
*        RESPECIFY GSSIZE BASED(PARMPTR2);                         0303 00478000
*                                      /* BASE GSSIZE                */ 00479000
*                                                                  0304 00480000
*        RESPECIFY GSPOINT BASED(PARMPTR3);                        0304 00481000
*                                      /* BASE GSPOINT               */ 00482000
*                                                                  0305 00483000
*        RESPECIFY GSINIT BASED(PARMPTR4);                         0305 00484000
*                                      /* BASE GSINIT                */ 00485000
*                                                                  0306 00486000
*        RESPECIFY GSSPID BASED(PARMPTR5);                         0306 00487000
*                                      /* BASE GSSID                 */ 00488000
*                                                                  0307 00489000
*        /************************************************************/ 00490000
*        /*                                                          */ 00491000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */ 00492000
*        /*                                                          */ 00493000
*        /************************************************************/ 00494000
*                                                                  0307 00495000
*        RESPECIFY (REG1PTR) RSTD;                                 0307 00496000
*        GDTPR = ADDR1;                                            0308 00497000
         L     GDTPR,ADDR1(,REG1PTR)                               0308 00498000
*        PARMPTR2 = ADDR2;                                         0309 00499000
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0309 00500000
*        PARMPTR3 = ADDR3;                                         0310 00501000
         L     PARMPTR3,ADDR3+8(,REG1PTR)                          0310 00502000
*        PARMPTR4 = ADDR4;                                         0311 00503000
         L     PARMPTR4,ADDR4+12(,REG1PTR)                         0311 00504000
*        PARMPTR5 = ADDR5;                                         0312 00505000
         L     @04,ADDR5+16(,REG1PTR)                              0312 00506000
         ST    @04,PARMPTR5                                        0312 00507000
*        RESPECIFY (REG1PTR) UNRSTD;                               0313 00508000
*                                                                  0313 00509000
*                                                                  0313 00510000
*                                                                  0314 00511000
*        /************************************************************/ 00512000
*        /*                                                          */ 00513000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 00514000
*        /*                                                          */ 00515000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 00516000
*        /*              TO THIS ROUTINE                             */ 00517000
*        /*                                                          */ 00518000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 00519000
*        /*               ADDRESS LIST                               */ 00520000
*        /*                                                          */ 00521000
*        /************************************************************/ 00522000
*                                                                  0314 00523000
*        GEN;                                                      0314 00524000
        ST    1,LISTPTR                                                 00525000
        ST    1,LISTSCAN                                                00526000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0315 00527000
         LA    @04,1                                               0315 00528000
         STC   @04,LISTLN                                          0315 00529000
@DL00315 L     @15,LISTSCAN                                        0315 00530000
         TM    LISTTEST(@15),B'10000000'                           0315 00531000
         BNZ   @DC00315                                            0315 00532000
*          LISTSCAN = LISTSCAN + 4;                                0316 00533000
         AL    @15,@CF00037                                        0316 00534000
         ST    @15,LISTSCAN                                        0316 00535000
*        END;                                                      0317 00536000
*                                                                  0317 00537000
         AL    @04,@CF00158                                        0317 00538000
         STC   @04,LISTLN                                          0317 00539000
         C     @04,@CF00634                                        0317 00540000
         BNH   @DL00315                                            0317 00541000
@DC00315 DS    0H                                                  0318 00542000
*        OLDERID2 = NEWERID2;                                      0318 00543000
         L     @07,GDTTR2(,GDTPR)                                  0318 00544000
         MVC   @TS00001(95),NEWERID2(@07)                          0318 00545000
         MVC   OLDERID2(95,@07),@TS00001                           0318 00546000
*        NEWID2 = 'SAGS';                                          0319 00547000
*                                                                  0319 00548000
         MVC   NEWID2(4,@07),@CC00635                              0319 00549000
*        /************************************************************/ 00550000
*        /*                                                          */ 00551000
*        /* ISSUE GETMAIN MACRO FOR REQUESTED CORE PLUS CONTROL      */ 00552000
*        /* INFORMATION AREA                                         */ 00553000
*        /* NOTE - CORE IS ALWAYS GOTTEN FROM SUBPOOL 0, BUT         */ 00554000
*        /* THE USER REQUESTED SUBPOOL ID IS PLACED IN THE           */ 00555000
*        /* CONTROL INFORMATION AREA.                                */ 00556000
*        /*                                                          */ 00557000
*        /************************************************************/ 00558000
*                                                                  0320 00559000
*        GETLIST = GETGEN;                                         0320 00560000
         MVC   GETLIST(10),GETGEN                                  0320 00561000
*        GETSZ = GSSIZE + 8;                                       0321 00562000
         LA    @07,8                                               0321 00563000
         AL    @07,GSSIZE(,PARMPTR2)                               0321 00564000
         ST    @07,GETSZ                                           0321 00565000
*        GETPT = ADDR(TEMPPTR);                                    0322 00566000
         LA    @07,TEMPPTR                                         0322 00567000
         ST    @07,GETPT                                           0322 00568000
*        CALL GETSTG;                                              0323 00569000
*                                                                  0323 00570000
*                                                                  0323 00571000
         BAL   @14,GETSTG                                          0323 00572000
*        /************************************************************/ 00573000
*        /*                                                          */ 00574000
*        /* IF NO CORE AVAILABLE FREE MODULES NOT IN USE             */ 00575000
*        /* AND TRY TO GETCORE AGAIN                                 */ 00576000
*        /*                                                          */ 00577000
*        /************************************************************/ 00578000
*                                                                  0324 00579000
*        IF TESTRC ^= 0                                            0324 00580000
*          THEN                                                    0324 00581000
         LTR   TESTRC,TESTRC                                       0324 00582000
         BZ    @RF00324                                            0324 00583000
*            DO;                                                   0325 00584000
*              CALL RELECORE;                                      0326 00585000
         BAL   @14,RELECORE                                        0326 00586000
*              CALL GETSTG;                                        0327 00587000
*                                                                  0327 00588000
         BAL   @14,GETSTG                                          0327 00589000
*              /******************************************************/ 00590000
*              /*                                                    */ 00591000
*              /* CHECK RETURN CODE FROM CORE REQUEST                */ 00592000
*              /*                                                    */ 00593000
*              /******************************************************/ 00594000
*                                                                  0328 00595000
*              IF TESTRC ^= 0                                      0328 00596000
*                THEN                                              0328 00597000
         SLR   @07,@07                                             0328 00598000
         CR    TESTRC,@07                                          0328 00599000
         BE    @RF00328                                            0328 00600000
*                  DO;                                             0329 00601000
*                    SETRC = 4;                                    0330 00602000
         MVC   SETRC(2),@CH00037                                   0330 00603000
*                    GSPOINT = 0;                                  0331 00604000
         ST    @07,GSPOINT(,PARMPTR3)                              0331 00605000
*                  END;                                            0332 00606000
*                ELSE                                              0333 00607000
*                  SETRC = 0;                                      0333 00608000
         B     @RC00328                                            0333 00609000
@RF00328 SLR   @04,@04                                             0333 00610000
         STH   @04,SETRC                                           0333 00611000
*            END;                                                  0334 00612000
*          ELSE                                                    0335 00613000
*            SETRC = 0;                                            0335 00614000
         B     @RC00324                                            0335 00615000
@RF00324 SLR   @04,@04                                             0335 00616000
         STH   @04,SETRC                                           0335 00617000
*        IF SETRC = 0                                              0336 00618000
*          THEN                                                    0336 00619000
@RC00324 LH    @04,SETRC                                           0336 00620000
         LTR   @04,@04                                             0336 00621000
         BNZ   @RF00336                                            0336 00622000
*            DO;                                                   0337 00623000
*                                                                  0337 00624000
*                                                                  0337 00625000
*              /******************************************************/ 00626000
*              /*                                                    */ 00627000
*              /* INITIALIZE THE UGSPACE AREA CONTROL INFORMATION,   */ 00628000
*              /* AND INITIALIZE THE UGSPACE AREA POINTER RETURNED   */ 00629000
*              /* TO THE USER                                        */ 00630000
*              /*                                                    */ 00631000
*              /******************************************************/ 00632000
*                                                                  0338 00633000
*              GSLEN = GETSZ;                                      0338 00634000
         L     @04,TEMPPTR                                         0338 00635000
         L     @15,GETSZ                                           0338 00636000
         ST    @15,GSLEN(,@04)                                     0338 00637000
*              GSID = ' ';                                         0339 00638000
         MVI   GSID+1(@04),C' '                                    0339 00639000
         MVC   GSID+2(2,@04),GSID+1(@04)                           0339 00640000
         MVI   GSID(@04),C' '                                      0339 00641000
*              GSPOINT = TEMPPTR + 8;                              0340 00642000
*                                                                  0340 00643000
         LA    @15,8                                               0340 00644000
         ALR   @15,@04                                             0340 00645000
         ST    @15,GSPOINT(,PARMPTR3)                              0340 00646000
*              /******************************************************/ 00647000
*              /*                                                    */ 00648000
*              /* BEFORE SETTING SUB-POOL ID, CHECK IF FIFTH         */ 00649000
*              /* ARGUMENT IS SPECIFIED                              */ 00650000
*              /*                                                    */ 00651000
*              /******************************************************/ 00652000
*                                                                  0341 00653000
*              IF LISTLN = 5                                       0341 00654000
*                THEN                                              0341 00655000
         CLI   LISTLN,5                                            0341 00656000
         BNE   @RF00341                                            0341 00657000
*                  GSSUBPID=GSSPID;                                0342 00658000
         L     @01,PARMPTR5                                        0342 00659000
         IC    @00,GSSPID(,@01)                                    0342 00660000
         STC   @00,GSSUBPID(,@04)                                  0342 00661000
*                ELSE                                              0343 00662000
*                  GSSUBPID = 0;                                   0343 00663000
*                                                                  0343 00664000
         B     @RC00341                                            0343 00665000
@RF00341 L     @04,TEMPPTR                                         0343 00666000
         MVI   GSSUBPID(@04),X'00'                                 0343 00667000
*              /******************************************************/ 00668000
*              /*                                                    */ 00669000
*              /* CHECK IF CORE INITIALIZATION REQUESTED BY CHECKING */ 00670000
*              /* FOR FOURTH ARGUMENT                                */ 00671000
*              /*                                                    */ 00672000
*              /******************************************************/ 00673000
*                                                                  0344 00674000
*              IF LISTLN >= 4                                      0344 00675000
*                THEN                                              0344 00676000
@RC00341 CLI   LISTLN,4                                            0344 00677000
         BL    @RF00344                                            0344 00678000
*                  DO;                                             0345 00679000
*                                                                  0345 00680000
*                    /************************************************/ 00681000
*                    /*                                              */ 00682000
*                    /* PREPARE FOR CORE INITIALIZATION              */ 00683000
*                    /*                                              */ 00684000
*                    /************************************************/ 00685000
*                                                                  0346 00686000
*                    INITSIZE = GSSIZE;                            0346 00687000
         L     @04,GSSIZE(,PARMPTR2)                               0346 00688000
         ST    @04,INITSIZE                                        0346 00689000
*                    INITPTR = GSPOINT;                            0347 00690000
*                                                                  0347 00691000
         L     @04,GSPOINT(,PARMPTR3)                              0347 00692000
         ST    @04,INITPTR                                         0347 00693000
*                    /************************************************/ 00694000
*                    /*                                              */ 00695000
*                    /* CHECK FOR INVALID FOURTH ARGUMENT, ABORT     */ 00696000
*                    /* IF INVALID                                   */ 00697000
*                    /*                                              */ 00698000
*                    /************************************************/ 00699000
*                                                                  0348 00700000
*                    IF GSINIT ^= 'ZERO' & GSINIT ^= 'BLNK'        0348 00701000
*                              & GSINIT ^= 'NSET'         /*         */ 00702000
*                      THEN                                        0348 00703000
*                                                                  0348 00704000
         CLC   GSINIT(4,PARMPTR4),@CC00138                         0348 00705000
         BE    @RF00348                                            0348 00706000
         CLC   GSINIT(4,PARMPTR4),@CC00140                         0348 00707000
         BE    @RF00348                                            0348 00708000
         CLC   GSINIT(4,PARMPTR4),@CC00142                         0348 00709000
         BE    @RF00348                                            0348 00710000
*                        DO;                                       0349 00711000
*                          RESPECIFY(REG13,REG14,REG15) RSTD;      0350 00712000
*                          REG15 = ARGERR;                         0351 00713000
         LA    REG15,40                                            0351 00714000
*                          REG14 = GDTABT;                         0352 00715000
         L     REG14,GDTABT(,GDTPR)                                0352 00716000
*                          REG13 = GDTABH;                         0353 00717000
         L     REG13,GDTABH(,GDTPR)                                0353 00718000
*                          GEN(BR    REG14);                       0354 00719000
         BR    REG14                                                    00720000
*                          RESPECIFY(REG13,REG14,REG15)UNRSTD;     0355 00721000
*                        END;                                      0356 00722000
*                                                                  0356 00723000
*                    /************************************************/ 00724000
*                    /*                                              */ 00725000
*                    /* CHECK FOR ZERO INITIALIZATION REQUEST        */ 00726000
*                    /*                                              */ 00727000
*                    /************************************************/ 00728000
*                                                                  0357 00729000
*                    IF GSINIT = 'ZERO'                            0357 00730000
*                      THEN                                        0357 00731000
*                                                                  0357 00732000
@RF00348 CLC   GSINIT(4,PARMPTR4),@CC00138                         0357 00733000
         BNE   @RF00357                                            0357 00734000
*                        /********************************************/ 00735000
*                        /*                                          */ 00736000
*                        /* ZERO AREA                                */ 00737000
*                        /*                                          */ 00738000
*                        /********************************************/ 00739000
*                                                                  0358 00740000
*                        CALL COREINIT(INITSIZE,INITPTR,SET0);     0358 00741000
*                                                                  0358 00742000
         LA    @15,INITSIZE                                        0358 00743000
         ST    @15,@AL00001                                        0358 00744000
         LA    @15,INITPTR                                         0358 00745000
         ST    @15,@AL00001+4                                      0358 00746000
         LA    @15,SET0                                            0358 00747000
         ST    @15,@AL00001+8                                      0358 00748000
         LA    @01,@AL00001                                        0358 00749000
         BAL   @14,COREINIT                                        0358 00750000
*                        /********************************************/ 00751000
*                        /*                                          */ 00752000
*                        /* CHECK FOR BLANK INITIALIZATION           */ 00753000
*                        /*                                          */ 00754000
*                        /********************************************/ 00755000
*                                                                  0359 00756000
*                      ELSE                                        0359 00757000
*                        IF GSINIT = 'BLNK'                        0359 00758000
*                          THEN                                    0359 00759000
*                                                                  0359 00760000
         B     @RC00357                                            0359 00761000
@RF00357 CLC   GSINIT(4,PARMPTR4),@CC00140                         0359 00762000
         BNE   @RF00359                                            0359 00763000
*                            /****************************************/ 00764000
*                            /*                                      */ 00765000
*                            /* BLANK AREA                           */ 00766000
*                            /*                                      */ 00767000
*                            /****************************************/ 00768000
*                                                                  0360 00769000
*                            CALL COREINIT(INITSIZE,INITPTR,SETB); 0360 00770000
         LA    @15,INITSIZE                                        0360 00771000
         ST    @15,@AL00001                                        0360 00772000
         LA    @15,INITPTR                                         0360 00773000
         ST    @15,@AL00001+4                                      0360 00774000
         LA    @15,SETB                                            0360 00775000
         ST    @15,@AL00001+8                                      0360 00776000
         LA    @01,@AL00001                                        0360 00777000
         BAL   @14,COREINIT                                        0360 00778000
*                  END;                                            0361 00779000
*            END;                                                  0362 00780000
*          ELSE;                                                   0363 00781000
*                                                                  0363 00782000
@RF00336 DS    0H                                                  0364 00783000
*        /************************************************************/ 00784000
*        /*                                                          */ 00785000
*        /* RETURN TO THE UGSPACE CALLER                             */ 00786000
*        /*                                                          */ 00787000
*        /************************************************************/ 00788000
*                                                                  0364 00789000
*        CALL ICKSAEP0(GDTTBL,MODID,SETRC);                        0364 00790000
@RC00336 ST    GDTPR,@AL00001                                      0364 00791000
         LA    @15,MODID                                           0364 00792000
         ST    @15,@AL00001+4                                      0364 00793000
         LA    @15,SETRC                                           0364 00794000
         ST    @15,@AL00001+8                                      0364 00795000
         MVI   @AL00001+8,X'80'                                    0364 00796000
         L     @15,GDTEPL(,GDTPR)                                  0364 00797000
         LA    @01,@AL00001                                        0364 00798000
         BALR  @14,@15                                             0364 00799000
*        /************************************************************/ 00800000
*        /************************************************************/ 00801000
*        /*                                                          */ 00802000
*        /* UFSPACE ENTRY POINT                                      */ 00803000
*        /*                                                          */ 00804000
*        /************************************************************/ 00805000
*        /************************************************************/ 00806000
*                                                                  0365 00807000
*DMSSAFS:  ENTRY(GDTTBLX,FSPOINTX);                                0365 00808000
*                                                                  0365 00809000
@EC00365 DS    0H                                                  0366 00810000
*DMSSAFS1:                                                         0366 00811000
*                                                                  0366 00812000
*        DCL FSPOINT PTR(31) BASED;    /* SPACE ADDR FOR UGSPACE     */ 00813000
*                                                                  0366 00814000
DMSSAFS1 DS    0H                                                  0367 00815000
*        RESPECIFY FSPOINT BASED(PARMPTR2);                        0367 00816000
*                                      /* BASE FSPOINT               */ 00817000
*                                                                  0368 00818000
*        DCL SPIDPTR PTR(31);          /* PTR TO SUBPOOL ID          */ 00819000
*                                                                  0368 00820000
*        /************************************************************/ 00821000
*        /*                                                          */ 00822000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */ 00823000
*        /*                                                          */ 00824000
*        /************************************************************/ 00825000
*                                                                  0369 00826000
*        RESPECIFY (REG1PTR) RSTD;                                 0369 00827000
*        GDTPR = ADDR1;                                            0370 00828000
         L     GDTPR,ADDR1(,REG1PTR)                               0370 00829000
*        PARMPTR2 = ADDR2;                                         0371 00830000
         LA    @15,4                                               0371 00831000
         LR    @14,REG1PTR                                         0371 00832000
         ALR   @14,@15                                             0371 00833000
         L     PARMPTR2,ADDR2(,@14)                                0371 00834000
*        RESPECIFY (REG1PTR) UNRSTD;                               0372 00835000
*                                                                  0372 00836000
*        OLDERID2 = NEWERID2;                                      0373 00837000
         L     @02,GDTTR2(,GDTPR)                                  0373 00838000
         MVC   @TS00001(95),NEWERID2(@02)                          0373 00839000
         MVC   OLDERID2(95,@02),@TS00001                           0373 00840000
*        NEWID2 = 'SAFS';                                          0374 00841000
*                                                                  0374 00842000
         MVC   NEWID2(4,@02),@CC00652                              0374 00843000
*        /************************************************************/ 00844000
*        /*                                                          */ 00845000
*        /* CHECK IF AREA TO BE FREED IS A UGSPACE OR UGPOOL AREA    */ 00846000
*        /*                                                          */ 00847000
*        /************************************************************/ 00848000
*                                                                  0375 00849000
*        TEMPPTR = FSPOINT - 4;                                    0375 00850000
         L     @02,FSPOINT(,PARMPTR2)                              0375 00851000
         SLR   @02,@15                                             0375 00852000
         ST    @02,TEMPPTR                                         0375 00853000
*        IF FREEID(1:3) = '   '                           /*         */ 00854000
*          THEN                                                    0376 00855000
         CLC   FREEID(3,@02),@CC00653                              0376 00856000
         BNE   @RF00376                                            0376 00857000
*            DO;                                                   0377 00858000
*                                                                  0377 00859000
*              /******************************************************/ 00860000
*              /*                                                    */ 00861000
*              /* FREE UGSPACE AREA                                  */ 00862000
*              /*                                                    */ 00863000
*              /******************************************************/ 00864000
*                                                                  0378 00865000
*              SPIDPTR = TEMPPTR - 4;                              0378 00866000
         L     @14,TEMPPTR                                         0378 00867000
         LCR   @15,@15                                             0378 00868000
         ALR   @15,@14                                             0378 00869000
         LR    SPIDPTR,@15                                         0378 00870000
*              SPIDPTR->GSLENID = FREEID(4:4);                     0379 00871000
         IC    @03,FREEID+3(,@14)                                  0379 00872000
         STC   @03,GSLENID(,SPIDPTR)                               0379 00873000
*              TEMPPTR = TEMPPTR - 4;                              0380 00874000
         ST    @15,TEMPPTR                                         0380 00875000
*              FREEPT = TEMPPTR;                                   0381 00876000
         ST    @15,FREEPT                                          0381 00877000
*              FREESZ = GSLEN;                                     0382 00878000
         L     @15,GSLEN(,@15)                                     0382 00879000
         ST    @15,FREESZ                                          0382 00880000
*              CALL FREESTG;                                       0383 00881000
         BAL   @14,FREESTG                                         0383 00882000
*            END;                                                  0384 00883000
*          ELSE                                                    0385 00884000
*            DO;                                                   0385 00885000
*                                                                  0385 00886000
         B     @RC00376                                            0385 00887000
@RF00376 DS    0H                                                  0386 00888000
*              /******************************************************/ 00889000
*              /*                                                    */ 00890000
*              /* CHECK IF UGPOOL AREA TO BE FREED IS THE LAST AREA  */ 00891000
*              /* IN THE UGPOOL CHAIN                                */ 00892000
*              /*                                                    */ 00893000
*              /******************************************************/ 00894000
*                                                                  0386 00895000
*              TEMPPTR = TEMPPTR - 12;                             0386 00896000
         L     @15,TEMPPTR                                         0386 00897000
         SL    @15,@CF00033                                        0386 00898000
         ST    @15,TEMPPTR                                         0386 00899000
*              IF GPLAST = TEMPPTR                                 0387 00900000
*                THEN                                              0387 00901000
         L     @14,GDTSAH(,GDTPR)                                  0387 00902000
         C     @15,GPLAST(,@14)                                    0387 00903000
         BNE   @RF00387                                            0387 00904000
*                  DO;                                             0388 00905000
*                                                                  0388 00906000
*                    /************************************************/ 00907000
*                    /*                                              */ 00908000
*                    /* UPDATE FORWARD CHAIN POINTER AND LAST UGPOOL */ 00909000
*                    /* AREA POINTER                                 */ 00910000
*                    /*                                              */ 00911000
*                    /************************************************/ 00912000
*                                                                  0389 00913000
*                    PREFWD = 0;                                   0389 00914000
         L     @15,GPBACK(,@15)                                    0389 00915000
         SLR   @07,@07                                             0389 00916000
         ST    @07,PREFWD(,@15)                                    0389 00917000
*                    GPLAST = GPBACK;                              0390 00918000
         ST    @15,GPLAST(,@14)                                    0390 00919000
*                  END;                                            0391 00920000
*                ELSE                                              0392 00921000
*                  DO;                                             0392 00922000
*                                                                  0392 00923000
         B     @RC00387                                            0392 00924000
@RF00387 DS    0H                                                  0393 00925000
*                    /************************************************/ 00926000
*                    /*                                              */ 00927000
*                    /* UPDATE FORWARD AND BACKWARD CHAIN POINTERS   */ 00928000
*                    /*                                              */ 00929000
*                    /************************************************/ 00930000
*                                                                  0393 00931000
*                    PREFWD = GPFORWRD;                            0393 00932000
         L     @15,TEMPPTR                                         0393 00933000
         L     @14,GPBACK(,@15)                                    0393 00934000
         L     @15,GPFORWRD(,@15)                                  0393 00935000
         ST    @15,PREFWD(,@14)                                    0393 00936000
*                    PASBACK = GPBACK;                             0394 00937000
         ST    @14,PASBACK(,@15)                                   0394 00938000
*                  END;                                            0395 00939000
*                                                                  0395 00940000
*              /******************************************************/ 00941000
*              /*                                                    */ 00942000
*              /* FREE UGPOOL AREA                                   */ 00943000
*              /*                                                    */ 00944000
*              /******************************************************/ 00945000
*                                                                  0396 00946000
*              FREEPT = TEMPPTR;                                   0396 00947000
@RC00387 L     @15,TEMPPTR                                         0396 00948000
         ST    @15,FREEPT                                          0396 00949000
*              FREESZ = GPLEN;                                     0397 00950000
         L     @15,GPLEN(,@15)                                     0397 00951000
         ST    @15,FREESZ                                          0397 00952000
*              CALL FREESTG;                                       0398 00953000
         BAL   @14,FREESTG                                         0398 00954000
*            END;                                                  0399 00955000
*                                                                  0399 00956000
*        /************************************************************/ 00957000
*        /*                                                          */ 00958000
*        /* RETURN TO THE UFSPACE CALLER                             */ 00959000
*        /*                                                          */ 00960000
*        /************************************************************/ 00961000
*                                                                  0400 00962000
*        CALL ICKSAEP0(GDTTBL,MODID);                              0400 00963000
@RC00376 ST    GDTPR,@AL00001                                      0400 00964000
         LA    @15,MODID                                           0400 00965000
         ST    @15,@AL00001+4                                      0400 00966000
         MVI   @AL00001+4,X'80'                                    0400 00967000
         L     @15,GDTEPL(,GDTPR)                                  0400 00968000
         LA    @01,@AL00001                                        0400 00969000
         BALR  @14,@15                                             0400 00970000
*        /************************************************************/ 00971000
*        /************************************************************/ 00972000
*        /*                                                          */ 00973000
*        /* UGPOOL ENTRY POINT                                       */ 00974000
*        /*                                                          */ 00975000
*        /************************************************************/ 00976000
*        /************************************************************/ 00977000
*                                                                  0401 00978000
*DMSSAGP:  ENTRY(GDTTBLX,GPSIZEX,GPPOINTX,GPIDVARX,GPINITX);       0401 00979000
*                                                                  0401 00980000
@EC00401 DS    0H                                                  0402 00981000
*DMSSAGP1:                                                         0402 00982000
*                                                                  0402 00983000
*        DCL GPSIZE FIXED(31) BASED;   /* SIZE FOR UGPOOL            */ 00984000
*                                                                  0402 00985000
DMSSAGP1 DS    0H                                                  0403 00986000
*        DCL GPPOINT PTR(31) BASED;    /* ADDR FOR UGPOOL            */ 00987000
*                                                                  0403 00988000
*        DCL GPIDVAR CHAR(4) BASED;    /* ID FOR UGPOOL              */ 00989000
*                                                                  0404 00990000
*        DCL GPINIT CHAR(4) BASED;     /* UGPOOL INIT ARGUMENT       */ 00991000
*                                                                  0405 00992000
*        DCL GPFCHAIN PTR(31) BASED(GPLAST);                       0406 00993000
*                                      /* UGPOOL FORWARD CHAIN       */ 00994000
*                                                                  0407 00995000
*        RESPECIFY GPSIZE BASED(PARMPTR2);                         0407 00996000
*                                      /* BASE GPSIZE                */ 00997000
*                                                                  0408 00998000
*        RESPECIFY GPPOINT BASED(PARMPTR3);                        0408 00999000
*                                      /* BASE GPPOINT               */ 01000000
*                                                                  0409 01001000
*        RESPECIFY GPIDVAR BASED(PARMPTR4);                        0409 01002000
*                                      /* BASE GPIDVAR               */ 01003000
*                                                                  0410 01004000
*        RESPECIFY GPINIT BASED(PARMPTR5);                         0410 01005000
*                                      /* BASE GPINIT                */ 01006000
*                                                                  0411 01007000
*        DCL PGCNTPTR PTR(31);         /* PTR TO 24-BYTE CONTROL INFO   01008000
*                                                                    */ 01009000
*                                                                  0411 01010000
*        /************************************************************/ 01011000
*        /*                                                          */ 01012000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */ 01013000
*        /*                                                          */ 01014000
*        /************************************************************/ 01015000
*                                                                  0412 01016000
*        RESPECIFY (REG1PTR) RSTD;                                 0412 01017000
*        GDTPR = ADDR1;                                            0413 01018000
         L     GDTPR,ADDR1(,REG1PTR)                               0413 01019000
*        PARMPTR2 = ADDR2;                                         0414 01020000
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0414 01021000
*        PARMPTR3 = ADDR3;                                         0415 01022000
         L     PARMPTR3,ADDR3+8(,REG1PTR)                          0415 01023000
*        PARMPTR4 = ADDR4;                                         0416 01024000
         L     PARMPTR4,ADDR4+12(,REG1PTR)                         0416 01025000
*        PARMPTR5 = ADDR5;                                         0417 01026000
         L     @04,ADDR5+16(,REG1PTR)                              0417 01027000
         ST    @04,PARMPTR5                                        0417 01028000
*        RESPECIFY (REG1PTR) UNRSTD;                               0418 01029000
*                                                                  0418 01030000
*                                                                  0418 01031000
*                                                                  0419 01032000
*        /************************************************************/ 01033000
*        /*                                                          */ 01034000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 01035000
*        /*                                                          */ 01036000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 01037000
*        /*              TO THIS ROUTINE                             */ 01038000
*        /*                                                          */ 01039000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 01040000
*        /*               ADDRESS LIST                               */ 01041000
*        /*                                                          */ 01042000
*        /************************************************************/ 01043000
*                                                                  0419 01044000
*        GEN;                                                      0419 01045000
        ST    1,LISTPTR                                                 01046000
        ST    1,LISTSCAN                                                01047000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0420 01048000
         LA    @04,1                                               0420 01049000
         STC   @04,LISTLN                                          0420 01050000
@DL00420 L     @15,LISTSCAN                                        0420 01051000
         TM    LISTTEST(@15),B'10000000'                           0420 01052000
         BNZ   @DC00420                                            0420 01053000
*          LISTSCAN = LISTSCAN + 4;                                0421 01054000
         AL    @15,@CF00037                                        0421 01055000
         ST    @15,LISTSCAN                                        0421 01056000
*        END;                                                      0422 01057000
*                                                                  0422 01058000
         AL    @04,@CF00158                                        0422 01059000
         STC   @04,LISTLN                                          0422 01060000
         C     @04,@CF00634                                        0422 01061000
         BNH   @DL00420                                            0422 01062000
@DC00420 DS    0H                                                  0423 01063000
*        OLDERID2 = NEWERID2;                                      0423 01064000
         L     @04,GDTTR2(,GDTPR)                                  0423 01065000
         MVC   @TS00001(95),NEWERID2(@04)                          0423 01066000
         MVC   OLDERID2(95,@04),@TS00001                           0423 01067000
*        NEWID2 = 'SAGP';                                          0424 01068000
*                                                                  0424 01069000
         MVC   NEWID2(4,@04),@CC00680                              0424 01070000
*        RESPECIFY (REG4) RSTD;                                    0425 01071000
*                                                                  0425 01072000
*        /************************************************************/ 01073000
*        /*                                                          */ 01074000
*        /* CHECK FOR A GET POOL REQUEST ON A PAGE BOUNDARY, IF YES, */ 01075000
*        /* A GETMAIN MUST BE ISSUED FOR THE PAGE BOUNDARY           */ 01076000
*        /* CORE WITH NO CONTROL INFORMATION AREA, OTHERWISE         */ 01077000
*        /* THE CONTROL INFORMATION IS ADDED TO THE GETMAIN          */ 01078000
*        /* REQUEST.                                                 */ 01079000
*        /*                                                          */ 01080000
*        /************************************************************/ 01081000
*                                                                  0426 01082000
*        IF GPIDVAR(3:4) = 'PG'                                    0426 01083000
*          THEN                                                    0426 01084000
         CLC   GPIDVAR+2(2,PARMPTR4),@CC00681                      0426 01085000
         BNE   @RF00426                                            0426 01086000
*            DO;                                                   0427 01087000
*              GETLIST = GETGENPG;                                 0428 01088000
         MVC   GETLIST(10),GETGENPG                                0428 01089000
*              GETSZ = GPSIZE;                                     0429 01090000
         L     @15,GPSIZE(,PARMPTR2)                               0429 01091000
         ST    @15,GETSZ                                           0429 01092000
*            END;                                                  0430 01093000
*          ELSE                                                    0431 01094000
*            DO;                                                   0431 01095000
         B     @RC00426                                            0431 01096000
@RF00426 DS    0H                                                  0432 01097000
*              GETLIST = GETGEN;                                   0432 01098000
         MVC   GETLIST(10),GETGEN                                  0432 01099000
*              GETSZ = GPSIZE + 16;                                0433 01100000
         LA    @15,16                                              0433 01101000
         AL    @15,GPSIZE(,PARMPTR2)                               0433 01102000
         ST    @15,GETSZ                                           0433 01103000
*            END;                                                  0434 01104000
*                                                                  0434 01105000
*        /************************************************************/ 01106000
*        /*                                                          */ 01107000
*        /* OBTAIN THE REQUESTED STORAGE                             */ 01108000
*        /*                                                          */ 01109000
*        /************************************************************/ 01110000
*                                                                  0435 01111000
*        GETPT = ADDR(TEMPPTR);                                    0435 01112000
@RC00426 LA    @07,TEMPPTR                                         0435 01113000
         ST    @07,GETPT                                           0435 01114000
*        CALL GETSTG;                                              0436 01115000
*                                                                  0436 01116000
*                                                                  0436 01117000
         BAL   @14,GETSTG                                          0436 01118000
*        /************************************************************/ 01119000
*        /*                                                          */ 01120000
*        /* CHECK RETURN CODE FROM CORE REQUEST                      */ 01121000
*        /*                                                          */ 01122000
*        /************************************************************/ 01123000
*                                                                  0437 01124000
*        IF TESTRC ^= 0                                            0437 01125000
*          THEN                                                    0437 01126000
         LTR   TESTRC,TESTRC                                       0437 01127000
         BZ    @RF00437                                            0437 01128000
*            DO;                                                   0438 01129000
*              /******************************************************/ 01130000
*              /*                                                    */ 01131000
*              /* NO CORE AVAILABLE DELETE MODULES NOT IN            */ 01132000
*              /* USE AND TRY GET CORE AGAIN                         */ 01133000
*              /*                                                    */ 01134000
*              /******************************************************/ 01135000
*                                                                  0439 01136000
*              CALL RELECORE;                                      0439 01137000
         BAL   @14,RELECORE                                        0439 01138000
*              CALL GETSTG;                                        0440 01139000
*                                                                  0440 01140000
         BAL   @14,GETSTG                                          0440 01141000
*              /******************************************************/ 01142000
*              /*                                                    */ 01143000
*              /* CHECK RETURN CODE FROM CORE REQUEST                */ 01144000
*              /*                                                    */ 01145000
*              /******************************************************/ 01146000
*                                                                  0441 01147000
*              IF TESTRC ^= 0                                      0441 01148000
*                THEN                                              0441 01149000
         SLR   @07,@07                                             0441 01150000
         CR    TESTRC,@07                                          0441 01151000
         BE    @RF00441                                            0441 01152000
*                  DO;                                             0442 01153000
*                    SETRC = 4;                                    0443 01154000
         MVC   SETRC(2),@CH00037                                   0443 01155000
*                    GPPOINT = 0;                                  0444 01156000
         ST    @07,GPPOINT(,PARMPTR3)                              0444 01157000
*                  END;                                            0445 01158000
*                ELSE                                              0446 01159000
*                  SETRC = 0;                                      0446 01160000
         B     @RC00441                                            0446 01161000
@RF00441 SLR   @07,@07                                             0446 01162000
         STH   @07,SETRC                                           0446 01163000
*            END;                                                  0447 01164000
*          ELSE                                                    0448 01165000
*            SETRC = 0;                                            0448 01166000
         B     @RC00437                                            0448 01167000
@RF00437 SLR   @07,@07                                             0448 01168000
         STH   @07,SETRC                                           0448 01169000
*        IF TESTRC = 0                                             0449 01170000
*          THEN                                                    0449 01171000
@RC00437 LTR   TESTRC,TESTRC                                       0449 01172000
         BNZ   @RF00449                                            0449 01173000
*            DO;                                                   0450 01174000
*                                                                  0450 01175000
*                                                                  0450 01176000
*              /******************************************************/ 01177000
*              /*                                                    */ 01178000
*              /* CHECK FOR A GET POOL REQUEST ON A PAGE BOUNDARY,   */ 01179000
*              /* IF YES, ISSUE GETMAIN FOR A 24-BYTE                */ 01180000
*              /* CONTROL INFORMATION AREA.                          */ 01181000
*              /*                                                    */ 01182000
*              /******************************************************/ 01183000
*                                                                  0451 01184000
*              IF GPIDVAR(3:4) = 'PG'                              0451 01185000
*                THEN                                              0451 01186000
         CLC   GPIDVAR+2(2,PARMPTR4),@CC00681                      0451 01187000
         BNE   @RF00451                                            0451 01188000
*PGCNTRL:          DO;                                             0452 01189000
PGCNTRL  DS    0H                                                  0453 01190000
*                    GETLIST = GETGEN;                             0453 01191000
         MVC   GETLIST(10),GETGEN                                  0453 01192000
*                    GETSZ = PGCTLEN;                              0454 01193000
         L     @07,PGCTLEN                                         0454 01194000
         ST    @07,GETSZ                                           0454 01195000
*                    GETPT = ADDR(PGCNTPTR);                       0455 01196000
         LA    @07,PGCNTPTR                                        0455 01197000
         ST    @07,GETPT                                           0455 01198000
*                    CALL GETSTG;                                  0456 01199000
*                                                                  0456 01200000
         BAL   @14,GETSTG                                          0456 01201000
*                    /************************************************/ 01202000
*                    /*                                              */ 01203000
*                    /* CKECK RETURN CODE FROM CORE REQUEST          */ 01204000
*                    /*                                              */ 01205000
*                    /************************************************/ 01206000
*                                                                  0457 01207000
*                    IF TESTRC ^= 0                                0457 01208000
*                      THEN                                        0457 01209000
         LTR   TESTRC,TESTRC                                       0457 01210000
         BZ    @RF00457                                            0457 01211000
*                        DO;                                       0458 01212000
*                                                                  0458 01213000
*                          /******************************************/ 01214000
*                          /*                                        */ 01215000
*                          /* NO CORE AVAILABLE DELETE MODULES       */ 01216000
*                          /* NOT IN USE AND TRY TO GET CORE AGAIN   */ 01217000
*                          /*                                        */ 01218000
*                          /******************************************/ 01219000
*                                                                  0459 01220000
*                          CALL RELECORE;                          0459 01221000
         BAL   @14,RELECORE                                        0459 01222000
*                          CALL GETSTG;                            0460 01223000
*                                                                  0460 01224000
         BAL   @14,GETSTG                                          0460 01225000
*                            IF TESTRC ^= 0                        0461 01226000
*                              THEN                                0461 01227000
         SLR   @08,@08                                             0461 01228000
         CR    TESTRC,@08                                          0461 01229000
         BE    @RF00461                                            0461 01230000
*                                DO;                               0462 01231000
*                                  /**********************************/ 01232000
*                                  /*                                */ 01233000
*                                  /* THE REQUEST FOR MAIN STORAGE   */ 01234000
*                                  /* FAILED,SET THE RETURN CODE,ZERO*/ 01235000
*                                  /* OUT USER GETPOOL PTR, FREE THE */ 01236000
*                                  /* PAGE BOUNDARY CORE AND RETURN  */ 01237000
*                                  /* TO THE UGPOOL CALLER.          */ 01238000
*                                  /*                                */ 01239000
*                                  /**********************************/ 01240000
*                                                                  0463 01241000
*                                  SETRC = 4;                      0463 01242000
         MVC   SETRC(2),@CH00037                                   0463 01243000
*                                  GPPOINT = 0;                    0464 01244000
*                                                                  0464 01245000
         ST    @08,GPPOINT(,PARMPTR3)                              0464 01246000
*                                  FREEPT = TEMPPTR;               0465 01247000
         L     @08,TEMPPTR                                         0465 01248000
         ST    @08,FREEPT                                          0465 01249000
*                                  FREESZ = GPSIZE;                0466 01250000
         L     @08,GPSIZE(,PARMPTR2)                               0466 01251000
         ST    @08,FREESZ                                          0466 01252000
*                                  CALL FREESTG;                   0467 01253000
*                                                                  0467 01254000
         BAL   @14,FREESTG                                         0467 01255000
*                                  CALL ICKSAEP0(GDTTBL,MODID,SETRC);   01256000
         ST    GDTPR,@AL00001                                      0468 01257000
         LA    @08,MODID                                           0468 01258000
         ST    @08,@AL00001+4                                      0468 01259000
         LA    @08,SETRC                                           0468 01260000
         ST    @08,@AL00001+8                                      0468 01261000
         MVI   @AL00001+8,X'80'                                    0468 01262000
         L     @15,GDTEPL(,GDTPR)                                  0468 01263000
         LA    @01,@AL00001                                        0468 01264000
         BALR  @14,@15                                             0468 01265000
*                                END;                              0469 01266000
*                        END;                                      0470 01267000
@RF00461 DS    0H                                                  0471 01268000
*                  END PGCNTRL;                                    0471 01269000
*                                                                  0471 01270000
@RF00457 DS    0H                                                  0472 01271000
*              /******************************************************/ 01272000
*              /*                                                    */ 01273000
*              /* INITIALIZE THE UGPOOL AREA CONTROL INFORMATION,    */ 01274000
*              /* AND INITIALIZE THE UGPOOL AREA POINTER RETURNED TO */ 01275000
*              /* THE USER                                           */ 01276000
*              /* NOTE - FOR A 24-BYTE CONTROL INFORMATION           */ 01277000
*              /* AREA, THE ADDR AND LEN OF THE PAGE BOUNDARY        */ 01278000
*              /* CORE IS STORED IN WORDS 5 AND 6.                   */ 01279000
*              /*                                                    */ 01280000
*              /******************************************************/ 01281000
*                                                                  0472 01282000
*              IF GPIDVAR(3:4) = 'PG'                              0472 01283000
*                THEN                                              0472 01284000
@RF00451 CLC   GPIDVAR+2(2,PARMPTR4),@CC00681                      0472 01285000
         BNE   @RF00472                                            0472 01286000
*                  DO;                                             0473 01287000
*                    PGCNTPTR->GPADRPG = TEMPPTR;                  0474 01288000
         L     @08,TEMPPTR                                         0474 01289000
         L     @15,PGCNTPTR                                        0474 01290000
         ST    @08,GPADRPG(,@15)                                   0474 01291000
*                    PGCNTPTR->GPLENPG = GPSIZE;                   0475 01292000
         L     @14,GPSIZE(,PARMPTR2)                               0475 01293000
         ST    @14,GPLENPG(,@15)                                   0475 01294000
*                    PGCNTPTR->GPLEN = PGCTLEN;                    0476 01295000
         L     @14,PGCTLEN                                         0476 01296000
         ST    @14,GPLEN(,@15)                                     0476 01297000
*                    GPPOINT = TEMPPTR;                            0477 01298000
         ST    @08,GPPOINT(,PARMPTR3)                              0477 01299000
*                    TEMPPTR = PGCNTPTR;                           0478 01300000
         ST    @15,TEMPPTR                                         0478 01301000
*                  END;                                            0479 01302000
*                ELSE                                              0480 01303000
*                  DO;                                             0480 01304000
         B     @RC00472                                            0480 01305000
@RF00472 DS    0H                                                  0481 01306000
*                    GPLEN = GPSIZE + 16;                          0481 01307000
         L     @08,TEMPPTR                                         0481 01308000
         LA    @15,16                                              0481 01309000
         L     @14,GPSIZE(,PARMPTR2)                               0481 01310000
         ALR   @14,@15                                             0481 01311000
         ST    @14,GPLEN(,@08)                                     0481 01312000
*                    GPPOINT = TEMPPTR + 16;                       0482 01313000
         ALR   @08,@15                                             0482 01314000
         ST    @08,GPPOINT(,PARMPTR3)                              0482 01315000
*                  END;                                            0483 01316000
*                                                                  0483 01317000
*                                                                  0483 01318000
*              GPFORWRD = 0;                                       0484 01319000
@RC00472 L     @08,TEMPPTR                                         0484 01320000
         SLR   @15,@15                                             0484 01321000
         ST    @15,GPFORWRD(,@08)                                  0484 01322000
*              GPID = GPIDVAR;                                     0485 01323000
         MVC   GPID(4,@08),GPIDVAR(PARMPTR4)                       0485 01324000
*              GPBACK = GPLAST;                                    0486 01325000
         L     @05,GDTSAH(,GDTPR)                                  0486 01326000
         L     @15,GPLAST(,@05)                                    0486 01327000
         ST    @15,GPBACK(,@08)                                    0486 01328000
*              GPFCHAIN = TEMPPTR;                                 0487 01329000
         ST    @08,GPFCHAIN(,@15)                                  0487 01330000
*              GPLAST = TEMPPTR;                                   0488 01331000
*                                                                  0488 01332000
         ST    @08,GPLAST(,@05)                                    0488 01333000
*              /******************************************************/ 01334000
*              /*                                                    */ 01335000
*              /* CHECK IF CORE INITIALIZATION REQUESTED             */ 01336000
*              /*                                                    */ 01337000
*              /******************************************************/ 01338000
*                                                                  0489 01339000
*              IF LISTLN = 5                                       0489 01340000
*                THEN                                              0489 01341000
         CLI   LISTLN,5                                            0489 01342000
         BNE   @RF00489                                            0489 01343000
*                  DO;                                             0490 01344000
*                                                                  0490 01345000
*                    /************************************************/ 01346000
*                    /*                                              */ 01347000
*                    /* PREPARE FOR CORE INITIALIZATION              */ 01348000
*                    /*                                              */ 01349000
*                    /************************************************/ 01350000
*                                                                  0491 01351000
*                    INITSIZE = GPSIZE;                            0491 01352000
         L     @08,GPSIZE(,PARMPTR2)                               0491 01353000
         ST    @08,INITSIZE                                        0491 01354000
*                    INITPTR = GPPOINT;                            0492 01355000
*                                                                  0492 01356000
         L     @08,GPPOINT(,PARMPTR3)                              0492 01357000
         ST    @08,INITPTR                                         0492 01358000
*                    /************************************************/ 01359000
*                    /*                                              */ 01360000
*                    /* CHECK FOR INVALID LAST ARGUMENT              */ 01361000
*                    /*                                              */ 01362000
*                    /************************************************/ 01363000
*                                                                  0493 01364000
*                    IF GPINIT ^= 'BLNK' & GPINIT ^= 'ZERO'        0493 01365000
*                      THEN                                        0493 01366000
*                                                                  0493 01367000
         L     @08,PARMPTR5                                        0493 01368000
         CLC   GPINIT(4,@08),@CC00140                              0493 01369000
         BE    @RF00493                                            0493 01370000
         CLC   GPINIT(4,@08),@CC00138                              0493 01371000
         BE    @RF00493                                            0493 01372000
*                        DO;                                       0494 01373000
*                          RESPECIFY(REG13,REG14,REG15) RSTD;      0495 01374000
*                          REG15 = ARGERR;                         0496 01375000
         LA    REG15,40                                            0496 01376000
*                          REG14 = GDTABT;                         0497 01377000
         L     REG14,GDTABT(,GDTPR)                                0497 01378000
*                          REG13 = GDTABH;                         0498 01379000
         L     REG13,GDTABH(,GDTPR)                                0498 01380000
*                          GEN(BR    REG14);                       0499 01381000
         BR    REG14                                                    01382000
*                          RESPECIFY(REG13,REG14,REG15)UNRSTD;     0500 01383000
*                        END;                                      0501 01384000
*                                                                  0501 01385000
*                    /************************************************/ 01386000
*                    /*                                              */ 01387000
*                    /* CHECK FOR ZERO INITIALIZATION REQUEST        */ 01388000
*                    /*                                              */ 01389000
*                    /************************************************/ 01390000
*                                                                  0502 01391000
*                    IF GPINIT = 'ZERO'                            0502 01392000
*                      THEN                                        0502 01393000
*                                                                  0502 01394000
@RF00493 L     @08,PARMPTR5                                        0502 01395000
         CLC   GPINIT(4,@08),@CC00138                              0502 01396000
         BNE   @RF00502                                            0502 01397000
*                        /********************************************/ 01398000
*                        /*                                          */ 01399000
*                        /* ZERO AREA                                */ 01400000
*                        /*                                          */ 01401000
*                        /********************************************/ 01402000
*                                                                  0503 01403000
*                        CALL COREINIT(INITSIZE,INITPTR,SET0);     0503 01404000
         LA    @08,INITSIZE                                        0503 01405000
         ST    @08,@AL00001                                        0503 01406000
         LA    @08,INITPTR                                         0503 01407000
         ST    @08,@AL00001+4                                      0503 01408000
         LA    @08,SET0                                            0503 01409000
         ST    @08,@AL00001+8                                      0503 01410000
         LA    @01,@AL00001                                        0503 01411000
         BAL   @14,COREINIT                                        0503 01412000
*                      ELSE                                        0504 01413000
*                                                                  0504 01414000
*                        /********************************************/ 01415000
*                        /*                                          */ 01416000
*                        /* BLANK AREA                               */ 01417000
*                        /*                                          */ 01418000
*                        /********************************************/ 01419000
*                                                                  0504 01420000
*                        CALL COREINIT(INITSIZE,INITPTR,SETB);     0504 01421000
         B     @RC00502                                            0504 01422000
@RF00502 LA    @08,INITSIZE                                        0504 01423000
         ST    @08,@AL00001                                        0504 01424000
         LA    @08,INITPTR                                         0504 01425000
         ST    @08,@AL00001+4                                      0504 01426000
         LA    @08,SETB                                            0504 01427000
         ST    @08,@AL00001+8                                      0504 01428000
         LA    @01,@AL00001                                        0504 01429000
         BAL   @14,COREINIT                                        0504 01430000
*                  END;                                            0505 01431000
*            END;                                                  0506 01432000
*          ELSE;                                                   0507 01433000
*                                                                  0507 01434000
@RF00449 DS    0H                                                  0508 01435000
*        /************************************************************/ 01436000
*        /*                                                          */ 01437000
*        /* RETURN TO THE UGPOOL CALLER                              */ 01438000
*        /*                                                          */ 01439000
*        /************************************************************/ 01440000
*                                                                  0508 01441000
*        CALL ICKSAEP0(GDTTBL,MODID,SETRC);                        0508 01442000
@RC00449 ST    GDTPR,@AL00001                                      0508 01443000
         LA    @08,MODID                                           0508 01444000
         ST    @08,@AL00001+4                                      0508 01445000
         LA    @08,SETRC                                           0508 01446000
         ST    @08,@AL00001+8                                      0508 01447000
         MVI   @AL00001+8,X'80'                                    0508 01448000
         L     @15,GDTEPL(,GDTPR)                                  0508 01449000
         LA    @01,@AL00001                                        0508 01450000
         BALR  @14,@15                                             0508 01451000
*        /************************************************************/ 01452000
*        /************************************************************/ 01453000
*        /*                                                          */ 01454000
*        /* UFPOOL ENTRY POINT                                       */ 01455000
*        /*                                                          */ 01456000
*        /************************************************************/ 01457000
*        /************************************************************/ 01458000
*                                                                  0509 01459000
*DMSSAFP:  ENTRY(GDTTBLX,FPIDVARX,FPALLX);                         0509 01460000
*                                                                  0509 01461000
@EC00509 DS    0H                                                  0510 01462000
*DMSSAFP1:                                                         0510 01463000
*                                                                  0510 01464000
*        DCL FPIDVAR CHAR(4) BASED;    /* SPACE ID FOR UFPOOL        */ 01465000
*                                                                  0510 01466000
DMSSAFP1 DS    0H                                                  0511 01467000
*        DCL FPALL CHAR(3) BASED;      /* UFPOOL ALL ARGUMENT        */ 01468000
*                                                                  0511 01469000
*        RESPECIFY FPIDVAR BASED(PARMPTR2);                        0512 01470000
*                                      /* BASE FPIDVAR               */ 01471000
*                                                                  0513 01472000
*        RESPECIFY FPALL BASED(PARMPTR3);                          0513 01473000
*                                      /* BASE FPALL                 */ 01474000
*                                                                  0514 01475000
*        /************************************************************/ 01476000
*        /*                                                          */ 01477000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */ 01478000
*        /*                                                          */ 01479000
*        /************************************************************/ 01480000
*                                                                  0514 01481000
*        RESPECIFY (REG1PTR) RSTD;                                 0514 01482000
*        GDTPR = ADDR1;                                            0515 01483000
         L     GDTPR,ADDR1(,REG1PTR)                               0515 01484000
*        PARMPTR2 = ADDR2;                                         0516 01485000
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0516 01486000
*        PARMPTR3 = ADDR3;                                         0517 01487000
         L     PARMPTR3,ADDR3+8(,REG1PTR)                          0517 01488000
*        RESPECIFY (REG1PTR) UNRSTD;                               0518 01489000
*                                                                  0518 01490000
*                                                                  0518 01491000
*                                                                  0519 01492000
*        /************************************************************/ 01493000
*        /*                                                          */ 01494000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 01495000
*        /*                                                          */ 01496000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 01497000
*        /*              TO THIS ROUTINE                             */ 01498000
*        /*                                                          */ 01499000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 01500000
*        /*               ADDRESS LIST                               */ 01501000
*        /*                                                          */ 01502000
*        /************************************************************/ 01503000
*                                                                  0519 01504000
*        GEN;                                                      0519 01505000
        ST    1,LISTPTR                                                 01506000
        ST    1,LISTSCAN                                                01507000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0520 01508000
         LA    @08,1                                               0520 01509000
         STC   @08,LISTLN                                          0520 01510000
@DL00520 L     @05,LISTSCAN                                        0520 01511000
         TM    LISTTEST(@05),B'10000000'                           0520 01512000
         BNZ   @DC00520                                            0520 01513000
*          LISTSCAN = LISTSCAN + 4;                                0521 01514000
         AL    @05,@CF00037                                        0521 01515000
         ST    @05,LISTSCAN                                        0521 01516000
*        END;                                                      0522 01517000
*                                                                  0522 01518000
         AL    @08,@CF00158                                        0522 01519000
         STC   @08,LISTLN                                          0522 01520000
         C     @08,@CF00634                                        0522 01521000
         BNH   @DL00520                                            0522 01522000
@DC00520 DS    0H                                                  0523 01523000
*        OLDERID2 = NEWERID2;                                      0523 01524000
         L     @08,GDTTR2(,GDTPR)                                  0523 01525000
         MVC   @TS00001(95),NEWERID2(@08)                          0523 01526000
         MVC   OLDERID2(95,@08),@TS00001                           0523 01527000
*        NEWID2 = 'SAFP';                                          0524 01528000
*                                                                  0524 01529000
         MVC   NEWID2(4,@08),@CC00699                              0524 01530000
*        /************************************************************/ 01531000
*        /*                                                          */ 01532000
*        /* CHECK FOR INVALID LAST ARGUMENT                          */ 01533000
*        /*                                                          */ 01534000
*        /************************************************************/ 01535000
*                                                                  0525 01536000
*        IF LISTPTR = 3 & FPALL ^= 'ALL'                           0525 01537000
*          THEN                                                    0525 01538000
*                                                                  0525 01539000
         CLC   LISTPTR(4),@CF00129                                 0525 01540000
         BNE   @RF00525                                            0525 01541000
         CLC   FPALL(3,PARMPTR3),@CC00130                          0525 01542000
         BE    @RF00525                                            0525 01543000
*            DO;                                                   0526 01544000
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  0527 01545000
*              REG15 = ARGERR;                                     0528 01546000
         LA    REG15,40                                            0528 01547000
*              REG14 = GDTABT;                                     0529 01548000
         L     REG14,GDTABT(,GDTPR)                                0529 01549000
*              REG13 = GDTABH;                                     0530 01550000
         L     REG13,GDTABH(,GDTPR)                                0530 01551000
*              GEN(BR    REG14);                                   0531 01552000
         BR    REG14                                                    01553000
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 0532 01554000
*            END;                                                  0533 01555000
*                                                                  0533 01556000
*        /************************************************************/ 01557000
*        /*                                                          */ 01558000
*        /* CHECK FOR NO UGPOOL AREAS TO FREE                        */ 01559000
*        /*                                                          */ 01560000
*        /************************************************************/ 01561000
*                                                                  0534 01562000
*        IF GPFIRST = 0                                            0534 01563000
*          THEN                                                    0534 01564000
@RF00525 L     @08,GDTSAH(,GDTPR)                                  0534 01565000
         L     @08,GPFIRST(,@08)                                   0534 01566000
         LTR   @08,@08                                             0534 01567000
         BNZ   @RF00534                                            0534 01568000
*            DO;                                                   0535 01569000
*              CALL ICKSAEP0(GDTTBL,MODID);                        0536 01570000
         ST    GDTPR,@AL00001                                      0536 01571000
         LA    @08,MODID                                           0536 01572000
         ST    @08,@AL00001+4                                      0536 01573000
         MVI   @AL00001+4,X'80'                                    0536 01574000
         L     @15,GDTEPL(,GDTPR)                                  0536 01575000
         LA    @01,@AL00001                                        0536 01576000
         BALR  @14,@15                                             0536 01577000
*            END;                                                  0537 01578000
*                                                                  0537 01579000
*        /************************************************************/ 01580000
*        /*                                                          */ 01581000
*        /* SCAN UGPOOL AREAS AND RELEASE AREAS TO BE RELEASED       */ 01582000
*        /*                                                          */ 01583000
*        /************************************************************/ 01584000
*                                                                  0538 01585000
*        DOCNTRL = ON;                                             0538 01586000
@RF00534 OI    DOCNTRL,B'10000000'                                 0538 01587000
*        TEMPPTR = GPFIRST;                                        0539 01588000
         L     @08,GDTSAH(,GDTPR)                                  0539 01589000
         L     @08,GPFIRST(,@08)                                   0539 01590000
         ST    @08,TEMPPTR                                         0539 01591000
*FPDO:   DO WHILE (DOCNTRL = ON);                                  0540 01592000
*                                                                  0540 01593000
FPDO     B     @DE00540                                            0540 01594000
@DL00540 DS    0H                                                  0541 01595000
*          /**********************************************************/ 01596000
*          /*                                                        */ 01597000
*          /* CHECK IF THIS AREA IS TO BE FREED                      */ 01598000
*          /*                                                        */ 01599000
*          /**********************************************************/ 01600000
*                                                                  0541 01601000
*          IF (LISTLN=3 & GPID(1:2)=FPIDVAR(1:2)) | (GPID=FPIDVAR) 0541 01602000
*            THEN                                                  0541 01603000
         CLI   LISTLN,3                                            0541 01604000
         BNE   @GL00005                                            0541 01605000
         L     @08,TEMPPTR                                         0541 01606000
         CLC   GPID(2,@08),FPIDVAR(PARMPTR2)                       0541 01607000
         BE    @RT00541                                            0541 01608000
@GL00005 L     @08,TEMPPTR                                         0541 01609000
         CLC   GPID(4,@08),FPIDVAR(PARMPTR2)                       0541 01610000
         BNE   @RF00541                                            0541 01611000
@RT00541 DS    0H                                                  0542 01612000
*              DO;                                                 0542 01613000
*                                                                  0542 01614000
*                /****************************************************/ 01615000
*                /*                                                  */ 01616000
*                /* CHECK IF UGPOOL AREA TO BE FREED IS THE LAST AREA*/ 01617000
*                /* IN THE UGPOOL CHAIN                              */ 01618000
*                /*                                                  */ 01619000
*                /****************************************************/ 01620000
*                                                                  0543 01621000
*                IF GPLAST = TEMPPTR                               0543 01622000
*                  THEN                                            0543 01623000
         L     @08,TEMPPTR                                         0543 01624000
         L     @05,GDTSAH(,GDTPR)                                  0543 01625000
         C     @08,GPLAST(,@05)                                    0543 01626000
         BNE   @RF00543                                            0543 01627000
*                    DO;                                           0544 01628000
*                                                                  0544 01629000
*                      /**********************************************/ 01630000
*                      /*                                            */ 01631000
*                      /* UPDATE FORWARD CHAIN POINTER AND LAST      */ 01632000
*                      /* UGPOOL AREA POINTER, AND SET DOCNTRL TO    */ 01633000
*                      /* FALL OUT OF DO WHILE LOOP                  */ 01634000
*                      /*                                            */ 01635000
*                      /**********************************************/ 01636000
*                                                                  0545 01637000
*                      DOCNTRL = OFF;                              0545 01638000
         NI    DOCNTRL,B'01111111'                                 0545 01639000
*                      PREFWD = 0;                                 0546 01640000
         L     @08,GPBACK(,@08)                                    0546 01641000
         SLR   @02,@02                                             0546 01642000
         ST    @02,PREFWD(,@08)                                    0546 01643000
*                      GPLAST = GPBACK;                            0547 01644000
         ST    @08,GPLAST(,@05)                                    0547 01645000
*                    END;                                          0548 01646000
*                  ELSE                                            0549 01647000
*                    DO;                                           0549 01648000
*                                                                  0549 01649000
         B     @RC00543                                            0549 01650000
@RF00543 DS    0H                                                  0550 01651000
*                      /**********************************************/ 01652000
*                      /*                                            */ 01653000
*                      /* UPDATE FORWARD AND BACKWARD CHAIN POINTERS */ 01654000
*                      /*                                            */ 01655000
*                      /**********************************************/ 01656000
*                                                                  0550 01657000
*                      PREFWD = GPFORWRD;                          0550 01658000
         L     @08,TEMPPTR                                         0550 01659000
         L     @05,GPBACK(,@08)                                    0550 01660000
         L     @08,GPFORWRD(,@08)                                  0550 01661000
         ST    @08,PREFWD(,@05)                                    0550 01662000
*                      PASBACK = GPBACK;                           0551 01663000
         ST    @05,PASBACK(,@08)                                   0551 01664000
*                    END;                                          0552 01665000
*                                                                  0552 01666000
*                /****************************************************/ 01667000
*                /*                                                  */ 01668000
*                /* CHECK FOR A 24-BYTE CONTROL INFORMATION AREA     */ 01669000
*                /* REQUIRED FOR THE SPACE GOTTEN ON THE PAGE        */ 01670000
*                /* BOUNDARY.                                        */ 01671000
*                /*                                                  */ 01672000
*                /****************************************************/ 01673000
*                                                                  0553 01674000
*                IF GPID(3:4) = 'PG'                               0553 01675000
*                  THEN                                            0553 01676000
*                                                                  0553 01677000
@RC00543 L     @08,TEMPPTR                                         0553 01678000
         CLC   GPID+2(2,@08),@CC00681                              0553 01679000
         BNE   @RF00553                                            0553 01680000
*                    /************************************************/ 01681000
*                    /*                                              */ 01682000
*                    /* FREE THE PAGE BOUNDARY AREA.  THE SPACE      */ 01683000
*                    /* TO BE FREED IS POINTED TO BY THE 5-WORD      */ 01684000
*                    /* OF THE 24-BYTE CONTROL INFORMATION           */ 01685000
*                    /* AREA.                                        */ 01686000
*                    /*                                              */ 01687000
*                    /************************************************/ 01688000
*                                                                  0554 01689000
*                    DO;                                           0554 01690000
*                      FREEPT = GPADRPG;                           0555 01691000
         L     @05,GPADRPG(,@08)                                   0555 01692000
         ST    @05,FREEPT                                          0555 01693000
*                      FREESZ = GPLENPG;                           0556 01694000
         L     @08,GPLENPG(,@08)                                   0556 01695000
         ST    @08,FREESZ                                          0556 01696000
*                      CALL FREESTG;                               0557 01697000
         BAL   @14,FREESTG                                         0557 01698000
*                    END;                                          0558 01699000
*                                                                  0558 01700000
*                /****************************************************/ 01701000
*                /*                                                  */ 01702000
*                /* FREE UGPOOL AREA                                 */ 01703000
*                /*                                                  */ 01704000
*                /****************************************************/ 01705000
*                                                                  0559 01706000
*                FREEPT = TEMPPTR;                                 0559 01707000
@RF00553 L     @08,TEMPPTR                                         0559 01708000
         ST    @08,FREEPT                                          0559 01709000
*                FREESZ = GPLEN;                                   0560 01710000
         L     @05,GPLEN(,@08)                                     0560 01711000
         ST    @05,FREESZ                                          0560 01712000
*                TEMPPTR = GPFORWRD;                               0561 01713000
         L     @08,GPFORWRD(,@08)                                  0561 01714000
         ST    @08,TEMPPTR                                         0561 01715000
*                CALL FREESTG;                                     0562 01716000
         BAL   @14,FREESTG                                         0562 01717000
*              END;                                                0563 01718000
*            ELSE                                                  0564 01719000
*              DO;                                                 0564 01720000
*                                                                  0564 01721000
         B     @RC00541                                            0564 01722000
@RF00541 DS    0H                                                  0565 01723000
*                /****************************************************/ 01724000
*                /*                                                  */ 01725000
*                /* CHECK IF UGPOOL AREA EXAMINED IS THE LAST AREA   */ 01726000
*                /* IN THE UGPOOL CHAIN                              */ 01727000
*                /*                                                  */ 01728000
*                /****************************************************/ 01729000
*                                                                  0565 01730000
*                IF GPLAST = TEMPPTR                               0565 01731000
*                  THEN                                            0565 01732000
*                                                                  0565 01733000
         L     @08,GDTSAH(,GDTPR)                                  0565 01734000
         CLC   GPLAST(4,@08),TEMPPTR                               0565 01735000
         BNE   @RF00565                                            0565 01736000
*                    /************************************************/ 01737000
*                    /*                                              */ 01738000
*                    /* SET DOCNTRL TO FALL OUT OF DO WHILE LOOP     */ 01739000
*                    /*                                              */ 01740000
*                    /************************************************/ 01741000
*                                                                  0566 01742000
*                    DOCNTRL = OFF;                                0566 01743000
         NI    DOCNTRL,B'01111111'                                 0566 01744000
*                  ELSE                                            0567 01745000
*                                                                  0567 01746000
*                    /************************************************/ 01747000
*                    /*                                              */ 01748000
*                    /* UPDATE UGPOOL AREA SCAN POINTER FOR NEXT     */ 01749000
*                    /* ITERATION                                    */ 01750000
*                    /*                                              */ 01751000
*                    /************************************************/ 01752000
*                                                                  0567 01753000
*                    TEMPPTR = GPFORWRD;                           0567 01754000
         B     @RC00565                                            0567 01755000
@RF00565 L     @08,TEMPPTR                                         0567 01756000
         L     @08,GPFORWRD(,@08)                                  0567 01757000
         ST    @08,TEMPPTR                                         0567 01758000
*              END;                                                0568 01759000
@RC00565 DS    0H                                                  0569 01760000
*        END FPDO;                                                 0569 01761000
*                                                                  0569 01762000
@RC00541 DS    0H                                                  0569 01763000
@DE00540 TM    DOCNTRL,B'10000000'                                 0569 01764000
         BO    @DL00540                                            0569 01765000
*        /************************************************************/ 01766000
*        /*                                                          */ 01767000
*        /* RETURN TO THE UFPOOL CALLER                              */ 01768000
*        /*                                                          */ 01769000
*        /************************************************************/ 01770000
*        CALL ICKSAEP0(GDTTBL,MODID);                              0570 01771000
         ST    GDTPR,@AL00001                                      0570 01772000
         LA    @08,MODID                                           0570 01773000
         ST    @08,@AL00001+4                                      0570 01774000
         MVI   @AL00001+4,X'80'                                    0570 01775000
         L     @15,GDTEPL(,GDTPR)                                  0570 01776000
         LA    @01,@AL00001                                        0570 01777000
         BALR  @14,@15                                             0570 01778000
*        /************************************************************/ 01779000
*        /************************************************************/ 01780000
*        /*                                                          */ 01781000
*        /* UTIME ENTRY POINT                                        */ 01782000
*        /*                                                          */ 01783000
*        /************************************************************/ 01784000
*        /************************************************************/ 01785000
*                                                                  0571 01786000
*DMSSATI:  ENTRY(GDTTBLX,TITIMEX,TIDATEX,TIFORMX);                 0571 01787000
*                                                                  0571 01788000
@EC00571 DS    0H                                                  0572 01789000
*DMSSATI1:                                                         0572 01790000
*                                                                  0572 01791000
*        DCL TIDATE CHAR(8) BASED;     /* DATE FOR UTIME             */ 01792000
*                                                                  0572 01793000
DMSSATI1 DS    0H                                                  0573 01794000
*        DCL TITIME CHAR(8) BASED;     /* TIME FOR UTIME             */ 01795000
*                                                                  0573 01796000
*        DCL TIFORM CHAR(4) BASED;     /* FORMAT FOR UTIME           */ 01797000
*                                                                  0574 01798000
*        RESPECIFY TIDATE BASED(PARMPTR3);                         0575 01799000
*                                      /* BASE TIDATE                */ 01800000
*                                                                  0576 01801000
*        RESPECIFY TITIME BASED(PARMPTR2);                         0576 01802000
*                                      /* BASE TITIME                */ 01803000
*                                                                  0577 01804000
*        RESPECIFY TIFORM BASED(PARMPTR4);                         0577 01805000
*                                      /* BASE TIFORM                */ 01806000
*                                                                  0578 01807000
*        /************************************************************/ 01808000
*        /*                                                          */ 01809000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */ 01810000
*        /*                                                          */ 01811000
*        /************************************************************/ 01812000
*                                                                  0578 01813000
*        RESPECIFY (REG1PTR) RSTD;                                 0578 01814000
*        GDTPR = ADDR1;                                            0579 01815000
         L     GDTPR,ADDR1(,REG1PTR)                               0579 01816000
*        PARMPTR2 = ADDR2;                                         0580 01817000
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0580 01818000
*        PARMPTR3 = ADDR3;                                         0581 01819000
         L     PARMPTR3,ADDR3+8(,REG1PTR)                          0581 01820000
*        PARMPTR4 = ADDR4;                                         0582 01821000
         L     PARMPTR4,ADDR4+12(,REG1PTR)                         0582 01822000
*        RESPECIFY (REG1PTR) UNRSTD;                               0583 01823000
*                                                                  0583 01824000
*                                                                  0583 01825000
*                                                                  0584 01826000
*        /************************************************************/ 01827000
*        /*                                                          */ 01828000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 01829000
*        /*                                                          */ 01830000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 01831000
*        /*              TO THIS ROUTINE                             */ 01832000
*        /*                                                          */ 01833000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 01834000
*        /*               ADDRESS LIST                               */ 01835000
*        /*                                                          */ 01836000
*        /************************************************************/ 01837000
*                                                                  0584 01838000
*        GEN;                                                      0584 01839000
        ST    1,LISTPTR                                                 01840000
        ST    1,LISTSCAN                                                01841000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0585 01842000
         LA    @08,1                                               0585 01843000
         STC   @08,LISTLN                                          0585 01844000
@DL00585 L     @15,LISTSCAN                                        0585 01845000
         TM    LISTTEST(@15),B'10000000'                           0585 01846000
         BNZ   @DC00585                                            0585 01847000
*          LISTSCAN = LISTSCAN + 4;                                0586 01848000
         AL    @15,@CF00037                                        0586 01849000
         ST    @15,LISTSCAN                                        0586 01850000
*        END;                                                      0587 01851000
*                                                                  0587 01852000
         AL    @08,@CF00158                                        0587 01853000
         STC   @08,LISTLN                                          0587 01854000
         C     @08,@CF00634                                        0587 01855000
         BNH   @DL00585                                            0587 01856000
@DC00585 DS    0H                                                  0588 01857000
*        OLDERID2 = NEWERID2;                                      0588 01858000
         L     @08,GDTTR2(,GDTPR)                                  0588 01859000
         MVC   @TS00001(95),NEWERID2(@08)                          0588 01860000
         MVC   OLDERID2(95,@08),@TS00001                           0588 01861000
*        NEWID2 = 'SATI';                                          0589 01862000
*                                                                  0589 01863000
         MVC   NEWID2(4,@08),@CC00721                              0589 01864000
*        /************************************************************/ 01865000
*        /*                                                          */ 01866000
*        /* CALL THE UTIME MODULE ICKSA05                            */ 01867000
*        /*                                                          */ 01868000
*        /************************************************************/ 01869000
*                                                                  0590 01870000
*        CALL ICKSACL0(GDTTBL,'ICKSA05 ',TITIME,TIDATE,TIFORM,LISTLN);  01871000
*                                                                  0590 01872000
         ST    GDTPR,@AL00001                                      0590 01873000
         LA    @08,@CC00722                                        0590 01874000
         ST    @08,@AL00001+4                                      0590 01875000
         ST    PARMPTR2,@AL00001+8                                 0590 01876000
         ST    PARMPTR3,@AL00001+12                                0590 01877000
         ST    PARMPTR4,@AL00001+16                                0590 01878000
         LA    @08,LISTLN                                          0590 01879000
         ST    @08,@AL00001+20                                     0590 01880000
         MVI   @AL00001+20,X'80'                                   0590 01881000
         L     @15,GDTCAL(,GDTPR)                                  0590 01882000
         LA    @01,@AL00001                                        0590 01883000
         BALR  @14,@15                                             0590 01884000
*        /************************************************************/ 01885000
*        /*                                                          */ 01886000
*        /* RETURN TO THE UTIME CALLER                               */ 01887000
*        /*                                                          */ 01888000
*        /************************************************************/ 01889000
*                                                                  0591 01890000
*        CALL ICKSAEP0(GDTTBL,MODID);                              0591 01891000
         ST    GDTPR,@AL00001                                      0591 01892000
         LA    @08,MODID                                           0591 01893000
         ST    @08,@AL00001+4                                      0591 01894000
         MVI   @AL00001+4,X'80'                                    0591 01895000
         L     @15,GDTEPL(,GDTPR)                                  0591 01896000
         LA    @01,@AL00001                                        0591 01897000
         BALR  @14,@15                                             0591 01898000
*        /************************************************************/ 01899000
*        /************************************************************/ 01900000
*        /*                                                          */ 01901000
*        /* USNAP ENTRY POINT                                        */ 01902000
*        /*                                                          */ 01903000
*        /************************************************************/ 01904000
*        /************************************************************/ 01905000
*                                                                  0592 01906000
*DMSSASN:  ENTRY(GDTTBLX,SNAPIDX);                                 0592 01907000
*                                                                  0592 01908000
@EC00592 DS    0H                                                  0593 01909000
*DMSSASN1:                                                         0593 01910000
*                                                                  0593 01911000
*                                                                  0593 01912000
*        DCL SNAPID FIXED(15) BASED;   /* SNAP IDENTIFIER            */ 01913000
*                                                                  0593 01914000
DMSSASN1 DS    0H                                                  0594 01915000
*        RESPECIFY SNAPID BASED(PARMPTR2);                         0594 01916000
*                                      /* BASE SNAPID                */ 01917000
*                                                                  0595 01918000
*        /* OPEN MACRO LIST                                          */ 01919000
*        DCL 1 OPENLIST CHAR(4) BDY(WORD),                         0595 01920000
*              2 OPENOPT CHAR(1),      /* OPEN OPTIONS               */ 01921000
*              2 OPENADDR PTR(24);     /* DCB ADDRESS                */ 01922000
*                                                                  0595 01923000
*        /* SNAP MACRO LIST                                          */ 01924000
*        DCL 1 SNAPLIST CHAR(16) BDY(WORD),                        0596 01925000
*              2 SNAPIDEN FIXED(8),    /* SNAP ID                    */ 01926000
*              2 SNAPOPT CHAR(3),      /* SNAP OPTIONS               */ 01927000
*              2 SNAPPTR PTR(31),      /* SNAP DCB ADDRESS           */ 01928000
*              2 SNAPTCB PTR(31),      /* SNAP TCB ADDRESS           */ 01929000
*              2 SNAPLST PTR(31);      /* SNAP-SHOT LIST ADDR        */ 01930000
*                                                                  0596 01931000
*        DCL DUMPDCB CHAR(88) BDY(WORD);                           0597 01932000
*                                      /* FULL REGION (SNAP) DUMP DCB*/ 01933000
*                                                                  0598 01934000
*        /* DCB ADDRESS FOR CLOSING                                  */ 01935000
*        DCL 1 SADCB PTR(31) BDY(WORD),                            0598 01936000
*              2 BLOCKFLG BIT(1);      /* CONTROL BLOCK ADDRESS FLAG */ 01937000
*                                                                  0598 01938000
*        DCL OPENGEN CHAR(4) GENERATED;/*GENERATED LIST FORM OPEN    */ 01939000
*                                                                  0599 01940000
*        DCL SNAPGEN CHAR(16) GENERATED;                           0600 01941000
*                                      /* GENERATED LIST FORM OF SNAP*/ 01942000
*                                                                  0601 01943000
*        DCL DCBGEN CHAR(88) GENERATED;/* GENERATED SNAP DCB         */ 01944000
*                                                                  0601 01945000
*        DCL BADSNAP FIXED(31) CONSTANT(44);                       0602 01946000
*                                      /* UABORT MESSAGE FOR         */ 01947000
*                                      /* UNSUCCESSFUL SNAP          */ 01948000
*                                                                  0603 01949000
*        /************************************************************/ 01950000
*        /*                                                          */ 01951000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION            */ 01952000
*        /*                                                          */ 01953000
*        /************************************************************/ 01954000
*                                                                  0603 01955000
*        RESPECIFY (REG1PTR) RSTD;                                 0603 01956000
*        GDTPR = ADDR1;                                            0604 01957000
         L     GDTPR,ADDR1(,REG1PTR)                               0604 01958000
*        PARMPTR2 = ADDR2;                                         0605 01959000
         L     PARMPTR2,ADDR2+4(,REG1PTR)                          0605 01960000
*        RESPECIFY (REG1PTR) UNRSTD;                               0606 01961000
*                                                                  0606 01962000
*        OLDERID2 = NEWERID2;                                      0607 01963000
         L     @08,GDTTR2(,GDTPR)                                  0607 01964000
         MVC   @TS00001(95),NEWERID2(@08)                          0607 01965000
         MVC   OLDERID2(95,@08),@TS00001                           0607 01966000
*        NEWID2 = 'SASN';                                          0608 01967000
*                                                                  0608 01968000
         MVC   NEWID2(4,@08),@CC00752                              0608 01969000
*        /************************************************************/ 01970000
*        /*                                                          */ 01971000
*        /* MOVE DCB AND OPEN LISTS INTO DYNAMIC STORAGE AND OPEN    */ 01972000
*        /* THE SNAP DCB FOR PROCESSING                              */ 01973000
*        /*                                                          */ 01974000
*        /************************************************************/ 01975000
*                                                                  0609 01976000
*        DUMPDCB = DCBGEN;                                         0609 01977000
         MVC   DUMPDCB(88),DCBGEN                                  0609 01978000
*        OPENLIST = OPENGEN;                                       0610 01979000
         MVC   OPENLIST(4),OPENGEN                                 0610 01980000
*        OPENADDR = ADDR(DUMPDCB);                                 0611 01981000
         LA    @08,DUMPDCB                                         0611 01982000
         STCM  @08,7,OPENADDR                                      0611 01983000
*        RESPECIFY (REG1) RSTD;                                    0612 01984000
*        REG1 = ADDR(OPENLIST);                                    0613 01985000
         LA    REG1,OPENLIST                                       0613 01986000
*LOPEN2: GEN(OPEN  MF=(E,(REG1)));                                 0614 01987000
LOPEN2   OPEN  MF=(E,(REG1))                                            01988000
*        RESPECIFY (REG1) UNRSTD;                                  0615 01989000
*                                                                  0615 01990000
*        /************************************************************/ 01991000
*        /*                                                          */ 01992000
*        /* MOVE SNAP MACRO LIST INTO DYNAMIC STORAGE AND ISSUE THE  */ 01993000
*        /* SNAP MACRO FOR A FULL REGION DUMP                        */ 01994000
*        /*                                                          */ 01995000
*        /************************************************************/ 01996000
*                                                                  0616 01997000
*        SNAPLIST = SNAPGEN;                                       0616 01998000
         MVC   SNAPLIST(16),SNAPGEN                                0616 01999000
*        SNAPPTR = ADDR(DUMPDCB);                                  0617 02000000
         LA    @08,DUMPDCB                                         0617 02001000
         ST    @08,SNAPPTR                                         0617 02002000
*        SNAPIDEN = SNAPID;                                        0618 02003000
         LH    @08,SNAPID(,PARMPTR2)                               0618 02004000
         STC   @08,SNAPIDEN                                        0618 02005000
*        RESPECIFY (REG1) RSTD;                                    0619 02006000
*        REG1 = ADDR(SNAPLIST);                                    0620 02007000
         LA    REG1,SNAPLIST                                       0620 02008000
*LSNAP2: GEN(SNAP  MF=(E,(REG1)));                                 0621 02009000
LSNAP2   SNAP  MF=(E,(REG1))                                            02010000
*        RESPECIFY (REG15) RSTD;                                   0622 02011000
*        RESPECIFY RTNREG RSTD;                                    0623 02012000
*        TESTRC = RTNREG;                                          0624 02013000
         LR    TESTRC,RTNREG                                       0624 02014000
*        RESPECIFY RTNREG UNRSTD;                                  0625 02015000
*        RESPECIFY (REG15) UNRSTD;                                 0626 02016000
*                                                                  0626 02017000
*        /************************************************************/ 02018000
*        /*                                                          */ 02019000
*        /* CLOSE THE SNAP DCB                                       */ 02020000
*        /*                                                          */ 02021000
*        /************************************************************/ 02022000
*                                                                  0627 02023000
*        SADCB = ADDR(DUMPDCB);                                    0627 02024000
         LA    @08,DUMPDCB                                         0627 02025000
         ST    @08,SADCB                                           0627 02026000
*        BLOCKFLG = ON;                                            0628 02027000
         OI    BLOCKFLG,B'10000000'                                0628 02028000
*        REG1 = ADDR(SADCB);                                       0629 02029000
         LA    REG1,SADCB                                          0629 02030000
*LCLOSE3:GEN(CLOSE MF=(E,(REG1)));                                 0630 02031000
LCLOSE3  CLOSE MF=(E,(REG1))                                            02032000
*        RESPECIFY (REG1) UNRSTD;                                  0631 02033000
*                                                                  0631 02034000
*        /************************************************************/ 02035000
*        /*                                                          */ 02036000
*        /* CHECK RETURN CODE FROM SNAP MACRO AND ABORT IF IT IS BAD */ 02037000
*        /*                                                          */ 02038000
*        /************************************************************/ 02039000
*                                                                  0632 02040000
*        IF TESTRC ^= 0                                            0632 02041000
*          THEN                                                    0632 02042000
*                                                                  0632 02043000
         LTR   TESTRC,TESTRC                                       0632 02044000
         BZ    @RF00632                                            0632 02045000
*            DO;                                                   0633 02046000
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  0634 02047000
*              REG15 = BADSNAP;                                    0635 02048000
         LA    REG15,44                                            0635 02049000
*              REG14 = GDTABT;                                     0636 02050000
         L     REG14,GDTABT(,GDTPR)                                0636 02051000
*              REG13 = GDTABH;                                     0637 02052000
         L     REG13,GDTABH(,GDTPR)                                0637 02053000
*              GEN(BR    REG14);                                   0638 02054000
         BR    REG14                                                    02055000
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 0639 02056000
*            END;                                                  0640 02057000
*                                                                  0640 02058000
*                                                                  0640 02059000
*        /************************************************************/ 02060000
*        /*                                                          */ 02061000
*        /* RETURN TO THE USNAP CALLER                               */ 02062000
*        /*                                                          */ 02063000
*        /************************************************************/ 02064000
*                                                                  0641 02065000
*        CALL ICKSAEP0(GDTTBL,MODID);                              0641 02066000
@RF00632 ST    GDTPR,@AL00001                                      0641 02067000
         LA    @08,MODID                                           0641 02068000
         ST    @08,@AL00001+4                                      0641 02069000
         MVI   @AL00001+4,X'80'                                    0641 02070000
         L     @15,GDTEPL(,GDTPR)                                  0641 02071000
         LA    @01,@AL00001                                        0641 02072000
         BALR  @14,@15                                             0641 02073000
*        /************************************************************/ 02074000
*        /*                                                          */ 02075000
*        /*  PROCEDURE NAME - GETSTG                                 */ 02076000
*        /*                                                          */ 02077000
*        /*  FUNCTION - THIS PROCEDURE OBTAINS MAIN                  */ 02078000
*        /*             STORAGE AS REQUESTED.                        */ 02079000
*        /*                                                          */ 02080000
*        /*  INPUT -    PARAMETER LIST DEFINED BY THE AREA           */ 02081000
*        /*             LABELLED GETLIST.                            */ 02082000
*        /*                                                          */ 02083000
*        /*  OUTPUT -   RETURN CODE IN TESTRC.                       */ 02084000
*        /*             ADDRESS OF THE AREA OBTAINED IS IN           */ 02085000
*        /*             THE AREA POINTED TO BY GETPT.                */ 02086000
*        /*                                                          */ 02087000
*        /************************************************************/ 02088000
*                                                                  0642 02089000
*GETSTG: PROCEDURE;                                                0642 02090000
*                                                                  0642 02091000
*                                                                  0642 02092000
         B     @PB00002                                            0642 02093000
GETSTG   STM   @14,@05,@SA00002                                    0642 02094000
         STM   @07,@12,@SA00002+32                                 0642 02095000
*LGETMN: GEN(GETMAIN MF=(E,GETLIST))                               0643 02096000
*          REFS(GETLIST);                                          0643 02097000
LGETMN   GETMAIN MF=(E,GETLIST)                                         02098000
*        RESPECIFY RTNREG RSTD;                                    0644 02099000
*        TESTRC = RTNREG;                                          0645 02100000
         LR    TESTRC,RTNREG                                       0645 02101000
*        RESPECIFY RTNREG UNRSTD;                                  0646 02102000
*                                                                  0646 02103000
*                                                                  0646 02104000
*        END GETSTG;                                               0647 02105000
*                                                                  0647 02106000
@EL00002 DS    0H                                                  0647 02107000
@EF00002 DS    0H                                                  0647 02108000
@ER00002 LM    @14,@05,@SA00002                                    0647 02109000
         LM    @07,@12,@SA00002+32                                 0647 02110000
         BR    @14                                                 0647 02111000
*        /************************************************************/ 02112000
*        /*                                                          */ 02113000
*        /*  PROCEDURE NAME - FREESTG                                */ 02114000
*        /*                                                          */ 02115000
*        /*  FUNCTION - THIS PROCEDURE RELEASES MAIN                 */ 02116000
*        /*             STORAGE AS REQUESTED.                        */ 02117000
*        /*                                                          */ 02118000
*        /*  INPUT -    PARAMETER LIST DEFINED BY THE AREA           */ 02119000
*        /*             LABELLED FREELIST.                           */ 02120000
*        /*                                                          */ 02121000
*        /*  OUTPUT -   NONE.                                        */ 02122000
*        /*                                                          */ 02123000
*        /************************************************************/ 02124000
*                                                                  0648 02125000
*FREESTG: PROCEDURE;                                               0648 02126000
*                                                                  0648 02127000
FREESTG  STM   @14,@12,@SA00003                                    0648 02128000
*        RESPECIFY (REG0,REG1) RSTD;                               0649 02129000
*        REG0 = FREESZ;                                            0650 02130000
         L     REG0,FREESZ                                         0650 02131000
*        REG1 = FREEPT;                                            0651 02132000
         L     REG1,FREEPT                                         0651 02133000
*LFREMN: GEN(FREEMAIN R,LV=(0),A=(1));                             0652 02134000
LFREMN   FREEMAIN R,LV=(0),A=(1)                                        02135000
*        RESPECIFY (REG0,REG1) UNRSTD;                             0653 02136000
*                                                                  0653 02137000
*        END FREESTG;                                              0654 02138000
*                                                                  0654 02139000
@EL00003 DS    0H                                                  0654 02140000
@EF00003 DS    0H                                                  0654 02141000
@ER00003 LM    @14,@12,@SA00003                                    0654 02142000
         BR    @14                                                 0654 02143000
*        /************************************************************/ 02144000
*        /*                                                          */ 02145000
*        /*  PROCEDURE NAME - COREINIT                               */ 02146000
*        /*                                                          */ 02147000
*        /*  FUNCTION - THIS PROCEDURE INITIALIZES CORE.  THE ADDRESS*/ 02148000
*        /*             OF THE CORE AND THE VALUE IT IS TO BE        */ 02149000
*        /*             INITIALIZED TO ARE PROVIDED BY THE CALLER    */ 02150000
*        /*                                                          */ 02151000
*        /*  INPUT - PARAMETER LIST CONTAINING THE ADDRESS OF A SIZE */ 02152000
*        /*          ARGUMENT, THE ADDRESS OF A VARIABLE CONTAINING  */ 02153000
*        /*          THE ADDRESS OF THE CORE TO BE INITIALIZED, AND  */ 02154000
*        /*          THE ADDRESS OF AN ARGUMENT INDICATING THE VALUE */ 02155000
*        /*          TO WHICH THE CORE IS TO BE INITIALIZED.         */ 02156000
*        /*                                                          */ 02157000
*        /*  OUTPUT - THE INITIALIZED CORE                           */ 02158000
*        /*                                                          */ 02159000
*        /************************************************************/ 02160000
*        /************************************************************/ 02161000
*        /*                                                          */ 02162000
*        /* CORE INITIALIZATION REQUEST INNER PROCEDURE              */ 02163000
*        /*                                                          */ 02164000
*        /************************************************************/ 02165000
*                                                                  0655 02166000
*COREINIT: PROCEDURE(ZSIZE,ZPTR,INITC);                            0655 02167000
*                                                                  0655 02168000
COREINIT STM   @14,@12,@SA00004                                    0655 02169000
         MVC   @PC00004(12),0(@01)                                 0655 02170000
*        DCL ZSIZE FIXED(31);          /* SIZE OF AREA TO INITIALIZE */ 02171000
*                                                                  0656 02172000
*        DCL ZPTR PTR(31);             /* ADDRESS OF AREA TO         */ 02173000
*                                      /* INITIALIZE                 */ 02174000
*                                                                  0658 02175000
*        DCL ALLINIT CHAR(256);        /* AREA TO INITIALIZE FROM    */ 02176000
*                                                                  0658 02177000
*        DCL INITCHAR CHAR(*) BASED(ZPTR);                         0659 02178000
*                                      /* AREA TO BE INITIALIZED     */ 02179000
*                                                                  0660 02180000
*        DCL INITC CHAR(1);            /* INITIALIZATION CHARACTER   */ 02181000
*                                      /* PASSED                     */ 02182000
*                                                                  0661 02183000
*        DCL CHARIN CHAR(1);           /* INITIALIZATION CHARACTER   */ 02184000
*                                                                  0661 02185000
*        /************************************************************/ 02186000
*        /*                                                          */ 02187000
*        /* INITIALIZE 256 BYTE AREA ALLINIT TO VALUE OF REQUEST     */ 02188000
*        /*                                                          */ 02189000
*        /************************************************************/ 02190000
*                                                                  0662 02191000
*        CHARIN = INITC;                                           0662 02192000
         L     @08,@PC00004+8                                      0662 02193000
         MVC   CHARIN(1),INITC(@08)                                0662 02194000
*        GEN(MVC   ALLINIT(1),CHARIN);                             0663 02195000
         MVC   ALLINIT(1),CHARIN                                        02196000
*        GEN(MVC   ALLINIT+1(255),ALLINIT);                        0664 02197000
         MVC   ALLINIT+1(255),ALLINIT                                   02198000
*        DOCNTRL = ON;                                             0665 02199000
         OI    DOCNTRL,B'10000000'                                 0665 02200000
*INITDO: DO WHILE (DOCNTRL = ON);                                  0666 02201000
*                                                                  0666 02202000
INITDO   B     @DE00666                                            0666 02203000
@DL00666 DS    0H                                                  0667 02204000
*          /**********************************************************/ 02205000
*          /*                                                        */ 02206000
*          /* CHECK FOR MORE THAN 256 BYTES TO INITIALIZE            */ 02207000
*          /*                                                        */ 02208000
*          /**********************************************************/ 02209000
*                                                                  0667 02210000
*          IF ZSIZE > 256                                          0667 02211000
*            THEN                                                  0667 02212000
         LA    @08,256                                             0667 02213000
         L     @05,@PC00004                                        0667 02214000
         L     @15,ZSIZE(,@05)                                     0667 02215000
         CR    @15,@08                                             0667 02216000
         BNH   @RF00667                                            0667 02217000
*              DO;                                                 0668 02218000
*                                                                  0668 02219000
*                /****************************************************/ 02220000
*                /*                                                  */ 02221000
*                /* INITIALIZE 256 BYTES AND UPDATE SIZE AND POINTER */ 02222000
*                /* VARIABLES FOR NEXT ITERATION                     */ 02223000
*                /*                                                  */ 02224000
*                /****************************************************/ 02225000
*                                                                  0669 02226000
*                INITCHAR(1:256) = ALLINIT(1:256);                 0669 02227000
         L     @14,@PC00004+4                                      0669 02228000
         L     @07,ZPTR(,@14)                                      0669 02229000
         MVC   INITCHAR(256,@07),ALLINIT                           0669 02230000
*                ZSIZE = ZSIZE - 256;                              0670 02231000
         SLR   @15,@08                                             0670 02232000
         ST    @15,ZSIZE(,@05)                                     0670 02233000
*                ZPTR = ZPTR + 256;                                0671 02234000
         ALR   @07,@08                                             0671 02235000
         ST    @07,ZPTR(,@14)                                      0671 02236000
*              END;                                                0672 02237000
*            ELSE                                                  0673 02238000
*              DO;                                                 0673 02239000
*                                                                  0673 02240000
         B     @RC00667                                            0673 02241000
@RF00667 DS    0H                                                  0674 02242000
*                /****************************************************/ 02243000
*                /*                                                  */ 02244000
*                /* INITIALIZE ZSIZE BYTES AND SET DOCNTRL TO FALL   */ 02245000
*                /* OUT OF LOOP                                      */ 02246000
*                /*                                                  */ 02247000
*                /****************************************************/ 02248000
*                                                                  0674 02249000
*                INITCHAR(1:ZSIZE) = ALLINIT(1:ZSIZE);             0674 02250000
         L     @08,@PC00004+4                                      0674 02251000
         L     @08,ZPTR(,@08)                                      0674 02252000
         L     @05,@PC00004                                        0674 02253000
         L     @05,ZSIZE(,@05)                                     0674 02254000
         BCTR  @05,0                                               0674 02255000
         EX    @05,@SM00814                                        0674 02256000
*                DOCNTRL = OFF;                                    0675 02257000
         NI    DOCNTRL,B'01111111'                                 0675 02258000
*              END;                                                0676 02259000
*        END INITDO;                                               0677 02260000
@RC00667 DS    0H                                                  0677 02261000
@DE00666 TM    DOCNTRL,B'10000000'                                 0677 02262000
         BO    @DL00666                                            0677 02263000
*        END COREINIT;                                             0678 02264000
@EL00004 DS    0H                                                  0678 02265000
@EF00004 DS    0H                                                  0678 02266000
@ER00004 LM    @14,@12,@SA00004                                    0678 02267000
         BR    @14                                                 0678 02268000
*        /************************************************************/ 02269000
*        /*                                                          */ 02270000
*        /*  PROCEDURE NAME - FINDNAME                               */ 02271000
*        /*                                                          */ 02272000
*        /*  FUNCTION - THIS PROCEDURE WILL SEARCH THE LOAD          */ 02273000
*        /*             LIST BLOCKS TO SEE IF MODULE HAS             */ 02274000
*        /*             BEEN LOADED AND STILL IN CORE.IF IT          */ 02275000
*        /*             IS RETURN WITH ENTRY POINT.IF NOT            */ 02276000
*        /*             LOAD THE CALLED MODULE,PUT NAME IN           */ 02277000
*        /*             IN LOAD BLOCK,THEN UP USE COUNTER            */ 02278000
*        /*             ONE AND RETURN WITH ENTRY POINT.             */ 02279000
*        /*                                                          */ 02280000
*        /*  INPUT - MODULE NAME                                     */ 02281000
*        /*                                                          */ 02282000
*        /*  OUTPUT - ENTRY POINT OF MODULE                          */ 02283000
*        /*                                                          */ 02284000
*        /************************************************************/ 02285000
*        /************************************************************/ 02286000
*        /************************************************************/ 02287000
*        /*                                                          */ 02288000
*        /*   FINDNAME THIS WILL LOAD MODULE IF NOT                  */ 02289000
*        /*   IN CORE  -  THEN RETURN ENTRY POINT                    */ 02290000
*        /*                                                          */ 02291000
*        /************************************************************/ 02292000
*        /************************************************************/ 02293000
*                                                                  0679 02294000
*FINDNAME:   PROC(CLNAMX,ENTPT);                                   0679 02295000
FINDNAME STM   @14,@07,@SA00005                                    0679 02296000
         STM   @09,@12,@SA00005+40                                 0679 02297000
         MVC   @PC00005(8),0(@01)                                  0679 02298000
*        DCL CLNAMX    CHAR(8);        /* NAME OF MODULE             */ 02299000
*        DCL ENTPT     PTR(31);        /* ENTRY POINT                */ 02300000
*        DCL INDX      FIXED(15);      /* LOAD LIST INDEX            */ 02301000
*        DCL SLTOUSE  PTR(31);         /* SLOT TO USE PTR            */ 02302000
*        DCL LOADNAME CHAR(8);         /* NAME OF MODULE             */ 02303000
*                                                                  0684 02304000
*        INDX = 0;                                                 0685 02305000
         SLR   INDX,INDX                                           0685 02306000
*        LOOPCTL = OFF;                                            0686 02307000
         NI    LOOPCTL,B'01111111'                                 0686 02308000
*        NAMEFND = OFF;                                            0687 02309000
*                                                                  0687 02310000
         NI    NAMEFND,B'01111111'                                 0687 02311000
*        /************************************************************/ 02312000
*        /*                                                          */ 02313000
*        /* SEARCH LLBLKS FOR MATCH OF MODULE NAME                   */ 02314000
*        /*                                                          */ 02315000
*        /************************************************************/ 02316000
*                                                                  0688 02317000
*FNDO:   DO WHILE LOOPCTL = OFF;                                   0688 02318000
FNDO     B     @DE00688                                            0688 02319000
@DL00688 DS    0H                                                  0689 02320000
*          IF INDX = 0                                             0689 02321000
*            THEN                                                  0689 02322000
*                                                                  0689 02323000
         LTR   INDX,INDX                                           0689 02324000
         BNZ   @RF00689                                            0689 02325000
*              /******************************************************/ 02326000
*              /*                                                    */ 02327000
*              /*   FIRST TIME USE PTR IN SAHIST                     */ 02328000
*              /*                                                    */ 02329000
*              /******************************************************/ 02330000
*                                                                  0690 02331000
*              P= LLBLKPTR;                                        0690 02332000
         L     @05,GDTSAH(,GDTPR)                                  0690 02333000
         L     P,LLBLKPTR(,@05)                                    0690 02334000
*            ELSE;                                                 0691 02335000
*                                                                  0691 02336000
@RF00689 DS    0H                                                  0692 02337000
*          /**********************************************************/ 02338000
*          /*                                                        */ 02339000
*          /*    SEARCH FOR MODULE MATCH                             */ 02340000
*          /*                                                        */ 02341000
*          /**********************************************************/ 02342000
*                                                                  0692 02343000
*          DO INDX = 1 TO LLSLTCNT WHILE LOOPCTL = OFF;            0692 02344000
         LA    INDX,1                                              0692 02345000
@DL00692 TM    LOOPCTL,B'10000000'                                 0692 02346000
         BNZ   @DC00692                                            0692 02347000
*            IF LLNOMOD(INDX) = 0                                  0693 02348000
*                                                                  0693 02349000
*            /********************************************************/ 02350000
*            /*                                                      */ 02351000
*            /*  NO MODULE IN THIS SLOT WHEN 0 IS FOUND              */ 02352000
*            /*                                                      */ 02353000
*            /********************************************************/ 02354000
*                                                                  0693 02355000
*              THEN;                                               0693 02356000
         LR    @05,INDX                                            0693 02357000
         SLA   @05,4                                               0693 02358000
         AL    @05,@CF00816                                        0693 02359000
         L     @05,LLNOMOD-12(@05,P)                               0693 02360000
         LTR   @05,@05                                             0693 02361000
         BZ    @RT00693                                            0693 02362000
*              ELSE                                                0695 02363000
*                DO;                                               0695 02364000
*                  IF CLNAMX = LLNAME(INDX)                        0696 02365000
*                    THEN                                          0696 02366000
         L     @05,@PC00005                                        0696 02367000
         LR    @03,INDX                                            0696 02368000
         SLA   @03,4                                               0696 02369000
         ST    @03,@TF00001                                        0696 02370000
         ALR   @03,P                                               0696 02371000
         AL    @03,@CF00812                                        0696 02372000
         CLC   CLNAMX(8,@05),LLNAME-8(@03)                         0696 02373000
         BNE   @RF00696                                            0696 02374000
*                      DO;                                         0697 02375000
*                                                                  0697 02376000
*                      /**********************************************/ 02377000
*                      /*                                            */ 02378000
*                      /*   GOT A MATCH ON MODULE NAME               */ 02379000
*                      /*                                            */ 02380000
*                      /**********************************************/ 02381000
*                                                                  0698 02382000
*                        LOOPCTL = ON;                             0698 02383000
         OI    LOOPCTL,B'10000000'                                 0698 02384000
*                        NAMEFND = ON;                             0699 02385000
         OI    NAMEFND,B'10000000'                                 0699 02386000
*                        ENTPT = LLADDR(INDX);                     0700 02387000
         L     @05,@PC00005+4                                      0700 02388000
         L     @03,@TF00001                                        0700 02389000
         L     @03,LLADDR-16(@03,P)                                0700 02390000
         ST    @03,ENTPT(,@05)                                     0700 02391000
*                        LLUSECTR(INDX) = LLUSECTR(INDX)+1;        0701 02392000
         LA    @05,1                                               0701 02393000
         L     @03,@TF00001                                        0701 02394000
         SLR   @15,@15                                             0701 02395000
         IC    @15,LLUSECTR-16(@03,P)                              0701 02396000
         ALR   @05,@15                                             0701 02397000
         L     @03,@TF00001                                        0701 02398000
         STC   @05,LLUSECTR-16(@03,P)                              0701 02399000
*                        END;                                      0702 02400000
*                    ELSE;                                         0703 02401000
@RF00696 DS    0H                                                  0704 02402000
*                END;                                              0704 02403000
*          END;                                                    0705 02404000
*                                                                  0705 02405000
@RT00693 AL    INDX,@CF00158                                       0705 02406000
         C     INDX,@CF00278                                       0705 02407000
         BNH   @DL00692                                            0705 02408000
@DC00692 DS    0H                                                  0706 02409000
*          /**********************************************************/ 02410000
*          /*                                                        */ 02411000
*          /*   USE CHAIN PTR IN LLBLK(S) IF 0 LAST LLBLK            */ 02412000
*          /*                                                        */ 02413000
*          /**********************************************************/ 02414000
*                                                                  0706 02415000
*          IF LLNXTBLK = 0                                         0706 02416000
*            THEN                                                  0706 02417000
         L     @05,LLNXTBLK(,P)                                    0706 02418000
         LTR   @05,@05                                             0706 02419000
         BNZ   @RF00706                                            0706 02420000
*              LOOPCTL = ON;                                       0707 02421000
         OI    LOOPCTL,B'10000000'                                 0707 02422000
*            ELSE                                                  0708 02423000
*              P = LLNXTBLK;                                       0708 02424000
         B     @RC00706                                            0708 02425000
@RF00706 L     P,LLNXTBLK(,P)                                      0708 02426000
*        END FNDO;                                                 0709 02427000
*                                                                  0709 02428000
@RC00706 DS    0H                                                  0709 02429000
@DE00688 TM    LOOPCTL,B'10000000'                                 0709 02430000
         BZ    @DL00688                                            0709 02431000
*        LOOPCTL = OFF;                                            0710 02432000
         NI    LOOPCTL,B'01111111'                                 0710 02433000
*          IF NAMEFND = ON                                         0711 02434000
*            THEN;                                                 0711 02435000
         TM    NAMEFND,B'10000000'                                 0711 02436000
         BO    @RT00711                                            0711 02437000
*            ELSE                                                  0713 02438000
*              /******************************************************/ 02439000
*              /*                                                    */ 02440000
*              /*     MODULE WAS NOT IN LLBLK PREPARE TO             */ 02441000
*              /*     LOAD NEEDED MODULE AND                         */ 02442000
*              /*     FIND A AVAILABLE SLOT FOR THIS MODULE          */ 02443000
*              /*                                                    */ 02444000
*              /******************************************************/ 02445000
*              DO;                                                 0713 02446000
*              P = LLBLKPTR;                                       0714 02447000
         L     @05,GDTSAH(,GDTPR)                                  0714 02448000
         L     P,LLBLKPTR(,@05)                                    0714 02449000
*                DO WHILE LLFSTSLT = 0;                            0715 02450000
*                                                                  0715 02451000
*                                                                  0715 02452000
         B     @DE00715                                            0715 02453000
@DL00715 DS    0H                                                  0716 02454000
*                  IF LLNXTBLK = 0                                 0716 02455000
*                    THEN                                          0716 02456000
         L     @05,LLNXTBLK(,P)                                    0716 02457000
         LTR   @05,@05                                             0716 02458000
         BNZ   @RF00716                                            0716 02459000
*                      DO;                                         0717 02460000
*                                                                  0717 02461000
*                      /**********************************************/ 02462000
*                      /*                                            */ 02463000
*                      /* NO SLOTS AVAIL.BUILD A NEW LLBLK           */ 02464000
*                      /*                                            */ 02465000
*                      /**********************************************/ 02466000
*                                                                  0718 02467000
*                        OLDERID2 = NEWERID2;                      0718 02468000
         L     @07,GDTTR2(,GDTPR)                                  0718 02469000
         MVC   @TS00001(95),NEWERID2(@07)                          0718 02470000
         MVC   OLDERID2(95,@07),@TS00001                           0718 02471000
*                        NEWID2 = 'SABB';                          0719 02472000
         MVC   NEWID2(4,@07),@CC00796                              0719 02473000
*                        CALL ICKSAGS0(GDTTBL,(LLSLTCNT*(LENGTH(LLSLOT) 02474000
*)                                                                 0720 02475000
*                        +(LENGTH(LLHDR)),LLNXTBLK,SETZERO);       0720 02476000
*                                                                  0720 02477000
         ST    GDTPR,@AL00001                                      0720 02478000
         LA    @07,@CF00809                                        0720 02479000
         ST    @07,@AL00001+4                                      0720 02480000
         LA    @07,LLNXTBLK(,P)                                    0720 02481000
         ST    @07,@AL00001+8                                      0720 02482000
         LA    @07,@CC00138                                        0720 02483000
         ST    @07,@AL00001+12                                     0720 02484000
         MVI   @AL00001+12,X'80'                                   0720 02485000
         L     @15,GDTGSP(,GDTPR)                                  0720 02486000
         LA    @01,@AL00001                                        0720 02487000
         BALR  @14,@15                                             0720 02488000
*                        RFY (RTNREG) RSTD;                        0721 02489000
*                        TESTRC = RTNREG;                          0722 02490000
         LR    TESTRC,RTNREG                                       0722 02491000
*                        RFY (RTNREG) UNRSTD;                      0723 02492000
*                          IF TESTRC ^= 0                          0724 02493000
*                            THEN                                  0724 02494000
*                                                                  0724 02495000
         LTR   TESTRC,TESTRC                                       0724 02496000
         BZ    @RF00724                                            0724 02497000
*                              DO;                                 0725 02498000
*                                RESPECIFY(REG13,REG14,REG15) RSTD;     02499000
*                                REG15 = NOSPACE;                  0727 02500000
         LA    REG15,28                                            0727 02501000
*                                REG14 = GDTABT;                   0728 02502000
         L     REG14,GDTABT(,GDTPR)                                0728 02503000
*                                REG13 = GDTABH;                   0729 02504000
         L     REG13,GDTABH(,GDTPR)                                0729 02505000
*                                GEN(BR    REG14);                 0730 02506000
         BR    REG14                                                    02507000
*                                RESPECIFY(REG13,REG14,REG15)UNRSTD;    02508000
*                              END;                                0732 02509000
*                            ELSE                                  0733 02510000
*                              DO;                                 0733 02511000
*                                                                  0733 02512000
         B     @RC00724                                            0733 02513000
@RF00724 DS    0H                                                  0734 02514000
*                              /**************************************/ 02515000
*                              /*                                    */ 02516000
*                              /* FORMAT AND CHAIN NEW LLBLK         */ 02517000
*                              /*                                    */ 02518000
*                              /**************************************/ 02519000
*                                                                  0734 02520000
*                              P= LLNXTBLK;                        0734 02521000
         L     P,LLNXTBLK(,P)                                      0734 02522000
*                              LLFSTSLT = ADDR(LLNXTSLT(1));       0735 02523000
*                                                                  0735 02524000
         LA    @05,LLNXTSLT(,P)                                    0735 02525000
         ST    @05,LLFSTSLT(,P)                                    0735 02526000
*                                DO INDX = 1 TO LLSLTCNT;          0736 02527000
         LA    INDX,1                                              0736 02528000
@DL00736 DS    0H                                                  0737 02529000
*                                  LLNXTSLT(INDX) =                0737 02530000
*                                  ADDR(LLNXTSLT(INDX+1));         0737 02531000
         LR    @05,INDX                                            0737 02532000
         SLA   @05,4                                               0737 02533000
         LA    @03,LLNXTSLT(@05,P)                                 0737 02534000
         AL    @05,@CF00812                                        0737 02535000
         ST    @03,LLNXTSLT-8(@05,P)                               0737 02536000
*                                END;                              0738 02537000
         AL    INDX,@CF00158                                       0738 02538000
         C     INDX,@CF00278                                       0738 02539000
         BNH   @DL00736                                            0738 02540000
*                              LLNXTSLT(LLSLTCNT) = 0;             0739 02541000
         SLR   @05,@05                                             0739 02542000
         ST    @05,LLNXTSLT+368(,P)                                0739 02543000
*                            END;                                  0740 02544000
*                      END;                                        0741 02545000
*                    ELSE                                          0742 02546000
*                      P = LLNXTBLK;                               0742 02547000
         B     @RC00716                                            0742 02548000
@RF00716 L     P,LLNXTBLK(,P)                                      0742 02549000
*                END;                                              0743 02550000
@RC00716 DS    0H                                                  0743 02551000
@DE00715 L     @05,LLFSTSLT(,P)                                    0743 02552000
         LTR   @05,@05                                             0743 02553000
         BZ    @DL00715                                            0743 02554000
*                SLTOUSE = LLFSTSLT;                               0744 02555000
*                                                                  0744 02556000
         LR    SLTOUSE,@05                                         0744 02557000
*                /****************************************************/ 02558000
*                /*                                                  */ 02559000
*                /*  CALCULATE THE INDX VALUE FOR SLOT               */ 02560000
*                /*  THAT WILL BE USED FOR THIS MODULE               */ 02561000
*                /*                                                  */ 02562000
*                /****************************************************/ 02563000
*                                                                  0745 02564000
*                INDX = ((SLTOUSE -P -(LENGTH(LLHDR)))  /          0745 02565000
*                (LENGTH(LLSLOT))) +1;                             0745 02566000
*                                                                  0745 02567000
         LR    @00,SLTOUSE                                         0745 02568000
         SLR   @00,P                                               0745 02569000
         SL    @00,@CF00154                                        0745 02570000
         SRDA  @00,32                                              0745 02571000
         D     @00,@CF00262                                        0745 02572000
         AL    @01,@CF00158                                        0745 02573000
         LR    INDX,@01                                            0745 02574000
*                LLFSTSLT = LLNXTSLT(INDX);                        0746 02575000
*                                                                  0746 02576000
         LR    @05,INDX                                            0746 02577000
         SLA   @05,4                                               0746 02578000
         AL    @05,@CF00812                                        0746 02579000
         L     @05,LLNXTSLT-8(@05,P)                               0746 02580000
         ST    @05,LLFSTSLT(,P)                                    0746 02581000
*                /****************************************************/ 02582000
*                /*                                                  */ 02583000
*                /*      LOAD THE MODULE                             */ 02584000
*                /*                                                  */ 02585000
*                /****************************************************/ 02586000
*                                                                  0747 02587000
*                RESPECIFY (REG0,REG1) RSTD;                       0747 02588000
*                LOADNAME = CLNAMX;                                0748 02589000
         L     @05,@PC00005                                        0748 02590000
         MVC   LOADNAME(8),CLNAMX(@05)                             0748 02591000
*LLDA1:          GEN(LOAD EPLOC=LOADNAME);                         0749 02592000
LLDA1    LOAD EPLOC=LOADNAME                                            02593000
*                LLNAME(INDX) = CLNAMX;                            0750 02594000
         LR    @05,INDX                                            0750 02595000
         SLA   @05,4                                               0750 02596000
         ST    @05,@TF00001                                        0750 02597000
         ALR   @05,P                                               0750 02598000
         AL    @05,@CF00812                                        0750 02599000
         L     @03,@PC00005                                        0750 02600000
         MVC   LLNAME-8(8,@05),CLNAMX(@03)                         0750 02601000
*                LLMODSZ(INDX) = REG1;                             0751 02602000
*                                                                  0751 02603000
         LR    @05,P                                               0751 02604000
         AL    @05,@TF00001                                        0751 02605000
         STCM  REG1,7,LLMODSZ-16(@05)                              0751 02606000
*                /****************************************************/ 02607000
*                /*                                                  */ 02608000
*                /*     PUT MODULE ENTRY POINT                       */ 02609000
*                /*    IN DMS LOAD LIST BLOCK                        */ 02610000
*                /*                                                  */ 02611000
*                /****************************************************/ 02612000
*                                                                  0752 02613000
*                ENTPT = REG0;                                     0752 02614000
         L     @05,@PC00005+4                                      0752 02615000
         ST    REG0,ENTPT(,@05)                                    0752 02616000
*                LLADDR(INDX) = ENTPT;                             0753 02617000
*                                                                  0753 02618000
         L     @05,@PC00005+4                                      0753 02619000
         L     @05,ENTPT(,@05)                                     0753 02620000
         L     @03,@TF00001                                        0753 02621000
         ST    @05,LLADDR-16(@03,P)                                0753 02622000
*                /****************************************************/ 02623000
*                /*                                                  */ 02624000
*                /*  UP USE CTR.FOR MODULE                           */ 02625000
*                /*                                                  */ 02626000
*                /****************************************************/ 02627000
*                                                                  0754 02628000
*                LLUSECTR(INDX) = LLUSECTR(INDX)+1;                0754 02629000
         LA    @05,1                                               0754 02630000
         L     @03,@TF00001                                        0754 02631000
         SLR   @15,@15                                             0754 02632000
         IC    @15,LLUSECTR-16(@03,P)                              0754 02633000
         ALR   @05,@15                                             0754 02634000
         L     @03,@TF00001                                        0754 02635000
         STC   @05,LLUSECTR-16(@03,P)                              0754 02636000
*                RESPECIFY (REG0,REG1) UNRSTD;                     0755 02637000
*            END;                                                  0756 02638000
*        RETURN;                                                   0757 02639000
*                                                                  0757 02640000
@EL00005 DS    0H                                                  0757 02641000
@EF00005 DS    0H                                                  0757 02642000
@ER00005 LM    @14,@07,@SA00005                                    0757 02643000
         LM    @09,@12,@SA00005+40                                 0757 02644000
         BR    @14                                                 0757 02645000
*        END FINDNAME;                                             0758 02646000
*                                                                  0758 02647000
*                                                                  0758 02648000
         B     @EL00005                                            0758 02649000
*            /********************************************************/ 02650000
*            /********************************************************/ 02651000
*            /*                                                      */ 02652000
*            /*  PROCEDURE NAME - RELECORE                           */ 02653000
*            /*                                                      */ 02654000
*            /*  FUNCTION                                            */ 02655000
*            /*      THIS RTN WILL SEARCH DMS LOAD LIST,             */ 02656000
*            /*      FREE MODULES NOT IN USE(USE CTR WILL BE         */ 02657000
*            /*      ZERO) THIS SHOULD FREE SOME CORE                */ 02658000
*            /*                                                      */ 02659000
*            /*  INPUT - NONE                                        */ 02660000
*            /*                                                      */ 02661000
*            /*  OUTPUT - NONE                                       */ 02662000
*            /*                                                      */ 02663000
*            /********************************************************/ 02664000
*            /********************************************************/ 02665000
*                                                                  0759 02666000
*RELECORE: PROC;                                                   0759 02667000
*                                                                  0759 02668000
RELECORE STM   @14,@07,@SA00006                                    0759 02669000
         STM   @09,@12,@SA00006+40                                 0759 02670000
*            OLDERID2 = NEWERID2;                                  0760 02671000
         L     @05,GDTTR2(,GDTPR)                                  0760 02672000
         MVC   @TS00001(95),NEWERID2(@05)                          0760 02673000
         MVC   OLDERID2(95,@05),@TS00001                           0760 02674000
*            NEWID2 = 'SAD3';                                      0761 02675000
         MVC   NEWID2(4,@05),@CC00802                              0761 02676000
*            IX = 0;                                               0762 02677000
         SLR   IX,IX                                               0762 02678000
*            LOOPCTL = OFF;                                        0763 02679000
*                                                                  0763 02680000
         NI    LOOPCTL,B'01111111'                                 0763 02681000
*RELDO:        DO WHILE LOOPCTL = OFF;                             0764 02682000
RELDO    B     @DE00764                                            0764 02683000
@DL00764 DS    0H                                                  0765 02684000
*                IF IX = 0                                         0765 02685000
*                  THEN                                            0765 02686000
*                                                                  0765 02687000
         LTR   IX,IX                                               0765 02688000
         BNZ   @RF00765                                            0765 02689000
*                      /**********************************************/ 02690000
*                      /*                                            */ 02691000
*                      /*   FIRST TIME USE POINTER IN                */ 02692000
*                      /*   SYSTEM HIST AREA TO LOAD                 */ 02693000
*                      /*   LIST BLOCK                               */ 02694000
*                      /*                                            */ 02695000
*                      /**********************************************/ 02696000
*                                                                  0766 02697000
*                      P = LLBLKPTR;                               0766 02698000
         L     @05,GDTSAH(,GDTPR)                                  0766 02699000
         L     P,LLBLKPTR(,@05)                                    0766 02700000
*                  ELSE;                                           0767 02701000
*                                                                  0767 02702000
@RF00765 DS    0H                                                  0768 02703000
*                /****************************************************/ 02704000
*                /*                                                  */ 02705000
*                /*           SEARCH EACH LOAD LIST                  */ 02706000
*                /*           BLOCK.WHEN MODULE NAME IS              */ 02707000
*                /*           IN SLOT AND USE CTR IS ZERO            */ 02708000
*                /*           THEN DELETE MODULE FROM CORE           */ 02709000
*                /*                                                  */ 02710000
*                /****************************************************/ 02711000
*                                                                  0768 02712000
*                  DO IX = 1 TO LLSLTCNT;                          0768 02713000
         LA    IX,1                                                0768 02714000
@DL00768 DS    0H                                                  0769 02715000
*                    IF LLNOMOD(IX) = 0 | LLUSECTR(IX) ^= 0        0769 02716000
*                                                                  0769 02717000
*                      THEN;                                       0769 02718000
         SLR   @05,@05                                             0769 02719000
         LR    @03,IX                                              0769 02720000
         SLA   @03,4                                               0769 02721000
         LR    @01,P                                               0769 02722000
         AL    @01,@CF00816                                        0769 02723000
         C     @05,LLNOMOD-12(@03,@01)                             0769 02724000
         BE    @RT00769                                            0769 02725000
         SLR   @15,@15                                             0769 02726000
         IC    @15,LLUSECTR-16(@03,P)                              0769 02727000
         CR    @05,@15                                             0769 02728000
         BNE   @RT00769                                            0769 02729000
*                      ELSE                                        0771 02730000
*                        DO;                                       0771 02731000
*                          RFY REG0 RSTD;                          0772 02732000
*                          REG0 =  ADDR(LLNAME(IX));               0773 02733000
         LR    @05,IX                                              0773 02734000
         SLA   @05,4                                               0773 02735000
         AL    @05,@CF00812                                        0773 02736000
         LA    REG0,LLNAME-8(@05,P)                                0773 02737000
*LDEL2:                    GEN(DELETE  EPLOC=(REG0));              0774 02738000
LDEL2    DELETE  EPLOC=(REG0)                                           02739000
*                          RFY REG0 UNRSTD;                        0775 02740000
*                          LLNOMOD(IX) = 0;                        0776 02741000
         LR    @05,IX                                              0776 02742000
         SLA   @05,4                                               0776 02743000
         SLR   @03,@03                                             0776 02744000
         LR    @01,P                                               0776 02745000
         AL    @01,@CF00816                                        0776 02746000
         ST    @03,LLNOMOD-12(@05,@01)                             0776 02747000
*                          LLNXTSLT(IX) = LLFSTSLT;                0777 02748000
         L     @03,LLFSTSLT(,P)                                    0777 02749000
         LR    @01,P                                               0777 02750000
         AL    @01,@CF00812                                        0777 02751000
         ST    @03,LLNXTSLT-8(@05,@01)                             0777 02752000
*                          LLFSTSLT = ADDR(LLNXTSLT(IX));          0778 02753000
         AL    @05,@CF00812                                        0778 02754000
         LA    @05,LLNXTSLT-8(@05,P)                               0778 02755000
         ST    @05,LLFSTSLT(,P)                                    0778 02756000
*                        END;                                      0779 02757000
*                  END;                                            0780 02758000
@RT00769 AL    IX,@CF00158                                         0780 02759000
         C     IX,@CF00278                                         0780 02760000
         BNH   @DL00768                                            0780 02761000
*                IF LLNXTBLK = 0                                   0781 02762000
*                  THEN                                            0781 02763000
         L     @05,LLNXTBLK(,P)                                    0781 02764000
         LTR   @05,@05                                             0781 02765000
         BNZ   @RF00781                                            0781 02766000
*                    LOOPCTL = ON;                                 0782 02767000
         OI    LOOPCTL,B'10000000'                                 0782 02768000
*                  ELSE                                            0783 02769000
*                    P = LLNXTBLK;                                 0783 02770000
         B     @RC00781                                            0783 02771000
@RF00781 L     P,LLNXTBLK(,P)                                      0783 02772000
*              END RELDO;                                          0784 02773000
*                                                                  0784 02774000
@RC00781 DS    0H                                                  0784 02775000
@DE00764 TM    LOOPCTL,B'10000000'                                 0784 02776000
         BZ    @DL00764                                            0784 02777000
*            IF GDTDBG = NULLPTR                                   0785 02778000
*              THEN;                                               0785 02779000
         L     @05,GDTDBG(,GDTPR)                                  0785 02780000
         LTR   @05,@05                                             0785 02781000
         BZ    @RT00785                                            0785 02782000
*              ELSE                                                0787 02783000
*                CALL ICKDB010(GDTTBL,'SAD4');                     0787 02784000
         ST    GDTPR,@AL00001                                      0787 02785000
         LA    @05,@CC00807                                        0787 02786000
         ST    @05,@AL00001+4                                      0787 02787000
         MVI   @AL00001+4,X'80'                                    0787 02788000
         L     @15,GDTDBG(,GDTPR)                                  0787 02789000
         LA    @01,@AL00001                                        0787 02790000
         BALR  @14,@15                                             0787 02791000
*            RETURN;                                               0788 02792000
@EL00006 DS    0H                                                  0788 02793000
@EF00006 DS    0H                                                  0788 02794000
@ER00006 LM    @14,@07,@SA00006                                    0788 02795000
         LM    @09,@12,@SA00006+40                                 0788 02796000
         BR    @14                                                 0788 02797000
*        END RELECORE;                                             0789 02798000
*                                                                  0789 02799000
         B     @EL00006                                            0789 02800000
@PB00006 DS    0H                                                  0790 02801000
*        /************************************************************/ 02802000
*        /*                                                          */ 02803000
*        /* LIST FORM OF GETMAIN MACRO--MOVED INTO A DYNAMIC AREA FOR*/ 02804000
*        /* USE                                                      */ 02805000
*        /*                                                          */ 02806000
*        /************************************************************/ 02807000
*                                                                  0790 02808000
*        GENERATE DATA;                                            0790 02809000
*                                                                  0790 02810000
*        /************************************************************/ 02811000
*        /*                                                          */ 02812000
*        /* LIST FORM OF THE GETMAIN MACRO, SPECIFYING PAGE          */ 02813000
*        /* BOUNDARY--MOVED INTO A DYNAMIC AREA FOR USE              */ 02814000
*        /*                                                          */ 02815000
*        /************************************************************/ 02816000
*                                                                  0791 02817000
*        GENERATE DATA;                                            0791 02818000
*                                                                  0791 02819000
*        /************************************************************/ 02820000
*        /*                                                          */ 02821000
*        /* FULL REGION (SNAP) DUMP DCB - THIS IS COPIED INTO A      */ 02822000
*        /* DYNAMIC AREA FOR USE                                     */ 02823000
*        /*                                                          */ 02824000
*        /************************************************************/ 02825000
*                                                                  0792 02826000
*        GENERATE DATA;                                            0792 02827000
*                                                                  0792 02828000
*        /************************************************************/ 02829000
*        /*                                                          */ 02830000
*        /* LIST FORM OF OPEN MACRO--MOVED INTO A DYNAMIC AREA FOR   */ 02831000
*        /* USE WITH SNAP                                            */ 02832000
*        /*                                                          */ 02833000
*        /************************************************************/ 02834000
*                                                                  0793 02835000
*        GENERATE DATA;                                            0793 02836000
*                                                                  0793 02837000
*        /************************************************************/ 02838000
*        /*                                                          */ 02839000
*        /* LIST FORM OF SNAP MACRO--MOVED INTO A DYNAMIC AREA FOR   */ 02840000
*        /* USE                                                      */ 02841000
*        /*                                                          */ 02842000
*        /************************************************************/ 02843000
*                                                                  0794 02844000
*        GENERATE DATA;                                            0794 02845000
*                                                                  0794 02846000
*        /************************************************************/ 02847000
*        /*                                                          */ 02848000
*        /* DECLARATION ALLOWING MODULE ICKSA01 ACCESS TO THIS       */ 02849000
*        /* MODULE'S AUTOMATIC STORAGE SIZE VALUE                    */ 02850000
*        /*                                                          */ 02851000
*        /************************************************************/ 02852000
*                                                                  0795 02853000
*        GENERATE DATA;                                            0795 02854000
*        RESPECIFY (GDTPR) UNRSTD;                                 0796 02855000
*        END ICKSA02                                               0797 02856000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02857000
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        * 02858000
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        * 02859000
*/*%INCLUDE SYSLIB  (DMSDF09 )                                        * 02860000
*;                                                                 0797 02861000
@EL00001 L     @13,4(,@13)                                         0797 02862000
@EF00001 L     @00,@SIZDATD                                        0797 02863000
         LR    @01,@11                                             0797 02864000
         FREEMAIN R,LV=(0),A=(1)                                        02865000
@ER00001 LM    @14,@12,12(@13)                                     0797 02866000
         BR    @14                                                 0797 02867000
@DATA    DS    0H                                                       02868000
@SM00814 MVC   INITCHAR(0,@08),ALLINIT                                  02869000
@DATD    DSECT                                                          02870000
         DS    0F                                                       02871000
@SA00001 DS    18F                                                      02872000
@PC00001 DS    20F                                                      02873000
@SA00005 DS    14F                                                      02874000
@PC00005 DS    2F                                                       02875000
@SA00002 DS    14F                                                      02876000
@SA00006 DS    14F                                                      02877000
@SA00004 DS    15F                                                      02878000
@PC00004 DS    3F                                                       02879000
@SA00003 DS    15F                                                      02880000
@AL00001 DS    6A                                                       02881000
@TF00001 DS    F                                                        02882000
ICKSA02  CSECT                                                          02883000
         DS    0F                                                       02884000
@CF00087 DC    F'0'                                                     02885000
@CF00158 DC    F'1'                                                     02886000
@CF00129 DC    F'3'                                                     02887000
@CF00037 DC    F'4'                                                     02888000
@CH00037 EQU   @CF00037+2                                               02889000
@CF00154 DC    F'8'                                                     02890000
@CF00033 DC    F'12'                                                    02891000
@CF00262 DC    F'16'                                                    02892000
@CF00278 DC    F'24'                                                    02893000
@CF00634 DC    F'255'                                                   02894000
@CF00809 DC    F'392'                                                   02895000
@CF00812 DC    F'-8'                                                    02896000
@CF00816 DC    F'-4'                                                    02897000
@DATD    DSECT                                                          02898000
         DS    0D                                                       02899000
LISTPTR  DS    A                                                        02900000
LISTSCAN DS    A                                                        02901000
IOCSPTR  DS    A                                                        02902000
OPNPTR   DS    A                                                        02903000
DDSTRU   DS    A                                                        02904000
FSADDR   DS    A                                                        02905000
DMPINDEX DS    A                                                        02906000
PARMPTR5 DS    A                                                        02907000
TEMPPTR  DS    A                                                        02908000
INITPTR  DS    A                                                        02909000
INITSIZE DS    F                                                        02910000
CLENTPT  DS    A                                                        02911000
PGCNTPTR DS    A                                                        02912000
SADCB    DS    AL4                                                      02913000
         ORG   SADCB                                                    02914000
BLOCKFLG DS    BL1                                                      02915000
         ORG   SADCB+4                                                  02916000
DELPARM  DS    F                                                        02917000
SETRC    DS    H                                                        02918000
LISTLN   DS    FL1                                                      02919000
@TS00001 DS    CL95                                                     02920000
DOCNTRL  DS    BL1                                                      02921000
         DS    CL1                                                      02922000
TEMPEPN  DS    CL8                                                      02923000
LOOPCTL  DS    BL1                                                      02924000
NAMEFND  DS    BL1                                                      02925000
         DS    CL2                                                      02926000
GETLIST  DS    CL10                                                     02927000
         ORG   GETLIST                                                  02928000
GETSZ    DS    FL4                                                      02929000
GETPT    DS    AL4                                                      02930000
GETFLG   DS    CL2                                                      02931000
         ORG   GETLIST+10                                               02932000
         DS    CL2                                                      02933000
FREELIST DS    CL8                                                      02934000
         ORG   FREELIST                                                 02935000
FREEPT   DS    AL4                                                      02936000
FREESZ   DS    FL4                                                      02937000
         ORG   FREELIST+8                                               02938000
OPENLIST DS    CL4                                                      02939000
         ORG   OPENLIST                                                 02940000
OPENOPT  DS    CL1                                                      02941000
OPENADDR DS    AL3                                                      02942000
         ORG   OPENLIST+4                                               02943000
SNAPLIST DS    CL16                                                     02944000
         ORG   SNAPLIST                                                 02945000
SNAPIDEN DS    FL1                                                      02946000
SNAPOPT  DS    CL3                                                      02947000
SNAPPTR  DS    AL4                                                      02948000
SNAPTCB  DS    AL4                                                      02949000
SNAPLST  DS    AL4                                                      02950000
         ORG   SNAPLIST+16                                              02951000
DUMPDCB  DS    CL88                                                     02952000
ALLINIT  DS    CL256                                                    02953000
CHARIN   DS    CL1                                                      02954000
LOADNAME DS    CL8                                                      02955000
         DS    CL3                                                      02956000
MSGAREA  DS    CL20                                                     02957000
ICKSA02  CSECT                                                          02958000
         DS    0F                                                       02959000
@SIZDATD DC    AL1(0)                                                   02960000
         DC    AL3(@ENDDATD-@DATD)                                      02961000
         DS    0D                                                       02962000
PGCTLEN  DC    AL4(24)                                                  02963000
@CC00722 DC    C'ICKSA05 '                                              02964000
@CC00138 DC    C'ZERO'                                                  02965000
@CC00140 DC    C'BLNK'                                                  02966000
@CC00142 DC    C'NSET'                                                  02967000
@CC00579 DC    C'SACL'                                                  02968000
@CC00598 DC    C'SALD'                                                  02969000
@CC00610 DC    C'SADE'                                                  02970000
@CC00635 DC    C'SAGS'                                                  02971000
@CC00652 DC    C'SAFS'                                                  02972000
@CC00680 DC    C'SAGP'                                                  02973000
@CC00699 DC    C'SAFP'                                                  02974000
@CC00721 DC    C'SATI'                                                  02975000
@CC00752 DC    C'SASN'                                                  02976000
@CC00796 DC    C'SABB'                                                  02977000
@CC00802 DC    C'SAD3'                                                  02978000
@CC00807 DC    C'SAD4'                                                  02979000
@CC00130 DC    C'ALL'                                                   02980000
@CC00653 DC    C'   '                                                   02981000
@CC00681 DC    C'PG'                                                    02982000
FIXAREA  DS    CL300                                                    02983000
         ORG   FIXAREA                                                  02984000
@NM00018 DC    300X'00'                                                 02985000
         ORG   FIXAREA+300                                              02986000
MODID    DC    CL4'SA02'                                                02987000
SETB     DC    CL1' '                                                   02988000
SET0     DC    X'00'                                                    02989000
@DATD    DSECT                                                          02990000
ICKSA02 CSECT                                                           02991000
GETGEN  GETMAIN EC,LV=8,A=GETGEN,MF=L                                   02992000
@DATD    DSECT                                                          02993000
ICKSA02 CSECT                                                           02994000
GETGENPG GETMAIN EC,LV=8,A=GETGENPG,BNDRY=PAGE,MF=L                     02995000
@DATD    DSECT                                                          02996000
ICKSA02 CSECT                                                           02997000
DCBGEN   DCB   DSORG=PS,RECFM=VBA,MACRF=(W),BLKSIZE=882,LRECL=125,    XX02998000
               DDNAME=DMSDUMP                                           02999000
@DATD    DSECT                                                          03000000
ICKSA02 CSECT                                                           03001000
OPENGEN  OPEN  (,(OUTPUT)),MF=L                                         03002000
@DATD    DSECT                                                          03003000
ICKSA02 CSECT                                                           03004000
SNAPGEN  SNAP  DCB=DCBGEN,SDATA=(CB,Q),PDATA=(ALL),ID=(00),MF=L         03005000
@DATD    DSECT                                                          03006000
ICKSA02 CSECT                                                           03007000
ICKSAS2 DC    A(@SIZDATD)                                               03008000
        ENTRY ICKSAS2                                                   03009000
@DATD    DSECT                                                          03010000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03011000
@ENDDATD EQU   *                                                        03012000
ICKSA02  CSECT                                                          03013000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03014000
@01      EQU   01                                                       03015000
@02      EQU   02                                                       03016000
@03      EQU   03                                                       03017000
@04      EQU   04                                                       03018000
@05      EQU   05                                                       03019000
@06      EQU   06                                                       03020000
@07      EQU   07                                                       03021000
@08      EQU   08                                                       03022000
@09      EQU   09                                                       03023000
@10      EQU   10                                                       03024000
@11      EQU   11                                                       03025000
@12      EQU   12                                                       03026000
@13      EQU   13                                                       03027000
@14      EQU   14                                                       03028000
@15      EQU   15                                                       03029000
SLTOUSE  EQU   @03                                                      03030000
INDX     EQU   @02                                                      03031000
SPIDPTR  EQU   @02                                                      03032000
P        EQU   @08                                                      03033000
IX       EQU   @02                                                      03034000
PARMPTR4 EQU   @05                                                      03035000
PARMPTR3 EQU   @02                                                      03036000
PARMPTR2 EQU   @03                                                      03037000
TESTRC   EQU   @06                                                      03038000
RTNREG   EQU   @15                                                      03039000
REG0     EQU   @00                                                      03040000
REG1     EQU   @01                                                      03041000
REG2     EQU   @02                                                      03042000
REG3     EQU   @03                                                      03043000
REG4     EQU   @04                                                      03044000
REG11    EQU   @11                                                      03045000
REG13    EQU   @13                                                      03046000
REG14    EQU   @14                                                      03047000
REG15    EQU   @15                                                      03048000
GDTPR    EQU   @09                                                      03049000
REG1PTR  EQU   @01                                                      03050000
REG10    EQU   @10                                                      03051000
REG12    EQU   @12                                                      03052000
REG5     EQU   @05                                                      03053000
REG6     EQU   @06                                                      03054000
REG7     EQU   @07                                                      03055000
REG8     EQU   @08                                                      03056000
REG9     EQU   @09                                                      03057000
GDTTBL   EQU   0                                                        03058000
GDTTR1   EQU   GDTTBL+8                                                 03059000
GDTTR2   EQU   GDTTBL+12                                                03060000
GDTSAH   EQU   GDTTBL+32                                                03061000
GDTDIN   EQU   GDTTBL+44                                                03062000
GDTDOP   EQU   GDTTBL+48                                                03063000
GDTDBG   EQU   GDTTBL+52                                                03064000
GDTDVO   EQU   GDTTBL+56                                                03065000
GDTPRT   EQU   GDTTBL+60                                                03066000
GDTESS   EQU   GDTTBL+64                                                03067000
GDTESA   EQU   GDTTBL+68                                                03068000
GDTRST   EQU   GDTTBL+72                                                03069000
GDTRES   EQU   GDTTBL+76                                                03070000
GDTCAL   EQU   GDTTBL+80                                                03071000
GDTGSP   EQU   GDTTBL+84                                                03072000
GDTFSP   EQU   GDTTBL+88                                                03073000
GDTGPL   EQU   GDTTBL+92                                                03074000
GDTFPL   EQU   GDTTBL+96                                                03075000
GDTLOD   EQU   GDTTBL+100                                               03076000
GDTDEL   EQU   GDTTBL+104                                               03077000
GDTPRL   EQU   GDTTBL+108                                               03078000
GDTEPL   EQU   GDTTBL+112                                               03079000
GDTTIM   EQU   GDTTBL+116                                               03080000
GDTIIO   EQU   GDTTBL+120                                               03081000
GDTTIO   EQU   GDTTBL+124                                               03082000
GDTOPN   EQU   GDTTBL+136                                               03083000
GDTCLS   EQU   GDTTBL+140                                               03084000
GDTGET   EQU   GDTTBL+144                                               03085000
GDTPUT   EQU   GDTTBL+148                                               03086000
GDTABT   EQU   GDTTBL+152                                               03087000
GDTABH   EQU   GDTTBL+156                                               03088000
GDTSNP   EQU   GDTTBL+160                                               03089000
GDTWTO   EQU   GDTTBL+168                                               03090000
GDTSCR   EQU   GDTTBL+172                                               03091000
GDTVCK   EQU   GDTTBL+176                                               03092000
GDTDVC   EQU   GDTTBL+180                                               03093000
GDTSTE   EQU   GDTTBL+188                                               03094000
ICKSACL0 EQU   0                                                        03095000
ICKSAEP0 EQU   0                                                        03096000
ICKSAGS0 EQU   0                                                        03097000
TRACE1   EQU   0                                                        03098000
OLDERID1 EQU   TRACE1                                                   03099000
TRACE2   EQU   0                                                        03100000
OLDERID2 EQU   TRACE2                                                   03101000
NEWID2   EQU   TRACE2+95                                                03102000
NEWERID2 EQU   5                                                        03103000
STAEPARM EQU   0                                                        03104000
STAEPFX  EQU   STAEPARM                                                 03105000
LISTTEST EQU   0                                                        03106000
IOCSTR   EQU   0                                                        03107000
IOCDSO   EQU   IOCSTR+13                                                03108000
IOCRFM   EQU   IOCSTR+14                                                03109000
IOCMAC   EQU   IOCSTR+15                                                03110000
IOCMSG   EQU   IOCSTR+16                                                03111000
OPNAGL   EQU   0                                                        03112000
OPNOPT   EQU   OPNAGL                                                   03113000
OPNRFM   EQU   OPNAGL+1                                                 03114000
OPNTYP   EQU   OPNAGL+2                                                 03115000
OPNMOD   EQU   OPNAGL+3                                                 03116000
UVOLLIST EQU   0                                                        03117000
UVOLENT  EQU   UVOLLIST+2                                               03118000
DARGLIST EQU   0                                                        03119000
DARGSTID EQU   DARGLIST+8                                               03120000
DARGARY  EQU   DARGLIST+20                                              03121000
DARGINS  EQU   DARGARY                                                  03122000
DARGINL  EQU   DARGARY+2                                                03123000
FMTLIST  EQU   0                                                        03124000
FMTFLGS  EQU   FMTLIST                                                  03125000
FMTSPF   EQU   FMTLIST+2                                                03126000
FMTRFNO  EQU   FMTSPF                                                   03127000
FMTILEN  EQU   FMTRFNO                                                  03128000
FMTIOFF  EQU   FMTLIST+4                                                03129000
FMTTRBC  EQU   FMTIOFF                                                  03130000
FMTSTO   EQU   FMTTRBC                                                  03131000
FMTOCOL  EQU   FMTLIST+6                                                03132000
FMTCNVF  EQU   FMTLIST+10                                               03133000
ICKDB010 EQU   0                                                        03134000
DMPITM   EQU   0                                                        03135000
DMPARY   EQU   0                                                        03136000
ADDR1    EQU   0                                                        03137000
ADDR2    EQU   0                                                        03138000
ADDR3    EQU   0                                                        03139000
ADDR4    EQU   0                                                        03140000
ADDR5    EQU   0                                                        03141000
FREEID   EQU   0                                                        03142000
LLBLK    EQU   0                                                        03143000
LLHDR    EQU   LLBLK                                                    03144000
LLFSTSLT EQU   LLHDR                                                    03145000
LLNXTBLK EQU   LLHDR+4                                                  03146000
LLSLOT   EQU   LLBLK+8                                                  03147000
LLNAME   EQU   LLSLOT                                                   03148000
LLNXTSLT EQU   LLNAME                                                   03149000
LLNOMOD  EQU   LLNAME+4                                                 03150000
LLADDR   EQU   LLSLOT+8                                                 03151000
LLUSECTR EQU   LLSLOT+12                                                03152000
LLMODSZ  EQU   LLSLOT+13                                                03153000
SAHIST   EQU   0                                                        03154000
GPFIRST  EQU   SAHIST                                                   03155000
GPLAST   EQU   SAHIST+4                                                 03156000
AUTOPTR  EQU   SAHIST+8                                                 03157000
LLBLKPTR EQU   SAHIST+16                                                03158000
AUTOTBL  EQU   0                                                        03159000
AUTOARAY EQU   AUTOTBL                                                  03160000
STATUS   EQU   AUTOARAY+4                                               03161000
@NM00019 EQU   0                                                        03162000
AUTOSIZE EQU   @NM00019                                                 03163000
GSCNTRL  EQU   0                                                        03164000
GSLEN    EQU   GSCNTRL                                                  03165000
GSLENID  EQU   GSLEN                                                    03166000
GSID     EQU   GSCNTRL+4                                                03167000
GSSUBPID EQU   GSID+3                                                   03168000
GPCNTRL  EQU   0                                                        03169000
GPFORWRD EQU   GPCNTRL                                                  03170000
GPBACK   EQU   GPCNTRL+4                                                03171000
GPLEN    EQU   GPCNTRL+8                                                03172000
GPID     EQU   GPCNTRL+12                                               03173000
GPADRPG  EQU   GPCNTRL+16                                               03174000
GPLENPG  EQU   GPCNTRL+20                                               03175000
PRECNTRL EQU   0                                                        03176000
PREFWD   EQU   PRECNTRL                                                 03177000
PASCNTRL EQU   0                                                        03178000
PASBACK  EQU   PASCNTRL+4                                               03179000
CLNAME   EQU   0                                                        03180000
LDMOD    EQU   0                                                        03181000
LDPOINT  EQU   0                                                        03182000
DEMOD    EQU   0                                                        03183000
GSSIZE   EQU   0                                                        03184000
GSPOINT  EQU   0                                                        03185000
GSINIT   EQU   0                                                        03186000
GSSPID   EQU   0                                                        03187000
FSPOINT  EQU   0                                                        03188000
GPSIZE   EQU   0                                                        03189000
GPPOINT  EQU   0                                                        03190000
GPIDVAR  EQU   0                                                        03191000
GPINIT   EQU   0                                                        03192000
GPFCHAIN EQU   0                                                        03193000
FPIDVAR  EQU   0                                                        03194000
FPALL    EQU   0                                                        03195000
TIDATE   EQU   0                                                        03196000
TITIME   EQU   0                                                        03197000
TIFORM   EQU   0                                                        03198000
SNAPID   EQU   0                                                        03199000
INITCHAR EQU   0                                                        03200000
DMPTRM   EQU   0                                                        03201000
ICKDVCL0 EQU   0                                                        03202000
ICKDVIN0 EQU   0                                                        03203000
ICKDVON0 EQU   0                                                        03204000
ICKDVOP0 EQU   0                                                        03205000
ICKIOCL0 EQU   0                                                        03206000
ICKIOGT0 EQU   0                                                        03207000
ICKIOIT0 EQU   0                                                        03208000
ICKIOOP0 EQU   0                                                        03209000
ICKIOPT0 EQU   0                                                        03210000
ICKIOTM0 EQU   0                                                        03211000
ICKSADE0 EQU   0                                                        03212000
ICKSAFP0 EQU   0                                                        03213000
ICKSAFS0 EQU   0                                                        03214000
ICKSAGP0 EQU   0                                                        03215000
ICKSALD0 EQU   0                                                        03216000
ICKSAPR0 EQU   0                                                        03217000
ICKSASC0 EQU   0                                                        03218000
ICKSASN0 EQU   0                                                        03219000
ICKSAST0 EQU   0                                                        03220000
ICKSATI0 EQU   0                                                        03221000
ICKSAVC0 EQU   0                                                        03222000
ICKSAWO0 EQU   0                                                        03223000
ICKTPEA0 EQU   0                                                        03224000
ICKTPES0 EQU   0                                                        03225000
ICKTPPR0 EQU   0                                                        03226000
ICKTPRE0 EQU   0                                                        03227000
ICKTPRS0 EQU   0                                                        03228000
NEWERID1 EQU   5                                                        03229000
GDTTBLX  EQU   0                                                        03230000
CLNAMEX  EQU   0                                                        03231000
LDMODX   EQU   0                                                        03232000
LDPOINTX EQU   0                                                        03233000
DEMODX   EQU   0                                                        03234000
GSSIZEX  EQU   0                                                        03235000
GSPOINTX EQU   0                                                        03236000
GSINITX  EQU   0                                                        03237000
GSSPIDX  EQU   0                                                        03238000
FSPOINTX EQU   0                                                        03239000
GPSIZEX  EQU   0                                                        03240000
GPPOINTX EQU   0                                                        03241000
GPIDVARX EQU   0                                                        03242000
GPINITX  EQU   0                                                        03243000
FPIDVARX EQU   0                                                        03244000
FPALLX   EQU   0                                                        03245000
TITIMEX  EQU   0                                                        03246000
TIDATEX  EQU   0                                                        03247000
TIFORMX  EQU   0                                                        03248000
SNAPIDX  EQU   0                                                        03249000
ZSIZE    EQU   0                                                        03250000
ZPTR     EQU   0                                                        03251000
INITC    EQU   0                                                        03252000
CLNAMX   EQU   0                                                        03253000
ENTPT    EQU   0                                                        03254000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03255000
PASFWD   EQU   PASCNTRL                                                 03256000
@NM00021 EQU   GSID                                                     03257000
@NM00020 EQU   GSLEN+1                                                  03258000
AUTOID   EQU   @NM00019+4                                               03259000
PTR1     EQU   AUTOARAY+8                                               03260000
ASIZE    EQU   AUTOARAY+6                                               03261000
AREAID   EQU   AUTOARAY                                                 03262000
SAHSTA   EQU   SAHIST+12                                                03263000
@NM00017 EQU   DMPARY+15                                                03264000
DMPARYTP EQU   DMPARY+14                                                03265000
DMPARYEX EQU   DMPARY+12                                                03266000
DMPARYIC EQU   DMPARY+10                                                03267000
DMPARYSZ EQU   DMPARY+8                                                 03268000
DMPARYNM EQU   DMPARY                                                   03269000
@NM00016 EQU   DMPITM+15                                                03270000
DMPITMTP EQU   DMPITM+14                                                03271000
DMPITMLN EQU   DMPITM+12                                                03272000
DMPITMPT EQU   DMPITM+8                                                 03273000
DMPITMNM EQU   DMPITM                                                   03274000
@NM00015 EQU   FMTCNVF+1                                                03275000
FMTBS    EQU   FMTCNVF+1                                                03276000
FMTSS    EQU   FMTCNVF+1                                                03277000
FMTAL    EQU   FMTCNVF+1                                                03278000
FMTZS    EQU   FMTCNVF+1                                                03279000
@NM00014 EQU   FMTCNVF                                                  03280000
FMTPU    EQU   FMTCNVF                                                  03281000
FMTBD    EQU   FMTCNVF                                                  03282000
FMTBHD   EQU   FMTCNVF                                                  03283000
FMTBHA   EQU   FMTCNVF                                                  03284000
FMTBH    EQU   FMTCNVF                                                  03285000
FMTOLEN  EQU   FMTLIST+8                                                03286000
FMTRIO   EQU   FMTOCOL                                                  03287000
FMTSPT   EQU   FMTSTO                                                   03288000
FMTSTL   EQU   FMTILEN                                                  03289000
@NM00013 EQU   FMTFLGS+1                                                03290000
FMTHDF   EQU   FMTFLGS                                                  03291000
FMTDFF   EQU   FMTFLGS                                                  03292000
FMTSTF   EQU   FMTFLGS                                                  03293000
FMTREPF  EQU   FMTFLGS                                                  03294000
FMTBDF   EQU   FMTFLGS                                                  03295000
FMTIDF   EQU   FMTFLGS                                                  03296000
FMTSCF   EQU   FMTFLGS                                                  03297000
FMTEOLF  EQU   FMTFLGS                                                  03298000
DARGDTM  EQU   DARGARY+4                                                03299000
DARGPCT  EQU   DARGINL                                                  03300000
DARGREP  EQU   DARGINS                                                  03301000
@NM00012 EQU   DARGLIST+19                                              03302000
DARGIND  EQU   DARGLIST+18                                              03303000
DARGRETL EQU   DARGLIST+16                                              03304000
DARGCNT  EQU   DARGLIST+14                                              03305000
DARGILP  EQU   DARGLIST+12                                              03306000
DARGSENT EQU   DARGSTID+3                                               03307000
DARGSMOD EQU   DARGSTID                                                 03308000
DARGRETP EQU   DARGLIST+4                                               03309000
DARGDBP  EQU   DARGLIST                                                 03310000
UVOLVOL  EQU   UVOLENT+4                                                03311000
UVOLDEV  EQU   UVOLENT                                                  03312000
UVOLCNT  EQU   UVOLLIST                                                 03313000
OPNRSVD  EQU   OPNAGL+28                                                03314000
OPNVOL   EQU   OPNAGL+24                                                03315000
OPNBLK   EQU   OPNAGL+20                                                03316000
OPNREC   EQU   OPNAGL+16                                                03317000
OPNDSN   EQU   OPNAGL+12                                                03318000
OPNDDN   EQU   OPNAGL+8                                                 03319000
OPNIOC   EQU   OPNAGL+4                                                 03320000
@NM00011 EQU   OPNMOD                                                   03321000
OPNMODRC EQU   OPNMOD                                                   03322000
OPNMODAC EQU   OPNMOD                                                   03323000
@NM00010 EQU   OPNTYP                                                   03324000
OPNTYPSO EQU   OPNTYP                                                   03325000
OPNTYPSI EQU   OPNTYP                                                   03326000
@NM00009 EQU   OPNRFM                                                   03327000
OPNRFMBK EQU   OPNRFM                                                   03328000
OPNRFMSF EQU   OPNRFM                                                   03329000
OPNRFMUN EQU   OPNRFM                                                   03330000
OPNRFMVR EQU   OPNRFM                                                   03331000
OPNRFMFX EQU   OPNRFM                                                   03332000
@NM00008 EQU   OPNOPT                                                   03333000
OPNOPTJM EQU   OPNOPT                                                   03334000
OPNOPTKS EQU   OPNOPT                                                   03335000
OPNOPTBK EQU   OPNOPT                                                   03336000
OPNOPTUP EQU   OPNOPT                                                   03337000
OPNOPTOT EQU   OPNOPT                                                   03338000
OPNOPTIN EQU   OPNOPT                                                   03339000
IOCEXT   EQU   IOCSTR+36                                                03340000
IOCRRN   EQU   IOCSTR+32                                                03341000
@NM00007 EQU   IOCSTR+30                                                03342000
IOCPNM   EQU   IOCSTR+28                                                03343000
IOCCBP   EQU   IOCSTR+24                                                03344000
IOCDSN   EQU   IOCSTR+20                                                03345000
@NM00006 EQU   IOCSTR+17                                                03346000
@NM00005 EQU   IOCMSG                                                   03347000
IOCMSGOP EQU   IOCMSG                                                   03348000
IOCMACPA EQU   IOCMAC                                                   03349000
@NM00004 EQU   IOCMAC                                                   03350000
IOCMACBK EQU   IOCMAC                                                   03351000
IOCMACUP EQU   IOCMAC                                                   03352000
IOCMACOT EQU   IOCMAC                                                   03353000
IOCMACIN EQU   IOCMAC                                                   03354000
@NM00003 EQU   IOCRFM                                                   03355000
IOCRFMBK EQU   IOCRFM                                                   03356000
IOCRFMSF EQU   IOCRFM                                                   03357000
IOCRFMUN EQU   IOCRFM                                                   03358000
IOCRFMVR EQU   IOCRFM                                                   03359000
IOCRFMFX EQU   IOCRFM                                                   03360000
@NM00002 EQU   IOCDSO                                                   03361000
IOCDSOPS EQU   IOCDSO                                                   03362000
IOCKYL   EQU   IOCSTR+12                                                03363000
IOCTRN   EQU   IOCSTR+8                                                 03364000
IOCDLN   EQU   IOCSTR+4                                                 03365000
IOCDAD   EQU   IOCSTR                                                   03366000
STAEWORK EQU   STAEPARM+32                                              03367000
STARPTR  EQU   STAEPFX+28                                               03368000
STASPTR  EQU   STAEPFX+24                                               03369000
STALEN   EQU   STAEPFX+20                                               03370000
STAID    EQU   STAEPFX+16                                               03371000
STAEPA   EQU   STAEPFX+12                                               03372000
STAGDT   EQU   STAEPFX+8                                                03373000
STABPTR  EQU   STAEPFX+4                                                03374000
STAFPTR  EQU   STAEPFX                                                  03375000
NEWID1   EQU   TRACE1+95                                                03376000
CALLID   EQU   OLDERID1+90                                              03377000
@NM00001 EQU   OLDERID1                                                 03378000
GDTCVR   EQU   GDTTBL+184                                               03379000
GDTSPR   EQU   GDTTBL+164                                               03380000
GDTTOH   EQU   GDTTBL+132                                               03381000
GDTRIP   EQU   GDTTBL+128                                               03382000
GDTDVH   EQU   GDTTBL+40                                                03383000
GDTIOH   EQU   GDTTBL+36                                                03384000
GDTTPH   EQU   GDTTBL+28                                                03385000
GDTRIH   EQU   GDTTBL+24                                                03386000
GDTSTH   EQU   GDTTBL+20                                                03387000
GDTDBH   EQU   GDTTBL+16                                                03388000
GDTPRM   EQU   GDTTBL+4                                                 03389000
GDTHDR   EQU   GDTTBL                                                   03390000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03391000
@RC00287 EQU   @RC00283                                                 03392000
@RC00328 EQU   @RC00324                                                 03393000
@RF00344 EQU   @RC00336                                                 03394000
@RF00359 EQU   @RC00336                                                 03395000
@RC00357 EQU   @RC00336                                                 03396000
@RC00441 EQU   @RC00437                                                 03397000
@RF00489 EQU   @RC00449                                                 03398000
@RC00502 EQU   @RC00449                                                 03399000
@RC00724 EQU   @RC00716                                                 03400000
@RT00711 EQU   @EL00005                                                 03401000
@PB00005 EQU   @PB00006                                                 03402000
@RT00785 EQU   @EL00006                                                 03403000
@PB00004 EQU   @PB00005                                                 03404000
@PB00003 EQU   @PB00004                                                 03405000
@PB00002 EQU   @PB00003                                                 03406000
@ENDDATA EQU   *                                                        03407000
         END   ICKSA02,(C'PLS1738',0701,78192)                          03408000
