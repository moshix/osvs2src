         TITLE '******* ICKSA03  SYSTEM ADAPTER PROL/UEPIL MODULE      *00001000
                 *******'                                               00002000
ICKSA03 CSECT                                                           00003000
MAINENT DS    0H                                                        00004000
        USING *,REG15                                                   00005000
        B     PROLOG                                                    00006000
        DC    AL2(BEGIN-MAINENT)                                        00007000
        DC    C'ICKSA03 '                                               00008000
ICKSAPR DS    0H                                                        00009000
        USING *,REG15                                                   00010000
        B     PROLOG                                                    00011000
        DC    AL2(DMSSAPR1-ICKSAPR)                                     00012000
        ENTRY ICKSAPR                                                   00013000
ICKSAEP DS    0H                                                        00014000
        USING *,REG15                                                   00015000
        B     PROLOG                                                    00016000
        DC    AL2(DMSSAEP1-ICKSAEP)                                     00017000
        ENTRY ICKSAEP                                                   00018000
        DROP  REG15                                                     00019000
PROLOG  AH    REG15,4(REG15)                                            00020000
        BR    REG15                                                     00021000
BEGIN   DS    0H                                                        00022000
*                                                                  0213 00023000
*                                                                  0213 00024000
*        /************************************************************/ 00025000
*        /*                                                          */ 00026000
*        /* PROL ROUTINE ENTRY POINT                                 */ 00027000
*        /*                                                          */ 00028000
*        /************************************************************/ 00029000
*                                                                  0214 00030000
*ICKSAPR:  ENTRY(MODIDX,PSIZEX);                                   0214 00031000
*                                                                  0214 00032000
@EC00214 DS    0H                                                  0215 00033000
*DMSSAPR1:                                                         0215 00034000
*                                                                  0215 00035000
*        /************************************************************/ 00036000
*        /*                                                          */ 00037000
*        /* PROLOG CODE FOR PROL ROUTINE                             */ 00038000
*        /*                                                          */ 00039000
*        /************************************************************/ 00040000
*                                                                  0215 00041000
*        GEN;                                                      0215 00042000
*                                                                  0215 00043000
DMSSAPR1 DS    0H                                                  0215 00044000
        L     REG15,24(REG13)         REGISTER 1 FROM SAVEAREA          00045000
        L     REG15,0(REG15)          GDTTBL ADDRESS                    00046000
        L     REG15,GDTSPR(REG15)     FROZEN AUTOMATIC STORAGE ADDR     00047000
        USING @DATD,REG15             DATA ADDRESSABILITY               00048000
        STM   REG2,REG12,PROLSAV      SAVE REGISTERS                    00049000
        DROP  REG15                                                     00050000
        L     REG2,24(REG13)          REGISTER 1 FROM SAVEAREA          00051000
        L     REG2,0(REG2)            GDTTBL ADDRESS                    00052000
        LR    REG11,REG15             FROZEN AUTOMATIC STORAGE ADDR     00053000
        USING @DATD,REG11             DATA ADDRESSABILITY               00054000
        ST    REG13,@SA00001+4                                          00055000
        ST    REG11,8(REG13)                                            00056000
        LR    REG13,REG11                                               00057000
        BALR  REG12,0                                                   00058000
PSTART1 DS    0H                                                        00059000
        USING PSTART1,REG12           CODE ADDRESSABILITY               00060000
*        /************************************************************/ 00061000
*        /*                                                          */ 00062000
*        /* BASE FOR THE GDTTBL IS ALREADY SET UP IN THE PROL CODE   */ 00063000
*        /* FOR THIS ROUTINE--NOW SET UP BASE FOR MODID AND PSIZE    */ 00064000
*        /*                                                          */ 00065000
*        /************************************************************/ 00066000
*                                                                  0216 00067000
*        RESPECIFY (REG1,REG14) RSTD;                              0216 00068000
*        GEN(L     MODIDPR,0(REG1));                               0217 00069000
         L     MODIDPR,0(REG1)                                          00070000
*        GEN(L     SIZEPR,4(REG1));                                0218 00071000
         L     SIZEPR,4(REG1)                                           00072000
*        RESPECIFY (REG1) UNRSTD;                                  0219 00073000
*                                                                  0219 00074000
*        /************************************************************/ 00075000
*        /*                                                          */ 00076000
*        /* SAVE THE RETURN ADDRESS IN REGISTER 14                   */ 00077000
*        /*                                                          */ 00078000
*        /************************************************************/ 00079000
*                                                                  0220 00080000
*        RTNADDR = REG14;                                          0220 00081000
         LR    RTNADDR,REG14                                       0220 00082000
*        RESPECIFY (REG14) UNRSTD;                                 0221 00083000
*                                                                  0221 00084000
*        TEMPID = MODID;                                           0222 00085000
*                                                                  0222 00086000
         MVC   TEMPID(4),MODID(MODIDPR)                            0222 00087000
*        /************************************************************/ 00088000
*        /*                                                          */ 00089000
*        /* DETERMINE IF MODULE ID IS CONTAINED IN FROZEN AUTOMATIC  */ 00090000
*        /* STORAGE TABLE                                            */ 00091000
*        /*                                                          */ 00092000
*        /************************************************************/ 00093000
*                                                                  0223 00094000
*        DOCNTRL = ON;                                             0223 00095000
         OI    DOCNTRL,B'10000000'                                 0223 00096000
*PRDO:   DO I=1 TO DIM(AUTOARAY) WHILE(DOCNTRL = ON);              0224 00097000
*                                                                  0224 00098000
PRDO     LA    I,1                                                 0224 00099000
@DL00224 TM    DOCNTRL,B'10000000'                                 0224 00100000
         BNO   @DC00224                                            0224 00101000
*          /**********************************************************/ 00102000
*          /*                                                        */ 00103000
*          /* DETERMINE IF MODULE ID MATCHES ID IN FROZEN AUTOMATIC  */ 00104000
*          /* STORAGE TABLE                                          */ 00105000
*          /*                                                        */ 00106000
*          /**********************************************************/ 00107000
*                                                                  0225 00108000
*          IF AREAID(I) = TEMPID                                   0225 00109000
*            THEN                                                  0225 00110000
         LR    @08,I                                               0225 00111000
         MH    @08,@CH00032                                        0225 00112000
         L     @07,GDTSAH(,GDTPR)                                  0225 00113000
         L     @07,AUTOPTR(,@07)                                   0225 00114000
         ALR   @07,@08                                             0225 00115000
         AL    @07,@CF00595                                        0225 00116000
         CLC   AREAID(4,@07),TEMPID                                0225 00117000
         BNE   @RF00225                                            0225 00118000
*              DOCNTRL = OFF;                                      0226 00119000
         NI    DOCNTRL,B'01111111'                                 0226 00120000
*        END PRDO;                                                 0227 00121000
*                                                                  0227 00122000
@RF00225 AL    I,@CF00157                                          0227 00123000
         C     I,@CF00111                                          0227 00124000
         BNH   @DL00224                                            0227 00125000
@DC00224 DS    0H                                                  0228 00126000
*        /************************************************************/ 00127000
*        /*                                                          */ 00128000
*        /* CHECK WHETHER OR NOT MODULE ID IS CONTAINED IN FROZEN    */ 00129000
*        /* AUTOMATIC STORAGE TABLE                                  */ 00130000
*        /*                                                          */ 00131000
*        /************************************************************/ 00132000
*                                                                  0228 00133000
*        IF DOCNTRL = ON                                           0228 00134000
*          THEN                                                    0228 00135000
         TM    DOCNTRL,B'10000000'                                 0228 00136000
         BNO   @RF00228                                            0228 00137000
*            DO;                                                   0229 00138000
*                                                                  0229 00139000
*              /******************************************************/ 00140000
*              /*                                                    */ 00141000
*              /* MODULE ID IS NOT CONTAINED IN FROZEN AUTOMATIC     */ 00142000
*              /* STORAGE TABLE SO CALL GETCORE ROUTINE TO GET CORE  */ 00143000
*              /* PLUS 8 BYTES FOR CONTROL INFORMATION               */ 00144000
*              /*                                                    */ 00145000
*              /******************************************************/ 00146000
*                                                                  0230 00147000
*              TEMPSIZE = PSIZE + 8;                               0230 00148000
         LA    @08,8                                               0230 00149000
         AL    @08,PSIZE(,SIZEPR)                                  0230 00150000
         ST    @08,TEMPSIZE                                        0230 00151000
*              CALL GETCORE(TEMPSIZE,TEMPPTR);                     0231 00152000
*                                                                  0231 00153000
         LA    @08,TEMPSIZE                                        0231 00154000
         ST    @08,@AL00001                                        0231 00155000
         LA    @08,TEMPPTR                                         0231 00156000
         ST    @08,@AL00001+4                                      0231 00157000
         LA    @01,@AL00001                                        0231 00158000
         BAL   @14,GETCORE                                         0231 00159000
*              /******************************************************/ 00160000
*              /*                                                    */ 00161000
*              /* STORE ADDRESS OF ACQUIRED CORE INTO REGISTER 5 AND */ 00162000
*              /* INSERT CONTROL INFORMATION IN FRONT OF AREA        */ 00163000
*              /*                                                    */ 00164000
*              /******************************************************/ 00165000
*                                                                  0232 00166000
*              RESPECIFY (REG5) RSTD;                              0232 00167000
*              REG5 = TEMPPTR + 8;                                 0233 00168000
         L     @08,TEMPPTR                                         0233 00169000
         LA    REG5,8                                              0233 00170000
         ALR   REG5,@08                                            0233 00171000
*              AUTOID = TEMPID;                                    0234 00172000
         MVC   AUTOID(4,@08),TEMPID                                0234 00173000
*              AUTOSIZE = TEMPSIZE;                                0235 00174000
         L     @15,TEMPSIZE                                        0235 00175000
         ST    @15,AUTOSIZE(,@08)                                  0235 00176000
*            END;                                                  0236 00177000
*          ELSE                                                    0237 00178000
*                                                                  0237 00179000
*            /********************************************************/ 00180000
*            /*                                                      */ 00181000
*            /* MODULE ID IS CONTAINED IN AUTOMATIC STORAGE TABLE SO */ 00182000
*            /* USE THIS TABLE FOR AUTOMATIC STORAGE REQUEST         */ 00183000
*            /* ALLOCATION                                           */ 00184000
*            /*                                                      */ 00185000
*            /********************************************************/ 00186000
*                                                                  0237 00187000
*            DO;                                                   0237 00188000
         B     @RC00228                                            0237 00189000
@RF00228 DS    0H                                                  0238 00190000
*              I = I -1;                                           0238 00191000
*                                                                  0238 00192000
         BCTR  I,0                                                 0238 00193000
*              /******************************************************/ 00194000
*              /*                                                    */ 00195000
*              /* CHECK IF STATUS IS ZERO, INDICATING THAT THE FROZEN*/ 00196000
*              /* AREA IS NOT BEING USED                             */ 00197000
*              /*                                                    */ 00198000
*              /******************************************************/ 00199000
*                                                                  0239 00200000
*              IF STATUS(I) = 0                                    0239 00201000
*                THEN                                              0239 00202000
*                                                                  0239 00203000
         LR    @08,I                                               0239 00204000
         MH    @08,@CH00032                                        0239 00205000
         L     @07,GDTSAH(,GDTPR)                                  0239 00206000
         L     @07,AUTOPTR(,@07)                                   0239 00207000
         LA    @01,0(@08,@07)                                      0239 00208000
         AL    @01,@CF00597                                        0239 00209000
         LH    @15,STATUS-4(,@01)                                  0239 00210000
         LTR   @15,@15                                             0239 00211000
         BNZ   @RF00239                                            0239 00212000
*                  /**************************************************/ 00213000
*                  /*                                                */ 00214000
*                  /* INSERT ADDRESS OF PREALLOCATED FROZEN          */ 00215000
*                  /* AUTOMATIC STORAGE INTO REGISTER 5              */ 00216000
*                  /*                                                */ 00217000
*                  /**************************************************/ 00218000
*                                                                  0240 00219000
*                  REG5 = PTR1(I);                                 0240 00220000
         AL    @07,@CF00598                                        0240 00221000
         L     REG5,PTR1-8(@08,@07)                                0240 00222000
*                ELSE                                              0241 00223000
*                  DO;                                             0241 00224000
*                                                                  0241 00225000
         B     @RC00239                                            0241 00226000
@RF00239 DS    0H                                                  0242 00227000
*                    /************************************************/ 00228000
*                    /*                                              */ 00229000
*                    /* CALL GETCORE ROUTINE TO ALLOCATE STORAGE + 8 */ 00230000
*                    /* BYTES FOR CONTROL INFORMATION                */ 00231000
*                    /*                                              */ 00232000
*                    /************************************************/ 00233000
*                                                                  0242 00234000
*                    TEMPSIZE = PSIZE + 8;                         0242 00235000
         LA    @08,8                                               0242 00236000
         AL    @08,PSIZE(,SIZEPR)                                  0242 00237000
         ST    @08,TEMPSIZE                                        0242 00238000
*                    CALL GETCORE(TEMPSIZE,TEMPPTR);               0243 00239000
*                                                                  0243 00240000
         LA    @08,TEMPSIZE                                        0243 00241000
         ST    @08,@AL00001                                        0243 00242000
         LA    @08,TEMPPTR                                         0243 00243000
         ST    @08,@AL00001+4                                      0243 00244000
         LA    @01,@AL00001                                        0243 00245000
         BAL   @14,GETCORE                                         0243 00246000
*                    /************************************************/ 00247000
*                    /*                                              */ 00248000
*                    /* STORE ADDRESS OF ACQUIRED CORE INTO REGISTER */ 00249000
*                    /* 5 (SO WON'T BE DESTROYED BY ANY CALLS)       */ 00250000
*                    /* AND INSERT CONTROL INFORMATION IN FRONT OF   */ 00251000
*                    /* AREA                                         */ 00252000
*                    /*                                              */ 00253000
*                    /************************************************/ 00254000
*                                                                  0244 00255000
*                    REG5 = TEMPPTR + 8;                           0244 00256000
         L     @08,TEMPPTR                                         0244 00257000
         LA    REG5,8                                              0244 00258000
         ALR   REG5,@08                                            0244 00259000
*                    AUTOID = IDENT;                               0245 00260000
         MVC   AUTOID(4,@08),IDENT                                 0245 00261000
*                    AUTOSIZE = TEMPSIZE;                          0246 00262000
         L     @07,TEMPSIZE                                        0246 00263000
         ST    @07,AUTOSIZE(,@08)                                  0246 00264000
*                  END;                                            0247 00265000
*                                                                  0247 00266000
*              /******************************************************/ 00267000
*              /*                                                    */ 00268000
*              /* INCREMENT STATUS BY ONE                            */ 00269000
*              /*                                                    */ 00270000
*              /******************************************************/ 00271000
*                                                                  0248 00272000
*              STATUS(I) = STATUS(I) + 1;                          0248 00273000
@RC00239 LR    @08,I                                               0248 00274000
         MH    @08,@CH00032                                        0248 00275000
         L     @07,GDTSAH(,GDTPR)                                  0248 00276000
         L     @07,AUTOPTR(,@07)                                   0248 00277000
         LA    @15,1                                               0248 00278000
         LA    @14,0(@08,@07)                                      0248 00279000
         AL    @14,@CF00597                                        0248 00280000
         AH    @15,STATUS-4(,@14)                                  0248 00281000
         AL    @07,@CF00597                                        0248 00282000
         STH   @15,STATUS-4(@08,@07)                               0248 00283000
*            END;                                                  0249 00284000
*                                                                  0249 00285000
*        /************************************************************/ 00286000
*        /*                                                          */ 00287000
*        /* UPDATE INTER MODULE TRACE TABLE WITH USER'S MODULE ID    */ 00288000
*        /*                                                          */ 00289000
*        /************************************************************/ 00290000
*                                                                  0250 00291000
*        OLDERID1 = NEWERID1;                                      0250 00292000
@RC00228 L     @08,GDTTR1(,GDTPR)                                  0250 00293000
         MVC   @TS00001(95),NEWERID1(@08)                          0250 00294000
         MVC   OLDERID1(95,@08),@TS00001                           0250 00295000
*        NEWID1 = TEMPID;                                          0251 00296000
*                                                                  0251 00297000
         MVC   NEWID1(4,@08),TEMPID                                0251 00298000
*        /************************************************************/ 00299000
*        /*                                                          */ 00300000
*        /* RESTORE THE RETURN ADDRESS INTO REGISTER 14              */ 00301000
*        /*                                                          */ 00302000
*        /************************************************************/ 00303000
*                                                                  0252 00304000
*        RESPECIFY (REG14) RSTD;                                   0252 00305000
*        REG14 = RTNADDR;                                          0253 00306000
*                                                                  0253 00307000
         LR    REG14,RTNADDR                                       0253 00308000
*        /************************************************************/ 00309000
*        /*                                                          */ 00310000
*        /* RESTORE SAVEAREA POINTER AND STORE USER'S MODULE ID INTO */ 00311000
*        /* THE FIRST 4 BYTES OF THE SAVEAREA THAT HE SAVED IN       */ 00312000
*        /*                                                          */ 00313000
*        /************************************************************/ 00314000
*                                                                  0254 00315000
*        RESPECIFY (REG13) RSTD;                                   0254 00316000
*        GEN(L     REG13,4(REG13));                                0255 00317000
         L     REG13,4(REG13)                                           00318000
*        GEN(MVC   0(4,REG13),TEMPID);                             0256 00319000
         MVC   0(4,REG13),TEMPID                                        00320000
*        RESPECIFY (REG13) UNRSTD;                                 0257 00321000
*                                                                  0257 00322000
*        /************************************************************/ 00323000
*        /*                                                          */ 00324000
*        /* THE PROL ROUTINE AUTOMATIC STORAGE AREA DOESN'T NEED     */ 00325000
*        /* TO BE RELEASED AS IT IS USED AGAIN--NOW LOAD THE ADDRESS */ 00326000
*        /* OF THE GOTTEN CORE INTO REGISTER 1, RESTORE REGISTERS    */ 00327000
*        /* 2 THROUGH 12 FROM THE SAVEAREA SAVED IN BY THIS ROUTINE  */ 00328000
*        /* (PROLSAVE) AND BRANCH ON REGISTER 14 (RETURN TO THE      */ 00329000
*        /* CALLER)                                                  */ 00330000
*        /*                                                          */ 00331000
*        /************************************************************/ 00332000
*                                                                  0258 00333000
*        RESPECIFY (REG1) RSTD;                                    0258 00334000
*        REG1 = REG5;                                              0259 00335000
         LR    REG1,REG5                                           0259 00336000
*        RESPECIFY(REG5) UNRSTD;                                   0260 00337000
*        GEN(LM    REG2,REG12,PROLSAV);                            0261 00338000
         LM    REG2,REG12,PROLSAV                                       00339000
*        GEN(BR    REG14);                                         0262 00340000
         BR    REG14                                                    00341000
*        RESPECIFY (REG1,REG14) UNRSTD;                            0263 00342000
*        /************************************************************/ 00343000
*        /*                                                          */ 00344000
*        /* UEPIL ROUTINE ENTRY POINT                                */ 00345000
*        /*                                                          */ 00346000
*        /************************************************************/ 00347000
*                                                                  0264 00348000
*ICKSAEP:  ENTRY(GDTTBLX,MODIDX,RCODEX);                           0264 00349000
*                                                                  0264 00350000
@EC00264 DS    0H                                                  0265 00351000
*DMSSAEP1:                                                         0265 00352000
*                                                                  0265 00353000
*        /************************************************************/ 00354000
*        /*                                                          */ 00355000
*        /* PROLOG CODE FOR THE UEPIL ROUTINE                        */ 00356000
*        /*                                                          */ 00357000
*        /************************************************************/ 00358000
*                                                                  0265 00359000
*        GEN;                                                      0265 00360000
*                                                                  0265 00361000
DMSSAEP1 DS    0H                                                  0265 00362000
        BALR  REG12,0                                                   00363000
PSTART2 SH    REG12,8(REG12)          CODE ADDRESSABILITY               00364000
        B     *+6                                                       00365000
        DC    AL2(PSTART2-PSTART1)                                      00366000
        L     REG11,0(REG1)           GDTTBL ADDRESS                    00367000
        L     REG11,GDTSPR(REG11)     FROZEN AUTOMATIC STORAGE ADDR     00368000
        USING @DATD,REG11             DATA ADDRESSABILITY               00369000
        ST    REG13,@SA00001+4                                          00370000
        ST    REG11,8(REG13)                                            00371000
        LR    REG13,REG11                                               00372000
*        /************************************************************/ 00373000
*        /*                                                          */ 00374000
*        /* SET UP BASE FOR GDTTBL, MODID AND RCODE                  */ 00375000
*        /*                                                          */ 00376000
*        /************************************************************/ 00377000
*                                                                  0266 00378000
*        RESPECIFY (REG1) RSTD;                                    0266 00379000
*        GEN(L     GDTPR,0(REG1));                                 0267 00380000
         L     GDTPR,0(REG1)                                            00381000
*        GEN(L     MODIDPR,4(REG1));                               0268 00382000
         L     MODIDPR,4(REG1)                                          00383000
*        GEN(L     RCODEPR,8(REG1));                               0269 00384000
*                                                                  0269 00385000
*                                                                  0269 00386000
         L     RCODEPR,8(REG1)                                          00387000
*                                                                  0270 00388000
*        /************************************************************/ 00389000
*        /*                                                          */ 00390000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 00391000
*        /*                                                          */ 00392000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 00393000
*        /*              TO THIS ROUTINE                             */ 00394000
*        /*                                                          */ 00395000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 00396000
*        /*               ADDRESS LIST                               */ 00397000
*        /*                                                          */ 00398000
*        /************************************************************/ 00399000
*                                                                  0270 00400000
*        GEN;                                                      0270 00401000
        ST    1,LISTPTR                                                 00402000
        ST    1,LISTSCAN                                                00403000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0271 00404000
         LA    LISTLN,1                                            0271 00405000
@DL00271 L     @10,LISTSCAN                                        0271 00406000
         TM    LISTTEST(@10),B'10000000'                           0271 00407000
         BNZ   @DC00271                                            0271 00408000
*          LISTSCAN = LISTSCAN + 4;                                0272 00409000
         AL    @10,@CF00036                                        0272 00410000
         ST    @10,LISTSCAN                                        0272 00411000
*        END;                                                      0273 00412000
*                                                                  0273 00413000
         AL    LISTLN,@CF00157                                     0273 00414000
         C     LISTLN,@CF00559                                     0273 00415000
         BNH   @DL00271                                            0273 00416000
@DC00271 DS    0H                                                  0274 00417000
*        RESPECIFY (REG1) UNRSTD;                                  0274 00418000
*                                                                  0274 00419000
*        /************************************************************/ 00420000
*        /*                                                          */ 00421000
*        /* GET ADDRESS OF CALLER'S AUTOMATIC STORAGE (TEMPPTR),     */ 00422000
*        /* GET ADDRESS OF SAVEAREA THAT THE CALLER SAVED REGISTERS  */ 00423000
*        /* IN (RTNSAVE), AND ZERO THIS SAVEAREA FORWARD CHAIN       */ 00424000
*        /* POINTER                                                  */ 00425000
*        /*                                                          */ 00426000
*        /************************************************************/ 00427000
*                                                                  0275 00428000
*        RESPECIFY (REG13) RSTD;                                   0275 00429000
*        GEN(L     REG13,4(REG13));                                0276 00430000
         L     REG13,4(REG13)                                           00431000
*        TEMPPTR = REG13;                                          0277 00432000
         ST    REG13,TEMPPTR                                       0277 00433000
*        GEN(L     REG13,4(REG13));                                0278 00434000
         L     REG13,4(REG13)                                           00435000
*        RTNSAVE = REG13;                                          0279 00436000
         LR    RTNSAVE,REG13                                       0279 00437000
*        SAVEFWD = NULLPTR;                                        0280 00438000
         SLR   @08,@08                                             0280 00439000
         ST    @08,SAVEFWD+8(,SAVEPTR)                             0280 00440000
*        REG13 = TEMPPTR;                                          0281 00441000
         L     REG13,TEMPPTR                                       0281 00442000
*        GEN(L     REG13,8(REG13));                                0282 00443000
         L     REG13,8(REG13)                                           00444000
*        RESPECIFY (REG13) UNRSTD;                                 0283 00445000
*                                                                  0283 00446000
*        /************************************************************/ 00447000
*        /*                                                          */ 00448000
*        /* CALCULATE ADDRESS OF AREA TO BE FREED--USER'S AUTOMATIC  */ 00449000
*        /* STORAGE AREA POINTER MINUS 8 (CONTROL INFORMATION)       */ 00450000
*        /*                                                          */ 00451000
*        /************************************************************/ 00452000
*                                                                  0284 00453000
*        TEMPPTR = TEMPPTR - 8;                                    0284 00454000
*                                                                  0284 00455000
         L     @08,TEMPPTR                                         0284 00456000
         SL    @08,@CF00153                                        0284 00457000
         ST    @08,TEMPPTR                                         0284 00458000
*        /************************************************************/ 00459000
*        /*                                                          */ 00460000
*        /* CHECK IF USER SPECIFIED A RETURN CODE                    */ 00461000
*        /*                                                          */ 00462000
*        /************************************************************/ 00463000
*                                                                  0285 00464000
*        IF LISTLN = 3                                             0285 00465000
*          THEN                                                    0285 00466000
         C     LISTLN,@CF00128                                     0285 00467000
         BNE   @RF00285                                            0285 00468000
*            SETRC = RCODE;                                        0286 00469000
         LH    SETRC,RCODE(,RCODEPR)                               0286 00470000
*          ELSE                                                    0287 00471000
*            SETRC = 0;                                            0287 00472000
*                                                                  0287 00473000
         B     @RC00285                                            0287 00474000
@RF00285 SLR   SETRC,SETRC                                         0287 00475000
*        /************************************************************/ 00476000
*        /*                                                          */ 00477000
*        /* DETERMINE IF MODULE ID IS CONTAINED IN FROZEN AUTOMATIC  */ 00478000
*        /* STORAGE TABLE                                            */ 00479000
*        /*                                                          */ 00480000
*        /************************************************************/ 00481000
*                                                                  0288 00482000
*        DOCNTRL = ON;                                             0288 00483000
@RC00285 OI    DOCNTRL,B'10000000'                                 0288 00484000
*EPDO:   DO I=1 TO DIM(AUTOARAY) WHILE(DOCNTRL = ON);              0289 00485000
*                                                                  0289 00486000
EPDO     LA    I,1                                                 0289 00487000
@DL00289 TM    DOCNTRL,B'10000000'                                 0289 00488000
         BNO   @DC00289                                            0289 00489000
*          /**********************************************************/ 00490000
*          /*                                                        */ 00491000
*          /* DETERMINE IF MODULE ID MATCHES ID IN FROZEN AUTOMATIC  */ 00492000
*          /* STORAGE TABLE                                          */ 00493000
*          /*                                                        */ 00494000
*          /**********************************************************/ 00495000
*                                                                  0290 00496000
*          IF AREAID(I) = MODID                                    0290 00497000
*            THEN                                                  0290 00498000
         LR    @08,I                                               0290 00499000
         MH    @08,@CH00032                                        0290 00500000
         L     @05,GDTSAH(,GDTPR)                                  0290 00501000
         L     @05,AUTOPTR(,@05)                                   0290 00502000
         ALR   @05,@08                                             0290 00503000
         AL    @05,@CF00595                                        0290 00504000
         CLC   AREAID(4,@05),MODID(MODIDPR)                        0290 00505000
         BNE   @RF00290                                            0290 00506000
*              DOCNTRL = OFF;                                      0291 00507000
         NI    DOCNTRL,B'01111111'                                 0291 00508000
*        END EPDO;                                                 0292 00509000
*                                                                  0292 00510000
@RF00290 AL    I,@CF00157                                          0292 00511000
         C     I,@CF00111                                          0292 00512000
         BNH   @DL00289                                            0292 00513000
@DC00289 DS    0H                                                  0293 00514000
*        /************************************************************/ 00515000
*        /*                                                          */ 00516000
*        /* RELEASE USER'S AUTOMATIC STORAGE AREA                    */ 00517000
*        /*                                                          */ 00518000
*        /************************************************************/ 00519000
*                                                                  0293 00520000
*        IF DOCNTRL = ON                                           0293 00521000
*          THEN                                                    0293 00522000
*                                                                  0293 00523000
         TM    DOCNTRL,B'10000000'                                 0293 00524000
         BNO   @RF00293                                            0293 00525000
*            /********************************************************/ 00526000
*            /*                                                      */ 00527000
*            /* MODULE ID IS NOT CONTAINED IN FROZEN AUTOMATIC       */ 00528000
*            /* STORAGE TABLE                                        */ 00529000
*            /*                                                      */ 00530000
*            /********************************************************/ 00531000
*                                                                  0294 00532000
*             DO;                                                  0294 00533000
*              RESPECIFY (REG0,REG1) RSTD;                         0295 00534000
*              REG0 = AUTOSIZE;                                    0296 00535000
         L     @08,TEMPPTR                                         0296 00536000
         L     REG0,AUTOSIZE(,@08)                                 0296 00537000
*              REG1 = TEMPPTR;                                     0297 00538000
         LR    REG1,@08                                            0297 00539000
*LFREM1:       GEN(FREEMAIN R,LV=(REG0),A=(REG1));                 0298 00540000
LFREM1   FREEMAIN R,LV=(REG0),A=(REG1)                                  00541000
*              RESPECIFY (REG0,REG1) UNRSTD;                       0299 00542000
*            END;                                                  0300 00543000
*          ELSE                                                    0301 00544000
*                                                                  0301 00545000
*            /********************************************************/ 00546000
*            /*                                                      */ 00547000
*            /* MODULE ID IS CONTAINED IN FROZEN AUTOMATIC STORAGE   */ 00548000
*            /* TABLE SO USE THIS TABLE FOR RELEASE REQUEST          */ 00549000
*            /*                                                      */ 00550000
*            /********************************************************/ 00551000
*                                                                  0301 00552000
*            DO;                                                   0301 00553000
         B     @RC00293                                            0301 00554000
@RF00293 DS    0H                                                  0302 00555000
*              I = I - 1;                                          0302 00556000
*                                                                  0302 00557000
         BCTR  I,0                                                 0302 00558000
*              /******************************************************/ 00559000
*              /*                                                    */ 00560000
*              /* CHECK IF STATUS IS GREATER THAT ONE, INDICATING    */ 00561000
*              /* THAT IT IS NOT THE FROZEN AREA TO BE RELEASED      */ 00562000
*              /*                                                    */ 00563000
*              /******************************************************/ 00564000
*                                                                  0303 00565000
*              IF STATUS(I) > 1                                    0303 00566000
*                THEN                                              0303 00567000
*                                                                  0303 00568000
         LR    @08,I                                               0303 00569000
         MH    @08,@CH00032                                        0303 00570000
         L     @05,GDTSAH(,GDTPR)                                  0303 00571000
         L     @05,AUTOPTR(,@05)                                   0303 00572000
         AL    @05,@CF00597                                        0303 00573000
         LH    @08,STATUS-4(@08,@05)                               0303 00574000
         C     @08,@CF00157                                        0303 00575000
         BNH   @RF00303                                            0303 00576000
*                  /**************************************************/ 00577000
*                  /*                                                */ 00578000
*                  /* IS NOT A FROZEN AREA SO FREE IT                */ 00579000
*                  /*                                                */ 00580000
*                  /**************************************************/ 00581000
*                                                                  0304 00582000
*                  DO;                                             0304 00583000
*                    RESPECIFY (REG0,REG1) RSTD;                   0305 00584000
*                    REG0 = AUTOSIZE;                              0306 00585000
         L     @08,TEMPPTR                                         0306 00586000
         L     REG0,AUTOSIZE(,@08)                                 0306 00587000
*                    REG1 = TEMPPTR;                               0307 00588000
         LR    REG1,@08                                            0307 00589000
*LFREM2:             GEN(FREEMAIN R,LV=(REG0),A=(REG1));           0308 00590000
LFREM2   FREEMAIN R,LV=(REG0),A=(REG1)                                  00591000
*                    RESPECIFY (REG0,REG1) UNRSTD;                 0309 00592000
*                  END;                                            0310 00593000
*                                                                  0310 00594000
*              /******************************************************/ 00595000
*              /*                                                    */ 00596000
*              /* DECREMENT STATUS BY 1                              */ 00597000
*              /*                                                    */ 00598000
*              /******************************************************/ 00599000
*                                                                  0311 00600000
*              STATUS(I) = STATUS(I) - 1;                          0311 00601000
@RF00303 LR    @08,I                                               0311 00602000
         MH    @08,@CH00032                                        0311 00603000
         L     @05,GDTSAH(,GDTPR)                                  0311 00604000
         L     @05,AUTOPTR(,@05)                                   0311 00605000
         LA    @01,0(@08,@05)                                      0311 00606000
         AL    @01,@CF00597                                        0311 00607000
         LH    @15,STATUS-4(,@01)                                  0311 00608000
         BCTR  @15,0                                               0311 00609000
         AL    @05,@CF00597                                        0311 00610000
         STH   @15,STATUS-4(@08,@05)                               0311 00611000
*            END;                                                  0312 00612000
*                                                                  0312 00613000
*        /************************************************************/ 00614000
*        /*                                                          */ 00615000
*        /*  IF MODULE IS  ONE OF THE CSECTS OF THE MAIN LOAD        */ 00616000
*        /*  MODULE ICKDMS (CAN TELL FROM THE MODID) THAT RECIEVES   */ 00617000
*        /*  CONTROL MANY TIMES DURING AN EXECUTION THEN DONT LOOK   */ 00618000
*        /*  FOR IT IN LLBLK BECAUSE ITS NOT THERE SAVE TIME         */ 00619000
*        /*  SEARCHING BLOCKS.DB01 IS IN LIST BECAUSE IT IS          */ 00620000
*        /*  LOADED AND SHOULD NOT BE DELETED TILL DMS               */ 00621000
*        /*  IS COMPLETED (IT CONTAINS UDUMP ROUTINE)                */ 00622000
*        /*                                                          */ 00623000
*        /************************************************************/ 00624000
*                                                                  0313 00625000
*        IF MODID ^= 'SA02' & MODID ^= 'DB01' & MODID ^= 'SA03' &  0313 00626000
*           MODID ^= 'EX01' & MODID ^= 'TP01' & MODID ^= 'IO01'    0313 00627000
*                                                                  0313 00628000
*          THEN                                                    0313 00629000
@RC00293 CLC   MODID(4,MODIDPR),@CC00566                           0313 00630000
         BE    @RF00313                                            0313 00631000
         CLC   MODID(4,MODIDPR),@CC00567                           0313 00632000
         BE    @RF00313                                            0313 00633000
         CLC   MODID(4,MODIDPR),@CC00493                           0313 00634000
         BE    @RF00313                                            0313 00635000
         CLC   MODID(4,MODIDPR),@CC00568                           0313 00636000
         BE    @RF00313                                            0313 00637000
         CLC   MODID(4,MODIDPR),@CC00569                           0313 00638000
         BE    @RF00313                                            0313 00639000
         CLC   MODID(4,MODIDPR),@CC00570                           0313 00640000
         BE    @RF00313                                            0313 00641000
*            DO;                                                   0314 00642000
*                                                                  0314 00643000
*              /******************************************************/ 00644000
*              /*                                                    */ 00645000
*              /*  BUILD MODULE NAME FOR SEARCH LLBLK RTN            */ 00646000
*              /*                                                    */ 00647000
*              /******************************************************/ 00648000
*                                                                  0315 00649000
*              TEMPEPN(1:8) = 'ICK     ';                          0315 00650000
         MVC   TEMPEPN(8),@CC00571                                 0315 00651000
*              TEMPEPN(4:7) = MODID(1:4);                          0316 00652000
*                                                                  0316 00653000
         MVC   TEMPEPN+3(4),MODID(MODIDPR)                         0316 00654000
*              /******************************************************/ 00655000
*              /*                                                    */ 00656000
*              /*  SEARCH LLBLK RTN WILL SEARCH LLBLK(S)             */ 00657000
*              /*  FOR MATCH OF NAME AND REDUCE USE CTR              */ 00658000
*              /*  BY ONE                                            */ 00659000
*              /*                                                    */ 00660000
*              /******************************************************/ 00661000
*                                                                  0317 00662000
*              IX = 0;                                             0317 00663000
         SLR   IX,IX                                               0317 00664000
*              LOOPCTL = OFF;                                      0318 00665000
         NI    LOOPCTL,B'01111111'                                 0318 00666000
*              NAMEFND = OFF;                                      0319 00667000
*                                                                  0319 00668000
         NI    NAMEFND,B'01111111'                                 0319 00669000
*              DO WHILE LOOPCTL = OFF;                             0320 00670000
         B     @DE00320                                            0320 00671000
@DL00320 DS    0H                                                  0321 00672000
*                IF IX = 0                                         0321 00673000
*                                                                  0321 00674000
*                /****************************************************/ 00675000
*                /*                                                  */ 00676000
*                /*    FIRST TIME USE POINTER IN SYSTEM              */ 00677000
*                /*    HIST SAVE AREA TO LOAD LIST BLOCK             */ 00678000
*                /*                                                  */ 00679000
*                /****************************************************/ 00680000
*                                                                  0321 00681000
*                  THEN                                            0321 00682000
         LTR   IX,IX                                               0321 00683000
         BNZ   @RF00321                                            0321 00684000
*                    P = LLBLKPTR;                                 0322 00685000
         L     @06,GDTSAH(,GDTPR)                                  0322 00686000
         L     P,LLBLKPTR(,@06)                                    0322 00687000
*                  ELSE;                                           0323 00688000
@RF00321 DS    0H                                                  0324 00689000
*                DO IX = 1 TO LLSLTCNT BY 1 WHILE LOOPCTL = OFF;   0324 00690000
*                                                                  0324 00691000
*                                                                  0324 00692000
         LA    IX,1                                                0324 00693000
@DL00324 TM    LOOPCTL,B'10000000'                                 0324 00694000
         BNZ   @DC00324                                            0324 00695000
*                /****************************************************/ 00696000
*                /*                                                  */ 00697000
*                /*    LOOK FOR MATCH OF NAME IN LLBLK               */ 00698000
*                /*    WHEN FOUND REDUCE USE CTR BY ONE              */ 00699000
*                /*  UNLESS IT IS ZERO.THIS SHOULD NOT BE.           */ 00700000
*                /*                                                  */ 00701000
*                /****************************************************/ 00702000
*                                                                  0325 00703000
*                  IF TEMPEPN = LLNAME(IX)                         0325 00704000
*                    THEN                                          0325 00705000
         LR    @08,IX                                              0325 00706000
         SLA   @08,4                                               0325 00707000
         ST    @08,@TF00001                                        0325 00708000
         ALR   @08,P                                               0325 00709000
         AL    @08,@CF00597                                        0325 00710000
         CLC   TEMPEPN(8),LLNAME-8(@08)                            0325 00711000
         BNE   @RF00325                                            0325 00712000
*                      DO;                                         0326 00713000
*                        LOOPCTL = ON;                             0327 00714000
         OI    LOOPCTL,B'10000000'                                 0327 00715000
*                        NAMEFND = ON;                             0328 00716000
         OI    NAMEFND,B'10000000'                                 0328 00717000
*                          IF LLUSECTR(IX) = 0                     0329 00718000
*                            THEN                                  0329 00719000
         L     @08,@TF00001                                        0329 00720000
         SLR   @06,@06                                             0329 00721000
         IC    @06,LLUSECTR-16(@08,P)                              0329 00722000
         C     @06,@CF00086                                        0329 00723000
         BNE   @RF00329                                            0329 00724000
*                              NAMEFND = OFF;                      0330 00725000
         NI    NAMEFND,B'01111111'                                 0330 00726000
*                            ELSE                                  0331 00727000
*                              LLUSECTR(IX) = LLUSECTR(IX)-1;      0331 00728000
*                                                                  0331 00729000
         B     @RC00329                                            0331 00730000
@RF00329 LR    @08,IX                                              0331 00731000
         SLA   @08,4                                               0331 00732000
         SLR   @06,@06                                             0331 00733000
         IC    @06,LLUSECTR-16(@08,P)                              0331 00734000
         BCTR  @06,0                                               0331 00735000
         STC   @06,LLUSECTR-16(@08,P)                              0331 00736000
*                      END;                                        0332 00737000
*                    ELSE;                                         0333 00738000
@RF00325 DS    0H                                                  0334 00739000
*                END;                                              0334 00740000
*                                                                  0334 00741000
@RC00325 AL    IX,@CF00157                                         0334 00742000
         C     IX,@CF00278                                         0334 00743000
         BNH   @DL00324                                            0334 00744000
@DC00324 DS    0H                                                  0335 00745000
*                IF LLNXTBLK = 0                                   0335 00746000
*                                                                  0335 00747000
*                /****************************************************/ 00748000
*                /*                                                  */ 00749000
*                /*  WHEN ZERO THIS IS LAST LLBLK                    */ 00750000
*                /*                                                  */ 00751000
*                /****************************************************/ 00752000
*                                                                  0335 00753000
*                  THEN                                            0335 00754000
         L     @08,LLNXTBLK(,P)                                    0335 00755000
         LTR   @08,@08                                             0335 00756000
         BNZ   @RF00335                                            0335 00757000
*                    LOOPCTL = ON;                                 0336 00758000
         OI    LOOPCTL,B'10000000'                                 0336 00759000
*                  ELSE                                            0337 00760000
*                    P = LLNXTBLK;                                 0337 00761000
         B     @RC00335                                            0337 00762000
@RF00335 L     P,LLNXTBLK(,P)                                      0337 00763000
*              END;                                                0338 00764000
@RC00335 DS    0H                                                  0338 00765000
@DE00320 TM    LOOPCTL,B'10000000'                                 0338 00766000
         BZ    @DL00320                                            0338 00767000
*            END;                                                  0339 00768000
*                                                                  0339 00769000
*        /************************************************************/ 00770000
*        /*                                                          */ 00771000
*        /* RESTORE SAVE AREA POINTER TO SAVE AREA USER SAVED IN,    */ 00772000
*        /* UPDATE INTER MODULE TRACE TABLE WITH MODULE ID OF MODULE */ 00773000
*        /* TO BE RETURNED TO (FOUND IN THE FIRST 4 BYTES OF THE SAVE*/ 00774000
*        /* AREA SAVED IN BY THE MODULE TO BE RETURNED TO)           */ 00775000
*        /*                                                          */ 00776000
*        /************************************************************/ 00777000
*                                                                  0340 00778000
*        OLDERID1 = NEWERID1;                                      0340 00779000
@RF00313 L     @06,GDTTR1(,GDTPR)                                  0340 00780000
         MVC   @TS00001(95),NEWERID1(@06)                          0340 00781000
         MVC   OLDERID1(95,@06),@TS00001                           0340 00782000
*        RESPECIFY (REG13) RSTD;                                   0341 00783000
*        REG13 = RTNSAVE;                                          0342 00784000
         LR    REG13,RTNSAVE                                       0342 00785000
*        GEN(L     REG13,4(REG13));                                0343 00786000
         L     REG13,4(REG13)                                           00787000
*        GEN(MVC   TEMPID(4),0(REG13));                            0344 00788000
         MVC   TEMPID(4),0(REG13)                                       00789000
*        GEN(L     REG13,8(REG13));                                0345 00790000
         L     REG13,8(REG13)                                           00791000
*        NEWID1 = TEMPID;                                          0346 00792000
*                                                                  0346 00793000
         L     @10,GDTTR1(,GDTPR)                                  0346 00794000
         MVC   NEWID1(4,@10),TEMPID                                0346 00795000
*        /************************************************************/ 00796000
*        /*                                                          */ 00797000
*        /* THE UEPIL ROUTINE AUTOMATIC STORAGE DOESN'T NEED TO BE   */ 00798000
*        /* RELEASED AS IT IS USED OVER AGAIN--PLACE USER RETURN CODE*/ 00799000
*        /* IN REGISTER 15, RESTORE REGISTERS FOR MODULE TO BE       */ 00800000
*        /* RETURNED TO (EXCLUDING REGISTER 15), AND BRANCH          */ 00801000
*        /* ON REGISTER 14 (RETURN TO THE MODULE THAT CALLED THE USER*/ 00802000
*        /* OF THE UEPIL ROUTINE)                                    */ 00803000
*        /*                                                          */ 00804000
*        /************************************************************/ 00805000
*                                                                  0347 00806000
*        RESPECIFY (REG14,REG15) RSTD;                             0347 00807000
*        REG15 = SETRC;                                            0348 00808000
         LR    REG15,SETRC                                         0348 00809000
*        GEN(L     REG14,12(REG13));                               0349 00810000
         L     REG14,12(REG13)                                          00811000
*        GEN(LM    REG0,REG12,20(REG13));                          0350 00812000
         LM    REG0,REG12,20(REG13)                                     00813000
*        GEN(BR    REG14);                                         0351 00814000
         BR    REG14                                                    00815000
*        RESPECIFY (REG13,REG14,REG15) UNRSTD;                     0352 00816000
*        /************************************************************/ 00817000
*        /*                                                          */ 00818000
*        /*  PROCEDURE NAME - GETCORE                                */ 00819000
*        /*                                                          */ 00820000
*        /*  FUNCTION - THIS PROCEDURE GETS THE REQUESTED CORE AND   */ 00821000
*        /*             PASSES BACK THE ADDRESS OF THIS CORE         */ 00822000
*        /*                                                          */ 00823000
*        /*  INPUT - PARAMETER LIST CONTAINING THE ADDRESS OF THE    */ 00824000
*        /*          SIZE ARGUMENT AND THE ADDRESS OF A VARIABLE TO  */ 00825000
*        /*          CONTAIN THE ADDRESS OF THE ACQUIRED CORE        */ 00826000
*        /*                                                          */ 00827000
*        /*  OUTPUT - THE ADDRESS OF THE ACQUIRED CORE               */ 00828000
*        /*                                                          */ 00829000
*        /************************************************************/ 00830000
*                                                                  0353 00831000
*GETCORE:  PROCEDURE(ZSIZE,ZPTR);                                  0353 00832000
*                                                                  0353 00833000
         B     @PB00002                                            0353 00834000
GETCORE  STM   @14,@08,@SA00002                                    0353 00835000
         STM   @10,@12,@SA00002+44                                 0353 00836000
         MVC   @PC00002(8),0(@01)                                  0353 00837000
*        DCL ZSIZE FIXED(31);          /* SIZE OF REQUESTED AREA     */ 00838000
*                                                                  0354 00839000
*        DCL ZPTR PTR(31);             /* VARIABLE TO CONTAIN THE    */ 00840000
*                                      /* ACQUIRED CORE ADDRESS      */ 00841000
*                                                                  0356 00842000
*        /* GETMAIN MACRO LIST                                       */ 00843000
*        DCL 1 GETLIST CHAR(10) BDY(WORD),                         0356 00844000
*              2 GETSZ FIXED(31),      /* GETMAIN SIZE               */ 00845000
*              2 GETPT PTR(31),        /* ADDRESS OF AREA WHERE ADDR */ 00846000
*                                      /* OF GOTTEN CORE IS TO BE PUT*/ 00847000
*              2 GETFLG CHAR(2);       /* GETMAIN FLAGS              */ 00848000
*                                                                  0356 00849000
*        DCL LIST1 GENERATED LABEL;    /* GETMAIN MACRO LIST LABEL   */ 00850000
*                                                                  0357 00851000
*        DCL GETGEN CHAR(10) DEFINED(LIST1);                       0358 00852000
*                                      /* GENERATED LIST FORM OF     */ 00853000
*                                      /* GETMAIN MACRO              */ 00854000
*                                                                  0359 00855000
*        /************************************************************/ 00856000
*        /*                                                          */ 00857000
*        /* ISSUE GETMAIN MACRO FOR REQUESTED CORE                   */ 00858000
*        /*                                                          */ 00859000
*        /************************************************************/ 00860000
*                                                                  0359 00861000
*        GETLIST = GETGEN;                                         0359 00862000
         MVC   GETLIST(10),GETGEN                                  0359 00863000
*        GETSZ = ZSIZE;                                            0360 00864000
         L     @10,@PC00002                                        0360 00865000
         L     @10,ZSIZE(,@10)                                     0360 00866000
         ST    @10,GETSZ                                           0360 00867000
*        GETPT = ADDR(ZPTR);                                       0361 00868000
         L     @10,@PC00002+4                                      0361 00869000
         ST    @10,GETPT                                           0361 00870000
*        RESPECIFY (REG1) RSTD;                                    0362 00871000
*        REG1 = ADDR(GETLIST);                                     0363 00872000
         LA    REG1,GETLIST                                        0363 00873000
*LGETM1: GEN(GETMAIN MF=(E,(REG1)));                               0364 00874000
LGETM1   GETMAIN MF=(E,(REG1))                                          00875000
*        RESPECIFY (REG1) UNRSTD;                                  0365 00876000
*                                                                  0365 00877000
*        /************************************************************/ 00878000
*        /*                                                          */ 00879000
*        /* CHECK RETURN CODE FROM CORE REQUEST                      */ 00880000
*        /*                                                          */ 00881000
*        /************************************************************/ 00882000
*                                                                  0366 00883000
*        RESPECIFY (RTNREG) RSTD;                                  0366 00884000
*        IF RTNREG ^= 0                                            0367 00885000
*          THEN                                                    0367 00886000
         LTR   RTNREG,RTNREG                                       0367 00887000
         BZ    @RF00367                                            0367 00888000
*DELMOD:     DO;                                                   0368 00889000
*                                                                  0368 00890000
DELMOD   DS    0H                                                  0369 00891000
*            /********************************************************/ 00892000
*            /*                                                      */ 00893000
*            /*  CORE IS NEEDED AND NOT AVAILABLE                    */ 00894000
*            /*  FREE MODULES NOT IN USE (USE CTR WILL BE            */ 00895000
*            /*  ZERO) THEN TRY ONE MORE GETCORE                     */ 00896000
*            /*                                                      */ 00897000
*            /********************************************************/ 00898000
*                                                                  0369 00899000
*              IX = 0;                                             0369 00900000
         SLR   IX,IX                                               0369 00901000
*              LOOPCTL = OFF;                                      0370 00902000
         NI    LOOPCTL,B'01111111'                                 0370 00903000
*                DO WHILE LOOPCTL = OFF;                           0371 00904000
*                                                                  0371 00905000
         B     @DE00371                                            0371 00906000
@DL00371 DS    0H                                                  0372 00907000
*                  IF IX = 0                                       0372 00908000
*                    THEN                                          0372 00909000
*                                                                  0372 00910000
         LTR   IX,IX                                               0372 00911000
         BNZ   @RF00372                                            0372 00912000
*                      /**********************************************/ 00913000
*                      /*                                            */ 00914000
*                      /*   FIRST TIME USE POINTER IN                */ 00915000
*                      /*   SYSTEM HIST AREA TO LOAD                 */ 00916000
*                      /*   LIST BLOCK                               */ 00917000
*                      /*                                            */ 00918000
*                      /**********************************************/ 00919000
*                                                                  0373 00920000
*                      P = LLBLKPTR;                               0373 00921000
         L     @14,GDTSAH(,GDTPR)                                  0373 00922000
         L     P,LLBLKPTR(,@14)                                    0373 00923000
*                    ELSE;                                         0374 00924000
*                                                                  0374 00925000
@RF00372 DS    0H                                                  0375 00926000
*                  /*****************************************        */ 00927000
*                  /*                                                */ 00928000
*                  /*  SEARCH EACH LOAD LIST BLOCK WHEN              */ 00929000
*                  /*  MODULE NAME IS IN SLOT AND  USE CTR           */ 00930000
*                  /*  IS ZERO THEN DELETE MODULE FROM CORE          */ 00931000
*                  /*                                                */ 00932000
*                  /*****************************************        */ 00933000
*                                                                  0375 00934000
*                  DO IX = 1 TO LLSLTCNT;                          0375 00935000
         LA    IX,1                                                0375 00936000
@DL00375 DS    0H                                                  0376 00937000
*                    IF LLNOMOD(IX) = 0 | LLUSECTR(IX) ^= 0        0376 00938000
*                                                                  0376 00939000
*                      THEN;                                       0376 00940000
         SLR   @14,@14                                             0376 00941000
         LR    @10,IX                                              0376 00942000
         SLA   @10,4                                               0376 00943000
         LR    @08,P                                               0376 00944000
         AL    @08,@CF00598                                        0376 00945000
         C     @14,LLNOMOD-12(@10,@08)                             0376 00946000
         BE    @RT00376                                            0376 00947000
         SLR   @08,@08                                             0376 00948000
         IC    @08,LLUSECTR-16(@10,P)                              0376 00949000
         CR    @14,@08                                             0376 00950000
         BNE   @RT00376                                            0376 00951000
*                      ELSE                                        0378 00952000
*                        DO;                                       0378 00953000
*                          RFY REG0 RSTD;                          0379 00954000
*                          REG0 = ADDR(LLNAME(IX));                0380 00955000
         LR    @14,IX                                              0380 00956000
         SLA   @14,4                                               0380 00957000
         AL    @14,@CF00597                                        0380 00958000
         LA    REG0,LLNAME-8(@14,P)                                0380 00959000
*LDEL1:                    GEN(DELETE  EPLOC=(REG0));              0381 00960000
LDEL1    DELETE  EPLOC=(REG0)                                           00961000
*                          RFY REG0 UNRSTD;                        0382 00962000
*                          LLNOMOD(IX) = 0;                        0383 00963000
         LR    @14,IX                                              0383 00964000
         SLA   @14,4                                               0383 00965000
         SLR   @10,@10                                             0383 00966000
         LR    @08,P                                               0383 00967000
         AL    @08,@CF00598                                        0383 00968000
         ST    @10,LLNOMOD-12(@14,@08)                             0383 00969000
*                          LLNXTSLT(IX) = LLFSTSLT;                0384 00970000
         L     @10,LLFSTSLT(,P)                                    0384 00971000
         LR    @08,P                                               0384 00972000
         AL    @08,@CF00597                                        0384 00973000
         ST    @10,LLNXTSLT-8(@14,@08)                             0384 00974000
*                          LLFSTSLT = ADDR(LLNXTSLT(IX));          0385 00975000
         AL    @14,@CF00597                                        0385 00976000
         LA    @14,LLNXTSLT-8(@14,P)                               0385 00977000
         ST    @14,LLFSTSLT(,P)                                    0385 00978000
*                        END;                                      0386 00979000
*                  END;                                            0387 00980000
@RT00376 AL    IX,@CF00157                                         0387 00981000
         C     IX,@CF00278                                         0387 00982000
         BNH   @DL00375                                            0387 00983000
*                  IF LLNXTBLK = 0                                 0388 00984000
*                    THEN                                          0388 00985000
         L     @14,LLNXTBLK(,P)                                    0388 00986000
         LTR   @14,@14                                             0388 00987000
         BNZ   @RF00388                                            0388 00988000
*                      LOOPCTL = ON;                               0389 00989000
         OI    LOOPCTL,B'10000000'                                 0389 00990000
*                    ELSE                                          0390 00991000
*                      P = LLNXTBLK;                               0390 00992000
         B     @RC00388                                            0390 00993000
@RF00388 L     P,LLNXTBLK(,P)                                      0390 00994000
*                END;                                              0391 00995000
@RC00388 DS    0H                                                  0391 00996000
@DE00371 TM    LOOPCTL,B'10000000'                                 0391 00997000
         BZ    @DL00371                                            0391 00998000
*               /********************************************        */ 00999000
*               /*                                                   */ 01000000
*               /*  TRY TO GET CORE AGAIN NOW THAT                   */ 01001000
*               /*  SOME MODULES HAVE BEEN DELETED                   */ 01002000
*               /*                                                   */ 01003000
*               /********************************************        */ 01004000
*                                                                  0392 01005000
*               RESPECIFY (REG1) RSTD;                             0392 01006000
*               REG1 = ADDR(GETLIST);                              0393 01007000
         LA    REG1,GETLIST                                        0393 01008000
*LGETM1X:       GEN(GETMAIN MF=(E,(REG1)));                        0394 01009000
LGETM1X  GETMAIN MF=(E,(REG1))                                          01010000
*               RESPECIFY (REG1) UNRSTD;                           0395 01011000
*                                                                  0395 01012000
*                 /******************************************        */ 01013000
*                 /*                                                 */ 01014000
*                 /* CHECK RETURN CODE FROM GET CORE REQUEST         */ 01015000
*                 /*                                                 */ 01016000
*                 /******************************************        */ 01017000
*                                                                  0396 01018000
*                 IF RTNREG ^= 0                                   0396 01019000
*                   THEN                                           0396 01020000
*                                                                  0396 01021000
         LTR   RTNREG,RTNREG                                       0396 01022000
         BZ    @RF00396                                            0396 01023000
*                     DO;                                          0397 01024000
*                       RESPECIFY(REG13,REG14,REG15) RSTD;         0398 01025000
*                       REG15 = NOSPACE;                           0399 01026000
         LA    REG15,28                                            0399 01027000
*                       REG14 = GDTABT;                            0400 01028000
         L     REG14,GDTABT(,GDTPR)                                0400 01029000
*                       REG13 = GDTABH;                            0401 01030000
         L     REG13,GDTABH(,GDTPR)                                0401 01031000
*                       GEN(BR    REG14);                          0402 01032000
         BR    REG14                                                    01033000
*                       RESPECIFY(REG13,REG14,REG15)UNRSTD;        0403 01034000
*                     END;                                         0404 01035000
*                   ELSE;                                          0405 01036000
@RF00396 DS    0H                                                  0406 01037000
*            END DELMOD;                                           0406 01038000
*          ELSE;                                                   0407 01039000
@RF00367 DS    0H                                                  0408 01040000
*        RESPECIFY (RTNREG) UNRSTD;                                0408 01041000
*        END GETCORE;                                              0409 01042000
@EL00002 DS    0H                                                  0409 01043000
@EF00002 DS    0H                                                  0409 01044000
@ER00002 LM    @14,@08,@SA00002                                    0409 01045000
         LM    @10,@12,@SA00002+44                                 0409 01046000
         BR    @14                                                 0409 01047000
@PB00002 DS    0H                                                  0410 01048000
*        /************************************************************/ 01049000
*        /*                                                          */ 01050000
*        /* LIST FORM OF GETMAIN MACRO - MOVED INTO A DYNAMIC AREA   */ 01051000
*        /* FOR USE                                                  */ 01052000
*        /*                                                          */ 01053000
*        /************************************************************/ 01054000
*                                                                  0410 01055000
*        GENERATE DATA;                                            0410 01056000
*                                                                  0410 01057000
*                                                                  0410 01058000
*        /************************************************************/ 01059000
*        /*                                                          */ 01060000
*        /* DECLARATIONS ALLOWING MODULE ICKSA01 ACCESS TO THIS      */ 01061000
*        /* MODULE'S AUTOMATIC STORAGE SIZE VALUE                    */ 01062000
*        /*                                                          */ 01063000
*        /************************************************************/ 01064000
*                                                                  0411 01065000
*        GENERATE DATA;                                            0411 01066000
*        RESPECIFY (REG2,REG3,REG4) UNRSTD;                        0412 01067000
*        END ICKSA03                                               0413 01068000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01069000
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        * 01070000
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        * 01071000
*/*%INCLUDE SYSLIB  (DMSDF09 )                                        * 01072000
*;                                                                 0413 01073000
@EL00001 L     @13,4(,@13)                                         0413 01074000
@EF00001 L     @00,@SIZDATD                                        0413 01075000
         LR    @01,@11                                             0413 01076000
         FREEMAIN R,LV=(0),A=(1)                                        01077000
@ER00001 LM    @14,@12,12(@13)                                     0413 01078000
         BR    @14                                                 0413 01079000
@DATA    DS    0H                                                       01080000
@CH00032 DC    H'12'                                                    01081000
@DATD    DSECT                                                          01082000
         DS    0F                                                       01083000
@SA00001 DS    18F                                                      01084000
@PC00001 DS    4F                                                       01085000
@SA00002 DS    14F                                                      01086000
@PC00002 DS    2F                                                       01087000
@AL00001 DS    2A                                                       01088000
@TF00001 DS    F                                                        01089000
ICKSA03  CSECT                                                          01090000
         DS    0F                                                       01091000
@CF00086 DC    F'0'                                                     01092000
@CF00157 DC    F'1'                                                     01093000
@CF00128 DC    F'3'                                                     01094000
@CF00036 DC    F'4'                                                     01095000
@CF00111 DC    F'6'                                                     01096000
@CF00153 DC    F'8'                                                     01097000
@CF00278 DC    F'24'                                                    01098000
@CF00559 DC    F'255'                                                   01099000
@CF00595 DC    F'-12'                                                   01100000
@CF00597 DC    F'-8'                                                    01101000
@CF00598 DC    F'-4'                                                    01102000
@DATD    DSECT                                                          01103000
         DS    0D                                                       01104000
LISTSCAN DS    A                                                        01105000
IOCSPTR  DS    A                                                        01106000
OPNPTR   DS    A                                                        01107000
DDSTRU   DS    A                                                        01108000
FSADDR   DS    A                                                        01109000
DMPINDEX DS    A                                                        01110000
TEMPSIZE DS    F                                                        01111000
TEMPPTR  DS    A                                                        01112000
DELPARM  DS    F                                                        01113000
LISTPTR  DS    A                                                        01114000
TESTRC   DS    H                                                        01115000
@TS00001 DS    CL95                                                     01116000
DOCNTRL  DS    BL1                                                      01117000
TEMPEPN  DS    CL8                                                      01118000
TEMPID   DS    CL4                                                      01119000
NAMEFND  DS    BL1                                                      01120000
LOOPCTL  DS    BL1                                                      01121000
GETLIST  DS    CL10                                                     01122000
         ORG   GETLIST                                                  01123000
GETSZ    DS    FL4                                                      01124000
GETPT    DS    AL4                                                      01125000
GETFLG   DS    CL2                                                      01126000
         ORG   GETLIST+10                                               01127000
         DS    CL2                                                      01128000
PROLSAV  DS    CL44                                                     01129000
ICKSA03  CSECT                                                          01130000
         DS    0F                                                       01131000
@SIZDATD DC    AL1(0)                                                   01132000
         DC    AL3(@ENDDATD-@DATD)                                      01133000
         DS    0D                                                       01134000
@CC00571 DC    C'ICK     '                                              01135000
@CC00493 DC    C'SA03'                                                  01136000
@CC00566 DC    C'SA02'                                                  01137000
@CC00567 DC    C'DB01'                                                  01138000
@CC00568 DC    C'EX01'                                                  01139000
@CC00569 DC    C'TP01'                                                  01140000
@CC00570 DC    C'IO01'                                                  01141000
FIXAREA  DS    CL150                                                    01142000
         ORG   FIXAREA                                                  01143000
@NM00018 DC    150X'00'                                                 01144000
         ORG   FIXAREA+150                                              01145000
IDENT    DC    CL4'SA03'                                                01146000
@DATD    DSECT                                                          01147000
ICKSA03 CSECT                                                           01148000
LIST1   GETMAIN EC,LV=8,A=LIST1,MF=L                                    01149000
@DATD    DSECT                                                          01150000
ICKSA03 CSECT                                                           01151000
ICKSAS3 DC    A(@SIZDATD)                                               01152000
        ENTRY ICKSAS3                                                   01153000
@DATD    DSECT                                                          01154000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01155000
@ENDDATD EQU   *                                                        01156000
ICKSA03  CSECT                                                          01157000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01158000
@01      EQU   01                                                       01159000
@02      EQU   02                                                       01160000
@03      EQU   03                                                       01161000
@04      EQU   04                                                       01162000
@05      EQU   05                                                       01163000
@06      EQU   06                                                       01164000
@07      EQU   07                                                       01165000
@08      EQU   08                                                       01166000
@09      EQU   09                                                       01167000
@10      EQU   10                                                       01168000
@11      EQU   11                                                       01169000
@12      EQU   12                                                       01170000
@13      EQU   13                                                       01171000
@14      EQU   14                                                       01172000
@15      EQU   15                                                       01173000
IX       EQU   @05                                                      01174000
P        EQU   @09                                                      01175000
I        EQU   @06                                                      01176000
RTNADDR  EQU   @10                                                      01177000
RTNSAVE  EQU   @10                                                      01178000
SETRC    EQU   @07                                                      01179000
LISTLN   EQU   @05                                                      01180000
RTNREG   EQU   @15                                                      01181000
REG0     EQU   @00                                                      01182000
REG1     EQU   @01                                                      01183000
REG2     EQU   @02                                                      01184000
REG3     EQU   @03                                                      01185000
REG4     EQU   @04                                                      01186000
REG5     EQU   @05                                                      01187000
REG13    EQU   @13                                                      01188000
REG14    EQU   @14                                                      01189000
REG15    EQU   @15                                                      01190000
GDTPR    EQU   @02                                                      01191000
MODIDPR  EQU   @03                                                      01192000
SIZEPR   EQU   @04                                                      01193000
RCODEPR  EQU   @04                                                      01194000
SAVEPTR  EQU   @13                                                      01195000
REG10    EQU   @10                                                      01196000
REG11    EQU   @11                                                      01197000
REG12    EQU   @12                                                      01198000
REG6     EQU   @06                                                      01199000
REG7     EQU   @07                                                      01200000
REG8     EQU   @08                                                      01201000
REG9     EQU   @09                                                      01202000
GDTTBL   EQU   0                                                        01203000
GDTTR1   EQU   GDTTBL+8                                                 01204000
GDTTR2   EQU   GDTTBL+12                                                01205000
GDTSAH   EQU   GDTTBL+32                                                01206000
GDTDIN   EQU   GDTTBL+44                                                01207000
GDTDOP   EQU   GDTTBL+48                                                01208000
GDTDBG   EQU   GDTTBL+52                                                01209000
GDTDVO   EQU   GDTTBL+56                                                01210000
GDTPRT   EQU   GDTTBL+60                                                01211000
GDTESS   EQU   GDTTBL+64                                                01212000
GDTESA   EQU   GDTTBL+68                                                01213000
GDTRST   EQU   GDTTBL+72                                                01214000
GDTRES   EQU   GDTTBL+76                                                01215000
GDTCAL   EQU   GDTTBL+80                                                01216000
GDTGSP   EQU   GDTTBL+84                                                01217000
GDTFSP   EQU   GDTTBL+88                                                01218000
GDTGPL   EQU   GDTTBL+92                                                01219000
GDTFPL   EQU   GDTTBL+96                                                01220000
GDTLOD   EQU   GDTTBL+100                                               01221000
GDTDEL   EQU   GDTTBL+104                                               01222000
GDTPRL   EQU   GDTTBL+108                                               01223000
GDTEPL   EQU   GDTTBL+112                                               01224000
GDTTIM   EQU   GDTTBL+116                                               01225000
GDTIIO   EQU   GDTTBL+120                                               01226000
GDTTIO   EQU   GDTTBL+124                                               01227000
GDTOPN   EQU   GDTTBL+136                                               01228000
GDTCLS   EQU   GDTTBL+140                                               01229000
GDTGET   EQU   GDTTBL+144                                               01230000
GDTPUT   EQU   GDTTBL+148                                               01231000
GDTABT   EQU   GDTTBL+152                                               01232000
GDTABH   EQU   GDTTBL+156                                               01233000
GDTSNP   EQU   GDTTBL+160                                               01234000
GDTSPR   EQU   GDTTBL+164                                               01235000
GDTWTO   EQU   GDTTBL+168                                               01236000
GDTSCR   EQU   GDTTBL+172                                               01237000
GDTVCK   EQU   GDTTBL+176                                               01238000
GDTDVC   EQU   GDTTBL+180                                               01239000
GDTSTE   EQU   GDTTBL+188                                               01240000
TRACE1   EQU   0                                                        01241000
OLDERID1 EQU   TRACE1                                                   01242000
NEWID1   EQU   TRACE1+95                                                01243000
NEWERID1 EQU   5                                                        01244000
TRACE2   EQU   0                                                        01245000
STAEPARM EQU   0                                                        01246000
STAEPFX  EQU   STAEPARM                                                 01247000
LISTTEST EQU   0                                                        01248000
IOCSTR   EQU   0                                                        01249000
IOCDSO   EQU   IOCSTR+13                                                01250000
IOCRFM   EQU   IOCSTR+14                                                01251000
IOCMAC   EQU   IOCSTR+15                                                01252000
IOCMSG   EQU   IOCSTR+16                                                01253000
OPNAGL   EQU   0                                                        01254000
OPNOPT   EQU   OPNAGL                                                   01255000
OPNRFM   EQU   OPNAGL+1                                                 01256000
OPNTYP   EQU   OPNAGL+2                                                 01257000
OPNMOD   EQU   OPNAGL+3                                                 01258000
UVOLLIST EQU   0                                                        01259000
UVOLENT  EQU   UVOLLIST+2                                               01260000
DARGLIST EQU   0                                                        01261000
DARGSTID EQU   DARGLIST+8                                               01262000
DARGARY  EQU   DARGLIST+20                                              01263000
DARGINS  EQU   DARGARY                                                  01264000
DARGINL  EQU   DARGARY+2                                                01265000
FMTLIST  EQU   0                                                        01266000
FMTFLGS  EQU   FMTLIST                                                  01267000
FMTSPF   EQU   FMTLIST+2                                                01268000
FMTRFNO  EQU   FMTSPF                                                   01269000
FMTILEN  EQU   FMTRFNO                                                  01270000
FMTIOFF  EQU   FMTLIST+4                                                01271000
FMTTRBC  EQU   FMTIOFF                                                  01272000
FMTSTO   EQU   FMTTRBC                                                  01273000
FMTOCOL  EQU   FMTLIST+6                                                01274000
FMTCNVF  EQU   FMTLIST+10                                               01275000
DMPITM   EQU   0                                                        01276000
DMPARY   EQU   0                                                        01277000
MODID    EQU   0                                                        01278000
PSIZE    EQU   0                                                        01279000
RCODE    EQU   0                                                        01280000
@NM00019 EQU   0                                                        01281000
AUTOSIZE EQU   @NM00019                                                 01282000
AUTOID   EQU   @NM00019+4                                               01283000
SAVEFWD  EQU   0                                                        01284000
LLBLK    EQU   0                                                        01285000
LLHDR    EQU   LLBLK                                                    01286000
LLFSTSLT EQU   LLHDR                                                    01287000
LLNXTBLK EQU   LLHDR+4                                                  01288000
LLSLOT   EQU   LLBLK+8                                                  01289000
LLNAME   EQU   LLSLOT                                                   01290000
LLNXTSLT EQU   LLNAME                                                   01291000
LLNOMOD  EQU   LLNAME+4                                                 01292000
LLUSECTR EQU   LLSLOT+12                                                01293000
SAHIST   EQU   0                                                        01294000
AUTOPTR  EQU   SAHIST+8                                                 01295000
LLBLKPTR EQU   SAHIST+16                                                01296000
AUTOTBL  EQU   0                                                        01297000
AUTOARAY EQU   AUTOTBL                                                  01298000
AREAID   EQU   AUTOARAY                                                 01299000
STATUS   EQU   AUTOARAY+4                                               01300000
PTR1     EQU   AUTOARAY+8                                               01301000
DMPTRM   EQU   0                                                        01302000
ICKDB010 EQU   0                                                        01303000
ICKDVCL0 EQU   0                                                        01304000
ICKDVIN0 EQU   0                                                        01305000
ICKDVON0 EQU   0                                                        01306000
ICKDVOP0 EQU   0                                                        01307000
ICKIOCL0 EQU   0                                                        01308000
ICKIOGT0 EQU   0                                                        01309000
ICKIOIT0 EQU   0                                                        01310000
ICKIOOP0 EQU   0                                                        01311000
ICKIOPT0 EQU   0                                                        01312000
ICKIOTM0 EQU   0                                                        01313000
ICKSACL0 EQU   0                                                        01314000
ICKSADE0 EQU   0                                                        01315000
ICKSAEP0 EQU   0                                                        01316000
ICKSAFP0 EQU   0                                                        01317000
ICKSAFS0 EQU   0                                                        01318000
ICKSAGP0 EQU   0                                                        01319000
ICKSAGS0 EQU   0                                                        01320000
ICKSALD0 EQU   0                                                        01321000
ICKSAPR0 EQU   0                                                        01322000
ICKSASC0 EQU   0                                                        01323000
ICKSASN0 EQU   0                                                        01324000
ICKSAST0 EQU   0                                                        01325000
ICKSATI0 EQU   0                                                        01326000
ICKSAVC0 EQU   0                                                        01327000
ICKSAWO0 EQU   0                                                        01328000
ICKTPEA0 EQU   0                                                        01329000
ICKTPES0 EQU   0                                                        01330000
ICKTPPR0 EQU   0                                                        01331000
ICKTPRE0 EQU   0                                                        01332000
ICKTPRS0 EQU   0                                                        01333000
NEWERID2 EQU   5                                                        01334000
RESOLVE  EQU   0                                                        01335000
MODIDX   EQU   0                                                        01336000
PSIZEX   EQU   0                                                        01337000
GDTTBLX  EQU   0                                                        01338000
RCODEX   EQU   0                                                        01339000
ZSIZE    EQU   0                                                        01340000
ZPTR     EQU   0                                                        01341000
GETGEN   EQU   LIST1                                                    01342000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01343000
ASIZE    EQU   AUTOARAY+6                                               01344000
SAHSTA   EQU   SAHIST+12                                                01345000
GPLAST   EQU   SAHIST+4                                                 01346000
GPFIRST  EQU   SAHIST                                                   01347000
LLMODSZ  EQU   LLSLOT+13                                                01348000
LLADDR   EQU   LLSLOT+8                                                 01349000
@NM00017 EQU   DMPARY+15                                                01350000
DMPARYTP EQU   DMPARY+14                                                01351000
DMPARYEX EQU   DMPARY+12                                                01352000
DMPARYIC EQU   DMPARY+10                                                01353000
DMPARYSZ EQU   DMPARY+8                                                 01354000
DMPARYNM EQU   DMPARY                                                   01355000
@NM00016 EQU   DMPITM+15                                                01356000
DMPITMTP EQU   DMPITM+14                                                01357000
DMPITMLN EQU   DMPITM+12                                                01358000
DMPITMPT EQU   DMPITM+8                                                 01359000
DMPITMNM EQU   DMPITM                                                   01360000
@NM00015 EQU   FMTCNVF+1                                                01361000
FMTBS    EQU   FMTCNVF+1                                                01362000
FMTSS    EQU   FMTCNVF+1                                                01363000
FMTAL    EQU   FMTCNVF+1                                                01364000
FMTZS    EQU   FMTCNVF+1                                                01365000
@NM00014 EQU   FMTCNVF                                                  01366000
FMTPU    EQU   FMTCNVF                                                  01367000
FMTBD    EQU   FMTCNVF                                                  01368000
FMTBHD   EQU   FMTCNVF                                                  01369000
FMTBHA   EQU   FMTCNVF                                                  01370000
FMTBH    EQU   FMTCNVF                                                  01371000
FMTOLEN  EQU   FMTLIST+8                                                01372000
FMTRIO   EQU   FMTOCOL                                                  01373000
FMTSPT   EQU   FMTSTO                                                   01374000
FMTSTL   EQU   FMTILEN                                                  01375000
@NM00013 EQU   FMTFLGS+1                                                01376000
FMTHDF   EQU   FMTFLGS                                                  01377000
FMTDFF   EQU   FMTFLGS                                                  01378000
FMTSTF   EQU   FMTFLGS                                                  01379000
FMTREPF  EQU   FMTFLGS                                                  01380000
FMTBDF   EQU   FMTFLGS                                                  01381000
FMTIDF   EQU   FMTFLGS                                                  01382000
FMTSCF   EQU   FMTFLGS                                                  01383000
FMTEOLF  EQU   FMTFLGS                                                  01384000
DARGDTM  EQU   DARGARY+4                                                01385000
DARGPCT  EQU   DARGINL                                                  01386000
DARGREP  EQU   DARGINS                                                  01387000
@NM00012 EQU   DARGLIST+19                                              01388000
DARGIND  EQU   DARGLIST+18                                              01389000
DARGRETL EQU   DARGLIST+16                                              01390000
DARGCNT  EQU   DARGLIST+14                                              01391000
DARGILP  EQU   DARGLIST+12                                              01392000
DARGSENT EQU   DARGSTID+3                                               01393000
DARGSMOD EQU   DARGSTID                                                 01394000
DARGRETP EQU   DARGLIST+4                                               01395000
DARGDBP  EQU   DARGLIST                                                 01396000
UVOLVOL  EQU   UVOLENT+4                                                01397000
UVOLDEV  EQU   UVOLENT                                                  01398000
UVOLCNT  EQU   UVOLLIST                                                 01399000
OPNRSVD  EQU   OPNAGL+28                                                01400000
OPNVOL   EQU   OPNAGL+24                                                01401000
OPNBLK   EQU   OPNAGL+20                                                01402000
OPNREC   EQU   OPNAGL+16                                                01403000
OPNDSN   EQU   OPNAGL+12                                                01404000
OPNDDN   EQU   OPNAGL+8                                                 01405000
OPNIOC   EQU   OPNAGL+4                                                 01406000
@NM00011 EQU   OPNMOD                                                   01407000
OPNMODRC EQU   OPNMOD                                                   01408000
OPNMODAC EQU   OPNMOD                                                   01409000
@NM00010 EQU   OPNTYP                                                   01410000
OPNTYPSO EQU   OPNTYP                                                   01411000
OPNTYPSI EQU   OPNTYP                                                   01412000
@NM00009 EQU   OPNRFM                                                   01413000
OPNRFMBK EQU   OPNRFM                                                   01414000
OPNRFMSF EQU   OPNRFM                                                   01415000
OPNRFMUN EQU   OPNRFM                                                   01416000
OPNRFMVR EQU   OPNRFM                                                   01417000
OPNRFMFX EQU   OPNRFM                                                   01418000
@NM00008 EQU   OPNOPT                                                   01419000
OPNOPTJM EQU   OPNOPT                                                   01420000
OPNOPTKS EQU   OPNOPT                                                   01421000
OPNOPTBK EQU   OPNOPT                                                   01422000
OPNOPTUP EQU   OPNOPT                                                   01423000
OPNOPTOT EQU   OPNOPT                                                   01424000
OPNOPTIN EQU   OPNOPT                                                   01425000
IOCEXT   EQU   IOCSTR+36                                                01426000
IOCRRN   EQU   IOCSTR+32                                                01427000
@NM00007 EQU   IOCSTR+30                                                01428000
IOCPNM   EQU   IOCSTR+28                                                01429000
IOCCBP   EQU   IOCSTR+24                                                01430000
IOCDSN   EQU   IOCSTR+20                                                01431000
@NM00006 EQU   IOCSTR+17                                                01432000
@NM00005 EQU   IOCMSG                                                   01433000
IOCMSGOP EQU   IOCMSG                                                   01434000
IOCMACPA EQU   IOCMAC                                                   01435000
@NM00004 EQU   IOCMAC                                                   01436000
IOCMACBK EQU   IOCMAC                                                   01437000
IOCMACUP EQU   IOCMAC                                                   01438000
IOCMACOT EQU   IOCMAC                                                   01439000
IOCMACIN EQU   IOCMAC                                                   01440000
@NM00003 EQU   IOCRFM                                                   01441000
IOCRFMBK EQU   IOCRFM                                                   01442000
IOCRFMSF EQU   IOCRFM                                                   01443000
IOCRFMUN EQU   IOCRFM                                                   01444000
IOCRFMVR EQU   IOCRFM                                                   01445000
IOCRFMFX EQU   IOCRFM                                                   01446000
@NM00002 EQU   IOCDSO                                                   01447000
IOCDSOPS EQU   IOCDSO                                                   01448000
IOCKYL   EQU   IOCSTR+12                                                01449000
IOCTRN   EQU   IOCSTR+8                                                 01450000
IOCDLN   EQU   IOCSTR+4                                                 01451000
IOCDAD   EQU   IOCSTR                                                   01452000
STAEWORK EQU   STAEPARM+32                                              01453000
STARPTR  EQU   STAEPFX+28                                               01454000
STASPTR  EQU   STAEPFX+24                                               01455000
STALEN   EQU   STAEPFX+20                                               01456000
STAID    EQU   STAEPFX+16                                               01457000
STAEPA   EQU   STAEPFX+12                                               01458000
STAGDT   EQU   STAEPFX+8                                                01459000
STABPTR  EQU   STAEPFX+4                                                01460000
STAFPTR  EQU   STAEPFX                                                  01461000
NEWID2   EQU   TRACE2+95                                                01462000
OLDERID2 EQU   TRACE2                                                   01463000
CALLID   EQU   OLDERID1+90                                              01464000
@NM00001 EQU   OLDERID1                                                 01465000
GDTCVR   EQU   GDTTBL+184                                               01466000
GDTTOH   EQU   GDTTBL+132                                               01467000
GDTRIP   EQU   GDTTBL+128                                               01468000
GDTDVH   EQU   GDTTBL+40                                                01469000
GDTIOH   EQU   GDTTBL+36                                                01470000
GDTTPH   EQU   GDTTBL+28                                                01471000
GDTRIH   EQU   GDTTBL+24                                                01472000
GDTSTH   EQU   GDTTBL+20                                                01473000
GDTDBH   EQU   GDTTBL+16                                                01474000
GDTPRM   EQU   GDTTBL+4                                                 01475000
GDTHDR   EQU   GDTTBL                                                   01476000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01477000
@RC00329 EQU   @RC00325                                                 01478000
@ENDDATA EQU   *                                                        01479000
         END   ICKSA03,(C'PLS1739',0701,78192)                          01480000
