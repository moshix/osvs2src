         TITLE '***********  ICKSA05  SYSTEM ADAPTER UTIME MODULE  *****00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
ICKSA05  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'ICKSA05   78.192'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  DS    0H                                                  0002 00022000
         USING @PSTART,@12                                         0002 00023000
         L     @00,@SIZDATD                                        0002 00024000
         GETMAIN  R,LV=(0)                                              00025000
         LR    @11,@01                                             0002 00026000
         USING @DATD,@11                                           0002 00027000
         ST    @13,@SA00001+4                                      0002 00028000
         LM    @00,@01,20(@13)                                     0002 00029000
         ST    @11,8(,@13)                                         0002 00030000
         LR    @13,@11                                             0002 00031000
         MVC   @PC00001(20),0(@01)                                 0002 00032000
*                                      /* NEW BASE FOR THE GLOBAL    */ 00033000
*                                      /* DATA TABLE                 */ 00034000
*                                                                  0193 00035000
*        /************************************************************/ 00036000
*        /*                                                          */ 00037000
*        /* SET BASE FOR THE GLOBAL DATA TABLE                       */ 00038000
*        /*                                                          */ 00039000
*        /************************************************************/ 00040000
*                                                                  0193 00041000
*        GDTPR = ADDR(GDTTBLX);                                    0193 00042000
         L     GDTPR,@PC00001                                      0193 00043000
*        OLDERID2 = NEWERID2;                                      0194 00044000
         L     @10,GDTTR2(,GDTPR)                                  0194 00045000
         MVC   @TS00001(95),NEWERID2(@10)                          0194 00046000
         MVC   OLDERID2(95,@10),@TS00001                           0194 00047000
*        NEWID2 = 'SA05';                                          0195 00048000
*                                                                  0195 00049000
         MVC   NEWID2(4,@10),@CC00481                              0195 00050000
*        /************************************************************/ 00051000
*        /*                                                          */ 00052000
*        /* INITIALIZE DAYS PER MONTH AREA                           */ 00053000
*        /*                                                          */ 00054000
*        /************************************************************/ 00055000
*                                                                  0196 00056000
*        MONTO = MONFROM;                                          0196 00057000
*                                                                  0196 00058000
         MVC   MONTO(11),MONFROM                                   0196 00059000
*        /************************************************************/ 00060000
*        /*                                                          */ 00061000
*        /* IF A FOURTH ARGUMENT IS SPECIFIED, BUT THIS ARGUMENT IS  */ 00062000
*        /* NOT 'FORMAT', 'HSECOND', OR 'CLOCK', THEN CALL           */ 00063000
*        /* THE UABORT ROUTINE.                                      */ 00064000
*        /*                                                          */ 00065000
*        /************************************************************/ 00066000
*                                                                  0197 00067000
*        IF TILN = 4 & TIFORM ^= FORMAT & TIFORM ^= HSECOND &      0197 00068000
*          TIFORM ^= CLOCK                                         0197 00069000
*          THEN                                                    0197 00070000
*                                                                  0197 00071000
         L     @10,@PC00001+16                                     0197 00072000
         CLI   TILN(@10),4                                         0197 00073000
         BNE   @RF00197                                            0197 00074000
         L     @10,@PC00001+12                                     0197 00075000
         CLC   TIFORM(4,@10),@CC00139                              0197 00076000
         BE    @RF00197                                            0197 00077000
         CLC   TIFORM(4,@10),@CC00141                              0197 00078000
         BE    @RF00197                                            0197 00079000
         CLC   TIFORM(4,@10),@CC00143                              0197 00080000
         BE    @RF00197                                            0197 00081000
*            DO;                                                   0198 00082000
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  0199 00083000
*              REG15 = ARGERR;                                     0200 00084000
         LA    REG15,40                                            0200 00085000
*              REG14 = GDTABT;                                     0201 00086000
         L     REG14,GDTABT(,GDTPR)                                0201 00087000
*              REG13 = GDTABH;                                     0202 00088000
         L     REG13,GDTABH(,GDTPR)                                0202 00089000
*              GEN(BR    REG14);                                   0203 00090000
         BR    REG14                                                    00091000
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 0204 00092000
*            END;                                                  0205 00093000
*                                                                  0205 00094000
*        /************************************************************/ 00095000
*        /*                                                          */ 00096000
*        /* CHECK IF DATE AND TIME IS TO BE FORMATTED                */ 00097000
*        /*                                                          */ 00098000
*        /************************************************************/ 00099000
*                                                                  0206 00100000
*        IF TILN = 4 & TIFORM = FORMAT                             0206 00101000
*          THEN                                                    0206 00102000
@RF00197 L     @10,@PC00001+16                                     0206 00103000
         CLI   TILN(@10),4                                         0206 00104000
         BNE   @RF00206                                            0206 00105000
         L     @10,@PC00001+12                                     0206 00106000
         CLC   TIFORM(4,@10),@CC00139                              0206 00107000
         BNE   @RF00206                                            0206 00108000
*            DO;                                                   0207 00109000
*                                                                  0207 00110000
*              /******************************************************/ 00111000
*              /*                                                    */ 00112000
*              /* OBTAIN PACKED DECIMAL DATE AND TIME BY ISSUING     */ 00113000
*              /* THE DEC FORM OF THE TIME MACRO.  THEN UNPACK THE   */ 00114000
*              /* TIME INTO THE VARIABLE TIME                        */ 00115000
*              /*                                                    */ 00116000
*              /******************************************************/ 00117000
*                                                                  0208 00118000
*              RESPECIFY (REG0,REG1) RSTD;                         0208 00119000
*LTIME1:       GEN(TIME  DEC);                                     0209 00120000
LTIME1   TIME  DEC                                                      00121000
*              GEN(ST    REG0,TIME);                               0210 00122000
         ST    REG0,TIME                                                00123000
*              GEN(UNPK  TIME(9),TIME(4));                         0211 00124000
*                                                                  0211 00125000
         UNPK  TIME(9),TIME(4)                                          00126000
*              /******************************************************/ 00127000
*              /*                                                    */ 00128000
*              /* SHIFT HOUR VALUE LEFT AND INSERT COLON AFTER HOUR  */ 00129000
*              /* VALUE,                                             */ 00130000
*              /* SHIFT MINUTE VALUE LEFT AND INSERT COLON AFTER     */ 00131000
*              /* MINUTE VALUE,                                      */ 00132000
*              /* INSERT FORMATTED TIME INTO TITIME FOR THE USER     */ 00133000
*              /*                                                    */ 00134000
*              /******************************************************/ 00135000
*                                                                  0212 00136000
*              TIME(1:2)=TIME(3:4);                                0212 00137000
         MVC   TIME(2),TIME+2                                      0212 00138000
*              TIME(3)=':';                                        0213 00139000
*                                                                  0213 00140000
         MVI   TIME+2,C':'                                         0213 00141000
*              TIME(4:5)=TIME(5:6);                                0214 00142000
         MVC   @TS00001(2),TIME+4                                  0214 00143000
         MVC   TIME+3(2),@TS00001                                  0214 00144000
*              TIME(6)=':';                                        0215 00145000
*                                                                  0215 00146000
         MVI   TIME+5,C':'                                         0215 00147000
*              TITIME(1:8)=TIME(1:8);                              0216 00148000
*                                                                  0216 00149000
         L     @10,@PC00001+4                                      0216 00150000
         MVC   TITIME(8,@10),TIME                                  0216 00151000
*              /******************************************************/ 00152000
*              /*                                                    */ 00153000
*              /* CONVERT PACKED DECIMAL YEAR AND DAY (00YYDDDF) TO  */ 00154000
*              /* BINARY, F BEING THE SIGN CHARACTER                 */ 00155000
*              /*                                                    */ 00156000
*              /******************************************************/ 00157000
*                                                                  0217 00158000
*              GEN(SR    REG0,REG0);                               0217 00159000
         SR    REG0,REG0                                                00160000
*              GEN(ST    REG0,DBLWORD);                            0218 00161000
         ST    REG0,DBLWORD                                             00162000
*              GEN(ST    REG1,DBLWORD+4);                          0219 00163000
         ST    REG1,DBLWORD+4                                           00164000
*              GEN(CVB   REG1,DBLWORD);                            0220 00165000
*                                                                  0220 00166000
         CVB   REG1,DBLWORD                                             00167000
*              /******************************************************/ 00168000
*              /*                                                    */ 00169000
*              /* SEPARATE THE YEAR AND DAY, STORE BINARY DAY NUMBER */ 00170000
*              /* IN DAY, STORE BINARY YEAR NUMBER IN YEAR           */ 00171000
*              /*                                                    */ 00172000
*              /******************************************************/ 00173000
*                                                                  0221 00174000
*              GEN(D     REG0,=F'1000');                           0221 00175000
         D     REG0,=F'1000'                                            00176000
*              GEN(STH   REG0,DAY);                                0222 00177000
         STH   REG0,DAY                                                 00178000
*              GEN(STH   REG1,YEAR);                               0223 00179000
         STH   REG1,YEAR                                                00180000
*              RESPECIFY (REG0,REG1) UNRSTD;                       0224 00181000
*                                                                  0224 00182000
*              /******************************************************/ 00183000
*              /******************************************************/ 00184000
*              /*                                                    */ 00185000
*              /* USE CALENDAR CONVERSION ALGORITHM TO OBTAIN DATE IN*/ 00186000
*              /* DAY, MONTH, AND YEAR--PUNT IN YEAR 2000            */ 00187000
*              /*                                                    */ 00188000
*              /******************************************************/ 00189000
*              /******************************************************/ 00190000
*                                                                  0225 00191000
*              /******************************************************/ 00192000
*              /*                                                    */ 00193000
*              /* IF YEAR IS A LEAP YEAR, THEN REINITIALIZE THE MONTH*/ 00194000
*              /* FEBRUARY TO 29 DAYS                                */ 00195000
*              /*                                                    */ 00196000
*              /******************************************************/ 00197000
*                                                                  0225 00198000
*              IF YEAR//4 = 0                                      0225 00199000
*                THEN                                              0225 00200000
         LH    @00,YEAR                                            0225 00201000
         SRDA  @00,32                                              0225 00202000
         D     @00,@CF00044                                        0225 00203000
         LTR   @00,@00                                             0225 00204000
         BNZ   @RF00225                                            0225 00205000
*                  MTHS(2) = 29;                                   0226 00206000
*                                                                  0226 00207000
         MVI   MTHS+1,X'1D'                                        0226 00208000
*              DOCNTRL = ON;                                       0227 00209000
*                                                                  0227 00210000
@RF00225 OI    DOCNTRL,B'10000000'                                 0227 00211000
*              /******************************************************/ 00212000
*              /*                                                    */ 00213000
*              /* CALCULATE DAY AND MONTH                            */ 00214000
*              /*                                                    */ 00215000
*              /******************************************************/ 00216000
*                                                                  0228 00217000
*TIDO:         DO I=1 TO 11 WHILE(DOCNTRL = ON);                   0228 00218000
TIDO     LA    I,1                                                 0228 00219000
@DL00228 TM    DOCNTRL,B'10000000'                                 0228 00220000
         BNO   @DC00228                                            0228 00221000
*                DAY = DAY - MTHS(I);                              0229 00222000
*                                                                  0229 00223000
         LH    @10,DAY                                             0229 00224000
         SLR   @08,@08                                             0229 00225000
         IC    @08,MTHS-1(I)                                       0229 00226000
         SLR   @10,@08                                             0229 00227000
         STH   @10,DAY                                             0229 00228000
*                /****************************************************/ 00229000
*                /*                                                  */ 00230000
*                /* CHECK IF DAY VALUE LESS THAN OR EQUAL ZERO       */ 00231000
*                /*                                                  */ 00232000
*                /****************************************************/ 00233000
*                                                                  0230 00234000
*                IF DAY <= 0                                       0230 00235000
*                  THEN                                            0230 00236000
         LTR   @10,@10                                             0230 00237000
         BP    @RF00230                                            0230 00238000
*                    DOCNTRL = OFF;                                0231 00239000
         NI    DOCNTRL,B'01111111'                                 0231 00240000
*              END TIDO;                                           0232 00241000
*                                                                  0232 00242000
@RF00230 AL    I,@CF00165                                          0232 00243000
         C     I,@CF00263                                          0232 00244000
         BNH   @DL00228                                            0232 00245000
@DC00228 DS    0H                                                  0233 00246000
*              /******************************************************/ 00247000
*              /*                                                    */ 00248000
*              /* SET DAY AND MONTH VALUES                           */ 00249000
*              /*                                                    */ 00250000
*              /******************************************************/ 00251000
*                                                                  0233 00252000
*              IF DOCNTRL = OFF                                    0233 00253000
*                THEN                                              0233 00254000
         TM    DOCNTRL,B'10000000'                                 0233 00255000
         BNZ   @RF00233                                            0233 00256000
*                  DO;                                             0234 00257000
*                    I = I - 1;                                    0235 00258000
         BCTR  I,0                                                 0235 00259000
*                    DAY = DAY + MTHS(I);                          0236 00260000
         SLR   @10,@10                                             0236 00261000
         IC    @10,MTHS-1(I)                                       0236 00262000
         AH    @10,DAY                                             0236 00263000
         STH   @10,DAY                                             0236 00264000
*                  END;                                            0237 00265000
*              MONTH = I;                                          0238 00266000
*                                                                  0238 00267000
@RF00233 STH   I,MONTH                                             0238 00268000
*              /******************************************************/ 00269000
*              /*                                                    */ 00270000
*              /* CONVERT DATE TO DECIMAL, UNPACK IT, AND FORMAT IT  */ 00271000
*              /* INTO TIDATE FOR THE USER WITH A SLASH SEPARATING   */ 00272000
*              /* MONTH FROM DAY AND DAY FROM YEAR                   */ 00273000
*              /*                                                    */ 00274000
*              /******************************************************/ 00275000
*                                                                  0239 00276000
*              RESPECIFY(REG0) RSTD;                               0239 00277000
*              GEN(LH    REG1,MONTH);                              0240 00278000
         LH    REG1,MONTH                                               00279000
*              GEN(M     REG0,=F'1000');                           0241 00280000
         M     REG0,=F'1000'                                            00281000
*              GEN(AH    REG1,DAY);                                0242 00282000
         AH    REG1,DAY                                                 00283000
*              GEN(M     REG0,=F'1000');                           0243 00284000
         M     REG0,=F'1000'                                            00285000
*              RESPECIFY (REG0) UNRSTD;                            0244 00286000
*              GEN(AH    REG1,YEAR);                               0245 00287000
         AH    REG1,YEAR                                                00288000
*              GEN(CVD   REG1,DBLWORD);                            0246 00289000
         CVD   REG1,DBLWORD                                             00290000
*              GEN(UNPK  DATETEMP(8),DBLWORD(8));                  0247 00291000
         UNPK  DATETEMP(8),DBLWORD(8)                                   00292000
*              GEN(MVZ   DATETEMP+7(1),DATETEMP+6);                0248 00293000
         MVZ   DATETEMP+7(1),DATETEMP+6                                 00294000
*              DATETEMP(3) = '/';                                  0249 00295000
         MVI   DATETEMP+2,C'/'                                     0249 00296000
*              DATETEMP(6) = '/';                                  0250 00297000
         MVI   DATETEMP+5,C'/'                                     0250 00298000
*              TIDATE(1:8) = DATETEMP(1:8);                        0251 00299000
         L     @10,@PC00001+8                                      0251 00300000
         MVC   TIDATE(8,@10),DATETEMP                              0251 00301000
*            END;                                                  0252 00302000
*          ELSE  /* DATE AND TIME NOT TO BE FORMATTED                */ 00303000
*            DO;                                                   0253 00304000
         B     @RC00206                                            0253 00305000
@RF00206 DS    0H                                                  0254 00306000
*              IF TILN = 4 & TIFORM = HSECOND                      0254 00307000
*                THEN                                              0254 00308000
         L     @10,@PC00001+16                                     0254 00309000
         CLI   TILN(@10),4                                         0254 00310000
         BNE   @RF00254                                            0254 00311000
         L     @10,@PC00001+12                                     0254 00312000
         CLC   TIFORM(4,@10),@CC00141                              0254 00313000
         BNE   @RF00254                                            0254 00314000
*                  DO;                                             0255 00315000
*                                                                  0255 00316000
*                    /************************************************/ 00317000
*                    /*                                              */ 00318000
*                    /* OBTAIN THE TIME IN HUNDREDTHS OF A           */ 00319000
*                    /* SECOND BY ISSUING THE BIN FORM OF            */ 00320000
*                    /* THE TIME MACRO.                              */ 00321000
*                    /*                                              */ 00322000
*                    /************************************************/ 00323000
*                                                                  0256 00324000
*                    RESPECIFY (REG0,REG1) RSTD;                   0256 00325000
*LTIME3:             GEN(TIME  BIN);                               0257 00326000
LTIME3   TIME  BIN                                                      00327000
*                    GEN(ST    REG0,TIME);                         0258 00328000
         ST    REG0,TIME                                                00329000
*                    RESPECIFY (REG0) UNRSTD;                      0259 00330000
*                                                                  0259 00331000
*                    /************************************************/ 00332000
*                    /*                                              */ 00333000
*                    /* INSERT TIME IN HUNDREDTHS OF A               */ 00334000
*                    /* SECOND INTO TITIME FOR USER.                 */ 00335000
*                    /*                                              */ 00336000
*                    /************************************************/ 00337000
*                                                                  0260 00338000
*                    TITIME(1:4) = TIME(1:4);                      0260 00339000
         L     @10,@PC00001+4                                      0260 00340000
         MVC   TITIME(4,@10),TIME                                  0260 00341000
*                  END;                                            0261 00342000
*                ELSE                                              0262 00343000
*                  DO;                                             0262 00344000
*                                                                  0262 00345000
         B     @RC00254                                            0262 00346000
@RF00254 DS    0H                                                  0263 00347000
*                    /************************************************/ 00348000
*                    /*                                              */ 00349000
*                    /* OBTAIN PACKED DECIMAL DATE AND TIME IN       */ 00350000
*                    /* MICROSECONDS BY ISSUING THE MIC FORM OF THE  */ 00351000
*                    /* TIME MACRO.                                  */ 00352000
*                    /*                                              */ 00353000
*                    /************************************************/ 00354000
*                                                                  0263 00355000
*                    RESPECIFY (REG1) RSTD;                        0263 00356000
*LTIME2:             GEN(TIME  MIC,DBLWORD);                       0264 00357000
*                                                                  0264 00358000
LTIME2   TIME  MIC,DBLWORD                                              00359000
*                    /************************************************/ 00360000
*                    /*                                              */ 00361000
*                    /* INSERT TIME IN MICROSECONDS INTO TITIME      */ 00362000
*                    /* FOR USER.                                    */ 00363000
*                    /*                                              */ 00364000
*                    /************************************************/ 00365000
*                                                                  0265 00366000
*                    TITIME = DBLWORD;                             0265 00367000
         L     @10,@PC00001+4                                      0265 00368000
         MVC   TITIME(8,@10),DBLWORD                               0265 00369000
*                    IF TILN = 4 & TIFORM = CLOCK                  0266 00370000
*                      THEN                                        0266 00371000
*                                                                  0266 00372000
         L     @10,@PC00001+16                                     0266 00373000
         CLI   TILN(@10),4                                         0266 00374000
         BNE   @RF00266                                            0266 00375000
         L     @10,@PC00001+12                                     0266 00376000
         CLC   TIFORM(4,@10),@CC00143                              0266 00377000
         BNE   @RF00266                                            0266 00378000
*                        /********************************************/ 00379000
*                        /*                                          */ 00380000
*                        /* OBTAIN THE TIME OF DAY IN MICRO          */ 00381000
*                        /* SECONDS BY ISSUING A STORE CLOCK         */ 00382000
*                        /* INSTRUCTION AND INSERTING IT             */ 00383000
*                        /* INTO TITIME FOR THE USER.                */ 00384000
*                        /*                                          */ 00385000
*                        /********************************************/ 00386000
*                                                                  0267 00387000
*                        GEN(STCK  DBLWORD);                       0267 00388000
         STCK  DBLWORD                                                  00389000
*                        TITIME = DBLWORD;                         0268 00390000
@RF00266 L     @10,@PC00001+4                                      0268 00391000
         MVC   TITIME(8,@10),DBLWORD                               0268 00392000
*                  END;                                            0269 00393000
*                                                                  0269 00394000
*              /******************************************************/ 00395000
*              /*                                                    */ 00396000
*              /* INSERT DATE IN PACKED DECIMAL (00YYDDDF) INTO THE  */ 00397000
*              /* UTIME DATE VARIABLE TIDATE IF ASKED FOR, WHERE     */ 00398000
*              /* F IS THE SIGN CHARACTER                            */ 00399000
*              /*                                                    */ 00400000
*              /******************************************************/ 00401000
*                                                                  0270 00402000
*              IF TILN ^= 2                                        0270 00403000
*                THEN                                              0270 00404000
@RC00254 L     @10,@PC00001+16                                     0270 00405000
         CLI   TILN(@10),2                                         0270 00406000
         BE    @RF00270                                            0270 00407000
*                  DO;                                             0271 00408000
*                    GEN(ST    REG1,DBLWORD);                      0272 00409000
         ST    REG1,DBLWORD                                             00410000
*                    RESPECIFY (REG1) UNRSTD;                      0273 00411000
*                    TIDATE(1:4) = DBLWORD(1:4);                   0274 00412000
         L     @10,@PC00001+8                                      0274 00413000
         MVC   TIDATE(4,@10),DBLWORD                               0274 00414000
*                  END;                                            0275 00415000
*            END;                                                  0276 00416000
*                                                                  0276 00417000
@RF00270 DS    0H                                                  0277 00418000
*        /************************************************************/ 00419000
*        /*                                                          */ 00420000
*        /* RETURN CONTROL TO THE CALLER                             */ 00421000
*        /*                                                          */ 00422000
*        /************************************************************/ 00423000
*                                                                  0277 00424000
*        CALL ICKSAEP0(GDTTBL,MODID);                              0277 00425000
@RC00206 ST    GDTPR,@AL00001                                      0277 00426000
         LA    @10,MODID                                           0277 00427000
         ST    @10,@AL00001+4                                      0277 00428000
         MVI   @AL00001+4,X'80'                                    0277 00429000
         L     @15,GDTEPL(,GDTPR)                                  0277 00430000
         LA    @01,@AL00001                                        0277 00431000
         BALR  @14,@15                                             0277 00432000
*        RESPECIFY (GDTPR) UNRSTD;                                 0278 00433000
*        END ICKSA05                                               0279 00434000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00435000
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        * 00436000
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        * 00437000
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        * 00438000
*;                                                                 0279 00439000
@EL00001 L     @13,4(,@13)                                         0279 00440000
@EF00001 L     @00,@SIZDATD                                        0279 00441000
         LR    @01,@11                                             0279 00442000
         FREEMAIN R,LV=(0),A=(1)                                        00443000
@ER00001 LM    @14,@12,12(@13)                                     0279 00444000
         BR    @14                                                 0279 00445000
@DATA    DS    0H                                                       00446000
@DATD    DSECT                                                          00447000
         DS    0F                                                       00448000
@SA00001 DS    18F                                                      00449000
@PC00001 DS    5F                                                       00450000
@AL00001 DS    2A                                                       00451000
ICKSA05  CSECT                                                          00452000
         DS    0F                                                       00453000
@CF00165 DC    F'1'                                                     00454000
@CF00044 DC    F'4'                                                     00455000
@CF00263 DC    F'11'                                                    00456000
@DATD    DSECT                                                          00457000
         DS    0D                                                       00458000
LISTSCAN DS    A                                                        00459000
IOCSPTR  DS    A                                                        00460000
OPNPTR   DS    A                                                        00461000
DDSTRU   DS    A                                                        00462000
FSADDR   DS    A                                                        00463000
DMPINDEX DS    A                                                        00464000
LISTPTR  DS    A                                                        00465000
SETRC    DS    H                                                        00466000
TESTRC   DS    H                                                        00467000
LISTLN   DS    FL1                                                      00468000
@TS00001 DS    CL95                                                     00469000
TIME     DS    CL9                                                      00470000
         DS    CL7                                                      00471000
DATETEMP DS    CL8                                                      00472000
DBLWORD  DS    CL8                                                      00473000
MONTO    DS    CL11                                                     00474000
         ORG   MONTO                                                    00475000
MTHS     DS    11AL1                                                    00476000
         ORG   MONTO+11                                                 00477000
         DS    CL1                                                      00478000
@NM00019 DS    CL6                                                      00479000
         ORG   @NM00019                                                 00480000
DAY      DS    FL2                                                      00481000
MONTH    DS    FL2                                                      00482000
YEAR     DS    FL2                                                      00483000
         ORG   @NM00019+6                                               00484000
DOCNTRL  DS    BL1                                                      00485000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00486000
@ENDDATD EQU   *                                                        00487000
ICKSA05  CSECT                                                          00488000
         DS    0F                                                       00489000
@SIZDATD DC    AL1(0)                                                   00490000
         DC    AL3(@ENDDATD-@DATD)                                      00491000
         DS    0D                                                       00492000
@CC00139 DC    C'FORM'                                                  00493000
@CC00141 DC    C'HSEC'                                                  00494000
@CC00143 DC    C'KLOK'                                                  00495000
@CC00481 DC    C'SA05'                                                  00496000
FIXAREA  DS    CL100                                                    00497000
         ORG   FIXAREA                                                  00498000
@NM00018 DC    100X'00'                                                 00499000
         ORG   FIXAREA+100                                              00500000
MODID    DC    CL4'SA05'                                                00501000
MONFROM  DS    CL11                                                     00502000
         ORG   MONFROM                                                  00503000
MINIT    DC    AL1(31)                                                  00504000
         DC    AL1(28)                                                  00505000
         DC    AL1(31)                                                  00506000
         DC    AL1(30)                                                  00507000
         DC    AL1(31)                                                  00508000
         DC    AL1(30)                                                  00509000
         DC    AL1(31)                                                  00510000
         DC    AL1(31)                                                  00511000
         DC    AL1(30)                                                  00512000
         DC    AL1(31)                                                  00513000
         DC    AL1(30)                                                  00514000
         ORG   MONFROM+11                                               00515000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00516000
@01      EQU   01                                                       00517000
@02      EQU   02                                                       00518000
@03      EQU   03                                                       00519000
@04      EQU   04                                                       00520000
@05      EQU   05                                                       00521000
@06      EQU   06                                                       00522000
@07      EQU   07                                                       00523000
@08      EQU   08                                                       00524000
@09      EQU   09                                                       00525000
@10      EQU   10                                                       00526000
@11      EQU   11                                                       00527000
@12      EQU   12                                                       00528000
@13      EQU   13                                                       00529000
@14      EQU   14                                                       00530000
@15      EQU   15                                                       00531000
I        EQU   @02                                                      00532000
REG0     EQU   @00                                                      00533000
REG1     EQU   @01                                                      00534000
REG13    EQU   @13                                                      00535000
REG14    EQU   @14                                                      00536000
REG15    EQU   @15                                                      00537000
GDTPR    EQU   @09                                                      00538000
REG10    EQU   @10                                                      00539000
REG11    EQU   @11                                                      00540000
REG12    EQU   @12                                                      00541000
REG2     EQU   @02                                                      00542000
REG3     EQU   @03                                                      00543000
REG4     EQU   @04                                                      00544000
REG5     EQU   @05                                                      00545000
REG6     EQU   @06                                                      00546000
REG7     EQU   @07                                                      00547000
REG8     EQU   @08                                                      00548000
REG9     EQU   @09                                                      00549000
RTNREG   EQU   @15                                                      00550000
GDTTBL   EQU   0                                                        00551000
GDTTR1   EQU   GDTTBL+8                                                 00552000
GDTTR2   EQU   GDTTBL+12                                                00553000
GDTDIN   EQU   GDTTBL+44                                                00554000
GDTDOP   EQU   GDTTBL+48                                                00555000
GDTDBG   EQU   GDTTBL+52                                                00556000
GDTDVO   EQU   GDTTBL+56                                                00557000
GDTPRT   EQU   GDTTBL+60                                                00558000
GDTESS   EQU   GDTTBL+64                                                00559000
GDTESA   EQU   GDTTBL+68                                                00560000
GDTRST   EQU   GDTTBL+72                                                00561000
GDTRES   EQU   GDTTBL+76                                                00562000
GDTCAL   EQU   GDTTBL+80                                                00563000
GDTGSP   EQU   GDTTBL+84                                                00564000
GDTFSP   EQU   GDTTBL+88                                                00565000
GDTGPL   EQU   GDTTBL+92                                                00566000
GDTFPL   EQU   GDTTBL+96                                                00567000
GDTLOD   EQU   GDTTBL+100                                               00568000
GDTDEL   EQU   GDTTBL+104                                               00569000
GDTPRL   EQU   GDTTBL+108                                               00570000
GDTEPL   EQU   GDTTBL+112                                               00571000
GDTTIM   EQU   GDTTBL+116                                               00572000
GDTIIO   EQU   GDTTBL+120                                               00573000
GDTTIO   EQU   GDTTBL+124                                               00574000
GDTOPN   EQU   GDTTBL+136                                               00575000
GDTCLS   EQU   GDTTBL+140                                               00576000
GDTGET   EQU   GDTTBL+144                                               00577000
GDTPUT   EQU   GDTTBL+148                                               00578000
GDTABT   EQU   GDTTBL+152                                               00579000
GDTABH   EQU   GDTTBL+156                                               00580000
GDTSNP   EQU   GDTTBL+160                                               00581000
GDTWTO   EQU   GDTTBL+168                                               00582000
GDTSCR   EQU   GDTTBL+172                                               00583000
GDTVCK   EQU   GDTTBL+176                                               00584000
GDTDVC   EQU   GDTTBL+180                                               00585000
GDTSTE   EQU   GDTTBL+188                                               00586000
ICKSAEP0 EQU   0                                                        00587000
TRACE1   EQU   0                                                        00588000
OLDERID1 EQU   TRACE1                                                   00589000
TRACE2   EQU   0                                                        00590000
OLDERID2 EQU   TRACE2                                                   00591000
NEWID2   EQU   TRACE2+95                                                00592000
NEWERID2 EQU   5                                                        00593000
STAEPARM EQU   0                                                        00594000
STAEPFX  EQU   STAEPARM                                                 00595000
IOCSTR   EQU   0                                                        00596000
IOCDSO   EQU   IOCSTR+13                                                00597000
IOCRFM   EQU   IOCSTR+14                                                00598000
IOCMAC   EQU   IOCSTR+15                                                00599000
IOCMSG   EQU   IOCSTR+16                                                00600000
OPNAGL   EQU   0                                                        00601000
OPNOPT   EQU   OPNAGL                                                   00602000
OPNRFM   EQU   OPNAGL+1                                                 00603000
OPNTYP   EQU   OPNAGL+2                                                 00604000
OPNMOD   EQU   OPNAGL+3                                                 00605000
UVOLLIST EQU   0                                                        00606000
UVOLENT  EQU   UVOLLIST+2                                               00607000
DARGLIST EQU   0                                                        00608000
DARGSTID EQU   DARGLIST+8                                               00609000
DARGARY  EQU   DARGLIST+20                                              00610000
DARGINS  EQU   DARGARY                                                  00611000
DARGINL  EQU   DARGARY+2                                                00612000
FMTLIST  EQU   0                                                        00613000
FMTFLGS  EQU   FMTLIST                                                  00614000
FMTSPF   EQU   FMTLIST+2                                                00615000
FMTRFNO  EQU   FMTSPF                                                   00616000
FMTILEN  EQU   FMTRFNO                                                  00617000
FMTIOFF  EQU   FMTLIST+4                                                00618000
FMTTRBC  EQU   FMTIOFF                                                  00619000
FMTSTO   EQU   FMTTRBC                                                  00620000
FMTOCOL  EQU   FMTLIST+6                                                00621000
FMTCNVF  EQU   FMTLIST+10                                               00622000
DMPITM   EQU   0                                                        00623000
DMPARY   EQU   0                                                        00624000
DMPTRM   EQU   0                                                        00625000
ICKDB010 EQU   0                                                        00626000
ICKDVCL0 EQU   0                                                        00627000
ICKDVIN0 EQU   0                                                        00628000
ICKDVON0 EQU   0                                                        00629000
ICKDVOP0 EQU   0                                                        00630000
ICKIOCL0 EQU   0                                                        00631000
ICKIOGT0 EQU   0                                                        00632000
ICKIOIT0 EQU   0                                                        00633000
ICKIOOP0 EQU   0                                                        00634000
ICKIOPT0 EQU   0                                                        00635000
ICKIOTM0 EQU   0                                                        00636000
ICKSACL0 EQU   0                                                        00637000
ICKSADE0 EQU   0                                                        00638000
ICKSAFP0 EQU   0                                                        00639000
ICKSAFS0 EQU   0                                                        00640000
ICKSAGP0 EQU   0                                                        00641000
ICKSAGS0 EQU   0                                                        00642000
ICKSALD0 EQU   0                                                        00643000
ICKSAPR0 EQU   0                                                        00644000
ICKSASC0 EQU   0                                                        00645000
ICKSASN0 EQU   0                                                        00646000
ICKSAST0 EQU   0                                                        00647000
ICKSATI0 EQU   0                                                        00648000
ICKSAVC0 EQU   0                                                        00649000
ICKSAWO0 EQU   0                                                        00650000
ICKTPEA0 EQU   0                                                        00651000
ICKTPES0 EQU   0                                                        00652000
ICKTPPR0 EQU   0                                                        00653000
ICKTPRE0 EQU   0                                                        00654000
ICKTPRS0 EQU   0                                                        00655000
LISTTEST EQU   0                                                        00656000
NEWERID1 EQU   5                                                        00657000
GDTTBLX  EQU   0                                                        00658000
TITIME   EQU   0                                                        00659000
TIDATE   EQU   0                                                        00660000
TIFORM   EQU   0                                                        00661000
TILN     EQU   0                                                        00662000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00663000
@NM00017 EQU   DMPARY+15                                                00664000
DMPARYTP EQU   DMPARY+14                                                00665000
DMPARYEX EQU   DMPARY+12                                                00666000
DMPARYIC EQU   DMPARY+10                                                00667000
DMPARYSZ EQU   DMPARY+8                                                 00668000
DMPARYNM EQU   DMPARY                                                   00669000
@NM00016 EQU   DMPITM+15                                                00670000
DMPITMTP EQU   DMPITM+14                                                00671000
DMPITMLN EQU   DMPITM+12                                                00672000
DMPITMPT EQU   DMPITM+8                                                 00673000
DMPITMNM EQU   DMPITM                                                   00674000
@NM00015 EQU   FMTCNVF+1                                                00675000
FMTBS    EQU   FMTCNVF+1                                                00676000
FMTSS    EQU   FMTCNVF+1                                                00677000
FMTAL    EQU   FMTCNVF+1                                                00678000
FMTZS    EQU   FMTCNVF+1                                                00679000
@NM00014 EQU   FMTCNVF                                                  00680000
FMTPU    EQU   FMTCNVF                                                  00681000
FMTBD    EQU   FMTCNVF                                                  00682000
FMTBHD   EQU   FMTCNVF                                                  00683000
FMTBHA   EQU   FMTCNVF                                                  00684000
FMTBH    EQU   FMTCNVF                                                  00685000
FMTOLEN  EQU   FMTLIST+8                                                00686000
FMTRIO   EQU   FMTOCOL                                                  00687000
FMTSPT   EQU   FMTSTO                                                   00688000
FMTSTL   EQU   FMTILEN                                                  00689000
@NM00013 EQU   FMTFLGS+1                                                00690000
FMTHDF   EQU   FMTFLGS                                                  00691000
FMTDFF   EQU   FMTFLGS                                                  00692000
FMTSTF   EQU   FMTFLGS                                                  00693000
FMTREPF  EQU   FMTFLGS                                                  00694000
FMTBDF   EQU   FMTFLGS                                                  00695000
FMTIDF   EQU   FMTFLGS                                                  00696000
FMTSCF   EQU   FMTFLGS                                                  00697000
FMTEOLF  EQU   FMTFLGS                                                  00698000
DARGDTM  EQU   DARGARY+4                                                00699000
DARGPCT  EQU   DARGINL                                                  00700000
DARGREP  EQU   DARGINS                                                  00701000
@NM00012 EQU   DARGLIST+19                                              00702000
DARGIND  EQU   DARGLIST+18                                              00703000
DARGRETL EQU   DARGLIST+16                                              00704000
DARGCNT  EQU   DARGLIST+14                                              00705000
DARGILP  EQU   DARGLIST+12                                              00706000
DARGSENT EQU   DARGSTID+3                                               00707000
DARGSMOD EQU   DARGSTID                                                 00708000
DARGRETP EQU   DARGLIST+4                                               00709000
DARGDBP  EQU   DARGLIST                                                 00710000
UVOLVOL  EQU   UVOLENT+4                                                00711000
UVOLDEV  EQU   UVOLENT                                                  00712000
UVOLCNT  EQU   UVOLLIST                                                 00713000
OPNRSVD  EQU   OPNAGL+28                                                00714000
OPNVOL   EQU   OPNAGL+24                                                00715000
OPNBLK   EQU   OPNAGL+20                                                00716000
OPNREC   EQU   OPNAGL+16                                                00717000
OPNDSN   EQU   OPNAGL+12                                                00718000
OPNDDN   EQU   OPNAGL+8                                                 00719000
OPNIOC   EQU   OPNAGL+4                                                 00720000
@NM00011 EQU   OPNMOD                                                   00721000
OPNMODRC EQU   OPNMOD                                                   00722000
OPNMODAC EQU   OPNMOD                                                   00723000
@NM00010 EQU   OPNTYP                                                   00724000
OPNTYPSO EQU   OPNTYP                                                   00725000
OPNTYPSI EQU   OPNTYP                                                   00726000
@NM00009 EQU   OPNRFM                                                   00727000
OPNRFMBK EQU   OPNRFM                                                   00728000
OPNRFMSF EQU   OPNRFM                                                   00729000
OPNRFMUN EQU   OPNRFM                                                   00730000
OPNRFMVR EQU   OPNRFM                                                   00731000
OPNRFMFX EQU   OPNRFM                                                   00732000
@NM00008 EQU   OPNOPT                                                   00733000
OPNOPTJM EQU   OPNOPT                                                   00734000
OPNOPTKS EQU   OPNOPT                                                   00735000
OPNOPTBK EQU   OPNOPT                                                   00736000
OPNOPTUP EQU   OPNOPT                                                   00737000
OPNOPTOT EQU   OPNOPT                                                   00738000
OPNOPTIN EQU   OPNOPT                                                   00739000
IOCEXT   EQU   IOCSTR+36                                                00740000
IOCRRN   EQU   IOCSTR+32                                                00741000
@NM00007 EQU   IOCSTR+30                                                00742000
IOCPNM   EQU   IOCSTR+28                                                00743000
IOCCBP   EQU   IOCSTR+24                                                00744000
IOCDSN   EQU   IOCSTR+20                                                00745000
@NM00006 EQU   IOCSTR+17                                                00746000
@NM00005 EQU   IOCMSG                                                   00747000
IOCMSGOP EQU   IOCMSG                                                   00748000
IOCMACPA EQU   IOCMAC                                                   00749000
@NM00004 EQU   IOCMAC                                                   00750000
IOCMACBK EQU   IOCMAC                                                   00751000
IOCMACUP EQU   IOCMAC                                                   00752000
IOCMACOT EQU   IOCMAC                                                   00753000
IOCMACIN EQU   IOCMAC                                                   00754000
@NM00003 EQU   IOCRFM                                                   00755000
IOCRFMBK EQU   IOCRFM                                                   00756000
IOCRFMSF EQU   IOCRFM                                                   00757000
IOCRFMUN EQU   IOCRFM                                                   00758000
IOCRFMVR EQU   IOCRFM                                                   00759000
IOCRFMFX EQU   IOCRFM                                                   00760000
@NM00002 EQU   IOCDSO                                                   00761000
IOCDSOPS EQU   IOCDSO                                                   00762000
IOCKYL   EQU   IOCSTR+12                                                00763000
IOCTRN   EQU   IOCSTR+8                                                 00764000
IOCDLN   EQU   IOCSTR+4                                                 00765000
IOCDAD   EQU   IOCSTR                                                   00766000
STAEWORK EQU   STAEPARM+32                                              00767000
STARPTR  EQU   STAEPFX+28                                               00768000
STASPTR  EQU   STAEPFX+24                                               00769000
STALEN   EQU   STAEPFX+20                                               00770000
STAID    EQU   STAEPFX+16                                               00771000
STAEPA   EQU   STAEPFX+12                                               00772000
STAGDT   EQU   STAEPFX+8                                                00773000
STABPTR  EQU   STAEPFX+4                                                00774000
STAFPTR  EQU   STAEPFX                                                  00775000
NEWID1   EQU   TRACE1+95                                                00776000
CALLID   EQU   OLDERID1+90                                              00777000
@NM00001 EQU   OLDERID1                                                 00778000
GDTCVR   EQU   GDTTBL+184                                               00779000
GDTSPR   EQU   GDTTBL+164                                               00780000
GDTTOH   EQU   GDTTBL+132                                               00781000
GDTRIP   EQU   GDTTBL+128                                               00782000
GDTDVH   EQU   GDTTBL+40                                                00783000
GDTIOH   EQU   GDTTBL+36                                                00784000
GDTSAH   EQU   GDTTBL+32                                                00785000
GDTTPH   EQU   GDTTBL+28                                                00786000
GDTRIH   EQU   GDTTBL+24                                                00787000
GDTSTH   EQU   GDTTBL+20                                                00788000
GDTDBH   EQU   GDTTBL+16                                                00789000
GDTPRM   EQU   GDTTBL+4                                                 00790000
GDTHDR   EQU   GDTTBL                                                   00791000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00792000
@ENDDATA EQU   *                                                        00793000
         END   ICKSA05,(C'PLS1906',0701,78192)                          00794000
