         TITLE '          **********  ICKTP01 - FORMAT MODULE  *********00001000
               ***      '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
ICKTP01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL2(@EP00002-@MAINENT)                                   00017000
         DC    AL1(16)                                             0002 00018000
         DC    C'ICKTP01   78.192'                                 0002 00019000
ICKTPES  DS    0H                                                  0002 00020000
         USING *,@15                                               0002 00021000
         B     @PROLOG                                             0002 00022000
         DC    AL2(@EP00276-ICKTPES)                                    00023000
         ENTRY ICKTPES                                                  00024000
ICKTPEA  DS    0H                                                  0002 00025000
         USING *,@15                                               0002 00026000
         B     @PROLOG                                             0002 00027000
         DC    AL2(@EP00283-ICKTPEA)                                    00028000
         ENTRY ICKTPEA                                                  00029000
ICKTPRS  DS    0H                                                  0002 00030000
         USING *,@15                                               0002 00031000
         B     @PROLOG                                             0002 00032000
         DC    AL2(@EP00290-ICKTPRS)                                    00033000
         ENTRY ICKTPRS                                                  00034000
ICKTPRE  DS    0H                                                  0002 00035000
         USING *,@15                                               0002 00036000
         B     @PROLOG                                             0002 00037000
         DC    AL2(@EP00297-ICKTPRE)                                    00038000
         ENTRY ICKTPRE                                                  00039000
ICKTPPR  DS    0H                                                  0002 00040000
         USING *,@15                                               0002 00041000
         B     @PROLOG                                             0002 00042000
         DC    AL2(@EP00304-ICKTPPR)                                    00043000
         ENTRY ICKTPPR                                                  00044000
         DROP  @15                                                      00045000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00046000
         BALR  @10,0                                               0002 00047000
@PSTART  LA    @11,4095(,@10)                                      0002 00048000
         LA    @12,4095(,@11)                                      0002 00049000
         USING @PSTART,@10                                         0002 00050000
         USING @PSTART+4095,@11                                    0002 00051000
         USING @PSTART+8190,@12                                    0002 00052000
         L     @00,@SIZDATD                                        0002 00053000
         GETMAIN  R,LV=(0)                                              00054000
         LR    @08,@01                                             0002 00055000
         USING @DATD,@08                                           0002 00056000
         ST    @13,@SA00001+4                                      0002 00057000
         LM    @15,@01,16(@13)                                     0002 00058000
         ST    @08,8(,@13)                                         0002 00059000
         LR    @13,@08                                             0002 00060000
         AH    @15,4(,@15)                                         0002 00061000
         BR    @15                                                 0002 00062000
@EP00002 DS    0H                                                  0003 00063000
*                                                                  0275 00064000
*        /* ENTRY POINT FOR THE ESTS MACRO.                         */  00065000
*                                                                  0276 00066000
*ICKTPES: ENTRY (GDTTBLX,FILENAME,STIDS);                          0276 00067000
         B     @EC00276                                            0276 00068000
@EP00276 MVC   @PC00001(12),0(@01)                                 0276 00069000
@EC00276 DS    0H                                                  0277 00070000
*        GDTPR = ADDR(GDTTBLX);                                    0277 00071000
         L     GDTPR,@PC00001                                      0277 00072000
*        CALL ICKSACL0 (GDTTBLX,TP04ENT,ESTSARG,FILENAME,STIDS);   0278 00073000
         L     @06,@PC00001                                        0278 00074000
         ST    @06,@AL00001                                        0278 00075000
         LA    @06,TP04ENT                                         0278 00076000
         ST    @06,@AL00001+4                                      0278 00077000
         LA    @06,ESTSARG                                         0278 00078000
         ST    @06,@AL00001+8                                      0278 00079000
         L     @06,@PC00001+4                                      0278 00080000
         ST    @06,@AL00001+12                                     0278 00081000
         L     @06,@PC00001+8                                      0278 00082000
         ST    @06,@AL00001+16                                     0278 00083000
         MVI   @AL00001+16,X'80'                                   0278 00084000
         L     @15,GDTCAL(,GDTPR)                                  0278 00085000
         LA    @01,@AL00001                                        0278 00086000
         BALR  @14,@15                                             0278 00087000
*        RESPECIFY RTNREG RSTD;                                    0279 00088000
*        TESTRC = RTNREG;                                          0280 00089000
         STH   RTNREG,TESTRC                                       0280 00090000
*        RESPECIFY RTNREG UNRSTD;                                  0281 00091000
*        CALL ICKSAEP0(GDTTBL,MODID,TESTRC);                       0282 00092000
*                                                                  0282 00093000
         ST    GDTPR,@AL00001                                      0282 00094000
         LA    @06,MODID                                           0282 00095000
         ST    @06,@AL00001+4                                      0282 00096000
         LA    @06,TESTRC                                          0282 00097000
         ST    @06,@AL00001+8                                      0282 00098000
         MVI   @AL00001+8,X'80'                                    0282 00099000
         L     @15,GDTEPL(,GDTPR)                                  0282 00100000
         LA    @01,@AL00001                                        0282 00101000
         BALR  @14,@15                                             0282 00102000
*        /* ENTRY POINT FOR THE ESTA MACRO.                         */  00103000
*                                                                  0283 00104000
*ICKTPEA: ENTRY (GDTTBLX,FILENAME,PCALIST);                        0283 00105000
         B     @EC00283                                            0283 00106000
@EP00283 MVC   @PC00001(8),0(@01)                                  0283 00107000
         MVC   @PC00001+12(4),8(@01)                               0283 00108000
@EC00283 DS    0H                                                  0284 00109000
*        GDTPR = ADDR(GDTTBLX);                                    0284 00110000
         L     GDTPR,@PC00001                                      0284 00111000
*        CALL ICKSACL0 (GDTTBLX,TP04ENT,ESTAARG,FILENAME,PCALIST); 0285 00112000
         L     @06,@PC00001                                        0285 00113000
         ST    @06,@AL00001                                        0285 00114000
         LA    @06,TP04ENT                                         0285 00115000
         ST    @06,@AL00001+4                                      0285 00116000
         LA    @06,ESTAARG                                         0285 00117000
         ST    @06,@AL00001+8                                      0285 00118000
         L     @06,@PC00001+4                                      0285 00119000
         ST    @06,@AL00001+12                                     0285 00120000
         L     @06,@PC00001+12                                     0285 00121000
         ST    @06,@AL00001+16                                     0285 00122000
         MVI   @AL00001+16,X'80'                                   0285 00123000
         L     @15,GDTCAL(,GDTPR)                                  0285 00124000
         LA    @01,@AL00001                                        0285 00125000
         BALR  @14,@15                                             0285 00126000
*        RESPECIFY RTNREG RSTD;                                    0286 00127000
*        TESTRC = RTNREG;                                          0287 00128000
         STH   RTNREG,TESTRC                                       0287 00129000
*        RESPECIFY RTNREG UNRSTD;                                  0288 00130000
*        CALL ICKSAEP0(GDTTBL,MODID,TESTRC);                       0289 00131000
*                                                                  0289 00132000
         ST    GDTPR,@AL00001                                      0289 00133000
         LA    @06,MODID                                           0289 00134000
         ST    @06,@AL00001+4                                      0289 00135000
         LA    @06,TESTRC                                          0289 00136000
         ST    @06,@AL00001+8                                      0289 00137000
         MVI   @AL00001+8,X'80'                                    0289 00138000
         L     @15,GDTEPL(,GDTPR)                                  0289 00139000
         LA    @01,@AL00001                                        0289 00140000
         BALR  @14,@15                                             0289 00141000
*        /* ENTRY POINT FOR THE REST MACRO.                         */  00142000
*ICKTPRS: ENTRY (GDTTBLX,FILENAME,PTR1,PTR2,PTR3,PTR4,PTR5,PTR6,PTR7);  00143000
         B     @EC00290                                            0290 00144000
@EP00290 MVC   @PC00001(8),0(@01)                                  0290 00145000
         MVC   @PC00001+16(28),8(@01)                              0290 00146000
@EC00290 DS    0H                                                  0291 00147000
*        GDTPR = ADDR(GDTTBLX);                                    0291 00148000
         L     GDTPR,@PC00001                                      0291 00149000
*        CALL ICKSACL0 (GDTTBLX,TP04ENT,RESTARG,FILENAME,PTR1,PTR2,PTR3 00150000
*PTR4,                                                             0292 00151000
*        PTR5,PTR6,PTR7);                                          0292 00152000
         L     @06,@PC00001                                        0292 00153000
         ST    @06,@AL00001                                        0292 00154000
         LA    @06,TP04ENT                                         0292 00155000
         ST    @06,@AL00001+4                                      0292 00156000
         LA    @06,RESTARG                                         0292 00157000
         ST    @06,@AL00001+8                                      0292 00158000
         L     @06,@PC00001+4                                      0292 00159000
         ST    @06,@AL00001+12                                     0292 00160000
         L     @06,@PC00001+16                                     0292 00161000
         ST    @06,@AL00001+16                                     0292 00162000
         L     @06,@PC00001+20                                     0292 00163000
         ST    @06,@AL00001+20                                     0292 00164000
         L     @06,@PC00001+24                                     0292 00165000
         ST    @06,@AL00001+24                                     0292 00166000
         L     @06,@PC00001+28                                     0292 00167000
         ST    @06,@AL00001+28                                     0292 00168000
         L     @06,@PC00001+32                                     0292 00169000
         ST    @06,@AL00001+32                                     0292 00170000
         L     @06,@PC00001+36                                     0292 00171000
         ST    @06,@AL00001+36                                     0292 00172000
         L     @06,@PC00001+40                                     0292 00173000
         ST    @06,@AL00001+40                                     0292 00174000
         MVI   @AL00001+40,X'80'                                   0292 00175000
         L     @15,GDTCAL(,GDTPR)                                  0292 00176000
         LA    @01,@AL00001                                        0292 00177000
         BALR  @14,@15                                             0292 00178000
*        RESPECIFY RTNREG RSTD;                                    0293 00179000
*        TESTRC = RTNREG;                                          0294 00180000
         STH   RTNREG,TESTRC                                       0294 00181000
*        RESPECIFY RTNREG UNRSTD;                                  0295 00182000
*        CALL ICKSAEP0(GDTTBL,MODID,TESTRC);                       0296 00183000
*                                                                  0296 00184000
         ST    GDTPR,@AL00001                                      0296 00185000
         LA    @06,MODID                                           0296 00186000
         ST    @06,@AL00001+4                                      0296 00187000
         LA    @06,TESTRC                                          0296 00188000
         ST    @06,@AL00001+8                                      0296 00189000
         MVI   @AL00001+8,X'80'                                    0296 00190000
         L     @15,GDTEPL(,GDTPR)                                  0296 00191000
         LA    @01,@AL00001                                        0296 00192000
         BALR  @14,@15                                             0296 00193000
*        /* ENTRY POINT FOR THE RESET MACRO.                        */  00194000
*                                                                  0297 00195000
*ICKTPRE: ENTRY (GDTTBLX,FILENAME,PGNOPTR);                        0297 00196000
         B     @EC00297                                            0297 00197000
@EP00297 MVC   @PC00001(8),0(@01)                                  0297 00198000
         MVC   @PC00001+44(4),8(@01)                               0297 00199000
@EC00297 DS    0H                                                  0298 00200000
*        GDTPR = ADDR(GDTTBLX);                                    0298 00201000
         L     GDTPR,@PC00001                                      0298 00202000
*        CALL ICKSACL0 (GDTTBLX,TP04ENT,RSETARG,FILENAME,PGNOPTR); 0299 00203000
         L     @06,@PC00001                                        0299 00204000
         ST    @06,@AL00001                                        0299 00205000
         LA    @06,TP04ENT                                         0299 00206000
         ST    @06,@AL00001+4                                      0299 00207000
         LA    @06,RSETARG                                         0299 00208000
         ST    @06,@AL00001+8                                      0299 00209000
         L     @06,@PC00001+4                                      0299 00210000
         ST    @06,@AL00001+12                                     0299 00211000
         L     @06,@PC00001+44                                     0299 00212000
         ST    @06,@AL00001+16                                     0299 00213000
         MVI   @AL00001+16,X'80'                                   0299 00214000
         L     @15,GDTCAL(,GDTPR)                                  0299 00215000
         LA    @01,@AL00001                                        0299 00216000
         BALR  @14,@15                                             0299 00217000
*        RESPECIFY RTNREG RSTD;                                    0300 00218000
*        TESTRC = RTNREG;                                          0301 00219000
         STH   RTNREG,TESTRC                                       0301 00220000
*        RESPECIFY RTNREG UNRSTD;                                  0302 00221000
*        CALL ICKSAEP0(GDTTBL,MODID,TESTRC);                       0303 00222000
         ST    GDTPR,@AL00001                                      0303 00223000
         LA    @06,MODID                                           0303 00224000
         ST    @06,@AL00001+4                                      0303 00225000
         LA    @06,TESTRC                                          0303 00226000
         ST    @06,@AL00001+8                                      0303 00227000
         MVI   @AL00001+8,X'80'                                    0303 00228000
         L     @15,GDTEPL(,GDTPR)                                  0303 00229000
         LA    @01,@AL00001                                        0303 00230000
         BALR  @14,@15                                             0303 00231000
*         /***********************************************************/ 00232000
*         /*                                                         */ 00233000
*         /* THE RUNNING CODE BEGINS HERE.  FIRST, WE MUST SET UP    */ 00234000
*         /* WORKING STORAGE.                                        */ 00235000
*         /*                                                         */ 00236000
*         /***********************************************************/ 00237000
*                                                                  0304 00238000
*ICKTPPR: ENTRY (GDTTBLX,FILENAME,DDPTR,FMPTR);                    0304 00239000
*                                                                  0304 00240000
*                                                                  0304 00241000
         B     @EC00304                                            0304 00242000
@EP00304 MVC   @PC00001(8),0(@01)                                  0304 00243000
         MVC   @PC00001+48(8),8(@01)                               0304 00244000
@EC00304 DS    0H                                                  0305 00245000
*                                                                  0305 00246000
*        /************************************************************/ 00247000
*        /*                                                          */ 00248000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 00249000
*        /*                                                          */ 00250000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 00251000
*        /*              TO THIS ROUTINE                             */ 00252000
*        /*                                                          */ 00253000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 00254000
*        /*               ADDRESS LIST                               */ 00255000
*        /*                                                          */ 00256000
*        /************************************************************/ 00257000
*                                                                  0305 00258000
*        GEN;                                                      0305 00259000
        ST    1,LISTPTR                                                 00260000
        ST    1,LISTSCAN                                                00261000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0306 00262000
         LA    @06,1                                               0306 00263000
         STC   @06,LISTLN                                          0306 00264000
@DL00306 L     @03,LISTSCAN                                        0306 00265000
         TM    LISTTEST(@03),B'10000000'                           0306 00266000
         BNZ   @DC00306                                            0306 00267000
*          LISTSCAN = LISTSCAN + 4;                                0307 00268000
         AL    @03,@CF00036                                        0307 00269000
         ST    @03,LISTSCAN                                        0307 00270000
*        END;                                                      0308 00271000
*                                                                  0308 00272000
*                                                                  0308 00273000
         AL    @06,@CF00160                                        0308 00274000
         STC   @06,LISTLN                                          0308 00275000
         C     @06,@CF00779                                        0308 00276000
         BNH   @DL00306                                            0308 00277000
@DC00306 DS    0H                                                  0309 00278000
*         GDTPR = ADDR(GDTTBLX);                                   0309 00279000
         L     GDTPR,@PC00001                                      0309 00280000
*         IF GDTTPH = NULLPTR                                      0310 00281000
*           THEN                                                   0310 00282000
         L     @06,GDTTPH(,GDTPR)                                  0310 00283000
         LTR   @06,@06                                             0310 00284000
         BNZ   @RF00310                                            0310 00285000
*             /*******************************************************/ 00286000
*             /*                                                     */ 00287000
*             /* AN ENTRY AT THIS POINT WITHOUT A PCT POINTER IS     */ 00288000
*             /* A CATASTROPHE.                                      */ 00289000
*             /*                                                     */ 00290000
*             /*******************************************************/ 00291000
*                                                                  0311 00292000
*                                                                  0311 00293000
*             DO;                                                  0311 00294000
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 0312 00295000
*               REG15 = 24;                                        0313 00296000
         LA    REG15,24                                            0313 00297000
*               REG14 = GDTABT;                                    0314 00298000
         L     REG14,GDTABT(,GDTPR)                                0314 00299000
*               REG13 = GDTABH;                                    0315 00300000
         L     REG13,GDTABH(,GDTPR)                                0315 00301000
*               GEN(BR    REG14);                                  0316 00302000
         BR    REG14                                                    00303000
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                0317 00304000
*             END;                                                 0318 00305000
*                                                                  0318 00306000
*         DDSTRU = DDPTR;                                          0319 00307000
@RF00310 L     @04,@PC00001+48                                     0319 00308000
         L     DDSTRU,DDPTR(,@04)                                  0319 00309000
*         PCTPTR = GDTTPH;              /* SET LOCAL PCT PTR.        */ 00310000
         L     PCTPTR,GDTTPH(,GDTPR)                               0320 00311000
*         IF PCTSPP ^= NULLPTR                                     0321 00312000
*           THEN                                                   0321 00313000
         L     @04,PCTSPP(,PCTPTR)                                 0321 00314000
         LTR   @04,@04                                             0321 00315000
         BZ    @RF00321                                            0321 00316000
*             PCTPTR = PCTSPP;          /* SET SECONDARY PCT PTR     */ 00317000
         LR    PCTPTR,@04                                          0322 00318000
*         FFMFLAG = ''B;                /* CLEAR THE CONTROL FLAGS   */ 00319000
@RF00321 XC    FFMFLAG(2),FFMFLAG                                  0323 00320000
*         FFMREDOS = 0;                 /* CLEAR REDO START.         */ 00321000
         SLR   @04,@04                                             0324 00322000
         ST    @04,FFMREDOS                                        0324 00323000
*         FFMREDOC = 0;                 /* INITIALIZE REDO COUNT.    */ 00324000
         STH   @04,FFMREDOC                                        0325 00325000
*         FFMBDP = DARGDBP;             /* SET DATA BLOCK POINTER.   */ 00326000
         L     @03,DARGDBP(,DDSTRU)                                0326 00327000
         ST    @03,FFMBDP                                          0326 00328000
*         FFMRBOFF = 0;                 /* INITIALIZE REDO OFFSET.   */ 00329000
         STH   @04,FFMRBOFF                                        0327 00330000
*         IF DARGFULL = ON              /* IF THIS IS A              */ 00331000
*           THEN                        /* PRINT REQUEST             */ 00332000
         CLC   DARGFULL(4),@CF00463                                0328 00333000
         BNE   @RF00328                                            0328 00334000
*             CVPRETP = NULLPTR;        /* FROM THE PRINT            */ 00335000
         ST    @04,CVPRETP                                         0329 00336000
*           ELSE                        /* FSR, THEN SETUP           */ 00337000
*             CVPRETP = DARGRETP;       /* FOR HANDLING              */ 00338000
         B     @RC00328                                            0330 00339000
@RF00328 L     @04,DARGRETP(,DDSTRU)                               0330 00340000
         ST    @04,CVPRETP                                         0330 00341000
*         DARGILP1 = NULLPTR;           /* LARGE BLOCKS              */ 00342000
@RC00328 SLR   @04,@04                                             0331 00343000
         ST    @04,DARGILP1                                        0331 00344000
*         CVPRETC = DARGRETL;           /* SET RETURN AREA LENGTH.   */ 00345000
         LH    @03,DARGRETL(,DDSTRU)                               0332 00346000
         STH   @03,CVPRETC                                         0332 00347000
*         FFMPASS = ON;                 /* TURN ON THE FIRST PASS SW */ 00348000
         OI    FFMPASS,B'00010000'                                 0333 00349000
*         PRTBUFF = ' ';                /* SET OUTPUT BUFFER BLANK   */ 00350000
         MVI   PRTBUFF+1,C' '                                      0334 00351000
         MVC   PRTBUFF+2(131),PRTBUFF+1                            0334 00352000
         MVI   PRTBUFF,C' '                                        0334 00353000
*         SAVERC = 0;                   /* INITIALIZE RETURN CODE.   */ 00354000
         STH   @04,SAVERC                                          0335 00355000
*         PCTAPC = 0;                   /* CLEAR NEXT PRINT POSITION */ 00356000
         STH   @04,PCTAPC(,PCTPTR)                                 0336 00357000
*         PCTIOP = FILENAME;            /* SET ALTERNATE IOCS PTR    */ 00358000
         L     @03,@PC00001+4                                      0337 00359000
         L     @03,FILENAME(,@03)                                  0337 00360000
         ST    @03,PCTIOP(,PCTPTR)                                 0337 00361000
*         PCTPMN =''B;                  /*RESET PUT MSG NBR          */ 00362000
*                                                                  0338 00363000
         SLR   @03,@03                                             0338 00364000
         STH   @03,PCTPMN(,PCTPTR)                                 0338 00365000
*         /***********************************************************/ 00366000
*         /*                                                         */ 00367000
*         /* SET UP THE FORMAT STRUCTURED ARGUMENT LIST ADDRESSING.  */ 00368000
*         /* IF AN STID EXISTS IN THE DYNAMIC DATA STRUCTURE,        */ 00369000
*         /* SEARCH THE QUEUED LIST FOR IT AND IF NOT FOUND, GET     */ 00370000
*         /* IT WITH A CALL TO ICKTP05. (GET STATIC TEXT)            */ 00371000
*         /* IF NO STID EXISTS, THEN SET UP THE ADDRESSING FROM THE  */ 00372000
*         /* POINTER PASSED WITH THE CALL.                           */ 00373000
*         /*                                                         */ 00374000
*         /***********************************************************/ 00375000
*                                                                  0339 00376000
*         IF GDTDBG = NULLPTR                                      0339 00377000
*           THEN;                                                  0339 00378000
         C     @04,GDTDBG(,GDTPR)                                  0339 00379000
         BE    @RT00339                                            0339 00380000
*           ELSE                                                   0341 00381000
*             CALL ICKDB010 (GDTTBL,'TPSI');                       0341 00382000
*                                                                  0341 00383000
         ST    GDTPR,@AL00001                                      0341 00384000
         LA    @04,@CC00783                                        0341 00385000
         ST    @04,@AL00001+4                                      0341 00386000
         MVI   @AL00001+4,X'80'                                    0341 00387000
         L     @15,GDTDBG(,GDTPR)                                  0341 00388000
         LA    @01,@AL00001                                        0341 00389000
         BALR  @14,@15                                             0341 00390000
*         IF DARGSTID ^= NULLPTR                                   0342 00391000
*           THEN                                                   0342 00392000
@RT00339 L     @04,DARGSTID(,DDSTRU)                               0342 00393000
         LTR   @04,@04                                             0342 00394000
         BZ    @RF00342                                            0342 00395000
*             DO;                                                  0343 00396000
*             /*******************************************************/ 00397000
*             /*                                                     */ 00398000
*             /* SEARCH THE STATIC TEXT QUEUE FOR THIS STID.         */ 00399000
*             /*  THIS QUEUE IS KEPT DURING EACH FSR EXECUTION.      */ 00400000
*             /*                                                     */ 00401000
*             /*******************************************************/ 00402000
*                                                                  0344 00403000
*               QENTP = PCTSQP;                                    0344 00404000
         L     @04,PCTSQP(,PCTPTR)                                 0344 00405000
         ST    @04,QENTP                                           0344 00406000
*               DO WHILE QENTP ^= NULLPTR & QSTID ^= DARGSTID;     0345 00407000
         B     @DE00345                                            0345 00408000
@DL00345 DS    0H                                                  0346 00409000
*                 QENTP = QCHAIN;                                  0346 00410000
         L     @04,QENTP                                           0346 00411000
         L     @04,QCHAIN(,@04)                                    0346 00412000
         ST    @04,QENTP                                           0346 00413000
*               END;                                               0347 00414000
@DE00345 L     @04,QENTP                                           0347 00415000
         LTR   @04,@04                                             0347 00416000
         BZ    @DC00345                                            0347 00417000
         CLC   QSTID(4,@04),DARGSTID(DDSTRU)                       0347 00418000
         BNE   @DL00345                                            0347 00419000
@DC00345 DS    0H                                                  0348 00420000
*               IF QENTP = NULLPTR                                 0348 00421000
*                 THEN                                             0348 00422000
         L     @04,QENTP                                           0348 00423000
         LTR   @04,@04                                             0348 00424000
         BNZ   @RF00348                                            0348 00425000
*                   DO;                                            0349 00426000
*                                                                  0349 00427000
*                   /*************************************************/ 00428000
*                   /*                                               */ 00429000
*                   /* MAKE THE CALL TO GET STATIC TEXT (ICKTP05)    */ 00430000
*                   /* THE ADDRESSING TO THE FORMAT LIST IS SET BY   */ 00431000
*                   /* THE ADDRESS RETURNED FROM GET STATIC TEXT.    */ 00432000
*                   /*                                               */ 00433000
*                   /*************************************************/ 00434000
*                                                                  0350 00435000
*                       CALL ICKSACL0 (GDTTBL,'ICKTP05 ',          0350 00436000
*                       DARGSTID,SBPOOL,QENTP);                    0350 00437000
*                                                                  0350 00438000
         ST    GDTPR,@AL00001                                      0350 00439000
         LA    @04,@CC00784                                        0350 00440000
         ST    @04,@AL00001+4                                      0350 00441000
         LA    @04,DARGSTID(,DDSTRU)                               0350 00442000
         ST    @04,@AL00001+8                                      0350 00443000
         LA    @04,SBPOOL                                          0350 00444000
         ST    @04,@AL00001+12                                     0350 00445000
         LA    @04,QENTP                                           0350 00446000
         ST    @04,@AL00001+16                                     0350 00447000
         MVI   @AL00001+16,X'80'                                   0350 00448000
         L     @15,GDTCAL(,GDTPR)                                  0350 00449000
         LA    @01,@AL00001                                        0350 00450000
         BALR  @14,@15                                             0350 00451000
*                       RESPECIFY RTNREG RSTD;                     0351 00452000
*                       TESTRC = RTNREG;                           0352 00453000
         STH   RTNREG,TESTRC                                       0352 00454000
*                       RESPECIFY RTNREG UNRSTD;                   0353 00455000
*                       IF TESTRC ^= 0                             0354 00456000
*                         THEN                                     0354 00457000
         LH    @04,TESTRC                                          0354 00458000
         LTR   @04,@04                                             0354 00459000
         BZ    @RF00354                                            0354 00460000
*                           DO;                                    0355 00461000
*                             CALL ERROR(6);                       0356 00462000
         LA    @01,@AL00356                                        0356 00463000
         BAL   @14,ERROR                                           0356 00464000
*                             CALL ICKSAEP0(GDTTBL,MODID,TESTRC);  0357 00465000
         ST    GDTPR,@AL00001                                      0357 00466000
         LA    @04,MODID                                           0357 00467000
         ST    @04,@AL00001+4                                      0357 00468000
         LA    @04,TESTRC                                          0357 00469000
         ST    @04,@AL00001+8                                      0357 00470000
         MVI   @AL00001+8,X'80'                                    0357 00471000
         L     @15,GDTEPL(,GDTPR)                                  0357 00472000
         LA    @01,@AL00001                                        0357 00473000
         BALR  @14,@15                                             0357 00474000
*                           END;                                   0358 00475000
*                   END;                                           0359 00476000
*                                                                  0359 00477000
@RF00354 DS    0H                                                  0360 00478000
*               /*****************************************************/ 00479000
*               /*                                                   */ 00480000
*               /* IF THIS STATIC TEXT STRUCTURE IS FOR A HEADER,    */ 00481000
*               /* SET UP THE HEADING INFORMATION IN THE PCT.        */ 00482000
*               /*                                                   */ 00483000
*               /*****************************************************/ 00484000
*                                                                  0360 00485000
*               IF QHEADF = ON                                     0360 00486000
*                 THEN                                             0360 00487000
@RF00348 L     @04,QENTP                                           0360 00488000
         TM    QHEADF(@04),B'01000000'                             0360 00489000
         BNO   @RF00360                                            0360 00490000
*                   DO;                                            0361 00491000
*                     PCTHLC = QHLC;                               0362 00492000
         IC    @03,QHLC(,@04)                                      0362 00493000
         STC   @03,PCTHLC(,PCTPTR)                                 0362 00494000
*                     PCTHSC = QHSC;                               0363 00495000
         IC    @03,QHSC(,@04)                                      0363 00496000
         STC   @03,PCTHSC(,PCTPTR)                                 0363 00497000
*                     PCTH1F = ON;                                 0364 00498000
*                     PCTH2F = OFF;                                0365 00499000
         OI    PCTH1F(PCTPTR),B'10000000'                          0365 00500000
         NI    PCTH2F(PCTPTR),B'10111111'                          0365 00501000
*                   END;                                           0366 00502000
*               IF QMSGF = ON                                      0367 00503000
*                 THEN                                             0367 00504000
@RF00360 L     @04,QENTP                                           0367 00505000
         TM    QMSGF(@04),B'10000000'                              0367 00506000
         BNO   @RF00367                                            0367 00507000
*                   DO;                                            0368 00508000
*                     FFMPMSF = ON;                                0369 00509000
         OI    FFMPMSF,B'00010000'                                 0369 00510000
*                     PCTPMN = -1;                                 0370 00511000
         MVC   PCTPMN(2,PCTPTR),@CH00786                           0370 00512000
*                   END;                                           0371 00513000
*               FSADDR = ADDR(QTEXT);                              0372 00514000
@RF00367 L     FSADDR,QENTP                                        0372 00515000
         LA    FSADDR,QTEXT(,FSADDR)                               0372 00516000
*             END;                                                 0373 00517000
*                                                                  0373 00518000
*             /*******************************************************/ 00519000
*             /*                                                     */ 00520000
*             /* SET THE ADDRESSING TO THE FORMAT LIST WHEN NO STID  */ 00521000
*             /* IS PASSED IN THE DYNAMIC ARGUMENT LIST.             */ 00522000
*             /*                                                     */ 00523000
*             /*******************************************************/ 00524000
*                                                                  0374 00525000
*           ELSE                                                   0374 00526000
*             DO;                                                  0374 00527000
         B     @RC00342                                            0374 00528000
@RF00342 DS    0H                                                  0375 00529000
*               IF LISTLN = 4                                      0375 00530000
*                 THEN                                             0375 00531000
         CLI   LISTLN,4                                            0375 00532000
         BNE   @RF00375                                            0375 00533000
*                   FSADDR = FMPTR;                                0376 00534000
         L     @04,@PC00001+52                                     0376 00535000
         L     FSADDR,FMPTR(,@04)                                  0376 00536000
*                 ELSE                                             0377 00537000
*                   DO;                                            0377 00538000
         B     @RC00375                                            0377 00539000
@RF00375 DS    0H                                                  0378 00540000
*                     CALL ERROR (1);                              0378 00541000
         LA    @01,@AL00378                                        0378 00542000
         BAL   @14,ERROR                                           0378 00543000
*                     RETURN CODE(RCQUIT);                         0379 00544000
         LH    @03,RCQUIT                                          0379 00545000
         L     @13,4(,@13)                                         0379 00546000
         L     @00,@SIZDATD                                        0379 00547000
         LR    @01,@08                                             0379 00548000
         FREEMAIN R,LV=(0),A=(1)                                        00549000
         LR    @15,@03                                             0379 00550000
         L     @14,12(,@13)                                        0379 00551000
         LM    @00,@12,20(@13)                                     0379 00552000
         BR    @14                                                 0379 00553000
*                   END;                                           0380 00554000
*             END;                                                 0381 00555000
@RC00375 DS    0H                                                  0382 00556000
*         FFMSTRS = FSADDR;                                        0382 00557000
*                                                                  0382 00558000
@RC00342 ST    FSADDR,FFMSTRS                                      0382 00559000
*         /***********************************************************/ 00560000
*         /*                                                         */ 00561000
*         /* IF NO INITIAL SPACING SUB-STRUCTURE EXISTS, SET DEFAULT.*/ 00562000
*         /* SPACING FOR THE FIRST LINE.                             */ 00563000
*         /* DEFAULT SPACING IS SET FROM THE DEFAULT SPACE CHARACTER */ 00564000
*         /* IN THE PRINT CONTROL TABLE SET UP BY THE UEST OR UREST  */ 00565000
*         /* MACROS.                                                 */ 00566000
*         /* SPACE TYPE IS SET TO 'R'. (RELATIVE)                    */ 00567000
*         /*                                                         */ 00568000
*         /***********************************************************/ 00569000
*                                                                  0383 00570000
*         IF FMTSCF = OFF                                          0383 00571000
*           THEN                                                   0383 00572000
         TM    FMTSCF(FSADDR),B'01000000'                          0383 00573000
         BNZ   @RF00383                                            0383 00574000
*             DO;                                                  0384 00575000
*               PRTSPF = PCTDSC;        /* SET DEFAULT SPACE FACTOR  */ 00576000
         LH    @04,PCTDSC(,PCTPTR)                                 0385 00577000
         STH   @04,PRTSPF                                          0385 00578000
*               PRTSPT = 'R';           /* SET RELATIVE SPACING.     */ 00579000
         MVI   PRTSPT,C'R'                                         0386 00580000
*             END;                                                 0387 00581000
*                                                                  0387 00582000
*         /***********************************************************/ 00583000
*         /*                                                         */ 00584000
*         /* THIS IS THE BASE DO LOOP FOR EXECUTION OF THE FORMAT    */ 00585000
*         /* STRUCTURES.                                             */ 00586000
*         /* THIS LOOP SCANS THROUGH THE FORMAT LIST SUB-STRUCTURES  */ 00587000
*         /* SETTING UP PARAMETERS FOR THE CALL TO THE CONVERSION    */ 00588000
*         /* PROCEDURE(CONVERT) AND CALLING THAT PROC ONCE FOR EACH  */ 00589000
*         /* FORMAT SUB-STRUCTURE THAT DEFINES DATA.  (BLOCK, INSERT,*/ 00590000
*         /* STATIC TEXT OR DEFAULT SUB-STRUCTURES)                  */ 00591000
*         /* SPACE AND REDO SUB-STRUCTURES ARE HANDLED ENTIRELY      */ 00592000
*         /* WITHIN THIS PROCEDURE                                   */ 00593000
*         /* THE END OF THIS DO LOOP IS AFTER THE REDO LOOPING       */ 00594000
*         /* CONTROLS NEAR THE END OF THIS MAIN PROCEDURE.           */ 00595000
*         /* CONTROL FLAGS USED IN THIS ROUTINE ARE AS FOLLOWS       */ 00596000
*         /*    FFMEOS - END OF THE SUB-STRUCTURES.                  */ 00597000
*         /*    FFMVS - A VALID SUB-STRUCTURE FOUND.                 */ 00598000
*         /*    FFMDATA - A DATA SUB-STRUCTURE HAS BEEN FOUND.       */ 00599000
*         /*                                                         */ 00600000
*         /***********************************************************/ 00601000
*                                                                  0388 00602000
*STRLOOP: DO WHILE FFMEOS = OFF;        /* END OF STRUCT LIST FLAG   */ 00603000
@RF00383 DS    0H                                                  0388 00604000
STRLOOP  B     @DE00388                                            0388 00605000
@DL00388 DS    0H                                                  0389 00606000
*           IF FMTSCF = ON              /* SPACE CONTROL FLAG.       */ 00607000
*             THEN                                                 0389 00608000
         TM    FMTSCF(FSADDR),B'01000000'                          0389 00609000
         BNO   @RF00389                                            0389 00610000
*               DO;                                                0390 00611000
*                 /***************************************************/ 00612000
*                 /*                                                 */ 00613000
*                 /* HANDLE A SPACING SUB-STRUCTURE.                 */ 00614000
*                 /*                                                 */ 00615000
*                 /***************************************************/ 00616000
*                                                                  0391 00617000
*                 FFMVS = ON;                                      0391 00618000
*                                                                  0391 00619000
         OI    FFMVS,B'01000000'                                   0391 00620000
*                 CALL SPACE;                                      0392 00621000
*                                                                  0392 00622000
         BAL   @14,SPACE                                           0392 00623000
*                 RESPECIFY RTNREG RSTD;                           0393 00624000
*                 TESTRC = RTNREG;                                 0394 00625000
         STH   RTNREG,TESTRC                                       0394 00626000
*                 RESPECIFY RTNREG UNRSTD;                         0395 00627000
*                 IF TESTRC ^= 0                                   0396 00628000
*                   THEN                                           0396 00629000
         LH    @04,TESTRC                                          0396 00630000
         LTR   @04,@04                                             0396 00631000
         BZ    @RF00396                                            0396 00632000
*                     CALL ICKSAEP0(GDTTBL,MODID,RCQUIT);          0397 00633000
*                                                                  0397 00634000
         MVC   @AL00001+4(8),@AL00397                              0397 00635000
         ST    GDTPR,@AL00001                                      0397 00636000
         L     @15,GDTEPL(,GDTPR)                                  0397 00637000
         LA    @01,@AL00001                                        0397 00638000
         BALR  @14,@15                                             0397 00639000
*               END;                                               0398 00640000
*             ELSE                                                 0399 00641000
*               IF FMTREPF = ON         /* REDO FLAG.                */ 00642000
*                 THEN                                             0399 00643000
         B     @RC00389                                            0399 00644000
@RF00389 TM    FMTREPF(FSADDR),B'00001000'                         0399 00645000
         BNO   @RF00399                                            0399 00646000
*                   DO;                                            0400 00647000
*                   /*************************************************/ 00648000
*                   /*                                               */ 00649000
*                   /* HANDLE A REDO OR REPLICATION SUB-STRUCTURE.   */ 00650000
*                   /*                                               */ 00651000
*                   /*************************************************/ 00652000
*                     FFMVS = ON;                                  0401 00653000
*                                                                  0401 00654000
         OI    FFMVS,B'01000000'                                   0401 00655000
*                     CALL REDO;                                   0402 00656000
*                                                                  0402 00657000
         BAL   @14,REDO                                            0402 00658000
*                   END;                                           0403 00659000
*                 ELSE                                             0404 00660000
*                   IF FMTSTF = ON      /* STATIC TEXT FLAG.         */ 00661000
*                     THEN                                         0404 00662000
         B     @RC00399                                            0404 00663000
@RF00399 TM    FMTSTF(FSADDR),B'00000100'                          0404 00664000
         BNO   @RF00404                                            0404 00665000
*                       DO;                                        0405 00666000
*                       /*********************************************/ 00667000
*                       /*                                           */ 00668000
*                       /* HANDLE A STATIC TEXT SUB-STRUCTURE.       */ 00669000
*                       /*                                           */ 00670000
*                       /*********************************************/ 00671000
*                         FFMDATA = ON;                            0406 00672000
         OI    FFMDATA,B'00000010'                                 0406 00673000
*                         FFMVS = ON;                              0407 00674000
*                                                                  0407 00675000
         OI    FFMVS,B'01000000'                                   0407 00676000
*                         CALL STATIC;                             0408 00677000
*                                                                  0408 00678000
         BAL   @14,STATIC                                          0408 00679000
*                       END;                                       0409 00680000
*                     ELSE                                         0410 00681000
*                       IF FMTBDF = ON  /* BLOCK DATA FLAG.          */ 00682000
*                         THEN                                     0410 00683000
         B     @RC00404                                            0410 00684000
@RF00404 TM    FMTBDF(FSADDR),B'00010000'                          0410 00685000
         BNO   @RF00410                                            0410 00686000
*                           DO;                                    0411 00687000
*                           /*****************************************/ 00688000
*                           /*                                       */ 00689000
*                           /* HANDLE A BLOCK DATA SUB-STRUCTURE.    */ 00690000
*                           /*                                       */ 00691000
*                           /*****************************************/ 00692000
*                             FFMDATA = ON;                        0412 00693000
         OI    FFMDATA,B'00000010'                                 0412 00694000
*                             FFMVS = ON;                          0413 00695000
*                                                                  0413 00696000
         OI    FFMVS,B'01000000'                                   0413 00697000
*                             CALL BLOCK;                          0414 00698000
*                                                                  0414 00699000
         BAL   @14,BLOCK                                           0414 00700000
*                           END;                                   0415 00701000
*                         ELSE                                     0416 00702000
*                           IF FMTIDF = ON                         0416 00703000
*                                       /* INSERT DATA FLAG.         */ 00704000
*                             THEN                                 0416 00705000
         B     @RC00410                                            0416 00706000
@RF00410 TM    FMTIDF(FSADDR),B'00100000'                          0416 00707000
         BNO   @RF00416                                            0416 00708000
*                               DO;                                0417 00709000
*                               /*************************************/ 00710000
*                               /*                                   */ 00711000
*                               /* HANDLE A DATA INSERT  DATA        */ 00712000
*                               /* SUB-STRUCTURE.                    */ 00713000
*                               /*                                   */ 00714000
*                               /*************************************/ 00715000
*                                 FFMDATA = ON;                    0418 00716000
         OI    FFMDATA,B'00000010'                                 0418 00717000
*                                 FFMVS = ON;                      0419 00718000
*                                                                  0419 00719000
         OI    FFMVS,B'01000000'                                   0419 00720000
*                                 CALL INSERT;                     0420 00721000
*                                                                  0420 00722000
         BAL   @14,INSERT                                          0420 00723000
*                               END;                               0421 00724000
*                       ELSE                                       0422 00725000
*                         IF FMTDFF = ON                           0422 00726000
*                                       /* DEFAULT DATA FLAG.        */ 00727000
*                           THEN                                   0422 00728000
         B     @RC00416                                            0422 00729000
@RF00416 TM    FMTDFF(FSADDR),B'00000010'                          0422 00730000
         BNO   @RF00422                                            0422 00731000
*                             DO;                                  0423 00732000
*                             /***************************************/ 00733000
*                             /*                                     */ 00734000
*                             /* BYPASS A DEFAULT DATA SUB-STRUCTURE */ 00735000
*                             /* IF A DEFAULT DATA SUB-STRUCTURE     */ 00736000
*                             /* IS USED, IT IS USED IN THE INSERT   */ 00737000
*                             /* HANDLING CODE BECAUSE THE REFERENCE */ 00738000
*                             /* NUMBER WAS NOT FOUND IN THE USERS   */ 00739000
*                             /* DYNAMIC ARGUMENT LIST.  THERE FORE, */ 00740000
*                             /* IT IS NEVER USED IN LINE.           */ 00741000
*                             /*                                     */ 00742000
*                             /***************************************/ 00743000
*                               STRSTP = 12;                       0424 00744000
         MVC   STRSTP(2),@CH00034                                  0424 00745000
*                               FFMVS = ON;                        0425 00746000
         OI    FFMVS,B'01000000'                                   0425 00747000
*                             END;                                 0426 00748000
*           /*********************************************************/ 00749000
*           /*                                                       */ 00750000
*           /* CHECK TO INSURE THAT A VALID SUB-STRUCTURE WAS FOUND. */ 00751000
*           /* IF NONE WAS FOUND, ISSUE ERROR MESSAGE AND RETURN.    */ 00752000
*           /*                                                       */ 00753000
*           /*********************************************************/ 00754000
*           IF FFMVS = OFF                                         0427 00755000
*             THEN                                                 0427 00756000
@RF00422 DS    0H                                                  0427 00757000
@RC00416 DS    0H                                                  0427 00758000
@RC00410 DS    0H                                                  0427 00759000
@RC00404 DS    0H                                                  0427 00760000
@RC00399 DS    0H                                                  0427 00761000
@RC00389 TM    FFMVS,B'01000000'                                   0427 00762000
         BNZ   @RF00427                                            0427 00763000
*               DO;                                                0428 00764000
*                                                                  0428 00765000
*                 CALL ERROR(1);                                   0429 00766000
*                                                                  0429 00767000
         LA    @01,@AL00429                                        0429 00768000
         BAL   @14,ERROR                                           0429 00769000
*                 CALL ICKSAEP0(GDTTBL,MODID,RCERR);               0430 00770000
*                                                                  0430 00771000
         MVC   @AL00001+4(8),@AL00430                              0430 00772000
         ST    GDTPR,@AL00001                                      0430 00773000
         L     @15,GDTEPL(,GDTPR)                                  0430 00774000
         LA    @01,@AL00001                                        0430 00775000
         BALR  @14,@15                                             0430 00776000
*               END;                                               0431 00777000
*         /***********************************************************/ 00778000
*         /*                                                         */ 00779000
*         /* IF THE SUB STRUCTURE WAS A DATA HANDLING  STRUCTURE     */ 00780000
*         /* (A STATIC TEXT, BLOCK DATA OR INSERT DATA SUB-STRUCTURE)*/ 00781000
*         /* CONTINUE HERE WITH THE HANDLING OF THAT STRUCTURE.      */ 00782000
*         /* VERIFY AND SET UP THE OUTPUT COLUMN AND LENGTH FOR THE  */ 00783000
*         /* DATA TYPE TO BE HANDLED.                                */ 00784000
*         /*                                                         */ 00785000
*         /***********************************************************/ 00786000
*                                                                  0432 00787000
*           IF FFMDATA = ON & FFMPINH = OFF                        0432 00788000
*             THEN                                                 0432 00789000
@RF00427 TM    FFMDATA,B'00000010'                                 0432 00790000
         BNO   @RF00432                                            0432 00791000
         TM    FFMPINH,B'10000000'                                 0432 00792000
         BNZ   @RF00432                                            0432 00793000
*DATALOOP:      DO;                                                0433 00794000
*                                                                  0433 00795000
DATALOOP DS    0H                                                  0434 00796000
*                 /***************************************************/ 00797000
*                 /*                                                 */ 00798000
*                 /* SET UP THE CONVERSION FLAGS IN THE PRINT AND    */ 00799000
*                 /* CONVERSION ARGUMENT LIST.                       */ 00800000
*                 /*                                                 */ 00801000
*                 /***************************************************/ 00802000
*                                                                  0434 00803000
*                 CVPTYF = FMTCNVF;                                0434 00804000
         MVC   CVPTYF(2),FMTCNVF(FSADDR)                           0434 00805000
*                 /***************************************************/ 00806000
*                 /*                                                 */ 00807000
*                 /* SET THE PARAMETERS FOR THE CONVERSION CALL.     */ 00808000
*                 /* THE PARAMETERS SET ARE-                         */ 00809000
*                 /*    CVPIADD - THE INPUT STRING ADDRESS.          */ 00810000
*                 /*        SET IN INPUT SUB-STRUCTURE HANDLING      */ 00811000
*                 /*    CVPPADD - THE PRINT LINE POSITION ADDRESS.   */ 00812000
*                 /*    CVPIL - THE INPUT STRING LENGTH.             */ 00813000
*                 /*        SET IN INPUT SUB-STRUCTURE HANDLING      */ 00814000
*                 /*    CVPOL THE OUTPUT STRING LENGTH.              */ 00815000
*                 /*    CVPRETC = THE RETURN AREA LENGTH.            */ 00816000
*                 /*    CVPRETP - THE RETURN AREA POINTER.           */ 00817000
*                 /*                                                 */ 00818000
*                 /***************************************************/ 00819000
*                                                                  0435 00820000
*                 IF FMTBS = ON         /* IF BLANK SUPPRESSION.     */ 00821000
*                   THEN                /* ADD OFFSET IN FMTOCOL TO  */ 00822000
         TM    FMTBS(FSADDR),B'00010000'                           0435 00823000
         BNO   @RF00435                                            0435 00824000
*                                       /* LAST AVAILABLE POSITION.  */ 00825000
*                     CVPPADD = ADDR(PRTBUFF) + FMTOCOL + PCTAPC;  0436 00826000
         LA    @04,PRTBUFF                                         0436 00827000
         AH    @04,FMTOCOL(,FSADDR)                                0436 00828000
         AH    @04,PCTAPC(,PCTPTR)                                 0436 00829000
         ST    @04,CVPPADD                                         0436 00830000
*                   ELSE                /* PRINT COLUMN IN FMTOCOL   */ 00831000
*                                       /* TO A POSSIBLE INDENT.     */ 00832000
*                     CVPPADD = ADDR(PRTBUFF) + FMTOCOL - 1 + DARGIND;  00833000
         B     @RC00435                                            0437 00834000
@RF00435 LA    @04,PRTBUFF                                         0437 00835000
         AH    @04,FMTOCOL(,FSADDR)                                0437 00836000
         BCTR  @04,0                                               0437 00837000
         SLR   @15,@15                                             0437 00838000
         IC    @15,DARGIND(,DDSTRU)                                0437 00839000
         ALR   @04,@15                                             0437 00840000
         ST    @04,CVPPADD                                         0437 00841000
*                 CVPOL = FMTOLEN;      /* SET OUTPUT LENGTH.        */ 00842000
*                                                                  0438 00843000
@RC00435 LH    @04,FMTOLEN(,FSADDR)                                0438 00844000
         ST    @04,CVPOL                                           0438 00845000
*                 /***************************************************/ 00846000
*                 /*                                                 */ 00847000
*                 /* ASSURE PRINT COLUMN IS WITHIN THE PRINT LINE.   */ 00848000
*                 /*                                                 */ 00849000
*                 /***************************************************/ 00850000
*                                                                  0439 00851000
*                 IF CVPPADD > (ADDR(PRTBUFF) + PCTPLW - 1)        0439 00852000
*                   THEN                                           0439 00853000
         LA    @04,PRTBUFF                                         0439 00854000
         AL    @04,PCTPLW(,PCTPTR)                                 0439 00855000
         BCTR  @04,0                                               0439 00856000
         C     @04,CVPPADD                                         0439 00857000
         BNL   @RF00439                                            0439 00858000
*                     DO;                                          0440 00859000
*                                                                  0440 00860000
*                       CALL ERROR(2);                             0441 00861000
*                                                                  0441 00862000
         LA    @01,@AL00441                                        0441 00863000
         BAL   @14,ERROR                                           0441 00864000
*                       FFMPINH = ON;                              0442 00865000
         OI    FFMPINH,B'10000000'                                 0442 00866000
*                     END;                                         0443 00867000
*                                                                  0443 00868000
*         /***********************************************************/ 00869000
*         /*                                                         */ 00870000
*         /* COMPUTE THE CONVERTED LENGTH FOR THE VARIOUS DATA TYPES */ 00871000
*         /* CONVL IS USED IN THIS SECTION OF CODE TO HOLD THE       */ 00872000
*         /* COMPUTED OUTPUT LENGTH FOR THE SELECTED DATA TYPE.      */ 00873000
*         /*                                                         */ 00874000
*         /***********************************************************/ 00875000
*                                                                  0444 00876000
*           CONVL = 0;                                             0444 00877000
*                                                                  0444 00878000
@RF00439 SLR   @04,@04                                             0444 00879000
         ST    @04,CONVL                                           0444 00880000
*           /* SET BINARY TO HEXIDECIMAL OR PACKED TO UNPACKED       */ 00881000
*           /*  OR BINARY TO HEXADECIMAL APOSTROPHE.                 */ 00882000
*                                                                  0445 00883000
*           IF CVPBH = ON | CVPPU = ON | CVPBHA = ON               0445 00884000
*             THEN                                                 0445 00885000
         TM    CVPBH,B'11001000'                                   0445 00886000
         BZ    @RF00445                                            0445 00887000
*               CONVL = CVPIL + CVPIL;                             0446 00888000
*                                                                  0446 00889000
         L     @04,CVPIL                                           0446 00890000
         LR    @15,@04                                             0446 00891000
         ALR   @15,@04                                             0446 00892000
         ST    @15,CONVL                                           0446 00893000
*           /* CHECK FOR MAXIMUM PACKED TO UNPACKED OUTPUT LENGTH.   */ 00894000
*                                                                  0447 00895000
*           IF CVPPU = ON                                          0447 00896000
*             THEN                                                 0447 00897000
@RF00445 TM    CVPPU,B'00001000'                                   0447 00898000
         BNO   @RF00447                                            0447 00899000
*               DO;                                                0448 00900000
*                 IF CVPOL > 16 | CVPIL > 8                        0449 00901000
*                   THEN                                           0449 00902000
         L     @04,CVPOL                                           0449 00903000
         C     @04,@CF00264                                        0449 00904000
         BH    @RT00449                                            0449 00905000
         L     @04,CVPIL                                           0449 00906000
         C     @04,@CF00156                                        0449 00907000
         BNH   @RF00449                                            0449 00908000
@RT00449 DS    0H                                                  0450 00909000
*                     DO;                                          0450 00910000
*                                                                  0450 00911000
*                       CALL ERROR(3);                             0451 00912000
*                                                                  0451 00913000
         LA    @01,@AL00451                                        0451 00914000
         BAL   @14,ERROR                                           0451 00915000
*                       IF CVPIL > 8                               0452 00916000
*                         THEN                                     0452 00917000
         LA    @04,8                                               0452 00918000
         C     @04,CVPIL                                           0452 00919000
         BNL   @RF00452                                            0452 00920000
*                           CVPIL = 8;                             0453 00921000
         ST    @04,CVPIL                                           0453 00922000
*                     END;                                         0454 00923000
@RF00452 DS    0H                                                  0455 00924000
*                CONVL = 16;                                       0455 00925000
@RF00449 MVC   CONVL(4),@CF00264                                   0455 00926000
*               END;                                               0456 00927000
*                                                                  0456 00928000
*           /* CHECK FOR MAXIMUM BINARY TO DECIMAL LENGTHS.          */ 00929000
*                                                                  0457 00930000
*          IF CVPBD = ON                                           0457 00931000
*            THEN                                                  0457 00932000
@RF00447 TM    CVPBD,B'00010000'                                   0457 00933000
         BNO   @RF00457                                            0457 00934000
*              DO;                                                 0458 00935000
*                IF CVPIL > 4 | CVPOL > 16                         0459 00936000
*                  THEN                                            0459 00937000
         L     @04,CVPIL                                           0459 00938000
         C     @04,@CF00036                                        0459 00939000
         BH    @RT00459                                            0459 00940000
         L     @04,CVPOL                                           0459 00941000
         C     @04,@CF00264                                        0459 00942000
         BNH   @RF00459                                            0459 00943000
@RT00459 DS    0H                                                  0460 00944000
*                    DO;                                           0460 00945000
*                                                                  0460 00946000
*                      CALL ERROR(3);                              0461 00947000
*                                                                  0461 00948000
         LA    @01,@AL00461                                        0461 00949000
         BAL   @14,ERROR                                           0461 00950000
*                      IF CVPIL > 4                                0462 00951000
*                        THEN                                      0462 00952000
         LA    @04,4                                               0462 00953000
         C     @04,CVPIL                                           0462 00954000
         BNL   @RF00462                                            0462 00955000
*                          CVPIL = 4;                              0463 00956000
         ST    @04,CVPIL                                           0463 00957000
*                    END;                                          0464 00958000
@RF00462 DS    0H                                                  0465 00959000
*                CONVL = 16;                                       0465 00960000
@RF00459 MVC   CONVL(4),@CF00264                                   0465 00961000
*              END;                                                0466 00962000
*                                                                  0466 00963000
*           /* IF NONE OF THE ABOVE, THEN SET TO THE INPUT LENGTH.   */ 00964000
*                                                                  0467 00965000
*           IF CONVL = 0                                           0467 00966000
*             THEN                                                 0467 00967000
@RF00457 L     @04,CONVL                                           0467 00968000
         LTR   @04,@04                                             0467 00969000
         BNZ   @RF00467                                            0467 00970000
*               CONVL = CVPIL;                                     0468 00971000
*                                                                  0468 00972000
         L     @04,CVPIL                                           0468 00973000
         ST    @04,CONVL                                           0468 00974000
*         /***********************************************************/ 00975000
*         /*                                                         */ 00976000
*         /*  SET OUTPUT LENGTH FOR ANY DEFAULTED LENGTH FIELD.      */ 00977000
*         /* CALLER SPECIFIED NO LENGTH IN THE FORMAT STRUCTURE.     */ 00978000
*         /* OR SPECIFIED LENGTH WAS LESS THAN DATA LENGTH.          */ 00979000
*         /*                                                         */ 00980000
*         /***********************************************************/ 00981000
*                                                                  0469 00982000
*           IF CVPOL = 0 | CONVL < CVPOL                           0469 00983000
*             THEN                                                 0469 00984000
@RF00467 L     @04,CVPOL                                           0469 00985000
         LTR   @04,@04                                             0469 00986000
         BZ    @RT00469                                            0469 00987000
         C     @04,CONVL                                           0469 00988000
         BNH   @RF00469                                            0469 00989000
@RT00469 DS    0H                                                  0470 00990000
*               CVPOL = CONVL;                                     0470 00991000
         L     @04,CONVL                                           0470 00992000
         ST    @04,CVPOL                                           0470 00993000
*                                                                  0471 00994000
*           /*********************************************************/ 00995000
*           /*                                                       */ 00996000
*           /* IF INPUT OR OUTPUT LENGTH IS LESS THAN ONE, THEN      */ 00997000
*           /* PUT OUT AN ERROR MESSAGE HERE AND TERMINATE.          */ 00998000
*           /*                                                       */ 00999000
*           /*********************************************************/ 01000000
*                                                                  0471 01001000
*           IF CVPOL < 1 | CVPIL < 1                               0471 01002000
*             THEN                                                 0471 01003000
@RF00469 LA    @04,1                                               0471 01004000
         C     @04,CVPOL                                           0471 01005000
         BH    @RT00471                                            0471 01006000
         C     @04,CVPIL                                           0471 01007000
         BNH   @RF00471                                            0471 01008000
@RT00471 DS    0H                                                  0472 01009000
*               DO;                                                0472 01010000
*                                                                  0472 01011000
*                 CALL ERROR(1);                                   0473 01012000
*                                                                  0473 01013000
         LA    @01,@AL00473                                        0473 01014000
         BAL   @14,ERROR                                           0473 01015000
*                 CALL ICKSAEP0(GDTTBL,MODID,RCERR);               0474 01016000
*                                                                  0474 01017000
         MVC   @AL00001+4(8),@AL00474                              0474 01018000
         ST    GDTPR,@AL00001                                      0474 01019000
         L     @15,GDTEPL(,GDTPR)                                  0474 01020000
         LA    @01,@AL00001                                        0474 01021000
         BALR  @14,@15                                             0474 01022000
*               END;                                               0475 01023000
*                                                                  0475 01024000
*         /***********************************************************/ 01025000
*         /*                                                         */ 01026000
*         /* ADJUST OUTPUT LENGTH FOR BINARY TO HEXADECIMAL.         */ 01027000
*         /* INSURE EVEN NUMBER OF OUTPUT BYTES FOR BINARY TO HEX    */ 01028000
*         /* CONVERSION.                                             */ 01029000
*         /*                                                         */ 01030000
*         /***********************************************************/ 01031000
*         IF CVPBH = ON | CVPBHA = ON                              0476 01032000
*           THEN                                                   0476 01033000
@RF00471 TM    CVPBH,B'11000000'                                   0476 01034000
         BZ    @RF00476                                            0476 01035000
*             DO;                                                  0477 01036000
*               IF CVPOL//2 ^= 0                                   0478 01037000
*                 THEN                                             0478 01038000
         L     @04,CVPOL                                           0478 01039000
         LR    @00,@04                                             0478 01040000
         SRDA  @00,32                                              0478 01041000
         D     @00,@CF00111                                        0478 01042000
         LTR   @00,@00                                             0478 01043000
         BZ    @RF00478                                            0478 01044000
*                   CVPOL = CVPOL + 1;                             0479 01045000
         AL    @04,@CF00160                                        0479 01046000
         ST    @04,CVPOL                                           0479 01047000
*             END;                                                 0480 01048000
*                                                                  0480 01049000
@RF00478 DS    0H                                                  0481 01050000
*           IF CVPBHA = ON                                         0481 01051000
*             THEN                                                 0481 01052000
@RF00476 TM    CVPBHA,B'01000000'                                  0481 01053000
         BNO   @RF00481                                            0481 01054000
*               CVPOL = CVPOL + 3;                                 0482 01055000
*                                                                  0482 01056000
*                                                                  0482 01057000
         LA    @04,3                                               0482 01058000
         AL    @04,CVPOL                                           0482 01059000
         ST    @04,CVPOL                                           0482 01060000
*         /***********************************************************/ 01061000
*         /*                                                         */ 01062000
*         /* IF THE SUB-STRUCTURE IS FOR A BINARY TO HEXIDECIMAL     */ 01063000
*         /* DUMP, CHECK FOR ANY PREVIOUS FORMATTING AS THAT LINE    */ 01064000
*         /* MUST BE PRINTED PRIOR TO CONVERTING THE DUMP.           */ 01065000
*         /*                                                         */ 01066000
*         /***********************************************************/ 01067000
*                                                                  0483 01068000
*           IF CVPBHD = ON                                         0483 01069000
*             THEN                                                 0483 01070000
@RF00481 TM    CVPBHD,B'00100000'                                  0483 01071000
         BNO   @RF00483                                            0483 01072000
*               DO;                                                0484 01073000
*                                                                  0484 01074000
*                 IF FFMFMTF = ON                                  0485 01075000
*                   THEN                                           0485 01076000
         TM    FFMFMTF,B'00000001'                                 0485 01077000
         BNO   @RF00485                                            0485 01078000
*                     DO;                                          0486 01079000
*                                                                  0486 01080000
*                       CALL LINEPRT;                              0487 01081000
*                                                                  0487 01082000
         BAL   @14,LINEPRT                                         0487 01083000
*                       RESPECIFY RTNREG RSTD;                     0488 01084000
*                       TESTRC = RTNREG;                           0489 01085000
         STH   RTNREG,TESTRC                                       0489 01086000
*                       RESPECIFY RTNREG UNRSTD;                   0490 01087000
*                       IF TESTRC >0                               0491 01088000
*                         THEN                                     0491 01089000
         LH    @04,TESTRC                                          0491 01090000
         LTR   @04,@04                                             0491 01091000
         BNP   @RF00491                                            0491 01092000
*                           CALL ICKSAEP0(GDTTBL,MODID,RCQUIT);    0492 01093000
         MVC   @AL00001+4(8),@AL00492                              0492 01094000
         ST    GDTPR,@AL00001                                      0492 01095000
         L     @15,GDTEPL(,GDTPR)                                  0492 01096000
         LA    @01,@AL00001                                        0492 01097000
         BALR  @14,@15                                             0492 01098000
*                     END;                                         0493 01099000
*                                                                  0493 01100000
@RF00491 DS    0H                                                  0494 01101000
*                 /* SET THE PRINT ADDRESS FOR BINARY TO HEX DUMP.   */ 01102000
*                                                                  0494 01103000
*                 CVPPADD = ADDR(PRTBUFF);                         0494 01104000
@RF00485 LA    @04,PRTBUFF                                         0494 01105000
         ST    @04,CVPPADD                                         0494 01106000
*               END;                                               0495 01107000
*         /***********************************************************/ 01108000
*         /*                                                         */ 01109000
*         /* SET UP IS COMPLETE AND WE ARE NOW READY TO CALL THE     */ 01110000
*         /* CONVERSION PROCEDURE(CONVERT) FOR THE CONVERSION OF THIS*/ 01111000
*         /* SEGMENT.                                                */ 01112000
*         /* RETURN CODES ARE                                        */ 01113000
*         /*    0 - GOOD RETURN                                      */ 01114000
*         /*    4 - GOOD RETURN BUT LINE OVERFLOW OCCURED AND ALL    */ 01115000
*         /*        PREVIOUSLY FORMATTED DATA HAS BEEN PRINTED.      */ 01116000
*         /*    8 - PACKED DECIMAL INPUT IS INVALID.                 */ 01117000
*         /*    OTHER - ERROR IN CONVERSION OR PRINTING.             */ 01118000
*         /*        GREATER THAN 8 IS TERMINATING.                   */ 01119000
*         /*                                                         */ 01120000
*         /***********************************************************/ 01121000
*                                                                  0496 01122000
*           IF FFMPINH = OFF                                       0496 01123000
*             THEN                                                 0496 01124000
@RF00483 TM    FFMPINH,B'10000000'                                 0496 01125000
         BNZ   @RF00496                                            0496 01126000
*               DO;                                                0497 01127000
*                                                                  0497 01128000
*                 OLDERID2 = NEWERID2;                             0498 01129000
         L     @04,GDTTR2(,GDTPR)                                  0498 01130000
         MVC   @TS00001(95),NEWERID2(@04)                          0498 01131000
         MVC   OLDERID2(95,@04),@TS00001                           0498 01132000
*                 NEWID2 = 'TPCC';                                 0499 01133000
*                                                                  0499 01134000
         MVC   NEWID2(4,@04),@CC00798                              0499 01135000
*                 CALL CONVERT;                                    0500 01136000
*                                                                  0500 01137000
         BAL   @14,CONVERT                                         0500 01138000
*                 RESPECIFY RTNREG RSTD;                           0501 01139000
*                 TESTRC = RTNREG;                                 0502 01140000
         STH   RTNREG,TESTRC                                       0502 01141000
*                 RESPECIFY RTNREG UNRSTD;                         0503 01142000
*                 IF TESTRC > 8                                    0504 01143000
*                   THEN                                           0504 01144000
*                                                                  0504 01145000
         LH    @04,TESTRC                                          0504 01146000
         C     @04,@CF00156                                        0504 01147000
         BNH   @RF00504                                            0504 01148000
*                     CALL ICKSAEP0(GDTTBL,MODID,RCQUIT);          0505 01149000
*                                                                  0505 01150000
         MVC   @AL00001+4(8),@AL00505                              0505 01151000
         ST    GDTPR,@AL00001                                      0505 01152000
         L     @15,GDTEPL(,GDTPR)                                  0505 01153000
         LA    @01,@AL00001                                        0505 01154000
         BALR  @14,@15                                             0505 01155000
*                 IF TESTRC = 8                                    0506 01156000
*                   THEN                                           0506 01157000
@RF00504 CLC   TESTRC(2),@CH00156                                  0506 01158000
         BNE   @RF00506                                            0506 01159000
*                     DO;                                          0507 01160000
*                                                                  0507 01161000
*                       CALL ERROR (7);                            0508 01162000
*                                                                  0508 01163000
         LA    @01,@AL00508                                        0508 01164000
         BAL   @14,ERROR                                           0508 01165000
*                     END;                                         0509 01166000
*                 IF TESTRC = 0                                    0510 01167000
*                   THEN                                           0510 01168000
@RF00506 LH    @04,TESTRC                                          0510 01169000
         LTR   @04,@04                                             0510 01170000
         BNZ   @RF00510                                            0510 01171000
*                     FFMFMTF = ON;                                0511 01172000
         OI    FFMFMTF,B'00000001'                                 0511 01173000
*               END;                                               0512 01174000
@RF00510 DS    0H                                                  0513 01175000
*         /***********************************************************/ 01176000
*         /*                                                         */ 01177000
*         /* IF THE REDO FLAG (FFMREDOF) IS ON, HANDLE THE LOOPING   */ 01178000
*         /* CONTROLS FOR REDO HERE.                                 */ 01179000
*         /*                                                         */ 01180000
*         /* PARAMETERS CONTROLING REPLICATION ARE AS FOLLOWS:       */ 01181000
*         /*                                                         */ 01182000
*         /* FFMREDOF - FLAG INDICATING A REPLICATION IS OPERATING.  */ 01183000
*         /* FFMREDOC - COUNT OF REDO STRUCTURES IN THE FORMAT LIST  */ 01184000
*         /* FFMREDOL - COUNT OF THE NUMBER OF REPLICATIONS.         */ 01185000
*         /* FFMREDOO - OFFSET IN BLOCK DATA FOR EACH REPLICATION.   */ 01186000
*         /* FFMRBOFF - CURRENT INPUT BLOCK OFFSET.                  */ 01187000
*         /* REDOCSAV - AREA FOR SAVING COUNT OF REDO FORMAT         */ 01188000
*         /*            SUB-STRUCTURES.                              */ 01189000
*         /* FFMREDOS - AREA FOR SAVING START OF REDO FORMAT         */ 01190000
*         /*            SUB-STRUCTURES.                              */ 01191000
*         /*                                                         */ 01192000
*         /***********************************************************/ 01193000
*                                                                  0513 01194000
*            END DATALOOP;                                         0513 01195000
@RF00496 DS    0H                                                  0514 01196000
*           IF FFMREDOF = ON & FFMDATA = ON                        0514 01197000
*             THEN                                                 0514 01198000
@RF00432 TM    FFMREDOF,B'10000010'                                0514 01199000
         BNO   @RF00514                                            0514 01200000
*               DO;                                                0515 01201000
*                                                                  0515 01202000
*                 /***************************************************/ 01203000
*                 /*                                                 */ 01204000
*                 /* REDUCE SUB-STRUCTURE COUNT BY ONE.              */ 01205000
*                 /*                                                 */ 01206000
*                 /***************************************************/ 01207000
*                                                                  0516 01208000
*                 FFMREDOC = FFMREDOC - 1;                         0516 01209000
*                                                                  0516 01210000
         LH    @04,FFMREDOC                                        0516 01211000
         BCTR  @04,0                                               0516 01212000
         STH   @04,FFMREDOC                                        0516 01213000
*                 /***************************************************/ 01214000
*                 /*                                                 */ 01215000
*                 /* IF THE REDO COUNT IS ZERO, THIS IS THE LAST     */ 01216000
*                 /* SUB-STRUCTURE OF THE LOOP SO PRINT              */ 01217000
*                 /* THE LINE.                                       */ 01218000
*                 /*                                                 */ 01219000
*                 /***************************************************/ 01220000
*                                                                  0517 01221000
*                 IF FFMREDOC = 0        /* IS THIS THE LAST STRUCT  */ 01222000
*                   THEN                                           0517 01223000
         LTR   @04,@04                                             0517 01224000
         BNZ   @RF00517                                            0517 01225000
*                     DO;                                          0518 01226000
*                                                                  0518 01227000
*                       /*********************************************/ 01228000
*                       /*                                           */ 01229000
*                       /* PRINT THIS COMPLETE LINE                  */ 01230000
*                       /*                                           */ 01231000
*                       /*********************************************/ 01232000
*                                                                  0519 01233000
*                       IF FFMFMTF = ON                            0519 01234000
*                         THEN                                     0519 01235000
         TM    FFMFMTF,B'00000001'                                 0519 01236000
         BNO   @RF00519                                            0519 01237000
*                           DO;                                    0520 01238000
*                                                                  0520 01239000
*                             CALL LINEPRT;                        0521 01240000
*                                                                  0521 01241000
         BAL   @14,LINEPRT                                         0521 01242000
*                             RESPECIFY RTNREG RSTD;               0522 01243000
*                             TESTRC = RTNREG;                     0523 01244000
         STH   RTNREG,TESTRC                                       0523 01245000
*                             RESPECIFY RTNREG UNRSTD;             0524 01246000
*                             IF TESTRC ^= 0                       0525 01247000
*                               THEN                               0525 01248000
         LH    @04,TESTRC                                          0525 01249000
         LTR   @04,@04                                             0525 01250000
         BZ    @RF00525                                            0525 01251000
*                                 CALL ICKSAEP0(GDTTBL,MODID,RCQUIT);   01252000
         MVC   @AL00001+4(8),@AL00526                              0526 01253000
         ST    GDTPR,@AL00001                                      0526 01254000
         L     @15,GDTEPL(,GDTPR)                                  0526 01255000
         LA    @01,@AL00001                                        0526 01256000
         BALR  @14,@15                                             0526 01257000
*                             IF FFMPMSF = ON     /* REDO A MESSAGE */  01258000
*                               THEN                               0527 01259000
@RF00525 TM    FFMPMSF,B'00010000'                                 0527 01260000
         BNO   @RF00527                                            0527 01261000
*                                 PCTPMN = -1;                     0528 01262000
         MVC   PCTPMN(2,PCTPTR),@CH00786                           0528 01263000
*                           END;                                   0529 01264000
*                                                                  0529 01265000
@RF00527 DS    0H                                                  0530 01266000
*                       /*********************************************/ 01267000
*                       /*                                           */ 01268000
*                       /* REDUCE THE LOOPING COUNT BY ONE.          */ 01269000
*                       /*                                           */ 01270000
*                       /*********************************************/ 01271000
*                                                                  0530 01272000
*                       FFMREDOL = FFMREDOL - 1;                   0530 01273000
*                                                                  0530 01274000
@RF00519 LH    @04,FFMREDOL                                        0530 01275000
         BCTR  @04,0                                               0530 01276000
         STH   @04,FFMREDOL                                        0530 01277000
*                       /*********************************************/ 01278000
*                       /*                                           */ 01279000
*                       /* IF THE LOOP COUNT IS ZERO, THIS IS THE    */ 01280000
*                       /* LAST REPLICATION SO CLEAN UP AND END.     */ 01281000
*                       /*                                           */ 01282000
*                       /*********************************************/ 01283000
*                       IF FFMREDOL = 0 /* IS THIS THE LAST TIME     */ 01284000
*                         THEN                                     0531 01285000
         SLR   @15,@15                                             0531 01286000
         CR    @04,@15                                             0531 01287000
         BNE   @RF00531                                            0531 01288000
*                           DO;                                    0532 01289000
*                                                                  0532 01290000
*                             /* IF YES, CLEAR THE REDO FIELDS       */ 01291000
*                                                                  0533 01292000
*                             FFMREDOF = OFF;                      0533 01293000
*                             FFMIDINH = OFF;                      0534 01294000
         NI    FFMREDOF,B'01110111'                                0534 01295000
*                             FFMREDOS = 0;                        0535 01296000
         ST    @15,FFMREDOS                                        0535 01297000
*                             FFMRBOFF = 0;                        0536 01298000
         STH   @15,FFMRBOFF                                        0536 01299000
*                           END;                                   0537 01300000
*                         ELSE                                     0538 01301000
*                           DO;                                    0538 01302000
*                                                                  0538 01303000
         B     @RC00531                                            0538 01304000
@RF00531 DS    0H                                                  0539 01305000
*                             /***************************************/ 01306000
*                             /*                                     */ 01307000
*                             /* IF NOT, RESTORE TO START OF STRUCT  */ 01308000
*                             /* STEP THE INPUT OFFSET AND DO AGAIN  */ 01309000
*                             /*                                     */ 01310000
*                             /***************************************/ 01311000
*                                                                  0539 01312000
*                             FFMREDOC = REDOCSAV;                 0539 01313000
         LH    @04,REDOCSAV                                        0539 01314000
         STH   @04,FFMREDOC                                        0539 01315000
*                             FSADDR = FFMREDOS;                   0540 01316000
         L     FSADDR,FFMREDOS                                     0540 01317000
*                             STRSTP = 0;                          0541 01318000
         SLR   @04,@04                                             0541 01319000
         STH   @04,STRSTP                                          0541 01320000
*                             FFMRBOFF = FFMRBOFF + FFMREDOO;      0542 01321000
         LH    @04,FFMRBOFF                                        0542 01322000
         AH    @04,FFMREDOO                                        0542 01323000
         STH   @04,FFMRBOFF                                        0542 01324000
*                             FFMIDINH = ON;                       0543 01325000
         OI    FFMIDINH,B'00001000'                                0543 01326000
*                           END;                                   0544 01327000
*                     END;                                         0545 01328000
@RC00531 DS    0H                                                  0546 01329000
*               END;                                               0546 01330000
@RF00517 DS    0H                                                  0547 01331000
*             FFMPASS = OFF;                                       0547 01332000
@RF00514 DS    0H                                                  0548 01333000
*             FFMDATA = OFF;                                       0548 01334000
*                                                                  0548 01335000
         NI    FFMPASS,B'11101101'                                 0548 01336000
*         /***********************************************************/ 01337000
*         /*                                                         */ 01338000
*         /* CHECK FOR END OF THE SUB-STRUCTURE LIST AND SET END     */ 01339000
*         /* FLAG IF IT IS FINISHED.                                 */ 01340000
*         /* TO BE AT THE END OF THE STRUCTURE, REDO FLAG MUST BE    */ 01341000
*         /* OFF                                                     */ 01342000
*         /*                                                         */ 01343000
*         /***********************************************************/ 01344000
*                                                                  0549 01345000
*           IF FMTEOLF = ON & FFMREDOF = OFF                       0549 01346000
*             THEN                                                 0549 01347000
         TM    FMTEOLF(FSADDR),B'10000000'                         0549 01348000
         BNO   @RF00549                                            0549 01349000
         TM    FFMREDOF,B'10000000'                                0549 01350000
         BNZ   @RF00549                                            0549 01351000
*               FFMEOS = ON;                                       0550 01352000
*                                                                  0550 01353000
         OI    FFMEOS,B'01000000'                                  0550 01354000
*         /***********************************************************/ 01355000
*         /*                                                         */ 01356000
*         /* STEP TO THE NEXT SUB-STRUCTURE.                         */ 01357000
*         /* STRSTP CONTAINS THE INCREMENT TO STEP THE STRUCTURE     */ 01358000
*         /* BASE ADDRESS FOR ADDRESSING THE NEXT SUB-STRUCTURE.     */ 01359000
*         /*                                                         */ 01360000
*         /***********************************************************/ 01361000
*                                                                  0551 01362000
*           FSADDR = FSADDR + STRSTP;                              0551 01363000
@RF00549 AH    FSADDR,STRSTP                                       0551 01364000
*           FFMVS = OFF;                                           0552 01365000
*           FFMPINH = OFF;                                         0553 01366000
*                                                                  0553 01367000
         NI    FFMVS,B'00111111'                                   0553 01368000
*         /***********************************************************/ 01369000
*         /*                                                         */ 01370000
*         /* THE SUB-STRUCTURE HANDLING LOOP ENDS HERE.              */ 01371000
*         /*                                                         */ 01372000
*         /***********************************************************/ 01373000
*                                                                  0554 01374000
*         END STRLOOP;                                             0554 01375000
@DE00388 TM    FFMEOS,B'01000000'                                  0554 01376000
         BZ    @DL00388                                            0554 01377000
*         /***********************************************************/ 01378000
*         /*                                                         */ 01379000
*         /* THE SUB-STRUCTURE LOOP IS COMPLETED.  CLEAN UP          */ 01380000
*         /* AND RETURN TO THE CALLER.                               */ 01381000
*         /*                                                         */ 01382000
*         /***********************************************************/ 01383000
*                                                                  0555 01384000
*         IF FFMFMTF = ON                                          0555 01385000
*           THEN                                                   0555 01386000
         TM    FFMFMTF,B'00000001'                                 0555 01387000
         BNO   @RF00555                                            0555 01388000
*             DO;                                                  0556 01389000
*                                                                  0556 01390000
*               CALL LINEPRT;                                      0557 01391000
*                                                                  0557 01392000
         BAL   @14,LINEPRT                                         0557 01393000
*               RESPECIFY RTNREG RSTD;                             0558 01394000
*               TESTRC = RTNREG;                                   0559 01395000
         STH   RTNREG,TESTRC                                       0559 01396000
*               RESPECIFY RTNREG UNRSTD;                           0560 01397000
*               SAVERC = TESTRC;                                   0561 01398000
         LH    @03,TESTRC                                          0561 01399000
         STH   @03,SAVERC                                          0561 01400000
*             END;                                                 0562 01401000
*         IF GDTDBG = NULLPTR                                      0563 01402000
*           THEN;                                                  0563 01403000
@RF00555 L     @03,GDTDBG(,GDTPR)                                  0563 01404000
         LTR   @03,@03                                             0563 01405000
         BZ    @RT00563                                            0563 01406000
*           ELSE                                                   0565 01407000
*             CALL ICKDB010 (GDTTBL,'TP1N');                       0565 01408000
*                                                                  0565 01409000
         ST    GDTPR,@AL00001                                      0565 01410000
         LA    @03,@CC00800                                        0565 01411000
         ST    @03,@AL00001+4                                      0565 01412000
         MVI   @AL00001+4,X'80'                                    0565 01413000
         L     @15,GDTDBG(,GDTPR)                                  0565 01414000
         LA    @01,@AL00001                                        0565 01415000
         BALR  @14,@15                                             0565 01416000
*         CALL ICKSAEP0(GDTTBL,MODID,SAVERC);                      0566 01417000
@RT00563 ST    GDTPR,@AL00001                                      0566 01418000
         LA    @03,MODID                                           0566 01419000
         ST    @03,@AL00001+4                                      0566 01420000
         LA    @03,SAVERC                                          0566 01421000
         ST    @03,@AL00001+8                                      0566 01422000
         MVI   @AL00001+8,X'80'                                    0566 01423000
         L     @15,GDTEPL(,GDTPR)                                  0566 01424000
         LA    @01,@AL00001                                        0566 01425000
         BALR  @14,@15                                             0566 01426000
*         /***********************************************************/ 01427000
*         /*                                                         */ 01428000
*         /*  PROCEDURE NAME - SPACE CONTROL PROCEDURE.              */ 01429000
*         /*                                                         */ 01430000
*         /* FUNCTION - THIS PROCEDURE SETS UP SPACING DICTATED BY   */ 01431000
*         /* SPACE SUB-STRUCTURE IN THE FORMAT LIST.  IN ADDITION,   */ 01432000
*         /* IT CAUSES THE PRINTING OF A LINE EACH TIME THIS ITEM    */ 01433000
*         /* IS ENCOUNTERED AFTER ANY DATA IS FORMATTED.             */ 01434000
*         /*                                                         */ 01435000
*         /* INPUT - INPUT IS THE SPACING SUB-STRUCTURE AS DEFINED   */ 01436000
*         /* BY THE FORMAT STRUCTURED ARGUMENT LIST IN THE GLOBAL    */ 01437000
*         /* INCLUDE.                                                */ 01438000
*         /*                                                         */ 01439000
*         /* OUTPUT - THE SPACING SET UP IN THE PRINT ARGUMENT LIST  */ 01440000
*         /* PASSED TO THE LINE PRINT PROCEDURE.(LINEPRT)            */ 01441000
*         /* SEE CVPSTRU IN THIS LISTING.                            */ 01442000
*         /*                                                         */ 01443000
*         /***********************************************************/ 01444000
*                                                                  0567 01445000
*SPACE:   PROC;                                                    0567 01446000
*                                                                  0567 01447000
*                                                                  0567 01448000
         B     @PB00002                                            0567 01449000
SPACE    STM   @14,@06,@SA00002                                    0567 01450000
         STM   @08,@12,@SA00002+36                                 0567 01451000
*         /***********************************************************/ 01452000
*         /*                                                         */ 01453000
*         /* IF THIS IS NOT THE FIRST PASS, PRINT THE LINE.          */ 01454000
*         /* FFMPASS IS TURNED ON BY THE FIRST ENTRY TO THE          */ 01455000
*         /* CONVERSION ROUTINE.                                     */ 01456000
*         /*                                                         */ 01457000
*         /***********************************************************/ 01458000
*                                                                  0568 01459000
*         IF FFMPASS = OFF                                         0568 01460000
*           THEN                                                   0568 01461000
         TM    FFMPASS,B'00010000'                                 0568 01462000
         BNZ   @RF00568                                            0568 01463000
*             DO;                                                  0569 01464000
*               IF FFMFMTF = ON                                    0570 01465000
*                 THEN                                             0570 01466000
         TM    FFMFMTF,B'00000001'                                 0570 01467000
         BNO   @RF00570                                            0570 01468000
*                   DO;                                            0571 01469000
*                                                                  0571 01470000
*                     CALL LINEPRT;                                0572 01471000
*                                                                  0572 01472000
         BAL   @14,LINEPRT                                         0572 01473000
*                     RESPECIFY RTNREG RSTD;                       0573 01474000
*                     TESTRC = RTNREG;                             0574 01475000
         STH   RTNREG,TESTRC                                       0574 01476000
*                     RESPECIFY RTNREG UNRSTD;                     0575 01477000
*                     IF TESTRC > 0                                0576 01478000
*                       THEN                                       0576 01479000
         LH    @06,TESTRC                                          0576 01480000
         LTR   @06,@06                                             0576 01481000
         BNP   @RF00576                                            0576 01482000
*                         RETURN CODE (RCQUIT);                    0577 01483000
         LH    @15,RCQUIT                                          0577 01484000
         L     @14,@SA00002                                        0577 01485000
         LM    @00,@06,@SA00002+8                                  0577 01486000
         LM    @08,@12,@SA00002+36                                 0577 01487000
         BR    @14                                                 0577 01488000
*                   END;                                           0578 01489000
@RF00576 DS    0H                                                  0579 01490000
*             END;                                                 0579 01491000
*                                                                  0579 01492000
@RF00570 DS    0H                                                  0580 01493000
*         /***********************************************************/ 01494000
*         /*                                                         */ 01495000
*         /* SET UP THE SPACING ARGUMENTS FOR THIS SUB-STRUCTURE.    */ 01496000
*         /*                                                         */ 01497000
*         /***********************************************************/ 01498000
*                                                                  0580 01499000
*         PRTSPF = FMTSPF;              /* SET SPACING FACTOR.       */ 01500000
@RF00568 LH    @06,FMTSPF(,FSADDR)                                 0580 01501000
         STH   @06,PRTSPF                                          0580 01502000
*         PRTSPT = FMTSPT;              /* SET SPACING TYPE.         */ 01503000
         MVC   PRTSPT(1),FMTSPT(FSADDR)                            0581 01504000
*         STRSTP = 6;                   /* SET FORMAT LIST STEPPING  */ 01505000
         MVC   STRSTP(2),@CH00114                                  0582 01506000
*         FFMPASS = OFF;                /* ASSURE 1ST PASS SWITCH OFF*/ 01507000
*                                                                  0583 01508000
         NI    FFMPASS,B'11101111'                                 0583 01509000
*         /***********************************************************/ 01510000
*         /*                                                         */ 01511000
*         /* END OF THE SPACE PROCEDURE.                             */ 01512000
*         /*                                                         */ 01513000
*         /***********************************************************/ 01514000
*                                                                  0584 01515000
*         RETURN CODE (0);                                         0584 01516000
         SLR   @15,@15                                             0584 01517000
         L     @14,@SA00002                                        0584 01518000
         LM    @00,@06,@SA00002+8                                  0584 01519000
         LM    @08,@12,@SA00002+36                                 0584 01520000
         BR    @14                                                 0584 01521000
*         END SPACE;                                               0585 01522000
*         /***********************************************************/ 01523000
*         /*                                                         */ 01524000
*         /* PROCEDURE NAME - REPLICATION INITIALIZATION             */ 01525000
*         /*                                                         */ 01526000
*         /* FUNCTION - INITIALIZES PARAMETERS TO CONTROL THE REDO   */ 01527000
*         /* OPERATION.                                              */ 01528000
*         /*                                                         */ 01529000
*         /* INPUT - THE REDO SUB-STRUCTURE OF THE FORMAT ARGUMENT   */ 01530000
*         /* AS DESCRIBED IN THE GLOBAL INCLUDE.  (FMTLIST)          */ 01531000
*         /*                                                         */ 01532000
*         /* OUTPUT - THE PARAMETERS CONTROLLING THE REPLICATION AS  */ 01533000
*         /* FOLLOWS.                                                */ 01534000
*         /*                                                         */ 01535000
*         /* FFMREDOF - A FLAG INDICATING REDO IS IN PROCESS.        */ 01536000
*         /* FFMREDOC - THE COUNT OF THE NUMBER OF SUB-STRUCTURES    */ 01537000
*         /*            REDO IS TO SPAN.                             */ 01538000
*         /* REDOCSAV - A SAVE AREA FOR THE COUNT.                   */ 01539000
*         /* FFMREDOL - THE COUNT OF THE NUMBER OF TIMES TO REDO.    */ 01540000
*         /* FFMREDOO - THE INPUT DATA BLOCK OFFSET FOR EACH REDO.   */ 01541000
*         /* FFMREDOS - THE ADDRESS OF THE FIRST SUB-STRUCTURE OF    */ 01542000
*         /*            THE SET.                                     */ 01543000
*         /*                                                         */ 01544000
*         /***********************************************************/ 01545000
*                                                                  0586 01546000
*REDO:    PROC;                                                    0586 01547000
*                                                                  0586 01548000
REDO     STM   @14,@06,@SA00003                                    0586 01549000
         STM   @08,@12,@SA00003+36                                 0586 01550000
*         /***********************************************************/ 01551000
*         /*                                                         */ 01552000
*         /* ASSURE THAT THIS IS NOT A NESTED REDO SUB-STRUCTURE.    */ 01553000
*         /*                                                         */ 01554000
*         /***********************************************************/ 01555000
*                                                                  0587 01556000
*         IF FFMREDOF = ON                                         0587 01557000
*           THEN                                                   0587 01558000
         TM    FFMREDOF,B'10000000'                                0587 01559000
         BNO   @RF00587                                            0587 01560000
*             DO;                                                  0588 01561000
*                                                                  0588 01562000
*               CALL ERROR (4);                                    0589 01563000
*                                                                  0589 01564000
         LA    @01,@AL00589                                        0589 01565000
         BAL   @14,ERROR                                           0589 01566000
*               FFMREDOC = 0;             /* ZERO CURR STRU COUNT.   */ 01567000
         SLR   @15,@15                                             0590 01568000
         STH   @15,FFMREDOC                                        0590 01569000
*               FFMREDOL = 0;             /* ZERO CURRENT LOOP COUNT */ 01570000
         STH   @15,FFMREDOL                                        0591 01571000
*               STRSTP = 8;               /* SET FMT LIST STEP COUNT */ 01572000
         MVC   STRSTP(2),@CH00156                                  0592 01573000
*               RETURN ;                                           0593 01574000
@EL00003 DS    0H                                                  0593 01575000
@EF00003 DS    0H                                                  0593 01576000
@ER00003 LM    @14,@06,@SA00003                                    0593 01577000
         LM    @08,@12,@SA00003+36                                 0593 01578000
         BR    @14                                                 0593 01579000
*             END;                                                 0594 01580000
*                                                                  0594 01581000
*         /***********************************************************/ 01582000
*         /*                                                         */ 01583000
*         /* LOCATE THE DYNAMIC DATA ARGUMENT LIST TO OBTAIN THE     */ 01584000
*         /* DYNAMIC DATA FOR THE REDO.  THIS INCLUDES THE NUMBER    */ 01585000
*         /* OF TIMES TO LOOP THROUGH THE STRUCTURES                 */ 01586000
*         /*                                                         */ 01587000
*         /***********************************************************/ 01588000
*                                                                  0595 01589000
*           DO DSINDX = 1 TO DARGCNT BY 1 WHILE DARGREP(DSINDX) ^= 0595 01590000
*               FMTRFNO;                                           0595 01591000
@RF00587 LA    @15,1                                               0595 01592000
         ST    @15,DSINDX                                          0595 01593000
         B     @DE00595                                            0595 01594000
@DL00595 LR    @14,@15                                             0595 01595000
         SLA   @14,3                                               0595 01596000
         LH    @14,DARGREP-8(@14,DDSTRU)                           0595 01597000
         CH    @14,FMTRFNO(,FSADDR)                                0595 01598000
         BE    @DC00595                                            0595 01599000
*           END;                                                   0596 01600000
*                                                                  0596 01601000
         AL    @15,@CF00160                                        0596 01602000
         ST    @15,DSINDX                                          0596 01603000
@DE00595 CH    @15,DARGCNT(,DDSTRU)                                0596 01604000
         BNH   @DL00595                                            0596 01605000
@DC00595 DS    0H                                                  0597 01606000
*         /***********************************************************/ 01607000
*         /*                                                         */ 01608000
*         /* SET THE REDO PARAMETERS IF DYNAMIC ARGUMENT FOUND.      */ 01609000
*         /*                                                         */ 01610000
*         /***********************************************************/ 01611000
*                                                                  0597 01612000
*         IF DSINDX <= DARGCNT                                     0597 01613000
*           THEN                                                   0597 01614000
         L     @15,DSINDX                                          0597 01615000
         CH    @15,DARGCNT(,DDSTRU)                                0597 01616000
         BH    @RF00597                                            0597 01617000
*             DO;                                                  0598 01618000
*               FFMREDOL = DARGPCT(DSINDX);                        0599 01619000
         SLA   @15,3                                               0599 01620000
         LH    @15,DARGPCT-8(@15,DDSTRU)                           0599 01621000
         STH   @15,FFMREDOL                                        0599 01622000
*               FFMREDOF = ON;          /* TURN REDO FLAG ON.        */ 01623000
         OI    FFMREDOF,B'10000000'                                0600 01624000
*               FFMREDOS = FSADDR + 8;  /* REDO START SUB-STRU       */ 01625000
         LA    @15,8                                               0601 01626000
         ALR   @15,FSADDR                                          0601 01627000
         ST    @15,FFMREDOS                                        0601 01628000
*               FFMREDOC = FMTTRBC;     /* REDO SUB-STRUC COUNT.     */ 01629000
         LH    @15,FMTTRBC(,FSADDR)                                0602 01630000
         STH   @15,FFMREDOC                                        0602 01631000
*               REDOCSAV = FFMREDOC;    /* SAVE IT.                  */ 01632000
         STH   @15,REDOCSAV                                        0603 01633000
*               FFMREDOO = FMTRIO;      /* REDO INPUT OFFSET.        */ 01634000
         LH    @15,FMTRIO(,FSADDR)                                 0604 01635000
         STH   @15,FFMREDOO                                        0604 01636000
*             END;                                                 0605 01637000
*         STRSTP = 8;                   /* STRUCTURE STEP = 8.       */ 01638000
*                                                                  0606 01639000
@RF00597 MVC   STRSTP(2),@CH00156                                  0606 01640000
*         /***********************************************************/ 01641000
*         /*                                                         */ 01642000
*         /* IF DYNAMIC ARGUMENT SUB-STRUCTURE NOT FOUND IGNORE THE  */ 01643000
*         /* REPLICATION BLOCK AND CONTINUE ON.                      */ 01644000
*         /*                                                         */ 01645000
*         /***********************************************************/ 01646000
*                                                                  0607 01647000
*         RETURN;                                                  0607 01648000
         B     @EL00003                                            0607 01649000
*         END REDO;                                                0608 01650000
*         /***********************************************************/ 01651000
*         /*                                                         */ 01652000
*         /* PROCEDURE NAME - STATIC TEXT SET UP.                    */ 01653000
*         /*                                                         */ 01654000
*         /* FUNCTION - SETS UP THE CONVERSION ARGUMENT LIST FOR A   */ 01655000
*         /* STATIC TEXT SUB-STRUCTURE.                              */ 01656000
*         /*                                                         */ 01657000
*         /* INPUT - THE STATIC TEXT SUB-STRUCTURE OF THE FORMAT     */ 01658000
*         /*         LIST.  (FMTLIST)                                */ 01659000
*         /*                                                         */ 01660000
*         /* OUTPUT - ARGUMENTS IN THE CONVERSION CALL. (CVPSTRU)    */ 01661000
*         /*                                                         */ 01662000
*         /***********************************************************/ 01663000
*                                                                  0609 01664000
*STATIC:  PROC;                                                    0609 01665000
*                                                                  0609 01666000
STATIC   STM   @14,@12,12(@13)                                     0609 01667000
*         CVPIADD = FFMSTRS + FMTSTO;   /* INPUT DATA ADDRESS.       */ 01668000
         LH    @15,FMTSTO(,FSADDR)                                 0610 01669000
         AL    @15,FFMSTRS                                         0610 01670000
         ST    @15,CVPIADD                                         0610 01671000
*         CVPIL = FMTSTL;               /* INPUT DATA LENGTH.        */ 01672000
         LH    @15,FMTSTL(,FSADDR)                                 0611 01673000
         ST    @15,CVPIL                                           0611 01674000
*         STRSTP = 12;                  /* FMT STRUCTURE STEP COUNT  */ 01675000
         MVC   STRSTP(2),@CH00034                                  0612 01676000
*         RETURN;                                                  0613 01677000
*                                                                  0613 01678000
@EL00004 DS    0H                                                  0613 01679000
@EF00004 DS    0H                                                  0613 01680000
@ER00004 LM    @14,@12,12(@13)                                     0613 01681000
         BR    @14                                                 0613 01682000
*         END STATIC;                                              0614 01683000
*         /***********************************************************/ 01684000
*         /*                                                         */ 01685000
*         /* PROCEDURE NAME - BLOCK DATA SET UP.                     */ 01686000
*         /*                                                         */ 01687000
*         /* FUNCTION - SET UP CONVERSION ARGUMENTS FOR BLOCK DATA.  */ 01688000
*         /*                                                         */ 01689000
*         /* INPUT - THE BLOCK DATA SUB-STRUCTURE OF THE FORMAT      */ 01690000
*         /*         LIST.  (FMTLIST)                                */ 01691000
*         /*                                                         */ 01692000
*         /* OUTPUT - ARGUMENTS IN THE CONVERSION CALL.  (CVPSTRU)   */ 01693000
*         /*                                                         */ 01694000
*         /***********************************************************/ 01695000
*                                                                  0615 01696000
*BLOCK:   PROC;                                                    0615 01697000
*                                                                  0615 01698000
BLOCK    STM   @14,@12,12(@13)                                     0615 01699000
*          IF DARGFULL = ON                                        0616 01700000
*            THEN                                                  0616 01701000
         CLC   DARGFULL(4),@CF00463                                0616 01702000
         BNE   @RF00616                                            0616 01703000
*              DARGILP1 = DARGRETP;                                0617 01704000
         L     @07,DARGRETP(,DDSTRU)                               0617 01705000
         ST    @07,DARGILP1                                        0617 01706000
*            ELSE                                                  0618 01707000
*              DARGILP2 = DARGILP;                                 0618 01708000
*                                                                  0618 01709000
         B     @RC00616                                            0618 01710000
@RF00616 LH    @07,DARGILP(,DDSTRU)                                0618 01711000
         STH   @07,DARGILP2                                        0618 01712000
*         CVPIADD = FFMBDP + FFMRBOFF + FMTIOFF;                   0619 01713000
*                                                                  0619 01714000
@RC00616 LH    @07,FFMRBOFF                                        0619 01715000
         AL    @07,FFMBDP                                          0619 01716000
         LH    @15,FMTIOFF(,FSADDR)                                0619 01717000
         ALR   @07,@15                                             0619 01718000
         ST    @07,CVPIADD                                         0619 01719000
*         IF FMTILEN > (DARGILP1-FMTIOFF) | FMTILEN = 0            0620 01720000
*           THEN                                                   0620 01721000
         LH    @07,FMTILEN(,FSADDR)                                0620 01722000
         LCR   @15,@15                                             0620 01723000
         AL    @15,DARGILP1                                        0620 01724000
         CR    @07,@15                                             0620 01725000
         BH    @RT00620                                            0620 01726000
         LTR   @07,@07                                             0620 01727000
         BNZ   @RF00620                                            0620 01728000
@RT00620 DS    0H                                                  0621 01729000
*             CVPIL = (DARGILP1-FMTIOFF);                          0621 01730000
         L     @07,DARGILP1                                        0621 01731000
         SH    @07,FMTIOFF(,FSADDR)                                0621 01732000
         ST    @07,CVPIL                                           0621 01733000
*           ELSE                                                   0622 01734000
*             CVPIL = FMTILEN;                                     0622 01735000
         B     @RC00620                                            0622 01736000
@RF00620 LH    @07,FMTILEN(,FSADDR)                                0622 01737000
         ST    @07,CVPIL                                           0622 01738000
*         STRSTP = 12;                                             0623 01739000
*                                                                  0623 01740000
@RC00620 MVC   STRSTP(2),@CH00034                                  0623 01741000
*         RETURN;                                                  0624 01742000
*                                                                  0624 01743000
@EL00005 DS    0H                                                  0624 01744000
@EF00005 DS    0H                                                  0624 01745000
@ER00005 LM    @14,@12,12(@13)                                     0624 01746000
         BR    @14                                                 0624 01747000
*         END BLOCK;                                               0625 01748000
*         /***********************************************************/ 01749000
*         /*                                                         */ 01750000
*         /* PROCEDURE NAME - INSERT DATA HANDLER.                   */ 01751000
*         /*                                                         */ 01752000
*         /* FUNCTION - THIS PROCEDURE SETS UP THE CONVERSION        */ 01753000
*         /* ARGUMENT LISTS FOR INSERT DATA FORMAT SUB-STRUCTURES.   */ 01754000
*         /* (SEE FMTLIST). IT SEARCHES THE DYNAMIC DATA STRUCTURE   */ 01755000
*         /* FOR THE GIVEN REFERENCE NUMBER AND IF FOUND, SETS UP    */ 01756000
*         /* THE DATA ARGUMENTS FROM IT.  IF NO FIND IS MADE, IT WILL*/ 01757000
*         /* EXAMINE THE NEXT SUB-STRUCTURE IN THE LIST TO SEE IF IT */ 01758000
*         /* IS A DEFAULT DATA SUB-STRUCTURE.  IF IT IS, IT WILL SET */ 01759000
*         /* UP THE STATIC TEXT ASSOCIATED WITH IT.  IF IT IS NOT,   */ 01760000
*         /* THIS STRUCTURE WILL BE IGNORED BY TURNING ON THE PRINT  */ 01761000
*         /* INHIBIT FLAG. (FFMPINH)                                 */ 01762000
*         /*                                                         */ 01763000
*         /* INPUT - THE INSERT DATA SUB-STRUCTURE AND DYNAMIC DATA  */ 01764000
*         /* SUB-STRUCTURE AS DEFINED IN FMTLIST AND DARGLIST        */ 01765000
*         /*                                                         */ 01766000
*         /* OUTPUT - THE DATA ARGUMENTS IN THE PRINT ARGUMENT LIST. */ 01767000
*         /* (CVPSTRU)                                               */ 01768000
*         /*                                                         */ 01769000
*         /***********************************************************/ 01770000
*                                                                  0626 01771000
*INSERT:  PROC;                                                    0626 01772000
*                                                                  0626 01773000
INSERT   STM   @14,@02,12(@13)                                     0626 01774000
         STM   @04,@12,36(@13)                                     0626 01775000
*         IF FFMIDINH = OFF             /* INSERT INHIBITED IN REDO  */ 01776000
*           THEN                                                   0627 01777000
         TM    FFMIDINH,B'00001000'                                0627 01778000
         BNZ   @RF00627                                            0627 01779000
*             DO;                                                  0628 01780000
*                                                                  0628 01781000
*             /*******************************************************/ 01782000
*             /*                                                     */ 01783000
*             /* SEARCH THE DYNAMIC LIST (DARGLIST) FOR THE          */ 01784000
*             /* REFERENCE NUMBER GIVEN.                             */ 01785000
*             /*                                                     */ 01786000
*             /*******************************************************/ 01787000
*                                                                  0629 01788000
*               DO DSINDX = 1 TO DARGCNT BY 1 WHILE DARGINS(DSINDX) ^=  01789000
*                   FMTRFNO;                                       0629 01790000
         LA    @07,1                                               0629 01791000
         ST    @07,DSINDX                                          0629 01792000
         B     @DE00629                                            0629 01793000
@DL00629 LR    @15,@07                                             0629 01794000
         SLA   @15,3                                               0629 01795000
         LH    @15,DARGINS-8(@15,DDSTRU)                           0629 01796000
         CH    @15,FMTRFNO(,FSADDR)                                0629 01797000
         BE    @DC00629                                            0629 01798000
*               END;                                               0630 01799000
         AL    @07,@CF00160                                        0630 01800000
         ST    @07,DSINDX                                          0630 01801000
@DE00629 CH    @07,DARGCNT(,DDSTRU)                                0630 01802000
         BNH   @DL00629                                            0630 01803000
@DC00629 DS    0H                                                  0631 01804000
*               IF DSINDX <= DARGCNT                               0631 01805000
*                 THEN                                             0631 01806000
         L     @07,DSINDX                                          0631 01807000
         CH    @07,DARGCNT(,DDSTRU)                                0631 01808000
         BH    @RF00631                                            0631 01809000
*                   DO;                                            0632 01810000
*                                                                  0632 01811000
*                   /*************************************************/ 01812000
*                   /*                                               */ 01813000
*                   /* THE REFERENCE NUMBER IS FOUND.  SET UP THE    */ 01814000
*                   /* ARGUMENTS FROM THE FOUND LIST.                */ 01815000
*                   /*                                               */ 01816000
*                   /*************************************************/ 01817000
*                                                                  0633 01818000
*                     CVPIADD = DARGDTM(DSINDX);                   0633 01819000
         SLA   @07,3                                               0633 01820000
         L     @15,DARGDTM-8(@07,DDSTRU)                           0633 01821000
         ST    @15,CVPIADD                                         0633 01822000
*                     CVPIL = DARGINL(DSINDX);                     0634 01823000
         LH    @07,DARGINL-8(@07,DDSTRU)                           0634 01824000
         ST    @07,CVPIL                                           0634 01825000
*                   END;                                           0635 01826000
*                 ELSE                                             0636 01827000
*                   DO;                                            0636 01828000
*                                                                  0636 01829000
         B     @RC00631                                            0636 01830000
@RF00631 DS    0H                                                  0637 01831000
*                 /***************************************************/ 01832000
*                 /*                                                 */ 01833000
*                 /* STEP FORMAT STRUCTURE ADDRESS TO CHECK FOR A    */ 01834000
*                 /* POSSIBLE DEFAULT DATA STRUCTURE AS THE INSERT   */ 01835000
*                 /* ITEM WAS NOT FOUND IN THE DYNAMIC STRUCTURE.    */ 01836000
*                 /*                                                 */ 01837000
*                 /***************************************************/ 01838000
*                                                                  0637 01839000
*                     IF FMTEOLF = OFF                             0637 01840000
*                       THEN                                       0637 01841000
         TM    FMTEOLF(FSADDR),B'10000000'                         0637 01842000
         BNZ   @RF00637                                            0637 01843000
*                         DO;                                      0638 01844000
*                         FSADDR = FSADDR +12;                     0639 01845000
         AL    FSADDR,@CF00034                                     0639 01846000
*                         IF FMTDFF = ON                           0640 01847000
*                           THEN                                   0640 01848000
         TM    FMTDFF(FSADDR),B'00000010'                          0640 01849000
         BNO   @RF00640                                            0640 01850000
*                             DO;                                  0641 01851000
*                                                                  0641 01852000
*                         /*******************************************/ 01853000
*                         /*                                         */ 01854000
*                         /* A DEFAULT DATA SUB-STRUCTURE IS FOUND.  */ 01855000
*                         /* SET UP THE ARGUMENTS FROM IT.           */ 01856000
*                         /*                                         */ 01857000
*                         /*******************************************/ 01858000
*                                                                  0642 01859000
*                               CVPIADD = FFMSTRS + FMTSTO;        0642 01860000
         LH    @07,FMTSTO(,FSADDR)                                 0642 01861000
         AL    @07,FFMSTRS                                         0642 01862000
         ST    @07,CVPIADD                                         0642 01863000
*                               CVPIL = FMTSTL;                    0643 01864000
         LH    @07,FMTSTL(,FSADDR)                                 0643 01865000
         ST    @07,CVPIL                                           0643 01866000
*                             END;                                 0644 01867000
*                           ELSE                                   0645 01868000
*                             DO;                                  0645 01869000
*                                                                  0645 01870000
         B     @RC00640                                            0645 01871000
@RF00640 DS    0H                                                  0646 01872000
*                 /***************************************************/ 01873000
*                 /*                                                 */ 01874000
*                 /* NO DEFAULT DATA STRUCTURE WAS FOUND SO RESTORE  */ 01875000
*                 /* THE FORMAT STRUCTURE ADDRESS TO ITS ORIGINAL    */ 01876000
*                 /* SETTING AND SUPPRESS CONVERSION AND PRINTING    */ 01877000
*                 /* FOR THIS SUB-STRUCTURE.                         */ 01878000
*                 /*                                                 */ 01879000
*                 /***************************************************/ 01880000
*                                                                  0646 01881000
*                               FFMPINH = ON;                      0646 01882000
         OI    FFMPINH,B'10000000'                                 0646 01883000
*                               FSADDR = FSADDR - 12;              0647 01884000
         SL    FSADDR,@CF00034                                     0647 01885000
*                             END;                                 0648 01886000
*                         END;                                     0649 01887000
*                       ELSE                                       0650 01888000
*                         FFMPINH = ON;                            0650 01889000
         B     @RC00637                                            0650 01890000
@RF00637 OI    FFMPINH,B'10000000'                                 0650 01891000
*                   END;                                           0651 01892000
*             END;                                                 0652 01893000
*           ELSE                                                   0653 01894000
*             FFMPINH = ON;             /* INHIBIT INSERT ON A REDO. */ 01895000
         B     @RC00627                                            0653 01896000
@RF00627 OI    FFMPINH,B'10000000'                                 0653 01897000
*           STRSTP = 12;                                           0654 01898000
@RC00627 MVC   STRSTP(2),@CH00034                                  0654 01899000
*         END INSERT;                                              0655 01900000
@EL00006 DS    0H                                                  0655 01901000
@EF00006 DS    0H                                                  0655 01902000
@ER00006 LM    @14,@02,12(@13)                                     0655 01903000
         LM    @04,@12,36(@13)                                     0655 01904000
         BR    @14                                                 0655 01905000
*/********************************************************************/ 01906000
*/*                                                                  */ 01907000
*/* PROCEDURE NAME - DATA CONVERSION PROCEDURE.                      */ 01908000
*/*                                                                  */ 01909000
*/* FUNCTION - CONVERTS DATA TO A PRINTABLE FORM.  CONVERSIONS       */ 01910000
*/*      PROVIDED ARE:                                               */ 01911000
*/*        EBCDIC TO CHARACTER.                                      */ 01912000
*/*        BINARY TO HEXIDECIMAL.                                    */ 01913000
*/*        BINARY TO HEXIDECIMAL ENCLOSED AS X'NNNN'                 */ 01914000
*/*        BINARY TO HEXIDECIMAL DUMP FORMAT.                        */ 01915000
*/*        PACKED DECIMAL TO UNPACKED DECIMAL.                       */ 01916000
*/*        BINARY TO UNPACKED DECIMAL.                               */ 01917000
*/*                                                                  */ 01918000
*/* INPUT - THE CONVERSION ARGUMENT LIST CVPSTRU.                    */ 01919000
*/*                                                                  */ 01920000
*/* OUTPUT - THE CONVERTED DATA IN THE PRINT BUFFER (PRTBUFF)        */ 01921000
*/*      OR MORE THAN ONE PRINTED LINE IF PRINT LINE OVERFLOW        */ 01922000
*/*      OCCURS AS A RESULT OF THE DATA BEING MORE THAN THE LENGTH   */ 01923000
*/*      OF THE PRINT BUFFER.                                        */ 01924000
*/*                                                                  */ 01925000
*/********************************************************************/ 01926000
*                                                                  0656 01927000
*CONVERT: PROCEDURE;                                               0656 01928000
*                                                                  0656 01929000
CONVERT  STM   @14,@06,@SA00007                                    0656 01930000
         STM   @08,@12,@SA00007+36                                 0656 01931000
*         OLDERID2 = NEWERID2;                                     0657 01932000
         L     @06,GDTTR2(,GDTPR)                                  0657 01933000
         MVC   @TS00001(95),NEWERID2(@06)                          0657 01934000
         MVC   OLDERID2(95,@06),@TS00001                           0657 01935000
*         NEWID2 = 'TP2I';                                         0658 01936000
*                                                                  0658 01937000
         MVC   NEWID2(4,@06),@CC00819                              0658 01938000
*         CVFLAG = '0000'X;             /* CLEAR THE FLAG BYTES.     */ 01939000
*                                                                  0659 01940000
         MVC   CVFLAG(2),@CB00820                                  0659 01941000
*         IF GDTDBG = NULLPTR                                      0660 01942000
*           THEN;                                                  0660 01943000
         L     @06,GDTDBG(,GDTPR)                                  0660 01944000
         LTR   @06,@06                                             0660 01945000
         BZ    @RT00660                                            0660 01946000
*           ELSE                                                   0662 01947000
*             CALL ICKDB010 (GDTTBL,'TP2I');                       0662 01948000
*                                                                  0662 01949000
         ST    GDTPR,@AL00001                                      0662 01950000
         LA    @06,@CC00819                                        0662 01951000
         ST    @06,@AL00001+4                                      0662 01952000
         MVI   @AL00001+4,X'80'                                    0662 01953000
         L     @15,GDTDBG(,GDTPR)                                  0662 01954000
         LA    @01,@AL00001                                        0662 01955000
         BALR  @14,@15                                             0662 01956000
*         /***********************************************************/ 01957000
*         /*                                                         */ 01958000
*         /* CHECK FOR POSSIBLE PRINT LINE OVERFLOW AND SET UP TO    */ 01959000
*         /* HANDLE IT.                                              */ 01960000
*         /*                                                         */ 01961000
*         /***********************************************************/ 01962000
*                                                                  0663 01963000
*         IF (CVPPADD - ADDR(PRTBUFF) + CVPOL) > PCTPLW            0663 01964000
*           THEN                                                   0663 01965000
@RT00660 LA    @06,PRTBUFF                                         0663 01966000
         LCR   @06,@06                                             0663 01967000
         AL    @06,CVPPADD                                         0663 01968000
         AL    @06,CVPOL                                           0663 01969000
         C     @06,PCTPLW(,PCTPTR)                                 0663 01970000
         BNH   @RF00663                                            0663 01971000
*             DO;                                                  0664 01972000
*               PLOVF = ON;                                        0665 01973000
         OI    PLOVF,B'10000000'                                   0665 01974000
*             END;                                                 0666 01975000
*                                                                  0666 01976000
*         /***********************************************************/ 01977000
*         /*                                                         */ 01978000
*         /* SET UP REMAINING PARAMETERS FOR THE INITIAL SEGMENT.    */ 01979000
*         /*                                                         */ 01980000
*         /***********************************************************/ 01981000
*                                                                  0667 01982000
*         CVSL = CVPOL;                 /* SET COMPLET OUTPUT LENGTH */ 01983000
@RF00663 L     CVSL,CVPOL                                          0667 01984000
*         CVSTA = CVPPADD;              /* SET PRINT START.          */ 01985000
         L     CVSTA,CVPPADD                                       0668 01986000
*         FMRIL = CVPIL;                /* SET REMAINING INPUT LEN.  */ 01987000
         L     @04,CVPIL                                           0669 01988000
         ST    @04,FMRIL                                           0669 01989000
*         FMRIP = CVPIADD;              /* SET REMAINING INPUT LOC.  */ 01990000
         L     @04,CVPIADD                                         0670 01991000
         ST    @04,FMRIP                                           0670 01992000
*         /***********************************************************/ 01993000
*         /*                                                         */ 01994000
*         /* TEST FOR EITHER BYTE TO HEXIDECIMAL OR HEXIDECIMAL      */ 01995000
*         /* APOSTROPHE CONVERSION AND CALL BHCONV PROCEDURE IF ON.  */ 01996000
*         /*                                                         */ 01997000
*         /***********************************************************/ 01998000
*                                                                  0671 01999000
*         IF CVPBH = ON | CVPBHA = ON                              0671 02000000
*           THEN                                                   0671 02001000
*                                                                  0671 02002000
         TM    CVPBH,B'11000000'                                   0671 02003000
         BZ    @RF00671                                            0671 02004000
*             CALL BHCONV;                                         0672 02005000
*                                                                  0672 02006000
         BAL   @14,BHCONV                                          0672 02007000
*         /***********************************************************/ 02008000
*         /*                                                         */ 02009000
*         /* IF BYTE TO HEXIDECIMAL DUMP CONVERSION IS ON            */ 02010000
*         /* THEN CALL BHDCONV PROCEDURE.                            */ 02011000
*         /*                                                         */ 02012000
*         /***********************************************************/ 02013000
*                                                                  0673 02014000
*         IF CVPBHD = ON                                           0673 02015000
*           THEN                                                   0673 02016000
*                                                                  0673 02017000
@RF00671 TM    CVPBHD,B'00100000'                                  0673 02018000
         BNO   @RF00673                                            0673 02019000
*             CALL BHDCONV;                                        0674 02020000
*                                                                  0674 02021000
         BAL   @14,BHDCONV                                         0674 02022000
*         /***********************************************************/ 02023000
*         /*                                                         */ 02024000
*         /* IF PACKED TO UNPACKED CONVERSION IS ON THEN CALL        */ 02025000
*         /* PUPCONV PROCEDURE.                                      */ 02026000
*         /*                                                         */ 02027000
*         /***********************************************************/ 02028000
*                                                                  0675 02029000
*         IF CVPPU = ON                                            0675 02030000
*           THEN                                                   0675 02031000
@RF00673 TM    CVPPU,B'00001000'                                   0675 02032000
         BNO   @RF00675                                            0675 02033000
*             DO;                                                  0676 02034000
*                                                                  0676 02035000
*               CALL PUPCONV;                                      0677 02036000
*                                                                  0677 02037000
         BAL   @14,PUPCONV                                         0677 02038000
*               RESPECIFY RTNREG RSTD;                             0678 02039000
*               TESTRC = RTNREG;                                   0679 02040000
         STH   RTNREG,TESTRC                                       0679 02041000
*               RESPECIFY RTNREG UNRSTD;                           0680 02042000
*               IF TESTRC > 0                                      0681 02043000
*                 THEN                                             0681 02044000
         LH    @04,TESTRC                                          0681 02045000
         LTR   @04,@04                                             0681 02046000
         BNP   @RF00681                                            0681 02047000
*                   RETURN CODE(TESTRC);                           0682 02048000
         LR    @15,@04                                             0682 02049000
         L     @14,@SA00007                                        0682 02050000
         LM    @00,@06,@SA00007+8                                  0682 02051000
         LM    @08,@12,@SA00007+36                                 0682 02052000
         BR    @14                                                 0682 02053000
*             END;                                                 0683 02054000
*                                                                  0683 02055000
@RF00681 DS    0H                                                  0684 02056000
*         /***********************************************************/ 02057000
*         /*                                                         */ 02058000
*         /* IF BINARY TO DECIMAL CONVERSION FLAG IS ON CALL BDCONV  */ 02059000
*         /*                                                         */ 02060000
*         /***********************************************************/ 02061000
*                                                                  0684 02062000
*         IF CVPBD = ON                                            0684 02063000
*           THEN                                                   0684 02064000
@RF00675 TM    CVPBD,B'00010000'                                   0684 02065000
         BNO   @RF00684                                            0684 02066000
*             DO;                                                  0685 02067000
*                                                                  0685 02068000
*               CALL BDCONV;                                       0686 02069000
*                                                                  0686 02070000
         BAL   @14,BDCONV                                          0686 02071000
*               RESPECIFY RTNREG RSTD;                             0687 02072000
*               TESTRC = RTNREG;                                   0688 02073000
         STH   RTNREG,TESTRC                                       0688 02074000
*               RESPECIFY RTNREG UNRSTD;                           0689 02075000
*               IF TESTRC > 0                                      0690 02076000
*                 THEN                                             0690 02077000
*                                                                  0690 02078000
         LH    @04,TESTRC                                          0690 02079000
         LTR   @04,@04                                             0690 02080000
         BNP   @RF00690                                            0690 02081000
*                   RETURN CODE(TESTRC);                           0691 02082000
*                                                                  0691 02083000
         LR    @15,@04                                             0691 02084000
         L     @14,@SA00007                                        0691 02085000
         LM    @00,@06,@SA00007+8                                  0691 02086000
         LM    @08,@12,@SA00007+36                                 0691 02087000
         BR    @14                                                 0691 02088000
*             END;                                                 0692 02089000
*                                                                  0692 02090000
@RF00690 DS    0H                                                  0693 02091000
*         /***********************************************************/ 02092000
*         /*                                                         */ 02093000
*         /* IF ALL CONVERSION FLAGS ARE OFF, THEN CONVERT THE LINE  */ 02094000
*         /* AS AN EBCDIC LINE BY CALLING EBCDIC.                    */ 02095000
*         /*                                                         */ 02096000
*         /***********************************************************/ 02097000
*                                                                  0693 02098000
*         IF CVPBH = OFF &                                         0693 02099000
*           CVPBHA = OFF &                                         0693 02100000
*           CVPBHD = OFF &                                         0693 02101000
*           CVPBD = OFF &                                          0693 02102000
*           CVPPU = OFF                                            0693 02103000
*           THEN                                                   0693 02104000
@RF00684 TM    CVPBH,B'11111000'                                   0693 02105000
         BNZ   @RF00693                                            0693 02106000
*             DO;                                                  0694 02107000
*                                                                  0694 02108000
*               CALL EBCDIC;                                       0695 02109000
*                                                                  0695 02110000
         BAL   @14,EBCDIC                                          0695 02111000
*               RESPECIFY RTNREG RSTD;                             0696 02112000
*               TESTRC = RTNREG;                                   0697 02113000
         STH   RTNREG,TESTRC                                       0697 02114000
*               RESPECIFY RTNREG UNRSTD;                           0698 02115000
*               IF TESTRC > 0                                      0699 02116000
*                 THEN                                             0699 02117000
         LH    @06,TESTRC                                          0699 02118000
         LTR   @06,@06                                             0699 02119000
         BNP   @RF00699                                            0699 02120000
*                   RETURN CODE(RCQUIT);                           0700 02121000
         LH    @15,RCQUIT                                          0700 02122000
         L     @14,@SA00007                                        0700 02123000
         LM    @00,@06,@SA00007+8                                  0700 02124000
         LM    @08,@12,@SA00007+36                                 0700 02125000
         BR    @14                                                 0700 02126000
*             END;                                                 0701 02127000
@RF00699 DS    0H                                                  0702 02128000
*         OLDERID2 = NEWERID2;                                     0702 02129000
@RF00693 L     @06,GDTTR2(,GDTPR)                                  0702 02130000
         MVC   @TS00001(95),NEWERID2(@06)                          0702 02131000
         MVC   OLDERID2(95,@06),@TS00001                           0702 02132000
*         NEWID2 = 'TP2N';                                         0703 02133000
*                                                                  0703 02134000
         MVC   NEWID2(4,@06),@CC00826                              0703 02135000
*         /***********************************************************/ 02136000
*         /*                                                         */ 02137000
*         /* SET THE RETURN CODE NEEDED AND RETURN TO THE FORMAT     */ 02138000
*         /* ROUTINE.                                                */ 02139000
*         /*                                                         */ 02140000
*         /***********************************************************/ 02141000
*                                                                  0704 02142000
*         IF PLOVF = ON                                            0704 02143000
*           THEN                                                   0704 02144000
         TM    PLOVF,B'10000000'                                   0704 02145000
         BNO   @RF00704                                            0704 02146000
*             SETRC = 4;                /* ADVISE FORMAT OF OVERFLOW */ 02147000
         LA    SETRC,4                                             0705 02148000
*           ELSE                                                   0706 02149000
*             SETRC = 0;                                           0706 02150000
*                                                                  0706 02151000
         B     @RC00704                                            0706 02152000
@RF00704 SLR   SETRC,SETRC                                         0706 02153000
*         IF GDTDBG = NULLPTR                                      0707 02154000
*           THEN;                                                  0707 02155000
@RC00704 L     @06,GDTDBG(,GDTPR)                                  0707 02156000
         LTR   @06,@06                                             0707 02157000
         BZ    @RT00707                                            0707 02158000
*           ELSE                                                   0709 02159000
*             CALL ICKDB010 (GDTTBL,'TP2N');                       0709 02160000
*                                                                  0709 02161000
         ST    GDTPR,@AL00001                                      0709 02162000
         LA    @06,@CC00826                                        0709 02163000
         ST    @06,@AL00001+4                                      0709 02164000
         MVI   @AL00001+4,X'80'                                    0709 02165000
         L     @15,GDTDBG(,GDTPR)                                  0709 02166000
         LA    @01,@AL00001                                        0709 02167000
         BALR  @14,@15                                             0709 02168000
*         RETURN CODE(SETRC);                                      0710 02169000
@RT00707 LR    @15,SETRC                                           0710 02170000
         L     @14,@SA00007                                        0710 02171000
         LM    @00,@06,@SA00007+8                                  0710 02172000
         LM    @08,@12,@SA00007+36                                 0710 02173000
         BR    @14                                                 0710 02174000
*         /***********************************************************/ 02175000
*         /*                                                         */ 02176000
*         /* PROCEDURE NAME - BINARY TO HEXADECIMAL CONVERSION.      */ 02177000
*         /*                                                         */ 02178000
*         /* FUNCTION - CONVERTS BINARY INPUT TO PRINTABLE           */ 02179000
*         /* HEXADECIMAL OUTPUT, PUTTING THE CONVERTED BYTES         */ 02180000
*         /* DIRECTLY INTO THE PRINT LINE.  UP TO 32K BYTES MAY BE   */ 02181000
*         /* TRANSLATED IN ANY ONE SEGMENT.                          */ 02182000
*         /*                                                         */ 02183000
*         /* INPUT - THE DATA INPUT POINTER  AND LENGTH              */ 02184000
*         /* (CONVL) AND THE POINTER TO THE PRINT LINE               */ 02185000
*         /* POSITION WHERE THE CONVERTED OUTPUT IS TO BE            */ 02186000
*         /* PLACED (CVSTA).                                         */ 02187000
*         /* IF BINARY TO HEXADECIMAL (WITHOUT APOSTROPHES)          */ 02188000
*         /* IS REQUESTED, AND                                       */ 02189000
*         /* IF THE INPUT LENGTH IS LARGE ENOUGH TO CAUSE THE PRINT  */ 02190000
*         /* LINE TO OVERFLOW, THEN THAT LINE WILL BE PRINTED AND    */ 02191000
*         /* FURTHER LINES WILL BE CONVERTED AND PRINTED UNTIL ALL OF*/ 02192000
*         /* THE INPUT DATA HAS BEEN CONVERTED.  IF THE PRINT LINE   */ 02193000
*         /* DOES NOT OVERFLOW, THEN NO PRINTING OCCURS HERE.        */ 02194000
*         /* CONVERSION FOR ALL LINES WILL BEGIN AT THE SAME POINT   */ 02195000
*         /* IN THE PRINT LINE AS THE FIRST LINE.                    */ 02196000
*         /*                                                         */ 02197000
*         /* OUTPUT - CONVERTED DATA IN THE PRINT LINE.              */ 02198000
*         /*                                                         */ 02199000
*         /***********************************************************/ 02200000
*                                                                  0711 02201000
*BHCONV:  PROC;                                                    0711 02202000
*                                                                  0711 02203000
BHCONV   STM   @14,@02,@SA00008                                    0711 02204000
         STM   @04,@05,@SA00008+20                                 0711 02205000
         STM   @08,@12,@SA00008+28                                 0711 02206000
*         /***********************************************************/ 02207000
*         /*                                                         */ 02208000
*         /* IF THIS IS A BYTE TO HEX APOST, SET THE LEADING X'.     */ 02209000
*         /*                                                         */ 02210000
*         /***********************************************************/ 02211000
*                                                                  0712 02212000
*         FMSIL = CONVL/2;                                         0712 02213000
*                                                                  0712 02214000
         LA    @04,2                                               0712 02215000
         L     @00,CONVL                                           0712 02216000
         SRDA  @00,32                                              0712 02217000
         DR    @00,@04                                             0712 02218000
         STH   @01,FMSIL                                           0712 02219000
*         IF CVPBHA = ON                                           0713 02220000
*           THEN                                                   0713 02221000
         TM    CVPBHA,B'01000000'                                  0713 02222000
         BNO   @RF00713                                            0713 02223000
*             DO;                                                  0714 02224000
*               CVPB(1:2) = 'X''';                                 0715 02225000
         MVC   CVPB(2,CVSTA),@CC00830                              0715 02226000
*               CVSTA = CVSTA + 2;                                 0716 02227000
*                                                                  0716 02228000
         ALR   CVSTA,@04                                           0716 02229000
*               /*****************************************************/ 02230000
*               /*                                                   */ 02231000
*               /* TRUNCATE BHA FORMAT AT END OF LINE                */ 02232000
*               /*                                                   */ 02233000
*               /*****************************************************/ 02234000
*               IF PLOVF = ON                                      0717 02235000
*                 THEN                                             0717 02236000
         TM    PLOVF,B'10000000'                                   0717 02237000
         BNO   @RF00717                                            0717 02238000
*                  FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF))     0718 02239000
*                          - 3) / 2;                               0718 02240000
         LA    @06,PRTBUFF                                         0718 02241000
         LCR   @06,@06                                             0718 02242000
         AL    @06,CVPPADD                                         0718 02243000
         LR    @00,@06                                             0718 02244000
         LCR   @00,@00                                             0718 02245000
         AL    @00,PCTPLW(,PCTPTR)                                 0718 02246000
         SL    @00,@CF00131                                        0718 02247000
         SRDA  @00,32                                              0718 02248000
         DR    @00,@04                                             0718 02249000
         STH   @01,FMSIL                                           0718 02250000
*               PLOVF = OFF;                                       0719 02251000
@RF00717 NI    PLOVF,B'01111111'                                   0719 02252000
*               CVSL = FMSIL + FMSIL;                              0720 02253000
         LH    @04,FMSIL                                           0720 02254000
         LR    CVSL,@04                                            0720 02255000
         ALR   CVSL,@04                                            0720 02256000
*             END;                                                 0721 02257000
*                                                                  0721 02258000
*           ELSE                                                   0722 02259000
*             IF PLOVF = ON                                        0722 02260000
*               THEN                                               0722 02261000
         B     @RC00713                                            0722 02262000
@RF00713 TM    PLOVF,B'10000000'                                   0722 02263000
         BNO   @RF00722                                            0722 02264000
*                 FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF)))     0723 02265000
*                         / 2;                                     0723 02266000
*                                                                  0723 02267000
         LA    @04,PRTBUFF                                         0723 02268000
         LCR   @04,@04                                             0723 02269000
         AL    @04,CVPPADD                                         0723 02270000
         LR    @00,@04                                             0723 02271000
         LCR   @00,@00                                             0723 02272000
         AL    @00,PCTPLW(,PCTPTR)                                 0723 02273000
         SRDA  @00,32                                              0723 02274000
         D     @00,@CF00111                                        0723 02275000
         STH   @01,FMSIL                                           0723 02276000
*         /***********************************************************/ 02277000
*         /*                                                         */ 02278000
*         /* CONVERT THE BYTE SEGMENT TO PRINTABLE HEXADECIMAL.      */ 02279000
*         /* CONVERSION IS DIRECTLY TO THE PRINT BUFFER.             */ 02280000
*         /*                                                         */ 02281000
*         /***********************************************************/ 02282000
*                                                                  0724 02283000
*         DO WHILE CVSL > 0;                                       0724 02284000
*                                                                  0724 02285000
@RF00722 DS    0H                                                  0724 02286000
@RC00713 B     @DE00724                                            0724 02287000
@DL00724 DS    0H                                                  0725 02288000
*         /***********************************************************/ 02289000
*         /*                                                         */ 02290000
*         /* THE FOLLOWING IS THE ACTUAL CONVERSION DO LOOP.         */ 02291000
*         /* CVCHR HOLDS THE TRANSLATE TABLE OFFSET FOR THE FIRST    */ 02292000
*         /* HALF BYTE.                                              */ 02293000
*         /* TTOFF HOLDS THE TRANSLATE TABLE OFFSET FOR THE SECOND   */ 02294000
*         /* HALF BYTE.                                              */ 02295000
*         /* BHTRTB IS THE TRANSLATE TABLE.                          */ 02296000
*         /* TRBUF HOLDS THE INPUT SOURCE.                           */ 02297000
*         /* CVPB HOLDS THE OUTPUT TRANSLATED DATA.                  */ 02298000
*         /*                                                         */ 02299000
*         /***********************************************************/ 02300000
*                                                                  0725 02301000
*           DO N = 1 TO FMSIL;                                     0725 02302000
         LA    N,1                                                 0725 02303000
         B     @DE00725                                            0725 02304000
@DL00725 DS    0H                                                  0726 02305000
*             CVPB(2*N-1) = BHTRTB(TRBUF(N)/16+1);                 0726 02306000
         LR    @04,N                                               0726 02307000
         ALR   @04,@04                                             0726 02308000
         ST    @04,@TF00001                                        0726 02309000
         ALR   @04,CVSTA                                           0726 02310000
         BCTR  @04,0                                               0726 02311000
         BCTR  @04,0                                               0726 02312000
         L     @01,FMRIP                                           0726 02313000
         BCTR  @01,0                                               0726 02314000
         SLR   @15,@15                                             0726 02315000
         IC    @15,TRBUF(N,@01)                                    0726 02316000
         LR    @14,@15                                             0726 02317000
         SRL   @14,4                                               0726 02318000
         LA    @01,BHTRTB(@14)                                     0726 02319000
         MVC   CVPB(1,@04),0(@01)                                  0726 02320000
*             CVPB(2*N) = BHTRTB((TRBUF(N) & '0F'X) + 1);          0727 02321000
         LR    @04,CVSTA                                           0727 02322000
         AL    @04,@TF00001                                        0727 02323000
         BCTR  @04,0                                               0727 02324000
         N     @15,@CF00831                                        0727 02325000
         LA    @14,BHTRTB(@15)                                     0727 02326000
         MVC   CVPB(1,@04),0(@14)                                  0727 02327000
*           END;                                                   0728 02328000
         AL    N,@CF00160                                          0728 02329000
@DE00725 CH    N,FMSIL                                             0728 02330000
         BNH   @DL00725                                            0728 02331000
*           CVSL = CVSL - FMSIL * 2;                               0729 02332000
*                                                                  0729 02333000
         LH    @04,FMSIL                                           0729 02334000
         ALR   @04,@04                                             0729 02335000
         SLR   CVSL,@04                                            0729 02336000
*         /***********************************************************/ 02337000
*         /*                                                         */ 02338000
*         /* IF NO PRINT LINE OVERFLOW, SET UP THE TRAILING '.       */ 02339000
*         /*                                                         */ 02340000
*         /***********************************************************/ 02341000
*                                                                  0730 02342000
*           IF PLOVF = OFF & CVPBHA = ON                           0730 02343000
*             THEN                                                 0730 02344000
         TM    PLOVF,B'10000000'                                   0730 02345000
         BNZ   @RF00730                                            0730 02346000
         TM    CVPBHA,B'01000000'                                  0730 02347000
         BNO   @RF00730                                            0730 02348000
*               DO;                                                0731 02349000
*                 IF CVSTA + 2*N <= ADDR(PRTBUFF) + PCTPLW         0732 02350000
*                   THEN                                           0732 02351000
         LR    @04,N                                               0732 02352000
         ALR   @04,@04                                             0732 02353000
         LR    @15,CVSTA                                           0732 02354000
         ALR   @15,@04                                             0732 02355000
         LA    @14,PRTBUFF                                         0732 02356000
         AL    @14,PCTPLW(,PCTPTR)                                 0732 02357000
         CR    @15,@14                                             0732 02358000
         BH    @RF00732                                            0732 02359000
*                     CVPB(2*N-1) = '''';                          0733 02360000
         ALR   @04,CVSTA                                           0733 02361000
         BCTR  @04,0                                               0733 02362000
         BCTR  @04,0                                               0733 02363000
         MVI   CVPB(@04),C''''                                     0733 02364000
*               END;                                               0734 02365000
*                                                                  0734 02366000
@RF00732 DS    0H                                                  0735 02367000
*           /*********************************************************/ 02368000
*           /*                                                       */ 02369000
*           /* SET ACTUAL PRINT COLUMN                               */ 02370000
*           /*                                                       */ 02371000
*           /*********************************************************/ 02372000
*                                                                  0735 02373000
*           PCTAPC = CVSTA + FMSIL + FMSIL - ADDR(PRTBUFF);        0735 02374000
*                                                                  0735 02375000
@RF00730 LH    @04,FMSIL                                           0735 02376000
         LR    @15,CVSTA                                           0735 02377000
         ALR   @15,@04                                             0735 02378000
         ALR   @15,@04                                             0735 02379000
         LA    @04,PRTBUFF                                         0735 02380000
         SLR   @15,@04                                             0735 02381000
         STH   @15,PCTAPC(,PCTPTR)                                 0735 02382000
*           IF CVPBHA = ON                                         0736 02383000
*             THEN                                                 0736 02384000
         TM    CVPBHA,B'01000000'                                  0736 02385000
         BNO   @RF00736                                            0736 02386000
*               PCTAPC = PCTAPC + 3;                               0737 02387000
*                                                                  0737 02388000
         AL    @15,@CF00131                                        0737 02389000
         STH   @15,PCTAPC(,PCTPTR)                                 0737 02390000
*         /***********************************************************/ 02391000
*         /*                                                         */ 02392000
*         /* SINCE A PRINT LINE OVER FLOW HAS OCCURRED, PRINT THE    */ 02393000
*         /* LINE JUST CONVERTED.                                    */ 02394000
*         /*                                                         */ 02395000
*         /***********************************************************/ 02396000
*                                                                  0738 02397000
*           IF PLOVF = ON                                          0738 02398000
*             THEN                                                 0738 02399000
@RF00736 TM    PLOVF,B'10000000'                                   0738 02400000
         BNO   @RF00738                                            0738 02401000
*               DO;                                                0739 02402000
*                                                                  0739 02403000
*                 CALL LINEPRT;                                    0740 02404000
*                                                                  0740 02405000
         BAL   @14,LINEPRT                                         0740 02406000
*                 RESPECIFY RTNREG RSTD;                           0741 02407000
*                 TESTRC = RTNREG;                                 0742 02408000
         STH   RTNREG,TESTRC                                       0742 02409000
*                 RESPECIFY RTNREG UNRSTD;                         0743 02410000
*                 IF TESTRC ^= 0                                   0744 02411000
*                   THEN                                           0744 02412000
         LH    @04,TESTRC                                          0744 02413000
         LTR   @04,@04                                             0744 02414000
         BZ    @RF00744                                            0744 02415000
*                     RETURN CODE(RCQUIT);                         0745 02416000
*                                                                  0745 02417000
         LH    @15,RCQUIT                                          0745 02418000
         L     @14,@SA00008                                        0745 02419000
         LM    @00,@02,@SA00008+8                                  0745 02420000
         LM    @04,@05,@SA00008+20                                 0745 02421000
         LM    @08,@12,@SA00008+28                                 0745 02422000
         BR    @14                                                 0745 02423000
*                 PRTSPF = 1;                                      0746 02424000
*                                                                  0746 02425000
@RF00744 MVC   PRTSPF(2),@CH00160                                  0746 02426000
*                 /***************************************************/ 02427000
*                 /*                                                 */ 02428000
*                 /* UPDATE FOR THE REPETITION IF PRINT LINE         */ 02429000
*                 /* OVERFLOW.                                       */ 02430000
*                 /*                                                 */ 02431000
*                 /***************************************************/ 02432000
*                                                                  0747 02433000
*                 FMRIP = FMRIP + FMSIL;                           0747 02434000
         LH    @04,FMSIL                                           0747 02435000
         AL    @04,FMRIP                                           0747 02436000
         ST    @04,FMRIP                                           0747 02437000
*                 CVSTA = CVPPADD;                                 0748 02438000
         L     @04,CVPPADD                                         0748 02439000
         LR    CVSTA,@04                                           0748 02440000
*                 IF CVSL > (ADDR(PRTBUFF) + PCTPLW - CVPPADD)     0749 02441000
*                   THEN                                           0749 02442000
         LA    @15,PRTBUFF                                         0749 02443000
         AL    @15,PCTPLW(,PCTPTR)                                 0749 02444000
         SLR   @15,@04                                             0749 02445000
         CR    CVSL,@15                                            0749 02446000
         BNH   @RF00749                                            0749 02447000
*                     FMSIL = (ADDR(PRTBUFF) + PCTPLW - CVPPADD)/2;     02448000
         LR    @00,@15                                             0750 02449000
         SRDA  @00,32                                              0750 02450000
         D     @00,@CF00111                                        0750 02451000
         STH   @01,FMSIL                                           0750 02452000
*                   ELSE                                           0751 02453000
*                     FMSIL = CVSL/2;                              0751 02454000
         B     @RC00749                                            0751 02455000
@RF00749 LR    @00,CVSL                                            0751 02456000
         SRDA  @00,32                                              0751 02457000
         D     @00,@CF00111                                        0751 02458000
         STH   @01,FMSIL                                           0751 02459000
*               END;                                               0752 02460000
@RC00749 DS    0H                                                  0753 02461000
*         END;                                                     0753 02462000
*                                                                  0753 02463000
@RF00738 DS    0H                                                  0753 02464000
@DE00724 SLR   @04,@04                                             0753 02465000
         CR    CVSL,@04                                            0753 02466000
         BH    @DL00724                                            0753 02467000
*         /***********************************************************/ 02468000
*         /*                                                         */ 02469000
*         /* CLEAN UP AND RETURN TO THE MAIN PROCEDURE.              */ 02470000
*         /*                                                         */ 02471000
*         /***********************************************************/ 02472000
*                                                                  0754 02473000
*         RETURN CODE (0);                                         0754 02474000
         LR    @15,@04                                             0754 02475000
         L     @14,@SA00008                                        0754 02476000
         LM    @00,@02,@SA00008+8                                  0754 02477000
         LM    @04,@05,@SA00008+20                                 0754 02478000
         LM    @08,@12,@SA00008+28                                 0754 02479000
         BR    @14                                                 0754 02480000
*         END BHCONV;                                              0755 02481000
*         /***********************************************************/ 02482000
*         /*                                                         */ 02483000
*         /* PROCEDURE NAME - BINARY TO HEX DUMP CONVERSION.         */ 02484000
*         /*                                                         */ 02485000
*         /* FUNCTION - CONVERTS BINARY INPUT TO DUMP FORMATTED      */ 02486000
*         /* OUTPUT.  CONVERSION ALWAYS BEGINS AT POSITION ONE IN    */ 02487000
*         /* THE PRINT LINE.                                         */ 02488000
*         /*                                                         */ 02489000
*         /* INPUT - THE DATA INPUT POINTER AND LENGTH.              */ 02490000
*         /*                                                         */ 02491000
*         /* OUTPUT - DUMP FORMATTED PRINT LINE(S).                  */ 02492000
*         /*                                                         */ 02493000
*         /***********************************************************/ 02494000
*                                                                  0756 02495000
*BHDCONV: PROC;                                                    0756 02496000
*                                                                  0756 02497000
BHDCONV  STM   @14,@06,@SA00009                                    0756 02498000
         STM   @08,@12,@SA00009+36                                 0756 02499000
*         /***********************************************************/ 02500000
*         /*                                                         */ 02501000
*         /* INITIALIZE THE OUTPUT INDEX COUNT AND SEGMENT LENGTH.   */ 02502000
*         /*                                                         */ 02503000
*         /***********************************************************/ 02504000
*                                                                  0757 02505000
*         OLDERID2 = NEWERID2;                                     0757 02506000
         L     @06,GDTTR2(,GDTPR)                                  0757 02507000
         MVC   @TS00001(95),NEWERID2(@06)                          0757 02508000
         MVC   OLDERID2(95,@06),@TS00001                           0757 02509000
*         NEWID2 = 'TP2M';                                         0758 02510000
         MVC   NEWID2(4,@06),@CC00836                              0758 02511000
*         HDINDEXB = 0;                                            0759 02512000
         SLR   @06,@06                                             0759 02513000
         STH   @06,HDINDEXB                                        0759 02514000
*         SETRC = 0;                                               0760 02515000
         SLR   SETRC,SETRC                                         0760 02516000
*         IF FMRIL > 32                                            0761 02517000
*           THEN                                                   0761 02518000
         LA    @06,32                                              0761 02519000
         C     @06,FMRIL                                           0761 02520000
         BNL   @RF00761                                            0761 02521000
*             FMSIL = 32;                                          0762 02522000
         STH   @06,FMSIL                                           0762 02523000
*           ELSE                                                   0763 02524000
*             FMSIL = FMRIL;                                       0763 02525000
*                                                                  0763 02526000
         B     @RC00761                                            0763 02527000
@RF00761 L     @06,FMRIL                                           0763 02528000
         STH   @06,FMSIL                                           0763 02529000
*         /***********************************************************/ 02530000
*         /*                                                         */ 02531000
*         /* THIS CODE BEGINS THE MAJOR CONVERSION LOOP.             */ 02532000
*         /*                                                         */ 02533000
*         /***********************************************************/ 02534000
*                                                                  0764 02535000
*         DO WHILE FMRIL > 0;                                      0764 02536000
@RC00761 B     @DE00764                                            0764 02537000
@DL00764 DS    0H                                                  0765 02538000
*           HDCVB(1:64) = ' ';                                     0765 02539000
*                                                                  0765 02540000
         MVI   HDCVB+1,C' '                                        0765 02541000
         MVC   HDCVB+2(62),HDCVB+1                                 0765 02542000
         MVI   HDCVB,C' '                                          0765 02543000
*         /***********************************************************/ 02544000
*         /*                                                         */ 02545000
*         /* SET THE EBCDIC PORTION OF THE HEX DUMP FORMAT.          */ 02546000
*         /*                                                         */ 02547000
*         /***********************************************************/ 02548000
*                                                                  0766 02549000
*           HDSEG3(1:FMSIL) = TRBUF;                               0766 02550000
         L     @04,CVPPADD                                         0766 02551000
         LH    @03,FMSIL                                           0766 02552000
         BCTR  @03,0                                               0766 02553000
         L     @01,FMRIP                                           0766 02554000
         EX    @03,@SM00915                                        0766 02555000
*           HDST1 = '*';                                           0767 02556000
         MVI   HDST1(@04),C'*'                                     0767 02557000
*           HDST2 = '*';                                           0768 02558000
*                                                                  0768 02559000
         MVI   HDST2(@04),C'*'                                     0768 02560000
*         /***********************************************************/ 02561000
*         /*                                                         */ 02562000
*         /* SET THE INDEX FOR THE FORMAT IN COLS 1 THROUGH 4.       */ 02563000
*         /* HDINDEXC(B) CONTAINS THE UPDATED INDEX TO BE TRANSLATED */ 02564000
*         /* HDINDEX IS THE INDEX LOCATION ON THE PRINT LINE.        */ 02565000
*         /*                                                         */ 02566000
*         /***********************************************************/ 02567000
*                                                                  0769 02568000
*           DO N = 1 TO 2 BY 1;                                    0769 02569000
         LA    N,1                                                 0769 02570000
@DL00769 DS    0H                                                  0770 02571000
*             HDINDEX(2*N-1) = BHTRTB(HDINDEXC(N)/16+1);           0770 02572000
         L     @06,CVPPADD                                         0770 02573000
         LR    @04,N                                               0770 02574000
         ALR   @04,@04                                             0770 02575000
         ST    @04,@TF00001                                        0770 02576000
         ALR   @04,@06                                             0770 02577000
         BCTR  @04,0                                               0770 02578000
         BCTR  @04,0                                               0770 02579000
         SLR   @03,@03                                             0770 02580000
         IC    @03,HDINDEXC-1(N)                                   0770 02581000
         SRL   @03,4                                               0770 02582000
         LA    @01,BHTRTB(@03)                                     0770 02583000
         MVC   HDINDEX(1,@04),0(@01)                               0770 02584000
*             HDINDEX(2*N) = BHTRTB((HDINDEXC(N) & '0F'X) + 1);    0771 02585000
         AL    @06,@TF00001                                        0771 02586000
         BCTR  @06,0                                               0771 02587000
         LA    @04,15                                              0771 02588000
         SLR   @03,@03                                             0771 02589000
         IC    @03,HDINDEXC-1(N)                                   0771 02590000
         NR    @04,@03                                             0771 02591000
         LA    @03,BHTRTB(@04)                                     0771 02592000
         MVC   HDINDEX(1,@06),0(@03)                               0771 02593000
*           END;                                                   0772 02594000
*                                                                  0772 02595000
         AL    N,@CF00160                                          0772 02596000
         C     N,@CF00111                                          0772 02597000
         BNH   @DL00769                                            0772 02598000
*         /***********************************************************/ 02599000
*         /*                                                         */ 02600000
*         /* CONVERT THE DUMP SEGMENTS FROM BYTE TO HEXADECIMAL.     */ 02601000
*         /* TRBUF  CONTAINS THE INPUT BYTE STRING TO BE TRANSLATED  */ 02602000
*         /* HDCVB CONTAINS THE TRANSLATED OUTPUT SEGMENTS.          */ 02603000
*         /*                                                         */ 02604000
*         /***********************************************************/ 02605000
*                                                                  0773 02606000
*           DO N = 1 TO FMSIL BY 1;                                0773 02607000
         LA    N,1                                                 0773 02608000
         B     @DE00773                                            0773 02609000
@DL00773 DS    0H                                                  0774 02610000
*             HDCVB(2*N-1) = BHTRTB(TRBUF(N)/16+1);                0774 02611000
         LR    @06,N                                               0774 02612000
         ALR   @06,@06                                             0774 02613000
         LA    @04,HDCVB-2(@06)                                    0774 02614000
         L     @03,FMRIP                                           0774 02615000
         BCTR  @03,0                                               0774 02616000
         SLR   @15,@15                                             0774 02617000
         IC    @15,TRBUF(N,@03)                                    0774 02618000
         LR    @03,@15                                             0774 02619000
         SRL   @03,4                                               0774 02620000
         LA    @01,BHTRTB(@03)                                     0774 02621000
         MVC   0(1,@04),0(@01)                                     0774 02622000
*             HDCVB(2*N) = BHTRTB((TRBUF(N) & '0F'X) + 1);         0775 02623000
         LA    @04,HDCVB-1(@06)                                    0775 02624000
         N     @15,@CF00831                                        0775 02625000
         LA    @06,BHTRTB(@15)                                     0775 02626000
         MVC   0(1,@04),0(@06)                                     0775 02627000
*           END;                                                   0776 02628000
*                                                                  0776 02629000
         AL    N,@CF00160                                          0776 02630000
@DE00773 CH    N,FMSIL                                             0776 02631000
         BNH   @DL00773                                            0776 02632000
*         /***********************************************************/ 02633000
*         /*                                                         */ 02634000
*         /* MOVE THE CONVERTED SEGMENTS TO THE PRINT BUFFER.        */ 02635000
*         /* HDSEG1 IS THE FIRST HALF (4 - 8 BYTE SEGMENTS) OF THE   */ 02636000
*         /* PRINT LINE.                                             */ 02637000
*         /* HDSEG2 IS THE SECOND HALF (4 - 8 BYTE SEGMENTS) OF THE  */ 02638000
*         /* PRINT LINE.                                             */ 02639000
*         /* HDCVB CONTAINS THE CONVERTED SEGMENTS WITH NO SPACES.   */ 02640000
*         /*                                                         */ 02641000
*         /***********************************************************/ 02642000
*                                                                  0777 02643000
*           J =1;                                                  0777 02644000
         LA    @04,1                                               0777 02645000
         LR    J,@04                                               0777 02646000
*           DO N = 1 TO 28 BY 9;                                   0778 02647000
         LR    N,@04                                               0778 02648000
@DL00778 DS    0H                                                  0779 02649000
*             HDSEG1(N:N+8) = HDCVB(J:J+7);                        0779 02650000
         L     @06,CVPPADD                                         0779 02651000
         LR    @04,@06                                             0779 02652000
         ALR   @04,N                                               0779 02653000
         MVI   HDSEG1+7(@04),C' '                                  0779 02654000
         LA    @01,HDCVB-1(J)                                      0779 02655000
         MVC   HDSEG1-1(8,@04),0(@01)                              0779 02656000
*             HDSEG2(N:N+8) = HDCVB(J+32:J+39);                    0780 02657000
         ALR   @06,N                                               0780 02658000
         MVI   HDSEG2+7(@06),C' '                                  0780 02659000
         LA    @04,HDCVB+31(J)                                     0780 02660000
         MVC   HDSEG2-1(8,@06),0(@04)                              0780 02661000
*             J = J+8;                                             0781 02662000
         AL    J,@CF00156                                          0781 02663000
*           END;                                                   0782 02664000
*                                                                  0782 02665000
         AL    N,@CF00254                                          0782 02666000
         C     N,@CF00288                                          0782 02667000
         BNH   @DL00778                                            0782 02668000
*         /***********************************************************/ 02669000
*         /*                                                         */ 02670000
*         /* CALL THE PRINT CALL SUB-ROUTINE TO PRINT THIS LINE.     */ 02671000
*         /*                                                         */ 02672000
*         /***********************************************************/ 02673000
*                                                                  0783 02674000
*         CALL LINEPRT;                                            0783 02675000
*                                                                  0783 02676000
         BAL   @14,LINEPRT                                         0783 02677000
*         RESPECIFY RTNREG RSTD;                                   0784 02678000
*         TESTRC = RTNREG;                                         0785 02679000
         STH   RTNREG,TESTRC                                       0785 02680000
*         RESPECIFY RTNREG UNRSTD;                                 0786 02681000
*         IF TESTRC ^= 0                                           0787 02682000
*           THEN                                                   0787 02683000
         LH    @06,TESTRC                                          0787 02684000
         LTR   @06,@06                                             0787 02685000
         BZ    @RF00787                                            0787 02686000
*             RETURN CODE(RCQUIT);                                 0788 02687000
*                                                                  0788 02688000
         LH    @15,RCQUIT                                          0788 02689000
         L     @14,@SA00009                                        0788 02690000
         LM    @00,@06,@SA00009+8                                  0788 02691000
         LM    @08,@12,@SA00009+36                                 0788 02692000
         BR    @14                                                 0788 02693000
*         PRTSPF = 1;                                              0789 02694000
*                                                                  0789 02695000
@RF00787 MVC   PRTSPF(2),@CH00160                                  0789 02696000
*         /***********************************************************/ 02697000
*         /*                                                         */ 02698000
*         /* UPDATE THE INPUT POINTERS FOR THE NEXT LINE.            */ 02699000
*         /*                                                         */ 02700000
*         /***********************************************************/ 02701000
*                                                                  0790 02702000
*           HDINDEXB = HDINDEXB + 32;   /* INCREMENT INDEX.          */ 02703000
         LA    @06,32                                              0790 02704000
         LH    @04,HDINDEXB                                        0790 02705000
         ALR   @04,@06                                             0790 02706000
         STH   @04,HDINDEXB                                        0790 02707000
*           FMRIP = FMRIP + FMSIL;      /* INCREMENT INPUT PTR.      */ 02708000
         LH    @04,FMSIL                                           0791 02709000
         L     @03,FMRIP                                           0791 02710000
         ALR   @03,@04                                             0791 02711000
         ST    @03,FMRIP                                           0791 02712000
*           FMRIL = FMRIL - FMSIL;      /* DECREMENT INPUT LENGTH.   */ 02713000
         LCR   @04,@04                                             0792 02714000
         AL    @04,FMRIL                                           0792 02715000
         ST    @04,FMRIL                                           0792 02716000
*           IF FMRIL > 32                                          0793 02717000
*             THEN                                                 0793 02718000
         CR    @04,@06                                             0793 02719000
         BNH   @RF00793                                            0793 02720000
*               FMSIL = 32;             /* SET SEGMENT LENGTH.       */ 02721000
         STH   @06,FMSIL                                           0794 02722000
*             ELSE                                                 0795 02723000
*               FMSIL = FMRIL;          /* SET SEGMENT LENGTH.       */ 02724000
         B     @RC00793                                            0795 02725000
@RF00793 L     @06,FMRIL                                           0795 02726000
         STH   @06,FMSIL                                           0795 02727000
*         END;                                                     0796 02728000
*                                                                  0796 02729000
@RC00793 DS    0H                                                  0796 02730000
@DE00764 SLR   @06,@06                                             0796 02731000
         C     @06,FMRIL                                           0796 02732000
         BL    @DL00764                                            0796 02733000
*         /***********************************************************/ 02734000
*         /*                                                         */ 02735000
*         /* CLEAN UP AND END THE BHD CONVERSION PROCEDURE.          */ 02736000
*         /*                                                         */ 02737000
*         /***********************************************************/ 02738000
*                                                                  0797 02739000
*         RETURN CODE (0);                                         0797 02740000
*                                                                  0797 02741000
         LR    @15,@06                                             0797 02742000
         L     @14,@SA00009                                        0797 02743000
         LM    @00,@06,@SA00009+8                                  0797 02744000
         LM    @08,@12,@SA00009+36                                 0797 02745000
         BR    @14                                                 0797 02746000
*         END BHDCONV;                                             0798 02747000
*         /***********************************************************/ 02748000
*         /*                                                         */ 02749000
*         /* PROCEDURE NAME - EBCDIC CONVERSION PROCEDURE.           */ 02750000
*         /*                                                         */ 02751000
*         /* FUNCTION - MOVES EBCDIC DATA TO BE PRINTED TO THE PRINT */ 02752000
*         /* LINE.                                                   */ 02753000
*         /* IF PRINT LINE OVERFLOW OCCURS, ALL LINES RESULTING FROM */ 02754000
*         /* THE OVERFLOW ARE PRINTED PRIOR TO RETURN TO ICKTP01.    */ 02755000
*         /*                                                         */ 02756000
*         /* INPUT - THE INPUT DATA POINTER AND LENGTH AND THE PRINT */ 02757000
*         /* POSITION ADDRESS.                                       */ 02758000
*         /*                                                         */ 02759000
*         /* OUTPUT - DATA FORMATTED ON THE PRINT LINE.              */ 02760000
*         /*                                                         */ 02761000
*         /***********************************************************/ 02762000
*                                                                  0799 02763000
*EBCDIC:  PROC;                                                    0799 02764000
*                                                                  0799 02765000
EBCDIC   STM   @14,@06,@SA00010                                    0799 02766000
         STM   @08,@12,@SA00010+36                                 0799 02767000
*         ALIGNBUF = ' ';               /* SET BUFFER BLANK          */ 02768000
*                                                                  0800 02769000
         MVI   ALIGNBUF+1,C' '                                     0800 02770000
         MVC   ALIGNBUF+2(118),ALIGNBUF+1                          0800 02771000
         MVI   ALIGNBUF,C' '                                       0800 02772000
*         IF PLOVF = ON                                            0801 02773000
*           THEN                                                   0801 02774000
         TM    PLOVF,B'10000000'                                   0801 02775000
         BNO   @RF00801                                            0801 02776000
*             DO;                                                  0802 02777000
*                                                                  0802 02778000
*             /*******************************************************/ 02779000
*             /*                                                     */ 02780000
*             /* IF PRINT LINE OVERFLOW WILL OCCUR, THEN THIS CODE   */ 02781000
*             /* WILL BREAK THE INPUT DATA INTO SEGMENTS AND PUT IT  */ 02782000
*             /* INTO THE PRINT LINE, INVOKING LINEPRT FOR EACH LINE */ 02783000
*             /* UNTIL ALL INPUT DATA HAS BEEN PRINTED.              */ 02784000
*             /*                                                     */ 02785000
*             /*******************************************************/ 02786000
*                                                                  0803 02787000
*               FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF)));      0803 02788000
         LA    @04,PRTBUFF                                         0803 02789000
         LCR   @04,@04                                             0803 02790000
         AL    @04,CVPPADD                                         0803 02791000
         LCR   @04,@04                                             0803 02792000
         AL    @04,PCTPLW(,PCTPTR)                                 0803 02793000
         STH   @04,FMSIL                                           0803 02794000
*               DO WHILE CVSL > 0;                                 0804 02795000
         B     @DE00804                                            0804 02796000
@DL00804 DS    0H                                                  0805 02797000
*                 CVPB(1:FMSIL) = TRBUF;                           0805 02798000
         LH    @04,FMSIL                                           0805 02799000
         LR    @15,@04                                             0805 02800000
         BCTR  @15,0                                               0805 02801000
         L     @14,FMRIP                                           0805 02802000
         EX    @15,@SM00917                                        0805 02803000
*                                       /* MOVE THE SEGMENT.         */ 02804000
*                 CVSL = CVSL - FMSIL;                             0806 02805000
         SLR   CVSL,@04                                            0806 02806000
*                                       /* STEP SEGMENT LENGTH.      */ 02807000
*                 FMRIP = FMRIP + FMSIL;                           0807 02808000
         ALR   @14,@04                                             0807 02809000
         ST    @14,FMRIP                                           0807 02810000
*                                       /* STEP THE INPUT POINTER.   */ 02811000
*                                                                  0808 02812000
*                 CALL LINEPRT;                                    0808 02813000
*                                                                  0808 02814000
         BAL   @14,LINEPRT                                         0808 02815000
*                 RESPECIFY RTNREG RSTD;                           0809 02816000
*                 TESTRC = RTNREG;                                 0810 02817000
         STH   RTNREG,TESTRC                                       0810 02818000
*                 RESPECIFY RTNREG UNRSTD;                         0811 02819000
*                   IF TESTRC > 0                                  0812 02820000
*                     THEN                                         0812 02821000
         LH    @04,TESTRC                                          0812 02822000
         LTR   @04,@04                                             0812 02823000
         BNP   @RF00812                                            0812 02824000
*                       RETURN CODE(RCQUIT);                       0813 02825000
*                                                                  0813 02826000
         LH    @15,RCQUIT                                          0813 02827000
         L     @14,@SA00010                                        0813 02828000
         LM    @00,@06,@SA00010+8                                  0813 02829000
         LM    @08,@12,@SA00010+36                                 0813 02830000
         BR    @14                                                 0813 02831000
*                 PRTSPF = 1;                                      0814 02832000
@RF00812 MVC   PRTSPF(2),@CH00160                                  0814 02833000
*                 CVSTA = CVPPADD;      /* RESET THE PRINT START ADDR*/ 02834000
         L     @04,CVPPADD                                         0815 02835000
         LR    CVSTA,@04                                           0815 02836000
*                 IF CVSL > (ADDR(PRTBUFF) + PCTPLW - CVPPADD)     0816 02837000
*                   THEN                /*IF MORE THAN ONE PRINT LINE*/ 02838000
         LA    @15,PRTBUFF                                         0816 02839000
         AL    @15,PCTPLW(,PCTPTR)                                 0816 02840000
         SLR   @15,@04                                             0816 02841000
         CR    CVSL,@15                                            0816 02842000
         BNH   @RF00816                                            0816 02843000
*                     FMSIL = (ADDR(PRTBUFF) + PCTPLW - CVPPADD);  0817 02844000
         STH   @15,FMSIL                                           0817 02845000
*                                       /* MOVE A COMPLETE SEGMENT.  */ 02846000
*                   ELSE                /* IF LESS THEN ONE LINE     */ 02847000
*                     DO;                                          0818 02848000
         B     @RC00816                                            0818 02849000
@RF00816 DS    0H                                                  0819 02850000
*                       FMSIL = CVSL;   /* SET LENGTH FOR REMAINDER  */ 02851000
         STH   CVSL,FMSIL                                          0819 02852000
*                       PCTAPC = 0;                                0820 02853000
         SLR   @04,@04                                             0820 02854000
         STH   @04,PCTAPC(,PCTPTR)                                 0820 02855000
*                     END;                                         0821 02856000
*               END;                                               0822 02857000
@RC00816 DS    0H                                                  0822 02858000
@DE00804 LTR   CVSL,CVSL                                           0822 02859000
         BP    @DL00804                                            0822 02860000
*             END;                                                 0823 02861000
*           ELSE                                                   0824 02862000
*             DO;                                                  0824 02863000
*                                                                  0824 02864000
         B     @RC00801                                            0824 02865000
@RF00801 DS    0H                                                  0825 02866000
*             /*******************************************************/ 02867000
*             /*                                                     */ 02868000
*             /* MOVE A PARTIAL LINE SEGMENT.                        */ 02869000
*             /*                                                     */ 02870000
*             /*******************************************************/ 02871000
*                                                                  0825 02872000
*               FMSIL = CVPOL;                                     0825 02873000
         L     @07,CVPOL                                           0825 02874000
         STH   @07,FMSIL                                           0825 02875000
*               ALIGNBUF(1:CVSL) = TRBUF;                          0826 02876000
*                                                                  0826 02877000
         LR    @07,CVSL                                            0826 02878000
         BCTR  @07,0                                               0826 02879000
         L     @04,FMRIP                                           0826 02880000
         EX    @07,@SM00919                                        0826 02881000
*               /*****************************************************/ 02882000
*               /*                                                   */ 02883000
*               /* LOCATE THE LAST NON BLANK CHARACTER AND SET THE   */ 02884000
*               /* OFFSET FOR BLANK SUPPRESSION.  IF ENTIRE FIELD    */ 02885000
*               /* IS BLANKS THEN PRINT BLANK FIELD.                 */ 02886000
*               /*                                                   */ 02887000
*               /*****************************************************/ 02888000
*                                                                  0827 02889000
*               DO N = CVSL TO 1 BY -1 WHILE ALIGNBUF(N) = ' ';    0827 02890000
         LR    N,CVSL                                              0827 02891000
         B     @DE00827                                            0827 02892000
@DL00827 LA    @04,ALIGNBUF-1(N)                                   0827 02893000
         CLI   0(@04),C' '                                         0827 02894000
         BNE   @DC00827                                            0827 02895000
*               END;                                               0828 02896000
*                                                                  0828 02897000
         BCTR  N,0                                                 0828 02898000
@DE00827 LTR   N,N                                                 0828 02899000
         BP    @DL00827                                            0828 02900000
@DC00827 DS    0H                                                  0829 02901000
*               IF N = 0 THEN N = CVSL;                            0829 02902000
*                                                                  0829 02903000
         LTR   N,N                                                 0829 02904000
         BNZ   @RF00829                                            0829 02905000
         LR    N,CVSL                                              0830 02906000
*               /*****************************************************/ 02907000
*               /*                                                   */ 02908000
*               /* MOVE LINE SEGMENT INTO PRINT BUFFER AND           */ 02909000
*               /* UPDATE THE AUTO PRINT COLUMN.                     */ 02910000
*               /*                                                   */ 02911000
*               /*****************************************************/ 02912000
*               IF FMTAR = ON & N ^= CVSL                          0831 02913000
*                 THEN                                             0831 02914000
@RF00829 CLC   FMTAR(4),@CF00463                                   0831 02915000
         BNE   @RF00831                                            0831 02916000
         CR    N,CVSL                                              0831 02917000
         BE    @RF00831                                            0831 02918000
*                   DO;                                            0832 02919000
*                   CVPB(CVSL-(N-1) : CVSL) = ALIGNBUF;            0833 02920000
         LA    @04,1                                               0833 02921000
         SLR   @04,N                                               0833 02922000
         ALR   @04,CVSL                                            0833 02923000
         ST    @04,@TF00001                                        0833 02924000
         ALR   @04,CVSTA                                           0833 02925000
         BCTR  @04,0                                               0833 02926000
         LR    @15,CVSL                                            0833 02927000
         SL    @15,@TF00001                                        0833 02928000
         EX    @15,@SM00921                                        0833 02929000
*                   PCTAPC = (CVSTA + CVSL -ADDR(PRTBUFF));        0834 02930000
         LR    @04,CVSTA                                           0834 02931000
         ALR   @04,CVSL                                            0834 02932000
         LA    @15,PRTBUFF                                         0834 02933000
         SLR   @04,@15                                             0834 02934000
         STH   @04,PCTAPC(,PCTPTR)                                 0834 02935000
*                   END;                                           0835 02936000
*                 ELSE                                             0836 02937000
*                   DO;                                            0836 02938000
         B     @RC00831                                            0836 02939000
@RF00831 DS    0H                                                  0837 02940000
*                   CVPB(1:CVSL) = ALIGNBUF;                       0837 02941000
         LR    @04,CVSL                                            0837 02942000
         BCTR  @04,0                                               0837 02943000
         EX    @04,@SM00923                                        0837 02944000
*                   PCTAPC = (CVSTA + N) - ADDR(PRTBUFF);          0838 02945000
         LR    @06,CVSTA                                           0838 02946000
         ALR   @06,N                                               0838 02947000
         LA    @04,PRTBUFF                                         0838 02948000
         SLR   @06,@04                                             0838 02949000
         STH   @06,PCTAPC(,PCTPTR)                                 0838 02950000
*                   END;                                           0839 02951000
*             END;                                                 0840 02952000
*                                                                  0840 02953000
@RC00831 DS    0H                                                  0841 02954000
*         /***********************************************************/ 02955000
*         /*                                                         */ 02956000
*         /* IF PCTPMN = -1 THEN THIS IS A MESSAGE LINE.  CONVERT    */ 02957000
*         /* THE MESSAGE NUMBER TO BINARY AND PUT IT BACK INTO PCTPMN*/ 02958000
*         /*                                                         */ 02959000
*         /***********************************************************/ 02960000
*                                                                  0841 02961000
*         IF PCTPMN = -1                                           0841 02962000
*           THEN                                                   0841 02963000
@RC00801 CLC   PCTPMN(2,PCTPTR),@CH00786                           0841 02964000
         BNE   @RF00841                                            0841 02965000
*             DO;                                                  0842 02966000
*               MSGNO = PRTBUFF(5:7);                              0843 02967000
         MVC   MSGNO(3),PRTBUFF+4                                  0843 02968000
*               GEN   (PACK  UNPKWD,MSGNO);                        0844 02969000
         PACK  UNPKWD,MSGNO                                             02970000
*               GEN   (CVB   CVDREG,UNPKWD);                       0845 02971000
         CVB   CVDREG,UNPKWD                                            02972000
*               PCTPMN = CVDREG;                                   0846 02973000
         STH   CVDREG,PCTPMN(,PCTPTR)                              0846 02974000
*             END;                                                 0847 02975000
*                                                                  0847 02976000
*         /***********************************************************/ 02977000
*         /*                                                         */ 02978000
*         /* CLEAN UP AND END THE EBCDIC PRINT PROCEDURE.            */ 02979000
*         /*                                                         */ 02980000
*         /***********************************************************/ 02981000
*                                                                  0848 02982000
*         RETURN CODE (0);                                         0848 02983000
*                                                                  0848 02984000
@RF00841 SLR   @15,@15                                             0848 02985000
         L     @14,@SA00010                                        0848 02986000
         LM    @00,@06,@SA00010+8                                  0848 02987000
         LM    @08,@12,@SA00010+36                                 0848 02988000
         BR    @14                                                 0848 02989000
*         END EBCDIC;                                              0849 02990000
*         /***********************************************************/ 02991000
*         /*                                                         */ 02992000
*         /* PROCEDURE NAME - PACKED TO UNPACKED DECIMAL CONVERSION. */ 02993000
*         /*                                                         */ 02994000
*         /* FUNCTION - THIS PROCEDURE CONVERTS PACKED TO UNPACKED   */ 02995000
*         /* DECIMAL DATA. IT IS CALLED BY THE BINARY TO DECIMAL     */ 02996000
*         /* PROCEDURE IN ADDITION TO HANDLING STRAIGHT PACKED TO    */ 02997000
*         /* UNPACKED.  IT IS, THEREFORE USED TO HANDLE ALL SIGN     */ 02998000
*         /* CONTROL, LEFT ALIGNMENT AND ZERO SUPPRESSION.           */ 02999000
*         /*                                                         */ 03000000
*         /* INPUT - THE INPUT DATA POINTER, DATA LENGTH, OUTPUT     */ 03001000
*         /* PRINT POSITION POINTER, ALIGN LEFT FLAG, ZERO SUPPRESS  */ 03002000
*         /* FLAG AND SIGN SUPPRESS FLAG.                            */ 03003000
*         /*                                                         */ 03004000
*         /* OUTPUT - CONVERTED DATA IN THE PRINT LINE.  PRINT LINE  */ 03005000
*         /* OVERFLOW DOES NOT OCCUR ON PACKED TO UNPACKED CONVERTS. */ 03006000
*         /* IF THE CONDITION OCCURS, THE DATA OUT IS TRUNCATED.     */ 03007000
*         /*                                                         */ 03008000
*         /***********************************************************/ 03009000
*                                                                  0850 03010000
*PUPCONV: PROC;                                                    0850 03011000
*                                                                  0850 03012000
PUPCONV  STM   @14,@06,12(@13)                                     0850 03013000
         STM   @08,@12,52(@13)                                     0850 03014000
*         PLOVF = OFF;                  /* OVERFLOW NOT ALLOWED.     */ 03015000
         NI    PLOVF,B'01111111'                                   0851 03016000
*         SETRC = 0;                                               0852 03017000
*                                                                  0852 03018000
         SLR   SETRC,SETRC                                         0852 03019000
*         /***********************************************************/ 03020000
*         /*                                                         */ 03021000
*         /* INITIALIZE COUNTERS USED FOR PACKED TO UNPACKED.        */ 03022000
*         /* INITIALIZE FLAGS TO CONTROL ZERO SUPPRESS & LEFT ALIGN  */ 03023000
*         /*                                                         */ 03024000
*         /***********************************************************/ 03025000
*                                                                  0853 03026000
*         PUPOCT = 1;                                              0853 03027000
         LA    @07,1                                               0853 03028000
         STH   @07,PUPOCT                                          0853 03029000
*         PUPPSC = 1;                                              0854 03030000
         LR    PUPPSC,@07                                          0854 03031000
*         IF CVPZS = OFF                /* IS IT ZERO SUPPRESS.      */ 03032000
*           THEN                                                   0855 03033000
         TM    CVPZS,B'10000000'                                   0855 03034000
         BNZ   @RF00855                                            0855 03035000
*             PUPPSF = ON;              /* SET TO PRINT ZEROS.       */ 03036000
         OI    PUPPSF,B'01000000'                                  0856 03037000
*           ELSE                                                   0857 03038000
*             PUPPSF = OFF;             /* SET TO SUPPRESS ZEROS.    */ 03039000
         B     @RC00855                                            0857 03040000
@RF00855 NI    PUPPSF,B'10111111'                                  0857 03041000
*         IF CVPAL = OFF                /* IS IT ALIGN LEFT.         */ 03042000
*           THEN                                                   0858 03043000
@RC00855 TM    CVPAL,B'01000000'                                   0858 03044000
         BNZ   @RF00858                                            0858 03045000
*             PUPIOF = ON;              /* SUPPRESS OUTPUT POINTER   */ 03046000
         OI    PUPIOF,B'00100000'                                  0859 03047000
*                                       /* STEPPING IF IT IS.        */ 03048000
*           ELSE                                                   0860 03049000
*             PUPIOF = OFF;             /* ALLOW OUTPUT PTR STEPPING */ 03050000
*                                                                  0860 03051000
         B     @RC00858                                            0860 03052000
@RF00858 NI    PUPIOF,B'11011111'                                  0860 03053000
*         /***********************************************************/ 03054000
*         /*                                                         */ 03055000
*         /* BEGIN THE CONVERSION LOOP HERE.                         */ 03056000
*         /*                                                         */ 03057000
*         /***********************************************************/ 03058000
*                                                                  0861 03059000
*         OLDERID2 = NEWERID2;                                     0861 03060000
@RC00858 L     @07,GDTTR2(,GDTPR)                                  0861 03061000
         MVC   @TS00001(95),NEWERID2(@07)                          0861 03062000
         MVC   OLDERID2(95,@07),@TS00001                           0861 03063000
*         NEWID2 = 'TP2D';                                         0862 03064000
         MVC   NEWID2(4,@07),@CC00846                              0862 03065000
*         IF CVPPU = ON                                            0863 03066000
*           THEN                                                   0863 03067000
         TM    CVPPU,B'00001000'                                   0863 03068000
         BNO   @RF00863                                            0863 03069000
*             FMSIL = CVPIL;            /* SET PACKED TO UNPACKED    */ 03070000
         L     @07,CVPIL                                           0864 03071000
         STH   @07,FMSIL                                           0864 03072000
*                                       /* LENGTH FIELD.             */ 03073000
*                                                                  0865 03074000
*         /***********************************************************/ 03075000
*         /*                                                         */ 03076000
*         /* SET UP THE SIGN UNDER CONTROL OF THE SIGN SUPPRESS FLAG */ 03077000
*         /* IN THE INPUT PARAMETERS.                                */ 03078000
*         /*                                                         */ 03079000
*         /***********************************************************/ 03080000
*                                                                  0865 03081000
*         IF CVPSS = OFF                /* IS SIGN SUPPRESS OFF.     */ 03082000
*           THEN                                                   0865 03083000
@RF00863 TM    CVPSS,B'00100000'                                   0865 03084000
         BNZ   @RF00865                                            0865 03085000
*             DO;                                                  0866 03086000
*               SIGNT = (TRBUF(FMSIL) & '0F'X);                    0867 03087000
         LH    @01,FMSIL                                           0867 03088000
         LA    SIGNT,15                                            0867 03089000
         L     @15,FMRIP                                           0867 03090000
         BCTR  @15,0                                               0867 03091000
         SLR   @14,@14                                             0867 03092000
         IC    @14,TRBUF(@01,@15)                                  0867 03093000
         NR    SIGNT,@14                                           0867 03094000
*                                       /* GET THE SIGN.             */ 03095000
*               IF SIGNT = 11 | SIGNT = 13                         0868 03096000
*                                       /* IF IT IS EITHER, MINUS.   */ 03097000
*                 THEN                                             0868 03098000
         C     SIGNT,@CF00033                                      0868 03099000
         BE    @RT00868                                            0868 03100000
         C     SIGNT,@CF00259                                      0868 03101000
         BNE   @RF00868                                            0868 03102000
@RT00868 DS    0H                                                  0869 03103000
*                   SIGN = MINUS;       /* SET THE MINUS SIGN.       */ 03104000
         MVI   SIGN,C'-'                                           0869 03105000
*                 ELSE                                             0870 03106000
*                   SIGN = PLUS;        /* SET THE PLUS SIGN.        */ 03107000
         B     @RC00868                                            0870 03108000
@RF00868 MVI   SIGN,C'+'                                           0870 03109000
*               PUPPSC = PUPPSC + 1;    /* STEP PRINT BUFF PTR.      */ 03110000
@RC00868 AL    PUPPSC,@CF00160                                     0871 03111000
*             END;                                                 0872 03112000
*                                                                  0872 03113000
*         DO N = 1 TO FMSIL BY 1;                                  0873 03114000
*                                                                  0873 03115000
@RF00865 LA    N,1                                                 0873 03116000
         B     @DE00873                                            0873 03117000
@DL00873 DS    0H                                                  0874 03118000
*           /*********************************************************/ 03119000
*           /*                                                       */ 03120000
*           /* GET THE HIGH ORDER HALF BYTE AND CHECK FOR A VALID    */ 03121000
*           /* PACKED DECIMAL DIGIT.                                 */ 03122000
*           /*                                                       */ 03123000
*           /*********************************************************/ 03124000
*                                                                  0874 03125000
*           DECT = TRBUF(N)/16;         /* GET HIGH ORDER HALF CHAR  */ 03126000
         L     @01,FMRIP                                           0874 03127000
         BCTR  @01,0                                               0874 03128000
         SLR   @00,@00                                             0874 03129000
         IC    @00,TRBUF(N,@01)                                    0874 03130000
         SRL   @00,4                                               0874 03131000
         STH   @00,DECT                                            0874 03132000
*           IF DECT > 9                 /* COMPARE TO MAXIMUM.       */ 03133000
*             THEN                                                 0875 03134000
*                                                                  0875 03135000
         C     @00,@CF00254                                        0875 03136000
         BNH   @RF00875                                            0875 03137000
*             /*******************************************************/ 03138000
*             /*                                                     */ 03139000
*             /* RETURN TO THE CALLER ON A NON-VALID PACKED DECIMAL  */ 03140000
*             /* DECIMAL DIGIT.                                      */ 03141000
*             /*                                                     */ 03142000
*             /*******************************************************/ 03143000
*                                                                  0876 03144000
*               DO;                                                0876 03145000
*                 RETURN CODE (8);                                 0877 03146000
         LA    @15,8                                               0877 03147000
         L     @14,12(,@13)                                        0877 03148000
         LM    @00,@06,20(@13)                                     0877 03149000
         LM    @08,@12,52(@13)                                     0877 03150000
         BR    @14                                                 0877 03151000
*               END;                                               0878 03152000
*                                                                  0878 03153000
*             /*******************************************************/ 03154000
*             /*                                                     */ 03155000
*             /* MOVE THIS HALF BYTE TO THE OUTPUT BUFFER.           */ 03156000
*             /* UNDER CONTROL OF THE ALIGN LEFT AND ZERO SUPPRESS   */ 03157000
*             /* CONTROL FLAGS.                                      */ 03158000
*             /*                                                     */ 03159000
*             /*******************************************************/ 03160000
*                                                                  0879 03161000
*             IF DECT ^= 0              /* IS IT NON ZERO            */ 03162000
*               THEN                                               0879 03163000
@RF00875 LH    @15,DECT                                            0879 03164000
         LTR   @15,@15                                             0879 03165000
         BZ    @RF00879                                            0879 03166000
*                 DO;                                              0880 03167000
*                   PUPPSF = ON;        /* TURN PRINT START ON.      */ 03168000
*                   PUPIOF = ON;        /* TURN OUTPUT STEP ON.      */ 03169000
         OI    PUPPSF,B'01100000'                                  0882 03170000
*                 END;                                             0883 03171000
*             IF FMSIL*2 - PUPOCT <=CVPOL                          0884 03172000
*                                      /* CHECK OUTPUT START.        */ 03173000
*               THEN                                               0884 03174000
@RF00879 LH    @15,FMSIL                                           0884 03175000
         ALR   @15,@15                                             0884 03176000
         SH    @15,PUPOCT                                          0884 03177000
         C     @15,CVPOL                                           0884 03178000
         BH    @RF00884                                            0884 03179000
*                 DO;                                              0885 03180000
*                   IF PUPPSF = ON     /* IS PRINT START ON         */  03181000
*                     THEN                                         0886 03182000
         TM    PUPPSF,B'01000000'                                  0886 03183000
         BNO   @RF00886                                            0886 03184000
*                       DO;                                        0887 03185000
*                         CVPB(PUPPSC) = BHTRTB(DECT+1);           0888 03186000
         LR    @01,CVSTA                                           0888 03187000
         ALR   @01,PUPPSC                                          0888 03188000
         BCTR  @01,0                                               0888 03189000
         LH    @15,DECT                                            0888 03190000
         LA    @14,BHTRTB(@15)                                     0888 03191000
         MVC   CVPB(1,@01),0(@14)                                  0888 03192000
*                                       /* MOVE CONVERTED DIGIT.     */ 03193000
*                         IF SIGNPOS = OFF & CVPSS = OFF           0889 03194000
*                           THEN                                   0889 03195000
         TM    SIGNPOS,B'00010000'                                 0889 03196000
         BNZ   @RF00889                                            0889 03197000
         TM    CVPSS,B'00100000'                                   0889 03198000
         BNZ   @RF00889                                            0889 03199000
*                             DO;                                  0890 03200000
*                                                                  0890 03201000
*                             /***************************************/ 03202000
*                             /*                                     */ 03203000
*                             /* MOVE SIGN TO BUFFER.                */ 03204000
*                             /*                                     */ 03205000
*                             /***************************************/ 03206000
*                                                                  0891 03207000
*                               PUPPSC=PUPPSC-1;                   0891 03208000
         BCTR  PUPPSC,0                                            0891 03209000
*                               CVPB(PUPPSC) = SIGN;               0892 03210000
         LR    @01,CVSTA                                           0892 03211000
         ALR   @01,PUPPSC                                          0892 03212000
         BCTR  @01,0                                               0892 03213000
         MVC   CVPB(1,@01),SIGN                                    0892 03214000
*                               PUPPSC=PUPPSC+1;                   0893 03215000
         AL    PUPPSC,@CF00160                                     0893 03216000
*                               SIGNPOS = ON;                      0894 03217000
         OI    SIGNPOS,B'00010000'                                 0894 03218000
*                             END;                                 0895 03219000
*                       END;                                       0896 03220000
@RF00889 DS    0H                                                  0897 03221000
*                   IF PUPIOF = ON      /* CAN OUTPUT PTR BE STEPPED */ 03222000
*                     THEN                                         0897 03223000
@RF00886 TM    PUPIOF,B'00100000'                                  0897 03224000
         BNO   @RF00897                                            0897 03225000
*                       PUPPSC = PUPPSC + 1;                       0898 03226000
         AL    PUPPSC,@CF00160                                     0898 03227000
*                   IF CVSTA + PUPPSC > ADDR(PRTBUFF) + PCTPLW     0899 03228000
*                                       /* IS IT END OF LINE.        */ 03229000
*                     THEN                                         0899 03230000
@RF00897 LR    @15,CVSTA                                           0899 03231000
         ALR   @15,PUPPSC                                          0899 03232000
         LA    @14,PRTBUFF                                         0899 03233000
         AL    @14,PCTPLW(,PCTPTR)                                 0899 03234000
         CR    @15,@14                                             0899 03235000
         BNH   @RF00899                                            0899 03236000
*                       DO;                                        0900 03237000
*                         OLDERID2 = NEWERID2;                     0901 03238000
         L     @04,GDTTR2(,GDTPR)                                  0901 03239000
         MVC   @TS00001(95),NEWERID2(@04)                          0901 03240000
         MVC   OLDERID2(95,@04),@TS00001                           0901 03241000
*                         NEWID2 = 'TP2O';                         0902 03242000
         MVC   NEWID2(4,@04),@CC00847                              0902 03243000
*                         RETURN CODE(0);                          0903 03244000
         SLR   @15,@15                                             0903 03245000
         L     @14,12(,@13)                                        0903 03246000
         LM    @00,@06,20(@13)                                     0903 03247000
         LM    @08,@12,52(@13)                                     0903 03248000
         BR    @14                                                 0903 03249000
*                       END;                                       0904 03250000
*                 END;                                             0905 03251000
@RF00899 DS    0H                                                  0906 03252000
*           PUPOCT = PUPOCT + 1;                                   0906 03253000
*                                                                  0906 03254000
@RF00884 LH    @01,PUPOCT                                          0906 03255000
         LA    @01,1(,@01)                                         0906 03256000
         STH   @01,PUPOCT                                          0906 03257000
*           /*********************************************************/ 03258000
*           /*                                                       */ 03259000
*           /* GET THE LOW ORDER HALF BYTE OF THE INPUT BYTE.        */ 03260000
*           /* IF THIS IS THE LAST BYTE, THIS WILL BE THE SIGN.      */ 03261000
*           /* IF THIS IS THE CASE, IGNORE IT & TERMINATE.           */ 03262000
*           /* IF THIS IS ANY OTHER THAN THE LAST BYTE, CHECK IT FOR */ 03263000
*           /* VALIDITY.                                             */ 03264000
*           /*                                                       */ 03265000
*           /*********************************************************/ 03266000
*                                                                  0907 03267000
*           DECT = TRBUF(N) & '0F'X;                               0907 03268000
         LA    @15,15                                              0907 03269000
         L     @14,FMRIP                                           0907 03270000
         BCTR  @14,0                                               0907 03271000
         SLR   @01,@01                                             0907 03272000
         IC    @01,TRBUF(N,@14)                                    0907 03273000
         NR    @15,@01                                             0907 03274000
         STH   @15,DECT                                            0907 03275000
*           IF DECT > 9                 /* IS IT A VALID PACK DIGIT  */ 03276000
*             THEN                                                 0908 03277000
         C     @15,@CF00254                                        0908 03278000
         BNH   @RF00908                                            0908 03279000
*               DO;                                                0909 03280000
*                 IF N = FMSIL          /* IF NOT, IS IT A SIGN.     */ 03281000
*                   THEN;                                          0910 03282000
         CH    N,FMSIL                                             0910 03283000
         BE    @RT00910                                            0910 03284000
*                   ELSE                                           0912 03285000
*                     DO;               /* IF NEITHER THEN ERROR RET */ 03286000
*                       OLDERID2 = NEWERID2;                       0913 03287000
         L     @04,GDTTR2(,GDTPR)                                  0913 03288000
         MVC   @TS00001(95),NEWERID2(@04)                          0913 03289000
         MVC   OLDERID2(95,@04),@TS00001                           0913 03290000
*                       NEWID2 = 'TP2I';                           0914 03291000
         MVC   NEWID2(4,@04),@CC00819                              0914 03292000
*                       RETURN CODE (8);                           0915 03293000
         LA    @15,8                                               0915 03294000
         L     @14,12(,@13)                                        0915 03295000
         LM    @00,@06,20(@13)                                     0915 03296000
         LM    @08,@12,52(@13)                                     0915 03297000
         BR    @14                                                 0915 03298000
*                     END;                                         0916 03299000
*               END;                                               0917 03300000
*                                                                  0917 03301000
@RT00910 DS    0H                                                  0918 03302000
*           /*********************************************************/ 03303000
*           /*                                                       */ 03304000
*           /* MOVE THE LOW ORDER HALF BYTE TO THE OUTPUT BUFFER.    */ 03305000
*           /* UNDER CONTROL OF THE ALIGN LEFT AND ZERO SUPPRESS     */ 03306000
*           /* CONTROL FLAGS.                                        */ 03307000
*           /*                                                       */ 03308000
*           /*********************************************************/ 03309000
*                                                                  0918 03310000
*           IF N < FMSIL                /* CHECK FOR SIGN POSITION.  */ 03311000
*             THEN                                                 0918 03312000
@RF00908 CH    N,FMSIL                                             0918 03313000
         BNL   @RF00918                                            0918 03314000
*               DO;                                                0919 03315000
*                 IF DECT ^= 0          /* CHECK FIRST NON-ZERO.     */ 03316000
*                   THEN                                           0920 03317000
         LH    @15,DECT                                            0920 03318000
         LTR   @15,@15                                             0920 03319000
         BZ    @RF00920                                            0920 03320000
*                     DO;                                          0921 03321000
*                       PUPPSF = ON;    /* PRINT START ON.           */ 03322000
*                       PUPIOF = ON;    /* OUTPUT STEP ON.           */ 03323000
         OI    PUPPSF,B'01100000'                                  0923 03324000
*                     END;                                         0924 03325000
*                 IF FMSIL*2 - PUPOCT <= CVPOL                     0925 03326000
*                                      /* CHECK OUTPUT START.        */ 03327000
*                   THEN                                           0925 03328000
@RF00920 LH    @15,FMSIL                                           0925 03329000
         ALR   @15,@15                                             0925 03330000
         SH    @15,PUPOCT                                          0925 03331000
         C     @15,CVPOL                                           0925 03332000
         BH    @RF00925                                            0925 03333000
*                     DO;                                          0926 03334000
*                       IF PUPPSF = ON  /* IS PRINT START ON.        */ 03335000
*                         THEN                                     0927 03336000
         TM    PUPPSF,B'01000000'                                  0927 03337000
         BNO   @RF00927                                            0927 03338000
*                           DO;                                    0928 03339000
*                             CVPB(PUPPSC) = BHTRTB(DECT + 1);     0929 03340000
         LR    @01,CVSTA                                           0929 03341000
         ALR   @01,PUPPSC                                          0929 03342000
         BCTR  @01,0                                               0929 03343000
         LH    @15,DECT                                            0929 03344000
         LA    @14,BHTRTB(@15)                                     0929 03345000
         MVC   CVPB(1,@01),0(@14)                                  0929 03346000
*                                       /* MOVE THE CHARACTER.       */ 03347000
*                             IF SIGNPOS = OFF & CVPSS = OFF       0930 03348000
*                               THEN                               0930 03349000
         TM    SIGNPOS,B'00010000'                                 0930 03350000
         BNZ   @RF00930                                            0930 03351000
         TM    CVPSS,B'00100000'                                   0930 03352000
         BNZ   @RF00930                                            0930 03353000
*                                 DO;   /* SET THE SIGN.             */ 03354000
*                                   PUPPSC=PUPPSC-1;               0932 03355000
         BCTR  PUPPSC,0                                            0932 03356000
*                                   CVPB(PUPPSC) = SIGN;           0933 03357000
         LR    @01,CVSTA                                           0933 03358000
         ALR   @01,PUPPSC                                          0933 03359000
         BCTR  @01,0                                               0933 03360000
         MVC   CVPB(1,@01),SIGN                                    0933 03361000
*                                   PUPPSC=PUPPSC+1;               0934 03362000
         AL    PUPPSC,@CF00160                                     0934 03363000
*                                   SIGNPOS = ON;                  0935 03364000
         OI    SIGNPOS,B'00010000'                                 0935 03365000
*                                 END;                             0936 03366000
*                           END;                                   0937 03367000
@RF00930 DS    0H                                                  0938 03368000
*                       IF PUPIOF = ON                             0938 03369000
*                         THEN                                     0938 03370000
@RF00927 TM    PUPIOF,B'00100000'                                  0938 03371000
         BNO   @RF00938                                            0938 03372000
*                           PUPPSC = PUPPSC + 1;                   0939 03373000
         AL    PUPPSC,@CF00160                                     0939 03374000
*                       IF CVSTA + PUPPSC > ADDR(PRTBUFF) + PCTPLW + 1  03375000
*                                       /* IS IT END OF PRINT LINE   */ 03376000
*                         THEN                                     0940 03377000
@RF00938 LR    @15,CVSTA                                           0940 03378000
         ALR   @15,PUPPSC                                          0940 03379000
         LA    @14,PRTBUFF                                         0940 03380000
         AL    @14,PCTPLW(,PCTPTR)                                 0940 03381000
         AL    @14,@CF00160                                        0940 03382000
         CR    @15,@14                                             0940 03383000
         BNH   @RF00940                                            0940 03384000
*                           DO;                                    0941 03385000
*                             OLDERID2 = NEWERID2;                 0942 03386000
         L     @04,GDTTR2(,GDTPR)                                  0942 03387000
         MVC   @TS00001(95),NEWERID2(@04)                          0942 03388000
         MVC   OLDERID2(95,@04),@TS00001                           0942 03389000
*                             NEWID2 = 'TP2V';                     0943 03390000
         MVC   NEWID2(4,@04),@CC00848                              0943 03391000
*                             RETURN CODE(0);                      0944 03392000
         SLR   @15,@15                                             0944 03393000
         L     @14,12(,@13)                                        0944 03394000
         LM    @00,@06,20(@13)                                     0944 03395000
         LM    @08,@12,52(@13)                                     0944 03396000
         BR    @14                                                 0944 03397000
*                           END;                                   0945 03398000
*                     END;                                         0946 03399000
@RF00940 DS    0H                                                  0947 03400000
*               END;                                               0947 03401000
@RF00925 DS    0H                                                  0948 03402000
*             PUPOCT = PUPOCT + 1;                                 0948 03403000
@RF00918 LH    @01,PUPOCT                                          0948 03404000
         LA    @01,1(,@01)                                         0948 03405000
         STH   @01,PUPOCT                                          0948 03406000
*         END;                                                     0949 03407000
*                                                                  0949 03408000
         AL    N,@CF00160                                          0949 03409000
@DE00873 CH    N,FMSIL                                             0949 03410000
         BNH   @DL00873                                            0949 03411000
*         /***********************************************************/ 03412000
*         /*                                                         */ 03413000
*         /* SET ZERO IN ALL ZERO FIELD, IF ZERO SUPPRESS AND        */ 03414000
*         /* NO NONZERO DIGITS FOUND.                                */ 03415000
*         /*                                                         */ 03416000
*         /***********************************************************/ 03417000
*         IF CVPZS = ON & PUPPSF = OFF                             0950 03418000
*           THEN                                                   0950 03419000
         TM    CVPZS,B'10000000'                                   0950 03420000
         BNO   @RF00950                                            0950 03421000
         TM    PUPPSF,B'01000000'                                  0950 03422000
         BNZ   @RF00950                                            0950 03423000
*             IF CVPAL = OFF                                       0951 03424000
*               THEN                                               0951 03425000
         TM    CVPAL,B'01000000'                                   0951 03426000
         BNZ   @RF00951                                            0951 03427000
*                 CVPB(CVSL) = '0';                                0952 03428000
         LR    @07,CVSTA                                           0952 03429000
         ALR   @07,CVSL                                            0952 03430000
         BCTR  @07,0                                               0952 03431000
         MVI   CVPB(@07),C'0'                                      0952 03432000
*               ELSE                                               0953 03433000
*                 CVPB(1) = '0';                                   0953 03434000
*                                                                  0953 03435000
         B     @RC00951                                            0953 03436000
@RF00951 MVI   CVPB(CVSTA),C'0'                                    0953 03437000
*         /***********************************************************/ 03438000
*         /*                                                         */ 03439000
*         /* LOCATE THE LAST NON BLANK CHARACTER AND SET THE         */ 03440000
*         /* OFFSET FOR BLANK SUPPRESSION.  IF ENTIRE FIELD          */ 03441000
*         /* IS BLANKS THEN PRINT A BLANK FIELD.                     */ 03442000
*         /***********************************************************/ 03443000
*                                                                  0954 03444000
*         DO N = CVSL TO 1 BY -1 WHILE CVPB(N) = ' ';              0954 03445000
@RC00951 DS    0H                                                  0954 03446000
@RF00950 LR    N,CVSL                                              0954 03447000
         B     @DE00954                                            0954 03448000
@DL00954 LR    @04,CVSTA                                           0954 03449000
         ALR   @04,N                                               0954 03450000
         BCTR  @04,0                                               0954 03451000
         CLI   CVPB(@04),C' '                                      0954 03452000
         BNE   @DC00954                                            0954 03453000
*         END;                                                     0955 03454000
         BCTR  N,0                                                 0955 03455000
@DE00954 LTR   N,N                                                 0955 03456000
         BP    @DL00954                                            0955 03457000
@DC00954 DS    0H                                                  0956 03458000
*         IF N = 0 THEN N = CVSL;                                  0956 03459000
         LTR   N,N                                                 0956 03460000
         BNZ   @RF00956                                            0956 03461000
         LR    N,CVSL                                              0957 03462000
*         PCTAPC = (CVSTA + N) - ADDR(PRTBUFF);                    0958 03463000
*                                                                  0958 03464000
@RF00956 LR    @04,CVSTA                                           0958 03465000
         ALR   @04,N                                               0958 03466000
         LA    @15,PRTBUFF                                         0958 03467000
         SLR   @04,@15                                             0958 03468000
         STH   @04,PCTAPC(,PCTPTR)                                 0958 03469000
*         /***********************************************************/ 03470000
*         /*                                                         */ 03471000
*         /* END OF THE PACKED TO UNPACKED DECIMAL CONVERSION.       */ 03472000
*         /*                                                         */ 03473000
*         /***********************************************************/ 03474000
*                                                                  0959 03475000
*         OLDERID2 = NEWERID2;                                     0959 03476000
         L     @04,GDTTR2(,GDTPR)                                  0959 03477000
         MVC   @TS00001(95),NEWERID2(@04)                          0959 03478000
         MVC   OLDERID2(95,@04),@TS00001                           0959 03479000
*         NEWID2 = 'TP2U';                                         0960 03480000
         MVC   NEWID2(4,@04),@CC00850                              0960 03481000
*         RETURN CODE (0);                                         0961 03482000
         SLR   @15,@15                                             0961 03483000
         L     @14,12(,@13)                                        0961 03484000
         LM    @00,@06,20(@13)                                     0961 03485000
         LM    @08,@12,52(@13)                                     0961 03486000
         BR    @14                                                 0961 03487000
*         END PUPCONV;                                             0962 03488000
*         /***********************************************************/ 03489000
*         /*                                                         */ 03490000
*         /* PROCEDURE NAME - BINARY TO DECIMAL CONVERSION.          */ 03491000
*         /*                                                         */ 03492000
*         /* FUNCTION - CONVERTS BINARY TO PACKED DECIMAL THEN CALLS */ 03493000
*         /* THE PACKED TO UNPACKED DECIMAL CONVERSION PROCEDURE TO  */ 03494000
*         /* CONVERT THE PACKED DECIMAL TO UNPACKED DECIMAL.         */ 03495000
*         /* THE CONVERT BINARY-TO-DECIMAL INSTRUCTION DOES          */ 03496000
*         /* NOT HANDLE FOUR BYTE BINARY NUMBERS WITH THE            */ 03497000
*         /* HIGH-ORDER BIT REPRESENTING DATA. IF THE VALUE          */ 03498000
*         /* TO BE CONVERTED IS FOUR BYTES IN LENGTH, HAS THE        */ 03499000
*         /* HIGH-ORDER BIT ON AND THE SUPPRESS SIGN FLAG IS         */ 03500000
*         /* ON, THE HIGH-ORDER BIT IS TURNED OFF AND A              */ 03501000
*         /* A PACKED DECIMAL VALUE IS ADDED TO THE VALUE            */ 03502000
*         /* RETURNED BY THE CONVERT BINARY-TO-DECIMAL               */ 03503000
*         /* INSTRUCTION.                                            */ 03504000
*         /*                                                         */ 03505000
*         /* INPUT - THE INPUT DATA POINTER, DATA LENGTH AND PRINT   */ 03506000
*         /* POSITION ADDRESS.                                       */ 03507000
*         /*                                                         */ 03508000
*         /* OUTPUT - CONVERTED DECIMAL DATA IN THE PRINT LINE.      */ 03509000
*         /*                                                         */ 03510000
*         /***********************************************************/ 03511000
*                                                                  0963 03512000
*BDCONV:  PROC;                                                    0963 03513000
*                                                                  0963 03514000
BDCONV   STM   @14,@06,@SA00012                                    0963 03515000
         STM   @08,@12,@SA00012+36                                 0963 03516000
*         BDLEN = 5 - CVPIL;                                       0964 03517000
         L     @07,CVPIL                                           0964 03518000
         LA    @04,5                                               0964 03519000
         SLR   @04,@07                                             0964 03520000
         ST    @04,BDLEN                                           0964 03521000
*         HIORDRF = OFF;                /* SET THE HI-ORDER          */ 03522000
         NI    HIORDRF,B'11110111'                                 0965 03523000
*                                       /* DATA FLAG.                */ 03524000
*         IF CVPIL = 2                  /* IS INPUT HALF WORD.       */ 03525000
*           THEN                                                   0966 03526000
         C     @07,@CF00111                                        0966 03527000
         BNE   @RF00966                                            0966 03528000
*             DO;                       /* SET UP HALF WORD INPUT.   */ 03529000
*               BINHALFC(1:2) = CVPIADD ->TRBUF;                   0968 03530000
         L     @07,CVPIADD                                         0968 03531000
         MVC   BINHALFC(2),TRBUF(@07)                              0968 03532000
*               BINACC = BINHALF;                                  0969 03533000
         LH    @07,BINHALF                                         0969 03534000
         ST    @07,BINACC                                          0969 03535000
*             END;                                                 0970 03536000
*           ELSE                                                   0971 03537000
*             DO;                       /* SET UP OTHER LENGTH INPUT */ 03538000
         B     @RC00966                                            0971 03539000
@RF00966 DS    0H                                                  0972 03540000
*               BINACC = 0;                                        0972 03541000
         SLR   @07,@07                                             0972 03542000
         ST    @07,BINACC                                          0972 03543000
*               BINACCC(BDLEN:4) = CVPIADD ->TRBUF;                0973 03544000
*                                                                  0973 03545000
         L     @07,BDLEN                                           0973 03546000
         LA    @04,BINACCC-1(@07)                                  0973 03547000
         LCR   @07,@07                                             0973 03548000
         AL    @07,@CF00036                                        0973 03549000
         L     @01,CVPIADD                                         0973 03550000
         EX    @07,@SM00929                                        0973 03551000
*               /*******************************************@OX17492*/  03552000
*               /*                                          @OX17492*/  03553000
*               /* DETERMINE IF THE HIGH-ORDER BIT CONTAINS @OX17492*/  03554000
*               /* DATA. DATA IS ASSUMED IF VALUE IS FOUR   @OX17492*/  03555000
*               /* BYTES LONG, THE HIGH-ORDER BIT IS ON AND @OX17492*/  03556000
*               /* THE SUPPRESS SIGN FLAG IS ON.            @OX17492*/  03557000
*               /*                                          @OX17492*/  03558000
*               /*******************************************@OX17492*/  03559000
*                                                                  0974 03560000
*               IF BINACCC(1) > MAXPLUS /* IS HIGH-ORDER    @OX17492*/  03561000
*                 THEN                  /* BIT ON ?         @OX17492*/  03562000
         CLI   BINACCC,X'7F'                                       0974 03563000
         BNH   @RF00974                                            0974 03564000
*                   IF CVPSS = ON       /* SIGN SUPPRESS?   @OX17492*/  03565000
*                     THEN                                /*@OX17492*/  03566000
         TM    CVPSS,B'00100000'                                   0975 03567000
         BNO   @RF00975                                            0975 03568000
*                       DO;                               /*@OX17492*/  03569000
*                       HIORDRF = ON;   /* SET HI-ORDER     @OX17492*/  03570000
         OI    HIORDRF,B'00001000'                                 0977 03571000
*                                       /* DATA BIT FLAG    @OX17492*/  03572000
*                       BINACCC(1) = BINACCC(1) & MAXPLUS;/*@OX17492*/  03573000
         NI    BINACCC,X'7F'                                       0978 03574000
*                                       /* CLEAR HIGH-ORDER @OX17492*/  03575000
*                                       /* BIT              @OX17492*/  03576000
*                       END;                              /*@OX17492*/  03577000
*                     ELSE;                               /*@OX17492*/  03578000
@RF00975 DS    0H                                                  0981 03579000
*                 ELSE;                                   /*@OX17492*/  03580000
@RF00974 DS    0H                                                  0982 03581000
*             END;                                                 0982 03582000
*                                                                  0982 03583000
*GEN      (L   CVDREG,BINACC);                                     0983 03584000
@RC00966 DS    0H                                                  0983 03585000
         L   CVDREG,BINACC                                              03586000
*GEN      (CVD CVDREG,UNPKWD);                                     0984 03587000
*                                                                  0984 03588000
         CVD CVDREG,UNPKWD                                              03589000
*         /**************************************************        */ 03590000
*         /*                                                         */ 03591000
*         /* IF THE HIGH-ORDER BIT CONTAINED DATA, IT MUST           */ 03592000
*         /* BE ADDED TO THE CONVERTED DECIMAL VALUE. THE            */ 03593000
*         /* DECIMAL EQUIVALENT MUST BE ADDED IN TWO PARTS           */ 03594000
*         /* EQUAL TO HALF THE REQUIRED VALUE BECAUSE ONE            */ 03595000
*         /* CONSTANT CANNOT BE DEFINED LARGE ENOUGH.                */ 03596000
*         /*                                                         */ 03597000
*         /**************************************************        */ 03598000
*                                                                  0985 03599000
*         IF HIORDRF = ON               /* HIGH-ORDER BIT            */ 03600000
*           THEN                        /* CONTAINS DATA ?           */ 03601000
         TM    HIORDRF,B'00001000'                                 0985 03602000
         BNO   @RF00985                                            0985 03603000
*             DO;                                                  0986 03604000
*             AP (UNPKWD,PKDECE);       /* ADD PACKED DECIMAL        */ 03605000
         AP    UNPKWD(8),@CB00710(8)                               0987 03606000
*             AP (UNPKWD,PKDECE);       /* EQUIVALEN OF              */ 03607000
         AP    UNPKWD(8),@CB00710(8)                               0988 03608000
*             END;                      /* X'80000000' BACK          */ 03609000
*           ELSE;                       /* IN TWO PARTS              */ 03610000
*                                                                  0990 03611000
@RF00985 DS    0H                                                  0991 03612000
*         /***********************************************************/ 03613000
*         /*                                                         */ 03614000
*         /* SET UP THE PARAMETERS FOR THE CALL TO THE PACKED TO     */ 03615000
*         /* UNPACKED CONVERSION AND MAKE THE CALL TO THAT PROCEDURE */ 03616000
*         /*                                                         */ 03617000
*         /***********************************************************/ 03618000
*                                                                  0991 03619000
*         FMRIP = ADDR(UNPKWD);                                    0991 03620000
         LA    @04,UNPKWD                                          0991 03621000
         ST    @04,FMRIP                                           0991 03622000
*         FMSIL = 8;                                               0992 03623000
*                                                                  0992 03624000
         MVC   FMSIL(2),@CH00156                                   0992 03625000
*         CALL PUPCONV;                                            0993 03626000
*                                                                  0993 03627000
         BAL   @14,PUPCONV                                         0993 03628000
*         RESPECIFY RTNREG RSTD;                                   0994 03629000
*         TESTRC = RTNREG;                                         0995 03630000
         STH   RTNREG,TESTRC                                       0995 03631000
*         RESPECIFY RTNREG UNRSTD;                                 0996 03632000
*         RETURN CODE (TESTRC);                                    0997 03633000
         LH    @06,TESTRC                                          0997 03634000
         LR    @15,@06                                             0997 03635000
         L     @14,@SA00012                                        0997 03636000
         LM    @00,@06,@SA00012+8                                  0997 03637000
         LM    @08,@12,@SA00012+36                                 0997 03638000
         BR    @14                                                 0997 03639000
*         END BDCONV;                                              0998 03640000
*         END CONVERT;                                             0999 03641000
*         /***********************************************************/ 03642000
*         /*                                                         */ 03643000
*         /* PROCEDURE NAME - DATA RETURN PROCEDURE.                 */ 03644000
*         /*                                                         */ 03645000
*         /* FUNCTION - THIS PROCEDURE RETURNS DATA TO A CALLER.     */ 03646000
*         /* THE DATA IS RETURNED TO THE AREA POINTED TO BY DARGRETP */ 03647000
*         /* TO THE LENGTH PROVIDED BY DARGRETC.  IF THE DATA LENGTH */ 03648000
*         /* TO BE FORMATTED IS LESS THAN THE COUNT IN DARGRETC THEN */ 03649000
*         /* THE AREA IS NOT PADDED WITH BLANKS.  IF DARGRETC IS LESS*/ 03650000
*         /* THAN THE THE LENGTH OF THE DATA TO BE FORMATTED, THEN   */ 03651000
*         /* FORMATTING IS STOPPED WHEN DARGRETC IS REACHED.  IN     */ 03652000
*         /* EITHER CASE, NO MESSAGE IS PRINTED OR ERROR CONDITION   */ 03653000
*         /* RETURNED.                                               */ 03654000
*         /*                                                         */ 03655000
*         /* INPUT - THE FULLY CONVERTED AND FORMATTED LINE IN THE   */ 03656000
*         /* PRINT ARGUMENT LIST (CVPSTRU).                          */ 03657000
*         /*                                                         */ 03658000
*         /* OUTPUT - THE RETURNED DATA IN THE AREA DESIGNATED BY    */ 03659000
*         /* THE CALLER.                                             */ 03660000
*         /*                                                         */ 03661000
*         /***********************************************************/ 03662000
*                                                                  1000 03663000
*LINERET: PROC;                                                    1000 03664000
*                                                                  1000 03665000
LINERET  STM   @14,@12,12(@13)                                     1000 03666000
*   OLDERID2 = NEWERID2;                                           1001 03667000
         L     @04,GDTTR2(,GDTPR)                                  1001 03668000
         MVC   @TS00001(95),NEWERID2(@04)                          1001 03669000
         MVC   OLDERID2(95,@04),@TS00001                           1001 03670000
*   NEWID2 = 'TPDR';                                               1002 03671000
*                                                                  1002 03672000
         MVC   NEWID2(4,@04),@CC00859                              1002 03673000
*         /***********************************************************/ 03674000
*         /*                                                         */ 03675000
*         /* RETURN THE FORMATTED LINE TO THE CALLER.                */ 03676000
*         /* RETLN IS USED TO CONTAIN THE LENGTH OF THE AREA TO BE   */ 03677000
*         /* MOVED.                                                  */ 03678000
*         /*                                                         */ 03679000
*         /***********************************************************/ 03680000
*                                                                  1003 03681000
*         IF CVPRETC > PCTPLW                                      1003 03682000
*           THEN                                                   1003 03683000
         LH    @04,CVPRETC                                         1003 03684000
         L     @03,PCTPLW(,PCTPTR)                                 1003 03685000
         CR    @04,@03                                             1003 03686000
         BNH   @RF01003                                            1003 03687000
*             DO;                                                  1004 03688000
*                                                                  1004 03689000
*             /*******************************************************/ 03690000
*             /*                                                     */ 03691000
*             /* SET THE SEGMENT LENGTH TO                           */ 03692000
*             /* MOVE AN ENTIRE LINE TO USERS DATA AREA.             */ 03693000
*             /*                                                     */ 03694000
*             /*******************************************************/ 03695000
*                                                                  1005 03696000
*               RETLN = PCTPLW;                                    1005 03697000
         ST    @03,RETLN                                           1005 03698000
*               CVPRETC = CVPRETC - PCTPLW;                        1006 03699000
         SLR   @04,@03                                             1006 03700000
         STH   @04,CVPRETC                                         1006 03701000
*             END;                                                 1007 03702000
*           ELSE                                                   1008 03703000
*             DO;                                                  1008 03704000
*                                                                  1008 03705000
         B     @RC01003                                            1008 03706000
@RF01003 DS    0H                                                  1009 03707000
*             /*******************************************************/ 03708000
*             /*                                                     */ 03709000
*             /* SET THE SEGMENT LENGTH TO                           */ 03710000
*             /* MOVE A PARTIAL LINE.                                */ 03711000
*             /*                                                     */ 03712000
*             /*******************************************************/ 03713000
*                                                                  1009 03714000
*               RETLN = CVPRETC;                                   1009 03715000
         LH    @04,CVPRETC                                         1009 03716000
         ST    @04,RETLN                                           1009 03717000
*               CVPRETC = 0;                                       1010 03718000
         SLR   @04,@04                                             1010 03719000
         STH   @04,CVPRETC                                         1010 03720000
*             END;                                                 1011 03721000
*         IF RETLN > 0                                             1012 03722000
*           THEN                                                   1012 03723000
@RC01003 L     @04,RETLN                                           1012 03724000
         LTR   @04,@04                                             1012 03725000
         BNP   @RF01012                                            1012 03726000
*             DO;                                                  1013 03727000
*                                                                  1013 03728000
*               /*****************************************************/ 03729000
*               /*                                                   */ 03730000
*               /* MOVE THE LINE SEGMENT TO THE USERS AREA.          */ 03731000
*               /*                                                   */ 03732000
*               /*****************************************************/ 03733000
*                                                                  1014 03734000
*               RETAREA(1:RETLN) = PRTBUFF;                        1014 03735000
         L     @03,CVPRETP                                         1014 03736000
         LR    @15,@04                                             1014 03737000
         BCTR  @15,0                                               1014 03738000
         EX    @15,@SM00931                                        1014 03739000
*               CVPRETP = CVPRETP + RETLN;                         1015 03740000
         ALR   @03,@04                                             1015 03741000
         ST    @03,CVPRETP                                         1015 03742000
*             END;                                                 1016 03743000
*             FFMFMTF = OFF;                                       1017 03744000
@RF01012 NI    FFMFMTF,B'11111110'                                 1017 03745000
*             PRTBUFF = ' ';                                       1018 03746000
*                                                                  1018 03747000
         MVI   PRTBUFF+1,C' '                                      1018 03748000
         MVC   PRTBUFF+2(131),PRTBUFF+1                            1018 03749000
         MVI   PRTBUFF,C' '                                        1018 03750000
*         RETURN;                                                  1019 03751000
@EL00013 DS    0H                                                  1019 03752000
@EF00013 DS    0H                                                  1019 03753000
@ER00013 LM    @14,@12,12(@13)                                     1019 03754000
         BR    @14                                                 1019 03755000
*         END LINERET;                                             1020 03756000
*         /***********************************************************/ 03757000
*         /*                                                         */ 03758000
*         /* PROCEDURE NAME - LINE PRINT PROCEDURE.                  */ 03759000
*         /*                                                         */ 03760000
*         /* FUNCTION - MAINTAINS PAGE FORMATTING INFORMATION,       */ 03761000
*         /* PRINTING TITLE, HEADING AND FOOTING LINES AS REQUIRED   */ 03762000
*         /* AND PRINTS THE LINES REQUESTED.  THIS PROCEDURE IS      */ 03763000
*         /* ALSWAYS CALLED FROM THE MAIN FORMAT PROCEDURE OR FROM   */ 03764000
*         /* THE CONVERSION PROCEDURE.                               */ 03765000
*         /*                                                         */ 03766000
*         /* INPUT - THE CONVERSION/PRINT ARGUMENT LIST. (CVPSTRU)   */ 03767000
*         /*                                                         */ 03768000
*         /* OUTPUT - THE PRINTED PAGE.                              */ 03769000
*         /*                                                         */ 03770000
*         /***********************************************************/ 03771000
*                                                                  1021 03772000
*LINEPRT: PROC;                                                    1021 03773000
*                                                                  1021 03774000
LINEPRT  STM   @14,@06,@SA00014                                    1021 03775000
         STM   @08,@12,@SA00014+36                                 1021 03776000
*         /***********************************************************/ 03777000
*         /*                                                         */ 03778000
*         /* IF THE DATA IS TO BE RETURNED TO THE USER INSTEAD OF    */ 03779000
*         /* BEING PRINTED, CALL THE LINE RETURN PROCEDURE.          */ 03780000
*         /*                                                         */ 03781000
*         /***********************************************************/ 03782000
*                                                                  1022 03783000
*         IF CVPRETP ^= NULLPTR                                    1022 03784000
*           THEN                                                   1022 03785000
         L     @06,CVPRETP                                         1022 03786000
         LTR   @06,@06                                             1022 03787000
         BZ    @RF01022                                            1022 03788000
*             DO;                                                  1023 03789000
*                                                                  1023 03790000
*               CALL LINERET;                                      1024 03791000
*                                                                  1024 03792000
         BAL   @14,LINERET                                         1024 03793000
*               FFMFMTF = OFF;                                     1025 03794000
         NI    FFMFMTF,B'11111110'                                 1025 03795000
*               PRTBUFF = ' ';                                     1026 03796000
         MVI   PRTBUFF+1,C' '                                      1026 03797000
         MVC   PRTBUFF+2(131),PRTBUFF+1                            1026 03798000
         MVI   PRTBUFF,C' '                                        1026 03799000
*               RETURN CODE(0);                                    1027 03800000
         SLR   @15,@15                                             1027 03801000
         L     @14,@SA00014                                        1027 03802000
         LM    @00,@06,@SA00014+8                                  1027 03803000
         LM    @08,@12,@SA00014+36                                 1027 03804000
         BR    @14                                                 1027 03805000
*             END;                                                 1028 03806000
*                                                                  1028 03807000
*         IF GDTDBG = NULLPTR                                      1029 03808000
*           THEN;                                                  1029 03809000
@RF01022 L     @06,GDTDBG(,GDTPR)                                  1029 03810000
         LTR   @06,@06                                             1029 03811000
         BZ    @RT01029                                            1029 03812000
*           ELSE                                                   1031 03813000
*             CALL ICKDB010 (GDTTBL,'TP3I');                       1031 03814000
*                                                                  1031 03815000
         ST    GDTPR,@AL00001                                      1031 03816000
         LA    @06,@CC00863                                        1031 03817000
         ST    @06,@AL00001+4                                      1031 03818000
         MVI   @AL00001+4,X'80'                                    1031 03819000
         L     @15,GDTDBG(,GDTPR)                                  1031 03820000
         LA    @01,@AL00001                                        1031 03821000
         BALR  @14,@15                                             1031 03822000
*         PRLINE = ' ';                 /* SET BUFFER TO BLANKS      */ 03823000
@RT01029 MVI   PRLINE+1,C' '                                       1032 03824000
         MVC   PRLINE+2(118),PRLINE+1                              1032 03825000
         MVI   PRLINE,C' '                                         1032 03826000
*         PRCC = PRCCON(2);             /* CARR CONT = SINGLE SPACE  */ 03827000
         MVC   PRCC(1),PRCCON+1                                    1033 03828000
*         SPFSAV = PRTSPF;              /* SAVE SPACING FACTOR       */ 03829000
*                                                                  1034 03830000
         LH    SPFSAV,PRTSPF                                       1034 03831000
*         /***********************************************************/ 03832000
*         /*                                                         */ 03833000
*         /* IF THE ALTERNATE PRINT FILE POINTER IS NULL AND THE     */ 03834000
*         /* ALTERNATE PRINT FILE FLAG IS ON THEN THE FILES MUST BE  */ 03835000
*         /* SWITCHED TO REFLECT THIS CHANGE.                        */ 03836000
*         /*                                                         */ 03837000
*         /***********************************************************/ 03838000
*                                                                  1035 03839000
*         IOCSPTR=PCTIOC;                                          1035 03840000
         L     @06,PCTIOC(,PCTPTR)                                 1035 03841000
         ST    @06,IOCSPTR                                         1035 03842000
*         IF PCTIOP = NULLPTR & PCTAPF = ON                        1036 03843000
*           THEN                                                   1036 03844000
         SLR   @06,@06                                             1036 03845000
         C     @06,PCTIOP(,PCTPTR)                                 1036 03846000
         BNE   @RF01036                                            1036 03847000
         TM    PCTAPF(PCTPTR),B'00001000'                          1036 03848000
         BNO   @RF01036                                            1036 03849000
*             DO;                                                  1037 03850000
*                                                                  1037 03851000
*               /*****************************************************/ 03852000
*               /*                                                   */ 03853000
*               /* IF PRINT LINES ARE IN THE BUFFER, FLUSH THE STACK */ 03854000
*               /* PRIOR TO CHANGING THE FILE POINTERS.              */ 03855000
*               /*                                                   */ 03856000
*               /*****************************************************/ 03857000
*                                                                  1038 03858000
*               IF PCTLNM ^= 0                                     1038 03859000
*                 THEN                                             1038 03860000
         CH    @06,PCTLNM(,PCTPTR)                                 1038 03861000
         BE    @RF01038                                            1038 03862000
*                   DO;                                            1039 03863000
*                     FFMPSFF = ON;                                1040 03864000
*                                                                  1040 03865000
         OI    FFMPSFF,B'00100000'                                 1040 03866000
*                     CALL STACKPUT (PRCC);                        1041 03867000
*                                                                  1041 03868000
         LA    @06,PRCC                                            1041 03869000
         ST    @06,@AL00001                                        1041 03870000
         LA    @01,@AL00001                                        1041 03871000
         BAL   @14,STACKPUT                                        1041 03872000
*                     RESPECIFY RTNREG RSTD;                       1042 03873000
*                     TESTRC = RTNREG;                             1043 03874000
         STH   RTNREG,TESTRC                                       1043 03875000
*                     RESPECIFY RTNREG UNRSTD;                     1044 03876000
*                     IF TESTRC ^= 0                               1045 03877000
*                       THEN                                       1045 03878000
         LH    @06,TESTRC                                          1045 03879000
         LTR   @06,@06                                             1045 03880000
         BZ    @RF01045                                            1045 03881000
*                         RETURN CODE(RCQUIT);                     1046 03882000
         LH    @15,RCQUIT                                          1046 03883000
         L     @14,@SA00014                                        1046 03884000
         LM    @00,@06,@SA00014+8                                  1046 03885000
         LM    @08,@12,@SA00014+36                                 1046 03886000
         BR    @14                                                 1046 03887000
*                   END;                                           1047 03888000
*                                                                  1047 03889000
@RF01045 DS    0H                                                  1048 03890000
*               /*****************************************************/ 03891000
*               /*                                                   */ 03892000
*               /* SWITCH THE IOCS PARMS TO THE STANDARD IOCS FILE.  */ 03893000
*               /*                                                   */ 03894000
*               /*****************************************************/ 03895000
*                                                                  1048 03896000
*               PCTLPL = PCTAPL;                                   1048 03897000
@RF01038 MVC   PCTLPL(4,PCTPTR),PCTAPL(PCTPTR)                     1048 03898000
*               PCTACT = PCTSTD;                                   1049 03899000
         MVC   PCTACT(8,PCTPTR),PCTSTD(PCTPTR)                     1049 03900000
*               PCTAPF = OFF;                                      1050 03901000
         NI    PCTAPF(PCTPTR),B'11110111'                          1050 03902000
*             END;                                                 1051 03903000
*                                                                  1051 03904000
*         /***********************************************************/ 03905000
*         /*                                                         */ 03906000
*         /* IF THE ALTERNATE PRINT FILE POINTER IS NOT NULL AND THE */ 03907000
*         /* ALTERNATE PRINT FILE FLAG IS OFF THEN THE FILES MUST BE */ 03908000
*         /* SWITCHED TO REFLECT THIS CHANGE.                        */ 03909000
*         /*                                                         */ 03910000
*         /***********************************************************/ 03911000
*                                                                  1052 03912000
*         IF PCTIOP ^= NULLPTR & PCTAPF = OFF                      1052 03913000
*           THEN                                                   1052 03914000
@RF01036 SLR   @06,@06                                             1052 03915000
         C     @06,PCTIOP(,PCTPTR)                                 1052 03916000
         BE    @RF01052                                            1052 03917000
         TM    PCTAPF(PCTPTR),B'00001000'                          1052 03918000
         BNZ   @RF01052                                            1052 03919000
*             DO;                                                  1053 03920000
*               /*****************************************************/ 03921000
*               /*                                                   */ 03922000
*               /* IF PRINT LINES ARE IN THE BUFFER, FLUSH THE STACK */ 03923000
*               /* PRIOR TO CHANGING THE FILE POINTERS.              */ 03924000
*               /*                                                   */ 03925000
*               /*****************************************************/ 03926000
*                                                                  1054 03927000
*               IF PCTLNM ^= 0                                     1054 03928000
*                 THEN                                             1054 03929000
         CH    @06,PCTLNM(,PCTPTR)                                 1054 03930000
         BE    @RF01054                                            1054 03931000
*                   DO;                                            1055 03932000
*                     FFMPSFF = ON;                                1056 03933000
*                                                                  1056 03934000
         OI    FFMPSFF,B'00100000'                                 1056 03935000
*                     CALL STACKPUT (PRCC);                        1057 03936000
*                                                                  1057 03937000
         LA    @06,PRCC                                            1057 03938000
         ST    @06,@AL00001                                        1057 03939000
         LA    @01,@AL00001                                        1057 03940000
         BAL   @14,STACKPUT                                        1057 03941000
*                     RESPECIFY RTNREG RSTD;                       1058 03942000
*                     TESTRC = RTNREG;                             1059 03943000
         STH   RTNREG,TESTRC                                       1059 03944000
*                     RESPECIFY RTNREG UNRSTD;                     1060 03945000
*                     IF TESTRC ^= 0                               1061 03946000
*                       THEN                                       1061 03947000
         LH    @06,TESTRC                                          1061 03948000
         LTR   @06,@06                                             1061 03949000
         BZ    @RF01061                                            1061 03950000
*                         RETURN CODE(RCQUIT);                     1062 03951000
         LH    @15,RCQUIT                                          1062 03952000
         L     @14,@SA00014                                        1062 03953000
         LM    @00,@06,@SA00014+8                                  1062 03954000
         LM    @08,@12,@SA00014+36                                 1062 03955000
         BR    @14                                                 1062 03956000
*                   END;                                           1063 03957000
*                                                                  1063 03958000
@RF01061 DS    0H                                                  1064 03959000
*               /*****************************************************/ 03960000
*               /*                                                   */ 03961000
*               /* SWITCH THE IOCS PARMS TO THE ALTERNATE IOCS FILE  */ 03962000
*               /*                                                   */ 03963000
*               /*****************************************************/ 03964000
*                                                                  1064 03965000
*               PCTSTD = PCTACT;                                   1064 03966000
@RF01054 MVC   PCTSTD(8,PCTPTR),PCTACT(PCTPTR)                     1064 03967000
*               PCTACT = PCTALT;                                   1065 03968000
         MVC   PCTACT(8,PCTPTR),PCTALT(PCTPTR)                     1065 03969000
*               PCTAPF = ON;                                       1066 03970000
         OI    PCTAPF(PCTPTR),B'00001000'                          1066 03971000
*             END;                                                 1067 03972000
*                                                                  1067 03973000
*         IOCSPTR = PCTIOC;             /* SET THE IOCS POINTER.     */ 03974000
@RF01052 L     @04,PCTIOC(,PCTPTR)                                 1068 03975000
         ST    @04,IOCSPTR                                         1068 03976000
*         NLISAV = PCTNLI;              /* SAVE THE NEXT LINE NUMBER */ 03977000
*                                                                  1069 03978000
         LH    NLISAV,PCTNLI(,PCTPTR)                              1069 03979000
*         /***********************************************************/ 03980000
*         /*                                                         */ 03981000
*         /* IF THE PREVIOUS LINE WAS A MESSAGE, ADD AN EXTRA SPACE  */ 03982000
*         /*                                                         */ 03983000
*         /***********************************************************/ 03984000
*                                                                  1070 03985000
*         IF PRTSPT = 'R' & PCTLLM = ON & PCTPMN = 0 & QSECMF = OFF     03986000
*           THEN                                                   1070 03987000
         CLI   PRTSPT,C'R'                                         1070 03988000
         BNE   @RF01070                                            1070 03989000
         TM    PCTLLM(PCTPTR),B'00010000'                          1070 03990000
         BNO   @RF01070                                            1070 03991000
         LH    @04,PCTPMN(,PCTPTR)                                 1070 03992000
         LTR   @04,@04                                             1070 03993000
         BNZ   @RF01070                                            1070 03994000
         L     @04,QENTP                                           1070 03995000
         TM    QSECMF(@04),B'00100000'                             1070 03996000
         BNZ   @RF01070                                            1070 03997000
*             DO;                                                  1071 03998000
*               SPFSAV = SPFSAV+1;                                 1072 03999000
         AL    SPFSAV,@CF00160                                     1072 04000000
*               PCTLLM = OFF;                                      1073 04001000
         NI    PCTLLM(PCTPTR),B'11101111'                          1073 04002000
*             END;                                                 1074 04003000
*                                                                  1074 04004000
*         /***********************************************************/ 04005000
*         /*                                                         */ 04006000
*         /* IF THIS IS AN INITIAL HEADER CHECK FOR SPACE FOR THE    */ 04007000
*         /* HEADING PLUS 1 PRINT LINE AND IF THIS MUCH SPACE IS     */ 04008000
*         /* NOT LEFT ON THIS PAGE, FORCE A PAGE OVERFLOW.           */ 04009000
*         /*                                                         */ 04010000
*         /***********************************************************/ 04011000
*                                                                  1075 04012000
*         IF PCTH1F = ON & (PCTNLI + PCTHSC) > PCTLDL              1075 04013000
*           THEN                                                   1075 04014000
@RF01070 TM    PCTH1F(PCTPTR),B'10000000'                          1075 04015000
         BNO   @RF01075                                            1075 04016000
         SLR   @04,@04                                             1075 04017000
         IC    @04,PCTHSC(,PCTPTR)                                 1075 04018000
         AH    @04,PCTNLI(,PCTPTR)                                 1075 04019000
         CH    @04,PCTLDL(,PCTPTR)                                 1075 04020000
         BNH   @RF01075                                            1075 04021000
*             PCTNLI = 999;                                        1076 04022000
         MVC   PCTNLI(2,PCTPTR),@CH00865                           1076 04023000
*         /***********************************************************/ 04024000
*         /*                                                         */ 04025000
*         /*  CONVERT ABSOLUTE TO RELATIVE SPACING IF NEEDED         */ 04026000
*         /*                                                         */ 04027000
*         /***********************************************************/ 04028000
*                                                                  1077 04029000
*         IF PRTSPT = 'A'                                          1077 04030000
*           THEN                                                   1077 04031000
@RF01075 CLI   PRTSPT,C'A'                                         1077 04032000
         BNE   @RF01077                                            1077 04033000
*             DO;                                                  1078 04034000
*               IF SPFSAV <= PCTLDL & SPFSAV >= PCTFDL             1079 04035000
*                 THEN                                             1079 04036000
         CH    SPFSAV,PCTLDL(,PCTPTR)                              1079 04037000
         BH    @RF01079                                            1079 04038000
         CH    SPFSAV,PCTFDL(,PCTPTR)                              1079 04039000
         BL    @RF01079                                            1079 04040000
*                   DO;                                            1080 04041000
*                     IF SPFSAV >= PCTNLI                          1081 04042000
*                       THEN                                       1081 04043000
         LH    @04,PCTNLI(,PCTPTR)                                 1081 04044000
         CR    SPFSAV,@04                                          1081 04045000
         BL    @RF01081                                            1081 04046000
*                         SPFSAV = SPFSAV + 1 - PCTNLI;            1082 04047000
         LA    @15,1                                               1082 04048000
         ALR   @15,SPFSAV                                          1082 04049000
         SLR   @15,@04                                             1082 04050000
         LR    SPFSAV,@15                                          1082 04051000
*                       ELSE                                       1083 04052000
*                         DO;                                      1083 04053000
         B     @RC01081                                            1083 04054000
@RF01081 DS    0H                                                  1084 04055000
*                           SPFSAV = 1;                            1084 04056000
         LA    SPFSAV,1                                            1084 04057000
*                           PCTNLI = 999;                          1085 04058000
         MVC   PCTNLI(2,PCTPTR),@CH00865                           1085 04059000
*                         END;                                     1086 04060000
*                   END;                                           1087 04061000
*                                                                  1087 04062000
*         /***********************************************************/ 04063000
*         /*                                                         */ 04064000
*         /*  ABSOLUTE LINE NUMBER IS OUT OF RANGE.                  */ 04065000
*         /*  FORCE AN EJECT AND PRINT ON FIRST LINE OF NEXT PAGE.   */ 04066000
*         /*                                                         */ 04067000
*         /***********************************************************/ 04068000
*                                                                  1088 04069000
*                 ELSE                                             1088 04070000
*                   DO;                                            1088 04071000
         B     @RC01079                                            1088 04072000
@RF01079 DS    0H                                                  1089 04073000
*                     SPFSAV = 1;        /* SET SINGLE SPACE CONTROL  * 04074000
         LA    SPFSAV,1                                            1089 04075000
*                     PCTNLI = 999;     /* FORCE AN EJECT            */ 04076000
         MVC   PCTNLI(2,PCTPTR),@CH00865                           1090 04077000
*                   END;                                           1091 04078000
*             END;                                                 1092 04079000
@RC01079 DS    0H                                                  1093 04080000
*         /***********************************************************/ 04081000
*         /*                                                         */ 04082000
*         /* TEST FOR OVERFLOW OR EJECT AND HANDLE IF NEEDED.        */ 04083000
*         /*                                                         */ 04084000
*         /***********************************************************/ 04085000
*                                                                  1093 04086000
*         IF (PCTNLI + SPFSAV) > PCTLDL | PRTSPT = 'E'             1093 04087000
*           THEN                                                   1093 04088000
@RF01077 LR    @04,SPFSAV                                          1093 04089000
         AH    @04,PCTNLI(,PCTPTR)                                 1093 04090000
         CH    @04,PCTLDL(,PCTPTR)                                 1093 04091000
         BH    @RT01093                                            1093 04092000
         CLI   PRTSPT,C'E'                                         1093 04093000
         BNE   @RF01093                                            1093 04094000
@RT01093 DS    0H                                                  1094 04095000
*OFLOOP:      DO;                                                  1094 04096000
OFLOOP   DS    0H                                                  1095 04097000
*               SPFSAV = 2;                                        1095 04098000
*                                                                  1095 04099000
         LA    SPFSAV,2                                            1095 04100000
*         /***********************************************************/ 04101000
*         /*                                                         */ 04102000
*         /*  WRITE THE FOOTING LINES IF THEY ARE REQUIRED           */ 04103000
*         /* CURLI IS USED TO POINT TO THE CURRENT FOOTING LINE TO   */ 04104000
*         /* BE PRINTED.                                             */ 04105000
*         /* LINCT IS USED AS A LOOP CONTROL CELL AND IS SET         */ 04106000
*         /* INITIALLY TO THE FOOTING LINE COUNT. (PCTFLC)           */ 04107000
*         /*                                                         */ 04108000
*         /***********************************************************/ 04109000
*                                                                  1096 04110000
*               IF PCTFLC ^= 0                                     1096 04111000
*                 THEN                                             1096 04112000
         LH    @04,PCTFLC(,PCTPTR)                                 1096 04113000
         LTR   @04,@04                                             1096 04114000
         BZ    @RF01096                                            1096 04115000
*                   DO;                                            1097 04116000
*                     PRFTSP = PCTFLN + 1 - NLISAV;                1098 04117000
*                                                                  1098 04118000
         LA    PRFTSP,1                                            1098 04119000
         AH    PRFTSP,PCTFLN(,PCTPTR)                              1098 04120000
         SLR   PRFTSP,NLISAV                                       1098 04121000
*                     /***********************************************/ 04122000
*                     /*                                             */ 04123000
*                     /* SPACE TO THE FIRST FOOTING LINE.            */ 04124000
*                     /*                                             */ 04125000
*                     /***********************************************/ 04126000
*                                                                  1099 04127000
*                     PRCC = PRCCON(4);                            1099 04128000
         MVC   PRCC(1),PRCCON+3                                    1099 04129000
*                     DO WHILE PRFTSP > 3;                         1100 04130000
         B     @DE01100                                            1100 04131000
@DL01100 DS    0H                                                  1101 04132000
*                       PRFTSP = PRFTSP - 3;                       1101 04133000
*                                                                  1101 04134000
         SL    PRFTSP,@CF00131                                     1101 04135000
*                       CALL STACKPUT (PRCC);                      1102 04136000
*                                                                  1102 04137000
         LA    @06,PRCC                                            1102 04138000
         ST    @06,@AL00001                                        1102 04139000
         LA    @01,@AL00001                                        1102 04140000
         BAL   @14,STACKPUT                                        1102 04141000
*                     END;                                         1103 04142000
*                                                                  1103 04143000
@DE01100 C     PRFTSP,@CF00131                                     1103 04144000
         BH    @DL01100                                            1103 04145000
*                     /***********************************************/ 04146000
*                     /*                                             */ 04147000
*                     /* PRINT THE FOOTING LINES.                    */ 04148000
*                     /*                                             */ 04149000
*                     /***********************************************/ 04150000
*                                                                  1104 04151000
*                     TTLPT = PCTFLP;   /* SET TEMP FOOTING LINE PTR */ 04152000
         L     TTLPT,PCTFLP(,PCTPTR)                               1104 04153000
*                     FLCC(1) = PRCCON(PRFTSP+ 1);                 1105 04154000
         LA    @01,PRCCON(PRFTSP)                                  1105 04155000
         MVC   FLCC(1,TTLPT),0(@01)                                1105 04156000
*                     DO LINCT = PCTFLC BY -1 TO 1;                1106 04157000
*                                                                  1106 04158000
         LH    @04,PCTFLC(,PCTPTR)                                 1106 04159000
         ST    @04,LINCT                                           1106 04160000
         B     @DE01106                                            1106 04161000
@DL01106 DS    0H                                                  1107 04162000
*                       CALL STACKPUT (FTLI);                      1107 04163000
*                                                                  1107 04164000
         ST    TTLPT,@AL00001                                      1107 04165000
         LA    @01,@AL00001                                        1107 04166000
         BAL   @14,STACKPUT                                        1107 04167000
*                       TTLPT = TTLPT + STDLWPS;                   1108 04168000
         AH    TTLPT,STDLWPS                                       1108 04169000
*                     END;                                         1109 04170000
         SLR   @04,@04                                             1109 04171000
         BCTR  @04,0                                               1109 04172000
         AL    @04,LINCT                                           1109 04173000
         ST    @04,LINCT                                           1109 04174000
@DE01106 LTR   @04,@04                                             1109 04175000
         BP    @DL01106                                            1109 04176000
*                   END;                                           1110 04177000
*                 /***************************************************/ 04178000
*                 /*                                                 */ 04179000
*                 /*  WRITE THE TITLE LINES REQUIRED BY THE OVER FLOW*/ 04180000
*                 /* LINCT IS USED AS A LOOP CONTROL CELL AND IS SET */ 04181000
*                 /* INITIALLY TO THE TITLE LINE COUNT.(PCTMLC) OR   */ 04182000
*                 /* (PCTSLC)                                        */ 04183000
*                 /*                                                 */ 04184000
*                 /***************************************************/ 04185000
*                 /*                                                 */ 04186000
*                 /* WRITE THE MAIN TITLE LINES FIRST.               */ 04187000
*                 /*                                                 */ 04188000
*                 /***************************************************/ 04189000
*                                                                  1111 04190000
*                   PCTNLI = 2;         /* SET NEXT LINE NUMBER      */ 04191000
@RF01096 MVC   PCTNLI(2,PCTPTR),@CH00111                           1111 04192000
*                   PCTCPN = PCTCPN + PCTPNI;                      1112 04193000
         LH    @04,PCTCPN(,PCTPTR)                                 1112 04194000
         AH    @04,PCTPNI(,PCTPTR)                                 1112 04195000
         STH   @04,PCTCPN(,PCTPTR)                                 1112 04196000
*                                       /* SET NEXT PAGE NUMBER.     */ 04197000
*                                                                  1113 04198000
*                 /***************************************************/ 04199000
*                 /*                                                 */ 04200000
*                 /* SET UP THE PAGE NUMBER IN THE MAIN TITLE LINE   */ 04201000
*                 /*                                                 */ 04202000
*                 /***************************************************/ 04203000
*                                                                  1113 04204000
*                   CVDREG = PCTCPN;    /* CONVERT PAGE NUMBER       */ 04205000
         LR    CVDREG,@04                                          1113 04206000
*                   GEN (CVD   CVDREG,UNPKWD);                     1114 04207000
         CVD   CVDREG,UNPKWD                                            04208000
*                   GEN (UNPK  MTPN,UNPKWD);                       1115 04209000
         UNPK  MTPN,UNPKWD                                              04210000
*                   GEN (OI    MTPN+3,X'F0');                      1116 04211000
*                                                                  1116 04212000
         OI    MTPN+3,X'F0'                                             04213000
*                   MTLINE(PCTPNL:PCTPNL + 4) = MTPN;              1117 04214000
         LH    @04,PCTPNL(,PCTPTR)                                 1117 04215000
         L     @01,PCTMLP(,PCTPTR)                                 1117 04216000
         ALR   @01,@04                                             1117 04217000
         BCTR  @01,0                                               1117 04218000
         MVI   MTLINE+4(@01),C' '                                  1117 04219000
         MVC   MTLINE(4,@01),MTPN                                  1117 04220000
*                                       /* MOVE PAGE NUMBER TO LINE  */ 04221000
*                                                                  1118 04222000
*                   /*************************************************/ 04223000
*                   /*                                               */ 04224000
*                   /* SET LEADING PAGE NUMBER ZEROS TO BLANKS.      */ 04225000
*                   /*                                               */ 04226000
*                   /*************************************************/ 04227000
*                                                                  1118 04228000
*                   LINCT = PCTPNL;                                1118 04229000
         ST    @04,LINCT                                           1118 04230000
*                   DO N = 1 TO 3 BY 1 WHILE MTLINE(LINCT) = '0';  1119 04231000
         LA    N,1                                                 1119 04232000
@DL01119 L     @06,LINCT                                           1119 04233000
         L     @04,PCTMLP(,PCTPTR)                                 1119 04234000
         ALR   @06,@04                                             1119 04235000
         BCTR  @06,0                                               1119 04236000
         CLI   MTLINE(@06),C'0'                                    1119 04237000
         BNE   @DC01119                                            1119 04238000
*                     MTLINE(LINCT) = ' ';                         1120 04239000
         L     @06,LINCT                                           1120 04240000
         ALR   @04,@06                                             1120 04241000
         BCTR  @04,0                                               1120 04242000
         MVI   MTLINE(@04),C' '                                    1120 04243000
*                                       /* SET PRECEDING ZEROS BLANK */ 04244000
*                     LINCT = LINCT +1;                            1121 04245000
         AL    @06,@CF00160                                        1121 04246000
         ST    @06,LINCT                                           1121 04247000
*                   END;                                           1122 04248000
*                                                                  1122 04249000
         AL    N,@CF00160                                          1122 04250000
         C     N,@CF00131                                          1122 04251000
         BNH   @DL01119                                            1122 04252000
@DC01119 DS    0H                                                  1123 04253000
*                   /*************************************************/ 04254000
*                   /*                                               */ 04255000
*                   /* PUT THE MAIN TITLE LINE TO SYSPRINT.          */ 04256000
*                   /*                                               */ 04257000
*                   /*************************************************/ 04258000
*                                                                  1123 04259000
*                                                                  1123 04260000
*                   CALL STACKPUT (MTLINE);                        1123 04261000
*                                                                  1123 04262000
         L     @06,PCTMLP(,PCTPTR)                                 1123 04263000
         ST    @06,@AL00001                                        1123 04264000
         LA    @01,@AL00001                                        1123 04265000
         BAL   @14,STACKPUT                                        1123 04266000
*                   RESPECIFY RTNREG RSTD;                         1124 04267000
*                   TESTRC = RTNREG;                               1125 04268000
         STH   RTNREG,TESTRC                                       1125 04269000
*                   RESPECIFY RTNREG UNRSTD;                       1126 04270000
*                   IF TESTRC ^= 0                                 1127 04271000
*                     THEN                                         1127 04272000
         LH    @06,TESTRC                                          1127 04273000
         LTR   @06,@06                                             1127 04274000
         BZ    @RF01127                                            1127 04275000
*                       RETURN CODE(RCQUIT);                       1128 04276000
*                                                                  1128 04277000
         LH    @15,RCQUIT                                          1128 04278000
         L     @14,@SA00014                                        1128 04279000
         LM    @00,@06,@SA00014+8                                  1128 04280000
         LM    @08,@12,@SA00014+36                                 1128 04281000
         BR    @14                                                 1128 04282000
*                   /*************************************************/ 04283000
*                   /*                                               */ 04284000
*                   /*  WRITE THE SUB TITLE LINES                    */ 04285000
*                   /* THERE MAY BE FROM ONE TO THREE TITLE LINES,   */ 04286000
*                   /* EACH WITH SPACING OF ONE TO THREE LINES.      */ 04287000
*                   /* THIS ROUTINE WRITES THOSE LINES AND KEEPS     */ 04288000
*                   /* TRACK OF THE SPACING TO DETERMINE WHAT WILL   */ 04289000
*                   /* BE THE FIRST DATA LINE.                       */ 04290000
*                   /* PCTSLP POINTS TO THE TITLE LINES.             */ 04291000
*                   /* PCTSLC CONTAINS A COUNT OF THE NUMBER OF LINES*/ 04292000
*                   /*                                               */ 04293000
*                   /*************************************************/ 04294000
*                                                                  1129 04295000
*                   TTLPT = PCTSLP;    /* SET TEMP SUB-TITLE PTR    */  04296000
@RF01127 L     TTLPT,PCTSLP(,PCTPTR)                               1129 04297000
*                   IF PCTSLC ^= 0                                 1130 04298000
*                     THEN                                         1130 04299000
         LH    @04,PCTSLC(,PCTPTR)                                 1130 04300000
         LTR   @04,@04                                             1130 04301000
         BZ    @RF01130                                            1130 04302000
*                       /*********************************************/ 04303000
*                       /*                                           */ 04304000
*                       /* COMPUTE THE LINE SPACE FOR EACH           */ 04305000
*                       /* SUB-TITLE LINE FOR LOCATION OF FIRST DATA */ 04306000
*                       /* LINE.                                     */ 04307000
*                       /*                                           */ 04308000
*                       /*********************************************/ 04309000
*                                                                  1131 04310000
*                       DO LINCT = 1 TO PCTSLC;                    1131 04311000
         LA    @04,1                                               1131 04312000
         B     @DE01131                                            1131 04313000
@DL01131 DS    0H                                                  1132 04314000
*                         IF STLCC = ' '                           1132 04315000
*                           THEN       /* FIGURE LINE SPACING.       */ 04316000
         CLI   STLCC(TTLPT),64                                     1132 04317000
         BNE   @RF01132                                            1132 04318000
*                             PCTNLI = PCTNLI + 1;                 1133 04319000
         LA    @04,1                                               1133 04320000
         AH    @04,PCTNLI(,PCTPTR)                                 1133 04321000
         STH   @04,PCTNLI(,PCTPTR)                                 1133 04322000
*                         IF STLCC = '0'                           1134 04323000
*                           THEN                                   1134 04324000
@RF01132 CLI   STLCC(TTLPT),240                                    1134 04325000
         BNE   @RF01134                                            1134 04326000
*                             PCTNLI = PCTNLI + 2;                 1135 04327000
         LA    @04,2                                               1135 04328000
         AH    @04,PCTNLI(,PCTPTR)                                 1135 04329000
         STH   @04,PCTNLI(,PCTPTR)                                 1135 04330000
*                         IF STLCC = '-'                           1136 04331000
*                           THEN                                   1136 04332000
@RF01134 CLI   STLCC(TTLPT),96                                     1136 04333000
         BNE   @RF01136                                            1136 04334000
*                             PCTNLI = PCTNLI + 3;                 1137 04335000
*                                                                  1137 04336000
         LA    @04,3                                               1137 04337000
         AH    @04,PCTNLI(,PCTPTR)                                 1137 04338000
         STH   @04,PCTNLI(,PCTPTR)                                 1137 04339000
*                       /*********************************************/ 04340000
*                       /*                                           */ 04341000
*                       /* PUT THE SUB-TITLE LINE TO SYSPRINT.       */ 04342000
*                       /*                                           */ 04343000
*                       /*********************************************/ 04344000
*                                                                  1138 04345000
*                         CALL STACKPUT (STLINE);                  1138 04346000
*                                                                  1138 04347000
@RF01136 ST    TTLPT,@AL00001                                      1138 04348000
         LA    @01,@AL00001                                        1138 04349000
         BAL   @14,STACKPUT                                        1138 04350000
*                         RESPECIFY RTNREG RSTD;                   1139 04351000
*                         TESTRC = RTNREG;                         1140 04352000
         STH   RTNREG,TESTRC                                       1140 04353000
*                         RESPECIFY RTNREG UNRSTD;                 1141 04354000
*                         IF TESTRC ^= 0                           1142 04355000
*                           THEN                                   1142 04356000
         LH    @04,TESTRC                                          1142 04357000
         LTR   @04,@04                                             1142 04358000
         BZ    @RF01142                                            1142 04359000
*                             RETURN CODE(RCQUIT);                 1143 04360000
         LH    @15,RCQUIT                                          1143 04361000
         L     @14,@SA00014                                        1143 04362000
         LM    @00,@06,@SA00014+8                                  1143 04363000
         LM    @08,@12,@SA00014+36                                 1143 04364000
         BR    @14                                                 1143 04365000
*                         TTLPT = TTLPT + STDLWPS;                 1144 04366000
@RF01142 AH    TTLPT,STDLWPS                                       1144 04367000
*                                       /* STEP TO NEXT LINE.        */ 04368000
*                       END;                                       1145 04369000
         LA    @04,1                                               1145 04370000
         AL    @04,LINCT                                           1145 04371000
@DE01131 ST    @04,LINCT                                           1145 04372000
         CH    @04,PCTSLC(,PCTPTR)                                 1145 04373000
         BNH   @DL01131                                            1145 04374000
*                 /***************************************************/ 04375000
*                 /*                                                 */ 04376000
*                 /* IF HEADINGS ARE TO BE PRINTED, DO IT HERE.      */ 04377000
*                 /* HEADING LINES ARE KEPT IN A QUEUE ANCHORED ON   */ 04378000
*                 /* PCTAHP.  IF PCTHAF IS ON AND PCTH1F IS OFF      */ 04379000
*                 /* DURING PAGE OVERFLOW, ALL HEADING LINES IN THE  */ 04380000
*                 /* QUEUE ARE PRINTED.                              */ 04381000
*                 /* PCTHAF INDICATES A HEADING IS ACTIVE.           */ 04382000
*                 /* PCTH1F INDICATES THE CURRENT LINE IS THE FIRST  */ 04383000
*                 /*        LINE OF A NEW HEADING SET.               */ 04384000
*                 /*                                                 */ 04385000
*                 /***************************************************/ 04386000
*                                                                  1146 04387000
*                 IF PCTHAF = ON & PCTH1F = OFF                    1146 04388000
*                   THEN                                           1146 04389000
@RF01130 TM    PCTHAF(PCTPTR),B'00100000'                          1146 04390000
         BNO   @RF01146                                            1146 04391000
         TM    PCTH1F(PCTPTR),B'10000000'                          1146 04392000
         BNZ   @RF01146                                            1146 04393000
*                     DO;                                          1147 04394000
*                       HEADPTR = PCTAHP;                          1148 04395000
         L     @06,PCTAHP(,PCTPTR)                                 1148 04396000
         ST    @06,HEADPTR                                         1148 04397000
*                       DO WHILE HEADPTR > 0;                      1149 04398000
*                                                                  1149 04399000
         B     @DE01149                                            1149 04400000
@DL01149 DS    0H                                                  1150 04401000
*                         /*******************************************/ 04402000
*                         /*                                         */ 04403000
*                         /* COMPUTE THE LINE SPACE FOR EACH         */ 04404000
*                         /* HEADING LINE FOR LOCATION OF THE FIRST  */ 04405000
*                         /* DATA LINE.                              */ 04406000
*                         /*                                         */ 04407000
*                         /*******************************************/ 04408000
*                                                                  1150 04409000
*                         IF HEADCC = ' '                          1150 04410000
*                           THEN                                   1150 04411000
         L     @06,HEADPTR                                         1150 04412000
         CLI   HEADCC(@06),C' '                                    1150 04413000
         BNE   @RF01150                                            1150 04414000
*                             PCTNLI = PCTNLI + 1;                 1151 04415000
         LA    @06,1                                               1151 04416000
         AH    @06,PCTNLI(,PCTPTR)                                 1151 04417000
         STH   @06,PCTNLI(,PCTPTR)                                 1151 04418000
*                         IF HEADCC = '0'                          1152 04419000
*                           THEN                                   1152 04420000
@RF01150 L     @06,HEADPTR                                         1152 04421000
         CLI   HEADCC(@06),C'0'                                    1152 04422000
         BNE   @RF01152                                            1152 04423000
*                             PCTNLI = PCTNLI + 2;                 1153 04424000
         LA    @06,2                                               1153 04425000
         AH    @06,PCTNLI(,PCTPTR)                                 1153 04426000
         STH   @06,PCTNLI(,PCTPTR)                                 1153 04427000
*                         IF HEADCC = '-'                          1154 04428000
*                           THEN                                   1154 04429000
@RF01152 L     @06,HEADPTR                                         1154 04430000
         CLI   HEADCC(@06),C'-'                                    1154 04431000
         BNE   @RF01154                                            1154 04432000
*                             PCTNLI = PCTNLI + 3;                 1155 04433000
*                                                                  1155 04434000
         LA    @06,3                                               1155 04435000
         AH    @06,PCTNLI(,PCTPTR)                                 1155 04436000
         STH   @06,PCTNLI(,PCTPTR)                                 1155 04437000
*                         /*******************************************/ 04438000
*                         /*                                         */ 04439000
*                         /* WRITE THE HEADING LINES.                */ 04440000
*                         /*                                         */ 04441000
*                         /*******************************************/ 04442000
*                                                                  1156 04443000
*                         CALL STACKPUT (HEADCC);                  1156 04444000
*                                                                  1156 04445000
@RF01154 L     @06,HEADPTR                                         1156 04446000
         LA    @06,HEADCC(,@06)                                    1156 04447000
         ST    @06,@AL00001                                        1156 04448000
         LA    @01,@AL00001                                        1156 04449000
         BAL   @14,STACKPUT                                        1156 04450000
*                         RESPECIFY RTNREG RSTD;                   1157 04451000
*                         TESTRC = RTNREG;                         1158 04452000
         STH   RTNREG,TESTRC                                       1158 04453000
*                         RESPECIFY RTNREG UNRSTD;                 1159 04454000
*                         IF TESTRC ^= 0                           1160 04455000
*                           THEN                                   1160 04456000
         LH    @06,TESTRC                                          1160 04457000
         LTR   @06,@06                                             1160 04458000
         BZ    @RF01160                                            1160 04459000
*                             RETURN CODE(RCQUIT);                 1161 04460000
         LH    @15,RCQUIT                                          1161 04461000
         L     @14,@SA00014                                        1161 04462000
         LM    @00,@06,@SA00014+8                                  1161 04463000
         LM    @08,@12,@SA00014+36                                 1161 04464000
         BR    @14                                                 1161 04465000
*                         HEADPTR = HEADQP;                        1162 04466000
@RF01160 L     @06,HEADPTR                                         1162 04467000
         L     @06,HEADQP(,@06)                                    1162 04468000
         ST    @06,HEADPTR                                         1162 04469000
*                                       /* STEP HEADER LINE PTR.     */ 04470000
*                       END;                                       1163 04471000
@DE01149 L     @06,HEADPTR                                         1163 04472000
         LTR   @06,@06                                             1163 04473000
         BP    @DL01149                                            1163 04474000
*                     END;                                         1164 04475000
*                                                                  1164 04476000
*             END OFLOOP;                                          1165 04477000
@RF01146 DS    0H                                                  1166 04478000
*         /***********************************************************/ 04479000
*         /*                                                         */ 04480000
*         /*  DO THE REQUIRED SPACING FOR THE LINE TO BE PRINTED     */ 04481000
*         /*  SET UP TRIPLE LINE SPACES TO GET TO THE REQUIRED LINE  */ 04482000
*         /*                                                         */ 04483000
*         /***********************************************************/ 04484000
*                                                                  1166 04485000
*         PRCC = PRCCON(4);             /* SET TRIPLE SPACE CHAR     */ 04486000
@RF01093 MVC   PRCC(1),PRCCON+3                                    1166 04487000
*         DO WHILE SPFSAV > 3;                                     1167 04488000
         B     @DE01167                                            1167 04489000
@DL01167 DS    0H                                                  1168 04490000
*           PCTNLI = PCTNLI + 3;        /* ADVANCE LINE COUNT        */ 04491000
         LA    @06,3                                               1168 04492000
         LH    @04,PCTNLI(,PCTPTR)                                 1168 04493000
         ALR   @04,@06                                             1168 04494000
         STH   @04,PCTNLI(,PCTPTR)                                 1168 04495000
*           SPFSAV = SPFSAV - 3;        /* REDUCE REQUEST COUNT      */ 04496000
*                                                                  1169 04497000
         SLR   SPFSAV,@06                                          1169 04498000
*           CALL STACKPUT (PRCC);                                  1170 04499000
*                                                                  1170 04500000
         LA    @06,PRCC                                            1170 04501000
         ST    @06,@AL00001                                        1170 04502000
         LA    @01,@AL00001                                        1170 04503000
         BAL   @14,STACKPUT                                        1170 04504000
*           RESPECIFY RTNREG RSTD;                                 1171 04505000
*           TESTRC = RTNREG;                                       1172 04506000
         STH   RTNREG,TESTRC                                       1172 04507000
*           RESPECIFY RTNREG UNRSTD;                               1173 04508000
*           IF TESTRC ^= 0                                         1174 04509000
*             THEN                                                 1174 04510000
         LH    @06,TESTRC                                          1174 04511000
         LTR   @06,@06                                             1174 04512000
         BZ    @RF01174                                            1174 04513000
*               RETURN CODE(RCQUIT);                               1175 04514000
         LH    @15,RCQUIT                                          1175 04515000
         L     @14,@SA00014                                        1175 04516000
         LM    @00,@06,@SA00014+8                                  1175 04517000
         LM    @08,@12,@SA00014+36                                 1175 04518000
         BR    @14                                                 1175 04519000
*         END;                                                     1176 04520000
*                                                                  1176 04521000
@RF01174 DS    0H                                                  1176 04522000
@DE01167 C     SPFSAV,@CF00131                                     1176 04523000
         BH    @DL01167                                            1176 04524000
*         /***********************************************************/ 04525000
*         /*                                                         */ 04526000
*         /*  INITIALIZE AND TRANSLATE THIS DATA LINE                */ 04527000
*         /*                                                         */ 04528000
*         /***********************************************************/ 04529000
*                                                                  1177 04530000
*         PRCC = PRCCON(SPFSAV+1);      /* SET PROPER SPACE CHAR     */ 04531000
         LA    @06,PRCCON(SPFSAV)                                  1177 04532000
         MVC   PRCC(1),0(@06)                                      1177 04533000
*         IF PCTPMN ^= 0                                           1178 04534000
*           THEN                                                   1178 04535000
         LH    @06,PCTPMN(,PCTPTR)                                 1178 04536000
         LTR   @06,@06                                             1178 04537000
         BZ    @RF01178                                            1178 04538000
*               PRLINE(1:72) = PRTBUFF;                            1179 04539000
         MVC   PRLINE(72),PRTBUFF                                  1179 04540000
*           ELSE                                                   1180 04541000
*               PRLINE = PRTBUFF;       /* MOVE LINE FOR PRINT       */ 04542000
*                                                                  1180 04543000
         B     @RC01178                                            1180 04544000
@RF01178 MVC   PRLINE(120),PRTBUFF                                 1180 04545000
*         CVDREG = PCTTRP;              /* GET TRANSLATE TABLE ADDR. */ 04546000
@RC01178 L     CVDREG,PCTTRP(,PCTPTR)                              1181 04547000
*GENERATE (TR    PRLINE,0(CVDREG));     /* TRANSLATE THE LINE        */ 04548000
*                                                                  1182 04549000
         TR    PRLINE,0(CVDREG)                                         04550000
*         /***********************************************************/ 04551000
*         /*                                                         */ 04552000
*         /* SET UP THE ARGUMENTS FOR THE ADAPTER.                   */ 04553000
*         /* THEN PRINT THIS LINE.                                   */ 04554000
*         /*                                                         */ 04555000
*         /***********************************************************/ 04556000
*                                                                  1183 04557000
*         CALL STACKPUT (PRCC);                                    1183 04558000
*                                                                  1183 04559000
         LA    @06,PRCC                                            1183 04560000
         ST    @06,@AL00001                                        1183 04561000
         LA    @01,@AL00001                                        1183 04562000
         BAL   @14,STACKPUT                                        1183 04563000
*         RESPECIFY RTNREG RSTD;                                   1184 04564000
*         TESTRC = RTNREG;                                         1185 04565000
         STH   RTNREG,TESTRC                                       1185 04566000
*         RESPECIFY RTNREG UNRSTD;                                 1186 04567000
*         IF TESTRC ^= 0                                           1187 04568000
*           THEN                                                   1187 04569000
         LH    @06,TESTRC                                          1187 04570000
         LTR   @06,@06                                             1187 04571000
         BZ    @RF01187                                            1187 04572000
*             RETURN CODE(RCQUIT);                                 1188 04573000
         LH    @15,RCQUIT                                          1188 04574000
         L     @14,@SA00014                                        1188 04575000
         LM    @00,@06,@SA00014+8                                  1188 04576000
         LM    @08,@12,@SA00014+36                                 1188 04577000
         BR    @14                                                 1188 04578000
*         PCTPMN = 0;                                              1189 04579000
@RF01187 SLR   @06,@06                                             1189 04580000
         STH   @06,PCTPMN(,PCTPTR)                                 1189 04581000
*         PCTNLI = PCTNLI + SPFSAV;                                1190 04582000
*                                                                  1190 04583000
         LR    @06,SPFSAV                                          1190 04584000
         AH    @06,PCTNLI(,PCTPTR)                                 1190 04585000
         STH   @06,PCTNLI(,PCTPTR)                                 1190 04586000
*         /***********************************************************/ 04587000
*         /*                                                         */ 04588000
*         /* IF THE LINE JUST PRINTED WAS A NEW HEADING LINE, SET IT */ 04589000
*         /* UP IN THE HEADER QUEUE HERE.  THE CORE FOR THIS QUEUE   */ 04590000
*         /* IS OBTAINED FROM POOL 'TP03'.  IF THERE WAS A PREVIOUS  */ 04591000
*         /* HEADER, ITS CORE IS FREED PRIOR TO GETTING CORE FOR     */ 04592000
*         /* THIS HEADER.  ALL HEADER CORE IS FREED WHEN A RESET IS  */ 04593000
*         /* ISSUED AT ANY TIME.                                     */ 04594000
*         /* PCTHAF IS A FLAG INDICATING THAT A HEADER IS ACTIVE.    */ 04595000
*         /* PCTH1F IS A FLAG INDICATING THAT THE CURRENT LINE       */ 04596000
*         /*        IS THE FIRST OF A NEW SERIES OF HEADER LINES.    */ 04597000
*         /* PCTH2F IS A FLAG INDICATING THAT THE CURRENT LINE IS A  */ 04598000
*         /*        CONTINUATION LINE OF A SET OF HEADERS BEING      */ 04599000
*         /*        ENTERED.                                         */ 04600000
*         /* PCTAHP IS THE ANCHOR POINT FOR THE HEADER QUEUE IN THE  */ 04601000
*         /*        PRINT CONTROL TABLE.                             */ 04602000
*         /*                                                         */ 04603000
*         /***********************************************************/ 04604000
*                                                                  1191 04605000
*         /***********************************************************/ 04606000
*         /*                                                         */ 04607000
*         /* IF A HEADING EXISTS AND THIS LINE IS A NEW ONE, FREE    */ 04608000
*         /* THE POOL SPACE FOR THE EXISTING HEADER.                 */ 04609000
*         /*                                                         */ 04610000
*         /***********************************************************/ 04611000
*                                                                  1191 04612000
*         IF PCTH1F = ON & PCTHAF = ON                             1191 04613000
*           THEN                                                   1191 04614000
         TM    PCTH1F(PCTPTR),B'10100000'                          1191 04615000
         BNO   @RF01191                                            1191 04616000
*             DO;                                                  1192 04617000
*                                                                  1192 04618000
*               CALL ICKSAFP0 (GDTTBL,HDPOOL);                     1193 04619000
*                                                                  1193 04620000
         ST    GDTPR,@AL00001                                      1193 04621000
         LA    @06,HDPOOL                                          1193 04622000
         ST    @06,@AL00001+4                                      1193 04623000
         MVI   @AL00001+4,X'80'                                    1193 04624000
         L     @15,GDTFPL(,GDTPR)                                  1193 04625000
         LA    @01,@AL00001                                        1193 04626000
         BALR  @14,@15                                             1193 04627000
*               PCTAHP = ''B;                                      1194 04628000
         SLR   @06,@06                                             1194 04629000
         ST    @06,PCTAHP(,PCTPTR)                                 1194 04630000
*             END;                                                 1195 04631000
*                                                                  1195 04632000
*         /***********************************************************/ 04633000
*         /*                                                         */ 04634000
*         /* GET THE POOL STORAGE FOR THE NEW HEADER LINE.           */ 04635000
*         /*                                                         */ 04636000
*         /***********************************************************/ 04637000
*                                                                  1196 04638000
*         IF PCTH1F = ON | PCTH2F = ON                             1196 04639000
*           THEN                                                   1196 04640000
@RF01191 TM    PCTH1F(PCTPTR),B'11000000'                          1196 04641000
         BZ    @RF01196                                            1196 04642000
*             DO;                                                  1197 04643000
*               CURLI = PCTPLW + 4;                                1198 04644000
*                                                                  1198 04645000
         LA    @06,4                                               1198 04646000
         AL    @06,PCTPLW(,PCTPTR)                                 1198 04647000
         ST    @06,CURLI                                           1198 04648000
*               CALL ICKSAGP0 (GDTTBL,CURLI,HEADPTR,HDPOOL,SETZERO);    04649000
         ST    GDTPR,@AL00001                                      1199 04650000
         LA    @06,CURLI                                           1199 04651000
         ST    @06,@AL00001+4                                      1199 04652000
         LA    @06,HEADPTR                                         1199 04653000
         ST    @06,@AL00001+8                                      1199 04654000
         LA    @06,HDPOOL                                          1199 04655000
         ST    @06,@AL00001+12                                     1199 04656000
         LA    @06,@CC00140                                        1199 04657000
         ST    @06,@AL00001+16                                     1199 04658000
         MVI   @AL00001+16,X'80'                                   1199 04659000
         L     @15,GDTGPL(,GDTPR)                                  1199 04660000
         LA    @01,@AL00001                                        1199 04661000
         BALR  @14,@15                                             1199 04662000
*                                       /* GET THE POOL CORE.        */ 04663000
*                                                                  1200 04664000
*               RESPECIFY RTNREG RSTD;                             1200 04665000
*               TESTRC = RTNREG;                                   1201 04666000
         STH   RTNREG,TESTRC                                       1201 04667000
*               RESPECIFY RTNREG UNRSTD;                           1202 04668000
*                 IF TESTRC ^= 0                                   1203 04669000
*                   THEN                                           1203 04670000
*                                                                  1203 04671000
         LH    @06,TESTRC                                          1203 04672000
         LTR   @06,@06                                             1203 04673000
         BZ    @RF01203                                            1203 04674000
*                     DO;                                          1204 04675000
*                       RESPECIFY(REG13,REG14,REG15) RSTD;         1205 04676000
*                       REG15 = 28;                                1206 04677000
         LA    REG15,28                                            1206 04678000
*                       REG14 = GDTABT;                            1207 04679000
         L     REG14,GDTABT(,GDTPR)                                1207 04680000
*                       REG13 = GDTABH;                            1208 04681000
         L     REG13,GDTABH(,GDTPR)                                1208 04682000
*                       GEN(BR    REG14);                          1209 04683000
         BR    REG14                                                    04684000
*                       RESPECIFY(REG13,REG14,REG15)UNRSTD;        1210 04685000
*                     END;                                         1211 04686000
*                                                                  1211 04687000
*               IF PCTH1F = ON                                     1212 04688000
*                 THEN                                             1212 04689000
*                                                                  1212 04690000
@RF01203 TM    PCTH1F(PCTPTR),B'10000000'                          1212 04691000
         BNO   @RF01212                                            1212 04692000
*                 /***************************************************/ 04693000
*                 /*                                                 */ 04694000
*                 /* INITIALIZE A NEW HEADER QUEUE.                  */ 04695000
*                 /*                                                 */ 04696000
*                 /***************************************************/ 04697000
*                                                                  1213 04698000
*                   DO;                                            1213 04699000
*                     PCTAHP = HEADPTR;                            1214 04700000
         L     @06,HEADPTR                                         1214 04701000
         ST    @06,PCTAHP(,PCTPTR)                                 1214 04702000
*                     HEADCC = PRCCON(3);                          1215 04703000
         MVC   HEADCC(1,@06),PRCCON+2                              1215 04704000
*                   END;                                           1216 04705000
*               IF PCTH2F = ON                                     1217 04706000
*                 THEN                                             1217 04707000
@RF01212 TM    PCTH2F(PCTPTR),B'01000000'                          1217 04708000
         BNO   @RF01217                                            1217 04709000
*                 /***************************************************/ 04710000
*                 /*                                                 */ 04711000
*                 /* ADD A NEW LINE TO THE HEADER QUEUE.             */ 04712000
*                 /*                                                 */ 04713000
*                 /***************************************************/ 04714000
*                                                                  1218 04715000
*                   DO;                                            1218 04716000
*                     IF PCTAHP = NULLPTR                          1219 04717000
*                       THEN                                       1219 04718000
         L     @06,PCTAHP(,PCTPTR)                                 1219 04719000
         LTR   @06,@06                                             1219 04720000
         BNZ   @RF01219                                            1219 04721000
*                         DO;                                      1220 04722000
*                           /*****************************************/ 04723000
*                           /*                                       */ 04724000
*                           /* WE ARE PART WAY THROUGH A HEADING     */ 04725000
*                           /* WITH A RESET HAVING BEEN ISSUED.      */ 04726000
*                           /* RETURN WITH CONDITION 12.             */ 04727000
*                           /*                                       */ 04728000
*                           /*****************************************/ 04729000
*                                                                  1221 04730000
*                           PCTH2F = OFF;                          1221 04731000
*                           PCTHAF = OFF;                          1222 04732000
         NI    PCTH2F(PCTPTR),B'10011111'                          1222 04733000
*                           PCTHLC = ''B;                          1223 04734000
         SLR   @06,@06                                             1223 04735000
         STC   @06,PCTHLC(,PCTPTR)                                 1223 04736000
*                           PCTHSC = ''B;                          1224 04737000
         SLR   @06,@06                                             1224 04738000
         STC   @06,PCTHSC(,PCTPTR)                                 1224 04739000
*                           RETURN CODE(RCQUIT);                   1225 04740000
         LH    @15,RCQUIT                                          1225 04741000
         L     @14,@SA00014                                        1225 04742000
         LM    @00,@06,@SA00014+8                                  1225 04743000
         LM    @08,@12,@SA00014+36                                 1225 04744000
         BR    @14                                                 1225 04745000
*                         END;                                     1226 04746000
*                     HDQPTR = PCTAHP;                             1227 04747000
@RF01219 L     @06,PCTAHP(,PCTPTR)                                 1227 04748000
         ST    @06,HDQPTR                                          1227 04749000
*                     DO WHILE HDQPTR->HEADQP ^= NULLPTR;          1228 04750000
         B     @DE01228                                            1228 04751000
@DL01228 DS    0H                                                  1229 04752000
*                       HDQPTR = HDQPTR->HEADQP;                   1229 04753000
         L     @06,HDQPTR                                          1229 04754000
         L     @06,HEADQP(,@06)                                    1229 04755000
         ST    @06,HDQPTR                                          1229 04756000
*                     END;                                         1230 04757000
@DE01228 L     @06,HDQPTR                                          1230 04758000
         L     @04,HEADQP(,@06)                                    1230 04759000
         LTR   @04,@04                                             1230 04760000
         BNZ   @DL01228                                            1230 04761000
*                     HDQPTR->HEADQP = HEADPTR;                    1231 04762000
         L     @04,HEADPTR                                         1231 04763000
         ST    @04,HEADQP(,@06)                                    1231 04764000
*                     HEADCC = PRCC;                               1232 04765000
         MVC   HEADCC(1,@04),PRCC                                  1232 04766000
*                   END;                                           1233 04767000
*                                                                  1233 04768000
*               /*****************************************************/ 04769000
*               /*                                                   */ 04770000
*               /* THIS STATEMENT MOVES ALL HEADING LINES TO THE     */ 04771000
*               /* SPACE AQUIRED FOR THEM.                           */ 04772000
*               /*                                                   */ 04773000
*               /*****************************************************/ 04774000
*                                                                  1234 04775000
*               HEADLI(1:PCTPLW) = PRLINE(1:PCTPLW);               1234 04776000
*                                                                  1234 04777000
@RF01217 L     @06,HEADPTR                                         1234 04778000
         L     @04,PCTPLW(,PCTPTR)                                 1234 04779000
         BCTR  @04,0                                               1234 04780000
         EX    @04,@SM00934                                        1234 04781000
*               /*****************************************************/ 04782000
*               /*                                                   */ 04783000
*               /* CHECK IF THIS IS THE LAST OF THE SET AND SET      */ 04784000
*               /* FLAGS ACCORDINGLY.                                */ 04785000
*               /*                                                   */ 04786000
*               /*****************************************************/ 04787000
*                                                                  1235 04788000
*               PCTHLC = PCTHLC - 1;                               1235 04789000
         SLR   @06,@06                                             1235 04790000
         IC    @06,PCTHLC(,PCTPTR)                                 1235 04791000
         BCTR  @06,0                                               1235 04792000
         STC   @06,PCTHLC(,PCTPTR)                                 1235 04793000
*               PCTH1F = OFF;                                      1236 04794000
         NI    PCTH1F(PCTPTR),B'01111111'                          1236 04795000
*               IF PCTHLC > 0                                      1237 04796000
*                 THEN                                             1237 04797000
         CLI   PCTHLC(PCTPTR),0                                    1237 04798000
         BNH   @RF01237                                            1237 04799000
*                    PCTH2F = ON;                                  1238 04800000
         OI    PCTH2F(PCTPTR),B'01000000'                          1238 04801000
*                  ELSE                                            1239 04802000
*                    PCTH2F = OFF;                                 1239 04803000
         B     @RC01237                                            1239 04804000
@RF01237 NI    PCTH2F(PCTPTR),B'10111111'                          1239 04805000
*               PCTHAF = ON;                                       1240 04806000
@RC01237 OI    PCTHAF(PCTPTR),B'00100000'                          1240 04807000
*             END;                                                 1241 04808000
*                                                                  1241 04809000
*         IF GDTDBG = NULLPTR                                      1242 04810000
*           THEN;                                                  1242 04811000
@RF01196 L     @06,GDTDBG(,GDTPR)                                  1242 04812000
         LTR   @06,@06                                             1242 04813000
         BZ    @RT01242                                            1242 04814000
*           ELSE                                                   1244 04815000
*             CALL ICKDB010 (GDTTBL,'TP3N');                       1244 04816000
*                                                                  1244 04817000
         ST    GDTPR,@AL00001                                      1244 04818000
         LA    @06,@CC00871                                        1244 04819000
         ST    @06,@AL00001+4                                      1244 04820000
         MVI   @AL00001+4,X'80'                                    1244 04821000
         L     @15,GDTDBG(,GDTPR)                                  1244 04822000
         LA    @01,@AL00001                                        1244 04823000
         BALR  @14,@15                                             1244 04824000
*         FFMFMTF = OFF;                                           1245 04825000
@RT01242 NI    FFMFMTF,B'11111110'                                 1245 04826000
*         PRTBUFF = ' ';                                           1246 04827000
         MVI   PRTBUFF+1,C' '                                      1246 04828000
         MVC   PRTBUFF+2(131),PRTBUFF+1                            1246 04829000
         MVI   PRTBUFF,C' '                                        1246 04830000
*         RETURN CODE(TESTRC);                                     1247 04831000
*                                                                  1247 04832000
         LH    @15,TESTRC                                          1247 04833000
         L     @14,@SA00014                                        1247 04834000
         LM    @00,@06,@SA00014+8                                  1247 04835000
         LM    @08,@12,@SA00014+36                                 1247 04836000
         BR    @14                                                 1247 04837000
*         END LINEPRT;                                             1248 04838000
*         /***********************************************************/ 04839000
*         /*                                                         */ 04840000
*         /* PROCEDURE NAME - LINE STACKING AND UPUT PROCEDURE.      */ 04841000
*         /*                                                         */ 04842000
*         /* FUNCTION - PUT THE PRINT LINES INTO THE OUTPUT BUFFER.  */ 04843000
*         /*     A UPUT IS ISSUED FOR THIS BUFFER WHEN THE BUFFER    */ 04844000
*         /*     IS FULL OR WHEN THE NEXT LINE TO BE PRINTED IS A    */ 04845000
*         /*     MESSAGE.  THIS BUFFER IS NORMALLY 2048 BYTES LONG   */ 04846000
*         /*     BUT MAY BE CHANGED BY ALTERING THE CONSTANT PRBUFL  */ 04847000
*         /*     BOTH HERE AND IN THE MODULE ICKTP04.                */ 04848000
*         /*     IF THE FLAG FFMPSFF IS ON, THERE IS NO LINE TO BE   */ 04849000
*         /*     ADDED BUT THE STACK IS TO BE PRINTED OUT.           */ 04850000
*         /*                                                         */ 04851000
*         /* INPUT - A LINE WIDTH BYTE AREA CONTAINING THE CARRIAGE  */ 04852000
*         /*     CONTROL CHARACTER AND THE DATA LINE.                */ 04853000
*         /*                                                         */ 04854000
*         /* OUTPUT - PRINT LINES TO THE IO ADAPTOR.                 */ 04855000
*         /*     AS LINES ARE PUT INTO THE BUFFER OR IN THE CASE OF  */ 04856000
*         /*     MESSAGES, AS THEY ARE PUT DIRECTLY TO THE IO        */ 04857000
*         /*     ADAPTOR, TRAILING BLANKS ARE STRIPPED TO A MINIMUM  */ 04858000
*         /*     A 1 BYTE DATA LINE PLUS THE CARRIAGE CONTROL        */ 04859000
*         /*     CHARACTER.                                          */ 04860000
*         /*                                                         */ 04861000
*         /***********************************************************/ 04862000
*                                                                  1249 04863000
*STACKPUT: PROC (PUTLINE);                                         1249 04864000
*                                                                  1249 04865000
STACKPUT STM   @14,@06,@SA00015                                    1249 04866000
         STM   @08,@12,@SA00015+36                                 1249 04867000
         MVC   @PC00015(4),0(@01)                                  1249 04868000
*         DCL PUTLINE CHAR(121);       /* INPUT ARGUMENT (DATA LINE) */ 04869000
*                                                                  1250 04870000
*         /***********************************************************/ 04871000
*         /*                                                         */ 04872000
*         /* LOCATE AND STRIP THE TRAILING BLANKS                    */ 04873000
*         /* IF A LINE IS TO BE ADDED OR PRINTED.  (FFMPSFF OFF)     */ 04874000
*         /*                                                         */ 04875000
*         /***********************************************************/ 04876000
*                                                                  1251 04877000
*         IF FFMPSFF = OFF                                         1251 04878000
*           THEN                                                   1251 04879000
         TM    FFMPSFF,B'00100000'                                 1251 04880000
         BNZ   @RF01251                                            1251 04881000
*               DO N = (PCTPLW + 1) TO 10 BY -1 WHILE PUTLINE(N) = ' '; 04882000
*                                                                  1252 04883000
         LA    N,1                                                 1252 04884000
         AL    N,PCTPLW(,PCTPTR)                                   1252 04885000
         B     @DE01252                                            1252 04886000
@DL01252 L     @06,@PC00015                                        1252 04887000
         ALR   @06,N                                               1252 04888000
         BCTR  @06,0                                               1252 04889000
         CLI   PUTLINE(@06),C' '                                   1252 04890000
         BNE   @DC01252                                            1252 04891000
*               END;                                               1253 04892000
*                                                                  1253 04893000
         BCTR  N,0                                                 1253 04894000
@DE01252 C     N,@CF00032                                          1253 04895000
         BNL   @DL01252                                            1253 04896000
@DC01252 DS    0H                                                  1254 04897000
*         /***********************************************************/ 04898000
*         /*                                                         */ 04899000
*         /* IF LINES ARE IN THE STACK AND IF THE STACK IS FULL OR   */ 04900000
*         /* THE CURRENT LINE IS A MESSAGE, OR THE FLUSH FLAG IS ON  */ 04901000
*         /* PUT THE STACK TO THE IO ADAPTOR.                        */ 04902000
*         /*                                                         */ 04903000
*         /***********************************************************/ 04904000
*                                                                  1254 04905000
*         IF PCTLNM ^= 0 & ((PCTBNL + (N+2) > (PCTBUF + PRBUFL))   1254 04906000
*           | FFMPMSF = ON                                         1254 04907000
*           | FFMPSFF = ON)                                        1254 04908000
*           THEN                                                   1254 04909000
@RF01251 LH    @06,PCTLNM(,PCTPTR)                                 1254 04910000
         LTR   @06,@06                                             1254 04911000
         BZ    @RF01254                                            1254 04912000
         LA    @06,2                                               1254 04913000
         ALR   @06,N                                               1254 04914000
         AL    @06,PCTBNL(,PCTPTR)                                 1254 04915000
         LH    @04,PRBUFL                                          1254 04916000
         AL    @04,PCTBUF(,PCTPTR)                                 1254 04917000
         CR    @06,@04                                             1254 04918000
         BH    @RT01254                                            1254 04919000
         TM    FFMPMSF,B'00110000'                                 1254 04920000
         BZ    @RF01254                                            1254 04921000
@RT01254 DS    0H                                                  1255 04922000
*             DO;                                                  1255 04923000
*               IOCDLN = PCTBNL - PCTBUF;                          1256 04924000
         L     @06,IOCSPTR                                         1256 04925000
         L     @04,PCTBUF(,PCTPTR)                                 1256 04926000
         L     @03,PCTBNL(,PCTPTR)                                 1256 04927000
         SLR   @03,@04                                             1256 04928000
         ST    @03,IOCDLN(,@06)                                    1256 04929000
*               IOCDAD = PCTBUF;                                   1257 04930000
         ST    @04,IOCDAD(,@06)                                    1257 04931000
*               IOCPNM = PCTLNM;                                   1258 04932000
         LH    @03,PCTLNM(,PCTPTR)                                 1258 04933000
         STH   @03,IOCPNM(,@06)                                    1258 04934000
*               PCTBNL = PCTBUF;                                   1259 04935000
         ST    @04,PCTBNL(,PCTPTR)                                 1259 04936000
*               PCTLNM = 0;                                        1260 04937000
*                                                                  1260 04938000
         SLR   @06,@06                                             1260 04939000
         STH   @06,PCTLNM(,PCTPTR)                                 1260 04940000
*               CALL ICKIOPT0 (GDTTBL,PCTIOC,NULLPMN);             1261 04941000
*                                                                  1261 04942000
         ST    GDTPR,@AL00001                                      1261 04943000
         LA    @06,PCTIOC(,PCTPTR)                                 1261 04944000
         ST    @06,@AL00001+4                                      1261 04945000
         LA    @06,NULLPMN                                         1261 04946000
         ST    @06,@AL00001+8                                      1261 04947000
         MVI   @AL00001+8,X'80'                                    1261 04948000
         L     @15,GDTPUT(,GDTPR)                                  1261 04949000
         LA    @01,@AL00001                                        1261 04950000
         BALR  @14,@15                                             1261 04951000
*               RESPECIFY RTNREG RSTD;                             1262 04952000
*               TESTRC = RTNREG;                                   1263 04953000
         STH   RTNREG,TESTRC                                       1263 04954000
*               RESPECIFY RTNREG UNRSTD;                           1264 04955000
*               IF TESTRC ^= 0                                     1265 04956000
*                 THEN                                             1265 04957000
*                                                                  1265 04958000
         LH    @06,TESTRC                                          1265 04959000
         LTR   @06,@06                                             1265 04960000
         BZ    @RF01265                                            1265 04961000
*                   DO;                                            1266 04962000
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           1267 04963000
*                     REG15 = 36;                                  1268 04964000
         LA    REG15,36                                            1268 04965000
*                     REG14 = GDTABT;                              1269 04966000
         L     REG14,GDTABT(,GDTPR)                                1269 04967000
*                     REG13 = GDTABH;                              1270 04968000
         L     REG13,GDTABH(,GDTPR)                                1270 04969000
*                     GEN(BR    REG14);                            1271 04970000
         BR    REG14                                                    04971000
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          1272 04972000
*                   END;                                           1273 04973000
*                                                                  1273 04974000
*             END;                                                 1274 04975000
*                                                                  1274 04976000
*                                                                  1274 04977000
@RF01265 DS    0H                                                  1275 04978000
*         /***********************************************************/ 04979000
*         /*                                                         */ 04980000
*         /* IF THE CURRENT LINE IS A MESSAGE, PUT IT DIRECTLY.      */ 04981000
*         /*                                                         */ 04982000
*         /***********************************************************/ 04983000
*                                                                  1275 04984000
*         IF FFMPMSF = ON & FFMPSFF = OFF                          1275 04985000
*           THEN                                                   1275 04986000
@RF01254 TM    FFMPMSF,B'00010000'                                 1275 04987000
         BNO   @RF01275                                            1275 04988000
         TM    FFMPSFF,B'00100000'                                 1275 04989000
         BNZ   @RF01275                                            1275 04990000
*             DO;                                                  1276 04991000
*               IOCDLN = N;                                        1277 04992000
         L     @06,IOCSPTR                                         1277 04993000
         ST    N,IOCDLN(,@06)                                      1277 04994000
*               IOCDAD = ADDR(PUTLINE);                            1278 04995000
         L     @04,@PC00015                                        1278 04996000
         ST    @04,IOCDAD(,@06)                                    1278 04997000
*               IOCPNM = ''B;                                      1279 04998000
*                                                                  1279 04999000
         SLR   @04,@04                                             1279 05000000
         STH   @04,IOCPNM(,@06)                                    1279 05001000
*               CALL ICKIOPT0 (GDTTBL,PCTIOC,PCTPMN);              1280 05002000
*                                                                  1280 05003000
         ST    GDTPR,@AL00001                                      1280 05004000
         LA    @06,PCTIOC(,PCTPTR)                                 1280 05005000
         ST    @06,@AL00001+4                                      1280 05006000
         LA    @06,PCTPMN(,PCTPTR)                                 1280 05007000
         ST    @06,@AL00001+8                                      1280 05008000
         MVI   @AL00001+8,X'80'                                    1280 05009000
         L     @15,GDTPUT(,GDTPR)                                  1280 05010000
         LA    @01,@AL00001                                        1280 05011000
         BALR  @14,@15                                             1280 05012000
*               RESPECIFY RTNREG RSTD;                             1281 05013000
*               TESTRC = RTNREG;                                   1282 05014000
         STH   RTNREG,TESTRC                                       1282 05015000
*               RESPECIFY RTNREG UNRSTD;                           1283 05016000
*               IF TESTRC ^= 0                                     1284 05017000
*                 THEN                                             1284 05018000
*                                                                  1284 05019000
         LH    @06,TESTRC                                          1284 05020000
         LTR   @06,@06                                             1284 05021000
         BZ    @RF01284                                            1284 05022000
*                   DO;                                            1285 05023000
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           1286 05024000
*                     REG15 = 36;                                  1287 05025000
         LA    REG15,36                                            1287 05026000
*                     REG14 = GDTABT;                              1288 05027000
         L     REG14,GDTABT(,GDTPR)                                1288 05028000
*                     REG13 = GDTABH;                              1289 05029000
         L     REG13,GDTABH(,GDTPR)                                1289 05030000
*                     GEN(BR    REG14);                            1290 05031000
         BR    REG14                                                    05032000
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          1291 05033000
*                   END;                                           1292 05034000
*                                                                  1292 05035000
*               PCTPMN = ''B;                                      1293 05036000
@RF01284 SLR   @06,@06                                             1293 05037000
         STH   @06,PCTPMN(,PCTPTR)                                 1293 05038000
*               PCTLLM = ON;                                       1294 05039000
*                                                                  1294 05040000
         OI    PCTLLM(PCTPTR),B'00010000'                          1294 05041000
*               RETURN CODE(0);                                    1295 05042000
*                                                                  1295 05043000
         SLR   @15,@15                                             1295 05044000
         L     @14,@SA00015                                        1295 05045000
         LM    @00,@06,@SA00015+8                                  1295 05046000
         LM    @08,@12,@SA00015+36                                 1295 05047000
         BR    @14                                                 1295 05048000
*             END;                                                 1296 05049000
*         /***********************************************************/ 05050000
*         /*                                                         */ 05051000
*         /* PUT THIS CURRENT LINE IN THE STACK.                     */ 05052000
*         /*                                                         */ 05053000
*         /***********************************************************/ 05054000
*                                                                  1297 05055000
*         IF FFMPSFF = OFF                                         1297 05056000
*           THEN                                                   1297 05057000
@RF01275 TM    FFMPSFF,B'00100000'                                 1297 05058000
         BNZ   @RF01297                                            1297 05059000
*             DO;                                                  1298 05060000
*               STACKLL = N;                                       1299 05061000
         L     @06,PCTBNL(,PCTPTR)                                 1299 05062000
         STCM  N,3,STACKLL(@06)                                    1299 05063000
*               STACKDL(1:N) = PUTLINE(1:N);                       1300 05064000
         LR    @04,N                                               1300 05065000
         BCTR  @04,0                                               1300 05066000
         L     @03,@PC00015                                        1300 05067000
         EX    @04,@SM00936                                        1300 05068000
*               PCTLNM = PCTLNM + 1;                               1301 05069000
         LA    @04,1                                               1301 05070000
         AH    @04,PCTLNM(,PCTPTR)                                 1301 05071000
         STH   @04,PCTLNM(,PCTPTR)                                 1301 05072000
*               PCTBNL = PCTBNL + N + 2;                           1302 05073000
         ALR   @06,N                                               1302 05074000
         AL    @06,@CF00111                                        1302 05075000
         ST    @06,PCTBNL(,PCTPTR)                                 1302 05076000
*             END;                                                 1303 05077000
*         FFMPSFF = OFF;                                           1304 05078000
*                                                                  1304 05079000
@RF01297 NI    FFMPSFF,B'11011111'                                 1304 05080000
*         RETURN CODE(0);                                          1305 05081000
*                                                                  1305 05082000
         SLR   @15,@15                                             1305 05083000
         L     @14,@SA00015                                        1305 05084000
         LM    @00,@06,@SA00015+8                                  1305 05085000
         LM    @08,@12,@SA00015+36                                 1305 05086000
         BR    @14                                                 1305 05087000
*         END STACKPUT;                                            1306 05088000
*         /***********************************************************/ 05089000
*         /*                                                         */ 05090000
*         /* PROCEDURE NAME - ERROR PROCEDURE.                       */ 05091000
*         /*                                                         */ 05092000
*         /* FUNCTION - CAUSE THE PRINTING OF TP ERROR MESSAGES.     */ 05093000
*         /*                                                         */ 05094000
*         /* INPUT - A CODE INDICATING THE ERROR MESSAGE TO BE PUT.  */ 05095000
*         /*                                                         */ 05096000
*         /* OUTPUT - A TEXT PROCESSING ERROR MESSAGE.               */ 05097000
*         /*                                                         */ 05098000
*         /***********************************************************/ 05099000
*                                                                  1307 05100000
*ERROR:   PROC (ERRCODE);                                          1307 05101000
*                                                                  1307 05102000
ERROR    STM   @14,@06,@SA00016                                    1307 05103000
         STM   @08,@12,@SA00016+36                                 1307 05104000
         MVC   @PC00016(4),0(@01)                                  1307 05105000
*         DCL CVPSAVP PTR(31);                                     1308 05106000
*         DCL CVPSAV CHAR(LENGTH(CVPSTRU)) BASED(CVPSAVP);         1309 05107000
*                                                                  1309 05108000
*         IF GDTDBG = NULLPTR                                      1310 05109000
*           THEN;                                                  1310 05110000
         L     @06,GDTDBG(,GDTPR)                                  1310 05111000
         LTR   @06,@06                                             1310 05112000
         BZ    @RT01310                                            1310 05113000
*           ELSE                                                   1312 05114000
*             CALL ICKDB010 (GDTTBL,'TPER');                       1312 05115000
*                                                                  1312 05116000
         ST    GDTPR,@AL00001                                      1312 05117000
         LA    @06,@CC00885                                        1312 05118000
         ST    @06,@AL00001+4                                      1312 05119000
         MVI   @AL00001+4,X'80'                                    1312 05120000
         L     @15,GDTDBG(,GDTPR)                                  1312 05121000
         LA    @01,@AL00001                                        1312 05122000
         BALR  @14,@15                                             1312 05123000
*         STIDMOD = STMODID;           /* SET MODULE IDENT           */ 05124000
@RT01310 MVC   STIDMOD(3),STMODID                                  1313 05125000
*         STIDENT = ERRCODE;            /* SET THE ENTRY NUMBER.     */ 05126000
*                                                                  1314 05127000
         L     @06,@PC00016                                        1314 05128000
         L     @06,ERRCODE(,@06)                                   1314 05129000
         STC   @06,STIDENT                                         1314 05130000
*         CALL ICKSACL0 (GDTTBL,'ICKTP05 ',STID,GPOOL,MSGAREA);    1315 05131000
*                                                                  1315 05132000
         ST    GDTPR,@AL00001                                      1315 05133000
         LA    @06,@CC00784                                        1315 05134000
         ST    @06,@AL00001+4                                      1315 05135000
         LA    @06,STID                                            1315 05136000
         ST    @06,@AL00001+8                                      1315 05137000
         LA    @06,GPOOL                                           1315 05138000
         ST    @06,@AL00001+12                                     1315 05139000
         LA    @06,MSGAREA                                         1315 05140000
         ST    @06,@AL00001+16                                     1315 05141000
         MVI   @AL00001+16,X'80'                                   1315 05142000
         L     @15,GDTCAL(,GDTPR)                                  1315 05143000
         LA    @01,@AL00001                                        1315 05144000
         BALR  @14,@15                                             1315 05145000
*         RESPECIFY RTNREG RSTD;                                   1316 05146000
*         TESTRC = RTNREG;                                         1317 05147000
         STH   RTNREG,TESTRC                                       1317 05148000
*         RESPECIFY RTNREG UNRSTD;                                 1318 05149000
*         IF TESTRC ^= 0                                           1319 05150000
*           THEN                                                   1319 05151000
         LH    @06,TESTRC                                          1319 05152000
         LTR   @06,@06                                             1319 05153000
         BZ    @RF01319                                            1319 05154000
*             RETURN CODE(RCQUIT);                                 1320 05155000
*                                                                  1320 05156000
         LH    @15,RCQUIT                                          1320 05157000
         L     @14,@SA00016                                        1320 05158000
         LM    @00,@06,@SA00016+8                                  1320 05159000
         LM    @08,@12,@SA00016+36                                 1320 05160000
         BR    @14                                                 1320 05161000
*         CALL ICKSAGS0 (GDTTBL,LENGTH(CVPSTRU),CVPSAVP);          1321 05162000
*                                                                  1321 05163000
@RF01319 ST    GDTPR,@AL00001                                      1321 05164000
         LA    @06,@CF00888                                        1321 05165000
         ST    @06,@AL00001+4                                      1321 05166000
         LA    @06,CVPSAVP                                         1321 05167000
         ST    @06,@AL00001+8                                      1321 05168000
         MVI   @AL00001+8,X'80'                                    1321 05169000
         L     @15,GDTGSP(,GDTPR)                                  1321 05170000
         LA    @01,@AL00001                                        1321 05171000
         BALR  @14,@15                                             1321 05172000
*         RESPECIFY RTNREG RSTD;                                   1322 05173000
*         TESTRC = RTNREG;                                         1323 05174000
         STH   RTNREG,TESTRC                                       1323 05175000
*         RESPECIFY RTNREG UNRSTD;                                 1324 05176000
*         IF TESTRC ^= 0                                           1325 05177000
*           THEN                                                   1325 05178000
*                                                                  1325 05179000
         LH    @06,TESTRC                                          1325 05180000
         LTR   @06,@06                                             1325 05181000
         BZ    @RF01325                                            1325 05182000
*             DO;                                                  1326 05183000
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 1327 05184000
*               REG15 = 28;                                        1328 05185000
         LA    REG15,28                                            1328 05186000
*               REG14 = GDTABT;                                    1329 05187000
         L     REG14,GDTABT(,GDTPR)                                1329 05188000
*               REG13 = GDTABH;                                    1330 05189000
         L     REG13,GDTABH(,GDTPR)                                1330 05190000
*               GEN(BR    REG14);                                  1331 05191000
         BR    REG14                                                    05192000
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                1332 05193000
*             END;                                                 1333 05194000
*                                                                  1333 05195000
*         PCTPMN = ERRCODE + 949;       /* SET MESSAGE NUMBER.       */ 05196000
@RF01325 L     @06,@PC00016                                        1334 05197000
         LA    @04,949                                             1334 05198000
         AL    @04,ERRCODE(,@06)                                   1334 05199000
         STH   @04,PCTPMN(,PCTPTR)                                 1334 05200000
*         CVPSAV = CVPSTRU;             /* SAVE THE CURRENT ARG.     */ 05201000
         L     @06,CVPSAVP                                         1335 05202000
         MVC   CVPSAV(162,@06),CVPSTRU                             1335 05203000
*         PCTLLM = ON;                  /* SET MESSAGE FLAG.         */ 05204000
         OI    PCTLLM(PCTPTR),B'00010000'                          1336 05205000
*         PRTSPF = 2;                   /* SET SPACING FACTOR.       */ 05206000
         MVC   PRTSPF(2),@CH00111                                  1337 05207000
*         PRTSPT = 'R ';                /* SET SPACING TYPE.         */ 05208000
         MVI   PRTSPT,C'R'                                         1338 05209000
*         PRTBUFF = ' ';                /* CLEAR THE BUFFER.         */ 05210000
         MVI   PRTBUFF+1,C' '                                      1339 05211000
         MVC   PRTBUFF+2(131),PRTBUFF+1                            1339 05212000
         MVI   PRTBUFF,C' '                                        1339 05213000
*         PRTBUFF(1:MSGLEN) = MSGTXT(1:MSGLEN);                    1340 05214000
         L     @06,MSGAREA                                         1340 05215000
         LH    @04,MSGLEN(,@06)                                    1340 05216000
         BCTR  @04,0                                               1340 05217000
         EX    @04,@SM00938                                        1340 05218000
*                                       /* MOVE MESSAGE TO BUFFER.   */ 05219000
*                                                                  1341 05220000
*         CALL LINEPRT;                                            1341 05221000
*                                                                  1341 05222000
         BAL   @14,LINEPRT                                         1341 05223000
*         RESPECIFY RTNREG RSTD;                                   1342 05224000
*         TESTRC = RTNREG;                                         1343 05225000
         STH   RTNREG,TESTRC                                       1343 05226000
*         RESPECIFY RTNREG UNRSTD;                                 1344 05227000
*         CVPSTRU = CVPSAV;             /* RESTORE CURRENT ARGUMENT  */ 05228000
*                                                                  1345 05229000
         L     @06,CVPSAVP                                         1345 05230000
         MVC   CVPSTRU(162),CVPSAV(@06)                            1345 05231000
*         CALL ICKSAFS0 (GDTTBL,CVPSAVP);/*                        1346 05232000
*                                          FREE PRINT ARGUMENT SPACE */ 05233000
*                                                                  1346 05234000
         ST    GDTPR,@AL00001                                      1346 05235000
         LA    @06,CVPSAVP                                         1346 05236000
         ST    @06,@AL00001+4                                      1346 05237000
         L     @15,GDTFSP(,GDTPR)                                  1346 05238000
         LA    @01,@AL00001                                        1346 05239000
         BALR  @14,@15                                             1346 05240000
*         CALL ICKSAFS0 (GDTTBL,MSGAREA);/*                        1347 05241000
*                                          FREE STATIC TEXT SPACE.   */ 05242000
*                                                                  1347 05243000
         ST    GDTPR,@AL00001                                      1347 05244000
         LA    @06,MSGAREA                                         1347 05245000
         ST    @06,@AL00001+4                                      1347 05246000
         L     @15,GDTFSP(,GDTPR)                                  1347 05247000
         LA    @01,@AL00001                                        1347 05248000
         BALR  @14,@15                                             1347 05249000
*         RETURN CODE (TESTRC);                                    1348 05250000
         LH    @15,TESTRC                                          1348 05251000
         L     @14,@SA00016                                        1348 05252000
         LM    @00,@06,@SA00016+8                                  1348 05253000
         LM    @08,@12,@SA00016+36                                 1348 05254000
         BR    @14                                                 1348 05255000
*         END ERROR;                                               1349 05256000
@PB00016 DS    0H                                                  1350 05257000
*         /***********************************************************/ 05258000
*         /*                                                         */ 05259000
*         /* END OF THE FORMAT PROCEDURE.                            */ 05260000
*         /*                                                         */ 05261000
*         /***********************************************************/ 05262000
*                                                                  1350 05263000
*                                                                  1350 05264000
*         GENERATE DATA;                                           1350 05265000
*                                                                  1350 05266000
*         END ICKTP01                                              1351 05267000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 05268000
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        * 05269000
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        * 05270000
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        * 05271000
*/*%INCLUDE SYSLIB  (DMSDF07 )                                        * 05272000
*;                                                                 1351 05273000
@EL00001 L     @13,4(,@13)                                         1351 05274000
@EF00001 L     @00,@SIZDATD                                        1351 05275000
         LR    @01,@08                                             1351 05276000
         FREEMAIN R,LV=(0),A=(1)                                        05277000
@ER00001 LM    @14,@12,12(@13)                                     1351 05278000
         BR    @14                                                 1351 05279000
@DATA    DS    0H                                                       05280000
@CH00865 DC    H'999'                                                   05281000
@CH00786 DC    H'-1'                                                    05282000
@SM00915 MVC   HDSEG3(0,@04),TRBUF(@01)                                 05283000
@SM00917 MVC   CVPB(0,CVSTA),TRBUF(@14)                                 05284000
@SM00919 MVC   ALIGNBUF(0),TRBUF(@04)                                   05285000
@SM00921 MVC   CVPB(0,@04),ALIGNBUF                                     05286000
@SM00923 MVC   CVPB(0,CVSTA),ALIGNBUF                                   05287000
@SM00929 MVC   0(0,@04),TRBUF(@01)                                      05288000
@SM00931 MVC   RETAREA(0,@03),PRTBUFF                                   05289000
@SM00934 MVC   HEADLI(0,@06),PRLINE                                     05290000
@SM00936 MVC   STACKDL(0,@06),PUTLINE(@03)                              05291000
@SM00938 MVC   PRTBUFF(0),MSGTXT(@06)                                   05292000
         DS    0F                                                       05293000
@AL00356 DC    A(@CF00114)             LIST WITH   1 ARGUMENT(S)        05294000
@AL00378 EQU   *                       LIST WITH   1 ARGUMENT(S)        05295000
@AL00429 EQU   *                       LIST WITH   1 ARGUMENT(S)        05296000
@AL00473 DC    A(@CF00160)             LIST WITH   1 ARGUMENT(S)        05297000
@AL00397 EQU   *                       LIST WITH   2 ARGUMENT(S)        05298000
@AL00492 EQU   *                       LIST WITH   2 ARGUMENT(S)        05299000
@AL00505 EQU   *                       LIST WITH   2 ARGUMENT(S)        05300000
@AL00526 DC    A(MODID)                LIST WITH   2 ARGUMENT(S)        05301000
         DC    AL1(X'80')                                               05302000
         DC    AL3(RCQUIT)                                              05303000
@AL00430 EQU   *                       LIST WITH   2 ARGUMENT(S)        05304000
@AL00474 DC    A(MODID)                LIST WITH   2 ARGUMENT(S)        05305000
         DC    AL1(X'80')                                               05306000
         DC    AL3(RCERR)                                               05307000
@AL00441 DC    A(@CF00111)             LIST WITH   1 ARGUMENT(S)        05308000
@AL00451 EQU   *                       LIST WITH   1 ARGUMENT(S)        05309000
@AL00461 DC    A(@CF00131)             LIST WITH   1 ARGUMENT(S)        05310000
@AL00508 DC    A(@CF00180)             LIST WITH   1 ARGUMENT(S)        05311000
@AL00589 DC    A(@CF00036)             LIST WITH   1 ARGUMENT(S)        05312000
@DATD    DSECT                                                          05313000
         DS    0F                                                       05314000
@SA00001 DS    18F                                                      05315000
@PC00001 DS    14F                                                      05316000
@SA00016 DS    14F                                                      05317000
@PC00016 DS    1F                                                       05318000
@SA00002 DS    14F                                                      05319000
@SA00003 DS    14F                                                      05320000
@SA00014 DS    14F                                                      05321000
@SA00007 DS    14F                                                      05322000
@SA00008 DS    12F                                                      05323000
@SA00009 DS    14F                                                      05324000
@SA00012 DS    14F                                                      05325000
@SA00010 DS    14F                                                      05326000
@SA00015 DS    14F                                                      05327000
@PC00015 DS    1F                                                       05328000
@AL00001 DS    11A                                                      05329000
@TF00001 DS    F                                                        05330000
ICKTP01  CSECT                                                          05331000
         DS    0F                                                       05332000
@CF00160 DC    F'1'                                                     05333000
@CH00160 EQU   @CF00160+2                                               05334000
@CF00111 DC    F'2'                                                     05335000
@CH00111 EQU   @CF00111+2                                               05336000
@CF00131 DC    F'3'                                                     05337000
@CF00036 DC    F'4'                                                     05338000
@CF00114 DC    F'6'                                                     05339000
@CH00114 EQU   @CF00114+2                                               05340000
@CF00180 DC    F'7'                                                     05341000
@CF00156 DC    F'8'                                                     05342000
@CH00156 EQU   @CF00156+2                                               05343000
@CF00254 DC    F'9'                                                     05344000
@CF00032 DC    F'10'                                                    05345000
@CF00033 DC    F'11'                                                    05346000
@CF00034 DC    F'12'                                                    05347000
@CH00034 EQU   @CF00034+2                                               05348000
@CF00259 DC    F'13'                                                    05349000
@CF00264 DC    F'16'                                                    05350000
@CF00288 DC    F'28'                                                    05351000
@CF00888 DC    F'162'                                                   05352000
@CF00779 DC    F'255'                                                   05353000
@CF00831 DC    XL4'0F'                                                  05354000
@CF00463 DC    BL4'1'                                                   05355000
@DATD    DSECT                                                          05356000
         DS    0D                                                       05357000
LISTSCAN DS    A                                                        05358000
IOCSPTR  DS    A                                                        05359000
OPNPTR   DS    A                                                        05360000
DMPINDEX DS    A                                                        05361000
QENTP    DS    A                                                        05362000
FMRIP    DS    A                                                        05363000
HEADPTR  DS    A                                                        05364000
MSGAREA  DS    A                                                        05365000
TEMP1    DS    F                                                        05366000
FFMSTRS  DS    A                                                        05367000
FFMREDOS DS    A                                                        05368000
FFMBDP   DS    A                                                        05369000
FMRIL    DS    F                                                        05370000
BINACC   DS    F                                                        05371000
LINCT    DS    F                                                        05372000
TEMP2    DS    F                                                        05373000
DARGILP1 DS    FL4                                                      05374000
         ORG   DARGILP1                                                 05375000
@NM00027 DS    FL2                                                      05376000
DARGILP2 DS    FL2                                                      05377000
         ORG   DARGILP1+4                                               05378000
DARGFULL DS    F                                                        05379000
FMTAR    DS    F                                                        05380000
CVPSAVP  DS    A                                                        05381000
LISTPTR  DS    A                                                        05382000
TESTRC   DS    H                                                        05383000
SAVERC   DS    H                                                        05384000
STRSTP   DS    H                                                        05385000
FFMRBOFF DS    H                                                        05386000
FFMREDOL DS    H                                                        05387000
FFMREDOO DS    H                                                        05388000
FFMREDOC DS    H                                                        05389000
REDOCSAV DS    H                                                        05390000
FMSIL    DS    H                                                        05391000
DECT     DS    H                                                        05392000
BINHALF  DS    H                                                        05393000
PUPOCT   DS    H                                                        05394000
PLLEN    DS    H                                                        05395000
PRSPF    DS    H                                                        05396000
LISTLN   DS    FL1                                                      05397000
@TS00001 DS    CL95                                                     05398000
CVPSTRU  DS    CL162                                                    05399000
         ORG   CVPSTRU                                                  05400000
CVPIADD  DS    AL4                                                      05401000
CVPPADD  DS    AL4                                                      05402000
CVPIL    DS    FL4                                                      05403000
CVPOL    DS    FL4                                                      05404000
CVPTYF   DS    BL2                                                      05405000
         ORG   CVPTYF                                                   05406000
CVPBH    DS    BL1                                                      05407000
CVPBHA   EQU   CVPTYF+0                                                 05408000
CVPBHD   EQU   CVPTYF+0                                                 05409000
CVPBD    EQU   CVPTYF+0                                                 05410000
CVPPU    EQU   CVPTYF+0                                                 05411000
@NM00019 EQU   CVPTYF+0                                                 05412000
CVPZS    DS    BL1                                                      05413000
CVPAL    EQU   CVPTYF+1                                                 05414000
CVPSS    EQU   CVPTYF+1                                                 05415000
CVPBS    EQU   CVPTYF+1                                                 05416000
CVPAR    EQU   CVPTYF+1                                                 05417000
@NM00020 EQU   CVPTYF+1                                                 05418000
         ORG   CVPSTRU+18                                               05419000
CVPRETC  DS    FL2                                                      05420000
CVPRETP  DS    AL4                                                      05421000
PRTSPF   DS    FL2                                                      05422000
PRTSPT   DS    CL1                                                      05423000
PRTBUFF  DS    CL133                                                    05424000
PRTBFOVF DS    CL2                                                      05425000
         ORG   CVPSTRU+162                                              05426000
ALIGNBUF DS    CL120                                                    05427000
         DS    CL6                                                      05428000
UNPKWD   DS    CL8                                                      05429000
HDINDEXC DS    CL2                                                      05430000
HDCVB    DS    CL64                                                     05431000
CVFLAG   DS    BL2                                                      05432000
         ORG   CVFLAG                                                   05433000
PLOVF    DS    BL1                                                      05434000
PUPPSF   EQU   CVFLAG+0                                                 05435000
PUPIOF   EQU   CVFLAG+0                                                 05436000
SIGNPOS  EQU   CVFLAG+0                                                 05437000
HIORDRF  EQU   CVFLAG+0                                                 05438000
         ORG   CVFLAG+2                                                 05439000
SIGN     DS    CL1                                                      05440000
MSGNO    DS    CL3                                                      05441000
MTPN     DS    CL4                                                      05442000
PRBUFF   DS    CL121                                                    05443000
         ORG   PRBUFF                                                   05444000
PRCC     DS    CL1                                                      05445000
PRLINE   DS    CL120                                                    05446000
         ORG   PRBUFF+121                                               05447000
STID     DS    CL4                                                      05448000
         ORG   STID                                                     05449000
STIDMOD  DS    CL3                                                      05450000
STIDENT  DS    AL1                                                      05451000
         ORG   STID+4                                                   05452000
FFMFLAG  DS    BL2                                                      05453000
         ORG   FFMFLAG                                                  05454000
FFMREDOF DS    BL1                                                      05455000
FFMEOS   EQU   FFMFLAG+0                                                05456000
FFMEOS1  EQU   FFMFLAG+0                                                05457000
FFMPASS  EQU   FFMFLAG+0                                                05458000
FFMIDINH EQU   FFMFLAG+0                                                05459000
FFMNOFM  EQU   FFMFLAG+0                                                05460000
FFMDATA  EQU   FFMFLAG+0                                                05461000
FFMFMTF  EQU   FFMFLAG+0                                                05462000
FFMPINH  DS    BL1                                                      05463000
FFMVS    EQU   FFMFLAG+1                                                05464000
FFMPSFF  EQU   FFMFLAG+1                                                05465000
FFMPMSF  EQU   FFMFLAG+1                                                05466000
@NM00026 EQU   FFMFLAG+1                                                05467000
         ORG   FFMFLAG+2                                                05468000
ICKTP01  CSECT                                                          05469000
         DS    0F                                                       05470000
@SIZDATD DC    AL1(0)                                                   05471000
         DC    AL3(@ENDDATD-@DATD)                                      05472000
         DS    0D                                                       05473000
GPOOL    DC    F'0'                                                     05474000
NULLPMN  DC    H'0'                                                     05475000
STDLWPS  DC    H'121'                                                   05476000
RCQUIT   DC    H'12'                                                    05477000
RCERR    DC    H'4'                                                     05478000
PRBUFL   DC    H'2048'                                                  05479000
@CC00784 DC    C'ICKTP05 '                                              05480000
@CC00140 DC    C'ZERO'                                                  05481000
@CC00783 DC    C'TPSI'                                                  05482000
@CC00798 DC    C'TPCC'                                                  05483000
@CC00800 DC    C'TP1N'                                                  05484000
@CC00819 DC    C'TP2I'                                                  05485000
@CC00826 DC    C'TP2N'                                                  05486000
@CC00836 DC    C'TP2M'                                                  05487000
@CC00846 DC    C'TP2D'                                                  05488000
@CC00847 DC    C'TP2O'                                                  05489000
@CC00848 DC    C'TP2V'                                                  05490000
@CC00850 DC    C'TP2U'                                                  05491000
@CC00859 DC    C'TPDR'                                                  05492000
@CC00863 DC    C'TP3I'                                                  05493000
@CC00871 DC    C'TP3N'                                                  05494000
@CC00885 DC    C'TPER'                                                  05495000
@CC00830 DC    C'X'''                                                   05496000
@CB00710 DC    X'000001073741824C'                                      05497000
@CB00820 EQU   @CB00710                                                 05498000
MODID    DC    CL4'TP01'                                                05499000
FIXAREA  DC    X'00'                                                    05500000
         DC    XL255'0'                                                 05501000
SBPOOL   DC    CL4'TP01'                                                05502000
BHTRTB   DC    CL16'0123456789ABCDEF'                                   05503000
PRCCON   DC    CL4'+ 0-'                                                05504000
PRECON   DC    CL1'1'                                                   05505000
HDPOOL   DC    CL4'TP03'                                                05506000
STMODID  DC    CL3'TP1'                                                 05507000
TP04ENT  DC    CL8'ICKTP04'                                             05508000
ESTSARG  DC    CL3'STS'                                                 05509000
ESTAARG  DC    CL3'STA'                                                 05510000
RESTARG  DC    CL3'RES'                                                 05511000
RSETARG  DC    CL3'RST'                                                 05512000
@DATD    DSECT                                                          05513000
ICKTP01  CSECT                                                          05514000
         ENTRY ICKTPS1                                                  05515000
ICKTPS1  DC A(@SIZDATD)                                                 05516000
@DATD    DSECT                                                          05517000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                05518000
@ENDDATD EQU   *                                                        05519000
ICKTP01  CSECT                                                          05520000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05521000
@01      EQU   01                                                       05522000
@02      EQU   02                                                       05523000
@03      EQU   03                                                       05524000
@04      EQU   04                                                       05525000
@05      EQU   05                                                       05526000
@06      EQU   06                                                       05527000
@07      EQU   07                                                       05528000
@08      EQU   08                                                       05529000
@09      EQU   09                                                       05530000
@10      EQU   10                                                       05531000
@11      EQU   11                                                       05532000
@12      EQU   12                                                       05533000
@13      EQU   13                                                       05534000
@14      EQU   14                                                       05535000
@15      EQU   15                                                       05536000
NLISAV   EQU   @06                                                      05537000
PRFTSP   EQU   @04                                                      05538000
SPFSAV   EQU   @03                                                      05539000
J        EQU   @03                                                      05540000
N        EQU   @07                                                      05541000
SIGNT    EQU   @07                                                      05542000
PUPPSC   EQU   @04                                                      05543000
CVSL     EQU   @06                                                      05544000
TTLPT    EQU   @06                                                      05545000
CVSTA    EQU   @03                                                      05546000
PCTPTR   EQU   @05                                                      05547000
FSADDR   EQU   @03                                                      05548000
DDSTRU   EQU   @06                                                      05549000
SETRC    EQU   @04                                                      05550000
RTNREG   EQU   @15                                                      05551000
REG13    EQU   @13                                                      05552000
REG14    EQU   @14                                                      05553000
REG15    EQU   @15                                                      05554000
CVDREG   EQU   @02                                                      05555000
GDTPR    EQU   @09                                                      05556000
REG0     EQU   @00                                                      05557000
REG1     EQU   @01                                                      05558000
REG10    EQU   @10                                                      05559000
REG11    EQU   @11                                                      05560000
REG12    EQU   @12                                                      05561000
REG2     EQU   @02                                                      05562000
REG3     EQU   @03                                                      05563000
REG4     EQU   @04                                                      05564000
REG5     EQU   @05                                                      05565000
REG6     EQU   @06                                                      05566000
REG7     EQU   @07                                                      05567000
REG8     EQU   @08                                                      05568000
REG9     EQU   @09                                                      05569000
GDTTBL   EQU   0                                                        05570000
GDTTR1   EQU   GDTTBL+8                                                 05571000
GDTTR2   EQU   GDTTBL+12                                                05572000
GDTTPH   EQU   GDTTBL+28                                                05573000
GDTDIN   EQU   GDTTBL+44                                                05574000
GDTDOP   EQU   GDTTBL+48                                                05575000
GDTDBG   EQU   GDTTBL+52                                                05576000
GDTDVO   EQU   GDTTBL+56                                                05577000
GDTPRT   EQU   GDTTBL+60                                                05578000
GDTESS   EQU   GDTTBL+64                                                05579000
GDTESA   EQU   GDTTBL+68                                                05580000
GDTRST   EQU   GDTTBL+72                                                05581000
GDTRES   EQU   GDTTBL+76                                                05582000
GDTCAL   EQU   GDTTBL+80                                                05583000
GDTGSP   EQU   GDTTBL+84                                                05584000
GDTFSP   EQU   GDTTBL+88                                                05585000
GDTGPL   EQU   GDTTBL+92                                                05586000
GDTFPL   EQU   GDTTBL+96                                                05587000
GDTLOD   EQU   GDTTBL+100                                               05588000
GDTDEL   EQU   GDTTBL+104                                               05589000
GDTPRL   EQU   GDTTBL+108                                               05590000
GDTEPL   EQU   GDTTBL+112                                               05591000
GDTTIM   EQU   GDTTBL+116                                               05592000
GDTIIO   EQU   GDTTBL+120                                               05593000
GDTTIO   EQU   GDTTBL+124                                               05594000
GDTOPN   EQU   GDTTBL+136                                               05595000
GDTCLS   EQU   GDTTBL+140                                               05596000
GDTGET   EQU   GDTTBL+144                                               05597000
GDTPUT   EQU   GDTTBL+148                                               05598000
GDTABT   EQU   GDTTBL+152                                               05599000
GDTABH   EQU   GDTTBL+156                                               05600000
GDTSNP   EQU   GDTTBL+160                                               05601000
GDTWTO   EQU   GDTTBL+168                                               05602000
GDTSCR   EQU   GDTTBL+172                                               05603000
GDTVCK   EQU   GDTTBL+176                                               05604000
GDTDVC   EQU   GDTTBL+180                                               05605000
GDTSTE   EQU   GDTTBL+188                                               05606000
ICKSACL0 EQU   0                                                        05607000
ICKSAEP0 EQU   0                                                        05608000
ICKSAGS0 EQU   0                                                        05609000
ICKSAFS0 EQU   0                                                        05610000
ICKSAGP0 EQU   0                                                        05611000
ICKSAFP0 EQU   0                                                        05612000
TRACE1   EQU   0                                                        05613000
OLDERID1 EQU   TRACE1                                                   05614000
TRACE2   EQU   0                                                        05615000
OLDERID2 EQU   TRACE2                                                   05616000
NEWID2   EQU   TRACE2+95                                                05617000
NEWERID2 EQU   5                                                        05618000
STAEPARM EQU   0                                                        05619000
STAEPFX  EQU   STAEPARM                                                 05620000
LISTTEST EQU   0                                                        05621000
ICKIOPT0 EQU   0                                                        05622000
IOCSTR   EQU   0                                                        05623000
IOCDAD   EQU   IOCSTR                                                   05624000
IOCDLN   EQU   IOCSTR+4                                                 05625000
IOCDSO   EQU   IOCSTR+13                                                05626000
IOCRFM   EQU   IOCSTR+14                                                05627000
IOCMAC   EQU   IOCSTR+15                                                05628000
IOCMSG   EQU   IOCSTR+16                                                05629000
IOCPNM   EQU   IOCSTR+28                                                05630000
OPNAGL   EQU   0                                                        05631000
OPNOPT   EQU   OPNAGL                                                   05632000
OPNRFM   EQU   OPNAGL+1                                                 05633000
OPNTYP   EQU   OPNAGL+2                                                 05634000
OPNMOD   EQU   OPNAGL+3                                                 05635000
UVOLLIST EQU   0                                                        05636000
UVOLENT  EQU   UVOLLIST+2                                               05637000
DARGLIST EQU   0                                                        05638000
DARGDBP  EQU   DARGLIST                                                 05639000
DARGRETP EQU   DARGLIST+4                                               05640000
DARGSTID EQU   DARGLIST+8                                               05641000
DARGILP  EQU   DARGLIST+12                                              05642000
DARGCNT  EQU   DARGLIST+14                                              05643000
DARGRETL EQU   DARGLIST+16                                              05644000
DARGIND  EQU   DARGLIST+18                                              05645000
DARGARY  EQU   DARGLIST+20                                              05646000
DARGINS  EQU   DARGARY                                                  05647000
DARGREP  EQU   DARGINS                                                  05648000
DARGINL  EQU   DARGARY+2                                                05649000
DARGPCT  EQU   DARGINL                                                  05650000
DARGDTM  EQU   DARGARY+4                                                05651000
FMTLIST  EQU   0                                                        05652000
FMTFLGS  EQU   FMTLIST                                                  05653000
FMTEOLF  EQU   FMTFLGS                                                  05654000
FMTSCF   EQU   FMTFLGS                                                  05655000
FMTIDF   EQU   FMTFLGS                                                  05656000
FMTBDF   EQU   FMTFLGS                                                  05657000
FMTREPF  EQU   FMTFLGS                                                  05658000
FMTSTF   EQU   FMTFLGS                                                  05659000
FMTDFF   EQU   FMTFLGS                                                  05660000
FMTSPF   EQU   FMTLIST+2                                                05661000
FMTRFNO  EQU   FMTSPF                                                   05662000
FMTILEN  EQU   FMTRFNO                                                  05663000
FMTSTL   EQU   FMTILEN                                                  05664000
FMTIOFF  EQU   FMTLIST+4                                                05665000
FMTTRBC  EQU   FMTIOFF                                                  05666000
FMTSTO   EQU   FMTTRBC                                                  05667000
FMTSPT   EQU   FMTSTO                                                   05668000
FMTOCOL  EQU   FMTLIST+6                                                05669000
FMTRIO   EQU   FMTOCOL                                                  05670000
FMTOLEN  EQU   FMTLIST+8                                                05671000
FMTCNVF  EQU   FMTLIST+10                                               05672000
FMTBS    EQU   FMTCNVF+1                                                05673000
ICKDB010 EQU   0                                                        05674000
DMPITM   EQU   0                                                        05675000
DMPARY   EQU   0                                                        05676000
PCTTAB   EQU   0                                                        05677000
PCTFLG   EQU   PCTTAB+4                                                 05678000
PCTH1F   EQU   PCTFLG                                                   05679000
PCTH2F   EQU   PCTFLG                                                   05680000
PCTHAF   EQU   PCTFLG                                                   05681000
PCTLLM   EQU   PCTFLG                                                   05682000
PCTAPF   EQU   PCTFLG                                                   05683000
PCTSPP   EQU   PCTTAB+8                                                 05684000
PCTACT   EQU   PCTTAB+12                                                05685000
PCTIOC   EQU   PCTACT                                                   05686000
PCTAPL   EQU   PCTACT+4                                                 05687000
PCTCPN   EQU   PCTAPL                                                   05688000
PCTNLI   EQU   PCTAPL+2                                                 05689000
PCTSTD   EQU   PCTTAB+20                                                05690000
PCTSPL   EQU   PCTSTD+4                                                 05691000
PCTALT   EQU   PCTTAB+28                                                05692000
PCTIOP   EQU   PCTALT                                                   05693000
PCTLPL   EQU   PCTALT+4                                                 05694000
PCTSQP   EQU   PCTTAB+48                                                05695000
PCTAHP   EQU   PCTTAB+52                                                05696000
PCTMLP   EQU   PCTTAB+56                                                05697000
PCTSLP   EQU   PCTTAB+60                                                05698000
PCTTRP   EQU   PCTTAB+64                                                05699000
PCTPLW   EQU   PCTTAB+68                                                05700000
PCTSLC   EQU   PCTTAB+74                                                05701000
PCTFLP   EQU   PCTTAB+76                                                05702000
PCTFLC   EQU   PCTTAB+80                                                05703000
PCTHLC   EQU   PCTTAB+82                                                05704000
PCTHSC   EQU   PCTTAB+83                                                05705000
PCTPNL   EQU   PCTTAB+84                                                05706000
PCTPMN   EQU   PCTTAB+86                                                05707000
PCTAPC   EQU   PCTTAB+88                                                05708000
PCTDSC   EQU   PCTTAB+92                                                05709000
PCTPNI   EQU   PCTTAB+94                                                05710000
PCTFDL   EQU   PCTTAB+96                                                05711000
PCTLDL   EQU   PCTTAB+98                                                05712000
PCTFLN   EQU   PCTTAB+100                                               05713000
PCTLNM   EQU   PCTTAB+102                                               05714000
PCTBUF   EQU   PCTTAB+104                                               05715000
PCTBNL   EQU   PCTTAB+108                                               05716000
RETAREA  EQU   0                                                        05717000
QENTRY   EQU   0                                                        05718000
QSTID    EQU   QENTRY                                                   05719000
QCHAIN   EQU   QENTRY+4                                                 05720000
QFLAGS   EQU   QENTRY+8                                                 05721000
QMSGF    EQU   QFLAGS                                                   05722000
QHEADF   EQU   QFLAGS                                                   05723000
QSECMF   EQU   QFLAGS                                                   05724000
QHLC     EQU   QENTRY+10                                                05725000
QHSC     EQU   QENTRY+11                                                05726000
QTEXT    EQU   QENTRY+12                                                05727000
CVPB     EQU   0                                                        05728000
TRBUF    EQU   0                                                        05729000
HDPRLI   EQU   0                                                        05730000
HDINDEX  EQU   HDPRLI                                                   05731000
HDSEG1   EQU   HDPRLI+6                                                 05732000
HDSEG2   EQU   HDPRLI+44                                                05733000
HDST1    EQU   HDPRLI+82                                                05734000
HDSEG3   EQU   HDPRLI+83                                                05735000
HDST2    EQU   HDPRLI+115                                               05736000
FTLI     EQU   0                                                        05737000
FLCC     EQU   FTLI                                                     05738000
MTLINE   EQU   0                                                        05739000
STLINE   EQU   0                                                        05740000
HEADQUE  EQU   0                                                        05741000
HEADQP   EQU   HEADQUE                                                  05742000
HEADCC   EQU   HEADQUE+4                                                05743000
HEADLI   EQU   HEADQUE+5                                                05744000
MESSAGE  EQU   0                                                        05745000
MSGLEN   EQU   MESSAGE+2                                                05746000
MSGTXT   EQU   MESSAGE+12                                               05747000
STACKMAP EQU   0                                                        05748000
STACKLL  EQU   STACKMAP                                                 05749000
STACKDL  EQU   STACKMAP+2                                               05750000
CVPSAV   EQU   0                                                        05751000
DMPTRM   EQU   0                                                        05752000
ICKDVCL0 EQU   0                                                        05753000
ICKDVIN0 EQU   0                                                        05754000
ICKDVON0 EQU   0                                                        05755000
ICKDVOP0 EQU   0                                                        05756000
ICKIOCL0 EQU   0                                                        05757000
ICKIOGT0 EQU   0                                                        05758000
ICKIOIT0 EQU   0                                                        05759000
ICKIOOP0 EQU   0                                                        05760000
ICKIOTM0 EQU   0                                                        05761000
ICKSADE0 EQU   0                                                        05762000
ICKSALD0 EQU   0                                                        05763000
ICKSAPR0 EQU   0                                                        05764000
ICKSASC0 EQU   0                                                        05765000
ICKSASN0 EQU   0                                                        05766000
ICKSAST0 EQU   0                                                        05767000
ICKSATI0 EQU   0                                                        05768000
ICKSAVC0 EQU   0                                                        05769000
ICKSAWO0 EQU   0                                                        05770000
ICKTPEA0 EQU   0                                                        05771000
ICKTPES0 EQU   0                                                        05772000
ICKTPPR0 EQU   0                                                        05773000
ICKTPRE0 EQU   0                                                        05774000
ICKTPRS0 EQU   0                                                        05775000
NEWERID1 EQU   5                                                        05776000
PCTTRT   EQU   0                                                        05777000
GDTTBLX  EQU   0                                                        05778000
FILENAME EQU   0                                                        05779000
STIDS    EQU   0                                                        05780000
PCALIST  EQU   0                                                        05781000
PTR1     EQU   0                                                        05782000
PTR2     EQU   0                                                        05783000
PTR3     EQU   0                                                        05784000
PTR4     EQU   0                                                        05785000
PTR5     EQU   0                                                        05786000
PTR6     EQU   0                                                        05787000
PTR7     EQU   0                                                        05788000
PGNOPTR  EQU   0                                                        05789000
DDPTR    EQU   0                                                        05790000
FMPTR    EQU   0                                                        05791000
PUTLINE  EQU   0                                                        05792000
ERRCODE  EQU   0                                                        05793000
STLCC    EQU   STLINE                                                   05794000
CONVL    EQU   TEMP1                                                    05795000
DSINDX   EQU   TEMP1                                                    05796000
RETLN    EQU   TEMP1                                                    05797000
BDLEN    EQU   TEMP1                                                    05798000
HDINDEXB EQU   HDINDEXC                                                 05799000
BINHALFC EQU   BINHALF                                                  05800000
BINACCC  EQU   BINACC                                                   05801000
CURLI    EQU   TEMP2                                                    05802000
HDQPTR   EQU   TEMP2                                                    05803000
MTLCC    EQU   MTLINE                                                   05804000
TRBUFB   EQU   TRBUF                                                    05805000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05806000
@NM00025 EQU   MESSAGE+10                                               05807000
@NM00024 EQU   MESSAGE+8                                                05808000
@NM00023 EQU   MESSAGE+6                                                05809000
MSGOFF   EQU   MESSAGE+4                                                05810000
@NM00022 EQU   MESSAGE                                                  05811000
FL1      EQU   FTLI+1                                                   05812000
HDSP3    EQU   HDPRLI+80                                                05813000
HDSP2    EQU   HDPRLI+42                                                05814000
HDSP1    EQU   HDPRLI+4                                                 05815000
@NM00021 EQU   QFLAGS                                                   05816000
PCTPPD   EQU   PCTTAB+90                                                05817000
PCTMLC   EQU   PCTTAB+72                                                05818000
PCTSME   EQU   PCTTAB+44                                                05819000
PCTSTM   EQU   PCTTAB+36                                                05820000
PCTANL   EQU   PCTLPL+2                                                 05821000
PCTAPN   EQU   PCTLPL                                                   05822000
PCTSNL   EQU   PCTSPL+2                                                 05823000
PCTSPN   EQU   PCTSPL                                                   05824000
PCTIOS   EQU   PCTSTD                                                   05825000
@NM00018 EQU   PCTFLG                                                   05826000
PCTIDN   EQU   PCTTAB                                                   05827000
@NM00017 EQU   DMPARY+15                                                05828000
DMPARYTP EQU   DMPARY+14                                                05829000
DMPARYEX EQU   DMPARY+12                                                05830000
DMPARYIC EQU   DMPARY+10                                                05831000
DMPARYSZ EQU   DMPARY+8                                                 05832000
DMPARYNM EQU   DMPARY                                                   05833000
@NM00016 EQU   DMPITM+15                                                05834000
DMPITMTP EQU   DMPITM+14                                                05835000
DMPITMLN EQU   DMPITM+12                                                05836000
DMPITMPT EQU   DMPITM+8                                                 05837000
DMPITMNM EQU   DMPITM                                                   05838000
@NM00015 EQU   FMTCNVF+1                                                05839000
FMTSS    EQU   FMTCNVF+1                                                05840000
FMTAL    EQU   FMTCNVF+1                                                05841000
FMTZS    EQU   FMTCNVF+1                                                05842000
@NM00014 EQU   FMTCNVF                                                  05843000
FMTPU    EQU   FMTCNVF                                                  05844000
FMTBD    EQU   FMTCNVF                                                  05845000
FMTBHD   EQU   FMTCNVF                                                  05846000
FMTBHA   EQU   FMTCNVF                                                  05847000
FMTBH    EQU   FMTCNVF                                                  05848000
@NM00013 EQU   FMTFLGS+1                                                05849000
FMTHDF   EQU   FMTFLGS                                                  05850000
@NM00012 EQU   DARGLIST+19                                              05851000
DARGSENT EQU   DARGSTID+3                                               05852000
DARGSMOD EQU   DARGSTID                                                 05853000
UVOLVOL  EQU   UVOLENT+4                                                05854000
UVOLDEV  EQU   UVOLENT                                                  05855000
UVOLCNT  EQU   UVOLLIST                                                 05856000
OPNRSVD  EQU   OPNAGL+28                                                05857000
OPNVOL   EQU   OPNAGL+24                                                05858000
OPNBLK   EQU   OPNAGL+20                                                05859000
OPNREC   EQU   OPNAGL+16                                                05860000
OPNDSN   EQU   OPNAGL+12                                                05861000
OPNDDN   EQU   OPNAGL+8                                                 05862000
OPNIOC   EQU   OPNAGL+4                                                 05863000
@NM00011 EQU   OPNMOD                                                   05864000
OPNMODRC EQU   OPNMOD                                                   05865000
OPNMODAC EQU   OPNMOD                                                   05866000
@NM00010 EQU   OPNTYP                                                   05867000
OPNTYPSO EQU   OPNTYP                                                   05868000
OPNTYPSI EQU   OPNTYP                                                   05869000
@NM00009 EQU   OPNRFM                                                   05870000
OPNRFMBK EQU   OPNRFM                                                   05871000
OPNRFMSF EQU   OPNRFM                                                   05872000
OPNRFMUN EQU   OPNRFM                                                   05873000
OPNRFMVR EQU   OPNRFM                                                   05874000
OPNRFMFX EQU   OPNRFM                                                   05875000
@NM00008 EQU   OPNOPT                                                   05876000
OPNOPTJM EQU   OPNOPT                                                   05877000
OPNOPTKS EQU   OPNOPT                                                   05878000
OPNOPTBK EQU   OPNOPT                                                   05879000
OPNOPTUP EQU   OPNOPT                                                   05880000
OPNOPTOT EQU   OPNOPT                                                   05881000
OPNOPTIN EQU   OPNOPT                                                   05882000
IOCEXT   EQU   IOCSTR+36                                                05883000
IOCRRN   EQU   IOCSTR+32                                                05884000
@NM00007 EQU   IOCSTR+30                                                05885000
IOCCBP   EQU   IOCSTR+24                                                05886000
IOCDSN   EQU   IOCSTR+20                                                05887000
@NM00006 EQU   IOCSTR+17                                                05888000
@NM00005 EQU   IOCMSG                                                   05889000
IOCMSGOP EQU   IOCMSG                                                   05890000
IOCMACPA EQU   IOCMAC                                                   05891000
@NM00004 EQU   IOCMAC                                                   05892000
IOCMACBK EQU   IOCMAC                                                   05893000
IOCMACUP EQU   IOCMAC                                                   05894000
IOCMACOT EQU   IOCMAC                                                   05895000
IOCMACIN EQU   IOCMAC                                                   05896000
@NM00003 EQU   IOCRFM                                                   05897000
IOCRFMBK EQU   IOCRFM                                                   05898000
IOCRFMSF EQU   IOCRFM                                                   05899000
IOCRFMUN EQU   IOCRFM                                                   05900000
IOCRFMVR EQU   IOCRFM                                                   05901000
IOCRFMFX EQU   IOCRFM                                                   05902000
@NM00002 EQU   IOCDSO                                                   05903000
IOCDSOPS EQU   IOCDSO                                                   05904000
IOCKYL   EQU   IOCSTR+12                                                05905000
IOCTRN   EQU   IOCSTR+8                                                 05906000
STAEWORK EQU   STAEPARM+32                                              05907000
STARPTR  EQU   STAEPFX+28                                               05908000
STASPTR  EQU   STAEPFX+24                                               05909000
STALEN   EQU   STAEPFX+20                                               05910000
STAID    EQU   STAEPFX+16                                               05911000
STAEPA   EQU   STAEPFX+12                                               05912000
STAGDT   EQU   STAEPFX+8                                                05913000
STABPTR  EQU   STAEPFX+4                                                05914000
STAFPTR  EQU   STAEPFX                                                  05915000
NEWID1   EQU   TRACE1+95                                                05916000
CALLID   EQU   OLDERID1+90                                              05917000
@NM00001 EQU   OLDERID1                                                 05918000
GDTCVR   EQU   GDTTBL+184                                               05919000
GDTSPR   EQU   GDTTBL+164                                               05920000
GDTTOH   EQU   GDTTBL+132                                               05921000
GDTRIP   EQU   GDTTBL+128                                               05922000
GDTDVH   EQU   GDTTBL+40                                                05923000
GDTIOH   EQU   GDTTBL+36                                                05924000
GDTSAH   EQU   GDTTBL+32                                                05925000
GDTRIH   EQU   GDTTBL+24                                                05926000
GDTSTH   EQU   GDTTBL+20                                                05927000
GDTDBH   EQU   GDTTBL+16                                                05928000
GDTPRM   EQU   GDTTBL+4                                                 05929000
GDTHDR   EQU   GDTTBL                                                   05930000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05931000
@RF00396 EQU   @RC00389                                                 05932000
@RC00631 EQU   @RC00627                                                 05933000
@RC00637 EQU   @RC00627                                                 05934000
@RC01081 EQU   @RC01079                                                 05935000
@PB00015 EQU   @PB00016                                                 05936000
@RC00640 EQU   @RC00637                                                 05937000
@PB00014 EQU   @PB00015                                                 05938000
@PB00013 EQU   @PB00014                                                 05939000
@PB00007 EQU   @PB00013                                                 05940000
@PB00006 EQU   @PB00007                                                 05941000
@PB00005 EQU   @PB00006                                                 05942000
@PB00004 EQU   @PB00005                                                 05943000
@PB00003 EQU   @PB00004                                                 05944000
@PB00002 EQU   @PB00003                                                 05945000
@ENDDATA EQU   *                                                        05946000
         END   ICKTP01,(C'PLS1755',0701,78192)                          05947000
