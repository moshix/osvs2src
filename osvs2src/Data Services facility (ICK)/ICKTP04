         TITLE '**********  DMS PAGE CONTROL MODULE  **********        *00001000
                        '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
ICKTP04  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'ICKTP04   78.192'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @11,0                                               0002 00021000
@PSTART  LA    @12,4095(,@11)                                      0002 00022000
         USING @PSTART,@11                                         0002 00023000
         USING @PSTART+4095,@12                                    0002 00024000
         L     @00,@SIZDATD                                        0002 00025000
         GETMAIN  R,LV=(0)                                              00026000
         LR    @10,@01                                             0002 00027000
         USING @DATD,@10                                           0002 00028000
         ST    @13,@SA00001+4                                      0002 00029000
         LM    @00,@01,20(@13)                                     0002 00030000
         ST    @10,8(,@13)                                         0002 00031000
         LR    @13,@10                                             0002 00032000
         MVC   @PC00001(40),0(@01)                                 0002 00033000
        ST    1,LISTPTR                                                 00034000
        ST    1,LISTSCAN                                                00035000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0222 00036000
         LA    LISTLN,1                                            0222 00037000
@DL00222 L     @09,LISTSCAN                                        0222 00038000
         TM    LISTTEST(@09),B'10000000'                           0222 00039000
         BNZ   @DC00222                                            0222 00040000
*          LISTSCAN = LISTSCAN + 4;                                0223 00041000
         AL    @09,@CF00055                                        0223 00042000
         ST    @09,LISTSCAN                                        0223 00043000
*        END;                                                      0224 00044000
*                                                                  0224 00045000
         AL    LISTLN,@CF00178                                     0224 00046000
         C     LISTLN,@CF00640                                     0224 00047000
         BNH   @DL00222                                            0224 00048000
@DC00222 DS    0H                                                  0225 00049000
*         IF MACARG = ('STS')                                      0225 00050000
*           THEN                                                   0225 00051000
         L     @09,@PC00001+4                                      0225 00052000
         CLC   MACARG(3,@09),@CC00641                              0225 00053000
         BNE   @RF00225                                            0225 00054000
*             DO;                                                  0226 00055000
*               CALL ESTSCONT(ARG1);                               0227 00056000
         L     @09,@PC00001+12                                     0227 00057000
         ST    @09,@AL00001                                        0227 00058000
         LA    @01,@AL00001                                        0227 00059000
         BAL   @14,ESTSCONT                                        0227 00060000
*               RESPECIFY RTNREG RSTD;                             0228 00061000
*               TESTRC = RTNREG;                                   0229 00062000
         LR    TESTRC,RTNREG                                       0229 00063000
*               RESPECIFY RTNREG UNRSTD;                           0230 00064000
*               SETRC = TESTRC;                                    0231 00065000
         STH   TESTRC,SETRC                                        0231 00066000
*             END;                                                 0232 00067000
*         IF MACARG = ('STA')                                      0233 00068000
*           THEN                                                   0233 00069000
@RF00225 L     @09,@PC00001+4                                      0233 00070000
         CLC   MACARG(3,@09),@CC00643                              0233 00071000
         BNE   @RF00233                                            0233 00072000
*             DO;                                                  0234 00073000
*               CALL ESTACONT(ARG1);                               0235 00074000
         L     @09,@PC00001+12                                     0235 00075000
         ST    @09,@AL00001                                        0235 00076000
         LA    @01,@AL00001                                        0235 00077000
         BAL   @14,ESTACONT                                        0235 00078000
*               RESPECIFY RTNREG RSTD;                             0236 00079000
*               TESTRC = RTNREG;                                   0237 00080000
         LR    TESTRC,RTNREG                                       0237 00081000
*               RESPECIFY RTNREG UNRSTD;                           0238 00082000
*               SETRC = TESTRC;                                    0239 00083000
         STH   TESTRC,SETRC                                        0239 00084000
*             END;                                                 0240 00085000
*         IF MACARG = ('RES')                                      0241 00086000
*           THEN                                                   0241 00087000
@RF00233 L     @09,@PC00001+4                                      0241 00088000
         CLC   MACARG(3,@09),@CC00645                              0241 00089000
         BNE   @RF00241                                            0241 00090000
*             DO;                                                  0242 00091000
*               CALL RESTCONT;                                     0243 00092000
         BAL   @14,RESTCONT                                        0243 00093000
*               RESPECIFY RTNREG RSTD;                             0244 00094000
*               TESTRC = RTNREG;                                   0245 00095000
         LR    TESTRC,RTNREG                                       0245 00096000
*               RESPECIFY RTNREG UNRSTD;                           0246 00097000
*               SETRC = TESTRC;                                    0247 00098000
         STH   TESTRC,SETRC                                        0247 00099000
*             END;                                                 0248 00100000
*         IF MACARG = ('RST')                                      0249 00101000
*           THEN                                                   0249 00102000
@RF00241 L     @09,@PC00001+4                                      0249 00103000
         CLC   MACARG(3,@09),@CC00647                              0249 00104000
         BNE   @RF00249                                            0249 00105000
*             DO;                                                  0250 00106000
*               IF LISTLN = 5 & ARG1 ^= NULLPTR                    0251 00107000
*                 THEN                                             0251 00108000
         C     LISTLN,@CF00268                                     0251 00109000
         BNE   @RF00251                                            0251 00110000
         L     @09,@PC00001+12                                     0251 00111000
         L     @09,ARG1(,@09)                                      0251 00112000
         LTR   @09,@09                                             0251 00113000
         BZ    @RF00251                                            0251 00114000
*                   PGNOF = ON;                                    0252 00115000
         OI    PGNOF,B'01000000'                                   0252 00116000
*                 ELSE                                             0253 00117000
*                   PGNOF = OFF;                                   0253 00118000
         B     @RC00251                                            0253 00119000
@RF00251 NI    PGNOF,B'10111111'                                   0253 00120000
*               CALL RESETCON(ARG1);                               0254 00121000
@RC00251 L     @03,@PC00001+12                                     0254 00122000
         ST    @03,@AL00001                                        0254 00123000
         LA    @01,@AL00001                                        0254 00124000
         BAL   @14,RESETCON                                        0254 00125000
*               RESPECIFY RTNREG RSTD;                             0255 00126000
*               TESTRC = RTNREG;                                   0256 00127000
         LR    TESTRC,RTNREG                                       0256 00128000
*               RESPECIFY RTNREG UNRSTD;                           0257 00129000
*               SETRC = TESTRC;                                    0258 00130000
         STH   TESTRC,SETRC                                        0258 00131000
*             END;                                                 0259 00132000
*         CALL ICKSAEP0(GDTTBL,MODID,SETRC);                       0260 00133000
@RF00249 L     @03,@PC00001                                        0260 00134000
         ST    @03,@AL00001                                        0260 00135000
         LA    @15,MODID                                           0260 00136000
         ST    @15,@AL00001+4                                      0260 00137000
         LA    @15,SETRC                                           0260 00138000
         ST    @15,@AL00001+8                                      0260 00139000
         MVI   @AL00001+8,X'80'                                    0260 00140000
         L     @15,GDTEPL(,@03)                                    0260 00141000
         LA    @01,@AL00001                                        0260 00142000
         BALR  @14,@15                                             0260 00143000
*                                                                  0261 00144000
*         /***********************************************************/ 00145000
*         /*                                                         */ 00146000
*         /* PROCEDURE NAME - ESTS HANDLER                           */ 00147000
*         /*                                                         */ 00148000
*         /* FUNCTION - THIS PROCEDURE CONTROLS THE ESTABLISHMENT    */ 00149000
*         /* OF THE PRINT CONTROL TABLE THRU USE OF THE (UESTS)      */ 00150000
*         /* MACRO.  IT ALSO OPENS THE PRINT DATA SET.               */ 00151000
*         /*                                                         */ 00152000
*         /* INPUT - A STATIC TEXT IDENTIFIER (STID) IDENTIFYING     */ 00153000
*         /* THE NON-DEFAULT DATA TO BE SET IN THAT TABLE.           */ 00154000
*         /*                                                         */ 00155000
*         /* OUTPUT - A PRINT CONTROL TABLE.                         */ 00156000
*         /*                                                         */ 00157000
*         /***********************************************************/ 00158000
*                                                                  0261 00159000
*ESTSCONT: PROC (STIDS);                                           0261 00160000
*                                                                  0261 00161000
@EL00001 L     @13,4(,@13)                                         0261 00162000
@EF00001 L     @00,@SIZDATD                                        0261 00163000
         LR    @01,@10                                             0261 00164000
         FREEMAIN R,LV=(0),A=(1)                                        00165000
@ER00001 LM    @14,@12,12(@13)                                     0261 00166000
         BR    @14                                                 0261 00167000
ESTSCONT STM   @14,@12,@SA00002                                    0261 00168000
         MVC   @PC00002(4),0(@01)                                  0261 00169000
*         /***********************************************************/ 00170000
*         /*                                                         */ 00171000
*         /* GET THE CORE FOR THE PCT AND INITIALIZE IT.             */ 00172000
*         /*                                                         */ 00173000
*         /***********************************************************/ 00174000
*                                                                  0262 00175000
*         SAVERC = 0;                                              0262 00176000
         SLR   SAVERC,SAVERC                                       0262 00177000
*         PCTPTR = GDTTPH;                                         0263 00178000
         L     @06,@PC00001                                        0263 00179000
         L     @06,GDTTPH(,@06)                                    0263 00180000
         LR    PCTPTR,@06                                          0263 00181000
*         IF GDTTPH = NULLPTR                                      0264 00182000
*           THEN                                                   0264 00183000
         LTR   @06,@06                                             0264 00184000
         BNZ   @RF00264                                            0264 00185000
*             PRIPCT = ON;                                         0265 00186000
         OI    PRIPCT,B'10000000'                                  0265 00187000
*           ELSE                                                   0266 00188000
*             PRIPCT = OFF;                                        0266 00189000
         B     @RC00264                                            0266 00190000
@RF00264 NI    PRIPCT,B'01111111'                                  0266 00191000
*         OLDERID2 = NEWERID2;                                     0267 00192000
@RC00264 L     @06,@PC00001                                        0267 00193000
         L     @06,GDTTR2(,@06)                                    0267 00194000
         MVC   @TS00001(95),NEWERID2(@06)                          0267 00195000
         MVC   OLDERID2(95,@06),@TS00001                           0267 00196000
*         NEWID2 = 'TP4I';                                         0268 00197000
*                                                                  0268 00198000
         MVC   NEWID2(4,@06),@CC00654                              0268 00199000
*         IF PRIPCT = OFF & PCTSPP ^= NULLPTR                      0269 00200000
*           THEN                                                   0269 00201000
         TM    PRIPCT,B'10000000'                                  0269 00202000
         BNZ   @RF00269                                            0269 00203000
         L     @06,PCTSPP(,PCTPTR)                                 0269 00204000
         LTR   @06,@06                                             0269 00205000
         BZ    @RF00269                                            0269 00206000
*             PCTPTR = PCTSPP;                                     0270 00207000
*                                                                  0270 00208000
         LR    PCTPTR,@06                                          0270 00209000
*         CALL INITPCT;                                            0271 00210000
*                                                                  0271 00211000
@RF00269 BAL   @14,INITPCT                                         0271 00212000
*         /***********************************************************/ 00213000
*         /*                                                         */ 00214000
*         /* IF THE REQUEST IS FOR A PRIMARY PRINT CONTROL TABLE,    */ 00215000
*         /* THEN THE STANDARD SYSPRINT TABLE MUST BE OPENED.        */ 00216000
*         /*                                                         */ 00217000
*         /***********************************************************/ 00218000
*                                                                  0272 00219000
*         IF PRIPCT = ON                                           0272 00220000
*           THEN                                                   0272 00221000
         TM    PRIPCT,B'10000000'                                  0272 00222000
         BNO   @RF00272                                            0272 00223000
*             DO;                                                  0273 00224000
*               OPNPTR = ADDR(PROPEN);  /* SET OPNAGL ADDRESS.       */ 00225000
         LA    OPNPTR,PROPEN                                       0274 00226000
*               OPNAGL = ''B;           /* SET OPEN LIST TO ZEROS.   */ 00227000
         XC    OPNAGL(32,OPNPTR),OPNAGL(OPNPTR)                    0275 00228000
*               OPNTYPSO = ON;          /* SYSTEM OUTPUT FLAG.       */ 00229000
         OI    OPNTYPSO(OPNPTR),B'01000000'                        0276 00230000
*               OPNIOC = ADDR(PCTIOC);  /* IOC ADDRESS PTR.          */ 00231000
         LA    @06,PCTIOC(,PCTPTR)                                 0277 00232000
         ST    @06,OPNIOC(,OPNPTR)                                 0277 00233000
*               OPNMODAC = ON;          /* ASA CARRIAGE CONTROL CHAR */ 00234000
*                                                                  0278 00235000
         OI    OPNMODAC(OPNPTR),B'10000000'                        0278 00236000
*               CALL ICKIOOP0 (GDTTBL,OPNAGL);                     0279 00237000
*                                                                  0279 00238000
         L     @06,@PC00001                                        0279 00239000
         ST    @06,@AL00001                                        0279 00240000
         ST    OPNPTR,@AL00001+4                                   0279 00241000
         MVI   @AL00001+4,X'80'                                    0279 00242000
         L     @15,GDTOPN(,@06)                                    0279 00243000
         LA    @01,@AL00001                                        0279 00244000
         BALR  @14,@15                                             0279 00245000
*               OLDERID2 = NEWERID2;                               0280 00246000
         L     @06,@PC00001                                        0280 00247000
         L     @04,GDTTR2(,@06)                                    0280 00248000
         MVC   @TS00001(95),NEWERID2(@04)                          0280 00249000
         MVC   OLDERID2(95,@04),@TS00001                           0280 00250000
*               NEWID2 = 'TP4A';                                   0281 00251000
*                                                                  0281 00252000
         MVC   NEWID2(4,@04),@CC00658                              0281 00253000
*               /*****************************************************/ 00254000
*               /*                                                   */ 00255000
*               /* GET STORAGE FOR THE PRINT LINE STACK BUFFER.      */ 00256000
*               /*                                                   */ 00257000
*               /*****************************************************/ 00258000
*                                                                  0282 00259000
*               CALL ICKSAGS0 (GDTTBL,PRBUFL,PCTBUF);              0282 00260000
         ST    @06,@AL00001                                        0282 00261000
         LA    @04,PRBUFL                                          0282 00262000
         ST    @04,@AL00001+4                                      0282 00263000
         LA    @04,PCTBUF(,PCTPTR)                                 0282 00264000
         ST    @04,@AL00001+8                                      0282 00265000
         MVI   @AL00001+8,X'80'                                    0282 00266000
         L     @15,GDTGSP(,@06)                                    0282 00267000
         LA    @01,@AL00001                                        0282 00268000
         BALR  @14,@15                                             0282 00269000
*               RESPECIFY RTNREG RSTD;                             0283 00270000
*               TESTRC = RTNREG;                                   0284 00271000
         LR    TESTRC,RTNREG                                       0284 00272000
*               RESPECIFY RTNREG UNRSTD;                           0285 00273000
*               IF TESTRC ^= 0                                     0286 00274000
*                 THEN                                             0286 00275000
*                                                                  0286 00276000
         LTR   TESTRC,TESTRC                                       0286 00277000
         BZ    @RF00286                                            0286 00278000
*                   DO;                                            0287 00279000
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0288 00280000
*                     REG15 = 28;                                  0289 00281000
         LA    REG15,28                                            0289 00282000
*                     REG14 = GDTABT;                              0290 00283000
         L     @06,@PC00001                                        0290 00284000
         L     REG14,GDTABT(,@06)                                  0290 00285000
*                     REG13 = GDTABH;                              0291 00286000
         L     REG13,GDTABH(,@06)                                  0291 00287000
*                     GEN(BR    REG14);                            0292 00288000
         BR    REG14                                                    00289000
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0293 00290000
*                   END;                                           0294 00291000
*               PCTBNL = PCTBUF;                                   0295 00292000
@RF00286 L     @06,PCTBUF(,PCTPTR)                                 0295 00293000
         ST    @06,PCTBNL(,PCTPTR)                                 0295 00294000
*            END;                                                  0296 00295000
*                                                                  0296 00296000
*         /***********************************************************/ 00297000
*         /*                                                         */ 00298000
*         /* GET THE STATIC TEXT ENTRY FOR THE REQUEST.              */ 00299000
*         /*                                                         */ 00300000
*         /***********************************************************/ 00301000
*                                                                  0297 00302000
*         CALL ICKSACL0 (GDTTBL,'ICKTP05 ',STIDS,SUBPZ,PCAADDR);   0297 00303000
*                                                                  0297 00304000
@RF00272 L     @06,@PC00001                                        0297 00305000
         ST    @06,@AL00001                                        0297 00306000
         LA    @04,@CC00659                                        0297 00307000
         ST    @04,@AL00001+4                                      0297 00308000
         L     @04,@PC00002                                        0297 00309000
         ST    @04,@AL00001+8                                      0297 00310000
         LA    @04,SUBPZ                                           0297 00311000
         ST    @04,@AL00001+12                                     0297 00312000
         LA    @04,PCAADDR                                         0297 00313000
         ST    @04,@AL00001+16                                     0297 00314000
         MVI   @AL00001+16,X'80'                                   0297 00315000
         L     @15,GDTCAL(,@06)                                    0297 00316000
         LA    @01,@AL00001                                        0297 00317000
         BALR  @14,@15                                             0297 00318000
*         RESPECIFY RTNREG RSTD;                                   0298 00319000
*         TESTRC = RTNREG;                                         0299 00320000
         LR    TESTRC,RTNREG                                       0299 00321000
*         RESPECIFY RTNREG UNRSTD;                                 0300 00322000
*         IF TESTRC ^= 0                                           0301 00323000
*           THEN                                                   0301 00324000
         LTR   TESTRC,TESTRC                                       0301 00325000
         BZ    @RF00301                                            0301 00326000
*             RETURN CODE(TESTRC);                                 0302 00327000
         LR    @15,TESTRC                                          0302 00328000
         L     @14,@SA00002                                        0302 00329000
         LM    @00,@12,@SA00002+8                                  0302 00330000
         BR    @14                                                 0302 00331000
*         /***********************************************************/ 00332000
*         /*                                                         */ 00333000
*         /*  SET UP THE ADDRESSES FROM THE OFFSETS.                 */ 00334000
*         /*                                                         */ 00335000
*         /***********************************************************/ 00336000
*                                                                  0303 00337000
*         IF PCMTLP ^= NULLPTR                                     0303 00338000
*           THEN                                                   0303 00339000
@RF00301 L     @06,PCAADDR                                         0303 00340000
         L     @04,PCMTLP(,@06)                                    0303 00341000
         LTR   @04,@04                                             0303 00342000
         BZ    @RF00303                                            0303 00343000
*             PCMTLP = PCMTLP + PCAADDR;                           0304 00344000
         ALR   @04,@06                                             0304 00345000
         ST    @04,PCMTLP(,@06)                                    0304 00346000
*         IF PCSTLP ^= NULLPTR                                     0305 00347000
*           THEN                                                   0305 00348000
@RF00303 L     @06,PCAADDR                                         0305 00349000
         L     @04,PCSTLP(,@06)                                    0305 00350000
         LTR   @04,@04                                             0305 00351000
         BZ    @RF00305                                            0305 00352000
*             PCSTLP = PCSTLP + PCAADDR;                           0306 00353000
         ALR   @04,@06                                             0306 00354000
         ST    @04,PCSTLP(,@06)                                    0306 00355000
*         IF PCFLP ^= NULLPTR                                      0307 00356000
*           THEN                                                   0307 00357000
@RF00305 L     @06,PCAADDR                                         0307 00358000
         L     @04,PCFLP(,@06)                                     0307 00359000
         LTR   @04,@04                                             0307 00360000
         BZ    @RF00307                                            0307 00361000
*             PCFLP = PCFLP + PCAADDR;                             0308 00362000
         ALR   @04,@06                                             0308 00363000
         ST    @04,PCFLP(,@06)                                     0308 00364000
*         IF PCPCP ^= NULLPTR                                      0309 00365000
*           THEN                                                   0309 00366000
@RF00307 L     @06,PCAADDR                                         0309 00367000
         L     @04,PCPCP(,@06)                                     0309 00368000
         LTR   @04,@04                                             0309 00369000
         BZ    @RF00309                                            0309 00370000
*             PCPCP = PCPCP + PCAADDR;                             0310 00371000
*                                                                  0310 00372000
         ALR   @04,@06                                             0310 00373000
         ST    @04,PCPCP(,@06)                                     0310 00374000
*         /***********************************************************/ 00375000
*         /*                                                         */ 00376000
*         /*  THE INPUT PARAMETER LIST IS SET UP.  CALL THE PROCEDURE*/ 00377000
*         /*  TO INITIALIZE THE PARAMETERS.                          */ 00378000
*         /*                                                         */ 00379000
*         /***********************************************************/ 00380000
*                                                                  0311 00381000
*         CALL P04SETUP;                                           0311 00382000
*                                                                  0311 00383000
@RF00309 BAL   @14,P04SETUP                                        0311 00384000
*         /***********************************************************/ 00385000
*         /*                                                         */ 00386000
*         /* CALL THE ROUTINE TO SET UP THE PARAMETERS IN THE PCT    */ 00387000
*         /*                                                         */ 00388000
*         /***********************************************************/ 00389000
*                                                                  0312 00390000
*         CALL PCTSETUP;                                           0312 00391000
*                                                                  0312 00392000
         BAL   @14,PCTSETUP                                        0312 00393000
*         RESPECIFY RTNREG RSTD;                                   0313 00394000
*         TESTRC = RTNREG;                                         0314 00395000
         LR    TESTRC,RTNREG                                       0314 00396000
*         RESPECIFY RTNREG UNRSTD;                                 0315 00397000
*         SAVERC = TESTRC;                                         0316 00398000
*                                                                  0316 00399000
         LR    SAVERC,TESTRC                                       0316 00400000
*         IF GDTDBG = NULLPTR                                      0317 00401000
*           THEN;                                                  0317 00402000
         L     @06,@PC00001                                        0317 00403000
         L     @06,GDTDBG(,@06)                                    0317 00404000
         LTR   @06,@06                                             0317 00405000
         BZ    @RT00317                                            0317 00406000
*           ELSE                                                   0319 00407000
*             CALL ICKDB010  (GDTTBL,'TP4S');                      0319 00408000
*                                                                  0319 00409000
         L     @06,@PC00001                                        0319 00410000
         ST    @06,@AL00001                                        0319 00411000
         LA    @03,@CC00662                                        0319 00412000
         ST    @03,@AL00001+4                                      0319 00413000
         MVI   @AL00001+4,X'80'                                    0319 00414000
         L     @15,GDTDBG(,@06)                                    0319 00415000
         LA    @01,@AL00001                                        0319 00416000
         BALR  @14,@15                                             0319 00417000
*         CALL ICKSAFS0 (GDTTBL,PCAADDR);/*                        0320 00418000
*                                          FREE STATIC TEXT CORE.    */ 00419000
*                                                                  0320 00420000
@RT00317 L     @06,@PC00001                                        0320 00421000
         ST    @06,@AL00001                                        0320 00422000
         LA    @03,PCAADDR                                         0320 00423000
         ST    @03,@AL00001+4                                      0320 00424000
         L     @15,GDTFSP(,@06)                                    0320 00425000
         LA    @01,@AL00001                                        0320 00426000
         BALR  @14,@15                                             0320 00427000
*         RETURN CODE(SAVERC);                                     0321 00428000
         LR    @15,SAVERC                                          0321 00429000
         L     @14,@SA00002                                        0321 00430000
         LM    @00,@12,@SA00002+8                                  0321 00431000
         BR    @14                                                 0321 00432000
*         END ESTSCONT;                                            0322 00433000
*         /***********************************************************/ 00434000
*         /*                                                         */ 00435000
*         /* PROCEDURE NAME - ESTA HANDLER.                          */ 00436000
*         /*                                                         */ 00437000
*         /* FUNCTION - ESTABLISHES A PRINT CONTROL TABLE FROM THE   */ 00438000
*         /* ARGUMENTS PASSED WITH THE CALL.  STATIC TEXT IS NOT     */ 00439000
*         /* REFERENCED IN THIS TYPE OF CALL.                        */ 00440000
*         /*                                                         */ 00441000
*         /* INPUT - THE ARGUMENT LIST DEFINED BY PCALIST IN THIS    */ 00442000
*         /* PROCEDURE.                                              */ 00443000
*         /*                                                         */ 00444000
*         /* OUTPUT - A PRINT CONTROL TABLE.                         */ 00445000
*         /*                                                         */ 00446000
*         /***********************************************************/ 00447000
*                                                                  0323 00448000
*ESTACONT: PROC (PCALIST);                                         0323 00449000
*                                                                  0323 00450000
ESTACONT STM   @14,@12,@SA00003                                    0323 00451000
         MVC   @PC00003(4),0(@01)                                  0323 00452000
*         SAVERC = 0;                                              0324 00453000
         SLR   SAVERC,SAVERC                                       0324 00454000
*         PCTPTR = GDTTPH;                                         0325 00455000
*                                                                  0325 00456000
         L     @06,@PC00001                                        0325 00457000
         L     @06,GDTTPH(,@06)                                    0325 00458000
         LR    PCTPTR,@06                                          0325 00459000
*         PCAADDR = ADDR(PCALIST);     /* SET STRUCTURE ADDRESS      */ 00460000
*                                                                  0326 00461000
         L     @04,@PC00003                                        0326 00462000
         ST    @04,PCAADDR                                         0326 00463000
*         /***********************************************************/ 00464000
*         /*                                                         */ 00465000
*         /* GET AND INITIALIZE THE PRINT CONTROL TABLE AREA.        */ 00466000
*         /*                                                         */ 00467000
*         /***********************************************************/ 00468000
*                                                                  0327 00469000
*         IF GDTTPH = NULLPTR                                      0327 00470000
*           THEN                                                   0327 00471000
         LTR   @06,@06                                             0327 00472000
         BNZ   @RF00327                                            0327 00473000
*             PRIPCT = ON;              /* PRIMARY CONTROL TABLE ON. */ 00474000
         OI    PRIPCT,B'10000000'                                  0328 00475000
*           ELSE                                                   0329 00476000
*             PRIPCT = OFF;             /* PRIMARY CONTROL TABLE OFF */ 00477000
         B     @RC00327                                            0329 00478000
@RF00327 NI    PRIPCT,B'01111111'                                  0329 00479000
*         IF PRIPCT = OFF & PCTSPP ^= NULLPTR                      0330 00480000
*           THEN                                                   0330 00481000
@RC00327 TM    PRIPCT,B'10000000'                                  0330 00482000
         BNZ   @RF00330                                            0330 00483000
         L     @06,PCTSPP(,PCTPTR)                                 0330 00484000
         LTR   @06,@06                                             0330 00485000
         BZ    @RF00330                                            0330 00486000
*             PCTPTR = PCTSPP;                                     0331 00487000
*                                                                  0331 00488000
         LR    PCTPTR,@06                                          0331 00489000
*         CALL INITPCT;                /* GET CORE FOR THE PCT.     */  00490000
*                                                                  0332 00491000
@RF00330 BAL   @14,INITPCT                                         0332 00492000
*         /***********************************************************/ 00493000
*         /*                                                         */ 00494000
*         /*  CALL THE PROCEDURE TO INITIALIZE THE PARAMETERS.       */ 00495000
*         /*                                                         */ 00496000
*         /***********************************************************/ 00497000
*                                                                  0333 00498000
*         CALL P04SETUP;                                           0333 00499000
*                                                                  0333 00500000
         BAL   @14,P04SETUP                                        0333 00501000
*         /***********************************************************/ 00502000
*         /*                                                         */ 00503000
*         /*  CALL THE ROUTINE TO SET UP THE PARAMETERS IN THE PCT   */ 00504000
*         /*                                                         */ 00505000
*         /***********************************************************/ 00506000
*                                                                  0334 00507000
*         CALL PCTSETUP;                                           0334 00508000
*                                                                  0334 00509000
         BAL   @14,PCTSETUP                                        0334 00510000
*         RESPECIFY RTNREG RSTD;                                   0335 00511000
*         TESTRC = RTNREG;                                         0336 00512000
         LR    TESTRC,RTNREG                                       0336 00513000
*         RESPECIFY RTNREG UNRSTD;                                 0337 00514000
*         SAVERC = TESTRC;                                         0338 00515000
*                                                                  0338 00516000
         LR    SAVERC,TESTRC                                       0338 00517000
*         IF GDTDBG = NULLPTR                                      0339 00518000
*           THEN;                                                  0339 00519000
         L     @06,@PC00001                                        0339 00520000
         L     @06,GDTDBG(,@06)                                    0339 00521000
         LTR   @06,@06                                             0339 00522000
         BZ    @RT00339                                            0339 00523000
*           ELSE                                                   0341 00524000
*             CALL ICKDB010  (GDTTBL,'TP4A');                      0341 00525000
*                                                                  0341 00526000
         L     @06,@PC00001                                        0341 00527000
         ST    @06,@AL00001                                        0341 00528000
         LA    @03,@CC00658                                        0341 00529000
         ST    @03,@AL00001+4                                      0341 00530000
         MVI   @AL00001+4,X'80'                                    0341 00531000
         L     @15,GDTDBG(,@06)                                    0341 00532000
         LA    @01,@AL00001                                        0341 00533000
         BALR  @14,@15                                             0341 00534000
*         RETURN CODE(SAVERC);                                     0342 00535000
@RT00339 LR    @15,SAVERC                                          0342 00536000
         L     @14,@SA00003                                        0342 00537000
         LM    @00,@12,@SA00003+8                                  0342 00538000
         BR    @14                                                 0342 00539000
*         END ESTACONT;                                            0343 00540000
*         /***********************************************************/ 00541000
*         /*                                                         */ 00542000
*         /* PROCEDURE NAME - PRINT WORK TABLE INITIALIZATION.       */ 00543000
*         /*                                                         */ 00544000
*         /* FUNCTION - INITIALIZES MOST OF THE DEFAULT VALUES IN    */ 00545000
*         /* IN THE PRINT WORK TABLE.                                */ 00546000
*         /* THIS PROCEDURE IS CALLED FROM THE TP04A & TP04B         */ 00547000
*         /* PROCEDURES AND MOVES THE INPUT ARGUMENTS INTO THE       */ 00548000
*         /* COMMON WORK TABLE SO THEY CAN BE MORE EFFICIENTLY       */ 00549000
*         /* HANDLED.                                                */ 00550000
*         /*                                                         */ 00551000
*         /* INPUT - NONE.                                           */ 00552000
*         /*                                                         */ 00553000
*         /* OUTPUT - A PARTIALLY INITIALIZED PRINT WORK TABLE.      */ 00554000
*         /*                                                         */ 00555000
*         /***********************************************************/ 00556000
*                                                                  0344 00557000
*P04SETUP: PROC;                                                   0344 00558000
*                                                                  0344 00559000
P04SETUP STM   @14,@12,12(@13)                                     0344 00560000
*         /***********************************************************/ 00561000
*         /*                                                         */ 00562000
*         /* SET UP THE WORKING PARAMETER TABLE.                     */ 00563000
*         /*                                                         */ 00564000
*         /***********************************************************/ 00565000
*                                                                  0345 00566000
*         P04WT = ''B;                                             0345 00567000
         XC    P04WT(42),P04WT                                     0345 00568000
*         P04MTP = PCMTLP;              /* SET MAIN TITLE LINE PTR   */ 00569000
         L     @03,PCAADDR                                         0346 00570000
         L     @15,PCMTLP(,@03)                                    0346 00571000
         ST    @15,P04MTP                                          0346 00572000
*         P04MTC = PCMTLC;              /* SET MAIN TITLE LINE COUNT */ 00573000
         LH    @15,PCMTLC(,@03)                                    0347 00574000
         STH   @15,P04MTC                                          0347 00575000
*         P04STP = PCSTLP;              /* SET SUB-TITLE LINE PTR    */ 00576000
         L     @15,PCSTLP(,@03)                                    0348 00577000
         ST    @15,P04STP                                          0348 00578000
*         P04STC = PCSTLC;              /* SET SUB-TITLE LINE COUNT  */ 00579000
         LH    @15,PCSTLC(,@03)                                    0349 00580000
         STH   @15,P04STC                                          0349 00581000
*         P04FP = PCFLP;                /* SET FOOTING LINE PTR      */ 00582000
         L     @15,PCFLP(,@03)                                     0350 00583000
         ST    @15,P04FP                                           0350 00584000
*         P04FC = PCFLC;                /* SET FOOTING LINE COUNT    */ 00585000
         LH    @15,PCFLC(,@03)                                     0351 00586000
         STH   @15,P04FC                                           0351 00587000
*         P04PCP = PCPCP;               /* SET CHAIN POINTER.        */ 00588000
         L     @15,PCPCP(,@03)                                     0352 00589000
         ST    @15,P04PCP                                          0352 00590000
*         P04PNL = PCPNL;               /* SET PAGE NUMBER LOCATION  */ 00591000
         LH    @15,PCPNL(,@03)                                     0353 00592000
         STH   @15,P04PNL                                          0353 00593000
*         P04TL = PCPTL;                /* SET TIME LOCATION         */ 00594000
         LH    @15,PCPTL(,@03)                                     0354 00595000
         STH   @15,P04TL                                           0354 00596000
*         P04DL = PCPDL;                /* SET DATE LOCATION         */ 00597000
         LH    @15,PCPDL(,@03)                                     0355 00598000
         STH   @15,P04DL                                           0355 00599000
*         P04LW = PCLW;                 /* SET THE LINE WIDTH.       */ 00600000
         LH    @15,PCLW(,@03)                                      0356 00601000
         STH   @15,P04LW                                           0356 00602000
*         P04PD = PCPD;                 /* SET PAGE DEPTH            */ 00603000
         LH    @15,PCPD(,@03)                                      0357 00604000
         STH   @15,P04PD                                           0357 00605000
*         P04DSC = PCDSC;               /* SET DEFAULT SPACE CHAR    */ 00606000
         SLR   @15,@15                                             0358 00607000
         IC    @15,PCDSC(,@03)                                     0358 00608000
         STH   @15,P04DSC                                          0358 00609000
*         END P04SETUP;                                            0359 00610000
@EL00004 DS    0H                                                  0359 00611000
@EF00004 DS    0H                                                  0359 00612000
@ER00004 LM    @14,@12,12(@13)                                     0359 00613000
         BR    @14                                                 0359 00614000
*         /***********************************************************/ 00615000
*         /*                                                         */ 00616000
*         /* PROCEDURE NAME - REST HANDLER.                          */ 00617000
*         /*                                                         */ 00618000
*         /* FUNCTION - THIS PROCEDURE CONTROL THE SETTING UP OF     */ 00619000
*         /* PARAMETERS IN THE PRINT CONTROL TABLE PASSED BY THE     */ 00620000
*         /* UREST MACRO.                                            */ 00621000
*         /*                                                         */ 00622000
*         /* INPUT - THE ARGUMENT LIST DEFINED BY THE PCR STRUCTURE  */ 00623000
*         /* IN THIS PROCEDURE.                                      */ 00624000
*         /*                                                         */ 00625000
*         /* OUTPUT - A MODIFIED EXISTING PRINT CONTROL TABLE.       */ 00626000
*         /*                                                         */ 00627000
*         /***********************************************************/ 00628000
*                                                                  0360 00629000
*RESTCONT: PROC;                                                   0360 00630000
*                                                                  0360 00631000
RESTCONT STM   @14,@12,@SA00005                                    0360 00632000
*         IF GDTTPH = NULLPTR                                      0361 00633000
*           THEN                                                   0361 00634000
*                                                                  0361 00635000
         L     @09,@PC00001                                        0361 00636000
         L     @03,GDTTPH(,@09)                                    0361 00637000
         LTR   @03,@03                                             0361 00638000
         BNZ   @RF00361                                            0361 00639000
*             DO;                                                  0362 00640000
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 0363 00641000
*               REG15 = 24;                                        0364 00642000
         LA    REG15,24                                            0364 00643000
*               REG14 = GDTABT;                                    0365 00644000
         L     REG14,GDTABT(,@09)                                  0365 00645000
*               REG13 = GDTABH;                                    0366 00646000
         L     REG13,GDTABH(,@09)                                  0366 00647000
*               GEN(BR    REG14);                                  0367 00648000
         BR    REG14                                                    00649000
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                0368 00650000
*             END;                                                 0369 00651000
*         PRIPCT = OFF;                                            0370 00652000
@RF00361 NI    PRIPCT,B'01111111'                                  0370 00653000
*         SAVERC = 0;                                              0371 00654000
*                                                                  0371 00655000
         SLR   SAVERC,SAVERC                                       0371 00656000
*         PCTPTR = GDTTPH;                                         0372 00657000
         L     @09,@PC00001                                        0372 00658000
         L     PCTPTR,GDTTPH(,@09)                                 0372 00659000
*         IF PCTSPP ^= NULLPTR                                     0373 00660000
*           THEN                                                   0373 00661000
         L     @09,PCTSPP(,PCTPTR)                                 0373 00662000
         LTR   @09,@09                                             0373 00663000
         BZ    @RF00373                                            0373 00664000
*             PCTPTR = PCTSPP;                                     0374 00665000
*                                                                  0374 00666000
         LR    PCTPTR,@09                                          0374 00667000
*         /***********************************************************/ 00668000
*         /*                                                         */ 00669000
*         /* FLUSH THE STACK BUFFER BEFORE MAKING ANY CHANGES.       */ 00670000
*         /*                                                         */ 00671000
*         /***********************************************************/ 00672000
*                                                                  0375 00673000
*         CALL STACKFL;                                            0375 00674000
*                                                                  0375 00675000
@RF00373 BAL   @14,STACKFL                                         0375 00676000
*         /***********************************************************/ 00677000
*         /*                                                         */ 00678000
*         /* THE FOLLOWING ARE DECLARES USED EXCLUSIVELY IN THIS     */ 00679000
*         /* PROCEDURE.  THE FIRST IS THE TABLE USED IN GETTING THE  */ 00680000
*         /* TRANSLATE TABLE REQUIRED BY VARIOUS PRINT CHAINS.       */ 00681000
*         /*                                                         */ 00682000
*         /***********************************************************/ 00683000
*                                                                  0376 00684000
*         /***********************************************************/ 00685000
*         /*                                                         */ 00686000
*         /* THE FOLLOWING IS A THREE BYTE WIDE TABLE OF THE VARIOUS */ 00687000
*         /* STANDARD PRINT CHAINS.  THE FIRST TWO BYTES OF EACH     */ 00688000
*         /* ENTRY CONTAIN THE PRINT CHAIN ID, THE THIRD BYTE        */ 00689000
*         /* CONTAINS THE STATIC TEXT ENTRY NUMBER IN THE MODULE     */ 00690000
*         /* ICKTSTP0 THAT CONTAINS THE TRANSLATE TABLE FOR THAT     */ 00691000
*         /* TYPE OF CHAIN.                                          */ 00692000
*         /*                                                         */ 00693000
*         /***********************************************************/ 00694000
*         DCL PCTAB (7) CHAR (3) INIT                              0376 00695000
*           ('C1D501'X,                 /* AN CHAIN.                 */ 00696000
*            'C8D506'X,                 /* HN CHAIN.                 */ 00697000
*            'D7D502'X,                 /* PN CHAIN.                 */ 00698000
*            'D8D503'X,                 /* QN CHAIN.                 */ 00699000
*            'D9D507'X,                 /* RN CHAIN.                 */ 00700000
*            'E2D504'X,                 /* SN CHAIN.                 */ 00701000
*            'E3D505'X);                /* TN CHAIN.                 */ 00702000
*                                                                  0376 00703000
*         DCL RESTARG(7) PTR(31);                                  0377 00704000
*                                                                  0378 00705000
*         /***********************************************************/ 00706000
*         /*                                                         */ 00707000
*         /* RUNNING CODE BEGINS HERE.                               */ 00708000
*         /*                                                         */ 00709000
*         /***********************************************************/ 00710000
*                                                                  0378 00711000
*         P04WT = ''B;                  /* CLEAR THE WORK TABLE. */     00712000
         XC    P04WT(42),P04WT                                     0378 00713000
*         RESTARG(1)=ADDR(ARG1);                                   0379 00714000
         L     @09,@PC00001+12                                     0379 00715000
         ST    @09,RESTARG                                         0379 00716000
*         RESTARG(2)=ADDR(ARG2);                                   0380 00717000
         L     @09,@PC00001+16                                     0380 00718000
         ST    @09,RESTARG+4                                       0380 00719000
*         RESTARG(3)=ADDR(ARG3);                                   0381 00720000
         L     @09,@PC00001+20                                     0381 00721000
         ST    @09,RESTARG+8                                       0381 00722000
*         RESTARG(4)=ADDR(ARG4);                                   0382 00723000
         L     @09,@PC00001+24                                     0382 00724000
         ST    @09,RESTARG+12                                      0382 00725000
*         RESTARG(5)=ADDR(ARG5);                                   0383 00726000
         L     @09,@PC00001+28                                     0383 00727000
         ST    @09,RESTARG+16                                      0383 00728000
*         RESTARG(6)=ADDR(ARG6);                                   0384 00729000
         L     @09,@PC00001+32                                     0384 00730000
         ST    @09,RESTARG+20                                      0384 00731000
*         RESTARG(7)=ADDR(ARG7);                                   0385 00732000
         L     @09,@PC00001+36                                     0385 00733000
         ST    @09,RESTARG+24                                      0385 00734000
*         DO ARGNMB = 1 TO (LISTLN - 3) BY 1;                      0386 00735000
         LA    ARGNMB,1                                            0386 00736000
         B     @DE00386                                            0386 00737000
@DL00386 DS    0H                                                  0387 00738000
*                                       /* LOOP THROUGH THE ARGS.    */ 00739000
*           PCRADDR = RESTARG(ARGNMB);  /* SET PARM ADDRESS          */ 00740000
*                                                                  0387 00741000
         LR    @04,ARGNMB                                          0387 00742000
         SLA   @04,2                                               0387 00743000
         L     PCRADDR,RESTARG-4(@04)                              0387 00744000
*           /*********************************************************/ 00745000
*           /*                                                       */ 00746000
*           /* IF SUB_TITLE ARGUMENT ENTERED, INITIALIZE THEM.       */ 00747000
*           /*                                                       */ 00748000
*           /*********************************************************/ 00749000
*                                                                  0388 00750000
*           IF PCRTYP = 'ST'            /* TEST FOR SUB-TITLE LINE   */ 00751000
*             THEN                                                 0388 00752000
         CLC   PCRTYP(2,PCRADDR),@CC00684                          0388 00753000
         BNE   @RF00388                                            0388 00754000
*               DO;                                                0389 00755000
*                 IF PCRPTR = NULLPTR                              0390 00756000
*                   THEN                                           0390 00757000
         L     @04,PCRPTR(,PCRADDR)                                0390 00758000
         LTR   @04,@04                                             0390 00759000
         BNZ   @RF00390                                            0390 00760000
*                     P04STC = -1;      /* SET TO CLEAR EXISTING.    */ 00761000
         MVC   P04STC(2),@CH00685                                  0391 00762000
*                   ELSE                                           0392 00763000
*                     DO;               /* SET NEW SUB-TITLE PTR.    */ 00764000
         B     @RC00390                                            0392 00765000
@RF00390 DS    0H                                                  0393 00766000
*                       P04STP = PCRPTR;                           0393 00767000
         L     @04,PCRPTR(,PCRADDR)                                0393 00768000
         ST    @04,P04STP                                          0393 00769000
*                       P04STC = PCRLC;                            0394 00770000
         LH    @04,PCRLC(,PCRADDR)                                 0394 00771000
         STH   @04,P04STC                                          0394 00772000
*                     END;                                         0395 00773000
*               END;                                               0396 00774000
*                                                                  0396 00775000
@RC00390 DS    0H                                                  0397 00776000
*           /*********************************************************/ 00777000
*           /*                                                       */ 00778000
*           /* IF FOOTING LINE ARGUMENT ENTERED INITIALIZE THEM.     */ 00779000
*           /*                                                       */ 00780000
*           /*********************************************************/ 00781000
*                                                                  0397 00782000
*           IF PCRTYP = 'FT'            /* CHECK FOR FOOTING LINE    */ 00783000
*             THEN                                                 0397 00784000
@RF00388 CLC   PCRTYP(2,PCRADDR),@CC00686                          0397 00785000
         BNE   @RF00397                                            0397 00786000
*               DO;                                                0398 00787000
*                 IF PCRPTR = NULLPTR                              0399 00788000
*                   THEN                                           0399 00789000
         L     @04,PCRPTR(,PCRADDR)                                0399 00790000
         LTR   @04,@04                                             0399 00791000
         BNZ   @RF00399                                            0399 00792000
*                     P04FC = -1;       /* SET TO CLEAR EXISTING.    */ 00793000
         MVC   P04FC(2),@CH00685                                   0400 00794000
*                   ELSE                                           0401 00795000
*                     DO;               /* SET NEW FOOTING PTR.      */ 00796000
         B     @RC00399                                            0401 00797000
@RF00399 DS    0H                                                  0402 00798000
*                       P04FP = PCRPTR;                            0402 00799000
         L     @04,PCRPTR(,PCRADDR)                                0402 00800000
         ST    @04,P04FP                                           0402 00801000
*                       P04FC = PCRLC;                             0403 00802000
         LH    @04,PCRLC(,PCRADDR)                                 0403 00803000
         STH   @04,P04FC                                           0403 00804000
*                     END;                                         0404 00805000
*               END;                                               0405 00806000
*                                                                  0405 00807000
@RC00399 DS    0H                                                  0406 00808000
*           /*********************************************************/ 00809000
*           /*                                                       */ 00810000
*           /* IF LINE WIDTH ARGUMENTS ENTERED, INITIALIZE THEM      */ 00811000
*           /*                                                       */ 00812000
*           /*********************************************************/ 00813000
*                                                                  0406 00814000
*           IF PCRTYP = 'LW'            /* TEST FOR NEW LINE WIDTH   */ 00815000
*             THEN                                                 0406 00816000
@RF00397 CLC   PCRTYP(2,PCRADDR),@CC00687                          0406 00817000
         BNE   @RF00406                                            0406 00818000
*               DO;                                                0407 00819000
*                 P04LW = PCRLC;        /* SET NEW LINE WIDTH        */ 00820000
         LH    @04,PCRLC(,PCRADDR)                                 0408 00821000
         STH   @04,P04LW                                           0408 00822000
*                 IF PCRLC = 0                                     0409 00823000
*                   THEN                                           0409 00824000
         LTR   @04,@04                                             0409 00825000
         BNZ   @RF00409                                            0409 00826000
*                     P04LW = STDLW;    /* SET TO RESTORE DEFAULT.   */ 00827000
         L     @04,STDLW                                           0410 00828000
         STH   @04,P04LW                                           0410 00829000
*               END;                                               0411 00830000
*                                                                  0411 00831000
@RF00409 DS    0H                                                  0412 00832000
*           /*********************************************************/ 00833000
*           /*                                                       */ 00834000
*           /* IF PAGE DEPTH ARGUMENTS ENTERED, INITIALIZE THEM.     */ 00835000
*           /*                                                       */ 00836000
*           /*********************************************************/ 00837000
*                                                                  0412 00838000
*           IF PCRTYP = 'PD'            /* TEST FOR NEW PAGE DEPTH   */ 00839000
*             THEN                                                 0412 00840000
@RF00406 CLC   PCRTYP(2,PCRADDR),@CC00688                          0412 00841000
         BNE   @RF00412                                            0412 00842000
*               DO;                                                0413 00843000
*                 P04PD = PCRLC;        /* SET NEW PAGE DEPTH        */ 00844000
         LH    @04,PCRLC(,PCRADDR)                                 0414 00845000
         STH   @04,P04PD                                           0414 00846000
*                 IF PCRLC = 0                                     0415 00847000
*                   THEN                                           0415 00848000
         LTR   @04,@04                                             0415 00849000
         BNZ   @RF00415                                            0415 00850000
*                     P04PD = STDPD;    /* SET TO RESTORE DEFAULT.   */ 00851000
         MVC   P04PD(2),@CH00619                                   0416 00852000
*               END;                                               0417 00853000
*                                                                  0417 00854000
@RF00415 DS    0H                                                  0418 00855000
*           /*********************************************************/ 00856000
*           /*                                                       */ 00857000
*           /* IF DEFAULT SPACE CHARACTER ENTERED, INITIALIZE IT.    */ 00858000
*           /*                                                       */ 00859000
*           /*********************************************************/ 00860000
*                                                                  0418 00861000
*           IF PCRTYP = 'SC'            /* TEST FOR NEW DEFAULT SPACE*/ 00862000
*             THEN                                                 0418 00863000
@RF00412 CLC   PCRTYP(2,PCRADDR),@CC00689                          0418 00864000
         BNE   @RF00418                                            0418 00865000
*               DO;                                                0419 00866000
*                 P04DSC = PCRLC;       /* SET NEW DSC               */ 00867000
         LH    @04,PCRLC(,PCRADDR)                                 0420 00868000
         STH   @04,P04DSC                                          0420 00869000
*                 IF PCRLC = 0                                     0421 00870000
*                   THEN                                           0421 00871000
         LTR   @04,@04                                             0421 00872000
         BNZ   @RF00421                                            0421 00873000
*                     P04DSC = 1;       /* SET TO RESTORE DEFAULT.   */ 00874000
         MVC   P04DSC(2),@CH00178                                  0422 00875000
*               END;                                               0423 00876000
*                                                                  0423 00877000
@RF00421 DS    0H                                                  0424 00878000
*           /*********************************************************/ 00879000
*           /*                                                       */ 00880000
*           /* IF PRINT CHAIN ARGUMENTS ENTERED, INITIALIZE IT.      */ 00881000
*           /*                                                       */ 00882000
*           /*********************************************************/ 00883000
*                                                                  0424 00884000
*         IF PCRTYP = 'PC'              /* TEST FOR PRINT CHAIN */ 0424 00885000
*           THEN                                                   0424 00886000
@RF00418 CLC   PCRTYP(2,PCRADDR),@CC00690                          0424 00887000
         BNE   @RF00424                                            0424 00888000
*             DO;                                                  0425 00889000
*               IF PCRLC ^= 0                                      0426 00890000
*                 THEN                                             0426 00891000
*                                                                  0426 00892000
         LH    @04,PCRLC(,PCRADDR)                                 0426 00893000
         LTR   @04,@04                                             0426 00894000
         BZ    @RF00426                                            0426 00895000
*                 /***************************************************/ 00896000
*                 /*                                                 */ 00897000
*                 /* IF PCRLC IS NON-ZERO, A STANDARD PRINT CHAIN    */ 00898000
*                 /* ID HAS BEEN FURNISHED.                          */ 00899000
*                 /* SEARCH THE TABLE FOR THE PRINT CHAIN ENTERED.   */ 00900000
*                 /* CHAIN ENTERED.                                  */ 00901000
*                 /* IF A MATCH IS FOUND, GO TO ICKTP05 TO GET IT.   */ 00902000
*                 /*                                                 */ 00903000
*                 /***************************************************/ 00904000
*                                                                  0427 00905000
*                   DO;                                            0427 00906000
*                     STID(1:3) = 'TP0';                           0428 00907000
         MVC   STID(3),@CC00691                                    0428 00908000
*                                       /* SET UP THE STID FOR CHAIN */ 00909000
*                     DO N = 1 TO 7 BY 1;                          0429 00910000
         LA    N,1                                                 0429 00911000
@DL00429 DS    0H                                                  0430 00912000
*                       IF PCTAB(N,1:2) = PCRLCC                   0430 00913000
*                         THEN                                     0430 00914000
         LR    @04,N                                               0430 00915000
         MH    @04,@CH00149                                        0430 00916000
         LA    @01,PCTAB-3(@04)                                    0430 00917000
         CLC   0(2,@01),PCRLCC(PCRADDR)                            0430 00918000
         BNE   @RF00430                                            0430 00919000
*                           STID(4) = PCTAB(N,3);                  0431 00920000
         LA    @01,PCTAB-1(@04)                                    0431 00921000
         MVC   STID+3(1),0(@01)                                    0431 00922000
*                                       /* SET THE ENTRY NUMBER.     */ 00923000
*                     END;                                         0432 00924000
@RF00430 AL    N,@CF00178                                          0432 00925000
         C     N,@CF00198                                          0432 00926000
         BNH   @DL00429                                            0432 00927000
*                     IF STID(4) ^= 0                              0433 00928000
*                       THEN                                       0433 00929000
         CLI   STID+3,0                                            0433 00930000
         BE    @RF00433                                            0433 00931000
*                         DO;                                      0434 00932000
*                                                                  0434 00933000
*                           CALL ICKSACL0 (GDTTBL,'ICKTP05 ',STID,SUBPZ 00934000
*P04PCP);                                                          0435 00935000
*                                                                  0435 00936000
         L     @04,@PC00001                                        0435 00937000
         ST    @04,@AL00001                                        0435 00938000
         LA    @15,@CC00659                                        0435 00939000
         ST    @15,@AL00001+4                                      0435 00940000
         LA    @15,STID                                            0435 00941000
         ST    @15,@AL00001+8                                      0435 00942000
         LA    @15,SUBPZ                                           0435 00943000
         ST    @15,@AL00001+12                                     0435 00944000
         LA    @15,P04PCP                                          0435 00945000
         ST    @15,@AL00001+16                                     0435 00946000
         MVI   @AL00001+16,X'80'                                   0435 00947000
         L     @15,GDTCAL(,@04)                                    0435 00948000
         LA    @01,@AL00001                                        0435 00949000
         BALR  @14,@15                                             0435 00950000
*                           RESPECIFY RTNREG RSTD;                 0436 00951000
*                           TESTRC = RTNREG;                       0437 00952000
         LR    TESTRC,RTNREG                                       0437 00953000
*                           RESPECIFY RTNREG UNRSTD;               0438 00954000
*                           SAVERC = TESTRC;                       0439 00955000
         LR    SAVERC,TESTRC                                       0439 00956000
*                         END;                                     0440 00957000
*                   END;                                           0441 00958000
*                                                                  0441 00959000
@RF00433 DS    0H                                                  0442 00960000
*               /*****************************************************/ 00961000
*               /*                                                   */ 00962000
*               /* IF PCRPTR IS NON-ZERO, A LOADMODULE NAME WAS      */ 00963000
*               /* GIVEN SO LOAD THE MODULE AND SET THE POINTER TO   */ 00964000
*               /* THE ENTRY POINT OF THE LOAD MODULE AS THE START   */ 00965000
*               /* OF THE TRANSLATE TABLE.                           */ 00966000
*               /*                                                   */ 00967000
*               /*****************************************************/ 00968000
*                                                                  0442 00969000
*               IF PCRPTR ^= NULLPTR                               0442 00970000
*                 THEN                                             0442 00971000
@RF00426 L     @04,PCRPTR(,PCRADDR)                                0442 00972000
         LTR   @04,@04                                             0442 00973000
         BZ    @RF00442                                            0442 00974000
*                   DO;                                            0443 00975000
*                                                                  0443 00976000
*                     CALL ICKSALD0 (GDTTBL,TTDSN,P04PCP);         0444 00977000
*                                                                  0444 00978000
         L     @03,@PC00001                                        0444 00979000
         ST    @03,@AL00001                                        0444 00980000
         ST    @04,@AL00001+4                                      0444 00981000
         LA    @04,P04PCP                                          0444 00982000
         ST    @04,@AL00001+8                                      0444 00983000
         L     @15,GDTLOD(,@03)                                    0444 00984000
         LA    @01,@AL00001                                        0444 00985000
         BALR  @14,@15                                             0444 00986000
*                   END;                                           0445 00987000
*             END;                                                 0446 00988000
*                                                                  0446 00989000
@RF00442 DS    0H                                                  0447 00990000
*           /*********************************************************/ 00991000
*           /*                                                       */ 00992000
*           /* TEST FOR A NEW PAGE NUMBER ENTERED                    */ 00993000
*           /* CONVERT TO BINARY AND ENTER IN TABLE.                 */ 00994000
*           /*                                                       */ 00995000
*           /*********************************************************/ 00996000
*                                                                  0447 00997000
*           IF PCRTYP = 'PN' & PGNOLIN ^= 0                        0447 00998000
*             THEN                                                 0447 00999000
@RF00424 CLC   PCRTYP(2,PCRADDR),@CC00692                          0447 01000000
         BNE   @RF00447                                            0447 01001000
         L     @04,PCRPTR(,PCRADDR)                                0447 01002000
         LH    @03,PGNOLIN(,@04)                                   0447 01003000
         LTR   @03,@03                                             0447 01004000
         BZ    @RF00447                                            0447 01005000
*               DO;                                                0448 01006000
*                 PAGE = ''B;                                      0449 01007000
         XC    PAGE(4),PAGE                                        0449 01008000
*                 PAGE((5-PGNOLIN):4) = PGNOCIN(1:PGNOLIN);        0450 01009000
         LCR   @03,@03                                             0450 01010000
         AL    @03,@CF00268                                        0450 01011000
         LA    @01,PAGE-1(@03)                                     0450 01012000
         LCR   @03,@03                                             0450 01013000
         AL    @03,@CF00055                                        0450 01014000
         EX    @03,@SM00724                                        0450 01015000
*GEN     (PACK  PACKWD,PAGE);                                      0451 01016000
         PACK  PACKWD,PAGE                                              01017000
*GEN     (CVB   CVDREG,PACKWD);                                    0452 01018000
         CVB   CVDREG,PACKWD                                            01019000
*                 P04CPN = CVDREG - 1;                             0453 01020000
         LR    @06,CVDREG                                          0453 01021000
         BCTR  @06,0                                               0453 01022000
         STH   @06,P04CPN                                          0453 01023000
*               END;                                               0454 01024000
*         END;                                                     0455 01025000
@RF00447 AL    ARGNMB,@CF00178                                     0455 01026000
@DE00386 LR    @06,LISTLN                                          0455 01027000
         SL    @06,@CF00149                                        0455 01028000
         CR    ARGNMB,@06                                          0455 01029000
         BNH   @DL00386                                            0455 01030000
*         /***********************************************************/ 01031000
*         /*                                                         */ 01032000
*         /*  CALL THE PROCEDURE TO SET THE PCT                      */ 01033000
*         /*                                                         */ 01034000
*         /***********************************************************/ 01035000
*                                                                  0456 01036000
*         CALL PCTSETUP;                                           0456 01037000
*                                                                  0456 01038000
         BAL   @14,PCTSETUP                                        0456 01039000
*         IF GDTDBG = NULLPTR                                      0457 01040000
*           THEN;                                                  0457 01041000
         L     @09,@PC00001                                        0457 01042000
         L     @09,GDTDBG(,@09)                                    0457 01043000
         LTR   @09,@09                                             0457 01044000
         BZ    @RT00457                                            0457 01045000
*           ELSE                                                   0459 01046000
*             CALL ICKDB010 (GDTTBL,'TP4R');                       0459 01047000
*                                                                  0459 01048000
         L     @09,@PC00001                                        0459 01049000
         ST    @09,@AL00001                                        0459 01050000
         LA    @06,@CC00693                                        0459 01051000
         ST    @06,@AL00001+4                                      0459 01052000
         MVI   @AL00001+4,X'80'                                    0459 01053000
         L     @15,GDTDBG(,@09)                                    0459 01054000
         LA    @01,@AL00001                                        0459 01055000
         BALR  @14,@15                                             0459 01056000
*         RETURN CODE(SAVERC);                                     0460 01057000
@RT00457 LR    @15,SAVERC                                          0460 01058000
         L     @14,@SA00005                                        0460 01059000
         LM    @00,@12,@SA00005+8                                  0460 01060000
         BR    @14                                                 0460 01061000
*         END RESTCONT;                                            0461 01062000
*         /***********************************************************/ 01063000
*         /*                                                         */ 01064000
*         /* PROCEDURE NAME - PCT SETTING PROCEDURE.                 */ 01065000
*         /*                                                         */ 01066000
*         /* FUNCTION - THIS PROCEDURE CHECKS AND SETS VALUES        */ 01067000
*         /* ENTERED AND SET INTO THE PRINT CONTROL WORK TABLE INTO  */ 01068000
*         /* THE PRINT CONTROL TABLE.                                */ 01069000
*         /*                                                         */ 01070000
*         /* INPUT - THE PRINT CONTROL WORK TABLE (P04WT).           */ 01071000
*         /*                                                         */ 01072000
*         /* OUTPUT - THE PRINT CONTROL TABLE.                       */ 01073000
*         /*                                                         */ 01074000
*         /***********************************************************/ 01075000
*                                                                  0462 01076000
*PCTSETUP: PROC;                                                   0462 01077000
*                                                                  0462 01078000
PCTSETUP STM   @14,@06,@SA00006                                    0462 01079000
         STM   @08,@12,@SA00006+36                                 0462 01080000
*         /***********************************************************/ 01081000
*         /*                                                         */ 01082000
*         /* TEST FOR PRIMARY CONTROL TABLE BUILD AND IF TRUE, BUILD */ 01083000
*         /* TABLE WITH ALL THE DEFAULTS.                            */ 01084000
*         /*                                                         */ 01085000
*         /***********************************************************/ 01086000
*                                                                  0463 01087000
*         PCTNLI = 999;                 /* FORCE A PAGE OVERFLOW.    */ 01088000
         LA    @06,999                                             0463 01089000
         STH   @06,PCTNLI(,PCTPTR)                                 0463 01090000
*         PCTANL = 999;                 /* FOR ALTERNATE FILE ALSO.  */ 01091000
         STH   @06,PCTANL(,PCTPTR)                                 0464 01092000
*         IF PRIPCT = ON                                           0465 01093000
*           THEN                                                   0465 01094000
         TM    PRIPCT,B'10000000'                                  0465 01095000
         BNO   @RF00465                                            0465 01096000
*             DO;                                                  0466 01097000
*               /*****************************************************/ 01098000
*               /*                                                   */ 01099000
*               /* GET THE STANDARD PRINT CHAIN TRANSLATE            */ 01100000
*               /* TABLE.                                            */ 01101000
*               /*                                                   */ 01102000
*               /*****************************************************/ 01103000
*                                                                  0467 01104000
*               STID(1:3) = 'TP0';                                 0467 01105000
         MVC   STID(3),@CC00691                                    0467 01106000
*               STID(4) = '02'X;                                   0468 01107000
*                                                                  0468 01108000
         MVI   STID+3,X'02'                                        0468 01109000
*               CALL ICKSACL0 (GDTTBL,'ICKTP05 ',STID,SUBPZ,PCTTRP);    01110000
*                                                                  0469 01111000
         L     @06,@PC00001                                        0469 01112000
         ST    @06,@AL00001                                        0469 01113000
         LA    @04,@CC00659                                        0469 01114000
         ST    @04,@AL00001+4                                      0469 01115000
         LA    @04,STID                                            0469 01116000
         ST    @04,@AL00001+8                                      0469 01117000
         LA    @04,SUBPZ                                           0469 01118000
         ST    @04,@AL00001+12                                     0469 01119000
         LA    @04,PCTTRP(,PCTPTR)                                 0469 01120000
         ST    @04,@AL00001+16                                     0469 01121000
         MVI   @AL00001+16,X'80'                                   0469 01122000
         L     @15,GDTCAL(,@06)                                    0469 01123000
         LA    @01,@AL00001                                        0469 01124000
         BALR  @14,@15                                             0469 01125000
*               RESPECIFY RTNREG RSTD;                             0470 01126000
*               TESTRC = RTNREG;                                   0471 01127000
         LR    TESTRC,RTNREG                                       0471 01128000
*               RESPECIFY RTNREG UNRSTD;                           0472 01129000
*               IF TESTRC ^= 0                                     0473 01130000
*                 THEN                                             0473 01131000
*                                                                  0473 01132000
         LTR   TESTRC,TESTRC                                       0473 01133000
         BZ    @RF00473                                            0473 01134000
*                   DO;                                            0474 01135000
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0475 01136000
*                     REG15 = 28;                                  0476 01137000
         LA    REG15,28                                            0476 01138000
*                     REG14 = GDTABT;                              0477 01139000
         L     @06,@PC00001                                        0477 01140000
         L     REG14,GDTABT(,@06)                                  0477 01141000
*                     REG13 = GDTABH;                              0478 01142000
         L     REG13,GDTABH(,@06)                                  0478 01143000
*                     GEN(BR    REG14);                            0479 01144000
         BR    REG14                                                    01145000
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0480 01146000
*                   END;                                           0481 01147000
*                                                                  0481 01148000
*               /*****************************************************/ 01149000
*               /*                                                   */ 01150000
*               /* INITIALIZE FIRST DATA LINE AND LAST DATA LINE.    */ 01151000
*               /*                                                   */ 01152000
*               /*****************************************************/ 01153000
*                                                                  0482 01154000
*               PCTPNI = 1;                                        0482 01155000
@RF00473 MVC   PCTPNI(2,PCTPTR),@CH00178                           0482 01156000
*               PCTFDL = 4;                                        0483 01157000
         MVC   PCTFDL(2,PCTPTR),@CH00055                           0483 01158000
*               PCTLDL = 60;                                       0484 01159000
         MVC   PCTLDL(2,PCTPTR),@CH00699                           0484 01160000
*             END;                                                 0485 01161000
*         /***********************************************************/ 01162000
*         /*                                                         */ 01163000
*         /* BEGIN TO VERIFY AND SET THE PRINT CONTROL TABLE ENTRIES */ 01164000
*         /* ENTERED WITH THIS REQUEST.                              */ 01165000
*         /*                                                         */ 01166000
*         /***********************************************************/ 01167000
*                                                                  0486 01168000
*         /***********************************************************/ 01169000
*         /*                                                         */ 01170000
*         /* SET UP A TRANSLATE TABLE ENTERED WITH THIS REQUEST.     */ 01171000
*         /*                                                         */ 01172000
*         /***********************************************************/ 01173000
*                                                                  0486 01174000
*         IF P04PCP ^= 0                                           0486 01175000
*           THEN                                                   0486 01176000
@RF00465 L     @06,P04PCP                                          0486 01177000
         LTR   @06,@06                                             0486 01178000
         BZ    @RF00486                                            0486 01179000
*             PCTTRP = P04PCP;                                     0487 01180000
*                                                                  0487 01181000
         ST    @06,PCTTRP(,PCTPTR)                                 0487 01182000
*         /***********************************************************/ 01183000
*         /*                                                         */ 01184000
*         /*  VERIFY AND SET CHANGES TO LINE WIDTH                   */ 01185000
*         /*                                                         */ 01186000
*         /***********************************************************/ 01187000
*                                                                  0488 01188000
*         IF P04LW > 0 & P04LW < 133                               0488 01189000
*           THEN                                                   0488 01190000
@RF00486 LH    @06,P04LW                                           0488 01191000
         LTR   @06,@06                                             0488 01192000
         BNP   @RF00488                                            0488 01193000
         C     @06,@CF00700                                        0488 01194000
         BNL   @RF00488                                            0488 01195000
*             PCTPLW = P04LW;                                      0489 01196000
         ST    @06,PCTPLW(,PCTPTR)                                 0489 01197000
*           ELSE                                                   0490 01198000
*             DO;                                                  0490 01199000
         B     @RC00488                                            0490 01200000
@RF00488 DS    0H                                                  0491 01201000
*               IF P04LW ^= 0                                      0491 01202000
*                 THEN                                             0491 01203000
         LH    @06,P04LW                                           0491 01204000
         LTR   @06,@06                                             0491 01205000
         BZ    @RF00491                                            0491 01206000
*                   SAVERC = 4;                                    0492 01207000
         LA    SAVERC,4                                            0492 01208000
*             END;                                                 0493 01209000
*                                                                  0493 01210000
@RF00491 DS    0H                                                  0494 01211000
*         /***********************************************************/ 01212000
*         /*                                                         */ 01213000
*         /* VERIFY AND SET CHANGES TO THE PAGE DEPTH.               */ 01214000
*         /*                                                         */ 01215000
*         /***********************************************************/ 01216000
*                                                                  0494 01217000
*         IF P04PD > 0                                             0494 01218000
*           THEN                                                   0494 01219000
@RC00488 LH    @06,P04PD                                           0494 01220000
         LTR   @06,@06                                             0494 01221000
         BNP   @RF00494                                            0494 01222000
*             DO;                                                  0495 01223000
*               PCTPPD = P04PD;                                    0496 01224000
         STH   @06,PCTPPD(,PCTPTR)                                 0496 01225000
*               PCTLDL = PCTPPD - OFLOSS;                          0497 01226000
         SH    @06,OFLOSS                                          0497 01227000
         STH   @06,PCTLDL(,PCTPTR)                                 0497 01228000
*             END;                                                 0498 01229000
*                                                                  0498 01230000
*         /***********************************************************/ 01231000
*         /*                                                         */ 01232000
*         /* VERIFY AND SET CHANGES TO DEFAULT SPACE CHARACTER.      */ 01233000
*         /*                                                         */ 01234000
*         /***********************************************************/ 01235000
*                                                                  0499 01236000
*         IF P04DSC > 0                                            0499 01237000
*           THEN                                                   0499 01238000
@RF00494 LH    @06,P04DSC                                          0499 01239000
         LTR   @06,@06                                             0499 01240000
         BNP   @RF00499                                            0499 01241000
*             DO;                                                  0500 01242000
*               IF P04DSC < 4                                      0501 01243000
*                 THEN                                             0501 01244000
         C     @06,@CF00055                                        0501 01245000
         BNL   @RF00501                                            0501 01246000
*                   PCTDSC = P04DSC;                               0502 01247000
         STH   @06,PCTDSC(,PCTPTR)                                 0502 01248000
*                 ELSE                                             0503 01249000
*                   SAVERC = 4;                                    0503 01250000
         B     @RC00501                                            0503 01251000
@RF00501 LA    SAVERC,4                                            0503 01252000
*             END;                                                 0504 01253000
*                                                                  0504 01254000
@RC00501 DS    0H                                                  0505 01255000
*         /***********************************************************/ 01256000
*         /*                                                         */ 01257000
*         /* VERIFY AND SET CHANGES TO CURRENT PAGE NUMBER           */ 01258000
*         /*                                                         */ 01259000
*         /***********************************************************/ 01260000
*                                                                  0505 01261000
*         IF P04CPN > 0                                            0505 01262000
*           THEN                                                   0505 01263000
@RF00499 LH    @06,P04CPN                                          0505 01264000
         LTR   @06,@06                                             0505 01265000
         BNP   @RF00505                                            0505 01266000
*             PCTCPN = P04CPN;                                     0506 01267000
*                                                                  0506 01268000
         STH   @06,PCTCPN(,PCTPTR)                                 0506 01269000
*         /***********************************************************/ 01270000
*         /*                                                         */ 01271000
*         /* VERIFY AND SET CHANGES TO PAGE NUMBER INCREMENT.        */ 01272000
*         /*                                                         */ 01273000
*         /***********************************************************/ 01274000
*                                                                  0507 01275000
*         IF P04PNI > 0                                            0507 01276000
*           THEN                                                   0507 01277000
@RF00505 LH    @06,P04PNI                                          0507 01278000
         LTR   @06,@06                                             0507 01279000
         BNP   @RF00507                                            0507 01280000
*             DO;                                                  0508 01281000
*               IF P04PNI > 9999                                   0509 01282000
*                 THEN                                             0509 01283000
         C     @06,@CF00701                                        0509 01284000
         BNH   @RF00509                                            0509 01285000
*                   SAVERC = 4;                                    0510 01286000
         LA    SAVERC,4                                            0510 01287000
*                 ELSE                                             0511 01288000
*                   PCTPNI = P04PNI;                               0511 01289000
         B     @RC00509                                            0511 01290000
@RF00509 LH    @06,P04PNI                                          0511 01291000
         STH   @06,PCTPNI(,PCTPTR)                                 0511 01292000
*             END;                                                 0512 01293000
*                                                                  0512 01294000
@RC00509 DS    0H                                                  0513 01295000
*         /***********************************************************/ 01296000
*         /*                                                         */ 01297000
*         /*  VERIFY AND SET CHANGES TO THE MAIN TITLE LINE          */ 01298000
*         /*                                                         */ 01299000
*         /***********************************************************/ 01300000
*                                                                  0513 01301000
*         IF P04MTP > 0                                            0513 01302000
*           THEN                                                   0513 01303000
@RF00507 L     @06,P04MTP                                          0513 01304000
         LTR   @06,@06                                             0513 01305000
         BNP   @RF00513                                            0513 01306000
*             DO;                                                  0514 01307000
*               /*****************************************************/ 01308000
*               /*                                                   */ 01309000
*               /* GET CORE FOR THE MAIN TITLE LINE.                 */ 01310000
*               /* GET POOL ZERO FOR PRIMARY CONTROL TABLE.          */ 01311000
*               /* GET POOL TP01 FOR SECONDARY CONTROL TABLE.        */ 01312000
*               /*                                                   */ 01313000
*               /*****************************************************/ 01314000
*                                                                  0515 01315000
*               IF PRIPCT = ON                                     0515 01316000
*                 THEN                                             0515 01317000
         TM    PRIPCT,B'10000000'                                  0515 01318000
         BNO   @RF00515                                            0515 01319000
*                   DO;                                            0516 01320000
*                                                                  0516 01321000
*                     CALL ICKSAGS0 (GDTTBL,STDLW,PCTMLP);         0517 01322000
*                                                                  0517 01323000
         L     @06,@PC00001                                        0517 01324000
         ST    @06,@AL00001                                        0517 01325000
         LA    @04,STDLW                                           0517 01326000
         ST    @04,@AL00001+4                                      0517 01327000
         LA    @04,PCTMLP(,PCTPTR)                                 0517 01328000
         ST    @04,@AL00001+8                                      0517 01329000
         MVI   @AL00001+8,X'80'                                    0517 01330000
         L     @15,GDTGSP(,@06)                                    0517 01331000
         LA    @01,@AL00001                                        0517 01332000
         BALR  @14,@15                                             0517 01333000
*                     RESPECIFY RTNREG RSTD;                       0518 01334000
*                     TESTRC = RTNREG;                             0519 01335000
         LR    TESTRC,RTNREG                                       0519 01336000
*                     RESPECIFY RTNREG UNRSTD;                     0520 01337000
*                     IF TESTRC ^= 0                               0521 01338000
*                       THEN                                       0521 01339000
*                                                                  0521 01340000
         LTR   TESTRC,TESTRC                                       0521 01341000
         BZ    @RF00521                                            0521 01342000
*                         DO;                                      0522 01343000
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0523 01344000
*                           REG15 = 28;                            0524 01345000
         LA    REG15,28                                            0524 01346000
*                           REG14 = GDTABT;                        0525 01347000
         L     @06,@PC00001                                        0525 01348000
         L     REG14,GDTABT(,@06)                                  0525 01349000
*                           REG13 = GDTABH;                        0526 01350000
         L     REG13,GDTABH(,@06)                                  0526 01351000
*                           GEN(BR    REG14);                      0527 01352000
         BR    REG14                                                    01353000
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0528 01354000
*                         END;                                     0529 01355000
*                   END;                                           0530 01356000
*                                                                  0530 01357000
*                 ELSE                                             0531 01358000
*                   DO;                                            0531 01359000
*                                                                  0531 01360000
         B     @RC00515                                            0531 01361000
@RF00515 DS    0H                                                  0532 01362000
*                     CALL ICKSAGP0 (GDTTBL,STDLW,PCTMLP,TPPOOL);  0532 01363000
*                                                                  0532 01364000
         L     @06,@PC00001                                        0532 01365000
         ST    @06,@AL00001                                        0532 01366000
         LA    @04,STDLW                                           0532 01367000
         ST    @04,@AL00001+4                                      0532 01368000
         LA    @04,PCTMLP(,PCTPTR)                                 0532 01369000
         ST    @04,@AL00001+8                                      0532 01370000
         LA    @04,TPPOOL                                          0532 01371000
         ST    @04,@AL00001+12                                     0532 01372000
         MVI   @AL00001+12,X'80'                                   0532 01373000
         L     @15,GDTGPL(,@06)                                    0532 01374000
         LA    @01,@AL00001                                        0532 01375000
         BALR  @14,@15                                             0532 01376000
*                     RESPECIFY RTNREG RSTD;                       0533 01377000
*                     TESTRC = RTNREG;                             0534 01378000
         LR    TESTRC,RTNREG                                       0534 01379000
*                     RESPECIFY RTNREG UNRSTD;                     0535 01380000
*                     IF TESTRC ^= 0                               0536 01381000
*                       THEN                                       0536 01382000
*                                                                  0536 01383000
         LTR   TESTRC,TESTRC                                       0536 01384000
         BZ    @RF00536                                            0536 01385000
*                         DO;                                      0537 01386000
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0538 01387000
*                           REG15 = 28;                            0539 01388000
         LA    REG15,28                                            0539 01389000
*                           REG14 = GDTABT;                        0540 01390000
         L     @06,@PC00001                                        0540 01391000
         L     REG14,GDTABT(,@06)                                  0540 01392000
*                           REG13 = GDTABH;                        0541 01393000
         L     REG13,GDTABH(,@06)                                  0541 01394000
*                           GEN(BR    REG14);                      0542 01395000
         BR    REG14                                                    01396000
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0543 01397000
*                         END;                                     0544 01398000
*                   END;                                           0545 01399000
*                                                                  0545 01400000
@RF00536 DS    0H                                                  0546 01401000
*               /*****************************************************/ 01402000
*               /*                                                   */ 01403000
*               /* MOVE THE MAIN TITLE LINE TO THE AREA              */ 01404000
*               /* OBTAINED.                                         */ 01405000
*               /*                                                   */ 01406000
*               /*****************************************************/ 01407000
*                                                                  0546 01408000
*               MTLBUFF(1:120) = MTLINBF(1:120);                   0546 01409000
@RC00515 L     @06,PCTMLP(,PCTPTR)                                 0546 01410000
         L     @04,P04MTP                                          0546 01411000
         MVC   MTLBUFF(120,@06),MTLINBF(@04)                       0546 01412000
*               MTLCC = EJECT;                                     0547 01413000
*                                                                  0547 01414000
         MVI   MTLCC(@06),C'1'                                     0547 01415000
*               /*****************************************************/ 01416000
*               /*                                                   */ 01417000
*               /* VERIFY AND SET PAGE NUMBER LOCATION CHANGES.      */ 01418000
*               /*                                                   */ 01419000
*               /*****************************************************/ 01420000
*                                                                  0548 01421000
*               IF P04PNL > 0                                      0548 01422000
*                 THEN                                             0548 01423000
         LH    @06,P04PNL                                          0548 01424000
         LTR   @06,@06                                             0548 01425000
         BNP   @RF00548                                            0548 01426000
*                   DO;                                            0549 01427000
*                     IF P04PNL < PCTPLW -4                        0550 01428000
*                       THEN                                       0550 01429000
         L     @04,PCTPLW(,PCTPTR)                                 0550 01430000
         SL    @04,@CF00055                                        0550 01431000
         CR    @06,@04                                             0550 01432000
         BNL   @RF00550                                            0550 01433000
*                         PCTPNL = P04PNL;                         0551 01434000
         STH   @06,PCTPNL(,PCTPTR)                                 0551 01435000
*                       ELSE                                       0552 01436000
*                         SAVERC = 4;                              0552 01437000
         B     @RC00550                                            0552 01438000
@RF00550 LA    SAVERC,4                                            0552 01439000
*                   END;                                           0553 01440000
*                                                                  0553 01441000
@RC00550 DS    0H                                                  0554 01442000
*               /*****************************************************/ 01443000
*               /*                                                   */ 01444000
*               /* VERIFY AND SET TIME LOCATION CHANGES.             */ 01445000
*               /*                                                   */ 01446000
*               /*****************************************************/ 01447000
*                                                                  0554 01448000
*               IF P04TL > 0                                       0554 01449000
*                 THEN                                             0554 01450000
@RF00548 LH    @06,P04TL                                           0554 01451000
         LTR   @06,@06                                             0554 01452000
         BNP   @RF00554                                            0554 01453000
*                   DO;                                            0555 01454000
*                     IF P04TL < PCTPLW - 6                        0556 01455000
*                       THEN;                                      0556 01456000
         L     @04,PCTPLW(,PCTPTR)                                 0556 01457000
         SL    @04,@CF00132                                        0556 01458000
         CR    @06,@04                                             0556 01459000
         BL    @RT00556                                            0556 01460000
*                       ELSE                                       0558 01461000
*                         SAVERC = 4;                              0558 01462000
         LA    SAVERC,4                                            0558 01463000
*                   END;                                           0559 01464000
*                                                                  0559 01465000
@RT00556 DS    0H                                                  0560 01466000
*               /*****************************************************/ 01467000
*               /*                                                   */ 01468000
*               /* VERIFY AND SET DATE LOCATION CHANGES.             */ 01469000
*               /*                                                   */ 01470000
*               /*****************************************************/ 01471000
*                                                                  0560 01472000
*               IF P04DL > 0                                       0560 01473000
*                 THEN                                             0560 01474000
@RF00554 LH    @06,P04DL                                           0560 01475000
         LTR   @06,@06                                             0560 01476000
         BNP   @RF00560                                            0560 01477000
*                   DO;                                            0561 01478000
*                     IF P04DL < PCTPLW - 6                        0562 01479000
*                       THEN;                                      0562 01480000
         L     @04,PCTPLW(,PCTPTR)                                 0562 01481000
         SL    @04,@CF00132                                        0562 01482000
         CR    @06,@04                                             0562 01483000
         BL    @RT00562                                            0562 01484000
*                       ELSE                                       0564 01485000
*                         SAVERC = 4;                              0564 01486000
         LA    SAVERC,4                                            0564 01487000
*                   END;                                           0565 01488000
*                                                                  0565 01489000
@RT00562 DS    0H                                                  0566 01490000
*               /*****************************************************/ 01491000
*               /*                                                   */ 01492000
*               /* INITIALIZE THE TIME AND DATE LOCATIONS IN THE     */ 01493000
*               /* MAIN TITLE LINE.                                  */ 01494000
*               /*                                                   */ 01495000
*               /*****************************************************/ 01496000
*                                                                  0566 01497000
*               CALL ICKSATI0 (GDTTBL,MTLBUFF(P04TL:P04TL+7),      0566 01498000
*                     MTLBUFF(P04DL:P04DL+7),FORMAT);              0566 01499000
@RF00560 L     @06,@PC00001                                        0566 01500000
         ST    @06,@AL00001                                        0566 01501000
         LH    @04,P04TL                                           0566 01502000
         L     @03,PCTMLP(,PCTPTR)                                 0566 01503000
         LA    @04,MTLBUFF-1(@04,@03)                              0566 01504000
         ST    @04,@AL00001+4                                      0566 01505000
         LH    @04,P04DL                                           0566 01506000
         LA    @04,MTLBUFF-1(@04,@03)                              0566 01507000
         ST    @04,@AL00001+8                                      0566 01508000
         LA    @04,@CC00152                                        0566 01509000
         ST    @04,@AL00001+12                                     0566 01510000
         MVI   @AL00001+12,X'80'                                   0566 01511000
         L     @15,GDTTIM(,@06)                                    0566 01512000
         LA    @01,@AL00001                                        0566 01513000
         BALR  @14,@15                                             0566 01514000
*             END;                                                 0567 01515000
*         /***********************************************************/ 01516000
*         /*                                                         */ 01517000
*         /* VERIFY AND SET SUB-TITLE LINE CHANGES.                  */ 01518000
*         /*                                                         */ 01519000
*         /***********************************************************/ 01520000
*                                                                  0568 01521000
*         IF P04STP > 0                                            0568 01522000
*           THEN                                                   0568 01523000
@RF00513 L     @06,P04STP                                          0568 01524000
         LTR   @06,@06                                             0568 01525000
         BNP   @RF00568                                            0568 01526000
*             DO;                                                  0569 01527000
*             /*******************************************************/ 01528000
*             /*                                                     */ 01529000
*             /* CHECK NUMBER OF LINES ENTERED.                      */ 01530000
*             /*                                                     */ 01531000
*             /*******************************************************/ 01532000
*                                                                  0570 01533000
*               IF P04STC < 1 | P04STC > 3                         0570 01534000
*                 THEN                                             0570 01535000
         LH    @06,P04STC                                          0570 01536000
         LTR   @06,@06                                             0570 01537000
         BNP   @RT00570                                            0570 01538000
         C     @06,@CF00149                                        0570 01539000
         BNH   @RF00570                                            0570 01540000
@RT00570 DS    0H                                                  0571 01541000
*                   SAVERC = 4;                                    0571 01542000
         LA    SAVERC,4                                            0571 01543000
*                 ELSE                                             0572 01544000
*                   DO;                                            0572 01545000
*                                                                  0572 01546000
         B     @RC00570                                            0572 01547000
@RF00570 DS    0H                                                  0573 01548000
*                   /*************************************************/ 01549000
*                   /*                                               */ 01550000
*                   /* GET CORE FOR THE NUMBER OF LINES REQUIRED.    */ 01551000
*                   /*                                               */ 01552000
*                   /*************************************************/ 01553000
*                                                                  0573 01554000
*                     SPCCNT = P04STC * STDLW;                     0573 01555000
*                                                                  0573 01556000
         L     @06,STDLW                                           0573 01557000
         MH    @06,P04STC                                          0573 01558000
         ST    @06,SPCCNT                                          0573 01559000
*                     CALL ICKSAGP0 (GDTTBL,SPCCNT,PCTSLP,TPPOOL); 0574 01560000
*                                                                  0574 01561000
         L     @06,@PC00001                                        0574 01562000
         ST    @06,@AL00001                                        0574 01563000
         LA    @04,SPCCNT                                          0574 01564000
         ST    @04,@AL00001+4                                      0574 01565000
         LA    @04,PCTSLP(,PCTPTR)                                 0574 01566000
         ST    @04,@AL00001+8                                      0574 01567000
         LA    @04,TPPOOL                                          0574 01568000
         ST    @04,@AL00001+12                                     0574 01569000
         MVI   @AL00001+12,X'80'                                   0574 01570000
         L     @15,GDTGPL(,@06)                                    0574 01571000
         LA    @01,@AL00001                                        0574 01572000
         BALR  @14,@15                                             0574 01573000
*                     RESPECIFY RTNREG RSTD;                       0575 01574000
*                     TESTRC = RTNREG;                             0576 01575000
         LR    TESTRC,RTNREG                                       0576 01576000
*                     RESPECIFY RTNREG UNRSTD;                     0577 01577000
*                     IF TESTRC ^= 0                               0578 01578000
*                       THEN                                       0578 01579000
*                                                                  0578 01580000
         LTR   TESTRC,TESTRC                                       0578 01581000
         BZ    @RF00578                                            0578 01582000
*                         DO;                                      0579 01583000
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0580 01584000
*                           REG15 = 28;                            0581 01585000
         LA    REG15,28                                            0581 01586000
*                           REG14 = GDTABT;                        0582 01587000
         L     @06,@PC00001                                        0582 01588000
         L     REG14,GDTABT(,@06)                                  0582 01589000
*                           REG13 = GDTABH;                        0583 01590000
         L     REG13,GDTABH(,@06)                                  0583 01591000
*                           GEN(BR    REG14);                      0584 01592000
         BR    REG14                                                    01593000
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0585 01594000
*                         END;                                     0586 01595000
*                                                                  0586 01596000
*                     SPCCNT = 0;                                  0587 01597000
*                                                                  0587 01598000
@RF00578 SLR   @06,@06                                             0587 01599000
         ST    @06,SPCCNT                                          0587 01600000
*                     /***********************************************/ 01601000
*                     /*                                             */ 01602000
*                     /* COMPUTE THE LINE SPACES REQUIRED FOR THE    */ 01603000
*                     /* SUB-TITLE LINES ENTERED.                    */ 01604000
*                     /*                                             */ 01605000
*                     /***********************************************/ 01606000
*                                                                  0588 01607000
*                     DO N = 1 TO P04STC BY 1;                     0588 01608000
         LA    N,1                                                 0588 01609000
         B     @DE00588                                            0588 01610000
@DL00588 DS    0H                                                  0589 01611000
*                       STLINE(N) = P04STP -> STLINE(1);           0589 01612000
         LR    @06,N                                               0589 01613000
         MH    @06,@CH00617                                        0589 01614000
         L     @04,PCTSLP(,PCTPTR)                                 0589 01615000
         ST    @06,@TF00001                                        0589 01616000
         ALR   @06,@04                                             0589 01617000
         AL    @06,@CF00726                                        0589 01618000
         L     @01,P04STP                                          0589 01619000
         MVC   STLINE(121,@06),STLINE(@01)                         0589 01620000
*                       IF STLCC(N) = SINGLE                       0590 01621000
*                         THEN                                     0590 01622000
         AL    @04,@TF00001                                        0590 01623000
         AL    @04,@CF00726                                        0590 01624000
         CLI   STLCC(@04),C' '                                     0590 01625000
         BNE   @RF00590                                            0590 01626000
*                           SPCCNT = SPCCNT + 1;                   0591 01627000
         LA    @06,1                                               0591 01628000
         AL    @06,SPCCNT                                          0591 01629000
         ST    @06,SPCCNT                                          0591 01630000
*                       IF STLCC(N) = DOUBLE                       0592 01631000
*                         THEN                                     0592 01632000
@RF00590 LR    @06,N                                               0592 01633000
         MH    @06,@CH00617                                        0592 01634000
         L     @04,PCTSLP(,PCTPTR)                                 0592 01635000
         ALR   @04,@06                                             0592 01636000
         AL    @04,@CF00726                                        0592 01637000
         CLI   STLCC(@04),C'0'                                     0592 01638000
         BNE   @RF00592                                            0592 01639000
*                           SPCCNT = SPCCNT + 2;                   0593 01640000
         LA    @06,2                                               0593 01641000
         AL    @06,SPCCNT                                          0593 01642000
         ST    @06,SPCCNT                                          0593 01643000
*                       IF STLCC(N) = TRIPLE                       0594 01644000
*                         THEN                                     0594 01645000
@RF00592 LR    @06,N                                               0594 01646000
         MH    @06,@CH00617                                        0594 01647000
         L     @04,PCTSLP(,PCTPTR)                                 0594 01648000
         ALR   @04,@06                                             0594 01649000
         AL    @04,@CF00726                                        0594 01650000
         CLI   STLCC(@04),C'-'                                     0594 01651000
         BNE   @RF00594                                            0594 01652000
*                           SPCCNT = SPCCNT + 3;                   0595 01653000
*                                                                  0595 01654000
         LA    @06,3                                               0595 01655000
         AL    @06,SPCCNT                                          0595 01656000
         ST    @06,SPCCNT                                          0595 01657000
*                       /*********************************************/ 01658000
*                       /*                                           */ 01659000
*                       /* CHECK TO ASSURE THAT THE SPACING CHAR IS  */ 01660000
*                       /* VALID AND IF NOT, SET DOUBLE SPACE.       */ 01661000
*                       /*                                           */ 01662000
*                       /*********************************************/ 01663000
*                                                                  0596 01664000
*                       IF STLCC(N) ^= SINGLE                      0596 01665000
*                         & STLCC(N) ^= DOUBLE                     0596 01666000
*                         & STLCC(N) ^= TRIPLE                     0596 01667000
*                         THEN                                     0596 01668000
@RF00594 LR    @06,N                                               0596 01669000
         MH    @06,@CH00617                                        0596 01670000
         L     @04,PCTSLP(,PCTPTR)                                 0596 01671000
         ST    @06,@TF00001                                        0596 01672000
         ALR   @06,@04                                             0596 01673000
         AL    @06,@CF00726                                        0596 01674000
         CLI   STLCC(@06),C' '                                     0596 01675000
         BE    @RF00596                                            0596 01676000
         LR    @06,@04                                             0596 01677000
         AL    @06,@TF00001                                        0596 01678000
         AL    @06,@CF00726                                        0596 01679000
         CLI   STLCC(@06),C'0'                                     0596 01680000
         BE    @RF00596                                            0596 01681000
         LR    @06,@04                                             0596 01682000
         AL    @06,@TF00001                                        0596 01683000
         AL    @06,@CF00726                                        0596 01684000
         CLI   STLCC(@06),C'-'                                     0596 01685000
         BE    @RF00596                                            0596 01686000
*                           DO;                                    0597 01687000
*                             STLCC(N) = DOUBLE;                   0598 01688000
         AL    @04,@TF00001                                        0598 01689000
         AL    @04,@CF00726                                        0598 01690000
         MVI   STLCC(@04),C'0'                                     0598 01691000
*                             SPCCNT = SPCCNT + 2;                 0599 01692000
         LA    @06,2                                               0599 01693000
         AL    @06,SPCCNT                                          0599 01694000
         ST    @06,SPCCNT                                          0599 01695000
*                           END;                                   0600 01696000
*                       P04STP = P04STP + STDLW;                   0601 01697000
@RF00596 L     @06,P04STP                                          0601 01698000
         AL    @06,STDLW                                           0601 01699000
         ST    @06,P04STP                                          0601 01700000
*                     END;                                         0602 01701000
         AL    N,@CF00178                                          0602 01702000
@DE00588 CH    N,P04STC                                            0602 01703000
         BNH   @DL00588                                            0602 01704000
*                     PCTSLC = P04STC;                             0603 01705000
*                                                                  0603 01706000
         LH    @06,P04STC                                          0603 01707000
         STH   @06,PCTSLC(,PCTPTR)                                 0603 01708000
*                     /***********************************************/ 01709000
*                     /*                                             */ 01710000
*                     /* MOVE THE FIRST DATA LINE DOWN BY THE SPACE  */ 01711000
*                     /* TAKEN BY THE SUB-TITLE LINES.               */ 01712000
*                     /*                                             */ 01713000
*                     /***********************************************/ 01714000
*                                                                  0604 01715000
*                     PCTFDL = PCTFDL + SPCCNT + 2;                0604 01716000
         LH    @06,PCTFDL(,PCTPTR)                                 0604 01717000
         AL    @06,SPCCNT                                          0604 01718000
         AL    @06,@CF00129                                        0604 01719000
         STH   @06,PCTFDL(,PCTPTR)                                 0604 01720000
*                   END;                                           0605 01721000
*             END;                                                 0606 01722000
*                                                                  0606 01723000
@RC00570 DS    0H                                                  0607 01724000
*         /***********************************************************/ 01725000
*         /*                                                         */ 01726000
*         /* VERIFY AND SET FOOTING LINE CHANGES.                    */ 01727000
*         /*                                                         */ 01728000
*         /***********************************************************/ 01729000
*                                                                  0607 01730000
*         IF P04FP > 0                                             0607 01731000
*           THEN                                                   0607 01732000
@RF00568 L     @06,P04FP                                           0607 01733000
         LTR   @06,@06                                             0607 01734000
         BNP   @RF00607                                            0607 01735000
*             DO;                                                  0608 01736000
*                                                                  0608 01737000
*             /*******************************************************/ 01738000
*             /*                                                     */ 01739000
*             /* ASSURE THE FOOTING LINE COUNT IS VALID.             */ 01740000
*             /*                                                     */ 01741000
*             /*******************************************************/ 01742000
*                                                                  0609 01743000
*               IF P04FC < 1 | P04FC > 3                           0609 01744000
*                 THEN                                             0609 01745000
         LH    @06,P04FC                                           0609 01746000
         LTR   @06,@06                                             0609 01747000
         BNP   @RT00609                                            0609 01748000
         C     @06,@CF00149                                        0609 01749000
         BNH   @RF00609                                            0609 01750000
@RT00609 DS    0H                                                  0610 01751000
*                   SAVERC = 4;                                    0610 01752000
         LA    SAVERC,4                                            0610 01753000
*                 ELSE                                             0611 01754000
*                   DO;                                            0611 01755000
*                                                                  0611 01756000
         B     @RC00609                                            0611 01757000
@RF00609 DS    0H                                                  0612 01758000
*                   /*************************************************/ 01759000
*                   /*                                               */ 01760000
*                   /* GET CORE FOR THE FOOTING LINES ENTERED.       */ 01761000
*                   /*                                               */ 01762000
*                   /*************************************************/ 01763000
*                                                                  0612 01764000
*                     SPCCNT = P04FC * STDLW;                      0612 01765000
         LH    @06,P04FC                                           0612 01766000
         LR    @01,@06                                             0612 01767000
         M     @00,STDLW                                           0612 01768000
         ST    @01,SPCCNT                                          0612 01769000
*                     PCTFLC = P04FC;                              0613 01770000
*                                                                  0613 01771000
         STH   @06,PCTFLC(,PCTPTR)                                 0613 01772000
*                     CALL ICKSAGP0 (GDTTBL,SPCCNT,PCTFLP,TPPOOL); 0614 01773000
*                                                                  0614 01774000
         L     @06,@PC00001                                        0614 01775000
         ST    @06,@AL00001                                        0614 01776000
         LA    @04,SPCCNT                                          0614 01777000
         ST    @04,@AL00001+4                                      0614 01778000
         LA    @04,PCTFLP(,PCTPTR)                                 0614 01779000
         ST    @04,@AL00001+8                                      0614 01780000
         LA    @04,TPPOOL                                          0614 01781000
         ST    @04,@AL00001+12                                     0614 01782000
         MVI   @AL00001+12,X'80'                                   0614 01783000
         L     @15,GDTGPL(,@06)                                    0614 01784000
         LA    @01,@AL00001                                        0614 01785000
         BALR  @14,@15                                             0614 01786000
*                     RESPECIFY RTNREG RSTD;                       0615 01787000
*                     TESTRC = RTNREG;                             0616 01788000
         LR    TESTRC,RTNREG                                       0616 01789000
*                     RESPECIFY RTNREG UNRSTD;                     0617 01790000
*                     IF TESTRC ^= 0                               0618 01791000
*                       THEN                                       0618 01792000
*                                                                  0618 01793000
         LTR   TESTRC,TESTRC                                       0618 01794000
         BZ    @RF00618                                            0618 01795000
*                         DO;                                      0619 01796000
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0620 01797000
*                           REG15 = 28;                            0621 01798000
         LA    REG15,28                                            0621 01799000
*                           REG14 = GDTABT;                        0622 01800000
         L     @06,@PC00001                                        0622 01801000
         L     REG14,GDTABT(,@06)                                  0622 01802000
*                           REG13 = GDTABH;                        0623 01803000
         L     REG13,GDTABH(,@06)                                  0623 01804000
*                           GEN(BR    REG14);                      0624 01805000
         BR    REG14                                                    01806000
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0625 01807000
*                         END;                                     0626 01808000
*                                                                  0626 01809000
*                     SPCCNT = 0;                                  0627 01810000
*                                                                  0627 01811000
@RF00618 SLR   @06,@06                                             0627 01812000
         ST    @06,SPCCNT                                          0627 01813000
*                     /***********************************************/ 01814000
*                     /*                                             */ 01815000
*                     /* COMPUTE THE SPACE REQUIRED BY THE FOOTING   */ 01816000
*                     /* LINES.                                      */ 01817000
*                     /*                                             */ 01818000
*                     /***********************************************/ 01819000
*                                                                  0628 01820000
*                     DO N = 1 TO P04FC BY 1;                      0628 01821000
         LA    N,1                                                 0628 01822000
         B     @DE00628                                            0628 01823000
@DL00628 DS    0H                                                  0629 01824000
*                       FTLINE(N) = P04FP -> FTLINE(1);            0629 01825000
         LR    @06,N                                               0629 01826000
         MH    @06,@CH00617                                        0629 01827000
         L     @04,PCTFLP(,PCTPTR)                                 0629 01828000
         ST    @06,@TF00001                                        0629 01829000
         ALR   @06,@04                                             0629 01830000
         AL    @06,@CF00726                                        0629 01831000
         L     @01,P04FP                                           0629 01832000
         MVC   FTLINE(121,@06),FTLINE(@01)                         0629 01833000
*                       IF FTLCC(N) = SINGLE                       0630 01834000
*                         THEN                                     0630 01835000
         AL    @04,@TF00001                                        0630 01836000
         AL    @04,@CF00726                                        0630 01837000
         CLI   FTLCC(@04),C' '                                     0630 01838000
         BNE   @RF00630                                            0630 01839000
*                           SPCCNT = SPCCNT + 1;                   0631 01840000
         LA    @06,1                                               0631 01841000
         AL    @06,SPCCNT                                          0631 01842000
         ST    @06,SPCCNT                                          0631 01843000
*                       IF FTLCC(N) = DOUBLE                       0632 01844000
*                         THEN                                     0632 01845000
@RF00630 LR    @06,N                                               0632 01846000
         MH    @06,@CH00617                                        0632 01847000
         L     @04,PCTFLP(,PCTPTR)                                 0632 01848000
         ALR   @04,@06                                             0632 01849000
         AL    @04,@CF00726                                        0632 01850000
         CLI   FTLCC(@04),C'0'                                     0632 01851000
         BNE   @RF00632                                            0632 01852000
*                           SPCCNT = SPCCNT + 2;                   0633 01853000
         LA    @06,2                                               0633 01854000
         AL    @06,SPCCNT                                          0633 01855000
         ST    @06,SPCCNT                                          0633 01856000
*                       IF FTLCC(N) = TRIPLE                       0634 01857000
*                         THEN                                     0634 01858000
@RF00632 LR    @06,N                                               0634 01859000
         MH    @06,@CH00617                                        0634 01860000
         L     @04,PCTFLP(,PCTPTR)                                 0634 01861000
         ALR   @04,@06                                             0634 01862000
         AL    @04,@CF00726                                        0634 01863000
         CLI   FTLCC(@04),C'-'                                     0634 01864000
         BNE   @RF00634                                            0634 01865000
*                           SPCCNT = SPCCNT + 3;                   0635 01866000
*                                                                  0635 01867000
         LA    @06,3                                               0635 01868000
         AL    @06,SPCCNT                                          0635 01869000
         ST    @06,SPCCNT                                          0635 01870000
*                       /*********************************************/ 01871000
*                       /*                                           */ 01872000
*                       /* CHECK THE CARRIAGE CONTROL CHAR FOR       */ 01873000
*                       /* VALIDITY (1, 2 OR 3) AND IF INVALID SET   */ 01874000
*                       /* TO 1.                                     */ 01875000
*                       /*                                           */ 01876000
*                       /*********************************************/ 01877000
*                                                                  0636 01878000
*                       IF FTLCC(N) ^= SINGLE                      0636 01879000
*                         | FTLCC(N) ^= DOUBLE                     0636 01880000
*                         | FTLCC(N) ^= TRIPLE                     0636 01881000
*                           THEN                                   0636 01882000
@RF00634 LR    @06,N                                               0636 01883000
         MH    @06,@CH00617                                        0636 01884000
         L     @04,PCTFLP(,PCTPTR)                                 0636 01885000
         ST    @06,@TF00001                                        0636 01886000
         ALR   @06,@04                                             0636 01887000
         AL    @06,@CF00726                                        0636 01888000
         CLI   FTLCC(@06),C' '                                     0636 01889000
         BNE   @RT00636                                            0636 01890000
         LR    @06,@04                                             0636 01891000
         AL    @06,@TF00001                                        0636 01892000
         AL    @06,@CF00726                                        0636 01893000
         CLI   FTLCC(@06),C'0'                                     0636 01894000
         BNE   @RT00636                                            0636 01895000
         AL    @04,@TF00001                                        0636 01896000
         AL    @04,@CF00726                                        0636 01897000
         CLI   FTLCC(@04),C'-'                                     0636 01898000
         BE    @RF00636                                            0636 01899000
@RT00636 DS    0H                                                  0637 01900000
*                             DO;                                  0637 01901000
*                               FTLCC(N) = SINGLE;                 0638 01902000
         LR    @06,N                                               0638 01903000
         MH    @06,@CH00617                                        0638 01904000
         L     @04,PCTFLP(,PCTPTR)                                 0638 01905000
         ALR   @04,@06                                             0638 01906000
         AL    @04,@CF00726                                        0638 01907000
         MVI   FTLCC(@04),C' '                                     0638 01908000
*                               SPCCNT = SPCCNT + 1;               0639 01909000
         LA    @06,1                                               0639 01910000
         AL    @06,SPCCNT                                          0639 01911000
         ST    @06,SPCCNT                                          0639 01912000
*                             END;                                 0640 01913000
*                       P04FP = P04FP + STDLW;                     0641 01914000
@RF00636 L     @06,P04FP                                           0641 01915000
         AL    @06,STDLW                                           0641 01916000
         ST    @06,P04FP                                           0641 01917000
*                     END;                                         0642 01918000
*                                                                  0642 01919000
         AL    N,@CF00178                                          0642 01920000
@DE00628 CH    N,P04FC                                             0642 01921000
         BNH   @DL00628                                            0642 01922000
*                     /***********************************************/ 01923000
*                     /*                                             */ 01924000
*                     /* ADJUST THE LAST DATA LINE PER FOOTING LINE  */ 01925000
*                     /*                                             */ 01926000
*                     /***********************************************/ 01927000
*                                                                  0643 01928000
*                     PCTFLN = PCTPPD - SPCCNT - 3;                0643 01929000
         LH    @06,PCTPPD(,PCTPTR)                                 0643 01930000
         SL    @06,SPCCNT                                          0643 01931000
         SL    @06,@CF00149                                        0643 01932000
         STH   @06,PCTFLN(,PCTPTR)                                 0643 01933000
*                     PCTLDL = PCTFLN - 2;                         0644 01934000
         BCTR  @06,0                                               0644 01935000
         BCTR  @06,0                                               0644 01936000
         STH   @06,PCTLDL(,PCTPTR)                                 0644 01937000
*                   END;                                           0645 01938000
*             END;                                                 0646 01939000
*                                                                  0646 01940000
@RC00609 DS    0H                                                  0647 01941000
*         /***********************************************************/ 01942000
*         /*                                                         */ 01943000
*         /* END OF THE VERIFY AND PCT SETTING PROCEDURE.            */ 01944000
*         /* THEN RETURN TO THE CALLING PROCEDURE.                   */ 01945000
*         /*                                                         */ 01946000
*         /***********************************************************/ 01947000
*                                                                  0647 01948000
*         RETURN CODE (SAVERC);                                    0647 01949000
@RF00607 LR    @15,SAVERC                                          0647 01950000
         L     @14,@SA00006                                        0647 01951000
         LM    @00,@06,@SA00006+8                                  0647 01952000
         LM    @08,@12,@SA00006+36                                 0647 01953000
         BR    @14                                                 0647 01954000
*         END PCTSETUP;                                            0648 01955000
*                                                                  0648 01956000
*         /***********************************************************/ 01957000
*         /*                                                         */ 01958000
*         /* PROCEDURE NAME - RESET FUNCTION HANDLER.                */ 01959000
*         /*                                                         */ 01960000
*         /* FUNCTION - RESETS THE PRINT CONTROL TABLE TO THE        */ 01961000
*         /* INITIAL DEFAULT VALUES AND RELEASES ALL 'TP' POOL       */ 01962000
*         /* STORAGE.  IN ADDITION, IT RETURNS THE LAST PAGE NUMBER  */ 01963000
*         /* USED TO THE CALLING ROUTINE.                            */ 01964000
*         /*                                                         */ 01965000
*         /* INPUT - PAGE NUMBER LOCATION.                           */ 01966000
*         /*                                                         */ 01967000
*         /* OUTPUT - REVISED PRINT CONTROL TABLE.                   */ 01968000
*         /*                                                         */ 01969000
*         /***********************************************************/ 01970000
*                                                                  0649 01971000
*RESETCON: PROC (PGNOPTR);                                         0649 01972000
*                                                                  0649 01973000
RESETCON STM   @14,@12,@SA00007                                    0649 01974000
         MVC   @PC00007(4),0(@01)                                  0649 01975000
*         /***********************************************************/ 01976000
*         /*                                                         */ 01977000
*         /* THE ARGUMENT STRUCTURE PASSED WITH THE URESET MACRO FOR */ 01978000
*         /* RETURN OF THE PAGE NUMBER TO THE CALLER.                */ 01979000
*         /*                                                         */ 01980000
*         /***********************************************************/ 01981000
*                                                                  0650 01982000
*         DCL PGNOPTR PTR(31);                                     0650 01983000
*         DCL 1 PGNO BASED(PGNOPTR),                               0651 01984000
*              2 PGNOL FIXED(15),      /* LENGTH OF PAGE NUMBER.     */ 01985000
*              2 PGNOC CHAR(4);        /* CHARACTERS OF PAGE NUMBER  */ 01986000
*                                                                  0651 01987000
*         /***********************************************************/ 01988000
*         /*                                                         */ 01989000
*         /* CHECK TO ASSURE THAT A PRINT CONTROL TABLE EXISTS.      */ 01990000
*         /* IF NONE EXISTS, SOMETHING IS OUT OF SEQUENCE.           */ 01991000
*         /*                                                         */ 01992000
*         /***********************************************************/ 01993000
*                                                                  0652 01994000
*         IF GDTTPH = NULLPTR                                      0652 01995000
*           THEN                                                   0652 01996000
         L     @03,@PC00001                                        0652 01997000
         L     @15,GDTTPH(,@03)                                    0652 01998000
         LTR   @15,@15                                             0652 01999000
         BNZ   @RF00652                                            0652 02000000
*             DO;                                                  0653 02001000
*                                                                  0653 02002000
*               DO;                                                0654 02003000
*                 RESPECIFY(REG13,REG14,REG15) RSTD;               0655 02004000
*                 REG15 = 24;                                      0656 02005000
         LA    REG15,24                                            0656 02006000
*                 REG14 = GDTABT;                                  0657 02007000
         L     REG14,GDTABT(,@03)                                  0657 02008000
*                 REG13 = GDTABH;                                  0658 02009000
         L     REG13,GDTABH(,@03)                                  0658 02010000
*                 GEN(BR    REG14);                                0659 02011000
         BR    REG14                                                    02012000
*                 RESPECIFY(REG13,REG14,REG15)UNRSTD;              0660 02013000
*               END;                                               0661 02014000
*             END;                                                 0662 02015000
*                                                                  0662 02016000
*         /***********************************************************/ 02017000
*         /*                                                         */ 02018000
*         /* SET ADDRESSABILITY TO THE CURRENT PCT.                  */ 02019000
*         /*                                                         */ 02020000
*         /***********************************************************/ 02021000
*                                                                  0663 02022000
*         PCTPTR = GDTTPH;                                         0663 02023000
@RF00652 L     @06,@PC00001                                        0663 02024000
         L     PCTPTR,GDTTPH(,@06)                                 0663 02025000
*         SAVERC = 0;                                              0664 02026000
         SLR   SAVERC,SAVERC                                       0664 02027000
*         IF PCTSPP ^= NULLPTR                                     0665 02028000
*           THEN                                                   0665 02029000
         L     @04,PCTSPP(,PCTPTR)                                 0665 02030000
         LTR   @04,@04                                             0665 02031000
         BZ    @RF00665                                            0665 02032000
*             DO;                                                  0666 02033000
*               PCTPTR = PCTSPP;                                   0667 02034000
         LR    PCTPTR,@04                                          0667 02035000
*               PCTNLI = 999;                                      0668 02036000
         LA    @04,999                                             0668 02037000
         STH   @04,PCTNLI(,PCTPTR)                                 0668 02038000
*               PCTSNL = 999;                                      0669 02039000
         STH   @04,PCTSNL(,PCTPTR)                                 0669 02040000
*             END;                                                 0670 02041000
*                                                                  0670 02042000
*         /***********************************************************/ 02043000
*         /*                                                         */ 02044000
*         /* FLUSH THE STACK BUFFER BEFORE MAKING CHANGES.           */ 02045000
*         /*                                                         */ 02046000
*         /***********************************************************/ 02047000
*                                                                  0671 02048000
*         CALL STACKFL;                                            0671 02049000
*                                                                  0671 02050000
@RF00665 BAL   @14,STACKFL                                         0671 02051000
*         /***********************************************************/ 02052000
*         /*                                                         */ 02053000
*         /* CONVERT AND RETURN THE PAGE NUMBER TO THE CALLERS AREA. */ 02054000
*         /*                                                         */ 02055000
*         /***********************************************************/ 02056000
*                                                                  0672 02057000
*         IF PGNOF = ON                                            0672 02058000
*           THEN                                                   0672 02059000
         TM    PGNOF,B'01000000'                                   0672 02060000
         BNO   @RF00672                                            0672 02061000
*             DO;                                                  0673 02062000
*               CVDREG = PCTCPN;                                   0674 02063000
         LH    CVDREG,PCTCPN(,PCTPTR)                              0674 02064000
*GEN     (CVD   CVDREG,PACKWD);                                    0675 02065000
         CVD   CVDREG,PACKWD                                            02066000
*GEN     (UNPK  PAGE,PACKWD);                                      0676 02067000
*                                                                  0676 02068000
         UNPK  PAGE,PACKWD                                              02069000
*               PAGE(4) = PAGE(4) | 'F0'X;  /* TURN OFF SIGN.        */ 02070000
         OI    PAGE+3,X'F0'                                        0677 02071000
*               PGNOC(1:PGNOL) = PAGE((5-PGNOL):4);                0678 02072000
         L     @04,@PC00007                                        0678 02073000
         L     @04,PGNOPTR(,@04)                                   0678 02074000
         LH    @03,PGNOL(,@04)                                     0678 02075000
         LR    @15,@03                                             0678 02076000
         BCTR  @15,0                                               0678 02077000
         LCR   @03,@03                                             0678 02078000
         AL    @03,@CF00268                                        0678 02079000
         LA    @01,PAGE-1(@03)                                     0678 02080000
         EX    @15,@SM00727                                        0678 02081000
*             END;                                                 0679 02082000
*         GDTTPH ->PCTSTM = PCTSTM;                                0680 02083000
@RF00672 L     @04,@PC00001                                        0680 02084000
         L     @04,GDTTPH(,@04)                                    0680 02085000
         MVC   PCTSTM(8,@04),PCTSTM(PCTPTR)                        0680 02086000
*         GDTTPH ->PCTSME = PCTSME;                                0681 02087000
         L     @03,PCTSME(,PCTPTR)                                 0681 02088000
         ST    @03,PCTSME(,@04)                                    0681 02089000
*         IF PCTAPF = ON                                           0682 02090000
*           THEN                                                   0682 02091000
         TM    PCTAPF(PCTPTR),B'00001000'                          0682 02092000
         BNO   @RF00682                                            0682 02093000
*             GDTTPH->PCTACT = PCTSTD;                             0683 02094000
         MVC   PCTACT(8,@04),PCTSTD(PCTPTR)                        0683 02095000
*           ELSE                                                   0684 02096000
*             GDTTPH ->PCTACT = PCTACT;                            0684 02097000
*                                                                  0684 02098000
         B     @RC00682                                            0684 02099000
@RF00682 L     @04,@PC00001                                        0684 02100000
         L     @04,GDTTPH(,@04)                                    0684 02101000
         MVC   PCTACT(8,@04),PCTACT(PCTPTR)                        0684 02102000
*         /***********************************************************/ 02103000
*         /*                                                         */ 02104000
*         /* FREE  THE TP01 SUB-POOL AND RETURN TO THE CALLER.       */ 02105000
*         /*                                                         */ 02106000
*         /***********************************************************/ 02107000
*                                                                  0685 02108000
*         CALL ICKSAFP0 (GDTTBL,TPPOOL,ALL);                       0685 02109000
*                                                                  0685 02110000
@RC00682 MVC   @AL00001+4(8),@AL00685                              0685 02111000
         L     @04,@PC00001                                        0685 02112000
         ST    @04,@AL00001                                        0685 02113000
         L     @15,GDTFPL(,@04)                                    0685 02114000
         LA    @01,@AL00001                                        0685 02115000
         BALR  @14,@15                                             0685 02116000
*         /***********************************************************/ 02117000
*         /*                                                         */ 02118000
*         /* CLEAR THE STID AND HEADER QUEUE POINTERS.               */ 02119000
*         /*                                                         */ 02120000
*         /***********************************************************/ 02121000
*                                                                  0686 02122000
*         PCTPTR = GDTTPH;                                         0686 02123000
         L     @03,@PC00001                                        0686 02124000
         L     PCTPTR,GDTTPH(,@03)                                 0686 02125000
*         PCTSPP = NULLPTR;                                        0687 02126000
         SLR   @04,@04                                             0687 02127000
         ST    @04,PCTSPP(,PCTPTR)                                 0687 02128000
*         PCTSQP = NULLPTR;                                        0688 02129000
         ST    @04,PCTSQP(,PCTPTR)                                 0688 02130000
*         PCTAHP = NULLPTR;                                        0689 02131000
         ST    @04,PCTAHP(,PCTPTR)                                 0689 02132000
*         PCTBNL = PCTBUF;                                         0690 02133000
*                                                                  0690 02134000
         L     @03,PCTBUF(,PCTPTR)                                 0690 02135000
         ST    @03,PCTBNL(,PCTPTR)                                 0690 02136000
*         RETURN CODE(0);                                          0691 02137000
         LR    @15,@04                                             0691 02138000
         L     @14,@SA00007                                        0691 02139000
         LM    @00,@12,@SA00007+8                                  0691 02140000
         BR    @14                                                 0691 02141000
*         END RESETCON;                                            0692 02142000
*                                                                  0692 02143000
*         /*                                                         */ 02144000
*         /* PROCEDURE NAME - GET PRINT CONTROL TABLE.               */ 02145000
*         /*                                                         */ 02146000
*         /* FUNCTION - GETS CORE FOR AND INITIALIZES THE PRINT      */ 02147000
*         /* CONTROL TABLE.                                          */ 02148000
*         /*                                                         */ 02149000
*         /* INPUT - NONE.                                           */ 02150000
*         /*                                                         */ 02151000
*         /* OUTPUT - NEW UNINITIALIZED PRINT CONTROL TABLE.         */ 02152000
*         /*                                                         */ 02153000
*         /***********************************************************/ 02154000
*                                                                  0693 02155000
*INITPCT: PROC;                                                    0693 02156000
*                                                                  0693 02157000
INITPCT  STM   @14,@04,@SA00008                                    0693 02158000
         STM   @06,@12,@SA00008+28                                 0693 02159000
*         /***********************************************************/ 02160000
*         /*                                                         */ 02161000
*         /* FLUSH THE STACK BUFFER BEFORE MAKING CHANGES.           */ 02162000
*         /*                                                         */ 02163000
*         /***********************************************************/ 02164000
*                                                                  0694 02165000
*         IF GDTTPH ^= NULLPTR                                     0694 02166000
*           THEN                                                   0694 02167000
*                                                                  0694 02168000
         L     @04,@PC00001                                        0694 02169000
         L     @04,GDTTPH(,@04)                                    0694 02170000
         LTR   @04,@04                                             0694 02171000
         BZ    @RF00694                                            0694 02172000
*             CALL STACKFL;                                        0695 02173000
*                                                                  0695 02174000
         BAL   @14,STACKFL                                         0695 02175000
*         PCTPTR = GDTTPH;                                         0696 02176000
*                                                                  0696 02177000
@RF00694 L     @03,@PC00001                                        0696 02178000
         L     @03,GDTTPH(,@03)                                    0696 02179000
         LR    PCTPTR,@03                                          0696 02180000
*         /***********************************************************/ 02181000
*         /*                                                         */ 02182000
*         /* IF AN EXISTING SECONDARY TABLE EXISTS, FREE IT.         */ 02183000
*         /*                                                         */ 02184000
*         /***********************************************************/ 02185000
*                                                                  0697 02186000
*         IF GDTTPH ^= NULLPTR & PCTSPP ^= NULLPTR                 0697 02187000
*           THEN                                                   0697 02188000
         SLR   @04,@04                                             0697 02189000
         CR    @03,@04                                             0697 02190000
         BE    @RF00697                                            0697 02191000
         L     @15,PCTSPP(,PCTPTR)                                 0697 02192000
         CR    @15,@04                                             0697 02193000
         BE    @RF00697                                            0697 02194000
*             DO;                                                  0698 02195000
*               PCTPTR = PCTSPP;                                   0699 02196000
         LR    PCTPTR,@15                                          0699 02197000
*               IF GDTTPH -> PCTAPF = ON                           0700 02198000
*                 THEN                                             0700 02199000
         TM    PCTAPF(@03),B'00001000'                             0700 02200000
         BNO   @RF00700                                            0700 02201000
*                   GDTTPH->PCTACT = PCTSTD;                       0701 02202000
         MVC   PCTACT(8,@03),PCTSTD(PCTPTR)                        0701 02203000
*                 ELSE                                             0702 02204000
*                   GDTTPH->PCTACT = PCTACT;                       0702 02205000
         B     @RC00700                                            0702 02206000
@RF00700 L     @04,@PC00001                                        0702 02207000
         L     @04,GDTTPH(,@04)                                    0702 02208000
         MVC   PCTACT(8,@04),PCTACT(PCTPTR)                        0702 02209000
*               PCTPTR = GDTTPH;                                   0703 02210000
*                                                                  0703 02211000
@RC00700 L     @03,@PC00001                                        0703 02212000
         L     PCTPTR,GDTTPH(,@03)                                 0703 02213000
*               CALL ICKSAFP0 (GDTTBL,TPPOOL,ALL);                 0704 02214000
*                                                                  0704 02215000
         MVC   @AL00001+4(8),@AL00704                              0704 02216000
         ST    @03,@AL00001                                        0704 02217000
         L     @15,GDTFPL(,@03)                                    0704 02218000
         LA    @01,@AL00001                                        0704 02219000
         BALR  @14,@15                                             0704 02220000
*               GDTTPH->PCTSQP = NULLPTR;                          0705 02221000
*                                                                  0705 02222000
         L     @04,@PC00001                                        0705 02223000
         L     @04,GDTTPH(,@04)                                    0705 02224000
         SLR   @03,@03                                             0705 02225000
         ST    @03,PCTSQP(,@04)                                    0705 02226000
*             END;                                                 0706 02227000
*                                                                  0706 02228000
*             OLDERID2 = NEWERID2;                                 0707 02229000
@RF00697 L     @04,@PC00001                                        0707 02230000
         L     @03,GDTTR2(,@04)                                    0707 02231000
         MVC   @TS00001(95),NEWERID2(@03)                          0707 02232000
         MVC   OLDERID2(95,@03),@TS00001                           0707 02233000
*             NEWID2 = 'TP4G';                                     0708 02234000
*                                                                  0708 02235000
         MVC   NEWID2(4,@03),@CC00714                              0708 02236000
*         /***********************************************************/ 02237000
*         /*                                                         */ 02238000
*         /* IF REQUEST IS FOR PRIMARY PCT, GET NON POOL CORE.       */ 02239000
*         /*                                                         */ 02240000
*         /***********************************************************/ 02241000
*                                                                  0709 02242000
*         IF GDTTPH = NULLPTR                                      0709 02243000
*           THEN                                                   0709 02244000
         L     @03,GDTTPH(,@04)                                    0709 02245000
         LTR   @03,@03                                             0709 02246000
         BNZ   @RF00709                                            0709 02247000
*             DO;                                                  0710 02248000
*                                                                  0710 02249000
*               CALL ICKSAGS0 (GDTTBL,PCTLEN,GDTTPH,SETZERO);      0711 02250000
*                                                                  0711 02251000
         ST    @04,@AL00001                                        0711 02252000
         LA    @05,PCTLEN                                          0711 02253000
         ST    @05,@AL00001+4                                      0711 02254000
         LA    @05,GDTTPH(,@04)                                    0711 02255000
         ST    @05,@AL00001+8                                      0711 02256000
         LA    @05,@CC00158                                        0711 02257000
         ST    @05,@AL00001+12                                     0711 02258000
         MVI   @AL00001+12,X'80'                                   0711 02259000
         L     @15,GDTGSP(,@04)                                    0711 02260000
         LA    @01,@AL00001                                        0711 02261000
         BALR  @14,@15                                             0711 02262000
*               RESPECIFY RTNREG RSTD;                             0712 02263000
*               TESTRC = RTNREG;                                   0713 02264000
         LR    TESTRC,RTNREG                                       0713 02265000
*               RESPECIFY RTNREG UNRSTD;                           0714 02266000
*               IF TESTRC ^= 0                                     0715 02267000
*                 THEN                                             0715 02268000
*                                                                  0715 02269000
         LTR   TESTRC,TESTRC                                       0715 02270000
         BZ    @RF00715                                            0715 02271000
*                   DO;                                            0716 02272000
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0717 02273000
*                     REG15 = 28;                                  0718 02274000
         LA    REG15,28                                            0718 02275000
*                     REG14 = GDTABT;                              0719 02276000
         L     @03,@PC00001                                        0719 02277000
         L     REG14,GDTABT(,@03)                                  0719 02278000
*                     REG13 = GDTABH;                              0720 02279000
         L     REG13,GDTABH(,@03)                                  0720 02280000
*                     GEN(BR    REG14);                            0721 02281000
         BR    REG14                                                    02282000
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0722 02283000
*                   END;                                           0723 02284000
*               PCTPTR = GDTTPH;                                   0724 02285000
@RF00715 L     @03,@PC00001                                        0724 02286000
         L     PCTPTR,GDTTPH(,@03)                                 0724 02287000
*               PCTIDN = 'PCT1';                                   0725 02288000
         MVC   PCTIDN(4,PCTPTR),@CC00715                           0725 02289000
*             END;                                                 0726 02290000
*                                                                  0726 02291000
*           /*********************************************************/ 02292000
*           /*                                                       */ 02293000
*           /* IF REQUEST IS FOR SECONDARY PCT, GET TP POOL CORE.    */ 02294000
*           /*                                                       */ 02295000
*           /*********************************************************/ 02296000
*                                                                  0727 02297000
*           ELSE                                                   0727 02298000
*             DO;                                                  0727 02299000
*                                                                  0727 02300000
         B     @RC00709                                            0727 02301000
@RF00709 DS    0H                                                  0728 02302000
*               CALL ICKSAGP0 (GDTTBL,PCTLEN,PCTSPP,TPPOOL,SETZERO);    02303000
*                                                                  0728 02304000
         MVC   @AL00001+4(16),@AL00728                             0728 02305000
         L     @04,@PC00001                                        0728 02306000
         ST    @04,@AL00001                                        0728 02307000
         LA    @15,PCTSPP(,PCTPTR)                                 0728 02308000
         ST    @15,@AL00001+8                                      0728 02309000
         L     @15,GDTGPL(,@04)                                    0728 02310000
         LA    @01,@AL00001                                        0728 02311000
         BALR  @14,@15                                             0728 02312000
*               RESPECIFY RTNREG RSTD;                             0729 02313000
*               TESTRC = RTNREG;                                   0730 02314000
         LR    TESTRC,RTNREG                                       0730 02315000
*               RESPECIFY RTNREG UNRSTD;                           0731 02316000
*               IF TESTRC ^= 0                                     0732 02317000
*                 THEN                                             0732 02318000
*                                                                  0732 02319000
         LTR   TESTRC,TESTRC                                       0732 02320000
         BZ    @RF00732                                            0732 02321000
*                   DO;                                            0733 02322000
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0734 02323000
*                     REG15 = 28;                                  0735 02324000
         LA    REG15,28                                            0735 02325000
*                     REG14 = GDTABT;                              0736 02326000
         L     @04,@PC00001                                        0736 02327000
         L     REG14,GDTABT(,@04)                                  0736 02328000
*                     REG13 = GDTABH;                              0737 02329000
         L     REG13,GDTABH(,@04)                                  0737 02330000
*                     GEN(BR    REG14);                            0738 02331000
         BR    REG14                                                    02332000
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0739 02333000
*                   END;                                           0740 02334000
*                                                                  0740 02335000
*               PCTPTR = PCTSPP;                                   0741 02336000
@RF00732 L     PCTPTR,PCTSPP(,PCTPTR)                              0741 02337000
*               PCTTAB = GDTTPH->PCTTAB;                           0742 02338000
         L     @04,@PC00001                                        0742 02339000
         L     @04,GDTTPH(,@04)                                    0742 02340000
         MVC   PCTTAB(112,PCTPTR),PCTTAB(@04)                      0742 02341000
*               PCTSPP = NULLPTR;                                  0743 02342000
         SLR   @04,@04                                             0743 02343000
         ST    @04,PCTSPP(,PCTPTR)                                 0743 02344000
*               PCTSQP = NULLPTR;                                  0744 02345000
         ST    @04,PCTSQP(,PCTPTR)                                 0744 02346000
*               PCTAHP = NULLPTR;                                  0745 02347000
         ST    @04,PCTAHP(,PCTPTR)                                 0745 02348000
*               PCTIDN = 'PCT2';                                   0746 02349000
         MVC   PCTIDN(4,PCTPTR),@CC00716                           0746 02350000
*             END;                                                 0747 02351000
*         END INITPCT;                                             0748 02352000
@EL00008 DS    0H                                                  0748 02353000
@EF00008 DS    0H                                                  0748 02354000
@ER00008 LM    @14,@04,@SA00008                                    0748 02355000
         LM    @06,@12,@SA00008+28                                 0748 02356000
         BR    @14                                                 0748 02357000
*         /***********************************************************/ 02358000
*         /*                                                         */ 02359000
*         /* PROCEDURE NAME - PRINT STACK BUFFER FLUSHING.           */ 02360000
*         /*                                                         */ 02361000
*         /* FUNCTION - CLEARS OUT ANY LINES THAT MAY HAVE BEEN LEFT */ 02362000
*         /* IN THE STACK BUFFER BY PREVIOUS OPERATIONS BY PUTTING   */ 02363000
*         /* THEM TO THE IO ADAPTOR.                                 */ 02364000
*         /*                                                         */ 02365000
*         /* INPUT - PRINT CONTROL TABLE & STACK BUFFER.             */ 02366000
*         /*                                                         */ 02367000
*         /* OUTPUT - PRINTED LINES TO SYSPRINT.                     */ 02368000
*         /*                                                         */ 02369000
*         /***********************************************************/ 02370000
*                                                                  0749 02371000
*STACKFL: PROC;                                                    0749 02372000
*                                                                  0749 02373000
STACKFL  STM   @14,@12,@SA00009                                    0749 02374000
*         IF PCTLNM = 0                                            0750 02375000
*           THEN                                                   0750 02376000
         SLR   @04,@04                                             0750 02377000
         CH    @04,PCTLNM(,PCTPTR)                                 0750 02378000
         BNE   @RF00750                                            0750 02379000
*             RETURN CODE(0);                                      0751 02380000
*                                                                  0751 02381000
         LR    @15,@04                                             0751 02382000
         L     @14,@SA00009                                        0751 02383000
         LM    @00,@12,@SA00009+8                                  0751 02384000
         BR    @14                                                 0751 02385000
*         IOCSPTR = PCTIOC;             /* SET IOCS ADDRESSABILITY   */ 02386000
@RF00750 L     IOCSPTR,PCTIOC(,PCTPTR)                             0752 02387000
*         IOCDLN = PCTBNL - PCTBUF;     /* SET DATA LENGTH.          */ 02388000
         L     @04,PCTBUF(,PCTPTR)                                 0753 02389000
         L     @15,PCTBNL(,PCTPTR)                                 0753 02390000
         SLR   @15,@04                                             0753 02391000
         ST    @15,IOCDLN(,IOCSPTR)                                0753 02392000
*         IOCDAD = PCTBUF;              /* SET DATA ADDRESS.         */ 02393000
         ST    @04,IOCDAD(,IOCSPTR)                                0754 02394000
*         IOCPNM = PCTLNM;              /* SET LINE COUNT.           */ 02395000
*                                                                  0755 02396000
         LH    @04,PCTLNM(,PCTPTR)                                 0755 02397000
         STH   @04,IOCPNM(,IOCSPTR)                                0755 02398000
*         CALL ICKIOPT0 (GDTTBL,PCTIOC,NULLPMN);                   0756 02399000
*                                                                  0756 02400000
         L     @04,@PC00001                                        0756 02401000
         ST    @04,@AL00001                                        0756 02402000
         LA    @15,PCTIOC(,PCTPTR)                                 0756 02403000
         ST    @15,@AL00001+4                                      0756 02404000
         LA    @15,NULLPMN                                         0756 02405000
         ST    @15,@AL00001+8                                      0756 02406000
         MVI   @AL00001+8,X'80'                                    0756 02407000
         L     @15,GDTPUT(,@04)                                    0756 02408000
         LA    @01,@AL00001                                        0756 02409000
         BALR  @14,@15                                             0756 02410000
*         RESPECIFY RTNREG RSTD;                                   0757 02411000
*         TESTRC = RTNREG;                                         0758 02412000
         LR    TESTRC,RTNREG                                       0758 02413000
*         RESPECIFY RTNREG UNRSTD;                                 0759 02414000
*         IF TESTRC ^= 0                                           0760 02415000
*           THEN                                                   0760 02416000
*                                                                  0760 02417000
         LTR   TESTRC,TESTRC                                       0760 02418000
         BZ    @RF00760                                            0760 02419000
*             DO;                                                  0761 02420000
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 0762 02421000
*               REG15 = 28;                                        0763 02422000
         LA    REG15,28                                            0763 02423000
*               REG14 = GDTABT;                                    0764 02424000
         L     @04,@PC00001                                        0764 02425000
         L     REG14,GDTABT(,@04)                                  0764 02426000
*               REG13 = GDTABH;                                    0765 02427000
         L     REG13,GDTABH(,@04)                                  0765 02428000
*               GEN(BR    REG14);                                  0766 02429000
         BR    REG14                                                    02430000
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                0767 02431000
*             END;                                                 0768 02432000
*                                                                  0768 02433000
*         GDTTPH->PCTLNM = NULLPTR;                                0769 02434000
@RF00760 SLR   @04,@04                                             0769 02435000
         L     @03,@PC00001                                        0769 02436000
         L     @03,GDTTPH(,@03)                                    0769 02437000
         STH   @04,PCTLNM(,@03)                                    0769 02438000
*         GDTTPH->PCTBNL = PCTBUF;                                 0770 02439000
         L     @15,PCTBUF(,PCTPTR)                                 0770 02440000
         ST    @15,PCTBNL(,@03)                                    0770 02441000
*         PCTLNM = NULLPTR;                                        0771 02442000
         STH   @04,PCTLNM(,PCTPTR)                                 0771 02443000
*         PCTBNL = PCTBUF;                                         0772 02444000
*                                                                  0772 02445000
         ST    @15,PCTBNL(,PCTPTR)                                 0772 02446000
*         END STACKFL;                                             0773 02447000
*                                                                  0773 02448000
@EL00009 DS    0H                                                  0773 02449000
@EF00009 DS    0H                                                  0773 02450000
@ER00009 LM    @14,@12,@SA00009                                    0773 02451000
         BR    @14                                                 0773 02452000
*         /***********************************************************/ 02453000
*         /*                                                         */ 02454000
*         /* END OF THE PAGE CONTROL MAJOR PROCEDURE.                */ 02455000
*         /*                                                         */ 02456000
*         /***********************************************************/ 02457000
*                                                                  0774 02458000
*         END ICKTP04                                              0774 02459000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02460000
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        * 02461000
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        * 02462000
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        * 02463000
*/*%INCLUDE SYSLIB  (DMSDF07 )                                        * 02464000
*;                                                                 0774 02465000
@DATA    DS    0H                                                       02466000
@CH00699 DC    H'60'                                                    02467000
@CH00619 DC    H'66'                                                    02468000
@CH00617 DC    H'121'                                                   02469000
@CH00685 DC    H'-1'                                                    02470000
@SM00724 MVC   0(0,@01),PGNOCIN(@04)                                    02471000
@SM00727 MVC   PGNOC(0,@04),0(@01)                                      02472000
         DS    0F                                                       02473000
@AL00685 EQU   *                       LIST WITH   2 ARGUMENT(S)        02474000
@AL00704 DC    A(TPPOOL)               LIST WITH   2 ARGUMENT(S)        02475000
         DC    AL1(X'80')                                               02476000
         DC    AL3(@CC00150)                                            02477000
@AL00728 DC    A(PCTLEN)               LIST WITH   4 ARGUMENT(S)        02478000
         DS    F                                                        02479000
         DC    A(TPPOOL)                                                02480000
         DC    AL1(X'80')                                               02481000
         DC    AL3(@CC00158)                                            02482000
@DATD    DSECT                                                          02483000
         DS    0F                                                       02484000
@SA00001 DS    18F                                                      02485000
@PC00001 DS    10F                                                      02486000
@SA00002 DS    15F                                                      02487000
@PC00002 DS    1F                                                       02488000
@SA00003 DS    15F                                                      02489000
@PC00003 DS    1F                                                       02490000
@SA00005 DS    15F                                                      02491000
@SA00007 DS    15F                                                      02492000
@PC00007 DS    1F                                                       02493000
@SA00008 DS    14F                                                      02494000
@SA00006 DS    14F                                                      02495000
@SA00009 DS    15F                                                      02496000
@AL00001 DS    5A                                                       02497000
@TF00001 DS    F                                                        02498000
ICKTP04  CSECT                                                          02499000
         DS    0F                                                       02500000
@CF00178 DC    F'1'                                                     02501000
@CH00178 EQU   @CF00178+2                                               02502000
@CF00129 DC    F'2'                                                     02503000
@CF00149 DC    F'3'                                                     02504000
@CH00149 EQU   @CF00149+2                                               02505000
@CF00055 DC    F'4'                                                     02506000
@CH00055 EQU   @CF00055+2                                               02507000
@CF00268 DC    F'5'                                                     02508000
@CF00132 DC    F'6'                                                     02509000
@CF00198 DC    F'7'                                                     02510000
@CF00700 DC    F'133'                                                   02511000
@CF00640 DC    F'255'                                                   02512000
@CF00701 DC    F'9999'                                                  02513000
@CF00726 DC    F'-121'                                                  02514000
@DATD    DSECT                                                          02515000
         DS    0D                                                       02516000
LISTSCAN DS    A                                                        02517000
DDSTRU   DS    A                                                        02518000
FSADDR   DS    A                                                        02519000
DMPINDEX DS    A                                                        02520000
PCAADDR  DS    A                                                        02521000
SPCCNT   DS    F                                                        02522000
LISTPTR  DS    A                                                        02523000
TEMPTR   DS    A                                                        02524000
SETRC    DS    H                                                        02525000
@TS00001 DS    CL95                                                     02526000
         DS    CL3                                                      02527000
P04WT    DS    CL42                                                     02528000
         ORG   P04WT                                                    02529000
P04MTP   DS    AL4                                                      02530000
P04STP   DS    AL4                                                      02531000
P04FP    DS    AL4                                                      02532000
P04FNP   DS    AL4                                                      02533000
P04PCP   DS    AL4                                                      02534000
P04MTC   DS    FL2                                                      02535000
P04STC   DS    FL2                                                      02536000
P04FC    DS    FL2                                                      02537000
P04LW    DS    FL2                                                      02538000
P04PD    DS    FL2                                                      02539000
P04DSC   DS    FL2                                                      02540000
P04CPN   DS    FL2                                                      02541000
P04PNI   DS    FL2                                                      02542000
P04PNL   DS    FL2                                                      02543000
P04TL    DS    FL2                                                      02544000
P04DL    DS    FL2                                                      02545000
         ORG   P04WT+42                                                 02546000
         DS    CL2                                                      02547000
PROPEN   DS    CL48                                                     02548000
P04FLG   DS    BL1                                                      02549000
         ORG   P04FLG                                                   02550000
PRIPCT   DS    BL1                                                      02551000
PGNOF    EQU   P04FLG+0                                                 02552000
         ORG   P04FLG+1                                                 02553000
STID     DS    CL4                                                      02554000
PAGE     DS    CL4                                                      02555000
         DS    CL7                                                      02556000
PACKWD   DS    CL8                                                      02557000
RESTARG  DS    7A                                                       02558000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02559000
@ENDDATD EQU   *                                                        02560000
ICKTP04  CSECT                                                          02561000
         DS    0F                                                       02562000
@SIZDATD DC    AL1(0)                                                   02563000
         DC    AL3(@ENDDATD-@DATD)                                      02564000
         DS    0D                                                       02565000
PCTLEN   DC    AL4(112)                                                 02566000
STDLW    DC    F'121'                                                   02567000
PRBUFL   DC    F'2048'                                                  02568000
SUBPZ    DC    F'0'                                                     02569000
IOPLSP   DC    F'40'                                                    02570000
TTSIZE   DC    H'256'                                                   02571000
OFLOSS   DC    H'12'                                                    02572000
NULLPMN  DC    H'0'                                                     02573000
@CC00659 DC    C'ICKTP05 '                                              02574000
@CC00152 DC    C'FORM'                                                  02575000
@CC00158 DC    C'ZERO'                                                  02576000
@CC00654 DC    C'TP4I'                                                  02577000
@CC00658 DC    C'TP4A'                                                  02578000
@CC00662 DC    C'TP4S'                                                  02579000
@CC00693 DC    C'TP4R'                                                  02580000
@CC00714 DC    C'TP4G'                                                  02581000
@CC00715 DC    C'PCT1'                                                  02582000
@CC00716 DC    C'PCT2'                                                  02583000
@CC00150 DC    C'ALL'                                                   02584000
@CC00641 DC    C'STS'                                                   02585000
@CC00643 DC    C'STA'                                                   02586000
@CC00645 DC    C'RES'                                                   02587000
@CC00647 DC    C'RST'                                                   02588000
@CC00691 DC    C'TP0'                                                   02589000
@CC00684 EQU   @CC00641                                                 02590000
@CC00686 DC    C'FT'                                                    02591000
@CC00687 DC    C'LW'                                                    02592000
@CC00688 DC    C'PD'                                                    02593000
@CC00689 DC    C'SC'                                                    02594000
@CC00690 EQU   @CC00715                                                 02595000
@CC00692 DC    C'PN'                                                    02596000
MODID    DC    CL4'TP04'                                                02597000
TPPOOL   DC    CL4'TP01'                                                02598000
DUMPID   DC    CL4'TP04'                                                02599000
FIXAREA  DS    CL220                                                    02600000
PCTAB    DC    X'C1D501'                                                02601000
         DC    X'C8D506'                                                02602000
         DC    X'D7D502'                                                02603000
         DC    X'D8D503'                                                02604000
         DC    X'D9D507'                                                02605000
         DC    X'E2D504'                                                02606000
         DC    X'E3D505'                                                02607000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02608000
@01      EQU   01                                                       02609000
@02      EQU   02                                                       02610000
@03      EQU   03                                                       02611000
@04      EQU   04                                                       02612000
@05      EQU   05                                                       02613000
@06      EQU   06                                                       02614000
@07      EQU   07                                                       02615000
@08      EQU   08                                                       02616000
@09      EQU   09                                                       02617000
@10      EQU   10                                                       02618000
@11      EQU   11                                                       02619000
@12      EQU   12                                                       02620000
@13      EQU   13                                                       02621000
@14      EQU   14                                                       02622000
@15      EQU   15                                                       02623000
N        EQU   @03                                                      02624000
ARGNMB   EQU   @09                                                      02625000
SAVERC   EQU   @07                                                      02626000
PCRADDR  EQU   @06                                                      02627000
PCTPTR   EQU   @05                                                      02628000
OPNPTR   EQU   @03                                                      02629000
IOCSPTR  EQU   @03                                                      02630000
TESTRC   EQU   @03                                                      02631000
LISTLN   EQU   @08                                                      02632000
RTNREG   EQU   @15                                                      02633000
REG13    EQU   @13                                                      02634000
REG14    EQU   @14                                                      02635000
REG15    EQU   @15                                                      02636000
CVDREG   EQU   @02                                                      02637000
REG0     EQU   @00                                                      02638000
REG1     EQU   @01                                                      02639000
REG10    EQU   @10                                                      02640000
REG11    EQU   @11                                                      02641000
REG12    EQU   @12                                                      02642000
REG2     EQU   @02                                                      02643000
REG3     EQU   @03                                                      02644000
REG4     EQU   @04                                                      02645000
REG5     EQU   @05                                                      02646000
REG6     EQU   @06                                                      02647000
REG7     EQU   @07                                                      02648000
REG8     EQU   @08                                                      02649000
REG9     EQU   @09                                                      02650000
ICKSACL0 EQU   0                                                        02651000
ICKSALD0 EQU   0                                                        02652000
ICKSAEP0 EQU   0                                                        02653000
ICKSAGS0 EQU   0                                                        02654000
ICKSAFS0 EQU   0                                                        02655000
ICKSAGP0 EQU   0                                                        02656000
ICKSAFP0 EQU   0                                                        02657000
ICKSATI0 EQU   0                                                        02658000
TRACE1   EQU   0                                                        02659000
OLDERID1 EQU   TRACE1                                                   02660000
TRACE2   EQU   0                                                        02661000
OLDERID2 EQU   TRACE2                                                   02662000
NEWID2   EQU   TRACE2+95                                                02663000
NEWERID2 EQU   5                                                        02664000
STAEPARM EQU   0                                                        02665000
STAEPFX  EQU   STAEPARM                                                 02666000
LISTTEST EQU   0                                                        02667000
ICKIOOP0 EQU   0                                                        02668000
ICKIOPT0 EQU   0                                                        02669000
IOCSTR   EQU   0                                                        02670000
IOCDAD   EQU   IOCSTR                                                   02671000
IOCDLN   EQU   IOCSTR+4                                                 02672000
IOCDSO   EQU   IOCSTR+13                                                02673000
IOCRFM   EQU   IOCSTR+14                                                02674000
IOCMAC   EQU   IOCSTR+15                                                02675000
IOCMSG   EQU   IOCSTR+16                                                02676000
IOCPNM   EQU   IOCSTR+28                                                02677000
OPNAGL   EQU   0                                                        02678000
OPNOPT   EQU   OPNAGL                                                   02679000
OPNRFM   EQU   OPNAGL+1                                                 02680000
OPNTYP   EQU   OPNAGL+2                                                 02681000
OPNTYPSO EQU   OPNTYP                                                   02682000
OPNMOD   EQU   OPNAGL+3                                                 02683000
OPNMODAC EQU   OPNMOD                                                   02684000
OPNIOC   EQU   OPNAGL+4                                                 02685000
UVOLLIST EQU   0                                                        02686000
UVOLENT  EQU   UVOLLIST+2                                               02687000
DARGLIST EQU   0                                                        02688000
DARGSTID EQU   DARGLIST+8                                               02689000
DARGARY  EQU   DARGLIST+20                                              02690000
DARGINS  EQU   DARGARY                                                  02691000
DARGINL  EQU   DARGARY+2                                                02692000
FMTLIST  EQU   0                                                        02693000
FMTFLGS  EQU   FMTLIST                                                  02694000
FMTSPF   EQU   FMTLIST+2                                                02695000
FMTRFNO  EQU   FMTSPF                                                   02696000
FMTILEN  EQU   FMTRFNO                                                  02697000
FMTIOFF  EQU   FMTLIST+4                                                02698000
FMTTRBC  EQU   FMTIOFF                                                  02699000
FMTSTO   EQU   FMTTRBC                                                  02700000
FMTOCOL  EQU   FMTLIST+6                                                02701000
FMTCNVF  EQU   FMTLIST+10                                               02702000
ICKDB010 EQU   0                                                        02703000
DMPITM   EQU   0                                                        02704000
DMPARY   EQU   0                                                        02705000
PCTTAB   EQU   0                                                        02706000
PCTIDN   EQU   PCTTAB                                                   02707000
PCTFLG   EQU   PCTTAB+4                                                 02708000
PCTAPF   EQU   PCTFLG                                                   02709000
PCTSPP   EQU   PCTTAB+8                                                 02710000
PCTACT   EQU   PCTTAB+12                                                02711000
PCTIOC   EQU   PCTACT                                                   02712000
PCTAPL   EQU   PCTACT+4                                                 02713000
PCTCPN   EQU   PCTAPL                                                   02714000
PCTNLI   EQU   PCTAPL+2                                                 02715000
PCTSTD   EQU   PCTTAB+20                                                02716000
PCTSPL   EQU   PCTSTD+4                                                 02717000
PCTSNL   EQU   PCTSPL+2                                                 02718000
PCTALT   EQU   PCTTAB+28                                                02719000
PCTLPL   EQU   PCTALT+4                                                 02720000
PCTANL   EQU   PCTLPL+2                                                 02721000
PCTSTM   EQU   PCTTAB+36                                                02722000
PCTSME   EQU   PCTTAB+44                                                02723000
PCTSQP   EQU   PCTTAB+48                                                02724000
PCTAHP   EQU   PCTTAB+52                                                02725000
PCTMLP   EQU   PCTTAB+56                                                02726000
PCTSLP   EQU   PCTTAB+60                                                02727000
PCTTRP   EQU   PCTTAB+64                                                02728000
PCTPLW   EQU   PCTTAB+68                                                02729000
PCTSLC   EQU   PCTTAB+74                                                02730000
PCTFLP   EQU   PCTTAB+76                                                02731000
PCTFLC   EQU   PCTTAB+80                                                02732000
PCTPNL   EQU   PCTTAB+84                                                02733000
PCTPPD   EQU   PCTTAB+90                                                02734000
PCTDSC   EQU   PCTTAB+92                                                02735000
PCTPNI   EQU   PCTTAB+94                                                02736000
PCTFDL   EQU   PCTTAB+96                                                02737000
PCTLDL   EQU   PCTTAB+98                                                02738000
PCTFLN   EQU   PCTTAB+100                                               02739000
PCTLNM   EQU   PCTTAB+102                                               02740000
PCTBUF   EQU   PCTTAB+104                                               02741000
PCTBNL   EQU   PCTTAB+108                                               02742000
MTLINE   EQU   0                                                        02743000
MTLCC    EQU   MTLINE                                                   02744000
MTLBUFF  EQU   MTLINE+1                                                 02745000
MTINL    EQU   0                                                        02746000
MTLINBF  EQU   MTINL+1                                                  02747000
STLINE   EQU   0                                                        02748000
STLCC    EQU   STLINE                                                   02749000
FTLINE   EQU   0                                                        02750000
FTLCC    EQU   FTLINE                                                   02751000
PCA      EQU   0                                                        02752000
PCMTLP   EQU   PCA                                                      02753000
PCSTLP   EQU   PCA+4                                                    02754000
PCFLP    EQU   PCA+8                                                    02755000
PCPCP    EQU   PCA+12                                                   02756000
PCPNL    EQU   PCA+16                                                   02757000
PCPTL    EQU   PCA+18                                                   02758000
PCPDL    EQU   PCA+20                                                   02759000
PCMTLC   EQU   PCA+22                                                   02760000
PCSTLC   EQU   PCA+24                                                   02761000
PCFLC    EQU   PCA+26                                                   02762000
PCLW     EQU   PCA+28                                                   02763000
PCPD     EQU   PCA+30                                                   02764000
PCDSC    EQU   PCA+32                                                   02765000
PCR      EQU   0                                                        02766000
PCRTYP   EQU   PCR                                                      02767000
PCRLC    EQU   PCR+2                                                    02768000
PCRPTR   EQU   PCR+4                                                    02769000
TTDSN    EQU   0                                                        02770000
PGNOIN   EQU   0                                                        02771000
PGNOLIN  EQU   PGNOIN                                                   02772000
PGNOCIN  EQU   PGNOIN+2                                                 02773000
PGNO     EQU   0                                                        02774000
PGNOL    EQU   PGNO                                                     02775000
PGNOC    EQU   PGNO+2                                                   02776000
DMPTRM   EQU   0                                                        02777000
ICKDVCL0 EQU   0                                                        02778000
ICKDVIN0 EQU   0                                                        02779000
ICKDVON0 EQU   0                                                        02780000
ICKDVOP0 EQU   0                                                        02781000
ICKIOCL0 EQU   0                                                        02782000
ICKIOGT0 EQU   0                                                        02783000
ICKIOIT0 EQU   0                                                        02784000
ICKIOTM0 EQU   0                                                        02785000
ICKSADE0 EQU   0                                                        02786000
ICKSAPR0 EQU   0                                                        02787000
ICKSASC0 EQU   0                                                        02788000
ICKSASN0 EQU   0                                                        02789000
ICKSAST0 EQU   0                                                        02790000
ICKSAVC0 EQU   0                                                        02791000
ICKSAWO0 EQU   0                                                        02792000
ICKTPEA0 EQU   0                                                        02793000
ICKTPES0 EQU   0                                                        02794000
ICKTPPR0 EQU   0                                                        02795000
ICKTPRE0 EQU   0                                                        02796000
ICKTPRS0 EQU   0                                                        02797000
NEWERID1 EQU   5                                                        02798000
TRANTAB  EQU   0                                                        02799000
GDTTBL   EQU   0                                                        02800000
GDTTR1   EQU   GDTTBL+8                                                 02801000
GDTTR2   EQU   GDTTBL+12                                                02802000
GDTTPH   EQU   GDTTBL+28                                                02803000
GDTDIN   EQU   GDTTBL+44                                                02804000
GDTDOP   EQU   GDTTBL+48                                                02805000
GDTDBG   EQU   GDTTBL+52                                                02806000
GDTDVO   EQU   GDTTBL+56                                                02807000
GDTPRT   EQU   GDTTBL+60                                                02808000
GDTESS   EQU   GDTTBL+64                                                02809000
GDTESA   EQU   GDTTBL+68                                                02810000
GDTRST   EQU   GDTTBL+72                                                02811000
GDTRES   EQU   GDTTBL+76                                                02812000
GDTCAL   EQU   GDTTBL+80                                                02813000
GDTGSP   EQU   GDTTBL+84                                                02814000
GDTFSP   EQU   GDTTBL+88                                                02815000
GDTGPL   EQU   GDTTBL+92                                                02816000
GDTFPL   EQU   GDTTBL+96                                                02817000
GDTLOD   EQU   GDTTBL+100                                               02818000
GDTDEL   EQU   GDTTBL+104                                               02819000
GDTPRL   EQU   GDTTBL+108                                               02820000
GDTEPL   EQU   GDTTBL+112                                               02821000
GDTTIM   EQU   GDTTBL+116                                               02822000
GDTIIO   EQU   GDTTBL+120                                               02823000
GDTTIO   EQU   GDTTBL+124                                               02824000
GDTOPN   EQU   GDTTBL+136                                               02825000
GDTCLS   EQU   GDTTBL+140                                               02826000
GDTGET   EQU   GDTTBL+144                                               02827000
GDTPUT   EQU   GDTTBL+148                                               02828000
GDTABT   EQU   GDTTBL+152                                               02829000
GDTABH   EQU   GDTTBL+156                                               02830000
GDTSNP   EQU   GDTTBL+160                                               02831000
GDTWTO   EQU   GDTTBL+168                                               02832000
GDTSCR   EQU   GDTTBL+172                                               02833000
GDTVCK   EQU   GDTTBL+176                                               02834000
GDTDVC   EQU   GDTTBL+180                                               02835000
GDTSTE   EQU   GDTTBL+188                                               02836000
MACARG   EQU   0                                                        02837000
FILENAME EQU   0                                                        02838000
ARG1     EQU   0                                                        02839000
ARG2     EQU   0                                                        02840000
ARG3     EQU   0                                                        02841000
ARG4     EQU   0                                                        02842000
ARG5     EQU   0                                                        02843000
ARG6     EQU   0                                                        02844000
ARG7     EQU   0                                                        02845000
STIDS    EQU   0                                                        02846000
PCALIST  EQU   0                                                        02847000
PGNOPTR  EQU   0                                                        02848000
PCRLCC   EQU   PCRLC                                                    02849000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02850000
GDTCVR   EQU   GDTTBL+184                                               02851000
GDTSPR   EQU   GDTTBL+164                                               02852000
GDTTOH   EQU   GDTTBL+132                                               02853000
GDTRIP   EQU   GDTTBL+128                                               02854000
GDTDVH   EQU   GDTTBL+40                                                02855000
GDTIOH   EQU   GDTTBL+36                                                02856000
GDTSAH   EQU   GDTTBL+32                                                02857000
GDTRIH   EQU   GDTTBL+24                                                02858000
GDTSTH   EQU   GDTTBL+20                                                02859000
GDTDBH   EQU   GDTTBL+16                                                02860000
GDTPRM   EQU   GDTTBL+4                                                 02861000
GDTHDR   EQU   GDTTBL                                                   02862000
FTBUFF   EQU   FTLINE+1                                                 02863000
STLBUFF  EQU   STLINE+1                                                 02864000
MTLINCC  EQU   MTINL                                                    02865000
PCTAPC   EQU   PCTTAB+88                                                02866000
PCTPMN   EQU   PCTTAB+86                                                02867000
PCTHSC   EQU   PCTTAB+83                                                02868000
PCTHLC   EQU   PCTTAB+82                                                02869000
PCTMLC   EQU   PCTTAB+72                                                02870000
PCTAPN   EQU   PCTLPL                                                   02871000
PCTIOP   EQU   PCTALT                                                   02872000
PCTSPN   EQU   PCTSPL                                                   02873000
PCTIOS   EQU   PCTSTD                                                   02874000
@NM00018 EQU   PCTFLG                                                   02875000
PCTLLM   EQU   PCTFLG                                                   02876000
PCTHAF   EQU   PCTFLG                                                   02877000
PCTH2F   EQU   PCTFLG                                                   02878000
PCTH1F   EQU   PCTFLG                                                   02879000
@NM00017 EQU   DMPARY+15                                                02880000
DMPARYTP EQU   DMPARY+14                                                02881000
DMPARYEX EQU   DMPARY+12                                                02882000
DMPARYIC EQU   DMPARY+10                                                02883000
DMPARYSZ EQU   DMPARY+8                                                 02884000
DMPARYNM EQU   DMPARY                                                   02885000
@NM00016 EQU   DMPITM+15                                                02886000
DMPITMTP EQU   DMPITM+14                                                02887000
DMPITMLN EQU   DMPITM+12                                                02888000
DMPITMPT EQU   DMPITM+8                                                 02889000
DMPITMNM EQU   DMPITM                                                   02890000
@NM00015 EQU   FMTCNVF+1                                                02891000
FMTBS    EQU   FMTCNVF+1                                                02892000
FMTSS    EQU   FMTCNVF+1                                                02893000
FMTAL    EQU   FMTCNVF+1                                                02894000
FMTZS    EQU   FMTCNVF+1                                                02895000
@NM00014 EQU   FMTCNVF                                                  02896000
FMTPU    EQU   FMTCNVF                                                  02897000
FMTBD    EQU   FMTCNVF                                                  02898000
FMTBHD   EQU   FMTCNVF                                                  02899000
FMTBHA   EQU   FMTCNVF                                                  02900000
FMTBH    EQU   FMTCNVF                                                  02901000
FMTOLEN  EQU   FMTLIST+8                                                02902000
FMTRIO   EQU   FMTOCOL                                                  02903000
FMTSPT   EQU   FMTSTO                                                   02904000
FMTSTL   EQU   FMTILEN                                                  02905000
@NM00013 EQU   FMTFLGS+1                                                02906000
FMTHDF   EQU   FMTFLGS                                                  02907000
FMTDFF   EQU   FMTFLGS                                                  02908000
FMTSTF   EQU   FMTFLGS                                                  02909000
FMTREPF  EQU   FMTFLGS                                                  02910000
FMTBDF   EQU   FMTFLGS                                                  02911000
FMTIDF   EQU   FMTFLGS                                                  02912000
FMTSCF   EQU   FMTFLGS                                                  02913000
FMTEOLF  EQU   FMTFLGS                                                  02914000
DARGDTM  EQU   DARGARY+4                                                02915000
DARGPCT  EQU   DARGINL                                                  02916000
DARGREP  EQU   DARGINS                                                  02917000
@NM00012 EQU   DARGLIST+19                                              02918000
DARGIND  EQU   DARGLIST+18                                              02919000
DARGRETL EQU   DARGLIST+16                                              02920000
DARGCNT  EQU   DARGLIST+14                                              02921000
DARGILP  EQU   DARGLIST+12                                              02922000
DARGSENT EQU   DARGSTID+3                                               02923000
DARGSMOD EQU   DARGSTID                                                 02924000
DARGRETP EQU   DARGLIST+4                                               02925000
DARGDBP  EQU   DARGLIST                                                 02926000
UVOLVOL  EQU   UVOLENT+4                                                02927000
UVOLDEV  EQU   UVOLENT                                                  02928000
UVOLCNT  EQU   UVOLLIST                                                 02929000
OPNRSVD  EQU   OPNAGL+28                                                02930000
OPNVOL   EQU   OPNAGL+24                                                02931000
OPNBLK   EQU   OPNAGL+20                                                02932000
OPNREC   EQU   OPNAGL+16                                                02933000
OPNDSN   EQU   OPNAGL+12                                                02934000
OPNDDN   EQU   OPNAGL+8                                                 02935000
@NM00011 EQU   OPNMOD                                                   02936000
OPNMODRC EQU   OPNMOD                                                   02937000
@NM00010 EQU   OPNTYP                                                   02938000
OPNTYPSI EQU   OPNTYP                                                   02939000
@NM00009 EQU   OPNRFM                                                   02940000
OPNRFMBK EQU   OPNRFM                                                   02941000
OPNRFMSF EQU   OPNRFM                                                   02942000
OPNRFMUN EQU   OPNRFM                                                   02943000
OPNRFMVR EQU   OPNRFM                                                   02944000
OPNRFMFX EQU   OPNRFM                                                   02945000
@NM00008 EQU   OPNOPT                                                   02946000
OPNOPTJM EQU   OPNOPT                                                   02947000
OPNOPTKS EQU   OPNOPT                                                   02948000
OPNOPTBK EQU   OPNOPT                                                   02949000
OPNOPTUP EQU   OPNOPT                                                   02950000
OPNOPTOT EQU   OPNOPT                                                   02951000
OPNOPTIN EQU   OPNOPT                                                   02952000
IOCEXT   EQU   IOCSTR+36                                                02953000
IOCRRN   EQU   IOCSTR+32                                                02954000
@NM00007 EQU   IOCSTR+30                                                02955000
IOCCBP   EQU   IOCSTR+24                                                02956000
IOCDSN   EQU   IOCSTR+20                                                02957000
@NM00006 EQU   IOCSTR+17                                                02958000
@NM00005 EQU   IOCMSG                                                   02959000
IOCMSGOP EQU   IOCMSG                                                   02960000
IOCMACPA EQU   IOCMAC                                                   02961000
@NM00004 EQU   IOCMAC                                                   02962000
IOCMACBK EQU   IOCMAC                                                   02963000
IOCMACUP EQU   IOCMAC                                                   02964000
IOCMACOT EQU   IOCMAC                                                   02965000
IOCMACIN EQU   IOCMAC                                                   02966000
@NM00003 EQU   IOCRFM                                                   02967000
IOCRFMBK EQU   IOCRFM                                                   02968000
IOCRFMSF EQU   IOCRFM                                                   02969000
IOCRFMUN EQU   IOCRFM                                                   02970000
IOCRFMVR EQU   IOCRFM                                                   02971000
IOCRFMFX EQU   IOCRFM                                                   02972000
@NM00002 EQU   IOCDSO                                                   02973000
IOCDSOPS EQU   IOCDSO                                                   02974000
IOCKYL   EQU   IOCSTR+12                                                02975000
IOCTRN   EQU   IOCSTR+8                                                 02976000
STAEWORK EQU   STAEPARM+32                                              02977000
STARPTR  EQU   STAEPFX+28                                               02978000
STASPTR  EQU   STAEPFX+24                                               02979000
STALEN   EQU   STAEPFX+20                                               02980000
STAID    EQU   STAEPFX+16                                               02981000
STAEPA   EQU   STAEPFX+12                                               02982000
STAGDT   EQU   STAEPFX+8                                                02983000
STABPTR  EQU   STAEPFX+4                                                02984000
STAFPTR  EQU   STAEPFX                                                  02985000
NEWID1   EQU   TRACE1+95                                                02986000
CALLID   EQU   OLDERID1+90                                              02987000
@NM00001 EQU   OLDERID1                                                 02988000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02989000
@RF00521 EQU   @RC00515                                                 02990000
@RC00709 EQU   @EL00008                                                 02991000
@PB00009 EQU   @EL00001                                                 02992000
@PB00008 EQU   @PB00009                                                 02993000
@PB00007 EQU   @PB00008                                                 02994000
@PB00006 EQU   @PB00007                                                 02995000
@PB00005 EQU   @PB00006                                                 02996000
@PB00004 EQU   @PB00005                                                 02997000
@PB00003 EQU   @PB00004                                                 02998000
@PB00002 EQU   @PB00003                                                 02999000
@ENDDATA EQU   *                                                        03000000
         END   ICKTP04,(C'PLS1800',0701,78192)                          03001000
