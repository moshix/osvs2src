         TITLE '**********  ICKWV01:  CREATE VOLUME TABLE OF CONTENTS  *00001000
                ********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
ICKWV01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'ICKWV01   78.192'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  DS    0H                                                  0002 00022000
         USING @PSTART,@12                                         0002 00023000
         L     @00,@SIZDATD                                        0002 00024000
         GETMAIN  R,LV=(0)                                              00025000
         LR    @11,@01                                             0002 00026000
         USING @DATD,@11                                           0002 00027000
         ST    @13,@SA00001+4                                      0002 00028000
         LM    @00,@01,20(@13)                                     0002 00029000
         ST    @11,8(,@13)                                         0002 00030000
         LR    @13,@11                                             0002 00031000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00032000
         MVC   @PC00001(28),0(@01)                                 0002 00033000
*                                                                  0180 00034000
         EJECT                                                          00035000
*                                                                  0181 00036000
*/*****  B E G I N    E X E C U T I O N  *****************************/ 00037000
*                                                                  0181 00038000
*    IF GDTDBG = NULLPTR                                           0181 00039000
*      THEN;                                                       0181 00040000
         L     @10,@PC00001                                        0181 00041000
         L     @10,GDTDBG(,@10)                                    0181 00042000
         LTR   @10,@10                                             0181 00043000
         BZ    @RT00181                                            0181 00044000
*      ELSE                                                        0183 00045000
*        CALL ICKDB010(GDTTBL                                      0183 00046000
*         ,'WV00');                                                0183 00047000
*                                                                  0183 00048000
*                                                                  0183 00049000
         L     @10,@PC00001                                        0183 00050000
         ST    @10,@AL00001                                        0183 00051000
         LA    @15,@CC00591                                        0183 00052000
         ST    @15,@AL00001+4                                      0183 00053000
         MVI   @AL00001+4,X'80'                                    0183 00054000
         L     @15,GDTDBG(,@10)                                    0183 00055000
         LA    @01,@AL00001                                        0183 00056000
         BALR  @14,@15                                             0183 00057000
*    CONDCODE = SUCCESS;                                           0184 00058000
*                                                                  0184 00059000
@RT00181 L     @10,@PC00001+24                                     0184 00060000
         SLR   @02,@02                                             0184 00061000
         ST    @02,CONDCODE(,@10)                                  0184 00062000
*/*  CHECK_VTOC_LOCATION_LEGALITY                                   */  00063000
*    CALL CHKVLOC;                                                 0185 00064000
*                                                                  0185 00065000
         BAL   @14,CHKVLOC                                         0185 00066000
*/*  IF NO ERRORS FOUND YET                                         */  00067000
*    IF CONDCODE = SUCCESS                                         0186 00068000
*                                                                  0186 00069000
*/*    THEN WRITE_FORMAT4_DSCB                                      */  00070000
*      THEN DO;    CALL WRTFMT4; END;                              0186 00071000
*                                                                  0186 00072000
         L     @10,@PC00001+24                                     0186 00073000
         L     @10,CONDCODE(,@10)                                  0186 00074000
         LTR   @10,@10                                             0186 00075000
         BNZ   @RF00186                                            0186 00076000
         BAL   @14,WRTFMT4                                         0188 00077000
*/*  IF NO ERRORS FOUND YET                                          */ 00078000
*    IF CONDCODE = SUCCESS                                         0190 00079000
*                                                                  0190 00080000
*/*    THEN WRITE_FORMAT5_DSCB                                       */ 00081000
*      THEN DO;    CALL WRTFMT5; END;                              0190 00082000
*                                                                  0190 00083000
@RF00186 L     @10,@PC00001+24                                     0190 00084000
         L     @10,CONDCODE(,@10)                                  0190 00085000
         LTR   @10,@10                                             0190 00086000
         BNZ   @RF00190                                            0190 00087000
         BAL   @14,WRTFMT5                                         0192 00088000
*/*  IF NO ERRORS FOUND YET                                          */ 00089000
*    IF CONDCODE = SUCCESS                                         0194 00090000
*                                                                  0194 00091000
*/*    THEN WRITE_FORMAT0_DSCBS                                      */ 00092000
*      THEN DO;    CALL WRTFMT0; END;                              0194 00093000
*                                                                  0194 00094000
@RF00190 L     @10,@PC00001+24                                     0194 00095000
         L     @10,CONDCODE(,@10)                                  0194 00096000
         LTR   @10,@10                                             0194 00097000
         BNZ   @RF00194                                            0194 00098000
         BAL   @14,WRTFMT0                                         0196 00099000
*/*  IF NO ERRORS FOUND YET                                          */ 00100000
*    IF CONDCODE = SUCCESS                                         0198 00101000
*                                                                  0198 00102000
*/*    THEN                                                          */ 00103000
*      THEN DO;                                                    0198 00104000
*                                                                  0198 00105000
*                                                                  0198 00106000
@RF00194 L     @10,@PC00001+24                                     0198 00107000
         L     @10,CONDCODE(,@10)                                  0198 00108000
         LTR   @10,@10                                             0198 00109000
         BNZ   @RF00198                                            0198 00110000
*/*      CHANGE_VOLUME_LABEL  WITH POINTER TO VTOC                   */ 00111000
*        CALL ICKCV01(GDTTBL                                       0200 00112000
*                    ,VOLIB                                        0200 00113000
*                    ,VOLSER                                       0200 00114000
*                    ,OWNERID                                      0200 00115000
*                    ,VTOCLOC                                      0200 00116000
*                    ,RETCODE);                                    0200 00117000
*                                                                  0200 00118000
         L     @10,@PC00001                                        0200 00119000
         ST    @10,@AL00001                                        0200 00120000
         L     @10,@PC00001+4                                      0200 00121000
         ST    @10,@AL00001+4                                      0200 00122000
         LA    @10,VOLSER                                          0200 00123000
         ST    @10,@AL00001+8                                      0200 00124000
         LA    @10,OWNERID                                         0200 00125000
         ST    @10,@AL00001+12                                     0200 00126000
         L     @10,@PC00001+8                                      0200 00127000
         ST    @10,@AL00001+16                                     0200 00128000
         LA    @10,RETCODE                                         0200 00129000
         ST    @10,@AL00001+20                                     0200 00130000
         L     @15,@CV00596                                        0200 00131000
         LA    @01,@AL00001                                        0200 00132000
         BALR  @14,@15                                             0200 00133000
*/*      IF NOT SUCCESSFUL                                           */ 00134000
*        IF RETCODE ^= SUCCESS                                     0201 00135000
*                                                                  0201 00136000
*/*        THEN SET ERROR CODE (CONDCODE=4)                          */ 00137000
*          THEN DO;    CONDCODE = NOWTVLBL; END;                   0201 00138000
*                                                                  0201 00139000
         L     @10,RETCODE                                         0201 00140000
         LTR   @10,@10                                             0201 00141000
         BZ    @RF00201                                            0201 00142000
         L     @10,@PC00001+24                                     0203 00143000
         MVC   CONDCODE(4,@10),@CF00048                            0203 00144000
*/*      END-THEN                                                    */ 00145000
*        END;                                                      0205 00146000
*                                                                  0205 00147000
@RF00201 DS    0H                                                  0206 00148000
*/*  RETURN                                                          */ 00149000
*    CALL ICKSAFP0(GDTTBL                                          0206 00150000
*          ,POOLID                                                 0206 00151000
*          ,ALL);                                                  0206 00152000
@RF00198 MVC   @AL00001+4(8),@AL00206                              0206 00153000
         L     @10,@PC00001                                        0206 00154000
         ST    @10,@AL00001                                        0206 00155000
         L     @15,GDTFPL(,@10)                                    0206 00156000
         LA    @01,@AL00001                                        0206 00157000
         BALR  @14,@15                                             0206 00158000
*    IF GDTDBG = NULLPTR                                           0207 00159000
*      THEN;                                                       0207 00160000
         L     @10,@PC00001                                        0207 00161000
         L     @10,GDTDBG(,@10)                                    0207 00162000
         LTR   @10,@10                                             0207 00163000
         BZ    @RT00207                                            0207 00164000
*      ELSE                                                        0209 00165000
*        CALL ICKDB010(GDTTBL                                      0209 00166000
*         ,'WV99');                                                0209 00167000
         L     @10,@PC00001                                        0209 00168000
         ST    @10,@AL00001                                        0209 00169000
         LA    @15,@CC00597                                        0209 00170000
         ST    @15,@AL00001+4                                      0209 00171000
         MVI   @AL00001+4,X'80'                                    0209 00172000
         L     @15,GDTDBG(,@10)                                    0209 00173000
         LA    @01,@AL00001                                        0209 00174000
         BALR  @14,@15                                             0209 00175000
*    CALL ICKSAEP0(GDTTBL,MODID);                                  0210 00176000
*                                                                  0210 00177000
*                                                                  0210 00178000
@RT00207 L     @10,@PC00001                                        0210 00179000
         ST    @10,@AL00001                                        0210 00180000
         LA    @15,MODID                                           0210 00181000
         ST    @15,@AL00001+4                                      0210 00182000
         MVI   @AL00001+4,X'80'                                    0210 00183000
         L     @15,GDTEPL(,@10)                                    0210 00184000
         LA    @01,@AL00001                                        0210 00185000
         BALR  @14,@15                                             0210 00186000
         EJECT                                                          00187000
*/*****  START OF SPECIFICATIONS  ************************************/ 00188000
*/*                                                                  */ 00189000
*/*  SUB-PROCEDURE NAME:  CHKVLOC                                    */ 00190000
*/*                                                                  */ 00191000
*/*  DESCRIPTIVE NAME:  CHECK VTOC LOCATION LEGALITY                 */ 00192000
*/*                                                                  */ 00193000
*/*  FUNCTION:                                                       */ 00194000
*/*                                                                  */ 00195000
*/*    DETERMINE, FOR PRESENT DEVICE, WHETHER THE VTOC ORIGIN AND    */ 00196000
*/*    EXTENT ARE WITHIN THE PROPER BOUNDS.                          */ 00197000
*/*                                                                  */ 00198000
*/*****  END OF SPECIFICATIONS  **************************************/ 00199000
*                                                                  0211 00200000
*                                                                  0211 00201000
*                                                                  0211 00202000
*/*  SUB-PROCEDURE CHECK_VTOC_LOCATION_LEGALITY                      */ 00203000
*    CHKVLOC:                                                      0211 00204000
*      PROCEDURE;                                                  0211 00205000
CHKVLOC  STM   @14,@02,@SA00002                                    0211 00206000
         STM   @06,@12,@SA00002+20                                 0211 00207000
*    OLDERID2 = NEWERID2;                                          0212 00208000
         L     @10,@PC00001                                        0212 00209000
         L     @15,GDTTR2(,@10)                                    0212 00210000
         MVC   @TS00001(95),NEWERID2(@15)                          0212 00211000
         MVC   OLDERID2(95,@15),@TS00001                           0212 00212000
*    NEWID2 = 'WVCV';                                              0213 00213000
*                                                                  0213 00214000
         MVC   NEWID2(4,@15),@CC00601                              0213 00215000
*/*  OBTAIN NUMBER OF TRACKS PER CYLINDER FOR DEVICE (UDEVINFO)      */ 00216000
*    CALL ICKDVIN0(GDTTBL                                          0214 00217000
*            ,VOLIB                                                0214 00218000
*            ,DEVTKCYL                                             0214 00219000
*            ,POOLID                                               0214 00220000
*            ,TKCYLPTR                                             0214 00221000
*            ,DATALEN                                              0214 00222000
*            ,RETCODE);                                            0214 00223000
*                                                                  0214 00224000
         ST    @10,@AL00001                                        0214 00225000
         L     @15,@PC00001+4                                      0214 00226000
         ST    @15,@AL00001+4                                      0214 00227000
         LA    @15,@CF00339                                        0214 00228000
         ST    @15,@AL00001+8                                      0214 00229000
         LA    @15,POOLID                                          0214 00230000
         ST    @15,@AL00001+12                                     0214 00231000
         LA    @15,TKCYLPTR                                        0214 00232000
         ST    @15,@AL00001+16                                     0214 00233000
         LA    @15,DATALEN                                         0214 00234000
         ST    @15,@AL00001+20                                     0214 00235000
         LA    @15,RETCODE                                         0214 00236000
         ST    @15,@AL00001+24                                     0214 00237000
         L     @15,GDTDIN(,@10)                                    0214 00238000
         LA    @01,@AL00001                                        0214 00239000
         BALR  @14,@15                                             0214 00240000
*/*  IF VTOC LOCATION IS 0:0                                         */ 00241000
*    IF VTOCCYL = 0 & VTOCHEAD = 0                                 0215 00242000
*                                                                  0215 00243000
*/*    THEN SET ERROR CODE - INVALID VTOC LOCATION (CONDCODE=2)      */ 00244000
*      THEN DO;    CONDCODE = BADLOCN; END;                        0215 00245000
*                                                                  0215 00246000
         L     @10,@PC00001+8                                      0215 00247000
         MVC   @ZT00002+2(2),VTOCCYL(@10)                          0215 00248000
         L     @15,@ZT00002                                        0215 00249000
         LTR   @15,@15                                             0215 00250000
         BNZ   @RF00215                                            0215 00251000
         MVC   @ZT00002+2(2),VTOCHEAD(@10)                         0215 00252000
         L     @10,@ZT00002                                        0215 00253000
         LTR   @10,@10                                             0215 00254000
         BNZ   @RF00215                                            0215 00255000
         L     @10,@PC00001+24                                     0217 00256000
         MVC   CONDCODE(4,@10),@CF00120                            0217 00257000
*/*  IF VTOC TRACK GIVEN IS BEYOND MAXIMUM VALUE                     */ 00258000
*    IF VTOCHEAD > (TRKSCYL - 1)                                   0219 00259000
*                                                                  0219 00260000
*/*    THEN SET ERROR CODE - INVALID VTOC LOCATION (CONDCODE=2)      */ 00261000
*      THEN DO;    CONDCODE = BADLOCN; END;                        0219 00262000
*                                                                  0219 00263000
@RF00215 L     @10,@PC00001+8                                      0219 00264000
         L     @01,TKCYLPTR                                        0219 00265000
         L     @15,TRKSCYL(,@01)                                   0219 00266000
         BCTR  @15,0                                               0219 00267000
         MVC   @ZT00002+2(2),VTOCHEAD(@10)                         0219 00268000
         C     @15,@ZT00002                                        0219 00269000
         BNL   @RF00219                                            0219 00270000
         L     @10,@PC00001+24                                     0221 00271000
         MVC   CONDCODE(4,@10),@CF00120                            0221 00272000
*/*  CONVERT VTOC LOCATION TO RELATIVE TRACK ADDRESS                 */ 00273000
*    VTOCRTA = (VTOCCYL * TRKSCYL) + VTOCHEAD;                     0223 00274000
*                                                                  0223 00275000
@RF00219 L     @10,@PC00001+8                                      0223 00276000
         MVC   @ZT00002+2(2),VTOCCYL(@10)                          0223 00277000
         L     @01,@ZT00002                                        0223 00278000
         L     @04,TKCYLPTR                                        0223 00279000
         M     @00,TRKSCYL(,@04)                                   0223 00280000
         MVC   @ZT00002+2(2),VTOCHEAD(@10)                         0223 00281000
         AL    @01,@ZT00002                                        0223 00282000
         LR    VTOCRTA,@01                                         0223 00283000
*/*  OBTAIN NUMBER OF PRIMARY TRACKS FOR DEVICE (UDEVINFO)           */ 00284000
*    CALL ICKDVIN0(GDTTBL                                          0224 00285000
*            ,VOLIB                                                0224 00286000
*            ,DEVPTRKS                                             0224 00287000
*            ,POOLID                                               0224 00288000
*            ,PTKSPTR                                              0224 00289000
*            ,DATALEN                                              0224 00290000
*            ,RETCODE);                                            0224 00291000
         L     @10,@PC00001                                        0224 00292000
         ST    @10,@AL00001                                        0224 00293000
         L     @04,@PC00001+4                                      0224 00294000
         ST    @04,@AL00001+4                                      0224 00295000
         LA    @04,@CF00332                                        0224 00296000
         ST    @04,@AL00001+8                                      0224 00297000
         LA    @04,POOLID                                          0224 00298000
         ST    @04,@AL00001+12                                     0224 00299000
         LA    @04,PTKSPTR                                         0224 00300000
         ST    @04,@AL00001+16                                     0224 00301000
         LA    @04,DATALEN                                         0224 00302000
         ST    @04,@AL00001+20                                     0224 00303000
         LA    @04,RETCODE                                         0224 00304000
         ST    @04,@AL00001+24                                     0224 00305000
         L     @15,GDTDIN(,@10)                                    0224 00306000
         LA    @01,@AL00001                                        0224 00307000
         BALR  @14,@15                                             0224 00308000
*    HIGHPRTA = NUMPTRKS - 1;                                      0225 00309000
*                                                                  0225 00310000
         L     @10,PTKSPTR                                         0225 00311000
         L     HIGHPRTA,NUMPTRKS(,@10)                             0225 00312000
         BCTR  HIGHPRTA,0                                          0225 00313000
*/*  IF VTOC BEGINS BEYOND PRIMARY TRACKS                            */ 00314000
*    IF VTOCRTA > HIGHPRTA                                         0226 00315000
*                                                                  0226 00316000
*/*    THEN SET ERROR CODE - INVALID VTOC LOCATION (CONDCODE=2)      */ 00317000
*      THEN DO;    CONDCODE = BADLOCN; END;                        0226 00318000
*                                                                  0226 00319000
         CLR   VTOCRTA,HIGHPRTA                                    0226 00320000
         BNH   @RF00226                                            0226 00321000
         L     @10,@PC00001+24                                     0228 00322000
         MVC   CONDCODE(4,@10),@CF00120                            0228 00323000
*/*  CALCULATE RELATIVE TRACK ADDRESS OF LAST TRACK OF VTOC          */ 00324000
*    ENDVRTA = VTOCRTA + EXTENT - 1;                               0230 00325000
*                                                                  0230 00326000
@RF00226 L     @10,@PC00001+12                                     0230 00327000
         LR    ENDVRTA,VTOCRTA                                     0230 00328000
         AL    ENDVRTA,EXTENT(,@10)                                0230 00329000
         BCTR  ENDVRTA,0                                           0230 00330000
*/*  IF VTOC LOCATION IS VALID                                       */ 00331000
*    IF CONDCODE = SUCCESS                                         0231 00332000
*                                                                  0231 00333000
*/*    THEN                                                          */ 00334000
*      THEN DO;                                                    0231 00335000
*                                                                  0231 00336000
*                                                                  0231 00337000
         L     @10,@PC00001+24                                     0231 00338000
         L     @02,CONDCODE(,@10)                                  0231 00339000
         LTR   @02,@02                                             0231 00340000
         BNZ   @RF00231                                            0231 00341000
*/*      IF END OF VTOC IS BEYOND PRIMARY TRACKS                     */ 00342000
*        IF ENDVRTA > HIGHPRTA                                     0233 00343000
*                                                                  0233 00344000
*/*        THEN SET ERROR CODE - INVALID EXTENT (CONDCODE=3)         */ 00345000
*          THEN DO;    CONDCODE = BADEXTNT; END;                   0233 00346000
*                                                                  0233 00347000
         CLR   ENDVRTA,HIGHPRTA                                    0233 00348000
         BNH   @RF00233                                            0233 00349000
         MVC   CONDCODE(4,@10),@CF00140                            0235 00350000
*/*      END-THEN                                                    */ 00351000
*        END;                                                      0237 00352000
*                                                                  0237 00353000
*/*  END-SUB-PROCEDURE CHECK_VTOC_LOCATION_LEGALITY                  */ 00354000
*    END CHKVLOC;                                                  0238 00355000
*                                                                  0238 00356000
*                                                                  0238 00357000
@EL00002 DS    0H                                                  0238 00358000
@EF00002 DS    0H                                                  0238 00359000
@ER00002 LM    @14,@02,@SA00002                                    0238 00360000
         LM    @06,@12,@SA00002+20                                 0238 00361000
         BR    @14                                                 0238 00362000
         EJECT                                                          00363000
*/*****  START OF SPECIFICATIONS  ************************************/ 00364000
*/*                                                                  */ 00365000
*/*  SUB-PROCEDURE NAME:  WRTFMT4                                    */ 00366000
*/*                                                                  */ 00367000
*/*  DESCRIPTIVE NAME:  WRITE FORMAT4 DSCB                           */ 00368000
*/*                                                                  */ 00369000
*/*  FUNCTION:                                                       */ 00370000
*/*                                                                  */ 00371000
*/*    CREATE, FOR THE PRESENT DEVICE, THE FIRST VTOC DSCB, AND      */ 00372000
*/*    WRITE IT ON THE VOLUME.                                       */ 00373000
*/*                                                                  */ 00374000
*/*****  END OF SPECIFICATIONS  **************************************/ 00375000
*                                                                  0239 00376000
*                                                                  0239 00377000
*                                                                  0239 00378000
*/*  SUB-PROCEDURE WRITE_FORMAT4_DSCB                                */ 00379000
*    WRTFMT4:                                                      0239 00380000
*      PROCEDURE;                                                  0239 00381000
WRTFMT4  STM   @14,@12,@SA00003                                    0239 00382000
*    OLDERID2 = NEWERID2;                                          0240 00383000
         L     @10,@PC00001                                        0240 00384000
         L     @05,GDTTR2(,@10)                                    0240 00385000
         MVC   @TS00001(95),NEWERID2(@05)                          0240 00386000
         MVC   OLDERID2(95,@05),@TS00001                           0240 00387000
*    NEWID2 = 'WVF4';                                              0241 00388000
*                                                                  0241 00389000
*                                                                  0241 00390000
         MVC   NEWID2(4,@05),@CC00605                              0241 00391000
*/*  SET UP FORMAT 4 DATA SET CONTROL BLOCK                          */ 00392000
*    DSCBDATA = ''B;                                               0242 00393000
         XC    DSCBDATA(96),DSCBDATA                               0242 00394000
*    F4PTR = ADDR(DSCBDATA);                                       0243 00395000
         LA    F4PTR,DSCBDATA                                      0243 00396000
*    DS4IDFMT = '4';                                               0244 00397000
         MVI   DS4IDFMT(F4PTR),C'4'                                0244 00398000
*    DS4NOEXT = 1;                                                 0245 00399000
*                                                                  0245 00400000
         MVI   DS4NOEXT(F4PTR),X'01'                               0245 00401000
*/*  GET FORMAT 4 DEVICE CONSTANTS FOR THE DEVICE (UDEVINFO)         */ 00402000
*    CALL ICKDVIN0(GDTTBL                                          0246 00403000
*            ,VOLIB                                                0246 00404000
*            ,DEVDSCBF                                             0246 00405000
*            ,POOLID                                               0246 00406000
*            ,CONSTPTR                                             0246 00407000
*            ,DATALEN                                              0246 00408000
*            ,RETCODE);                                            0246 00409000
         ST    @10,@AL00001                                        0246 00410000
         L     @05,@PC00001+4                                      0246 00411000
         ST    @05,@AL00001+4                                      0246 00412000
         LA    @05,@CF00361                                        0246 00413000
         ST    @05,@AL00001+8                                      0246 00414000
         LA    @05,POOLID                                          0246 00415000
         ST    @05,@AL00001+12                                     0246 00416000
         LA    @05,CONSTPTR                                        0246 00417000
         ST    @05,@AL00001+16                                     0246 00418000
         LA    @05,DATALEN                                         0246 00419000
         ST    @05,@AL00001+20                                     0246 00420000
         LA    @05,RETCODE                                         0246 00421000
         ST    @05,@AL00001+24                                     0246 00422000
         L     @15,GDTDIN(,@10)                                    0246 00423000
         LA    @01,@AL00001                                        0246 00424000
         BALR  @14,@15                                             0246 00425000
*    DS4DEVCT = DEVCONST;                                          0247 00426000
         L     @10,CONSTPTR                                        0247 00427000
         MVC   DS4DEVCT(14,F4PTR),DEVCONST(@10)                    0247 00428000
*    DSCBMAX = DS4DEVDT;                                           0248 00429000
*                                                                  0248 00430000
         SLR   @10,@10                                             0248 00431000
         IC    @10,DS4DEVDT(,F4PTR)                                0248 00432000
         ST    @10,DSCBMAX                                         0248 00433000
*/*  CALCULATE NUMBER OF AVAILABLE (FORMAT 0) DSCBS                  */ 00434000
*    AVAIL = (DS4DEVDT * EXTENT) - 2;                              0249 00435000
         L     @05,@PC00001+12                                     0249 00436000
         LR    @01,@10                                             0249 00437000
         M     @00,EXTENT(,@05)                                    0249 00438000
         BCTR  @01,0                                               0249 00439000
         BCTR  @01,0                                               0249 00440000
         ST    @01,AVAIL                                           0249 00441000
*    DS4DSREC = AVAIL;                                             0250 00442000
*                                                                  0250 00443000
         ST    @01,@TF00001                                        0250 00444000
         MVC   DS4DSREC(2,F4PTR),@TF00001+2                        0250 00445000
*/*  PLACE ALTERNATE TRACK INFO IN DSCB                              */ 00446000
*    DS4HCCHH = NEXTALT;                                           0251 00447000
         L     @10,@PC00001+20                                     0251 00448000
         MVC   DS4HCCHH(4,F4PTR),NEXTALT(@10)                      0251 00449000
*    DS4NOATK = ALTS;                                              0252 00450000
*                                                                  0252 00451000
         L     @10,@PC00001+16                                     0252 00452000
         MVC   DS4NOATK(2,F4PTR),ALTS+2(@10)                       0252 00453000
*/*  SET VTOC EXTENT DESCRIPTION                                     */ 00454000
*    DS4VTOCE(1) = 1;                                              0253 00455000
         LA    @10,1                                               0253 00456000
         STC   @10,DS4VTOCE(,F4PTR)                                0253 00457000
*    DS4VTOCE(3:6) = VTOCLOC;                                      0254 00458000
         L     @05,@PC00001+8                                      0254 00459000
         L     @03,VTOCLOC(,@05)                                   0254 00460000
         ST    @03,@TF00001                                        0254 00461000
         MVC   DS4VTOCE+2(4,F4PTR),@TF00001                        0254 00462000
*    DS4VTOCE(7:8) = ENDVRTA / TRKSCYL;                            0255 00463000
         L     @01,TKCYLPTR                                        0255 00464000
         L     @15,TRKSCYL(,@01)                                   0255 00465000
         LR    @01,ENDVRTA                                         0255 00466000
         SLR   @00,@00                                             0255 00467000
         DR    @00,@15                                             0255 00468000
         ST    @01,@TF00001                                        0255 00469000
         MVC   DS4VTOCE+6(2,F4PTR),@TF00001+2                      0255 00470000
*    DS4VTOCE(9:10) = ENDVRTA // TRKSCYL;                          0256 00471000
*                                                                  0256 00472000
         LR    @01,ENDVRTA                                         0256 00473000
         SLR   @00,@00                                             0256 00474000
         DR    @00,@15                                             0256 00475000
         ST    @00,@TF00001                                        0256 00476000
         MVC   DS4VTOCE+8(2,F4PTR),@TF00001+2                      0256 00477000
*/*  WRITE THE FORMAT 4 DSCB AT BEGINNING OF VTOC (UDEVOP)           */ 00478000
*    DSCBKEY = DSCB4KEY;                                           0257 00479000
         MVC   DSCBKEY(44),DSCB4KEY                                0257 00480000
*    DSCBCCHH = VTOCLOC;                                           0258 00481000
         ST    @03,DSCBCCHH                                        0258 00482000
*    DSCBR = 1;                                                    0259 00483000
         MVI   DSCBR,X'01'                                         0259 00484000
*    DSCBKL = LENGTH(DSCBKEY);                                     0260 00485000
         MVI   DSCBKL,X'2C'                                        0260 00486000
*    DSCBDL = LENGTH(DSCBDATA);                                    0261 00487000
         MVC   DSCBDL(2),@CH00483                                  0261 00488000
*    RECNUM = 1;                                                   0262 00489000
         ST    @10,RECNUM                                          0262 00490000
*    DATAPTR = ADDR(DSCBREC);                                      0263 00491000
         LA    @10,DSCBREC                                         0263 00492000
         ST    @10,DATAPTR                                         0263 00493000
*    DATALEN = LENGTH(DSCBREC);                                    0264 00494000
         MVC   DATALEN(4),@CF00535                                 0264 00495000
*    CALL ICKDVOP0(GDTTBL                                          0265 00496000
*          ,VOLIB                                                  0265 00497000
*          ,ACTWCKDN                                               0265 00498000
*          ,VTOCLOC                                                0265 00499000
*          ,RECNUM                                                 0265 00500000
*          ,POOLID                                                 0265 00501000
*          ,DATAPTR                                                0265 00502000
*          ,DATALEN                                                0265 00503000
*          ,RETCODE);                                              0265 00504000
*                                                                  0265 00505000
         L     @10,@PC00001                                        0265 00506000
         ST    @10,@AL00001                                        0265 00507000
         L     @15,@PC00001+4                                      0265 00508000
         ST    @15,@AL00001+4                                      0265 00509000
         LA    @15,@CF00264                                        0265 00510000
         ST    @15,@AL00001+8                                      0265 00511000
         ST    @05,@AL00001+12                                     0265 00512000
         LA    @05,RECNUM                                          0265 00513000
         ST    @05,@AL00001+16                                     0265 00514000
         LA    @05,POOLID                                          0265 00515000
         ST    @05,@AL00001+20                                     0265 00516000
         LA    @05,DATAPTR                                         0265 00517000
         ST    @05,@AL00001+24                                     0265 00518000
         LA    @05,DATALEN                                         0265 00519000
         ST    @05,@AL00001+28                                     0265 00520000
         LA    @05,RETCODE                                         0265 00521000
         ST    @05,@AL00001+32                                     0265 00522000
         L     @15,GDTDOP(,@10)                                    0265 00523000
         LA    @01,@AL00001                                        0265 00524000
         BALR  @14,@15                                             0265 00525000
*/*  IF NOT SUCCESSFUL                                               */ 00526000
*    IF RETCODE ^= SUCCESS                                         0266 00527000
*                                                                  0266 00528000
*/*    THEN SET ERROR CODE (CONDCODE=1)                              */ 00529000
*      THEN DO;    CONDCODE = NOVTOCWT; END;                       0266 00530000
*                                                                  0266 00531000
         L     @10,RETCODE                                         0266 00532000
         LTR   @10,@10                                             0266 00533000
         BZ    @RF00266                                            0266 00534000
         L     @10,@PC00001+24                                     0268 00535000
         MVC   CONDCODE(4,@10),@CF00169                            0268 00536000
*/*  END-SUB-PROCEDURE WRITE_FORMAT4_DSCB                            */ 00537000
*    END WRTFMT4;                                                  0270 00538000
*                                                                  0270 00539000
*                                                                  0270 00540000
*                                                                  0270 00541000
@EL00003 DS    0H                                                  0270 00542000
@EF00003 DS    0H                                                  0270 00543000
@ER00003 LM    @14,@12,@SA00003                                    0270 00544000
         BR    @14                                                 0270 00545000
         EJECT                                                          00546000
*/*****  START OF SPECIFICATIONS  ************************************/ 00547000
*/*                                                                  */ 00548000
*/*  SUB-PROCEDURE NAME:  WRTFMT5                                    */ 00549000
*/*                                                                  */ 00550000
*/*  DESCRIPTIVE NAME:  WRITE FORMAT5 DSCB                           */ 00551000
*/*                                                                  */ 00552000
*/*  FUNCTION:                                                       */ 00553000
*/*                                                                  */ 00554000
*/*    CREATE AND WRITE FORMAT-5 DSCB AS APPROPRIATE:                */ 00555000
*/*    MSS OR NON-MSS.                                               */ 00556000
*/*                                                                  */ 00557000
*/*****  END OF SPECIFICATIONS  **************************************/ 00558000
*                                                                  0271 00559000
*                                                                  0271 00560000
*                                                                  0271 00561000
*/*  SUB-PROCEDURE WRITE_FORMAT5_DSCB                                */ 00562000
*    WRTFMT5:                                                      0271 00563000
*      PROCEDURE;                                                  0271 00564000
WRTFMT5  STM   @14,@12,@SA00004                                    0271 00565000
*    OLDERID2 = NEWERID2;                                          0272 00566000
         L     @10,@PC00001                                        0272 00567000
         L     @07,GDTTR2(,@10)                                    0272 00568000
         MVC   @TS00001(95),NEWERID2(@07)                          0272 00569000
         MVC   OLDERID2(95,@07),@TS00001                           0272 00570000
*    NEWID2 = 'WVF5';                                              0273 00571000
*                                                                  0273 00572000
*                                                                  0273 00573000
         MVC   NEWID2(4,@07),@CC00612                              0273 00574000
*/*  SET UP FORMAT 5 DATA SET CONTROL BLOCK                          */ 00575000
*    F5PTR = ADDR(DSCBAREA);                                       0274 00576000
         LA    F5PTR,DSCBAREA                                      0274 00577000
*    DSCBAREA = ''B;                                               0275 00578000
         XC    DSCBAREA(140),DSCBAREA                              0275 00579000
*    DS5KEYID = DSCB5KEY;                                          0276 00580000
         MVC   DS5KEYID(4,F5PTR),@CB00553                          0276 00581000
*    DS5FMTID = '5';                                               0277 00582000
*                                                                  0277 00583000
         MVI   DS5FMTID(F5PTR),C'5'                                0277 00584000
*/*  IF VOLUME IS NOT AN MSS VOLUME (UDEVINFO)                       */ 00585000
*    CALL ICKDVIN0(GDTTBL                                          0278 00586000
*            ,VOLIB                                                0278 00587000
*            ,DEVMSSID                                             0278 00588000
*            ,POOLID                                               0278 00589000
*            ,MSSIDPTR                                             0278 00590000
*            ,DATALEN                                              0278 00591000
*            ,RETCODE);                                            0278 00592000
         ST    @10,@AL00001                                        0278 00593000
         L     @07,@PC00001+4                                      0278 00594000
         ST    @07,@AL00001+4                                      0278 00595000
         LA    @07,@CF00355                                        0278 00596000
         ST    @07,@AL00001+8                                      0278 00597000
         LA    @07,POOLID                                          0278 00598000
         ST    @07,@AL00001+12                                     0278 00599000
         LA    @07,MSSIDPTR                                        0278 00600000
         ST    @07,@AL00001+16                                     0278 00601000
         LA    @07,DATALEN                                         0278 00602000
         ST    @07,@AL00001+20                                     0278 00603000
         LA    @07,RETCODE                                         0278 00604000
         ST    @07,@AL00001+24                                     0278 00605000
         L     @15,GDTDIN(,@10)                                    0278 00606000
         LA    @01,@AL00001                                        0278 00607000
         BALR  @14,@15                                             0278 00608000
*    IF MSSFLAG = NO                                               0279 00609000
*                                                                  0279 00610000
*/*    THEN                                                          */ 00611000
*      THEN DO;                                                    0279 00612000
*                                                                  0279 00613000
*                                                                  0279 00614000
         L     @10,MSSIDPTR                                        0279 00615000
         TM    MSSFLAG(@10),B'10000000'                            0279 00616000
         BNZ   @RF00279                                            0279 00617000
*        FREEPTR = ADDR(DS5AVEXT);                                 0281 00618000
*                                                                  0281 00619000
         LA    FREEPTR,DS5AVEXT(,F5PTR)                            0281 00620000
*/*      IF VTOC NOT AT BEGINNING OF VOLUME                          */ 00621000
*        IF VTOCRTA > 1                                            0282 00622000
*                                                                  0282 00623000
*/*        THEN                                                      */ 00624000
*          THEN DO;                                                0282 00625000
*                                                                  0282 00626000
*                                                                  0282 00627000
         CL    VTOCRTA,@CF00169                                    0282 00628000
         BNH   @RF00282                                            0282 00629000
*/*           BUILD EXTENT ENTRY FOR SPACE PRECEEDING VTOC           */ 00630000
*             FREERTA = 1;                                         0284 00631000
         MVC   FREERTA(2,FREEPTR),@CH00169                         0284 00632000
*             IF VTOCRTA > TRKSCYL                                 0285 00633000
*               THEN DO;                                           0285 00634000
*                                                                  0285 00635000
         L     @10,TKCYLPTR                                        0285 00636000
         L     @10,TRKSCYL(,@10)                                   0285 00637000
         CLR   VTOCRTA,@10                                         0285 00638000
         BNH   @RF00285                                            0285 00639000
*                 FREECYL = (VTOCRTA / TRKSCYL) - 1;               0287 00640000
         LR    @01,VTOCRTA                                         0287 00641000
         SLR   @00,@00                                             0287 00642000
         DR    @00,@10                                             0287 00643000
         BCTR  @01,0                                               0287 00644000
         ST    @01,@TF00001                                        0287 00645000
         MVC   FREECYL(2,FREEPTR),@TF00001+2                       0287 00646000
*                 FREETRK = TRKSCYL - 1 + (VTOCRTA // TRKSCYL);    0288 00647000
         LR    @15,@10                                             0288 00648000
         BCTR  @15,0                                               0288 00649000
         LR    @01,VTOCRTA                                         0288 00650000
         SLR   @00,@00                                             0288 00651000
         DR    @00,@10                                             0288 00652000
         ALR   @15,@00                                             0288 00653000
         STC   @15,FREETRK(,FREEPTR)                               0288 00654000
*                 END;                                             0289 00655000
*               ELSE DO;                                           0290 00656000
*                                                                  0290 00657000
         B     @RC00285                                            0290 00658000
@RF00285 DS    0H                                                  0291 00659000
*                 FREECYL = 0;                                     0291 00660000
         SLR   @10,@10                                             0291 00661000
         ST    @10,@TF00001                                        0291 00662000
         MVC   FREECYL(2,FREEPTR),@TF00001+2                       0291 00663000
*                 FREETRK = VTOCRTA - 1;                           0292 00664000
         LR    @10,VTOCRTA                                         0292 00665000
         BCTR  @10,0                                               0292 00666000
         STC   @10,FREETRK(,FREEPTR)                               0292 00667000
*                 END;                                             0293 00668000
*                                                                  0293 00669000
*/*           INCREMENT TO NEXT FREE EXTENT AREA                     */ 00670000
*             FREEPTR = FREEPTR + LENGTH(FREEDESC);                0294 00671000
*                                                                  0294 00672000
@RC00285 AH    FREEPTR,@CH00259                                    0294 00673000
*/*           END-THEN                                               */ 00674000
*             END;                                                 0295 00675000
*                                                                  0295 00676000
*/*       IF VTOC NOT AT END OF VOLUME (PRIMARY TRACKS)              */ 00677000
*         IF ENDVRTA < HIGHPRTA                                    0296 00678000
*                                                                  0296 00679000
*/*         THEN                                                     */ 00680000
*           THEN DO;                                               0296 00681000
*                                                                  0296 00682000
*                                                                  0296 00683000
@RF00282 CLR   ENDVRTA,HIGHPRTA                                    0296 00684000
         BNL   @RF00296                                            0296 00685000
*/*           BUILD EXTENT ENTRY FOR SPACE FOLLOWING VTOC            */ 00686000
*             FREERTA = ENDVRTA + 1;                               0298 00687000
         LA    @10,1                                               0298 00688000
         ALR   @10,ENDVRTA                                         0298 00689000
         ST    @10,@TF00001                                        0298 00690000
         MVC   FREERTA(2,FREEPTR),@TF00001+2                       0298 00691000
*             FREECYL = (HIGHPRTA - ENDVRTA) / TRKSCYL;            0299 00692000
         LR    @10,HIGHPRTA                                        0299 00693000
         SLR   @10,ENDVRTA                                         0299 00694000
         L     @03,TKCYLPTR                                        0299 00695000
         L     @03,TRKSCYL(,@03)                                   0299 00696000
         LR    @00,@10                                             0299 00697000
         SRDA  @00,32                                              0299 00698000
         DR    @00,@03                                             0299 00699000
         ST    @01,@TF00001                                        0299 00700000
         MVC   FREECYL(2,FREEPTR),@TF00001+2                       0299 00701000
*             FREETRK = (HIGHPRTA - ENDVRTA) // TRKSCYL;           0300 00702000
*                                                                  0300 00703000
         LR    @01,@10                                             0300 00704000
         SLR   @00,@00                                             0300 00705000
         DR    @00,@03                                             0300 00706000
         STC   @00,FREETRK(,FREEPTR)                               0300 00707000
*/*           END-THEN                                               */ 00708000
*             END;                                                 0301 00709000
*                                                                  0301 00710000
*/*       END-THEN                                                   */ 00711000
*         END;                                                     0302 00712000
*                                                                  0302 00713000
@RF00296 DS    0H                                                  0303 00714000
*/*  WRITE THE FORMAT 5 DSCB (UDEVOP)                                */ 00715000
*    DSCBCCHH = VTOCLOC;                                           0303 00716000
@RF00279 L     @10,@PC00001+8                                      0303 00717000
         MVC   DSCBCCHH(4),VTOCLOC(@10)                            0303 00718000
*    DSCBR = 2;                                                    0304 00719000
         MVI   DSCBR,X'02'                                         0304 00720000
*    DSCBKL = 4;                                                   0305 00721000
         MVI   DSCBKL,X'04'                                        0305 00722000
*    DSCBDL = 136;                                                 0306 00723000
         MVC   DSCBDL(2),@CH00614                                  0306 00724000
*    RECNUM = 2;                                                   0307 00725000
         MVC   RECNUM(4),@CF00120                                  0307 00726000
*    DATAPTR = ADDR(DSCBREC);                                      0308 00727000
         LA    @15,DSCBREC                                         0308 00728000
         ST    @15,DATAPTR                                         0308 00729000
*    DATALEN = LENGTH(DSCBREC);                                    0309 00730000
         MVC   DATALEN(4),@CF00535                                 0309 00731000
*    CALL ICKDVOP0(GDTTBL                                          0310 00732000
*          ,VOLIB                                                  0310 00733000
*          ,ACTWCKDN                                               0310 00734000
*          ,VTOCLOC                                                0310 00735000
*          ,RECNUM                                                 0310 00736000
*          ,POOLID                                                 0310 00737000
*          ,DATAPTR                                                0310 00738000
*          ,DATALEN                                                0310 00739000
*          ,RETCODE);                                              0310 00740000
*                                                                  0310 00741000
         L     @15,@PC00001                                        0310 00742000
         ST    @15,@AL00001                                        0310 00743000
         L     @14,@PC00001+4                                      0310 00744000
         ST    @14,@AL00001+4                                      0310 00745000
         LA    @14,@CF00264                                        0310 00746000
         ST    @14,@AL00001+8                                      0310 00747000
         ST    @10,@AL00001+12                                     0310 00748000
         LA    @10,RECNUM                                          0310 00749000
         ST    @10,@AL00001+16                                     0310 00750000
         LA    @10,POOLID                                          0310 00751000
         ST    @10,@AL00001+20                                     0310 00752000
         LA    @10,DATAPTR                                         0310 00753000
         ST    @10,@AL00001+24                                     0310 00754000
         LA    @10,DATALEN                                         0310 00755000
         ST    @10,@AL00001+28                                     0310 00756000
         LA    @10,RETCODE                                         0310 00757000
         ST    @10,@AL00001+32                                     0310 00758000
         L     @15,GDTDOP(,@15)                                    0310 00759000
         LA    @01,@AL00001                                        0310 00760000
         BALR  @14,@15                                             0310 00761000
*/*  IF NOT SUCCESSFUL                                               */ 00762000
*    IF RETCODE ^= SUCCESS                                         0311 00763000
*                                                                  0311 00764000
*/*    THEN SET ERROR CODE (CONDCODE=1)                              */ 00765000
*      THEN DO;    CONDCODE = NOVTOCWT; END;                       0311 00766000
*                                                                  0311 00767000
         L     @10,RETCODE                                         0311 00768000
         LTR   @10,@10                                             0311 00769000
         BZ    @RF00311                                            0311 00770000
         L     @10,@PC00001+24                                     0313 00771000
         MVC   CONDCODE(4,@10),@CF00169                            0313 00772000
*/*  END-SUB-PROCEDURE WRITE_FORMAT5_DSCB                            */ 00773000
*    END WRTFMT5;                                                  0315 00774000
*                                                                  0315 00775000
*                                                                  0315 00776000
@EL00004 DS    0H                                                  0315 00777000
@EF00004 DS    0H                                                  0315 00778000
@ER00004 LM    @14,@12,@SA00004                                    0315 00779000
         BR    @14                                                 0315 00780000
         EJECT                                                          00781000
*/*****  START OF SPECIFICATIONS  ************************************/ 00782000
*/*                                                                  */ 00783000
*/*  SUB-PROCEDURE NAME:  WRTFMT0                                    */ 00784000
*/*                                                                  */ 00785000
*/*  DESCRIPTIVE NAME:  WRITE FORMAT0 DSCB                           */ 00786000
*/*                                                                  */ 00787000
*/*  FUNCTION:                                                       */ 00788000
*/*                                                                  */ 00789000
*/*    CREATE AND WRITE FORMAT-0 DSCBS THROUGH THE REMAINDER OF      */ 00790000
*/*    THE VTOC EXTENT.                                              */ 00791000
*/*                                                                  */ 00792000
*/*****  END OF SPECIFICATIONS  **************************************/ 00793000
*                                                                  0316 00794000
*                                                                  0316 00795000
*/*  SUB-PROCEDURE WRITE_FORMAT0_DSCBS                               */ 00796000
*    WRTFMT0:                                                      0316 00797000
*      PROCEDURE;                                                  0316 00798000
WRTFMT0  STM   @14,@12,@SA00005                                    0316 00799000
*    OLDERID2 = NEWERID2;                                          0317 00800000
         L     @10,@PC00001                                        0317 00801000
         L     @10,GDTTR2(,@10)                                    0317 00802000
         MVC   @TS00001(95),NEWERID2(@10)                          0317 00803000
         MVC   OLDERID2(95,@10),@TS00001                           0317 00804000
*    NEWID2 = 'WVF0';                                              0318 00805000
*                                                                  0318 00806000
*                                                                  0318 00807000
         MVC   NEWID2(4,@10),@CC00618                              0318 00808000
*/*  SET UP TO WRITE FIRST FORMAT 0 DSCB                             */ 00809000
*    DSCBAREA = ''B;                                               0319 00810000
         XC    DSCBAREA(140),DSCBAREA                              0319 00811000
*    DSCBCCHH = VTOCLOC;                                           0320 00812000
         L     @10,@PC00001+8                                      0320 00813000
         MVC   DSCBCCHH(4),VTOCLOC(@10)                            0320 00814000
*    DSCBR = 3;                                                    0321 00815000
         MVI   DSCBR,X'03'                                         0321 00816000
*    DSCBKL = LENGTH(DSCBKEY);                                     0322 00817000
         MVI   DSCBKL,X'2C'                                        0322 00818000
*    DSCBDL = LENGTH(DSCBDATA);                                    0323 00819000
         MVC   DSCBDL(2),@CH00483                                  0323 00820000
*    RECNUM = 3;                                                   0324 00821000
         MVC   RECNUM(4),@CF00140                                  0324 00822000
*    DATAPTR = ADDR(DSCBREC);                                      0325 00823000
         LA    @10,DSCBREC                                         0325 00824000
         ST    @10,DATAPTR                                         0325 00825000
*    DATALEN = LENGTH(DSCBREC);                                    0326 00826000
*                                                                  0326 00827000
         MVC   DATALEN(4),@CF00535                                 0326 00828000
*/*  DO-UNTIL VTOC FULL                                              */ 00829000
*    DO AVAIL = AVAIL TO 1 BY -1;                                  0327 00830000
*                                                                  0327 00831000
*                                                                  0327 00832000
         L     @10,AVAIL                                           0327 00833000
         B     @DE00327                                            0327 00834000
@DL00327 DS    0H                                                  0328 00835000
*/*    WRITE A FORMAT 0 DSCB (UDEVOP)                                */ 00836000
*      DSCBR = RECNUM;                                             0328 00837000
         MVC   DSCBR(1),RECNUM+3                                   0328 00838000
*      CALL ICKDVOP0(GDTTBL                                        0329 00839000
*            ,VOLIB                                                0329 00840000
*            ,ACTWCKDN                                             0329 00841000
*            ,DSCBCCHH                                             0329 00842000
*            ,RECNUM                                               0329 00843000
*            ,POOLID                                               0329 00844000
*            ,DATAPTR                                              0329 00845000
*            ,DATALEN                                              0329 00846000
*            ,RETCODE);                                            0329 00847000
*                                                                  0329 00848000
         L     @10,@PC00001                                        0329 00849000
         ST    @10,@AL00001                                        0329 00850000
         L     @15,@PC00001+4                                      0329 00851000
         ST    @15,@AL00001+4                                      0329 00852000
         LA    @15,@CF00264                                        0329 00853000
         ST    @15,@AL00001+8                                      0329 00854000
         LA    @15,DSCBCCHH                                        0329 00855000
         ST    @15,@AL00001+12                                     0329 00856000
         LA    @15,RECNUM                                          0329 00857000
         ST    @15,@AL00001+16                                     0329 00858000
         LA    @15,POOLID                                          0329 00859000
         ST    @15,@AL00001+20                                     0329 00860000
         LA    @15,DATAPTR                                         0329 00861000
         ST    @15,@AL00001+24                                     0329 00862000
         LA    @15,DATALEN                                         0329 00863000
         ST    @15,@AL00001+28                                     0329 00864000
         LA    @15,RETCODE                                         0329 00865000
         ST    @15,@AL00001+32                                     0329 00866000
         L     @15,GDTDOP(,@10)                                    0329 00867000
         LA    @01,@AL00001                                        0329 00868000
         BALR  @14,@15                                             0329 00869000
*/*    IF NOT SUCCESSFUL                                             */ 00870000
*      IF RETCODE ^= SUCCESS                                       0330 00871000
*                                                                  0330 00872000
*/*      THEN RETURN (CONDCODE=1)                                    */ 00873000
*        THEN DO;                                                  0330 00874000
*                                                                  0330 00875000
         SLR   @10,@10                                             0330 00876000
         C     @10,RETCODE                                         0330 00877000
         BE    @RF00330                                            0330 00878000
*          CONDCODE = NOVTOCWT;                                    0332 00879000
         L     @15,@PC00001+24                                     0332 00880000
         MVC   CONDCODE(4,@15),@CF00169                            0332 00881000
*          IF GDTDBG = NULLPTR                                     0333 00882000
*            THEN;                                                 0333 00883000
         L     @15,@PC00001                                        0333 00884000
         C     @10,GDTDBG(,@15)                                    0333 00885000
         BE    @RT00333                                            0333 00886000
*            ELSE                                                  0335 00887000
*              CALL ICKDB010(GDTTBL,'WV55');                       0335 00888000
         L     @10,@PC00001                                        0335 00889000
         ST    @10,@AL00001                                        0335 00890000
         LA    @15,@CC00620                                        0335 00891000
         ST    @15,@AL00001+4                                      0335 00892000
         MVI   @AL00001+4,X'80'                                    0335 00893000
         L     @15,GDTDBG(,@10)                                    0335 00894000
         LA    @01,@AL00001                                        0335 00895000
         BALR  @14,@15                                             0335 00896000
*          CALL ICKSAEP0(GDTTBL,MODID);                            0336 00897000
@RT00333 L     @10,@PC00001                                        0336 00898000
         ST    @10,@AL00001                                        0336 00899000
         LA    @15,MODID                                           0336 00900000
         ST    @15,@AL00001+4                                      0336 00901000
         MVI   @AL00001+4,X'80'                                    0336 00902000
         L     @15,GDTEPL(,@10)                                    0336 00903000
         LA    @01,@AL00001                                        0336 00904000
         BALR  @14,@15                                             0336 00905000
*          END;                                                    0337 00906000
*                                                                  0337 00907000
*/*    IF END OF TRACK IS REACHED                                    */ 00908000
*      IF RECNUM = DSCBMAX                                         0338 00909000
*                                                                  0338 00910000
*/*      THEN                                                        */ 00911000
*        THEN DO;                                                  0338 00912000
*                                                                  0338 00913000
*                                                                  0338 00914000
@RF00330 CLC   RECNUM(4),DSCBMAX                                   0338 00915000
         BNE   @RF00338                                            0338 00916000
*/*        IF END OF CYLINDER IS REACHED                             */ 00917000
*          IF DSCBHH = (TRKSCYL - 1)                               0340 00918000
*                                                                  0340 00919000
*/*          THEN                                                    */ 00920000
*            THEN DO;                                              0340 00921000
*                                                                  0340 00922000
*                                                                  0340 00923000
         L     @10,TKCYLPTR                                        0340 00924000
         L     @10,TRKSCYL(,@10)                                   0340 00925000
         BCTR  @10,0                                               0340 00926000
         MVC   @ZT00002+2(2),DSCBHH                                0340 00927000
         C     @10,@ZT00002                                        0340 00928000
         BNE   @RF00340                                            0340 00929000
*/*            SET FOR NEXT CYLINDER                                 */ 00930000
*              DSCBCC = DSCBCC + 1;                                0342 00931000
         LA    @10,1                                               0342 00932000
         MVC   @ZT00002+2(2),DSCBCC                                0342 00933000
         L     @15,@ZT00002                                        0342 00934000
         ALR   @15,@10                                             0342 00935000
         STH   @15,DSCBCC                                          0342 00936000
*              DSCBHH = 0;                                         0343 00937000
         SLR   @15,@15                                             0343 00938000
         STH   @15,DSCBHH                                          0343 00939000
*              RECNUM = 1;                                         0344 00940000
         ST    @10,RECNUM                                          0344 00941000
*              DSCBR = RECNUM;                                     0345 00942000
*                                                                  0345 00943000
         STC   @10,DSCBR                                           0345 00944000
*/*            END-THEN                                              */ 00945000
*              END;                                                0346 00946000
*                                                                  0346 00947000
*/*          ELSE                                                    */ 00948000
*            ELSE DO;                                              0347 00949000
*                                                                  0347 00950000
*                                                                  0347 00951000
         B     @RC00340                                            0347 00952000
@RF00340 DS    0H                                                  0348 00953000
*/*            SET FOR NEXT TRACK                                    */ 00954000
*              DSCBHH = DSCBHH + 1;                                0348 00955000
         LA    @10,1                                               0348 00956000
         MVC   @ZT00002+2(2),DSCBHH                                0348 00957000
         L     @15,@ZT00002                                        0348 00958000
         ALR   @15,@10                                             0348 00959000
         STH   @15,DSCBHH                                          0348 00960000
*              RECNUM = 1;                                         0349 00961000
         ST    @10,RECNUM                                          0349 00962000
*              DSCBR = RECNUM;                                     0350 00963000
*                                                                  0350 00964000
         STC   @10,DSCBR                                           0350 00965000
*/*            END-ELSE                                              */ 00966000
*              END;                                                0351 00967000
*                                                                  0351 00968000
*/*        END-THEN                                                  */ 00969000
*          END;                                                    0352 00970000
*                                                                  0352 00971000
*/*      ELSE INCREMENT RECORD NUMBER                                */ 00972000
*        ELSE DO;                                                  0353 00973000
         B     @RC00338                                            0353 00974000
@RF00338 DS    0H                                                  0354 00975000
*          RECNUM = RECNUM + 1;                                    0354 00976000
         LA    @10,1                                               0354 00977000
         AL    @10,RECNUM                                          0354 00978000
         ST    @10,RECNUM                                          0354 00979000
*          DSCBR = RECNUM;                                         0355 00980000
         STC   @10,DSCBR                                           0355 00981000
*          END;                                                    0356 00982000
*                                                                  0356 00983000
*/*  END-UNTIL                                                       */ 00984000
*    END;                                                          0357 00985000
*                                                                  0357 00986000
@RC00338 SLR   @10,@10                                             0357 00987000
         BCTR  @10,0                                               0357 00988000
         AL    @10,AVAIL                                           0357 00989000
         ST    @10,AVAIL                                           0357 00990000
@DE00327 LTR   @10,@10                                             0357 00991000
         BP    @DL00327                                            0357 00992000
*/*  END-SUB-PROCEDURE WRITE_FORMAT0_DSCBS                           */ 00993000
*    END WRTFMT0;                                                  0358 00994000
*                                                                  0358 00995000
*                                                                  0358 00996000
@EL00005 DS    0H                                                  0358 00997000
@EF00005 DS    0H                                                  0358 00998000
@ER00005 LM    @14,@12,@SA00005                                    0358 00999000
         BR    @14                                                 0358 01000000
@PB00005 DS    0H                                                  0358 01001000
*/*  END-PROCEDURE CREATE_VOLUME_TABLE_OF_CONTENTS                   */ 01002000
*                                                                  0359 01003000
*    END ICKWV01                                                   0359 01004000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01005000
*/*%INCLUDE SYSLIB  (DMSDF01 )                                        * 01006000
*/*%INCLUDE SYSLIB  (DMSDF00 )                                        * 01007000
*/*@INCLUDE SYSLIB  (DMSDF02 )                                        * 01008000
*/*%INCLUDE SYSLIB  (IECSDSL1)                                        * 01009000
*;                                                                 0359 01010000
@DATA    DS    0H                                                       01011000
@CH00259 DC    H'5'                                                     01012000
@CH00483 DC    H'96'                                                    01013000
@CH00614 DC    H'136'                                                   01014000
         DS    0F                                                       01015000
@AL00206 DC    A(POOLID)               LIST WITH   2 ARGUMENT(S)        01016000
         DC    AL1(X'80')                                               01017000
         DC    AL3(@CC00141)                                            01018000
@DATD    DSECT                                                          01019000
         DS    0F                                                       01020000
@SA00001 DS    18F                                                      01021000
@PC00001 DS    7F                                                       01022000
@SA00002 DS    12F                                                      01023000
@SA00003 DS    15F                                                      01024000
@SA00004 DS    15F                                                      01025000
@SA00005 DS    15F                                                      01026000
@AL00001 DS    9A                                                       01027000
@TF00001 DS    F                                                        01028000
@ZTEMPS  DS    0F                                                       01029000
@ZT00002 DC    F'0'                                                     01030000
@ZTEMPND EQU   *                                                        01031000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         01032000
ICKWV01  CSECT                                                          01033000
         DS    0F                                                       01034000
@CF00169 DC    F'1'                                                     01035000
@CH00169 EQU   @CF00169+2                                               01036000
@CF00120 DC    F'2'                                                     01037000
@CF00140 DC    F'3'                                                     01038000
@CF00048 DC    F'4'                                                     01039000
@CF00264 DC    F'9'                                                     01040000
@CF00535 DC    F'148'                                                   01041000
@CF00332 DC    F'201'                                                   01042000
@CF00339 DC    F'204'                                                   01043000
@CF00355 DC    F'212'                                                   01044000
@CF00361 DC    F'215'                                                   01045000
@DATD    DSECT                                                          01046000
         DS    0D                                                       01047000
LISTSCAN DS    A                                                        01048000
IOCSPTR  DS    A                                                        01049000
OPNPTR   DS    A                                                        01050000
DDSTRU   DS    A                                                        01051000
FSADDR   DS    A                                                        01052000
DMPINDEX DS    A                                                        01053000
DSCBMAX  DS    F                                                        01054000
CONSTPTR DS    A                                                        01055000
DATAPTR  DS    A                                                        01056000
DATALEN  DS    F                                                        01057000
TKCYLPTR DS    A                                                        01058000
PTKSPTR  DS    A                                                        01059000
MSSIDPTR DS    A                                                        01060000
RECNUM   DS    F                                                        01061000
AVAIL    DS    F                                                        01062000
RETCODE  DS    F                                                        01063000
LISTPTR  DS    A                                                        01064000
SETRC    DS    H                                                        01065000
TESTRC   DS    H                                                        01066000
LISTLN   DS    FL1                                                      01067000
@TS00001 DS    CL95                                                     01068000
DSCBREC  DS    CL148                                                    01069000
         ORG   DSCBREC                                                  01070000
DSCBCNT  DS    CL8                                                      01071000
         ORG   DSCBCNT                                                  01072000
DSCBCCHH DS    FL4                                                      01073000
         ORG   DSCBCCHH                                                 01074000
DSCBCC   DS    FL2                                                      01075000
DSCBHH   DS    FL2                                                      01076000
         ORG   DSCBCNT+4                                                01077000
DSCBR    DS    FL1                                                      01078000
DSCBKL   DS    FL1                                                      01079000
DSCBDL   DS    FL2                                                      01080000
         ORG   DSCBREC+8                                                01081000
DSCBAREA DS    CL140                                                    01082000
         ORG   DSCBAREA                                                 01083000
DSCBKEY  DS    CL44                                                     01084000
DSCBDATA DS    CL96                                                     01085000
         ORG   DSCBREC+148                                              01086000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01087000
@ENDDATD EQU   *                                                        01088000
ICKWV01  CSECT                                                          01089000
         DS    0F                                                       01090000
@SIZDATD DC    AL1(0)                                                   01091000
         DC    AL3(@ENDDATD-@DATD)                                      01092000
@CV00596 DC    V(ICKCV01)                                               01093000
         DS    0D                                                       01094000
@CC00591 DC    C'WV00'                                                  01095000
@CC00597 DC    C'WV99'                                                  01096000
@CC00601 DC    C'WVCV'                                                  01097000
@CC00605 DC    C'WVF4'                                                  01098000
@CC00612 DC    C'WVF5'                                                  01099000
@CC00618 DC    C'WVF0'                                                  01100000
@CC00620 DC    C'WV55'                                                  01101000
@CC00141 DC    C'ALL'                                                   01102000
@CB00553 DC    X'05050505'                                              01103000
MODID    DC    CL4'WV01'                                                01104000
DSCB4KEY DS    CL44                                                     01105000
         ORG   DSCB4KEY                                                 01106000
@NM00024 DC    44X'04'                                                  01107000
         ORG   DSCB4KEY+44                                              01108000
VOLSER   DC    CL6'      '                                              01109000
OWNERID  DC    CL14'              '                                     01110000
POOLID   DC    CL4'WV01'                                                01111000
PTCHWV01 DS    CL256                                                    01112000
         ORG   PTCHWV01                                                 01113000
@NM00026 DC    256X'00'                                                 01114000
         ORG   PTCHWV01+256                                             01115000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01116000
@01      EQU   01                                                       01117000
@02      EQU   02                                                       01118000
@03      EQU   03                                                       01119000
@04      EQU   04                                                       01120000
@05      EQU   05                                                       01121000
@06      EQU   06                                                       01122000
@07      EQU   07                                                       01123000
@08      EQU   08                                                       01124000
@09      EQU   09                                                       01125000
@10      EQU   10                                                       01126000
@11      EQU   11                                                       01127000
@12      EQU   12                                                       01128000
@13      EQU   13                                                       01129000
@14      EQU   14                                                       01130000
@15      EQU   15                                                       01131000
FREEPTR  EQU   @02                                                      01132000
HIGHPRTA EQU   @05                                                      01133000
ENDVRTA  EQU   @04                                                      01134000
VTOCRTA  EQU   @03                                                      01135000
F5PTR    EQU   @06                                                      01136000
F4PTR    EQU   @02                                                      01137000
REG12    EQU   @12                                                      01138000
REG0     EQU   @00                                                      01139000
REG1     EQU   @01                                                      01140000
REG10    EQU   @10                                                      01141000
REG11    EQU   @11                                                      01142000
REG13    EQU   @13                                                      01143000
REG14    EQU   @14                                                      01144000
REG15    EQU   @15                                                      01145000
REG2     EQU   @02                                                      01146000
REG3     EQU   @03                                                      01147000
REG4     EQU   @04                                                      01148000
REG5     EQU   @05                                                      01149000
REG6     EQU   @06                                                      01150000
REG7     EQU   @07                                                      01151000
REG8     EQU   @08                                                      01152000
REG9     EQU   @09                                                      01153000
RTNREG   EQU   @15                                                      01154000
ICKSAEP0 EQU   0                                                        01155000
ICKSAFP0 EQU   0                                                        01156000
TRACE1   EQU   0                                                        01157000
OLDERID1 EQU   TRACE1                                                   01158000
TRACE2   EQU   0                                                        01159000
OLDERID2 EQU   TRACE2                                                   01160000
NEWID2   EQU   TRACE2+95                                                01161000
NEWERID2 EQU   5                                                        01162000
STAEPARM EQU   0                                                        01163000
STAEPFX  EQU   STAEPARM                                                 01164000
IOCSTR   EQU   0                                                        01165000
IOCDSO   EQU   IOCSTR+13                                                01166000
IOCRFM   EQU   IOCSTR+14                                                01167000
IOCMAC   EQU   IOCSTR+15                                                01168000
IOCMSG   EQU   IOCSTR+16                                                01169000
OPNAGL   EQU   0                                                        01170000
OPNOPT   EQU   OPNAGL                                                   01171000
OPNRFM   EQU   OPNAGL+1                                                 01172000
OPNTYP   EQU   OPNAGL+2                                                 01173000
OPNMOD   EQU   OPNAGL+3                                                 01174000
UVOLLIST EQU   0                                                        01175000
UVOLENT  EQU   UVOLLIST+2                                               01176000
ICKDVIN0 EQU   0                                                        01177000
ICKDVOP0 EQU   0                                                        01178000
DARGLIST EQU   0                                                        01179000
DARGSTID EQU   DARGLIST+8                                               01180000
DARGARY  EQU   DARGLIST+20                                              01181000
DARGINS  EQU   DARGARY                                                  01182000
DARGINL  EQU   DARGARY+2                                                01183000
FMTLIST  EQU   0                                                        01184000
FMTFLGS  EQU   FMTLIST                                                  01185000
FMTSPF   EQU   FMTLIST+2                                                01186000
FMTRFNO  EQU   FMTSPF                                                   01187000
FMTILEN  EQU   FMTRFNO                                                  01188000
FMTIOFF  EQU   FMTLIST+4                                                01189000
FMTTRBC  EQU   FMTIOFF                                                  01190000
FMTSTO   EQU   FMTTRBC                                                  01191000
FMTOCOL  EQU   FMTLIST+6                                                01192000
FMTCNVF  EQU   FMTLIST+10                                               01193000
ICKDB010 EQU   0                                                        01194000
DMPITM   EQU   0                                                        01195000
DMPARY   EQU   0                                                        01196000
IECSDSF4 EQU   0                                                        01197000
IECSDSL4 EQU   0                                                        01198000
DS4IDFMT EQU   IECSDSL4                                                 01199000
DS4DSREC EQU   IECSDSL4+6                                               01200000
DS4HCCHH EQU   IECSDSL4+8                                               01201000
DS4NOATK EQU   IECSDSL4+12                                              01202000
DS4NOEXT EQU   IECSDSL4+15                                              01203000
DS4DEVCT EQU   IECSDSL4+18                                              01204000
DS4DEVOV EQU   DS4DEVCT+6                                               01205000
DS4DEVDT EQU   DS4DEVCT+12                                              01206000
DS4AMCAT EQU   IECSDSL4+40                                              01207000
DS4VSIND EQU   DS4AMCAT                                                 01208000
DS4VTOCE EQU   IECSDSL4+61                                              01209000
IECSDSF5 EQU   0                                                        01210000
IECSDSL5 EQU   0                                                        01211000
DS5KEYID EQU   IECSDSL5                                                 01212000
DS5AVEXT EQU   IECSDSL5+4                                               01213000
DS5FMTID EQU   IECSDSL5+44                                              01214000
DEVCONST EQU   0                                                        01215000
TRKSCYL  EQU   0                                                        01216000
NUMPTRKS EQU   0                                                        01217000
MSSFLAG  EQU   0                                                        01218000
FREEDESC EQU   0                                                        01219000
FREERTA  EQU   FREEDESC                                                 01220000
FREECYL  EQU   FREEDESC+2                                               01221000
FREETRK  EQU   FREEDESC+4                                               01222000
DMPTRM   EQU   0                                                        01223000
ICKDVCL0 EQU   0                                                        01224000
ICKDVON0 EQU   0                                                        01225000
ICKIOCL0 EQU   0                                                        01226000
ICKIOGT0 EQU   0                                                        01227000
ICKIOIT0 EQU   0                                                        01228000
ICKIOOP0 EQU   0                                                        01229000
ICKIOPT0 EQU   0                                                        01230000
ICKIOTM0 EQU   0                                                        01231000
ICKSACL0 EQU   0                                                        01232000
ICKSADE0 EQU   0                                                        01233000
ICKSAFS0 EQU   0                                                        01234000
ICKSAGP0 EQU   0                                                        01235000
ICKSAGS0 EQU   0                                                        01236000
ICKSALD0 EQU   0                                                        01237000
ICKSAPR0 EQU   0                                                        01238000
ICKSASC0 EQU   0                                                        01239000
ICKSASN0 EQU   0                                                        01240000
ICKSAST0 EQU   0                                                        01241000
ICKSATI0 EQU   0                                                        01242000
ICKSAVC0 EQU   0                                                        01243000
ICKSAWO0 EQU   0                                                        01244000
ICKTPEA0 EQU   0                                                        01245000
ICKTPES0 EQU   0                                                        01246000
ICKTPPR0 EQU   0                                                        01247000
ICKTPRE0 EQU   0                                                        01248000
ICKTPRS0 EQU   0                                                        01249000
LISTTEST EQU   0                                                        01250000
NEWERID1 EQU   5                                                        01251000
GDTTBL   EQU   0                                                        01252000
GDTTR1   EQU   GDTTBL+8                                                 01253000
GDTTR2   EQU   GDTTBL+12                                                01254000
GDTDIN   EQU   GDTTBL+44                                                01255000
GDTDOP   EQU   GDTTBL+48                                                01256000
GDTDBG   EQU   GDTTBL+52                                                01257000
GDTDVO   EQU   GDTTBL+56                                                01258000
GDTPRT   EQU   GDTTBL+60                                                01259000
GDTESS   EQU   GDTTBL+64                                                01260000
GDTESA   EQU   GDTTBL+68                                                01261000
GDTRST   EQU   GDTTBL+72                                                01262000
GDTRES   EQU   GDTTBL+76                                                01263000
GDTCAL   EQU   GDTTBL+80                                                01264000
GDTGSP   EQU   GDTTBL+84                                                01265000
GDTFSP   EQU   GDTTBL+88                                                01266000
GDTGPL   EQU   GDTTBL+92                                                01267000
GDTFPL   EQU   GDTTBL+96                                                01268000
GDTLOD   EQU   GDTTBL+100                                               01269000
GDTDEL   EQU   GDTTBL+104                                               01270000
GDTPRL   EQU   GDTTBL+108                                               01271000
GDTEPL   EQU   GDTTBL+112                                               01272000
GDTTIM   EQU   GDTTBL+116                                               01273000
GDTIIO   EQU   GDTTBL+120                                               01274000
GDTTIO   EQU   GDTTBL+124                                               01275000
GDTOPN   EQU   GDTTBL+136                                               01276000
GDTCLS   EQU   GDTTBL+140                                               01277000
GDTGET   EQU   GDTTBL+144                                               01278000
GDTPUT   EQU   GDTTBL+148                                               01279000
GDTSNP   EQU   GDTTBL+160                                               01280000
GDTWTO   EQU   GDTTBL+168                                               01281000
GDTSCR   EQU   GDTTBL+172                                               01282000
GDTVCK   EQU   GDTTBL+176                                               01283000
GDTDVC   EQU   GDTTBL+180                                               01284000
GDTSTE   EQU   GDTTBL+188                                               01285000
VOLIB    EQU   0                                                        01286000
VTOCLOC  EQU   0                                                        01287000
EXTENT   EQU   0                                                        01288000
ALTS     EQU   0                                                        01289000
NEXTALT  EQU   0                                                        01290000
CONDCODE EQU   0                                                        01291000
@NM00025 EQU   VTOCLOC                                                  01292000
VTOCCYL  EQU   @NM00025                                                 01293000
VTOCHEAD EQU   @NM00025+2                                               01294000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01295000
GDTCVR   EQU   GDTTBL+184                                               01296000
GDTSPR   EQU   GDTTBL+164                                               01297000
GDTABH   EQU   GDTTBL+156                                               01298000
GDTABT   EQU   GDTTBL+152                                               01299000
GDTTOH   EQU   GDTTBL+132                                               01300000
GDTRIP   EQU   GDTTBL+128                                               01301000
GDTDVH   EQU   GDTTBL+40                                                01302000
GDTIOH   EQU   GDTTBL+36                                                01303000
GDTSAH   EQU   GDTTBL+32                                                01304000
GDTTPH   EQU   GDTTBL+28                                                01305000
GDTRIH   EQU   GDTTBL+24                                                01306000
GDTSTH   EQU   GDTTBL+20                                                01307000
GDTDBH   EQU   GDTTBL+16                                                01308000
GDTPRM   EQU   GDTTBL+4                                                 01309000
GDTHDR   EQU   GDTTBL                                                   01310000
DS5END   EQU   IECSDSL5+140                                             01311000
DS5PTRDS EQU   IECSDSL5+135                                             01312000
DS5MAVET EQU   IECSDSL5+45                                              01313000
DS5EXTAV EQU   IECSDSL5+9                                               01314000
@NM00023 EQU   IECSDSF5                                                 01315000
DS4END   EQU   IECSDSL4+96                                              01316000
@NM00022 EQU   IECSDSL4+71                                              01317000
DS4F6PTR EQU   IECSDSL4+56                                              01318000
@NM00021 EQU   IECSDSL4+51                                              01319000
DS4R2TIM EQU   IECSDSL4+43                                              01320000
DS4VSCRA EQU   DS4AMCAT+1                                               01321000
@NM00020 EQU   DS4VSIND                                                 01322000
DS4VSBAD EQU   DS4VSIND                                                 01323000
DS4VSREF EQU   DS4VSIND                                                 01324000
DS4AMTIM EQU   IECSDSL4+32                                              01325000
DS4DEVDB EQU   DS4DEVCT+13                                              01326000
DS4DEVTL EQU   DS4DEVCT+10                                              01327000
DS4DEVFG EQU   DS4DEVCT+9                                               01328000
DS4DEVK  EQU   DS4DEVCT+8                                               01329000
DS4DEVL  EQU   DS4DEVOV+1                                               01330000
DS4DEVI  EQU   DS4DEVOV                                                 01331000
DS4DEVTK EQU   DS4DEVCT+4                                               01332000
DS4DEVSZ EQU   DS4DEVCT                                                 01333000
@NM00019 EQU   IECSDSL4+16                                              01334000
DS4VTOCI EQU   IECSDSL4+14                                              01335000
DS4HPCHR EQU   IECSDSL4+1                                               01336000
@NM00018 EQU   IECSDSF4                                                 01337000
@NM00017 EQU   DMPARY+15                                                01338000
DMPARYTP EQU   DMPARY+14                                                01339000
DMPARYEX EQU   DMPARY+12                                                01340000
DMPARYIC EQU   DMPARY+10                                                01341000
DMPARYSZ EQU   DMPARY+8                                                 01342000
DMPARYNM EQU   DMPARY                                                   01343000
@NM00016 EQU   DMPITM+15                                                01344000
DMPITMTP EQU   DMPITM+14                                                01345000
DMPITMLN EQU   DMPITM+12                                                01346000
DMPITMPT EQU   DMPITM+8                                                 01347000
DMPITMNM EQU   DMPITM                                                   01348000
@NM00015 EQU   FMTCNVF+1                                                01349000
FMTBS    EQU   FMTCNVF+1                                                01350000
FMTSS    EQU   FMTCNVF+1                                                01351000
FMTAL    EQU   FMTCNVF+1                                                01352000
FMTZS    EQU   FMTCNVF+1                                                01353000
@NM00014 EQU   FMTCNVF                                                  01354000
FMTPU    EQU   FMTCNVF                                                  01355000
FMTBD    EQU   FMTCNVF                                                  01356000
FMTBHD   EQU   FMTCNVF                                                  01357000
FMTBHA   EQU   FMTCNVF                                                  01358000
FMTBH    EQU   FMTCNVF                                                  01359000
FMTOLEN  EQU   FMTLIST+8                                                01360000
FMTRIO   EQU   FMTOCOL                                                  01361000
FMTSPT   EQU   FMTSTO                                                   01362000
FMTSTL   EQU   FMTILEN                                                  01363000
@NM00013 EQU   FMTFLGS+1                                                01364000
FMTHDF   EQU   FMTFLGS                                                  01365000
FMTDFF   EQU   FMTFLGS                                                  01366000
FMTSTF   EQU   FMTFLGS                                                  01367000
FMTREPF  EQU   FMTFLGS                                                  01368000
FMTBDF   EQU   FMTFLGS                                                  01369000
FMTIDF   EQU   FMTFLGS                                                  01370000
FMTSCF   EQU   FMTFLGS                                                  01371000
FMTEOLF  EQU   FMTFLGS                                                  01372000
DARGDTM  EQU   DARGARY+4                                                01373000
DARGPCT  EQU   DARGINL                                                  01374000
DARGREP  EQU   DARGINS                                                  01375000
@NM00012 EQU   DARGLIST+19                                              01376000
DARGIND  EQU   DARGLIST+18                                              01377000
DARGRETL EQU   DARGLIST+16                                              01378000
DARGCNT  EQU   DARGLIST+14                                              01379000
DARGILP  EQU   DARGLIST+12                                              01380000
DARGSENT EQU   DARGSTID+3                                               01381000
DARGSMOD EQU   DARGSTID                                                 01382000
DARGRETP EQU   DARGLIST+4                                               01383000
DARGDBP  EQU   DARGLIST                                                 01384000
UVOLVOL  EQU   UVOLENT+4                                                01385000
UVOLDEV  EQU   UVOLENT                                                  01386000
UVOLCNT  EQU   UVOLLIST                                                 01387000
OPNRSVD  EQU   OPNAGL+28                                                01388000
OPNVOL   EQU   OPNAGL+24                                                01389000
OPNBLK   EQU   OPNAGL+20                                                01390000
OPNREC   EQU   OPNAGL+16                                                01391000
OPNDSN   EQU   OPNAGL+12                                                01392000
OPNDDN   EQU   OPNAGL+8                                                 01393000
OPNIOC   EQU   OPNAGL+4                                                 01394000
@NM00011 EQU   OPNMOD                                                   01395000
OPNMODRC EQU   OPNMOD                                                   01396000
OPNMODAC EQU   OPNMOD                                                   01397000
@NM00010 EQU   OPNTYP                                                   01398000
OPNTYPSO EQU   OPNTYP                                                   01399000
OPNTYPSI EQU   OPNTYP                                                   01400000
@NM00009 EQU   OPNRFM                                                   01401000
OPNRFMBK EQU   OPNRFM                                                   01402000
OPNRFMSF EQU   OPNRFM                                                   01403000
OPNRFMUN EQU   OPNRFM                                                   01404000
OPNRFMVR EQU   OPNRFM                                                   01405000
OPNRFMFX EQU   OPNRFM                                                   01406000
@NM00008 EQU   OPNOPT                                                   01407000
OPNOPTJM EQU   OPNOPT                                                   01408000
OPNOPTKS EQU   OPNOPT                                                   01409000
OPNOPTBK EQU   OPNOPT                                                   01410000
OPNOPTUP EQU   OPNOPT                                                   01411000
OPNOPTOT EQU   OPNOPT                                                   01412000
OPNOPTIN EQU   OPNOPT                                                   01413000
IOCEXT   EQU   IOCSTR+36                                                01414000
IOCRRN   EQU   IOCSTR+32                                                01415000
@NM00007 EQU   IOCSTR+30                                                01416000
IOCPNM   EQU   IOCSTR+28                                                01417000
IOCCBP   EQU   IOCSTR+24                                                01418000
IOCDSN   EQU   IOCSTR+20                                                01419000
@NM00006 EQU   IOCSTR+17                                                01420000
@NM00005 EQU   IOCMSG                                                   01421000
IOCMSGOP EQU   IOCMSG                                                   01422000
IOCMACPA EQU   IOCMAC                                                   01423000
@NM00004 EQU   IOCMAC                                                   01424000
IOCMACBK EQU   IOCMAC                                                   01425000
IOCMACUP EQU   IOCMAC                                                   01426000
IOCMACOT EQU   IOCMAC                                                   01427000
IOCMACIN EQU   IOCMAC                                                   01428000
@NM00003 EQU   IOCRFM                                                   01429000
IOCRFMBK EQU   IOCRFM                                                   01430000
IOCRFMSF EQU   IOCRFM                                                   01431000
IOCRFMUN EQU   IOCRFM                                                   01432000
IOCRFMVR EQU   IOCRFM                                                   01433000
IOCRFMFX EQU   IOCRFM                                                   01434000
@NM00002 EQU   IOCDSO                                                   01435000
IOCDSOPS EQU   IOCDSO                                                   01436000
IOCKYL   EQU   IOCSTR+12                                                01437000
IOCTRN   EQU   IOCSTR+8                                                 01438000
IOCDLN   EQU   IOCSTR+4                                                 01439000
IOCDAD   EQU   IOCSTR                                                   01440000
STAEWORK EQU   STAEPARM+32                                              01441000
STARPTR  EQU   STAEPFX+28                                               01442000
STASPTR  EQU   STAEPFX+24                                               01443000
STALEN   EQU   STAEPFX+20                                               01444000
STAID    EQU   STAEPFX+16                                               01445000
STAEPA   EQU   STAEPFX+12                                               01446000
STAGDT   EQU   STAEPFX+8                                                01447000
STABPTR  EQU   STAEPFX+4                                                01448000
STAFPTR  EQU   STAEPFX                                                  01449000
NEWID1   EQU   TRACE1+95                                                01450000
CALLID   EQU   OLDERID1+90                                              01451000
@NM00001 EQU   OLDERID1                                                 01452000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01453000
@RF00231 EQU   @EL00002                                                 01454000
@RF00233 EQU   @EL00002                                                 01455000
@RF00266 EQU   @EL00003                                                 01456000
@RF00311 EQU   @EL00004                                                 01457000
@PB00004 EQU   @PB00005                                                 01458000
@RC00340 EQU   @RC00338                                                 01459000
@PB00003 EQU   @PB00004                                                 01460000
@PB00002 EQU   @PB00003                                                 01461000
@ENDDATA EQU   *                                                        01462000
         END   ICKWV01,(C'PLS1843',0701,78192)                          01463000
