         TITLE 'IECIOFT1-IOS CONTROL BLOCK FORMAT MODULE               *00001000
                        '                                               00002000
IECIOFT1 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'IECIOFT1  77.005'                                 0001 00009000
IECIOEXD DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP00119-IECIOEXD)                                   00013000
         ENTRY IECIOEXD                                                 00014000
IECIOUCB DS    0H                                                  0001 00015000
         USING *,@15                                               0001 00016000
         B     @PROLOG                                             0001 00017000
         DC    AL2(@EP00154-IECIOUCB)                                   00018000
         ENTRY IECIOUCB                                                 00019000
         DROP  @15                                                      00020000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00021000
         BALR  @12,0                                               0001 00022000
@PSTART  DS    0H                                                  0001 00023000
         USING @PSTART,@12                                         0001 00024000
         L     @00,@SIZDATD                                        0001 00025000
         GETMAIN  R,LV=(0)                                              00026000
         LR    @11,@01                                             0001 00027000
         USING @DATD,@11                                           0001 00028000
         ST    @13,@SA00001+4                                      0001 00029000
         LM    @15,@01,16(@13)                                     0001 00030000
         ST    @11,8(,@13)                                         0001 00031000
         LR    @13,@11                                             0001 00032000
         AH    @15,4(,@15)                                         0001 00033000
         BR    @15                                                 0001 00034000
@EP00001 DS    0H                                                  0002 00035000
*IECIOEXD:                                                         0119 00036000
*   ENTRY;                                                         0119 00037000
*                                                                  0119 00038000
@EP00119 DS    0H                                                  0120 00039000
*/********************************************************************/ 00040000
*/* FUNCTION -                                                     0120 00041000
*      ROUTINE WHICH FORMATS THE IOS EXCP DEBUG AREA (XDBA,ALSO KNOWN   00042000
*      AS EXCPD). IT SETS UP THE POINTERS TO BE PASSED TO THE FORMAT    00043000
*      SERVICE ROUTINE SENT IN THE PARAMETER LIST. FOR A NON-ZERO  0120 00044000
*      RETURN CODE FROM THE FORMATTING SERVICE THE FOLLOWING MESSAGE    00045000
*      WILL BE PRINTED:                                            0120 00046000
*               *** FORMATTING SERVICE ROUTINE ERROR DURING EXCPD(XDBA) 00047000
*                   FORMATTING (POSSIBLE CAUSE: DATA NOT IN DUMP) ***   00048000
*      AT THIS POINT PROCESSING WOULD TERMINATE.                   0120 00049000
*                                                                  0120 00050000
*   INPUT -                                                        0120 00051000
*      REGISTER 1 POINTS TO THE PARAMETER WHICH CONTAINS THE ADDRESS    00052000
*      OF THE CONTROL BLOCK TO BE FORMATTED IN ADPLFMT2. ADPLFMT1, ALSO 00053000
*      DEFINED AS START,CONTAINS THE OFFSET TO BE PLACED ALONG SIDE THE 00054000
*      FIRST FIELD IN THE CONTROL BLOCK, AND ADPLCOM1 HAS THE ADDRESS   00055000
*      OF THE ESTAE PARAMETER LIST.                                0120 00056000
*                                                                  0120 00057000
*   CALLS -                                                        0120 00058000
*      CONVERT, FMTRTN, AND PRINT                                  0120 00059000
*                                                                  0120 00060000
*   CALLED BY -                                                    0120 00061000
*      IECIOFMT TO FORMAT THE XDBA(EXCPD)                          0120 00062000
*                                                                  0120 00063000
*   RETURNS TO -                                                   0120 00064000
*      CALLER WITH THE RETURN CODE SET BT THE FORMAT SERVICE ROUTINE    00065000
*                                                                    */ 00066000
*/********************************************************************/ 00067000
*                                                                  0120 00068000
*   ESTAPTR=ADPLCOM1;               /* SAVE PTR TO ESTAE PARM LIST   */ 00069000
         L     ESTAPTR,ADPLCOM1(,ABDPLPTR)                         0120 00070000
*   EXCPDPTR=ADPLFMT2;              /* POINTER TO EXCPD PASSED IN  0121 00071000
*                                      PARMLIST                      */ 00072000
         L     EXCPDPTR,ADPLFMT2(,ABDPLPTR)                        0121 00073000
*   SAVEPTR=EXCPDPTR-START;         /* VALUE FOR OFFSETS             */ 00074000
         LR    SAVEPTR,EXCPDPTR                                    0122 00075000
         SL    SAVEPTR,START(,ABDPLPTR)                            0122 00076000
*   ADPLCOM1=ADDR(EXCPDMSG);        /* ERROR MSG                     */ 00077000
         LA    @14,EXCPDMSG                                        0123 00078000
         ST    @14,ADPLCOM1(,ABDPLPTR)                             0123 00079000
*   STM(VADR,RCREG,LCALREGS);       /* SAVE REGS FOR EXPECTED RETRY  */ 00080000
         STM   VADR,RCREG,LCALREGS(ESTAPTR)                        0124 00081000
*   ERRSW=OFF;                      /* ERROR INDICATOR               */ 00082000
*                                                                  0125 00083000
         NI    ERRSW,B'01111111'                                   0125 00084000
*   /*****************************************************************/ 00085000
*   /*                                                               */ 00086000
*   /* PRINT THE HEADER FOR THE XDBA                                 */ 00087000
*   /*                                                               */ 00088000
*   /*****************************************************************/ 00089000
*                                                                  0126 00090000
*   BUFFER(1:LENGTH(EXCPDHDR))=EXCPDHDR;/* TITLE LINE                */ 00091000
         L     @14,ADPLBUF(,ABDPLPTR)                              0126 00092000
         MVC   BUFFER(54,@14),EXCPDHDR                             0126 00093000
*   PACKAREA=EXCPDPTR;              /* MOVE ADDR INTO CHAR AREA      */ 00094000
         ST    EXCPDPTR,PACKAREA                                   0127 00095000
*   GARBAGE='04'X;                  /* GARBAGE BYTE FOR UNPACK       */ 00096000
         MVI   GARBAGE,X'04'                                       0128 00097000
*   UNPK(ADDRESS,UNPACK);           /* UNPACK INTO BUFFER LINE       */ 00098000
         UNPK  ADDRESS(9,@14),UNPACK(5)                            0129 00099000
*   TR(ADDRESS,TRANS);              /* MAKE PRINTABLE                */ 00100000
         TR    ADDRESS(9,@14),TRANS                                0130 00101000
*   CALL PRINT;                     /* PRINT IT                      */ 00102000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0131 00103000
         BALR  @14,@15                                             0131 00104000
*   BUFFER(1:LENGTH(EXCPUS))=EXCPUS;/* UNDERSCORE                    */ 00105000
         L     @14,ADPLBUF(,ABDPLPTR)                              0132 00106000
         MVC   BUFFER(6,@14),EXCPUS                                0132 00107000
*   CALL PRINT;                     /* PRINT IT                      */ 00108000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0133 00109000
         BALR  @14,@15                                             0133 00110000
*   CALL PRINT;                     /* BLANK                         */ 00111000
*                                                                  0134 00112000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0134 00113000
         BALR  @14,@15                                             0134 00114000
*   /*****************************************************************/ 00115000
*   /*                                                               */ 00116000
*   /* FORMAT THE FIRST SECTION OF THE XDBA                          */ 00117000
*   /*                                                               */ 00118000
*   /*****************************************************************/ 00119000
*                                                                  0135 00120000
*   DO ARRAYCNT=1 TO DIM(XDBANAME) WHILE(ERRSW=OFF);/* PRINT ALL   0135 00121000
*                                      LINES FOR XDBA UNTIL RQE      */ 00122000
         LA    ARRAYCNT,1                                          0135 00123000
@DL00135 TM    ERRSW,B'10000000'                                   0135 00124000
         BNZ   @DC00135                                            0135 00125000
*     LINEPTR=XDBANAME(ARRAYCNT);   /* POINTER TO FORMAT PATTERN     */ 00126000
         LR    @14,ARRAYCNT                                        0136 00127000
         SLA   @14,2                                               0136 00128000
         L     LINEPTR,XDBANAME-4(@14)                             0136 00129000
*     CALL CONVERT;                 /* GENERATE OFFSET               */ 00130000
         BAL   @14,CONVERT                                         0137 00131000
*     CALL FMTRTN;                  /* FORMAT AND PRINT              */ 00132000
         BAL   @14,FMTRTN                                          0138 00133000
*   END;                            /* END FORMAT LOOP               */ 00134000
         AH    ARRAYCNT,@CH00039                                   0139 00135000
         CH    ARRAYCNT,@CH00154                                   0139 00136000
         BNH   @DL00135                                            0139 00137000
@DC00135 DS    0H                                                  0140 00138000
*   LINEPTR=ADDR(XDBAF5);           /* NEXT FORMAT PATTERN WHICH GET    00139000
*                                      REPEATED A NUMBER OF TIMES    */ 00140000
         LA    LINEPTR,XDBAF5                                      0140 00141000
*   DO ARRAYCNT=1 TO LISTMAX WHILE(ERRSW=OFF);/* REST OF CONTROL   0141 00142000
*                                      BLOCK                         */ 00143000
         LA    ARRAYCNT,1                                          0141 00144000
@DL00141 TM    ERRSW,B'10000000'                                   0141 00145000
         BNZ   @DC00141                                            0141 00146000
*     CALL CONVERT;                 /* GENERATE OFFSET               */ 00147000
         BAL   @14,CONVERT                                         0142 00148000
*     CALL FMTRTN;                  /* FORMAT AND PRINT              */ 00149000
         BAL   @14,FMTRTN                                          0143 00150000
*   END;                            /* END REST OF XDBA FORMATTING   */ 00151000
         AH    ARRAYCNT,@CH00039                                   0144 00152000
         CH    ARRAYCNT,@CH00967                                   0144 00153000
         BNH   @DL00141                                            0144 00154000
@DC00141 DS    0H                                                  0145 00155000
*   IF ERRSW=OFF THEN               /* FORMATTED ALL LINES SO FAR OK */ 00156000
         TM    ERRSW,B'10000000'                                   0145 00157000
         BNZ   @RF00145                                            0145 00158000
*     DO;                                                          0146 00159000
*       LINEPTR=ADDR(XDBAF3);       /* LAST LINE OF OUTPUT           */ 00160000
         LA    LINEPTR,XDBAF3                                      0147 00161000
*       CALL CONVERT;               /* GENERATE OFFSET               */ 00162000
         BAL   @14,CONVERT                                         0148 00163000
*       CALL FMTRTN;                /* FORMAT AND PRINT              */ 00164000
         BAL   @14,FMTRTN                                          0149 00165000
*     END;                          /* END FORMATTED ALL LINES OK    */ 00166000
*   ELSE                                                           0151 00167000
*     ;                             /* ERROR FORMATTING BEB/FIX LISTS*/ 00168000
@RF00145 DS    0H                                                  0152 00169000
*   LCALREGS=RTYREGS;               /* RESTORE CALLERS EXPECTED ERROR   00170000
*                                      REGS                          */ 00171000
         MVC   LCALREGS(64,ESTAPTR),RTYREGS(ESTAPTR)               0152 00172000
*   RETURN CODE(RCCODE);                                           0153 00173000
         L     @13,4(,@13)                                         0153 00174000
         L     @00,@SIZDATD                                        0153 00175000
         LR    @01,@11                                             0153 00176000
         FREEMAIN R,LV=(0),A=(1)                                        00177000
         LR    @15,@07                                             0153 00178000
         L     @14,12(,@13)                                        0153 00179000
         LM    @00,@12,20(@13)                                     0153 00180000
         BR    @14                                                 0153 00181000
*IECIOUCB:                                                         0154 00182000
*   ENTRY;                                                         0154 00183000
*                                                                  0154 00184000
@EP00154 DS    0H                                                  0155 00185000
*/********************************************************************/ 00186000
*/* FUNCTION -                                                     0155 00187000
*      ROUTINE WHICH FORMATS THE UNIT CONTROL BLOCK(UCB). IT SETS  0155 00188000
*      UP THE POINTERS TO BE PASSED TO THE FORMAT SERVICE ROUTINE  0155 00189000
*      SENT IN THE PARAMETER LIST. FOR A NON-ZERO RETURN CODE FROM THE  00190000
*      FORMATTING SERVICE THE FOLLOWING MESSAGE WILL BE PRINTED:   0155 00191000
*               *** FORMATTING SERVICE ROUTINE ERROR DURING UCB    0155 00192000
*                   FORMATTING (POSSIBLE CAUSE: DATA NOT IN DUMP) ***   00193000
*      IF THERE IS AN ERROR TRYING TO ACCESS THE UCBTYPE FIELD OR IF    00194000
*      THE FIELD IS INVALID THE FOLLOWING MESSAGE WILL BE PRINTED: 0155 00195000
*               *** UNKNOWN UCB TYPE FOR UCB AT LOCATION XXXXXXXX  0155 00196000
*      AT THIS POINT, FOR EITHER REASON, PROCESSING WOULD TERMINATE.    00197000
*                                                                  0155 00198000
*   INPUT -                                                        0155 00199000
*      REGISTER 1 POINTS TO THE PARAMETER WHICH CONTAINS THE ADDRESS    00200000
*      OF THE CONTROL BLOCK TO BE FORMATTED IN ADPLFMT2. ADPLFMT1, ALSO 00201000
*      DEFINED AS START,CONTAINS THE OFFSET TO BE PLACED ALONG SIDE THE 00202000
*      FIRST FIELD IN THE CONTROL BLOCK, AND ADPLCOM1 CONTAINS THE 0155 00203000
*      ADDRESS OF THE ESTAE PARAMETER LIST.                        0155 00204000
*                                                                  0155 00205000
*   CALLS -                                                        0155 00206000
*      ACCESRTN,CONVERT,FMTRTN, AND PRINT                          0155 00207000
*                                                                  0155 00208000
*   CALLED BY -                                                    0155 00209000
*      IECIOFMT TO FORMAT THE UNIT CONTROL BLOCK                   0155 00210000
*                                                                  0155 00211000
*   RETURNS TO -                                                   0155 00212000
*      CALLER WITH THE RETURN CODE SET BY THE ACCESS OR FORMAT SERVICE  00213000
*      ROUTINE.                                                    0155 00214000
*                                                                    */ 00215000
*/********************************************************************/ 00216000
*                                                                  0155 00217000
*   ESTAPTR=ADPLCOM1;               /* SAVE PTR TO ESTAE PARM LIST   */ 00218000
         L     ESTAPTR,ADPLCOM1(,ABDPLPTR)                         0155 00219000
*   UCBPTR=ADPLFMT2;                /* PTR TO UCB PASSED IN PARMLIST */ 00220000
         L     UCBPTR,ADPLFMT2(,ABDPLPTR)                          0156 00221000
*   SAVEPTR=UCBPTR-START;           /* USED FOR FIGURING OFFSET      */ 00222000
         LR    SAVEPTR,UCBPTR                                      0157 00223000
         SL    SAVEPTR,START(,ABDPLPTR)                            0157 00224000
*   ADPLCOM1=ADDR(UCBMSG);          /* FORMAT ERROR MESSAGE          */ 00225000
         LA    @14,UCBMSG                                          0158 00226000
         ST    @14,ADPLCOM1(,ABDPLPTR)                             0158 00227000
*   STM(VADR,RCREG,LCALREGS);       /* SAVE REGS FOR EXPECTED RETRY  */ 00228000
         STM   VADR,RCREG,LCALREGS(ESTAPTR)                        0159 00229000
*   ERRSW=OFF;                      /* INITIALIZE ERROR INDICATOR    */ 00230000
*                                                                  0160 00231000
         NI    ERRSW,B'01111111'                                   0160 00232000
*   /*****************************************************************/ 00233000
*   /*                                                               */ 00234000
*   /* INITIALIZE HEADER FOR THE UCB                                 */ 00235000
*   /*                                                               */ 00236000
*   /*****************************************************************/ 00237000
*                                                                  0161 00238000
*   BUFFER(1:LENGTH(UCBHDR))=UCBHDR;/* HEADER LINE                   */ 00239000
         L     @14,ADPLBUF(,ABDPLPTR)                              0161 00240000
         MVC   BUFFER(54,@14),UCBHDR                               0161 00241000
*   PACKAREA=UCBPTR;                /* MOVE ADDR INTO CHAR AREA      */ 00242000
         ST    UCBPTR,PACKAREA                                     0162 00243000
*   GARBAGE='04'X;                  /* GARBAGE BYTE FOR UNPACK       */ 00244000
         MVI   GARBAGE,X'04'                                       0163 00245000
*   UNPK(ADDRESS,UNPACK);           /* UNPACK INTO BUFFER LINE       */ 00246000
         UNPK  ADDRESS(9,@14),UNPACK(5)                            0164 00247000
*   TR(ADDRESS,TRANS);              /* MAKE PRINTABLE                */ 00248000
         TR    ADDRESS(9,@14),TRANS                                0165 00249000
*   VADR=ADDR(UCBTYP);              /* DEVICE TYPE                   */ 00250000
         LA    VADR,UCBTYP(,UCBPTR)                                0166 00251000
*   CALL ACCESRTN;                  /* ACCESS IT                     */ 00252000
         BAL   @14,ACCESRTN                                        0167 00253000
*   IF RCREG^=ZERO|DATAWORD=ZERO THEN/* ERROR FINDING UCBTYPE        */ 00254000
         SLR   @14,@14                                             0168 00255000
         CR    RCREG,@14                                           0168 00256000
         BNE   @RT00168                                            0168 00257000
         C     @14,DATAWORD(,DATAPTR)                              0168 00258000
         BNE   @RF00168                                            0168 00259000
@RT00168 DS    0H                                                  0169 00260000
*     BUFFER(1:LENGTH(UNKNOWN))=UNKNOWN;                           0169 00261000
         L     @14,ADPLBUF(,ABDPLPTR)                              0169 00262000
         MVC   BUFFER(56,@14),UNKNOWN                              0169 00263000
*   ELSE                            /* FOUND UCB TYPE TO BE INSERTED    00264000
*                                      IN THE HEADER                 */ 00265000
*     DO;                                                          0170 00266000
         B     @RC00168                                            0170 00267000
@RF00168 DS    0H                                                  0171 00268000
*       TYPBYTE=DATAWORD;           /* SAVE DEVICE TYPE FIELDS       */ 00269000
         MVC   TYPBYTE(4),DATAWORD(DATAPTR)                        0171 00270000
*       ADPLFMT2=ADPLFMT2-PREFIX;   /* START UCB FORMATTING AT PREFIX*/ 00271000
         L     @14,ADPLFMT2(,ABDPLPTR)                             0172 00272000
         SH    @14,@CH00072                                        0172 00273000
         ST    @14,ADPLFMT2(,ABDPLPTR)                             0172 00274000
*       IF TBYTE3=MAGTAPE THEN      /* MAGNETIC TAPE UCB             */ 00275000
*                                                                  0173 00276000
         CLC   TBYTE3(1),MAGTAPE                                   0173 00277000
         BNE   @RF00173                                            0173 00278000
*         /***********************************************************/ 00279000
*         /*                                                         */ 00280000
*         /* MAGNETIC TAPE UCB                                       */ 00281000
*         /*                                                         */ 00282000
*         /***********************************************************/ 00283000
*                                                                  0174 00284000
*         DO;                                                      0174 00285000
*           HDRTYPE(1:LENGTH(MAGHDR))=MAGHDR;/* FILL IN UCB TYPE     */ 00286000
         L     @14,ADPLBUF(,ABDPLPTR)                              0175 00287000
         MVC   HDRTYPE(20,@14),MAGHDR                              0175 00288000
*           CALL PRINT;             /* PRINT HEADER                  */ 00289000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0176 00290000
         BALR  @14,@15                                             0176 00291000
*           BUFFER(1:LENGTH(UCBUS))=UCBUS;/* UNDER SCORE             */ 00292000
         L     @14,ADPLBUF(,ABDPLPTR)                              0177 00293000
         MVC   BUFFER(5,@14),UCBUS                                 0177 00294000
*           CALL PRINT;             /* PRINT IT                      */ 00295000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0178 00296000
         BALR  @14,@15                                             0178 00297000
*           CALL PRINT;             /* BLANK LINE                    */ 00298000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0179 00299000
         BALR  @14,@15                                             0179 00300000
*           DO ARRAYCNT=1 TO DIM(MAGDARAY) WHILE(ERRSW=OFF);/* FORMAT   00301000
*                                      PATTERN ARRAY                 */ 00302000
         LA    ARRAYCNT,1                                          0180 00303000
@DL00180 TM    ERRSW,B'10000000'                                   0180 00304000
         BNZ   @DC00180                                            0180 00305000
*             LINEPTR=MAGDARAY(ARRAYCNT);/* FORMAT PATTERN ADDR      */ 00306000
         LR    @14,ARRAYCNT                                        0181 00307000
         SLA   @14,2                                               0181 00308000
         L     LINEPTR,MAGDARAY-4(@14)                             0181 00309000
*             CALL CONVERT;         /* GENERATE OFFSET               */ 00310000
         BAL   @14,CONVERT                                         0182 00311000
*             CALL FMTRTN;          /* FORMAT                        */ 00312000
         BAL   @14,FMTRTN                                          0183 00313000
*           END;                    /* END FORMAT LOOP FILL IN HDR 0184 00314000
*                                      AND FORMAT                    */ 00315000
         AH    ARRAYCNT,@CH00039                                   0184 00316000
         CH    ARRAYCNT,@CH00156                                   0184 00317000
         BNH   @DL00180                                            0184 00318000
@DC00180 DS    0H                                                  0185 00319000
*         END;                      /* END MAGNETIC TAPE TYPE        */ 00320000
*       ELSE                        /* NOT A MAGNETIC TAPE UCB       */ 00321000
*         IF TBYTE3=CTCTYPE THEN    /* CHANNEL TO CHANNEL UCB        */ 00322000
*                                                                  0186 00323000
         B     @RC00173                                            0186 00324000
@RF00173 CLC   TBYTE3(1),CTCTYPE                                   0186 00325000
         BNE   @RF00186                                            0186 00326000
*           /*********************************************************/ 00327000
*           /*                                                       */ 00328000
*           /* CHANNEL TO CHANNEL UCB                                */ 00329000
*           /*                                                       */ 00330000
*           /*********************************************************/ 00331000
*                                                                  0187 00332000
*           DO;                                                    0187 00333000
*             HDRTYPE(1:LENGTH(CTCHDR))=CTCHDR;/* FILL IN UCB TYPE   */ 00334000
         L     @14,ADPLBUF(,ABDPLPTR)                              0188 00335000
         MVC   HDRTYPE(25,@14),CTCHDR                              0188 00336000
*             CALL PRINT;           /* PRINT HEADER                  */ 00337000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0189 00338000
         BALR  @14,@15                                             0189 00339000
*             BUFFER(1:LENGTH(UCBUS))=UCBUS;/* UNDER SCORE           */ 00340000
         L     @14,ADPLBUF(,ABDPLPTR)                              0190 00341000
         MVC   BUFFER(5,@14),UCBUS                                 0190 00342000
*             CALL PRINT;           /* PRINT IT                      */ 00343000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0191 00344000
         BALR  @14,@15                                             0191 00345000
*             CALL PRINT;           /* BLANK LINE                    */ 00346000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0192 00347000
         BALR  @14,@15                                             0192 00348000
*             DO ARRAYCNT=1 TO DIM(CTCARRAY) WHILE(ERRSW=OFF);/*   0193 00349000
*                                      FORMAT PATTERN ARRAY          */ 00350000
         LA    ARRAYCNT,1                                          0193 00351000
@DL00193 TM    ERRSW,B'10000000'                                   0193 00352000
         BNZ   @DC00193                                            0193 00353000
*               LINEPTR=CTCARRAY(ARRAYCNT);/* FORMAT PATTERN ADDR    */ 00354000
         LR    @14,ARRAYCNT                                        0194 00355000
         SLA   @14,2                                               0194 00356000
         L     LINEPTR,CTCARRAY-4(@14)                             0194 00357000
*               CALL CONVERT;       /* GENERATE OFFSET               */ 00358000
         BAL   @14,CONVERT                                         0195 00359000
*               CALL FMTRTN;        /* FORMAT                        */ 00360000
         BAL   @14,FMTRTN                                          0196 00361000
*             END;                  /* END FORMAT LOOP FILL IN HDR 0197 00362000
*                                      AND FORMAT                    */ 00363000
         AH    ARRAYCNT,@CH00039                                   0197 00364000
         CH    ARRAYCNT,@CH00156                                   0197 00365000
         BNH   @DL00193                                            0197 00366000
@DC00193 DS    0H                                                  0198 00367000
*           END;                    /* END CHANNEL TO CHANNEL UCB    */ 00368000
*         ELSE                      /* NOT A CHANNEL TO CHANNEL UCB  */ 00369000
*           IF TBYTE3=COMTYPE THEN  /* COMMUNICATIONS TYPE UCB       */ 00370000
         B     @RC00186                                            0199 00371000
@RF00186 CLC   TBYTE3(1),COMTYPE                                   0199 00372000
         BNE   @RF00199                                            0199 00373000
*             DO;                                                  0200 00374000
*               IF(TBYTE4&MASK3704)=MASK3704 THEN/* 3704,3705 TYPE   */ 00375000
         SLR   @14,@14                                             0201 00376000
         IC    @14,MASK3704                                        0201 00377000
         SLR   @10,@10                                             0201 00378000
         IC    @10,TBYTE4                                          0201 00379000
         NR    @10,@14                                             0201 00380000
         CR    @10,@14                                             0201 00381000
         BNE   @RF00201                                            0201 00382000
*                 DO;                                              0202 00383000
*                                                                  0202 00384000
*                   /*************************************************/ 00385000
*                   /*                                               */ 00386000
*                   /* 3704,3705 UCB                                 */ 00387000
*                   /*                                               */ 00388000
*                   /*************************************************/ 00389000
*                                                                  0203 00390000
*                   HDRTYPE(1:LENGTH(HDR3704))=HDR3704;/* FILL IN UCB   00391000
*                                      TYPE                          */ 00392000
         L     @14,ADPLBUF(,ABDPLPTR)                              0203 00393000
         MVC   HDRTYPE(31,@14),HDR3704                             0203 00394000
*                   CALL PRINT;     /* PRINT HEADER                  */ 00395000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0204 00396000
         BALR  @14,@15                                             0204 00397000
*                   BUFFER(1:LENGTH(UCBUS))=UCBUS;/* UNDER SCORE     */ 00398000
         L     @14,ADPLBUF(,ABDPLPTR)                              0205 00399000
         MVC   BUFFER(5,@14),UCBUS                                 0205 00400000
*                   CALL PRINT;     /* PRINT IT                      */ 00401000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0206 00402000
         BALR  @14,@15                                             0206 00403000
*                   CALL PRINT;     /* BLANK LINE                    */ 00404000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0207 00405000
         BALR  @14,@15                                             0207 00406000
*                   DO ARRAYCNT=1 TO DIM(ARRY3704) WHILE(ERRSW=OFF);    00407000
         LA    ARRAYCNT,1                                          0208 00408000
@DL00208 TM    ERRSW,B'10000000'                                   0208 00409000
         BNZ   @DC00208                                            0208 00410000
*                                   /* FORMAT PATTERN ARRAY          */ 00411000
*                     LINEPTR=ARRY3704(ARRAYCNT);/* FORMAT PATTERN 0209 00412000
*                                      ADDR                          */ 00413000
         LR    @14,ARRAYCNT                                        0209 00414000
         SLA   @14,2                                               0209 00415000
         L     LINEPTR,ARRY3704-4(@14)                             0209 00416000
*                     CALL CONVERT; /* GENERATE OFFSET               */ 00417000
         BAL   @14,CONVERT                                         0210 00418000
*                     CALL FMTRTN;  /* FORMAT                        */ 00419000
         BAL   @14,FMTRTN                                          0211 00420000
*                   END;            /* END FORMAT LOOP FILL IN HDR 0212 00421000
*                                      AND FORMAT                    */ 00422000
         AH    ARRAYCNT,@CH00039                                   0212 00423000
         CH    ARRAYCNT,@CH00156                                   0212 00424000
         BNH   @DL00208                                            0212 00425000
@DC00208 DS    0H                                                  0213 00426000
*                 END;              /* END 3704,3705 TYPE            */ 00427000
*               ELSE                /* NOT 3704,3705 TYPE            */ 00428000
*                 DO;                                              0214 00429000
*                                                                  0214 00430000
         B     @RC00201                                            0214 00431000
@RF00201 DS    0H                                                  0215 00432000
*                   /*************************************************/ 00433000
*                   /*                                               */ 00434000
*                   /* COMMUNICATIONS UCB                            */ 00435000
*                   /*                                               */ 00436000
*                   /*************************************************/ 00437000
*                                                                  0215 00438000
*                   HDRTYPE(1:LENGTH(COMHDR))=COMHDR;/* FILL IN UCB     00439000
*                                      TYPE                          */ 00440000
         L     @14,ADPLBUF(,ABDPLPTR)                              0215 00441000
         MVC   HDRTYPE(21,@14),COMHDR                              0215 00442000
*                   CALL PRINT;     /* PRINT HEADER                  */ 00443000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0216 00444000
         BALR  @14,@15                                             0216 00445000
*                   BUFFER(1:LENGTH(UCBUS))=UCBUS;/* UNDER SCORE     */ 00446000
         L     @14,ADPLBUF(,ABDPLPTR)                              0217 00447000
         MVC   BUFFER(5,@14),UCBUS                                 0217 00448000
*                   CALL PRINT;     /* PRINT IT                      */ 00449000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0218 00450000
         BALR  @14,@15                                             0218 00451000
*                   CALL PRINT;     /* BLANK LINE                    */ 00452000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0219 00453000
         BALR  @14,@15                                             0219 00454000
*                   DO ARRAYCNT=1 TO DIM(COMARRAY) WHILE(ERRSW=OFF);    00455000
         LA    ARRAYCNT,1                                          0220 00456000
@DL00220 TM    ERRSW,B'10000000'                                   0220 00457000
         BNZ   @DC00220                                            0220 00458000
*                                   /* FORMAT PATTERN ARRAY          */ 00459000
*                     LINEPTR=COMARRAY(ARRAYCNT);/* FORMAT PATTERN 0221 00460000
*                                      ADDR                          */ 00461000
         LR    @14,ARRAYCNT                                        0221 00462000
         SLA   @14,2                                               0221 00463000
         L     LINEPTR,COMARRAY-4(@14)                             0221 00464000
*                     CALL CONVERT; /* GENERATE OFFSET               */ 00465000
         BAL   @14,CONVERT                                         0222 00466000
*                     CALL FMTRTN;  /* FORMAT                        */ 00467000
         BAL   @14,FMTRTN                                          0223 00468000
*                   END;            /* END FORMAT LOOP FILL IN HDR 0224 00469000
*                                      AND FORMAT                    */ 00470000
         AH    ARRAYCNT,@CH00039                                   0224 00471000
         CH    ARRAYCNT,@CH00154                                   0224 00472000
         BNH   @DL00220                                            0224 00473000
@DC00220 DS    0H                                                  0225 00474000
*                 END;              /* END NOT 3704,3705 UCB         */ 00475000
*             END;                  /* END COMMUNICATIONS UCB        */ 00476000
*           ELSE                    /* NOT COMMUNICATIONS UCB        */ 00477000
*             IF TBYTE3=DATYPE THEN /* DIRECT ACCESS TYPE            */ 00478000
         B     @RC00199                                            0227 00479000
@RF00199 CLC   TBYTE3(1),DATYPE                                    0227 00480000
         BNE   @RF00227                                            0227 00481000
*               DO;                                                0228 00482000
*                                                                  0228 00483000
*                 /***************************************************/ 00484000
*                 /*                                                 */ 00485000
*                 /* DIRECT ACCESS UCB                               */ 00486000
*                 /*                                                 */ 00487000
*                 /***************************************************/ 00488000
*                                                                  0229 00489000
*                 HDRTYPE(1:LENGTH(DAHDR))=DAHDR;/* FILL IN UCB TYPE */ 00490000
         L     @14,ADPLBUF(,ABDPLPTR)                              0229 00491000
         MVC   HDRTYPE(20,@14),DAHDR                               0229 00492000
*                 CALL PRINT;       /* PRINT HEADER                  */ 00493000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0230 00494000
         BALR  @14,@15                                             0230 00495000
*                 BUFFER(1:LENGTH(UCBUS))=UCBUS;/* UNDER SCORE       */ 00496000
         L     @14,ADPLBUF(,ABDPLPTR)                              0231 00497000
         MVC   BUFFER(5,@14),UCBUS                                 0231 00498000
*                 CALL PRINT;       /* PRINT IT                      */ 00499000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0232 00500000
         BALR  @14,@15                                             0232 00501000
*                 CALL PRINT;       /* BLANK LINE                    */ 00502000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0233 00503000
         BALR  @14,@15                                             0233 00504000
*                 DO ARRAYCNT=1 TO DIM(DARRAY) WHILE(ERRSW=OFF);/* 0234 00505000
*                                      FORMAT PATTERN ARRAY          */ 00506000
         LA    ARRAYCNT,1                                          0234 00507000
@DL00234 TM    ERRSW,B'10000000'                                   0234 00508000
         BNZ   @DC00234                                            0234 00509000
*                   LINEPTR=DARRAY(ARRAYCNT);/* FORMAT PATTERN ADDR  */ 00510000
         LR    @14,ARRAYCNT                                        0235 00511000
         SLA   @14,2                                               0235 00512000
         L     LINEPTR,DARRAY-4(@14)                               0235 00513000
*                   CALL CONVERT;   /* GENERATE OFFSET               */ 00514000
         BAL   @14,CONVERT                                         0236 00515000
*                   CALL FMTRTN;    /* FORMAT                        */ 00516000
         BAL   @14,FMTRTN                                          0237 00517000
*                 END;              /* END FORMAT LOOP FILL IN HDR 0238 00518000
*                                      AND FORMAT                    */ 00519000
         AH    ARRAYCNT,@CH00039                                   0238 00520000
         CH    ARRAYCNT,@CH00156                                   0238 00521000
         BNH   @DL00234                                            0238 00522000
@DC00234 DS    0H                                                  0239 00523000
*               END;                /* END DIRECT ACCESS UCB         */ 00524000
*             ELSE                  /* NOT DIRECT ACCESS TYPE        */ 00525000
*               IF TBYTE3=GRAPHICS THEN/* GRAPHICS TYPE              */ 00526000
         B     @RC00227                                            0240 00527000
@RF00227 CLC   TBYTE3(1),GRAPHICS                                  0240 00528000
         BNE   @RF00240                                            0240 00529000
*                 DO;                                              0241 00530000
*                                                                  0241 00531000
*                   /*************************************************/ 00532000
*                   /*                                               */ 00533000
*                   /* GRAPHICS UCB                                  */ 00534000
*                   /*                                               */ 00535000
*                   /*************************************************/ 00536000
*                                                                  0242 00537000
*                   HDRTYPE(1:LENGTH(GRAPHDR))=GRAPHDR;/* FILL IN UCB   00538000
*                                      TYPE                          */ 00539000
         L     @14,ADPLBUF(,ABDPLPTR)                              0242 00540000
         MVC   HDRTYPE(15,@14),GRAPHDR                             0242 00541000
*                   CALL PRINT;     /* PRINT HEADER                  */ 00542000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0243 00543000
         BALR  @14,@15                                             0243 00544000
*                   BUFFER(1:LENGTH(UCBUS))=UCBUS;/* UNDER SCORE     */ 00545000
         L     @14,ADPLBUF(,ABDPLPTR)                              0244 00546000
         MVC   BUFFER(5,@14),UCBUS                                 0244 00547000
*                   CALL PRINT;     /* PRINT IT                      */ 00548000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0245 00549000
         BALR  @14,@15                                             0245 00550000
*                   CALL PRINT;     /* BLANK LINE                    */ 00551000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0246 00552000
         BALR  @14,@15                                             0246 00553000
*                   DO ARRAYCNT=1 TO DIM(GRAPHARY) WHILE(ERRSW=OFF);    00554000
         LA    ARRAYCNT,1                                          0247 00555000
@DL00247 TM    ERRSW,B'10000000'                                   0247 00556000
         BNZ   @DC00247                                            0247 00557000
*                                   /* FORMAT PATTERN ARRAY          */ 00558000
*                     LINEPTR=GRAPHARY(ARRAYCNT);/* FORMAT PATTERN 0248 00559000
*                                      ADDR                          */ 00560000
         LR    @14,ARRAYCNT                                        0248 00561000
         SLA   @14,2                                               0248 00562000
         L     LINEPTR,GRAPHARY-4(@14)                             0248 00563000
*                     CALL CONVERT; /* GENERATE OFFSET               */ 00564000
         BAL   @14,CONVERT                                         0249 00565000
*                     CALL FMTRTN;  /* FORMAT                        */ 00566000
         BAL   @14,FMTRTN                                          0250 00567000
*                   END;            /* END FORMAT LOOP FILL IN HDR 0251 00568000
*                                      AND FORMAT                    */ 00569000
         AH    ARRAYCNT,@CH00039                                   0251 00570000
         CH    ARRAYCNT,@CH00156                                   0251 00571000
         BNH   @DL00247                                            0251 00572000
@DC00247 DS    0H                                                  0252 00573000
*                 END;              /* END GRAPHICS UCB              */ 00574000
*               ELSE                /* NOT GRAPHICS TYPE             */ 00575000
*                 IF TBYTE3=UNITREC THEN/* UNIT RECORD TYPE          */ 00576000
         B     @RC00240                                            0253 00577000
@RF00240 CLC   TBYTE3(1),UNITREC                                   0253 00578000
         BNE   @RF00253                                            0253 00579000
*                   DO;                                            0254 00580000
*                     IF TBYTE4=MASK3800 THEN/* 3800 DEVICE TYPE     */ 00581000
         CLC   TBYTE4(1),MASK3800                                  0255 00582000
         BNE   @RF00255                                            0255 00583000
*                       DO;                                        0256 00584000
*                                                                  0256 00585000
*                         /*******************************************/ 00586000
*                         /*                                         */ 00587000
*                         /* 3800 DEVICE UCB                         */ 00588000
*                         /*                                         */ 00589000
*                         /*******************************************/ 00590000
*                                                                  0257 00591000
*                         HDRTYPE(1:LENGTH(HDR3800))=HDR3800;/* FILL    00592000
*                                      IN UCB TYPE                   */ 00593000
         L     @14,ADPLBUF(,ABDPLPTR)                              0257 00594000
         MVC   HDRTYPE(13,@14),HDR3800                             0257 00595000
*                         CALL PRINT;/* PRINT HEADER                 */ 00596000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0258 00597000
         BALR  @14,@15                                             0258 00598000
*                         BUFFER(1:LENGTH(UCBUS))=UCBUS;/* UNDER   0259 00599000
*                                      SCORE                         */ 00600000
         L     @14,ADPLBUF(,ABDPLPTR)                              0259 00601000
         MVC   BUFFER(5,@14),UCBUS                                 0259 00602000
*                         CALL PRINT;/* PRINT IT                     */ 00603000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0260 00604000
         BALR  @14,@15                                             0260 00605000
*                         CALL PRINT;/* BLANK LINE                   */ 00606000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0261 00607000
         BALR  @14,@15                                             0261 00608000
*                         DO ARRAYCNT=1 TO DIM(ARY3800) WHILE(ERRSW=OFF 00609000
*                               );  /* FORMAT PATTERN ARRAY          */ 00610000
         LA    ARRAYCNT,1                                          0262 00611000
@DL00262 TM    ERRSW,B'10000000'                                   0262 00612000
         BNZ   @DC00262                                            0262 00613000
*                           LINEPTR=ARY3800(ARRAYCNT);/* FORMAT    0263 00614000
*                                      PATTERN ADDR                  */ 00615000
         LR    @14,ARRAYCNT                                        0263 00616000
         SLA   @14,2                                               0263 00617000
         L     LINEPTR,ARY3800-4(@14)                              0263 00618000
*                           CALL CONVERT;/* GENERATE OFFSET          */ 00619000
         BAL   @14,CONVERT                                         0264 00620000
*                           CALL FMTRTN;/* FORMAT                    */ 00621000
         BAL   @14,FMTRTN                                          0265 00622000
*                         END;      /* END FORMAT LOOP FILL IN HDR 0266 00623000
*                                      AND FORMAT                    */ 00624000
         AH    ARRAYCNT,@CH00039                                   0266 00625000
         CH    ARRAYCNT,@CH00156                                   0266 00626000
         BNH   @DL00262                                            0266 00627000
@DC00262 DS    0H                                                  0267 00628000
*                       END;        /* END 3800 DEVICE UCB           */ 00629000
*                     ELSE          /* NOT 3800 DEVICE TYPE          */ 00630000
*                       IF TBYTE4=MASK3851 THEN/* 3851 DEVICE TYPE   */ 00631000
         B     @RC00255                                            0268 00632000
@RF00255 CLC   TBYTE4(1),MASK3851                                  0268 00633000
         BNE   @RF00268                                            0268 00634000
*                         DO;                                      0269 00635000
*                                                                  0269 00636000
*                           /*****************************************/ 00637000
*                           /*                                       */ 00638000
*                           /* 3851 DEVICE UCB                       */ 00639000
*                           /*                                       */ 00640000
*                           /*****************************************/ 00641000
*                                                                  0270 00642000
*                           HDRTYPE(1:LENGTH(HDR3851))=HDR3851;/*  0270 00643000
*                                      FILL IN UCB TYPE              */ 00644000
         L     @14,ADPLBUF(,ABDPLPTR)                              0270 00645000
         MVC   HDRTYPE(18,@14),HDR3851                             0270 00646000
*                           CALL PRINT;/* PRINT HEADER               */ 00647000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0271 00648000
         BALR  @14,@15                                             0271 00649000
*                           BUFFER(1:LENGTH(UCBUS))=UCBUS;/* UNDER 0272 00650000
*                                      SCORE                         */ 00651000
         L     @14,ADPLBUF(,ABDPLPTR)                              0272 00652000
         MVC   BUFFER(5,@14),UCBUS                                 0272 00653000
*                           CALL PRINT;/* PRINT IT                   */ 00654000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0273 00655000
         BALR  @14,@15                                             0273 00656000
*                           CALL PRINT;/* BLANK LINE                 */ 00657000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0274 00658000
         BALR  @14,@15                                             0274 00659000
*                           DO ARRAYCNT=1 TO DIM(ARY3851) WHILE(ERRSW=  00660000
*                                 OFF);/* FORMAT PATTERN ARRAY       */ 00661000
         LA    ARRAYCNT,1                                          0275 00662000
@DL00275 TM    ERRSW,B'10000000'                                   0275 00663000
         BNZ   @DC00275                                            0275 00664000
*                             LINEPTR=ARY3851(ARRAYCNT);/* FORMAT  0276 00665000
*                                      PATTERN ADDR                  */ 00666000
         LR    @14,ARRAYCNT                                        0276 00667000
         SLA   @14,2                                               0276 00668000
         L     LINEPTR,ARY3851-4(@14)                              0276 00669000
*                             CALL CONVERT;/* GENERATE OFFSET        */ 00670000
         BAL   @14,CONVERT                                         0277 00671000
*                             CALL FMTRTN;/* FORMAT                  */ 00672000
         BAL   @14,FMTRTN                                          0278 00673000
*                           END;    /* END FORMAT LOOP FILL IN HDR 0279 00674000
*                                      AND FORMAT                    */ 00675000
         AH    ARRAYCNT,@CH00039                                   0279 00676000
         CH    ARRAYCNT,@CH00156                                   0279 00677000
         BNH   @DL00275                                            0279 00678000
@DC00275 DS    0H                                                  0280 00679000
*                         END;      /* END 3851 DEVICE UCB           */ 00680000
*                       ELSE        /* NOT 3851 DEVICE TYPE          */ 00681000
*                         IF(TBYTE2&UCHARSET)=UCHARSET THEN/*      0281 00682000
*                                      UNIVERSAL CHAR SET            */ 00683000
         B     @RC00268                                            0281 00684000
@RF00268 SLR   @14,@14                                             0281 00685000
         IC    @14,UCHARSET                                        0281 00686000
         SLR   @10,@10                                             0281 00687000
         IC    @10,TBYTE2                                          0281 00688000
         NR    @10,@14                                             0281 00689000
         CR    @10,@14                                             0281 00690000
         BNE   @RF00281                                            0281 00691000
*                           DO;                                    0282 00692000
*                                                                  0282 00693000
*                             /***************************************/ 00694000
*                             /*                                     */ 00695000
*                             /* UNIT RECORD UCB WITH UNIVERSAL      */ 00696000
*                             /* CHARACTER SET                       */ 00697000
*                             /*                                     */ 00698000
*                             /***************************************/ 00699000
*                                                                  0283 00700000
*                             HDRTYPE(1:LENGTH(UCHARHDR))=UCHARHDR;/*   00701000
*                                      FILL IN UCB TYPE              */ 00702000
         L     @14,ADPLBUF(,ABDPLPTR)                              0283 00703000
         MVC   HDRTYPE(31,@14),UCHARHDR                            0283 00704000
*                             CALL PRINT;/* PRINT HEADER             */ 00705000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0284 00706000
         BALR  @14,@15                                             0284 00707000
*                             BUFFER(1:LENGTH(UCBUS))=UCBUS;/* UNDER    00708000
*                                      SCORE                         */ 00709000
         L     @14,ADPLBUF(,ABDPLPTR)                              0285 00710000
         MVC   BUFFER(5,@14),UCBUS                                 0285 00711000
*                             CALL PRINT;/* PRINT IT                 */ 00712000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0286 00713000
         BALR  @14,@15                                             0286 00714000
*                             CALL PRINT;/* BLANK LINE               */ 00715000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0287 00716000
         BALR  @14,@15                                             0287 00717000
*                             DO ARRAYCNT=1 TO DIM(UCHARRAY) WHILE(     00718000
*                                   ERRSW=OFF);/* FORMAT PATTERN   0288 00719000
*                                      ARRAY                         */ 00720000
         LA    ARRAYCNT,1                                          0288 00721000
@DL00288 TM    ERRSW,B'10000000'                                   0288 00722000
         BNZ   @DC00288                                            0288 00723000
*                               LINEPTR=UCHARRAY(ARRAYCNT);/* FORMAT    00724000
*                                      PATTERN ADDR                  */ 00725000
         LR    @14,ARRAYCNT                                        0289 00726000
         SLA   @14,2                                               0289 00727000
         L     LINEPTR,UCHARRAY-4(@14)                             0289 00728000
*                               CALL CONVERT;/* GENERATE OFFSET      */ 00729000
         BAL   @14,CONVERT                                         0290 00730000
*                               CALL FMTRTN;/* FORMAT                */ 00731000
         BAL   @14,FMTRTN                                          0291 00732000
*                             END;  /* END FORMAT LOOP FORMAT        */ 00733000
         AH    ARRAYCNT,@CH00039                                   0292 00734000
         CH    ARRAYCNT,@CH00156                                   0292 00735000
         BNH   @DL00288                                            0292 00736000
@DC00288 DS    0H                                                  0293 00737000
*                           END;    /* END UNIVERSAL CHAR SET        */ 00738000
*                         ELSE      /* NOT UNIVERSAL CHAR SET        */ 00739000
*                           DO;                                    0294 00740000
*                                                                  0294 00741000
         B     @RC00281                                            0294 00742000
@RF00281 DS    0H                                                  0295 00743000
*                             /***************************************/ 00744000
*                             /*                                     */ 00745000
*                             /* UNIT RECORD UCB                     */ 00746000
*                             /*                                     */ 00747000
*                             /***************************************/ 00748000
*                                                                  0295 00749000
*                             HDRTYPE(1:LENGTH(UNITHDR))=UNITHDR;/*     00750000
*                                      FILL IN UCB TYPE              */ 00751000
         L     @14,ADPLBUF(,ABDPLPTR)                              0295 00752000
         MVC   HDRTYPE(18,@14),UNITHDR                             0295 00753000
*                             CALL PRINT;/* PRINT HEADER             */ 00754000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0296 00755000
         BALR  @14,@15                                             0296 00756000
*                             BUFFER(1:LENGTH(UCBUS))=UCBUS;/* UNDER    00757000
*                                      SCORE                         */ 00758000
         L     @14,ADPLBUF(,ABDPLPTR)                              0297 00759000
         MVC   BUFFER(5,@14),UCBUS                                 0297 00760000
*                             CALL PRINT;/* PRINT IT                 */ 00761000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0298 00762000
         BALR  @14,@15                                             0298 00763000
*                             CALL PRINT;/* BLANK LINE               */ 00764000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0299 00765000
         BALR  @14,@15                                             0299 00766000
*                             DO ARRAYCNT=1 TO DIM(UNITARY) WHILE(ERRSW 00767000
*                                   =OFF);/* FORMAT PATTERN ARRAY    */ 00768000
         LA    ARRAYCNT,1                                          0300 00769000
@DL00300 TM    ERRSW,B'10000000'                                   0300 00770000
         BNZ   @DC00300                                            0300 00771000
*                               LINEPTR=UNITARY(ARRAYCNT);/* FORMAT     00772000
*                                      PATTERN ADDR                  */ 00773000
         LR    @14,ARRAYCNT                                        0301 00774000
         SLA   @14,2                                               0301 00775000
         L     LINEPTR,UNITARY-4(@14)                              0301 00776000
*                               CALL CONVERT;/* GENERATE OFFSET      */ 00777000
         BAL   @14,CONVERT                                         0302 00778000
*                               CALL FMTRTN;/* FORMAT                */ 00779000
         BAL   @14,FMTRTN                                          0303 00780000
*                             END;  /* END FORMAT LOOP FORMAT        */ 00781000
         AH    ARRAYCNT,@CH00039                                   0304 00782000
         CH    ARRAYCNT,@CH00154                                   0304 00783000
         BNH   @DL00300                                            0304 00784000
@DC00300 DS    0H                                                  0305 00785000
*                           END;    /* END NOT UNIVERSAL CHAR SET    */ 00786000
*                   END;            /* END UNIT RECORD UCB           */ 00787000
*                 ELSE              /* NOT UNIT RECORD TYPE          */ 00788000
*                   IF TBYTE3=CHARRDR THEN/* CHARACTER READER TYPE   */ 00789000
         B     @RC00253                                            0307 00790000
@RF00253 CLC   TBYTE3(1),CHARRDR                                   0307 00791000
         BNE   @RF00307                                            0307 00792000
*                     DO;                                          0308 00793000
*                                                                  0308 00794000
*                       /*********************************************/ 00795000
*                       /*                                           */ 00796000
*                       /* CHARACTER READER UCB                      */ 00797000
*                       /*                                           */ 00798000
*                       /*********************************************/ 00799000
*                                                                  0309 00800000
*                       HDRTYPE(1:LENGTH(CHARHDR))=CHARHDR;/* FILL IN   00801000
*                                      UCB TYPE                      */ 00802000
         L     @14,ADPLBUF(,ABDPLPTR)                              0309 00803000
         MVC   HDRTYPE(18,@14),CHARHDR                             0309 00804000
*                       CALL PRINT; /* PRINT HEADER                  */ 00805000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0310 00806000
         BALR  @14,@15                                             0310 00807000
*                       BUFFER(1:LENGTH(UCBUS))=UCBUS;/* UNDER SCORE */ 00808000
         L     @14,ADPLBUF(,ABDPLPTR)                              0311 00809000
         MVC   BUFFER(5,@14),UCBUS                                 0311 00810000
*                       CALL PRINT; /* PRINT IT                      */ 00811000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0312 00812000
         BALR  @14,@15                                             0312 00813000
*                       CALL PRINT; /* BLANK LINE                    */ 00814000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0313 00815000
         BALR  @14,@15                                             0313 00816000
*                       DO ARRAYCNT=1 TO DIM(CHARARY) WHILE(ERRSW=OFF); 00817000
         LA    ARRAYCNT,1                                          0314 00818000
@DL00314 TM    ERRSW,B'10000000'                                   0314 00819000
         BNZ   @DC00314                                            0314 00820000
*                                   /* FORMAT PATTERN ARRAY          */ 00821000
*                         LINEPTR=CHARARY(ARRAYCNT);/* FORMAT PATTERN   00822000
*                                      ADDR                          */ 00823000
         LR    @14,ARRAYCNT                                        0315 00824000
         SLA   @14,2                                               0315 00825000
         L     LINEPTR,CHARARY-4(@14)                              0315 00826000
*                         CALL CONVERT;/* GENERATE OFFSET            */ 00827000
         BAL   @14,CONVERT                                         0316 00828000
*                         CALL FMTRTN;/* FORMAT                      */ 00829000
         BAL   @14,FMTRTN                                          0317 00830000
*                       END;        /* END FORMAT LOOP FORMAT        */ 00831000
         AH    ARRAYCNT,@CH00039                                   0318 00832000
         CH    ARRAYCNT,@CH00154                                   0318 00833000
         BNH   @DL00314                                            0318 00834000
@DC00314 DS    0H                                                  0319 00835000
*                     END;          /* END CHARACTER READER UCB      */ 00836000
*                   ELSE            /* INVALID UCB TYPE              */ 00837000
*                     BUFFER(1:LENGTH(UNKNOWN))=UNKNOWN;           0320 00838000
         B     @RC00307                                            0320 00839000
@RF00307 L     @14,ADPLBUF(,ABDPLPTR)                              0320 00840000
         MVC   BUFFER(56,@14),UNKNOWN                              0320 00841000
*     END;                          /* END FOUND UCB TYPE FIELD      */ 00842000
@RC00307 DS    0H                                                  0321 00843000
@RC00253 DS    0H                                                  0321 00844000
@RC00240 DS    0H                                                  0321 00845000
@RC00227 DS    0H                                                  0321 00846000
@RC00199 DS    0H                                                  0321 00847000
@RC00186 DS    0H                                                  0321 00848000
@RC00173 DS    0H                                                  0322 00849000
*   CALL PRINT;                     /* BLANK LINE OR ERROR MSG       */ 00850000
@RC00168 L     @15,ADPLPRNT(,ABDPLPTR)                             0322 00851000
         BALR  @14,@15                                             0322 00852000
*   LCALREGS=RTYREGS;               /* RESTORE CALLERS EXPECTED ERROR   00853000
*                                      REGS                          */ 00854000
         MVC   LCALREGS(64,ESTAPTR),RTYREGS(ESTAPTR)               0323 00855000
*   RETURN CODE(RCCODE);                                           0324 00856000
         L     @13,4(,@13)                                         0324 00857000
         L     @00,@SIZDATD                                        0324 00858000
         LR    @01,@11                                             0324 00859000
         FREEMAIN R,LV=(0),A=(1)                                        00860000
         LR    @15,@07                                             0324 00861000
         L     @14,12(,@13)                                        0324 00862000
         LM    @00,@12,20(@13)                                     0324 00863000
         BR    @14                                                 0324 00864000
*CONVERT:                                                          0325 00865000
*   PROC OPTIONS(SAVE(14));                                        0325 00866000
*                                                                  0325 00867000
CONVERT  ST    @14,12(,@13)                                        0325 00868000
*/********************************************************************/ 00869000
*/* FUNCTION -                                                     0326 00870000
*      ROUTINE TO DYNAMICALLY GENERATE THE OFFSETS TO BE PUT ALONGSIDE  00871000
*      THE CONTROL BLOCK LINE.  IT FIGURES THE OFFSET FROM THE     0326 00872000
*      BEGINNING OF THE CONTROL BLOCK, CONVERTS IT TO PRINTABLE HEX,    00873000
*      PLACES IT INTO A BUFFER AREA AND PUTS THE ADDRESS OF THIS   0326 00874000
*      BUFFER AREA INTO THE PARAMETER LIST TO BE PICKED UP IN THE  0326 00875000
*      FORMAT PATTERNS BY THE FORMAT SERVICE ROUTINE.              0326 00876000
*                                                                  0326 00877000
*   NOTE  -                                                        0326 00878000
*      THIS CODE COMPARES THE ADDRESSES WITH THE HIGH ORDER BYTE   0326 00879000
*      OFF, SINCE ALL CODE IS NOT 31 BIT ADDRESSING AND SOME POINTERS   00880000
*      HAVE BITS SET IN THE HIGH ORDER BYTE OF THE ADDRESS.        0326 00881000
*                                                                  0326 00882000
*   INPUT -                                                        0326 00883000
*      SAVEPTR MUST HAVE THE ADDRESS OF THE BEGINNING OF THE CONTROL    00884000
*      BLOCK, REGISTER 1 POINTS TO THE PARMLIST WHICH CONTAINS THE 0326 00885000
*      CURRENT CONTROL BLOCK ADDRESS IN ADPLFMT2.                  0326 00886000
*                                                                  0326 00887000
*   CALLS -                                                        0326 00888000
*      MAKES NO OUTSIDE CALLS                                      0326 00889000
*                                                                  0326 00890000
*   CALLED BY -                                                    0326 00891000
*      IECIOEXD,IECIOUCB                                           0326 00892000
*                                                                  0326 00893000
*   RETURNS TO -                                                   0326 00894000
*      CALLER WITHOUT SETTING A RETURN CODE                        0326 00895000
*                                                                    */ 00896000
*/********************************************************************/ 00897000
*                                                                  0326 00898000
*   IF SAVEPTR>ADPLFMT2 THEN        /* THIS WILL OCCUR FOR A PREFIX     00899000
*                                      WITH A NEGATIVE OFFSET        */ 00900000
         L     @14,ADPLFMT2(,ABDPLPTR)                             0326 00901000
         CR    SAVEPTR,@14                                         0326 00902000
         BNH   @RF00326                                            0326 00903000
*     DO;                                                          0327 00904000
*       NEGBIT=ON;                  /* INDICATE NEGATIVE OFFSET      */ 00905000
         OI    NEGBIT,B'10000000'                                  0328 00906000
*       CONVRT=SAVEPTR-ADPLFMT2;    /* NEGATIVE OFFSET VALUE         */ 00907000
         LCR   @14,@14                                             0329 00908000
         ALR   @14,SAVEPTR                                         0329 00909000
         LR    CONVRT,@14                                          0329 00910000
*     END;                          /* END NEGATIVE OFFSET           */ 00911000
*   ELSE                            /* POSITIVE OR ZERO OFFSET       */ 00912000
*     DO;                                                          0331 00913000
         B     @RC00326                                            0331 00914000
@RF00326 DS    0H                                                  0332 00915000
*       NEGBIT=OFF;                 /* INDICATE POS VALUE            */ 00916000
         NI    NEGBIT,B'01111111'                                  0332 00917000
*       CONVRT=ADPLFMT2-SAVEPTR;    /* RELATIVE OFFSET IN CONTROL  0333 00918000
*                                      BLOCK                         */ 00919000
         L     CONVRT,ADPLFMT2(,ABDPLPTR)                          0333 00920000
         SLR   CONVRT,SAVEPTR                                      0333 00921000
*     END;                          /* END POS VALUE                 */ 00922000
*   DIGIT=BLANKS(1:5);              /* BLANK OUT DIGITS              */ 00923000
@RC00326 MVC   DIGIT(5),BLANKS                                     0335 00924000
*   PACKAREA=CONVRT;                /* PLACE OFFSET INTO CHAR AREA 0336 00925000
*                                      FOR THE UNPACK                */ 00926000
         ST    CONVRT,PACKAREA                                     0336 00927000
*   GARBAGE='04'X;                  /* GARBAGE BYTE SO OFFSET WILL 0337 00928000
*                                      UNPACK OK                     */ 00929000
*                                                                  0337 00930000
         MVI   GARBAGE,X'04'                                       0337 00931000
*   /*****************************************************************/ 00932000
*   /*                                                               */ 00933000
*   /* FOR AN ODD NUMBER OF DIGITS THE OUTPUT SHOULD LOOK LIKE +C OR */ 00934000
*   /* +13C. IF THE VALUE WAS UNPACKED DIRECTLY INTO DIGITS THE      */ 00935000
*   /* OUTPUT WOULD HAVE UNWANTED LEADING ZEROS SUCH AS +0C. TO      */ 00936000
*   /* ELIMINATE THIS(ONLY FOR AN ODD NUMBER OF DIGITS) UNPACK ODD   */ 00937000
*   /* NUMBER OF DIGITS INTO CONVERTD WHERE THE LEADING ZERO WILL BE */ 00938000
*   /* OVERWRITTEN BY THE '+' OR '-' SIGN                            */ 00939000
*   /*                                                               */ 00940000
*   /*****************************************************************/ 00941000
*                                                                  0338 00942000
*   IF CONVRT<TWODGT THEN           /* ONLY 1 DIGIT TO OFFSET        */ 00943000
         CH    CONVRT,@CH00377                                     0338 00944000
         BNL   @RF00338                                            0338 00945000
*     UNPK(CONVERTD(1:3),UNPACK(4:5));/* UNPACK ONLY 1 DIGIT AND   0339 00946000
*                                      DUMMY                         */ 00947000
         UNPK  CONVERTD(3),UNPACK+3(2)                             0339 00948000
*   ELSE                                                           0340 00949000
*     IF CONVRT<THREDGT THEN        /* 2 DIGITS TO OFFSET            */ 00950000
         B     @RC00338                                            0340 00951000
@RF00338 CH    CONVRT,@CH00994                                     0340 00952000
         BNL   @RF00340                                            0340 00953000
*       UNPK(DIGIT(1:3),UNPACK(4:5));/* UNPACK LAST 2 DIGITS & DUMMY */ 00954000
         UNPK  DIGIT(3),UNPACK+3(2)                                0341 00955000
*     ELSE                                                         0342 00956000
*       IF CONVRT<FOURDGT THEN      /* 3 DIGITS TO OFFSET            */ 00957000
         B     @RC00340                                            0342 00958000
@RF00340 CH    CONVRT,@CH00963                                     0342 00959000
         BNL   @RF00342                                            0342 00960000
*         UNPK(CONVERTD(1:5),UNPACK(3:5));/* UNPACK LAST 3 DIGITS &     00961000
*                                      DUMMY                         */ 00962000
         UNPK  CONVERTD(5),UNPACK+2(3)                             0343 00963000
*       ELSE                        /* 4 DIGITS (MAX)                */ 00964000
*         UNPK(DIGIT(1:5),UNPACK(3:5));/* LAST 4 DIGITS & DUMMY BYTE */ 00965000
         B     @RC00342                                            0344 00966000
@RF00342 UNPK  DIGIT(5),UNPACK+2(3)                                0344 00967000
*   TR(DIGIT,TRANS);                /* MAKE PRINTABLE                */ 00968000
@RC00342 DS    0H                                                  0345 00969000
@RC00340 DS    0H                                                  0345 00970000
@RC00338 TR    DIGIT(5),TRANS                                      0345 00971000
*   IF NEGBIT=ON THEN               /* WAS A NEGATIVE OFFSET         */ 00972000
         TM    NEGBIT,B'10000000'                                  0346 00973000
         BNO   @RF00346                                            0346 00974000
*     PLUS=NEGCHAR;                 /* MINUS SIGN                    */ 00975000
         MVI   PLUS,C'-'                                           0347 00976000
*   ELSE                            /* POSITIVE OFFSET               */ 00977000
*     PLUS=PLUSCHAR;                /* MOVE IN PLUS SIGN             */ 00978000
         B     @RC00346                                            0348 00979000
@RF00346 MVI   PLUS,C'+'                                           0348 00980000
*   ADPLFMT1=ADDR(CONVERTD);        /* SET UP FOR FORMAT             */ 00981000
@RC00346 LA    @14,CONVERTD                                        0349 00982000
         ST    @14,ADPLFMT1(,ABDPLPTR)                             0349 00983000
*   END CONVERT;                                                   0350 00984000
@EL00002 DS    0H                                                  0350 00985000
@EF00002 DS    0H                                                  0350 00986000
@ER00002 L     @14,12(,@13)                                        0350 00987000
         BR    @14                                                 0350 00988000
*FMTRTN:                                                           0351 00989000
*   PROC OPTIONS(SAVE(14));                                        0351 00990000
*                                                                  0351 00991000
FMTRTN   ST    @14,@SA00003                                        0351 00992000
*/****************************************************************** */ 00993000
*/* FUNCTION                                                       0352 00994000
*       ROUTINE TO SET UP CALLING OF THE FORMAT SERVICE ROUTINE PASSED  00995000
*     IN THE PARMLIST AND CHECKS RETURN CODE.  IF A RETURN CODE IS BAD  00996000
*     IT TAKES THE MESSAGE WHOSE ADDRESS IS IN ADPLCOM1. AND PUTS IT    00997000
*     IN THE BUFFER AND PRINTS IT. IT SETS THE ERRSW TO INDICATE BAD    00998000
*     RETURN CODE AND RETURNS. IF THE RETURN CODE WAS GOOD, IT PRINTS   00999000
*     THE FORMATTED LINE.                                          0352 01000000
*                                                                  0352 01001000
*   CALLS-                                                         0352 01002000
*       CALLS FORMAT AND PRINT                                     0352 01003000
*                                                                  0352 01004000
*   INPUT -                                                        0352 01005000
*     LINEPTR(REGISTER 0) HAS THE ADDRESS OF THE FORMAT PATTERN TO BE   01006000
*    PASSED TO THE FORMAT SERVICE ROUTINE. ADPLFMT2 CONTAINS THE CURREN 01007000
*    ADDRESS OF THE CONTROL BLOCK TO BE FORMATTED AND ,IN MOST CASES,   01008000
*    ADPLFMT1 CONTAINS THE ADDRESS OF THE FIELD 'CONVERTD' WHICH IS     01009000
*    THE EBCDIC REPRESENTATION OF THE OFFSET TO BE PLACED ALONG SIDE    01010000
*    THE OUTPUT LINE.                                              0352 01011000
*                                                                  0352 01012000
*   CALLED BY -                                                    0352 01013000
*     IECIOEXD,IECIOUCB                                            0352 01014000
*                                                                  0352 01015000
*   RETURNS CONTROL TO -                                           0352 01016000
*     CALLER WITH RETURN CODE RECIEVED FROM FORMAT                 0352 01017000
*     SERVICE ROUTINE                                              0352 01018000
*                                                                    */ 01019000
*/****************************************************************** */ 01020000
*                                                                  0352 01021000
*   IF ADPLSNPR=OFF THEN            /* SNAP WAS THE INVOKER          */ 01022000
         TM    ADPLSNPR(ABDPLPTR),B'10000000'                      0352 01023000
         BNZ   @RF00352                                            0352 01024000
*     DO;                           /* PROTECTION IS NEEDED FROM THE    01025000
*                                      FORMAT SERVICE ROUTINE IN CASE   01026000
*                                      OF ABEND                      */ 01027000
*       RTYADR=ADDR(FMTRTY);        /* WHERE TO RETRY                */ 01028000
         LA    @14,FMTRTY                                          0354 01029000
         ST    @14,RTYADR(,ESTAPTR)                                0354 01030000
*       ERREXP=ON;                  /* INDICATE AN ERROR IS EXPECTED */ 01031000
         OI    ERREXP(ESTAPTR),B'10000000'                         0355 01032000
*     END;                          /* END SNAP WAS INVOKER          */ 01033000
*   ELSE                                                           0357 01034000
*     ;                             /* SNAP WAS NOT INVOKER          */ 01035000
@RF00352 DS    0H                                                  0358 01036000
*   CALL FORMAT;                    /* FORMAT ROUTINE PASSED BY    0358 01037000
*                                      CALLER                        */ 01038000
         L     @15,ADPLFRMT(,ABDPLPTR)                             0358 01039000
         BALR  @14,@15                                             0358 01040000
*   ERREXP=OFF;                     /* ERROR IS NO LONGER EXPECTED   */ 01041000
         NI    ERREXP(ESTAPTR),B'01111111'                         0359 01042000
*   IF RCREG^=ZERO THEN                                            0360 01043000
         LTR   RCREG,RCREG                                         0360 01044000
         BZ    @RF00360                                            0360 01045000
*     DO;                           /* FORMAT ROUTINE ERROR          */ 01046000
*FMTRTY:                            /* RETRY ADDRESS FROM ESTAE      */ 01047000
*       ERRSW=ON;                   /* SET ERROR INDICATOR           */ 01048000
FMTRTY   OI    ERRSW,B'10000000'                                   0362 01049000
*       CALL PRINT;                 /* SPACE A LINE                  */ 01050000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0363 01051000
         BALR  @14,@15                                             0363 01052000
*       BUFFER=MSG;                 /* ERROR MSG PASSED BY CALLER  0364 01053000
*                                      WHOSE ADDR IS PLACED IN     0364 01054000
*                                      ADPLCOM1                      */ 01055000
         L     @14,ADPLBUF(,ABDPLPTR)                              0364 01056000
         L     @10,ADPLCOM1(,ABDPLPTR)                             0364 01057000
         MVC   BUFFER(120,@14),MSG(@10)                            0364 01058000
*       RCREG=4;                    /* INDICATE THE FORMATTER DID NOT   01059000
*                                      FINISH SUCESSFULLY            */ 01060000
         LA    RCREG,4                                             0365 01061000
*     END;                          /* END FORMAT ROUTINE ERROR      */ 01062000
*   ELSE                                                           0367 01063000
*     ;                             /* FORMATTED LINE IS IN BUFFER   */ 01064000
@RF00360 DS    0H                                                  0368 01065000
*   RCCODE=RCREG;                   /* SAVE RETURN CODE FROM FORMAT     01066000
*                                      SERVICE ROUTINE               */ 01067000
         LR    RCCODE,RCREG                                        0368 01068000
*   CALL PRINT;                     /* PRINT THE ERROR MSG OR      0369 01069000
*                                      FORMATTED LINE                */ 01070000
         L     @15,ADPLPRNT(,ABDPLPTR)                             0369 01071000
         BALR  @14,@15                                             0369 01072000
*   RETURN CODE(RCCODE);                                           0370 01073000
         LR    @15,RCCODE                                          0370 01074000
@EL00003 DS    0H                                                  0370 01075000
@EF00003 DS    0H                                                  0370 01076000
@ER00003 L     @14,@SA00003                                        0370 01077000
         BR    @14                                                 0370 01078000
*   END FMTRTN;                                                    0371 01079000
*ACCESRTN:                                                         0372 01080000
*   PROC OPTIONS(SAVE(14));                                        0372 01081000
*                                                                  0372 01082000
ACCESRTN ST    @14,@SA00004                                        0372 01083000
*/********************************************************************/ 01084000
*/* FUNCTION-                                                      0373 01085000
*       ROUTINE WHICH CALLS THE ACCESS SERVICE ROUTINE AND MOVES THE    01086000
*     VALUE RETURNED IN R0 INTO DATAPTR.                           0373 01087000
*                                                                  0373 01088000
*                                                                  0373 01089000
*   INPUT -                                                        0373 01090000
*         VADR(REGISTER 0) CONTAINS THE VIRTUAL ADDRESS OF THE FIELD    01091000
*         TO BE ACCESSED.                                          0373 01092000
*                                                                  0373 01093000
*    CALLS-                                                        0373 01094000
*         ACCESS SERVICE ROUTINE PASSED IN PARMLIST                0373 01095000
*                                                                  0373 01096000
*    CALLED BY -                                                   0373 01097000
*         IECIOEXD,IECIOUCB                                        0373 01098000
*                                                                  0373 01099000
*    RETURNS TO -                                                  0373 01100000
*         CALLER WITH THE RETURN CODE SET BY THE ACCESS            0373 01101000
*         SERVICE ROUTINE.                                         0373 01102000
*                                                                    */ 01103000
*/********************************************************************/ 01104000
*                                                                  0373 01105000
*   IF ADPLSNPR=OFF THEN            /* SNAP WAS INVOKER              */ 01106000
         TM    ADPLSNPR(ABDPLPTR),B'10000000'                      0373 01107000
         BNZ   @RF00373                                            0373 01108000
*     DO;                                                          0374 01109000
*       RTYADR=ADDR(RETRY);         /* ESTAE RETRY ADDR FOR EXPECTED    01110000
*                                      ERROR                         */ 01111000
         LA    @14,RETRY                                           0375 01112000
         ST    @14,RTYADR(,ESTAPTR)                                0375 01113000
*       DATAPTR=VADR;               /* TO GET THE PROPER BASING FOR     01114000
*                                      THE AREA                      */ 01115000
         LR    DATAPTR,VADR                                        0376 01116000
*       RCREG=ZERO;                 /* SUCCESS UNLESS AN ABEND OCCURS*/ 01117000
         SLR   RCREG,RCREG                                         0377 01118000
*       ERREXP=ON;                  /* INDICATE AN ERROR IS EXPECTED */ 01119000
         OI    ERREXP(ESTAPTR),B'10000000'                         0378 01120000
*       VERIFY=DATADWRD;            /* MOVE A DOUBLE WORD INTO BUFFER*/ 01121000
*                                                                  0379 01122000
         MVC   VERIFY(8),DATADWRD(DATAPTR)                         0379 01123000
*       /*************************************************************/ 01124000
*       /*                                                           */ 01125000
*       /* THIS MOVE WILL CAUSE AN ABEND IF THE DUMP DOES NOT CONTAIN*/ 01126000
*       /* THE AREA REFERENCED OR IF THE AREA IS PROTECTED. IF AN    */ 01127000
*       /* ABEND OCCURS, THE ESTAE WILL GET CONTROL AND RETRY AT THE */ 01128000
*       /* POINT WHICH SETS A BAD RETURN CODE AND RETURNS TO THE     */ 01129000
*       /* CALLER. THIS THEN SIMULATES THE PRINT DUMP ACCESS ROUTINE.*/ 01130000
*       /* IF THE AREA ASKED FOR IS IN THE DUMP A DOUBLE WORD IS     */ 01131000
*       /* MOVED INTO AN INTERNAL BUFFER TO PREVENT AN UNEXPECTED    */ 01132000
*       /* ERROR WHEN REFERENCING THE AREA AGAIN                     */ 01133000
*       /*                                                           */ 01134000
*       /*************************************************************/ 01135000
*                                                                  0380 01136000
*       ERREXP=OFF;                 /* INDICATE AN ERROR IS NO LONGER   01137000
*                                      EXPECTED                      */ 01138000
         NI    ERREXP(ESTAPTR),B'01111111'                         0380 01139000
*       DATAPTR=ADDR(VERIFY);       /* REBASE DATA OFF INTERNAL    0381 01140000
*                                      BUFFER                        */ 01141000
         LA    DATAPTR,VERIFY                                      0381 01142000
*     END;                          /* END SNAP WAS INVOKER          */ 01143000
*   ELSE                            /* CALLER HAS OWN ACCESS ROUTINE    01144000
*                                      LIKE PRINT DUMP               */ 01145000
*     DO;                                                          0383 01146000
         B     @RC00373                                            0383 01147000
@RF00373 DS    0H                                                  0384 01148000
*       CALL ACCESS;                /* ACCESS SERVICE ROUTINE PASSED    01149000
*                                      BY CALLER                     */ 01150000
         L     @15,ADPLMEMA(,ABDPLPTR)                             0384 01151000
         BALR  @14,@15                                             0384 01152000
*       IF RCREG=ZERO THEN                                         0385 01153000
         LTR   RCREG,RCREG                                         0385 01154000
         BNZ   @RF00385                                            0385 01155000
*         DATAPTR=VADR;             /* SAVE PTR RETURNED BY ACCESS 0386 01156000
*                                      SERVICE ROUTINE               */ 01157000
         LR    DATAPTR,VADR                                        0386 01158000
*       ELSE                        /* BAD RETURN CODE               */ 01159000
*RETRY:                             /* RETRY ADDR FOR ESTAE          */ 01160000
*         RCREG=4;                  /* SET A BAD RETURN CODE         */ 01161000
         B     @RC00385                                            0387 01162000
@RF00385 DS    0H                                                  0387 01163000
RETRY    LA    RCREG,4                                             0387 01164000
*     END;                          /* END INVOKER HAS OWN ACCESS  0388 01165000
*                                      ROUTINE                       */ 01166000
@RC00385 DS    0H                                                  0389 01167000
*   RCCODE=RCREG;                   /* SAVE RETURN CODE FROM ACCESS     01168000
*                                      SERVICE RTN                   */ 01169000
@RC00373 LR    RCCODE,RCREG                                        0389 01170000
*   RETURN CODE(RCCODE);                                           0390 01171000
         LR    @15,RCCODE                                          0390 01172000
@EL00004 DS    0H                                                  0390 01173000
@EF00004 DS    0H                                                  0390 01174000
@ER00004 L     @14,@SA00004                                        0390 01175000
         BR    @14                                                 0390 01176000
*   END ACCESRTN;                                                  0391 01177000
*   END IECIOFT1                                                   0392 01178000
*                                                                  0392 01179000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01180000
*/*%INCLUDE SYSLIB  (IHAABDPL)                                       */ 01181000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 01182000
*                                                                  0392 01183000
*       ;                                                          0392 01184000
@DATA    DS    0H                                                       01185000
@CH00039 DC    H'1'                                                     01186000
@CH00154 DC    H'3'                                                     01187000
@CH00156 DC    H'4'                                                     01188000
@CH00072 DC    H'8'                                                     01189000
@CH00377 DC    H'16'                                                    01190000
@CH00967 DC    H'61'                                                    01191000
@CH00994 DC    H'256'                                                   01192000
@CH00963 DC    H'4096'                                                  01193000
@DATD    DSECT                                                          01194000
         DS    0F                                                       01195000
@SA00001 DS    18F                                                      01196000
@SA00003 DS    1F                                                       01197000
@SA00004 DS    1F                                                       01198000
IECIOFT1 CSECT                                                          01199000
         DS    0F                                                       01200000
@DATD    DSECT                                                          01201000
         DS    0D                                                       01202000
TYPBYTE  DS    FL4                                                      01203000
         ORG   TYPBYTE                                                  01204000
TBYTE1   DS    FL1                                                      01205000
TBYTE2   DS    FL1                                                      01206000
TBYTE3   DS    FL1                                                      01207000
TBYTE4   DS    FL1                                                      01208000
         ORG   TYPBYTE+4                                                01209000
CONVERTD DS    CL6                                                      01210000
         ORG   CONVERTD                                                 01211000
PLUS     DS    CL1                                                      01212000
DIGIT    DS    CL5                                                      01213000
         ORG   CONVERTD+6                                               01214000
ERRSW    DS    BL1                                                      01215000
NEGBIT   DS    BL1                                                      01216000
         DS    CL4                                                      01217000
UNPACK   DS    CL5                                                      01218000
         ORG   UNPACK                                                   01219000
PACKAREA DS    CL4                                                      01220000
GARBAGE  DS    CL1                                                      01221000
         ORG   UNPACK+5                                                 01222000
         DS    CL3                                                      01223000
VERIFY   DS    CL8                                                      01224000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01225000
@ENDDATD EQU   *                                                        01226000
IECIOFT1 CSECT                                                          01227000
         DS    0F                                                       01228000
@SIZDATD DC    AL1(0)                                                   01229000
         DC    AL3(@ENDDATD-@DATD)                                      01230000
         DS    0D                                                       01231000
CHARRDR  DC    XL1'04'                                                  01232000
COMTYPE  DC    XL1'40'                                                  01233000
CTCTYPE  DC    XL1'41'                                                  01234000
DATYPE   DC    XL1'20'                                                  01235000
GRAPHICS DC    XL1'10'                                                  01236000
MAGTAPE  DC    XL1'80'                                                  01237000
MASK3704 DC    XL1'05'                                                  01238000
MASK3800 DC    XL1'0E'                                                  01239000
MASK3851 DC    XL1'42'                                                  01240000
UCHARSET DC    XL1'80'                                                  01241000
UNITREC  DC    XL1'08'                                                  01242000
XDBAL1   DS    CL19                                                     01243000
         ORG   XDBAL1                                                   01244000
@NM00006 DC    CL4'COMP'                                                01245000
@NM00007 DC    CL4'FLAG'                                                01246000
@NM00008 DC    CL3'PSW'                                                 01247000
@NM00009 DC    CL8'COMPCODE'                                            01248000
         ORG   XDBAL1+19                                                01249000
         DS    CL2                                                      01250000
XDBAF1   DS    CL32                                                     01251000
         ORG   XDBAF1                                                   01252000
@NM00010 DS    CL4                                                      01253000
         ORG   @NM00010                                                 01254000
@NM00011 DC    X'01'                                                    01255000
@NM00012 DC    X'40'                                                    01256000
@NM00013 DC    AL1(0)                                                   01257000
@NM00014 DC    AL1(0)                                                   01258000
         ORG   XDBAF1+4                                                 01259000
@NM00015 DS    CL8                                                      01260000
         ORG   @NM00015                                                 01261000
@NM00016 DC    X'07'                                                    01262000
@NM00017 DC    X'31'                                                    01263000
@NM00018 DC    AL1(8)                                                   01264000
@NM00019 DC    AL1(13)                                                  01265000
@NM00020 DC    AL4(XDBAL1)                                              01266000
         ORG   XDBAF1+12                                                01267000
@NM00021 DS    CL4                                                      01268000
         ORG   @NM00021                                                 01269000
@NM00022 DC    X'05'                                                    01270000
@NM00023 DC    X'31'                                                    01271000
@NM00024 DC    AL1(18)                                                  01272000
@NM00025 DC    AL1(23)                                                  01273000
         ORG   XDBAF1+16                                                01274000
@NM00026 DS    CL4                                                      01275000
         ORG   @NM00026                                                 01276000
@NM00027 DC    X'05'                                                    01277000
@NM00028 DC    X'23'                                                    01278000
@NM00029 DC    AL1(28)                                                  01279000
@NM00030 DC    AL1(32)                                                  01280000
         ORG   XDBAF1+20                                                01281000
@NM00031 DS    CL4                                                      01282000
         ORG   @NM00031                                                 01283000
@NM00032 DC    X'04'                                                    01284000
@NM00033 DC    X'03'                                                    01285000
@NM00034 DC    AL1(0)                                                   01286000
@NM00035 DC    AL1(41)                                                  01287000
         ORG   XDBAF1+24                                                01288000
@NM00036 DS    CL4                                                      01289000
         ORG   @NM00036                                                 01290000
@NM00037 DC    X'05'                                                    01291000
@NM00038 DC    X'73'                                                    01292000
@NM00039 DC    AL1(50)                                                  01293000
@NM00040 DC    AL1(59)                                                  01294000
         ORG   XDBAF1+28                                                01295000
@NM00041 DS    CL4                                                      01296000
         ORG   @NM00041                                                 01297000
@NM00042 DC    F'0'                                                     01298000
         ORG   XDBAF1+32                                                01299000
XDBAL2   DS    CL11                                                     01300000
         ORG   XDBAL2                                                   01301000
@NM00043 DC    CL4'REGS'                                                01302000
@NM00044 DC    CL2'AT'                                                  01303000
@NM00045 DC    CL5'ABEND'                                               01304000
         ORG   XDBAL2+11                                                01305000
         DS    CL1                                                      01306000
XDBAF2   DS    CL44                                                     01307000
         ORG   XDBAF2                                                   01308000
@NM00046 DS    CL4                                                      01309000
         ORG   @NM00046                                                 01310000
@NM00047 DC    X'01'                                                    01311000
@NM00048 DC    X'40'                                                    01312000
@NM00049 DC    AL1(0)                                                   01313000
@NM00050 DC    AL1(0)                                                   01314000
         ORG   XDBAF2+4                                                 01315000
@NM00051 DS    CL8                                                      01316000
         ORG   @NM00051                                                 01317000
@NM00052 DC    X'07'                                                    01318000
@NM00053 DC    X'33'                                                    01319000
@NM00054 DC    AL1(8)                                                   01320000
@NM00055 DC    AL1(23)                                                  01321000
@NM00056 DC    AL4(XDBAL2)                                              01322000
         ORG   XDBAF2+12                                                01323000
@NM00057 DS    CL4                                                      01324000
         ORG   @NM00057                                                 01325000
@NM00058 DC    X'05'                                                    01326000
@NM00059 DC    X'13'                                                    01327000
@NM00060 DC    AL1(13)                                                  01328000
@NM00061 DC    AL1(32)                                                  01329000
         ORG   XDBAF2+16                                                01330000
@NM00062 DS    CL4                                                      01331000
         ORG   @NM00062                                                 01332000
@NM00063 DC    X'05'                                                    01333000
@NM00064 DC    X'43'                                                    01334000
@NM00065 DC    AL1(16)                                                  01335000
@NM00066 DC    AL1(41)                                                  01336000
         ORG   XDBAF2+20                                                01337000
@NM00067 DS    CL4                                                      01338000
         ORG   @NM00067                                                 01339000
@NM00068 DC    X'04'                                                    01340000
@NM00069 DC    X'03'                                                    01341000
@NM00070 DC    AL1(0)                                                   01342000
@NM00071 DC    AL1(50)                                                  01343000
         ORG   XDBAF2+24                                                01344000
@NM00072 DS    CL4                                                      01345000
         ORG   @NM00072                                                 01346000
@NM00073 DC    X'04'                                                    01347000
@NM00074 DC    X'03'                                                    01348000
@NM00075 DC    AL1(0)                                                   01349000
@NM00076 DC    AL1(59)                                                  01350000
         ORG   XDBAF2+28                                                01351000
@NM00077 DS    CL4                                                      01352000
         ORG   @NM00077                                                 01353000
@NM00078 DC    X'04'                                                    01354000
@NM00079 DC    X'03'                                                    01355000
@NM00080 DC    AL1(0)                                                   01356000
@NM00081 DC    AL1(68)                                                  01357000
         ORG   XDBAF2+32                                                01358000
@NM00082 DS    CL4                                                      01359000
         ORG   @NM00082                                                 01360000
@NM00083 DC    X'04'                                                    01361000
@NM00084 DC    X'03'                                                    01362000
@NM00085 DC    AL1(0)                                                   01363000
@NM00086 DC    AL1(77)                                                  01364000
         ORG   XDBAF2+36                                                01365000
@NM00087 DS    CL4                                                      01366000
         ORG   @NM00087                                                 01367000
@NM00088 DC    X'04'                                                    01368000
@NM00089 DC    X'03'                                                    01369000
@NM00090 DC    AL1(0)                                                   01370000
@NM00091 DC    AL1(86)                                                  01371000
         ORG   XDBAF2+40                                                01372000
@NM00092 DS    CL4                                                      01373000
         ORG   @NM00092                                                 01374000
@NM00093 DC    F'0'                                                     01375000
         ORG   XDBAF2+44                                                01376000
XDBAF3   DS    CL24                                                     01377000
         ORG   XDBAF3                                                   01378000
@NM00094 DS    CL4                                                      01379000
         ORG   @NM00094                                                 01380000
@NM00095 DC    X'01'                                                    01381000
@NM00096 DC    X'40'                                                    01382000
@NM00097 DC    AL1(0)                                                   01383000
@NM00098 DC    AL1(0)                                                   01384000
         ORG   XDBAF3+4                                                 01385000
@NM00099 DS    CL4                                                      01386000
         ORG   @NM00099                                                 01387000
@NM00100 DC    X'04'                                                    01388000
@NM00101 DC    X'03'                                                    01389000
@NM00102 DC    AL1(0)                                                   01390000
@NM00103 DC    AL1(23)                                                  01391000
         ORG   XDBAF3+8                                                 01392000
@NM00104 DS    CL4                                                      01393000
         ORG   @NM00104                                                 01394000
@NM00105 DC    X'04'                                                    01395000
@NM00106 DC    X'03'                                                    01396000
@NM00107 DC    AL1(0)                                                   01397000
@NM00108 DC    AL1(32)                                                  01398000
         ORG   XDBAF3+12                                                01399000
@NM00109 DS    CL4                                                      01400000
         ORG   @NM00109                                                 01401000
@NM00110 DC    X'04'                                                    01402000
@NM00111 DC    X'03'                                                    01403000
@NM00112 DC    AL1(0)                                                   01404000
@NM00113 DC    AL1(41)                                                  01405000
         ORG   XDBAF3+16                                                01406000
@NM00114 DS    CL4                                                      01407000
         ORG   @NM00114                                                 01408000
@NM00115 DC    X'04'                                                    01409000
@NM00116 DC    X'03'                                                    01410000
@NM00117 DC    AL1(0)                                                   01411000
@NM00118 DC    AL1(50)                                                  01412000
         ORG   XDBAF3+20                                                01413000
@NM00119 DS    CL4                                                      01414000
         ORG   @NM00119                                                 01415000
@NM00120 DC    F'0'                                                     01416000
         ORG   XDBAF3+24                                                01417000
XDBAF4   DS    CL28                                                     01418000
         ORG   XDBAF4                                                   01419000
@NM00121 DS    CL4                                                      01420000
         ORG   @NM00121                                                 01421000
@NM00122 DC    X'01'                                                    01422000
@NM00123 DC    X'40'                                                    01423000
@NM00124 DC    AL1(0)                                                   01424000
@NM00125 DC    AL1(0)                                                   01425000
         ORG   XDBAF4+4                                                 01426000
@NM00126 DS    CL4                                                      01427000
         ORG   @NM00126                                                 01428000
@NM00127 DC    X'04'                                                    01429000
@NM00128 DC    X'03'                                                    01430000
@NM00129 DC    AL1(0)                                                   01431000
@NM00130 DC    AL1(23)                                                  01432000
         ORG   XDBAF4+8                                                 01433000
@NM00131 DS    CL4                                                      01434000
         ORG   @NM00131                                                 01435000
@NM00132 DC    X'04'                                                    01436000
@NM00133 DC    X'03'                                                    01437000
@NM00134 DC    AL1(0)                                                   01438000
@NM00135 DC    AL1(32)                                                  01439000
         ORG   XDBAF4+12                                                01440000
@NM00136 DS    CL4                                                      01441000
         ORG   @NM00136                                                 01442000
@NM00137 DC    X'04'                                                    01443000
@NM00138 DC    X'03'                                                    01444000
@NM00139 DC    AL1(0)                                                   01445000
@NM00140 DC    AL1(41)                                                  01446000
         ORG   XDBAF4+16                                                01447000
@NM00141 DS    CL4                                                      01448000
         ORG   @NM00141                                                 01449000
@NM00142 DC    X'04'                                                    01450000
@NM00143 DC    X'03'                                                    01451000
@NM00144 DC    AL1(0)                                                   01452000
@NM00145 DC    AL1(50)                                                  01453000
         ORG   XDBAF4+20                                                01454000
@NM00146 DS    CL4                                                      01455000
         ORG   @NM00146                                                 01456000
@NM00147 DC    X'04'                                                    01457000
@NM00148 DC    X'03'                                                    01458000
@NM00149 DC    AL1(0)                                                   01459000
@NM00150 DC    AL1(59)                                                  01460000
         ORG   XDBAF4+24                                                01461000
@NM00151 DS    CL4                                                      01462000
         ORG   @NM00151                                                 01463000
@NM00152 DC    F'0'                                                     01464000
         ORG   XDBAF4+28                                                01465000
XDBAF5   DS    CL40                                                     01466000
         ORG   XDBAF5                                                   01467000
@NM00153 DS    CL4                                                      01468000
         ORG   @NM00153                                                 01469000
@NM00154 DC    X'01'                                                    01470000
@NM00155 DC    X'40'                                                    01471000
@NM00156 DC    AL1(0)                                                   01472000
@NM00157 DC    AL1(0)                                                   01473000
         ORG   XDBAF5+4                                                 01474000
@NM00158 DS    CL4                                                      01475000
         ORG   @NM00158                                                 01476000
@NM00159 DC    X'04'                                                    01477000
@NM00160 DC    X'03'                                                    01478000
@NM00161 DC    AL1(0)                                                   01479000
@NM00162 DC    AL1(23)                                                  01480000
         ORG   XDBAF5+8                                                 01481000
@NM00163 DS    CL4                                                      01482000
         ORG   @NM00163                                                 01483000
@NM00164 DC    X'04'                                                    01484000
@NM00165 DC    X'03'                                                    01485000
@NM00166 DC    AL1(0)                                                   01486000
@NM00167 DC    AL1(32)                                                  01487000
         ORG   XDBAF5+12                                                01488000
@NM00168 DS    CL4                                                      01489000
         ORG   @NM00168                                                 01490000
@NM00169 DC    X'04'                                                    01491000
@NM00170 DC    X'03'                                                    01492000
@NM00171 DC    AL1(0)                                                   01493000
@NM00172 DC    AL1(41)                                                  01494000
         ORG   XDBAF5+16                                                01495000
@NM00173 DS    CL4                                                      01496000
         ORG   @NM00173                                                 01497000
@NM00174 DC    X'04'                                                    01498000
@NM00175 DC    X'03'                                                    01499000
@NM00176 DC    AL1(0)                                                   01500000
@NM00177 DC    AL1(50)                                                  01501000
         ORG   XDBAF5+20                                                01502000
@NM00178 DS    CL4                                                      01503000
         ORG   @NM00178                                                 01504000
@NM00179 DC    X'04'                                                    01505000
@NM00180 DC    X'03'                                                    01506000
@NM00181 DC    AL1(0)                                                   01507000
@NM00182 DC    AL1(59)                                                  01508000
         ORG   XDBAF5+24                                                01509000
@NM00183 DS    CL4                                                      01510000
         ORG   @NM00183                                                 01511000
@NM00184 DC    X'04'                                                    01512000
@NM00185 DC    X'03'                                                    01513000
@NM00186 DC    AL1(0)                                                   01514000
@NM00187 DC    AL1(68)                                                  01515000
         ORG   XDBAF5+28                                                01516000
@NM00188 DS    CL4                                                      01517000
         ORG   @NM00188                                                 01518000
@NM00189 DC    X'04'                                                    01519000
@NM00190 DC    X'03'                                                    01520000
@NM00191 DC    AL1(0)                                                   01521000
@NM00192 DC    AL1(77)                                                  01522000
         ORG   XDBAF5+32                                                01523000
@NM00193 DS    CL4                                                      01524000
         ORG   @NM00193                                                 01525000
@NM00194 DC    X'04'                                                    01526000
@NM00195 DC    X'03'                                                    01527000
@NM00196 DC    AL1(0)                                                   01528000
@NM00197 DC    AL1(86)                                                  01529000
         ORG   XDBAF5+36                                                01530000
@NM00198 DS    CL4                                                      01531000
         ORG   @NM00198                                                 01532000
@NM00199 DC    F'0'                                                     01533000
         ORG   XDBAF5+40                                                01534000
UCBL1    DS    CL7                                                      01535000
         ORG   UCBL1                                                    01536000
@NM00200 DC    CL4'LOCK'                                                01537000
@NM00201 DC    CL3'IOQ'                                                 01538000
         ORG   UCBL1+7                                                  01539000
         DS    CL1                                                      01540000
UCBF1    DS    CL20                                                     01541000
         ORG   UCBF1                                                    01542000
@NM00202 DS    CL4                                                      01543000
         ORG   @NM00202                                                 01544000
@NM00203 DC    X'01'                                                    01545000
@NM00204 DC    X'40'                                                    01546000
@NM00205 DC    AL1(0)                                                   01547000
@NM00206 DC    AL1(0)                                                   01548000
         ORG   UCBF1+4                                                  01549000
@NM00207 DS    CL8                                                      01550000
         ORG   @NM00207                                                 01551000
@NM00208 DC    X'07'                                                    01552000
@NM00209 DC    X'33'                                                    01553000
@NM00210 DC    AL1(8)                                                   01554000
@NM00211 DC    AL1(17)                                                  01555000
@NM00212 DC    AL4(UCBL1)                                               01556000
         ORG   UCBF1+12                                                 01557000
@NM00213 DS    CL4                                                      01558000
         ORG   @NM00213                                                 01559000
@NM00214 DC    X'05'                                                    01560000
@NM00215 DC    X'23'                                                    01561000
@NM00216 DC    AL1(26)                                                  01562000
@NM00217 DC    AL1(35)                                                  01563000
         ORG   UCBF1+16                                                 01564000
@NM00218 DS    CL4                                                      01565000
         ORG   @NM00218                                                 01566000
@NM00219 DC    F'0'                                                     01567000
         ORG   UCBF1+20                                                 01568000
UCBL2    DS    CL23                                                     01569000
         ORG   UCBL2                                                    01570000
@NM00220 DC    CL4'FLGS'                                                01571000
@NM00221 DC    CL2'ID'                                                  01572000
@NM00222 DC    CL6'STATUS'                                              01573000
@NM00223 DC    CL4'CHAN'                                                01574000
@NM00224 DC    CL7'DEVFLAG'                                             01575000
         ORG   UCBL2+23                                                 01576000
         DS    CL1                                                      01577000
UCBF2    DS    CL32                                                     01578000
         ORG   UCBF2                                                    01579000
@NM00225 DS    CL4                                                      01580000
         ORG   @NM00225                                                 01581000
@NM00226 DC    X'01'                                                    01582000
@NM00227 DC    X'40'                                                    01583000
@NM00228 DC    AL1(0)                                                   01584000
@NM00229 DC    AL1(0)                                                   01585000
         ORG   UCBF2+4                                                  01586000
@NM00230 DS    CL8                                                      01587000
         ORG   @NM00230                                                 01588000
@NM00231 DC    X'07'                                                    01589000
@NM00232 DC    X'31'                                                    01590000
@NM00233 DC    AL1(8)                                                   01591000
@NM00234 DC    AL1(17)                                                  01592000
@NM00235 DC    AL4(UCBL2)                                               01593000
         ORG   UCBF2+12                                                 01594000
@NM00236 DS    CL4                                                      01595000
         ORG   @NM00236                                                 01596000
@NM00237 DC    X'05'                                                    01597000
@NM00238 DC    X'10'                                                    01598000
@NM00239 DC    AL1(26)                                                  01599000
@NM00240 DC    AL1(35)                                                  01600000
         ORG   UCBF2+16                                                 01601000
@NM00241 DS    CL4                                                      01602000
         ORG   @NM00241                                                 01603000
@NM00242 DC    X'05'                                                    01604000
@NM00243 DC    X'50'                                                    01605000
@NM00244 DC    AL1(44)                                                  01606000
@NM00245 DC    AL1(53)                                                  01607000
         ORG   UCBF2+20                                                 01608000
@NM00246 DS    CL4                                                      01609000
         ORG   @NM00246                                                 01610000
@NM00247 DC    X'05'                                                    01611000
@NM00248 DC    X'33'                                                    01612000
@NM00249 DC    AL1(62)                                                  01613000
@NM00250 DC    AL1(71)                                                  01614000
         ORG   UCBF2+24                                                 01615000
@NM00251 DS    CL4                                                      01616000
         ORG   @NM00251                                                 01617000
@NM00252 DC    X'05'                                                    01618000
@NM00253 DC    X'63'                                                    01619000
@NM00254 DC    AL1(80)                                                  01620000
@NM00255 DC    AL1(89)                                                  01621000
         ORG   UCBF2+28                                                 01622000
@NM00256 DS    CL4                                                      01623000
         ORG   @NM00256                                                 01624000
@NM00257 DC    F'0'                                                     01625000
         ORG   UCBF2+32                                                 01626000
UCBL3    DS    CL20                                                     01627000
         ORG   UCBL3                                                    01628000
@NM00258 DC    CL8'UNITNAME'                                            01629000
@NM00259 DC    CL7'DEVTYPE'                                             01630000
@NM00260 DC    CL5'EXTPT'                                               01631000
         ORG   UCBL3+20                                                 01632000
UCBF3    DS    CL24                                                     01633000
         ORG   UCBF3                                                    01634000
@NM00261 DS    CL4                                                      01635000
         ORG   @NM00261                                                 01636000
@NM00262 DC    X'01'                                                    01637000
@NM00263 DC    X'40'                                                    01638000
@NM00264 DC    AL1(0)                                                   01639000
@NM00265 DC    AL1(0)                                                   01640000
         ORG   UCBF3+4                                                  01641000
@NM00266 DS    CL8                                                      01642000
         ORG   @NM00266                                                 01643000
@NM00267 DC    X'07'                                                    01644000
@NM00268 DC    X'73'                                                    01645000
@NM00269 DC    AL1(8)                                                   01646000
@NM00270 DC    AL1(17)                                                  01647000
@NM00271 DC    AL4(UCBL3)                                               01648000
         ORG   UCBF3+12                                                 01649000
@NM00272 DS    CL4                                                      01650000
         ORG   @NM00272                                                 01651000
@NM00273 DC    X'05'                                                    01652000
@NM00274 DC    X'63'                                                    01653000
@NM00275 DC    AL1(26)                                                  01654000
@NM00276 DC    AL1(35)                                                  01655000
         ORG   UCBF3+16                                                 01656000
@NM00277 DS    CL4                                                      01657000
         ORG   @NM00277                                                 01658000
@NM00278 DC    X'05'                                                    01659000
@NM00279 DC    X'43'                                                    01660000
@NM00280 DC    AL1(44)                                                  01661000
@NM00281 DC    AL1(53)                                                  01662000
         ORG   UCBF3+20                                                 01663000
@NM00282 DS    CL4                                                      01664000
         ORG   @NM00282                                                 01665000
@NM00283 DC    F'0'                                                     01666000
         ORG   UCBF3+24                                                 01667000
UCBP1    DS    CL12                                                     01668000
         ORG   UCBP1                                                    01669000
@NM00284 DS    CL4                                                      01670000
         ORG   @NM00284                                                 01671000
@NM00285 DC    X'01'                                                    01672000
@NM00286 DC    X'40'                                                    01673000
@NM00287 DC    AL1(0)                                                   01674000
@NM00288 DC    AL1(0)                                                   01675000
         ORG   UCBP1+4                                                  01676000
@NM00289 DS    CL4                                                      01677000
         ORG   @NM00289                                                 01678000
@NM00290 DC    X'04'                                                    01679000
@NM00291 DC    X'03'                                                    01680000
@NM00292 DC    AL1(0)                                                   01681000
@NM00293 DC    AL1(8)                                                   01682000
         ORG   UCBP1+8                                                  01683000
@NM00294 DS    CL4                                                      01684000
         ORG   @NM00294                                                 01685000
@NM00295 DC    F'0'                                                     01686000
         ORG   UCBP1+12                                                 01687000
UCBP2    DS    CL16                                                     01688000
         ORG   UCBP2                                                    01689000
@NM00296 DS    CL4                                                      01690000
         ORG   @NM00296                                                 01691000
@NM00297 DC    X'01'                                                    01692000
@NM00298 DC    X'40'                                                    01693000
@NM00299 DC    AL1(0)                                                   01694000
@NM00300 DC    AL1(0)                                                   01695000
         ORG   UCBP2+4                                                  01696000
@NM00301 DS    CL4                                                      01697000
         ORG   @NM00301                                                 01698000
@NM00302 DC    X'04'                                                    01699000
@NM00303 DC    X'03'                                                    01700000
@NM00304 DC    AL1(0)                                                   01701000
@NM00305 DC    AL1(8)                                                   01702000
         ORG   UCBP2+8                                                  01703000
@NM00306 DS    CL4                                                      01704000
         ORG   @NM00306                                                 01705000
@NM00307 DC    X'04'                                                    01706000
@NM00308 DC    X'03'                                                    01707000
@NM00309 DC    AL1(0)                                                   01708000
@NM00310 DC    AL1(17)                                                  01709000
         ORG   UCBP2+12                                                 01710000
@NM00311 DS    CL4                                                      01711000
         ORG   @NM00311                                                 01712000
@NM00312 DC    F'0'                                                     01713000
         ORG   UCBP2+16                                                 01714000
UCBP4    DS    CL24                                                     01715000
         ORG   UCBP4                                                    01716000
@NM00313 DS    CL4                                                      01717000
         ORG   @NM00313                                                 01718000
@NM00314 DC    X'01'                                                    01719000
@NM00315 DC    X'40'                                                    01720000
@NM00316 DC    AL1(0)                                                   01721000
@NM00317 DC    AL1(0)                                                   01722000
         ORG   UCBP4+4                                                  01723000
@NM00318 DS    CL4                                                      01724000
         ORG   @NM00318                                                 01725000
@NM00319 DC    X'04'                                                    01726000
@NM00320 DC    X'03'                                                    01727000
@NM00321 DC    AL1(0)                                                   01728000
@NM00322 DC    AL1(8)                                                   01729000
         ORG   UCBP4+8                                                  01730000
@NM00323 DS    CL4                                                      01731000
         ORG   @NM00323                                                 01732000
@NM00324 DC    X'04'                                                    01733000
@NM00325 DC    X'03'                                                    01734000
@NM00326 DC    AL1(0)                                                   01735000
@NM00327 DC    AL1(17)                                                  01736000
         ORG   UCBP4+12                                                 01737000
@NM00328 DS    CL4                                                      01738000
         ORG   @NM00328                                                 01739000
@NM00329 DC    X'04'                                                    01740000
@NM00330 DC    X'03'                                                    01741000
@NM00331 DC    AL1(0)                                                   01742000
@NM00332 DC    AL1(26)                                                  01743000
         ORG   UCBP4+16                                                 01744000
@NM00333 DS    CL4                                                      01745000
         ORG   @NM00333                                                 01746000
@NM00334 DC    X'04'                                                    01747000
@NM00335 DC    X'03'                                                    01748000
@NM00336 DC    AL1(0)                                                   01749000
@NM00337 DC    AL1(35)                                                  01750000
         ORG   UCBP4+20                                                 01751000
@NM00338 DS    CL4                                                      01752000
         ORG   @NM00338                                                 01753000
@NM00339 DC    F'0'                                                     01754000
         ORG   UCBP4+24                                                 01755000
UCBP6    DS    CL32                                                     01756000
         ORG   UCBP6                                                    01757000
@NM00340 DS    CL4                                                      01758000
         ORG   @NM00340                                                 01759000
@NM00341 DC    X'01'                                                    01760000
@NM00342 DC    X'40'                                                    01761000
@NM00343 DC    AL1(0)                                                   01762000
@NM00344 DC    AL1(0)                                                   01763000
         ORG   UCBP6+4                                                  01764000
@NM00345 DS    CL4                                                      01765000
         ORG   @NM00345                                                 01766000
@NM00346 DC    X'04'                                                    01767000
@NM00347 DC    X'03'                                                    01768000
@NM00348 DC    AL1(0)                                                   01769000
@NM00349 DC    AL1(8)                                                   01770000
         ORG   UCBP6+8                                                  01771000
@NM00350 DS    CL4                                                      01772000
         ORG   @NM00350                                                 01773000
@NM00351 DC    X'04'                                                    01774000
@NM00352 DC    X'03'                                                    01775000
@NM00353 DC    AL1(0)                                                   01776000
@NM00354 DC    AL1(17)                                                  01777000
         ORG   UCBP6+12                                                 01778000
@NM00355 DS    CL4                                                      01779000
         ORG   @NM00355                                                 01780000
@NM00356 DC    X'04'                                                    01781000
@NM00357 DC    X'03'                                                    01782000
@NM00358 DC    AL1(0)                                                   01783000
@NM00359 DC    AL1(26)                                                  01784000
         ORG   UCBP6+16                                                 01785000
@NM00360 DS    CL4                                                      01786000
         ORG   @NM00360                                                 01787000
@NM00361 DC    X'04'                                                    01788000
@NM00362 DC    X'03'                                                    01789000
@NM00363 DC    AL1(0)                                                   01790000
@NM00364 DC    AL1(35)                                                  01791000
         ORG   UCBP6+20                                                 01792000
@NM00365 DS    CL4                                                      01793000
         ORG   @NM00365                                                 01794000
@NM00366 DC    X'04'                                                    01795000
@NM00367 DC    X'03'                                                    01796000
@NM00368 DC    AL1(0)                                                   01797000
@NM00369 DC    AL1(44)                                                  01798000
         ORG   UCBP6+24                                                 01799000
@NM00370 DS    CL4                                                      01800000
         ORG   @NM00370                                                 01801000
@NM00371 DC    X'04'                                                    01802000
@NM00372 DC    X'03'                                                    01803000
@NM00373 DC    AL1(0)                                                   01804000
@NM00374 DC    AL1(53)                                                  01805000
         ORG   UCBP6+28                                                 01806000
@NM00375 DS    CL4                                                      01807000
         ORG   @NM00375                                                 01808000
@NM00376 DC    F'0'                                                     01809000
         ORG   UCBP6+32                                                 01810000
BLANKS   DC    CL5' '                                                   01811000
TRANS    DS    CL256                                                    01812000
         ORG   TRANS                                                    01813000
@NM00380 DS    CL64                                                     01814000
BL       DC    CL1' '                                                   01815000
@NM00381 DS    CL175                                                    01816000
NUMS     DC    CL16'0123456789ABCDEF'                                   01817000
         ORG   TRANS+256                                                01818000
CHARHDR  DC    CL18'(CHARACTER READER)'                                 01819000
COMHDR   DC    CL21'(COMMUNICATION TYPE)'                               01820000
CTCHDR   DC    CL25'(CHANNEL TO CHANNEL TYPE)'                          01821000
DAHDR    DC    CL20'(DIRECT ACCESS TYPE)'                               01822000
EXCPDHDR DC    CL54'-XDBA-    (EXCPD)    ---------------------AT LOCATIC01823000
               ON '                                                     01824000
EXCPDMSG DC    CL120'*** FORMATTING SERVICE ROUTINE ERROR DURING EXCPD C01825000
               FORMATTING (POSSILE CAUSE: DATA NOT IN DUMP) ***'        01826000
EXCPUS   DC    CL6'------'                                              01827000
GRAPHDR  DC    CL15'(GRAPHICS TYPE)'                                    01828000
HDR3704  DC    CL31'(3704,3705 TELEPROCESSING TYPE)'                    01829000
HDR3800  DC    CL13'(3800 DEVICE)'                                      01830000
HDR3851  DC    CL18'(3851 DEVICE TYPE)'                                 01831000
MAGHDR   DC    CL20'(MAGNETIC TAPE TYPE)'                               01832000
UCBHDR   DC    CL54'-UCB-                                     AT LOCATIC01833000
               ON '                                                     01834000
UCBMSG   DC    CL120'*** FORMATTING SERVICE ROUTINE ERROR DURING UCB FOC01835000
               RMATTING (POSSIBLE CAUSE: DATA NOT IN DUMP) ***'         01836000
UCHARHDR DC    CL31'(UNIT REC W/UNIVERSAL CHAR SET)'                    01837000
UNITHDR  DC    CL18'(UNIT RECORD TYPE)'                                 01838000
UNKNOWN  DC    CL56'        *** UNKNOWN UCB TYPE FOR UCB AT LOCATION'   01839000
IO1PATCH DC    CL200'PATCH AREA FOR IECIOFT1 - IT IS 200 BYTES LONG'    01840000
         DS    CL3                                                      01841000
CTCARRAY DC    AL4(UCBF1)                                               01842000
         DC    AL4(UCBF2)                                               01843000
         DC    AL4(UCBF3)                                               01844000
         DC    AL4(UCBP2)                                               01845000
ARY3800  DC    AL4(UCBF1)                                               01846000
         DC    AL4(UCBF2)                                               01847000
         DC    AL4(UCBF3)                                               01848000
         DC    AL4(UCBP1)                                               01849000
COMARRAY DC    AL4(UCBF1)                                               01850000
         DC    AL4(UCBF2)                                               01851000
         DC    AL4(UCBF3)                                               01852000
MAGDARAY DC    AL4(UCBF1)                                               01853000
         DC    AL4(UCBF2)                                               01854000
         DC    AL4(UCBF3)                                               01855000
         DC    AL4(UCBP6)                                               01856000
GRAPHARY DC    AL4(UCBF1)                                               01857000
         DC    AL4(UCBF2)                                               01858000
         DC    AL4(UCBF3)                                               01859000
         DC    AL4(UCBP4)                                               01860000
XDBANAME DC    AL4(XDBAF1)                                              01861000
         DC    AL4(XDBAF2)                                              01862000
         DC    AL4(XDBAF5)                                              01863000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01864000
@01      EQU   01                                                       01865000
@02      EQU   02                                                       01866000
@03      EQU   03                                                       01867000
@04      EQU   04                                                       01868000
@05      EQU   05                                                       01869000
@06      EQU   06                                                       01870000
@07      EQU   07                                                       01871000
@08      EQU   08                                                       01872000
@09      EQU   09                                                       01873000
@10      EQU   10                                                       01874000
@11      EQU   11                                                       01875000
@12      EQU   12                                                       01876000
@13      EQU   13                                                       01877000
@14      EQU   14                                                       01878000
@15      EQU   15                                                       01879000
SAVEPTR  EQU   @09                                                      01880000
EXCPDPTR EQU   @05                                                      01881000
RCCODE   EQU   @07                                                      01882000
ESTAPTR  EQU   @06                                                      01883000
DATAPTR  EQU   @08                                                      01884000
CONVRT   EQU   @07                                                      01885000
ARRAYCNT EQU   @05                                                      01886000
UCBPTR   EQU   @05                                                      01887000
ABDPLPTR EQU   @01                                                      01888000
LINEPTR  EQU   @00                                                      01889000
VADR     EQU   @00                                                      01890000
RCREG    EQU   @15                                                      01891000
ABDPL    EQU   0                                                        01892000
ADPLFLAG EQU   ABDPL+7                                                  01893000
ADPLSNPR EQU   ADPLFLAG                                                 01894000
ADPLBUF  EQU   ABDPL+8                                                  01895000
ADPLPRNT EQU   ABDPL+12                                                 01896000
ADPLMEMA EQU   ABDPL+20                                                 01897000
ADPLFRMT EQU   ABDPL+24                                                 01898000
ADPLCOM1 EQU   ABDPL+28                                                 01899000
ADPLFMT1 EQU   ABDPL+44                                                 01900000
ADPLFMT2 EQU   ABDPL+48                                                 01901000
UCB      EQU   0                                                        01902000
UCBOB    EQU   0                                                        01903000
UCBJBNR  EQU   UCBOB                                                    01904000
UCBFL5   EQU   UCBOB+1                                                  01905000
UCBAF    EQU   UCBFL5                                                   01906000
UCBSTAT  EQU   UCBOB+3                                                  01907000
UCBCHAN  EQU   UCBOB+4                                                  01908000
UCBSFLS  EQU   UCBOB+6                                                  01909000
UCBFLA   EQU   UCBSFLS                                                  01910000
UCBFL1   EQU   UCBFLA                                                   01911000
UCBBSY   EQU   UCBFL1                                                   01912000
UCBNRY   EQU   UCBFL1                                                   01913000
UCBPST   EQU   UCBFL1                                                   01914000
UCBCUB   EQU   UCBFL1                                                   01915000
UCBFLB   EQU   UCBSFLS+1                                                01916000
UCBCHM   EQU   UCBOB+8                                                  01917000
UCBCHM1  EQU   UCBCHM                                                   01918000
UCBPTH0  EQU   UCBCHM1                                                  01919000
UCBPTH1  EQU   UCBCHM1                                                  01920000
UCBWGT   EQU   UCBOB+12                                                 01921000
UCBTYP   EQU   UCBOB+16                                                 01922000
UCBTBYT1 EQU   UCBTYP                                                   01923000
UCB1FEA5 EQU   UCBTBYT1                                                 01924000
UCB1FEA6 EQU   UCBTBYT1                                                 01925000
UCBTBYT2 EQU   UCBTYP+1                                                 01926000
UCB2OPT2 EQU   UCBTBYT2                                                 01927000
UCBDUDN1 EQU   UCB2OPT2                                                 01928000
UCB2OPT3 EQU   UCBTBYT2                                                 01929000
UCBDUDN2 EQU   UCB2OPT3                                                 01930000
UCB2OPT4 EQU   UCBTBYT2                                                 01931000
UCBRWTAU EQU   UCB2OPT4                                                 01932000
UCB2OPT6 EQU   UCBTBYT2                                                 01933000
UCB2OPT7 EQU   UCBTBYT2                                                 01934000
UCBTBYT3 EQU   UCBTYP+2                                                 01935000
UCBDVCLS EQU   UCBTBYT3                                                 01936000
UCBTBYT4 EQU   UCBTYP+3                                                 01937000
UCBEXTPT EQU   UCBOB+20                                                 01938000
UCBFLC   EQU   UCBEXTPT                                                 01939000
UCBDEV   EQU   UCBOB+24                                                 01940000
UCBCMEXT EQU   0                                                        01941000
UCBATI   EQU   UCBCMEXT+3                                               01942000
@NM00005 EQU   UCBATI                                                   01943000
UCBFLP1  EQU   UCBCMEXT+5                                               01944000
UCBMT    EQU   0                                                        01945000
UCBOCR   EQU   0                                                        01946000
UCB3540X EQU   0                                                        01947000
UCBDKBYT EQU   UCB3540X+6                                               01948000
UCB3800X EQU   0                                                        01949000
UCBOPTNS EQU   UCB3800X                                                 01950000
UCBACTIV EQU   UCB3800X+3                                               01951000
UCBMDRBF EQU   UCB3800X+36                                              01952000
UCBUCS   EQU   0                                                        01953000
UCBUCSOP EQU   UCBUCS+4                                                 01954000
UCBFCBOP EQU   UCBUCS+5                                                 01955000
ACCESS   EQU   0                                                        01956000
FORMAT   EQU   0                                                        01957000
PRINT    EQU   0                                                        01958000
BUFFER   EQU   0                                                        01959000
HDRTYPE  EQU   BUFFER+10                                                01960000
ADDRESS  EQU   BUFFER+55                                                01961000
DATADWRD EQU   0                                                        01962000
DATAWORD EQU   0                                                        01963000
ESTAPARM EQU   0                                                        01964000
ESTAERR  EQU   ESTAPARM                                                 01965000
ERREXP   EQU   ESTAERR                                                  01966000
RTYADR   EQU   ESTAPARM+4                                               01967000
RTYREGS  EQU   ESTAPARM+8                                               01968000
LCALREGS EQU   ESTAPARM+72                                              01969000
MSG      EQU   0                                                        01970000
UCBBGN   EQU   0                                                        01971000
UCBOBS01 EQU   UCBDEV                                                   01972000
UCBSTAB  EQU   UCBOBS01+10                                              01973000
UCBBSVL  EQU   UCBSTAB                                                  01974000
UCBPRSRS EQU   UCBSTAB                                                  01975000
UCBDMCT  EQU   UCBOBS01+11                                              01976000
UCBFL4   EQU   UCBOBS01+13                                              01977000
UCBOBS02 EQU   UCBDEV                                                   01978000
UCBTFL1  EQU   UCBOBS02+19                                              01979000
UCBXTN   EQU   UCBOBS02+20                                              01980000
UCBVOPT  EQU   UCBXTN                                                   01981000
UCBOBS03 EQU   UCBDEV                                                   01982000
UCBXTADR EQU   UCBOBS03                                                 01983000
UCBOBS04 EQU   UCBDEV                                                   01984000
UCBBTA   EQU   UCBOBS04+12                                              01985000
UCBOBS06 EQU   UCBDEV                                                   01986000
UCBAOF   EQU   UCBOBS06                                                 01987000
UCBAOF1  EQU   UCBAOF                                                   01988000
UCBAOF2  EQU   UCBAOF+1                                                 01989000
@NM00004 EQU   UCBOBS06+3                                               01990000
UCBIRB   EQU   UCBOBS06+4                                               01991000
UCBGRAF  EQU   UCBIRB                                                   01992000
UCBLDNCA EQU   UCBOBS06+8                                               01993000
UCBRDYQ  EQU   UCBLDNCA                                                 01994000
UCBIRLN  EQU   UCBRDYQ                                                  01995000
UCBLDNCB EQU   UCBRDYQ+1                                                01996000
UCBCTLNK EQU   UCBOBS06+12                                              01997000
UCBOBS07 EQU   UCBDEV                                                   01998000
UCBOBS08 EQU   UCBDEV                                                   01999000
UCBCTCAD EQU   UCBOBS08                                                 02000000
UCBCTCF1 EQU   UCBOBS08+4                                               02001000
UCBOBS09 EQU   UCBDEV                                                   02002000
ARRY3704 EQU   CTCARRAY                                                 02003000
ARY3851  EQU   CTCARRAY                                                 02004000
CHARARY  EQU   COMARRAY                                                 02005000
DARRAY   EQU   MAGDARAY                                                 02006000
START    EQU   ADPLFMT1                                                 02007000
UCHARRAY EQU   ARY3800                                                  02008000
UNITARY  EQU   COMARRAY                                                 02009000
UCBUS    EQU   EXCPUS                                                   02010000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02011000
UCBRV066 EQU   UCBOBS09+4                                               02012000
UCBIOSBA EQU   UCBOBS09                                                 02013000
UCBRV042 EQU   UCBOBS08+5                                               02014000
UCBRV082 EQU   UCBCTCF1                                                 02015000
UCBRV081 EQU   UCBCTCF1                                                 02016000
UCBRV080 EQU   UCBCTCF1                                                 02017000
UCBRV079 EQU   UCBCTCF1                                                 02018000
UCBRV078 EQU   UCBCTCF1                                                 02019000
UCBRV077 EQU   UCBCTCF1                                                 02020000
UCBRV076 EQU   UCBCTCF1                                                 02021000
UCBCTC80 EQU   UCBCTCF1                                                 02022000
UCBCTCAL EQU   UCBCTCAD                                                 02023000
UCBICNCB EQU   UCBOBS07+4                                               02024000
UCBRV040 EQU   UCBOBS07                                                 02025000
UCBCTLNA EQU   UCBCTLNK+1                                               02026000
UCBRLN   EQU   UCBCTLNK                                                 02027000
UCBRDYQA EQU   UCBLDNCB                                                 02028000
UCBINRLN EQU   UCBIRLN                                                  02029000
UCBIRBA  EQU   UCBIRB+1                                                 02030000
UCBRV039 EQU   UCBGRAF                                                  02031000
UCBDWNR  EQU   UCBGRAF                                                  02032000
UCBRPND  EQU   UCBGRAF                                                  02033000
UCBUPM   EQU   UCBGRAF                                                  02034000
UCBBTAM  EQU   UCBGRAF                                                  02035000
UCBDRNO  EQU   UCBGRAF                                                  02036000
UCBDRO   EQU   UCBGRAF                                                  02037000
UCBOIP   EQU   UCBGRAF                                                  02038000
UCBATRCD EQU   @NM00004                                                 02039000
UCBSKPFG EQU   @NM00004                                                 02040000
UCBRIPND EQU   @NM00004                                                 02041000
UCBRTIAC EQU   @NM00004                                                 02042000
UCBRSV79 EQU   @NM00004                                                 02043000
UCBRSV78 EQU   @NM00004                                                 02044000
UCBRSV77 EQU   @NM00004                                                 02045000
UCBOLTEP EQU   @NM00004                                                 02046000
UCBATNCT EQU   UCBOBS06+2                                               02047000
UCBRSV76 EQU   UCBAOF2                                                  02048000
UCBRSV75 EQU   UCBAOF2                                                  02049000
UCBRSV74 EQU   UCBAOF2                                                  02050000
UCBRSV73 EQU   UCBAOF2                                                  02051000
UCBRSV72 EQU   UCBAOF2                                                  02052000
UCBRSV71 EQU   UCBAOF2                                                  02053000
UCBRSV70 EQU   UCBAOF2                                                  02054000
UCBRSV69 EQU   UCBAOF2                                                  02055000
UCBRSV68 EQU   UCBAOF1                                                  02056000
UCBRSV67 EQU   UCBAOF1                                                  02057000
UCBRSV66 EQU   UCBAOF1                                                  02058000
UCBRSV65 EQU   UCBAOF1                                                  02059000
UCBRSV64 EQU   UCBAOF1                                                  02060000
UCBOFNL  EQU   UCBAOF1                                                  02061000
UCBOFSP  EQU   UCBAOF1                                                  02062000
UCBOFMCR EQU   UCBAOF1                                                  02063000
UCBBTB   EQU   UCBBTA+1                                                 02064000
UCBDI    EQU   UCBBTA                                                   02065000
UCBSNS   EQU   UCBOBS04+8                                               02066000
UCBTEB   EQU   UCBOBS04+4                                               02067000
UCBGCB   EQU   UCBOBS04+3                                               02068000
UCBOPEN  EQU   UCBOBS04+2                                               02069000
UCBSTART EQU   UCBOBS04                                                 02070000
UCBXTNB  EQU   UCBXTN+1                                                 02071000
UCBRSV22 EQU   UCBVOPT                                                  02072000
UCBRSV21 EQU   UCBVOPT                                                  02073000
UCBRSV20 EQU   UCBVOPT                                                  02074000
UCBESVE  EQU   UCBVOPT                                                  02075000
UCBERPC  EQU   UCBVOPT                                                  02076000
UCBESVC  EQU   UCBVOPT                                                  02077000
UCBEVA   EQU   UCBVOPT                                                  02078000
UCBESV   EQU   UCBVOPT                                                  02079000
UCBRV009 EQU   UCBTFL1                                                  02080000
UCBRV008 EQU   UCBTFL1                                                  02081000
UCBRV007 EQU   UCBTFL1                                                  02082000
UCBRV006 EQU   UCBTFL1                                                  02083000
UCBRV005 EQU   UCBTFL1                                                  02084000
UCBRV038 EQU   UCBTFL1                                                  02085000
UCBNSLTP EQU   UCBTFL1                                                  02086000
UCBNLTP  EQU   UCBTFL1                                                  02087000
UCBRES1B EQU   UCBOBS02+18                                              02088000
UCBFSER  EQU   UCBOBS02+12                                              02089000
@NM00003 EQU   UCBOBS02+4                                               02090000
UCBFSEQ  EQU   UCBOBS02+2                                               02091000
UCBFSCT  EQU   UCBOBS02                                                 02092000
UCBNEXP  EQU   UCBOBS01+20                                              02093000
UCBBASE  EQU   UCBOBS01+16                                              02094000
UCBRES1A EQU   UCBOBS01+15                                              02095000
UCBUSER  EQU   UCBOBS01+14                                              02096000
UCBFL47  EQU   UCBFL4                                                   02097000
UCBFL46  EQU   UCBFL4                                                   02098000
UCBFL45  EQU   UCBFL4                                                   02099000
UCBRV065 EQU   UCBFL4                                                   02100000
UCBDSS   EQU   UCBFL4                                                   02101000
UCBRESVP EQU   UCBFL4                                                   02102000
UCBWDAV  EQU   UCBFL4                                                   02103000
UCBDAVV  EQU   UCBFL4                                                   02104000
UCBSQC   EQU   UCBOBS01+12                                              02105000
UCBDATP  EQU   UCBOBS01+12                                              02106000
UCBDMC   EQU   UCBDMCT                                                  02107000
UCBMOUNT EQU   UCBDMCT                                                  02108000
UCBBNUL  EQU   UCBSTAB                                                  02109000
UCBSHAR  EQU   UCBSTAB                                                  02110000
UCBBSTR  EQU   UCBSTAB                                                  02111000
UCBBPUB  EQU   UCBSTAB                                                  02112000
UCBBPRV  EQU   UCBSTAB                                                  02113000
UCBBALB  EQU   UCBPRSRS                                                 02114000
UCBPGFL  EQU   UCBSTAB                                                  02115000
UCBDVSHR EQU   UCBBSVL                                                  02116000
UCBVOLI  EQU   UCBOBS01+4                                               02117000
UCBVTOC  EQU   UCBOBS01                                                 02118000
@NM00379 EQU   ESTAERR                                                  02119000
UNEXP2   EQU   ESTAERR                                                  02120000
LOCKHELD EQU   ESTAERR                                                  02121000
@NM00378 EQU   BUFFER+64                                                02122000
@NM00377 EQU   BUFFER+6                                                 02123000
OFFSET   EQU   BUFFER                                                   02124000
UCBERADR EQU   UCBUCS+12                                                02125000
UCBFCBID EQU   UCBUCS+8                                                 02126000
UCBERCNT EQU   UCBUCS+7                                                 02127000
UCBRSV51 EQU   UCBUCS+6                                                 02128000
UCBRSV50 EQU   UCBFCBOP                                                 02129000
UCBRSV49 EQU   UCBFCBOP                                                 02130000
UCBRSV48 EQU   UCBFCBOP                                                 02131000
UCBRSV47 EQU   UCBFCBOP                                                 02132000
UCBRSV46 EQU   UCBFCBOP                                                 02133000
UCBRSV45 EQU   UCBFCBOP                                                 02134000
UCBRSV44 EQU   UCBFCBOP                                                 02135000
UCBFCBO1 EQU   UCBFCBOP                                                 02136000
UCBUCSPE EQU   UCBUCSOP                                                 02137000
UCBRSV43 EQU   UCBUCSOP                                                 02138000
UCBRSV42 EQU   UCBUCSOP                                                 02139000
UCBRSV41 EQU   UCBUCSOP                                                 02140000
UCBRSV40 EQU   UCBUCSOP                                                 02141000
UCBRSV39 EQU   UCBUCSOP                                                 02142000
UCBUCSO2 EQU   UCBUCSOP                                                 02143000
UCBUCSO1 EQU   UCBUCSOP                                                 02144000
UCBUCSID EQU   UCBUCS                                                   02145000
UCBMDRBA EQU   UCBMDRBF+1                                               02146000
UCBRV075 EQU   UCBMDRBF                                                 02147000
UCBRV074 EQU   UCB3800X+32                                              02148000
UCBIMAGE EQU   UCB3800X+28                                              02149000
UCBFCBNM EQU   UCB3800X+24                                              02150000
UCBCHAR4 EQU   UCB3800X+20                                              02151000
UCBCHAR3 EQU   UCB3800X+16                                              02152000
UCBCHAR2 EQU   UCB3800X+12                                              02153000
UCBCHAR1 EQU   UCB3800X+8                                               02154000
UCBCGMID EQU   UCB3800X+4                                               02155000
UCBBRSTA EQU   UCBACTIV                                                 02156000
UCBRV063 EQU   UCBACTIV                                                 02157000
UCBRV062 EQU   UCBACTIV                                                 02158000
UCBRV061 EQU   UCBACTIV                                                 02159000
UCBRV060 EQU   UCBACTIV                                                 02160000
UCBRV059 EQU   UCBACTIV                                                 02161000
UCBRV058 EQU   UCBACTIV                                                 02162000
UCBRV057 EQU   UCBACTIV                                                 02163000
UCBRV050 EQU   UCB3800X+2                                               02164000
UCBCGMNO EQU   UCB3800X+1                                               02165000
UCBRV083 EQU   UCBOPTNS                                                 02166000
UCBBRSTR EQU   UCBOPTNS                                                 02167000
UCBRV056 EQU   UCBOPTNS                                                 02168000
UCBRV055 EQU   UCBOPTNS                                                 02169000
UCBRV054 EQU   UCBOPTNS                                                 02170000
UCBRV053 EQU   UCBOPTNS                                                 02171000
UCBRV052 EQU   UCBOPTNS                                                 02172000
UCBRV051 EQU   UCBOPTNS                                                 02173000
UCBRV073 EQU   UCB3540X+7                                               02174000
UCBRV072 EQU   UCBDKBYT                                                 02175000
UCBRV071 EQU   UCBDKBYT                                                 02176000
UCBRV070 EQU   UCBDKBYT                                                 02177000
UCBRV069 EQU   UCBDKBYT                                                 02178000
UCBRV068 EQU   UCBDKBYT                                                 02179000
UCBRV067 EQU   UCBDKBYT                                                 02180000
UCBVLVER EQU   UCBDKBYT                                                 02181000
UCBDKAMX EQU   UCBDKBYT                                                 02182000
UCBVLSER EQU   UCB3540X                                                 02183000
UCBRDATA EQU   UCBOCR+4                                                 02184000
UCBFRID  EQU   UCBOCR                                                   02185000
UCBCLN   EQU   UCBMT+14                                                 02186000
UCBERG   EQU   UCBMT+12                                                 02187000
UCBMS    EQU   UCBMT+11                                                 02188000
UCBNB    EQU   UCBMT+10                                                 02189000
UCBPW    EQU   UCBMT+9                                                  02190000
UCBPR    EQU   UCBMT+8                                                  02191000
UCBSIO   EQU   UCBMT+6                                                  02192000
UCBTW    EQU   UCBMT+5                                                  02193000
UCBTR    EQU   UCBMT+4                                                  02194000
UCBTWT   EQU   UCBMT+3                                                  02195000
UCBTRT   EQU   UCBMT+2                                                  02196000
UCBCTD   EQU   UCBMT                                                    02197000
UCBWTOID EQU   UCBCMEXT+17                                              02198000
UCBRV043 EQU   UCBCMEXT+16                                              02199000
UCBASID  EQU   UCBCMEXT+14                                              02200000
UCBMFCNT EQU   UCBCMEXT+12                                              02201000
UCBPMSK  EQU   UCBCMEXT+10                                              02202000
UCBCCWOF EQU   UCBCMEXT+8                                               02203000
UCBRV041 EQU   UCBCMEXT+6                                               02204000
UCBRV036 EQU   UCBFLP1                                                  02205000
UCBRV035 EQU   UCBFLP1                                                  02206000
UCBERLOG EQU   UCBFLP1                                                  02207000
UCBRV033 EQU   UCBFLP1                                                  02208000
UCBRV032 EQU   UCBFLP1                                                  02209000
UCBRV031 EQU   UCBFLP1                                                  02210000
UCBSHRUP EQU   UCBFLP1                                                  02211000
UCBNSRCH EQU   UCBFLP1                                                  02212000
UCBSNSCT EQU   UCBCMEXT+4                                               02213000
UCBHPDV  EQU   @NM00005                                                 02214000
UCBHALI  EQU   @NM00005                                                 02215000
UCBRSV09 EQU   @NM00005                                                 02216000
UCBRSV08 EQU   @NM00005                                                 02217000
UCBRSV07 EQU   @NM00005                                                 02218000
UCBRSV06 EQU   @NM00005                                                 02219000
UCBRSV05 EQU   @NM00005                                                 02220000
UCBRSV04 EQU   @NM00005                                                 02221000
UCBDTI   EQU   UCBCMEXT+2                                               02222000
UCBSTI   EQU   UCBCMEXT+1                                               02223000
UCBETI   EQU   UCBCMEXT                                                 02224000
UCBEXTP  EQU   UCBEXTPT+1                                               02225000
UCBDDRSW EQU   UCBFLC                                                   02226000
UCBTICBT EQU   UCBFLC                                                   02227000
UCBIVRR  EQU   UCBFLC                                                   02228000
UCBIVRS  EQU   UCBFLC                                                   02229000
UCBITF   EQU   UCBFLC                                                   02230000
UCBUDE   EQU   UCBFLC                                                   02231000
UCBWAA   EQU   UCBFLC                                                   02232000
UCBATTP  EQU   UCBFLC                                                   02233000
UCBUNTYP EQU   UCBTBYT4                                                 02234000
UCBRSV11 EQU   UCBDVCLS                                                 02235000
UCBRSV10 EQU   UCBDVCLS                                                 02236000
UCB3CHAR EQU   UCBDVCLS                                                 02237000
UCB3UREC EQU   UCBDVCLS                                                 02238000
UCB3DISP EQU   UCBDVCLS                                                 02239000
UCB3DACC EQU   UCBDVCLS                                                 02240000
UCB3COMM EQU   UCBDVCLS                                                 02241000
UCB3TAPE EQU   UCBDVCLS                                                 02242000
UCBDVPWR EQU   UCB2OPT7                                                 02243000
UCBVLPWR EQU   UCB2OPT6                                                 02244000
UCB2OPT5 EQU   UCBTBYT2                                                 02245000
UCBRVDEV EQU   UCBRWTAU                                                 02246000
UCBRPS   EQU   UCBDUDN2                                                 02247000
UCBRR    EQU   UCBDUDN1                                                 02248000
UCB2OPT1 EQU   UCBTBYT2                                                 02249000
UCB2OPT0 EQU   UCBTBYT2                                                 02250000
UCB1FEA7 EQU   UCBTBYT1                                                 02251000
UCBD6250 EQU   UCB1FEA6                                                 02252000
UCBD1600 EQU   UCB1FEA5                                                 02253000
UCB1FEA4 EQU   UCBTBYT1                                                 02254000
UCB1FEA3 EQU   UCBTBYT1                                                 02255000
UCB1FEA2 EQU   UCBTBYT1                                                 02256000
UCB1FEA1 EQU   UCBTBYT1                                                 02257000
UCB1FEA0 EQU   UCBTBYT1                                                 02258000
UCBNAME  EQU   UCBOB+13                                                 02259000
UCBRV029 EQU   UCBWGT                                                   02260000
UCBVHRSN EQU   UCBWGT                                                   02261000
UCBVORSN EQU   UCBWGT                                                   02262000
UCBMTPXP EQU   UCBWGT                                                   02263000
UCBREW   EQU   UCBWGT                                                   02264000
UCBPUB   EQU   UCBWGT                                                   02265000
UCBOUT   EQU   UCBWGT                                                   02266000
UCBIN    EQU   UCBWGT                                                   02267000
UCBCPU   EQU   UCBOB+11                                                 02268000
UCBLCI   EQU   UCBOB+10                                                 02269000
UCBCNT   EQU   UCBOB+9                                                  02270000
UCBRV017 EQU   UCBCHM1                                                  02271000
UCBRV016 EQU   UCBCHM1                                                  02272000
UCBRV015 EQU   UCBCHM1                                                  02273000
UCBRV014 EQU   UCBCHM1                                                  02274000
UCBSPB   EQU   UCBPTH1                                                  02275000
UCBPPB   EQU   UCBPTH1                                                  02276000
UCBSPA   EQU   UCBPTH0                                                  02277000
UCBPPA   EQU   UCBPTH0                                                  02278000
UCBSIGP  EQU   UCBFLB                                                   02279000
UCBVALPH EQU   UCBFLB                                                   02280000
UCBCRHSN EQU   UCBFLB                                                   02281000
UCBCRHRV EQU   UCBFLB                                                   02282000
UCBRESVH EQU   UCBFLB                                                   02283000
UCBSPST  EQU   UCBFLB                                                   02284000
UCBASNS  EQU   UCBFLB                                                   02285000
UCBIORST EQU   UCBFLB                                                   02286000
UCBQISCE EQU   UCBFL1                                                   02287000
UCBACTV  EQU   UCBFL1                                                   02288000
UCBSAP   EQU   UCBFL1                                                   02289000
UCBNOTRC EQU   UCBCUB                                                   02290000
UCBPSNS  EQU   UCBFL1                                                   02291000
UCBUSING EQU   UCBPST                                                   02292000
UCBNOTRD EQU   UCBNRY                                                   02293000
UCBBUSYD EQU   UCBBSY                                                   02294000
UCBUA    EQU   UCBCHAN+1                                                02295000
UCBCHA   EQU   UCBCHAN                                                  02296000
UCBDADI  EQU   UCBSTAT                                                  02297000
UCBSYSR  EQU   UCBSTAT                                                  02298000
UCBPRES  EQU   UCBSTAT                                                  02299000
UCBALOC  EQU   UCBSTAT                                                  02300000
UCBUNLD  EQU   UCBSTAT                                                  02301000
UCBRESV  EQU   UCBSTAT                                                  02302000
UCBCHGS  EQU   UCBSTAT                                                  02303000
UCBONLI  EQU   UCBSTAT                                                  02304000
UCBID    EQU   UCBOB+2                                                  02305000
UCBALTPH EQU   UCBFL5                                                   02306000
UCBALTCU EQU   UCBFL5                                                   02307000
UCBNALOC EQU   UCBFL5                                                   02308000
UCBENVRD EQU   UCBFL5                                                   02309000
UCBVSDR  EQU   UCBFL5                                                   02310000
UCBSASK  EQU   UCBFL5                                                   02311000
UCBAMV   EQU   UCBAF                                                    02312000
UCBDCC   EQU   UCBFL5                                                   02313000
UCBMONT  EQU   UCBJBNR                                                  02314000
UCBRV011 EQU   UCBJBNR                                                  02315000
UCBMMSGP EQU   UCBJBNR                                                  02316000
UCBOLDSM EQU   UCBJBNR                                                  02317000
UCBRV003 EQU   UCBJBNR                                                  02318000
UCBDUC   EQU   UCBJBNR                                                  02319000
UCBJES3  EQU   UCBJBNR                                                  02320000
UCBVRDEV EQU   UCBJBNR                                                  02321000
UCBCMSEG EQU   UCBOB                                                    02322000
UCBPFXND EQU   UCB+512                                                  02323000
UCBIOQ   EQU   UCB+508                                                  02324000
UCBLOCK  EQU   UCB+504                                                  02325000
UCBPXST  EQU   UCB+504                                                  02326000
@NM00002 EQU   UCB                                                      02327000
ADPLABDA EQU   ABDPL+56                                                 02328000
ADPLEXT  EQU   ABDPL+52                                                 02329000
ADPLCOM4 EQU   ABDPL+40                                                 02330000
ADPLCOM3 EQU   ABDPL+36                                                 02331000
ADPLCOM2 EQU   ABDPL+32                                                 02332000
ADPLCVT  EQU   ABDPL+16                                                 02333000
@NM00001 EQU   ADPLFLAG                                                 02334000
ADPLDMGT EQU   ADPLFLAG                                                 02335000
ADPLSYTM EQU   ADPLFLAG                                                 02336000
ADPLSBPL EQU   ABDPL+6                                                  02337000
ADPLASID EQU   ABDPL+4                                                  02338000
ADPLTCB  EQU   ABDPL                                                    02339000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02340000
@RC00201 EQU   @RC00199                                                 02341000
@RC00281 EQU   @RC00253                                                 02342000
@RC00268 EQU   @RC00253                                                 02343000
@RC00255 EQU   @RC00253                                                 02344000
@ENDDATA EQU   *                                                        02345000
         END   IECIOFT1,(C'PLS1912',0701,77005)                         02346000
