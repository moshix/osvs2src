         TITLE 'IECVDERP - DIRECT ACCESS ERROR RECOVERY PROCEEDURES    *00001000
                        '                                               00002000
IECVDERP CSECT ,                                                   0001 00003000
@PROLOG  DS    0H                                                  0002 00004000
         USING IECVDERP,BASERG,BASEREG2                    @ZA15984     00005000
         LR    BASERG,@15          SET UP BASE REG                      00006000
         LR    @06,@14             SAVE R14 FOR RETURN     @ZA15984     00007000
         STM   @02,@06,0(@13)      SAVE REGS               @ZA15984     00008000
         L     BASEREG2,NEWBASE    SET UP SECOND BASE      @ZA15984     00009000
         B     FIRST                                       @ZA15056     00010000
NEWBASE  DC    A(IECVDERP+4096)                            @ZA15056     00011000
*FIRST:                                                            0160 00012000
*   EWARG=IOSERP;                   /* INIT EWA BASE                 */ 00013000
FIRST    L     EWARG,IOSERP(,IOSBRG)                               0160 00014000
*   IOSERR='1'B;                    /* INDICATE ERP IN CTL           */ 00015000
*   IOSEX='1'B;                     /* INDICATE EXCEP COND           */ 00016000
         OI    IOSERR(IOSBRG),B'00100100'                          0162 00017000
*   IF IOSBYP='1'B                  /* BYPASS IOS SEEK       @ZA17978*/ 00018000
*     THEN                          /* YES                   @ZA17978*/ 00019000
         TM    IOSBYP(IOSBRG),B'10000000'                          0163 00020000
         BNO   @RF00163                                            0163 00021000
*     IF ERPRDLOG='0'B&ERPRECAL='0'B/* ERP PGM               @ZA17978*/ 00022000
*       THEN                                                       0164 00023000
         TM    ERPRDLOG+6(EWAPTR),B'11000000'                      0164 00024000
         BZ    @RT00164                                            0164 00025000
*       GOTO CCNOT0;                /* NO, DONT RESTORE REAL @ZA17978*/ 00026000
*     ELSE                                                         0166 00027000
*       ;                           /* YES, TEST CC          @ZA15059*/ 00028000
@RF00164 DS    0H                                                  0167 00029000
*   ELSE                                                           0167 00030000
*     ;                             /* NO, TEST CC           @ZA15059*/ 00031000
*                                                                  0167 00032000
@RF00163 DS    0H                                                  0168 00033000
*   /*****************************************************************/ 00034000
*   /*                                                               */ 00035000
*   /* RESTORE THE ORIGINAL START ADDRESS INTO THE IOSRST FIELD UNDER*/ 00036000
*   /* THE FOLLOWING CONDITIONS.......... 1.CC=0-NOT VIRTUAL DEV     */ 00037000
*   /* 2.CC=0-VIRTUALDEV-NO UNIT CHECK 3.CC=0-VIRTUAL DEV-UNIT       */ 00038000
*   /* CHECK-NO ENV DATA                                     @ZA15998*/ 00039000
*   /*                                                               */ 00040000
*   /*****************************************************************/ 00041000
*                                                                  0168 00042000
*   IF ECC1OR3='0'B THEN            /* TEST FOR SIO=0        @ZA15695*/ 00043000
         TM    ECC1OR3+20(IOSBRG),B'00010000'                      0168 00044000
         BNZ   @RF00168                                            0168 00045000
*     DO;                                                          0169 00046000
*       IF UCBRVDEV='1'B THEN       /* VIRTUAL DEV           @ZA15998*/ 00047000
         TM    UCBRVDEV(UCBRG),B'00001000'                         0170 00048000
         BNO   @RF00170                                            0170 00049000
*         IF IUNITCK='1'B THEN      /* UNIT CHECK            @ZA15998*/ 00050000
         TM    IUNITCK+24(IOSBRG),B'00000010'                      0171 00051000
         BNO   @RF00171                                            0171 00052000
*           IF EWDEDAT='1'B THEN    /* ENV DATA              @ZA15998*/ 00053000
         TM    EWDEDAT(EWAPTR),B'00010000'                         0172 00054000
         BO    @RT00172                                            0172 00055000
*             GO TO CCNOT0;         /*                       @ZA15998*/ 00056000
*           ELSE                                                   0174 00057000
*             ;                     /*                       @ZA15998*/ 00058000
*         ELSE                                                     0175 00059000
*           ;                       /*                       @ZA15998*/ 00060000
@RF00171 DS    0H                                                  0176 00061000
*       ELSE                                                       0176 00062000
*         ;                         /*                       @ZA15998*/ 00063000
*                                                                  0176 00064000
@RF00170 DS    0H                                                  0177 00065000
*       /*************************************************************/ 00066000
*       /*                                                           */ 00067000
*       /* SUBROUTINE TO RESTORE IOSRST                      @ZA04222*/ 00068000
*       /*                                                           */ 00069000
*       /*************************************************************/ 00070000
*                                                                  0177 00071000
*       RFY                                                        0177 00072000
*        (WKRG1) RSTD;              /*                       @ZA04222*/ 00073000
*       WKRG1=IOSVST;               /* VIRT START ADDR       @ZA04222*/ 00074000
         L     WKRG1,IOSVST(,IOSBRG)                               0178 00075000
*       GEN;                                                       0179 00076000
*                                  /*                       @ZA04222 */ 00077000
         LRA    WKRG1,0(WKRG1)      CONVERT TO REAL         @ZA04222    00078000
*       IOSRST=WKRG1;               /* RESTORE REAL START ADDR     0180 00079000
*                                                            @ZA04222*/ 00080000
         ST    WKRG1,IOSRST(,IOSBRG)                               0180 00081000
*       RFY                                                        0181 00082000
*        (WKRG1) UNRSTD;            /*                       @ZA04222*/ 00083000
*     END;                          /*                       @ZA15998*/ 00084000
*CCNOT0:                            /*                       @ZA17978*/ 00085000
*   IF ERPREV='0'B                  /* FIRST ENTRY?                  */ 00086000
*     THEN                                                         0183 00087000
@RF00168 DS    0H                                                  0183 00088000
CCNOT0   TM    ERPREV+6(EWAPTR),B'00000010'                        0183 00089000
         BNZ   @RF00183                                            0183 00090000
*     DO;                           /* YES,                          */ 00091000
*       EWDSAVKY=IOSCKEY;           /* SAVE CP PROT KEY              */ 00092000
         MVC   EWDSAVKY(1,EWAPTR),IOSCKEY(IOSBRG)                  0185 00093000
*       EWDSAVOP=IOSOPT;            /* SAVE USER'S OPTS BYTE         */ 00094000
         MVC   EWDSAVOP(1,EWAPTR),IOSOPT(IOSBRG)                   0186 00095000
*       IOSLOG='0'B;                /* INITIAL NO LOGOUT             */ 00096000
*       IOSMSG='0'B;                /* INITIAL NO MESSAGE            */ 00097000
         NI    IOSLOG(IOSBRG),B'11111010'                          0188 00098000
*     END;                                                         0189 00099000
*   ELSE                                                           0190 00100000
*     ;                             /* NO                            */ 00101000
@RF00183 DS    0H                                                  0191 00102000
*   IF IUNITCK='0'B                 /* UNIT CHECK?                   */ 00103000
*     THEN                                                         0191 00104000
         TM    IUNITCK+24(IOSBRG),B'00000010'                      0191 00105000
         BNZ   @RF00191                                            0191 00106000
*     DO;                           /* NO, CLEAR SNS                 */ 00107000
*       IOSSNS=IOSSNS&&IOSSNS;                                     0193 00108000
         XC    IOSSNS(2,IOSBRG),IOSSNS(IOSBRG)                     0193 00109000
*       GOTO INTCK;                 /* GO CHECK FOR INTERCEPT        */ 00110000
         B     INTCK                                               0194 00111000
*     END;                                                         0195 00112000
*   ELSE                                                           0196 00113000
*     ;                             /* YES                           */ 00114000
@RF00191 DS    0H                                                  0197 00115000
*   IF EWABDSNS='1'B                /* SENSE FAIL?                   */ 00116000
*     THEN                                                         0197 00117000
         TM    EWABDSNS(EWAPTR),B'00000001'                        0197 00118000
         BO    @RT00197                                            0197 00119000
*     GOTO SNSERR;                  /* YES, TREAT AS SEEK CK         */ 00120000
*   ELSE                                                           0199 00121000
*     ;                             /* NO                            */ 00122000
*   IF UCBTBYT4='08'X               /* 2314?                         */ 00123000
*     THEN                                                         0200 00124000
         CLI   UCBTBYT4(UCBRG),X'08'                               0200 00125000
         BE    @RT00200                                            0200 00126000
*     GOTO STATCK;                  /* YES, CHK RHA STATUS           */ 00127000
*   ELSE                                                           0202 00128000
*     ;                             /* NO                            */ 00129000
*   IF EWDEDAT='1'B                 /* LOG FULL?                     */ 00130000
*     THEN                                                         0203 00131000
         TM    EWDEDAT(EWAPTR),B'00010000'                         0203 00132000
         BNO   @RF00203                                            0203 00133000
*     DO;                           /* YES, LOG & RTY                */ 00134000
*       GEN;                                                       0205 00135000
*                                         /*                            00136000
                 BAL   @14,LOGSAVE         SAVE LOG INFO                00137000
*       GOTO RETRY;                 /* RETRY ORIG REQ                */ 00138000
         B     RETRY                                               0206 00139000
*     END;                                                         0207 00140000
*   ELSE                                                           0208 00141000
*     ;                             /* NO                            */ 00142000
@RF00203 DS    0H                                                  0209 00143000
*   IF UCBTBYT4='0A'X|UCBRVDEV='1'B /* 3340 OR MSS?          @ZA05468*/ 00144000
*     THEN                                                         0209 00145000
         CLI   UCBTBYT4(UCBRG),X'0A'                               0209 00146000
         BE    @RT00209                                            0209 00147000
         TM    UCBRVDEV(UCBRG),B'00001000'                         0209 00148000
         BO    @RT00209                                            0209 00149000
*     GOTO INTCK;                   /* YES, SKIP ZLOG CHK            */ 00150000
*   ELSE                                                           0211 00151000
*     ;                             /* NO                            */ 00152000
*   IF EWDZLOG='0'B                 /* ZEUS LOG FULL?                */ 00153000
*     THEN                                                         0212 00154000
         TM    EWDZLOG(EWAPTR),B'10000000'                         0212 00155000
         BZ    @RT00212                                            0212 00156000
*     GOTO INTCK;                   /* NO                            */ 00157000
*   ELSE                                                           0214 00158000
*     ;                             /* YES                           */ 00159000
*   ERPRDLOG='1'B;                  /* SET RD LOG IND                */ 00160000
         OI    ERPRDLOG+6(EWAPTR),B'10000000'                      0215 00161000
*   GEN;                                                           0216 00162000
*                                 /*                                    00163000
         BAL   @14,LOGSAVE         SAVE LOG INFO                        00164000
*   IOSBYP='1'B;                    /* IND NO SEEK/SFM               */ 00165000
         OI    IOSBYP(IOSBRG),B'10000000'                          0217 00166000
*   IOSCKEY=0;                      /* SET KEY TO X'00'      @ZA13517*/ 00167000
         MVI   IOSCKEY(IOSBRG),X'00'                               0218 00168000
*   RFY                                                            0219 00169000
*    (WKRG1,                                                       0219 00170000
*     CCWRG1,                                                      0219 00171000
*     WKRG2) RSTD;                                                 0219 00172000
*   CCWRG1=ADDR(DACP7);             /* READ LOG                      */ 00173000
         LA    CCWRG1,DACP7                                        0220 00174000
*   GEN;                                                           0221 00175000
*                                  /*                                   00176000
         BAL   @14,CPBLD           BLD CHAN PGM                         00177000
*   WKRG2=ADDR(MDRZLOG);            /* RD LOG ADDR           @VS30022*/ 00178000
         L     WKRG2,EWADDISP-1(,EWAPTR)                           0222 00179000
         LA    WKRG2,0(,WKRG2)                                     0222 00180000
         LA    WKRG2,MDRZLOG(,WKRG2)                               0222 00181000
*   GEN;                                                           0223 00182000
         LRA   WKRG2,0(WKRG2)      REAL ADDRESS            @VS30022     00183000
*   WKRG1->CCWDATA=WKRG2;           /* INSERT DATE ADDR      @VS30022*/ 00184000
         STCM  WKRG2,7,CCWDATA(WKRG1)                              0224 00185000
*   GOTO RESTART;                   /* GO START ERP CP               */ 00186000
         B     RESTART                                             0225 00187000
*   RFY                                                            0226 00188000
*    (WKRG1,                                                       0226 00189000
*     CCWRG1,                                                      0226 00190000
*     WKRG2) UNRSTD;                                               0226 00191000
*                                                                  0226 00192000
*   /*****************************************************************/ 00193000
*   /*                                                               */ 00194000
*   /* CHECK SNS STATUS TO VERIFY SUCCESSFUL RHA/RR0 IGNORE          */ 00195000
*   /* UNSUCCESSFUL RHA/RR0 FOR INTERVENTION REQUIRED                */ 00196000
*   /*                                                               */ 00197000
*   /*****************************************************************/ 00198000
*                                                                  0227 00199000
*STATCK:                                                           0227 00200000
*   IF EUNITCK='1'B                 /* UNIT CHECK?                   */ 00201000
*     THEN                                                         0227 00202000
STATCK   TM    EUNITCK+8(EWAPTR),B'00000010'                       0227 00203000
         BNO   @RF00227                                            0227 00204000
*     IF EWDINT='1'B                /* YES, IS INT REQUIRED ALSO     */ 00205000
*       THEN                                                       0228 00206000
         TM    EWDINT(EWAPTR),B'01000000'                          0228 00207000
         BO    @RT00228                                            0228 00208000
*       GOTO SETBADHA;              /* YES, IGNORE                   */ 00209000
*     ELSE                                                         0230 00210000
*       GOTO SNSRTY;                /* NO, RETRY SENSE               */ 00211000
         B     SNSRTY                                              0230 00212000
*   ELSE                                                           0231 00213000
*     ;                             /* NO, CHK FOR OTHER BAD STATUS  */ 00214000
@RF00227 DS    0H                                                  0232 00215000
*   IF EPCI='1'B|EINCLGTH='1'B|EPGMCK='1'B|EPROTCK='1'B|ECDATACK='1'B|  00216000
*       EINTCCK='1'B|ECHCK='1'B THEN                               0232 00217000
         TM    EPCI+8(EWAPTR),B'11111011'                          0232 00218000
         BZ    @RF00232                                            0232 00219000
*     ;                             /* UNSUCCESSFUL, RETRY           */ 00220000
*   ELSE                                                           0234 00221000
*     GOTO INTCK;                   /* SUCCESSFUL, SKIP RETRY        */ 00222000
*SNSRTY:                                                           0235 00223000
*   IF EWACNTR3=EWACNT01            /* RETRY CNT MAX?        @ZA05546*/ 00224000
*     THEN                                                         0235 00225000
SNSRTY   CLI   EWACNTR3(EWAPTR),1                                  0235 00226000
         BE    @RT00235                                            0235 00227000
*     GOTO SETBADHA;                /* YES,PROCEED WITHOUT HA      0236 00228000
*                                                            @ZA05546*/ 00229000
*   ELSE                                                           0237 00230000
*     ;                             /* NO,RETRY              @ZA05546*/ 00231000
*                                                                  0237 00232000
*   /*****************************************************************/ 00233000
*   /*                                                               */ 00234000
*   /* A RHA/RR0 FAILURE HAS OCCURRED, OVERLAY IOSB STATUS WITH SENSE*/ 00235000
*   /* STATUS FROM ERWA                                              */ 00236000
*   /*                                                               */ 00237000
*   /*****************************************************************/ 00238000
*                                                                  0238 00239000
*STATSAV:                           /*                       @ZA05546*/ 00240000
*   IOSTATUS=EWASSTAT;              /*                       @ZA05546*/ 00241000
STATSAV  MVC   IOSTATUS(2,IOSBRG),EWASSTAT(EWAPTR)                 0238 00242000
*   EWACNTR3=EWACNTR3+EWACNT01;     /* INCREMENT CNTR        @ZA05546*/ 00243000
         LA    @12,1                                               0239 00244000
         SLR   @11,@11                                             0239 00245000
         IC    @11,EWACNTR3(,EWAPTR)                               0239 00246000
         ALR   @12,@11                                             0239 00247000
         STC   @12,EWACNTR3(,EWAPTR)                               0239 00248000
*   GOTO RETRY;                     /* RETRY                 @ZA05546*/ 00249000
         B     RETRY                                               0240 00250000
*SETBADHA:                                                         0241 00251000
*   ERPBADHA='1'B;                  /* IND NO HA                     */ 00252000
SETBADHA OI    ERPBADHA+6(EWAPTR),B'00001000'                      0241 00253000
*   EWDCCHH=IOSCCHH;                /* SAVE SEEK ADDR FOR MSG        */ 00254000
*                                                                  0242 00255000
         MVC   EWDCCHH(4,EWAPTR),IOSCCHH(IOSBRG)                   0242 00256000
*   /*****************************************************************/ 00257000
*   /*                                                               */ 00258000
*   /* FOR INTERCEPT CONDITIONS, LOG THE ERROR, RESET IOSCOD TO      */ 00259000
*   /* NORMAL, AND RESTART USER CH PGM                               */ 00260000
*   /*                                                               */ 00261000
*   /*****************************************************************/ 00262000
*                                                                  0243 00263000
*INTCK:                                                            0243 00264000
*   IF IOSCOD=IOSFINTC              /* INTERCEPT?                    */ 00265000
*     THEN                                                         0243 00266000
INTCK    CLI   IOSCOD(IOSBRG),X'7E'                                0243 00267000
         BNE   @RF00243                                            0243 00268000
*     DO;                           /* YES,                          */ 00269000
*       IOSCOD=IOSNRMC;             /* RESET CODE TO NORMAL          */ 00270000
         MVI   IOSCOD(IOSBRG),X'7F'                                0245 00271000
*       GEN;                                                       0246 00272000
*                                          /*                           00273000
                 BAL   @14,LOGSAVE         SAVE LOG INFO                00274000
*       GOTO RETRY;                 /* RESTART USER CP               */ 00275000
         B     RETRY                                               0247 00276000
*     END;                                                         0248 00277000
*   ELSE                                                           0249 00278000
*     ;                             /* NO                            */ 00279000
@RF00243 DS    0H                                                  0250 00280000
*   CCWRG=IOSCSWCA-CCWLNGTH;        /* POINT TO ERR CCW              */ 00281000
*                                                                  0250 00282000
         L     CCWRG,IOSCSWCA-1(,IOSBRG)                           0250 00283000
         LA    CCWRG,0(,CCWRG)                                     0250 00284000
         SL    CCWRG,@CF00073                                      0250 00285000
*   /*****************************************************************/ 00286000
*   /*                                                               */ 00287000
*   /* SET UP TO CALL RESIDENT ERROR INTERPRETER                     */ 00288000
*   /*                                                               */ 00289000
*   /*****************************************************************/ 00290000
*                                                                  0251 00291000
*   CALLRG=CVTXITP;                 /* ADDR OF ERR INTERP            */ 00292000
         L     @12,CVTPTR                                          0251 00293000
         L     CALLRG,CVTXITP(,@12)                                0251 00294000
*   GEN;                                                           0252 00295000
*                                                                  0252 00296000
         BALR  @14,CALLRG          GOT TO ERR INTERP                    00297000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         00298000
*        ERROR INTERPRETER VECTOR TABLE                                 00299000
*                                                                       00300000
         DC    X'1D',AL1(CCC-*+1)  CHAN CTRL CHK                        00301000
*                                                                       00302000
         DC    X'1E',AL1(ICC-*+1)  INTERFACE CTRL CHK                   00303000
*                                                                       00304000
         DC    X'1C',AL1(CDC-*+1)  CHAN DATA CHK                        00305000
*                                                                       00306000
         DC    X'1F',AL1(CCHN-*+1) CHAINING CHK                         00307000
*                                                                       00308000
         DC    X'05',AL1(OVRN-*+1) OVERRUN                     @ZA25317 00309000
*                                                                       00310000
         DC    X'08',AL1(PERM-*+1) PERM ERR                             00311000
*                                                                       00312000
         DC    X'03',AL1(EQUP-*+1) EQUIP CHK                            00313000
*                                                                       00314000
         DC    X'00',AL1(CREJ-*+1) COMMAND REJECT                       00315000
*                                                                       00316000
         DC    X'02',AL1(BUSO-*+1) BUSOUT                               00317000
*                                                                       00318000
         DC    X'01',AL1(INT-*+1)  INT REQ'D                            00319000
*                                                                       00320000
         DC    X'07',AL1(SEEK-*+1) SEEK CHK                             00321000
*                                                                       00322000
         DC    X'0E',AL1(MAM-*+1)  MISS ADDR MARK                       00323000
*                                                                       00324000
         DC    X'09',AL1(TVRN-*+1) TRK OVRN / INVALID TRK FMT           00325000
*                                                                       00326000
         DC    X'0C',AL1(NRF-*+1)  NO RECORD FOUND                      00327000
*                                                                       00328000
         DC    X'06',AL1(TCC-*+1)  TRK COND CHK                         00329000
*                                                                       00330000
         DC    X'04',AL1(DCHK-*+1) DATA CHK                             00331000
*                                                                       00332000
         DC    X'0A',AL1(EOC-*+1)  END OF CYLINDER                      00333000
*                                                                       00334000
         DC    X'0D',AL1(FPRT-*+1) FILE PROT                            00335000
*                                                                       00336000
         DC    X'0F',AL1(OFLO-*+1) OP INCOMPLETE                        00337000
*                                                                       00338000
         DC    X'1A',AL1(CPCK-*+1) CHAN PGM CHK                         00339000
*                                                                       00340000
         DC    X'1B',AL1(CPRT-*+1) CHAN PROT CHK                        00341000
*                                                                       00342000
         DC    X'17',AL1(UNEX-*+1) UNIT EXCEPTION                       00343000
*                                                                       00344000
         DC    X'19',AL1(LGTH-*+1) INCORRECT LENGTH                     00345000
*                                                                       00346000
         DC    X'16',AL1(UCHK-*+1) UNIT CHK - NO SNS                    00347000
*                                                                       00348000
         DC    X'2F',AL1(ENDI-*+1) END OF TEST                          00349000
*                                                                       00350000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         00351000
*                                                                       00352000
*        BRANCH TABLE FOR RETURN VECTORS FROM ERR INTERP                00353000
*                                                                       00354000
CCC      DS    0H                  CHAN CTRL CHK                        00355000
ICC      DS    0H                  INTERFACE CTRL CHK                   00356000
         B     ERCHAN                                                   00357000
*                                                                       00358000
CDC      DS    0H                  CHAN DATA CHK                        00359000
CCHN     DS    0H                  CHAINING CHK                         00360000
         B     RTY10D              RETRY 10, NO LOG            @ZA00137 00361000
EQUP     B     SAFCHK              CHECK FOR MSS 'SAF'         @G24LSFS 00362000
BUSO     DS    0H                  BUSOUT                               00363000
MAM      DS    0H                  MISS ADDR MK                         00364000
UCHK     DS    0H                  UNIT CHECK - NO SNS                  00365000
         B     RTY10               RETRY 10                             00366000
*                                                                       00367000
TVRN     DS    0H                  TRK OVERRUN                          00368000
CPCK     DS    0H                  CH PGM CHK                           00369000
CPRT     DS    0H                  CH PROT CHK                          00370000
         B     ERHARD              HARD ERRS                            00371000
*                                                                       00372000
PERM     B     PERMCK              PERM ERR                             00373000
*                                                                       00374000
SEEK     B     ERSEK               SEEK CHK                             00375000
*                                                                       00376000
INT      B     ERINT               INT REQ'D                            00377000
*                                                                       00378000
CREJ     B     ERMSG               CMD REJECT                           00379000
*                                                                       00380000
OVRN     B     RTY10A              OVERRUN                              00381000
*                                                                       00382000
NRF      B     NRFCK               NO RECORD OUUND                      00383000
*                                                                       00384000
TCC      B     ERTCC               TRK COND CHK                         00385000
*                                                                       00386000
DCHK     B     ERDATA              DATA CHK                             00387000
*                                                                       00388000
EOC      B     EREOC               END OF CYLINDER                      00389000
*                                                                       00390000
FPRT     B     ERFP                FILE PROTECT                         00391000
*                                                                       00392000
OFLO     B     EROFLO              OP INCOMPLETE                        00393000
*                                                                       00394000
UNEX     B     EREOF               UNIT EXECPTION                       00395000
*                                                                       00396000
LGTH     B     ERLEN               INCORRECT LENGTH                     00397000
*                                                                       00398000
ENDI     B     ERNOER              NO ABNORMAL STATUS OR SENSE          00399000
*                                                                       00400000
*   /*****************************************************************/ 00401000
*   /*                                                               */ 00402000
*   /* IF EQUIPMENT CHECK ON VIRTUAL 3330, CHECK FOR STAGING ADAPTER */ 00403000
*   /* FAILURE (SAF).IF SO SET FOR WTO MSG,LOG AND RETRY             */ 00404000
*   /*                                                               */ 00405000
*   /*****************************************************************/ 00406000
*                                                                  0253 00407000
*SAFCHK:                                                           0253 00408000
*   IF UCBRVDEV='1'B                /* VIRTUAL 3330          @G24LSFS*/ 00409000
*       &MSSERMSG='25'X THEN        /* SAF CONDITION         @G24LSFS*/ 00410000
SAFCHK   TM    UCBRVDEV(UCBRG),B'00001000'                         0253 00411000
         BNO   @RF00253                                            0253 00412000
         CLI   MSSERMSG+32(EWAPTR),X'25'                           0253 00413000
         BNE   @RF00253                                            0253 00414000
*     DO;                           /* WTO MSG AND LOG BITS  @G24LSFS*/ 00415000
*       GEN;                                                       0255 00416000
*                 /*                                                    00417000
                 BAL  @14,LOGSAVE     SAVE LOG INFO          @G24LSFS   00418000
*       IOSMSG='1'B;                /* IND. I/O ERROR MSG    @G24LSFS*/ 00419000
         OI    IOSMSG(IOSBRG),B'00000100'                          0256 00420000
*       EWAFLG3=0;                  /* CLR ERP FLAGS         @G24LSFS*/ 00421000
         MVI   EWAFLG3(EWAPTR),X'00'                               0257 00422000
*       ERPREV='1'B;                /* IND. PREVIOUS ENTRY   @G24LSFS*/ 00423000
         OI    ERPREV+6(EWAPTR),B'00000010'                        0258 00424000
*       EWADDMSG='1'B;              /* INDICATE CCHH AVAIL.  @G24LSFS*/ 00425000
         OI    EWADDMSG(EWAPTR),B'00000010'                        0259 00426000
*       GOTO XCTLWTO;               /* GO TO WTO EXIT        @G24LSFS*/ 00427000
         B     XCTLWTO                                             0260 00428000
*     END;                          /* END SETUP FOR WTO,LOG @G24LSFS*/ 00429000
*   ELSE                                                           0262 00430000
*     GOTO RTY10;                   /* REAL EQUIPMENT CHECK  @G24LSFS*/ 00431000
*                                                                  0262 00432000
*   /*****************************************************************/ 00433000
*   /*                                                               */ 00434000
*   /* RETRY 10, LOG AFTER FINAL RETRY (HARDLOG)                     */ 00435000
*   /*                                                               */ 00436000
*   /*****************************************************************/ 00437000
*                                                                  0263 00438000
*RTY10B:                                                           0263 00439000
*   IF EWACNTR1<EWACNT10            /* CNT MAX?                      */ 00440000
*     THEN                                                         0263 00441000
RTY10B   CLI   EWACNTR1(EWAPTR),10                                 0263 00442000
         BL    @RT00263                                            0263 00443000
*     GOTO CNTINCR1;                /* NO, GO INCR & RTY             */ 00444000
*   ELSE                                                           0265 00445000
*     ;                             /* YES, FALL THRU                */ 00446000
*                                                                  0265 00447000
*   /*****************************************************************/ 00448000
*   /*                                                               */ 00449000
*   /* RETRY 10, LOG BEFORE EACH RETRY (SOFTLOG)                     */ 00450000
*   /*                                                               */ 00451000
*   /*****************************************************************/ 00452000
*                                                                  0266 00453000
*RTY10:                                                            0266 00454000
*   ;                                                              0266 00455000
RTY10    DS    0H                                                  0267 00456000
*   GEN;                                                           0267 00457000
*                                                                  0267 00458000
*                                  /*                                   00459000
         BAL   @14,LOGSAVE         SAVE LOG INFO                        00460000
*   /*****************************************************************/ 00461000
*   /*                                                               */ 00462000
*   /* RETRY 10, NO LOG ACTION                                       */ 00463000
*   /*                                                               */ 00464000
*   /*****************************************************************/ 00465000
*                                                                  0268 00466000
*RTY10C:                                                           0268 00467000
*   IF EWACNTR1<EWACNT10            /* CNT MAX?                      */ 00468000
*     THEN                                                         0268 00469000
RTY10C   CLI   EWACNTR1(EWAPTR),10                                 0268 00470000
         BL    @RT00268                                            0268 00471000
*     GOTO CNTINCR1;                /* NO, INCR & RTY                */ 00472000
*   ELSE                                                           0270 00473000
*     ;                             /* YES                           */ 00474000
*                                                                  0270 00475000
*   /*****************************************************************/ 00476000
*   /*                                                               */ 00477000
*   /* SET FOR IO ERR MSG                                            */ 00478000
*   /*                                                               */ 00479000
*   /*****************************************************************/ 00480000
*                                                                  0271 00481000
*ERMSG:                                                            0271 00482000
*                                                                  0271 00483000
*   /*****************************************************************/ 00484000
*   /*                                                               */ 00485000
*   /* TEST SENSE BYTE 7 AND 18 FOR UCB LOCKOUT COND.        @G24LSFS*/ 00486000
*   /*                                                               */ 00487000
*   /*****************************************************************/ 00488000
*                                                                  0271 00489000
*   IF MSSERMSG='0F'X               /* MSS ERROR SEE BYTE 18 @G24LSFS*/ 00490000
*       &MSSERRCD='03'X             /* EMBEDDED SEEK-RST CP  @G24LSFS*/ 00491000
*     THEN                                                         0271 00492000
ERMSG    LA    @12,32                                              0271 00493000
         ALR   @12,EWAPTR                                          0271 00494000
         CLI   MSSERMSG(@12),X'0F'                                 0271 00495000
         BNE   @RF00271                                            0271 00496000
         CLI   MSSERRCD(@12),X'03'                                 0271 00497000
         BE    @RT00271                                            0271 00498000
*     GOTO ERFP;                    /* RESTART CHAN PGM      @G24LSFS*/ 00499000
*   ELSE                                                           0273 00500000
*     ;                             /* NOT LOCKOUT CONDITION @G24LSFS*/ 00501000
@RF00271 DS    0H                                                  0274 00502000
*   IOSMSG='1'B;                    /* IND I/O ERR MSG               */ 00503000
         OI    IOSMSG(IOSBRG),B'00000100'                          0274 00504000
*   EWADDMSG='1'B;                  /* INDICATE CCHH AVAILABLE       */ 00505000
*                                                                  0275 00506000
         OI    EWADDMSG(EWAPTR),B'00000010'                        0275 00507000
*   /*****************************************************************/ 00508000
*   /*                                                               */ 00509000
*   /* SET FOR XCTL TO WRITE TO OPERATOR (WTO)                       */ 00510000
*   /*                                                               */ 00511000
*   /*****************************************************************/ 00512000
*                                                                  0276 00513000
*XCTLWTO:                                                          0276 00514000
*   IOSPROC=IOSAWTO;                /* IND WTO                       */ 00515000
XCTLWTO  MVI   IOSPROC(IOSBRG),X'14'                               0276 00516000
*   EWDCCW9(1:6)=UCBVOLI;           /* VOL SER FOR WTO               */ 00517000
         MVC   EWDCCW9(6,EWAPTR),UCBVOLI(UCBRG)                    0277 00518000
*   EWACHA=UCBCHAN;                 /* MOVE ADR TO EWA       @ZA07997*/ 00519000
         MVC   EWACHA(2,EWAPTR),UCBCHAN(UCBRG)                     0278 00520000
*   IF UCBENVRD='1'B                /* EXP SENSE DEVICE?             */ 00521000
*     THEN                                                         0279 00522000
         TM    UCBENVRD(UCBRG),B'00001000'                         0279 00523000
         BNO   @RF00279                                            0279 00524000
*     IF FMTBITS='100'B             /* YES, IS SKA IN SENSE?         */ 00525000
*       THEN                                                       0280 00526000
         LA    @12,32                                              0280 00527000
         ALR   @12,EWAPTR                                          0280 00528000
         TM    FMTBITS(@12),B'01000000'                            0280 00529000
         BNO   @RF00280                                            0280 00530000
         TM    FMTBITS(@12),B'00110000'                            0280 00531000
         BNZ   @RF00280                                            0280 00532000
*       EWDCCHH=RSTCCHH;            /* YES, USE IT                   */ 00533000
         MVC   EWDCCHH(4,EWAPTR),RSTCCHH(@12)                      0281 00534000
*     ELSE                                                         0282 00535000
*       EWDCCHH=IOSCCHH;            /* NO, USE IOSBSKA               */ 00536000
         B     @RC00280                                            0282 00537000
@RF00280 MVC   EWDCCHH(4,EWAPTR),IOSCCHH(IOSBRG)                   0282 00538000
*   ELSE                                                           0283 00539000
*     ;                             /* NO, EWDCCHH ALREADY SET       */ 00540000
*                                                                  0283 00541000
@RF00279 DS    0H                                                  0284 00542000
*   /*****************************************************************/ 00543000
*   /*                                                               */ 00544000
*   /* IF MSS SA FAILURE GO TO WTO AND LOG                   @G24LSFS*/ 00545000
*   /*                                                               */ 00546000
*   /*****************************************************************/ 00547000
*                                                                  0284 00548000
*   IF UCBRVDEV='1'B THEN           /* VIRTUAL 3330          @G24LSFS*/ 00549000
@RC00279 TM    UCBRVDEV(UCBRG),B'00001000'                         0284 00550000
         BNO   @RF00284                                            0284 00551000
*     IF MSSERMSG='25'X             /* FORMAT 2 MSG 5        @G24LSFS*/ 00552000
*         &IUNITCK='1'B THEN        /* UNIT CHECK ,THEN SAF  @G24LSFS*/ 00553000
         CLI   MSSERMSG+32(EWAPTR),X'25'                           0285 00554000
         BNE   @RF00285                                            0285 00555000
         TM    IUNITCK+24(IOSBRG),B'00000010'                      0285 00556000
         BO    @RT00285                                            0285 00557000
*       GOTO CALTRANS;              /* GO TO WTO AND LOG     @G24LSFS*/ 00558000
*     ELSE                                                         0287 00559000
*       ;                           /* NOT SA FAILURE        @G24LSFS*/ 00560000
@RF00285 DS    0H                                                  0288 00561000
*   ELSE                                                           0288 00562000
*     ;                             /* NOT VIRTUAL 3330      @G24LSFS*/ 00563000
@RF00284 DS    0H                                                  0289 00564000
*   GOTO ERHARD;                    /* PERM ERR                      */ 00565000
*                                                                  0289 00566000
         B     ERHARD                                              0289 00567000
*   /*****************************************************************/ 00568000
*   /*                                                               */ 00569000
*   /* SOFT ERRORS INDICATED BY IOSEX=0 HARD ERRORS INDICATED BY     */ 00570000
*   /* IOSEX=1 ERP RELEASE OF CONTROL INDICATED BY IOSERR=0          */ 00571000
*   /*                                                               */ 00572000
*   /*****************************************************************/ 00573000
*                                                                  0290 00574000
*ERSOFT:                                                           0290 00575000
*   IOSEX='0'B;                     /* IND SOFT & FALL THRU          */ 00576000
ERSOFT   NI    IOSEX(IOSBRG),B'11111011'                           0290 00577000
*   IF ERPOCSW='1'B                 /* USER CCW SAVED ?              */ 00578000
*     THEN                                                         0291 00579000
         TM    ERPOCSW+12(EWAPTR),B'10000000'                      0291 00580000
         BNO   @RF00291                                            0291 00581000
*     IOSCSWCA=EWDCCW5(2:4);        /* RESTORE USER CSW              */ 00582000
         MVC   IOSCSWCA(3,IOSBRG),EWDCCW5+1(EWAPTR)                0292 00583000
*   ELSE                                                           0293 00584000
*     ;                             /* NO                            */ 00585000
@RF00291 DS    0H                                                  0294 00586000
*ERHARD:                                                           0294 00587000
*   IOSERR='0'B;                    /* RELEASE CONTROL               */ 00588000
ERHARD   NI    IOSERR(IOSBRG),B'11011111'                          0294 00589000
*   IF ERPOFLO='1'B                 /* OFLO IND?                     */ 00590000
*     THEN                                                         0295 00591000
         TM    ERPOFLO+6(EWAPTR),B'00000100'                       0295 00592000
         BNO   @RF00295                                            0295 00593000
*     ISNSOFLO='1'B;                /* YES, IND SO IN SNS            */ 00594000
         OI    ISNSOFLO+42(IOSBRG),B'00000001'                     0296 00595000
*   ELSE                                                           0297 00596000
*     ;                             /* NO                            */ 00597000
@RF00295 DS    0H                                                  0298 00598000
*   ERPOCSW='0'B;                   /* RESET                         */ 00599000
         NI    ERPOCSW+12(EWAPTR),B'01111111'                      0298 00600000
*   EWAFLG3=0;                      /* CLEAR ERP FLAGS               */ 00601000
         MVI   EWAFLG3(EWAPTR),X'00'                               0299 00602000
*   GEN;                                                           0300 00603000
*                                                                  0300 00604000
*                                  /*                                   00605000
         BAL   @14,RESTORE         RESTORE IOSCKEY-OPT-RST              00606000
*   /*****************************************************************/ 00607000
*   /*                                                               */ 00608000
*   /* DETERMINE IF TRANSIENTS (OBR OR WTO) ARE NEEDED, AND IF THEY  */ 00609000
*   /* CAN BE CALLED                                                 */ 00610000
*   /*                                                               */ 00611000
*   /*****************************************************************/ 00612000
*                                                                  0301 00613000
*DIRCHK:                                                           0301 00614000
*   IF INTLOG='1'B THEN             /* IF INTERNAL LOG BIT IS SET  0301 00615000
*                                      THEN AN INTER REQ MESSAGE HAS    00616000
*                                      BEEN ISSUED FOR A LOG @ZA17988*/ 00617000
DIRCHK   TM    INTLOG+136(EWAPTR),B'00000001'                      0301 00618000
         BNO   @RF00301                                            0301 00619000
*     IOSLOG='1'B;                  /* SET LOG FLAG          @ZA17988*/ 00620000
         OI    IOSLOG(IOSBRG),B'00000001'                          0302 00621000
*   INTLOG='0'B;                    /* RESET INTERNAL LOG    @ZA19708*/ 00622000
@RF00301 NI    INTLOG+136(EWAPTR),B'11111110'                      0303 00623000
*   IF IOSMSG='0'B&IOSLOG='0'B      /* LOG OR MSG            @ZA30281*/ 00624000
*     THEN                                                         0304 00625000
         TM    IOSMSG(IOSBRG),B'00000101'                          0304 00626000
         BZ    @RT00304                                            0304 00627000
*     GOTO PERMSOFT;                /* NO, SKIP TRANSIENT    @ZA30281*/ 00628000
*   ELSE                                                           0306 00629000
*     ;                             /* YES, CHECK DEFERRED   @ZA30281*/ 00630000
@RF00304 DS    0H                                                  0307 00631000
*IDRCHK:                                                           0307 00632000
*   IF IOSIDR='1'B                  /* DIR NEEDED?           @ZA05565*/ 00633000
*     THEN                                                         0307 00634000
IDRCHK   TM    IOSIDR(IOSBRG),B'00000100'                          0307 00635000
         BO    @RT00307                                            0307 00636000
*     GOTO DIRBLD;                  /* YES, GO BUILD IT      @ZA05565*/ 00637000
*   ELSE                                                           0309 00638000
*     ;                             /* NO, FALL THRU         @ZA00565*/ 00639000
*CALTRANS:                          /* CALL TRANS PROCEDURE          */ 00640000
*   ;                                                              0310 00641000
CALTRANS DS    0H                                                  0311 00642000
*   GEN;                                                           0311 00643000
*                                                                  0311 00644000
         LM    @02,@06,0(@13)      RESTORE REGS                         00645000
         B     8(@06)              EXIT TO LOAD TRANS                */ 00646000
*   /*****************************************************************/ 00647000
*   /*                                                               */ 00648000
*   /* BUILD AND QUEUE DEFERRED INCIDENT RECORD COPY,SRB,IOSB, EWA,  */ 00649000
*   /* AND EWA EXT TO GOTTEN CORE AND SCHEDULE ON THE MASTER MEMORY. */ 00650000
*   /*                                                       @ZA02273*/ 00651000
*   /*                                                               */ 00652000
*   /*****************************************************************/ 00653000
*                                                                  0312 00654000
*DIRBLD:                                                           0312 00655000
*   ;                                                              0312 00656000
DIRBLD   DS    0H                                                  0313 00657000
*   GEN;                                                           0313 00658000
*                                  /*                                   00659000
         BAL   @14,GETBLOK3        GET 3 160 BYTE BLOCKS                00660000
*   RFY                                                            0314 00661000
*    (WKRG1,                                                       0314 00662000
*     WKRG2,                                                       0314 00663000
*     WKRG3) RSTD;                                                 0314 00664000
*   GEN REFS(IOSSRB,IOSERP,EWADDISP,SRBPARM,IOSEND);               0315 00665000
*                                                          /*           00666000
         L     @12,IOSSRB(IOSBRG)     ADDR OF SRB                       00667000
         MVC   @04(44,WKRG3),@04(@12) COPY SRB                          00668000
         LA    @14,48(WKRG3)          ADDR OF IOSB COPY                 00669000
         MVC   0(IOSEND,@14),0(IOSBRG)  COPY IOSB                       00670000
         ST    @14,SRBPARM(WKRG3)  POINT SRB TO IOSB            YM02273 00671000
         ST    WKRG3,IOSSRB(@14)   POINT IOSB TO SRB                    00672000
         L     @12,0(WKRG3)        ADDR OF EWA COPY                     00673000
         ST    @12,IOSERP(@14)     POINT IOSB TO EWA                    00674000
         OI    0(@14),X'01'        SET IOSIOSB                 @ZA02273 00675000
         MVI   @14(@14),@14        RESET LOCAL LOCK            @ZA10445 00676000
         MVI   @03(@14),X'14'      IOSPROC=WTO                 @ZA02273 00677000
         MVC   @04(156,@12),@04(EWAPTR)  COPY EWA                       00678000
         L     @14,0(@12)           POINT TO OBR COPY                   00679000
         LA    @14,4(@14)                                      @ZA02273 00680000
         STCM  @14,7,EWADDISP(@12) POINT TO OBR INFO                    00681000
         ICM   @12,7,EWADDISP(EWAPTR)                                   00682000
         MVC   0(156,@14),0(@12)     COPY EWA EXT                       00683000
         SR    @15,@15             ZERO                        @ZA02273 00684000
         L     @14,0(@11)                                      @ZA02273 00685000
         L     @14,0(@14)              LINK                    @ZA02273 00686000
         ST    @15,0(@11)                                      @ZA02273 00687000
         ST    @15,0(@14)                  FIELDS              @ZA02273 00688000
*   RFY                                                            0316 00689000
*     SRBSECT BASED(WKRG3);         /*                       @ZA02273*/ 00690000
*   SRBASCB=ADDR(IEAMASCB);         /* SPECIFY MASTER MEMORY @ZA02273*/ 00691000
         L     @12,@CA00034                                        0317 00692000
         ST    @12,SRBASCB(,WKRG3)                                 0317 00693000
*   SRBPASID=1;                     /* SET PURGE ID TO MASTER MEMORY    00694000
*                                                            @ZA02273*/ 00695000
         MVC   SRBPASID(2,WKRG3),@CH00081                          0318 00696000
*   GEN REFS(CVTLSMQ,SRBFLNK);                                     0319 00697000
           SCHEDULE SRB=(WKRG3),SCOPE=LOCAL      SCHED. SRB @ZA02273    00698000
*   RFY                                                            0320 00699000
*    (WKRG1,                                                       0320 00700000
*     WKRG2,                                                       0320 00701000
*     WKRG3) UNRSTD;                                               0320 00702000
*                                                                  0320 00703000
*   /*****************************************************************/ 00704000
*   /*                                                               */ 00705000
*   /* EXIT INDICATING PERMANENT OR SOFT ERROR. THE STATE OF IOSEX AT*/ 00706000
*   /* EXIT DETERMINES WHICH. IOSEX=0 - SOFT IOSEX=1 - PERM          */ 00707000
*   /*                                                               */ 00708000
*   /*****************************************************************/ 00709000
*                                                                  0321 00710000
*PERMSOFT:                                                         0321 00711000
*   ;                                                              0321 00712000
PERMSOFT DS    0H                                                  0322 00713000
*   GEN;                                                           0322 00714000
*                                                                  0322 00715000
         LM    @02,@06,0(@13)      RESTORE REGS                         00716000
         B     4(@06)              EXIT PERM/SOFT ERR                   00717000
*   /*****************************************************************/ 00718000
*   /*                                                               */ 00719000
*   /* INCREMENT ERROR CNTR & RESTART USER OR ERP CP                 */ 00720000
*   /*                                                               */ 00721000
*   /*****************************************************************/ 00722000
*                                                                  0323 00723000
*CNTINCR1:                                                         0323 00724000
*   EWACNTR1=EWACNTR1+1;            /* INCR                          */ 00725000
*                                                                  0323 00726000
CNTINCR1 LA    @12,1                                               0323 00727000
         SLR   @11,@11                                             0323 00728000
         IC    @11,EWACNTR1(,EWAPTR)                               0323 00729000
         ALR   @12,@11                                             0323 00730000
         STC   @12,EWACNTR1(,EWAPTR)                               0323 00731000
*   /*****************************************************************/ 00732000
*   /*                                                               */ 00733000
*   /* RESTORE THE STATIC SEEK ADDRESS INTO THE DYNAMIC SEEK FIELD   */ 00734000
*   /* UNDER THE FOLLOWING CONDITIONS.......... 1.CC=0-NOT VIRTUAL   */ 00735000
*   /* DEV 2.CC=0-VIRTUALDEV-NO UNIT CHECK 3.CC=0-VIRTUAL DEV-UNIT   */ 00736000
*   /* CHECK-NO ENV DATA                                     @ZA28708*/ 00737000
*   /*                                                               */ 00738000
*   /*****************************************************************/ 00739000
*                                                                  0324 00740000
*RETRY:                             /*                       @ZA28708*/ 00741000
*   IF ECC1OR3='0'B THEN            /* TEST FOR SIO=0        @ZA15695*/ 00742000
RETRY    TM    ECC1OR3+20(IOSBRG),B'00010000'                      0324 00743000
         BNZ   @RF00324                                            0324 00744000
*     IF UCBRVDEV^='1'B|IUNITCK^='1'B|EWDEDAT^='1'B THEN/*   @ZA15998*/ 00745000
         TM    UCBRVDEV(UCBRG),B'00001000'                         0325 00746000
         BNO   @RT00325                                            0325 00747000
         TM    IUNITCK+24(IOSBRG),B'00000010'                      0325 00748000
         BNO   @RT00325                                            0325 00749000
         TM    EWDEDAT(EWAPTR),B'00010000'                         0325 00750000
         BO    @RF00325                                            0325 00751000
@RT00325 DS    0H                                                  0326 00752000
*       IOSEEKA=IOSEEK;             /* DYNAMIC SEEK = STATIC @ZA15654*/ 00753000
         MVC   IOSEEKA(8,IOSBRG),IOSEEK(IOSBRG)                    0326 00754000
*     ELSE                                                         0327 00755000
*       ;                           /*                       @ZA28708*/ 00756000
@RF00325 DS    0H                                                  0328 00757000
*   ELSE                                                           0328 00758000
*     ;                             /*                       @ZA26177*/ 00759000
@RF00324 DS    0H                                                  0329 00760000
*   IF ERPCP='0'B                   /* ERP CH PGM?                   */ 00761000
*     THEN                          /* NO, CLR FLGS XCPT OFLO        */ 00762000
         TM    ERPCP+6(EWAPTR),B'00010000'                         0329 00763000
         BNZ   @RF00329                                            0329 00764000
*     EWAFLG3=EWAFLG3&'04'X;                                       0330 00765000
         NI    EWAFLG3(EWAPTR),X'04'                               0330 00766000
*   ELSE                                                           0331 00767000
*     ;                             /* YES, SKIP FLG CLEAR           */ 00768000
@RF00329 DS    0H                                                  0332 00769000
*RESTART:                                                          0332 00770000
*   ERPREV='1'B;                    /* IND PREV ENTRY                */ 00771000
RESTART  OI    ERPREV+6(EWAPTR),B'00000010'                        0332 00772000
*   GEN;                                                           0333 00773000
*                                                                  0333 00774000
         LM    @02,@06,0(@13)      RESTORE REGS                         00775000
         BR    @06                 TAKE RETRY/RESTART EXIT              00776000
*   /*****************************************************************/ 00777000
*   /*                                                               */ 00778000
*   /* CHANNEL ERROR, RETRY 10 IF ERPIB ALLOWS - ANY LOGGING IS DONE */ 00779000
*   /* BY CCH                                                        */ 00780000
*   /*                                                               */ 00781000
*   /*****************************************************************/ 00782000
*                                                                  0334 00783000
*ERCHAN:                                                           0334 00784000
*   IF EWANORTY='1'B                /* RETRY ALLOWED?                */ 00785000
*     THEN                                                         0334 00786000
ERCHAN   TM    EWANORTY(EWAPTR),B'00000001'                        0334 00787000
         BO    @RT00334                                            0334 00788000
*     GOTO ERMSG;                   /* NO, PERM ERR          @ZA26526*/ 00789000
*   ELSE                                                           0336 00790000
*     ;                             /* YES, RETRY            @ZA00137*/ 00791000
*                                                                  0336 00792000
*   /*****************************************************************/ 00793000
*   /*                                                               */ 00794000
*   /* TEST FOR MSS MISSING INTERRUPT CONDITION              @G24LSFS*/ 00795000
*   /*                                                               */ 00796000
*   /*****************************************************************/ 00797000
*                                                                  0337 00798000
*   IF ICCCK='1'B                   /* ARE BOTH CHN CNTL CHK @G24LSFS*/ 00799000
*       &IINTCCK='1'B               /* AND INT CNTL CHK ON   @G24LSFS*/ 00800000
*     THEN                                                         0337 00801000
         TM    ICCCK+24(IOSBRG),B'00000110'                        0337 00802000
         BNO   @RF00337                                            0337 00803000
*     IF EWACNTR1<1                 /* RETRY ONLY ONCE       @G24LSFS*/ 00804000
*       THEN                                                       0338 00805000
         CLI   EWACNTR1(EWAPTR),1                                  0338 00806000
         BL    @RT00338                                            0338 00807000
*       GOTO CNTINCR1;              /* INCR. CNT AND RETRY   @G24LSFS*/ 00808000
*     ELSE                          /*                       @ZA31895*/ 00809000
*       GOTO ERMSG;                 /* RETRY FAILED HARD ERR @ZA31895*/ 00810000
         B     ERMSG                                               0340 00811000
*   ELSE                                                           0341 00812000
*     ;                             /* NO MISSING INTERRUPT  @G24LSFS*/ 00813000
@RF00337 DS    0H                                                  0342 00814000
*RTY10D:                                                           0342 00815000
*   IF EWACNTR1<EWACNT10            /* CNT MAX?              @ZA00137*/ 00816000
*     THEN                                                         0342 00817000
RTY10D   CLI   EWACNTR1(EWAPTR),10                                 0342 00818000
         BL    @RT00342                                            0342 00819000
*     GOTO CNTINCR1;                /* NO, INCR & RTY        @ZA00137*/ 00820000
*   ELSE                                                           0344 00821000
*     ;                             /* YES                   @ZA00137*/ 00822000
*   GOTO ERMSG;                     /* EXIT PERM ERR         @ZA00137*/ 00823000
*                                                                  0345 00824000
         B     ERMSG                                               0345 00825000
*   /*****************************************************************/ 00826000
*   /*                                                               */ 00827000
*   /* PERMANENT ERROR ON ALL BUT 2314. DATA CHK IN COUNT FIELD ON   */ 00828000
*   /* 2314. LOG ALL. RETRY 10 ON 2314.                              */ 00829000
*   /*                                                               */ 00830000
*   /*****************************************************************/ 00831000
*                                                                  0346 00832000
*PERMCK:                                                           0346 00833000
*   IF UCB2OPT4='1'B                /* VIRTUAL DASD?         @ZA05468*/ 00834000
*     THEN                                                         0346 00835000
PERMCK   TM    UCB2OPT4(UCBRG),B'00001000'                         0346 00836000
         BNO   @RF00346                                            0346 00837000
*     IF EWDMDA1='1'B|EWDMDA2='1'B  /* MEDIA ERROR?@ZA05468          */ 00838000
*       THEN                                                       0347 00839000
         TM    EWDMDA1(EWAPTR),B'10100000'                         0347 00840000
         BNZ   @RT00347                                            0347 00841000
*       GOTO BYPOBR;                /* YES-BYPASS OBR        @ZA05468*/ 00842000
*     ELSE                                                         0349 00843000
*       ;                           /* NOT MEDIA ERROR       @ZA05468*/ 00844000
*   ELSE                                                           0350 00845000
*     ;                             /* NOT VIRTUAL DASD      @ZA05468*/ 00846000
@RF00346 DS    0H                                                  0351 00847000
*   GEN;                                                           0351 00848000
*                                  /*                                   00849000
         BAL   @14,LOGSAVE         SAVE LOG INFO                        00850000
*BYPOBR:                                                           0352 00851000
*   IF UCBTBYT4='08'X               /* 2314?                         */ 00852000
*     THEN                                                         0352 00853000
BYPOBR   CLI   UCBTBYT4(UCBRG),X'08'                               0352 00854000
         BE    @RT00352                                            0352 00855000
*     GOTO RTY10C;                  /* YES, RETRY                    */ 00856000
*   ELSE                                                           0354 00857000
*     ;                             /* NO, PERM ERR          @ZM41657*/ 00858000
*   IF ISNEQPCK='1'B                /* HANDLE EQP CK         @ZM41657*/ 00859000
*     THEN                                                         0355 00860000
         TM    ISNEQPCK+42(IOSBRG),B'00010000'                     0355 00861000
         BO    @RT00355                                            0355 00862000
*     GOTO ERMSG;                   /* NORMALLY.             @ZM41657*/ 00863000
*   ELSE                                                           0357 00864000
*     ;                             /* HANDLE NON-EQP CK     @ZM41657*/ 00865000
*   IF CCWOP='5E'X                  /* CHK FOR RD-M-CKD      @ZA19708*/ 00866000
*     THEN                                                         0358 00867000
         CLI   CCWOP(CCWRG),X'5E'                                  0358 00868000
         BE    @RT00358                                            0358 00869000
*     GOTO RTY10C;                  /* RETRY                 @ZM41657*/ 00870000
*   ELSE                                                           0360 00871000
*     GOTO ERMSG;                   /* HANDLE                @ZM41657*/ 00872000
*                                                                  0360 00873000
         B     ERMSG                                               0360 00874000
*   /*****************************************************************/ 00875000
*   /*                                                               */ 00876000
*   /* SEEK CHK - RECALIBRATE & RETRY 10, LOG                        */ 00877000
*   /*                                                               */ 00878000
*   /*****************************************************************/ 00879000
*                                                                  0361 00880000
*SNSERR:                                                           0361 00881000
*   IOSTATUS=EWASSTAT;              /* MOVE SENSE STATUS             */ 00882000
SNSERR   MVC   IOSTATUS(2,IOSBRG),EWASSTAT(EWAPTR)                 0361 00883000
*ERSEK:                                                            0362 00884000
*   IF EWACNTR1<EWACNT10            /* CNT MAX?                      */ 00885000
*     THEN                                                         0362 00886000
ERSEK    CLI   EWACNTR1(EWAPTR),10                                 0362 00887000
         BNL   @RF00362                                            0362 00888000
*     ;                             /* NO, RECAL - RTY               */ 00889000
*   ELSE                                                           0364 00890000
*     GOTO ERMSG;                   /* YES, PERM ERR                 */ 00891000
*   GEN;                                                           0365 00892000
*                                  /*                                   00893000
         BAL   @14,LOGSAVE         SAVE LOG INFO                        00894000
*   ERPRECAL='1'B;                  /* IND RECAL OP                  */ 00895000
         OI    ERPRECAL+6(EWAPTR),B'01000000'                      0366 00896000
*   IOSBYP='1'B;                    /* NO SEEK/SFM                   */ 00897000
*   IOSDEP='1'B;                    /* DEVICE END POST               */ 00898000
         OI    IOSBYP(IOSBRG),B'11000000'                          0368 00899000
*   CCWRG1=ADDR(DACP6);             /* RECAL CH PGM                  */ 00900000
         LA    CCWRG1,DACP6                                        0369 00901000
*   GEN;                                                           0370 00902000
*                                  /*                                   00903000
         BAL   @14,CPBLD           BLD CHAN PGM                         00904000
*   GOTO CNTINCR1;                  /* START CH PGM                  */ 00905000
*                                                                  0371 00906000
         B     CNTINCR1                                            0371 00907000
*   /*****************************************************************/ 00908000
*   /*                                                               */ 00909000
*   /* INTERVENTION REQUIRED - RETRY 1 ON ALL BUT 3340 LOG ON 3340,  */ 00910000
*   /* 3350, OR EMULATED DEVICE WHEN                         @ZA10232*/ 00911000
*   /* STATE BITS ARE ON.                                    @ZA10232*/ 00912000
*   /*                                                               */ 00913000
*   /*****************************************************************/ 00914000
*                                                                  0372 00915000
*ERINT:                                                            0372 00916000
*   IF UCBTBYT4='0A'X|UCBTBYT4='0B'X|EEMU='1'B/*             @ZA10232*/ 00917000
*     THEN                          /* YES, CHK STATE                */ 00918000
ERINT    CLI   UCBTBYT4(UCBRG),X'0A'                               0372 00919000
         BE    @RT00372                                            0372 00920000
         CLI   UCBTBYT4(UCBRG),X'0B'                               0372 00921000
         BE    @RT00372                                            0372 00922000
         TM    EEMU+34(EWAPTR),B'00001000'                         0372 00923000
         BNO   @RF00372                                            0372 00924000
@RT00372 DS    0H                                                  0373 00925000
*     IF DMCHECK='11'B              /* STATE = 1?            @ZA17988*/ 00926000
*       THEN                                                       0373 00927000
         TM    DMCHECK+42(EWAPTR),B'00001100'                      0373 00928000
         BNO   @RF00373                                            0373 00929000
*       DO;                         /* YES,THEN SAVE LOG DATA        */ 00930000
*         GEN;                                                     0375 00931000
*                                                 /*                    00932000
                        BAL   @14,LOGSAVE         SAVE LOG INFO         00933000
*         INTLOG='1'B;              /* SET INT. LOG BIT      @ZA17988*/ 00934000
         OI    INTLOG+136(EWAPTR),B'00000001'                      0376 00935000
*       END;                                                       0377 00936000
*     ELSE                                                         0378 00937000
*       ;                                                          0378 00938000
@RF00373 DS    0H                                                  0379 00939000
*   ELSE                                                           0379 00940000
*     ;                                                            0379 00941000
@RF00372 DS    0H                                                  0380 00942000
*   IF UCBTBYT4='0A'X               /* IF 3340 THEN NO RETRY @ZA17988*/ 00943000
*     THEN                                                         0380 00944000
         CLI   UCBTBYT4(UCBRG),X'0A'                               0380 00945000
         BE    @RT00380                                            0380 00946000
*     GOTO ERINT1;                  /*                       @ZA17988*/ 00947000
*   IF EWACNTR2=EWACNT01            /* CNTR MAX?                     */ 00948000
*     THEN                                                         0382 00949000
         CLI   EWACNTR2(EWAPTR),1                                  0382 00950000
         BE    @RT00382                                            0382 00951000
*     GOTO ERINT1;                  /* YES, SET FOR MSG              */ 00952000
*   ELSE                                                           0384 00953000
*     ;                             /* NO RETRY                      */ 00954000
*   EWACNTR2=EWACNTR2+EWACNT01;     /* INCREMENT                     */ 00955000
         LA    @12,1                                               0385 00956000
         SLR   @11,@11                                             0385 00957000
         IC    @11,EWACNTR2(,EWAPTR)                               0385 00958000
         ALR   @12,@11                                             0385 00959000
         STC   @12,EWACNTR2(,EWAPTR)                               0385 00960000
*   GOTO RETRY;                     /* RETRY                         */ 00961000
         B     RETRY                                               0386 00962000
*ERINT1:                                                           0387 00963000
*   IOSLOG='0'B;                    /* RESET IOSLOG BIT      @ZA17988*/ 00964000
ERINT1   NI    IOSLOG(IOSBRG),B'11111110'                          0387 00965000
*   IOSPROC=IOSAWTO;                /* IND WTO                       */ 00966000
         MVI   IOSPROC(IOSBRG),X'14'                               0388 00967000
*   EWDCCW9(1:6)=UCBVOLI;           /* VOL SER FOR WTO               */ 00968000
         MVC   EWDCCW9(6,EWAPTR),UCBVOLI(UCBRG)                    0389 00969000
*   GOTO CALTRANS;                  /* GOTO WTO                      */ 00970000
*                                                                  0390 00971000
         B     CALTRANS                                            0390 00972000
*   /*****************************************************************/ 00973000
*   /*                                                               */ 00974000
*   /* RETRY 10 - SOFT LOG ALL BUT 3340                              */ 00975000
*   /*                                                               */ 00976000
*   /*****************************************************************/ 00977000
*                                                                  0391 00978000
*RTY10A:                                                           0391 00979000
*   IF UCBTBYT4='0A'X               /* 3340?                         */ 00980000
*     THEN                                                         0391 00981000
RTY10A   CLI   UCBTBYT4(UCBRG),X'0A'                               0391 00982000
         BE    @RT00391                                            0391 00983000
*     GOTO RTY10B;                  /* YES, SKIP LOG                 */ 00984000
*   ELSE                                                           0393 00985000
*     GOTO RTY10;                   /* NO, LOG                       */ 00986000
*                                                                  0393 00987000
         B     RTY10                                               0393 00988000
*   /*****************************************************************/ 00989000
*   /*                                                               */ 00990000
*   /* NO RECORD FOUND - FOR 2314, VERIFY SEEK BY COMPARING SEEK ADDR*/ 00991000
*   /* & HOME ADDR. IF EQUAL, PERM ERR. IF NOT, SEEK CHK. PERM ERR   */ 00992000
*   /* FOR ALL OTHER DEVICES.                                        */ 00993000
*   /*                                                               */ 00994000
*   /*****************************************************************/ 00995000
*                                                                  0394 00996000
*NRFCK:                                                            0394 00997000
*   IF UCBTBYT4='08'X               /* 2314?                         */ 00998000
*     THEN                                                         0394 00999000
NRFCK    CLI   UCBTBYT4(UCBRG),X'08'                               0394 01000000
         BNE   @RF00394                                            0394 01001000
*     ;                             /* YES, VERIFY SEEK              */ 01002000
*   ELSE                                                           0396 01003000
*     GOTO ERHARD;                  /* NO, PERM ERR                  */ 01004000
*   IF IOSSKCC=EWDCCHH(1:2)         /* SEEK ADDR = HOME ADDR?        */ 01005000
*     THEN                                                         0397 01006000
         CLC   IOSSKCC(2,IOSBRG),EWDCCHH(EWAPTR)                   0397 01007000
         BE    @RT00397                                            0397 01008000
*     GOTO ERHARD;                  /* YES, PERM ERR                 */ 01009000
*   ELSE                                                           0399 01010000
*     ;                             /* NO, SET SEEK CHK              */ 01011000
*   EWDSKCK='1'B;                   /* EWA SNS                       */ 01012000
         OI    EWDSKCK(EWAPTR),B'00000001'                         0400 01013000
*   ISNSSKCK='1'B;                  /* IOSB SNS                      */ 01014000
         OI    ISNSSKCK+42(IOSBRG),B'00000001'                     0401 01015000
*   GOTO ERSEK;                     /* TERAT AS SEEK CHK             */ 01016000
*                                                                  0402 01017000
         B     ERSEK                                               0402 01018000
*   /*****************************************************************/ 01019000
*   /*                                                               */ 01020000
*   /* TRACK CONDITION CHECK - POSITION TO ALT OR DEF+1 TRK & RESTART*/ 01021000
*   /* INTERRUPTED CHAIN. FOR 3340, HA AND R0 MUST BE READ. FOR 2314,*/ 01022000
*   /* HA AND R0 WILL HAVE BEEN READ PREVIOUSLY BY THE IOS SENSE     */ 01023000
*   /* ROUTINE.                                                      */ 01024000
*   /*                                                               */ 01025000
*   /*****************************************************************/ 01026000
*                                                                  0403 01027000
*ERTCC:                                                            0403 01028000
*   IF UCBTBYT4='0A'X               /* 3340?                         */ 01029000
*     THEN                                                         0403 01030000
ERTCC    CLI   UCBTBYT4(UCBRG),X'0A'                               0403 01031000
         BE    @RT00403                                            0403 01032000
*     ;                             /* YES, SET TO READ HA/R0        */ 01033000
*   ELSE                                                           0405 01034000
*     DO;                           /* NO, IND RHA/RR0 RTRN          */ 01035000
*       ERPRHA='1'B;                /* RHA/RR0 IND                   */ 01036000
         OI    ERPRHA+6(EWAPTR),B'00100000'                        0406 01037000
*       GOTO ERNOER;                /* RHA/RR0 RETURN                */ 01038000
         B     ERNOER                                              0407 01039000
*     END;                                                         0408 01040000
*                                                                  0408 01041000
*   /*****************************************************************/ 01042000
*   /*                                                               */ 01043000
*   /* SET TO READ HOME ADDR AND R0                                  */ 01044000
*   /*                                                               */ 01045000
*   /*****************************************************************/ 01046000
*                                                                  0409 01047000
*   IOSSKH2=RSTHD&'1F'X;            /* SET HEAD ADDR FROM SNS        */ 01048000
@RT00403 LA    @12,31                                              0409 01049000
         SLR   @11,@11                                             0409 01050000
         IC    @11,RSTHD+32(,EWAPTR)                               0409 01051000
         NR    @12,@11                                             0409 01052000
         STC   @12,IOSSKH2(,IOSBRG)                                0409 01053000
*   IOSCKEY=0;                      /* SET PROT KEY OF ZERO          */ 01054000
         MVI   IOSCKEY(IOSBRG),X'00'                               0410 01055000
*   ERPRHA='1'B;                    /* IND RHA/RR0                   */ 01056000
         OI    ERPRHA+6(EWAPTR),B'00100000'                        0411 01057000
*   CCWRG1=ADDR(DACP8);             /* RHA.RR0 CH PGM                */ 01058000
         LA    CCWRG1,DACP8                                        0412 01059000
*   GEN;                                                           0413 01060000
*                                  /*                                   01061000
         BAL   @14,CPBLD           BLD CHAN PGM                         01062000
*   GOTO RESTART;                   /* START CH PGM                  */ 01063000
*                                                                  0414 01064000
         B     RESTART                                             0414 01065000
*   /*****************************************************************/ 01066000
*   /*                                                               */ 01067000
*   /* ERP ENTERED WITH NO ERROR CONDITIONS PRESENT FOR ONE OF THE   */ 01068000
*   /* FOLLOWING REASONS: 1. SUCCESSFUL RETRY - ERROR CORRECTED 2.   */ 01069000
*   /* RETURN FROM ERP RECALIBRATE CH PGM 3. RETURN FROM ERP READ LOG*/ 01070000
*   /* CH PGM 4. RETURN FROM ERP REAH HA.R0 CH PGM 5. BRANCH ENTRY   */ 01071000
*   /* FROM 2314 TCC CODE                                            */ 01072000
*   /*                                                               */ 01073000
*   /*****************************************************************/ 01074000
*                                                                  0415 01075000
*ERNOER:                                                           0415 01076000
*   ;                                                              0415 01077000
ERNOER   DS    0H                                                  0416 01078000
*   GEN;                                                           0416 01079000
*                                  /*                                   01080000
         BAL   @14,RESTORE         RESTORE IOSCKEY-OPT-RST              01081000
*   CCWRG=IOSCSWCA-CCWLNGTH;        /* GET CURRENT CCW       @ZA25984*/ 01082000
         L     CCWRG,IOSCSWCA-1(,IOSBRG)                           0417 01083000
         LA    CCWRG,0(,CCWRG)                                     0417 01084000
         SL    CCWRG,@CF00073                                      0417 01085000
*   IF CCWOP='5E'X                  /* CURRENT OP FTR?       @ZA25984*/ 01086000
*     THEN                          /*                       @ZA25984*/ 01087000
         CLI   CCWOP(CCWRG),X'5E'                                  0418 01088000
         BNE   @RF00418                                            0418 01089000
*     IF DCHNBIT='0'B&CCHNBIT='0'B  /* DATA OR               @ZA25984*/ 01090000
*       THEN                        /* COMMAND CHAIN?        @ZA25984*/ 01091000
         TM    DCHNBIT(CCWRG),B'11000000'                          0419 01092000
         BNZ   @RF00419                                            0419 01093000
*       IF CCWRG=ADDR(EWDCCW4)      /* CURRENT CMD IN EWD?   @ZA25984*/ 01094000
*         THEN                      /*                       @ZA25984*/ 01095000
         LA    @12,EWDCCW4(,EWAPTR)                                0420 01096000
         CR    CCWRG,@12                                           0420 01097000
         BNE   @RF00420                                            0420 01098000
*         IOSCSWCA=EWDCCW5(1:3);    /* RESTORE ORIG CCW      @ZA25984*/ 01099000
         MVC   IOSCSWCA(3,IOSBRG),EWDCCW5(EWAPTR)                  0421 01100000
*       ELSE                                                       0422 01101000
*         ;                         /*                       @ZA25984*/ 01102000
@RF00420 DS    0H                                                  0423 01103000
*     ELSE                                                         0423 01104000
*       ;                           /*                       @ZA25984*/ 01105000
@RF00419 DS    0H                                                  0424 01106000
*   ELSE                                                           0424 01107000
*     ;                             /*                       @ZA25984*/ 01108000
@RF00418 DS    0H                                                  0425 01109000
*   ERPCP='0'B;                     /* RESET ERP CH PGM IND          */ 01110000
         LA    @12,6                                               0425 01111000
         ALR   @12,EWAPTR                                          0425 01112000
         NI    ERPCP(@12),B'11101111'                              0425 01113000
*   IF ERPRECAL='1'B                /* RECAL FLG?                    */ 01114000
*     THEN                                                         0426 01115000
         TM    ERPRECAL(@12),B'01000000'                           0426 01116000
         BO    @RT00426                                            0426 01117000
*     GOTO RTY10C;                  /* YES, RETRY                    */ 01118000
*   IF ERPRDLOG='1'B                /* READ LOG FLG?                 */ 01119000
*     THEN                                                         0428 01120000
         TM    ERPRDLOG(@12),B'10000000'                           0428 01121000
         BO    @RT00428                                            0428 01122000
*     GOTO RETRY;                   /* YES,RETRY                     */ 01123000
*   ELSE                                                           0430 01124000
*     ;                             /* NO, CONTINUE CHK              */ 01125000
*   IF ERPRHA='0'B                  /* READ HA/R0 FLG?               */ 01126000
*     THEN                                                         0431 01127000
         TM    ERPRHA(@12),B'00100000'                             0431 01128000
         BZ    @RT00431                                            0431 01129000
*     GOTO ERSOFT;                  /* NO, ERR CORRECTED             */ 01130000
*   ELSE                                                           0433 01131000
*     ;                             /* YES, TCC RTRN                 */ 01132000
*   ERPRHA='0'B;                    /* RESET RHA IND                 */ 01133000
         NI    ERPRHA(@12),B'11011111'                             0434 01134000
*   IF UCBTBYT4='08'X               /* 2314?                         */ 01135000
*     THEN                                                         0435 01136000
         CLI   UCBTBYT4(UCBRG),X'08'                               0435 01137000
         BE    @RT00435                                            0435 01138000
*     GOTO SKIPRSTR;                /* YES RHA DONE BY IOS           */ 01139000
*   ELSE                                                           0437 01140000
*     ;                             /* NO                            */ 01141000
*   IOSSNS=EWDSAVS;                 /* RESTORE ORIG SNS & -          */ 01142000
         MVC   IOSSNS(2,IOSBRG),EWDSAVS(EWAPTR)                    0438 01143000
*   IOSCSW=EWDSAVC;                 /* CSW                           */ 01144000
         MVC   IOSCSW(7,IOSBRG),EWDSAVC(EWAPTR)                    0439 01145000
*   CCWRG=IOSCSWCA-CCWLNGTH;        /* ORIG ERR CCW                  */ 01146000
         L     CCWRG,IOSCSWCA-1(,IOSBRG)                           0440 01147000
         LA    CCWRG,0(,CCWRG)                                     0440 01148000
         SL    CCWRG,@CF00073                                      0440 01149000
*SKIPRSTR:                                                         0441 01150000
*   IOSCCHH=EWDRZRO;                /* MOVE ADDR OF DEF/ALT          */ 01151000
*                                                                  0441 01152000
SKIPRSTR MVC   IOSCCHH(4,IOSBRG),EWDRZRO(EWAPTR)                   0441 01153000
*   /*****************************************************************/ 01154000
*   /*                                                               */ 01155000
*   /* TO SEEK ADDR                                                  */ 01156000
*   /*                                                               */ 01157000
*   /*****************************************************************/ 01158000
*                                                                  0442 01159000
*   ERPCP='1'B;                     /* IND ERP CP                    */ 01160000
         OI    ERPCP+6(EWAPTR),B'00010000'                         0442 01161000
*   IF EWDHADEF='1'B                /* DEFECTIVE TRACK?              */ 01162000
*     THEN                                                         0443 01163000
         TM    EWDHADEF(EWAPTR),B'00000010'                        0443 01164000
         BNO   @RF00443                                            0443 01165000
*     DO;                           /* YES, IN OFLO CPGM?            */ 01166000
*       IF CCWRG=ADDR(EWDCCW2)      /* IN OFLO CPGM?                 */ 01167000
*         THEN                                                     0445 01168000
         LA    @12,EWDCCW2(,EWAPTR)                                0445 01169000
         CR    CCWRG,@12                                           0445 01170000
         BNE   @RF00445                                            0445 01171000
*         DO;                       /* YES                           */ 01172000
*           RFY                                                    0447 01173000
*            (WKRG1) RSTD;                                         0447 01174000
*           GEN;                                                   0448 01175000
                         LRA   WKRG1,0(CCWRG)                           01176000
*           IOSRST=WKRG1;           /* POINT TO CH PGM               */ 01177000
         ST    WKRG1,IOSRST(,IOSBRG)                               0449 01178000
*           RFY                                                    0450 01179000
*            (WKRG1) UNRSTD;                                       0450 01180000
*           GOTO RESTART;           /* RESTART CH PGM                */ 01181000
         B     RESTART                                             0451 01182000
*         END;                                                     0452 01183000
*       ELSE                                                       0453 01184000
*         GOTO OFLOCK1;             /* NO                            */ 01185000
*     END;                                                         0454 01186000
*   ELSE                                                           0455 01187000
*     ;                             /* NO, UPDATE SEEK ADDR          */ 01188000
@RF00443 DS    0H                                                  0456 01189000
*   GEN;                                                           0456 01190000
         BAL   @14,SKUPDAT         INCR SEEK ADDR BY 1                  01191000
*OFLOCK1:                                                          0457 01192000
*   IF ISNSOFLO='1'B                /* OFLO?                         */ 01193000
*     THEN                                                         0457 01194000
OFLOCK1  TM    ISNSOFLO+42(IOSBRG),B'00000001'                     0457 01195000
         BO    @RT00457                                            0457 01196000
*     GOTO EROFLOA;                 /* YES, GOTO OFLO RECOVERY       */ 01197000
*   ELSE                                                           0459 01198000
*     ;                             /* NO, NORMAL TCC                */ 01199000
*   RFY                                                            0460 01200000
*    (CCWRG1) RSTD;                                                0460 01201000
*   CCWRG1=ADDR(DACP1);             /* SET FOR SS-RHA-TIC            */ 01202000
         LA    CCWRG1,DACP1                                        0461 01203000
*   IF UCBENVRD='0'B                /* EXP SENSE DEV?                */ 01204000
*     THEN                                                         0462 01205000
         TM    UCBENVRD(UCBRG),B'00001000'                         0462 01206000
         BNZ   @RF00462                                            0462 01207000
*     CCWRG1=ADDR(DACP9);           /* NO, SET FOR SHA- TIC=RHA-TIC  */ 01208000
         LA    CCWRG1,DACP9                                        0463 01209000
*   ELSE                                                           0464 01210000
*     ;                             /* YES, ALREADY SET              */ 01211000
@RF00462 DS    0H                                                  0465 01212000
*   RFY                                                            0465 01213000
*    (CCWRG1) UNRSTD;                                              0465 01214000
*   GEN;                                                           0466 01215000
*                                  /*                                   01216000
         BAL   @14,CPBLD           BLD CHAN PGM                         01217000
*   GEN;                                                           0467 01218000
*                                  /*                                   01219000
         BAL   @14,TICBLD          BLD TIC TO USER                      01220000
*   GOTO RESTART;                   /* START CH PGM                  */ 01221000
*                                                                  0468 01222000
         B     RESTART                                             0468 01223000
*   /*****************************************************************/ 01224000
*   /*                                                               */ 01225000
*   /* OVERFLOW OPERATION INCOMPLETE - BLD CH PGM TO COMPLETE        */ 01226000
*   /* INTERRUPTED OPERATION.                                        */ 01227000
*   /*                                                               */ 01228000
*   /*****************************************************************/ 01229000
*                                                                  0469 01230000
*EROFLO:                                                           0469 01231000
*   IOSSKH2=RSTHD&'1F'X;            /* SET CURRENT HD FROM SNS       */ 01232000
EROFLO   LA    @12,31                                              0469 01233000
         SLR   @11,@11                                             0469 01234000
         IC    @11,RSTHD+32(,EWAPTR)                               0469 01235000
         NR    @12,@11                                             0469 01236000
         STC   @12,IOSSKH2(,IOSBRG)                                0469 01237000
*EROFLOA:                                                          0470 01238000
*   ERPOFLO='1'B;                   /* SET OFLO IND                  */ 01239000
EROFLOA  OI    ERPOFLO+6(EWAPTR),B'00000100'                       0470 01240000
*   EWDHARNO=1;                     /* RECORD = 1                    */ 01241000
         MVI   EWDHARNO(EWAPTR),X'01'                              0471 01242000
*   IF EWDTCC='1'B&EWDHADEF='1'B THEN                              0472 01243000
         TM    EWDTCC(EWAPTR),B'00000010'                          0472 01244000
         BNO   @RF00472                                            0472 01245000
         TM    EWDHADEF(EWAPTR),B'00000010'                        0472 01246000
         BO    @RT00472                                            0472 01247000
*     ;                                                            0473 01248000
*   ELSE                                                           0474 01249000
*     EWDCCHH=IOSCCHH;              /* USE IOSB SEEK CCHH            */ 01250000
@RF00472 MVC   EWDCCHH(4,EWAPTR),IOSCCHH(IOSBRG)                   0474 01251000
*   IF CCWRG=ADDR(DOFLOCCW)         /* ERR IN ERP OFLO CH PGM?       */ 01252000
*     THEN                                                         0475 01253000
@RT00472 LA    @12,104                                             0475 01254000
         ALR   @12,EWAPTR                                          0475 01255000
         CR    CCWRG,@12                                           0475 01256000
         BE    @RT00475                                            0475 01257000
*     GOTO OFLOCALC;                /* YES, SKIP CH PGM BLD          */ 01258000
*   ELSE                                                           0477 01259000
*     ;                             /* NO, BLD INIT CH PGM           */ 01260000
*   RFY                                                            0478 01261000
*    (CCWRG1,                                                      0478 01262000
*     WKRG1) RSTD;                                                 0478 01263000
*   CCWRG1=ADDR(DACP3);             /* ASSUME RPS                    */ 01264000
         LA    CCWRG1,DACP3                                        0479 01265000
*   IF UCBRPS='1'B                  /* RPS DEV?                      */ 01266000
*     THEN                                                         0480 01267000
         TM    UCBRPS(UCBRG),B'00010000'                           0480 01268000
         BO    @RT00480                                            0480 01269000
*     ;                             /* YES, ALREADY SET              */ 01270000
*   ELSE                                                           0482 01271000
*     CCWRG1=ADDR(DACP4);           /* SET FOR NON-RPS               */ 01272000
         LA    CCWRG1,DACP4                                        0482 01273000
*   GEN;                                                           0483 01274000
@RT00480 DS    0H                                                  0483 01275000
*                                  /*                                   01276000
         BAL   @14,CPBLD           BLD CHAN PGM                         01277000
*   CCWRG1=CCWRG+CCWLNGTH;          /* POINT TO NEXT CCW             */ 01278000
         LA    @12,8                                               0484 01279000
         LR    CCWRG1,CCWRG                                        0484 01280000
         ALR   CCWRG1,@12                                          0484 01281000
*   WKRG1=WKRG1-CCWLNGTH;           /* BACK UP OVER *-8 TIC          */ 01282000
         SLR   WKRG1,@12                                           0485 01283000
*   IF DCHNBIT='1'B|CCHNBIT='1'B    /* DATA/CMD CHAIN?               */ 01284000
*     THEN                                                         0486 01285000
         TM    DCHNBIT(CCWRG),B'11000000'                          0486 01286000
         BNZ   @RT00486                                            0486 01287000
*     ;                             /* YES, BLD TIC                  */ 01288000
*   ELSE                                                           0488 01289000
*     DO;                           /* NO                            */ 01290000
*       EWDCCW5(1:4)=CCWRG1;        /* SAVE USER CSW                 */ 01291000
         STCM  CCWRG1,15,EWDCCW5(EWAPTR)                           0489 01292000
*       ERPOCSW='1'B;               /* IND SAVED CSW                 */ 01293000
         OI    ERPOCSW+12(EWAPTR),B'10000000'                      0490 01294000
*       GOTO CMDSET;                /* SKIP TIC BLD                  */ 01295000
         B     CMDSET                                              0491 01296000
*     END;                                                         0492 01297000
*                                                                  0492 01298000
*   /*****************************************************************/ 01299000
*   /*                                                               */ 01300000
*   /* IS NEXT CCW A TIC                                             */ 01301000
*   /*                                                               */ 01302000
*   /*****************************************************************/ 01303000
*                                                                  0493 01304000
*   IF CCWRG1->TICBITS='1000'B THEN                                0493 01305000
@RT00486 TM    TICBITS(CCWRG1),B'00001000'                         0493 01306000
         BNO   @RF00493                                            0493 01307000
         TM    TICBITS(CCWRG1),B'00000111'                         0493 01308000
         BNZ   @RF00493                                            0493 01309000
*     DO;                           /* YES                           */ 01310000
*       WKRG3=CCWRG1->CCWDATA;      /* FETCH TIC ARG                 */ 01311000
         L     WKRG3,CCWDATA-1(,CCWRG1)                            0495 01312000
         LA    WKRG3,0(,WKRG3)                                     0495 01313000
*       IF WKRG3=CCWRG              /* IS IT *-8?                    */ 01314000
*         THEN                                                     0496 01315000
         CR    WKRG3,CCWRG                                         0496 01316000
         BNE   @RF00496                                            0496 01317000
*         DO;                       /* YES PT AT NXT AND -           */ 01318000
*           WKRG1=WKRG1+CCWLNGTH;   /* INCR TIC BLD ADDR             */ 01319000
         LA    @12,8                                               0498 01320000
         ALR   WKRG1,@12                                           0498 01321000
*           CCWRG1=CCWRG1+CCWLNGTH; /* PT AT NXT                     */ 01322000
         ALR   CCWRG1,@12                                          0499 01323000
*         END;                                                     0500 01324000
*       ELSE                                                       0501 01325000
*         ;                         /* NO                            */ 01326000
@RF00496 DS    0H                                                  0502 01327000
*     END;                                                         0502 01328000
*   ELSE                                                           0503 01329000
*     ;                             /* NO                            */ 01330000
@RF00493 DS    0H                                                  0504 01331000
*   GEN;                                                           0504 01332000
*                                  /*                                   01333000
         BAL   @14,TICBLD          BLD TIC TO USER                      01334000
*   RFY                                                            0505 01335000
*    (CCWRG1,                                                      0505 01336000
*     WKRG1) UNRSTD;                                               0505 01337000
*CMDSET:                                                           0506 01338000
*   DOFLOCCW=DACCW;                 /* COPY USER CCW, THEN MOD       */ 01339000
CMDSET   LA    @12,104                                             0506 01340000
         ALR   @12,EWAPTR                                          0506 01341000
         MVC   DOFLOCCW(8,@12),DACCW(CCWRG)                        0506 01342000
*   OFLOOP=EWDSNS3;                 /* ASSUME EXTSNS DEV             */ 01343000
         MVC   OFLOOP(1,@12),EWDSNS3(EWAPTR)                       0507 01344000
*   IF UCBENVRD='0'B                /* EXTSNS DEV?                   */ 01345000
*     THEN                                                         0508 01346000
         TM    UCBENVRD(UCBRG),B'00001000'                         0508 01347000
         BNZ   @RF00508                                            0508 01348000
*     OFLOOP=EWDSNS5;               /* NO, SET FROM BYTE 5           */ 01349000
         MVC   OFLOOP(1,@12),EWDSNS5(EWAPTR)                       0509 01350000
*   ELSE                                                           0510 01351000
*     ;                             /* YES, ALREADY SET              */ 01352000
@RF00508 DS    0H                                                  0511 01353000
*   OFLOPCI='0'B;                   /* CLEAR PCI BIT                 */ 01354000
*                                                                  0511 01355000
         NI    OFLOPCI+104(EWAPTR),B'11110111'                     0511 01356000
*   /*****************************************************************/ 01357000
*   /*                                                               */ 01358000
*   /* IF ERROR CCW IS USING INDIRECT DATA ADDRESSING, OBTAIN CORE   */ 01359000
*   /* FOR ERP IDAL AND COPY ERRCCW IDAL.                            */ 01360000
*   /*                                                               */ 01361000
*   /*****************************************************************/ 01362000
*                                                                  0512 01363000
*IDALCK:                                                           0512 01364000
*   IF IDABIT='1'B                  /* INDIRECT ADDRESSING?          */ 01365000
*     THEN                                                         0512 01366000
IDALCK   TM    IDABIT(CCWRG),B'00000100'                           0512 01367000
         BNO   @RF00512                                            0512 01368000
*     DO;                           /* YES                           */ 01369000
*       RFY                                                        0514 01370000
*        (WKRG1,                                                   0514 01371000
*         WKRG3,                                                   0514 01372000
*         CALLRG) RSTD;                                            0514 01373000
*       GEN;                                                       0515 01374000
*                                          /*                           01375000
                 BAL   @14,GETBLOK         GET A 160 BYTE BLOCK OF CORE 01376000
*       WKRG1=CCWDATA;              /* POINT AT USER IDAL            */ 01377000
         L     WKRG1,CCWDATA-1(,CCWRG)                             0516 01378000
         LA    WKRG1,0(,WKRG1)                                     0516 01379000
*       GEN;                                                       0517 01380000
         LRA   WKRG3,0(WKRG3)      REAL ADDR  OF ERP IDAL               01381000
         STNSM MASKBYTE,X'FB'      DAT OFF                              01382000
*       ERPIDAL=USERIDAL;           /* COPY USER IDAL                */ 01383000
         MVC   ERPIDAL+4(156,WKRG3),USERIDAL(WKRG1)                0518 01384000
*       GEN;                                                       0519 01385000
         STOSM MASKBYTE,X'04'      DAT ON                               01386000
*       OFLOARG=WKRG3+WORDSIZE;     /* PLACE IN CCW                  */ 01387000
         LA    @14,4                                               0520 01388000
         ALR   @14,WKRG3                                           0520 01389000
         STCM  @14,7,OFLOARG+104(EWAPTR)                           0520 01390000
*     END;                                                         0521 01391000
*   ELSE                                                           0522 01392000
*     ;                             /* NO, SKIP IDAL PROCESS         */ 01393000
@RF00512 DS    0H                                                  0523 01394000
*OFLOCALC:                                                         0523 01395000
*   FDISP=CCWCNT-IOSCSWRC;          /* CALC OFLO DISP                */ 01396000
OFLOCALC LH    @14,CCWCNT(,CCWRG)                                  0523 01397000
         N     @14,@CF00055                                        0523 01398000
         LH    @12,IOSCSWRC(,IOSBRG)                               0523 01399000
         N     @12,@CF00055                                        0523 01400000
         SLR   @14,@12                                             0523 01401000
         STH   @14,FDISP+152(,EWAPTR)                              0523 01402000
*   WKRG1=ADDR(DOFLOCCW);           /* POINT AT ERP OFLO CCW         */ 01403000
         LA    WKRG1,104                                           0524 01404000
         ALR   WKRG1,EWAPTR                                        0524 01405000
*   IF IDABIT='1'B                  /* INDIRECT ADDRESSING?          */ 01406000
*     THEN                                                         0525 01407000
         TM    IDABIT(CCWRG),B'00000100'                           0525 01408000
         BNO   @RF00525                                            0525 01409000
*     DO;                           /* YES, LOCATE IDAW & DISP       */ 01410000
*       GEN;                                                       0527 01411000
         BAL   @14,ADRCALC         CALC IDAW ADDR & DISP                01412000
*       OFLOARG=WKRG1;              /* POINT TO IDAW                 */ 01413000
         STCM  WKRG1,7,OFLOARG+104(EWAPTR)                         0528 01414000
*       CALLRG=ADDR(IEAPTRV);       /* REAL/VIRT XLATE RTN           */ 01415000
         L     CALLRG,@CV00033                                     0529 01416000
*       GEN;                                                       0530 01417000
         LR    @12,@01             SAVE IOSB REG ACROSS XLATE           01418000
         LR    @01,WKRG1           REAL ADDR                            01419000
         BALR  @14,@15             GOTO  XLATE RTN                      01420000
         LR    WKRG1,@01           VIRTUAL ADDR                         01421000
         LR    @01,@12             RESTORE IOSB REG                     01422000
         L     BASEREG2,NEWBASE    RESTORE SECOND BASE REG     @ZA15984 01423000
*     END;                                                         0531 01424000
*   ELSE                                                           0532 01425000
*     ;                             /* NO                            */ 01426000
*                                                                  0532 01427000
@RF00525 DS    0H                                                  0533 01428000
*   /*****************************************************************/ 01429000
*   /*                                                               */ 01430000
*   /* UPDATE ADDR POINTED TO BY WKRG1 BY FDISP. WKRG1 MAY POINT TO  */ 01431000
*   /* EITHER A CCW OR AN IDAW.                                      */ 01432000
*   /*                                                               */ 01433000
*   /*****************************************************************/ 01434000
*                                                                  0533 01435000
*   WKRG1->CCWDATA=WKRG1->CCWDATA+FDISP;                           0533 01436000
         L     @14,CCWDATA-1(,WKRG1)                               0533 01437000
         LA    @14,0(,@14)                                         0533 01438000
         LH    @12,FDISP+152(,EWAPTR)                              0533 01439000
         N     @12,@CF00055                                        0533 01440000
         ALR   @14,@12                                             0533 01441000
         STCM  @14,7,CCWDATA(WKRG1)                                0533 01442000
*   IF SCHOPA='1'B&SCHOPB='1'B      /* SEARCH OP? @ZA17964-          */ 01443000
*     THEN                                                         0534 01444000
         TM    SCHOPA(CCWRG),B'00100001'                           0534 01445000
         BO    @RT00534                                            0534 01446000
*     GOTO SCHOP;                   /* YES, SET CNT SKIP SILI      0535 01447000
*                                      @ZA17964-                     */ 01448000
*   ELSE                                                           0536 01449000
*     ;                             /* @ZA17964-                     */ 01450000
*   IF IOSCSWRC=0                   /* RESID CNT =0?                 */ 01451000
*     THEN                                                         0537 01452000
         LH    @14,IOSCSWRC(,IOSBRG)                               0537 01453000
         N     @14,@CF00055                                        0537 01454000
         LTR   @14,@14                                             0537 01455000
         BNZ   @RF00537                                            0537 01456000
*     DO;                           /* YES, FORCE CNT=1, SKIP, SILI  */ 01457000
*SCHOP:                             /* CCW IS A SEARCH TYPE OP     0539 01458000
*                                      @ZA17964-                     */ 01459000
*       OFLOCNT=1;                  /* CNT = 1                       */ 01460000
SCHOP    LA    @14,104                                             0539 01461000
         ALR   @14,EWAPTR                                          0539 01462000
         MVC   OFLOCNT(2,@14),@CH00081                             0539 01463000
*       OFLOSKIP='1'B;              /* SKIP = 1                      */ 01464000
*       OFLOSLI='1'B;               /* SILI = 1              @ZA07730*/ 01465000
         OI    OFLOSKIP(@14),B'00110000'                           0541 01466000
*     END;                                                         0542 01467000
*   ELSE                                                           0543 01468000
*     OFLOCNT=IOSCSWRC;             /* NO, USE RESID AS CNT          */ 01469000
         B     @RC00537                                            0543 01470000
@RF00537 LH    @14,IOSCSWRC(,IOSBRG)                               0543 01471000
         N     @14,@CF00055                                        0543 01472000
         STH   @14,OFLOCNT+104(,EWAPTR)                            0543 01473000
*   IF UCBRPS='1'B                  /* RPS DEV?                      */ 01474000
*     THEN                                                         0544 01475000
@RC00537 TM    UCBRPS(UCBRG),B'00010000'                           0544 01476000
         BNO   @RF00544                                            0544 01477000
*     WKRG1=ADDR(EWDCCW1);          /* YES                           */ 01478000
         LA    WKRG1,EWDCCW1(,EWAPTR)                              0545 01479000
*   ELSE                                                           0546 01480000
*     WKRG1=ADDR(EWDCCW2);          /* NO                            */ 01481000
         B     @RC00544                                            0546 01482000
@RF00544 LA    WKRG1,EWDCCW2(,EWAPTR)                              0546 01483000
*   GEN;                                                           0547 01484000
@RC00544 DS    0H                                                  0547 01485000
         LRA   WKRG1,0(WKRG1)      REAL ADDR                            01486000
*   IOSRST=WKRG1;                   /* POINT AT CP                   */ 01487000
         ST    WKRG1,IOSRST(,IOSBRG)                               0548 01488000
*   GEN;                                                           0549 01489000
*                                  /*                          @ZA07730 01490000
         CLI   EWDCCW5(EWAPTR),X'08'        TIC CMD?           @ZA07730 01491000
         BNE   RESTART                      NO, RESTART        @ZA07730 01492000
         L     CALLRG,@CV00033              GET XLATE RTN      @ZA07730 01493000
         LR    @12,@01                      SAVE IOB PTR       @ZA07730 01494000
         L     @01,EWDCCW5(EWAPTR)          GET CCW ADDRS      @ZA07730 01495000
         LA    @01,0(@01)                   CLEAR HI BYTE      @ZA07730 01496000
         BALR  @14,@15                      REAL/VIRTUAL RTN   @ZA07730 01497000
         L     BASEREG2,NEWBASE             RESTORE BASE REG2  @ZA15984 01498000
         CLI   0(@01),X'9A'                 MT RHA?            @ZA07730 01499000
         BNE   RHATST                       NO, TEST RHA       @ZA07730 01500000
         NI    0(@01),X'7F'                 TURN OFF MT        @ZA07730 01501000
RHAYES   MVC   EWDCCW2(8,EWAPTR),EWDCCW5(EWAPTR) BYPASS SEARCH @ZA07730 01502000
RHANO    LR    @01,@12                      RESTORE IOB        @ZA07730 01503000
         B     RESTART                      GO START CH PGM    @ZA07730 01504000
RHATST   CLI   0(@01),X'1A'                 RHA?               @ZA07730 01505000
         BNE   RHANO                        NO                 @ZA07730 01506000
         B     RHAYES                       YES                @ZA07730 01507000
*   RFY                                                            0550 01508000
*    (WKRG1,                                                       0550 01509000
*     CALLRG) UNRSTD;                                              0550 01510000
*                                                                  0550 01511000
*   /*****************************************************************/ 01512000
*   /*                                                               */ 01513000
*   /* DATA CHECK                                                    */ 01514000
*   /*                                                               */ 01515000
*   /*****************************************************************/ 01516000
*                                                                  0551 01517000
*ERDATA:                                                           0551 01518000
*   ;                                                              0551 01519000
ERDATA   DS    0H                                                  0552 01520000
*   GEN;                                                           0552 01521000
*                                  /*                                   01522000
         BAL   @14,MERCK           MERLIN FAMILY?                       01523000
         BNE   WINCK1              NO, BRANCH                           01524000
*   IF EWDCORR='1'B                 /* CORRECTABLE?                  */ 01525000
*     THEN                                                         0553 01526000
         TM    EWDCORR(EWAPTR),B'01000000'                         0553 01527000
         BNO   @RF00553                                            0553 01528000
*     DO;                           /* YES, TEST FOR LOGGING @ZA09637*/ 01529000
*                                                                  0554 01530000
*       /*************************************************************/ 01531000
*       /*                                                           */ 01532000
*       /* LOG CORRECTABLE DATA CHECKS FOR 3350 AND EMULATED 3330    */ 01533000
*       /* (MOD 1 & 11) DEVICES.                             @ZA09637*/ 01534000
*       /*                                                           */ 01535000
*       /*************************************************************/ 01536000
*                                                                  0555 01537000
*       IF UCBTBYT4='0B'X|EEMU='1'B /* 3350 OR EMULATION?    @ZA09637*/ 01538000
*         THEN                                                     0555 01539000
         CLI   UCBTBYT4(UCBRG),X'0B'                               0555 01540000
         BE    @RT00555                                            0555 01541000
         TM    EEMU+34(EWAPTR),B'00001000'                         0555 01542000
         BNO   @RF00555                                            0555 01543000
@RT00555 DS    0H                                                  0556 01544000
*         DO;                       /* YES, SAVE LOG DATA    @ZA09637*/ 01545000
*           GEN;                                                   0557 01546000
*                                                  /*                   01547000
                         BAL   @14,LOGSAVE         SAVE LOG INFO        01548000
*         END;                      /*                       @ZA09637*/ 01549000
*       ELSE                                                       0559 01550000
*         ;                         /* NOT 3350 OR EMULATION @ZA09637*/ 01551000
@RF00555 DS    0H                                                  0560 01552000
*       GOTO ECCENTRY;              /* GO TO ECC ROUTINE     @ZA09637*/ 01553000
         B     ECCENTRY                                            0560 01554000
*     END;                          /*                       @ZA09637*/ 01555000
*   ELSE                                                           0562 01556000
*     ;                             /* NO                            */ 01557000
@RF00553 DS    0H                                                  0563 01558000
*   IF EWDOFLO='0'B                 /* OVERFLOW?                     */ 01559000
*     THEN                                                         0563 01560000
         TM    EWDOFLO(EWAPTR),B'00000001'                         0563 01561000
         BZ    @RT00563                                            0563 01562000
*     GOTO RTY10;                   /* NO, LOG THEN RETRY    @ZA26139*/ 01563000
*   ELSE                                                           0565 01564000
*     ;                             /* YES, SET TO USE ECC           */ 01565000
*                                                                  0565 01566000
*   /*****************************************************************/ 01567000
*   /*                                                               */ 01568000
*   /* CCW SEARCH CODE                                               */ 01569000
*   /*                                                               */ 01570000
*   /*****************************************************************/ 01571000
*                                                                  0566 01572000
*   RFY                                                            0566 01573000
*    (WKRG3) RSTD;                                                 0566 01574000
*   GEN;                                                           0567 01575000
*                                  /*                                   01576000
         BAL   @14,LOGSAVE         SAVE LOG INFO                        01577000
*   WKRG3=0;                        /* LOOP CNT = 0                  */ 01578000
         SLR   WKRG3,WKRG3                                         0568 01579000
*   RSTRTDSP=RSTDISP;               /* MOVE TO SAVE AREA             */ 01580000
         MVC   RSTRTDSP+152(3,EWAPTR),RSTDISP+32(EWAPTR)           0569 01581000
*   GOTO CHAINCK;                   /* GOTO CCW SCH CODE             */ 01582000
         B     CHAINCK                                             0570 01583000
*   RFY                                                            0571 01584000
*    (WKRG3) UNRSTD;                                               0571 01585000
*                                                                  0571 01586000
*   /*****************************************************************/ 01587000
*   /*                                                               */ 01588000
*   /* ALL DATA CHECKS LOGGED FOR 3340 DEVICES.                      */ 01589000
*   /*                                                               */ 01590000
*   /*****************************************************************/ 01591000
*                                                                  0572 01592000
*WINCK1:                                                           0572 01593000
*   IF UCBTBYT4='0A'X|UCBTBYT4='08'X/* 3340 OR 2314?                 */ 01594000
*     THEN                                                         0572 01595000
WINCK1   CLI   UCBTBYT4(UCBRG),X'0A'                               0572 01596000
         BE    @RT00572                                            0572 01597000
         CLI   UCBTBYT4(UCBRG),X'08'                               0572 01598000
         BNE   @RF00572                                            0572 01599000
@RT00572 DS    0H                                                  0573 01600000
*     DO;                           /* YES, LOG                      */ 01601000
*       GEN;                                                       0574 01602000
*                                          /*                           01603000
                 BAL   @14,LOGSAVE         SAVE LOG INFO                01604000
*     END;                                                         0575 01605000
*   ELSE                                                           0576 01606000
*     ;                             /* NO, SKIP LOG                  */ 01607000
@RF00572 DS    0H                                                  0577 01608000
*   IF EWDCORR='0'B                 /* CORRECTABLE?                  */ 01609000
*     THEN                                                         0577 01610000
         TM    EWDCORR(EWAPTR),B'01000000'                         0577 01611000
         BZ    @RT00577                                            0577 01612000
*     GOTO RTY10C;                  /* NO, RETRY                     */ 01613000
*   ELSE                                                           0579 01614000
*     ;                             /* YES, PERFORM ECF              */ 01615000
*MERWCK1:                                                          0580 01616000
*   ;                               /* TEST FOR 3330 FAMILY          */ 01617000
MERWCK1  DS    0H                                                  0581 01618000
*   GEN;                                                           0581 01619000
*                                  /*                                   01620000
         BAL   @14,MERWCK          MERLIN FMLY OR 3340?                 01621000
         BNE   ZEUSDISP            NO, SET FOR ZEUS                     01622000
*ECCENTRY:                          /* 3350/EMULATION ENTRY  @ZA09637*/ 01623000
*   RSTRTDSP=RSTDISP;               /* SAVE RSTRT DISP               */ 01624000
ECCENTRY LA    @12,152                                             0582 01625000
         ALR   @12,EWAPTR                                          0582 01626000
         LA    @11,32                                              0582 01627000
         ALR   @11,EWAPTR                                          0582 01628000
         SLR   @05,@05                                             0582 01629000
         ICM   @05,7,RSTDISP(@11)                                  0582 01630000
         STCM  @05,7,RSTRTDSP(@12)                                 0582 01631000
*   FDISP=RSTDISP-BKDISP;           /* CALC FWD DISP                 */ 01632000
         LH    @11,BKDISP(,@11)                                    0583 01633000
         N     @11,@CF00055                                        0583 01634000
         SLR   @05,@11                                             0583 01635000
         STH   @05,FDISP(,@12)                                     0583 01636000
*   GOTO LOOPSET;                   /* SKIP ZEUS CODE                */ 01637000
         B     LOOPSET                                             0584 01638000
*ZEUSDISP:                                                         0585 01639000
*   FDISP=CCWCNT-BKDISP-IOSCSWRC;   /* CALC FWD DISP                 */ 01640000
ZEUSDISP LH    @12,CCWCNT(,CCWRG)                                  0585 01641000
         N     @12,@CF00055                                        0585 01642000
         LH    @11,BKDISP+32(,EWAPTR)                              0585 01643000
         N     @11,@CF00055                                        0585 01644000
         SLR   @12,@11                                             0585 01645000
         LH    @11,IOSCSWRC(,IOSBRG)                               0585 01646000
         N     @11,@CF00055                                        0585 01647000
         SLR   @12,@11                                             0585 01648000
         STH   @12,FDISP+152(,EWAPTR)                              0585 01649000
*   IF FDISP<0                      /* NEG DISP?                     */ 01650000
*     THEN                                                         0586 01651000
*     GOTO RTY10C;                  /* YES, RETRY CH PGM             */ 01652000
*   ELSE                                                           0588 01653000
*     ;                             /* NO, CONTINUE                  */ 01654000
*                                                                  0588 01655000
@RF00586 DS    0H                                                  0589 01656000
*   /*****************************************************************/ 01657000
*   /*                                                               */ 01658000
*   /* SET UP LOOP TO APPLY ECC BYTE TO CORE                         */ 01659000
*   /*                                                               */ 01660000
*   /*****************************************************************/ 01661000
*                                                                  0589 01662000
*   RFY                                                            0589 01663000
*    (WKRG1,                                                       0589 01664000
*     WKRG2,                                                       0589 01665000
*     WKRG3,                                                       0589 01666000
*     CALLRG,                                                      0589 01667000
*     CCWRG1) RSTD;                                                0589 01668000
*LOOPSET:                                                          0590 01669000
*   WKRG3=3;                        /* SET LOOP CNT                  */ 01670000
LOOPSET  LA    WKRG3,3                                             0590 01671000
*   WKRG2=ADDR(ECCSYN);             /* POINT AT CORR BYTE            */ 01672000
         LA    WKRG2,ECCSYN+32(,EWAPTR)                            0591 01673000
*ECFLOOP1:                                                         0592 01674000
*   IF FDISP<CCWCNT                 /* ERR IN THIS SEG?              */ 01675000
*     THEN                                                         0592 01676000
ECFLOOP1 CLC   FDISP+152(2,EWAPTR),CCWCNT(CCWRG)                   0592 01677000
         BNL   @RF00592                                            0592 01678000
*     ;                             /* YES, CONTINUE                 */ 01679000
*   ELSE                                                           0594 01680000
*     GOTO MERWCK2;                 /* NO CHK FOR NXT SEG            */ 01681000
*   WKRG1=CCWRG;                    /* POINT AT ERRCCW               */ 01682000
         LR    WKRG1,CCWRG                                         0595 01683000
*   IF IDABIT='1'B                  /* INDIRECT ADDRESSING?          */ 01684000
*     THEN                                                         0596 01685000
         TM    IDABIT(CCWRG),B'00000100'                           0596 01686000
         BNO   @RF00596                                            0596 01687000
*     DO;                           /* YES,                          */ 01688000
*       GEN;                                                       0598 01689000
         BAL   @14,ADRCALC         POINT TO CURRENT IDAW                01690000
*     END;                                                         0599 01691000
*   ELSE                                                           0600 01692000
*     DO;                           /* NO                            */ 01693000
         B     @RC00596                                            0600 01694000
@RF00596 DS    0H                                                  0601 01695000
*       GEN;                                                       0601 01696000
         LRA   WKRG1,0(WKRG1)      REAL ADDR OF CCW                     01697000
*     END;                                                         0602 01698000
*   IF IDABIT='0'B                  /* INDIRECT ADDRESSING?  @ZA03158*/ 01699000
*     THEN                                                         0603 01700000
@RC00596 TM    IDABIT(CCWRG),B'00000100'                           0603 01701000
         BNZ   @RF00603                                            0603 01702000
*     CALLRG=FDISP;                 /* NO                    @ZA03158*/ 01703000
         LH    CALLRG,FDISP+152(,EWAPTR)                           0604 01704000
         N     CALLRG,@CF00055                                     0604 01705000
*   ELSE                                                           0605 01706000
*     ;                             /*                       @ZA03158*/ 01707000
@RF00603 DS    0H                                                  0606 01708000
*   IF ECCBYTE=0|SKIPBIT='1'B       /* ECC=0 OR SKIP BIT=1?          */ 01709000
*     THEN                                                         0606 01710000
         CLI   ECCBYTE(WKRG2),0                                    0606 01711000
         BE    @RT00606                                            0606 01712000
         TM    SKIPBIT(CCWRG),B'00010000'                          0606 01713000
         BNO   @RF00606                                            0606 01714000
@RT00606 DS    0H                                                  0607 01715000
*     DO;                           /*                       @ZA03158*/ 01716000
*       FDISP=CALLRG;               /* RESTORE ORIG. FDISP   @ZA03158*/ 01717000
         STH   CALLRG,FDISP+152(,EWAPTR)                           0608 01718000
*       GOTO ECCINCR;               /* SKIP XCL-OR           @ZA03158*/ 01719000
         B     ECCINCR                                             0609 01720000
*     END;                          /*                       @ZA03158*/ 01721000
*   ELSE                                                           0611 01722000
*     ;                             /* NO, APPLY ECF                 */ 01723000
@RF00606 DS    0H                                                  0612 01724000
*   CCWRG1=FDISP;                   /* PICK UP FWD DISP              */ 01725000
         LA    @14,152                                             0612 01726000
         ALR   @14,EWAPTR                                          0612 01727000
         LH    CCWRG1,FDISP(,@14)                                  0612 01728000
         N     CCWRG1,@CF00055                                     0612 01729000
*   FDISP=CALLRG;                   /* RESTORE ORIG. FDISP   @ZA03158*/ 01730000
         STH   CALLRG,FDISP(,@14)                                  0613 01731000
*   GEN REFS(MASKBYTE);                                            0614 01732000
         LRA   CALLRG,0(WKRG2)     REAL ADDR OF ECC BYTE                01733000
         STNSM MASKBYTE,X'FB'      DOWN WITH DAT                        01734000
         ICM   WKRG1,7,1(WKRG1)    DATA ADDR (REAL)                     01735000
         AR    WKRG1,CCWRG1        DATA+DISP                            01736000
         XC    0(1,WKRG1),0(CALLRG) XCL-OR ECC BYTE TO CORE             01737000
         STOSM MASKBYTE,X'04'      DAT ON                               01738000
*ECCINCR:                                                          0615 01739000
*   WKRG2=WKRG2+1;                  /* ECC BYTE PTR                  */ 01740000
ECCINCR  LA    @14,1                                               0615 01741000
         ALR   WKRG2,@14                                           0615 01742000
*   FDISP=FDISP+1;                  /* DISPLACEMENT                  */ 01743000
         LA    @12,152                                             0616 01744000
         ALR   @12,EWAPTR                                          0616 01745000
         LH    @00,FDISP(,@12)                                     0616 01746000
         N     @00,@CF00055                                        0616 01747000
         ALR   @00,@14                                             0616 01748000
         STH   @00,FDISP(,@12)                                     0616 01749000
*   IF UCBTBYT4='06'X               /* 2305A?                        */ 01750000
*     THEN                                                         0617 01751000
         CLI   UCBTBYT4(UCBRG),X'06'                               0617 01752000
         BNE   @RF00617                                            0617 01753000
*     FDISP=FDISP+1;                /* YES, INCR AGAIN               */ 01754000
         ALR   @00,@14                                             0618 01755000
         STH   @00,FDISP(,@12)                                     0618 01756000
*   ELSE                                                           0619 01757000
*     ;                             /* NO                            */ 01758000
@RF00617 DS    0H                                                  0620 01759000
*   GEN;                                                           0620 01760000
*                                  /*                                   01761000
         BCT   WKRG3,ECFLOOP1      DECR CNT & LOOP TILL ZERO            01762000
*        LABEL 'MERWCK2' MUST FOLLOW                                    01763000
MERWCK2  BAL   @14,MERWCK          MERLIN FMLY OR 3340?                 01764000
         BNE   MASKCK              NO, TO RESTART CODE                  01765000
*CHAINCK:                                                          0621 01766000
*   IF DCHNBIT='0'B                 /* DATA CHAINING?                */ 01767000
*     THEN                                                         0621 01768000
CHAINCK  TM    DCHNBIT(CCWRG),B'10000000'                          0621 01769000
         BZ    @RT00621                                            0621 01770000
*     GOTO LENCK1;                  /* NO, CHK FOR CU DTD LGTH       */ 01771000
*   ELSE                                                           0623 01772000
*     ;                             /* YES, PT TO NXT CCW            */ 01773000
*   FDISP=FDISP-CCWCNT;             /* DECR FWD DISP                 */ 01774000
         LA    @14,152                                             0624 01775000
         ALR   @14,EWAPTR                                          0624 01776000
         LH    @12,CCWCNT(,CCWRG)                                  0624 01777000
         N     @12,@CF00055                                        0624 01778000
         LH    @00,FDISP(,@14)                                     0624 01779000
         N     @00,@CF00055                                        0624 01780000
         SLR   @00,@12                                             0624 01781000
         STH   @00,FDISP(,@14)                                     0624 01782000
*   RSTRTDSP=RSTRTDSP-CCWCNT;       /* DECR RSTRT DISP               */ 01783000
         LCR   @12,@12                                             0625 01784000
         L     @00,RSTRTDSP-1(,@14)                                0625 01785000
         ICM   @00,8,@CB00242                                      0625 01786000
         ALR   @12,@00                                             0625 01787000
         STCM  @12,7,RSTRTDSP(@14)                                 0625 01788000
*   CCWRG=CCWRG+CCWLNGTH;           /* POINT TO NXT CCW              */ 01789000
         AL    CCWRG,@CF00073                                      0626 01790000
*   IF TICBITS^='1000'B             /* IS IT A TIC?                  */ 01791000
*     THEN                                                         0627 01792000
         TM    TICBITS(CCWRG),B'00001000'                          0627 01793000
         BNO   @RT00627                                            0627 01794000
         TM    TICBITS(CCWRG),B'00000111'                          0627 01795000
         BNZ   @RT00627                                            0627 01796000
*     ;                             /* NO                            */ 01797000
*   ELSE                                                           0629 01798000
*     DO;                           /* YES, PICK UP ITS ARG          */ 01799000
*       CCWRG=CCWDATA;              /* PICK UP ARG                   */ 01800000
         L     @14,CCWDATA-1(,CCWRG)                               0630 01801000
         LA    @14,0(,@14)                                         0630 01802000
         LR    CCWRG,@14                                           0630 01803000
*       CALLRG=ADDR(IEAPTRV);       /* REAL/VIRT XLATE RTN           */ 01804000
         L     CALLRG,@CV00033                                     0631 01805000
*       GEN;                                                       0632 01806000
         LR    @12,@01             SAVE IOSB REG ACROSS XLATE           01807000
         LR    @01,CCWRG           REAL ADDR                            01808000
         BALR  @14,@15             GOTO  XLATE RTN                      01809000
         LR    CCWRG,@01           VIRTUAL ADDR                         01810000
         LR    @01,@12             RESTORE IOSB REG                     01811000
         L     BASEREG2,NEWBASE    RESTORE BASE REG 2      @ZA15984     01812000
*     END;                                                         0633 01813000
*   IF WKRG3=0                      /* LOOP CNT ZERO?                */ 01814000
*     THEN                                                         0634 01815000
@RT00627 LTR   WKRG3,WKRG3                                         0634 01816000
         BZ    @RT00634                                            0634 01817000
*     GOTO MERWCK2;                 /* YES, SKIP ECC                 */ 01818000
*   ELSE                                                           0636 01819000
*     GOTO ECFLOOP1;                /* NO, CONTINUE ECC              */ 01820000
         B     ECFLOOP1                                            0636 01821000
*   RFY                                                            0637 01822000
*    (WKRG1,                                                       0637 01823000
*     WKRG2,                                                       0637 01824000
*     WKRG3,                                                       0637 01825000
*     CALLRG,                                                      0637 01826000
*     CCWRG1) UNRSTD;                                              0637 01827000
*LENCK1:                                                           0638 01828000
*   IF CULGTH='1'B&RSTRTDSP=CCWCNT  /* CHAN TRUNC?                   */ 01829000
*     THEN                                                         0638 01830000
LENCK1   TM    CULGTH+32(EWAPTR),B'00000001'                       0638 01831000
         BNO   @RF00638                                            0638 01832000
         LH    @12,CCWCNT(,CCWRG)                                  0638 01833000
         N     @12,@CF00055                                        0638 01834000
         L     @11,RSTRTDSP+151(,EWAPTR)                           0638 01835000
         LA    @11,0(,@11)                                         0638 01836000
         CR    @12,@11                                             0638 01837000
         BNE   @RF00638                                            0638 01838000
*     DO;                           /* YES, EQUIP CHK                */ 01839000
*       EWDEQU='1'B;                /* SET EQUIP CHK                 */ 01840000
         OI    EWDEQU(EWAPTR),B'00010000'                          0640 01841000
*       GOTO RTY10;                 /* GOTO EQUIP CHK CODE           */ 01842000
         B     RTY10                                               0641 01843000
*     END;                                                         0642 01844000
*   ELSE                                                           0643 01845000
*     ;                             /* NO, CONTINUE                  */ 01846000
@RF00638 DS    0H                                                  0644 01847000
*   IOSCSWRC=IOSCSWRC&&IOSCSWRC;    /* CLEAR RESID CNT               */ 01848000
         LH    @12,IOSCSWRC(,IOSBRG)                               0644 01849000
         N     @12,@CF00055                                        0644 01850000
         LR    @11,@12                                             0644 01851000
         XR    @11,@12                                             0644 01852000
         STH   @11,IOSCSWRC(,IOSBRG)                               0644 01853000
*   IF RSTRTDSP=CCWCNT              /* POSSIBLE INC LGTH?            */ 01854000
*     THEN                                                         0645 01855000
         L     @12,RSTRTDSP+151(,EWAPTR)                           0645 01856000
         LA    @12,0(,@12)                                         0645 01857000
         LH    @11,CCWCNT(,CCWRG)                                  0645 01858000
         N     @11,@CF00055                                        0645 01859000
         CR    @12,@11                                             0645 01860000
         BE    @RT00645                                            0645 01861000
*     GOTO MASKCK;                  /* NO, SKIP                      */ 01862000
*   ELSE                                                           0647 01863000
*     ;                             /* YES, CONTINUE                 */ 01864000
*   IF CCWCNT-RSTRTDSP<0            /* NEG RESID?                    */ 01865000
*     THEN                                                         0648 01866000
         SLR   @11,@12                                             0648 01867000
         LTR   @11,@11                                             0648 01868000
         BM    @RT00648                                            0648 01869000
*     GOTO SLICK;                   /* YES, CHK SLI BIT              */ 01870000
*   ELSE                                                           0650 01871000
*     ;                             /* NO                            */ 01872000
*   IOSCSWRC=CCWCNT-RSTRTDSP;       /* STORE RESID                   */ 01873000
         STH   @11,IOSCSWRC(,IOSBRG)                               0651 01874000
*   IF EWDOFLO='1'B                 /* OVERFLOW?                     */ 01875000
*     THEN                                                         0652 01876000
         TM    EWDOFLO(EWAPTR),B'00000001'                         0652 01877000
         BO    @RT00652                                            0652 01878000
*     GOTO MASKCK;                  /* YES, SKIP SLI CHK             */ 01879000
*   ELSE                                                           0654 01880000
*     ;                             /* NO                            */ 01881000
*SLICK:                                                            0655 01882000
*   IF SLIBIT='1'B                  /* SUPP INC LGTH?                */ 01883000
*     THEN                                                         0655 01884000
SLICK    TM    SLIBIT(CCWRG),B'00100000'                           0655 01885000
         BO    @RT00655                                            0655 01886000
*     GOTO MASKCK;                  /* YES CONTINUE                  */ 01887000
*   ELSE                                                           0657 01888000
*     ;                             /* NO                            */ 01889000
*   IOSTATUS='0C40'X;               /* SET CE, DE, INC LGTH          */ 01890000
         MVC   IOSTATUS(2,IOSBRG),@CB01943                         0658 01891000
*CSWINCR:                                                          0659 01892000
*   CCWRG=CCWRG+CCWLNGTH;           /* POINT TO ERRCCW + 8           */ 01893000
CSWINCR  AL    CCWRG,@CF00073                                      0659 01894000
*   IOSCSWCA=CCWRG;                 /* POINT AT ERR CCW              */ 01895000
         STCM  CCWRG,7,IOSCSWCA(IOSBRG)                            0660 01896000
*   GOTO ERSOFT;                    /* EXIT TO CE APP                */ 01897000
*                                                                  0661 01898000
         B     ERSOFT                                              0661 01899000
*   /*****************************************************************/ 01900000
*   /*                                                               */ 01901000
*   /* CHECK FOR NO RESTART INDICATORS                               */ 01902000
*   /*                                                               */ 01903000
*   /*****************************************************************/ 01904000
*                                                                  0662 01905000
*MASKCK:                                                           0662 01906000
*   IF MSKNORST='1'B&IOSSMDB='1'B THEN                             0662 01907000
MASKCK   TM    MSKNORST+88(IOSBRG),B'00000001'                     0662 01908000
         BNO   @RF00662                                            0662 01909000
         TM    IOSSMDB(IOSBRG),B'00001000'                         0662 01910000
         BNO   @RF00662                                            0662 01911000
*     DO;                           /* YES, SET PCI CODE & EXIT      */ 01912000
*       IOSCOD=IOSFTCHC;            /* SET PCI CODE IN IOSB          */ 01913000
         MVI   IOSCOD(IOSBRG),X'71'                                0664 01914000
*       DAFLG2=0;                   /* CLEAR ERP FLAGS               */ 01915000
         MVI   DAFLG2+6(EWAPTR),X'00'                              0665 01916000
*       IOSERR='0'B;                /* ERP IN CONTROL                */ 01917000
*       IOSEX='0'B;                 /* EXCEPTION BIT                 */ 01918000
         NI    IOSERR(IOSBRG),B'11011011'                          0667 01919000
*       IOSLOG='0'B;                /* FLAGS                         */ 01920000
         NI    IOSLOG(IOSBRG),B'11111110'                          0668 01921000
*       GEN;                                                       0669 01922000
*                                          /*                           01923000
                 BAL   @14,RESTORE         RESTORE IOSCKEY-OPT-RST      01924000
*       GEN;                                                       0670 01925000
         LM    @02,@06,0(@13)      RESTORE REGS                         01926000
         B     4(@06)             EXIT                                  01927000
*     END;                                                         0671 01928000
*   ELSE                                                           0672 01929000
*     ;                             /* NO, CONTINUE                  */ 01930000
@RF00662 DS    0H                                                  0673 01931000
*   IOSSKH2=RSTHD&'1F'X;            /* SET HD FROM SENSE             */ 01932000
         LA    @12,31                                              0673 01933000
         SLR   @11,@11                                             0673 01934000
         IC    @11,RSTHD+32(,EWAPTR)                               0673 01935000
         NR    @12,@11                                             0673 01936000
         STC   @12,IOSSKH2(,IOSBRG)                                0673 01937000
*   IF EWDTCC='1'B                  /* TCC?                          */ 01938000
*     THEN                                                         0674 01939000
         TM    EWDTCC(EWAPTR),B'00000010'                          0674 01940000
         BO    @RT00674                                            0674 01941000
*     GOTO ERTCC;                   /* YES, GOTO TCC CODE            */ 01942000
*   ELSE                                                           0676 01943000
*     ;                             /* NO                            */ 01944000
*   IF EWDOFLO='1'B                 /* OVERFLOW?                     */ 01945000
*     THEN                                                         0677 01946000
         TM    EWDOFLO(EWAPTR),B'00000001'                         0677 01947000
         BNO   @RF00677                                            0677 01948000
*     IF EWDCORR='1'B               /* YES, IS CORR ALSO ON?         */ 01949000
*       THEN                                                       0678 01950000
         TM    EWDCORR(EWAPTR),B'01000000'                         0678 01951000
         BNO   @RF00678                                            0678 01952000
*       DO;                         /* YES, UPDATE SEEK ADDR         */ 01953000
*         GEN;                                                     0680 01954000
         BAL   @14,SKUPDAT         UPDATE SEEK ADDR                     01955000
*         GOTO EROFLOA;             /* OVERFLOW - OP INCOMPLETE      */ 01956000
         B     EROFLOA                                             0681 01957000
*       END;                                                       0682 01958000
*     ELSE                                                         0683 01959000
*       GOTO EROFLOA;               /* NO, SKIP SKA UPDATE           */ 01960000
*   ELSE                                                           0684 01961000
*     ;                             /* NO                            */ 01962000
@RF00677 DS    0H                                                  0685 01963000
*   RFY                                                            0685 01964000
*    (WKRG1,                                                       0685 01965000
*     WKRG3,                                                       0685 01966000
*     CCWRG1,                                                      0685 01967000
*     CALLRG) RSTD;                 /*                               */ 01968000
*   IF CCWOP^='5E'X                 /* RD-M-CKD ?            @ZA19708*/ 01969000
*     THEN                                                         0686 01970000
         CLI   CCWOP(CCWRG),X'5E'                                  0686 01971000
         BNE   @RT00686                                            0686 01972000
*     GOTO NOFTR;                   /* NO, HANDLE NORMALLY   @ZM41657*/ 01973000
*   ELSE                                                           0688 01974000
*     ;                             /* YES, RESTART CCW CHN  @ZM41657   01975000
*                                      FOR COR D.C.          @ZM41657*/ 01976000
*                                                                  0688 01977000
*   /*****************************************************************/ 01978000
*   /*                                                               */ 01979000
*   /* IF ERR IN RESTART CCW THEN SET IOSRST TO POINT TO ERP CCW AND */ 01980000
*   /* SKIP CPBLD                                            @ZA19708*/ 01981000
*   /*                                                               */ 01982000
*   /*****************************************************************/ 01983000
*                                                                  0689 01984000
*   IF CCWRG=ADDR(FTRCCW) THEN                                     0689 01985000
         LA    @14,104                                             0689 01986000
         ALR   @14,EWAPTR                                          0689 01987000
         CR    CCWRG,@14                                           0689 01988000
         BNE   @RF00689                                            0689 01989000
*     DO;                                                          0690 01990000
*       WKRG1=ADDR(EWDCCW1);                                       0691 01991000
         LA    WKRG1,EWDCCW1(,EWAPTR)                              0691 01992000
*       GEN;                                                       0692 01993000
            LRA  WKRG1,0(WKRG1)                                         01994000
*       IOSRST=WKRG1;                                              0693 01995000
         ST    WKRG1,IOSRST(,IOSBRG)                               0693 01996000
*       GOTO FTRCALC;                                              0694 01997000
         B     FTRCALC                                             0694 01998000
*     END;                                                         0695 01999000
*   CCWRG1=ADDR(DACP5);             /* PT TO RESTART CCWS    @ZA19708*/ 02000000
@RF00689 LA    CCWRG1,DACP5                                        0696 02001000
*   EWDCCW6(1:5)=EWDASNS(9:13);     /* SAVE CCHHR IN EWD     @ZA10564*/ 02002000
         MVC   EWDCCW6(5,EWAPTR),EWDASNS+8(EWAPTR)                 0697 02003000
*   GEN;                                                           0698 02004000
*                                  /*                                   02005000
         BAL   @14,CPBLD           BLD CHAN PGM                         02006000
*   FTROP='5E'X;                    /* SET FTR OP CODE       @ZA19708*/ 02007000
         LA    @14,104                                             0699 02008000
         ALR   @14,EWAPTR                                          0699 02009000
         MVI   FTROP(@14),X'5E'                                    0699 02010000
*   FTRFLG=CCWFLG;                  /* SET USER FLAGS        @ZA19708*/ 02011000
         MVC   FTRFLG(1,@14),CCWFLG(CCWRG)                         0700 02012000
*   IF DCHNBIT='0'B&CCHNBIT='0'B    /* CHAINING?             @ZA25984*/ 02013000
*     THEN                          /*                       @ZA25984*/ 02014000
         TM    DCHNBIT(CCWRG),B'11000000'                          0701 02015000
         BNZ   @RF00701                                            0701 02016000
*     IF CCWRG^=ADDR(FTRCCW)        /* CCW IN ERP AREA?      @ZA25984*/ 02017000
*       THEN                        /*                       @ZA25984*/ 02018000
         CR    CCWRG,@14                                           0702 02019000
         BE    @RF00702                                            0702 02020000
*       EWDCCW5(1:3)=IOSCSWCA;      /* SAVE CSW              @ZA25984*/ 02021000
         MVC   EWDCCW5(3,EWAPTR),IOSCSWCA(IOSBRG)                  0703 02022000
*     ELSE                                                         0704 02023000
*       ;                                                          0704 02024000
@RF00702 DS    0H                                                  0705 02025000
*   ELSE                                                           0705 02026000
*     DO;                                                          0705 02027000
         B     @RC00701                                            0705 02028000
@RF00701 DS    0H                                                  0706 02029000
*       CCWRG1=CCWRG+CCWLNGTH;                                     0706 02030000
         LA    CCWRG1,8                                            0706 02031000
         ALR   CCWRG1,CCWRG                                        0706 02032000
*       GEN;                                                       0707 02033000
*                                  /*                                   02034000
         BAL   @14,TICBLD          BLD TIC TO USER                      02035000
*     END;                                                         0708 02036000
*   FTRDATA=CCWDATA;                /* POINT TO BFR OR IDAL  @ZA19708*/ 02037000
*                                                                  0709 02038000
@RC00701 MVC   FTRDATA+104(3,EWAPTR),CCWDATA(CCWRG)                0709 02039000
*   /*****************************************************************/ 02040000
*   /*                                                               */ 02041000
*   /* IF ERROR CCW USING IDAL, OBTAIN CORE AND COPY ERR CCW IDAL    */ 02042000
*   /*                                                       @ZM41657*/ 02043000
*   /*                                                               */ 02044000
*   /*****************************************************************/ 02045000
*                                                                  0710 02046000
*   IF IDABIT='1'B                  /*                       @ZM41657*/ 02047000
*     THEN                          /* IDAL                  @ZM41657*/ 02048000
         TM    IDABIT(CCWRG),B'00000100'                           0710 02049000
         BNO   @RF00710                                            0710 02050000
*     DO;                           /*                       @ZM41657*/ 02051000
*       GEN;                                                       0712 02052000
*                                      /*                               02053000
             BAL   @14,GETBLOK         GET A 160 BYTE BLOCK OF CORE     02054000
*       WKRG1=CCWDATA;              /* POINT AT USER IDAL    @ZM41657*/ 02055000
         L     WKRG1,CCWDATA-1(,CCWRG)                             0713 02056000
         LA    WKRG1,0(,WKRG1)                                     0713 02057000
*       GEN;                                                       0714 02058000
*                                  /*                       @ZM41657 */ 02059000
         LRA   WKRG3,0(WKRG3)      REAL ADDR OF ERP IDAL    @ZM41657    02060000
         STNSM MASKBYTE,X'FB'      DAT OFF                  @ZM41657    02061000
*       ERPIDAL=USERIDAL;           /* COPY USER IDAL        @ZM41657*/ 02062000
         MVC   ERPIDAL+4(156,WKRG3),USERIDAL(WKRG1)                0715 02063000
*       GEN;                                                       0716 02064000
*                                  /*                       @ZM41657 */ 02065000
         STOSM MASKBYTE,X'04'      DAT ON                   @ZM41657    02066000
*       FTRDATA=WKRG3+WORDSIZE;     /* PUT IDAL ADDR IN CCW  @ZA19708*/ 02067000
         LA    @14,4                                               0717 02068000
         ALR   @14,WKRG3                                           0717 02069000
         STCM  @14,7,FTRDATA+104(EWAPTR)                           0717 02070000
*     END;                          /*                       @ZM41657*/ 02071000
*   ELSE                                                           0719 02072000
*     ;                             /* NO IDAL               @ZM41657*/ 02073000
@RF00710 DS    0H                                                  0720 02074000
*FTRCALC:                                                          0720 02075000
*   ;                               /* FIND RESTART LOCATION @ZA19708*/ 02076000
FTRCALC  DS    0H                                                  0721 02077000
*   FDISP=CCWCNT-IOSCSWRC;          /* DISP TO RESTART       @ZA19708*/ 02078000
         LH    @14,CCWCNT(,CCWRG)                                  0721 02079000
         N     @14,@CF00055                                        0721 02080000
         LH    @12,IOSCSWRC(,IOSBRG)                               0721 02081000
         N     @12,@CF00055                                        0721 02082000
         SLR   @14,@12                                             0721 02083000
         STH   @14,FDISP+152(,EWAPTR)                              0721 02084000
*   WKRG1=ADDR(FTRCCW);             /* POINT TO ERP FTR CCW  @ZA19708*/ 02085000
         LA    WKRG1,104                                           0722 02086000
         ALR   WKRG1,EWAPTR                                        0722 02087000
*   IF IDABIT='1'B                  /*                       @ZM41657*/ 02088000
*     THEN                          /* IDAL                  @ZM41657*/ 02089000
         TM    IDABIT(CCWRG),B'00000100'                           0723 02090000
         BNO   @RF00723                                            0723 02091000
*     DO;                           /*                       @ZM41657*/ 02092000
*       GEN;                                                       0725 02093000
*                                  /*                       @ZM41657 */ 02094000
         BAL   RTRNRG,ADRCALC      CALC IDAW ADDR AND DISP  @ZM41657    02095000
*       FTRDATA=WKRG1;              /* POINT TO CORRECT IDA  @ZA19708*/ 02096000
         STCM  WKRG1,7,FTRDATA+104(EWAPTR)                         0726 02097000
*       RFY                                                        0727 02098000
*         WKRG12 RSTD;              /*                       @ZM41657*/ 02099000
*       CALLRG=ADDR(IEAPTRV);       /* REAL-VIRTUAL XLATE    @ZM41657*/ 02100000
         L     CALLRG,@CV00033                                     0728 02101000
*       GEN;                                                       0729 02102000
*                                  /*                       @ZM41657 */ 02103000
         LR    WKRG12,IOSBRG       SAVE IOSB POINTER        @ZM41657    02104000
         LR    IOSBRG,WKRG1        REAL ADDRESS             @ZM41657    02105000
         BALR  RTRNRG,CALLRG       GO TO XLATE RTN          @ZM41657    02106000
         LR    WKRG1,IOSBRG        VIRTUAL ADDRESS          @ZM41657    02107000
         LR    IOSBRG,WKRG12       RESTORE IOSB POINTER     @ZM41657    02108000
         L     BASEREG2,NEWBASE    RESTORE BASE REG 2       @ZA15984    02109000
*       RFY                                                        0730 02110000
*         WKRG12 UNRSTD;            /*                       @ZM41657*/ 02111000
*     END;                          /*                       @ZM41657*/ 02112000
*   ELSE                                                           0732 02113000
*     ;                             /* NO IDAL               @ZM41657*/ 02114000
@RF00723 DS    0H                                                  0733 02115000
*   RFY                                                            0733 02116000
*    (WKRG1,                                                       0733 02117000
*     WKRG3,                                                       0733 02118000
*     CALLRG) UNRSTD;               /*                       @ZM41657*/ 02119000
*   RFY                                                            0734 02120000
*    (WKRG1,                                                       0734 02121000
*     CCWRG1) RSTD;                                                0734 02122000
*                                                                  0734 02123000
*   /*****************************************************************/ 02124000
*   /*                                                               */ 02125000
*   /* ADD FDISP TO ADDRESS POINTED TO BY WKRG1. WKRG1 POINTS TO     */ 02126000
*   /* EITHER THE ERP FTR CCW OR THE CORRECT IDAW            @ZM41657*/ 02127000
*   /*                                                               */ 02128000
*   /*****************************************************************/ 02129000
*                                                                  0735 02130000
*   WKRG1->CCWDATA=WKRG1->CCWDATA+FDISP;/* ADD FORWARD DISPLACEMENT     02131000
*                                                            @ZA19708*/ 02132000
         L     @12,CCWDATA-1(,WKRG1)                               0735 02133000
         LA    @12,0(,@12)                                         0735 02134000
         LH    @11,FDISP+152(,EWAPTR)                              0735 02135000
         N     @11,@CF00055                                        0735 02136000
         ALR   @12,@11                                             0735 02137000
         STCM  @12,7,CCWDATA(WKRG1)                                0735 02138000
*   IF IOSCSWRC=0                   /* RESIDUAL COUNT = 0?   @ZA19708*/ 02139000
*     THEN                                                         0736 02140000
         LH    @12,IOSCSWRC(,IOSBRG)                               0736 02141000
         N     @12,@CF00055                                        0736 02142000
         LTR   @12,@12                                             0736 02143000
         BNZ   @RF00736                                            0736 02144000
*     DO;                           /* YES, FORCE CNT = 1    @ZA19708*/ 02145000
*       FTRCNT=1;                   /*                       @ZA19708*/ 02146000
         LA    @12,104                                             0738 02147000
         ALR   @12,EWAPTR                                          0738 02148000
         MVC   FTRCNT(2,@12),@CH00081                              0738 02149000
*       FTRSKP='1'B;                /*                       @ZA19708*/ 02150000
         OI    FTRSKP(@12),B'00010000'                             0739 02151000
*     END;                          /*                       @ZA19708*/ 02152000
*   ELSE                            /* RESIDUAL COUNT NOT 0  @ZA19708*/ 02153000
*     FTRCNT=IOSCSWRC;              /* USID RESID CNT AS IS  @ZA19708*/ 02154000
         B     @RC00736                                            0741 02155000
@RF00736 LH    @12,IOSCSWRC(,IOSBRG)                               0741 02156000
         N     @12,@CF00055                                        0741 02157000
         STH   @12,FTRCNT+104(,EWAPTR)                             0741 02158000
*   GOTO RESTART;                   /* RESTART DATA XFER     @ZM41657*/ 02159000
         B     RESTART                                             0742 02160000
*   RFY                                                            0743 02161000
*    (WKRG1,                                                       0743 02162000
*     CCWRG1) UNRSTD;                                              0743 02163000
*NOFTR:                             /*                       @ZM41657*/ 02164000
*   IF CCHNBIT='0'B                 /* CMD CHAINING?                 */ 02165000
*     THEN                                                         0744 02166000
NOFTR    TM    CCHNBIT(CCWRG),B'01000000'                          0744 02167000
         BNZ   @RF00744                                            0744 02168000
*     DO;                           /* NO, SET CMPLET CD & XIT       */ 02169000
*       IOSTSA='0C'X;               /* SET CE, DE IN CSW             */ 02170000
         MVI   IOSTSA(IOSBRG),X'0C'                                0746 02171000
*       GOTO CSWINCR;               /* SET FOR EXIT                  */ 02172000
         B     CSWINCR                                             0747 02173000
*     END;                                                         0748 02174000
*   ELSE                                                           0749 02175000
*     ;                             /* YES, SET UP RESTART           */ 02176000
@RF00744 DS    0H                                                  0750 02177000
*   CCWRG=CCWRG+CCWLNGTH;           /* POINT AT NXT CCW              */ 02178000
         AL    CCWRG,@CF00073                                      0750 02179000
*   IF TICBITS^='1000'B             /* IS IT A TIC?                  */ 02180000
*     THEN                                                         0751 02181000
         TM    TICBITS(CCWRG),B'00001000'                          0751 02182000
         BNO   @RT00751                                            0751 02183000
         TM    TICBITS(CCWRG),B'00000111'                          0751 02184000
         BNZ   @RT00751                                            0751 02185000
*     ;                             /* NO, SKIP ARG LOAD             */ 02186000
*   ELSE                                                           0753 02187000
*     DO;                           /* YES, PICK UP ITS ARG          */ 02188000
*       CCWRG=CCWDATA;              /* PICK UP ARG                   */ 02189000
         L     @12,CCWDATA-1(,CCWRG)                               0754 02190000
         LA    @12,0(,@12)                                         0754 02191000
         LR    CCWRG,@12                                           0754 02192000
*       CALLRG=ADDR(IEAPTRV);       /* REAL/VIRT XLATE RTN           */ 02193000
         L     CALLRG,@CV00033                                     0755 02194000
*       GEN;                                                       0756 02195000
         LR    @12,@01             SAVE IOSB REG ACROSS XLATE           02196000
         LR    @01,CCWRG           REAL ADDR                            02197000
         BALR  @14,@15             GOTO  XLATE RTN                      02198000
         LR    CCWRG,@01           VIRTUAL ADDR                         02199000
         LR    @01,@12             RESTORE IOSB REG                     02200000
         L     BASEREG2,NEWBASE    RESTORE BASE REG 2        @ZA15984   02201000
*     END;                                                         0757 02202000
*   RFY                                                            0758 02203000
*    (WKRG1,                                                       0758 02204000
*     CCWRG1) RSTD;                                                0758 02205000
@RT00751 DS    0H                                                  0759 02206000
*   CCWRG1=ADDR(DACP5);             /* PT AT PROTOTYPE CH PGM        */ 02207000
         LA    CCWRG1,DACP5                                        0759 02208000
*   EWDCCW6(1:5)=EWDASNS(9:13);     /* SAVE CCHHR IN EWD     @ZA10564*/ 02209000
         MVC   EWDCCW6(5,EWAPTR),EWDASNS+8(EWAPTR)                 0760 02210000
*   GEN;                                                           0761 02211000
*                                  /*                                   02212000
         BAL   @14,CPBLD           BLD CHAN PGM                         02213000
*   IF MTOP='1'B THEN               /* TEST IF USER DOING MT @ZA15056*/ 02214000
         TM    MTOP(CCWRG),B'10000000'                             0762 02215000
         BNO   @RF00762                                            0762 02216000
*     GEN;                                                         0763 02217000
            OI    0(WKRG1),X'80'      OR ON MT BIT           @ZA15056   02218000
*   ELSE                                                           0764 02219000
*     ;                                                            0764 02220000
*                                                                  0764 02221000
@RF00762 DS    0H                                                  0765 02222000
*   /*****************************************************************/ 02223000
*   /*                                                               */ 02224000
*   /* TEST FOR COUNT, RD SECTOR, NO-OP                      @ZA14702*/ 02225000
*   /*                                                       @ZA14703*/ 02226000
*   /* AND SEEK OPS                                          @ZA27345*/ 02227000
*   /*                                                               */ 02228000
*   /*****************************************************************/ 02229000
*                                                                  0765 02230000
*   IF CNTOP='1'B|SCHOPA='1'B|SEEKOP='11'B/*                 @ZA27345*/ 02231000
*     THEN                                                         0765 02232000
         TM    CNTOP(CCWRG),B'00110000'                            0765 02233000
         BNZ   @RT00765                                            0765 02234000
         TM    SEEKOP(CCWRG),B'00000011'                           0765 02235000
         BNO   @RF00765                                            0765 02236000
@RT00765 DS    0H                                                  0766 02237000
*     WKRG1=WKRG1-CCWLNGTH;         /* YES, BK UP OVER RD CNT        */ 02238000
         SL    WKRG1,@CF00073                                      0766 02239000
*   ELSE                                                           0767 02240000
*     ;                             /* NO, LEAVE RD CNT IN CP        */ 02241000
@RF00765 DS    0H                                                  0768 02242000
*   CCWRG1=CCWRG;                   /* CCW PTR                       */ 02243000
         LR    CCWRG1,CCWRG                                        0768 02244000
*   GEN;                                                           0769 02245000
*                                  /*                                   02246000
         BAL   @14,TICBLD          BLD TIC TO USER                      02247000
*   GOTO RESTART;                   /* GO START CP                   */ 02248000
         B     RESTART                                             0770 02249000
*   RFY                                                            0771 02250000
*    (CCWRG1,                                                      0771 02251000
*     WKRG1) UNRSTD;                                               0771 02252000
*                                                                  0771 02253000
*   /*****************************************************************/ 02254000
*   /*                                                               */ 02255000
*   /* CHANNEL PROGRAM BUILD SUBROUTINE INPUT - CCWRG1 POINTS TO A   */ 02256000
*   /* PROTOTYPE CCW STRING OUTPUT - CCW STRING BEGINNING AT DACCW1 +*/ 02257000
*   /* THE POSITION OFFSET SPECIFIED IN THE FIRST CCW. THE LENGTH OF */ 02258000
*   /* THE STRING IS DETER- MINED BY THE LENGTH OF THE INPUT STRING. */ 02259000
*   /* WKRG1 POINTS TO THE LAST CCW BUILT. CCWRG1 IS LOADED FROM     */ 02260000
*   /* CCWRG                                                         */ 02261000
*   /*                                                               */ 02262000
*   /*****************************************************************/ 02263000
*                                                                  0772 02264000
*   RFY                                                            0772 02265000
*    (WKRG1,                                                       0772 02266000
*     WKRG2,                                                       0772 02267000
*     WKRG3,                                                       0772 02268000
*     CCWRG1) RSTD;                                                0772 02269000
*CPBLD:                                                            0773 02270000
*   IF IOSBYP='1'B                  /* BYPASS IOS SEEK       @ZA15059*/ 02271000
*     THEN                          /* YES                           */ 02272000
CPBLD    TM    IOSBYP(IOSBRG),B'10000000'                          0773 02273000
         BNO   @RF00773                                            0773 02274000
*     IF ERPRDLOG='0'B&ERPRECAL='0'B/* ERP RECAL OR RDLOG            */ 02275000
*       THEN                                                       0774 02276000
         TM    ERPRDLOG+6(EWAPTR),B'11000000'                      0774 02277000
         BZ    @RT00774                                            0774 02278000
*       GOTO RESTART;               /* NO, DONT BUILD ERP PGM      0775 02279000
*                                                            @ZA15059*/ 02280000
*     ELSE                                                         0776 02281000
*       ;                           /* YES, BUILD ERP PGM    @ZA15059*/ 02282000
@RF00774 DS    0H                                                  0777 02283000
*   ELSE                                                           0777 02284000
*     ;                                                            0777 02285000
@RF00773 DS    0H                                                  0778 02286000
*   ERPCP='1'B;                     /* IND ERP CH PGM                */ 02287000
         OI    ERPCP+6(EWAPTR),B'00010000'                         0778 02288000
*   EWDSAVS=IOSSNS;                 /* SAVE SNS & -                  */ 02289000
         MVC   EWDSAVS(2,EWAPTR),IOSSNS(IOSBRG)                    0779 02290000
*   EWDSAVC=IOSCSW;                 /* CSW                           */ 02291000
         MVC   EWDSAVC(7,EWAPTR),IOSCSW(IOSBRG)                    0780 02292000
*   WKRG1=ADDR(EWDCCW1)+CCWRG1->CPBLDPOS;/* FIRST CCW                */ 02293000
         LA    WKRG1,EWDCCW1(,EWAPTR)                              0781 02294000
         SLR   @12,@12                                             0781 02295000
         IC    @12,CPBLDPOS(,CCWRG1)                               0781 02296000
         ALR   WKRG1,@12                                           0781 02297000
*   GEN;                                                           0782 02298000
         LRA   WKRG3,0(WKRG1)      REAL ADDRESS                         02299000
*   IOSRST=WKRG3;                   /* POINT TO CH PGM START         */ 02300000
         ST    WKRG3,IOSRST(,IOSBRG)                               0783 02301000
*EXREGLD:                                                          0784 02302000
*   WKRG3=CCWRG1->CPBLDFLG;         /* PICK UP RELOCATE REG          */ 02303000
EXREGLD  SLR   WKRG3,WKRG3                                         0784 02304000
         IC    WKRG3,CPBLDFLG(,CCWRG1)                             0784 02305000
*   GEN;                                                           0785 02306000
         EX    WKRG3,LDREG         LOAD BASE REG                        02307000
         LRA   WKRG2,0(WKRG2)      REAL ADDRESS                         02308000
*   WKRG1->COPARG=                  /* SET OP AND CALC DATA-         */ 02309000
*       CCWRG1->COPARG+WKRG2;       /* ADDR                          */ 02310000
         LR    @12,WKRG2                                           0786 02311000
         AL    @12,COPARG(,CCWRG1)                                 0786 02312000
         ST    @12,COPARG(,WKRG1)                                  0786 02313000
*   WKRG1->CFLGLEN=                 /* SET FLGS AND LENGTH -         */ 02314000
*       CCWRG1->CFLGLEN;            /* FROM PROTOTYPE                */ 02315000
         L     @12,CFLGLEN(,CCWRG1)                                0787 02316000
         ST    @12,CFLGLEN(,WKRG1)                                 0787 02317000
*   WKRG1->CPBLDPOS=0;              /* CLEAR HIGH LENGTH BYTE        */ 02318000
         MVI   CPBLDPOS(WKRG1),X'00'                               0788 02319000
*   IF WKRG3<16                     /* END FLAG?                     */ 02320000
*     THEN                                                         0789 02321000
         C     WKRG3,@CF00052                                      0789 02322000
         BNL   @RF00789                                            0789 02323000
*     DO;                           /* NO, CONTINUE                  */ 02324000
*       CCWRG1=CCWRG1+CCWLNGTH;     /* INCR FROM & -                 */ 02325000
         LA    @12,8                                               0791 02326000
         ALR   CCWRG1,@12                                          0791 02327000
*       WKRG1=WKRG1+CCWLNGTH;       /* TO REGS                       */ 02328000
         ALR   WKRG1,@12                                           0792 02329000
*       GOTO EXREGLD;               /* NEXT CCW                      */ 02330000
         B     EXREGLD                                             0793 02331000
*     END;                                                         0794 02332000
*   ELSE                                                           0795 02333000
*     ;                             /* YES, EXIT                     */ 02334000
@RF00789 DS    0H                                                  0796 02335000
*   CCWRG1=CCWRG;                   /* LOAD REG FOR TICBLD           */ 02336000
         LR    CCWRG1,CCWRG                                        0796 02337000
*   GEN;                                                           0797 02338000
         BR    @14                 RETURN TO CALLER                     02339000
*                                                                       02340000
LDREG    LR    WKRG2,0             LOAD RELOCATE REG                    02341000
*   RFY                                                            0798 02342000
*    (WKRG2,                                                       0798 02343000
*     WKRG3) UNRSTD;                                               0798 02344000
*                                                                  0798 02345000
*   /*****************************************************************/ 02346000
*   /*                                                               */ 02347000
*   /* END OF CYLINDER - UPDATE SEEK ADDR CYL & BLD CP TO RESTART    */ 02348000
*   /* USER CHAIN                                                    */ 02349000
*   /*                                                               */ 02350000
*   /*****************************************************************/ 02351000
*                                                                  0799 02352000
*EREOC:                                                            0799 02353000
*   IOSSKH2='7F'X;                  /* FORCE HD HIGH                 */ 02354000
EREOC    MVI   IOSSKH2(IOSBRG),X'7F'                               0799 02355000
*UPDATSKA:                                                         0800 02356000
*   ;                                                              0800 02357000
UPDATSKA DS    0H                                                  0801 02358000
*   GEN;                                                           0801 02359000
         BAL   @14,SKUPDAT         UPDATE SEEK ADDR                     02360000
*   IF EWDOFLO='1'B                 /* OVERFLOW?                     */ 02361000
*     THEN                                                         0802 02362000
         TM    EWDOFLO(EWAPTR),B'00000001'                         0802 02363000
         BO    @RT00802                                            0802 02364000
*     GOTO EROFLOA;                 /* YES, TOO OFLO CODE            */ 02365000
*   ELSE                                                           0804 02366000
*     ;                             /* NO                            */ 02367000
*   RFY                                                            0805 02368000
*    (CCWRG1) RSTD;                                                0805 02369000
*OFLOCK2:                                                          0806 02370000
*   IF UCBENVRD='1'B                /* EXP SENSE DEV?                */ 02371000
*     THEN                                                         0806 02372000
OFLOCK2  TM    UCBENVRD(UCBRG),B'00001000'                         0806 02373000
         BNO   @RF00806                                            0806 02374000
*     DO;                           /* YES,                          */ 02375000
*       CCWRG1=ADDR(DACP1);         /* POINT AT CP                   */ 02376000
         LA    CCWRG1,DACP1                                        0808 02377000
*       GOTO BLDCP2;                /* GO BLD CP                     */ 02378000
         B     BLDCP2                                              0809 02379000
*     END;                                                         0810 02380000
*   ELSE                                                           0811 02381000
*     ;                             /* NO                            */ 02382000
@RF00806 DS    0H                                                  0812 02383000
*   IF ERPCYLSW='1'B                /* CYL SWITCH FLG?               */ 02384000
*     THEN                                                         0812 02385000
         TM    ERPCYLSW+6(EWAPTR),B'00000001'                      0812 02386000
         BNO   @RF00812                                            0812 02387000
*     CCWRG1=ADDR(DACP9);           /* SHA-TIC-RHA-TIC               */ 02388000
         LA    CCWRG1,DACP9                                        0813 02389000
*   ELSE                                                           0814 02390000
*     CCWRG1=ADDR(DACP2);           /* RHA-TIC                       */ 02391000
         B     @RC00812                                            0814 02392000
@RF00812 LA    CCWRG1,DACP2                                        0814 02393000
*BLDCP2:                                                           0815 02394000
*   ;                               /* BUILD CCW2                    */ 02395000
@RC00812 DS    0H                                                  0815 02396000
BLDCP2   DS    0H                                                  0816 02397000
*   GEN;                                                           0816 02398000
*                                  /*                                   02399000
         BAL   @14,CPBLD           BLD CHAN PGM                         02400000
*   CCWRG1=CCWRG;                   /* CCW PTR FOR TICBLD            */ 02401000
         LR    CCWRG1,CCWRG                                        0817 02402000
*   GEN;                                                           0818 02403000
*                                  /*                                   02404000
         BAL   @14,TICBLD          BLD TIC TO USER                      02405000
*   GOTO RESTART;                   /* START CP                      */ 02406000
         B     RESTART                                             0819 02407000
*   RFY                                                            0820 02408000
*    (CCWRG1) UNRSTD;                                              0820 02409000
*                                                                  0820 02410000
*   /*****************************************************************/ 02411000
*   /*                                                               */ 02412000
*   /* FILE PROTECT - UPDATE SEEK ADDR & BLD CP TO RESTART USER      */ 02413000
*   /* CHAIN.                                                        */ 02414000
*   /*                                                               */ 02415000
*   /*****************************************************************/ 02416000
*                                                                  0821 02417000
*ERFP:                                                             0821 02418000
*   IF CCWOP='07'X                  /* FULL SEEK?                    */ 02419000
*     THEN                                                         0821 02420000
ERFP     CLI   CCWOP(CCWRG),X'07'                                  0821 02421000
         BE    @RT00821                                            0821 02422000
*     GOTO ERHARD;                  /* YES, PERM ERR                 */ 02423000
*   ELSE                                                           0823 02424000
*     ;                             /* NO                            */ 02425000
*   IF CCWOP='0B'X                  /* CYL SEEK?                     */ 02426000
*     THEN                                                         0824 02427000
         CLI   CCWOP(CCWRG),X'0B'                                  0824 02428000
         BNE   @RF00824                                            0824 02429000
*     ERPCYLSW='1'B;                /* YES, IND CYL MVMNT            */ 02430000
         OI    ERPCYLSW+6(EWAPTR),B'00000001'                      0825 02431000
*   ELSE                                                           0826 02432000
*     IF CCWOP='1B'X                /* NO, CHK FOR HD SEEK           */ 02433000
*       THEN                                                       0826 02434000
         B     @RC00824                                            0826 02435000
@RF00824 CLI   CCWOP(CCWRG),X'1B'                                  0826 02436000
         BNE   @RF00826                                            0826 02437000
*       ;                           /* YES, FALL THRU                */ 02438000
*     ELSE                                                         0828 02439000
*       GOTO UPDATSKA;              /* NO, UPDATE SKA                */ 02440000
*   RFY                                                            0829 02441000
*    (CCWRG1) RSTD;                                                0829 02442000
@RC00824 DS    0H                                                  0830 02443000
*   CCWRG1=CCWDATA;                 /* POINT TO USER SEEK ARG        */ 02444000
         L     CCWRG1,CCWDATA-1(,CCWRG)                            0830 02445000
         LA    CCWRG1,0(,CCWRG1)                                   0830 02446000
*   GEN REFS(MASKBYTE);                                            0831 02447000
         LRA   WKRG1,0(IOSBRG)     REAL ADDRESS                         02448000
         STNSM MASKBYTE,X'FB'      DOWN WITH DAT                        02449000
*   WKRG1->IOSCCHH=DASKARG;         /* MOVE TO SEEK FIELD            */ 02450000
         MVC   IOSCCHH(4,WKRG1),DASKARG+2(CCWRG1)                  0832 02451000
*   GEN REFS(MASKBYTE);                                            0833 02452000
         STOSM MASKBYTE,X'04'      DAT ON                               02453000
         BAL   @14,XTNTCK          CHECK EXTENTS                        02454000
*   RFY                                                            0834 02455000
*    (CCWRG1) UNRSTD;                                              0834 02456000
*   CCWRG=CCWRG+CCWLNGTH;           /* PT BEYOND SK CYL/HD CCW       */ 02457000
         AL    CCWRG,@CF00073                                      0835 02458000
*   GOTO OFLOCK2;                   /* CHECK FOR OVERFLOW    @ZA08316*/ 02459000
*                                                                  0836 02460000
         B     OFLOCK2                                             0836 02461000
*   /*****************************************************************/ 02462000
*   /*                                                               */ 02463000
*   /* UNIT EXCEPTION - IF DURING ERP RHA, IGNORE. IF NOT FIRST      */ 02464000
*   /* ENTRY, EXIT TO CE APP. OTHERWISE, PERM ERR.                   */ 02465000
*   /*                                                               */ 02466000
*   /*****************************************************************/ 02467000
*                                                                  0837 02468000
*EREOF:                                                            0837 02469000
*   IF ERPRHA='1'B                  /* ERP RHA?                      */ 02470000
*     THEN                                                         0837 02471000
EREOF    TM    ERPRHA+6(EWAPTR),B'00100000'                        0837 02472000
         BO    @RT00837                                            0837 02473000
*     GOTO ERNOER;                  /* YES, IGNORE                   */ 02474000
*   ELSE                                                           0839 02475000
*     ;                                                            0839 02476000
*                                                                  0839 02477000
*   /*****************************************************************/ 02478000
*   /*                                                               */ 02479000
*   /* INCORRECT LENGTH - IF NOT FIRST ENTRY, EXIT TO CE APP.        */ 02480000
*   /* OTHERWISE, PERM ERR.                                          */ 02481000
*   /*                                                               */ 02482000
*   /*****************************************************************/ 02483000
*                                                                  0840 02484000
*ERLEN:                                                            0840 02485000
*   IF ERPREV='1'B                  /* PREVIOUS ENTRY?               */ 02486000
*     THEN                                                         0840 02487000
ERLEN    TM    ERPREV+6(EWAPTR),B'00000010'                        0840 02488000
         BO    @RT00840                                            0840 02489000
*     GOTO ERSOFT;                  /* YES, EXIT TO CE APP           */ 02490000
*   ELSE                                                           0842 02491000
*     GOTO ERHARD;                  /* NO, PERM ERR                  */ 02492000
*                                                                  0842 02493000
         B     ERHARD                                              0842 02494000
*   /*****************************************************************/ 02495000
*   /*                                                               */ 02496000
*   /* DEVICE TYPE CHECKING SUBROUTINE - TWO ENTRY PTS MERCK - CHECK */ 02497000
*   /* FOR MERLIN FAMILY DEVICES. MERWCK - CHECK FOR MERLIN FAMILY OR*/ 02498000
*   /* 3340 DEVICES                                                  */ 02499000
*   /*                                                               */ 02500000
*   /*****************************************************************/ 02501000
*                                                                  0843 02502000
*MERWCK:                                                           0843 02503000
*   IF UCBTBYT4='0A'X               /* 3340?                         */ 02504000
*     THEN                                                         0843 02505000
MERWCK   CLI   UCBTBYT4(UCBRG),X'0A'                               0843 02506000
         BE    @RT00843                                            0843 02507000
*     GOTO CKEXIT;                  /* YES, EXIT                     */ 02508000
*   ELSE                                                           0845 02509000
*     ;                                                            0845 02510000
*MERCK:                                                            0846 02511000
*   IF UCBTBYT4='09'X               /* 3330?                         */ 02512000
*     THEN                                                         0846 02513000
MERCK    CLI   UCBTBYT4(UCBRG),X'09'                               0846 02514000
         BE    @RT00846                                            0846 02515000
*     GOTO CKEXIT;                  /* YES, EXIT                     */ 02516000
*   ELSE                                                           0848 02517000
*     ;                                                            0848 02518000
*   IF UCBTBYT4='0D'X               /* 3330C?                        */ 02519000
*     THEN                                                         0849 02520000
         CLI   UCBTBYT4(UCBRG),X'0D'                               0849 02521000
         BE    @RT00849                                            0849 02522000
*     GOTO CKEXIT;                  /* YES - EXIT                    */ 02523000
*   ELSE                                                           0851 02524000
*     ;                                                            0851 02525000
*   IF UCBTBYT4='0B'X               /* 3350 ?                @Z30RSAG*/ 02526000
*     THEN                                                         0852 02527000
         CLI   UCBTBYT4(UCBRG),X'0B'                               0852 02528000
         BE    @RT00852                                            0852 02529000
*     GOTO CKEXIT;                  /* YES - EXIT            @Z30RSAG*/ 02530000
*   ELSE                                                           0854 02531000
*     ;                                                            0854 02532000
*CKEXIT:                                                           0855 02533000
*   ;                                                              0855 02534000
CKEXIT   DS    0H                                                  0856 02535000
*   GEN;                                                           0856 02536000
*                                                                  0856 02537000
         BR    @14                 RETURN TO CALLER                     02538000
*   /*****************************************************************/ 02539000
*   /*                                                               */ 02540000
*   /* INDIRECT ADDRESS WORD LOCATION SUBROUTINE - INPUT - WKRG1 =   */ 02541000
*   /* CCW ADDR FDISP = FWD DISP INTO IDAL OUTPUT - WKRG1 = IDAW ADDR*/ 02542000
*   /* (REAL) FDISP = FWD DISP INTO IDAW                             */ 02543000
*   /*                                                               */ 02544000
*   /*****************************************************************/ 02545000
*                                                                  0857 02546000
*   RFY                                                            0857 02547000
*    (WKRG1,                                                       0857 02548000
*     WKRG3,                                                       0857 02549000
*     CCWRG1,                                                      0857 02550000
*     CALLRG,                                                      0857 02551000
*     RTRNRG,                                                      0857 02552000
*     WKRG2) RSTD;                                                 0857 02553000
*ADRCALC:                                                          0858 02554000
*   WKRG1=WKRG1->CCWDATA;           /* POINT AT IDAW                 */ 02555000
ADRCALC  L     @12,CCWDATA-1(,WKRG1)                               0858 02556000
         LA    @12,0(,@12)                                         0858 02557000
         LR    WKRG1,@12                                           0858 02558000
*   GEN REFS(IDAWLEN);                                             0859 02559000
         SR    @12,@12             CLEAR                                02560000
         STNSM MASKBYTE,X'FB'      DAT OFF                              02561000
         ICM   @12,3,IDAWLEN(WKRG1) IDAW LENGTH                         02562000
         STOSM MASKBYTE,X'04'      DAT ON                               02563000
         LA    CALLRG,2047         MASK                                 02564000
         NR    @12,CALLRG          CLEAR ALL BUT LGTH BITS              02565000
         LA    CALLRG,2048         MAX LENGTH                           02566000
         SR    CALLRG,@12          EFECTIVE LENGTH OF IDAW              02567000
*   ECNT=CALLRG;                                                   0860 02568000
         LA    @12,152                                             0860 02569000
         ALR   @12,EWAPTR                                          0860 02570000
         STH   CALLRG,ECNT(,@12)                                   0860 02571000
*   CALLRG=FDISP;                   /* SAVE ORIGINAL FDISP   @ZA03158*/ 02572000
         LH    CALLRG,FDISP(,@12)                                  0861 02573000
         N     CALLRG,@CF00055                                     0861 02574000
*DISPCK:                                                           0862 02575000
*   IF FDISP<ECNT                   /* DISP IN THIS IDAW?            */ 02576000
*     THEN                                                         0862 02577000
DISPCK   LA    @12,152                                             0862 02578000
         ALR   @12,EWAPTR                                          0862 02579000
         CLC   FDISP(2,@12),ECNT(@12)                              0862 02580000
         BNL   @RF00862                                            0862 02581000
*     DO;                           /* YES, RETURN TO CALLER         */ 02582000
*       GEN;                                                       0864 02583000
         BR    @14                 RETURN TO CALLER                     02584000
*     END;                                                         0865 02585000
*   ELSE                                                           0866 02586000
*     ;                             /* NO                            */ 02587000
*                                                                  0866 02588000
@RF00862 DS    0H                                                  0867 02589000
*   /*****************************************************************/ 02590000
*   /*                                                               */ 02591000
*   /* CALCULATE FDISP BY SUBTRACTING ECNT                           */ 02592000
*   /*                                                               */ 02593000
*   /*****************************************************************/ 02594000
*                                                                  0867 02595000
*   GEN;                                                           0867 02596000
*                                                        /*@ZA25289*/   02597000
              LA    @12,152             LOCATE FDISP           @ZA25289 02598000
              ALR   @12,EWAPTR                                 @ZA25289 02599000
              LH    @00,FDISP(,@12)     LOAD FDISP             @ZA25289 02600000
              N     @00,FOXFOX          MASK OFF 2 HI BYTES    @ZA25289 02601000
              NC    FDISP(4,@12),FOXFOX CLEAR FDISP AREA       @ZA25289 02602000
              SL    @00,FDISP(,@12)     SUB CNT FROM FDISP     @ZA25289 02603000
              STH   @00,FDISP(,@12)     RESTORE NEW FDISP      @ZA25289 02604000
*   WKRG1=WKRG1+WORDSIZE;           /* POINT TO NXT IDAW             */ 02605000
         AL    WKRG1,@CF00088                                      0868 02606000
*   ECNT=IDAWSIZE;                  /* LEN = 2048 FOR ALL BUT FIRST  */ 02607000
         MVC   ECNT+152(2,EWAPTR),@CH00090                         0869 02608000
*   GOTO DISPCK;                    /* LOOP                          */ 02609000
         B     DISPCK                                              0870 02610000
*   RFY                                                            0871 02611000
*    (WKRG1,                                                       0871 02612000
*     WKRG3,                                                       0871 02613000
*     CCWRG1,                                                      0871 02614000
*     CALLRG) UNRSTD;                                              0871 02615000
*                                                                  0871 02616000
*   /*****************************************************************/ 02617000
*   /*                                                               */ 02618000
*   /* TIC BLD SUBROUTINE - BUILDS A TIC TO THE NEXT NON-TIC CCW IN  */ 02619000
*   /* USER CHAIN. INPUT - CCWRG1 POINTS TO THE USER CCW TO BE       */ 02620000
*   /* CONNECTED. WKRG1 POINTS TO THE LAST ERP CCW BUILT BY CPBLD.   */ 02621000
*   /*                                                               */ 02622000
*   /*****************************************************************/ 02623000
*                                                                  0872 02624000
*   RFY                                                            0872 02625000
*    (CCWRG1,                                                      0872 02626000
*     WKRG1,                                                       0872 02627000
*     WKRG3,                                                       0872 02628000
*     CALLRG) RSTD;                                                0872 02629000
*TICBLD:                                                           0873 02630000
*   WKRG1=WKRG1+CCWLNGTH;           /* POINT TO BLD AREA             */ 02631000
TICBLD   AL    WKRG1,@CF00073                                      0873 02632000
*   IF CCWRG1->TICBITS='1000'B      /* USER CCW A TIC?               */ 02633000
*     THEN                          /* YES USE TIC ARG               */ 02634000
         TM    TICBITS(CCWRG1),B'00001000'                         0874 02635000
         BNO   @RF00874                                            0874 02636000
         TM    TICBITS(CCWRG1),B'00000111'                         0874 02637000
         BNZ   @RF00874                                            0874 02638000
*     WKRG3=CCWRG1->CCWDATA;                                       0875 02639000
         L     WKRG3,CCWDATA-1(,CCWRG1)                            0875 02640000
         LA    WKRG3,0(,WKRG3)                                     0875 02641000
*   ELSE                                                           0876 02642000
*     DO;                           /* NO                            */ 02643000
         B     @RC00874                                            0876 02644000
@RF00874 DS    0H                                                  0877 02645000
*       GEN;                                                       0877 02646000
         LRA   WKRG3,0(CCWRG1)     REAL ADDRESS                         02647000
*     END;                                                         0878 02648000
*   WKRG1->COPARG=WKRG3;            /* SET TIC TO ADDR               */ 02649000
@RC00874 ST    WKRG3,COPARG(,WKRG1)                                0879 02650000
*   WKRG1->CCWOP='08'X;             /* SET TIC OP CODE               */ 02651000
         MVI   CCWOP(WKRG1),X'08'                                  0880 02652000
*   GEN;                                                           0881 02653000
*                                  /*                                   02654000
         BR    @14                 RETURN TO CALLER                     02655000
*   RFY                                                            0882 02656000
*    (CCWRG1,                                                      0882 02657000
*     WKRG1,                                                       0882 02658000
*     WKRG3,                                                       0882 02659000
*     CALLRG) UNRSTD;                                              0882 02660000
*                                                                  0882 02661000
*   /*****************************************************************/ 02662000
*   /*                                                               */ 02663000
*   /* SEEK ADDRESS UPDATE AND EXTENT CHECK SUBROUTINE - UPDATE      */ 02664000
*   /* IOSEEKA TO NEXT SEQUENTIAL TRACK AND CALL DRIVER EXTENT CHECK */ 02665000
*   /* ROUTINE.                                                      */ 02666000
*   /*                                                               */ 02667000
*   /*****************************************************************/ 02668000
*                                                                  0883 02669000
*   RFY                                                            0883 02670000
*    (WKRG1) RSTD;                                                 0883 02671000
*SKUPDAT:                                                          0884 02672000
*   WKRG1=CVTZDTAB;                 /* POINT AT DEV TBL              */ 02673000
SKUPDAT  L     @15,CVTPTR                                          0884 02674000
         L     WKRG1,CVTZDTAB(,@15)                                0884 02675000
*   WKRG1=WKRG1+DTABNDX(UCBTBYT4+1);/* PT AT DEV ENTRY               */ 02676000
         SLR   @15,@15                                             0885 02677000
         IC    @15,UCBTBYT4(,UCBRG)                                0885 02678000
         SLR   @12,@12                                             0885 02679000
         IC    @12,DTABNDX(@15,WKRG1)                              0885 02680000
         ALR   WKRG1,@12                                           0885 02681000
*   IOSSKHH=IOSSKHH+1;              /* INCR HD                       */ 02682000
         LA    @15,1                                               0886 02683000
         SLR   @12,@12                                             0886 02684000
         ICM   @12,3,IOSSKHH(IOSBRG)                               0886 02685000
         ALR   @12,@15                                             0886 02686000
         STCM  @12,3,IOSSKHH(IOSBRG)                               0886 02687000
*   IF IOSSKHH<DNOTKCYL             /* HEAD BEYOND LIMIT?            */ 02688000
*     THEN                                                         0887 02689000
         CLC   IOSSKHH(2,IOSBRG),DNOTKCYL(WKRG1)                   0887 02690000
         BL    @RT00887                                            0887 02691000
*     GOTO XTNTCK;                  /* NO, TO XTNT CHK RTN           */ 02692000
*   ELSE                                                           0889 02693000
*     ;                             /* YES, ZERO AND INCR CYL        */ 02694000
*   IOSSKHH=IOSSKHH&&IOSSKHH;       /* ZERO                          */ 02695000
         LR    @11,@12                                             0890 02696000
         XR    @11,@12                                             0890 02697000
         STCM  @11,3,IOSSKHH(IOSBRG)                               0890 02698000
*   IOSSKCC=IOSSKCC+1;              /* INCR CYL                      */ 02699000
         SLR   @12,@12                                             0891 02700000
         ICM   @12,3,IOSSKCC(IOSBRG)                               0891 02701000
         ALR   @15,@12                                             0891 02702000
         STCM  @15,3,IOSSKCC(IOSBRG)                               0891 02703000
*   RFY                                                            0892 02704000
*    (WKRG1) UNRSTD;                                               0892 02705000
*XTNTCK:                                                           0893 02706000
*   CALLRG=VOIEXTNT(IOSDVRID+1);    /* PT AT XTNT CK RTN             */ 02707000
XTNTCK   SLR   @12,@12                                             0893 02708000
         IC    @12,IOSDVRID(,IOSBRG)                               0893 02709000
         MH    @12,@CH02026                                        0893 02710000
         L     @11,CVTPTR                                          0893 02711000
         L     @11,CVTIXAVL(,@11)                                  0893 02712000
         L     @11,IOCVOID(,@11)                                   0893 02713000
         L     CALLRG,VOIEXTNT(@12,@11)                            0893 02714000
*   GEN;                                                           0894 02715000
*                                                                  0894 02716000
         LR    @06,@14             SAVE 14                              02717000
         BALR  @14,CALLRG          GOTO  XTNT CHK RTN                   02718000
         B     RSTBASE             OK, RTRN TO CALLER          @ZA15984 02719000
         MVI   EWAFLG3(EWAPTR),X'00'  CLEAR ERP FLAGS                   02720000
         NI    IOSERR(IOSBRG),X'DF'  CLEAR ERP IN CONTROL               02721000
         NI    IOSLOG(IOSBRG),X'FE'  CLEAR LOG CONTROL                  02722000
         LM    @02,@06,0(@13)      RESTORE REGS                         02723000
         B     12(@06)             EXIT                                 02724000
RSTBASE  LR    @14,@06             RESTORE 14                  @ZA15984 02725000
         L     BASEREG2,NEWBASE    SET UP SECOND BASE REG      @ZA15984 02726000
         BR    @14                 OK, RTRN TO CALLER          @ZA15984 02727000
*   /*****************************************************************/ 02728000
*   /*                                                               */ 02729000
*   /* GET BLOCK SUBROUTINE - CALL STORAGE MANAGER TO OBTAIN 1 OR 3  */ 02730000
*   /* 160 BYTE BLOCKS OF CORE, CHAIN BLOCK TO END OF CHAIN OFF EWA, */ 02731000
*   /* RETURN VIRTUAL ADDRESS OF FIRST BLOCK TO CALLER IN R11        */ 02732000
*   /* (WKRG3).                                                      */ 02733000
*   /*                                                               */ 02734000
*   /*****************************************************************/ 02735000
*                                                                  0895 02736000
*   RFY                                                            0895 02737000
*    (WKRG3) RSTD;                                                 0895 02738000
*GETBLOK3:                                                         0896 02739000
*   WKRG3='30000020'X;              /* IND 3 BLOCKS                  */ 02740000
GETBLOK3 L     WKRG3,@CF01989                                      0896 02741000
*   GOTO GETBLOKA;                  /* SKIP 1 BLOCK SETUP            */ 02742000
         B     GETBLOKA                                            0897 02743000
*GETBLOK:                                                          0898 02744000
*   WKRG3='10000020'X;              /* SET FOR 1 160 BYTE BLK        */ 02745000
GETBLOK  L     WKRG3,@CF01993                                      0898 02746000
*GETBLOKA:                                                         0899 02747000
*   CALLRG=ADDR(IECVSMGR);          /* STG MGR ENTRY POINT           */ 02748000
GETBLOKA L     CALLRG,@CV00032                                     0899 02749000
*   GEN REFS(IOSASID);                                             0900 02750000
*                                  /*                                   02751000
         ICM   WKRG3,6,IOSASID(IOSBRG)  PICK UP ASID                    02752000
         LM    @02,@06,0(@13)      SAVE ORIG REGS FRM STG MGR           02753000
         LR    @12,@14             SAVE RTRN REG                        02754000
         BALR  @14,CALLRG          GOTO  STG MGR                        02755000
         STM   @02,@06,0(@13)      SAVE ORIG REGS                       02756000
         LR    @14,@12             RSTR RTRN REG                        02757000
         L     BASEREG2,NEWBASE    SET UP SECOND BASE          @ZA15984 02758000
*   IF WKRG3->EWAEXT=0              /* THIS ONLY 1 BLOCK?            */ 02759000
*     THEN                                                         0901 02760000
         L     @15,EWAEXT(,WKRG3)                                  0901 02761000
         LTR   @15,@15                                             0901 02762000
         BNZ   @RF00901                                            0901 02763000
*     ;                             /* YES-FALL THRU         @VS30640*/ 02764000
*   ELSE                                                           0903 02765000
*     GOTO NOCHAIN;                 /* NO-DONT CHAIN IT      @VS30640*/ 02766000
*   RFY                                                            0904 02767000
*    (WKRG1) RSTD;                                                 0904 02768000
*   WKRG1=EWARG;                    /* CHAIN BASE                    */ 02769000
         LR    WKRG1,EWARG                                         0905 02770000
*ENDLOOP:                                                          0906 02771000
*   IF WKRG1->EWAEXT=0              /* END OF CHAIN?                 */ 02772000
*     THEN                                                         0906 02773000
ENDLOOP  L     @15,EWAEXT(,WKRG1)                                  0906 02774000
         LTR   @15,@15                                             0906 02775000
         BNZ   @RF00906                                            0906 02776000
*     WKRG1->EWAEXT=WKRG3;          /* YES, CHAIN NEW BLK            */ 02777000
         ST    WKRG3,EWAEXT(,WKRG1)                                0907 02778000
*   ELSE                                                           0908 02779000
*     DO;                           /* NO, LOOP                      */ 02780000
         B     @RC00906                                            0908 02781000
@RF00906 DS    0H                                                  0909 02782000
*       WKRG1=WKRG1->EWAEXT;        /* POINT TO NEXT                 */ 02783000
         L     WKRG1,EWAEXT(,WKRG1)                                0909 02784000
*       GOTO ENDLOOP;               /* LOOP TILL END OF CHAIN        */ 02785000
         B     ENDLOOP                                             0910 02786000
*     END;                                                         0911 02787000
*NOCHAIN:                                                          0912 02788000
*   ;                                                              0912 02789000
@RC00906 DS    0H                                                  0912 02790000
NOCHAIN  DS    0H                                                  0913 02791000
*   GEN;                                                           0913 02792000
         BR    @14                 RETURN TO CALLER                     02793000
*   RFY                                                            0914 02794000
*    (WKRG1,                                                       0914 02795000
*     WKRG3) UNRSTD;                                               0914 02796000
*                                                                  0914 02797000
*   /*****************************************************************/ 02798000
*   /*                                                               */ 02799000
*   /* SUBROUTINE TO RESTORE IOSCKEY, IOSOPTS, & IOSRST              */ 02800000
*   /*                                                               */ 02801000
*   /*****************************************************************/ 02802000
*                                                                  0915 02803000
*RESTORE:                                                          0915 02804000
*   IOSCKEY=EWDSAVKY;               /* RESTORE KEY                   */ 02805000
RESTORE  MVC   IOSCKEY(1,IOSBRG),EWDSAVKY(EWAPTR)                  0915 02806000
*   IOSOPT=EWDSAVOP;                /* RESTORE OPTS                  */ 02807000
         MVC   IOSOPT(1,IOSBRG),EWDSAVOP(EWAPTR)                   0916 02808000
*   GEN;                                                           0917 02809000
         TM IOSBYP(IOSBRG),B'10000000' /* BYPASS BIT ?      @ZA17978 */ 02810000
         BOR @14                      /* DONT RESTORE START @ZA17978 */ 02811000
*   RFY                                                            0918 02812000
*    (WKRG1) RSTD;                                                 0918 02813000
*   WKRG1=IOSVST;                   /* VIRT START ADDR               */ 02814000
         L     WKRG1,IOSVST(,IOSBRG)                               0919 02815000
*   GEN;                                                           0920 02816000
         LRA   WKRG1,0(WKRG1)      CONVERT TO REAL                      02817000
*   IOSRST=WKRG1;                   /* RESTORE REAL START ADDR       */ 02818000
         ST    WKRG1,IOSRST(,IOSBRG)                               0921 02819000
*   RFY                                                            0922 02820000
*    (WKRG1) UNRSTD;                                               0922 02821000
*   GEN;                                                           0923 02822000
         BR    @14                 RETURN TO CALLER                     02823000
*   GEN;                                                           0924 02824000
*                                  /*                       @ZA30284 */ 02825000
*********************************************************************** 02826000
* ENTRY - LOGSAVE - SAVE LOG INFO IF NONE PREVIOUSLY SAVED.   *         02827000
* IF A PREVIOUS LOG EXIST TEST IT AGAINST THE NEW DATA TO SEE IF IT   * 02828000
* SHOULD BE OVERLAID.                                                 * 02829000
*********************************************************************** 02830000
*           |         PREVIOUS DATA SAVED           |                 * 02831000
*           |***************************************|                 * 02832000
*           | FMT   | FMT   | UNIT  | ENV   | CORR  |                 * 02833000
*           |  3    |  6    | CHECK | LOG   | DATA  |                 * 02834000
*****************************************************                 * 02835000
*   | FMT 3 | NOLOG |   LOG |   LOG |   LOG |   LOG |                 * 02836000
*   |************************************************                 * 02837000
* N | FMT 6 | NOLOG | NOLOG |   LOG |   LOG |   LOG |                 * 02838000
*   |************************************************                 * 02839000
* E |UNIT CK| NOLOG | NOLOG | NOLOG |   LOG |   LOG |                 * 02840000
*   |************************************************                 * 02841000
* W |ENV LOG| NOLOG | NOLOG | NOLOG | NOLOG |   LOG |                 * 02842000
*   |************************************************                 * 02843000
*   |CORR DC| NOLOG | NOLOG | NOLOG | NOLOG | NOLOG |                 * 02844000
*********************************************************************** 02845000
*                                                                       02846000
*LOGSAVE:                                                          0925 02847000
*   IF IOSLOG='1'B|INTLOG='1'B      /* PREV DATA SAVED?      @ZA17988*/ 02848000
*     THEN                                                         0925 02849000
LOGSAVE  TM    IOSLOG(IOSBRG),B'00000001'                          0925 02850000
         BO    @RT00925                                            0925 02851000
         TM    INTLOG+136(EWAPTR),B'00000001'                      0925 02852000
         BNO   @RF00925                                            0925 02853000
@RT00925 DS    0H                                                  0926 02854000
*     DO;                           /* YES TEST NEW-OLD FOR OVERLAY     02855000
*                                                            @ZA30284*/ 02856000
*       GEN;                                                       0927 02857000
*                                   /*                      @ZA30284 */ 02858000
         L     @15,EWADDISP-1(,EWAPTR) /* GET LOG SAVE PTR  @ZA30284 */ 02859000
         TM    EWAMDR(@10),X'10'    /*PREV RECORD MDR?      @ZA30284 */ 02860000
         BNO   NOPRVMDR             /*NO, BRANCH            @ZA30284 */ 02861000
         TM    EWDASNS+7(@10),X'30' /*NEW FORMAT 3?         @ZA30284 */ 02862000
         BO    OBRSAVE              /*YES, GO SAVE IT       @ZA30284 */ 02863000
         BR    @14                  /*NO, RETURN TO CALLER  @ZA30284 */ 02864000
NOPRVMDR TM    OBRSNS+7(@15),X'30'  /*PREV FMT 3?           @ZA30284 */ 02865000
         BOR   @14                  /*YES, DONT OVERLAY     @ZA30284 */ 02866000
         TM    EWDASNS+7(@10),X'60' /*NEW FMT 6?            @ZA30284 */ 02867000
         BO    MDRCHK               /*YES, LOG IT           @ZA30284 */ 02868000
         TM    OBRSNS+2(@15),X'10'  /*PREV ENVIRONMENTAL?   @ZA30284 */ 02869000
         BO    PREVENV              /*YES, TEST AGAIN       @ZA30284 */ 02870000
         TM    EWDSNS2(@10),EWDEDAT /*NEW ENV DATA?         @ZA30284 */ 02871000
         BO    NEWENV               /*YES, TEST FMT 5       @ZA30284 */ 02872000
         TM    OBRSNS+7(@15),X'50'   /*PREV FMT 5?          @ZA30284 */ 02873000
         BO    PREV5                /*YES, TEST NEW 5       @ZA30284 */ 02874000
         BR    @14                  /*NO, RETURN            @ZA30284 */ 02875000
PREV5    TM    EWDASNS+7(@10),X'50' /*NEW FMT 5?            @ZA30284 */ 02876000
         BNO   OBRSAVE              /*NO, GO SAVE IT        @ZA30284 */ 02877000
         BR    @14                  /*YES, RETURN           @ZA30284 */ 02878000
NEWENV   TM    OBRSNS+7(@15),X'50'   /*PREV FMT 5?          @ZA30284 */ 02879000
         BO    OBRSAVE              /*YES, SAVE IT          @ZA30284 */ 02880000
         BR    @14                  /*NO, RETURN            @ZA30284 */ 02881000
PREVENV  TM    EWDSNS2(@10),EWDEDAT /*NEW ENV?              @ZA30284 */ 02882000
         BOR   @14                  /*YES, RETURN           @ZA30284 */ 02883000
         B     PREV5                /*NO, TEST NEW 5        @ZA30284 */ 02884000
*     END;                          /*                       @ZA30284*/ 02885000
*   ELSE                                                           0929 02886000
*     ;                             /* GET STORAGE                   */ 02887000
@RF00925 DS    0H                                                  0930 02888000
*GETLOGBK:                                                         0930 02889000
*   ;                               /* GET CORE FOR LOG INFO         */ 02890000
GETLOGBK DS    0H                                                  0931 02891000
*   GEN;                                                           0931 02892000
         LR    @00,@14             SAVE RTRN REG                        02893000
         BAL   @14,GETBLOK         GOTO  GET CORE RTN                   02894000
         LR    @14,@00             RESTORE RTRN REG                     02895000
*   EWADDISP=WKRG3+LINK;            /* SET OBR PTR           @ZA02273*/ 02896000
         LA    @15,4                                               0932 02897000
         ALR   @15,WKRG3                                           0932 02898000
         STCM  @15,7,EWADDISP(EWAPTR)                              0932 02899000
*   IOSLOG='1'B;                    /* SET LOG IND                   */ 02900000
         OI    IOSLOG(IOSBRG),B'00000001'                          0933 02901000
*MDRCHK:                                                           0934 02902000
*   DAMDR=DAMDR&&DAMDR;             /* CLEAR RECORD AREA             */ 02903000
MDRCHK   L     @15,EWADDISP-1(,EWAPTR)                             0934 02904000
         XC    DAMDR(154,@15),DAMDR(@15)                           0934 02905000
*   IF ERPRDLOG='1'B|FMTBITS='110'B /* MDR RECORD ?          @ZA03181*/ 02906000
*     THEN                                                         0935 02907000
         TM    ERPRDLOG+6(EWAPTR),B'10000000'                      0935 02908000
         BO    @RT00935                                            0935 02909000
         TM    FMTBITS+32(EWAPTR),B'01100000'                      0935 02910000
         BNO   @RF00935                                            0935 02911000
         TM    FMTBITS+32(EWAPTR),B'00010000'                      0935 02912000
         BNZ   @RF00935                                            0935 02913000
@RT00935 DS    0H                                                  0936 02914000
*     ;                             /* YES CONT                      */ 02915000
*   ELSE                                                           0937 02916000
*     GOTO OBRSAVE;                 /* NO, TOO OBR SETUP             */ 02917000
*MDRSAVE:                           /*                       @ZA30284*/ 02918000
*   EWAMDR='1'B;                    /* IND MDR RECORD                */ 02919000
MDRSAVE  OI    EWAMDR(EWAPTR),B'10000000'                          0938 02920000
*   IF ERPRDLOG='1'B                /* ZEUS LOG?                     */ 02921000
*     THEN                                                         0939 02922000
         TM    ERPRDLOG+6(EWAPTR),B'10000000'                      0939 02923000
         BNO   @RF00939                                            0939 02924000
*     ;                             /* YES                           */ 02925000
*   ELSE                                                           0941 02926000
*     GOTO SNSMDR;                  /* NO                            */ 02927000
*   MDRCDSIZ=RCD154;                /* IND 154 BYTE RCD              */ 02928000
         L     @15,EWADDISP-1(,EWAPTR)                             0942 02929000
         LA    @15,0(,@15)                                         0942 02930000
         MVC   MDRCDSIZ(2,@15),@CH00093                            0942 02931000
*   IF UCBTBYT4='06'X               /* 2305A ?                       */ 02932000
*     THEN                                                         0943 02933000
         CLI   UCBTBYT4(UCBRG),X'06'                               0943 02934000
         BNE   @RF00943                                            0943 02935000
*     MDRID='12'X;                  /* YES                           */ 02936000
         MVI   MDRID(@15),X'12'                                    0944 02937000
*   ELSE                                                           0945 02938000
*     MDRID='02'X;                  /* NO                            */ 02939000
         B     @RC00943                                            0945 02940000
@RF00943 L     @15,EWADDISP-1(,EWAPTR)                             0945 02941000
         MVI   MDRID(@15),X'02'                                    0945 02942000
*   GOTO SETCUA;                    /* GO SET CUA ADDR               */ 02943000
         B     SETCUA                                              0946 02944000
*SNSMDR:                                                           0947 02945000
*   MDRCDSIZ=56;                    /* IND 56 BYTE RCD               */ 02946000
SNSMDR   L     @15,EWADDISP-1(,EWAPTR)                             0947 02947000
         LA    @15,0(,@15)                                         0947 02948000
         MVC   MDRCDSIZ(2,@15),@CH00095                            0947 02949000
*   IF UCBTBYT4='09'X               /* CHK DEV TYPE          @Z30RSAG*/ 02950000
*     THEN                                                         0948 02951000
         CLI   UCBTBYT4(UCBRG),X'09'                               0948 02952000
         BNE   @RF00948                                            0948 02953000
*     MDRID='01'X;                  /* 3330 MERLIN                   */ 02954000
         MVI   MDRID(@15),X'01'                                    0949 02955000
*   ELSE                                                           0950 02956000
*     IF UCBTBYT4='0D'X THEN                                       0950 02957000
         B     @RC00948                                            0950 02958000
@RF00948 CLI   UCBTBYT4(UCBRG),X'0D'                               0950 02959000
         BNE   @RF00950                                            0950 02960000
*       MDRID='0A'X;                /* 3330 ICEBERG                  */ 02961000
         L     @15,EWADDISP-1(,EWAPTR)                             0951 02962000
         MVI   MDRID(@15),X'0A'                                    0951 02963000
*     ELSE                                                         0952 02964000
*       IF UCBTBYT4='0A'X           /* 3340                  @Z30RSAG*/ 02965000
*         THEN                                                     0952 02966000
         B     @RC00950                                            0952 02967000
@RF00950 CLI   UCBTBYT4(UCBRG),X'0A'                               0952 02968000
         BNE   @RF00952                                            0952 02969000
*         MDRID='09'X;              /* 3340                          */ 02970000
         L     @15,EWADDISP-1(,EWAPTR)                             0953 02971000
         MVI   MDRID(@15),X'09'                                    0953 02972000
*       ELSE                                                       0954 02973000
*         IF UCBTBYT4='0B'X         /* 3350                  @Z30RSAG*/ 02974000
*           THEN                                                   0954 02975000
         B     @RC00952                                            0954 02976000
@RF00952 CLI   UCBTBYT4(UCBRG),X'0B'                               0954 02977000
         BNE   @RF00954                                            0954 02978000
*           MDRID='11'X;            /* 3350                          */ 02979000
         L     @15,EWADDISP-1(,EWAPTR)                             0955 02980000
         MVI   MDRID(@15),X'11'                                    0955 02981000
*         ELSE                                                     0956 02982000
*           ;                       /* CONTINUE              @Z30RSAG*/ 02983000
@RF00954 DS    0H                                                  0957 02984000
*   MDRVOL=UCBVOLI;                 /* VOLUME SERIAL                 */ 02985000
@RC00952 DS    0H                                                  0957 02986000
@RC00950 DS    0H                                                  0957 02987000
@RC00948 L     @15,EWADDISP-1(,EWAPTR)                             0957 02988000
         LA    @15,0(,@15)                                         0957 02989000
         MVC   MDRVOL(6,@15),UCBVOLI(UCBRG)                        0957 02990000
*   MDRSNS(1:UCBSNSCT)=EWDASNS(1:UCBSNSCT);/* SENSE          @ZA05468*/ 02991000
         L     @12,UCBEXTPT(,UCBRG)                                0958 02992000
         SLR   @11,@11                                             0958 02993000
         IC    @11,UCBSNSCT(,@12)                                  0958 02994000
         BCTR  @11,0                                               0958 02995000
         EX    @11,@SM02066                                        0958 02996000
*SETCUA:                                                           0959 02997000
*   ;                               /* SET CHAN UNIT ADDR            */ 02998000
SETCUA   DS    0H                                                  0960 02999000
*   GEN;                                                           0960 03000000
*********************************************************************** 03001000
*      THIS ROUTINE IS RESPONSIBLE FOR INSERTING THE PROPER           * 03002000
*      PHYSICAL ADDRESS INTO THE MDR WORK AREA.  THE FOLLOWING        * 03003000
*      TABLE DESCRIBES THE VARIOUS DATA USED TO ASSEMBLE THIS         * 03004000
*      ADDRESS DEPENDING ON THE PHYSICAL DEVICE.                      * 03005000
*********************************************************************** 03006000
*    @ZA09638                     * 3 * 3 M * 3 * 3   E M   E M * 3 E * 03007000
*                                 * 3 * 3 O * 3 * 3 * 3 O * 3 O * 3 3 * 03008000
*                                 * 3 * 3 D * 4 * 5 * 3 D * 3 D * 4 3 * 03009000
*                                 * 0 * 0 I * 0 * 0 * 3 1 * 3 I * 4 4 * 03010000
*                                 *   *   I *   *   * 0   * 0 I *   0 * 03011000
*---------------------------------------------------------------------* 03012000
*  MODIFY CHANNEL ADDRESS         *   *     *   *   *     *     *     * 03013000
*  TO EQUAL UCB+D                 * X *  X  * X * X *  X  *  X  *  X  * 03014000
*---------------------------------*---*-----*---*---*-----*-----*-----* 03015000
*  SET BIT 2 OF UNIT              *   *     *   *   *     *     *     * 03016000
*  ADDRESS TO '0'                 *   *     *   *   *  X  *     *  X  * 03017000
*---------------------------------*---*-----*---*---*-----*-----*-----* 03018000
*  USE SENSE BYTE 4 BITS 0+1      *   *     *   *   *     *     *     * 03019000
*  TO CONTROL BITS 3+4 OF THE CUA *   *     *   *   *     *     *  X  * 03020000
*---------------------------------*---*-----*---*---*-----*-----*-----* 03021000
*  CONVERT 1 OF 8 CODE TO 3 OF 6  *   *     *   *   *     *     *     * 03022000
*  FOR SENSE BYTE 4               *   *     *   *   *  X  *  X  *     * 03023000
*---------------------------------*---*-----*---*---*-----*-----*-----* 03024000
*  USE SENSE BYTE 4 BITS 5-7      *   *     *   *   *     *     *     * 03025000
*  IN BITS 5-7 OF CUA             * X *  X  *   *   *  X  *  X  *  X  * 03026000
*---------------------------------------------------------------------* 03027000
*   WKACUA=EWACHA;                  /* GET ADDRESS FROM EWA  @ZA09638*/ 03028000
         L     @15,EWADDISP-1(,EWAPTR)                             0961 03029000
         LA    @15,0(,@15)                                         0961 03030000
         MVC   WKACUA(2,@15),EWACHA(EWAPTR)                        0961 03031000
*   WKACHA=UCBNAME;                 /* MOVE CHA ADR TO WORK AREA   0962 03032000
*                                                            @ZA09638*/ 03033000
         MVC   WKACHA(1,@15),UCBNAME(UCBRG)                        0962 03034000
*   WKACHA=WKACHA&'0F'X;            /* CLEAR HI DIGIT        @ZA09638*/ 03035000
         NI    WKACHA(@15),X'0F'                                   0963 03036000
*   IF UCBTBYT4='0B'X               /* TEST IF 3350 NATIVE   @ZA09638*/ 03037000
*     THEN                                                         0964 03038000
         CLI   UCBTBYT4(UCBRG),X'0B'                               0964 03039000
         BE    @RT00964                                            0964 03040000
*     GO TO NORMAL;                 /*                       @ZA09638*/ 03041000
*   IF UCBTBYT4='0A'X               /* TEST IF 3340          @ZA09638*/ 03042000
*     THEN                          /*                       @ZA09638*/ 03043000
         CLI   UCBTBYT4(UCBRG),X'0A'                               0966 03044000
         BNE   @RF00966                                            0966 03045000
*     IF EEMU='1'B                  /* IF EMULATED THEN DO   @ZA09638*/ 03046000
*       THEN                        /*                       @ZA09638*/ 03047000
         TM    EEMU+34(EWAPTR),B'00001000'                         0967 03048000
         BNO   @RF00967                                            0967 03049000
*       DO;                         /*                       @ZA09638*/ 03050000
*         WKASNS4=EWDSNS4;          /* GET SENSE BYTE 4      @ZA09638*/ 03051000
         MVC   WKASNS4(1,@15),EWDSNS4(EWAPTR)                      0969 03052000
*         WKABIT2='0'B;             /* CLEAR BIT 2 OF UA     @ZA09638*/ 03053000
         NI    WKABIT2(@15),B'11011111'                            0970 03054000
*         WKASTRG='0'B;             /* CLEAR BITS 3&4 OF UA  @ZA09638*/ 03055000
         NI    WKASTRG(@15),B'11100111'                            0971 03056000
*         IF EST0='1'B              /* IF BIT 0 ON           @ZA09638*/ 03057000
*           THEN                                                   0972 03058000
         TM    EST0+36(EWAPTR),B'10000000'                         0972 03059000
         BNO   @RF00972                                            0972 03060000
*           WKASTRG0='1'B;          /* THEN BIT 3=ON         @ZA09638*/ 03061000
         OI    WKASTRG0(@15),B'00010000'                           0973 03062000
*         IF EST1='1'B              /* IF BIT 1 ON           @ZA09638*/ 03063000
*           THEN                                                   0974 03064000
@RF00972 TM    EST1+36(EWAPTR),B'01000000'                         0974 03065000
         BNO   @RF00974                                            0974 03066000
*           WKASTRG1='1'B;          /* THEN BIT 4=ON         @ZA09638*/ 03067000
         L     @15,EWADDISP-1(,EWAPTR)                             0975 03068000
         OI    WKASTRG1(@15),B'00001000'                           0975 03069000
*         GO TO PUA;                /* GO TO FINISH CUA      @ZA09638*/ 03070000
         B     PUA                                                 0976 03071000
*       END;                        /*                       @ZA09638*/ 03072000
*     ELSE                                                         0978 03073000
*       GO TO NORMAL;               /* IF NATIVE 3340        @ZA09638*/ 03074000
*   IF UCBTBYT4='09'X|UCBTBYT4='0D'X/* 3330 1 OR II          @ZA09638*/ 03075000
*     THEN                          /*                       @ZA09638*/ 03076000
@RF00966 CLI   UCBTBYT4(UCBRG),X'09'                               0979 03077000
         BE    @RT00979                                            0979 03078000
         CLI   UCBTBYT4(UCBRG),X'0D'                               0979 03079000
         BNE   @RF00979                                            0979 03080000
@RT00979 DS    0H                                                  0980 03081000
*     DO;                           /*                       @ZA09638*/ 03082000
*       IF EEMU='1'B                /* EMULATED DEVICE?      @ZA09638*/ 03083000
*         THEN                      /*                       @ZA09638*/ 03084000
         TM    EEMU+34(EWAPTR),B'00001000'                         0981 03085000
         BNO   @RF00981                                            0981 03086000
*         DO;                       /*                       @ZA09638*/ 03087000
*                                                                  0982 03088000
*           /*********************************************************/ 03089000
*           /*                                                       */ 03090000
*           /* THIS CODE WILL CONVERT SENSE BYTE 4 FROM 1 OF 8 CODE  */ 03091000
*           /* TO 3 OF 6                                             */ 03092000
*           /*                                                       */ 03093000
*           /*********************************************************/ 03094000
*                                                                  0983 03095000
*           RFY                                                    0983 03096000
*            (WKRG2,                                               0983 03097000
*             FRRRG) RSTD;          /*                       @ZA09638*/ 03098000
*           GEN;                                                   0984 03099000
*                                                          /*@ZA09638*/ 03100000
            LA    @04,1   /* PUT 1 INTO REG                  @ZA09638*/ 03101000
            SR    @05,@05 /* CLEAR REG                       @ZA09638*/ 03102000
            IC    @05,EWDSNS4(EWAPTR) /* GET SENSE BYTE      @ZA09638*/ 03103000
SHIFT       SRA   @05,1   /* SHIFT RIGHT 1 POSITION          @ZA09638*/ 03104000
            BZ    GOTIT   /* IS REG = 0                      @ZA09638*/ 03105000
            LA    @04,1(@04)   /* INCREMENT REG BY 1         @ZA09638*/ 03106000
            B     SHIFT   /* LOOP AGAIN                      @ZA09638*/ 03107000
GOTIT       LA    @05,7   /* LOAD 7 INTO REG                 @ZA09638*/ 03108000
            MR    @04,@04 /* MULT 7 TIMES # OF SHIFTS        @ZA09638*/ 03109000
            L     @15,EWADDISP-1(EWAPTR) /*GET MDR ADR       @ZA09638*/ 03110000
            STC   @05,WKASNS4(@15)  /* STORE 3 OF 6 CODE     @ZA09638*/ 03111000
*           RFY                                                    0985 03112000
*            (WKRG2,                                               0985 03113000
*             FRRRG) UNRSTD;        /*                       @ZA09638*/ 03114000
*           IF UCBTBYT4='09'X       /* IF MERLIN THEN RESET BIT 2 OF    03115000
*                                      CONTROL UNIT ADDRESS  @ZA09638*/ 03116000
*             THEN                                                 0986 03117000
         CLI   UCBTBYT4(UCBRG),X'09'                               0986 03118000
         BNE   @RF00986                                            0986 03119000
*             WKABIT2='0'B;         /*                       @ZA09638*/ 03120000
         L     @15,EWADDISP-1(,EWAPTR)                             0987 03121000
         NI    WKABIT2(@15),B'11011111'                            0987 03122000
*           ELSE                                                   0988 03123000
*             ;                     /*                       @ZA09638*/ 03124000
@RF00986 DS    0H                                                  0989 03125000
*           GO TO PUA;              /* COMPLETE CUA          @ZA09638*/ 03126000
         B     PUA                                                 0989 03127000
*         END;                      /*                       @ZA09638*/ 03128000
*       ELSE                        /*                       @ZA09638*/ 03129000
*         WKASNS4=EWDSNS4;          /* REAL 3330 - GET SENSE 4     0991 03130000
*                                                            @ZA09638*/ 03131000
@RF00981 L     @15,EWADDISP-1(,EWAPTR)                             0991 03132000
         MVC   WKASNS4(1,@15),EWDSNS4(EWAPTR)                      0991 03133000
*     END;                          /*                       @ZA09638*/ 03134000
*PUA:                                                              0993 03135000
*   WKAUA=WKAUA&'F8'X;              /* SAVE BITS 0-4         @ZA27761*/ 03136000
@RF00979 DS    0H                                                  0993 03137000
PUA      L     @15,EWADDISP-1(,EWAPTR)                             0993 03138000
         LA    @15,0(,@15)                                         0993 03139000
         NI    WKAUA(@15),X'F8'                                    0993 03140000
*   WKASNS4=WKASNS4&'07'X;          /* SAVE BITS 5-7         @ZA27761*/ 03141000
         NI    WKASNS4(@15),X'07'                                  0994 03142000
*   WKAUA=WKAUA|WKASNS4;            /* MERGE INTO ONE BYTE   @ZA27761*/ 03143000
         OC    WKAUA(1,@15),WKASNS4(@15)                           0995 03144000
*NORMAL:                            /*                       @ZA27761*/ 03145000
*   IF UCBNAME(1:1)<'F0'X           /* NON-NUMERIC ADDR?     @ZA27761*/ 03146000
*     THEN                                                         0996 03147000
NORMAL   CLI   UCBNAME(UCBRG),X'F0'                                0996 03148000
         BNL   @RF00996                                            0996 03149000
*     WKACUA=WKACUA+'900'X;         /* MAKE IT ALPHA         @ZA27761*/ 03150000
         L     @15,EWADDISP-1(,EWAPTR)                             0997 03151000
         LA    @15,0(,@15)                                         0997 03152000
         LA    @12,2304                                            0997 03153000
         LH    @11,WKACUA(,@15)                                    0997 03154000
         N     @11,@CF00055                                        0997 03155000
         ALR   @12,@11                                             0997 03156000
         STH   @12,WKACUA(,@15)                                    0997 03157000
*   ELSE                                                           0998 03158000
*     ;                             /* NUMERIC OK            @ZA27761*/ 03159000
@RF00996 DS    0H                                                  0999 03160000
*   MDRCUA=WKACUA;                  /* PUT PHYSICAL ADDR INTO MDR  0999 03161000
*                                                            @ZA27761*/ 03162000
         L     @15,EWADDISP-1(,EWAPTR)                             0999 03163000
         LA    @15,0(,@15)                                         0999 03164000
         MVC   MDRCUA(2,@15),WKACUA(@15)                           0999 03165000
*   WKA=0;                          /* CLEAR WORKAREA BYTES 2-4    1000 03166000
*                                                            @ZA27761*/ 03167000
         SLR   @12,@12                                             1000 03168000
         STCM  @12,7,WKA(@15)                                      1000 03169000
*   GOTO LOGRTRN;                   /* RETURN TO CALLER              */ 03170000
         B     LOGRTRN                                             1001 03171000
*OBRSAVE:                                                          1002 03172000
*   ;                               /* FORMAT OBR                    */ 03173000
OBRSAVE  DS    0H                                                  1003 03174000
*   EWAMDR='0'B;                    /* IND OBR RECORD                */ 03175000
         NI    EWAMDR(EWAPTR),B'01111111'                          1003 03176000
*   EWADCNT=DEVNO;                  /* NO. OF DEVICE DEP BYTES       */ 03177000
         MVI   EWADCNT(EWAPTR),X'18'                               1004 03178000
*   OBRVOL=UCBVOLI;                 /* VOLUME SERIAL                 */ 03179000
         L     @15,EWADDISP-1(,EWAPTR)                             1005 03180000
         LA    @15,0(,@15)                                         1005 03181000
         MVC   OBRVOL(6,@15),UCBVOLI(UCBRG)                        1005 03182000
*   OBRSKA=IOSEEKA(2:8);            /* SEEK ADDR                     */ 03183000
         MVC   OBRSKA(7,@15),IOSEEKA+1(IOSBRG)                     1006 03184000
*   OBRHOMAD=EWDCCHH;               /* HOME ADDR/PHY ADDR            */ 03185000
         MVC   OBRHOMAD(4,@15),EWDCCHH(EWAPTR)                     1007 03186000
*   OBRCSW=IOSCSW;                  /* CSW                           */ 03187000
         MVC   OBRCSW(7,@15),IOSCSW(IOSBRG)                        1008 03188000
*   IF CCWRG>0                      /* VALID CCW ?                   */ 03189000
*     THEN                                                         1009 03190000
         LTR   CCWRG,CCWRG                                         1009 03191000
         BNP   @RF01009                                            1009 03192000
*     OBRCCW=CCWRG->DACCW;          /* SAVE FAILING CCW      @ZA05463*/ 03193000
         MVC   OBRCCW(8,@15),DACCW(CCWRG)                          1010 03194000
*   ELSE                                                           1011 03195000
*     ;                             /* NO CCW                        */ 03196000
@RF01009 DS    0H                                                  1012 03197000
*   OBRSNS(1:UCBSNSCT)=EWDASNS(1:UCBSNSCT);/* SENSE          @ZA05468*/ 03198000
         L     @15,EWADDISP-1(,EWAPTR)                             1012 03199000
         L     @12,UCBEXTPT(,UCBRG)                                1012 03200000
         SLR   @11,@11                                             1012 03201000
         IC    @11,UCBSNSCT(,@12)                                  1012 03202000
         BCTR  @11,0                                               1012 03203000
         EX    @11,@SM02069                                        1012 03204000
*LOGRTRN:                                                          1013 03205000
*   ;                               /* RETURN TO CALLER              */ 03206000
LOGRTRN  DS    0H                                                  1014 03207000
*   GEN;                                                           1014 03208000
         BR    @14                 RETURN TO CALLER                     03209000
*   RFY                                                            1015 03210000
*    (RTRNRG) UNRSTD;                                              1015 03211000
*   GEN REFS(EWDCCW1,EWDCCW2,EWDCCW3,EWDCCW4,EWDHOMAD,EWDSNS8);    1016 03212000
*                                                                    /* 03213000
         EJECT                                                          03214000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         03215000
*        PROTOTYPE CCWS FOR USE BY 'CPBLD' IN CONSTRUCTING              03216000
*        ERP CHANNEL PROGRAMS                                           03217000
*                                                                       03218000
DACP1    DS    0F                                                       03219000
*CCW1    SET SECTOR EWDCCW1+6,CC+SLI,1                                  03220000
         DC    X'23'               OP                                   03221000
         DC    AL3(EWDCCW1+6)      ARG                                  03222000
         DC    X'60'               CC+SLI                               03223000
         DC    AL1(EWARG)          RELOCATE                             03224000
         DC    AL1(0*8)            POSITION                             03225000
         DC    AL1(1)              LGTH                                 03226000
DACP2    DS    0F                                                       03227000
*CCW2,1  RHA   EWDCCW1,CC+SLI+SKIP,5                                    03228000
         DC    X'1A'               OP                                   03229000
         DC    AL3(EWDCCW1)        ARG                                  03230000
         DC    X'70'               CC+SLI+SKIP                          03231000
         DC    AL1(WKRG2*16+EWARG) RELOCATE + END FLG                   03232000
         DC    AL1(0*8)            POSITION                             03233000
         DC    AL1(5)              LGTH                                 03234000
*                                                                       03235000
DACP3    DS    0F                                                       03236000
*CCW1    SET SECTOR EWDCCW1+6,CC+SLI,1                                  03237000
         DC    X'23'               OP                                   03238000
         DC    AL3(EWDCCW1+6)      ARG                                  03239000
         DC    X'60'               CC+SLI                               03240000
         DC    AL1(EWARG)          RELOCATE                             03241000
         DC    AL1(0*8)            POSITION                             03242000
         DC    AL1(1)              LGTH                                 03243000
DACP4    DS    0F                                                       03244000
*CCW2,1  SID   EWDCCHH,CC+SLI,5                                         03245000
         DC    X'31'               OP                                   03246000
         DC    AL3(EWDCCHH)        ARG                                  03247000
         DC    X'60'               CC+SLI                               03248000
         DC    AL1(EWARG)          RELOCATE                             03249000
         DC    AL1(1*8)            POSITION                             03250000
         DC    AL1(5)              LGTH                                 03251000
*CCW3,2  TIC   *-8,CC+SLI,0                                             03252000
         DC    X'08'               OP                                   03253000
         DC    AL3(EWDCCW2)        ARG                                  03254000
         DC    X'60'               CC+SLI                               03255000
         DC    AL1(EWARG)          RELOCATE                             03256000
         DC    AL1(0*8)            POSITION                             03257000
         DC    AL1(0)              LGTH                                 03258000
*CCW4,3  X     (ERCCW DATA+ # BYTES READ),ERCCW FLGS,RESID CNT          03259000
         DC    X'00'               OP SET FROM SENSE                    03260000
         DC    AL3(0)              ARG CALC'D BY ERP                    03261000
         DC    X'00'               FLGS FROM ERCCW                      03262000
         DC    AL1(EWARG)          RELOCATE                             03263000
         DC    AL1(0*8)            POSITION                             03264000
         DC    AL1(0)              LENTH SET FROM RESID                 03265000
*CCW5,4  TIC   *-8,CC+SLI,0                                             03266000
         DC    X'08'               OP                                   03267000
         DC    AL3(EWDCCW4)        ARG                                  03268000
         DC    X'60'               CC+SLI                               03269000
         DC    AL1(WKRG2*16+EWARG) RELOCATE + END FLG                   03270000
         DC    AL1(0*8)            POSITION                             03271000
         DC    AL1(0)              LGTH                                 03272000
*                                                                       03273000
DACP5    DS    0F                                                       03274000
*CCW1    RHA EWDCCW1,CC+SLI+SKIP,5                                      03275000
         DC    X'1A'               OP                                   03276000
         DC    AL3(EWDCCW1)        ARG                                  03277000
         DC    X'70'               CC+SLI                               03278000
         DC    AL1(EWARG)          RELOCATE                             03279000
         DC    AL1(0*8)            POSITION                             03280000
         DC    AL1(5)              LGTH                                 03281000
*CCW2    SID   EWDSNS8,CC+SLI,5                                         03282000
         DC    X'31'               OP                                   03283000
         DC    AL3(EWDCCW6)        ARG                        @ZA10564  03284000
         DC    X'60'               CC+SLI                               03285000
         DC    AL1(EWARG)          RELOCATE                             03286000
         DC    AL1(0*8)            POSITION                             03287000
         DC    AL1(5)              LGTH                                 03288000
*CCW3    TIC   *-8,CC+SLI,0                                             03289000
         DC    X'08'               OP                                   03290000
         DC    AL3(EWDCCW2)        ARG                                  03291000
         DC    X'60'               CC+SLI                               03292000
         DC    AL1(EWARG)          RELOCATE                             03293000
         DC    AL1(0*8)            POSITION                             03294000
         DC    AL1(0)              LGTH                                 03295000
*CCW4    RD-CNT EWDCCW1,CC+SLI+SKIP,1                                   03296000
         DC    X'12'               OP                                   03297000
         DC    AL3(EWDCCW1)        ARG                                  03298000
         DC    X'70'               CC+SLI+SKIP                          03299000
         DC    AL1(WKRG2*16+EWARG) RELOCATE + END FLG                   03300000
         DC    AL1(0*8)            POSITION                             03301000
         DC    AL1(1)              LGTH                                 03302000
*                                                                       03303000
DACP6    DS    0F                                                       03304000
*CCW1    RECAL EWDCCW1,SLI,1                                            03305000
         DC    X'13'               OP                                   03306000
         DC    AL3(EWDCCW1)        ARG                                  03307000
         DC    X'20'               SLI                                  03308000
         DC    AL1(WKRG2*16+EWARG) RELOCATE + END FLG                   03309000
         DC    AL1(6*8)            POSITION                             03310000
         DC    AL1(1)              LGTH                                 03311000
*                                                                       03312000
DACP7    DS    0F                                                       03313000
*CCW1    RD-LOG 0,SLI,1                                                 03314000
         DC    X'24'               OP                                   03315000
         DC    AL3(0)              ADDR SET BY ERP                      03316000
         DC    X'20'               SLI                                  03317000
         DC    AL1(WKRG2*16+EWARG) RELOCATE + END FLG                   03318000
         DC    AL1(6*8)            POSITION                             03319000
         DC    AL1(128)            LGTH                                 03320000
*                                                                       03321000
DACP8    DS    0F                                                       03322000
*CCW1    RHA   EWDHOMAD,CC+SLI,5                                        03323000
         DC    X'1A'               OP                                   03324000
         DC    AL3(EWDHOMAD)       ARG                                  03325000
         DC    X'60'               CC+SLI                               03326000
         DC    AL1(EWARG)          RELOCATE                             03327000
         DC    AL1(5*8)            POSITION                             03328000
         DC    AL1(5)              LGTH                                 03329000
*CCW2    RR0   EWDRZRO,SLI,4                                            03330000
         DC    X'16'               OP                                   03331000
         DC    AL3(EWDRZRO)        ARG                                  03332000
         DC    X'20'               SLI                                  03333000
         DC    AL1(WKRG2*16+EWARG) RELOCATE + END FLG                   03334000
         DC    AL1(0*8)            POSITION                             03335000
         DC    AL1(4)              LGTH                                 03336000
*                                                                       03337000
DACP9    DS    0F                                                       03338000
*CCW1    SHA   IOSCCHH,CC+SLI,4                                         03339000
         DC    X'39'               OP                                   03340000
         DC    AL3(IOSCCHH)        ARG                                  03341000
         DC    X'60'               CC+SLI                               03342000
         DC    AL1(IOSBRG)         RELOCATE                             03343000
         DC    AL1(0*8)            POSITION                             03344000
         DC    AL1(4)              LGTH                                 03345000
*CCW2    TIC   *-8,CC+SLI,0                                             03346000
         DC    X'08'               OP                                   03347000
         DC    AL3(EWDCCW1)        ARG                                  03348000
         DC    X'60'               CC+SLI                               03349000
         DC    AL1(EWARG)          RELOCATE                             03350000
         DC    AL1(0*8)            POSITION                             03351000
         DC    AL1(0)              LGTH                                 03352000
*CCW3    RHA   EWDCCW1,CC+SLI+SKIP                                      03353000
         DC    X'1A'               OP                                   03354000
         DC    AL3(EWDCCW1)        ARG                                  03355000
         DC    X'70'               CC+SLI+SKIP                          03356000
         DC    AL1(WKRG2*16+EWARG) RELOCATE + END FLG                   03357000
         DC    AL1(0*8)            POSITION                             03358000
         DC    AL1(5)              LGTH                                 03359000
*                                                                    */ 03360000
*   END;                            /* THE END...                    */ 03361000
@EL00001 DS    0H                                                  1017 03362000
@EF00001 DS    0H                                                  1017 03363000
@ER00001 BR    @14                                                 1017 03364000
*/*MVMDAERP:      CHART (SEQ) L R PERRY ZA17988                      */ 03365000
*/*IECVDERP:      E ENTER ERP                                        */ 03366000
*/*               P SET ADDRESSIBILITY                               */ 03367000
*/*               P SAVE REGS 2-6, IOSERR=1                          */ 03368000
*/*               P RESTORE IOSRST                                   */ 03369000
*/*               D (YES,,NO,%A001) ERPREV=0?                        */ 03370000
*/*               P SAVE IOSCKEY AND IOSOPTS. ERPREV=1               */ 03371000
*/*%A001:         D (YES,,NO,%A004) UNIT CHK?                        */ 03372000
*/*               D (NO,,YES,STATSAV) SENSE FAIL? (EWABDSNS)         */ 03373000
*/*               D (NO,,YES,STATCK) 2314 DEV?                       */ 03374000
*/*               D (NO,,YES,%A002) ENV DATA?                        */ 03375000
*/*               D (NO,%A003,YES,INTCK) 3340 OR MSS?                */ 03376000
*/*%A002:         S (,RETRY)LOGSAVE :SET TO SAVE LOG                 */ 03377000
*/*%A003:         D (YES,,NO,INTCK) ZEUS LOG?                        */ 03378000
*/*               P ERPRDLOG = 1                                     */ 03379000
*/*               S LOGSAVE:SAVE LOG INFO                            */ 03380000
*/*               P IOSBYP=1 SET FOR RDLOG CP (DACP7)                */ 03381000
*/*               S (,RESTART) CPBLD:BLD RDLOG CP                    */ 03382000
*/*%A004:         P IOSSNS=0                                         */ 03383000
*/*INTCK:         D (NO,,YES,%A005) INTERCEPT? (IOSCOD=7E)           */ 03384000
*/*               S CCWSUB:POINT AT ERRCCW                           */ 03385000
*/*               P CALLRG=CVTXITP                                   */ 03386000
*/*               S ERINTERP:BALR-14 CALLRG TO ERR INTERP            */ 03387000
*/*            D (CCC,ERCHAN,ICC,ERCHAN,CDC,RTY10D,CCHN,RTY10D,PERM, */ 03388000
*/*PERMCK,EQUP,RTY10,CREJ,ERMSG,BUSO,RTY10,INT,ERINT,SEEK,           */ 03389000
*/*ERSEK,MAM,RTY10,OVRN,RTY10A,TVRN,ERHARD,NRF,NRFCK,TCC,ERTCC,      */ 03390000
*/*DCHK,ERDATA,EOC,EREOC,FPRT,ERFP,OFLO,EROFLO,CPCK,ERHARD,          */ 03391000
*/*CPRT,ERHARD,UNEX,EREOF,LGTH,ERLEN,UCHK,RTY10,ENDI,ERNOER)         */ 03392000
*/*RETURN VECTORS FROM ERR INTERP                                    */ 03393000
*/*%A005:         P IOSCOD=7F                                        */ 03394000
*/*               S (,RETRY) LOGSAVE:SAVE LOG INFO                   */ 03395000
*/*STATSAV:       P IOSTATUS = EWASSTAT                              */ 03396000
*/*               P (,RETRY) INCREMENT EWACNTR3                      */ 03397000
*/*STATCK:        D (YES,,NO,INTCK) ABNORMAL SENSE STATUS?           */ 03398000
*/*               D (NO,,YES,SETBADHA) INTERVENTION REQUIRED?        */ 03399000
*/*SNSRTY:        D (YES,,NO,STATSAV) EWACNTR3 = 1?                  */ 03400000
*/*SETBADHA:      P (,INTCK) ERPBADHA=1. MOVE SKA CCHH TO RHA CCHH   */ 03401000
*/*RTY10D:        D (NO,,YES,CNTINCR1) EWACNTR<10?                   */ 03402000
*/*               P (,ERMSG) SET LOG BIT FOR DDR                     */ 03403000
*/*RTY10:         E RTY10                                            */ 03404000
*/*               S LOGSAVE:SAVE LOG INFO                            */ 03405000
*/*RTY10C:        D (YES,,NO,ERMSG) EWACNTR1 < 10?                   */ 03406000
*/*CNTINCR1:      M (,RETRY) INCR EWACNTR1                           */ 03407000
*/*RTY10A:        E RTY10A                                           */ 03408000
*/*               D (YES,,NO,RTY10) 3340 DEV?                        */ 03409000
*/*RTY10B:        D (YES,CNTINCR1,NO,RTY10) EWACNTR1 < 10?           */ 03410000
*/*ERCHAN:        E ERCHAN                                           */ 03411000
*/*               S LOGSAVE:SAVE LOG INFO                            */ 03412000
*/*               D (YES,ERMSG,NO,RTY10C) ERPIB IBNORTY=1?           */ 03413000
*/*PERMCK:        E PERMCK                                           */ 03414000
*/*               D (NO,,YES,BYPOBR) VIRT. DASD MEDIA ERROR?         */ 03415000
*/*               S LOGSAVE:SAVE LOG INFO                            */ 03416000
*/*BYPOBR:        D (NO,,YES,RTY10C) 2314?                           */ 03417000
*/*               D (NO,,YES,ERMSG) EQUIP CHK ?                      */ 03418000
*/*               D (NO,ERMSG,YES,RTY10C) RD-M-CKD CMD ?             */ 03419000
*/*EREOF:         E EREOF                                            */ 03420000
*/*               D (NO,,YES,ERNOER) ERPRHA=1?                       */ 03421000
*/*ERLEN:         E ERLEN                                            */ 03422000
*/*               D (YES,,NO,ERHARD) ERPREV=1?                       */ 03423000
*/*ERSOFT:        P IOSEX=0                                          */ 03424000
*/*               D (YES,,NO,ERHARD) ERPOCSW =1 ?                    */ 03425000
*/*               P (,ERHARD) RESTORE USER CSW                       */ 03426000
*/*ERMSG:         P IOSMSG=1                                         */ 03427000
*/*XCTLWTO:       P SET FOR XCTL TO WTO (IOSPROC = '14'X)            */ 03428000
*/*ERHARD:        P IOSERR=0                                         */ 03429000
*/*               D (YES,,NO,%A006) ERPOFLO=1?                       */ 03430000
*/*               P SET OFLO IN IOSSNS                               */ 03431000
*/*%A006:         P CLEAR ERP FLGS                                   */ 03432000
*/*               S RESTORE:RESTORE IOSCKEY, OPTS, & RST             */ 03433000
*/*DIRCHK:        D (YES,,NO,%H001) INTERNAL LOG ON?                 */ 03434000
*/*               P SET IOSLOG BIT                                   */ 03435000
*/*%H001:         D (YES,,NO,%A007) TRANS NEEDED? (MSG OR LOG)       */ 03436000
*/*IDRCHK:        D (YES,DIRBLD,NO,%A008) DIR NEEDED? (IOSIDR = 1)   */ 03437000
*/*CALTRANS:      E RESTORE REGS                                     */ 03438000
*/*               R RETURN TO IOS REG 6 +8                           */ 03439000
*/*DIRBLD:        S GETBLOCK3:GET 3 BLOCKS FOR DIR                   */ 03440000
*/*               P COPY SRB TO FIRST BLOCK                          */ 03441000
*/*               P COPY IOSB TO FIRST BLOCK                         */ 03442000
*/*               P POINT COPIED SRB TO COPIED IOSB                  */ 03443000
*/*               P POINT COMPIED IOSB TO COPIED SRB                 */ 03444000
*/*               P POINT COPIED IOSB TO SECOND BLOCK (EWA)          */ 03445000
*/*               P SET IOSIOSB = 1 IN COPIED IOSB                   */ 03446000
*/*               P CLEAR IOSOPT BYTE IN COPIED IOSB                 */ 03447000
*/*               P IOSPROC = X'14' (WTO) IN COPIED IOSB             */ 03448000
*/*               P COPY EWA INTO SECOND BLOCK                       */ 03449000
*/*               P POINT COPIED EWA TO 3RD BLOCK (OBR INFO)         */ 03450000
*/*               P COPY OBR INFORMATION TO 3RD BLOCK                */ 03451000
*/*               P CLEAR LINK FIELDS IN 1ST AND 2ND BLOCKS          */ 03452000
*/*               P POINT COPIED SRB TO ASCB                         */ 03453000
*/*               P SCHEDULE SRB ON LSMQ                             */ 03454000
*/*PERMSOFT:      P RESTORE REGS                                     */ 03455000
*/*               R R06+4 PERM/SOFT                                  */ 03456000
*/*%A007:         D (NO,PERMSOFT,YES,IDRCHK) INT REQ'D?              */ 03457000
*/*%A008:         R R06+8 CALL TRANS                                 */ 03458000
*/*NRFCK:         E NRFCK                                            */ 03459000
*/*               D (YES,,NO,ERHARD) 2314?                           */ 03460000
*/*               D (NO,,YES,ERHARD) SEEK ADDR CCHH = HOME ADDR CCHH?   03461000
*/*                                                                  */ 03462000
*/*               P (,ERSEK) 'OR' SEEK CHK INTO SENSE                */ 03463000
*/*ERSEK:         E ERSEK                                            */ 03464000
*/*               S LOGSAVE:SAVE LOG INFO                            */ 03465000
*/*               P ERPRECAL=1 IOSBYP=1 IOSDEP=1 SET FOR RECAL       */ 03466000
*/*               S (,RESTART) CPBLD:BLD RECAL CP                    */ 03467000
*/*ERINT:         E ERINT                                            */ 03468000
*/*               D (YES,,NO,%H002) 3340,3350,EMULATED?              */ 03469000
*/*               D (YES,,NO,%H002)  STATE=11?                       */ 03470000
*/*               P SET INTERNAL LOG BIT                             */ 03471000
*/*               S LOGSAVE:SAVE LOG INFO                            */ 03472000
*/*%H002:         D (NO,,YES,ERINT1) 3340?                           */ 03473000
*/*%A009:         D (NO,,YES,ERINT1) EWACNTR2 = 1?                   */ 03474000
*/*               P (,RETRY) INCR EWACNTR2                           */ 03475000
*/*ERINT1:        P RESET IOSLOG                                     */ 03476000
*/*               P (,CALTRANS) IOSPROC=X'14' SETUP XCTL TO WTO      */ 03477000
*/*ERTCC:         E ERTCC                                            */ 03478000
*/*               D (NO,,YES,%A010) 3340?                            */ 03479000
*/*               P (,ERNOER) ERPRHA=1                               */ 03480000
*/*%A010:         P SET SKA HD FROM SNS                              */ 03481000
*/*               P IOSCKEY=0 ERPRHA=1 SET FOR RHA/RR0               */ 03482000
*/*               S (,RESTART) CPBLD:BLD RHA/RR0 CP                  */ 03483000
*/*RETRY:         D (YES,,NO,RESTART) ERPCP=0?                       */ 03484000
*/*               P CLEAR FLGS EXCPT OFLO                            */ 03485000
*/*RESTART:       P RESTORE REGS                                     */ 03486000
*/*               R R14+0 RETRY RESTART                              */ 03487000
*/*ERNOER:        E ERNOER                                           */ 03488000
*/*               P RESTORE IOSCKEY, IOSOPTS, & IOSRST. ERPCP=0      */ 03489000
*/*               D (NO,,YES,RTY10C) ERPRECAL=1?                     */ 03490000
*/*               D (NO,,YES,RETRY) ERPRDLOG=1?                      */ 03491000
*/*               D (NO,,YES,ERSOFT) ERPRHA=0?                       */ 03492000
*/*               P RESTORE ORIG SNS & CSW                           */ 03493000
*/*               P MOVE R0 CCHH TO SKA                              */ 03494000
*/*               D (NO,,YES,OFLOCK1) DEF TRK?                       */ 03495000
*/*               S SKUPDAT:UPDATE SEEK ADDR & CHK XTNTS             */ 03496000
*/*OFLOCK1:       D (NO,,YES,EROFLOA) OFLO?                          */ 03497000
*/*               P SET FOR SS- RHA- TIC                             */ 03498000
*/*               D (NO,,YES,%A011) EXTSNS?                          */ 03499000
*/*               P SET FOR SHA- TIC- RHA- TIC                       */ 03500000
*/*%A011:         S (,RESTART) CPBLD:BLD CHAN PGM                    */ 03501000
*/*EREOC:         E EREOC                                            */ 03502000
*/*               P FORCE HD HIGH (7F)                               */ 03503000
*/*UPDATSKA:      S SKUPDAT:UPDATE SEEK ADDR & CHK XTNTS             */ 03504000
*/*OFLOCK2:       D (NO,,YES,EROFLOA) OFLO?                          */ 03505000
*/*               D (NO,,YES,%A013) EXP SENSE DEV?                   */ 03506000
*/*               D (NO,,YES,%A012) CYL SWITCH FLG SET?              */ 03507000
*/*               P (,BLDCP2) SET FOR RHA- TIC (DACP2)               */ 03508000
*/*%A012:         P (,BLDCP2) SET FOR SHA- TIC- RHA- TIC (DACP9)     */ 03509000
*/*%A013:         P SET FOR SS- RHA- TIC (DACP1)                     */ 03510000
*/*BLDCP2:        S CPBLD:BLD CHAN PGM                               */ 03511000
*/*               P CCWRG1=CCWRG                                     */ 03512000
*/*               S (,RESTART) TICBLD:BLD TIC TO USER CP             */ 03513000
*/*ERFP:          E ERFP                                             */ 03514000
*/*               D (NO,,YES,ERHARD) FULL (07) SEEK?                 */ 03515000
*/*               D (NO,,YES,%A015) CYL SEEK?                        */ 03516000
*/*               D (YES,,NO,UPDATSKA) HD SEEK?                      */ 03517000
*/*%A014:         P DAT=OFF (MODESET). FETCH USER SEEK ARG.        1018 03518000
*/*DAT=ON (MODESET).                                                 */ 03519000
*/*               S XTNTCK:CHECK XTNTS                               */ 03520000
*/*               P (,OFLOCK2) CCWRG = *+8                           */ 03521000
*/*%A015:         P (,%A014) ERPCYLSW=1                              */ 03522000
*/*ERDATA:        E ERDATA                                           */ 03523000
*/*               D (YES,,NO,WINCK1) MERLIN?                         */ 03524000
*/*               D (NO,,YES,MERWCK1) CORRECTABLE?                   */ 03525000
*/*               D (YES,,NO,RTY10B) OP INC?                         */ 03526000
*/*               P (,CHAINCK) LOOP CNT = 0. RSTRTDSP = RSTDISP      */ 03527000
*/*WINCK1:        D (NO,,YES,%A016) 3340?                            */ 03528000
*/*%A019:         D (YES,,NO,RTY10C) CORRECTABLE?                    */ 03529000
*/*MERWCK1:       D (YES,,NO,ZEUSDISP) MERLIN OR WIN?                */ 03530000
*/*               P FDISP = RSTDISP - BKDISP                         */ 03531000
*/*               P RSTRTDSP = RSTDSP. FDISP = RSTDISP-BKDISP        */ 03532000
*/*LOOPSET:       P LOOP CNT =3. POINT AT FIRST ECC BYTE             */ 03533000
*/*ECFLOOP1:      D (YES,,NO,MERWCK2) ERR IN THIS SEG? FDISP < CCW CNT  03534000
*/*                                                                  */ 03535000
*/*               P WKRG1=CCWRG                                      */ 03536000
*/*               D (YES,,NO,%A018) IDAW?                            */ 03537000
*/*               S ADDRCALC:POINT TO IDAW                           */ 03538000
*/*%A018:         P ERR ADDR = DATA ADDR + FDISP                     */ 03539000
*/*               D (NO,,YES,ECCINCR) ECC BYTE = 0 OR SKIP FLG =1    */ 03540000
*/*               P DAT BIT = OFF. EXCL OR ECC BYTE TO CORE. DAT BIT =  03541000
*/*ON.                                                               */ 03542000
*/*ECCINCR:       P INCR ECC PTR. DECR LOOP CNT. INCR FDISP.         */ 03543000
*/*               D (YES,,NO,%A017) ZEUS A?                          */ 03544000
*/*               P INCR FDISP AGAIN                                 */ 03545000
*/*%A017:         D (YES,MERWCK2,NO,ECFLOOP1) LOOP CNT = 0?          */ 03546000
*/*%A016:         S (,%A019) LOGSAVE:SAVE LOG INFO                   */ 03547000
*/*ZEUSDISP:      P FDISP = CCW CNT - BKDISP - RESID CNT             */ 03548000
*/*               D (YES,RTY10C,NO,LOOPSET) FDISP NEGATIVE?          */ 03549000
*/*MERWCK2:       D (YES,,NO,MASKCK) MERLIN OR WIN?                  */ 03550000
*/*CHAINCK:       D (NO,,YES,%A020) DATA CHAINING?                   */ 03551000
*/*LENCK1:        D (YES,,NO,%A022) CU DET'D INC LGTH?               */ 03552000
*/*               D (YES,,NO,%A022) RSTRTDSP = CCW CNT?              */ 03553000
*/*               P (,RTY10) SET EQUIP CHK IN SNS                    */ 03554000
*/*%A020:        P DECR DISP'S BY CCW CNT. POINT TO NEXT CCW         */ 03555000
*/*               D (YES,,NO,%A021) IS IT A TIC?                     */ 03556000
*/*               P POINT AT TIC ARG                                 */ 03557000
*/*%A021:         D (NO,ECFLOOP1,YES,MERWCK2) LOOP CNT = 0?          */ 03558000
*/*%A022:         P CLEAR RESID CNT IN CSW                           */ 03559000
*/*               D (NO,,YES,MASKCK) RSTRTDSP = CCW CNT?             */ 03560000
*/*               P RESID = CCW CNT = RSTRT                          */ 03561000
*/*               D (YES,,NO,SETCNT) NEG RESID?                      */ 03562000
*/*SLICK:         D (NO,,YES,MASKCK) SLI BIT ON?                     */ 03563000
*/*               P SET CE, DE, INC LGTH IN CSW.                     */ 03564000
*/*CSWINCR:       P (,ERSOFT) POINT TO ERR CCW                       */ 03565000
*/*SETCNT:        P STORE CALC'D RESID IN CSW                        */ 03566000
*/*               D (YES,MASKCK,NO,SLICK) OFLO?                      */ 03567000
*/*MASKCK:        D (NO,,YES,PCIBIT) FILE MASK INHIBIT RETRY?        */ 03568000
*/*%A023:         P SET SKA HD FROM SNS                              */ 03569000
*/*               D (YES,,NO,%A024) OFLO?                            */ 03570000
*/*               D (YES,,NO,EROFLOA) CORRECTOBLE?                   */ 03571000
*/*               S (,EROFLOA) SKUPDAT:UPDATE SEEK ADDR & CHK XTNTS  */ 03572000
*/*%A024:         D (YES,,NO,NOFTR) RD-M-CKD CMD?                    */ 03573000
*/*               P UPDATE FTRCCW D.A.D.                             */ 03574000
*/*               D (YES,,NO,PTFTR)  IDA BIT ON?                   1018 03575000
*/*               S GETBLK: GET CORE ADDR                            */ 03576000
*/*PTFTR:         P WKRG1 = ADDR(FTRCCW)                             */ 03577000
*/*               D (YES,,NO,UPFTR) IDA BIT ON?                      */ 03578000
*/*               S ADRCALC: CALCULATE IDAW+FRWD DISPL               */ 03579000
*/*               P UPDATE FTRCCW D.A.D.                             */ 03580000
*/*               S IEAPTRV: XLATE TO VIRT ADDR                      */ 03581000
*/*UPFTR:         S BLDCP: BUILD CCW(DACP5)                          */ 03582000
*/*               P MOVE IN FTRCCW                                   */ 03583000
*/*               S (,RESTART) BLDTIC: BUILD TIC                     */ 03584000
*/*NOFTR:         D (NO,,YES,%A025) CMD CHAIN?                       */ 03585000
*/*               P (,CSWINCR) SET CE, DE IN CSW                     */ 03586000
*/*%A025:         D (YES,,NO,%A026) NEXT CCW A TIC?                  */ 03587000
*/*               P POINT TO TIC ARG                                 */ 03588000
*/*%A026:         P SET FOR SS SID TIC RDCNT TIC (DACP5)             */ 03589000
*/*               S CPBLD:BLD CH PGM                                 */ 03590000
*/*               D (YES,,NO,%A027) CNT OP?                          */ 03591000
*/*               P BACK UP WKRG1 TP OVERLAY RDCNT                   */ 03592000
*/*%A027:         P CCWRG1 = CCWRG                                   */ 03593000
*/*               S (,RESTART) TICBLD:BLD TIC                        */ 03594000
*/*PCIBIT:        D (YES,,NO,%A023)IOSMDB=1? PCI STOP                */ 03595000
*/*               P SET PCI COMPLETE (71) IN IOSCOD                  */ 03596000
*/*               P CLEAR ALL ERP FLGS                               */ 03597000
*/*               P IOSERR=0 IOSLOG=0 IOSEX=0                        */ 03598000
*/*               S RESTORE:RESTORE IOSCKEY,OPTS & RST               */ 03599000
*/*               P RESTORE REGS                                     */ 03600000
*/*               R R14+12 POST PER IOSCOD                           */ 03601000
*/*EROFLO:        E EROFLO                                           */ 03602000
*/*               P SET HEAD FROM SENSE                              */ 03603000
*/*EROFLOA:       P ERPOFLO=1. SET RECORD = 1                        */ 03604000
*/*               D (NO,,YES,OFLOCALC) ERR IN ERP CH PGM?            */ 03605000
*/*               P SET FOR RPS CP                                   */ 03606000
*/*               D (NO,,YES,%A028) RPS?                             */ 03607000
*/*               P SET FOR NON-RPS CP (DACP4)                       */ 03608000
*/*%A028:         S CPBLD:BLD CP                                     */ 03609000
*/*               D (NO,,YES,%A0281) CMD OR DATA CHAIN?              */ 03610000
*/*               P (,CMDSET) SAVE USER CSW IN EWDCCW5. ERPOCSW = 1. */ 03611000
*/*%A0281:        P POINT TO NEXT CCW                                */ 03612000
*/*               D (YES,,NO,%A030) IS IT A TIC?                     */ 03613000
*/*               D (NO,,YES,%A029) *-8?                             */ 03614000
*/*               P (,%A030) BACK UP TICBLD REG                      */ 03615000
*/*%A029:         P POINT TO NEXT CCW                                */ 03616000
*/*%A030:         S (,CMDSET) TICBLD:BLD TIC TO USER                 */ 03617000
*/*CMDSET:        P COPY USER CCW                                    */ 03618000
*/*               P SET CMD CODE FROM SENSE BYTE 3                   */ 03619000
*/*               D (NO,,YES,%A031) EXTSNS?                          */ 03620000
*/*               P SET CMD CODE FROM SENSE BYTE 5                   */ 03621000
*/*%A031:         P COPY FLGS XCPT PCI FROM ERRCCW                   */ 03622000
*/*IDALCK:        D (YES,,MO,OFLOCALC) IDAL (ERCCW)                  */ 03623000
*/*               S GETBLOK:GET CORE FOR IDAL                        */ 03624000
*/*               P COPY IDAL TO GOTTEN CORE                         */ 03625000
*/*               P POINT OFLO CCW TO IDAL                           */ 03626000
*/*OFLOCALC:      P FDISP = ERCCW CNT - CSW RESID                    */ 03627000
*/*               P WKRG1 = ADDR(DOFLOCCW)                           */ 03628000
*/*               D (YES,,NO,%A032) IDAW?                            */ 03629000
*/*               S ADDRCALC:RESOLVE TO IDAW + DISP                  */ 03630000
*/*               P OFLOARG = WKRG1 (POINT TO IDAW)                  */ 03631000
*/*%A032:         P UPDATE DATA ADDR + FDISP                         */ 03632000
*/*               D (YES,,NO,%A033) RESID = 0?                       */ 03633000
*/*               P (,RESTART) CNT=1. SKIP FLG = 1.                  */ 03634000
*/*%A033:         P (,RESTART) CNT = RESID                           */ 03635000
*/*SKUPDAT:       E SKUPDAT                                          */ 03636000
*/*               P POINT TO DEV CHAR TBL                            */ 03637000
*/*               P INCR HD                                          */ 03638000
*/*               D (YES,,NO,XTNTCK) HD BEYOND LIMIT?                */ 03639000
*/*               P HD = 0                                           */ 03640000
*/*               P INCR CYL                                         */ 03641000
*/*XTNTCK:        E XTNTCK                                           */ 03642000
*/*               S XTNT-DVR:CALL XTNT DVR PER DVR ID IN IOSB        */ 03643000
*/*               D (YES,,NO,EXIT12) XTNT OK?                        */ 03644000
*/*               R RETURN TO CALLER                                 */ 03645000
*/*EXIT12:        P CLEAR ALL ERP FLGS                               */ 03646000
*/*               P IOSERR=0 IOSLOG=0                                */ 03647000
*/*               S RESTORE:RESTORE IOSCKEY,OPTS & RST               */ 03648000
*/*               P RESTORE REGS                                     */ 03649000
*/*               R R14+12 POST PER IOSCOD                           */ 03650000
*/*LOGSAVE:       E LOGSAVE                                          */ 03651000
*/*               D (NO,,YES,LOGSAVE) ZEUS LOG?                      */ 03652000
*/*               D (NO,LOGSAVE,YES,%A034) FORMAT 6?                 */ 03653000
*/*%A034:         D (NO,GETLOGBK,YES,MDRCK) IOSLOG = 1?              */ 03654000
*/*LOGSAVE:       E LOGSAVE                                          */ 03655000
*/*               D (NO,GETLOGBK,YES,LOGRTRN) IOSLOG = 1?            */ 03656000
*/*GETLOGBK:      S GETBLOCK:GET EXTENSION FOR LOG INFO              */ 03657000
*/*               P EWADDISP = ADDR RCD AREA                         */ 03658000
*/*               P IOSLOG = 1.                                      */ 03659000
*/*MDRCK:         P CLEAR RCD AREA                                   */ 03660000
*/*               D (YES,,NO,OBRSAVE) ERPRDLOG OR FORMAT 6 ?         */ 03661000
*/*               P EWAMDR = 1.                                      */ 03662000
*/*               D (YES,,NO,SNSMDR) ZEUS LOG ?                      */ 03663000
*/*               P SET RCD SIZE = 154                               */ 03664000
*/*               P (,SETCUA) SET RCDID                              */ 03665000
*/*SNSMDR:        P SET RCD SIZE = 56                                */ 03666000
*/*               P SET UNIT TYPE, VOL SER & SENSE.                  */ 03667000
*/*SETCUA:        P (,LOGRTRN) SET CHAN UNIT ADDR.                   */ 03668000
*/*OBRSAVE:       P SAVE OBR INFO. IOSLOG=1.                         */ 03669000
*/*LOGRTRN:       R RETURN TO CALLER                                 */ 03670000
*/*MERWCK:        E MERWCK                                           */ 03671000
*/*               D (NO,,YES,%A035) WINCHESTER?                      */ 03672000
*/*MERCK:         E MERCK                                            */ 03673000
*/*               D (N0,,YES,%A035) MERLIN?                          */ 03674000
*/*               D (NO,,YES,%A035) ICEBERG?                         */ 03675000
*/*%A035:         R RETURN W COND CD                                 */ 03676000
*/*CPBLD:         E CPBLD                                            */ 03677000
*/*               P ERPCP=1                                          */ 03678000
*/*               P SET 'TOO' ADDR & START ADDR (IOSRST)             */ 03679000
*/*EXREGLD:       P LOAD RELOCATE REG                                */ 03680000
*/*               P SET OP CD & DATA ADDR                            */ 03681000
*/*               P SET FLGS & LGTH                                  */ 03682000
*/*               P ZERO HI-ORDER LGTH BYTE                          */ 03683000
*/*               D (YES,,NO,%A036) END FLG?                         */ 03684000
*/*               R RETURN TO CALLER                                 */ 03685000
*/*%A036:         P CPFRG = *+8                                      */ 03686000
*/*               P (,EXREGLD) WORKRG1 = *+8                         */ 03687000
*/*TICBLD:        E TICBLD                                           */ 03688000
*/*               P WORKRG1 = *+8                                    */ 03689000
*/*               D (YES,,NO,%A037) CCW A TIC?                       */ 03690000
*/*               P POINT TO TIC ARG                                 */ 03691000
*/*%A037:         P BLD TIC                                          */ 03692000
*/*               R RETURN TO CALLER                                 */ 03693000
*/*IECVDERP:      END                                                */ 03694000
@DATA    DS    0H                                                       03695000
@CH00081 DC    H'1'                                                     03696000
@CH02026 DC    H'12'                                                    03697000
@CH00095 DC    H'56'                                                    03698000
@CH00093 DC    H'154'                                                   03699000
@CH00090 DC    H'2048'                                                  03700000
@SM02066 MVC   MDRSNS(0,@15),EWDASNS(EWAPTR)                            03701000
@SM02069 MVC   OBRSNS(0,@15),EWDASNS(EWAPTR)                            03702000
@DATD    DSECT                                                          03703000
         DS    0F                                                       03704000
IECVDERP CSECT                                                          03705000
         DS    0F                                                       03706000
@CF00088 DC    F'4'                                                     03707000
@CF00073 DC    F'8'                                                     03708000
@CF00052 DC    F'16'                                                    03709000
@CF00055 DC    XL4'0000FFFF'                                            03710000
@CF01989 DC    XL4'30000020'                                            03711000
@CF01993 DC    XL4'10000020'                                            03712000
@DATD    DSECT                                                          03713000
         DS    0D                                                       03714000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03715000
@ENDDATD EQU   *                                                        03716000
IECVDERP CSECT                                                          03717000
         DS    0F                                                       03718000
@SIZDATD DC    AL1(0)                                                   03719000
         DC    AL3(@ENDDATD-@DATD)                                      03720000
@CV00032 DC    V(IECVSMGR)                                              03721000
@CV00033 DC    V(IEAPTRV)                                               03722000
@CA00034 DC    A(IEAMASCB)                                              03723000
         DS    0D                                                       03724000
@CB01943 DC    X'0C40'                                                  03725000
@CB00242 DC    X'00'                                                    03726000
         DS    CL1                                                      03727000
FOXFOX   DC    X'0000FFFF'                                              03728000
VDERPID  DC    CL90'IECVDERP SU24 04/28/78            UZ18162 '         03729000
         DS    CL2                                                      03730000
IECVDIRQ DS    CL8                                                      03731000
         ORG   IECVDIRQ                                                 03732000
WTODIRQ  DC    A(0)                                                     03733000
OBRDIRQ  DC    A(0)                                                     03734000
         ORG   IECVDIRQ+8                                               03735000
MASKBYTE DS    CL1                                                      03736000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03737000
@01      EQU   01                                                       03738000
@02      EQU   02                                                       03739000
@03      EQU   03                                                       03740000
@04      EQU   04                                                       03741000
@05      EQU   05                                                       03742000
@06      EQU   06                                                       03743000
@07      EQU   07                                                       03744000
@08      EQU   08                                                       03745000
@09      EQU   09                                                       03746000
@10      EQU   10                                                       03747000
@11      EQU   11                                                       03748000
@12      EQU   12                                                       03749000
@13      EQU   13                                                       03750000
@14      EQU   14                                                       03751000
@15      EQU   15                                                       03752000
IOSBRG   EQU   @01                                                      03753000
CCWRG1   EQU   @02                                                      03754000
WKRG1    EQU   @03                                                      03755000
FRRRG    EQU   @04                                                      03756000
WKRG2    EQU   @05                                                      03757000
BASEREG2 EQU   @06                                                      03758000
UCBRG    EQU   @07                                                      03759000
CCWRG    EQU   @08                                                      03760000
BASERG   EQU   @09                                                      03761000
EWAPTR   EQU   @10                                                      03762000
EWARG    EQU   @10                                                      03763000
WKRG3    EQU   @11                                                      03764000
WKRG12   EQU   @12                                                      03765000
CALLRG   EQU   @15                                                      03766000
RTRNRG   EQU   @14                                                      03767000
         ENTRY IECVDIRQ                                                 03768000
         EXTRN IEAMASCB                                                 03769000
CVTPTR   EQU   16                                                       03770000
DIRCHNPT EQU   0                                                        03771000
IOSB     EQU   0                                                        03772000
IOSFLA   EQU   IOSB                                                     03773000
IOSACHN  EQU   IOSFLA                                                   03774000
IOSERR   EQU   IOSFLA                                                   03775000
IOSSMDB  EQU   IOSFLA                                                   03776000
IOSEX    EQU   IOSFLA                                                   03777000
IOSFLB   EQU   IOSB+1                                                   03778000
IOSMSG   EQU   IOSFLB                                                   03779000
IOSLOG   EQU   IOSFLB                                                   03780000
IOSFLC   EQU   IOSB+2                                                   03781000
IOSDVALT EQU   IOSFLC                                                   03782000
IOSPROC  EQU   IOSB+3                                                   03783000
IOSDVRID EQU   IOSB+4                                                   03784000
IOSASID  EQU   IOSB+6                                                   03785000
IOSPKEY  EQU   IOSB+12                                                  03786000
IOSIDR   EQU   IOSPKEY                                                  03787000
IOSCOD   EQU   IOSB+13                                                  03788000
IOSOPT   EQU   IOSB+14                                                  03789000
IOSBYP   EQU   IOSOPT                                                   03790000
IOSDEP   EQU   IOSOPT                                                   03791000
IOSOPT2  EQU   IOSB+15                                                  03792000
@NM00002 EQU   IOSB+20                                                  03793000
IOSCC    EQU   @NM00002                                                 03794000
IOSCSW   EQU   @NM00002+1                                               03795000
IOSCSWCA EQU   IOSCSW                                                   03796000
IOSTATUS EQU   IOSCSW+3                                                 03797000
IOSTSA   EQU   IOSTATUS                                                 03798000
IOSCSWRC EQU   IOSCSW+5                                                 03799000
IOSSRB   EQU   IOSB+28                                                  03800000
IOSSNS   EQU   IOSB+42                                                  03801000
IOSIPIB  EQU   IOSB+44                                                  03802000
IOSERP   EQU   IOSB+52                                                  03803000
IOSRST   EQU   IOSB+72                                                  03804000
IOSVST   EQU   IOSB+76                                                  03805000
IOSPATH  EQU   IOSB+86                                                  03806000
IOSCHN   EQU   IOSPATH                                                  03807000
IOSFMSK  EQU   IOSB+88                                                  03808000
IOSCKEY  EQU   IOSB+89                                                  03809000
IOSEEK   EQU   IOSB+92                                                  03810000
IOSEEKA  EQU   IOSB+100                                                 03811000
IOSCCHH  EQU   IOSEEKA+3                                                03812000
IOSSKCC  EQU   IOSCCHH                                                  03813000
IOSSKHH  EQU   IOSCCHH+2                                                03814000
IOSSKH2  EQU   IOSSKHH+1                                                03815000
IOSEND   EQU   IOSB+108                                                 03816000
EWA      EQU   0                                                        03817000
EWAHDR   EQU   EWA                                                      03818000
EWAEXT   EQU   EWAHDR                                                   03819000
EWAFLAGS EQU   EWA+4                                                    03820000
EWAFLG1  EQU   EWAFLAGS                                                 03821000
EWASCCD  EQU   EWAFLG1                                                  03822000
EWASCC3  EQU   EWASCCD                                                  03823000
EWADDMSG EQU   EWAFLG1                                                  03824000
EWABDSNS EQU   EWAFLG1                                                  03825000
EWAFLG2  EQU   EWAFLAGS+1                                               03826000
EWAMDR   EQU   EWAFLG2                                                  03827000
EWAFLG3  EQU   EWAFLAGS+2                                               03828000
EWASNSCT EQU   EWAFLAGS+3                                               03829000
EWASSTAT EQU   EWA+8                                                    03830000
EWACNTRS EQU   EWA+10                                                   03831000
EWACNTR1 EQU   EWACNTRS                                                 03832000
EWACNTR2 EQU   EWACNTRS+1                                               03833000
EWACNTR3 EQU   EWACNTRS+2                                               03834000
EWAERPIB EQU   EWA+16                                                   03835000
EWARGFG1 EQU   EWAERPIB+4                                               03836000
EWANORTY EQU   EWARGFG1                                                 03837000
EWARGFG2 EQU   EWAERPIB+5                                               03838000
EWAXCSW1 EQU   EWAERPIB+6                                               03839000
EWAXCSW2 EQU   EWAERPIB+7                                               03840000
EWACHA   EQU   EWA+24                                                   03841000
EWADCNT  EQU   EWA+28                                                   03842000
EWADDISP EQU   EWA+29                                                   03843000
EWAIERP  EQU   EWA+32                                                   03844000
DAIDAW   EQU   0                                                        03845000
IDAWLEN  EQU   DAIDAW+2                                                 03846000
DASKARG  EQU   0                                                        03847000
DAXSNS   EQU   0                                                        03848000
RSTHD    EQU   DAXSNS+6                                                 03849000
MSSERMSG EQU   DAXSNS+7                                                 03850000
FMTSNS   EQU   MSSERMSG                                                 03851000
FMTBITS  EQU   FMTSNS                                                   03852000
FMT6BITS EQU   FMTBITS                                                  03853000
RSTCCHHR EQU   DAXSNS+8                                                 03854000
RSTCCHH  EQU   RSTCCHHR                                                 03855000
RSTDISP  EQU   DAXSNS+15                                                03856000
BKDISP   EQU   DAXSNS+18                                                03857000
MSSERRCD EQU   BKDISP                                                   03858000
ECCSYN   EQU   DAXSNS+20                                                03859000
ERSYM    EQU   DAXSNS+23                                                03860000
CULGTH   EQU   ERSYM                                                    03861000
DTABNDX  EQU   0                                                        03862000
DTABNTRY EQU   0                                                        03863000
DNOTKCYL EQU   DTABNTRY+2                                               03864000
DISPSAV  EQU   0                                                        03865000
FDISP    EQU   DISPSAV                                                  03866000
ECNT     EQU   DISPSAV+2                                                03867000
RSTRTDSP EQU   DISPSAV+5                                                03868000
ECCBYTE  EQU   0                                                        03869000
DAFLG1   EQU   0                                                        03870000
ERPOCSW  EQU   DAFLG1                                                   03871000
DAFLG2   EQU   0                                                        03872000
ERPRDLOG EQU   DAFLG2                                                   03873000
ERPRECAL EQU   DAFLG2                                                   03874000
ERPRHA   EQU   DAFLG2                                                   03875000
ERPCP    EQU   DAFLG2                                                   03876000
ERPBADHA EQU   DAFLG2                                                   03877000
ERPOFLO  EQU   DAFLG2                                                   03878000
ERPREV   EQU   DAFLG2                                                   03879000
ERPCYLSW EQU   DAFLG2                                                   03880000
ISNS     EQU   0                                                        03881000
ISNEQPCK EQU   ISNS                                                     03882000
ISNSSKCK EQU   ISNS                                                     03883000
ISNSOFLO EQU   ISNS+1                                                   03884000
DACCW    EQU   0                                                        03885000
COPARG   EQU   DACCW                                                    03886000
CCWOP    EQU   COPARG                                                   03887000
MTOP     EQU   CCWOP                                                    03888000
SCHOPA   EQU   CCWOP                                                    03889000
CNTOP    EQU   CCWOP                                                    03890000
TICBITS  EQU   CCWOP                                                    03891000
SEEKOP   EQU   TICBITS                                                  03892000
SCHOPB   EQU   SEEKOP                                                   03893000
CCWDATA  EQU   COPARG+1                                                 03894000
CFLGLEN  EQU   DACCW+4                                                  03895000
CCWFLG   EQU   CFLGLEN                                                  03896000
DCHNBIT  EQU   CCWFLG                                                   03897000
CCHNBIT  EQU   CCWFLG                                                   03898000
SLIBIT   EQU   CCWFLG                                                   03899000
SKIPBIT  EQU   CCWFLG                                                   03900000
IDABIT   EQU   CCWFLG                                                   03901000
CPBLDFLG EQU   CFLGLEN+1                                                03902000
CCWCNT   EQU   CFLGLEN+2                                                03903000
CPBLDPOS EQU   CCWCNT                                                   03904000
FTRCCW   EQU   0                                                        03905000
FTROP    EQU   FTRCCW                                                   03906000
FTRDATA  EQU   FTRCCW+1                                                 03907000
FTRFLG   EQU   FTRCCW+4                                                 03908000
FTRSKP   EQU   FTRFLG                                                   03909000
FTRCNT   EQU   FTRCCW+6                                                 03910000
DOFLOCCW EQU   0                                                        03911000
OFLOOP   EQU   DOFLOCCW                                                 03912000
OFLOARG  EQU   DOFLOCCW+1                                               03913000
OFLOFLG  EQU   DOFLOCCW+4                                               03914000
OFLOSLI  EQU   OFLOFLG                                                  03915000
OFLOSKIP EQU   OFLOFLG                                                  03916000
OFLOPCI  EQU   OFLOFLG                                                  03917000
OFLOCNT  EQU   DOFLOCCW+6                                               03918000
ERPIDAL  EQU   0                                                        03919000
USERIDAL EQU   0                                                        03920000
DAFMSK   EQU   0                                                        03921000
MSKNORST EQU   DAFMSK                                                   03922000
ICSWSTAT EQU   0                                                        03923000
IUNITCK  EQU   ICSWSTAT                                                 03924000
ICCCK    EQU   ICSWSTAT+1                                               03925000
IINTCCK  EQU   ICSWSTAT+1                                               03926000
ECSWSTAT EQU   0                                                        03927000
EUNITCK  EQU   ECSWSTAT                                                 03928000
EPCI     EQU   ECSWSTAT+1                                               03929000
EINCLGTH EQU   ECSWSTAT+1                                               03930000
EPGMCK   EQU   ECSWSTAT+1                                               03931000
EPROTCK  EQU   ECSWSTAT+1                                               03932000
ECDATACK EQU   ECSWSTAT+1                                               03933000
EINTCCK  EQU   ECSWSTAT+1                                               03934000
ECHCK    EQU   ECSWSTAT+1                                               03935000
EIOSCC   EQU   0                                                        03936000
ECC1OR3  EQU   EIOSCC                                                   03937000
ESNS2    EQU   0                                                        03938000
EEMU     EQU   ESNS2                                                    03939000
ESNS4    EQU   0                                                        03940000
ESTRG    EQU   ESNS4                                                    03941000
EST0     EQU   ESTRG                                                    03942000
EST1     EQU   ESTRG                                                    03943000
ESNS10   EQU   0                                                        03944000
DMCHECK  EQU   ESNS10                                                   03945000
INTERFLG EQU   0                                                        03946000
INTFLG1  EQU   INTERFLG+7                                               03947000
INTLOG   EQU   INTFLG1                                                  03948000
DAMDR    EQU   0                                                        03949000
MDRCDSIZ EQU   DAMDR                                                    03950000
WKA      EQU   DAMDR+2                                                  03951000
WKACUA   EQU   WKA                                                      03952000
WKACHA   EQU   WKACUA                                                   03953000
WKAUA    EQU   WKACUA+1                                                 03954000
WKABIT2  EQU   WKAUA                                                    03955000
WKASTRG  EQU   WKAUA                                                    03956000
WKASTRG0 EQU   WKASTRG                                                  03957000
WKASTRG1 EQU   WKASTRG                                                  03958000
WKASNS4  EQU   WKA+2                                                    03959000
MDRID    EQU   DAMDR+5                                                  03960000
MDRCUA   EQU   DAMDR+24                                                 03961000
MDRZLOG  EQU   DAMDR+26                                                 03962000
MDRVOL   EQU   MDRZLOG                                                  03963000
MDRSNS   EQU   MDRZLOG+6                                                03964000
DAOBR    EQU   0                                                        03965000
OBRVOL   EQU   DAOBR                                                    03966000
OBRSKA   EQU   DAOBR+9                                                  03967000
OBRHOMAD EQU   DAOBR+18                                                 03968000
OBRCSW   EQU   DAOBR+25                                                 03969000
OBRCCW   EQU   DAOBR+32                                                 03970000
OBRSNS   EQU   DAOBR+40                                                 03971000
OBRSNS2  EQU   OBRSNS+2                                                 03972000
UCB      EQU   0                                                        03973000
UCBOB    EQU   0                                                        03974000
UCBJBNR  EQU   UCBOB                                                    03975000
UCBFL5   EQU   UCBOB+1                                                  03976000
UCBAF    EQU   UCBFL5                                                   03977000
UCBENVRD EQU   UCBFL5                                                   03978000
UCBSTAT  EQU   UCBOB+3                                                  03979000
UCBCHAN  EQU   UCBOB+4                                                  03980000
UCBSFLS  EQU   UCBOB+6                                                  03981000
UCBFLA   EQU   UCBSFLS                                                  03982000
UCBFL1   EQU   UCBFLA                                                   03983000
UCBBSY   EQU   UCBFL1                                                   03984000
UCBNRY   EQU   UCBFL1                                                   03985000
UCBPST   EQU   UCBFL1                                                   03986000
UCBCUB   EQU   UCBFL1                                                   03987000
UCBFLB   EQU   UCBSFLS+1                                                03988000
UCBCHM   EQU   UCBOB+8                                                  03989000
UCBCHM1  EQU   UCBCHM                                                   03990000
UCBPTH0  EQU   UCBCHM1                                                  03991000
UCBPTH1  EQU   UCBCHM1                                                  03992000
UCBWGT   EQU   UCBOB+12                                                 03993000
UCBNAME  EQU   UCBOB+13                                                 03994000
UCBTYP   EQU   UCBOB+16                                                 03995000
UCBTBYT1 EQU   UCBTYP                                                   03996000
UCB1FEA5 EQU   UCBTBYT1                                                 03997000
UCB1FEA6 EQU   UCBTBYT1                                                 03998000
UCBTBYT2 EQU   UCBTYP+1                                                 03999000
UCB2OPT2 EQU   UCBTBYT2                                                 04000000
UCBDUDN1 EQU   UCB2OPT2                                                 04001000
UCB2OPT3 EQU   UCBTBYT2                                                 04002000
UCBDUDN2 EQU   UCB2OPT3                                                 04003000
UCBRPS   EQU   UCBDUDN2                                                 04004000
UCB2OPT4 EQU   UCBTBYT2                                                 04005000
UCBRWTAU EQU   UCB2OPT4                                                 04006000
UCBRVDEV EQU   UCBRWTAU                                                 04007000
UCB2OPT6 EQU   UCBTBYT2                                                 04008000
UCB2OPT7 EQU   UCBTBYT2                                                 04009000
UCBTBYT3 EQU   UCBTYP+2                                                 04010000
UCBDVCLS EQU   UCBTBYT3                                                 04011000
UCBTBYT4 EQU   UCBTYP+3                                                 04012000
UCBEXTPT EQU   UCBOB+20                                                 04013000
UCBFLC   EQU   UCBEXTPT                                                 04014000
UCBDEV   EQU   UCBOB+24                                                 04015000
UCBCMEXT EQU   0                                                        04016000
UCBATI   EQU   UCBCMEXT+3                                               04017000
@NM00055 EQU   UCBATI                                                   04018000
UCBSNSCT EQU   UCBCMEXT+4                                               04019000
UCBFLP1  EQU   UCBCMEXT+5                                               04020000
UCBMT    EQU   0                                                        04021000
UCBOCR   EQU   0                                                        04022000
UCB3540X EQU   0                                                        04023000
UCBDKBYT EQU   UCB3540X+6                                               04024000
UCB3800X EQU   0                                                        04025000
UCBOPTNS EQU   UCB3800X                                                 04026000
UCBACTIV EQU   UCB3800X+3                                               04027000
UCBMDRBF EQU   UCB3800X+36                                              04028000
UCBUCS   EQU   0                                                        04029000
UCBUCSOP EQU   UCBUCS+4                                                 04030000
UCBFCBOP EQU   UCBUCS+5                                                 04031000
CVTMAP   EQU   0                                                        04032000
CVTZDTAB EQU   CVTMAP+64                                                04033000
CVTXITP  EQU   CVTMAP+68                                                04034000
CVTDAR   EQU   CVTMAP+72                                                04035000
CVTFLGS1 EQU   CVTDAR                                                   04036000
CVTDCB   EQU   CVTMAP+116                                               04037000
CVTIOQET EQU   CVTMAP+120                                               04038000
CVTIXAVL EQU   CVTMAP+124                                               04039000
CVTIERLC EQU   CVTMAP+144                                               04040000
CVTHEAD  EQU   CVTMAP+160                                               04041000
CVTSV76C EQU   CVTHEAD                                                  04042000
CVTOPTA  EQU   CVTMAP+182                                               04043000
CVTOPTB  EQU   CVTMAP+183                                               04044000
CVTGTF   EQU   CVTMAP+236                                               04045000
CVTGTFST EQU   CVTGTF                                                   04046000
CVTGTFS  EQU   CVTGTFST                                                 04047000
CVTSTATE EQU   CVTGTFST                                                 04048000
CVTTMODE EQU   CVTGTFST                                                 04049000
CVTFORM  EQU   CVTGTFST                                                 04050000
CVTAQAVT EQU   CVTMAP+240                                               04051000
CVTTCMFG EQU   CVTAQAVT                                                 04052000
CVTVOLM2 EQU   CVTMAP+244                                               04053000
CVTTATA  EQU   CVTVOLM2                                                 04054000
CVTTSKS  EQU   CVTTATA                                                  04055000
CVTVOLF2 EQU   CVTTSKS                                                  04056000
CVTTAT   EQU   CVTTATA+1                                                04057000
CVTATER  EQU   CVTMAP+248                                               04058000
CVTEXT1  EQU   CVTMAP+252                                               04059000
CVTPURG  EQU   CVTMAP+260                                               04060000
CVTQMSG  EQU   CVTMAP+268                                               04061000
CVTDMSR  EQU   CVTMAP+272                                               04062000
CVTRSV37 EQU   CVTDMSR                                                  04063000
CVTDMSRF EQU   CVTRSV37                                                 04064000
CVTERPV  EQU   CVTMAP+316                                               04065000
CVTINTLA EQU   CVTMAP+320                                               04066000
CVTAPF   EQU   CVTMAP+324                                               04067000
CVTEXT2  EQU   CVTMAP+328                                               04068000
CVTHJES  EQU   CVTMAP+332                                               04069000
CVTPGSIA EQU   CVTMAP+348                                               04070000
CVTA1F1  EQU   CVTMAP+356                                               04071000
CVTSYSK  EQU   CVTMAP+357                                               04072000
CVTVOLM1 EQU   CVTMAP+380                                               04073000
CVTVOLF1 EQU   CVTVOLM1                                                 04074000
CVTATMCT EQU   CVTMAP+388                                               04075000
CVTXTNT1 EQU   0                                                        04076000
CVTXTNT2 EQU   0                                                        04077000
CVTDSSV  EQU   CVTXTNT2                                                 04078000
CVTFLGBT EQU   CVTXTNT2+5                                               04079000
CVTQID   EQU   CVTXTNT2+24                                              04080000
CVTRV400 EQU   CVTXTNT2+52                                              04081000
CVTRV409 EQU   CVTXTNT2+53                                              04082000
CVTATCVT EQU   CVTXTNT2+64                                              04083000
CVTRV429 EQU   CVTXTNT2+84                                              04084000
CVTRV438 EQU   CVTXTNT2+85                                              04085000
CVTRV457 EQU   CVTXTNT2+112                                             04086000
CVTRV466 EQU   CVTXTNT2+113                                             04087000
CVTFIX   EQU   0                                                        04088000
CVTRELNO EQU   CVTFIX+252                                               04089000
IOCOM    EQU   0                                                        04090000
IOCVOID  EQU   IOCOM+32                                                 04091000
VOID     EQU   0                                                        04092000
VOIENTRY EQU   VOID                                                     04093000
VOIEXTNT EQU   VOID+8                                                   04094000
SRBSECT  EQU   0                                                        04095000
SRB      EQU   SRBSECT                                                  04096000
SRBFLNK  EQU   SRB+4                                                    04097000
SRBASCB  EQU   SRB+8                                                    04098000
SRBFLC   EQU   SRB+12                                                   04099000
SRBPASID EQU   SRBFLC+2                                                 04100000
SRBPARM  EQU   SRB+28                                                   04101000
UCBBGN   EQU   0                                                        04102000
IOSATTSC EQU   IOSIPIB                                                  04103000
IOSWTOWA EQU   IOSIPIB                                                  04104000
IOSPCISC EQU   IOSIPIB                                                  04105000
EWADDIOS EQU   EWAIERP                                                  04106000
EWADAREA EQU   EWAIERP                                                  04107000
EWDASNS  EQU   EWADAREA                                                 04108000
EWDSNS0  EQU   EWDASNS                                                  04109000
EWDINT   EQU   EWDSNS0                                                  04110000
EWDEQU   EQU   EWDSNS0                                                  04111000
EWDTCC   EQU   EWDSNS0                                                  04112000
EWDSKCK  EQU   EWDSNS0                                                  04113000
EWDSNS1  EQU   EWDASNS+1                                                04114000
EWDMAM   EQU   EWDSNS1                                                  04115000
EWDOFLO  EQU   EWDSNS1                                                  04116000
EWDSNS2  EQU   EWDASNS+2                                                04117000
EWDZLOG  EQU   EWDSNS2                                                  04118000
EWDWRPS  EQU   EWDZLOG                                                  04119000
EWDMDA1  EQU   EWDWRPS                                                  04120000
EWDCORR  EQU   EWDSNS2                                                  04121000
EWD22    EQU   EWDSNS2                                                  04122000
EWDMDA2  EQU   EWD22                                                    04123000
EWDEDAT  EQU   EWDSNS2                                                  04124000
EWDSNS3  EQU   EWDASNS+3                                                04125000
EWDSNS4  EQU   EWDASNS+4                                                04126000
EWDSNS5  EQU   EWDASNS+5                                                04127000
EWDSNS8  EQU   EWDASNS+8                                                04128000
EWDSNS10 EQU   EWDASNS+10                                               04129000
EWDSNS24 EQU   EWDASNS+24                                               04130000
EWDRZRO  EQU   EWDSNS24                                                 04131000
EWDSAVKY EQU   EWADAREA+28                                              04132000
EWDSAVOP EQU   EWADAREA+29                                              04133000
EWDSAVS  EQU   EWADAREA+30                                              04134000
EWDSAVC  EQU   EWADAREA+32                                              04135000
EWDHOMAD EQU   EWADAREA+39                                              04136000
EWDHAFLG EQU   EWDHOMAD                                                 04137000
EWDHADEF EQU   EWDHAFLG                                                 04138000
EWDCCHH  EQU   EWDHOMAD+1                                               04139000
EWDHARNO EQU   EWDHOMAD+5                                               04140000
EWDCCW1  EQU   EWADAREA+48                                              04141000
EWDCCW2  EQU   EWADAREA+56                                              04142000
EWDCCW3  EQU   EWADAREA+64                                              04143000
EWDCCW4  EQU   EWADAREA+72                                              04144000
EWDCCW5  EQU   EWADAREA+80                                              04145000
EWDCCW6  EQU   EWADAREA+88                                              04146000
EWDCCW8  EQU   EWADAREA+104                                             04147000
EWDCCW9  EQU   EWADAREA+112                                             04148000
EWDCCWA  EQU   EWADAREA+120                                             04149000
UCBOBS01 EQU   UCBDEV                                                   04150000
UCBVOLI  EQU   UCBOBS01+4                                               04151000
UCBSTAB  EQU   UCBOBS01+10                                              04152000
UCBBSVL  EQU   UCBSTAB                                                  04153000
UCBPRSRS EQU   UCBSTAB                                                  04154000
UCBDMCT  EQU   UCBOBS01+11                                              04155000
UCBFL4   EQU   UCBOBS01+13                                              04156000
UCBOBS02 EQU   UCBDEV                                                   04157000
UCBTFL1  EQU   UCBOBS02+19                                              04158000
UCBXTN   EQU   UCBOBS02+20                                              04159000
UCBVOPT  EQU   UCBXTN                                                   04160000
UCBOBS03 EQU   UCBDEV                                                   04161000
UCBXTADR EQU   UCBOBS03                                                 04162000
UCBOBS04 EQU   UCBDEV                                                   04163000
UCBBTA   EQU   UCBOBS04+12                                              04164000
UCBOBS06 EQU   UCBDEV                                                   04165000
UCBAOF   EQU   UCBOBS06                                                 04166000
UCBAOF1  EQU   UCBAOF                                                   04167000
UCBAOF2  EQU   UCBAOF+1                                                 04168000
@NM00054 EQU   UCBOBS06+3                                               04169000
UCBIRB   EQU   UCBOBS06+4                                               04170000
UCBGRAF  EQU   UCBIRB                                                   04171000
UCBLDNCA EQU   UCBOBS06+8                                               04172000
UCBRDYQ  EQU   UCBLDNCA                                                 04173000
UCBIRLN  EQU   UCBRDYQ                                                  04174000
UCBLDNCB EQU   UCBRDYQ+1                                                04175000
UCBCTLNK EQU   UCBOBS06+12                                              04176000
UCBOBS07 EQU   UCBDEV                                                   04177000
UCBOBS08 EQU   UCBDEV                                                   04178000
UCBCTCAD EQU   UCBOBS08                                                 04179000
UCBCTCF1 EQU   UCBOBS08+4                                               04180000
UCBOBS09 EQU   UCBDEV                                                   04181000
CVTS01   EQU   CVTPGSIA                                                 04182000
CVTLPDIA EQU   CVTS01+12                                                04183000
CVTDIRST EQU   CVTLPDIA                                                 04184000
CVTSLIDA EQU   CVTS01+24                                                04185000
CVTCTLFG EQU   CVTS01+50                                                04186000
CVTLSMQ  EQU   CVTS01+268                                               04187000
CVTRV210 EQU   CVTS01+424                                               04188000
CVTRV219 EQU   CVTS01+425                                               04189000
CVTRV228 EQU   CVTS01+426                                               04190000
CVTRV237 EQU   CVTS01+427                                               04191000
CVTMFRTR EQU   CVTS01+452                                               04192000
CVTRV262 EQU   CVTS01+468                                               04193000
CVTRV271 EQU   CVTS01+469                                               04194000
CVTRV280 EQU   CVTS01+470                                               04195000
CVTRV289 EQU   CVTS01+471                                               04196000
CVTGSDA  EQU   CVTS01+600                                               04197000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    04198000
CVTRV628 EQU   CVTS01+728                                               04199000
CVTRV627 EQU   CVTS01+724                                               04200000
CVTRV626 EQU   CVTS01+720                                               04201000
CVTRV625 EQU   CVTS01+716                                               04202000
CVTRV624 EQU   CVTS01+712                                               04203000
CVTRV623 EQU   CVTS01+708                                               04204000
CVTRV622 EQU   CVTS01+704                                               04205000
CVTRV621 EQU   CVTS01+700                                               04206000
CVTIHASU EQU   CVTS01+696                                               04207000
CVTSUSP  EQU   CVTS01+692                                               04208000
CVTT6SVC EQU   CVTS01+688                                               04209000
CVTCDAL  EQU   CVTS01+684                                               04210000
CVTTCTL  EQU   CVTS01+680                                               04211000
CVTRSUME EQU   CVTS01+676                                               04212000
CVTJTERM EQU   CVTS01+672                                               04213000
CVTASMRM EQU   CVTS01+668                                               04214000
CVTTCASP EQU   CVTS01+664                                               04215000
CVT0PT03 EQU   CVTS01+660                                               04216000
CVT0PT0E EQU   CVTS01+656                                               04217000
CVTRV609 EQU   CVTS01+652                                               04218000
CVTCGK   EQU   CVTS01+648                                               04219000
CVTRAC   EQU   CVTS01+644                                               04220000
CVTHSM   EQU   CVTS01+640                                               04221000
CVTRV605 EQU   CVTS01+636                                               04222000
CVTRV604 EQU   CVTS01+632                                               04223000
CVTEFF02 EQU   CVTS01+628                                               04224000
CVTCBBR  EQU   CVTS01+624                                               04225000
CVTSSCR  EQU   CVTS01+620                                               04226000
CVTEVENT EQU   CVTS01+616                                               04227000
CVTCRCA  EQU   CVTS01+612                                               04228000
CVTTPIO  EQU   CVTS01+608                                               04229000
CVTADV   EQU   CVTS01+604                                               04230000
CVTGSDAB EQU   CVTGSDA                                                  04231000
CVTQV3   EQU   CVTS01+596                                               04232000
CVTQV2   EQU   CVTS01+592                                               04233000
CVTQV1   EQU   CVTS01+588                                               04234000
CVTRPT   EQU   CVTS01+584                                               04235000
CVTSSRB  EQU   CVTS01+580                                               04236000
CVTCSDRL EQU   CVTS01+576                                               04237000
CVTEXP1  EQU   CVTS01+572                                               04238000
CVTRMPMT EQU   CVTS01+568                                               04239000
CVTRMPTT EQU   CVTS01+564                                               04240000
CVTVPSA  EQU   CVTS01+560                                               04241000
CVTVSTOP EQU   CVTS01+556                                               04242000
CVTGTFR8 EQU   CVTS01+552                                               04243000
CVTQUIT  EQU   CVTS01+548                                               04244000
CVTVACR  EQU   CVTS01+544                                               04245000
CVTWTCB  EQU   CVTS01+540                                               04246000
CVTSTPRS EQU   CVTS01+536                                               04247000
CVT0PT02 EQU   CVTS01+532                                               04248000
CVTDARCM EQU   CVTS01+528                                               04249000
CVTIRECM EQU   CVTS01+524                                               04250000
CVTJRECM EQU   CVTS01+520                                               04251000
CVTVEMS0 EQU   CVTS01+516                                               04252000
CVTSPFRR EQU   CVTS01+512                                               04253000
CVTRLSTG EQU   CVTS01+508                                               04254000
CVT0TC0A EQU   CVTS01+504                                               04255000
CVTGMBR  EQU   CVTS01+500                                               04256000
CVTLFRM  EQU   CVTS01+496                                               04257000
CVTRMBR  EQU   CVTS01+492                                               04258000
CVTVIOP  EQU   CVTS01+488                                               04259000
CVTRV307 EQU   CVTS01+486                                               04260000
CVTRV306 EQU   CVTS01+484                                               04261000
CVTRV305 EQU   CVTS01+482                                               04262000
CVTRV304 EQU   CVTS01+480                                               04263000
CVTRV303 EQU   CVTS01+478                                               04264000
CVTRV302 EQU   CVTS01+476                                               04265000
CVTTRCA  EQU   CVTS01+472                                               04266000
CVTRV297 EQU   CVTRV289                                                 04267000
CVTRV296 EQU   CVTRV289                                                 04268000
CVTRV295 EQU   CVTRV289                                                 04269000
CVTRV294 EQU   CVTRV289                                                 04270000
CVTRV293 EQU   CVTRV289                                                 04271000
CVTRV292 EQU   CVTRV289                                                 04272000
CVTRV291 EQU   CVTRV289                                                 04273000
CVTRV290 EQU   CVTRV289                                                 04274000
CVTRV288 EQU   CVTRV280                                                 04275000
CVTRV287 EQU   CVTRV280                                                 04276000
CVTRV286 EQU   CVTRV280                                                 04277000
CVTRV285 EQU   CVTRV280                                                 04278000
CVTRV284 EQU   CVTRV280                                                 04279000
CVTRV283 EQU   CVTRV280                                                 04280000
CVTRV282 EQU   CVTRV280                                                 04281000
CVTRV281 EQU   CVTRV280                                                 04282000
CVTRV279 EQU   CVTRV271                                                 04283000
CVTRV278 EQU   CVTRV271                                                 04284000
CVTRV277 EQU   CVTRV271                                                 04285000
CVTRV276 EQU   CVTRV271                                                 04286000
CVTRV275 EQU   CVTRV271                                                 04287000
CVTRV274 EQU   CVTRV271                                                 04288000
CVTRV273 EQU   CVTRV271                                                 04289000
CVTRV272 EQU   CVTRV271                                                 04290000
CVTRV270 EQU   CVTRV262                                                 04291000
CVTRV269 EQU   CVTRV262                                                 04292000
CVTRV268 EQU   CVTRV262                                                 04293000
CVTRV267 EQU   CVTRV262                                                 04294000
CVTRV266 EQU   CVTRV262                                                 04295000
CVTRV265 EQU   CVTRV262                                                 04296000
CVTRV264 EQU   CVTRV262                                                 04297000
CVTRV263 EQU   CVTRV262                                                 04298000
CVTVFP   EQU   CVTS01+464                                               04299000
CVTVSI   EQU   CVTS01+460                                               04300000
CVTVPSIB EQU   CVTS01+456                                               04301000
CVTMFACT EQU   CVTMFRTR                                                 04302000
CVTMFCTL EQU   CVTS01+448                                               04303000
CVTPVBP  EQU   CVTS01+444                                               04304000
CVTPWI   EQU   CVTS01+440                                               04305000
CVTRV254 EQU   CVTS01+438                                               04306000
CVTRV253 EQU   CVTS01+436                                               04307000
CVTRV252 EQU   CVTS01+434                                               04308000
CVTRV251 EQU   CVTS01+433                                               04309000
CVTRV250 EQU   CVTS01+432                                               04310000
CVTRV249 EQU   CVTS01+431                                               04311000
CVTRV248 EQU   CVTS01+430                                               04312000
CVTRV247 EQU   CVTS01+429                                               04313000
CVTRV246 EQU   CVTS01+428                                               04314000
CVTRV245 EQU   CVTRV237                                                 04315000
CVTRV244 EQU   CVTRV237                                                 04316000
CVTRV243 EQU   CVTRV237                                                 04317000
CVTRV242 EQU   CVTRV237                                                 04318000
CVTRV241 EQU   CVTRV237                                                 04319000
CVTRV240 EQU   CVTRV237                                                 04320000
CVTRV239 EQU   CVTRV237                                                 04321000
CVTRV238 EQU   CVTRV237                                                 04322000
CVTRV236 EQU   CVTRV228                                                 04323000
CVTRV235 EQU   CVTRV228                                                 04324000
CVTRV234 EQU   CVTRV228                                                 04325000
CVTRV233 EQU   CVTRV228                                                 04326000
CVTRV232 EQU   CVTRV228                                                 04327000
CVTRV231 EQU   CVTRV228                                                 04328000
CVTRV230 EQU   CVTRV228                                                 04329000
CVTRV229 EQU   CVTRV228                                                 04330000
CVTRV227 EQU   CVTRV219                                                 04331000
CVTRV226 EQU   CVTRV219                                                 04332000
CVTRV225 EQU   CVTRV219                                                 04333000
CVTRV224 EQU   CVTRV219                                                 04334000
CVTRV223 EQU   CVTRV219                                                 04335000
CVTRV222 EQU   CVTRV219                                                 04336000
CVTRV221 EQU   CVTRV219                                                 04337000
CVTRV220 EQU   CVTRV219                                                 04338000
CVTRV218 EQU   CVTRV210                                                 04339000
CVTRV217 EQU   CVTRV210                                                 04340000
CVTRV216 EQU   CVTRV210                                                 04341000
CVTRV215 EQU   CVTRV210                                                 04342000
CVTRV214 EQU   CVTRV210                                                 04343000
CVTRV213 EQU   CVTRV210                                                 04344000
CVTRV212 EQU   CVTRV210                                                 04345000
CVTRV211 EQU   CVTRV210                                                 04346000
CVTLCCAT EQU   CVTS01+420                                               04347000
CVTPCCAT EQU   CVTS01+416                                               04348000
CVTIPCRP EQU   CVTS01+412                                               04349000
CVTIPCRI EQU   CVTS01+408                                               04350000
CVTIPCDS EQU   CVTS01+404                                               04351000
CVTAIDVT EQU   CVTS01+400                                               04352000
CVTSSAP  EQU   CVTS01+396                                               04353000
CVTEHCIR EQU   CVTS01+392                                               04354000
CVTEHDEF EQU   CVTS01+388                                               04355000
CVTDAIR  EQU   CVTS01+384                                               04356000
CVTPERFM EQU   CVTS01+380                                               04357000
CVT044R2 EQU   CVTS01+376                                               04358000
CVTFETCH EQU   CVTS01+372                                               04359000
CVTRSTWD EQU   CVTS01+368                                               04360000
CVTSPOST EQU   CVTS01+364                                               04361000
CVTIOBP  EQU   CVTS01+360                                               04362000
CVTASMVT EQU   CVTS01+356                                               04363000
CVTRECRQ EQU   CVTS01+352                                               04364000
CVTWSAC  EQU   CVTS01+348                                               04365000
CVTRV149 EQU   CVTS01+344                                               04366000
CVTWSAL  EQU   CVTS01+340                                               04367000
CVTSPSA  EQU   CVTS01+336                                               04368000
CVTGLMN  EQU   CVTS01+332                                               04369000
CVTVEAC0 EQU   CVTS01+328                                               04370000
CVT062R1 EQU   CVTS01+324                                               04371000
CVTRPOST EQU   CVTS01+320                                               04372000
CVTDQIQE EQU   CVTS01+316                                               04373000
CVTCSD   EQU   CVTS01+312                                               04374000
CVTLKRMA EQU   CVTS01+308                                               04375000
CVTRSPIE EQU   CVTS01+304                                               04376000
CVTRENQ  EQU   CVTS01+300                                               04377000
CVTLQCB  EQU   CVTS01+296                                               04378000
CVTFQCB  EQU   CVTS01+292                                               04379000
CVTQCS01 EQU   CVTS01+288                                               04380000
CVTAPFT  EQU   CVTS01+284                                               04381000
CVTPARRL EQU   CVTS01+280                                               04382000
CVTVWAIT EQU   CVTS01+276                                               04383000
CVTGSPL  EQU   CVTS01+272                                               04384000
CVTGSMQ  EQU   CVTS01+264                                               04385000
CVTEXPRO EQU   CVTS01+260                                               04386000
CVTOPCTP EQU   CVTS01+256                                               04387000
CVTSIC   EQU   CVTS01+252                                               04388000
CVTTPIOS EQU   CVTS01+248                                               04389000
CVTRTMS  EQU   CVTS01+244                                               04390000
CVTSDBF  EQU   CVTS01+240                                               04391000
CVTSCBP  EQU   CVTS01+236                                               04392000
CVTSDMP  EQU   CVTS01+232                                               04393000
CVTSV60  EQU   CVTS01+228                                               04394000
CVTRTMCT EQU   CVTS01+224                                               04395000
CVTASCBL EQU   CVTS01+220                                               04396000
CVTASCBH EQU   CVTS01+216                                               04397000
CVTGDA   EQU   CVTS01+212                                               04398000
CVTASVT  EQU   CVTS01+208                                               04399000
CVTVVMDI EQU   CVTS01+204                                               04400000
CVTAQTOP EQU   CVTS01+200                                               04401000
CVTIOSCS EQU   CVTS01+196                                               04402000
CVTSDRM  EQU   CVTS01+192                                               04403000
CVTOPTE  EQU   CVTS01+188                                               04404000
CVTSTXU  EQU   CVTS01+184                                               04405000
CVTQUIS  EQU   CVTS01+180                                               04406000
CVTPARS  EQU   CVTS01+176                                               04407000
CVTS1EE  EQU   CVTS01+172                                               04408000
CVTFRAS  EQU   CVTS01+168                                               04409000
CVTQSAS  EQU   CVTS01+164                                               04410000
CVTCRAS  EQU   CVTS01+160                                               04411000
CVTCRMN  EQU   CVTS01+156                                               04412000
CVTDELCP EQU   CVTS01+152                                               04413000
CVTFRECL EQU   CVTS01+148                                               04414000
CVTGETCL EQU   CVTS01+144                                               04415000
CVTBLDCP EQU   CVTS01+140                                               04416000
CVTAUTHL EQU   CVTS01+136                                               04417000
CVTSCAN  EQU   CVTS01+132                                               04418000
CVTRV144 EQU   CVTS01+130                                               04419000
CVTMAXMP EQU   CVTS01+128                                               04420000
CVTSTCK  EQU   CVTS01+124                                               04421000
CVTRV139 EQU   CVTS01+123                                               04422000
CVTDSSAC EQU   CVTS01+122                                               04423000
CVTRV513 EQU   CVTS01+121                                               04424000
CVTIOSPL EQU   CVTS01+120                                               04425000
CVTPTGT  EQU   CVTS01+116                                               04426000
CVTCSPIE EQU   CVTS01+112                                               04427000
CVTSMFEX EQU   CVTS01+108                                               04428000
CVTOLT0A EQU   CVTS01+104                                               04429000
CVTSRBRT EQU   CVTS01+100                                               04430000
CVTPUTL  EQU   CVTS01+96                                                04431000
CVTASCRL EQU   CVTS01+92                                                04432000
CVTASCRF EQU   CVTS01+88                                                04433000
CVTRV326 EQU   CVTS01+84                                                04434000
CVTRV325 EQU   CVTS01+80                                                04435000
CVTRV324 EQU   CVTS01+76                                                04436000
CVT0VL01 EQU   CVTS01+72                                                04437000
CVTSHRVM EQU   CVTS01+68                                                04438000
CVTRV332 EQU   CVTS01+64                                                04439000
CVTTAS   EQU   CVTS01+60                                                04440000
CVTRSCN  EQU   CVTS01+56                                                04441000
CVTTRAC2 EQU   CVTS01+54                                                04442000
CVTTRACE EQU   CVTS01+52                                                04443000
CVTAPG   EQU   CVTS01+51                                                04444000
CVTSDTRC EQU   CVTCTLFG                                                 04445000
CVTGTRCE EQU   CVTCTLFG                                                 04446000
CVTNOMP  EQU   CVTCTLFG                                                 04447000
CVTRSV79 EQU   CVTCTLFG                                                 04448000
CVTDSTAT EQU   CVTCTLFG                                                 04449000
CVTRSV78 EQU   CVTCTLFG                                                 04450000
CVTRV333 EQU   CVTCTLFG                                                 04451000
CVTRV323 EQU   CVTCTLFG                                                 04452000
CVTSPVLK EQU   CVTS01+49                                                04453000
CVTRSV77 EQU   CVTS01+48                                                04454000
CVTRV331 EQU   CVTS01+44                                                04455000
CVTRV330 EQU   CVTS01+40                                                04456000
CVTRV329 EQU   CVTS01+36                                                04457000
CVTRV328 EQU   CVTS01+32                                                04458000
CVTRV322 EQU   CVTS01+28                                                04459000
CVTSLID  EQU   CVTSLIDA+1                                               04460000
CVTSYLK  EQU   CVTSLIDA                                                 04461000
CVTRV321 EQU   CVTS01+20                                                04462000
CVTRV320 EQU   CVTS01+16                                                04463000
CVTLPDIR EQU   CVTLPDIA+1                                               04464000
CVTRSV69 EQU   CVTDIRST                                                 04465000
CVTRSV68 EQU   CVTDIRST                                                 04466000
CVTRSV67 EQU   CVTDIRST                                                 04467000
CVTRSV66 EQU   CVTDIRST                                                 04468000
CVTRSV65 EQU   CVTDIRST                                                 04469000
CVTRSV64 EQU   CVTDIRST                                                 04470000
CVTRSV63 EQU   CVTDIRST                                                 04471000
CVTDICOM EQU   CVTDIRST                                                 04472000
CVTPVTP  EQU   CVTS01+8                                                 04473000
CVTLPDSR EQU   CVTS01+4                                                 04474000
CVTGETL  EQU   CVTS01                                                   04475000
UCBRV066 EQU   UCBOBS09+4                                               04476000
UCBIOSBA EQU   UCBOBS09                                                 04477000
UCBRV042 EQU   UCBOBS08+5                                               04478000
UCBRV082 EQU   UCBCTCF1                                                 04479000
UCBRV081 EQU   UCBCTCF1                                                 04480000
UCBRV080 EQU   UCBCTCF1                                                 04481000
UCBRV079 EQU   UCBCTCF1                                                 04482000
UCBRV078 EQU   UCBCTCF1                                                 04483000
UCBRV077 EQU   UCBCTCF1                                                 04484000
UCBRV076 EQU   UCBCTCF1                                                 04485000
UCBCTC80 EQU   UCBCTCF1                                                 04486000
UCBCTCAL EQU   UCBCTCAD                                                 04487000
UCBICNCB EQU   UCBOBS07+4                                               04488000
UCBRV040 EQU   UCBOBS07                                                 04489000
UCBCTLNA EQU   UCBCTLNK+1                                               04490000
UCBRLN   EQU   UCBCTLNK                                                 04491000
UCBRDYQA EQU   UCBLDNCB                                                 04492000
UCBINRLN EQU   UCBIRLN                                                  04493000
UCBIRBA  EQU   UCBIRB+1                                                 04494000
UCBRV039 EQU   UCBGRAF                                                  04495000
UCBDWNR  EQU   UCBGRAF                                                  04496000
UCBRPND  EQU   UCBGRAF                                                  04497000
UCBUPM   EQU   UCBGRAF                                                  04498000
UCBBTAM  EQU   UCBGRAF                                                  04499000
UCBDRNO  EQU   UCBGRAF                                                  04500000
UCBDRO   EQU   UCBGRAF                                                  04501000
UCBOIP   EQU   UCBGRAF                                                  04502000
UCBATRCD EQU   @NM00054                                                 04503000
UCBSKPFG EQU   @NM00054                                                 04504000
UCBRIPND EQU   @NM00054                                                 04505000
UCBRTIAC EQU   @NM00054                                                 04506000
UCBRSV79 EQU   @NM00054                                                 04507000
UCBRSV78 EQU   @NM00054                                                 04508000
UCBRSV77 EQU   @NM00054                                                 04509000
UCBOLTEP EQU   @NM00054                                                 04510000
UCBATNCT EQU   UCBOBS06+2                                               04511000
UCBRSV76 EQU   UCBAOF2                                                  04512000
UCBRSV75 EQU   UCBAOF2                                                  04513000
UCBRSV74 EQU   UCBAOF2                                                  04514000
UCBRSV73 EQU   UCBAOF2                                                  04515000
UCBRSV72 EQU   UCBAOF2                                                  04516000
UCBRSV71 EQU   UCBAOF2                                                  04517000
UCBRSV70 EQU   UCBAOF2                                                  04518000
UCBRSV69 EQU   UCBAOF2                                                  04519000
UCBRSV68 EQU   UCBAOF1                                                  04520000
UCBRSV67 EQU   UCBAOF1                                                  04521000
UCBRSV66 EQU   UCBAOF1                                                  04522000
UCBRSV65 EQU   UCBAOF1                                                  04523000
UCBRSV64 EQU   UCBAOF1                                                  04524000
UCBOFNL  EQU   UCBAOF1                                                  04525000
UCBOFSP  EQU   UCBAOF1                                                  04526000
UCBOFMCR EQU   UCBAOF1                                                  04527000
UCBBTB   EQU   UCBBTA+1                                                 04528000
UCBDI    EQU   UCBBTA                                                   04529000
UCBSNS   EQU   UCBOBS04+8                                               04530000
UCBTEB   EQU   UCBOBS04+4                                               04531000
UCBGCB   EQU   UCBOBS04+3                                               04532000
UCBOPEN  EQU   UCBOBS04+2                                               04533000
UCBSTART EQU   UCBOBS04                                                 04534000
UCBXTNB  EQU   UCBXTN+1                                                 04535000
UCBRSV22 EQU   UCBVOPT                                                  04536000
UCBRSV21 EQU   UCBVOPT                                                  04537000
UCBRSV20 EQU   UCBVOPT                                                  04538000
UCBESVE  EQU   UCBVOPT                                                  04539000
UCBERPC  EQU   UCBVOPT                                                  04540000
UCBESVC  EQU   UCBVOPT                                                  04541000
UCBEVA   EQU   UCBVOPT                                                  04542000
UCBESV   EQU   UCBVOPT                                                  04543000
UCBRV009 EQU   UCBTFL1                                                  04544000
UCBRV008 EQU   UCBTFL1                                                  04545000
UCBRV007 EQU   UCBTFL1                                                  04546000
UCBRV006 EQU   UCBTFL1                                                  04547000
UCBRV005 EQU   UCBTFL1                                                  04548000
UCBDQDSP EQU   UCBTFL1                                                  04549000
UCBNSLTP EQU   UCBTFL1                                                  04550000
UCBNLTP  EQU   UCBTFL1                                                  04551000
UCBRES1B EQU   UCBOBS02+18                                              04552000
UCBFSER  EQU   UCBOBS02+12                                              04553000
@NM00053 EQU   UCBOBS02+4                                               04554000
UCBFSEQ  EQU   UCBOBS02+2                                               04555000
UCBFSCT  EQU   UCBOBS02                                                 04556000
UCBNEXP  EQU   UCBOBS01+20                                              04557000
UCBBASE  EQU   UCBOBS01+16                                              04558000
UCBRES1A EQU   UCBOBS01+15                                              04559000
UCBUSER  EQU   UCBOBS01+14                                              04560000
UCBFL47  EQU   UCBFL4                                                   04561000
UCBMAT   EQU   UCBFL4                                                   04562000
UCBHOLD  EQU   UCBFL4                                                   04563000
UCBATTN  EQU   UCBFL4                                                   04564000
UCBDSS   EQU   UCBFL4                                                   04565000
UCBRESVP EQU   UCBFL4                                                   04566000
UCBWDAV  EQU   UCBFL4                                                   04567000
UCBDAVV  EQU   UCBFL4                                                   04568000
UCBSQC   EQU   UCBOBS01+12                                              04569000
UCBDATP  EQU   UCBOBS01+12                                              04570000
UCBDMC   EQU   UCBDMCT                                                  04571000
UCBMOUNT EQU   UCBDMCT                                                  04572000
UCBBNUL  EQU   UCBSTAB                                                  04573000
UCBSHAR  EQU   UCBSTAB                                                  04574000
UCBBSTR  EQU   UCBSTAB                                                  04575000
UCBBPUB  EQU   UCBSTAB                                                  04576000
UCBBPRV  EQU   UCBSTAB                                                  04577000
UCBBALB  EQU   UCBPRSRS                                                 04578000
UCBPGFL  EQU   UCBSTAB                                                  04579000
UCBDVSHR EQU   UCBBSVL                                                  04580000
UCBVTOC  EQU   UCBOBS01                                                 04581000
EWDEND   EQU   EWADAREA+128                                             04582000
EWDCCW7  EQU   EWADAREA+96                                              04583000
EWDDISP  EQU   EWADAREA+45                                              04584000
EWDHAALT EQU   EWDHAFLG                                                 04585000
EWDHA5   EQU   EWDHAFLG                                                 04586000
EWDHA4   EQU   EWDHAFLG                                                 04587000
EWDHA3   EQU   EWDHAFLG                                                 04588000
EWDHA2   EQU   EWDHAFLG                                                 04589000
EWDHA1   EQU   EWDHAFLG                                                 04590000
EWDHA0   EQU   EWDHAFLG                                                 04591000
EWDSNS27 EQU   EWDASNS+27                                               04592000
EWDSNS26 EQU   EWDASNS+26                                               04593000
EWDSNS25 EQU   EWDASNS+25                                               04594000
EWDSNS23 EQU   EWDASNS+23                                               04595000
EWDSNS22 EQU   EWDASNS+22                                               04596000
EWDSNS21 EQU   EWDASNS+21                                               04597000
EWDSNS20 EQU   EWDASNS+20                                               04598000
EWDSNS19 EQU   EWDASNS+19                                               04599000
EWDSNS18 EQU   EWDASNS+18                                               04600000
EWDSNS17 EQU   EWDASNS+17                                               04601000
EWDSNS16 EQU   EWDASNS+16                                               04602000
EWDSNS15 EQU   EWDASNS+15                                               04603000
EWDSNS14 EQU   EWDASNS+14                                               04604000
EWDSNS13 EQU   EWDASNS+13                                               04605000
EWDSNS12 EQU   EWDASNS+12                                               04606000
EWDSNS11 EQU   EWDASNS+11                                               04607000
EWD107   EQU   EWDSNS10                                                 04608000
EWD106   EQU   EWDSNS10                                                 04609000
EWD105   EQU   EWDSNS10                                                 04610000
EWD104   EQU   EWDSNS10                                                 04611000
EWDSTAT  EQU   EWDSNS10                                                 04612000
EWD100   EQU   EWDSNS10                                                 04613000
EWDSNS9  EQU   EWDASNS+9                                                04614000
EWDSNS7  EQU   EWDASNS+7                                                04615000
EWDSNS6  EQU   EWDASNS+6                                                04616000
EWD27    EQU   EWDSNS2                                                  04617000
EWD26    EQU   EWDSNS2                                                  04618000
EWD25    EQU   EWDSNS2                                                  04619000
EWD24    EQU   EWDSNS2                                                  04620000
EWDINHI  EQU   EWDMAM                                                   04621000
EWDFP    EQU   EWDSNS1                                                  04622000
EWDNRF   EQU   EWDSNS1                                                  04623000
EWD13    EQU   EWDSNS1                                                  04624000
EWDEOC   EQU   EWDSNS1                                                  04625000
EWDTVRN  EQU   EWDSNS1                                                  04626000
EWDPERM  EQU   EWDSNS1                                                  04627000
EWDOVRN  EQU   EWDSNS0                                                  04628000
EWDDATA  EQU   EWDSNS0                                                  04629000
EWDBUSO  EQU   EWDSNS0                                                  04630000
EWDCREJ  EQU   EWDSNS0                                                  04631000
EWAEND   EQU   EWADDIOS+71                                              04632000
EWASCSW  EQU   EWADDIOS+64                                              04633000
EWASNS   EQU   EWADDIOS                                                 04634000
IOSPCIWA EQU   IOSPCISC+44                                              04635000
IOSPCIRS EQU   IOSPCISC+8                                               04636000
@NM00007 EQU   IOSPCISC+4                                               04637000
@NM00006 EQU   IOSPCISC                                                 04638000
IOSWRNDR EQU   IOSWTOWA+4                                               04639000
IOSWTOPT EQU   IOSWTOWA+3                                               04640000
IOSWTOCP EQU   IOSWTOWA+2                                               04641000
IOSWTOCH EQU   IOSWTOWA                                                 04642000
IOSATTWA EQU   IOSATTSC+40                                              04643000
@NM00005 EQU   IOSATTSC+24                                              04644000
IOSATTSN EQU   IOSATTSC                                                 04645000
@NM00061 EQU   SRB+40                                                   04646000
@NM00060 EQU   SRB+38                                                   04647000
SRBPRIOR EQU   SRB+37                                                   04648000
SRBPKF   EQU   SRB+36                                                   04649000
SRBSAVE  EQU   SRB+32                                                   04650000
SRBRMTR  EQU   SRB+24                                                   04651000
SRBEP    EQU   SRB+20                                                   04652000
SRBPTCB  EQU   SRBFLC+4                                                 04653000
SRBCPAFF EQU   SRBFLC                                                   04654000
SRBID    EQU   SRB                                                      04655000
VOIEND   EQU   VOID+12                                                  04656000
VOIRSTR  EQU   VOID+4                                                   04657000
VOIPRG   EQU   VOIENTRY                                                 04658000
IOCOEND  EQU   IOCOM+128                                                04659000
IOCPATCH EQU   IOCOM+124                                                04660000
IOCUCBBM EQU   IOCOM+120                                                04661000
IOCQCNT  EQU   IOCOM+116                                                04662000
IOCIOSDQ EQU   IOCOM+112                                                04663000
IOCIOSEQ EQU   IOCOM+108                                                04664000
IOCSVCF  EQU   IOCOM+104                                                04665000
IOCTCCW  EQU   IOCOM+100                                                04666000
IOCRSVTB EQU   IOCOM+96                                                 04667000
IOCMFCNT EQU   IOCOM+92                                                 04668000
IOCMFHK  EQU   IOCOM+88                                                 04669000
IOCGENA  EQU   IOCOM+84                                                 04670000
IOCCCH   EQU   IOCOM+80                                                 04671000
IOCASYNQ EQU   IOCOM+76                                                 04672000
IOCLCHTB EQU   IOCOM+72                                                 04673000
IOCATTBL EQU   IOCOM+68                                                 04674000
IOCOMEX  EQU   IOCOM+64                                                 04675000
IOCSYNCH EQU   IOCOM+56                                                 04676000
IOCCATLK EQU   IOCOM+48                                                 04677000
IOCPRGID EQU   IOCOM+44                                                 04678000
IOCIOSCP EQU   IOCOM+40                                                 04679000
IOCORMGT EQU   IOCOM+36                                                 04680000
IOCSTIO  EQU   IOCOM+28                                                 04681000
@NM00059 EQU   IOCOM+24                                                 04682000
@NM00058 EQU   IOCOM+20                                                 04683000
IOCINT   EQU   IOCOM+16                                                 04684000
IOCCTBL  EQU   IOCOM+12                                                 04685000
IOCHIO   EQU   IOCOM+8                                                  04686000
IOCPST   EQU   IOCOM+4                                                  04687000
IOCPGCT  EQU   IOCOM+2                                                  04688000
IOCVOICT EQU   IOCOM                                                    04689000
CVTLEVL  EQU   CVTRELNO+2                                               04690000
CVTNUMB  EQU   CVTRELNO                                                 04691000
CVTMDL   EQU   CVTFIX+250                                               04692000
@NM00057 EQU   CVTFIX+248                                               04693000
@NM00056 EQU   CVTFIX                                                   04694000
CVTRV482 EQU   CVTXTNT2+128                                             04695000
CVTRV481 EQU   CVTXTNT2+124                                             04696000
CVTRV480 EQU   CVTXTNT2+120                                             04697000
CVTRV479 EQU   CVTXTNT2+118                                             04698000
CVTRV478 EQU   CVTXTNT2+117                                             04699000
CVTRV477 EQU   CVTXTNT2+116                                             04700000
CVTRV476 EQU   CVTXTNT2+115                                             04701000
CVTRV475 EQU   CVTXTNT2+114                                             04702000
CVTRV474 EQU   CVTRV466                                                 04703000
CVTRV473 EQU   CVTRV466                                                 04704000
CVTRV472 EQU   CVTRV466                                                 04705000
CVTRV471 EQU   CVTRV466                                                 04706000
CVTRV470 EQU   CVTRV466                                                 04707000
CVTRV469 EQU   CVTRV466                                                 04708000
CVTRV468 EQU   CVTRV466                                                 04709000
CVTRV467 EQU   CVTRV466                                                 04710000
CVTRV465 EQU   CVTRV457                                                 04711000
CVTRV464 EQU   CVTRV457                                                 04712000
CVTRV463 EQU   CVTRV457                                                 04713000
CVTRV462 EQU   CVTRV457                                                 04714000
CVTRV461 EQU   CVTRV457                                                 04715000
CVTRV460 EQU   CVTRV457                                                 04716000
CVTRV459 EQU   CVTRV457                                                 04717000
CVTRV458 EQU   CVTRV457                                                 04718000
CVTRV456 EQU   CVTXTNT2+108                                             04719000
CVTRV455 EQU   CVTXTNT2+104                                             04720000
CVTRV454 EQU   CVTXTNT2+100                                             04721000
CVTRV453 EQU   CVTXTNT2+96                                              04722000
CVTRV452 EQU   CVTXTNT2+94                                              04723000
CVTRV451 EQU   CVTXTNT2+92                                              04724000
CVTRV450 EQU   CVTXTNT2+90                                              04725000
CVTRV449 EQU   CVTXTNT2+88                                              04726000
CVTRV448 EQU   CVTXTNT2+87                                              04727000
CVTRV447 EQU   CVTXTNT2+86                                              04728000
CVTRV446 EQU   CVTRV438                                                 04729000
CVTRV445 EQU   CVTRV438                                                 04730000
CVTRV444 EQU   CVTRV438                                                 04731000
CVTRV443 EQU   CVTRV438                                                 04732000
CVTRV442 EQU   CVTRV438                                                 04733000
CVTRV441 EQU   CVTRV438                                                 04734000
CVTRV440 EQU   CVTRV438                                                 04735000
CVTRV439 EQU   CVTRV438                                                 04736000
CVTRV437 EQU   CVTRV429                                                 04737000
CVTRV436 EQU   CVTRV429                                                 04738000
CVTRV435 EQU   CVTRV429                                                 04739000
CVTRV434 EQU   CVTRV429                                                 04740000
CVTRV433 EQU   CVTRV429                                                 04741000
CVTRV432 EQU   CVTRV429                                                 04742000
CVTRV431 EQU   CVTRV429                                                 04743000
CVTRV430 EQU   CVTRV429                                                 04744000
CVTRV428 EQU   CVTXTNT2+80                                              04745000
CVTRV427 EQU   CVTXTNT2+76                                              04746000
CVTRV426 EQU   CVTXTNT2+72                                              04747000
CVTRV425 EQU   CVTXTNT2+68                                              04748000
CVTATACT EQU   CVTATCVT                                                 04749000
CVTRV423 EQU   CVTXTNT2+62                                              04750000
CVTRV422 EQU   CVTXTNT2+60                                              04751000
CVTRV421 EQU   CVTXTNT2+58                                              04752000
CVTRV420 EQU   CVTXTNT2+56                                              04753000
CVTRV419 EQU   CVTXTNT2+55                                              04754000
CVTRV418 EQU   CVTXTNT2+54                                              04755000
CVTRV417 EQU   CVTRV409                                                 04756000
CVTRV416 EQU   CVTRV409                                                 04757000
CVTRV415 EQU   CVTRV409                                                 04758000
CVTRV414 EQU   CVTRV409                                                 04759000
CVTRV413 EQU   CVTRV409                                                 04760000
CVTRV412 EQU   CVTRV409                                                 04761000
CVTRV411 EQU   CVTRV409                                                 04762000
CVTRV410 EQU   CVTRV409                                                 04763000
CVTRV408 EQU   CVTRV400                                                 04764000
CVTRV407 EQU   CVTRV400                                                 04765000
CVTRV406 EQU   CVTRV400                                                 04766000
CVTRV405 EQU   CVTRV400                                                 04767000
CVTRV404 EQU   CVTRV400                                                 04768000
CVTRV403 EQU   CVTRV400                                                 04769000
CVTRV402 EQU   CVTRV400                                                 04770000
CVTRV401 EQU   CVTRV400                                                 04771000
CVTICB   EQU   CVTXTNT2+48                                              04772000
CVTSKTA  EQU   CVTXTNT2+44                                              04773000
CVTCCVT  EQU   CVTXTNT2+40                                              04774000
CVTRSV98 EQU   CVTXTNT2+36                                              04775000
CVTRSV97 EQU   CVTXTNT2+34                                              04776000
CVTRSV96 EQU   CVTXTNT2+32                                              04777000
CVTOLTEP EQU   CVTXTNT2+28                                              04778000
CVTQIDA  EQU   CVTQID+1                                                 04779000
CVTRSV95 EQU   CVTQID                                                   04780000
CVTRSV94 EQU   CVTXTNT2+20                                              04781000
CVTRSV93 EQU   CVTXTNT2+16                                              04782000
CVTRSV92 EQU   CVTXTNT2+12                                              04783000
CVTDEBVR EQU   CVTXTNT2+8                                               04784000
CVTRSV91 EQU   CVTXTNT2+6                                               04785000
CVTRSV9H EQU   CVTFLGBT                                                 04786000
CVTRSV9G EQU   CVTFLGBT                                                 04787000
CVTRSV9F EQU   CVTFLGBT                                                 04788000
CVTRSV9E EQU   CVTFLGBT                                                 04789000
CVTRSV9D EQU   CVTFLGBT                                                 04790000
CVTRSV9C EQU   CVTFLGBT                                                 04791000
CVTVME   EQU   CVTFLGBT                                                 04792000
CVTNPE   EQU   CVTFLGBT                                                 04793000
CVTNUCLS EQU   CVTXTNT2+4                                               04794000
CVTDSSVA EQU   CVTDSSV+1                                                04795000
CVTRSV89 EQU   CVTDSSV                                                  04796000
CVTRSV88 EQU   CVTXTNT1+8                                               04797000
CVTRSV87 EQU   CVTXTNT1+4                                               04798000
CVTFACHN EQU   CVTXTNT1                                                 04799000
CVTRV488 EQU   CVTMAP+412                                               04800000
CVTRV487 EQU   CVTMAP+408                                               04801000
CVTRV486 EQU   CVTMAP+404                                               04802000
CVTRV485 EQU   CVTMAP+400                                               04803000
CVTACTAP EQU   CVTMAP+396                                               04804000
CVTAUTH  EQU   CVTMAP+392                                               04805000
CVTATMCA EQU   CVTATMCT+1                                               04806000
CVTATMST EQU   CVTATMCT                                                 04807000
CVTRSV61 EQU   CVTMAP+384                                               04808000
CVTVOLT1 EQU   CVTVOLM1+1                                               04809000
CVTVOLI1 EQU   CVTVOLF1                                                 04810000
CVTSTOA  EQU   CVTMAP+376                                               04811000
CVTRSV58 EQU   CVTMAP+374                                               04812000
CVTRSV57 EQU   CVTMAP+372                                               04813000
CVTDDCE  EQU   CVTMAP+368                                               04814000
CVTPNWFR EQU   CVTMAP+364                                               04815000
CVTSMF   EQU   CVTMAP+360                                               04816000
CVTSULK  EQU   CVTMAP+358                                               04817000
CVTSLKO  EQU   CVTSYSK                                                  04818000
CVTSLKP  EQU   CVTSYSK                                                  04819000
CVTSLKQ  EQU   CVTSYSK                                                  04820000
CVTSLKR  EQU   CVTSYSK                                                  04821000
CVTRSV56 EQU   CVTSYSK                                                  04822000
CVTRSV55 EQU   CVTSYSK                                                  04823000
CVTRSV54 EQU   CVTSYSK                                                  04824000
CVTRSV53 EQU   CVTSYSK                                                  04825000
CVTRSV52 EQU   CVTA1F1                                                  04826000
CVTRSV51 EQU   CVTA1F1                                                  04827000
CVTRSV50 EQU   CVTA1F1                                                  04828000
CVTRSV49 EQU   CVTA1F1                                                  04829000
CVTRSV48 EQU   CVTA1F1                                                  04830000
CVTRSV47 EQU   CVTA1F1                                                  04831000
CVTSRSW  EQU   CVTA1F1                                                  04832000
CVTPFSW  EQU   CVTA1F1                                                  04833000
CVTPCVT  EQU   CVTMAP+352                                               04834000
CVTRSV46 EQU   CVTMAP+344                                               04835000
CVTRSV45 EQU   CVTMAP+340                                               04836000
CVTRSV44 EQU   CVTMAP+338                                               04837000
CVTRSV43 EQU   CVTMAP+336                                               04838000
CVTHJESA EQU   CVTHJES+1                                                04839000
CVTRSV42 EQU   CVTHJES                                                  04840000
CVTEXT2A EQU   CVTEXT2+1                                                04841000
CVTRSV41 EQU   CVTEXT2                                                  04842000
CVTAPFA  EQU   CVTAPF+1                                                 04843000
CVTRSV40 EQU   CVTAPF                                                   04844000
CVTRV518 EQU   CVTINTLA                                                 04845000
CVTRV517 EQU   CVTERPV                                                  04846000
CVTEORM  EQU   CVTMAP+312                                               04847000
CVTMCHPR EQU   CVTMAP+308                                               04848000
CVTTZ    EQU   CVTMAP+304                                               04849000
CVTJEPS  EQU   CVTMAP+300                                               04850000
CVTJESCT EQU   CVTMAP+296                                               04851000
CVTMODE  EQU   CVTMAP+292                                               04852000
CVTPTRV  EQU   CVTMAP+288                                               04853000
CVTREAL  EQU   CVTMAP+284                                               04854000
CVTRSV39 EQU   CVTMAP+280                                               04855000
CVTRSV38 EQU   CVTMAP+276                                               04856000
CVTDMSRA EQU   CVTDMSR+1                                                04857000
CVTRV634 EQU   CVTDMSRF                                                 04858000
CVTRV633 EQU   CVTDMSRF                                                 04859000
CVTRV632 EQU   CVTDMSRF                                                 04860000
CVTRV631 EQU   CVTDMSRF                                                 04861000
CVTRV630 EQU   CVTDMSRF                                                 04862000
CVTRV629 EQU   CVTDMSRF                                                 04863000
CVTUDUMP EQU   CVTDMSRF                                                 04864000
CVTSDUMP EQU   CVTDMSRF                                                 04865000
CVTQMSGA EQU   CVTQMSG+1                                                04866000
CVTRSV36 EQU   CVTQMSG                                                  04867000
CVTAMFF  EQU   CVTMAP+264                                               04868000
CVTPURGA EQU   CVTPURG+1                                                04869000
CVTRSV35 EQU   CVTPURG                                                  04870000
CVTCBSP  EQU   CVTMAP+256                                               04871000
CVTATERA EQU   CVTATER+1                                                04872000
CVTSYST  EQU   CVTATER                                                  04873000
CVTVOLT2 EQU   CVTTAT                                                   04874000
CVTVOLI2 EQU   CVTVOLF2                                                 04875000
CVTAQAVB EQU   CVTAQAVT+1                                               04876000
CVTRSV34 EQU   CVTTCMFG                                                 04877000
CVTRSV33 EQU   CVTTCMFG                                                 04878000
CVTRSV32 EQU   CVTTCMFG                                                 04879000
CVTRSV31 EQU   CVTTCMFG                                                 04880000
CVTRSV30 EQU   CVTTCMFG                                                 04881000
CVTRSV29 EQU   CVTTCMFG                                                 04882000
CVTLDEV  EQU   CVTTCMFG                                                 04883000
CVTTCRDY EQU   CVTTCMFG                                                 04884000
CVTGTFA  EQU   CVTGTF+1                                                 04885000
CVTRSV27 EQU   CVTGTFST                                                 04886000
CVTRNIO  EQU   CVTGTFST                                                 04887000
CVTUSR   EQU   CVTGTFST                                                 04888000
CVTRV318 EQU   CVTFORM                                                  04889000
CVTRV317 EQU   CVTTMODE                                                 04890000
CVTRV316 EQU   CVTSTATE                                                 04891000
CVTRV315 EQU   CVTGTFS                                                  04892000
CVTGTFAV EQU   CVTGTFS                                                  04893000
CVT0SCR1 EQU   CVTMAP+232                                               04894000
CVTRV515 EQU   CVTMAP+228                                               04895000
CVTRMS   EQU   CVTMAP+224                                               04896000
CVTPATCH EQU   CVTMAP+220                                               04897000
CVTTSCE  EQU   CVTMAP+216                                               04898000
CVTLNKSC EQU   CVTMAP+214                                               04899000
CVTQABST EQU   CVTMAP+212                                               04900000
CVTMDLDS EQU   CVTMAP+208                                               04901000
CVTUSER  EQU   CVTMAP+204                                               04902000
CVTABEND EQU   CVTMAP+200                                               04903000
CVTSMCA  EQU   CVTMAP+196                                               04904000
CVTRSV18 EQU   CVTMAP+192                                               04905000
CVTQLPAQ EQU   CVTMAP+188                                               04906000
CVTQCDSR EQU   CVTMAP+184                                               04907000
CVTRSV17 EQU   CVTOPTB                                                  04908000
CVTRSV16 EQU   CVTOPTB                                                  04909000
CVTFP    EQU   CVTOPTB                                                  04910000
CVTAPTHR EQU   CVTOPTB                                                  04911000
CVTNLOG  EQU   CVTOPTB                                                  04912000
CVTTOD   EQU   CVTOPTB                                                  04913000
CVTCTIMS EQU   CVTOPTB                                                  04914000
CVTPROT  EQU   CVTOPTB                                                  04915000
CVTXPFP  EQU   CVTOPTA                                                  04916000
CVTASCII EQU   CVTOPTA                                                  04917000
CVTRSV13 EQU   CVTOPTA                                                  04918000
CVTRSV12 EQU   CVTOPTA                                                  04919000
CVTNIP   EQU   CVTOPTA                                                  04920000
CVTDDR   EQU   CVTOPTA                                                  04921000
CVTAPR   EQU   CVTOPTA                                                  04922000
CVTCCH   EQU   CVTOPTA                                                  04923000
CVTSNCTR EQU   CVTMAP+180                                               04924000
CVTQMWR  EQU   CVTMAP+176                                               04925000
CVTQOCR  EQU   CVTMAP+172                                               04926000
CVT1EF00 EQU   CVTMAP+168                                               04927000
CVTMZ00  EQU   CVTMAP+164                                               04928000
CVTSV76Q EQU   CVTSV76C                                                 04929000
CVTRSV11 EQU   CVTMAP+156                                               04930000
CVT0PT01 EQU   CVTMAP+152                                               04931000
CVTMSER  EQU   CVTMAP+148                                               04932000
CVTRV516 EQU   CVTIERLC                                                 04933000
CVTILCH  EQU   CVTMAP+140                                               04934000
CVT0DS   EQU   CVTMAP+136                                               04935000
CVTFBOSV EQU   CVTMAP+132                                               04936000
CVTNUCB  EQU   CVTMAP+128                                               04937000
CVTSV76M EQU   CVTIOQET                                                 04938000
CVTDCBA  EQU   CVTMAP+117                                               04939000
CVTMVS2  EQU   CVTDCB                                                   04940000
CVT6DAT  EQU   CVTDCB                                                   04941000
CVT4MPS  EQU   CVTDCB                                                   04942000
CVTRSV09 EQU   CVTDCB                                                   04943000
CVT4MS1  EQU   CVTDCB                                                   04944000
CVT2SPS  EQU   CVTDCB                                                   04945000
CVT1SSS  EQU   CVTDCB                                                   04946000
CVTRSV08 EQU   CVTDCB                                                   04947000
CVTSTB   EQU   CVTMAP+112                                               04948000
CVTQTD00 EQU   CVTMAP+108                                               04949000
CVTQTE00 EQU   CVTMAP+104                                               04950000
CVTCUCB  EQU   CVTMAP+100                                               04951000
CVTSJQ   EQU   CVTMAP+96                                                04952000
CVTPBLDL EQU   CVTMAP+92                                                04953000
CVTTPC   EQU   CVTMAP+88                                                04954000
CVTSVDCB EQU   CVTMAP+84                                                04955000
CVTBRET  EQU   CVTMAP+82                                                04956000
CVTEXIT  EQU   CVTMAP+80                                                04957000
CVT0FN00 EQU   CVTMAP+76                                                04958000
CVTDARA  EQU   CVTDAR+1                                                 04959000
CVTRSV07 EQU   CVTFLGS1                                                 04960000
CVTRSV06 EQU   CVTFLGS1                                                 04961000
CVTRSV05 EQU   CVTFLGS1                                                 04962000
CVTRSV04 EQU   CVTFLGS1                                                 04963000
CVTRSV03 EQU   CVTFLGS1                                                 04964000
CVTRSV02 EQU   CVTFLGS1                                                 04965000
CVTRSV01 EQU   CVTFLGS1                                                 04966000
CVTDMPLK EQU   CVTFLGS1                                                 04967000
CVTMSLT  EQU   CVTMAP+60                                                04968000
CVTDATE  EQU   CVTMAP+56                                                04969000
CVTBTERM EQU   CVTMAP+52                                                04970000
CVTSYSAD EQU   CVTMAP+48                                                04971000
CVTXTLER EQU   CVTMAP+44                                                04972000
CVTILK2  EQU   CVTMAP+40                                                04973000
CVTILK1  EQU   CVTMAP+36                                                04974000
CVTPRLTV EQU   CVTMAP+32                                                04975000
CVTPCNVT EQU   CVTMAP+28                                                04976000
CVT0VL00 EQU   CVTMAP+24                                                04977000
CVTXAPG  EQU   CVTMAP+20                                                04978000
CVTBUF   EQU   CVTMAP+16                                                04979000
CVTJOB   EQU   CVTMAP+12                                                04980000
CVTLINK  EQU   CVTMAP+8                                                 04981000
CVT0EF00 EQU   CVTMAP+4                                                 04982000
CVTTCBP  EQU   CVTMAP                                                   04983000
CVT      EQU   CVTMAP                                                   04984000
UCBERADR EQU   UCBUCS+12                                                04985000
UCBFCBID EQU   UCBUCS+8                                                 04986000
UCBERCNT EQU   UCBUCS+7                                                 04987000
UCBRSV51 EQU   UCBUCS+6                                                 04988000
UCBFCBPE EQU   UCBFCBOP                                                 04989000
UCBRSV49 EQU   UCBFCBOP                                                 04990000
UCBRSV48 EQU   UCBFCBOP                                                 04991000
UCBRSV47 EQU   UCBFCBOP                                                 04992000
UCBRSV46 EQU   UCBFCBOP                                                 04993000
UCBRSV45 EQU   UCBFCBOP                                                 04994000
UCBRSV44 EQU   UCBFCBOP                                                 04995000
UCBFCBO1 EQU   UCBFCBOP                                                 04996000
UCBUCSPE EQU   UCBUCSOP                                                 04997000
UCBRSV43 EQU   UCBUCSOP                                                 04998000
UCBRSV42 EQU   UCBUCSOP                                                 04999000
UCBRSV41 EQU   UCBUCSOP                                                 05000000
UCBRSV40 EQU   UCBUCSOP                                                 05001000
UCBRSV39 EQU   UCBUCSOP                                                 05002000
UCBUCSO2 EQU   UCBUCSOP                                                 05003000
UCBUCSO1 EQU   UCBUCSOP                                                 05004000
UCBUCSID EQU   UCBUCS                                                   05005000
UCBMDRBA EQU   UCBMDRBF+1                                               05006000
UCBRV075 EQU   UCBMDRBF                                                 05007000
UCBRV074 EQU   UCB3800X+32                                              05008000
UCBIMAGE EQU   UCB3800X+28                                              05009000
UCBFCBNM EQU   UCB3800X+24                                              05010000
UCBCHAR4 EQU   UCB3800X+20                                              05011000
UCBCHAR3 EQU   UCB3800X+16                                              05012000
UCBCHAR2 EQU   UCB3800X+12                                              05013000
UCBCHAR1 EQU   UCB3800X+8                                               05014000
UCBCGMID EQU   UCB3800X+4                                               05015000
UCBBRSTA EQU   UCBACTIV                                                 05016000
UCBRV063 EQU   UCBACTIV                                                 05017000
UCBRV062 EQU   UCBACTIV                                                 05018000
UCBRV061 EQU   UCBACTIV                                                 05019000
UCBRV060 EQU   UCBACTIV                                                 05020000
UCBRV059 EQU   UCBACTIV                                                 05021000
UCBRV058 EQU   UCBACTIV                                                 05022000
UCBRV057 EQU   UCBACTIV                                                 05023000
UCBRV050 EQU   UCB3800X+2                                               05024000
UCBCGMNO EQU   UCB3800X+1                                               05025000
UCBRV083 EQU   UCBOPTNS                                                 05026000
UCBBRSTR EQU   UCBOPTNS                                                 05027000
UCBRV056 EQU   UCBOPTNS                                                 05028000
UCBRV055 EQU   UCBOPTNS                                                 05029000
UCBRV054 EQU   UCBOPTNS                                                 05030000
UCBRV053 EQU   UCBOPTNS                                                 05031000
UCBRV052 EQU   UCBOPTNS                                                 05032000
UCBRV051 EQU   UCBOPTNS                                                 05033000
UCBRV073 EQU   UCB3540X+7                                               05034000
UCBRV072 EQU   UCBDKBYT                                                 05035000
UCBRV071 EQU   UCBDKBYT                                                 05036000
UCBRV070 EQU   UCBDKBYT                                                 05037000
UCBRV069 EQU   UCBDKBYT                                                 05038000
UCBRV068 EQU   UCBDKBYT                                                 05039000
UCBRV067 EQU   UCBDKBYT                                                 05040000
UCBVLVER EQU   UCBDKBYT                                                 05041000
UCBDKAMX EQU   UCBDKBYT                                                 05042000
UCBVLSER EQU   UCB3540X                                                 05043000
UCBRDATA EQU   UCBOCR+4                                                 05044000
UCBFRID  EQU   UCBOCR                                                   05045000
UCBCLN   EQU   UCBMT+14                                                 05046000
UCBERG   EQU   UCBMT+12                                                 05047000
UCBMS    EQU   UCBMT+11                                                 05048000
UCBNB    EQU   UCBMT+10                                                 05049000
UCBPW    EQU   UCBMT+9                                                  05050000
UCBPR    EQU   UCBMT+8                                                  05051000
UCBSIO   EQU   UCBMT+6                                                  05052000
UCBTW    EQU   UCBMT+5                                                  05053000
UCBTR    EQU   UCBMT+4                                                  05054000
UCBTWT   EQU   UCBMT+3                                                  05055000
UCBTRT   EQU   UCBMT+2                                                  05056000
UCBCTD   EQU   UCBMT                                                    05057000
UCBWTOID EQU   UCBCMEXT+17                                              05058000
UCBMIHTI EQU   UCBCMEXT+16                                              05059000
UCBASID  EQU   UCBCMEXT+14                                              05060000
UCBMFCNT EQU   UCBCMEXT+12                                              05061000
UCBPMSK  EQU   UCBCMEXT+10                                              05062000
UCBCCWOF EQU   UCBCMEXT+8                                               05063000
UCBRV041 EQU   UCBCMEXT+6                                               05064000
UCBRV036 EQU   UCBFLP1                                                  05065000
UCBRV035 EQU   UCBFLP1                                                  05066000
UCBERLOG EQU   UCBFLP1                                                  05067000
UCBRV033 EQU   UCBFLP1                                                  05068000
UCBINHIO EQU   UCBFLP1                                                  05069000
UCBNSWAP EQU   UCBFLP1                                                  05070000
UCBSHRUP EQU   UCBFLP1                                                  05071000
UCBNSRCH EQU   UCBFLP1                                                  05072000
UCBHPDV  EQU   @NM00055                                                 05073000
UCBHALI  EQU   @NM00055                                                 05074000
UCBRSV09 EQU   @NM00055                                                 05075000
UCBRSV08 EQU   @NM00055                                                 05076000
UCBRSV07 EQU   @NM00055                                                 05077000
UCBRSV06 EQU   @NM00055                                                 05078000
UCBRSV05 EQU   @NM00055                                                 05079000
UCBRSV04 EQU   @NM00055                                                 05080000
UCBDTI   EQU   UCBCMEXT+2                                               05081000
UCBSTI   EQU   UCBCMEXT+1                                               05082000
UCBETI   EQU   UCBCMEXT                                                 05083000
UCBEXTP  EQU   UCBEXTPT+1                                               05084000
UCBDDRSW EQU   UCBFLC                                                   05085000
UCBTICBT EQU   UCBFLC                                                   05086000
UCBIVRR  EQU   UCBFLC                                                   05087000
UCBIVRS  EQU   UCBFLC                                                   05088000
UCBITF   EQU   UCBFLC                                                   05089000
UCBUDE   EQU   UCBFLC                                                   05090000
UCBWAA   EQU   UCBFLC                                                   05091000
UCBATTP  EQU   UCBFLC                                                   05092000
UCBUNTYP EQU   UCBTBYT4                                                 05093000
UCBRSV11 EQU   UCBDVCLS                                                 05094000
UCBRSV10 EQU   UCBDVCLS                                                 05095000
UCB3CHAR EQU   UCBDVCLS                                                 05096000
UCB3UREC EQU   UCBDVCLS                                                 05097000
UCB3DISP EQU   UCBDVCLS                                                 05098000
UCB3DACC EQU   UCBDVCLS                                                 05099000
UCB3COMM EQU   UCBDVCLS                                                 05100000
UCB3TAPE EQU   UCBDVCLS                                                 05101000
UCBDVPWR EQU   UCB2OPT7                                                 05102000
UCBVLPWR EQU   UCB2OPT6                                                 05103000
UCB2OPT5 EQU   UCBTBYT2                                                 05104000
UCBRR    EQU   UCBDUDN1                                                 05105000
UCB2OPT1 EQU   UCBTBYT2                                                 05106000
UCB2OPT0 EQU   UCBTBYT2                                                 05107000
UCB1FEA7 EQU   UCBTBYT1                                                 05108000
UCBD6250 EQU   UCB1FEA6                                                 05109000
UCBD1600 EQU   UCB1FEA5                                                 05110000
UCB1FEA4 EQU   UCBTBYT1                                                 05111000
UCB1FEA3 EQU   UCBTBYT1                                                 05112000
UCB1FEA2 EQU   UCBTBYT1                                                 05113000
UCB1FEA1 EQU   UCBTBYT1                                                 05114000
UCB1FEA0 EQU   UCBTBYT1                                                 05115000
UCBRV029 EQU   UCBWGT                                                   05116000
UCBVHRSN EQU   UCBWGT                                                   05117000
UCBVORSN EQU   UCBWGT                                                   05118000
UCBMTPXP EQU   UCBWGT                                                   05119000
UCBREW   EQU   UCBWGT                                                   05120000
UCBPUB   EQU   UCBWGT                                                   05121000
UCBOUT   EQU   UCBWGT                                                   05122000
UCBIN    EQU   UCBWGT                                                   05123000
UCBCPU   EQU   UCBOB+11                                                 05124000
UCBLCI   EQU   UCBOB+10                                                 05125000
UCBCNT   EQU   UCBOB+9                                                  05126000
UCBRV017 EQU   UCBCHM1                                                  05127000
UCBRV016 EQU   UCBCHM1                                                  05128000
UCBRV015 EQU   UCBCHM1                                                  05129000
UCBRV014 EQU   UCBCHM1                                                  05130000
UCBSPB   EQU   UCBPTH1                                                  05131000
UCBPPB   EQU   UCBPTH1                                                  05132000
UCBSPA   EQU   UCBPTH0                                                  05133000
UCBPPA   EQU   UCBPTH0                                                  05134000
UCBSIGP  EQU   UCBFLB                                                   05135000
UCBVALPH EQU   UCBFLB                                                   05136000
UCBCRHSN EQU   UCBFLB                                                   05137000
UCBCRHRV EQU   UCBFLB                                                   05138000
UCBRESVH EQU   UCBFLB                                                   05139000
UCBSPST  EQU   UCBFLB                                                   05140000
UCBASNS  EQU   UCBFLB                                                   05141000
UCBIORST EQU   UCBFLB                                                   05142000
UCBQISCE EQU   UCBFL1                                                   05143000
UCBACTV  EQU   UCBFL1                                                   05144000
UCBSAP   EQU   UCBFL1                                                   05145000
UCBNOTRC EQU   UCBCUB                                                   05146000
UCBPSNS  EQU   UCBFL1                                                   05147000
UCBUSING EQU   UCBPST                                                   05148000
UCBNOTRD EQU   UCBNRY                                                   05149000
UCBBUSYD EQU   UCBBSY                                                   05150000
UCBUA    EQU   UCBCHAN+1                                                05151000
UCBCHA   EQU   UCBCHAN                                                  05152000
UCBDADI  EQU   UCBSTAT                                                  05153000
UCBSYSR  EQU   UCBSTAT                                                  05154000
UCBPRES  EQU   UCBSTAT                                                  05155000
UCBALOC  EQU   UCBSTAT                                                  05156000
UCBUNLD  EQU   UCBSTAT                                                  05157000
UCBRESV  EQU   UCBSTAT                                                  05158000
UCBCHGS  EQU   UCBSTAT                                                  05159000
UCBONLI  EQU   UCBSTAT                                                  05160000
UCBID    EQU   UCBOB+2                                                  05161000
UCBALTPH EQU   UCBFL5                                                   05162000
UCBALTCU EQU   UCBFL5                                                   05163000
UCBNALOC EQU   UCBFL5                                                   05164000
UCBVSDR  EQU   UCBFL5                                                   05165000
UCBSASK  EQU   UCBFL5                                                   05166000
UCBAMV   EQU   UCBAF                                                    05167000
UCBDCC   EQU   UCBFL5                                                   05168000
UCBMONT  EQU   UCBJBNR                                                  05169000
UCBRV011 EQU   UCBJBNR                                                  05170000
UCBMMSGP EQU   UCBJBNR                                                  05171000
UCBOLDSM EQU   UCBJBNR                                                  05172000
UCBRV003 EQU   UCBJBNR                                                  05173000
UCBDUC   EQU   UCBJBNR                                                  05174000
UCBJES3  EQU   UCBJBNR                                                  05175000
UCBVRDEV EQU   UCBJBNR                                                  05176000
UCBCMSEG EQU   UCBOB                                                    05177000
UCBPFXND EQU   UCB+512                                                  05178000
UCBIOQ   EQU   UCB+508                                                  05179000
UCBLOCK  EQU   UCB+504                                                  05180000
UCBPXST  EQU   UCB+504                                                  05181000
@NM00052 EQU   UCB                                                      05182000
OBRSNS7  EQU   OBRSNS+7                                                 05183000
@NM00051 EQU   OBRSNS+3                                                 05184000
@NM00050 EQU   OBRSNS2                                                  05185000
PRVLOG   EQU   OBRSNS2                                                  05186000
@NM00049 EQU   OBRSNS2                                                  05187000
OBRSNS1  EQU   OBRSNS+1                                                 05188000
OBRSNS0  EQU   OBRSNS                                                   05189000
@NM00048 EQU   DAOBR+22                                                 05190000
@NM00047 EQU   DAOBR+16                                                 05191000
@NM00046 EQU   DAOBR+6                                                  05192000
@NM00045 EQU   DAMDR+6                                                  05193000
WKAPUA   EQU   WKAUA                                                    05194000
@NM00044 EQU   WKAUA                                                    05195000
@NM00043 EQU   INTFLG1                                                  05196000
@NM00042 EQU   INTERFLG                                                 05197000
ODDTRK   EQU   ESNS10                                                   05198000
BIASSW   EQU   ESNS10                                                   05199000
LATCH124 EQU   ESNS10                                                   05200000
DMSIZE   EQU   ESNS10                                                   05201000
EPUA     EQU   ESNS4                                                    05202000
@NM00041 EQU   ESNS4                                                    05203000
@NM00040 EQU   ESNS2                                                    05204000
@NM00039 EQU   ESNS2                                                    05205000
@NM00038 EQU   EIOSCC                                                   05206000
ECC2OR3  EQU   EIOSCC                                                   05207000
EILC     EQU   EIOSCC                                                   05208000
ECCCK    EQU   ECSWSTAT+1                                               05209000
EUNITEX  EQU   ECSWSTAT                                                 05210000
EDEVEND  EQU   ECSWSTAT                                                 05211000
ECHEND   EQU   ECSWSTAT                                                 05212000
@NM00037 EQU   ECSWSTAT                                                 05213000
ICHCK    EQU   ICSWSTAT+1                                               05214000
ICDATACK EQU   ICSWSTAT+1                                               05215000
IPROTCK  EQU   ICSWSTAT+1                                               05216000
IPGMCK   EQU   ICSWSTAT+1                                               05217000
IINCLGTH EQU   ICSWSTAT+1                                               05218000
IPCI     EQU   ICSWSTAT+1                                               05219000
IUNITEX  EQU   ICSWSTAT                                                 05220000
IDEVEND  EQU   ICSWSTAT                                                 05221000
ICHEND   EQU   ICSWSTAT                                                 05222000
@NM00036 EQU   ICSWSTAT                                                 05223000
@NM00035 EQU   DAFMSK                                                   05224000
@NM00034 EQU   DOFLOCCW+5                                               05225000
@NM00033 EQU   OFLOFLG                                                  05226000
@NM00032 EQU   FTRCCW+5                                                 05227000
FTRIDA   EQU   FTRFLG                                                   05228000
FTRPCI   EQU   FTRFLG                                                   05229000
FTRSLI   EQU   FTRFLG                                                   05230000
FTRCC    EQU   FTRFLG                                                   05231000
FTRDC    EQU   FTRFLG                                                   05232000
CPBLDLEN EQU   CCWCNT+1                                                 05233000
PCIBIT   EQU   CCWFLG                                                   05234000
@NM00031 EQU   SEEKOP                                                   05235000
@NM00030 EQU   TICBITS                                                  05236000
@NM00029 EQU   CCWOP                                                    05237000
@NM00028 EQU   ISNS+1                                                   05238000
@NM00027 EQU   ISNS                                                     05239000
@NM00026 EQU   ISNS                                                     05240000
@NM00025 EQU   DAFLG1                                                   05241000
@NM00024 EQU   DISPSAV+4                                                05242000
DNOCYL   EQU   DTABNTRY                                                 05243000
@NM00023 EQU   ERSYM                                                    05244000
@NM00022 EQU   BKDISP+1                                                 05245000
@NM00021 EQU   DAXSNS+14                                                05246000
RSTSCTR  EQU   DAXSNS+13                                                05247000
RSTRECNO EQU   RSTCCHHR+4                                               05248000
FMT4BIT  EQU   FMT6BITS                                                 05249000
@NM00020 EQU   FMTSNS                                                   05250000
RSTCMD2  EQU   DAXSNS+5                                                 05251000
@NM00019 EQU   DAXSNS+4                                                 05252000
RSTCMD1  EQU   DAXSNS+3                                                 05253000
@NM00018 EQU   DAXSNS                                                   05254000
@NM00017 EQU   DAIDAW                                                   05255000
EWACPU   EQU   EWA+27                                                   05256000
@NM00016 EQU   EWA+26                                                   05257000
EWACSEQ  EQU   EWAXCSW2                                                 05258000
EWACDIN  EQU   EWAXCSW2                                                 05259000
@NM00015 EQU   EWAXCSW2                                                 05260000
EWACTEC  EQU   EWAXCSW2                                                 05261000
EWACDAV  EQU   EWAXCSW1                                                 05262000
EWACCHV  EQU   EWAXCSW1                                                 05263000
EWACCMD  EQU   EWAXCSW1                                                 05264000
EWACUNS  EQU   EWAXCSW1                                                 05265000
EWACSQV  EQU   EWAXCSW1                                                 05266000
@NM00014 EQU   EWAXCSW1                                                 05267000
EWACITF  EQU   EWAXCSW1                                                 05268000
@NM00013 EQU   EWARGFG2                                                 05269000
EWACCUE  EQU   EWARGFG2                                                 05270000
EWACSTG  EQU   EWARGFG2                                                 05271000
EWACSCU  EQU   EWARGFG2                                                 05272000
EWACCHA  EQU   EWARGFG2                                                 05273000
EWACCPU  EQU   EWARGFG2                                                 05274000
EWACCNT  EQU   EWARGFG1                                                 05275000
EWACSNS  EQU   EWARGFG1                                                 05276000
@NM00012 EQU   EWARGFG1                                                 05277000
EWACHIO  EQU   EWARGFG1                                                 05278000
EWACTIO  EQU   EWARGFG1                                                 05279000
EWACINT  EQU   EWARGFG1                                                 05280000
EWACSIO  EQU   EWARGFG1                                                 05281000
EWAUCB   EQU   EWAERPIB+1                                               05282000
@NM00011 EQU   EWAERPIB                                                 05283000
EWASTUP  EQU   EWA+14                                                   05284000
EWACNTR4 EQU   EWACNTRS+3                                               05285000
EWASCTMX EQU   EWASNSCT                                                 05286000
@NM00010 EQU   EWASNSCT                                                 05287000
EWAJAM   EQU   EWAFLG3                                                  05288000
@NM00009 EQU   EWAFLG2                                                  05289000
EWADIR   EQU   EWAFLG2                                                  05290000
EWACOVF  EQU   EWAFLG2                                                  05291000
EWAWTEMP EQU   EWAFLG2                                                  05292000
EWASCC1  EQU   EWASCC3                                                  05293000
EWASCC2  EQU   EWASCC3                                                  05294000
@NM00008 EQU   EWAFLG1                                                  05295000
EWASLIS  EQU   EWAFLG1                                                  05296000
IOSSKR   EQU   IOSEEKA+7                                                05297000
IOSSKH1  EQU   IOSSKHH                                                  05298000
IOSSKBB  EQU   IOSEEKA+1                                                05299000
IOSSKM   EQU   IOSEEKA                                                  05300000
IOSMDM   EQU   IOSB+91                                                  05301000
IOSMDB   EQU   IOSB+90                                                  05302000
IOSCKEY7 EQU   IOSCKEY                                                  05303000
IOSCKEY6 EQU   IOSCKEY                                                  05304000
IOSCKEY5 EQU   IOSCKEY                                                  05305000
IOSCKEY4 EQU   IOSCKEY                                                  05306000
@NM00004 EQU   IOSCKEY                                                  05307000
IOSCUDEV EQU   IOSPATH+1                                                05308000
@NM00003 EQU   IOSCHN                                                   05309000
IOSPATH3 EQU   IOSCHN                                                   05310000
IOSPATH2 EQU   IOSCHN                                                   05311000
IOSEXP   EQU   IOSCHN                                                   05312000
IOSGDP   EQU   IOSCHN                                                   05313000
IOSAFF   EQU   IOSB+85                                                  05314000
IOSRSS1B EQU   IOSB+84                                                  05315000
IOSDSID  EQU   IOSB+80                                                  05316000
IOSDIE   EQU   IOSB+68                                                  05317000
IOSABN   EQU   IOSB+64                                                  05318000
IOSNRM   EQU   IOSB+60                                                  05319000
IOSPCI   EQU   IOSB+56                                                  05320000
IOSPCHN  EQU   IOSB+48                                                  05321000
IOSAPMSK EQU   IOSB+40                                                  05322000
IOSRES4A EQU   IOSB+36                                                  05323000
IOSUSE   EQU   IOSB+32                                                  05324000
IOSTSB   EQU   IOSTATUS+1                                               05325000
IOSUCB   EQU   IOSB+16                                                  05326000
IOSOPT2X EQU   IOSOPT2                                                  05327000
IOSIGP   EQU   IOSOPT2                                                  05328000
IOSHTP   EQU   IOSOPT2                                                  05329000
IOSRELSE EQU   IOSOPT                                                   05330000
IOSAPR   EQU   IOSOPT                                                   05331000
IOSTSLL  EQU   IOSOPT                                                   05332000
IOSNERP  EQU   IOSOPT                                                   05333000
IOSPSLL  EQU   IOSOPT                                                   05334000
IOSQISCE EQU   IOSOPT                                                   05335000
IOSPKY7  EQU   IOSPKEY                                                  05336000
IOSPGDPX EQU   IOSPKEY                                                  05337000
IOSLCL   EQU   IOSPKEY                                                  05338000
@NM00001 EQU   IOSPKEY                                                  05339000
IOSPGAD  EQU   IOSB+8                                                   05340000
IOSPRLVL EQU   IOSB+5                                                   05341000
IOSFLC7  EQU   IOSFLC                                                   05342000
IOSCTCNR EQU   IOSFLC                                                   05343000
IOSRWAIT EQU   IOSFLC                                                   05344000
IOSTP    EQU   IOSFLC                                                   05345000
IOSCC3WE EQU   IOSFLC                                                   05346000
IOSVERIF EQU   IOSDVALT                                                 05347000
IOSDVMNT EQU   IOSFLC                                                   05348000
IOSBDCST EQU   IOSFLB                                                   05349000
IOSFLB4  EQU   IOSFLB                                                   05350000
IOSFLB3  EQU   IOSFLB                                                   05351000
IOSNOTRS EQU   IOSFLB                                                   05352000
IOSSDR   EQU   IOSFLB                                                   05353000
IOSDIESE EQU   IOSFLB                                                   05354000
IOSIOSB  EQU   IOSFLA                                                   05355000
IOSDOM   EQU   IOSFLA                                                   05356000
IOSSMDA  EQU   IOSFLA                                                   05357000
IOSCCHN  EQU   IOSACHN                                                  05358000
IOSDCHN  EQU   IOSACHN                                                  05359000
DIRCHN2  EQU   DIRCHNPT+4                                               05360000
DIRCHN1  EQU   DIRCHNPT                                                 05361000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05362000
@RT00164 EQU   CCNOT0                                                   05363000
@RT00172 EQU   CCNOT0                                                   05364000
@RT00197 EQU   SNSERR                                                   05365000
@RT00200 EQU   STATCK                                                   05366000
@RT00209 EQU   INTCK                                                    05367000
@RT00212 EQU   INTCK                                                    05368000
@RT00228 EQU   SETBADHA                                                 05369000
@RF00228 EQU   SNSRTY                                                   05370000
@RF00232 EQU   INTCK                                                    05371000
@RT00235 EQU   SETBADHA                                                 05372000
@RF00253 EQU   RTY10                                                    05373000
@RT00263 EQU   CNTINCR1                                                 05374000
@RT00268 EQU   CNTINCR1                                                 05375000
@RT00271 EQU   ERFP                                                     05376000
@RC00280 EQU   @RC00279                                                 05377000
@RT00285 EQU   CALTRANS                                                 05378000
@RT00304 EQU   PERMSOFT                                                 05379000
@RT00307 EQU   DIRBLD                                                   05380000
@RT00334 EQU   ERMSG                                                    05381000
@RT00338 EQU   CNTINCR1                                                 05382000
@RF00338 EQU   ERMSG                                                    05383000
@RT00342 EQU   CNTINCR1                                                 05384000
@RT00347 EQU   BYPOBR                                                   05385000
@RT00352 EQU   RTY10C                                                   05386000
@RT00355 EQU   ERMSG                                                    05387000
@RT00358 EQU   RTY10C                                                   05388000
@RF00358 EQU   ERMSG                                                    05389000
@RF00362 EQU   ERMSG                                                    05390000
@RT00380 EQU   ERINT1                                                   05391000
@RT00382 EQU   ERINT1                                                   05392000
@RT00391 EQU   RTY10B                                                   05393000
@RF00391 EQU   RTY10                                                    05394000
@RF00394 EQU   ERHARD                                                   05395000
@RT00397 EQU   ERHARD                                                   05396000
@RT00426 EQU   RTY10C                                                   05397000
@RT00428 EQU   RETRY                                                    05398000
@RT00431 EQU   ERSOFT                                                   05399000
@RT00435 EQU   SKIPRSTR                                                 05400000
@RF00445 EQU   OFLOCK1                                                  05401000
@RT00457 EQU   EROFLOA                                                  05402000
@RT00475 EQU   OFLOCALC                                                 05403000
@RT00534 EQU   SCHOP                                                    05404000
@RT00563 EQU   RTY10                                                    05405000
@RT00577 EQU   RTY10C                                                   05406000
@RT00586 EQU   RTY10C                                                   05407000
@RF00592 EQU   MERWCK2                                                  05408000
@RT00621 EQU   LENCK1                                                   05409000
@RT00634 EQU   MERWCK2                                                  05410000
@RF00634 EQU   ECFLOOP1                                                 05411000
@RT00645 EQU   MASKCK                                                   05412000
@RT00648 EQU   SLICK                                                    05413000
@RT00652 EQU   MASKCK                                                   05414000
@RT00655 EQU   MASKCK                                                   05415000
@RT00674 EQU   ERTCC                                                    05416000
@RF00678 EQU   EROFLOA                                                  05417000
@RT00686 EQU   NOFTR                                                    05418000
@RC00736 EQU   RESTART                                                  05419000
@RT00774 EQU   RESTART                                                  05420000
@RT00802 EQU   EROFLOA                                                  05421000
@RT00821 EQU   ERHARD                                                   05422000
@RF00826 EQU   UPDATSKA                                                 05423000
@RT00837 EQU   ERNOER                                                   05424000
@RT00840 EQU   ERSOFT                                                   05425000
@RF00840 EQU   ERHARD                                                   05426000
@RT00843 EQU   CKEXIT                                                   05427000
@RT00846 EQU   CKEXIT                                                   05428000
@RT00849 EQU   CKEXIT                                                   05429000
@RT00852 EQU   CKEXIT                                                   05430000
@RT00887 EQU   XTNTCK                                                   05431000
@RF00901 EQU   NOCHAIN                                                  05432000
@RF00935 EQU   OBRSAVE                                                  05433000
@RF00939 EQU   SNSMDR                                                   05434000
@RC00943 EQU   SETCUA                                                   05435000
@RT00964 EQU   NORMAL                                                   05436000
@RF00974 EQU   PUA                                                      05437000
@RF00967 EQU   NORMAL                                                   05438000
@ENDDATA EQU   *                                                        05439000
         END   IECVDERP,(C'PLS0829',0701,78115)                         05440000
