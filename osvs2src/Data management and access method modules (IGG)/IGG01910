 TITLE 'IGG01910-IECOSLDA OPEN EXECUTOR (SAM)'                          00020000
IGG01910 CSECT                                                          00020403
*                                                                       00021201
*MODULE NAME - IGG01910                                          Y02072 00021602
*                                                                       00022002
*DESCRIPTIVE NAME - LOAD ACCESS METHOD ROUTINES                  Y02072 00022102
*                                                                       00022202
*COPYRIGHT - NONE                                                Y02072 00022302
*                                                                       00022402
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00022502
*                                                                       00022802
*          VS 2 RELEASE 2 DELETIONS                              Y02072 00022902
*000206,000550,006200,052500,052620,052900-052940,055729-055733, Y02072 00023002
*100000,106500-106597,116610-117200,55760,106400-106600,107400,  Y02072 00025202
*111800-113600,114200,145600-145800                              Y02072 00035202
*                                                                YM1140 00045202
*                                                                YM4640 00045302
*                                                                       00047303
*          VS2 RELEASE 3 DELETIONS                                      00049303
*                                                              @Z30TSCF 00049703
*          RELEASE 20 DELETIONS                                         00050102
*2161055746,055754,144120-144140                                 M5150  00052402
*2161                                                            S20038 00054702
*2161055720-055750,122000,144400,144700                          S20202 00057002
*2161144120-144140                                               M5701  00059302
*          RELEASE 21 DELETIONS                                         00061602
*1091122000,144660-144720                                        S21040 00063902
*D73400-74200                                                   SA66897 00065902
*                                                                       00066202
*STATUS CHANGE LEVEL 007                                                00075402
*                                                                       00077702
*FUNCTION/OPERATION - THIS ROUTINE WILL LOAD SOME OF THE I/O       UT18 00080018
*      PROCESSING MODULES.  THE MODULES TO BE LOADED ARE DETERMINEDUT18 00100018
*      FOR THE ACCESS METHODS AND DEVICE TYPE TO BE USED.          UT18 00120018
*      IT WILL PLACE THE ADDRESS OF THE LOADED MODULES IN THE           00160000
*      APPROPRIATE DCB FIELDS, AND THE ID'S IN THE DEB.                 00180000
*      IT WILL BRING IN THE APPROPRIATE ERROR ROUTINES.                 00200000
*      THIS MODULE WAS SPLIT IN RELEASE 18 TO INCLUDE USER         UT18 00220018
*      TOTALING SUPPORT.  THE SECOND HALF OF THIS MODULE IS NOW    UT18 00240018
*      IGG01917.                                                   UT18 00260018
*                                                                       00280000
*ENTRY POINTS: ENTERED FROM IGG0191J, IGG0191D, IGG0191G BY USE OF THE  00300000
*      XCTL MACRO.                                                      00320000
*                                                                       00340000
*INPUT: SEE DESCRIPTION OF REGISTERS, DCB(USERS)                        00360000
*                                                                       00380000
*OUTPUT: DCB(USERS),IOB(USERS).                                         00400000
*                                                                       00420000
*EXTERNAL ROUTINES: NONE.                                               00440000
*                                                                       00460000
*EXITS-NORMAL   XCTL TO IGG01917.                                  UT18 00480018
*                                                                       00500000
*EXITS-ERROR: NONE.                                                     00520000
*                                                                       00540000
*TABLES/WORAREA: DUPE EVERYTHING*************************************** 00560000
*********************************************************************** 00580000
*                                                                       00600000
*ATTRIBUTES: REENTRANT, REUSABLE, RUNS IN DATA MANAGEMENT KEY,   Y02072 00620002
*            SUPERVISOR STATE                                    Y02072 00630002
*                                                                       00640000
*NOTES: THIS ROUTINE HAS A LIST OF ALL BSAM, QSAM MODULES SUPPORTED.    00660000
*                                                                       00680000
*********************************************************************** 00700000
*                                                                       00720000
*                                                                       00740000
*  REGISTER CONVENTIONS USED THROUGH OUT ALL OPEN PASSES                00760000
*                                                                       00780000
*********************************************************************** 00800000
*                                                                       00820000
RE       EQU   0         WORK REG5                                      00830002
RF       EQU   1         WORK REG6                                      00832002
R1       EQU   RF        PARM REG                                YM1140 00834002
RDCB     EQU   2         DCB REGISTER                                   00840000
RBASE    EQU   3         BASE REGISTER                                  00860000
RCORE    EQU   4         WORK AREA ADDRESS                              00880000
RPAR     EQU   5         TOP OF PARAMETER LIST                          00900000
RWTG     EQU   6         TOP OF WTG TABLE                               00920000
RPARC    EQU   7         CURRENT PARAMETER                              00940000
RWTGC    EQU   8         CURRENT TRANS LOAD                             00960000
RTIOT    EQU   9         USED HERE AS WRK REG AND  COMM VECTOR ADDR.    00980000
RUCB     EQU   10        USED HERE AS A COUNTER IN IOB GENERATION       01000000
RDEB     EQU   11        DEB ADDRESS                                    01020000
RB       EQU   12        WORK REG1  **                                  01040000
RC       EQU   13        WORK REG2  **  USED IN IOB GENERATION          01060000
RD       EQU   14        WORK REG3  **                                  01080000
RJ       EQU   15        WORK REG4                                      01100000
*                                                                       01160000
*                                                                       01180000
PARAR    EQU   RPARC                                                    01200000
*                                                                       01220000
*********************************************************************** 01240000
*                                                                       01260000
*********************************************************************** 01280000
*                                                                       01300000
* MASK'S TO TEST PARAMETER LIST WITH                                    01320000
*                                                                       01340000
*********************************************************************   01360000
INP      EQU   X'0F'                                                    01380000
OUTP       EQU   X'0F'                                                  01400000
UPDATE     EQU   X'04'                                                  01420000
INOUT      EQU   X'03'                                                  01440000
OUTIN      EQU   X'07'                                                  01460000
RDBACK     EQU   X'01'                                                  01480000
INPRDBK  EQU   X'0E'               MASK TO CK INPUT AND RDBACK     UT18 01490018
*                                                                       01500000
*                                                                       01520000
*********************************************************************   01540000
*                                                                       01560000
*                                                                       01580000
* OFFSET FOR PARAMETER TESTS                                            01600000
*                                                                       01620000
ONE        EQU   X'01'                                                  01640000
THREE    EQU   X'03'                    CONSTANT=O               S20202 01645020
K24      EQU   X'18'                    CONSTANT=24              S20202 01650020
K25      EQU   X'19'                    CONSTANT=25              S20202 01655020
FRTYATE    EQU   48                                                     01660000
DISPSN     EQU   X'0'                                                   01680000
*                                                                       01700000
*                                                                       01720000
*********************************************************************   01740000
*                                                                       01760000
* OFFSETS FOR DEB REFERENCE                                             01780000
*                                                                       01800000
*                                                                       01820000
ABEAPPOF EQU   17                       OFFSET TO AB END APP     S20202 01830020
*                                       ADDR                     S20202 01835020
FOUR     EQU   X'04'                                             M5150  01839020
BIN      EQU   36                                                       01840000
BEXT     EQU   38                                                       01860000
*                                                                       01880000
*                                                                       01900000
*                                                                       01920000
*********************************************************************   01940000
*                                                                       01960000
* MASK'S USED TO TEST OPTION FIELDS IN DCB                              01980000
*                                                                       02000000
*                                                                       02020000
*                                                                       02040000
DOUBLE     EQU   X'01'                                                  02060000
*                                                                       02080000
*                                                                       02100000
STOWB      EQU   X'80'                                                  02120000
WRTCK      EQU   X'80'                                                  02140000
OVRFLO     EQU   X'20'                                                  02160000
PCI        EQU   X'20'                                                  02180000
MINKEY     EQU   X'01'                                                  02200000
CONCAT     EQU   X'FF'                                                  02220000
UTFMASK  EQU   X'02'                    MASK FOR TOTALING FACILITY UT18 02230018
*                                                                       02240000
*********************************************************************   02260000
*                                                                       02280000
* MASKS FOR ACCESS METHODS IN SAM                                       02300000
*                                                                       02320000
QSAMB      EQU   X'01'                                                  02340000
BSAMBIT    EQU   X'00'                                                  02360000
PAM        EQU   X'02'                                                  02380000
*                                                                       02400000
*                                                                       02420000
* MASKS FOR MACRO'S TO BE USED                                          02440000
*                                                                       02460000
GETB       EQU   X'40'                                                  02480000
PUTB       EQU   X'40'                                                  02500000
READB      EQU   X'20'                                                  02520000
WRITEB     EQU   X'20'                                                  02540000
POINTB     EQU   X'04'                                                  02560000
CNTRLB     EQU   X'02'                                                  02580000
*                                                                       02600000
*                                                                       02620000
*********************************************************************   02640000
*                                                                       02660000
* MASKS FOR DEVICES TO BE SUPPORTED                                     02680000
*                                                                       02700000
OCR3886  EQU   X'57'                    DCBDEVT FOR 3886 OCR    XL03127 02710002
*                                                                       02720000
*                                                                       02740000
*********************************************************************   02760000
*                                                                       02780000
*                                                                       02800000
*                                                                       02820000
*                                                                       02840000
*********************************************************************   02860000
*                                                                       02880000
* MASKS FOR STATUS BITS TO BE TESTED                                    02900000
*                                                                       02920000
*                                                                       02940000
EXCPN      EQU   X'30'                                                  02960000
COMPLETE   EQU   X'80'                                                  02980000
FIRSTIOB   EQU   X'01'                                                  03000000
*                                                                       03020000
*                                                                       03040000
*                                                                       03060000
*********************************************************************   03080000
*                                                                       03100000
* MASKS FOR BUFFER TECHNIQUE'S                                          03120000
*                                                                       03140000
CYCLICB    EQU   X'20'                                                  03160000
EXCHANGB   EQU   X'10'                                                  03180000
SIMPLEB    EQU   X'40'                                                  03200000
EXCHCYCL   EQU   X'30'                                                  03220000
*                                                                       03240000
*********************************************************************   03260000
*                                                                       03280000
*                                                                       03300000
* MODES OF OPERATION FOR QSAM                                           03320000
*                                                                       03340000
LOCATEB    EQU   X'08'                                                  03360000
MOVEB      EQU   X'10'                                                  03380000
MOVEXCHB EQU   X'14'                                                    03400000
SUBSTUTB   EQU   X'04'                                                  03420000
*                                                                       03440000
*                                                                       03460000
*********************************************************************   03480000
*                                                                       03500000
*                                                                       03520000
* COMMAND BYTES FOR THE 2841                                            03540000
*                                                                       03560000
*       CONTROL UNIT                                                    03580000
*                                                                       03600000
*                                                                       03620000
*                                                                       03640000
SRCHE      EQU   X'31'                                                  03660000
WRTCKD     EQU   X'1D'                                                  03680000
RDC        EQU   X'92'                                                  03700000
RDKD       EQU   X'8E'                                                  03720000
RDD        EQU   X'86'                                                  03740000
TIC        EQU   X'08'                                                  03760000
*                                                                       03780000
*                                                                       03800000
*********************************************************************   03820000
*                                                                       03840000
*                                                                       03860000
* MASKS FOR RECORD FORMATS                                              03880000
*                                                                       03900000
*                                                                       03920000
STANDRDF   EQU   X'08'                                                  03940000
FORMATU    EQU   X'C0'                                                  03960000
FORMATF    EQU   X'80'                                                  03980000
FORMATV    EQU   X'40'                                                  04000000
FORMATD  EQU   X'20'                    D FORMAT RECORDS         S20038 04010020
BLOCKED    EQU   X'10'                                                  04020000
FIXEDBLK   EQU   X'90'                                                  04040000
*                                                                       04060000
*                                                                       04080000
*********************************************************************   04100000
*                                                                       04120000
*                                                                       04140000
*   CHANNEL CONTROL WORD FLAGS                                          04160000
*                                                                       04180000
SKIP       EQU   X'10'                                                  04200000
SLI        EQU   X'20'                                                  04220000
CC         EQU   X'40'                                                  04240000
DATACH     EQU   X'A0'                                                  04260000
SLICC      EQU   X'60'                                                  04280000
SLICCSK    EQU   X'70'                                                  04300000
*                                                                       04320000
*                                                                       04340000
*********************************************************************   04360000
*                                                                       04380000
*                                                                       04400000
KEYS       EQU   X'01'                                                  04420000
QSAM       EQU   X'01'                                                  04440000
*                                                                       04460000
*                                                                       04480000
*********************************************************************   04500000
*                                                                       04520000
GETMAIN    EQU   4                                                      04540000
XCTL       EQU   7                                                      04560000
LOAD       EQU   8                                                      04580000
*                                                                       04600000
*********************************************************************   04620000
*                                                                       04640000
D2       EQU   2                        DISPLACEMENT OF 2        S21040 04642021
D3       EQU   3                        DISPLACEMENT OF 3        S21040 04644021
D6       EQU   6                        DISPLACEMENT OF 6        S21040 04646021
L1       EQU   1                        LENGTH OF 1              S21040 04648021
L3       EQU   3                        LENGTH OF 3              S21040 04650021
L4       EQU   4                        LENGTH OF 4              S21040 04652021
*                                                                       04660000
**********************************************************************  04680000
ASA        EQU   X'04'                                                  04700000
BKREAD     EQU   X'01'                                                  04720000
URBITS   EQU   X'40'                                                    04740000
TAPEB    EQU   X'80'                                                    04760000
DABIT    EQU   X'20'                                                    04780000
OVRDMSK  EQU   X'C0'                    INDICATES OPEN OVERRITE  S21040 04782021
OVRDIN   EQU   X'0F'                    TEST FOR LABEL=(,,,IN)   S21040 04784021
ERREOB   EQU   X'0B'                    UTF EOB DISP. IN TABLE   S21040 04786021
PTR3211  EQU   X'49'                    MASK FOR 3211 PRINTER    S20202 04790020
*                                                                       04800000
**********************************************************************  04820000
*                                                                       04840000
**********************************************************************  04860000
*                                                                       04880000
*                                                                       04900000
*                                                                       04920000
*                                                                       04942000
*                                                                       04944000
*                                                                       04946000
*                                                                       04948000
*                                                                       04950000
*                                                                       04952000
*                                                                       04954000
*                                                                       04956000
*                                                                       04958000
*                                                                       04960000
*                                                                       04980000
         BALR  RBASE,0                                                  05000000
         USING SLDA,RBASE                                               05020000
         USING IHADCB,RDCB                                              05040000
         USING FORCORE,RCORE                                            05080000
*                                                                       05120000
*                                                                       05140000
SLDA     EQU   *                                                        05160000
*                                                                       05180000
         B     BEGIN                    BRANCH AROUND MODULE ID  YM4640 05180102
         DC    C'IGG01910'              MODULE NAME              YM4640 05180202
         DC    C'@Z30TSCF'              LAST SHIP CODE         @Z30TSCF 05180303
         DC    C'10/22/74'              LAST SHIP DATE         @Z30TSCF 05180403
BEGIN    DS    0H                       END OF MODULE ID         YM4640 05180502
*                                                                       05200000
         L     RDCB,0(RPARC)            GET DCB ADDRESS                 05220000
         LA    RDCB,0(RDCB)             CLEAR HI BYTE                   05240000
         L     RDEB,DCBDEBAD            GET DEB ADDRESS                 05260000
         USING DEBBASIC,RDEB                                            05270001
         L     RCORE,4(RWTGC)           GET WORK AREA                   05280000
         MVI   22(RWTG),X'CB'          CHANGE DE ATTR.TO ONLY LOADABLE  05300000
*                                                                       05320000
         L     RTIOT,DEBAPPAD           GET APPENDAGE ADDRESS           05340000
         USING DEBAVT,RTIOT                                             05350001
         SR    RUCB,RUCB                CLEAR REG                       05360000
         SR    RF,RF                    CLEAR RER                       05380000
         IC    RUCB,DEBNMEXT            GET NUMBER OF EXTENTS           05400000
         IC    RF,DEBEXSCL              GET SCALING FACTOR              05420000
         SLL   RUCB,0(RF)               SHIFT ACCORDING TO EXTENT SIZE  05440000
         IC    RF,DEBAMLNG              GET ACCESS METHOD LENGTH        05460000
         LA    RUCB,0(RF,RUCB)          ADD TO POINT TO SUBRT ID FLD    05480000
         LA    RUCB,32(RUCB,RDEB)       ADD BASIC DEB SZ TO DEB AD      05500000
*                                                                       05520000
*  RUCB NOW POINTS TO THE SUBROUTINE ID FIELD IN THE DEB                05540000
*                                                                       05560000
         TM    DCBOPTCD,UTFMASK         TEST FOR TOTALING          UT18 05561018
         BZ    SLDAA                    BR IF NOT SPECIFIED        UT18 05562018
         TM    0(RPARC),INPRDBK         IS OPEN FOR INPUT/RDBACK   UT18 05563018
         BZ    SLDAA                    IF YES, NO TOTALING REQ'D  UT18 05564018
*                                                                  UT18 05565018
* SINCE UTF WAS SPECIFIED THE TOTALING SAVE ROUTINE (IGG019AX)     UT18 05566018
*        WAS LOADED BY IGG0191Y IN STAGE 1 - SO IT IS NECESSARY    UT18 05567018
*        TO UPDATE THE SUBROUTINE ID POINTER (RUCB) TO POINT       UT18 05568018
*        TO THE SECOND ID SUBFIELD.                                UT18 05569018
*                                                                  UT18 05570018
         LA    RUCB,2(RUCB)             POINT TO NEXT ID SUBFIELD  UT18 05571018
SLDAA    EQU   *                                                 S20202 05571220
         CLI   DCBDEVT,PTR3211          TEST FOR 3211 PRINTER    S20202 05571420
         BNE   SLDAB                    NO BRANCH AROUND         S20202 05571620
*                                                                       05571820
*   FOR A 3211 PRINTER LOAD AN ABNORMAL END APPENDAGE AND AN ERROR      05572020
*   RETRY MODULE.                                                       05572220
*                                                                       05572420
         LA    RB,ABEAPP11        ABNORMAL END APD ID            S20202 05572601
         BAL   RC,SLDROUT              GO LOAD APP AND RETURN    S20202 05572701
         MVC   DEBXCEAD,25(RWTG)       MOVE APP ADDR INTO AVT    S20202 05572801
         LA    RB,ERRMOD                GET ADDR OF ERROR RETRY  S20202 05573420
         BAL   RC,SLDROUT               GO LOAD ERROR RETRY MOD  S20202 05573620
*                                                                       05573820
*   WHEN RETURN FROM 'SLDROUT'- R0 CONTAINS THE ADDR OF THE             05574020
*   ASYNCHRONOUS ERROR ROUTINE. NOW BUILD AN IRB TO BE USED  IN         05574220
*   SCHEDULING THIS ROUTINE                                             05574420
         CIRB  EP=(0),KEY=PP,MODE=PP,STAB=(RE)                          05574601
         ST    RF,K24(RWTG)             TEMP SAVE FOR IRB ADDR   S20202 05574820
         MVC   DEBIRBB,25(RWTG)   MOVE IRB ADDR INTO DEB         S20202 05575001
SLDAB    EQU   *                                                 M5150  05575720
         USING WTGENTRY,RWTGC                                    Y02072 05575802
         MVC   WTGIDTTR,NEXTMOD         ID OF NEXT MOD IN WTG  @Z30TSCF 05575903
         TM    DCBCIND2,QSAMB           DCB FOR QSAM                    05594002
         BC    1,SLD100                 YES BRANCH                      05600000
*                                                                       05620000
         CLI   DCBDEVT,OCR3886          IS DEVICE A 3886        XL03127 05670002
         BNE   SLDAC                    NO,BR FOR STD BSAM CHECKXL03127 05672002
         LA    RB,OCRCHK                YES,GET ADDR OCR CHK ID XL03127 05674002
         B     SLDAE                    BRANCH AROUND           XL03127 05676002
SLDAC    LA    RB,CHECK                 GET ADDRESS OF CHECK ID         05680002
SLDAE    EQU   *                        BRANCH POINT            XL03127 05690002
         TM    DCBOFLGS,X'20'           CONCATENATION UNLIKE ATTRIBUTES 05700000
         BC    8,SLDA0                  NO BRANCH                       05720000
         BAL   RC,SLDROUT1              STORE THE ID OF CHECK IN DEB    05740000
         B     SLDA1                                                    05760000
*                                                                       05780000
SLDA0    BAL   RC,SLDROUT               LOAD CHECK ROUTINE              05800000
         MVC   DCBCHECK+1(3),25(RWTG)  LOAD CHECK ADDR. INTO DCB        05820000
*                                                                       05840000
SLDA1    EQU   *                                                        05860000
*                                                                       05880000
         CLI   DCBDEVT,OCR3886          IS DEVICE A 3886        XL03127 05890002
         BNE   SLDA3                    NO,BR FOR STD BSAM READ XL03127 05892002
         LA    RB,OCRREAD               YES,GET ADDR OCR RD ID  XL03127 05894002
         B     SLDA5                    BRANCH AROUND           XL03127 05896002
*                                                                       05898002
SLDA3    LA    RB,WRH2                  GET RD/WRT ID ADDRESS           05900002
SLDA5    BAL   RC,SLDROUT               TO LOAD FUNCTION                05920002
         MVC   DCBREAD+1(3),25(RWTG)   LOAD READ/WR ADDR. IN DCB        05940000
*                                                                       05960000
         B     SLDEOB                   GET SPECIAL ROUTINES            05980000
*                                                                       06000000
*********************************************************************** 06020000
*                                                                       06040000
SLD100   EQU   *                                                        06060000
*                                                                       06080000
         TM    DISPSN(PARAR),OUTP       DCB  EOR  OUTPUT                06120000
         BC    1,SLD200                 YES BRANCH                      06140000
*                                                                       06160000
         LA    RB,GERR                  GET ADDRESS OF GERR ID          06180000
*                                                                       06200000
         TM    DCBOFLGS,X'20'           CONCATENATION UNLIKE ATTRIBUTES 06220000
         BC    8,SLD100A                NO BRANCH                       06240000
*                                                                       06260000
         BAL   RC,SLDROUT1              JUST STORE GERRS ID IN DEB      06280000
         B     SLD101                                                   06300000
*                                                                       06320000
*                                                                       06340000
SLD100A  BAL   RC,SLDROUT               LOAD GERR                       06360000
         MVC   DCBGERR+1(3),25(RWTG)   LOAD GERR ADDR. IN DCB           06380000
*                                                                       06400000
*                                                                       06420000
SLD101   EQU   *                                                        06440000
*                                                                       06460000
         TM    DCBDEVT,URBITS           DCB USING URE                   06480000
         BC    1,SLD170                 YES BRANCH                      06500000
*                                                                       06520000
         TM    DCBDEVT,TAPEB            DCB USING TAPE                  06540000
         BC    8,SLD160                 NO BRANCH                       06560000
*                                                                       06580000
         TM    DEBOPATB,X'03'          OPEN FOR BACKWARD READ           06600000
         BC    9,SLD160                NO BRANCH                        06620000
*                                                                       06640000
         LA    RB,SBLF                  SET UP BASE FOR BACKWARD GETS   06660000
         TM    DCBMACRF,MOVEXCHB       DCB USING MOVE OR SUBST. MODE    06680000
         BC    8,SLD150                 NO BRANCH MUST BE LOCATE MODE   06700000
         LA    RB,L'NXTENTRY(RB)        POINT TO MVOE MODE       Y02072 06732002
*                                                                       06740000
*                                                                       06760000
SLD150   EQU   *                                                        06780000
         BAL   RC,SLDROUT               TO LOAD FUNCTION                06800000
         MVC   DCBGET+1(3),25(RWTG)    LOAD GET ADDR. IN DCB            06820000
*                                                                       06840000
*******************************************************************     06860000
*******************************************************************     06880000
*                                                                       06900000
         B     SLDEOB                   TO SPECIAL ROUTINES             06920000
*                                                                       06940000
SLD160   EQU   *                                                        06960000
*                                                                       06980000
         LA    RB,SGLF                  SET UP FOR NORMAL GET IDS       07000000
         B     SLD172                                                   07020000
*                                                                       07040000
SLD170   TM    DCBMACRF,CNTRLB          IS CNTRL MACRO USED READER      07060000
         BC    8,SLD160                 NO USE NORMAL GETS              07080000
*                                                                       07100000
         LA    RB,GMFC                  POINT TO SPECIAL GET MOVE       07120000
*                                                                       07140000
         B     SLD175                                                   07160000
*                                                                       07180000
SLD172   EQU   *                                                        07200000
         TM    DCBMACRF,MOVEXCHB        DCB USING MOVE OR SUBST. MODE   07220000
         BC    8,SLD175                 NO BRANCH MUST BE LOCATE MODE   07240000
*                                                                       07260000
SLD173   EQU   *                                                        07280000
         LA    RB,2*L'NXTENTRY(RB)      UPDATE TO MOVE MODE      Y02072 07282002
SLD175   EQU   *                                                        07320000
         TM    DCBRECFM,DCBRECF         FORMAT F OR U           SA66897 07370002
         BO    SLD150                   YES, GO LOAD ROUTINE    SA66897 07420002
         TM    DCBRECFM,DCBRECV         FORMAT V                SA66897 07422002
         BO    SLD1760                  YES, GO INCR TO NEXT ID SA66897 07424002
*                                                                       07426002
* BECAUSE DCBRECFM FIELD BITS 0, 1, & 2 HAVE DUPLICATE MEANINGS         07428002
* IT IS NECESSARY TO MAKE THE FOLLOWING TWO TESTS TO DETERMINE          07428402
* IF FORMAT D RECORDS ARE BEING USED.                                   07428802
*   RECFM = 001XXXXX - UNDEFINED REC FORMAT WITH TRK OVERFLO            07428902
*   RECFM = 001XXXXX - ASCII TAPE (OPTCD = Q)                           07429002
* AT THIS POINT BITS 0 & 1 ARE ZERO.                                    07429102
*                                                                       07429202
         TM    DCBRECFM,DCBRECD         ASCII TAPE OR TRK OVFLO SA66897 07429602
         BZ    SLD150                   NO, GO LOAD FOR FORMAT  SA66897 07429702
*                                         U RECORDS             SA66897 07429802
         TM    DCBOPTCD,DCBOPTQ         ASCII TAPE              SA66897 07429902
         BZ    SLD150                   NO, GO LOAD U FORMAT    SA66897 07437402
SLD1760  EQU   *                                                 S20038 07445002
         LA    RB,L'NXTENTRY(RB)        UPDATE TO V REC IDS      Y02072 07452502
         B     SLD150                   TO LOAD FUNCTION                07460000
*                                                                       07480000
SLD200   LA    RB,PERR                  GET ADDRESS OF PERR ID          07500000
         BAL   RC,SLDROUT               TO LOAD SUBROUTINE              07520000
         MVC   DCBPERR+1(3),25(RWTG)   LOAD PERR ADDR.IN DCB            07540000
*                                                                       07560000
*                                                                       07580000
SLD250   LA    RB,SPLF                  ESTABLISH BASE FOR PUTS         07600000
*                                                                       07620000
         TM    DCBMACRF+1,MOVEXCHB     DCB USING MOVE OR SUBST. MODE    07640000
         BC    8,SLD175                 NO BRANCH MUST BE LOCATE MOGE   07660000
         B     SLD173                   SET UP FOR MOVE ROUTINES        07680000
*                                                                       07700000
*********************************************************************** 07720000
*                                                                       07740000
SLDEOB   EQU   *                                                        07760000
*                                                                       07780000
*    THIS SECTION OF CODE UP TO THE LABEL ENDOVR WILL ENSURE THAT       07850021
*    THE EOB ROUTINE IGG019CT GETS LOADED BY IGG01917 FOR ANY           07920021
*    OPEN OVERRIDE.                                                     07990021
*                                                                       08060021
         TM    JFCBMASK+D6,OVRDMSK      WAS AN OVERRIDE USED     S21040 08130021
         BNO   ENDOVR                   BR IF NO                 S21040 08200021
         TM    0(RPARC),OVRDIN          WAS IT LABEL=(,,,IN)     S21040 08270021
         BZ    INCHNG                   BR IF YES                S21040 08340021
         MVC   DCBCNTRL+D2(L1),DCBCNTRL+D3 SAVE WRITE EOB DISP   S21040 08410021
         MVI   DCBCNTRL+D3,ERREOB       SET READ EOB ROUTINE FOR S21040 08480021
*                                       THE ERROR EOB ROUTINE           08550021
         B     ENDOVR                   CONTINUE                 S21040 08620021
INCHNG   EQU   *                                                 S21040 08690021
         MVI   DCBCNTRL+D2,ERREOB       SET WRITE EOB ROUTINE    S21040 08760021
*                                       FOR ERROR EOB ROUTINE           08830021
ENDOVR   EQU   *                                                 S21040 08900021
*                                                                       08970021
*    IF USER TOTALING IS TO BE USED, EOB ROUTINES WHICH CONTAIN         09040021
*    THE TOTALING LINKAGE MUST BE LOADED INSTEAD OF THE NORMAL EOB      09110021
*    ROUTINES. THIS IS ACCOMPLISHED BY DOING A TRANSLATE OF THE         09180021
*    DCBCNTRL FIELD TO CONVERT NORMAL EOB DISPLACEMENTS INTO            09250021
*    DISPLACEMENTS FOR THE UTF EOB ROUTINE. THE ROUTINES ARE            09320021
*    LOADED BY IGG01917.                                                09390021
*                                                                       09460021
         TM    DCBOPTCD,UTFMASK         TEST FOR TOTALING OPTION S21040 09530021
         BZ    RELOOP                   BR IF NOT SPECIFIED      Y02072 09600002
         TM    0(RPARC),INPRDBK         IS OPEN FOR INPUT/RDBACK S21040 09670021
         BZ    RELOOP                   IF YES, NO TOTALING REQD Y02072 09740002
         TR    DCBCNTRL(L4),UTFTBL      CHANGE TO UTF DISP.      S21040 09810021
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURR WTG ENTRY        10280000
         LA    RPARC,PLOFF(0,RPARC)     INCR CURRENT DCB ENTRY PRTR     10300000
         CLC   0(2,RWTGC),AMIDCNST      THIS RT NEEDED AGAIN            10320000
         BCR   8,RBASE                                                  10340000
*                                                                       10360000
         CLC   0(2,RWTGC),OPIDCNST      END OF TABLE                    10380000
         BC    7,RELOOP                 NO,CHECK NEXT ENTRY             10400000
*                                                                       10420000
         LR    RPARC,RPAR                                               10440000
         LA    RWTGC,WAOFF(0,RWTG)      REINITIALIZE WTG LIST PTR       10460000
ZCHEK    CLI   0(RWTGC),X'00'          IS THIS ENTRY COMPLETE           10480000
         BC    7,TCTLRTN                IF NOT TRANSFER CONTROL         10500000
*                                                                       10520000
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY                  10540000
         LA    RPARC,PLOFF(0,RPARC)                                     10560000
         BC    15,ZCHEK                                                 10580000
*                                                                       10600000
TCTLRTN  EQU   *                                                        10620000
         USING WTG,RWTG                                                 10670003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*10720003
               MODID=WTGENTRY                                  @Z30TSCF 10730003
         DROP  RWTGC,RWTG                                      @Z30TSCF 10740003
*                                                                       10760000
*                                                                       10780000
*                                                                       10800000
WAOFF    EQU   32                                                       10820000
PLOFF    EQU   4                        OFFSET OF DCB ENTRIES           10840000
WGOFF    EQU   8                        OFFSET OF WTG ENTRIES           10860000
OPIDCNST DC    C'0S'                                                    10880000
AMIDCNST DC    C'10'                                                    11060000
*                                                                       11080000
*                                                                       11100000
*                                                                       11120000
         DS    0H                                                       11140000
SLDROUT  EQU   *                                                        11160000
         USING WTGMODNM,RWTG                                     Y02072 11210002
         MVC   WTGMODID,0(RB)           ID TO MOD NAME           Y02072 11260002
         DROP  RWTG                                              Y02072 11310002
*                                                                       11380000
         L     R1,CVTPTR                LOAD CVT ADDRESS         YM1140 11390002
         USING CVT,R1                   CVT ADDRESSABILITY       YM1140 11392002
         L     R1,CVTLINK               GET LPALIB DCB ADDRESS   YM1140 11394002
         DROP  R1                       DROP CVT BASE            YM1140 11396002
*                                                                       11400000
         LOAD  EPLOC=(RWTG),DCB=(1)                              YM1140 11420002
*                                                                       11440000
*                                                                       11460000
*                                                                       11480000
         ST    RE,24(RWTG)             TEMP STORE OF ROUTINE ADDR,      11500000
SLDROUT1 MVC   0(2,RUCB),0(RB)          STORE ROUTINES ID IN DEB        11520000
         LA    RUCB,2(RUCB)             UPDATE SUBRT PNTR               11540000
         SR    RD,RD                    CLEAR REG                       11560000
         IC    RD,DEBNMSUB              GET NO.OF SUBRTS LOADED SO FAR  11580000
         LA    RD,1(RD)                 ONE MORE SUB RT LOADED          11600000
         STC   RD,DEBNMSUB              STORE NEW TOTAL SUBRTS LOADED   11620000
         BR    RC                      RETURN                           11640000
*                                                                       11660000
*                                                                       11730021
*    THE FOLLOWING TABLE IS USED WITH A TRANSLATE INSTRUCTION           11740021
*    TO CONVERT DISPLACEMENTS FOR THE EOB TABLE INTO THE                11750021
*    ENTRIES FOR THE CORRESPONDING UTF EOB ROUTINES.                    11760021
*                                                                       11770021
UTFTBL   EQU   *                                                 S21040 11780021
         DC    X'00'                    NO CHANGE                S21040 11790021
         DC    X'0C'                    IGG019CD TO IGG019TD     S21040 11800021
         DC    X'0D'                    IGG019CC TO IGG019TC     S21040 11810021
         DC    X'03'                    NO CHANGE                S21040 11820021
         DC    X'04'                    NO CHANGE                S21040 11830021
         DC    X'05'                    NO CHANGE                S21040 11840021
         DC    X'06'                    NO CHANGE                S21040 11850021
         DC    X'07'                    NO CHANGE                S21040 11860021
         DC    X'08'                    NO CHANGE                S21040 11870021
         DC    X'09'                    NO CHANGE                S21040 11880021
         DC    X'0A'                    NO CHANGE                S21040 11890021
         DC    X'0B'                    NO CHANGE                S21040 11900021
*                                                                       12060000
*********************************************************************** 12080000
*                                                                       12100000
*   BELOW ARE THE QSAM ROUTINES BEING SUPPORTED                         12120000
*                                                                       12140000
*********************************************************************   12160000
*                                                                       12180000
NEXTMOD  DC    C'17',VL3(IGG01917)      IGG01917 - THIS IS THE @Z30TSCF 12240003
*                                       SECOND HALF OF THIS MODULE UT18 12260002
SGLF     DC    C'AA'                    SIMPLE GET LOC MODE FIXED REC.  12300000
SGLV     DC    C'AB'                    SIMPLE GET LOC MODE VARIABLE R. 12360000
SGMF     DC    C'AC'                    SIMPLE GET MOVE MD FIXED RECS.  12420000
SGMV     DC    C'AD'                    SIMPLE GET MOVE MD VARIABLE REC 12480000
GMFC     DC    C'AG'                    SIMPLE GET CARD RDR-CNTRL MOVEF 12540000
GMVC     DC    C'AG'                    SIMPLE GET CARD RDR-CNTRL 25005 12590018
*                                       MOVEF                     25005 12600018
SPLF     DC    C'AI'                    SIMPLE PUT LOC MD. FIXED RECS   12660000
SPLV     DC    C'AJ'                    SIMPLE PUT LOC MD. VARIABLE REC 12720000
SPMF     DC    C'AK'                    SIMPLE PUT MOVE MD. FIXED REGS  12780000
SPMV     DC    C'AL'                    SIMPLE PUT MOVE MD. VARIABLE RC 12840000
SBLF     DC    C'AM'                    SIMPLE GETBACKWARDS LOC MD  FIX 12900000
SBMF     DC    C'AN'                    SIMPLE GETBACKWARDS MOVE MD VAR 12960000
GERR     DC    C'AQ'                    GET ERROR ROUTINE               13020000
PERR     DC    C'AR'                    PUT ERROR ROUTINE               13080000
*                                                                       13140000
*  THIS CONCLUDES THOSE QSAM MODULES THAT ARE BEING SUPPORTED NOW       13160000
*                                                                       13180000
*   BELOW ARE THE BSAM MODULES BEING SUPPORTED AT THIS TIME             13240000
*                                                                       13260000
*                                                                       13280000
WRH2     DC    C'BA'                    READ-WRITE ROUTINE              13300000
CHECK    DC    C'BB'                    CHECK ROUTINE                   13360000
OCRREAD  DC    C'LU'                    READ ROUTINE FOR 3886   XL03127 13430002
OCRCHK   DC    C'LS'                    CHECK ROUTINE FOR 3886  XL03127 13436002
*    THIS CONCLUDES THE BSAM MODES BEING SUPPORTED NOW                  13480000
*                                                                       13500000
*   3211 ERROR RETRY MODULES                                            14402020
*                                                                       14404020
ABEAPP11 DC    C'FR'       TTR FOR 3211 ABN APP                  M5150  14412002
ERRMOD   DC    C'FS'       TTR FOR ERR RETRY MODS                M5150  14414002
NXTENTRY DS    0CL2                     TO GET 2 BYTE LEN ATTR   Y02072 14416002
         SPACE 3                                                        14422002
PATCH    DC    25H'0'                   PATCH AREA               YM4640 14430002
END      EQU   *                        END OF MODULE            Y02072 14480002
         TITLE 'IGG01910 - FORMAT OF GOTTEN CORE'                       14540002
         IECDSECS  MAIN,WTG,PREFX,EXPAND=YES                   @Z30TSCF 14590003
         ORG   WTGIDTTR                                          Y02072 14600002
WTGID    DS    CL2                      NEXT MOD ID              Y02072 14610002
*                                                                       14620000
CVT      DSECT                                                          14640000
         CVT                                                            14660000
*                                                                       14680000
*                                                                       14700000
         IEZDEB                                                         14720001
*                                                                       15260000
           DCBD  DSORG=PS                                               15280000
*                                                                       15300000
**********************************************************************  15320000
*                                                                       15340000
           END                                                          15360000
