 TITLE 'IGG01912 - SAM PAPER TAPE/UPDATE'                               00007018
*                                                                       00009001
*                                                                       00011001
IGG01912 CSECT                                                     UT18 00014018
*MODULE NAME - IGG01912                                          Y02072 00014402
*                                                                       00014802
*DESCRIPTIVE NAME - LOAD ACCESS METHOD ROUTINES                  Y02072 00015202
*                                                                       00015602
*COPYRIGHT - NONE                                                Y02072 00015702
*                                                                       00015802
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00015902
*                                                                       00018102
*          VS2 RELEASE 2 DELETIONS                               Y02072 00020602
*000080,000550,010800,057500,057700,057900-057940,081400,082000, Y02072 00022802
*089860-090000,090800,091240,091280,091320,091360,091400-091600, Y02072 00025002
*091756-091762,101000,120210-120558,123400,053570-053599,        Y02072 00027202
*60160,110800-111000,116600,117000-118400,119200                 Y02072 00037202
*                                                                YM1141 00037302
*                                                                YM1140 00047302
*                                                                YM4640 00047402
*                                                                       00049403
*          VS2 RELEASE 3 DELETIONS                                      00051403
*                                                              @Z30TSCF 00053403
*00009341020,9342020                                           @ZA05572 00054403
*          RELEASE 20 DELETIONS                                         00055802
*0930080800,081800                                               A34004 00058002
*0930129000,150800,151400                                        S20201 00060202
*          RELEASE 21 DELETIONS                                         00062402
*0090055600,068200-068400,111200,129000-151800,152400-152600     S21042 00064602
*                                                                       00066802
*STATUS CHANGE LEVEL 007                                                00075602
*                                                                       00077802
*FUNCTION/OPERATION: THIS ROUTINE WILL LOAD MODULES NECESSARY FOR       00080000
*      PROCESSING PAPER TAPE INPUT OR UPDATE AFTER DETERMINING          00100000
*      WHAT THEY ARE.  IT WILL PLACE THE ADDRESS OF THE LOADED          00120000
*      MODULES IN THE APPROPRIATE DCB FIELDS, AND THE ID'S IN THE DEB   00140000
*      IT WILL BRING IN THE APPROPRIATE ERROR ROUTINES.                 00160000
*      IT WILL BRING IN ANY SIO APPENDAGES REQUIRED TO PERFORM SPECIFIC 00200000
*      FUNCTIONS.                                                       00220000
*      THIS MODULE WAS SPLIT IN RELEASE 18 TO INCLUDE USER         UT18 00225018
*      TOTALING SUPPORT.  THE SECOND HALF OF THIS MODULE IS NOW    UT18 00230018
*      IGG01918.                                                   UT18 00235018
*                                                                       00240000
*ENTRY POINTS  ENTERED FROM IGG0191G OR IGG0191P BY USE OF THE XCTL     00260000
*      MACRO                                                            00280000
*                                                                       00300000
*INPUT: SEE DESCRIPTION OF REGISTERS, DCB(USERS)                        00320000
*                                                                       00340000
*OUTPUT: DCB(USERS),IOB(USERS).                                         00360000
*                                                                       00380000
*EXTERNAL ROUTINES: NONE.                                               00400000
*                                                                       00420000
*EXITS-NORMAL   XCTL TO IGG01918.                                  UT18 00440018
*                                                                       00460000
*EXITS-ERROR: NONE.                                                     00480000
*                                                                       00500000
*TABLES/WORKAREAS - WHERE TO GO TABLE (WTG)                             00520000
*                                                                       00540000
*      BYTE 0-7    NAME                                                 00560000
*      BYTE 8-10   RELATIVE DISK ADDRESS (TTR) OF FIRST RECORD          00580000
*      BYTE 11     CONCATENATION NUMBER                                 00600000
*      BYTE 12     ZERO                                                 00620000
*      BYTE 13     ALIAS INDICATOR AND USER DATA FIELD DESCRIPTOR.      00640000
*                       ALIAS INDICATOR 1 BIT                           00660000
*                       NUMBER OF TTRS IN USERS DATA FIELD 2 BITS       00680000
*      BYTE 14-16  TTR OF FIRST TEXT RECORD                             00700000
*      BYTE 17     ZERO                                                 00720000
*      BYTE 18-19  TTR OF NOTE LIST OR SCATTER LIST                     00740000
*      BYTE 20     TRANSLATION TABLE                                    00760000
*      BYTE 21     ZERO OR NUMBER OF ENTRIES IN THE NOTE LIST           00780000
*      BYTE 22-23  ATTRIBUTES                                           00800000
*      BYTE 24-26  TOTAL CONTIGUOUS MAIN STORAGE REQUIRED FOR MODULE    00820000
*      BYTE 27-28  LENGTH OF FIRST TEXT RECORD                          00840000
*      BYTE 29     LENGTH OF WTG TABLE (IN DOUBLE WORDS)                00860000
*      BYTE 30-31  PATH THROUGH LOADS OF ROUTINES                       00880000
*      BYTE 32-36 IDTTR OF EXECUTOR FOR FIRST DCB                       00900000
*      BYTE 37-39 WORKAREA ADDRESS FOR FIRST DCB                        00920000
*      BYTE 40-   TABLE OF IDTTR'S                                      00940000
*      BYTE 32+N(8) IDTTR OF EXECUTOR FOR N TH DCB   (5 BYTES)          00960000
*                   WORKAREA ADDRESS FOR N TH DCB    (3 BYTES)          00980000
*                   IDTTR OF LAST ROUTINE LOAD       (5 BYTES)          01000000
*                   NOT USED                         (3 BYTES)          01020000
*********************************************************************** 01040000
*                                                                       01060000
*ATTRIBUTES: REENTRANT, REUSABLE, RUNS IN DATA MANAGEMENT KEY    Y02072 01080002
*                                                                       01100000
*NOTES  THIS ROUTINE HAS A LIST OF ALL BSAM, QSAM MODULES SUPPORTED     01120000
*      FOR PAPER TAPE AND UPDATE.                                       01140000
*                                                                       01160000
*********************************************************************** 01180000
*                                                                       01200000
*                                                                       01220000
*  REGISTER CONVENTIONS USED THROUGH OUT ALL OPEN PASSES                01240000
*                                                                       01260000
*********************************************************************** 01280000
*                                                                       01300000
RE       EQU   0         WORK REG5                                      01310002
RWK1     EQU   RE        WORK REGISTER                           Y02072 01312002
RF       EQU   1         WORK REG6                                      01314002
R1       EQU   RF        PARM REG                                YM1140 01316002
RDCB     EQU   2         DCB REGISTER                                   01320000
RBASE    EQU   3         BASE REGISTER                                  01340000
RCORE    EQU   4         WORK AREA ADDRESS                              01360000
RPAR     EQU   5         TOP OF PARAMETER LIST                          01380000
RWTG     EQU   6         TOP OF WTG TABLE                               01400000
RPARC    EQU   7         CURRENT PARAMETER                              01420000
RWTGC    EQU   8         CURRENT TRANS LOAD                             01440000
RTIOT    EQU   9         USED HERE AS WRK REG AND  COMM VECTOR ADDR.    01460000
RUCB     EQU   10        USED HERE AS A COUNTER IN IOB GENERATION       01480000
RDEB     EQU   11        DEB ADDRESS                                    01500000
RB       EQU   12        WORK REG1  **                                  01520000
RC       EQU   13        WORK REG2  **                                  01540000
RWK2     EQU   RC                       WORK REGISTER            Y02072 01550002
RD       EQU   14        WORK REG3  **                                  01560000
RJ       EQU   15        WORK REG4                                      01580000
*                                                                       01640000
*                                                                       01660000
PARAR    EQU   RPARC                                                    01680000
*                                                                       01700000
*********************************************************************** 01720000
*                                                                       01740000
*********************************************************************** 01760000
*                                                                       01780000
* MASK'S TO TEST PARAMETER LIST WITH                                    01800000
*                                                                       01820000
*********************************************************************   01840000
INP      EQU   X'0F'                                                    01860000
OUTP       EQU   X'0F'                                                  01880000
UPDATE     EQU   X'04'                                                  01900000
INOUT      EQU   X'03'                                                  01920000
OUTIN      EQU   X'07'                                                  01940000
RDBACK     EQU   X'01'                                                  01960000
INPRDBK  EQU   X'0E'               MASK TO CK INPUT AND RDBACK     UT18 01970018
*                                                                       01980000
*                                                                       02000000
*********************************************************************   02020000
*                                                                       02040000
*                                                                       02060000
* OFFSET FOR PARAMETER TESTS                                            02080000
*                                                                       02100000
ONE        EQU   X'01'                                                  02120000
FRTYATE    EQU   48                                                     02140000
DISPSN     EQU   X'0'                                                   02160000
*                                                                       02180000
*                                                                       02200000
*********************************************************************   02220000
*                                                                       02240000
* OFFSETS FOR DEB REFERENCE                                             02260000
*                                                                       02280000
*                                                                       02300000
BIN      EQU   36                                                       02320000
BEXT     EQU   38                                                       02340000
*                                                                       02360000
*                                                                       02380000
*                                                                       02400000
*********************************************************************   02420000
*                                                                       02440000
* MASK'S USED TO TEST OPTION FIELDS IN DCB                              02460000
*                                                                       02480000
*                                                                       02500000
*                                                                       02520000
DOUBLE     EQU   X'01'                                                  02540000
*                                                                       02560000
*                                                                       02580000
STOWB      EQU   X'80'                                                  02600000
WRTCK      EQU   X'80'                                                  02620000
OVRFLO     EQU   X'20'                                                  02640000
PCI        EQU   X'20'                                                  02660000
MINKEY     EQU   X'01'                                                  02680000
CONCAT     EQU   X'FF'                                                  02700000
UPDATEB  EQU   X'80'                                                    02720000
OVFLBIT  EQU   X'20'                                                    02740000
UTFMASK  EQU   X'02'                    MASK FOR TOTALING FACILITY UT18 02750018
*********************************************************************   02760000
*                                                                       02780000
* MASKS FOR ACCESS METHODS IN SAM                                       02800000
*                                                                       02820000
QSAMB      EQU   X'01'                                                  02840000
BSAMBIT    EQU   X'00'                                                  02860000
PAM        EQU   X'02'                                                  02880000
*                                                                       02900000
*                                                                       02920000
* MASKS FOR MACRO'S TO BE USED                                          02940000
*                                                                       02960000
GETB       EQU   X'40'                                                  02980000
PUTB       EQU   X'40'                                                  03000000
READB      EQU   X'20'                                                  03020000
WRITEB     EQU   X'20'                                                  03040000
POINTB     EQU   X'04'                                                  03060000
CNTRLB     EQU   X'02'                                                  03080000
*                                                                       03100000
*                                                                       03120000
*********************************************************************   03140000
*                                                                       03160000
* MASKS FOR DEVICES TO BE SUPPORTED                                     03180000
*                                                                       03200000
*                                                                       03220000
*                                                                       03240000
*********************************************************************   03260000
*                                                                       03280000
*                                                                       03300000
*                                                                       03320000
*                                                                       03340000
*********************************************************************   03360000
*                                                                       03380000
* MASKS FOR STATUS BITS TO BE TESTED                                    03400000
*                                                                       03420000
*                                                                       03440000
EXCPN      EQU   X'30'                                                  03460000
COMPLETE   EQU   X'80'                                                  03480000
FIRSTIOB   EQU   X'01'                                                  03500000
*                                                                       03520000
*                                                                       03540000
*                                                                       03560000
*********************************************************************   03580000
*                                                                       03600000
* MASKS FOR BUFFER TECHNIQUE'S                                          03620000
*                                                                       03640000
CYCLICB    EQU   X'20'                                                  03660000
EXCHANGB   EQU   X'10'                                                  03680000
SIMPLEB    EQU   X'40'                                                  03700000
EXCHCYCL   EQU   X'30'                                                  03720000
*                                                                       03740000
*********************************************************************   03760000
*                                                                       03780000
*                                                                       03800000
* MODES OF OPERATION FOR QSAM                                           03820000
*                                                                       03840000
LOCATEB    EQU   X'08'                                                  03860000
MOVEB      EQU   X'10'                                                  03880000
SUBSTUTB   EQU   X'04'                                                  03900000
*                                                                       03920000
*                                                                       03940000
*********************************************************************   03960000
*                                                                       03980000
*                                                                       04000000
* COMMAND BYTES FOR THE 2841                                            04020000
*                                                                       04040000
*       CONTROL UNIT                                                    04060000
*                                                                       04080000
*                                                                       04100000
*                                                                       04120000
SRCHE      EQU   X'31'                                                  04140000
WRTCKD     EQU   X'1D'                                                  04160000
RDC        EQU   X'92'                                                  04180000
RDKD       EQU   X'8E'                                                  04200000
RDD        EQU   X'86'                                                  04220000
TIC        EQU   X'08'                                                  04240000
*                                                                       04260000
*                                                                       04280000
*********************************************************************   04300000
*                                                                       04320000
*                                                                       04340000
* MASKS FOR RECORD FORMATS                                              04360000
*                                                                       04380000
*                                                                       04400000
STANDRDF   EQU   X'08'                                                  04420000
FORMATU    EQU   X'C0'                                                  04440000
FORMATF    EQU   X'80'                                                  04460000
FORMATV    EQU   X'40'                                                  04480000
BLOCKED    EQU   X'10'                                                  04500000
FIXEDBLK   EQU   X'90'                                                  04520000
TRANS    EQU   X'7E'                    TRANSLATE MODE MASK.            04540000
*                                                                       04560000
*                                                                       04580000
*********************************************************************   04600000
*                                                                       04620000
*                                                                       04640000
*   CHANNEL CONTROL WORD FLAGS                                          04660000
*                                                                       04680000
SKIP       EQU   X'10'                                                  04700000
SLI        EQU   X'20'                                                  04720000
CC         EQU   X'40'                                                  04740000
DATACH     EQU   X'A0'                                                  04760000
SLICC      EQU   X'60'                                                  04780000
SLICCSK    EQU   X'70'                                                  04800000
*                                                                       04820000
*                                                                       04840000
*********************************************************************   04860000
*                                                                       04880000
*                                                                       04900000
KEYS       EQU   X'01'                                                  04920000
QSAM       EQU   X'01'                                                  04940000
IDLNG    EQU   2                        LENGTH OF XCTL ID        Y02072 04950002
*                                                                       04960000
*                                                                       04980000
*********************************************************************   05000000
*                                                                       05020000
GETMAIN    EQU   4                                                      05040000
XCTL       EQU   7                                                      05060000
LOAD       EQU   8                                                      05080000
*                                                                       05100000
*********************************************************************   05120000
*                                                                       05140000
*                                                                       05160000
**********************************************************************  05180000
ASISVLN  EQU   9                        DBLWORDS FOR IRB WKA     YM1141 05190002
ASA        EQU   X'04'                                                  05200000
BKREAD     EQU   X'01'                                                  05220000
URBITS   EQU   X'40'                                                    05240000
TAPEB    EQU   X'80'                                                    05260000
DABIT    EQU   X'20'                                                    05280000
OABD075  EQU   75                                                S21042 05290021
*                                                                       05300000
**********************************************************************  05320000
*                                                                       05340000
*     RECORD READY CONSTANTS                                            05343020
*                                                                       05346020
SIX      EQU   6                        CONSTANT OF SIX          S20201 05349020
NRECREDY EQU X'20'                      NON RECORD READY BIT     S20201 05352020
TRKOVFL  EQU   X'20'                    TRACK OVERFLOW BIT       S20201 05355020
**********************************************************************  05360000
*                                                                       05380000
*                                                                       05400000
*                                                                       05420000
*                                                                       05442000
*                                                                       05444000
*                                                                       05446000
*                                                                       05448000
*                                                                       05450000
*                                                                       05452000
*                                                                       05454000
*                                                                       05456000
*                                                                       05458000
*                                                                       05460000
*                                                                       05480000
         BALR  RBASE,0                                                  05500000
         USING SLDA,RBASE                                               05520000
         USING IHADCB,RDCB                                              05540000
         USING DEB,RDEB                                          S21042 05560021
         USING FORCORE,RCORE                                            05580000
*                                                                       05620000
*                                                                       05640000
SLDA     EQU   *                                                        05660000
*                                                                       05680000
         B     BEGIN                    BRANCH AROUND MODULE ID  YM4640 05682002
         DC    C'IGG01912'              MODULE NAME              YM4640 05684002
         DC    C'@Z30TSCF'              LAST SHIP CODE         @Z30TSCF 05686003
         DC    C'10/22/74'              LAST SHIP DATE         @Z30TSCF 05688003
BEGIN    DS    0H                       END OF MODULE ID         YM4640 05690002
*                                                                       05700000
         L     RDCB,0(RPARC)            GET DCB ADDRESS                 05720000
         LA    RDCB,0(RDCB)             CLEAR HI BYTE                   05740000
         L     RDEB,DCBDEBAD            GET DEB ADDRESS                 05760000
         L     RCORE,4(RWTGC)           GET WORK AREA                   05780000
         MVI   22(RWTG),X'CB'           CHANGE ATTRIBUTES TO ONLY LOAD  05800000
*                                                                       05820000
         L     RTIOT,DEBAPPAD           GET APPENDAGE ADDRESS           05840000
         USING AVT,RTIOT                                                05850001
         SR    RUCB,RUCB                CLEAR REG                       05860000
         SR    RF,RF                   CLEAR REG                        05880000
         IC    RUCB,DEBNMEXT            GET NUMBER OF EXTENTS           05900000
         IC    RF,DEBEXSCL              GET SCALING FACTOR              05920000
         SLL   RUCB,0(RF)               SHIFT ACCORDING TO EXTENT SIZE  05940000
         IC    RF,DEBAMLNG              GET ACCESS METHOD LENGTH        05960000
         LA    RUCB,0(RF,RUCB)          ADD TO POINT TO SUBRT ID FLD    05980000
         LA    RUCB,32(RUCB,RDEB)       ADD BASIC DEB SZ TO DEB AD      06000000
*                                                                  UT18 06001018
         TM    DCBOPTCD,UTFMASK         TEST FOR TOTALING          UT18 06002018
         BZ    SLDAA                    BR IF NOT SPECIFIED        UT18 06003018
         TM    0(RPARC),INPRDBK         IS OPEN FOR INPUT/RDBACK   UT18 06004018
         BZ    SLDAA                    IF YES, NO TOTALING REQ'D  UT18 06005018
*                                                                  UT18 06006018
* SINCE UTF WAS SPECIFIED THE TOTALING SAVE ROUTINE (IGG019AX)     UT18 06007018
*        WAS LOADED BY IGG0191Y IN STAGE 1 - SO IT IS NECESSARY    UT18 06008018
*        TO UPDATE THE SUBROUTINE ID POINTER (RUCB) TO POINT       UT18 06009018
*        TO THE SECOND ID SUBFIELD.                                UT18 06010018
*                                                                  UT18 06011018
         LA    RUCB,2(RUCB)             POINT TO NEXT ID SUBFIELD  UT18 06012018
*                                                                  UT18 06013018
SLDAA    EQU   *                        SYMBOLIC ADDR              UT18 06014018
*                                                                  UT18 06015018
         USING WTGENTRY,RWTGC                                    Y02072 06015402
         MVC   WTGIDTTR,NEXTMOD         ID OF NEXT MOD IN WTG  @Z30TSCF 06015803
*                                                                       06020000
* AN OFFSET IS USED TO LOAD THE PROPER MODULES FROM THE LIST OF MODULES 06040000
*   IN THE LOAD TABLE.  THIS OFFSET IS SET TO ZERO FOR BSAM, TWO FOR    06060002
*   QSAM.  THE ARRANGEMENT OF THE LOAD TABLE MUST BE A BSAM MODULE      06080000
*   FOLLOWED BY THE CORRESPONDING QSAM MODULE.                          06100000
*                                                                       06120000
SLD02    EQU   *                                                        06140000
         TM    DCBCIND2,QSAMB           IS THIS DCB FOR QSAM            06160000
         BZ    SLD100                   NO,BRANCH TO SET UP FOR BSAM    06180000
*                                                                       06200000
SLD80    EQU   *                                                        06220000
         LA    RD,IDLNG                 SET UP FOR QSAM          Y02072 06240002
         STH   RD,OFFSET                SET OFFSET TO LOAD QSAM  Y02072 06260002
*                                        MODULES                        06280000
         B     SLD105                                                   06320000
*                                                                       06340000
SLD100   EQU   *                                                        06360000
         SR    RD,RD                    CLEAR THE REGISTER              06400000
         STH   RD,OFFSET                SET OFFSET = 0 TO LOAD BSAM     06420000
*                                        MODULES                        06440000
*                                                                       06460000
SLD105   EQU   *                                                        06480000
         TM    DCBCIND2,UPDATEB         IS THIS UPDATE                  06500000
         BO    SLD106                  YES,GO TO LOAD FOR UPDATE        06520000
*                                                                       06540000
*THIS SECTION LOADS BSAM OR QSAM MODULES FOR PAPER TAPE                 06560000
*                                                                       06580000
SLD200   EQU   *                                                        06600000
         LA    RB,CHECKPT               GET PAPER TAPE CHECK/GERR ID    06620000
         AH    RB,OFFSET                ADD OFFSET TO GET CORRECT ID    06640000
*                                                                       06660000
         TM    DCBOFLGS,X'20'           CONCATENATION UNLIKE ATTRIBUTES 06680000
         BZ    SLD210                   NO,GO TO LOAD ROUTINE           06700000
*                                                                       06720000
SLD205   EQU   *                                                        06740000
*                                       YES, CANNOT HAVE CONCATENATION  06760000
*                                      OF UNLIKE ATTRIBUTES WITH        06780000
*                                      PAPER TAPE, MUST ABEND.          06800000
         DMABCOND OABD075,PDLOAD,RETURN=NONE,RES=NO 013 ABEND    S21042 06820021
         B     TCTLRTN                                           S21042 06840021
SLD210   EQU   *                                                        06860000
         BAL   RC,SLDROUT               TO LOAD CHECK OR GERR           06880000
         MVC   DCBCHECK+1(3),25(RWTG)   STORE ADDRESS IN DCB            06900000
*                                                                       06920000
         LA    RB,RPTU                  GET ADDRESS OF READ/GET TRANS   06940000
*                                                                       06960000
         TM    DCBCODE,TRANS            IS THIS TRANSLATE MODE          06980000
         BM    SLD220                   YES,GO TO LOAD MODULE           07000000
*                                                                       07020000
         LA    RB,WRH2                  NO,GET ADDRESS OF READ ID       07040000
SLD220   EQU   *                                                        07060000
         AH    RB,OFFSET                ADD OFFSET TO GET CORRECT ID    07080000
         BAL   RC,SLDROUT               TO LOAD READ OR GET ROUTINE     07100000
         MVC   DCBREAD+1(3),25(RWTG)    STORE ADDRESS IN DCBREAD/GET    07120000
*********************************************************************** 07140000
*      GET THE TRANSLATE TABLES NECESSARY FOR PAPER TAPE                07160000
*                                                                       07180000
SLDAPP00 EQU   *                                                        07200000
*                                                                       07220000
         SR    RE,RE                    GET TRANSLATION CODE.           07240000
         IC    RE,DCBCODE                                               07260000
         LA    RF,128                   POINT TO FIRST BIT IN TRAN CODE 07280000
         LA    RJ,7                     SET NUMBER OF CODES             07300000
SLDAPP10 EQU   *                                                        07320000
*                                                                       07340000
         CR    RE,RF                    IS THIS BIT ON?                 07360000
         BE    SLDAPP11                 YES, BRANCH.                    07380000
         SRL   RF,1                     NO, SHIFT TEST BIT OVER ONE.    07400000
         BCT   RJ,SLDAPP10              BRANCH WHEN NOT AT LAST BIT.    07420000
SLDAPP11 EQU   *                                                        07440000
*                                                                       07460000
*                                       ADJUST COUNT TO GET PROPER      07480000
*                                         ENTRY IN EXECUTE TABLE.       07500000
         SLL   RJ,2                     MULTIPLY BY FOUR (BYTES/INSTR). 07520000
         EX    0,SLDTTBX(RJ)            EXECUTE PROPER LOAD FOR THIS    07540000
*                                         BIT ON.                       07560000
         BAL   RC,SLDROUT               LOAD ROUTINE                    07580000
         MVC   DCBLCTBL+1(3),25(RWTG)   STORE ADDRESS                   07600000
SLDAPP14 EQU   *                                                        07620000
*                                                                       07640000
         B     SLDAPP15                                                 07660000
*                                                                       07680000
SLDTTBX  EQU   *-4                                                      07700000
*                                                                       07720000
*     ONE OF THESE INSTRUCTIONS WILL BE EXECUTED TO LOAD THE PROPER     07740000
* CONVERSION TABLE OR NONE, AS DETERMINED FROM DCBCODE.                 07760000
*                                                                       07780000
         LA    RB,TLTY                  TELETYPE                        07800000
         LA    RB,ASCI                  ASCII                           07820000
         LA    RB,NCRC                  NCR                             07840000
         LA    RB,BURR                  BURROUGHS                       07860000
         LA    RB,FRID                  FRIDEN                          07880000
         LA    RB,PTTC                  IBM                             07900000
         B     SLDAPP14                 NONE                            07920000
*                                                                       07940000
**********************************************************************  07960000
*THIS SECTION DETERMINES IF A LENGTH CHECKING APPENDAGE IS NEEDED       07980000
*   FOR PAPER TAPE                                                      08000000
*                                                                       08020000
SLDAPP15 EQU   *                                                        08040000
         TM    DCBRECFM,FORMATU         TYPE U RECORDS                  08060000
         BO    RELOOP                   YES, DON'T LOAD          A34004 08070020
*                                       APPENDAGE                A34004 08080020
         LA    RB,ACEP                  GET ID OF WLI APPENDAGE         08100000
         TM    DCBCIND2,QSAMB           IS DCB FOR QSAM                 08120000
         BNO   SLDAPP17                 NO,GO TO LOAD APPENDAGE  Y02072 08140002
         TM    DCBCODE,TRANS            IS IT FOR TRANSLATE             08160000
         BM    RELOOP                   YES, DON'T LOAD          A34004 08170020
*                                       APPENDAGE                A34004 08180020
SLDAPP17 BAL   RWK2,SLDROUT             GO LOAD APPENDAGE        Y02072 08192002
         ST    RWK1,AVTCE               APPEN ADDR TO AVT        Y02072 08194002
         B     RELOOP                   BRANCH TO GET OUT        Y02072 08200002
*                                                                       08220000
*THIS SECTION LOADS BSAM OR QSAM MODULES FOR UPDATE                     08240000
*                                                                       08260000
SLD106   EQU   *                                                        08280000
         LA    RB,CHECKUP               GET CHECK/GERR ID               08300000
         AH    RB,OFFSET                ADD OFFSET TO GET CORRECT ID    08320000
*                                                                       08340000
         TM    DCBOFLGS,X'20'           CONCATENATION UNLIKE ATTRIBUTES 08360000
         BZ    SLD110                   NO,GO LOAD CHECK/GERR ROUTINE   08380000
*                                                                       08400000
         BAL   RC,SLDROUT1              STORE CHECK OR GERR ID IN DEB   08420000
*                                                                       08440000
         B     SLD120                                                   08460000
*                                                                       08480000
SLD110   EQU   *                                                        08500000
         BAL   RC,SLDROUT               TO LOAD CHECK OR GERR           08520000
         MVC   DCBCHECK+1(3),25(RWTG)   STORE ADDRESS IN DCBCHECK/GERR  08540000
SLD120   EQU   *                                                        08560000
         LA    RB,BUEOE                GET END OF EXTENT ID FOR UPDATE  08580000
         AH    RB,OFFSET               ADD OFFSET TO GET CORRECT ID     08600000
         BAL   RC,SLDROUT                                               08620000
         ST    RE,AVTEOE                APPENDAGE TABLE ENTRY FOR EOE   08640001
*                                                                       08660000
         LA    RB,UPRW                  GET READ/WRITE ADDRESS ID       08680000
         AH    RB,OFFSET                ADD OFFSET TO GET CORRECT ID    08700000
         BAL   RC,SLDROUT               TO LOAD READ/WRITE OR GET       08720000
         MVC   DCBREAD+1(3),25(RWTG)    STORE ADDRESS IN DCBREAD/GET    08740000
*                                                                       08760000
*                                                                       08780000
*THIS SECTION LOADS START IO AND, IF NECESSARY,                         08800000
*   LENGTH CHECKING AND TRACK OVERFLOW APPENDAGES FOR UPDATE            08820000
*                                                                       08840000
SLDAPP16 EQU   *                                                        08860000
*                                                                       08880000
         NI    DCBCIND2,X'7F'           TURN OFF UPDATE BIT             08900000
*                                                                       08920000
         LA    RB,USIO                  GET SIO APPENDAGE ID UPDATE     08940000
         BAL   RC,SLDROUT               LOAD ROUTINE                    08960000
         ST    RE,AVTSIO                APPENDAGE TABLE ENTRY FOR SIO   08980001
SLDAPPA  EQU   *                                                        09060000
*                                        APPENDAGE FOR TRACK OVERFLOW   09100000
*                                        INPUT.                         09120000
*     IGG019C3, OFFSET 0, USED FOR THE TRACK OVERFLOW ABNORMAL   Y02072 09124002
*     END, AND OFFSET 4 IS USED FOR THE TRACK OVERFLOW CHANNEL   Y02072 09132002
*     END APPENDAGE                                              Y02072 09136002
         TM    DCBRECFM,OVFLBIT         ARE TRACK OVERFLOW        23591 09165018
*                                       MODULES REQ               23591 09170018
         BZ    SLDAPPB                  NO,BRANCH                 23591 09175018
         LA    RB,TOABNE                GET ADDRESS OF ABNORMAL END     09175402
         BAL   RC,SLDROUT               LOAD THE APPENDAGE              09175502
         ST    RE,AVTABNE               APPENDAGE TABLE ENTRY FOR       09177001
*                                       ABNORMAL END APPENDAGE          09178001
         LA    RB,ASYNCH               GET ID OF ASYNCHRONOUS ROUTINE   09180000
         BAL   RC,SLDROUT              LOAD ROUTINE                     09200000
*  WHEN RETURNING FROM 'SLDROUT', REGISTER 0 CONTAINS THE ADDRESS       09220000
*   OF THE ASYNCHRONOUS ERROR ROUTINE                                   09240000
*                                                                       09260000
*        BUILD IRB FOR IGG019C1 - WORKAREA IS USED IN 19C3              09265002
*                                                                       09270002
         CIRB  EP=(0),KEY=PP,MODE=PP,STAB=(RE),WKAREA=ASISVLN    YM1141 09280002
         ST    RF,24(RWTG)             STORE ADDRESSS OF IRB            09300000
         MVC   DEBIRBAD+1(3),25(RWTG)  PUT IRB ADDRESS IN DEB           09320000
SLDAPPB  EQU   *                                                        09340000
         TM    DCBRECFM,FORMATU         FORMAT U RECORDS         S20201 09343020
         BM    LAB03                    NO BRANCH AROUND         S20201 09344020
         TM    DCBRECFM,TRKOVFL         IS IT TRACK OVERFLOW     S20201 09345020
         BO    SLDAPP19                 YES BRANCH TO SLDAPP19   S20201 09346020
         LA    RB,ACEU                  NO GET U FORMAT CHAN END S20201 09347020
         B     SLDAPP18                 LOAD U FORMAT CHAN END   S20201 09348020
LAB03    EQU   *                                                 S20201 09349020
         TM    DCBRECFM,FORMATF         FIXED LENGTH RECS        S20201 09350020
         BO    LAB02                    BRANCH TO LOAD MOD       S20201 09351020
LAB01    EQU   *                                                 S20201 09352020
         TM    DCBRECFM,FORMATU        FORMAT U RECORDS                 09360000
         BC    9,SLDAPP19              BRANCH IF SPECIFIED FORMAT U     09380000
*                                        OR NOT SPECIFIED AT ALL.       09400000
         LA    RB,ACEV                 GET VARIABLE RD LGN CHECK APPN.  09420000
         TM    DCBRECFM,FORMATV        FORMAT V RECORDS                 09440000
         BO    SLDAPP18                YES,LOAD VARIABLE LGN APPEN      09460000
         TM    DCBRECFM,FIXEDBLK       FIXED BLOCK RECORDS              09480000
         BC    12,SLDAPP19             NO,DON'T LOAD APPENDAGE          09500000
LAB02    EQU   *                                                 S20201 09510020
         LA    RB,ACEF                 YES, GET FIXED LGN CHECK APPEN   09520000
*                                                                       09540000
SLDAPP18 EQU   *                                                        09560000
         BAL   RC,SLDROUT               LOAD ROUTINE                    09580000
         ST    RE,AVTCE                 APPENDAGE TABLE ENTRY FOR CE    09600001
         TM    DCBRECFM,DCBRECTO        TRACK OVERFLOW           Y02072 09600402
         BO    RELOOP                   YES, BYPASS SEC ENT PT   Y02072 09600802
         AH    RWK1,SECENTRY            ABNORMAL END ENTRY       Y02072 09602002
         ST    RWK1,AVTABNE             ABNOR END ENTRY TO AVT   Y02072 09604002
         B     RELOOP                                            A26750 09610019
*                                                                       09620000
*THIS SECTION LOADS MODULES NEEDED BY EITHER PAPER TAPE OR UPDATE       09640000
*                                                                       09660000
SLDAPP19 EQU   *                                                        09680000
*                                                                       09700000
         TM    DCBRECFM,OVFLBIT    TRK OVERFLOW                  A26750 09800019
         BZ    RELOOP              NO, BRANCH                    A26750 09900019
         L     RE,16(RTIOT)        GET ABN END ADDRESS           A26750 10000019
         AH    RWK1,SECENTRY            ADDR OF CHANNEL END APPG Y02072 10100002
         ST    RE,AVTCE                 APPENDAGE TABLE ENTRY FOR CE    10200001
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURR WTG ENTRY        10720000
         LA    RPARC,PLOFF(0,RPARC)     INCR CURRENT DCB ENTRY PRTR     10740000
         CLC   0(2,RWTGC),AMIDCNST      THIS RT NEEDED AGAIN            10760000
         BCR   8,RBASE                                                  10780000
*                                                                       10800000
         CLC   0(2,RWTGC),OPIDCNST      END OF TABLE                    10820000
         BC    7,RELOOP                 NO,CHECK NEXT ENTRY             10840000
*                                                                       10860000
         LR    RPARC,RPAR                                               10880000
         LA    RWTGC,WAOFF(0,RWTG)      REINITIALIZE WTG LIST PTR       10900000
ZCHEK    CLI   0(RWTGC),0               IS THIS ENTRY COMPLETE          10920000
         BC    7,TCTLRTN                IF NOT TRANSFER CONTROL         10940000
*                                                                       10960000
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY                  10980000
         LA    RPARC,PLOFF(0,RPARC)                                     11000000
         BC    15,ZCHEK                                                 11020000
*                                                                       11040000
TCTLRTN  EQU   *                                                        11060000
         USING WTG,RWTG                                                 11110003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*11160003
               MODID=WTGENTRY                                  @Z30TSCF 11170003
         DROP  RWTGC,RWTG                                      @Z30TSCF 11180003
**                                                                      11200000
*                                                                       11220000
*                                                                       11240000
*                                                                       11260000
WAOFF    EQU   32                                                       11280000
PLOFF    EQU   4                        OFFSET OF DCB ENTRIES           11300000
WGOFF    EQU   8                        OFFSET OF WTG ENTRIES           11320000
OPIDCNST DC    C'0S'                                                    11520000
AMIDCNST DC    C'12'                                                    11540000
*                                                                       11560000
*                                                                       11580000
*                                                                       11600000
         DS    0H                                                       11620000
SLDROUT  EQU   *                                                        11640000
         MVC   6(2,RWTG),0(RB)          MOVE 2 BYTE ID TO DE            11680000
*                                                                       11860000
*                                                                       11880000
         L     R1,CVTPTR                LOAD CVT ADDRESS         YM1140 11890002
         USING CVT,R1                   CVT ADDRESSABILITY       YM1140 11892002
         L     R1,CVTLINK               GET LPALIB DCB ADDRESS   YM1140 11894002
         DROP  R1                       DROP CVT BASE            YM1140 11896002
**                                                                      11900000
         LOAD  EPLOC=(RWTG),DCB=(1)                              YM1140 11920002
**                                                                      11940000
*                                                                       11960000
*                                                                       11980000
*                                                                       12000000
         ST    RE,24(RWTG)              STORE ADDRESSS OF LOADED ROUTIN 12020000
SLDROUT1 MVC   0(2,RUCB),0(RB)          STORE ID IN DEB                 12057901
         LA    RUCB,2(RUCB)             UPDATE SUBRT PNTR               12060000
         SR    RD,RD                                                    12080000
         IC    RD,DEBNMSUB              GET NO. OF SUBRT LOADED         12100000
         LA    RD,1(RD)                 ADD ONE TO TOTAL                12120000
         STC   RD,DEBNMSUB              STORE NEW TOTAL OF SUBRT LOADED 12140000
         BR    RC                       RETURN                          12160000
*                                                                       12180000
*                                                                       12200000
*********************************************************************** 12220000
*                                                                       12240000
SECENTRY DC    H'4'                     OFFSET TO SECOND ENTRY   Y02072 12340002
*                                                                       12580000
*********************************************************************** 12600000
*                                                                       12620000
*                                                                       12640000
*                                                                       12660000
*                                                                       12700000
* THIS MODULE IS DEPENDENT ON THE ARRANGEMENT OF THE FOLLOWING LOAD     12720000
*   TABLE.  THE LOAD TABLE IS SET UP WITH A BSAM ENTRY, FOLLOWED        12740000
*   BY THE CORRESPONDING QSAM ENTRY.  THIS PATTERN MUST BE MAINTAINED   12760000
*   TO ENSURE THAT THE PROPER MODULE IS LOADED                          12780000
*                                                                       12800000
*********************************************************************   12820000
*                                                                       12840000
***                                                                     12880000
         DC    0D'0'                    ALIGN TO DOUBLE WORD BDY Y02072 12930002
NEXTMOD  DC    C'18',VL3(IGG01918)      ID OF MODULE IGG01918  @Z30TSCF 12980003
CHECKUP  DC    C'BI'                    ID OF MODULE IGG019BI    Y02072 13030002
UPER     DC    C'AF'                    ID OF MODULE IGG019AF    Y02072 13080002
UPRW     DC    C'BH'                    ID OF MODULE IGG019BH    Y02072 13130002
UGFV     DC    C'AE'                    ID OF MODULE IGG019AE    Y02072 13180002
CHECKPT  DC    C'BG'                    ID OF MODULE IGG019BG    Y02072 13230002
GERR     DC    C'AQ'                    ID OF MODULE IGG019AQ    Y02072 13280002
RPTU     DC    C'BF'                    ID OF MODULE IGG019BF    Y02072 13330002
GPTF     DC    C'AT'                    ID OF MODULE IGG019AT    Y02072 13380002
WRH2     DC    C'BA'                    ID OF MODULE IGG019BA    Y02072 13430002
GPTN     DC    C'AC'                    ID OF MODULE IGG019AC    Y02072 13480002
BUEOE    DC    C'BM'                    ID OF MODULE IGG019BM    Y02072 13530002
QUEOE    DC    C'AW'                    ID OF MODULE IGG019AW    Y02072 13580002
USIO     DC    C'CG'                    ID OF MODULE IGG019CG    Y02072 13630002
TOABNE   DC    C'C3'                    ID OF MODULE IGG019C3    Y02072 13680002
ASYNCH   DC    C'C1'                    ID OF MODULE IGG019C1    Y02072 13730002
ACEF     DC    C'CI'                    ID OF MODULE IGG019CI    Y02072 13780002
ACEP     DC    C'CS'                    ID OF MODULE IGG019CS    Y02072 13830002
ACEV     DC    C'CJ'                    ID OF MODULE IGG019CJ    Y02072 13880002
TLTY     DC    C'CM'                    ID OF MODULE IGG019CM    Y02072 13930002
ASCI     DC    C'CN'                    ID OF MODULE IGG019CN    Y02072 13980002
BURR     DC    C'CO'                    ID OF MODULE IGG019CO    Y02072 14030002
FRID     DC    C'CP'                    ID OF MODULE IGG019CP    Y02072 14080002
PTTC     DC    C'CQ'                    ID OF MODULE IGG019CQ    Y02072 14130002
NCRC     DC    C'CR'                    ID OF MODULE IGG019CR    Y02072 14180002
ACEU     DC    C'C0'                    ID OF MODULE IGG019C0    Y02072 14230002
PDLOAD   DC    C'6M'                    ID OF MODULE IGG0196M    Y02072 14280002
         SPACE                                                          14330002
PATCH    DC    25H'0'                   PATCH AREA               YM4640 14430002
END      EQU   *                        END OF MODULE            Y02072 15200002
         TITLE 'IGG01912 - FORMAT OF GOTTEN CORE'                       15220002
         IECDSECS MAIN,WTG,PREFX,EXPAND=YES                    @Z30TSCF 15250003
         ORG   WTGIDTTR                                          Y02072 15260002
WTGID    DS    CL2                      NEXT MOD ID              Y02072 15270002
*                                                                       15280000
*                                                                       15300000
AVT      DSECT                          APPENDAGE VECTOR TABLE          15301001
AVTEOEPG DS    0CL1                     NO.PAGES MODULE REQUIRES        15302001
AVTEOE   DS    A                        ADDR OF END OF EXTENT           15303001
*                                       APPENDAGE                       15304001
AVTSIOPG DS    0CL1                     NO.PAGES MODULE REQUIRES        15305001
AVTSIO   DS    A                        ADDR OF START I/O               15306001
*                                       APPENDAGE                       15307001
AVTPCIPG DS    0CL1                     NO.PAGES MODULE REQUIRES        15308001
AVTPCI   DS    A                        ADDR OF PCI APPENDAGE           15309001
AVTCEPG  DS    0CL1                     NO.PAGES MODULE REQUIRES        15310001
AVTCE    DS    A                        ADDR OF CHANNEL END             15311001
*                                       APPENDAGE                       15312001
AVTABNPG DS    0CL1                     NO.PAGES MODULE REQUIRES        15313001
AVTABNE  DS    A                        ADDR OF ABNORMAL END            15314001
*                                       APPENDAGE                       15315001
CVT      DSECT                                                          15320000
         CVT                                                            15340000
*                                                                       15360000
*                                                                       15380000
BLDEB    DSECT                                                          15400000
DEB      DS    0F                                                       15420000
DEBNMSUB DS    0CL1                                                     15440000
DEBTCBAD DS    CL4                                                      15460000
DEBAMLNG DS    0CL1                                                     15480000
DEBDEBAD DS    CL4                                                      15500000
DEBOGLGS DS    0CL1                                                     15520000
DEBIRBAD DS    CL4                                                      15540000
DEBOPATB DS    0CL1                                                     15560000
DEBSYSPG DS    CL4                                                      15580000
DEBNMEXT DS    0CL1                                                     15600000
DEBUSRPG DS    CL4                                                      15620000
DEBPRIOR DS    0CL1                                                     15640000
DEBECBAD DS    CL4                                                      15660000
DEBPROTG DS    0CL1                                                     15680000
DEBDEBID DS    0CL1                                                     15700000
DEBDCBAD DS    CL4                                                      15720000
DEBEXSCL DS    0CL1                                                     15740000
DEBAPPAD DS    CL4                                                      15760000
DEBDVMOD DS    0CL1                                                     15780000
DEBUCBAD DS    CL4                                                      15800000
DEBBINUM DS    CL2                                                      15820000
DEBSTRCC DS    CL2                                                      15840000
DEBSTRHH DS    CL2                                                      15860000
DEBENDCC DS    CL2                                                      15880000
DEBENDHH DS    CL2                                                      15900000
DEBNMTRK DS    CL2                                                      15920000
*                                                                       15940000
           DCBD  DSORG=PS                                               15960000
* DCBREAD IS A TEMPORARY STORAGE AREA USED FOR THE OFFSET USED IN       15980000
*  LOADING EITHER QSAM MODULES OR BSAM MODULES                          16000000
OFFSET   EQU   DCBREAD+2                                                16020000
**********************************************************************  16040000
*                                                                       16060000
           END                                                          16080000
