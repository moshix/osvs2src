 TITLE 'IGG01913 - SAM EXECUTOR FOR PCI/TRACK OVERFLOW'                 00007018
IGG01913 CSECT                                                     UT18 00014018
*MODULE NAME - IGG01913                                          Y02072 00024002
*                                                                       00034002
*DESCRIPTIVE NAME - LOAD ACCESS METHOD ROUTINES                  Y02072 00034402
*                                                                       00034802
*COPYRIGHT - NONE                                                Y02072 00034902
*                                                                       00037902
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00039902
*                                                                       00040302
*          RELEASE 20 DELETIONS                                         00041002
*0945059134,059142,143400                                        M5150  00044002
*0945                                                            S20038 00047002
*0945059120-059150,125000,147800                                 S20202 00050002
*0945143400                                                      M5701  00053002
*          RELEASE 21 DELETIONS                                         00056002
*1091002800,118000-118600                                        A39228 00059002
*                                                               SA66897 00059402
*          VS2 RELEASE 2 DELETIONS                                      00061002
*000090,000230-000320,000410-000500,125000,055900,056100,        Y02072 00061402
*056300-056340,59160,107200-107400,108200,108800,110400-112400,  Y02072 00061802
*113000-117200                                                   Y02072 00061902
*                                                                YM1141 00062102
*                                                                YM1140 00062202
*                                                                       00066103
*          VS2 RELEASE 3 DELETIONS                                      00068103
*                                                              @Z30TSCF 00068503
*                                                                       00070103
*STATUS CHANGE LEVEL 004                                                00074002
*                                                                       00077002
*FUNCTION/OPERATION - THIS ROUTINE WILL LOAD SOME OF THE I/O       UT18 00080018
*      PROCESSING MODULES.  THE MODULES TO BE LOADED ARE DETERMINEDUT18 00100018
*      FOR THE ACCESS METHODS AND DEVICE TYPE TO BE USED.          UT18 00120018
*      IT WILL PLACE THE ADDRESS OF THE LOADED MODULES IN THE           00160000
*      APPROPRIATE DCB FIELDS, AND THE ID'S IN THE DEB.                 00180000
*      IT WILL BRING IN THE APPROPRIATE ERROR ROUTINES.                 00200000
*      THIS MODULE WAS SPLIT IN RELEASE 18 TO INCLUDE USER         UT18 00210018
*      TOTALING SUPPORT.  THE SECOND HALF OF THIS MODULE IS NOW    UT18 00220018
*      IGG01919.                                                   UT18 00230018
*                                                                       00260000
*ENTRY POINT -- ENTERED FROM IGG0191K,IGG0191R,IGG0191Q                 00280021
*      AND IGG0191H BY USE OF THE XCTL MACRO.                           00300000
*                                                                       00320000
*INPUT: SEE DESCRIPTION OF REGISTERS, DCB(USERS)                        00340000
*                                                                       00360000
*OUTPUT: DCB(USERS),IOB(USERS).                                         00380000
*                                                                       00400000
*EXTERNAL ROUTINES: NONE.                                               00420000
*                                                                       00430018
*EXITS-NORMAL   XCTL TO IGG01919.                                  UT18 00440018
*                                                                       00460000
*EXITS-ERROR: NONE.                                                     00480000
*                                                                       00500000
*TABLES/WORKAREAS- WHERE TO GO TABLE (WTG)                              00520000
*                                                                       00540000
*      BYTE  0-7  NAME                                                  00560000
*      BYTE  8-10 RELATIVE DISK ADDRESS(TTR) OF FIRST RECORD            00580000
*      BYTE 11    CONCATENATION NUMBER                                  00600000
*      BYTE 12    ZERO                                                  00620000
*      BYTE 13    ALIAS INDICATOR AND USER DATA FIELD DESCRIPTOR.       00640000
*                        ALIAS INDICATOR 1 BIT                          00660000
*                        NUMBER OF TTRS IN USERS DATA FIELD 2 BITS      00680000
*      BYTE 14-16 TTR OF FIRST TEXT RECORD                              00700000
*      BYTE 17    ZERO                                                  00720000
*      BYTE 18-19 TTR OF NOTE LIST OR SCATTER LIST                      00740000
*      BYTE 20    TRANSLATION TABLE                                     00760000
*      BYTE 21    ZERO OR NUMBER OF ENTRIES IN THE NOTE LIST            00780000
*      BYTE 22-23 ATTRIBUTES                                            00800000
*      BYTE 24-26 TOTAL CONTIGUOUS MAIN STORAGE REQUIRED FOR MODULE     00820000
*      BYTE 27-28 LENGTH OF FIRST TEXT RECORD                           00840000
*      BYTE 29    LENGTH OF WTG TABLE (IN DOUBLE WORDS)                 00860000
*      BYTE 30-31 PATH THROUGH LOADS OF ROUTINES                        00880000
*      BYTE 32-36 IDTTR OF EXECUTOR FOR FIRST DCB                       00900000
*      BYTE 37-39 WORKAREA ADDRESS FOR FIRST DCB                        00920000
*      BYTE 40-   TABLE OF IDTTR'S                                      00940000
*      BYTE 32+N(8) IDTTR OF EXECUTOR FOR N TH DCB   (5 BYTES)          00960000
*                   WORKAREA ADDRESS FOR N TH DCB    (3 BYTES)          00980000
*                   IDTTR OF LAST ROUTINE LOAD       (5 BYTES)          01000000
*                   NOT USED                         (3 BYTES)          01020000
*                                                                       01040000
*ATTRIBUTES: REENTRANT, REUSABLE, RUNS IN DATA MANAGEMENT KEY,   Y02072 01060002
*            SUPERVISOR STATE                                    Y02072 01070002
*                                                                       01080000
*NOTES: THIS ROUTINE HAS A LIST OF ALL BSAM, QSAM MODULES SUPPORTED.    01100000
*                                                                       01120000
*********************************************************************** 01140000
*                                                                       01160000
*                                                                       01180000
*  REGISTER CONVENTIONS USED THROUGH OUT ALL OPEN PASSES                01200000
*                                                                       01220000
*********************************************************************** 01240000
*                                                                       01260000
RE       EQU   0         WORK REG5                                      01262002
RF       EQU   1         WORK REG6                                      01264002
R1       EQU   RF        PARM REG                                YM1140 01270002
RDCB     EQU   2         DCB REGISTER                                   01280000
RBASE    EQU   3         BASE REGISTER                                  01300000
RCORE    EQU   4         WORK AREA ADDRESS                              01320000
RPAR     EQU   5         TOP OF PARAMETER LIST                          01340000
RWTG     EQU   6         TOP OF WTG TABLE                               01360000
RPARC    EQU   7         CURRENT PARAMETER                              01380000
RWTGC    EQU   8         CURRENT TRANS LOAD                             01400000
RTIOT    EQU   9         USED HERE AS WRK REG AND  COMM VECTOR ADDR.    01420000
RUCB     EQU   10        USED HERE AS A COUNTER IN IOB GENERATION       01440000
RDEB     EQU   11        DEB ADDRESS                                    01460000
RB       EQU   12        WORK REG1  **                                  01480000
RC       EQU   13        WORK REG2  **  USED IN IOB GENERATION          01500000
RD       EQU   14        WORK REG3  **                                  01520000
RJ       EQU   15        WORK REG4                                      01540000
*                                                                       01600000
*                                                                       01620000
PARAR    EQU   RPARC                                                    01640000
*                                                                       01660000
*********************************************************************** 01680000
*                                                                       01700000
*********************************************************************** 01720000
*                                                                       01740000
* MASK'S TO TEST PARAMETER LIST WITH                                    01760000
*                                                                       01780000
*********************************************************************   01800000
INP      EQU   X'0F'                                                    01820000
OUTP       EQU   X'0F'                                                  01840000
UPDATE     EQU   X'04'                                                  01860000
INOUT      EQU   X'03'                                                  01880000
OUTIN      EQU   X'07'                                                  01900000
RDBACK     EQU   X'01'                                                  01920000
INPRDBK  EQU   X'0E'               MASK TO CK INPUT AND RDBACK     UT18 01930018
*                                                                       01940000
*                                                                       01960000
*********************************************************************   01980000
*                                                                       02000000
*                                                                       02020000
* OFFSET FOR PARAMETER TESTS                                            02040000
*                                                                       02060000
ONE        EQU   X'01'                                                  02080000
THREE    EQU   X'03'                    CONSTANT=3               S20202 02085020
K24      EQU   X'18'                    CONSTANT=24              S20202 02090020
K25      EQU   X'19'                    CONSTANT=25              S20202 02095020
FRTYATE    EQU   48                                                     02100000
DISPSN     EQU   X'0'                                                   02120000
*                                                                       02140000
*                                                                       02160000
*********************************************************************   02180000
*                                                                       02200000
* OFFSETS FOR DEB REFERENCE                                             02220000
*                                                                       02240000
*                                                                       02260000
DEBIRBOF EQU   9                        OFFSET TO IRB ADDR       S20202 02265020
FOUR     EQU   X'04'                                             M5150  02279020
BIN      EQU   36                                                       02280000
BEXT     EQU   38                                                       02300000
*                                                                       02320000
*                                                                       02340000
*                                                                       02360000
*********************************************************************   02380000
*                                                                       02400000
* MASK'S USED TO TEST OPTION FIELDS IN DCB                              02420000
*                                                                       02440000
*                                                                       02460000
*                                                                       02480000
DOUBLE     EQU   X'01'                                                  02500000
*                                                                       02520000
*                                                                       02540000
STOWB      EQU   X'80'                                                  02560000
WRTCK      EQU   X'80'                                                  02580000
OVRFLO   EQU   X'20'                                                    02600000
PCI        EQU   X'20'                                                  02620000
MINKEY     EQU   X'01'                                                  02640000
CONCAT     EQU   X'FF'                                                  02660000
UTFMASK  EQU   X'02'                    MASK FOR TOTALING FACILITY UT18 02670018
*                                                                       02680000
*********************************************************************   02700000
*                                                                       02720000
* MASKS FOR ACCESS METHODS IN SAM                                       02740000
*                                                                       02760000
QSAMB      EQU   X'01'                                                  02780000
BSAMBIT    EQU   X'00'                                                  02800000
PAM        EQU   X'02'                                                  02820000
*                                                                       02840000
*                                                                       02860000
* MASKS FOR MACRO'S TO BE USED                                          02880000
*                                                                       02900000
GETB       EQU   X'40'                                                  02920000
PUTB       EQU   X'40'                                                  02940000
READB      EQU   X'20'                                                  02960000
WRITEB     EQU   X'20'                                                  02980000
POINTB     EQU   X'04'                                                  03000000
CNTRLB     EQU   X'02'                                                  03020000
*                                                                       03040000
*                                                                       03060000
*********************************************************************   03080000
*                                                                       03100000
* MASKS FOR DEVICES TO BE SUPPORTED                                     03120000
*                                                                       03140000
*                                                                       03160000
*                                                                       03180000
PTR3211  EQU   X'49'                    MASK FOR 3211 PRINTER    S20202 03190020
*********************************************************************   03200000
*                                                                       03220000
*                                                                       03240000
*                                                                       03260000
*                                                                       03280000
*********************************************************************   03300000
*                                                                       03320000
* MASKS FOR STATUS BITS TO BE TESTED                                    03340000
*                                                                       03360000
*                                                                       03380000
EXCPN      EQU   X'30'                                                  03400000
COMPLETE   EQU   X'80'                                                  03420000
FIRSTIOB   EQU   X'01'                                                  03440000
*                                                                       03460000
*                                                                       03480000
*                                                                       03500000
*********************************************************************   03520000
*                                                                       03540000
* MASKS FOR BUFFER TECHNIQUE'S                                          03560000
*                                                                       03580000
EXCHANGB   EQU   X'10'                                                  03600000
SIMPLEB    EQU   X'40'                                                  03620000
*                                                                       03640000
*********************************************************************   03660000
*                                                                       03680000
*                                                                       03700000
* MODES OF OPERATION FOR QSAM                                           03720000
*                                                                       03740000
LOCATEB    EQU   X'08'                                                  03760000
MOVEB      EQU   X'10'                                                  03780000
MOVEXCHB EQU X'14'                                                      03800000
SUBSTUTB   EQU   X'04'                                                  03820000
*                                                                       03840000
*                                                                       03860000
*********************************************************************   03880000
*                                                                       03900000
*                                                                       03920000
* COMMAND BYTES FOR THE 2841                                            03940000
*                                                                       03960000
*       CONTROL UNIT                                                    03980000
*                                                                       04000000
*                                                                       04020000
*                                                                       04040000
SRCHE      EQU   X'31'                                                  04060000
WRTCKD     EQU   X'1D'                                                  04080000
RDC        EQU   X'92'                                                  04100000
RDKD       EQU   X'8E'                                                  04120000
RDD        EQU   X'86'                                                  04140000
TIC        EQU   X'08'                                                  04160000
*                                                                       04180000
*                                                                       04200000
*********************************************************************   04220000
*                                                                       04240000
*                                                                       04260000
* MASKS FOR RECORD FORMATS                                              04280000
*                                                                       04300000
*                                                                       04320000
STANDRDF   EQU   X'08'                                                  04340000
FORMATU    EQU   X'C0'                                                  04360000
FORMATF    EQU   X'80'                                                  04380000
FORMATV    EQU   X'40'                                                  04400000
FORMATD  EQU   X'20'                    D FORMAT RECORDS         S20038 04410020
BLOCKED    EQU   X'10'                                                  04420000
FIXEDBLK   EQU   X'90'                                                  04440000
*                                                                       04460000
*                                                                       04480000
*********************************************************************   04500000
*                                                                       04520000
*                                                                       04540000
*   CHANNEL CONTROL WORD FLAGS                                          04560000
*                                                                       04580000
SKIP       EQU   X'10'                                                  04600000
SLI        EQU   X'20'                                                  04620000
CC         EQU   X'40'                                                  04640000
DATACH     EQU   X'A0'                                                  04660000
SLICC      EQU   X'60'                                                  04680000
SLICCSK    EQU   X'70'                                                  04700000
*                                                                       04720000
*                                                                       04740000
*********************************************************************   04760000
*                                                                       04780000
*                                                                       04800000
KEYS       EQU   X'01'                                                  04820000
QSAM       EQU   X'01'                                                  04840000
*                                                                       04860000
*                                                                       04880000
*********************************************************************   04900000
*                                                                       04920000
*                                                                       04940000
*********************************************************************   04960000
*                                                                       04980000
*                                                                       05000000
**********************************************************************  05020000
ASISVLN  EQU   9                        DBLWORDS FOR IRB WKA     YM1141 05030002
ASA        EQU   X'04'                                                  05040000
BKREAD     EQU   X'01'                                                  05060000
URBITS   EQU   X'40'                                                    05080000
TAPEB    EQU   X'80'                                                    05100000
DABIT    EQU   X'20'                                                    05120000
         EJECT                                                          05170002
         BALR  RBASE,0                                                  05340000
         USING SLDA,RBASE                                               05360000
         USING IHADCB,RDCB                                              05380000
         USING BLDEB,RDEB                                               05400000
         USING FORCORE,RCORE                                            05420000
*                                                                       05460000
*                                                                       05480000
SLDA     EQU   *                                                        05500000
*                                                                       05520000
         B     BEGIN                    BR AROUND CONSTANTS      Y02072 05530002
         DC    C'IGG01913'              MODULE NAME              Y02072 05532002
         DC    C'@Z30TSCF'              LAST SHIP CODE         @Z30TSCF 05536003
         DC    C'10/22/74'              LAST DATE MODIFIED     @Z30TSCF 05538003
BEGIN    DS    0H                                                       05538402
*                                                                       05540000
         L     RDCB,0(RPARC)            GET DCB ADDRESS                 05560000
         LA    RDCB,0(RDCB)             CLEAR HI BYTE                   05580000
         L     RDEB,DCBDEBAD            GET DEB ADDRESS                 05600000
         L     RCORE,4(RWTGC)           GET WORK AREA                   05620000
         MVI   22(RWTG),X'CB'          CHANGE DE ATTR.TO ONLY LOADABLE  05640000
*                                                                       05660000
         L     RTIOT,DEBAPPAD           GET APPENDAGE ADDRESS           05680000
         SR    RUCB,RUCB                CLEAR REG                       05700000
         SR    RF,RF                    CLEAR RER                       05720000
         IC    RUCB,DEBNMEXT            GET NUMBER OF EXTENTS           05740000
         IC    RF,DEBEXSCL              GET SCALING FACTOR              05760000
         SLL   RUCB,0(RF)               SHIFT ACCORDING TO EXTENT SIZE  05780000
         IC    RF,DEBAMLNG              GET ACCESS METHOD LENGTH        05800000
         LA    RUCB,0(RF,RUCB)          ADD TO POINT TO SUBRT ID FLD    05820000
         LA    RUCB,32(RUCB,RDEB)       ADD BASIC DEB SZ TO DEB AD      05840000
*                                                                       05860000
*  RUCB NOW POINTS TO THE SUBROUTINE ID FIELD IN THE DEB                05880000
*                                                                       05900000
         TM    DCBOPTCD,UTFMASK         TEST FOR TOTALING          UT18 05901018
         BZ    SLDAA                    BR IF NOT SPECIFIED        UT18 05902018
         TM    0(RPARC),INPRDBK         IS OPEN FOR INPUT/RDBACK   UT18 05903018
         BZ    SLDAA                    IF YES, NO TOTALING REQ'D  UT18 05904018
*                                                                  UT18 05905018
* SINCE UTF WAS SPECIFIED THE TOTALING SAVE ROUTINE (IGG019AX)     UT18 05906018
*        WAS LOADED BY IGG0191Y IN STAGE 1 - SO IT IS NECESSARY    UT18 05907018
*        TO UPDATE THE SUBROUTINE ID POINTER (RUCB) TO POINT       UT18 05908018
*        TO THE SECOND ID SUBFIELD.                                UT18 05909018
*                                                                  UT18 05910018
         LA    RUCB,2(RUCB)             POINT TO NEXT ID SUBFIELD  UT18 05911018
SLDAA    EQU   *                                                 S20202 05911220
         CLI   DCBDEVT,PTR3211          TEST FOR 3211 PRINTER    S20202 05911420
         BNE   SLDAB                    NO BRANCH AROUND         S20202 05911620
*                                                                       05911820
*   FOR A 3211 PRINTER LOAD AN ERROR RETRY MODULE                       05912020
*                                                                       05912220
         LA    RB,ERRMOD                GET ADDR OF ERROR RETRY  S20202 05912420
         BAL   RC,SLDROUT               GO LOAD ERROR RETRY MOD  S20202 05912620
*   WHEN RETURN FROM 'SLDROUT'- R0 CONTAINS THE ADDR OF THE             05912820
*   ASYNCHRONOUS ERROR ROUTINE. NOW BUILD AN IRB TO BE USED  IN         05913020
*   SCHEDULING THIS ROUTINE. WKA IS USED IN IGG019C3.                   05913202
         CIRB  EP=(0),KEY=PP,MODE=PP,STAB=(RE),WKAREA=ASISVLN    YM1141 05913402
         ST    RF,K24(RWTG)             TEMP SAVE FOR IRB ADDR   S20202 05913620
         MVC   DEBIRBOF(THREE,RDEB),K25(RWTG) MV IRB ADDR INTO   S20202 05913820
*                                       DEB                      S20202 05914020
SLDAB    EQU   *                                                 M5150  05915420
         USING WTGENTRY,RWTGC                                    Y02072 05915802
         MVC   WTGIDTTR,NEXTMOD         ID OF NEXT MOD         @Z30TSCF 05915903
         TM    DCBCIND2,QSAMB          DCB FOR QSAM                     05940000
         BO    SLD100                  YES,BRANCH                       05960000
*                                                                       05980000
         LA    RB,CHECK                GET ID OF CHECK ROUTINE          06000000
         B     SLD105                                                   06040000
*                                                                       06060000
SLD100   EQU   *                                                        06080000
         LA    RB,GERR                 GET GERR ROUTINE ID              06120000
*                                                                       06140000
         TM    DISPSN(PARAR),OUTP      DCB FOR OUTPUT                   06160000
         BO    SLD200                  YES, BRANCH                      06180000
*                                                                       06200000
SLD105   EQU   *                                                        06220000
         TM    DCBOFLGS,X'20'           CONCATENATION UNLIKE ATTRIBUTES 06240000
         BZ    SLDA0                   NO,GO TO LOAD ROUTINE            06260000
*                                                                       06280000
         BAL   RC,SLDROUT1             STORE CHECK OR GERR ID IN DEB    06300000
         B     SLDA1                                                    06320000
*                                                                       06340000
SLDA0    EQU   *                                                        06360000
         BAL   RC,SLDROUT              GO TO LOAD ROUTINE               06380000
         MVC   DCBCHECK+1(3),25(RWTG)  STORE CHECK/GERR ID IN DCB       06400000
*                                                                       06420000
SLDA1    EQU   *                                                        06440000
         TM    DCBCIND2,QSAMB          DCB FOR QSAMB                    06460000
         BO    SLD101                  YES,BRANCH                       06480000
*                                                                       06500000
         LA    RB,WRH2                 GET READ WRITE ID                06520000
         B     SLD150                  GO TO LOAD ROUTINE               06540000
*                                                                       06560000
*                                                                       06580000
*                                                                       06600000
SLD101   EQU   *                                                        06620000
         TM    DCBDEVT,TAPEB            DCB USING TAPE                  06640000
         BZ    SLD160                   NO,BRANCH                       06660000
*                                                                       06680000
         TM    DEBOPATB,X'03'           OPEN FOR BACKWARD READ          06700000
         BC    9,SLD160                 NO,BRANCH                       06720000
*                                                                       06740000
         LA    RB,SBLF                  SET UP BASE FOR BACKWARD GETS   06760000
         TM    DCBMACRF,MOVEXCHB       DCB USING MOVE OR SUBST. MODE    06780000
         BZ    SLD150                   NO,BRANCH MUST BE LOCATE MODE   06800000
         LA    RB,L'IDLEN(RB)           POINT TO MOVE MODE       Y02072 06810002
SLD150   EQU   *                                                        06860000
         BAL   RC,SLDROUT               TO LOAD FUNCTION                06880000
         MVC   DCBGET+1(3),25(RWTG)    PUT ADDRESS IN DCBGET/READ       06900000
         B     SLDEOB                   TO SPECIAL ROUTINES             07000000
*                                                                       07020000
SLD160   EQU   *                                                        07040000
*                                                                       07060000
         LA    RB,SGLF                  SET UP FOR NORMAL GET IDS       07080000
         TM    DCBMACRF,MOVEXCHB       DCB USING MOVE OR SUBST. MODE    07200000
         BZ    SLD175                   NO,BRANCH MUST BE LOCATE MODE   07220000
SLD173   EQU   *                                                        07260000
         LA    RB,2*L'IDLEN(RB)         UPDATE TO MOVE MODE      Y02072 07270002
SLD175   EQU   *                                                        07320000
         TM    DCBRECFM,DCBRECF         FORMAT F OR U           SA66897 07370002
         BO    SLD150                   YES, GO LOAD ROUTINE    SA66897 07420002
         TM    DCBRECFM,DCBRECV         FORMAT V                SA66897 07422002
         BO    SLD180                   YES, GO INCR TO NEXT ID SA66897 07424002
*                                                                       07426002
* BECAUSE DCBRECFM FIELD BITS 0, 1, & 2 HAVE DUPLICATE MEANINGS         07428002
* IT IS NECESSARY TO MAKE THE FOLLOWING TWO TESTS TO DETERMINE          07428402
* IF FORMAT D RECORDS ARE BEING USED.                                   07428802
*   RECFM = 001XXXXX - UNDEFINED REC FORMAT WITH TRK OVERFLO            07429202
*   RECFM = 001XXXXX - ASCII TAPE (OPTCD = Q)                           07429602
* AT THIS POINT BITS 0 & 1 ARE ZERO.                                    07429702
*                                                                       07429802
         TM    DCBRECFM,DCBRECD         ASCII TAPE OR TRK OVFLO SA66897 07429902
         BZ    SLD150                   NO, GO LOAD FOR FORMAT  SA66897 07437402
*                                         U RECORDS             SA66897 07439402
         TM    DCBOPTCD,DCBOPTQ         ASCII TAPE              SA66897 07441402
         BZ    SLD150                   NO, GO LOAD U FORMAT    SA66897 07443402
SLD180   EQU   *                                                 S20038 07445002
         LA    RB,L'IDLEN(RB)           UPDATE TO V REC IDS      Y02072 07452502
         B     SLD150                   TO LOAD FUNCTION                07460000
*                                                                       07480000
SLD200   LA    RB,PERR                  GET ADDRESS OF PERR ID          07500000
         BAL   RC,SLDROUT               TO LOAD SUBROUTINE              07520000
         MVC   DCBPERR+1(3),25(RWTG)    LOAD PERR ADDRESS IN DCB        07540000
*                                                                       07560000
SLD250   LA    RB,SPLF                  ESTABLISH BASE FOR PUTS         07580000
*                                                                       07600000
         TM    DCBMACRF+1,MOVEXCHB     DCB USING MOVE OR SUBST. MODE    07620000
         BZ    SLD175                   NO,BRANCH MUST BE LOCATE MODE   07640000
         B     SLD173                   SET UP FOR MOVE ROUTINES        07660000
*                                                                       07680000
*********************************************************************** 07700000
*                                                                       07720000
SLDEOB   EQU   *                                                        07740000
*                                                                       07760000
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURR WTG ENTRY        10360000
         LA    RPARC,PLOFF(0,RPARC)     INCR CURRENT DCB ENTRY PRTR     10380000
         CLC   0(2,RWTGC),AMIDCNST      THIS RT NEEDED AGAIN            10400000
         BCR   8,RBASE                                                  10420000
*                                                                       10440000
         CLC   0(2,RWTGC),OPIDCNST      END OF TABLE                    10460000
         BC    7,RELOOP                 NO,CHECK NEXT ENTRY             10480000
*                                                                       10500000
         LR    RPARC,RPAR                                               10520000
         LA    RWTGC,WAOFF(0,RWTG)      REINITIALIZE WTG LIST PTR       10540000
ZCHEK    CLI   0(RWTGC),X'00'          IS THIS ENTRY COMPLETE           10560000
         BC    7,TCTLRTN                IF NOT TRANSFER CONTROL         10580000
*                                                                       10600000
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY                  10620000
         LA    RPARC,PLOFF(0,RPARC)                                     10640000
         BC    15,ZCHEK                                                 10660000
*                                                                       10680000
TCTLRTN  EQU   *                                                        10700000
         USING WTG,RWTG                                                 10750003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*10800003
               MODID=WTGENTRY                                  @Z30TSCF 10810003
         DROP  RWTGC,RWTG                                      @Z30TSCF 10820003
*                                                                       10840000
WAOFF    EQU   32                                                       10940000
PLOFF    EQU   4                        OFFSET OF DCB ENTRIES           10960000
WGOFF    EQU   8                        OFFSET OF WTG ENTRIES           10980000
OPIDCNST DC    C'0S'                                                    11000000
AMIDCNST DC    C'13'                                                    11020000
         DS    0H                                                       11260000
SLDROUT  EQU   *                                                        11280000
         USING WTGMODNM,RWTG                                     Y02072 11330002
         MVC   WTGMODID,0(RB)           ID TO MOD NAME           Y02072 11380002
         DROP  RWTG                                              Y02072 11430002
         L     R1,CVTPTR                LOAD CVT ADDRESS         YM1140 11480002
         USING CVT,R1                   CVT ADDRESSABILITY       YM1140 11530002
         L     R1,CVTLINK               GET LPALIB DCB ADDRESS   YM1140 11580002
         DROP  R1                       DROP CVT BASE            YM1140 11630002
*                                                                       11680002
         LOAD  EPLOC=(RWTG),DCB=(1)                              YM1140 11720002
*                                                                       11740000
*                                                                       11760000
*                                                                       11780000
         ST    RE,24(RWTG)              TEMP STORE OF ROUTINE ADDR,     11880000
SLDROUT1 MVC   0(2,RUCB),0(RB)          STORE ROUTINES ID IN DEB        11900000
         LA    RUCB,2(RUCB)             UPDATE SUBRT PNTR               11920000
         SR    RD,RD                                             A39228 11922021
         IC    RD,DEBNMSUB              GET NO. OF SUBROUTINES   A39228 11924021
*                                       LOADED                   A39228 11926021
         LA    RD,1(RD)                 ADD ONE TO TOTAL         A39228 11928021
         STC   RD,DEBNMSUB              STORE NEW TOTAL OF       A39228 11930021
*                                       SUBROUTINES LOADED              11932021
         BR    RC                      RETURN                           11940000
         EJECT                                                          11990002
*                                                                       12400000
*   BELOW ARE THE QSAM ROUTINES BEING SUPPORTED                         12420000
*                                                                       12440000
NEXTMOD  DC    C'19',VL3(IGG01919)      IGG01919 - THIS IS THE @Z30TSCF 12540003
SGLF     DC    C'AA'                    SIMPLE GET LOC MODE FIXED REC.  12600000
SGLV     DC    C'AB'                    SIMPLE GET LOC MODE VARIABLE R. 12660000
SGMF     DC    C'AC'                    SIMPLE GET MOVE MD FIXED RECS.  12720000
SGMV     DC    C'AD'                    SIMPLE GET MOVE MD VARIABLE REC 12780000
SPLF     DC    C'AI'                   SIMPLE PUT LOC MD. FIXED RECS.   12840000
SPLV     DC    C'AJ'                    SIMPLE PUT LOC MD. VARIABLE REC 12900000
SPMF     DC    C'AK'                    SIMPLE PUT MOVE MD. FIXED REGS  12960000
SPMV     DC    C'AL'                    SIMPLE PUT MOVE MD. VARIABLE RC 13020000
SBLF     DC    C'AM'                    SIMPLE GETBACKWARDS LOC MD  FIX 13080000
SBMF     DC    C'AN'                    SIMPLE GETBACKWARDS MOVE MD VAR 13140000
GERR     DC    C'AQ'                    GET ERROR ROUTINE               13200000
PERR     DC    C'AR'                    PUT ERROR ROUTINE               13260000
*                                                                       13320000
*  THIS CONCLUDES THOSE QSAM MODULES THAT ARE BEING SUPPORTED NOW       13340000
*                                                                       13360000
*   BELOW ARE THE BSAM MODULES BEING SUPPORTED AT THIS TIME             13420000
*                                                                       13460000
WRH2     DC    C'BA'                    READ-WRITE ROUTINE              13480000
CHECK    DC    C'BB'                    CHECK ROUTINE                   13540000
*                                                                       13640000
*    THIS CONCLUDES THE BSAM MODES BEING SUPPORTED NOW                  13660000
*                                                                       13740000
*   3211 ERROR RETRY MODULE                                             13840020
*                                                                       13940020
ERRMOD   DC    C'FS'        ERR RTRY MOD TTR                     M5150  14340002
IDLEN    DS    0CL2                     LENGTH OF MODULE ID      Y02072 14390002
         SPACE                                                          14440002
PATCH    DC    25H'0'                   PATCH AREA               Y02072 14490002
END      EQU   *                        END OF MODULE            Y02072 14800002
         IECDSECS  MAIN,WTG,PREFX,EXPAND=YES                   @Z30TSCF 14890003
         ORG   WTGIDTTR                                          Y02072 14892002
WTGID    DS    CL2                      NEXT MODS ID             Y02072 14894002
*                                                                       14900000
*                                                                       14920000
CVT      DSECT                                                          14940000
         CVT                                                            14960000
*                                                                       14980000
*                                                                       15000000
BLDEB    DSECT                                                          15020000
DEB      DS    0F                                                       15040000
DEBNMSUB DS    0CL1                                                     15060000
DEBTCBAD DS    CL4                                                      15080000
DEBAMLNG DS    0CL1                                                     15100000
DEBDEBAD DS    CL4                                                      15120000
DEBOGLGS DS    0CL1                                                     15140000
DEBIRBAD DS    CL4                                                      15160000
DEBOPATB DS    0CL1                                                     15180000
DEBSYSPG DS    CL4                                                      15200000
DEBNMEXT DS    0CL1                                                     15220000
DEBUSRPG DS    CL4                                                      15240000
DEBPRIOR DS    0CL1                                                     15260000
DEBECBAD DS    CL4                                                      15280000
DEBPROTG DS    0CL1                                                     15300000
DEBDEBID DS    0CL1                                                     15320000
DEBDCBAD DS    CL4                                                      15340000
DEBEXSCL DS    0CL1                                                     15360000
DEBAPPAD DS    CL4                                                      15380000
DEBDVMOD DS    0CL1                                                     15400000
DEBUCBAD DS    CL4                                                      15420000
DEBBINUM DS    CL2                                                      15440000
DEBSTRCC DS    CL2                                                      15460000
DEBSTRHH DS    CL2                                                      15480000
DEBENDCC DS    CL2                                                      15500000
DEBENDHH DS    CL2                                                      15520000
DEBNMTRK DS    CL2                                                      15540000
*                                                                       15560000
           DCBD  DSORG=PS                                               15580000
*                                                                       15600000
**********************************************************************  15620000
*                                                                       15640000
           END                                                          15660000
