 TITLE 'IGG01915-SAM STAGE 3 OPEN EXEC FOR VARIABLE LNGTH/SPANNED RECS' 00100018
IGG01915 CSECT                                                          00200000
*                                                                       00202003
*MODULE NAME - IGG01915                                          Y02072 00210002
*                                                                       00220002
*DESCRIPTIVE NAME - LOAD ACCESS METHOD ROUTINES                  Y02072 00230002
*                                                                       00240002
*COPYRIGHT - NONE                                                Y02072 00242002
*                                                                       00244002
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00246002
*                                                                       00248002
*          VS 2 RELEASE 2 DELETIONS                              Y02072 00250002
*001100,011500,014800,190500,191100,192500-193500,207799-207803, Y02072 00260002
*506050-508150,207840,458000-459000,463000,485000-497000,        Y02072 00270002
*508320,508400-508750                                            Y02072 00320002
*                                                                YM1140 00370002
*                                                                       00420003
*          VS2 RELEASE 3 DELETIONS                                      00470003
*                                                              @Z30TSCF 00480003
* D281200-281700,D307200-307620,A281500,A307500                @ZA01530 00490003
*APAR @ZA08271 UPDATES APAR @ZA01530                           @ZA08271 00492003
*C265000,267000                                                @ZA08271 00494003
*A281500,281560,281620-283500,307500-307740                    @ZA08271 00496003
*          RELEASE 20 DELETIONS                                       * 00500000
*0911207822,207830,613000-614000                                 M5150  00510020
*0911279300-279600,305300-305600                                 A36867 00520020
*0911213000                                                      A31594 00550020
*0911                                                            M2687  00570020
*0911533000,625600-626200                                        S20202 00580020
*0911613000-614000                                               M5701  00590020
*          RELEASE 21 DELETIONS                                       * 00600000
*1093014400,264000-273000,460000,529000-627000,629000-630000     S21042 00620021
*1093533000,625500-626500                                        S21040 00650021
*578000                                                          M1816  00660021
*          RELEASE 22 DELETIONS                                       * 00700000
*          RELEASE 23 DELETIONS                                       * 00800000
*          RELEASE 24 DELETIONS                                       * 00900000
*          RELEASE 25 DELETIONS                                       * 01000000
*          RELEASE 26 DELETIONS                                       * 01100000
*STATUS CHANGE LEVEL 007                                                01150002
*                                                                       01210018
*FUNCTION/OPERATION - THIS MODULE LOADS ACCESS METHOD SUBROUTINES FOR   01220018
*    PROCESSING VARIABLE OR SPANNED RECORDS.  IT DETERMINES WHICH       01230018
*    MODULES SHOULD BE LOADED, LOADS THEM AND ENTERS THE ADDRESS OF     01240018
*    THE LOADED MODULES IN THE APPROPRIATE DCB FIELDS AND THE ID'S IN   01250018
*    THE DEB.  IT LOADS GET/PUT OR READ/WRITE ROUTINES AND ERROR CHECK  01260018
*    ROUTINES.                                                          01270018
*                                                                       01280018
*    THIS MODULE WAS SPLIT FOR RELEASE 18.  THE RESULTING NEW MODULE    01290018
*    IS IGG01991.                                                       01300018
*                                                                       01310018
*ENTRY POINTS - THE MODULE MAY BE ENTERED FROM STAGE 2 EXECUTORS        01320018
*    IGG0191J, IGG0191G, IGG0191D, OR IGG0191P.                         01330019
*                                                                       01340018
*INPUT - SEE DESCRIPTION OF REGISTER CONTENTS                           01350018
*                                                                       01360018
*OUTPUT - ADDRESSES OF SUBROUTINES LOADED ARE PLACED IN DCB, ID'S       01370018
*    ARE PLACED IN DEB SUBROUTINE ID SECTION.                           01380018
*                                                                       01390018
*EXTERNAL ROUTINES - NONE                                               01400018
*                                                                       01400402
*MACROS - ACTION - MODESET, LOAD, XCTL, CIRB, DMABCOND, XCTLTABL Y02072 01402002
*                                                                       01410018
*EXITS - NORMAL - XCTL TO IGG01991 TO COMPLETE LOADING OF ACCESS        01420018
*                 METHOD SUBROUTINES.                                   01430018
*       - ERROR - XCTL TO PROBLEM DETERMINATION FOR WTP AND 013 ABEND   01440021
*                                                                       01450018
*TABLES/WORKAREAS - DESCRIBED BY DSECTS AT END OF MODULE LISTING.       01460018
*                                                                       01470018
*ATTRIBUTES - REENTRANT, REUSABLE, SUPERVISOR STATE,             Y02072 01480002
*             RUNS IN DATA MANAGEMENT KEY UNLESS OTHEWISE        Y02072 01482002
*             SPECIFIED.                                         Y02072 01484002
*                                                                       01490018
*                                                                       01500018
* REGISTER CONVENTIONS                                                  01510018
RE       EQU   0                        WORK REG5                       01560002
RF       EQU   1                        WORK REG6                       01610002
R1       EQU   RF                       PARM REG                 YM1140 01660002
RDCB     EQU   2                        DCB                             01700000
RBASE    EQU   3                        BASE                            01800000
RCORE    EQU   4                        WORE AREA                       01900000
RPAR     EQU   5                        TOP OF PARAMETER                02000000
RWTG     EQU   6                        TOP OF WTG TABLE                02100000
RPARC    EQU   7                        CURRENT PARAMETER               02200000
RWTGC    EQU   8                        CURRENT TRANS LOAD              02300000
RTIOT    EQU   9                        TIOT                            02400000
RUCB     EQU   10                       UCB                             02500000
RDEB     EQU   11                       DEB                             02600000
RB       EQU   12                       WORK REG1                       02700000
RC       EQU   13                       WORK REG2                       02800000
RD       EQU   14                       WORK REG3                       02900000
RJ       EQU   15                       WORK REG4                       03000000
*                                                                       03300000
*                                                                       03400000
PARAR    EQU   RPARC                                                    03500000
THREE    EQU   X'03'                    CONSTANT=3               S20202 03520020
K24      EQU   X'18'                    CONSTANT=24              S20202 03540020
K25      EQU   X'19'                    CONSTANT=25              S20202 03560020
*                                                                       03600000
*********************************************************************** 03700000
*                                                                       03800000
*********************************************************************** 03900000
*                                                                       04000000
* MASK'S TO TEST PARAMETER LIST WITH                                    04100000
*                                                                       04200000
*********************************************************************   04300000
INP      EQU   X'0F'                    MASK                            04400000
OUTP     EQU   X'0F'                    MASK                            04500000
UPDATE   EQU   X'04'                    MASK                            04600000
INOUT    EQU   X'03'                    MASK                            04700000
OUTIN    EQU   X'07'                    MASK                            04800000
RDBACK   EQU   X'01'                    MASK                            04900000
INPRDBK  EQU   X'0E'               MASK TO CK INPUT AND RDBACK     UT18 04950018
*                                                                       05000000
*                                                                       05100000
*********************************************************************   05200000
*                                                                       05300000
*                                                                       05400000
* OFFSET FOR PARAMETER TESTS                                            05500000
*                                                                       05600000
FRTYATE  EQU   48                       MASK                            05700000
DISPSN   EQU   X'0'                     MASK                            05800000
*                                                                       05900000
*                                                                       06000000
*********************************************************************   06100000
*                                                                       06200000
* OFFSETS FOR DEB REFERENCE                                             06300000
*                                                                       06400000
*                                                                       06500000
ABEAPPOF EQU   17                       OFFSET TO AB END APP     S20202 06540020
*                                       ADDR                     S20202 06560020
FOUR     EQU   X'04'                                             M5150  06590020
BIN      EQU   36                                                       06600000
BEXT     EQU   38                                                       06700000
*                                                                       06800000
*                                                                       06900000
*                                                                       07000000
*********************************************************************   07100000
*                                                                       07200000
* MASK'S USED TO TEST OPTION FIELDS IN DCB                              07300000
*                                                                       07400000
*                                                                       07500000
*                                                                       07600000
DOUBLE   EQU   X'01'                    MASK                            07700000
*                                                                       07800000
*                                                                       07900000
STOWB    EQU   X'80'                    MASK                            08000000
WRTCK    EQU   X'80'                    MASK                            08100000
OVRFLO   EQU   X'20'                    MASK                            08200000
PCI      EQU   X'20'                    MASK                            08300000
MINKEY   EQU   X'01'                    MASK                            08400000
CONCAT   EQU   X'FF'                    MASK                            08500000
UTFMASK  EQU   X'02'               MASK FOR TOTALING FACILITY      UT18 08550018
BFTEKR   EQU   X'20'                    MASK FOR OFFSET READ     S19015 08570019
*                                                                       08600000
*********************************************************************   08700000
*                                                                       08710019
* MASKS USED TO TEST OPTION FIELDS IN DEB                               08720019
*                                                                       08730019
INOROUT  EQU   X'0F'                    INPUT OR OUTPUT          S19015 08740019
*                                                                       08750019
******************************************************************      08760019
*                                                                       08800000
* MASKS FOR ACCESS METHODS IN SAM                                       08900000
*                                                                       09000000
QSAMB    EQU   X'01'                    MASK                            09100000
BSAMBIT  EQU   X'00'                    MASK                            09200000
PAM      EQU   X'02'                    MASK                            09300000
*                                                                       09400000
*                                                                       09500000
* MASKS FOR MACRO'S TO BE USED                                          09600000
*                                                                       09700000
GETB     EQU   X'40'                    MASK                            09800000
PUTB     EQU   X'40'                    MASK                            09900000
READB    EQU   X'20'                    MASK                            10000000
WRITEB   EQU   X'20'                    MASK                            10100000
POINTB   EQU   X'04'                    MASK                            10200000
CNTRLB   EQU   X'02'                    MASK                            10300000
*                                                                       10400000
*                                                                       10500000
*********************************************************************   10600000
* MASKS FOR DEVICES TO BE SUPPORTED                                     10700000
*                                                                       10800000
*                                                                       10900000
*********************************************************************   11000000
*                                                                       11100000
*                                                                       11200000
PTR3211  EQU   X'49'                    MASK FOR 3211 PRINTER    S20202 11250020
*                                                                       11300000
*                                                                       11400000
*********************************************************************   11500000
*                                                                       11600000
* MASKS FOR STATUS BITS TO BE TESTED                                    11700000
*                                                                       11800000
*                                                                       11900000
EXCPN    EQU   X'30'                    MASK                            12000000
COMPLETE EQU   X'80'                    MASK                            12100000
FIRSTIOB EQU   X'01'                    MASK                            12200000
*                                                                       12300000
*                                                                       12400000
*                                                                       12500000
*********************************************************************   12600000
*                                                                       12700000
* MASKS FOR BUFFER TECHNIQUE'S                                          12800000
*                                                                       12900000
CYCLICB  EQU   X'20'                                                    13000000
EXCHANGB EQU   X'10'                                                    13100000
SIMPLEB  EQU   X'40'                                                    13200000
EXCHCYCL EQU   X'30'                                                    13300000
*                                                                       13400000
*    MASKS FOR OPEN OVERRIDE OPTIONS                                    13410021
*                                                                       13420021
OVRDMSK  EQU   X'C0'                    INDICATES OPEN OVERRIDE  S21040 13430021
OVRDIN   EQU   X'0F'                    TEST FOR LABEL=(,,,IN)   S21040 13440021
CTDISP   EQU   X'10'                    CT DISPLACEMENT IN TABLE S21040 13450021
*                                                                       13500000
* MODES  OPERATION FOR QSAM                                             13600000
LOCATEB  EQU   X'08'                                                    13700000
MOVEB    EQU   X'10'                                                    13800000
MOVEXCHB EQU   X'14'                                                    13850003
SUBSTUTB EQU   X'04'                                                    13900000
DATAMODE EQU   X'01'                                                    14000000
* COMMAN YTES FOR THE 2841                                              14100000
SRCHE    EQU   X'31'                                                    14200000
WRTCKD   EQU   X'1D'                                                    14300000
RDC      EQU   X'92'                                                    14400000
RDKD     EQU   X'8E'                                                    14500000
RDD      EQU   X'86'                                                    14600000
TIC      EQU   X'08'                                                    14700000
* MASKS   RECORD FORMATS                                                14800000
STANDRDF EQU   X'08'                                                    14900000
FORMATU  EQU   X'C0'                                                    15000000
FORMATF  EQU   X'80'                                                    15100000
FORMATV  EQU   X'40'                                                    15200000
SPANNED  EQU   X'08'                                                    15300000
BLOCKED  EQU   X'10'                                                    15400000
FIXEDBLK EQU   X'90'                                                    15500000
*   CHAN  CONTROL WORD FLAGS                                            15600000
SKIP     EQU   X'10'                                                    15700000
SLI      EQU   X'20'                                                    15800000
CC       EQU   X'40'                                                    15900000
DATACH   EQU   X'A0'                                                    16000000
SLICC    EQU   X'60'                                                    16100000
SLICCSK  EQU   X'70'                                                    16200000
KEYS     EQU   X'01'                                                    16300000
QSAM     EQU   X'01'                                                    16400000
GETMAIN  EQU   4                                                        16500000
XCTL     EQU   7                                                        16600000
LOAD     EQU   8                                                        16700000
ASA      EQU   X'04'                                                    16800000
BKREAD   EQU   X'01'                                                    16900000
URBITS   EQU   X'40'                                                    17000000
TAPEB    EQU   X'80'                                                    17100000
DABIT    EQU   X'20'                                                    17200000
D2       EQU   2                        DISPLACEMENT OF 2        S21040 17210021
D3       EQU   3                        DISPLACEMENT OF 3        S21040 17220021
D6       EQU   6                        DISPLACEMENT OF 6        S21040 17230021
L1       EQU   1                        LENGTH OF 1              S21040 17240021
L4       EQU   4                        LENGTH OF 4              S21040 17250021
R25      EQU   25                       CONSTANT                        17300000
R3       EQU   3                        CONSTANT                        17400000
R5       EQU   5                        CONSTANT                        17500000
R2       EQU   2                        CONSTANT                 S19015 17510019
ATBOFST  EQU   22                       OFFSET TO ATTRIBUTE      S19015 17520019
LENOFST  EQU   27                       OFFSET TO LENGTH OF TEXT S19015 17530019
ONLYLOAD EQU   X'CB'                    ONLY LOADABLE            S19015 17540019
MULTTEXT EQU   X'CA'                    MULTIPLE TEXT            S19015 17550019
UPDATEB  EQU   X'80'                    OPEN FOR UPDATE          S19015 17560019
FLGOFFST EQU   4                        OFFSET TO FLAG IN BCB    S19015 17570019
RAFLAG   EQU   X'80'                    RECORD AREA INDICATOR    S19015 17580019
OABD076  EQU   76                                                S21042 17590021
*                                                                       17600000
*                                                                       17700000
         BALR  RBASE,RE                 SET BASE                        17800000
         USING SLDA,RBASE                                               17900000
         USING IHADCB,RDCB                                              18000000
         USING FORCORE,RCORE                                            18200000
*                                                                       18400000
*                                                                       18500000
SLDA     EQU   *                                                        18600000
         B     BEGIN                    BR AROUND CONSTANTS    @Z30TSCF 18650003
         DC    C'IGG01915'              MODULE ID              @Z30TSCF 18700003
         DC    C'@Z30TSCF'              LAST SHIP CODE         @Z30TSCF 18750003
         DC    C'11/18/74'              LAST SHIP DATE         @Z30TSCF 18760003
BEGIN    DS    0H                                                       18770003
*                                                                       18800000
         L     RDCB,0(RPARC)            GET DCB ADDRESS                 18900000
         LA    RDCB,0(RDCB)             CLEAR HI BYTE                   19000000
         L     RDEB,DCBDEBAD            GET DEB ADDRESS                 19100000
         USING DEBBASIC,RDEB                                            19150001
         L     RCORE,4(RWTGC)           GET WORK AREA                   19200000
*                                                                       19400000
         L     RTIOT,DEBAPPAD           GET APPENDAGE ADDRESS           19500000
         USING DEBAVT,RTIOT                                             19550001
         SR    RUCB,RUCB                CLEAR REG                       19600000
         SR    RF,RF                    CLEAR RER                       19700000
         SR    RD,RD                                                    19800000
         IC    RUCB,DEBNMEXT            GET NUMBER OF EXTENTS           19900000
         IC    RF,DEBEXSCL              GET SCALING FACTOR              20000000
         SLL   RUCB,0(RF)               SHIFT ACCORDING TO EXTENT SIZE  20100000
         IC    RF,DEBAMLNG              GET ACCESS METHOD LENGTH        20200000
         LA    RUCB,0(RF,RUCB)          ADD TO POINT TO SUBRT ID FLD    20300000
         LA    RUCB,32(RUCB,RDEB)       ADD BASIC DEB SZ TO DEB AD      20400000
*                                                                       20500000
*  RUCB NOW POINTS TO THE SUBROUTINE ID FIELD IN THE DEB                20600000
*                                                                       20700000
         TM    DCBOPTCD,UTFMASK         TEST FOR TOTALING          UT18 20706018
         BZ    SLDAA                    BR IF NOT SPECIFIED        UT18 20712018
         TM    0(RPARC),INPRDBK         IS OPEN FOR INPUT/RDBACK   UT18 20718018
         BZ    SLDAA                    IF YES,NO TOTALING REQ'RD  UT18 20724018
*                                                                       20730018
*  SINCE UTF WAS SPECIFIED, THE TOTALING SAVE ROUTINE (IGG019AX)        20736018
*  WAS LOADED BY IGG0191Y IN STAGE 1 - SO IT IS NECESSARY TO       UT18 20742018
*  UPDATE THE SUBROUTINE ID POINTER (RUCB) TO POINT TO THE         UT18 20748018
*  SECOND ID SUBFIELD.                                             UT18 20754018
*                                                                  UT18 20760018
         LA    RUCB,2(RUCB)             INCREMENT POINTER BY 2     UT18 20766018
         IC    RD,DEBNMSUB              NO. OF SUBRTNS LOADED SO A29249 20768019
*                                       FAR                      A29249 20770019
*                                                                  UT18 20772018
SLDAA    EQU   *                                                   UT18 20778018
         CLI   DCBDEVT,PTR3211          TEST FOR 3211 PRINTER    S20202 20778220
         BNE   SLDAB                    NO BRANCH AROUND         S20202 20778420
*                                                                       20778620
*   FOR A 3211 PRINTER LOAD AN ABNORMAL END APPENDAGE AND AN ERROR      20778820
*   RETRY MODULE.                                                       20779020
*                                                                       20779220
         LA    RB,ABEAPP11              GET ADDR ABNORMAL END    S20202 20779420
*                                      APP ID                    S20202 20779601
         BAL   RC,SLDROUT              GO LOAD APP AND RETURN    S20202 20779701
         MVC   DEBXCEAD,25(RWTG)       MOVE APP ADDR INTO AVT    S20202 20779801
         LA    RB,ERRMOD                GET ADDR OF ERROR RETRY  S20202 20780620
*                                       MOD                      S20202 20780820
         BAL   RC,SLDROUT               GO LOAD ERROR RETRY MOD  S20202 20781020
*                                       3211                     S20202 20781220
*                                                                       20781420
*   WHEN RETURN FROM 'SLDROUT'- R0 CONTAINS THE ADDR OF THE             20781620
*   ASYNCHRONOUS ERROR ROUTINE. NOW BUILD AN IRB TO BE USED  IN         20781820
*   SCHEDULING THIS ROUTINE                                             20782020
         CIRB  EP=(0),KEY=PP,MODE=PP,STAB=(RE)                          20782201
         ST    RF,K24(RWTG)             TEMP SAVE FOR IRB ADDR   S20202 20782420
         MVC   DEBIRBB,25(RWTG)   MOVE IRB ADDR INTO DEB         S20202 20782601
SLDAB    EQU   *                                                 M5150  20783820
         USING WTGENTRY,RWTGC                                    Y02072 20783902
         MVC   WTGIDTTR,NEXTMOD         ID OF NEXT MOD         @Z30TSCF 20789203
         TM    DCBCIND2,QSAMB           DCB FOR QSAM                    20800000
         BC    1,SLD100                YES                              20900000
*                                                                       21100000
         LA    RB,CHECK                 GET ADDRESS OF CHECK ID         21200000
         TM    DCBOFLGS,X'20'          CONCATENATING UNLIKE      A31594 21260020
*                                       ATTRIBUTES               A31594 21320020
         BC    8,SLDA0                  NO BRANCH                       21400000
         BAL   RC,SLDROUT1              STORE THE ID OF CHECK IN DEB    21500000
         B     SLDA1                    DO NOT LOAD CHECK ROUTINE       21600000
*                                                                       21700000
SLDA0    BAL   RC,SLDROUT               LOAD CHECK ROUTINE              21800000
         MVC   DCBECC(R3),R25(RWTG)     LOAD CHECK ADDR INTO DCB        21900000
*                                                                       22000000
SLDA1    EQU   *                                                        22100000
         TM    DCBBFTEK,BFTEKR          VS SUPPORT NEEDED        S19015 22110019
         BZ    SLDA3                    NO--BRANCH               S19015 22120019
         LA    RB,OFFSETRD              OFFSET READ ID           S19015 22130019
         B     SLDA4                    GO TO LOAD ROUTINE       S19015 22140019
*                                                                       22150019
*                                                                       22200000
SLDA3    EQU   *                                                 S19015 22250019
         LA    RB,WRH2                  GET RD/WRT ID ADDRESS           22300000
SLDA4    EQU   *                                                 S19015 22350019
         BAL   RC,SLDROUT               TO LOAD FUNCTION                22400000
         MVC   DCBREAD+1(R3),R25(RWTG)  LOAD R/W ADDR.                  22500000
         B     SLDEOB                   GET SPECIAL ROUTINES            22600000
SLD100   EQU   *                                                        22700000
         TM    DCBCIND2,UPDATEB         IS THIS UPDATE           S19015 22760019
         BO    SLD106                   YES, LOAD UPDATE ERR RTN S19015 22820019
         TM    DISPSN(PARAR),OUTP       DCB FOR OUTPUT                  22900000
         BC    1,SLD200                 YES, BRANCH                     23000000
*                                                                       23100000
         LA    RB,GERR                  GET ADDRESS OF GERR ID          23200000
         B     SLD107                   BRANCH TO TEST ATTRIBUTE S19015 23210019
*                                                                       23220019
SLD106   EQU   *                                                 S19015 23230019
*                                                                       23240019
         LA    RB,UERR                  GET ADDRESS OF UERR ID   S19015 23250019
*                                                                       23260019
SLD107   EQU   *                                                 S19015 23270019
*                                                                       23300000
         TM    DCBOFLGS,X'20'           CONTATENTION UNLIKE ATTRIBUTES/ 23400000
         BC    8,SLD100A                NO, BRANCH                      23500000
*                                                                       23600000
         BAL   RC,SLDROUT1                                              23700000
         B     SLD101                   TO CHECK NEXT PARAMETER         23800000
*                                                                       23900000
*                                                                       24000000
SLD150   EQU   *                                                        24100000
         BAL   RC,SLDROUT               TO LOADING FUNCTION             24200000
*                                                                       24230019
SLD151   EQU   *                                                 S19015 24260019
         MVC   DCBGET+1(3),25(RWTG)     INSERT ADDRESS OF THE MODULE    24300000
         B     SLDEOB                   JUST LOADED INTO DCB FIELD      24400000
*                                                                       24500000
SLD100A  EQU   *                                                        24600000
         BAL   RC,SLDROUT               TO OUTPUT                       24700000
         MVC   DCBGERR+1(3),25(RWTG)    LOAD GERR ADDR. IN DCB          24800000
*                                                                       24900000
*                                                                       25000000
SLD101   EQU   *                                                        25100000
         CLI   DCBLRECL,X'80'          LRECL=X                          25200000
         BE    CHECKLOC                YES                              25300000
SLD172   EQU   *                                                        25400000
*                                                                       25500000
         TM    DCBRECFM,SPANNED                                         25600000
         BO    SLD173                   NOT SPANNED                     25700000
         TM    DCBMACRF,MOVEXCHB        MOVE OR SUBST?         @Z30TSMI 25800003
         BNZ   SLD171                   YES                    @Z30TSMI 25900003
         LA    RB,GL                   IGG019AB                         26000000
         B     SLD150                   DONE                            26100000
CHECKLOC TM    DCBMACRF,LOCATEB        IS IT LOCATE MODE                26200000
         BO    SLD172                  YES                              26300000
ABEND013 DMABCOND OABD076,PDLOAD,RETURN=NONE,RES=NO,           @ZA08271*26500003
               REGSAVE=YES              CALL PROBLEM DETERM    @ZA08271 26700003
         B     TCTLRTN                                           S21042 26900021
SLD171   EQU   *                                                        27400000
         LA    RB,GM                   IGG019AD                         27500000
         B     SLD150                   DONE                            27600000
SLD173   EQU   *                                                        27700000
         TM    DCBCIND2,UPDATEB         IS THIS UPDATE           S19015 27730019
         BO    SLD170                   YES, BRANCH              S19015 27760019
         TM    DCBMACRF,DATAMODE        DCB USING DATA MODE             27800000
         BO    SLD176                   NOT DATA MODE                   27900000
         TM    DCBMACRF,MOVEXCHB        MOVE OR SUBST?         @Z30TSMI 28000003
         BNZ   SLD177                   YES                    @Z30TSMI 28100003
         L     RC,DCBBUFCB              GET BUFFCB ADDRESS     @ZA08271 28150003
         LA    RC,DISPSN(RC)            CLEAR HI ORDER BYTE    @ZA08271 28156003
         MODESET KEYADDR=DXUKEY,WORKREG=15 GET USER KEY        @ZA08271 28162003
         TM    FLGOFFST(RC),RAFLAG      RECORD AREA PRESENT?   @ZA08271 28168003
         MODESET EXTKEY=DATAMGT                                @ZA08271 28174003
         BO    SLD169                   YES, BRANCH              S19015 28180019
         LA    RB,GLS                  IGG019FB                         28200000
         B     SLD150                   ALL DONE                        28300000
*                                                                       28310019
SLD169   EQU   *                                                 S19015 28320019
         TM    DCBLRECL,X'80'           LRECL=X                @ZA08271 28330003
         BO    ABEND013                 YES-GO ABEND           @ZA08271 28335003
         LA    RB,GLSLR                 GET SPECIAL GET MODULE   S19015 28340019
         B     SLD150                   ALL DONE                 S19015 28350019
SLD170   EQU   *                                                 S19015 28360019
         LA    RB,UGET                  GET UPDATE GET MODULE    S19015 28370019
         B     SLD150                   LOAD                     S19015 28380019
SLD176   EQU   *                                                        28400000
         LA    RB,GDS                  IGG019FF                         28500000
         B     SLD150                   ALL DONE                        28600000
SLD177   EQU   *                                                        28700000
         LA    RB,GMS                  IGG019FD                         28800000
         B     SLD150                   ALL DNOE                        28900000
SLD200   LA    RB,PERR                  GET THE ADDR. OF PERR ID INTO   29000000
         BAL   RC,SLDROUT               LOAD SUBROUTINE                 29100000
         MVC   DCBPERR+1(3),25(RWTG)    INSERT PERR ADDR. INTO DCB      29200000
*                                                                       29300000
         TM    DCBRECFM,SPANNED         SPANNED                         29400000
         BO    SLD175                   NOT SPANNED                     29500000
         TM    DCBMACRF+1,MOVEXCHB      MOVE OR SUBST?         @Z30TSMI 29600003
         BNZ   SLD174                   YES, BRANCH            @Z30TSMI 29700003
         LA    RB,PL                   IGG019AJ                         29800000
         B     SLD150                   GO TO NEXT CHECKING             29900000
SLD174   EQU   *                                                        30000000
         LA    RB,PM                   IGG019AL                         30100000
         B     SLD150                   GO TO NEXT CHECKING             30200000
SLD175   EQU   *                                                        30300000
         TM    DCBMACRF+1,DATAMODE                                      30400000
         BO    SLD178                  SKIP                             30500000
         TM    DCBMACRF+1,MOVEXCHB      MOVE OR SUBST?         @Z30TSMI 30600003
         BNZ   SLD179                   YES                    @Z30TSMI 30700003
         L     RB,DCBBUFCB             GET BUFFCB ADDRESS      @ZA08271 30750003
         LA    RB,DISPSN(RB)           CLEAR HI ORDER BYTE     @ZA08271 30756003
         MODESET KEYADDR=DXUKEY,WORKREG=15  GET USER KEY       @ZA08271 30762003
         TM    FLGOFFST(RB),RAFLAG     LRI PRESENT?            @ZA08271 30768003
         MODESET EXTKEY=DATAMGT                                @ZA08271 30774003
         BO    SLD180                   YES, BRANCH LD BP        S19015 30780003
         LA    RB,PLS                  IGG019FJ                         30800000
         B     SLD150                   GO TO NEXT CHECKING             30900000
SLD180   EQU   *                                                 S19015 30920019
         LA    RB,PLSLR                 GET SPECIAL PUT MODULE   S19015 30940019
         B     SLD150                   TO NEXT ONE              S19015 30960019
SLD179   EQU   *                                                        31000000
         LA    RB,PMS                  IGG019FL                         31100000
         B     SLD150                   TO NEXT ONE                     31200000
SLD178   EQU   *                                                        31300000
         LA    RB,PDS                  IGG019FG                         31400000
         B     SLD150                   TO NEXT ONE                     31500000
SLDEOB   EQU   *                                                        31600000
         STC   RD,DEBNMSUB              STORE NBR OF MODULES       UT18 37600018
*                                                                       43900000
*    THIS SECTION OF CODE UP TO THE LABEL ENDOVER WILL ENSURE THAT      43903021
*    THE EOB ROUTINE IGG019CT GETS LOADED FOR ANY OPEN OVERRIDE.        43906021
*    ROUTINE LOADED BY IGG01991.                                        43909021
*                                                                       43912021
         TM    JFCBMASK+D6,OVRDMSK      WAS AN OVERRIDE USED     S21040 43915021
         BNO   ENDOVR                   BR IF NO                 S21040 43918021
         TM    0(RPARC),OVRDIN          WAS IT LABEL=(,,,IN)     S21040 43921021
         BZ    INCHNG                   BRANCH IF YES            S21040 43924021
         MVC   DCBCNTRL+D2(L1),DCBCNTRL+D3 SAVE WRITE EOB DISP   S21040 43927021
         MVI   DCBCNTRL+D3,CTDISP       SET READ EOB ROUTINE FOR S21040 43930021
*                                       THE ERROR EOB ROUTINE           43933021
         B     ENDOVR                   CONTINUE                 S21040 43936021
INCHNG   EQU   *                                                 S21040 43939021
         MVI   DCBCNTRL+D2,CTDISP       SET WRITE EOB ROUTINE    S21040 43942021
*                                        FOR ERROR EOB ROUTINE          43945021
ENDOVR   EQU   *                                                 S21040 43948021
*                                                                       43951021
*    IF USER TOTALING WAS SPECIFIED, EOB ROUTINES CONTAINING            43954021
*    LINKAGE TO THE TOTALING SAVE ROUTINES MUST BE LOADED INSTEAD       43957021
*    OF NORMAL EOB ROUTINES.  THIS IS ACCOMPLISHED BY DOING A           43960021
*    TRANSLATE OF THE DCBCNTRL FIELD TO CONVERT NORMAL EOB              43963021
*    DISPLACEMENTS INTO DISPLACEMENTS FOR THE UTF EOB ROUTINES.         43966021
*    EOB ROUTINES ARE LOADED BY IGG01991.                               43969021
*                                                                       43972021
         TM    DCBOPTCD,UTFMASK         TEST FOR TOTALING OPTION S21040 43975021
         BZ    SLD250                   BR IF NOT SPECIFIED      S21040 43978021
         TM    0(RPARC),INPRDBK         IS OPEN FOR INPUT/RDBACK S21040 43981021
         BZ    SLD250                   BR YES NO TOTALING REQ'D S21040 43984021
         TR    DCBCNTRL(L4),UTFTBL      CHANGE TO UTF DISP.      S21040 43987021
SLD250   EQU   *                                                 S21040 43990021
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURR WTG ENTRY        44000000
         LA    RPARC,PLOFF(0,RPARC)     INCR CURRENT DCB ENTRY PRTR     44100000
         CLC   0(2,RWTGC),AMIDCNST      THIS RT NEEDED AGAIN            44200000
         BCR   8,RBASE                  BACK TO OPEN CONTROL            44300000
*                                                                       44400000
         CLC   0(2,RWTGC),OPIDCNST      END OF TABLE                    44500000
         BC    7,RELOOP                 NO,CHECK NEXT ENTRY             44600000
*                                                                       44700000
         LR    RPARC,RPAR                                               44800000
         LA    RWTGC,WAOFF(0,RWTG)      REINITIALIZE WTG LIST PTR       44900000
ZCHEK    CLI   0(RWTGC),X'00'          IS THIS ENTRY COMPLETE           45000000
         BC    7,TCTLRTN                IF NOT TRANSFER CONTROL         45100000
*                                                                       45200000
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY                  45300000
         LA    RPARC,PLOFF(0,RPARC)                                     45400000
         B     ZCHEK                    COMPLETE                        45500000
*                                                                       45600000
TCTLRTN  EQU   *                                                        45700000
         USING WTG,RWTG                                                 45750003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*45800003
               MODID=WTGENTRY                                  @Z30TSCF 45850003
         DROP  RWTGC,RWTG                                      @Z30TSCF 45900003
*                                                                       48000000
*                                                                       48100000
*                                                                       48200000
         DS    0H                       HALF WORD BOUNDARY              48300000
SLDROUT  EQU   *                                                        48400000
         USING WTGMODNM,RWTG                                     Y02072 48450002
         MVC   WTGMODID,0(RB)           ID TO MOD NAME           Y02072 48500002
         DROP  RWTG                                              Y02072 48550002
         L     R1,CVTPTR                LOAD CVT ADDRESS         YM1140 48600002
         USING CVT,R1                   CVT ADDRESSABILITY       YM1140 48650002
         L     R1,CVTLINK               GET LPALIB DCB ADDRESS   YM1140 48700002
         DROP  R1                       DROP CVT BASE            YM1140 48750002
*                                                                       48800002
         LOAD  EPLOC=(RWTG),DCB=(1)                              YM1140 49700002
*                                                                       49800000
*                                                                       49900000
*                                                                       50000000
         ST    RE,24(RWTG)             TEMP STORE OF ROUTINE ADDR,      50100000
SLDROUT1 MVC   0(2,RUCB),0(RB)          STORE ROUTINES ID IN DEB        50200000
         LA    RUCB,2(RUCB)             UPDATE SUBRT PNTR               50300000
         LA    RD,1(RD)                 ONE MORE SUB RT LOADED          50400000
         BR    RC                      RETURN                           50500000
*                                                                       50600000
WAOFF    EQU   32                                                       50820018
PLOFF    EQU   4                        OFFSET OF DCB ENTRIES           50825018
WGOFF    EQU   8                        OFFSET OF WTG ENTRIES           50830018
OPIDCNST DC    C'0S'                    ID                              50835018
AMIDCNST DC    C'15'                    MODULE ID                       50880018
*                                                                       50900000
*                                                                       50903021
*    THE FOLLOWING TABLE IS USED WITH A TRANSLATE INSTRUCTION TO        50906021
*    CONVERT DISPLACEMENTS FOR THE EOB TABLE INTO THOSE FOR THE         50909021
*    ENTRIES FOR THE CORRESPONDING UTF ROUTINES.                        50912021
*                                                                       50915021
UTFTBL   EQU   *                                                 S21040 50918021
         DC    X'00'                    NO CHANGE                S21040 50921021
         DC    X'0B'                    IGG019CD TO IGG019TD     S21040 50924021
         DC    X'0C'                    IFG019CC TO IGG019TC     S21040 50927021
         DC    X'03'                    NO CHANGE                S21040 50930021
         DC    X'04'                    NO CHANGE                S21040 50933021
         DC    X'05'                    NO CHANGE                S21040 50936021
         DC    X'06'                    NO CHANGE                S21040 50939021
         DC    X'07'                    NO CHANGE                S21040 50942021
         DC    X'08'                    NO CHANGE                S21040 50945021
         DC    X'09'                    NO CHANGE                S21040 50948021
         DC    X'0A'                    NO CHANGE                S21040 50951021
         DC    X'0B'                    NO CHANGE                S21040 50954021
         DC    X'0C'                    NO CHANGE                S21040 50957021
         DC    X'0D'                    NO CHANGE                S21040 50960021
         DC    X'0E'                    NO CHANGE                S21040 50963021
         DC    X'0F'                    NO CHANGE                S21040 50966021
         DC    X'10'                    NO CHANGE                S21040 50969021
*                                                                       50972021
*    NOTE, THERE MUST BE AN ENTRY IN THIS TRANSLATE TABLE FOR           50975021
*    EACH ENTRY IN THE EOB TABLE.                                       50978021
*                                                                       50981021
*                                                                       51000000
*                                                                       52600000
*********************************************************************** 52700000
*                                                                       52800000
*         MODULE IDS LOADED BY THIS MODULE                              52850002
*                                                                       52900002
NEXTMOD  DC    C'91',VL3(IGG01991)      ID OF MODULE IGG01991  @Z30TSCF 52950003
PERR     DC    C'AR'                    ID OF MODULE IGG019AR    Y02072 53000002
GERR     DC    C'AQ'                    ID OF MODULE IGG019AQ    Y02072 53050002
UERR     DC    C'BQ'                    ID OF MODULE IGG019BQ    Y02072 53100002
UGET     DC    C'BN'                    ID OF MODULE IGG019BN    Y02072 53150002
GL       DC    C'AB'                    ID OF MODULE IGG019AB    Y02072 53200002
GM       DC    C'AD'                    ID OF MODULE IGG019AD    Y02072 53250002
PL       DC    C'AJ'                    ID OF MODULE IGG019AJ    Y02072 53300002
PM       DC    C'AL'                    ID OF MODULE IGG019AL    Y02072 53350002
GLSLR    DC    C'BO'                    ID OF MODULE IGG019BO    Y02072 53400002
GLS      DC    C'FB'                    ID OF MODULE IGG019FB    Y02072 53450002
GMS      DC    C'FD'                    ID OF MODULE IGG019FD    Y02072 53500002
GDS      DC    C'FF'                    ID OF MODULE IGG019FF    Y02072 53550002
PLSLR    DC    C'BP'                    ID OF MODULE IGG019BP    Y02072 53600002
PLS      DC    C'FJ'                    ID OF MODULE IGG019FJ    Y02072 53650002
PMS      DC    C'FL'                    ID OF MODULE IGG019FL    Y02072 53700002
PDS      DC    C'FG'                    ID OF MODULE IGG019FG    Y02072 53750002
WRH2     DC    C'BA'                    ID OF MODULE IGG019BA    Y02072 53800002
OFFSETRD DC    C'BU'                    ID OF MODULE IGG019BU    Y02072 53850002
CHECK    DC    C'BB'                    ID OF MODULE IGG019BB    Y02072 53900002
ABEAPP11 DC    C'FR'                    ID OF MODULE IGG019FR    Y02072 53950002
ERRMOD   DC    C'FS'                    ID OF MODULE IGG019FS    Y02072 54000002
PDLOAD   DC    C'6M',VL3(IGG0196M)      ID OF MODULE IGG0196M  @Z30TSCF 54050003
*                                                                       54060002
PATCH    DC    0H'0',C'IGG01915',XL42'00'   PATCH AREA           Y02072 54100002
 TITLE 'IGG01915 - FORMAT OF GOTTEN CORE'                               62800018
         IECDSECS MAIN,WTG,PREFX,EXPAND=YES                    @Z30TSCF 62900003
         ORG   WTGIDTTR                                          Y02072 62950002
WTGID    DS    CL2                      NEXT MOD ID              Y02072 63000002
*                                                                       63100000
*                                                                       63200000
CVT      DSECT                                                          63300000
         CVT                                                            63400000
*                                                                       63500000
*                                                                       63600000
         IEZDEB                                                         63700001
*                                                                       66400000
           DCBD  DSORG=PS                                               66500000
DCBECC   EQU   DCBCHECK+1               DCB FIELD                       66600000
         END                                                            66700000
