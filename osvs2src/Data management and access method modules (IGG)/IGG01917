 TITLE 'IGG01917 - SAM OPEN EXECUTOR (SECOND HALF OF IGG01910)'    UT18 00100018
IGG01917 CSECT                                                          00150020
*MODULE NAME - IGG01917                                          Y02072 00152002
*                                                                       00154002
*DESCRIPTIVE NAME - LOADS ACCESS METHOD ROUTINES                 Y02072 00156002
*                                                                       00158002
*COPYRIGHT - NONE                                                Y02072 00158402
*                                                                       00158802
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00159202
*                                                                       00159602
*          VS 2 RELEASE 2 DELETIONS                              Y02072 00160002
*001100,011000,020000-021000,031000,038000,256200-256600,283500, Y02072 00170002
*284500,285500-286500,342480-342704,343280-343760,353530-353950, Y02072 00180002
*360300-367150,390000-394000,399000-402000,413000,505050-505900, Y02072 00190002
*598040-598096,623300,624200,624240-624400,335500-337500,342000  Y02072 00192002
*381010-381100,594200-594800,624100-624500,403000,479000-480000, Y02072 00242002
*484000,489000-501000,537000-544000                              Y02072 00252002
*                                                                YM1140 00262002
*                                                                YM2507 00272002
*                                                                YM4640 00272102
*D381600-381800                                                  YM5922 00282102
*                                                                       00292103
*          VS2 RELEASE 3 DELETIONS                                      00294103
*                                                              @Z30TSCF 00296103
*C371000-371100                                                @OS73907 00298137
*A371420-371424                                                @OS73907 00298537
*          RELEASE 20 DELETIONS                                         00300018
*0872                                                            S20038 00350020
*0872290000-292000                                               A32160 00370020
*0872259000,343000,345000,352000,568000,626000                   S20201 00380020
*          RELEASE 21 DELETIONS                                         00400018
*0090                                                            A49371 00402021
*0090                                                             M0062 00410021
*D139000-151000,261000-266000,325000-335000,337000              SA53194 00412021
*D381020-381040,381050                                          SA53194 00416021
*0090286000-299000,326000-338000,548000-564000,568000,625600     S21040 00420021
*0090                                                            A42906 00450021
*          VS2.037 CHANGES                                              00500037
*C280030,280040                                               @ZA28034  00550037
*A368000-369000                                               @ZA28034  00600037
*STATUS CHANGE LEVEL 005                                                01100002
*                                                                       01200018
*FUNCTION/OPERATION - THIS MODULE IS A CONTINUATION OF MODULE      UT18 01300018
*      IGG01910 AND LOADS THE REMAINING I/O MODULES.  WHAT IS TO   UT18 01400018
*      BE LOADED IS DETERMINED FROM THE CODES IN THE DCBCNTRL      UT18 01500018
*      FIELD WHICH WAS SET BY PREVIOUS LOADS OF THE OPEN EXECUTORS.UT18 01600018
*      IT WILL PLACE THE ADDRESS OF THE LOADED MODULES IN THE           01700018
*      APPROPRIATE DCB FIELDS, AND THE ID'S IN THE DEB.                 01800018
*      IT WILL BRING IN THE APPROPRIATE END-OF-BLOCK(EOB) ROUTINE       01900018
*      IT WILL BRING IN A SIO APPENDAGE FOR PRINTERS THAT        Y02072 02000002
*      REQUIRE IT.                                               Y02072 02100002
*                                                                       02200018
*ENTRY POINTS - ENTERED ONLY FROM IGG01910 BY USE OF XCTL MACRO    UT18 02300018
*                                                                       02400018
*INPUT: SEE DESCRIPTION OF REGISTERS, DCB(USERS)                        02500018
*                                                                       02600018
*OUTPUT: DCB(USERS),IOB(USERS).                                         02700018
*                                                                       02800018
*EXTERNAL ROUTINES: NONE.                                               02900018
*                                                                       03000018
*EXITS-NORMAL: XCTL TO IGG01911(IECOSOP9)                        Y02072 03100002
*                                                                       03200018
*EXITS-ERROR: NONE.                                                     03300018
*                                                                       03400018
*TABLES/WORKAREAS               *************************************** 03500018
*********************************************************************** 03600018
*                                                                       03700018
*ATTRIBUTES: REENTRANT, REUSABLE, SUPERVISOR STATE,              Y02072 03800002
*            RUNS IN DATA MANAGEMENT KEY                         Y02072 03850002
*                                                                       03900018
*NOTES: THIS ROUTINE HAS A LIST OF ALL BSAM, QSAM MODULES SUPPORTED.    04000018
*                                                                       04100018
*********************************************************************** 04200018
*                                                                       04300018
*                                                                       04400018
*  REGISTER CONVENTIONS USED THROUGH OUT ALL OPEN PASSES                04500018
*                                                                       04600018
*********************************************************************** 04700018
*                                                                       04800018
RE       EQU   0         WORK REG5                                      04850002
RF       EQU   1         WORK REG6                                      04860002
R1       EQU   RF        PARM REG                                YM1140 04870002
RDCB     EQU   2         DCB REGISTER                                   04900018
RBASE    EQU   3         BASE REGISTER                                  05000018
RCORE    EQU   4         WORK AREA ADDRESS                              05100018
RPAR     EQU   5         TOP OF PARAMETER LIST                          05200018
RWTG     EQU   6         TOP OF WTG TABLE                               05300018
RPARC    EQU   7         CURRENT PARAMETER                              05400018
RWTGC    EQU   8         CURRENT TRANS LOAD                             05500018
RTIOT    EQU   9         USED HERE AS WRK REG AND  COMM VECTOR ADDR.    05600018
RUCB     EQU   10        USED HERE AS A COUNTER IN IOB GENERATION       05700018
RDEB     EQU   11        DEB ADDRESS                                    05800018
RB       EQU   12        WORK REG1  **                                  05900018
RC       EQU   13        WORK REG2  **  USED IN IOB GENERATION          06000018
RD       EQU   14        WORK REG3  **                                  06100018
RJ       EQU   15        WORK REG4                                      06200018
*                                                                       06500018
*                                                                       06600018
PARAR    EQU   RPARC                                                    06700018
*                                                                       06800018
*********************************************************************** 06900018
*                                                                       07000018
*********************************************************************** 07100018
*                                                                       07200018
* MASK'S TO TEST PARAMETER LIST WITH                                    07300018
*                                                                       07400018
*********************************************************************   07500018
INP      EQU   X'0F'                                                    07600018
OUTP       EQU   X'0F'                                                  07700018
UPDATE     EQU   X'04'                                                  07800018
INOUT      EQU   X'03'                                                  07900018
OUTIN      EQU   X'07'                                                  08000018
RDBACK     EQU   X'01'                                                  08100018
INPRDBK  EQU   X'0E'               MASK TO CK INPUT AND RDBACK     UT18 08200018
*                                                                       08300018
*                                                                       08400018
*********************************************************************   08500018
*                                                                       08600018
*                                                                       08700018
* OFFSET FOR PARAMETER TESTS                                            08800018
*                                                                       08900018
ONE        EQU   X'01'                                                  09000018
FRTYATE    EQU   48                                                     09100018
DISPSN     EQU   X'0'                                                   09200018
*                                                                       09300018
*                                                                       09400018
*********************************************************************   09500018
*                                                                       09600018
* OFFSETS FOR DEB REFERENCE                                             09700018
*                                                                       09800018
*                                                                       09900018
BIN      EQU   36                                                       10000018
BEXT     EQU   38                                                       10100018
*                                                                       10200018
*                                                                       10300018
*                                                                       10400018
*********************************************************************   10500018
*                                                                       10600018
* MASK'S USED TO TEST OPTION FIELDS IN DCB                              10700018
*                                                                       10800018
*                                                                       10900018
*                                                                       11000018
DOUBLE     EQU   X'01'                                                  11100018
*                                                                       11200018
*                                                                       11300018
STOWB      EQU   X'80'                                                  11400018
WRTCK      EQU   X'80'                                                  11500018
OVRFLO     EQU   X'20'                                                  11600018
PCI        EQU   X'20'                                                  11700018
MINKEY     EQU   X'01'                                                  11800018
CONCAT     EQU   X'FF'                                                  11900018
UTFMASK  EQU   X'02'                    MASK FOR TOTALING FACILITY UT18 12000018
BYPASS   EQU   X'10'                    BYPASS DOS EMBED CHKPT   S21040 12030021
*                                       RECORDS MASK, TAPE FILE         12060021
*                                                                       12100018
*********************************************************************   12200018
*                                                                       12300018
* MASKS FOR ACCESS METHODS IN SAM                                       12400018
*                                                                       12500018
QSAMB      EQU   X'01'                                                  12600018
BSAMBIT    EQU   X'00'                                                  12700018
PAM        EQU   X'02'                                                  12800018
*                                                                       12900018
*                                                                       13000018
* MASKS FOR MACRO'S TO BE USED                                          13100018
*                                                                       13200018
GETB       EQU   X'40'                                                  13300018
PUTB       EQU   X'40'                                                  13400018
READB      EQU   X'20'                                                  13500018
WRITEB     EQU   X'20'                                                  13600018
POINTB     EQU   X'04'                                                  13700018
CNTRLB     EQU   X'02'                                                  13800018
*********************************************************************   15200018
*                                                                       15300018
* MASKS FOR STATUS BITS TO BE TESTED                                    15400018
*                                                                       15500018
*                                                                       15600018
EXCPN      EQU   X'30'                                                  15700018
COMPLETE   EQU   X'80'                                                  15800018
FIRSTIOB   EQU   X'01'                                                  15900018
*                                                                       16000018
*                                                                       16100018
*                                                                       16200018
*********************************************************************   16300018
*                                                                       16400018
* MASKS FOR BUFFER TECHNIQUE'S                                          16500018
*                                                                       16600018
CYCLICB    EQU   X'20'                                                  16700018
EXCHANGB   EQU   X'10'                                                  16800018
SIMPLEB    EQU   X'40'                                                  16900018
EXCHCYCL   EQU   X'30'                                                  17000018
*                                                                       17100018
*********************************************************************   17200018
*                                                                       17300018
*                                                                       17400018
* MODES OF OPERATION FOR QSAM                                           17500018
*                                                                       17600018
LOCATEB    EQU   X'08'                                                  17700018
MOVEB      EQU   X'10'                                                  17800018
MOVEXCHB EQU   X'14'                                                    17900018
SUBSTUTB   EQU   X'04'                                                  18000018
*                                                                       18100018
*                                                                       18200018
*********************************************************************   18300018
*                                                                       18400018
*                                                                       18500018
* COMMAND BYTES FOR THE 2841                                            18600018
*                                                                       18700018
*       CONTROL UNIT                                                    18800018
*                                                                       18900018
*                                                                       19000018
*                                                                       19100018
SRCHE      EQU   X'31'                                                  19200018
WRTCKD     EQU   X'1D'                                                  19300018
RDC        EQU   X'92'                                                  19400018
RDKD       EQU   X'8E'                                                  19500018
RDD        EQU   X'86'                                                  19600018
TIC        EQU   X'08'                                                  19700018
*                                                                       19800018
*                                                                       19900018
*********************************************************************   20000018
*                                                                       20100018
*                                                                       20200018
* MASKS FOR RECORD FORMATS                                              20300018
*                                                                       20400018
*                                                                       20500018
STANDRDF   EQU   X'08'                                                  20600018
FORMATU    EQU   X'C0'                                                  20700018
FORMATF    EQU   X'80'                                                  20800018
FORMATV    EQU   X'40'                                                  20900018
FORMATD  EQU   X'20'                    D FORMAT RECORDS         S20038 20950020
BLOCKED    EQU   X'10'                                                  21000018
FIXEDBLK   EQU   X'90'                                                  21100018
*                                                                       21200018
*                                                                       21300018
*********************************************************************   21400018
*                                                                       21500018
*                                                                       21600018
*   CHANNEL CONTROL WORD FLAGS                                          21700018
*                                                                       21800018
SKIP       EQU   X'10'                                                  21900018
SLI        EQU   X'20'                                                  22000018
CC         EQU   X'40'                                                  22100018
DATACH     EQU   X'A0'                                                  22200018
SLICC      EQU   X'60'                                                  22300018
SLICCSK    EQU   X'70'                                                  22400018
*                                                                       22500018
*                                                                       22600018
*********************************************************************   22700018
*                                                                       22800018
*                                                                       22900018
KEYS       EQU   X'01'                                                  23000018
QSAM       EQU   X'01'                                                  23100018
*                                                                       23200018
*                                                                       23300018
*********************************************************************   23400018
*                                                                       23500018
GETMAIN    EQU   4                                                      23600018
XCTL       EQU   7                                                      23700018
LOAD       EQU   8                                                      23800018
*                                                                       23900018
*********************************************************************   24000018
*                                                                       24100018
*                                                                       24200018
**********************************************************************  24300018
ASA        EQU   X'04'                                                  24400018
BKREAD     EQU   X'01'                                                  24500018
URBITS   EQU   X'40'                                                    24600018
TAPEB    EQU   X'80'                                                    24700018
DABIT    EQU   X'20'                                                    24800018
WAOFF    EQU   32                                                       24900018
PLOFF    EQU   4                        OFFSET OF DCB ENTRIES           25000018
WGOFF    EQU   8                        OFFSET OF WTG ENTRIES           25100018
*                                                                       25200018
**********************************************************************  25300018
D3525    EQU   X'4C'               3525 DEVICE                  SA53194 25301021
RP       EQU   X'60'               PRT/PCH ASSOC D.S.           SA53194 25302021
RW       EQU   X'50'               RD/PCH ASSOC D.S             SA53194 25303021
PW       EQU   X'30'               RD/PRT ASSOC D.S.            SA53194 25304021
ASSOCDS  EQU   X'04'               3525 ASSOCIATED D.S          SA53194 25304421
SIX      EQU   6                                                 S20201 25305020
NRECREDY EQU   X'20'                                             S20201 25310020
THREE    EQU   3                        CONSTANT OF 3            S20201 25315020
FIVE     EQU   5                        CONSTANT OF 5            S20201 25320020
TWENTY5  EQU   25                       CONSTANT OF 25           S20201 25325020
ABENDISP EQU   17                       OFFSET IN AVT ABE ADDR   S20201 25330020
ADLEN    EQU   3                        ADDR LENGTH              S20201 25335020
ADDISP   EQU   25                       DISP OF LOADS RTRN ADDR  S20201 25340020
STANDF   EQU   X'08'                                             S20201 25345020
SDINDIC  EQU   X'08'                    SEARCH DIRECT INDICATOR  S20201 25350020
TRKOVFL  EQU   X'20'                    TRACK OVERFLOW MASK      S20201 25355020
ZERO     EQU   0                        DISPLACEMENT OF 0        S20201 25360020
D1       EQU   1                        DISPLACEMENT OF 1        S20201 25365020
D5       EQU   5                        DISPLACEMENT OF 5        S20201 25370020
D6       EQU   6                        DISPLACEMENT OF 6        S20201 25375020
D13      EQU   13                       DISPLACEMENT OF 13       S20201 25380020
D17      EQU   17                       DISPLACEMENT OF 17       S20201 25385020
D25      EQU   25                       DISPLACEMENT OF 25       S20201 25390020
TEMPSAVE EQU   24                       OFFSET TO TEMP SAVE ADDR  M5467 25392002
*                                         OF LOADED ROUTINES      M5467 25394002
IDLEN    EQU   2                        LENGTH OF A MODULE ID    Y02072 25396002
         EJECT                                                          25400002
         BALR  RBASE,0                                                  27100018
         USING SLDA,RBASE                                               27200018
         USING IHADCB,RDCB                                              27300018
         USING BLDEB,RDEB                                               27400018
         USING FORCORE,RCORE                                            27500018
*                                                                       27700018
*                                                                       27800018
SLDA     EQU   *                                                        27900018
*                                                                       28000018
         B     BEGIN                    BRANCH AROUND MODULE ID  YM4640 28001002
         DC    C'IGG01917'              MODULE NAME              YM4640 28002002
         DC    C'@ZA28034'              LAST SHIP CODE         @ZA28034 28003037
         DC    C'02/02/78'              LAST SHIP DATE         @ZA28034 28003637
BEGIN    DS    0H                       END OF MODULE ID         YM4640 28005002
*                                                                       28100018
         L     RDCB,0(RPARC)            GET DCB ADDRESS                 28200018
         LA    RDCB,0(RDCB)             CLEAR HI BYTE                   28300018
         L     RDEB,DCBDEBAD            GET DEB ADDRESS                 28400018
         L     RCORE,4(RWTGC)           GET WORK AREA                   28500018
*                                                                       29200021
         MVI   22(RWTG),X'CB'          CHANGE DE ATTR.TO ONLY LOADABLE  30000018
*                                                                       30100018
         L     RTIOT,DEBAPPAD           GET APPENDAGE ADDRESS           30200018
         USING AVT,RTIOT                                                30250001
         SR    RUCB,RUCB                CLEAR REG                       30300018
         SR    RF,RF                    CLEAR RER                       30400018
         IC    RUCB,DEBNMEXT            GET NUMBER OF EXTENTS           30500018
         IC    RF,DEBEXSCL              GET SCALING FACTOR              30600018
         SLL   RUCB,0(RF)               SHIFT ACCORDING TO EXTENT SIZE  30700018
         IC    RF,DEBAMLNG              GET ACCESS METHOD LENGTH        30800018
         LA    RUCB,0(RF,RUCB)          ADD TO POINT TO SUBRT ID FLD    30900018
         LA    RUCB,32(RUCB,RDEB)       ADD BASIC DEB SZ TO DEB AD      31000018
*                                                                       31100018
*  RUCB NOW POINTS TO THE SUBROUTINE ID FIELD IN THE DEB AND MUST  UT18 31200018
*  NOW BE INCREMENTED TO POINT BEYOND THE LAST ENTRY.              UT18 31300018
*                                                                  UT18 31400018
SLDAA    CLI   0(RUCB),X'00'            IS RUCB BEYOND LAST ENTRY  UT18 31500018
         BE    SLDAB                    BR IF YES                  UT18 31600018
         LA    RUCB,2(RUCB)             INCREMENT TO NEXT ID FIELD UT18 31700018
         B     SLDAA                    TEST NEXT FIELD            UT18 31800018
*                                                                  UT18 31900018
*                                                                  UT18 32000018
*                                                                  UT18 32100018
*  RUCB NOW POINTS TO THE NEXT AVAILABLE SUBROUTINE ID FIELD IN    UT18 32200018
*  THE DEB.                                                        UT18 32300018
SLDAB    EQU   *                                                        32400018
*********************************************************************** 33900018
*      GET THE EOB MODULES NEEDED FOR THIS FILE                         34000018
*                                                                       34100018
         TM    DCBDEVT,URBITS           UNIT RECORD DEVICE       A42906 34202021
         BO    SLDAPP01                 YES,BRANCH               A42906 34204021
         TM    JFCBMASK+D6,SDINDIC      SEARCH DIRECT USED       S20201 34208020
         BNO   NOSDOPT                  BRANCH NO                S20201 34216020
         LA    RB,CEAFP                 GET SEARCH DIRECT CE     S20201 34224020
         BAL   RC,SLDROUT               LOAD ROUTINE             S20201 34232020
         ST    RE,AVTCE                 APPENDAGE TABLE ENTRY FOR CE    34240001
         LA    RB,AEOESF                GET END OF EXTENT APPEN  S20201 34272020
         BAL   RC,SLDROUT               LOAD IT IN AND PUT       S20201 34280020
         ST    RE,AVTEOE                APPENDAGE TABLE ENTRY FOR EOE   34288001
         B     SLDAPP17                 AROUND NEXT              Y02072 34304002
*                                                                       34312020
NOSDOPT  EQU   *                                                 S20201 34320020
*                                                                       34384020
         TM    0(RPARC),OUTP            DCB FOR OUTPUT ONLY             34400018
         BO    SLDAPP10                 AROUND NEXT              S20201 34500020
*                                                                       34600018
*  END OF EXTENT  APPENDAGE NEEDED FOR DISK INPUT                       34700018
*                                                                       34800018
         TM    DCBDEVT,X'20'           D.A. DEVICE                      34900018
         BZ    SLDAPP01                NO BRANCH                        35000018
         TM    DCBCIND1,X'40'          SEARCH DIRECT INPUT              35100018
         BNO   LAB04                   NO LOAD CH                S20201 35120020
         TM    JFCBMASK+SIX,NRECREDY    IS IT NON RPS            S20201 35140020
         BO    SLDAPP01                 YES BRANCH AROUND        S20201 35160020
         LA    RB,AEOESF                GET END OF EXTENT        S20201 35180020
*                                       APPENDAGE                S20201 35200020
*                                       FOR STANDARD FIXED              35220020
         B     LAB05                    GO AROUND NEXT           S20201 35240020
*                                                                       35300018
LAB04    EQU   *                                                 S20201 35350020
         LA    RB,AEOE                 GET END OF EXTENT ID             35400018
LAB05    EQU   *                                                 S20201 35450020
         BAL   RC,SLDROUT              LOAD ROUTINE                     35500018
         ST    RE,AVTEOE                APPENDAGE TABLE ENTRY FOR EOE   35600001
*                                                                       35700018
*        LENGTH CHECKING IS REQUIRED FOR DCB                            35800018
*                                                                       35900018
SLDAPP01 EQU   *                                                        36000018
         TM    DCBDEVT,DCBDVTAP         MAG TAPE BEING USED     SA57129 36010002
         BZ    SLDAPP10                 NO, BYPASS DOS/CHKP     SA57129 36020002
         TM    DCBOPTCD,DCBBCKPT        BYPASS DOS CHKPT RCD     Y02072 36050002
         BZ    AROUND                   NO, BRANCH              SA57129 36100002
         LA    RB,DACEV                 GET BYPASS DOS CHKPT RCD S21040 36720021
*                                       V LENGTH APPENDAGE ID           36730021
         TM    DCBRECFM,FORMATF         FORMAT F OR U RCDS       S21040 36740021
         BZ    SLDAPP12                 BRANCH IF NO             S21040 36750021
         LA    RB,DACEUF                BYPASS DOS CHKPT RCD     S21040 36760021
*                                APPEND ID FOR FORMATS U AND F          36770021
         B     SLDAPP12                                          S21040 36780021
*                                                                       36790021
SLDAPP10 EQU   *                                                        36800018
         TM    0(RPARC),OUTP            OUTPUT DCB            @ZA28034  36820037
         BO    SLDAPP14                 YES-NO LENGTH CHECK   @ZA28034  36840037
*                                       APPEN NEEDED.         @ZA28034  36860037
*                                                                       36900018
         TM    JFCBMASK+SIX,NRECREDY    IS IT RECORD READY       S20201 36907020
         BO    AROUND                   NO BRANCH AROUND         S20201 36914020
LAB002   EQU   *                                                 S20201 36921020
         TM    DCBRECFM,FORMATU         FORMAT U RECORDS         S20201 36928020
         BM    LAB03                    NO BRANCH AROUND         S20201 36935020
         TM    DCBRECFM,TRKOVFL         IS IT TRACK OVERFLOW     S20201 36942020
         BO    SLDAPP14                 YES BRANCH TO SLDAPP14   S20201 36949020
         LA    RB,ACEU                  NO GET U FORMAT CHAN END S20201 36956020
         B     SLDAPP12                 LOAD U FORMAT CHAN END   S20201 36963020
LAB03    EQU   *                                                 S20201 36970020
         TM    DCBRECFM,FORMATF         FIXED LENGTH RECS        S20201 36977020
         BO    SLDAPP11                 YES LOAD CI              S20201 36984020
         B     SALADS                   BRANCH FOR V FORMAT      A49371 36986021
AROUND   EQU   *                                                 S20201 36991020
         TM    0(RPARC),OUTP            OPEN FOR OUTPUT ONLY     A49371 36993021
         BO    SLDAPP14                 BRANCH YES -- NO LENGTH- A49371 36995021
*                                       CHECKING APPENDAGE NEEDED       36997021
         TM    DCBRECFM,FORMATU         U RECORDS                       37000018
         BO    SLDAPP14                 YES, BRANCH            @OS73907 37100037
         BM    SALAD                    NO, F OR V RCDS        @OS73907 37110037
         TM    DCBRECFM,FORMATD         D OR T RCDS?           @OS73907 37120037
         BZ    SLDAPP14                 NO, EXIT               @OS73907 37130037
         TM    DCBDEVT,TAPEB            IS IT TAPE             @OS73907 37140037
         BZ    SLDAPP14                 NO, EXIT               @OS73907 37142037
         B     SALADS                   YES, BRANCH            @OS73907 37142437
SALAD    EQU   *                                                 S20038 37150020
         TM    DCBRECFM,FIXEDBLK        FIXED BLKD RECORDS              37200018
         BC    1,SLDAPP11               YES BRANCH                      37300018
         TM    DCBRECFM,FORMATV         VARIABLE RECORDS                37400018
         BC    8,SLDAPP14               NO BRANCH                       37500018
SALADS   EQU   *                                                 S20038 37550020
         LA    RB,ACEV                  GET V LN CKNG APPN.             37600018
         B     SLDAPP12                                                 37700018
SLDAPP11 EQU   *                                                        37800018
         LA    RB,ACEF                  GET F LN CKNG APPN              37900018
SLDAPP12 BAL   RC,SLDROUT               LOAD ROUTINE                    38000018
         ST    RE,AVTCE                 APPENDAGE TABLE ENTRY FOR CE    38100001
         TM    DCBDEVT,DABIT            IS THIS DA               YM5922 38102002
         BZ    SALAD13                  NO, TEST FOR TAPE        YM5922 38104002
         AH    RE,SECENTRY              OFFSET TO ABNOR ENTRY    YM5922 38106002
         B     SLDAPP13                 GO STORE ABNOR ENTRY AD  YM5922 38108002
SALAD13  DS    0H                                                YM5922 38108402
         TM    DCBDEVT,DCBDVTAP         MAG TAPE BEING USED     SA57129 38110002
         BZ    SLDAPP14                 NO, BYPASS DOS/CHKPT    SA57129 38112002
         TM    DCBOPTCD,BYPASS          BYPASS DOS CHKPT RCD     S21040 38120021
         BZ    SLDAPP14                 BRANCH IF NO             S21040 38140021
SLDAPP13 DS    0H                                                YM5922 38190002
         ST    RE,AVTABNE               ABNOR END APP ADDR       YM5922 38192002
SLDAPP14 EQU   *                                                        38200018
* * * * * * *        3525   3505   SUPORT   * * * * * * * * * *         38220021
         CLI   DCBDEVT,X'4C'           IS THIS A 3525            M0062  38240021
         BE    SLDAPP17                YES, BRANCH               M0062  38260021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 38280021
         TM    DCBDEVT,X'48'            PRINTER USED                    38300018
         BC    14,SLDAPP17              NO BRANCH                       38400018
         LA    RB,PSIO                  GET SIO APPNDAGE                38500018
         BAL   RC,SLDROUT               LOAD ROUTINE                    38600018
         ST    RE,AVTSIO                APPENDAGE TABLE ENTRY FOR SIO   38700001
*                                                                       38800018
SLDAPP17 EQU   *                                                        38900018
         BAL   RF,EOBROUT               GET EOB RT ID                   39500018
*                                                                       39600018
         BAL   RC,SLDROUT               LOAD ROUTINE                    39700018
*                                                                       39800018
*                                                                       39900018
*                                                                       40200018
         USING WTGENTRY,RWTGC                                    Y02072 40250002
         MVC   WTGIDTTR,SOP9            ID OF NEXT MOD         @Z30TSCF 40260003
         TM    DCBCIND2,DCBCNQSM       QSAM BEING USED           Y02072 40350002
         BZ    SLDEOB2                 NO BRANCH                 Y02072 40360002
         MVC   DCBEOB+1(3),25(RWTG)    STORE EOB ROUTINE                40400018
         MVC   DCBCNTRL+3(1),DCBCNTRL+1  SETUP FOR QSAM CNTRL TEST      40500018
         TM    DCBDEVT,X'80'           DCB FOR TAPE                     40600018
         BZ    SLDEOB8                 NO BRANCH                        40700018
         B     SLDEOBC                 YES BRANCH                       40800018
*                                                                       40900018
*                                                                       41000018
SLDEOB2  EQU   *                                                        41100018
*                                                                       41200018
         MVC   DCBEOBR+1(3),25(RWTG)  LOAD EOB ADDR IN DCB              41400018
*                                                                       41500018
SLDEOB20 EQU   *                                                        41600018
*                                                                       41700018
         MVC   DCBEOBW+1(3),25(RWTG)  LOAD EOB WRITE ADDR IN DCB        41800018
*                                                                       41900018
*                                                                       42000018
SLDEOB4  EQU   *                                                        42100018
*                                                                       42200018
         BAL   RF,EOBROUT               GET POSSIBLE WRT ROUT (IN/OUT)  42300018
*                                                                       42400018
*                                                                       42500018
         LTR   RC,RC                    DCB FOR IN/OUT                  42600018
         BC    8,SLDEOB6                NO BRANCH                       42700018
*                                                                       42800018
         BAL   RC,SLDROUT               LOAD WRT EOB RT.                42900018
*                                                                       43000018
         MVC   DCBEOBW+1(3),25(RWTG)  LOAD EOB WRITE ADDR.IN DCB        43100018
*                                                                       43200018
*                                                                       43300018
SLDEOB6  EQU   *                                                        43400018
*                                                                       43500018
         BAL   RF,EOBROUT               IS NOTE/POINT USED              43600018
*                                                                       43700018
         LTR   RC,RC                    TEST FOR ITS ID                 43800018
         BP    SLDEOB9                 YES BRANCH                       43900018
*                                                                       44000018
SLDEOB8  EQU   *                                                        44100018
*                                                                       44200018
         BAL   RF,EOBROUT               GET POSSIBLE CNTRL RT ID        44300018
         LTR   RC,RC                    IS THERE A CNTRL ID             44400018
         BC    8,SLDEOBC                NO BRANCH                       44500018
*                                                                       44600018
SLDEOB9  BAL   RC,SLDROUT              LOAD NOTE/POINT OR CONTROL       44700018
         CLC   DUMY(2),0(RB)            DUMMY CONTROL MODULE      M5467 44750002
         BNE   SLDEOB10                 NO, BR AROUND             M5467 44760002
         AH    RE,CNTOFSET              GET ADDR OF CNTRL ENT PT  M5467 44770002
         ST    RE,TEMPSAVE(RWTG)        TEMP SAVE ADDR            M5467 44780002
SLDEOB10 EQU   *                        NOT DUMMY                 M5467 44790002
         MVC   DCBCNTRL+1(3),25(RWTG)  STORE N/P OR CNTRL ADDR. IN DCB  44800018
         B     SLDEOBE                                                  44900018
*                                                                       45000018
SLDEOBC  EQU   *                                                        45100018
         XC    DCBCNTRL(4),DCBCNTRL     CLEAR PARA LIST                 45200018
         OI    DCBCNTRL+3,X'01'         SET VECTOR  TO  ONE             45300018
*                                                                       45400018
SLDEOBE  EQU   *                        END.                            45500018
         MVC    DCBEROPT(1),DXCCW6      REPLACE QSAM ERROR OPTIONS      45600018
*                                                                       45700018
*                                                                       45800018
*********************************************************************** 45900018
*                                                                       46000018
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURR WTG ENTRY        46100018
         LA    RPARC,PLOFF(0,RPARC)     INCR CURRENT DCB ENTRY PRTR     46200018
         CLC   0(2,RWTGC),AMIDCNST      THIS RT NEEDED AGAIN            46300018
         BCR   8,RBASE                                                  46400018
*                                                                       46500018
         CLC   0(2,RWTGC),OPIDCNST      END OF TABLE                    46600018
         BC    7,RELOOP                 NO,CHECK NEXT ENTRY             46700018
*                                                                       46800018
         LR    RPARC,RPAR                                               46900018
         LA    RWTGC,WAOFF(0,RWTG)      REINITIALIZE WTG LIST PTR       47000018
ZCHEK    CLI   0(RWTGC),X'00'          IS THIS ENTRY COMPLETE           47100018
         BC    7,TCTLRTN                IF NOT TRANSFER CONTROL         47200018
*                                                                       47300018
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY                  47400018
         LA    RPARC,PLOFF(0,RPARC)                                     47500018
         BC    15,ZCHEK                                                 47600018
*                                                                       47700018
TCTLRTN  EQU   *                                                        47800018
         USING WTG,RWTG                                                 47850003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*47900003
               MODID=WTGENTRY                                  @Z30TSCF 47950003
         DROP  RWTGC,RWTG                                      @Z30TSCF 48000003
*                                                                       48500018
*                                                                       48600018
*                                                                       48700018
SLDROUT  EQU   *                                                        48800018
         USING WTGMODNM,RWTG                                     Y02072 48850002
         MVC   WTGMODID,0(RB)           ID TO MOD NAME           Y02072 48900002
         DROP  RWTG                                              Y02072 48950002
         L     R1,CVTPTR                LOAD CVT ADDRESS         YM1140 49000002
         USING CVT,R1                   CVT ADDRESSABILITY       YM1140 49050002
         L     R1,CVTLINK               GET LPALIB DCB ADDRESS   YM1140 49100002
         DROP  R1                       DROP CVT BASE            YM1140 49150002
*                                                                       49200002
         LOAD  EPLOC=(RWTG),DCB=(1)                              YM1140 50100002
*                                                                       50200018
*                                                                       50300018
*                                                                       50400018
         ST    RE,24(RWTG)             TEMP STORE OF ROUTINE ADDR,      50500018
SLDROUT1 MVC   0(2,RUCB),0(RB)          STORE ROUTINES ID IN DEB        50600018
         LA    RUCB,2(RUCB)             UPDATE SUBRT PNTR               50700018
         SR    RD,RD                    CLEAR REG                       50800018
         IC    RD,DEBNMSUB              GET NO.OF SUBRTS LOADED SO FAR  50900018
         LA    RD,1(RD)                 ONE MORE SUB RT LOADED          51000018
         STC   RD,DEBNMSUB              STORE NEW TOTAL SUBRTS LOADED   51100018
         BR    RC                      RETURN                           51200018
*                                                                       51300018
*                                                                       51400018
*********************************************************************** 51500018
*                                                                       51600018
*                                                                       51700018
*********************************************************************** 51800018
*                                                                       51900018
EOBROUT  EQU   *                                                        52000018
*                                                                       52100018
         SR    RC,RC                                                    52200018
         LA    RE,EOBTABL               GET TABLE OF NAMES              52300018
         LA    RB,IDLEN                 LEN OF MODULE ID         Y02072 52400002
         IC    RC,DCBCNTRL+3            GET ID NO. DEVICE DEP.          52500018
         L     RJ,DCBCNTRL              SHIFT IDS RIGHT BY ONE BYTE     52600018
         SRL   RJ,8                                                     52700018
         ST    RJ,DCBCNTRL                                              52800018
         MR    RB,RB                    CALCULATE WHERE ID IS           52900018
         LR    RB,RC                    PREPARE TO LOAD  MODULE         53000018
         AR    RB,RE                    POINT TO CORRECT ID             53100018
         BR    RF                       RETURN                          53200018
*                                                                       53300018
*********************************************************************** 53400018
*                                                                       53500018
CNTOFSET DC    H'24'                    OFFSET OF CONTROL ROUTINE M5467 53550002
*                                         IN DUMMY MODULE         M5467 53560002
SECENTRY DC    H'4'                     OFFSET TO ABNORMAL END   YM5922 53570002
*                                         ENTRY IN APPENDAGE     YM5922 53580002
OPIDCNST DC    C'0S'                                                    53600018
AMIDCNST DC    C'17'                    ID OF THIS MODULE          UT18 54500018
SOP9     DC    C'11',VL3(IGG01911)  IGGO1911 OR IECOS90X -QSAM @Z30TSCF 57000003
*                                                                       57050002
*        BELOW ARE THE SHARABLE ROUTINES USED BY BSAM / QSAM            57600018
*                                                                       57800018
*                                                                       57900018
*        APPENDAGES USED BY BSAM AND QSAM   ---------------------       58000018
*                                                                       58100018
*                                                                       58200018
AEOE     DC    C'CH'                    END OF EXTENT APPNDG NON-SF-INP 58300018
ACEF     DC    C'CI'                    CHANNEL END APPNDG LEN CHK FREC 58600018
ACEV     DC    C'CJ'                    CHANNEL END APPNDG LEN CHK VREC 58900018
PSIO     DC    C'CL'                    APPENDAGE FOR PRINTERS SIO      59500018
DACEUF   DC    C'EI'                    CHANNEL/ABNORMAL END     S21040 59810021
*                                       APPNDG TO                S21040 59820021
*                                       BYPASS DOS CHKPT RCDS. U,F RCD  59830021
DACEV    DC    C'EJ'                    CHANNEL/ABNORMAL END     S21040 59850021
*                                       APPNDG TO                S21040 59860021
*                                       BYPASS DOS CHKPT RCDS, V RCDS   59870021
*                                                                       59890021
*                                                                       59900018
*********************************************************************** 60000018
*                                                                       60100018
*        DEVICE DEPENDENT ROUTINES SUPPORTED                            60200018
*                                                                       60300018
EOBTABL  EQU   *                                                        60400018
         DC    C'  '                                                    60500002
EPD2     DC    C'CD'                    EOB RT DISK-OUTP/STANDRF INP    60700002
EGP2     DC    C'CC'                    EOB RT. DISK-TP-RDR. INP/OUTP.  60800002
DDA2     DC    C'CE'                    EOB RT. PRNTR/PUNCH NORMAL      60900002
DDB2     DC    C'CF'                    EOB RT. PRNTR/PUNCH ASA         61000002
NPD2     DC    C'BC'                    NOTE-POINT DISK                 61100002
NPT2     DC    C'BD'                    NOTE-POINT TAPE                 61200002
CNT1     DC    C'CA'                    CNTRL RT READER                 61300002
CNT2     DC    C'CB'                    CNTRL RT. PRINTER               61400002
CNT3     DC    C'BE'                    CNTRL RT. TAPE                  61500002
DUMY     DC    C'AV'                   DUMMY PUT/NOP ROUTINE            61600002
OVRD     DC    C'CT'                    OPEN OVERRIDE ERROR RTN   OC034 61700002
UTF1     DC    C'TD'                    USER TOTALLING EOB ROUTINE UT18 61800002
UTF2     DC    C'TC'                    USER TOTALLING EOB ROUTINE UT18 61900002
UTF3     DC    C'TV'                    USER TOTALLING EOB ROUTINE UT18 62000002
UTF4     DC    C'TW'                    USER TOTALLING EOB ROUTINE UT18 62100002
UTF5     DC    C'T2'                    USER TOTALLING EOB ROUTINE UT18 62200002
ACEU     DC    C'C0'                    CHANNEL END FOR FORMAT U S20201 62310002
AEOESF   DC    C'C4'                    SF INPUT END OF EXT      S20201 62320002
         DC    C'  '                    FILLER FOR IGG019FN      YM2507 62330002
CEAFP    DC    C'FP'                    SEARCH DIRECT CHANNEL    S20201 62340002
DDC2     DC    C'FK'                    EOB RT. DATA PROTECTION   M0062 62342002
DDD2     DC    C'FQ'                    EOB RT. PRT FOR 3525 DEV  M0062 62344002
DDE2     DC    C'FU'                    EOB RT. 3525 INTRPRT FILE M0062 62346002
CNT4     DC    C'FA'                    CNTRL RT. 3525 DEV        M0062 62348002
OCRCNTRL DC    C'LT'                    CNTRL RTNE FOR 3886 OCR XL03127 62348402
         SPACE                                                          62398402
PATCH    DC    25H'0'                   PATCH AREA               YM4640 62450002
END      EQU   *                        END OF MODULE            Y02072 62500002
         TITLE 'IGG01917 - FORMAT OF GOTTEN CORE'                       63000002
         IECDSECS  MAIN,WTG,PREFX,EXPAND=YES                   @Z30TSCF 63050003
         ORG   WTGIDTTR                                          Y02072 63100002
WTGID    DS    CL2                      NEXT MOD ID              Y02072 63150002
*                                                                       63300018
*                                                                       63400018
CVT      DSECT                                                          63500018
         CVT                                                            63600018
*                                                                       63700018
AVT      DSECT                          APPENDAGE VECTOR TABLE          63706001
AVTEOEPG DS    0CL1                     NO.PAGES MODULE REQUIRES        63712001
AVTEOE   DS    A                        ADDR OF END OF EXTENT           63718001
*                                       APPENDAGE                       63724001
AVTSIOPG DS    0CL1                     NO.PAGES MODULE REQUIRES        63730001
AVTSIO   DS    A                        ADDR OF START I/O               63736001
*                                       APPENDAGE                       63742001
AVTPCIPG DS    0CL1                     NO.PAGES MODULE REQUIRES        63748001
AVTPCI   DS    A                        ADDR OF PCI APPENDAGE           63754001
AVTCEPG  DS    0CL1                     NO.PAGES MODULE REQUIRES        63760001
AVTCE    DS    A                        ADDR OF CHANNEL END             63766001
*                                       APPENDAGE                       63772001
AVTABNPG DS    0CL1                     NO.PAGES MODULE REQUIRES        63778001
AVTABNE  DS    A                        ADDR OF ABNORMAL END            63784001
*                                       APPENDAGE                       63790001
*                                                                       63800018
BLDEB    DSECT                                                          63900018
DEB      DS    0F                                                       64000018
DEBNMSUB DS    0CL1                                                     64100018
DEBTCBAD DS    CL4                                                      64200018
DEBAMLNG DS    0CL1                                                     64300018
DEBDEBAD DS    CL4                                                      64400018
DEBOGLGS DS    0CL1                                                     64500018
DEBIRBAD DS    CL4                                                      64600018
DEBOPATB DS    0CL1                                                     64700018
DEBSYSPG DS    CL4                                                      64800018
DEBNMEXT DS    0CL1                                                     64900018
DEBUSRPG DS    CL4                                                      65000018
DEBPRIOR DS    0CL1                                                     65100018
DEBECBAD DS    CL4                                                      65200018
DEBPROTG DS    0CL1                                                     65300018
DEBDEBID DS    0CL1                                                     65400018
DEBDCBAD DS    CL4                                                      65500018
DEBEXSCL DS    0CL1                                                     65600018
DEBAPPAD DS    CL4                                                      65700018
DEBDVMOD DS    0CL1                                                     65800018
DEBUCBAD DS    CL4                                                      65900018
DEBBINUM DS    CL2                                                      66000018
DEBSTRCC DS    CL2                                                      66100018
DEBSTRHH DS    CL2                                                      66200018
DEBENDCC DS    CL2                                                      66300018
DEBENDHH DS    CL2                                                      66400018
DEBNMTRK DS    CL2                                                      66500018
*                                                                       66600018
           DCBD  DSORG=PS                                               66700018
DCBDVTAP EQU   X'80'                    DEVICE CLASS FOR MG TAP SA57129 66702002
         IKJTCB                                                         66710001
           END                                                          67100018
