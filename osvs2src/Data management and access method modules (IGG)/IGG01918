 TITLE 'IGG01918 - SAM OPEN EXECUTOR (SECOND HALF OF IGG01912)'    UT18 00100018
IGG01918 CSECT                                                          00102003
*MODULE NAME - IGG01918                                          Y02072 00110002
*                                                                       00120002
*DESCRIPTIVE NAME - LOAD ACCESS METHOD ROUTINES                  Y02072 00130002
*                                                                       00140002
*COPYRIGHT - NONE                                                Y02072 00142002
*                                                                       00144002
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00146002
*                                                                       00148002
*          VS 2 RELEASE 2 DELETIONS                              Y02072 00150002
*001500,011000,027000,059000,307500,308500-309700,376000,405000, Y02072 00160002
*576000-577000,437000-438000,448000-457000,494000-507000         Y02072 00170002
*                                                                YM1140 00220002
*                                                                YM4640 00220102
*                                                                       00270103
*          VS2 RELEASE 3 DELETIONS                                      00280103
*                                                              @Z30TSCF 00290103
*          RELEASE 20 DELETIONS                                         00300018
*0892339500-340000                                               M6184  00310020
*0892339000-342000                                               A39226 00320020
*0892314000-316000                                               A32160 00350020
*          RELEASE 21 DELETIONS                                         00400018
*                                                                       00500002
*STATUS CHANGE LEVEL 004                                                01100002
*                                                                       01200018
*FUNCTION/OPERATION - THIS MODULE IS A CONTINUATION OF MODULE      UT18 01300018
*      IGG01912 AND LOADS THE REMAINING I/O MODULES.  WHAT IS TO   UT18 01400018
*      BE LOADED IS DETERMINED FROM THE CODES IN THE DCBCNTRL      UT18 01500018
*      FIELD WHICH WAS SET BY PREVIOUS LOADS OF THE OPEN EXECUTORS.UT18 01600018
*      IT WILL BRING IN THE APPROPRIATE END-OF-BLOCK(EOB) ROUTINE       01700018
*                                                                       01800018
*ENTRY POINTS - ENTERED ONLY FROM IGG01912 BY USE OF XCTL MACRO    UT18 01900018
*                                                                       02000018
*INPUT: SEE DESCRIPTION OF REGISTERS, DCB(USERS)                        02100018
*                                                                       02200018
*OUTPUT: DCB(USERS),IOB(USERS).                                         02300018
*                                                                       02400018
*EXTERNAL ROUTINES: NONE.                                               02500018
*                                                                       02600018
*EXITS-NORMAL: XCTL TO IGG01911(IECOSOP9)                        Y02072 02700002
*                                                                       02800018
*EXITS-ERROR: NONE.                                                     02900018
*                                                                       02950002
*MACROS - ACTION: XCTL, LOAD, IECDSECS(MAIN,WTG), DCBD, CVT      Y02072 02960002
*                                                                       03000018
*TABLES/WORKAREAS - WHERE TO GO TABLE (WTG)                             03100018
*                                                                       03200018
*      BYTE 0-7    NAME                                                 03300018
*      BYTE 8-10   RELATIVE DISK ADDRESS (TTR) OF FIRST RECORD          03400018
*      BYTE 11     CONCATENATION NUMBER                                 03500018
*      BYTE 12     ZERO                                                 03600018
*      BYTE 13     ALIAS INDICATOR AND USER DATA FIELD DESCRIPTOR.      03700018
*                       ALIAS INDICATOR 1 BIT                           03800018
*                       NUMBER OF TTRS IN USERS DATA FIELD 2 BITS       03900018
*      BYTE 14-16  TTR OF FIRST TEXT RECORD                             04000018
*      BYTE 17     ZERO                                                 04100018
*      BYTE 18-19  TTR OF NOTE LIST OR SCATTER LIST                     04200018
*      BYTE 20     TRANSLATION TABLE                                    04300018
*      BYTE 21     ZERO OR NUMBER OF ENTRIES IN THE NOTE LIST           04400018
*      BYTE 22-23  ATTRIBUTES                                           04500018
*      BYTE 24-26  TOTAL CONTIGUOUS MAIN STORAGE REQUIRED FOR MODULE    04600018
*      BYTE 27-28  LENGTH OF FIRST TEXT RECORD                          04700018
*      BYTE 29     LENGTH OF WTG TABLE (IN DOUBLE WORDS)                04800018
*      BYTE 30-31  PATH THROUGH LOADS OF ROUTINES                       04900018
*      BYTE 32-36 IDTTR OF EXECUTOR FOR FIRST DCB                       05000018
*      BYTE 37-39 WORKAREA ADDRESS FOR FIRST DCB                        05100018
*      BYTE 40-   TABLE OF IDTTR'S                                      05200018
*      BYTE 32+N(8) IDTTR OF EXECUTOR FOR N TH DCB   (5 BYTES)          05300018
*                   WORKAREA ADDRESS FOR N TH DCB    (3 BYTES)          05400018
*                   IDTTR OF LAST ROUTINE LOAD       (5 BYTES)          05500018
*                   NOT USED                         (3 BYTES)          05600018
*********************************************************************** 05700018
*                                                                       05800018
*ATTRIBUTES: REENTRANT, REUSABLE, RUNS IN DATA MANAGEMENT KEY    Y02072 05900002
*            AND SUPERVISOR STATE                                Y02072 05950002
*                                                                       06000018
*NOTES  THIS ROUTINE HAS A LIST OF ALL BSAM, QSAM MODULES SUPPORTED     06100018
*      FOR PAPER TAPE AND UPDATE.                                       06200018
*                                                                       06300018
*********************************************************************** 06400018
*                                                                       06500018
*                                                                       06600018
*  REGISTER CONVENTIONS USED THROUGH OUT ALL OPEN PASSES                06700018
*                                                                       06800018
*********************************************************************** 06900018
*                                                                       07000018
RE       EQU   0         WORK REG5                                      07050002
RF       EQU   1         WORK REG6                                      07060002
R1       EQU   RF        PARM REG                                YM1140 07070002
RDCB     EQU   2         DCB REGISTER                                   07100018
RBASE    EQU   3         BASE REGISTER                                  07200018
RCORE    EQU   4         WORK AREA ADDRESS                              07300018
RPAR     EQU   5         TOP OF PARAMETER LIST                          07400018
RWTG     EQU   6         TOP OF WTG TABLE                               07500018
RPARC    EQU   7         CURRENT PARAMETER                              07600018
RWTGC    EQU   8         CURRENT TRANS LOAD                             07700018
RTIOT    EQU   9         USED HERE AS WRK REG AND  COMM VECTOR ADDR.    07800018
RUCB     EQU   10        USED HERE AS A COUNTER IN IOB GENERATION       07900018
RDEB     EQU   11        DEB ADDRESS                                    08000018
RB       EQU   12        WORK REG1  **                                  08100018
RC       EQU   13        WORK REG2  **                                  08200018
RD       EQU   14        WORK REG3  **                                  08300018
RJ       EQU   15        WORK REG4                                      08400018
*                                                                       08700018
*                                                                       08800018
PARAR    EQU   RPARC                                                    08900018
*                                                                       09000018
*********************************************************************** 09100018
*                                                                       09200018
*********************************************************************** 09300018
*                                                                       09400018
* MASK'S TO TEST PARAMETER LIST WITH                                    09500018
*                                                                       09600018
*********************************************************************   09700018
INP      EQU   X'0F'                                                    09800018
OUTP       EQU   X'0F'                                                  09900018
UPDATE     EQU   X'04'                                                  10000018
INOUT      EQU   X'03'                                                  10100018
OUTIN      EQU   X'07'                                                  10200018
RDBACK     EQU   X'01'                                                  10300018
INPRDBK  EQU   X'0E'               MASK TO CK INPUT AND RDBACK     UT18 10400018
*                                                                       10500018
*                                                                       10600018
*********************************************************************   10700018
*                                                                       10800018
*                                                                       10900018
* OFFSET FOR PARAMETER TESTS                                            11000018
*                                                                       11100018
ONE        EQU   X'01'                                                  11200018
FRTYATE    EQU   48                                                     11300018
DISPSN     EQU   X'0'                                                   11400018
*                                                                       11500018
*                                                                       11600018
*********************************************************************   11700018
*                                                                       11800018
* OFFSETS FOR DEB REFERENCE                                             11900018
*                                                                       12000018
*                                                                       12100018
BIN      EQU   36                                                       12200018
BEXT     EQU   38                                                       12300018
*                                                                       12400018
*                                                                       12500018
*                                                                       12600018
*********************************************************************   12700018
*                                                                       12800018
* MASK'S USED TO TEST OPTION FIELDS IN DCB                              12900018
*                                                                       13000018
*                                                                       13100018
*                                                                       13200018
DOUBLE     EQU   X'01'                                                  13300018
*                                                                       13400018
*                                                                       13500018
STOWB      EQU   X'80'                                                  13600018
WRTCK      EQU   X'80'                                                  13700018
OVRFLO     EQU   X'20'                                                  13800018
PCI        EQU   X'20'                                                  13900018
MINKEY     EQU   X'01'                                                  14000018
CONCAT     EQU   X'FF'                                                  14100018
UPDATEB  EQU   X'80'                                                    14200018
OVFLBIT  EQU   X'20'                                                    14300018
UTFMASK  EQU   X'02'                    MASK FOR TOTALING FACILITY UT18 14400018
*                                                                       14500018
*********************************************************************   14600018
*                                                                       14700018
* MASKS FOR ACCESS METHODS IN SAM                                       14800018
*                                                                       14900018
QSAMB      EQU   X'01'                                                  15000018
BSAMBIT    EQU   X'00'                                                  15100018
PAM        EQU   X'02'                                                  15200018
*                                                                       15300018
*                                                                       15400018
* MASKS FOR MACRO'S TO BE USED                                          15500018
*                                                                       15600018
GETB       EQU   X'40'                                                  15700018
PUTB       EQU   X'40'                                                  15800018
READB      EQU   X'20'                                                  15900018
WRITEB     EQU   X'20'                                                  16000018
POINTB     EQU   X'04'                                                  16100018
CNTRLB     EQU   X'02'                                                  16200018
*                                                                       16300018
*                                                                       16400018
*********************************************************************   16500018
*                                                                       16600018
* MASKS FOR DEVICES TO BE SUPPORTED                                     16700018
*                                                                       16800018
*                                                                       16900018
*                                                                       17000018
*********************************************************************   17100018
*                                                                       17200018
*                                                                       17300018
*                                                                       17400018
*                                                                       17500018
*********************************************************************   17600018
*                                                                       17700018
* MASKS FOR STATUS BITS TO BE TESTED                                    17800018
*                                                                       17900018
*                                                                       18000018
EXCPN      EQU   X'30'                                                  18100018
COMPLETE   EQU   X'80'                                                  18200018
FIRSTIOB   EQU   X'01'                                                  18300018
*                                                                       18400018
*                                                                       18500018
*                                                                       18600018
*********************************************************************   18700018
*                                                                       18800018
* MASKS FOR BUFFER TECHNIQUE'S                                          18900018
*                                                                       19000018
CYCLICB    EQU   X'20'                                                  19100018
EXCHANGB   EQU   X'10'                                                  19200018
SIMPLEB    EQU   X'40'                                                  19300018
EXCHCYCL   EQU   X'30'                                                  19400018
*                                                                       19500018
*********************************************************************   19600018
*                                                                       19700018
*                                                                       19800018
* MODES OF OPERATION FOR QSAM                                           19900018
*                                                                       20000018
LOCATEB    EQU   X'08'                                                  20100018
MOVEB      EQU   X'10'                                                  20200018
SUBSTUTB   EQU   X'04'                                                  20300018
*                                                                       20400018
*                                                                       20500018
*********************************************************************   20600018
*                                                                       20700018
*                                                                       20800018
* COMMAND BYTES FOR THE 2841                                            20900018
*                                                                       21000018
*       CONTROL UNIT                                                    21100018
*                                                                       21200018
*                                                                       21300018
*                                                                       21400018
SRCHE      EQU   X'31'                                                  21500018
WRTCKD     EQU   X'1D'                                                  21600018
RDC        EQU   X'92'                                                  21700018
RDKD       EQU   X'8E'                                                  21800018
RDD        EQU   X'86'                                                  21900018
TIC        EQU   X'08'                                                  22000018
*                                                                       22100018
*                                                                       22200018
*********************************************************************   22300018
*                                                                       22400018
*                                                                       22500018
* MASKS FOR RECORD FORMATS                                              22600018
*                                                                       22700018
*                                                                       22800018
STANDRDF   EQU   X'08'                                                  22900018
FORMATU    EQU   X'C0'                                                  23000018
FORMATF    EQU   X'80'                                                  23100018
FORMATV    EQU   X'40'                                                  23200018
BLOCKED    EQU   X'10'                                                  23300018
FIXEDBLK   EQU   X'90'                                                  23400018
TRANS    EQU   X'7E'                    TRANSLATE MODE MASK.            23500018
*                                                                       23600018
*                                                                       23700018
*********************************************************************   23800018
*                                                                       23900018
*                                                                       24000018
*   CHANNEL CONTROL WORD FLAGS                                          24100018
*                                                                       24200018
SKIP       EQU   X'10'                                                  24300018
SLI        EQU   X'20'                                                  24400018
CC         EQU   X'40'                                                  24500018
DATACH     EQU   X'A0'                                                  24600018
SLICC      EQU   X'60'                                                  24700018
SLICCSK    EQU   X'70'                                                  24800018
*                                                                       24900018
*                                                                       25000018
*********************************************************************   25100018
*                                                                       25200018
*                                                                       25300018
KEYS       EQU   X'01'                                                  25400018
QSAM       EQU   X'01'                                                  25500018
*                                                                       25600018
*                                                                       25700018
*********************************************************************   25800018
*                                                                       25900018
GETMAIN    EQU   4                                                      26000018
XCTL       EQU   7                                                      26100018
LOAD       EQU   8                                                      26200018
*                                                                       26300018
*********************************************************************   26400018
*                                                                       26500018
*                                                                       26600018
**********************************************************************  26700018
ASA        EQU   X'04'                                                  26800018
BKREAD     EQU   X'01'                                                  26900018
URBITS   EQU   X'40'                                                    27000018
TAPEB    EQU   X'80'                                                    27100018
DABIT    EQU   X'20'                                                    27200018
WAOFF    EQU   32                                                       27300018
PLOFF    EQU   4                        OFFSET OF DCB ENTRIES           27400018
WGOFF    EQU   8                        OFFSET OF WTG ENTRIES           27500018
IDLEN    EQU   2                        LENGTH OF MODULE ID      Y02072 27550002
*                                                                       27600018
**********************************************************************  27700018
*                                                                       27800018
**********************************************************************  27900018
*                                                                       28000018
*                                                                       28100018
*                                                                       28200018
*                                                                       28400018
*                                                                       28500018
*                                                                       28600018
*                                                                       28700018
*                                                                       28800018
*                                                                       28900018
*                                                                       29000018
*                                                                       29100018
*                                                                       29200018
*                                                                       29300018
*                                                                       29400018
         BALR  RBASE,0                                                  29500018
         USING SLDA,RBASE                                               29600018
         USING IHADCB,RDCB                                              29700018
         USING BLDEB,RDEB                                               29800018
         USING FORCORE,RCORE                                            29900018
*                                                                       30100018
*                                                                       30200018
SLDA     EQU   *                                                        30300018
*                                                                       30400018
         B     BEGIN                    BRANCH AROUND MODULE ID  YM4640 30405002
         DC    C'IGG01918'              MODULE NAME              YM4640 30410002
         DC    C'@Z30TSCF'              LAST SHIP CODE         @Z30TSCF 30415003
         DC    C'10/24/74'              LAST SHIP DATE         @Z30TSCF 30420003
BEGIN    DS    0H                       END OF MODULE ID         YM4640 30425002
*                                                                       30500018
         L     RDCB,0(RPARC)            GET DCB ADDRESS                 30600018
         LA    RDCB,0(RDCB)             CLEAR HI BYTE                   30700018
         L     RDEB,DCBDEBAD            GET DEB ADDRESS                 30800018
         USING WTGENTRY,RWTGC                                    Y02072 30850002
         L     RCORE,WTGCORE-1          GET WORK AREA ADDR       Y02072 30900002
         DROP  RWTGC                                             Y02072 30950002
*                                                                 OC034 31000018
*   THIS SECTION OF CODE UP TO THE LABEL ENDOVR WILL ENSURE THAT  OC034 31100018
*   THE EOB ROUTINE IGG019CT GETS LOADED FOR ANY OPEN OVERRIDE.   OC034 31200018
         TM    JFCBMASK+6,X'C0'         WAS AN OVERRIDE USED      OC034 31300018
         BNO   ENDOVR                   BR IF NO                 A32160 31400020
         TM    0(RPARC),X'0F'           WAS IT LABEL=(,,,IN)     A32160 31500020
         BZ    INCHNG                   BR IF YES                A32160 31600020
         MVC   DCBCNTRL+2(1),DCBCNTRL+3 SAVE WRITE EOB DISP       OC034 31700018
         MVI   DCBCNTRL+3,X'0B'         SET READ EOB ROUTINE FOR  OC034 31800018
*                                       THE ERROR EOB ROUTINE     OC034 31900018
         B     ENDOVR                   CONTINUE                  OC034 32000018
INCHNG   MVI   DCBCNTRL+2,X'0B'         SET WRITE EOB ROUTINE FOR OC034 32100018
*                                       THE ERROR EOB ROUTINE     OC034 32200018
ENDOVR   EQU   *                        CONTINUE                  OC034 32300018
         MVI   22(RWTG),X'CB'           CHANGE ATTRIBUTES TO ONLY LOAD  32400018
*                                                                       32500018
         L     RTIOT,DEBAPPAD           GET APPENDAGE ADDRESS           32600018
         SR    RUCB,RUCB                CLEAR REG                       32700018
         SR    RF,RF                   CLEAR REG                        32800018
         IC    RUCB,DEBNMEXT            GET NUMBER OF EXTENTS           32900018
         IC    RF,DEBEXSCL              GET SCALING FACTOR              33000018
         SLL   RUCB,0(RF)               SHIFT ACCORDING TO EXTENT SIZE  33100018
         IC    RF,DEBAMLNG              GET ACCESS METHOD LENGTH        33200018
         LA    RUCB,0(RF,RUCB)          ADD TO POINT TO SUBRT ID FLD    33300018
         LA    RUCB,32(RUCB,RDEB)       ADD BASIC DEB SZ TO DEB AD      33400018
*                                                                       33500018
*  RUCB NOW POINTS TO THE SUBROUTINE ID FIELD IN THE DEB AND MUST  UT18 33600018
*  NOW BE INCREMENTED TO POINT BEYOND THE LAST ENTRY.              UT18 33700018
*                                                                  UT18 33800018
SLDAA    SR    RF,RF                    CLEAR REG                A39226 33850020
*                                       A3922                    A39226 33900020
         IC    RF,0(RDEB)              GET NO. OF SUBROUTINES    M6184  33970020
         SLL   RF,1                     MULTIPLY BY TWO          A39226 34050020
*                                       A3922                    A39226 34100020
         AR    RUCB,RF                  ADD TO SUBID POINTER     A39226 34150020
*                                       A3922                    A39226 34200020
*                                                                  UT18 34300018
*  RUCB NOW POINTS TO THE NEXT AVAILABLE SUBROUTINE ID FIELD IN    UT18 34400018
*  THE DEB.                                                        UT18 34500018
SLDAB    EQU   *                                                        34600018
*                                                                  UT18 34700018
*  IF USER TOTALING IS TO BE USED, EOB ROUTINES WHICH CONTAIN THE  UT18 34800018
*  TOTALING LINKAGE MUST BE LOADED INSTEAD OF THE NORMAL EOB RTNS. UT18 34900018
*  THIS IS ACCOMPLISHED BY DOING A TRANSLATE OF THE DCBCNTRL FIELD UT18 35000018
*  TO CONVERT NORMAL EOB DISPLACEMENTS INTO DISPLACEMENTS FOR THE  UT18 35100018
*  UTF EOB ROUTINES.                                               UT18 35200018
*                                                                       35300018
         TM    DCBOPTCD,UTFMASK         TEST FOR TOTALING OPTION   UT18 35400018
         BZ    SLDAC                    BR IF NOT SPECIFIED        UT18 35500018
         TM    0(RPARC),INPRDBK         IS OPEN FOR INPUT/RDBACK   UT18 35600018
         BZ    SLDAC                    IF YES, NO TOTALING REQ'D  UT18 35700018
         TR    DCBCNTRL(4),UTFTBL       CHANGE TO UTF DISPLACEMENT UT18 35800018
SLDAC    EQU   *                                                   UT18 35900018
*                                                                  UT18 36000018
*                                                                       36100018
*                                                                       36200018
*                                                                       36300018
*                                                                       36400018
*                                                                       36500018
*THIS SECTION LOADS MODULES NEEDED BY EITHER PAPER TAPE OR UPDATE       36600018
*                                                                       36700018
         BAL   RF,EOBROUT               GET EOB RT ID                   36800018
*                                                                       36900018
         BAL   RC,SLDROUT               LOAD ROUTINE                    37000018
*                                                                       37100018
         USING WTGENTRY,RWTGC                                    Y02072 37150002
         MVC   WTGIDTTR,SOP9            IDTTR OF NEXT MOD      @Z30TSCF 37160003
*                                                                       37200018
         TM    DCBCIND2,QSAMB           QSAM BEING USED                 37300018
         BO    SLDEOB8                  YES,BRANCH                      37400018
*                                                                       37500018
*                                                                       37700018
SLDEOB2  EQU   *                                                        37800018
*                                                                       37900018
*                                                                       38000018
         MVC   DCBEOBR+1(3),25(RWTG)    STORE ADDRESS                   38100018
*                                                                       38200018
*                                                                       38300018
         MVC   DCBEOBW+1(3),25(RWTG)    STORE ADDRESS                   38400018
*                                                                       38500018
*                                                                       38600018
SLDEOB4  EQU   *                                                        38700018
*                                                                       38800018
         BAL   RF,EOBROUT               GET POSSIBLE WRT ROUT (IN/OUT)  38900018
*                                                                       39000018
*                                                                       39100018
*                                                                       39200018
SLDEOB6  EQU   *                                                        39300018
*                                                                       39400018
         BAL   RF,EOBROUT               IS NOTE/POINT USED              39500018
*                                                                       39600018
         LTR   RC,RC                    TEST FOR ITS ID                 39700018
         BC    8,SLDEOBC                NO,BRANCH                       39800018
*                                                                       39900018
         BAL   RC,SLDROUT               LOAD NOTE/POINT ROUTINE         40000018
         MVC   DCBCNTRL+1(3),25(RWTG)   STORE NOTE/POINT ADDRESS        40100018
         B     SLDEOBE                                                  40200018
*                                                                       40300018
SLDEOB8  EQU   *                                                        40400018
         MVC   DCBEOB+1(3),25(RWTG)     STORE ADDRESS FOR QSAM          40600018
*                                                                       40700018
SLDEOBC  EQU   *                                                        40800018
*                                                                       40900018
         XC    DCBCNTRL(4),DCBCNTRL     CLEAR PARAMETER LIST            41000018
         OI    DCBCNTRL+3,X'01'         SET VECTOR  TO  ONE             41100018
*                                                                       41200018
SLDEOBE  EQU   *                        END.                            41300018
         MVC    DCBEROPT(1),DXCCW6      REPLACE QSAM ERROR OPTIONS      41400018
*                                                                       41500018
*                                                                       41600018
*********************************************************************** 41700018
*                                                                       41800018
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURR WTG ENTRY        41900018
         LA    RPARC,PLOFF(0,RPARC)     INCR CURRENT DCB ENTRY PRTR     42000018
         CLC   0(2,RWTGC),AMIDCNST      THIS RT NEEDED AGAIN            42100018
         BCR   8,RBASE                                                  42200018
*                                                                       42300018
         CLC   0(2,RWTGC),OPIDCNST      END OF TABLE                    42400018
         BC    7,RELOOP                 NO,CHECK NEXT ENTRY             42500018
*                                                                       42600018
         LR    RPARC,RPAR                                               42700018
         LA    RWTGC,WAOFF(0,RWTG)      REINITIALIZE WTG LIST PTR       42800018
ZCHEK    CLI   0(RWTGC),0               IS THIS ENTRY COMPLETE          42900018
         BC    7,TCTLRTN                IF NOT TRANSFER CONTROL         43000018
*                                                                       43100018
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY                  43200018
         LA    RPARC,PLOFF(0,RPARC)                                     43300018
         BC    15,ZCHEK                                                 43400018
*                                                                       43500018
TCTLRTN  EQU   *                                                        43600018
         USING WTG,RWTG                                                 43650003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*43700003
               MODID=WTGENTRY                                  @Z30TSCF 43750003
         DROP  RWTGC,RWTG                                      @Z30TSCF 43800003
**                                                                      44300018
*                                                                       44400018
*                                                                       44500018
*                                                                       44600018
SLDROUT  EQU   *                                                        44700018
         USING WTGMODNM,RWTG                                     Y02072 44750002
         MVC   WTGMODID,0(RB)           ID TO MOD NAME           Y02072 44800002
         DROP  RWTG                                              Y02072 44850002
         L     R1,CVTPTR                LOAD CVT ADDRESS         YM1140 44900002
         USING CVT,R1                   CVT ADDRESSABILITY       YM1140 44950002
         L     R1,CVTLINK               GET LPALIB DCB ADDRESS   YM1140 45000002
         DROP  R1                       DROP CVT BASE            YM1140 45050002
*                                                                       45800018
*                                                                       45900018
**                                                                      46000018
         LOAD  EPLOC=(RWTG),DCB=(1)                              YM1140 46100002
**                                                                      46200018
*                                                                       46300018
*                                                                       46400018
*                                                                       46500018
         ST    RE,24(RWTG)              STORE ADDRESSS OF LOADED ROUTIN 46600018
SLDROUT1 MVC   0(2,RUCB),0(RB)          STORE ID IN DEB                 46700018
         LA    RUCB,2(RUCB)             UPDATE SUBRT PNTR               46800018
         SR    RD,RD                                                    46900018
         IC    RD,DEBNMSUB              GET NO. OF SUBRT LOADED         47000018
         LA    RD,1(RD)                 ADD ONE TO TOTAL                47100018
         STC   RD,DEBNMSUB              STORE NEW TOTAL OF SUBRT LOADED 47200018
         BR    RC                       RETURN                          47300018
*                                                                       47400018
*                                                                       47500018
*********************************************************************** 47600018
*                                                                       47700018
*                                                                       47800018
*********************************************************************** 47900018
*                                                                       48000018
EOBROUT  EQU   *                                                        48100018
*                                                                       48200018
         SR    RC,RC                                                    48300018
         LA    RE,EOBTABL               GET TABLE OF NAMES              48400018
         LA    RB,IDLEN                 LEN OF MODULE ID         Y02072 48500002
         IC    RC,DCBCNTRL+3            GET ID NO. DEVICE DEP.          48600018
         L     RJ,DCBCNTRL              SHIFT IDS RIGHT BY ONE BYTE     48700018
         SRL   RJ,8                                                     48800018
         ST    RJ,DCBCNTRL                                              48900018
         MR    RB,RB                    CALCULATE WHERE ID IS           49000018
         LR    RB,RC                    PREPARE TO LOAD  MODULE         49100018
         AR    RB,RE                    POINT TO CORRECT ID             49200018
         BR    RF                       RETURN                          49300018
         EJECT                                                          49350002
OPIDCNST DC    C'0S'                                                    50800018
AMIDCNST DC    C'18'                    ID OF THIS MODULE          UT18 50900018
*                                                                       51000018
*      THE FOLLOWING TABLE IS USED WITH A TRANSLATE INSTRUCTION TO UT18 51100018
*      CONVERT DISPLACEMENTS FOR THE EOB TABLE INTO THE ENTRIES    UT18 51200018
*      FOR THE CORRESPONDING UTF EOB ROUTINES.                     UT18 51300018
*                                                                  UT18 51400018
UTFTBL   DC    X'00'                    NO CHANGE                  UT18 51500018
         DC    X'0C'                    IGG019CD BECOMES IGG019TD  UT18 51600018
         DC    X'0D'                    IGG019CC BECOMES IGG019TC  UT18 51700018
         DC    X'03'                    NO CHANGE                  UT18 51800018
         DC    X'04'                    NO CHANGE                  UT18 51900018
         DC    X'05'                    NO CHANGE                  UT18 52000018
         DC    X'06'                    NO CHANGE                  UT18 52100018
         DC    X'07'                    NO CHANGE                  UT18 52200018
         DC    X'08'                    NO CHANGE                  UT18 52300018
         DC    X'09'                    NO CHANGE                  UT18 52400018
         DC    X'0A'                    NO CHANGE                  UT18 52500018
         DC    X'0B'                    NO CHANGE                  UT18 52600018
*                                                                       52700018
*                                                                       52800018
* THIS MODULE IS DEPENDENT ON THE ARRANGEMENT OF THE FOLLOWING LOAD     52900018
*   TABLE.  THE LOAD TABLE IS SET UP WITH A BSAM ENTRY, FOLLOWED        53000018
*   BY THE CORRESPONDING QSAM ENTRY.  THIS PATTERN MUST BE MAINTAINED   53100018
*   TO ENSURE THAT THE PROPER MODULE IS LOADED                          53200018
*                                                                       53300018
SOP9     DC    C'11',VL3(IGG01911)     LAST LOAD OF OPEN EXECS @Z30TSCF 54200003
*                                                                       54500018
*********************************************************************** 54600018
*                                                                       54700018
*        DEVICE DEPENDENT ROUTINES SUPPORTED                            54800018
*                                                                       54900018
EOBTABL  EQU   *                                                        55000018
         DC    C'  '                                                    55100002
EPD2     DC    C'CD'                    EOB RT DISK-OUTP/STANDRF INP    55200002
EGP2     DC    C'CC'                    EOB RT. DISK-TP-RDR. INP/OUTP.  55300002
DDA2     DC    C'CE'                    EOB RT. PRNTR/PUNCH NORMAL      55400002
DDB2     DC    C'CF'                    EOB RT. PRNTR/PUNCH ASA         55500002
NPD2     DC    C'BK'                    NOTE POINT DISK                 55600002
NPT2     DC    C'BD'                    NOTE-POINT TAPE                 55700002
CNT1     DC    C'CA'                    CNTRL RT READER                 55800002
DUMA     DC    C'  '                    TABLE FILLER                    55900002
DUMB     DC    C'  '                    TABLE FILLER                    56000002
DUMC     DC    C'AV'                    DUMMY EXECUTOR                  56100002
OVRD     DC    C'CT'                    OPEN OVERRIDE ERROR RTN   OC034 56200002
UTF1     DC    C'TD'                    USER TOTALLING EOB ROUTINE UT18 56300002
UTF2     DC    C'TC'                    USER TOTALLING EOB ROUTINE UT18 56400002
UTF3     DC    C'TV'                    USER TOTALLING EOB ROUTINE UT18 56500002
UTF4     DC    C'TW'                    USER TOTALLING EOB ROUTINE UT18 56600002
UTF5     DC    C'T2'                    USER TOTALLING EOB ROUTINE UT18 56700002
         SPACE                                                          56800002
PATCH    DC    25H'0'                   PATCH AREA               YM4640 56900002
END      EQU   *                        END OF MODULE            Y02072 56910002
***                                                                     56950002
         TITLE 'IGG01918 - FORMAT OF GOTTEN CORE'                       57500002
*                                                                       57800018
         IECDSECS  MAIN,WTG,PREFX,EXPAND=YES                   @Z30TSCF 57850003
         ORG   WTGIDTTR                                          Y02072 57860002
WTGID    DS    CL2                      NEXT MODS ID             Y02072 57870002
*                                                                       57900018
CVT      DSECT                                                          58000018
         CVT                                                            58100018
*                                                                       58200018
*                                                                       58300018
BLDEB    DSECT                                                          58400018
DEB      DS    0F                                                       58500018
DEBNMSUB DS    0CL1                                                     58600018
DEBTCBAD DS    CL4                                                      58700018
DEBAMLNG DS    0CL1                                                     58800018
DEBDEBAD DS    CL4                                                      58900018
DEBOGLGS DS    0CL1                                                     59000018
DEBIRBAD DS    CL4                                                      59100018
DEBOPATB DS    0CL1                                                     59200018
DEBSYSPG DS    CL4                                                      59300018
DEBNMEXT DS    0CL1                                                     59400018
DEBUSRPG DS    CL4                                                      59500018
DEBPRIOR DS    0CL1                                                     59600018
DEBECBAD DS    CL4                                                      59700018
DEBPROTG DS    0CL1                                                     59800018
DEBDEBID DS    0CL1                                                     59900018
DEBDCBAD DS    CL4                                                      60000018
DEBEXSCL DS    0CL1                                                     60100018
DEBAPPAD DS    CL4                                                      60200018
DEBDVMOD DS    0CL1                                                     60300018
DEBUCBAD DS    CL4                                                      60400018
DEBBINUM DS    CL2                                                      60500018
DEBSTRCC DS    CL2                                                      60600018
DEBSTRHH DS    CL2                                                      60700018
DEBENDCC DS    CL2                                                      60800018
DEBENDHH DS    CL2                                                      60900018
DEBNMTRK DS    CL2                                                      61000018
*                                                                       61100018
           DCBD  DSORG=PS                                               61200018
* DCBREAD IS A TEMPORARY STORAGE AREA USED FOR THE OFFSET USED IN       61300018
*  LOADING EITHER QSAM MODULES OR BSAM MODULES                          61400018
OFFSET   EQU   DCBREAD+2                                                61500018
**********************************************************************  61600018
*                                                                       61700018
           END                                                          61800018
