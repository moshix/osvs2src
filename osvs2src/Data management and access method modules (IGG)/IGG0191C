         TITLE 'IGG0191C-IECOSD06 OPEN EXECUTOR(DUMMY DATA SET)'        00020000
*MODULE NAME - IGG0191C                                          Y02072 00020102
*                                                                       00020202
*DESCRIPTIVE NAME - DUMMY OPEN EXECUTOR                          Y02072 00020302
*                                                                       00020402
*COPYRIGHT - NONE                                                Y02072 00020502
*                                                                       00020602
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00020702
*                                                                       00020902
*          VS2 RELEASE 2 DELETIONS                               Y02072 00021602
*                                                                       00021802
*D000204,009600,025200,026120,026150,026160,026170,027300,       Y02072 00022002
*D027340-027360,045000,045200,045400-045600,046000,049200,       Y02072 00022802
*D050600,060100,026010,027320,268-458,27400-29200,56400-56600    Y02072 00024802
*58400-588000                                                    Y02072 00024902
*                                                                YM1140 00034902
*                                                                YM7889 00044902
*          VS2 RELEASE 3 DELETIONS/CHANGES                              00046900
*                                                                       00047003
*A047724,047728                                                 ZA01372 00047300
*                                                              @Z30TSCF 00047503
*A038801-038832,C039000,040199                                 @ZA07053 00047637
*000001786900-01787200,01810213,01810413-01810423,03909003,    &ZA07619 00047737
*000003927003,03948103-03948703,04181000-04182000,04358421,    &ZA07619 00048037
*000004359231,04570102-04571302,04861000,05020100-05021302     &ZA07619 00048337
*A018110,026759,026867                                         @ZA11148 00048437
*A039495,039497,039499,039501,041850,046750,033851,039501      @ZA12925 00048637
*C039150,039489,041870,045920,033850,039503                    @ZA12925 00048837
*D050324-050360                                                @ZA12925 00049037
*D040820,041084-041092                                         @ZA16037 00049137
*                                                                       00049237
*          RELEASE 20 DELETIONS                                         00049437
*3525024600,025400,026200,059600,060200,060600                   S20016 00049602
*          RELEASE 21 DELETIONS                                         00051502
*2673010000,022800-023000,023800,041200-041600,057000,059600-    S21042 00053402
*2673060600,061800-062600                                        S21042 00055302
*2673                                                            A48163 00057202
*2673                                                            A45054 00059102
* 030000,030500-030520,030660-030800,031600,032000-032400,       A46862 00061002
* 035000-035200,036400-036600,037640-037680                      A46862 00062902
*                                                                A51108 00064802
*D25000,25600,26010-26090,26244-26400                           SA68439 00066802
*A040810,041030,041040,047860,047920,047930,047940             @ZA19736 00069837
*C043520                                                       @ZA27484 00071837
*STATUS CHANGE LEVEL 007                                                00074302
*********************************************************************** 00076202
*                                                                     * 00078102
*FUNCTION-OPERATION --OPENS A DCB FOR 'DUMMY'(I.E.,EFFECTIVE NOP  FOR * 00080000
*                     OPERATIONS ON DATA SET)                         * 00100000
*                                                                     * 00120000
*           VECTORS IN DCB ARE SET SUCH THAT THE FOLLOWING        15741 00126000
*              OPERATIONS WILL IN EFFECT BE                       15741 00132000
*                                                                     * 00180000
*             1.BSAM                                                  * 00200000
*                  WRITE     POST ECB AND RETURN                  15741 00206000
*                  NOTE      NOP (NO OPERATION)                   15741 00212000
*                  POINT     NOP                                      * 00260000
*                  READ      POST ECB AND RETURN                  15741 00270000
*                  CNTRL     NOP                                      * 00300000
*                  CHECK     WRITE - NOP                              * 00320000
*                  CHECK     READ - GO TO EODAD                       * 00340000
*                                                                     * 00360000
*             2 QSAM                                                  * 00380000
*                   GET(MOVE MODE)      GO TO EODAD                   * 00400000
*                   GET(LOCATE MODE)    GO TO EODAD                   * 00420000
*                   PUT(MOVE MODE)      NOP                           * 00440000
*                   PUT(LOCATE MODE)    ADDRESS OF BUFFER RETURNED IN * 00460000
*                                        REGISTER 1                   * 00480000
*                   PUTX                NOP                           * 00500000
*                   CNTRL               NOP                           * 00520000
*                   RELSE               NOP                           * 00540000
*                   TRUNC               NOP                           * 00560000
*                                                                     * 00580000
*             3.DCBIOBA       POINT TO DUMMY IOB WITHIN THIS ROUTINE  * 00600000
*                             ITS ECB IS POSTED COMP.NO ERROR FOR     * 00620000
*                             PRTOV WITH USER EXIT.                   * 00640000
*                                                                     * 00660000
*             4.BUFFER POOL   BUILD POOL IF REQUESTED.ONE BUFFER ONLY * 00680000
*                             FOR QSAM,FULL SIZE POOL FOR BSAM.       * 00700000
*                                                                     * 00720000
*             5.DEB           BUILD A 56 BYTE DUMMY DEB               * 00740002
*                                NONE - APPENDAGE VECTOR TABLE          00742002
*                             16 BYTE - PREFIX                          00744002
*                             32 BYTE - BASIC SECTION                   00746002
*                              4 BYTE - ZERO UCB ADDRESS                00748002
*                              0 BYTE - ACCESS METHOD SECTION           00748402
*                              4 BYTE - SUBROUTINE NAME SECTION         00748802
*                                       (ONLY 2 BYTES USED)             00750002
*                                                                       00750402
*           IT ALSO SETS AUDIT TRAIL BITS IN THE OPEN WORKAREA   Y02072 00752002
*           AFTER ACQUIRING RESOURCES IN CASE OF A FORCE CLOSE   Y02072 00754002
*           SITUATION.                                           Y02072 00756002
*                                                                     * 00760000
*ENTRY POINT  IGG0191C ENTERED BY XCTL                                * 00780000
*                                                                     * 00800000
*INPUT   SEE DESCRIPTION OF REGISTERS,DCB(USERS)                      * 00820000
*                                                                     * 00840000
*OUTPUT  SEE DESCRIPTION OF REGISTERS,DCB(USERS)                      * 00860000
*                                                                     * 00880000
*EXTERNAL ROUTINES  1.SUPERVISOR (GETMAIN)                            * 00900000
*                   2. SUPERVISOR (LOAD)                              * 00920000
*                                                                     * 00940000
*EXITS NORMAL - XCTL TO IGG01911 FOR DCB COPY BACK               Y02072 00960002
*                                                                     * 00980000
*EXITS ERROR: XCTL TO PROB DET (IGG0196M) FOR WTP AND 013 ABEND         01000021
*                                                                     * 01020000
*MACROS : ACTION - GETMAIN, MODESET, DEBCHK, LOAD, DMABCOND,     Y02072 01030002
*                  XCTL, XCTLTABL                                Y02072 01032002
*                                                                       01034002
*MACROS : MAPPING - CVT, IKJTCB, IECDSECS, DCBD, IEZDEB, IHAPSA, Y02072 01036002
*                   IGGPARML                                            01036102
*                                                                       01036402
*ATTRIBUTES - RE-ENTRANT, REUSUABLE, SUPERVISOR STATE,           Y02072 01036802
*             RUNS IN DATA MANAGEMENT KEY UNLESS OTHERWISE       Y02072 01037202
*             SPECIFIED.                                         Y02072 01037602
*                                                                       01038002
*TABLES/WORKAREAS- WHERE TO GO TABLE (WTG)                              01040000
*                                                                       01060000
*      BYTE  0-7  NAME                                                  01080000
*      BYTE  8-10 RELATIVE DISK ADDRESS(TTR) OF FIRST RECORD            01100000
*      BYTE 11    CONCATENATION NUMBER                                  01120000
*      BYTE 12    ZERO                                                  01140000
*      BYTE 13    ALIAS INDICATOR AND USER DATA FIELD DESCRIPTOR.       01160000
*                        ALIAS INDICATOR 1 BIT                          01180000
*                        NUMBER OF TTRS IN USERS DATA FIELD 2 BITS      01200000
*      BYTE 14-16 TTR OF FIRST TEXT RECORD                              01220000
*      BYTE 17    ZERO                                                  01240000
*      BYTE 18-19 TTR OF NOTE LIST OR SCATTER LIST                      01260000
*      BYTE 20    TRANSLATION TABLE                                     01280000
*      BYTE 21    ZERO OR NUMBER OF ENTRIES IN THE NOTE LIST            01300000
*      BYTE 22-23 ATTRIBUTES                                            01320000
*      BYTE 24-26 TOTAL CONTIGUOUS MAIN STORAGE REQUIRED FOR MODULE     01340000
*      BYTE 27-28 LENGTH OF FIRST TEXT RECORD                           01360000
*      BYTE 29    LENGTH OF WTG TABLE (IN DOUBLE WORDS)                 01380000
*      BYTE 30-31 PATH THROUGH LOADS OF ROUTINES                        01400000
*      BYTE 32-36 IDTTR OF EXECUTOR FOR FIRST DCB                       01420000
*      BYTE 37-39 WORKAREA ADDRESS FOR FIRST DCB                        01440000
*      BYTE 40-   TABLE OF IDTTR'S                                      01460000
*      BYTE 32+N(8) IDTTR OF EXECUTOR FOR N TH DCB   (5 BYTES)          01480000
*                   WORKAREA ADDRESS FOR N TH DCB    (3 BYTES)          01500000
*                   IDTTR OF LAST ROUTINE LOAD       (5 BYTES)          01520000
*                   NOT USED                         (3 BYTES)          01540000
*                                                                     * 01560000
         EJECT                                                          01599202
*                                                                     * 01600000
*   EQUATES                                                             01620000
*                                                                       01640000
NORLD    EQU   X'10'         NO RELOCATION NECCESSARY INDICATOR  A51108 01650021
*                                FOR LOAD                               01652021
VEC1     EQU   26                                                       01660000
DCBSVC   EQU   84                                                       01680000
READB    EQU   X'20'                                                    01700000
WRITEB   EQU   X'20'                                                    01720000
LOCATEB  EQU   X'08'                                                    01740000
OUTPUT   EQU   X'0F'                                                    01760000
PRINTER  EQU   X'48'                   PRINTER DEVT MASK                01780000
LRECIND  EQU   X'20'                    LOGICAL RECORD INTERFACE A45054 01782021
QSAMB    EQU   X'01'                   DCBCIND2, BIT ON IF QSAM  A45054 01784021
FORMATVS EQU   X'48'                   VARIABLE SPANNED RECORDS  A45054 01786021
FLGOFFST EQU   4                       OFFSET TO FLAG BYTE IN    A48163 01786400
*                                       BUFFER CONTROL BLOCK            01786800
NOT      EQU   X'FF'                   MASK TO TURN OF BITS    @ZA07619 01787137
ADLEN    EQU   3                       LENGTH OF ADDRESS       @ZA07619 01787437
*                                      BUFFER CONTROL BLOCK    @ZA07619 01787737
DWDLEN   EQU   8                        DOUBLEWORD LENGTH        A48163 01788021
EXTND    EQU   X'40'                    FLAG TO INDICATE BUFCB   A48163 01788421
*                                         IS 16 BYTES IN LENGTH  A48163 01788821
LENNSPEC EQU   52                       CODE FOR BUFL OR BLKSE  SA53809 01793202
*                                         NOT SPECIFIED         SA53809 01795202
NOBUFCB  EQU   1                        INVALID ADDRESS          Y02072 01805202
DEBID    EQU   X'0F'                    DEB ID                  SA68439 01807202
DEBSIZE  EQU   56                       SIZE OF DEB FOR DD DUMMY S20016 01810020
PUTLOC   EQU   X'48'                   MACRF MASK,PUT LOCATE   @ZA07053 01810237
GETLOC   EQU   X'48'                   MACRF MASK, GET LOCATE  @ZA07619 01810437
OABD056  EQU   56                      INTERNAL CODE           @ZA07053 01810537
OABD061  EQU   61                      INTERNAL CODE           @ZA07619 01810637
RAFLAG   EQU   X'80'                   RECORD AREA PRESENT     @ZA07619 01810737
BLKFMT   EQU   X'10'                   DCB BLK FORMAT INDICATOR@ZA07053 01810837
VARIABLE EQU   X'40'                   VARIABLE REC INDICATOR  @ZA07053 01810937
FORMATF  EQU   X'80'                   FIXED REC INDICATOR     @ZA07053 01811037
ONE      EQU   1                       NUMBER OF EXTENTS       @ZA11148 01811237
TWO      EQU   2                       EXTENT SCALE            @ZA11148 01811437
FOUR     EQU   4                       ADDITION FACTOR         @ZA07053 01811637
         EJECT                                                          01812002
*                                                                       01814002
* REGISTER EQUATES                                                      01816002
*                                                                       01818002
RE       EQU   0                       WORK REGISTER/PARAM REG          01820000
R0       EQU   RE                       PARM REG FOR DMABCOND   SA53809 01830002
RF       EQU   1                       WORK REGISTER/PARAM REG          01840000
R1       EQU   RF                       PARM REGISTER            Y02072 01842002
RWK1     EQU   RF                      WORK REGISTER             Y02072 01850002
RDCB     EQU   2                       ADDR. OF CURRENT DCB             01860000
RBASE    EQU   3                       BASE REG.                        01880000
RCORE    EQU   4                       ADDR. OF OPEN WORK AREA          01900000
RPAR     EQU   5                       OPEN PARAMETER LIST              01920000
RWTG     EQU   6                       D.E. TABLE FOR XCTL & LOAD       01940000
RPARC    EQU   7                       CURRENT ENTRY IN PARAM. LIST     01960000
RWTGC    EQU   8                       CURRENT ENTRY IN WTG TABLE       01980000
RTIOT    EQU   9                       WORK REG.                        02000000
RWK2     EQU   RTIOT                   WORK REGISTER             Y02072 02010002
RUCB     EQU   10                      WORK REG.                        02020000
RDEB     EQU   11                      WORK REG.                        02040000
RWK5     EQU   RDEB                     WORK REGISTER            Y02072 02050002
RA       EQU   11                      WORK REG.                        02060000
RB       EQU   12                      WORK REG                         02080000
RC       EQU   13                      WORK REG                         02100000
RWK6     EQU   RC                       WORK REGISTER           SA53809 02110002
RD       EQU   14                      WORK REG                         02120000
RWK3     EQU   RD                      WORK REGISTER             Y02072 02130002
RJ       EQU   15                      WORK REG/PARAM REG               02140000
RWK4     EQU   RJ                      WORK REGISTER             Y02072 02150002
         EJECT                                                          02160002
IGG0191C CSECT                                                          02220000
         BALR  RBASE,0                 SET UP BASE REG                  02260002
         USING FORCORE,RCORE                                            02340000
         USING *,RBASE                                           S21042 02380021
         USING PSA,0                                                    02390002
         USING IHADCB,RDCB                                              02400000
**                                                                      02420000
         B     BEGIN                    BR AROUND CONSTANTS             02430002
         DC    C'IGG0191C'              MODULE NAME                     02432002
         DC    C'@ZA27484'              LAST SHIP CODE         @ZA16037 02436037
         DC    C'10/27/77'              LAST DATE MODIFIED     @ZA16037 02436837
BEGIN    DS    0H                                                       02438402
**                                                                      02438802
         L     RCORE,4(RWTGC)          GET WORKAREA                     02440000
*                                                                       02450002
         SR    RWK1,RWK1                PREPARE TO CLEAR FIELD   Y02072 02450102
         ST    RWK1,DXMSGADR            ZERO SO LAST LOAD OF     Y02072 02450502
*                                         OPEN EXECS WILL NOT    Y02072 02450902
*                                         THINK MSG CSECT LOADED        02451302
*SET A BIT IN COMMON OPENS AUDIT TRAIL INDICATING TO FORCE       Y02072 02452002
*CLOSE AND PROBLEM DETERMINATION NOT TO REFRESH THE USERS DCB    Y02072 02454002
*FROM THE KEY 5 DCB BEFORE TAKING ANY USER EXITS.                Y02072 02456002
*                                                                       02458002
         OI    DXATCOM1,DXATREFR        DO NOT REFRESH DCB       Y02072 02458402
         LA    RJ,DEBSIZE               GET SIZE OF DEB          S20016 02460020
         USING PARML,RPARC                                              02470002
         L     RDCB,PARDCBAD            SET UP DCB ADDRESSABILITY       02480002
         GETMAIN R,LV=(15),SP=230       GET MAIN FOR DUMMY DEB   Y02072 02520002
         XC    0(DEBSIZE,RF),0(RF)      CLEAR CORE               S20016 02540020
         USING DEBPREFX,RWK1                                            02550002
         MVI   DEBLNGTH,(DEBSIZE+7)/8   DBL WORD LEN TO DEB     SA68439 02560002
         LA    RWK3,DEBBASIC            BASIC SECTION OF DEB    SA68439 02570002
         DROP  RWK1                                                     02572002
         ST    RWK3,24(RWTG)            TEMP STORE OF DEB ADDR.         02580002
         MVC   DCBDEBAD+1(3),25(RWTG)  MOVE DEBAD TO DCB                02600000
         L     RWK5,PSATOLD             ADDR OF CURRENT TCB     SA68439 02604002
*                                                                       02609402
* MUST USE CS INSTRUCTION TO PUT DEB ON TCB DEB CHAIN TO PREVENT Y02072 02609802
* OVERLAYING THE ADDRESS OF ANOTHER DEB BEING ADDED BY ANOTHER   Y02072 02610202
* CPU.                                                           Y02072 02610602
*                                                                       02610702
         USING TCB,RWK5                                          Y02072 02611002
         USING DEBBASIC,RWK3                                     Y02072 02613002
         L     RWK4,TCBDEB              GET FIRST DEB ON CHAIN   Y02072 02615002
         MODESET  EXTKEY=SUPR           GET INTO SUPER KEY       Y02072 02615102
SD04110  EQU   *                                                 Y02072 02615402
         ST    RWK4,DEBDEBAD            LINK DEBS                Y02072 02615802
         CS    RWK4,RWK3,TCBDEB         INSERT DEB INTO DEB CHN  Y02072 02616602
         BNE   SD04110                  IF CS INST FAILS, TRY    Y02072 02619202
*                                         AGAIN                  Y02072 02621202
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 02621802
         ST    RWK5,DEBTCBAD            TCB ADDR TO DEB          Y02072 02623802
         MVC   DEBOPATB,PAROPT          COPY OPEN ATTRIBUTES    SA68439 02673802
         NI    DEBOPATB,X'FF'-PARENLST  TURN OFF END LIST BIT   SA68439 02675802
         MVI   DEBNMEXT,ONE             NUMBER OF EXTENTS = 1  @ZA11148 02679837
         ST    RDCB,DEBDCBAD            DCB ADDR TO DEB         SA68439 02681837
         MVC   DEBPROTG,DXUKEY          PROTECT KEY TO DEB      SA68439 02683837
         OI    DEBDEBID,DEBID           DEB IDENTIFIER          SA68439 02685837
         MVI   DEBEXSCL,TWO             EXTENT SACLE = 2       @ZA11148 02687837
         DROP  RWK5,RPARC                                               02690602
         MVC   6(2,RWTG),SPLD          STORE ID OF DUMMY IN DE          02693302
         MVI   22(RWTG),X'CB'           PUT ATTRIBUTES IN LIST          02700000
         NI    23(RWTG),X'FF'-NORLD    RELOCATE IS REQUIRED      A51108 02710021
         MVC   14(3,RWTG),SPLD+2       STORE TTR OF DUMMY IN DE         02720000
         DEBCHK (RDCB),TYPE=ADD,AM=SAM   ADD DEB TO DEB TABLE    Y02072 02732002
*                                                                       02742002
*  LOAD IGG019AV, DUMMY ACCESS METHOD ROUTINE                           02752002
*                                                                       02762002
         USING WTGMODNM,RWTG                                     Y02072 02782002
         MVC   WTGMODID,SPLD            ID TO MOD NAME           Y02072 02832002
         DROP  RWTG                                              Y02072 02882002
         L     R1,CVTPTR                LOAD CVT ADDRESS         YM1140 02892002
         USING CVT,R1                   CVT ADDRESSABILITY       YM1140 02894002
         L     R1,CVTLINK               GET LPALIB DCB ADDRESS   YM1140 02896002
         DROP  R1                       DROP CVT BASE            YM1140 02898002
**                                                                      02900000
         LOAD  EPLOC=(RWTG),DCB=(1)                              YM1140 02920002
**                                                                      02940000
**                                                                      02960000
         OI    23(RWTG),NORLD          RESET RELOCATE BIT        A51108 02962021
         MVC   DEBSUBID-DEBSUBNM+DEBBASND+L'DEBSUCBA,SPLD SUBID SA68439 02964002
         MVI   DEBNMSUB,1               NO OF ACC METH RTNS     SA68439 02966002
         DROP  RWK3                                                     02968002
         USING ADUMMY,RTIOT            SET THE BASE              A46862 02970021
         LR    RTIOT,RE                 SAVE ADDR.OF IGG019AV           02980000
         L     RD,ADUMPUT              LOAD DUMMY PUT ADDR       A46862 02990021
         ST    RD,24(RWTG)             TEMP.STORE OF DUMMY ADDR. A46862 03000021
         MVC   DCBCNTRL+1(3),25(RWTG)  LOAD ADDR.OF CNTRC/NOTE/POINT    03020000
         MVC   DCBREAD+1(3),25(RWTG)   LOAD ADDR.OF RD/WR/GET/PUT       03040000
         TM    DCBMACRF,X'02'          USING READ/CNTRL          A28185 03042019
         BO    SD04120                 YES,BRANCH                A28185 03044019
         TM    DCBMACRF+1,X'02'        USING WRITE/CNTRL         A28185 03046019
         BZ    SD04121                 NO,BRANCH                 A28185 03048019
SD04120  L     RD,ADUMCNTR             ADDR OF DUMMY CNTRL       A46862 03050021
         ST    RD,24(RWTG)             TEMP STORE OF CNTRL ADDR  A28185 03054019
         MVC   DCBCNTRL+1(3),25(RWTG)  LOAD ADDR OF CNTRL RTN    A28185 03056019
SD04121  L     RD,ADUMCHEK             ADDR OF CHECK RTN         A46862 03066021
         ST    RD,24(RWTG)              TEMP STORE OF CHECK ADDR.       03100000
         MVC   DCBCHECK+1(3),25(RWTG)  LOAD ADDR.OF CHECK/GERR/PERR)    03120000
*                                                                       03140000
         L     RUCB,ADUMIOB            LOAD ADDR OF DUMMY IOB    A46862 03160021
         ST    RUCB,DCBIOBA             STORE IOB ADDR.INDCB            03180000
*                                                                       03260000
SD04130  TM    DCBMACRF,READB           IS THIS BSAM                    03280000
         BC    1,SD04132                YES BRANCH                      03300000
         TM    DCBMACRF+1,WRITEB        NO                              03320000
         BC    1,SD04132                YES BRANCH                      03340000
*                                                                       03360000
         OI    DCBCIND2,DCBCNQSM        SET QSAM INDICATOR       YM5574 03362002
         SR    RB,RB                    CLEAR REGISTER            M1552 03365000
         IC    RB,DCBBUFNO              GET NUMBER OF BUFFERS     M1552 03370000
         LTR   RB,RB                    IS BUFNO EQUAL TO ZERO    M1552 03375000
         BNE   NODEFALT                 NO, BRANCH AROUND         M1552 03380000
         LA    RB,5                     DEFAULT IS 5 BUFFERS   @ZA12925 03385037
         STC   RB,DCBBUFNO              NUMBER OF BUF TO DCB   @ZA12925 03387037
NODEFALT EQU   *                                                  M1552 03390000
         TM    0(RPARC),OUTPUT          QSAM OUTPUT                     03400000
         BC    14,SD04131               NO, BRANCH INPUT OR UPDATE      03420000
*                                                                       03440000
         TM    DCBMACRF+1,LOCATEB       PUT LOCATE                      03460000
         BZ    SD04200                 NO BRANCH TO GET BUF POOL        03480000
         L     RD,ADUMPUTL             LOAD DUMMY PUT LOCATE ADD A46862 03490021
         ST    RD,24(RWTG)              TEMP.STORE OF PUT ADDR.         03540000
         MVC   DCBPUT+1(3),25(RWTG)    LOAD ADDR OF PUT                 03560000
         B     SD04200                  BRANCH TO GETT POOL             03580000
*                                                                       03600000
SD04131  EQU   *                                                        03620000
         L     RD,ADUMGET              ADDR OF DUMMY GET RTN     A46862 03630021
         ST    RD,24(RWTG)              TEMP.STORE OF GET ADDR.         03680000
         MVC   DCBGET+1(3),25(RWTG)    LOAD ADDR OF GET                 03700000
         B     SD04200                 BRANCH TO GET POOL               03720000
*                                                                       03740000
SD04132  EQU   *                                                        03760000
         L     RD,ADUMBSAM             LOAD ADDR OF DUM. BSAM    A46862 03770021
         ST    RD,24(RWTG)              TEMP.STORE OF ADDRESS     15741 03772000
         MVC   DCBREAD+1(3),25(RWTG)    MOVE ADDRESS TO DCB       15741 03776000
         SR    RB,RB                    CLEAR RB                        03780000
         IC    RB,DCBBUFNO              GET NO.BUFFERS REQUESTED        03800000
         LTR   RB,RB                    ANY BUFFERS REQUIRED            03820000
         BZ    SD04END1                 NO BRANCH TO END                03840000
SD04200  EQU   *                                                        03880000
         TM    DCBCIND2,QSAMB           IS THIS QSAM?          @ZA07053 03900037
         BNO   SD04210                  NO - BY PASS BLOCK CHK @ZA07053 03903037
         TM    DCBMACRF+1,PUTLOC        PUT, IN LOCATE MODE    @ZA07053 03906037
         BNO   SD04203                  NO - BYPASS BLOCK CHK  @ZA07619 03909037
         TM    DCBRECFM,BLKFMT          BLOCK FORMAT?          @ZA07053 03912037
         BNO   SD04204                  NO - BYPASS BLOCK CHK  @ZA12925 03915037
         TM    DCBRECFM,VARIABLE        "V" RECORDS            @ZA07053 03918037
         BNO   FIXED                    NO - CHECK FOR FIXED   @ZA07053 03921037
         TM    DCBRECFM,FORMATVS        IS THIS SPAN RECS?     @ZA07053 03924037
         BO    SD04205                  YES - BYPASS BLOCK CHK @ZA07619 03927037
         LH    RC,DCBLRECL              OBTAIN LRECL           @ZA07053 03930037
         LA    RD,FOUR                  ADD LENGHT OF BDW      @ZA07053 03933037
         AR    RC,RD                                           @ZA07053 03936037
         CH    RC,DCBBLKSI              IS LRECL GT BLKSIZE?   @ZA07053 03939037
         BNH   SD04210                  NO - CONTINUE          @ZA07053 03942037
         LA    RE,OABD056               YES - ISSUE ABEND      @ZA07053 03945037
         B     ERROR                                           @ZA07053 03948037
SD04203  TM    DCBMACRF,GETLOC         GET, LOCATE MODE?       @ZA07619 03948337
         BNO   SD04210                 NO - CONTINUE           @ZA07619 03948637
SD04204  TM    DCBRECFM,FORMATVS       IS THIS SPANNED REC?    @ZA12925 03948937
         BNO   SD04210                 NO - CONTINUE           @ZA07619 03949137
SD04205  TM    DCBBUFCB+ADLEN,NOBUFCB  BUFCB SPECIFIED?        @ZA07619 03949337
         BO    FIXED                   NO - GET THE BUFFERS    @ZA12925 03949537
         MODESET  KEYADDR=DXUKEY,WORKREG=15  GOTO USER KEY     @ZA12925 03949737
         L     RJ,DCBBUFCB             GET BCB ADDRESS         @ZA12925 03949937
         TM    FLGOFFST(RJ),RAFLAG     RECORD ARE PRESENT?     @ZA12925 03950137
         BO    SD04285                 YES, EXIT               @ZA12925 03950337
         TM    DCBBFTEK,LRECIND        RECORD AREA NEEDED?     @ZA12925 03950437
         BNO   SD04285                 NO, EXIT                @ZA12925 03950537
         TM    FLGOFFST(RJ),EXTND      SPACE AVAILABLE FOR LRI?@ZA12925 03950637
         BNO   DCBERROR                NO,SET DCB IN ERROR     @ZA12925 03950737
         B     GETRALEN                BRANCH TO GET RECORD    @ZA12925 03950837
*                                      AREA ONLY               @ZA07619 03950937
FIXED    EQU   *                        CHECK FIXED BLOCK FMT  @ZA07053 03951037
         TM    DCBRECFM,FORMATF         FIXED REC ?            @ZA07053 03954037
         BZ    SD04210                  NO - CONTIUE           @ZA07053 03957037
         SR    RD,RD                    CLEAR REGISTER         @ZA07053 03960037
         LH    RJ,DCBBLKSI              OBTAIN BLKSIZE         @ZA07053 03963037
         LTR   RJ,RJ                    CHECK FOR BLKSIZE=ZERO @ZA07053 03966037
         BZ    SD04210                  BRANCH IF ZERO         @ZA07053 03969037
         LH    RA,DCBLRECL              OBTAIN LRECL           @ZA07053 03972037
         LTR   RA,RA                    CHECK FOR LRECL=ZERO   @ZA07053 03975037
         BZ    SD04210                  BRANCH IF ZERO         @ZA07053 03978037
         DR    RD,RA                    DIVIDE BLKSIZE BY LRECL@ZA07053 03981037
         LTR   RD,RD                    IS THERE A REMAINDER ? @ZA07053 03984037
         BZ    SD04210                  NO - CONTINUE          @ZA07053 03987037
         LA    RE,OABD056               YES - ISSUE ABEND      @ZA07053 03990037
         B     ERROR                                           @ZA07053 03993037
SD04210  TM    DCBBUFCB+3,1             IS THERE A BUF.CNTL.BLK@ZA07053 03996037
         BZ    SD04END1                 YES BRANCH TO END               03999037
         LH    RC,DCBBUFL               GET BUFFER LENGTH      @ZA07053 04002037
         LTR   RC,RC                    HAS IT BEEN SPECIFIED           04026602
         BC    7,SD04220                BRANCH ON YES                   04033302
         LH    RC,DCBBLKSI              GET LENGTH FROM BLOCK SIZE      04040000
         LTR   RC,RC                   IS BLOCK SIZE SPECIFIED          04060000
         BP    SD04220                 YES BRANCH TO GET POOL           04080000
         LA    RWK2,NOBUFCB            INIT REG FOR NOT PUTL   @ZA19736 04082037
*                                                                       04084037
*  TEST FOR QSAM OUTPUT WITH LOCATE MODE. IF YES,ABEND USER             04086037
*  TO KEEP HIM FROM ABENDING WHEN IGG019AV DOES NOT PASS HIM            04088037
*  A VALID BUFFER ADDRESS BECAUSE SOME DCB FIELDS ARE NOT SPECIFIED     04090037
*                                                              @ZA19736 04092037
*                                                                       04094037
         TM DCBMACF2,PUTLOC + DCBMRLCP    PUT LOCATE?          @ZA19736 04096037
         BNO SD04220                      NO BYPASS DMACOND &  @ZA19736 04098037
*                                         DO GETMAIN!          @ZA19736 04100037
         LA    R0,LENNSPEC              INTERNAL ABEND CODE     SA53809 04110002
ERROR    DMABCOND  (R0),PDLOAD,RETURN=NONE,RES=NO,REGSAVE=YES   SA53809 04112002
         B     TCTLRTN                  GO TO PROB DETERMINATION S21042 04160021
**                                                                      04180000
DCBERROR MODESET  EXTKEY=DATAMGT       DATA MGT KEY            @ZA12925 04185037
         LA    RE,OABD061              LOAD INTERNAL CODE      @ZA12925 04187037
         B     ERROR                                           @ZA07619 04190037
*                                                                       04195037
SD04220  LA    RC,7(0,RC)               ADJUST                          04200000
         SRL   RC,3                            TO                       04220000
         SLL   RC,3                               DOUBLE ALIGNMENT      04240000
*                                                                       04260000
         LR    RD,RB                     SAVE LENGTH AND NUMBER         04280000
         LR    RJ,RC                                                    04300000
         MR    RD,RD                    COMPUTE TOTAL LENGTH            04320000
*                                                                       04340000
         TM    DCBCIND2,QSAMB          IT IT QSAM               A45054  04350021
         BNO   DEFAULT                                         @ZA27484 04352037
         TM    DCBBFTEK,LRECIND        LRI REQUESTED            A45054  04354021
         BNO   ALIGN                                            A45054  04356021
         TM    DCBRECFM,FORMATVS       VARIABLE SPANNED         A45054  04358021
         BNO   DEFAULT                 BRANCH TO TURN OFF LRI  @ZA07619 04358437
*              ALLOW 8 EXTRA BYTES FOR EXTENDED CONTROL BLOCK           04358637
         B     SD04230                                          A45054  04358837
DEFAULT  NI    DCBBFTEK,NOT-LRECIND    TURN OFF LRI            @ZA07619 04359037
*                                                                       04359237
ALIGN    EQU   *                                                A45054  04359621
*                                                                       04360000
         TM    DCBBFTEK,1               FULL WORD ALLIGNMENT REQUIRED   04380000
         BC    1,SD04230                BRANCH ON YES                   04400000
         LA    RJ,8(0,RJ)               ADD 8 ON NO                     04420000
         B     SD04240                                                  04440000
*                                                                       04460000
SD04230  LA    RJ,16(0,RJ)              ADD  16  ON  YES                04480000
         OI    FCAOPEN,FCAOXTND         INDIC BCB IS EXTENDED    Y02072 04482002
SD04240  EQU   *                                                 Y02072 04490002
         MODESET  KEYADDR=DXUKEY,WORKREG=11  GET INTO USER KEY   Y02072 04492002
*                                                                       04502002
         GETMAIN R,LV=(15),SP=0                                  Y02072 04520002
*                                                                       04570002
SD0426A  EQU   *                                               &ZA07619 04580037
         TM    DCBBUFCB+3,NOBUFCB      BUFCB SPECIFIED?        &ZA07619 04581037
         BO    SD04246                 NO, GO FORMAT POOL      &ZA07619 04582037
         L     RJ,DCBBUFCB             YES, GET BUFCB ADDRESS  &ZA07619 04583037
         OI    FLGOFFST(RJ),RAFLAG     SET FLAG SHOWING        &ZA07619 04584037
*                                      REC ADDR PRESENT        &ZA07619 04585037
         ST    RF,8(RJ)                STORE REC-AREA ADDRESS  &ZA07619 04586037
         LH    RJ,DCBLRECL             LOAD LRECL IN WORK REG  &ZA07619 04587037
         LA    RJ,32(RJ)               ADD 32 BYTE CNTRL FIELD &ZA07619 04588037
         ST    RJ,0(RF)                STORE LRECL IN REC-AREA &ZA07619 04589037
         XC    4(32,RF),4(RF)          CLEAR CNTRL FIELD IN    &ZA07619 04590037
*                                      RECORD AREA             &ZA07619 04591037
         B     SD04285                 EXIT                    @ZA12925 04592037
SD04246  ST    RF,0(0,RF)              TEMP. STORE START OF BUF. POOL   04593037
         LR    RWK2,RWK1                SAVE FIRST BUFFER ADDR   Y02072 04600002
         STH   RB,4(0,RF)              STORE BUFNO IN BUF CONTROL BLK   04620037
         STH   RC,6(0,RF)              STORE LNTH IN BUF CONTROL BLK    04630037
         SPACE 2                                                        04660002
         MODESET  EXTKEY=DATAMGT        AUDIT TRAIL IN KEY 5     Y02072 04670002
         SPACE 2                                                        04672002
         OI    FCAOPEN,FCAOBUF          INDIC BUFFERS GETMAINED  Y02072 04674002
         STCM  RWK2,B'0111',DCBBUFCA    BCB ADR TO DCB         @ZA12925 04675037
         SPACE 2                                                        04676002
         MODESET  KEYADDR=DXUKEY,WORKREG=10  BACK TO USER KEY    Y02072 04678002
         SPACE 2                                                        04678402
         LR    RUCB,RF                  GET ADDR.IN WOKR REG.           04680000
         LA    RUCB,8(0,RUCB)           POINT TO SECOND DOUBLE WORD     04700000
         TM    DCBBFTEK,1               DOUBLE WORD ALLIGN.             04720000
         BC    8,TSTLRI                 YES BRANCH               A48163 04740021
         LA    RUCB,4(0,RUCB)           POINT TO FULL NOT DOUBLE        04760000
         B     EXTEND                   GO SET EXTEND FLAG       A48163 04770021
TSTLRI   EQU  *                                                 ZA01372 04772000
         TM    DCBCIND2,DCBCNQSM        IS IT QSAM              ZA01372 04772400
         BNO   SD04250                  NO, DO NOT TEST LRI     ZA01372 04772800
         TM    DCBBFTEK,LRECIND         LRI SUPPORTED           ZA01372 04774000
         BNO   SD04250                  NO, BRANCH TO SAVE FIRST A48163 04776021
*                                        BUFFER ADDRESS          A48163 04778021
         LA    RUCB,DWDLEN(0,RUCB)      YES, OFFSET TO NEXT DW   A48163 04778421
EXTEND   OI    FLGOFFST(RF),EXTND       SET FLAG TO INDICATE     A48163 04778821
*                                       BUFFER CONTROL BLOCK EXTENDED   04779221
*                                                                       04779621
*          THE NEXT SEQUENCE OF INSTRUCTIONS BUILDS A BUFFER POOL       04779721
SD04250  EQU   *                                                        04780000
         LTR   RC,RC                    TST FOR ZERO BUFLN     @ZA19736 04786037
         BNZ   SD04255                  BUFLN ZERO BRANCH!     @ZA19736 04791037
         ST    RC,0(0,RF)               ZERO NXT BUF PTR       @ZA19736 04796037
         B     SD04285                  LEAVE                  @ZA19736 04801037
SD04255  ST    RUCB,0(RF)               STORE BUFFER ADDR.     @ZA19736 04806037
         LR    RF,RUCB                  SAVE NEXT BUFFER ADDR.          04820000
SD04260  EQU   *                                                        04840000
         BCT   RB,SD04280               IF MORE BRANCH                  04860000
         B     SD04283                  EXIT                   &ZA07619 04880037
SD04280  EQU   *                                                        04940000
         ALR   RUCB,RC                  BUFF LEN + BUFF ADDR.           04960000
         ST    RUCB,0(RF)               STORE NEXT BUFF IN LINK         04980000
         ALR   RF,RC                    UPDATE TO NEXT LINK             05000000
         B     SD04260                                                  05020000
SD04283  TM    DCBBFTEK,LRECIND        RECORD AREA NEEDED?     &ZA07619 05020637
         BNO   SD04284                 NO, EXIT                &ZA07619 05021237
         L     RJ,DCBBUFCB             YES,GET BUFFER CNTL BLK &ZA07619 05021837
         TM    FLGOFFST(RJ),EXTND      SPACE AVAILABLE FOR     &ZA07619 05022437
*                                      RECORD AREA?            &ZA07619 05023037
         BNO   DCBERROR                NO, ABEND               &ZA07619 05023637
*                                                              &ZA07619 05024237
GETRALEN EQU   *                                               &ZA07619 05024837
         LH    RJ,DCBLRECL             LOAD LRECL IN WRK REG   &ZA07619 05025437
         LA    RJ,32(RJ)               ADD 32 BYTES FOR CNTRL  &ZA07619 05026037
*                                      INFORMATION             &ZA07619 05026637
         B     SD04240                 GET SPACE FOR REC AREA  &ZA07619 05027237
*                                                              &ZA07619 05027837
SD04284  EQU   *                                               &ZA07619 05028437
         ST    RB,0(RF)                LAST LINK TO ZERO       &ZA07619 05029037
SD04285  EQU   *                                                 Y02072 05030002
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 05032002
***                                                                     05040000
SD04END1 EQU   *                                                 Y02072 05050002
         USING WTGENTRY,RWTGC                                    Y02072 05052002
         MVC   WTGIDTTR,LASTLOAD        MOVE ID TO WTG ENTRY   @Z30TSCF 05060003
         LR    RA,RBASE                SET RA FOR POSSIBLE REPEAT       05080000
**                                                                      05100000
*                                                                       05120000
*          THIS IS AN OPEN PROVIDED SECTION OF CODE THAT SETS UP XCTL   05140000
*                                                                       05160000
*********************************************************************   05180000
*                                                                       05200000
*                                                                       05220000
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)    INCREMENT TO NXT ENTRY IN WRG    05240000
         LA    RPARC,PLOFF(0,RPARC)    INCREMENT TO NXT DCB IN PARAM    05260000
         CLC   0(2,RWTGC),AMIDCNST     IS NXT ALSO DUMMY                05280000
         BCR   8,RA                    YES RETURN TO START              05300000
*                                                                       05320000
         CLC   0(2,RWTGC),OPIDCNST     IS NXT END OF WTG                05340000
         BC    7,RELOOP                NO RETURN TO TEST NXT ENTRY      05360000
*                                                                       05380000
         LR    RPARC,RPAR              INITIALIZE PARAM REGISTER        05400000
         LA    RWTGC,WAOFF(0,RWTG)     INIT. WTGC REG TO START OF WTG   05420000
ZCHEK    CLI   0(RWTGC),X'00'          IS THIS ENTRY COMPLETE           05440000
         BC    7,TCTLRTN           IF NOT TRANSFER CONTROL              05460000
*                                                                       05480000
         LA    RWTGC,WGOFF(0,RWTGC)    INCREMENT TO NXT ENTRY IN WTG    05500000
         LA    RPARC,PLOFF(0,RPARC)    INC. TO NXT DCB IN PARAM LIST    05520000
         BC    15,ZCHEK                                                 05540000
*                                                                       05560000
TCTLRTN  EQU   *                                                        05580000
*                                                                       05600000
         USING WTG,RWTG                                                 05650003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*05700003
               MODID=WTGENTRY                                  @Z30TSCF 05750003
         DROP  RWTGC,RWTG                                      @Z30TSCF 05752003
*                                                                       05760000
WAOFF      EQU   32                                                     05780000
PLOFF    EQU   4                   OFFSET OF DCB ENTRIES                05800000
WGOFF    EQU   8                   OFFSET OF WTG ENTRIES                05820000
OPIDCNST DC    C'0S'                                                    05900000
AMIDCNST DC    C'1C'                                                    05920000
SPLD     DC    C'AV'                    DUMMY ROUTINE            Y02072 05930002
PDLOAD   DC    C'6M',VL3(IGG0196M)      PROB DETER             @Z30TSCF 05932003
LASTLOAD DC    C'11',VL3(IGG01911)      DCB COPY BACK ROUTINE  @Z30TSCF 05934003
*                                                                       05940000
PATCH    DC    25H'0'                   PATCH AREA               Y02072 05950002
END      EQU   *                        END OF MOSULE            Y02072 06000002
         SPACE 6                                                        06080002
ADUMMY   DSECT                                                   A46862 06090021
ADUMPUT  DS    A                   ADDR OF DUMMY PUT RTN         A46862 06092021
ADUMPUTL DS    A                   ADDR OF DUMMY PUT LOCATE RTN  A46862 06094021
ADUMGET  DS    A                   ADDR OF DUMMY GET RTN         A46862 06096021
ADUMCHEK DS    A                   ADDR OF DUMMY CHECK RTN       A46862 06098021
ADUMIOB  DS    A                   ADDR OF DUMMY IOB RTN         A46862 06098421
ADUMBSAM DS    A                   ADDR OF DUMMY BSAM RTN        A46862 06098821
ADUMCNTR DS    A                   ADDR OF DUMMY CNTRL RTN       A46862 06099221
*                                                                       06099621
         EJECT                                                          06104702
         IHAPSA                                                         06106702
         EJECT                                                          06108702
         IGGPARML                                                       06109102
         EJECT                                                          06109802
CVT      DSECT                                                          06114902
***                                                                     06120000
         CVT                                                            06140000
***                                                                     06160000
         IECDSECS MAIN,WTG,DCB,PREFX,EXPAND=YES                @Z30TSCF 06220003
         ORG   WTGIDTTR                                          Y02072 06230002
WTGID    DS    CL2                      NEXT MOD ID              Y02072 06240002
         EJECT                                                          06242002
FORCORE  DSECT                                                   Y02072 06250002
         IHAFCAUD  ORG=YES                                       Y02072 06260002
         EJECT                                                          06262002
         IKJTCB                                                  Y02072 06270002
         EJECT                                                          06270402
         IEZDEB                                                  Y02072 06272002
         END                                                            06280000
