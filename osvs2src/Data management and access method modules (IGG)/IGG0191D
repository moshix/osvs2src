 TITLE 'IGG0191D - OPEN EXECUTOR FOR OUTPUT AND DA DEVICES'             00020002
IGG0191D CSECT                                                          00021203
*MODULE NAME - IGG0191D                                          Y02072 00022403
*                                                                       00023603
*DESCRIPTIVE NAME = BUILD IOBS                                   Y02072 00024803
*                                                                       00026003
*COPYRIGHT - NONE                                                Y02072 00027203
*                                                                       00028403
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00029603
*                                                                       00030803
*           VS2 RELEASE 2 DELETIONS                              Y02072 00032003
*012400,015000,053400,068400,068800,069200,070840,070880-070920, Y02072 00033203
*073480-073500,073502-073600,079400,137200,139900,139920-140240  Y02072 00034403
*200,124900,125800,129800,131200                                 Y02072 00035602
*                                                                YM4697 00035702
*                                                                YM7595 00037002
*                                                                       00037403
*          VS2 RELEASE 3 DELETIONS                                      00037803
*                                                              @Z30TSCF 00038203
*          RELEASE 20 DELETIONS                                       * 00038702
*0973032600-032800,058400-058600,061600,070800,073520-073540,    S20201 00040002
*0973081600-083000,108200-110600,111600-112200,113400-119800,    S20201 00041302
*0973136200-137600,139000,139400,140000                          S20201 00042602
*          RELEASE 21 DELETIONS                                       * 00043902
*0091074000,118800,120300                                        M0131  00045202
*0091004700,130800,134680-134760,139000-140000,140200,147400-    S21042 00046502
*0091147600                                                      S21042 00047802
*0091073502-073506,074600-076400,120000-121000                   A37507 00049102
*                                                                       00050402
*STATUS CHANGE LEVEL 008                                                00051702
*                                                                       00053002
*FUNCTION/OPERATION: THIS ROUTINE WILL SET UP A CODE IN THE DCBCNTRL    00060000
*      FIELD OF THE DCB FOR IGG01910. IGG01910 WILL FROM THIS CODE      00080000
*      DETERMINE WHAT INPUT/OUTPUT ROUTINES WILL BE BROUGHT INTO CORE   00100000
*      AT OPEN TIME. (BASIC)                                            00120000
*      IT WILL DETERMINE HOW MANY IOB'S ARE TO BE CREATED, USE'GETMAIN' 00140000
*      TO GET CORE FOR THE IOB'S, AND CLEAR THE CORE.                   00160000
*      IF THE DCB IS BEING OPENED FOR OUTPUT                            00170019
*      IT WILL LINK THE IOB'S AND INITIALIZE THEM.                      00180000
*      IT WILL CONSTRUCT CHANNEL PROGRAMS NEEDED FOR PROPER EXECUTION.  00200000
*      IT WILL SET UP THE NUMBER OF EXTENTS NEEDED AND PLACE THE        00220000
*      ADDRESSES IN THE DCB AND IOB'S.                                  00240000
*      IT SETS AN AUDIT TRAIL BIT IN THE OPEN WORKAREA           Y02072 00250002
*      INDICATING TO FORCE CLOSE THAT THE CORE GETMAINED FOR THE Y02072 00252002
*      IOB'S CAN BE FREEMAINED.                                  Y02072 00254002
*                                                                       00260000
*      THIS MODULE WAS SPLIT FOR RELEASE 19.  THE RESULTING MODULE      00265019
*      IS IGG0191O.                                                     00270019
*                                                                       00275019
*ENTRY POINTS: ENTERED FROM IGG0191A BY USE OF THE XCTL MACRO.          00280000
*                                                                       00300000
*INPUT: SEE DESCRIPTION OF REGISTERS, DCB(USERS).                       00320000
*OUTPUT: IOB(USER), SEE DESCRIPTION OF THE REGISTERS, DCB(USERS)        00340000
*                                                                       00360000
*                                                                       00380000
*EXTERNAL ROUTINES: NONE.                                               00400000
*                                                                       00420000
*EXITS-NORMAL: XCTL TO IGG01910(IECOSLDA)    TO LOAD ROUTINES           00440000
*                                                                       00460000
*EXITS-ERROR-CALL PROB DET (IGG0196M) FOR WTP AND 013 ABEND,            00466021
*            INSUFFICIENT BUFFERS AVAILABLE IN                          00472021
*            BUFFER POOL TO SATISFY DCB BUFFER REQUIREMENTS       M1552 00480000
*                                                                       00500000
*MACROS : ACTION - MODESET, GETMAIN, XCTL, XCTLTABL              Y02072 00510002
*                                                                       00510402
*MACROS : MAPPING - IECDSECS(DCB,WTG), IHAFCAUD, IHACCW, IEZIOB, IGGBCB 00510802
*                                                                       00512002
*TABLES/WORKAREAS-  WHERE TO GO TABLE  (WTG)                            00520000
*                                                                       00540000
*   BYTE 0-7   NAME                                                     00560000
*   BYTE 8-10  RELATIVE DISK ADDRESS (TTR) OF FIRST RECORD              00580000
*   BYTE 11    CONCATENATION NUMBER                                     00600000
*   BYTE 12    ZERO                                                     00620000
*   BYTE 13    ALIAS INDICATOR AND USER DATA FIELD DESCRIPTOR:          00640000
*              ALIAS INDICATOR 1 BIT                                    00660000
*              NUMBER OF TTRS IN USERS DATA FIELD  2 BITS               00680000
*   BYTE 14-16 TTR OF FIRST TEXT RECORD                                 00700000
*   BYTE 17    ZERO                                                     00720000
*   BYTE 18-19 TTR OF NOTE LIST OR SCATTER LIST                         00740000
*   BYTE 20    TRANSLATION TABLE                                        00760000
*   BYTE 21    ZERO OR NUMBER OF ENTRIES IN THE NOTE LIST               00780000
*   BYTE 22-23 ATTRIBUTES                                               00800000
*   BYTE 24-26 TOTAL CONTIGUOUS MAIN STORAGE REQUIRED FOR MODULE        00820000
*   BYTE 27-28 LENGTH OF FIRST TEXT RECORD                              00840000
*   BYTE 29    LENGTH OF WTG TABLE  (IN DOUBLE WORDS)                   00860000
*   BYTE 30-31 PATH THROUGH LOADS OF ROUTINES                           00880000
*   BYTE 32-34 IDTTR OF EXECUTOR FOR 1ST DCB                            00900000
*   BYTE 35    WORKAREA ADDRESS FOR 1ST DCB                             00920000
*   BYTE 36-39 TABLE OF IDTTR'S                                         00940000
*                                                                       00960000
*        32+N(8)   IDTTR OF EXECUTOR FOR NTH DCB      (3 BYTES)         00980000
*                  WORKAREA ADDRESS FOR NTH DCB       (1 BYTE)          01000000
*                  IDTTR OF LAST ROUTINE  LOAD        (3 BYTES)         01020000
*                  NOT USED                           (1 BYTE)          01040000
*                                                                       01060000
*                                                                       01080000
*********************************************************************** 01100000
*ATTRIBUTES: REENTRANT, REUSABLE, SUPERVISOR STATE,              Y02072 01120002
*            RUNS IN USER KEY UNLESS OTHERWISE SPECIFIED.        Y02072 01130002
*                                                                       01140000
*                                                                       01160000
*********************************************************************** 01180000
*                                                                       01200000
*                                                                       01220000
*  REGISTER CONVENTIONS USED                                            01240002
*                                                                       01260000
*********************************************************************** 01280000
*                                                                       01300000
RDCB     EQU   2         DCB REGISTER                                   01320000
RBASE    EQU   3         BASE REGISTER                                  01340000
RCORE    EQU   4         WORK AREA ADDRESS                              01360000
RPAR     EQU   5         TOP OF PARAMETER LIST                          01380000
RWTG     EQU   6         TOP OF WTG TABLE                               01400000
RPARC    EQU   7         CURRENT PARAMETER                              01420000
RWTGC    EQU   8         CURRENT TRANS LOAD                             01440000
RBUFADR  EQU   9                        MAINTAINS ADDR OF NEXT   Y02072 01450002
*                                         AVAILABLE BUFFER       Y02072 01460002
RUCB     EQU   10        USED HERE AS A COUNTER IN IOB GENERATION       01480000
RWK1     EQU   11        WORK REGISTER                           Y02072 01500002
RB       EQU   12        WORK REG1  **                                  01520000
RWK3     EQU   RB                       WORK REGISTER            Y02072 01530002
RC       EQU   13        WORK REG2  **  USED IN IOB GENERATION          01540000
RWK2     EQU   RC                       WORK REGISTER            Y02072 01550002
RD       EQU   14        WORK REG3  **                                  01560000
RJ       EQU   15        WORK REG4                                      01580000
RWK4     EQU   RJ        WORK REG                                YM7595 01590002
RE       EQU   0         WORK REG5                                      01600000
RF       EQU   1         WORK REG6                                      01620000
*                                                                       01640000
*                                                                       01660000
PARAR    EQU   RPARC                                                    01680000
*                                                                       01700000
*********************************************************************** 01720000
*                                                                       01740000
*                                                                       01760000
*                                                                       01780000
*********************************************************************   01800000
* MASK'S TO TEST PARAMETER LIST WITH                                    01820000
INP      EQU   X'0F'                                                    01840000
OUTP       EQU   X'0F'                                                  01860000
UPDATE     EQU   X'04'                                                  01880000
INOUT      EQU   X'03'                                                  01900000
OUTIN      EQU   X'07'                                                  01920000
RDBACK     EQU   X'01'                                                  01940000
*                                                                       01960000
*                                                                       01980000
*********************************************************************   02000000
*                                                                       02020000
*                                                                       02040000
* OFFSET FOR PARAMETER TESTS                                            02060000
*                                                                       02080000
ONE        EQU   X'01'                                                  02100000
FRTYATE    EQU   48                                                     02120000
DISPSN     EQU   X'0'                                                   02140000
*                                                                       02160000
*                                                                       02180000
*********************************************************************   02200000
*                                                                       02220000
* OFFSETS FOR DEB REFERENCE                                             02240000
*                                                                       02260000
*                                                                       02280000
BIN        EQU   36                     BIN NOS.                   DM0I 02300000
BEXT       EQU   38                     BIN EXTENT                 DM0I 02320000
*                                                                       02340000
*                                                                       02360000
*                                                                       02380000
*********************************************************************   02400000
*                                                                       02420000
* MASK'S USED TO TEST OPTION FIELDS IN DCB                              02440000
*                                                                       02460000
*                                                                       02480000
*                                                                       02500000
DOUBLE     EQU   X'01'                                                  02520000
*                                                                       02540000
*                                                                       02560000
STOWB      EQU   X'80'                                                  02580000
WRTCK      EQU   X'80'                  WRITE CHECK                DM0I 02600000
OVRFLO     EQU   X'20'                                                  02620000
PCI        EQU   X'20'                                                  02640000
MINKEY     EQU   X'01'                                                  02660000
CONCAT     EQU   X'FF'                                                  02680000
*                                                                       02700000
*********************************************************************   02720000
*                                                                       02740000
* MASKS FOR ACCESS METHODS IN SAM                                       02760000
*                                                                       02780000
QSAMB      EQU   X'01'                                                  02800000
BSAMBIT    EQU   X'00'                                                  02820000
PAM        EQU   X'02'                                                  02840000
*                                                                       02860000
*                                                                       02880000
* MASKS FOR MACRO'S TO BE USED                                          02900000
*                                                                       02920000
GETB       EQU   X'40'                                                  02940000
PUTB       EQU   X'40'                                                  02960000
READB      EQU   X'20'                                                  02980000
WRITEB     EQU   X'20'                                                  03000000
POINTB     EQU   X'04'                                                  03020000
CNTRLB     EQU   X'02'                                                  03040000
*                                                                       03060000
*                                                                       03080000
*********************************************************************   03100000
*                                                                       03120000
* MASKS FOR DEVICES TO BE SUPPORTED                                     03140000
*                                                                       03160000
*                                                                       03180000
*                                                                       03200000
*********************************************************************   03220000
*                                                                       03240000
*                                                                       03242020
* DISPLACEMENTS AND BYTE COUNTS AS EQUATES                              03244020
*                                                                       03246020
D0       EQU   0                        DISPLACEMENTS OF ZERO    S20201 03248020
D5       EQU   5                        DISPLACEMENTS OF FIVE    S20201 03250020
D6       EQU   6                        DISPLACEMENTS OF SIX     S20201 03252020
B1       EQU   1                        BYTE COUNT OF ONE        S20201 03254020
B8       EQU   8                        BYTE COUNT OF EIGHT      S20201 03256020
B16      EQU   16                       BYTE COUNT OF SIXTEEN    S20201 03258020
B24      EQU   24                       BYTE COUNT OF TWENTYFOUR S20201 03260020
*                                                                       03262020
FIVE     EQU   5                        BYTE COUNT OF FIVE       S20201 03264020
SIX      EQU   6                        LNGH CHP WITH RCD READY  S20201 03266020
*                                       DW                       S20201 03268020
TEN      EQU   X'0A'                    LNGH CHP WRT CHK + RCD   S20201 03270020
*                                       RDY                      S20201 03272020
MAX      EQU   255                      MAX COUNT FOR EXEC INST  S20201 03274020
INPBIOB  EQU   80                       BASIC INPUT IOB SIZE     S20201 03276020
*                                                                       03278020
*                                                                       03280020
*                                                                       03282020
FLAGOFF  EQU   4                        OFFSET IN CCW TO FLAGS   S20201 03284020
CNTOFF   EQU   7                        OFFSET IN CCW TO CNT FLD S20201 03286020
SDFLG    EQU   X'08'                    SEARCH DIRECT INDICATOR  S20201 03288020
SDOPT    EQU   X'01'                    SEARCH DIRECT MASK       S20201 03290020
*                                                                       03292020
*                                                                       03300000
*********************************************************************   03320000
*                                                                       03340000
* MASKS FOR STATUS BITS TO BE TESTED                                    03360000
*                                                                       03380000
*                                                                       03400000
EXCPN      EQU   X'30'                                                  03420000
COMPLETE   EQU   X'60'                  COMPLETE MASK              DM0I 03440000
FIRSTIOB   EQU   X'01'                                                  03460000
*                                                                       03480000
*                                                                       03500000
*                                                                       03520000
*********************************************************************   03540000
*                                                                       03560000
* MASKS FOR BUFFER TECHNIQUE'S                                          03580000
*                                                                       03600000
CYCLICB    EQU   X'20'                                                  03620000
EXCHANGB   EQU   X'10'                                                  03640000
SIMPLEB    EQU   X'40'                                                  03660000
EXCHCYCL   EQU   X'30'                                                  03680000
*                                                                       03700000
*********************************************************************   03720000
*                                                                       03740000
*                                                                       03760000
* MODES OF OPERATION FOR QSAM                                           03780000
*                                                                       03800000
LOCATEB    EQU   X'08'                                                  03820000
MOVEB      EQU   X'10'                                                  03840000
SUBSTUTB   EQU   X'04'                                                  03860000
*                                                                       03880000
*                                                                       03900000
*********************************************************************   03920000
*                                                                       03940000
*                                                                       03960000
* COMMAND BYTES FOR THE 2841                                            03980000
*                                                                       04000000
*       CONTROL UNIT                                                    04020000
*                                                                       04040000
*                                                                       04060000
*                                                                       04080000
SRCHE      EQU   X'31'                                                  04100000
WRTCKD     EQU   X'1D'                                                  04120000
RDC        EQU   X'92'                                                  04140000
RDKD       EQU   X'8E'                                                  04160000
RDD        EQU   X'86'                                                  04180000
TIC        EQU   X'08'                                                  04200000
SETSC    EQU   X'23'                    SET SECTOR CCW CMND      S20201 04205020
RDSC     EQU   X'22'                    READ SECTOR CCW CMND     S20201 04210020
*                                                                       04215020
*                                                                       04220000
*                                                                       04240000
*********************************************************************   04260000
*                                                                       04280000
*                                                                       04300000
* MASKS FOR RECORD FORMATS                                              04320000
*                                                                       04340000
*                                                                       04360000
STANDRDF   EQU   X'88'                  STANDARD FORMORT           DM0I 04380000
FORMATU    EQU   X'C0'                                                  04400000
FORMATF    EQU   X'80'                                                  04420000
FORMATV    EQU   X'40'                                                  04440000
BLOCKED    EQU   X'10'                                                  04460000
*                                                                       04480000
*                                                                       04500000
*********************************************************************   04520000
*                                                                       04540000
*                                                                       04560000
*   CHANNEL CONTROL WORD FLAGS                                          04580000
*                                                                       04600000
SKIP       EQU   X'10'                                                  04620000
SLI        EQU   X'20'                                                  04640000
CC         EQU   X'40'                                                  04660000
DATACH     EQU   X'A0'                                                  04680000
SLICC      EQU   X'60'                                                  04700000
SLICCSK    EQU   X'70'                                                  04720000
*                                                                       04740000
*                                                                       04760000
*********************************************************************   04780000
*                                                                       04800000
*                                                                       04820000
KEYS       EQU   X'01'                                                  04840000
QSAM       EQU   X'01'                                                  04860000
NORCDRY  EQU   X'20'                    NO RECORD READY          S20201 04865020
*                                       INDICATOR                S20201 04870020
*                                       MASK                            04875020
*                                                                       04880000
*                                                                       04900000
*********************************************************************   04920000
*                                                                       04940000
GETMAIN    EQU   4                                                      04960000
QSAMZ      EQU   X'05'                  MASK                       DM0I 04980000
COMMTABL   EQU   16                     MASK                       DM0I 05000000
IDTTR      EQU   5                      LENGTH OF IDTTR FOR MVC  S19015 05005019
CPINCR     EQU   24                     CP INCREMENT--OFFSET     S19015 05010019
*                                       READ                     S19015 05015019
NOROUT     EQU   0                      TO INDICATE NO EOB       S19015 05020019
*                                       NEEDED                   S19015 05025019
BFTEKR     EQU   X'20'                  BDAM VS SUPPORT          S19015 05030019
VSBITS     EQU   X'48'                  VS BITS IN DCBRECFM      S19015 05035019
UNRELFLG EQU   X'02'                   IOB UNRELATED FLAG        A37507 05037021
*********************************************************************   05040000
OABD060  EQU   60                                                S21042 05050021
*                                                                       05060000
*                                                                       05080000
*                                                                       05100000
*                                                                       05120000
*                                                                       05140000
*                                                                       05180000
*                                                                       05200000
*                                                                       05220000
         BALR  RBASE,0                  REG 3 IS BASE                   05240000
         USING SOP2,RBASE                                               05260000
         USING IHADCB,RDCB              REG 2 IS DCB                    05280000
         USING FORCORE,RCORE            REG 4 IS WORK AREA ADDR         05320000
*                                                                       05360000
*                                                                       05380000
*                                                                       05400000
*                                                                       05420000
SOP2     EQU   *                                                        05440000
*                                                                       05460000
         B     BEGIN                    BR AROUND CONSTANTS      Y02072 05470002
         DC    C'IGG0191D'              MODULE NAME              Y02072 05472002
         DC    C'@Z30TSCF'              LAST SHIP CODE         @Z30TSCF 05474003
         DC    C'10/18/74'              LAST DATE MODIFIED     @Z30TSCF 05476003
BEGIN    DS    0H                                                Y02072 05478002
         L     RDCB,0(RPARC)            GET DCB ADDRESS                 05480000
         LA    RDCB,0(RDCB)             CLEAR HI BYTE                   05500000
         L     RCORE,4(RWTGC)           GET WORK AREA ADDRESS           05520000
*                                                                       05540000
         SR    RC,RC                    READY A WORK REG                05560000
         TM    DISPSN(RPARC),INP        FILE FOR INPUT                  05580000
         BC    7,SOP230                 NO BRANCH                       05600000
*                                                                       05620000
         TM    DCBMACRF,POINTB         POINT MACRO USED                 05640000
         BC    1,SOP220A               YES BRANCH TO STANDARD F RECS    05660000
*                                                                       05680000
SOP220   TM    DCBRECFM,STANDRDF        STANDARD F RECORDS USED         05700000
         BC    1,SOP221                 YES BRANCH                      05720000
*                                                                       05740000
*                                                                       05760000
SOP220A  EQU   *                                                        05780000
         MVI   DCBCNTRL+3,2             EGP2 ID NUMBER                  05800000
         LA    RC,8                     INCREMENT FOR NON SF RECS 20185 05820018
         TM    DCBCIND2,QSAMB           DATA SET FOR QSAM        S19015 05822019
         BO    SOP221                   YES--BRANCH              S19015 05824019
         TM    DCBBFTEK,BFTEKR          OFFSET READ              S19015 05826019
         BZ    SOP221                   NO--BRANCH               S19015 05828019
         LA    RC,CPINCR(RC)            INCREMENT FOR OFFSET     S19015 05830019
*                                       READ                     S19015 05832019
         MVI   DCBCNTRX,NOROUT          NO EOB ROUT NEEDED       S19015 05834019
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD      S20201 05837020
*                                       READY                    S20201 05840020
         BO    SOP225                   BRANCH IF YES, EXTRA     S20201 05843020
*                                       SPACE                    S20201 05846020
*                                       ALREADY ACQUIRED BY OFFSET      05849020
*                                       REA                             05852020
SOP221   EQU   *                                                 S20201 05855020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD      S20201 05858020
*                                       READY                    S20201 05861020
         BO    SOP225                   BRANCH IF YES            S20201 05864020
         LA    RC,B24(RC)               INCR FOR RCD READY       S20201 05867020
SOP225   EQU   *                                                 S20201 05870020
         LA    RC,INPBIOB(RC)           INCR FOR READ IOB        S20201 05873020
         B     SOP235                   GO TO GET CORE           S20201 05876020
*                                                                       05880000
*                                                                       05900000
SOP230   LA    RC,88                    AMT CORE NEEDED FOR OUTPUT IOB  05920000
         MVI   DCBCNTRX,QSAM            MOVE ID                    DM0I 05940000
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD      S20201 05943020
*                                       READY                    S20201 05946020
         BO    SOP233                   BRANCH IF YES            S20201 05949020
         LA    RC,B16(RC)               INCR FOR RCD READY       S20201 05952020
SOP233   EQU   *                                                 S20201 05955020
         TM    DCBOPTCD,WRTCK           WRITE VALIDITY CHECK USED       05960000
         BC    14,SOP235                NO BRANCH                       05980000
*                                                                       06000000
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD      S20201 06002020
*                                       READY                    S20201 06004020
         BO    SOP233A                  BRANCH IF YES            S20201 06006020
         LA    RC,B8(RC)                INCR FOR RCD READY       S20201 06008020
SOP233A  EQU   *                                                 S20201 06010020
*                                                                       06012020
         LA    RC,24(RC)                AMT SPACE NEEDED FOR WRT CK CP. 06020000
*                                                                       06040000
*                                                                       06060000
*     AT THIS POINT  RC=REG.13 HAS THE SIZE OF AN IOB IN IT             06080000
*                                                                       06100000
*                                                                       06120000
SOP235   EQU   *                                                        06140000
         TM    JFCBMASK+D6,SDFLG        SEARCH DIRECT            S20201 06145020
         BNO   NOSD1                    BRANCH NO                S20201 06150020
         LA    RC,B16(RC)               INCR IOB SIZE            S20201 06155020
*                                                                       06160020
NOSD1    EQU   *                                                 S20201 06165020
*                                                                       06170020
         SRL   RC,3                     IOB IN DOUBLE WORDS             06180000
         STC   RC,DCBIOBL               STORE IN DCB                    06200000
         SLL   RC,3                     RESET IOB SIZE                  06220000
*                                                                       06240000
         SR    RF,RF                                                    06260000
         TM    DCBCIND2,QSAMB           DATA SET FOR QSAM               06280000
         BC    14,SOP237                NO BRANCH                       06300000
*                                                                       06320000
*                                                                       06340000
         IC    RF,DCBBUFNO              GET NUMBER OF IOBS TO BUILD     06360000
         B     SOP239                   SKIP TO NEXT               DM0I 06380000
*                                                                       06400000
*                                                                       06420000
SOP237   EQU   *                                                        06440000
*                                                                       06460000
         IC    RF,DCBNCP                GET NUMBER OF IOBS TO BUILD     06480000
         LTR   RF,RF                    HAS THIS BEEN SPECIFIED         06500000
         BC    7,SOP239                 YES BRANCH                      06520000
*                                                                       06540000
         LA    RF,1                     SUPPLY 1 FOR USER               06560000
         STC   RF,DCBNCP                SAVE FOR NOW                    06580000
*                                                                       06600000
SOP239   EQU   *                                                        06620000
*                                                                       06640000
         LR    RUCB,RF                                                  06660000
*                                                                       06680000
*                                                                       06700000
*********************************************************************** 06720000
*                                                                       06740000
         MR    RE,RC                    COMPUTE TOTAL AMT SPACE NEEDED  06760000
*                                                                       06762020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD      S20201 06764020
*                                       READY                    S20201 06766020
         BO    SOP239A                  BRANCH IF YES            S20201 06768020
         LA    RF,B8(RF)                INCR FOR THETA VALUES    S20201 06770020
SOP239A  EQU   *                                                 S20201 06772020
         LR    RD,RF                                                    06780000
         LR    RB,RF                    SAVE FOR FUTURE USE             06800000
*                                                                       06820000
*  THE FOLLOWING SAVES THE AMOUNT OF CORE GETMAINED FOR THE IOBS YM4697 06822002
*  IN THE FORCE CLOSE AUDIT TRAIL FOR THE FORCE CLOSE EXECUTOR.  YM4697 06824002
*                                                                       06828002
         ST    RD,DXATEXC2              SAVE LENGTH              YM4697 06828402
*                                                                       06828802
         MODESET  KEYADDR=DXUKEY,WORKREG=11 GET INTO USER KEY    Y02072 06830002
*                                                                       06860000
         GETMAIN R,LV=(RD),SP=0                                  Y02072 06880002
*                                                                       06900000
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 06910002
**                                                                      06940000
*    THIS SECTION CLEARS THE SPACE RECIEVED FROM GETMAIN                06960000
**                                                                      06980000
*                                                                       07000000
         LR    RJ,RB                    RESTORE LENGTH TO CLEAR         07020000
         LA    RE,B8                    CONSTANT OF EIGHT        S20201 07030020
         ST    RF,DCBIOBA               SAVE FIRST IOB ADDRESS          07040000
         OI    FCAOPEN,FCAOIOB          OK TO FREE IOB CORE      Y02072 07050002
         BCTR  RJ,0                     REDUCE AMT BT ONE               07060000
*                                                                       07064020
* OBTAIN  THETA ADDRESSES MAY BE USED LATER                             07068020
*                                                                       07072020
         AR    RB,RF                    GET ADDR TOTAL AREA + 1  S20201 07076020
         SR    RB,RE                    BACK UP A DW             S20201 07080020
         ST    RB,DXCCW11               TEMP STORE SECT ADDR     Y02072 07084002
         LA    RB,MAX                   GET MAX EXECUTE VALVE    S20201 07096020
         MODESET  KEYADDR=DXUKEY,WORKREG=11 GET INTO USER KEY    Y02072 07096402
COMPARE  CR    RJ,RB                    IS AMT TO CLEAR GREATER 255     07100000
         BC    12,ONECLEAR              NO BRANCH                       07120000
*                                                                       07140000
         EX    RB,CLEAR                 CLEAR 256 BYTES                 07160000
         SR    RJ,RB                    SUBT 255 FROM AMT TO BE CLEARED 07180000
         BCTR  RJ,0                     SUBT ONE MORE BYTE              07200000
         LA    RF,256(RF)               UPDATE AREA ADDR BY 256         07220000
         B     COMPARE                  CHECK AGAIN                DM0I 07240000
*                                                                       07260000
CLEAR    XC    0(1,RF),0(RF)            ACTUAL CLEAR INSTRUCTION        07280000
*                                                                       07300000
ONECLEAR EX    RJ,CLEAR                 CLEARS LESS THAN 256            07320000
*                                                                       07340000
         L     RB,DCBIOBA              GET IOB ADDR              A37507 07340221
         CH    RUCB,ONEIOB             ONE IOB?                  A37507 07340421
         BNE   NTONEIOB                NO, BRANCH                A37507 07340621
         USING IOBQSAMN,RWK3            ESTABLISH ADDR FOR IOB          07340702
*                                       DSECT                    A37507 07341021
         OI    IOBFLAG1,IOBUNREL       YES, SET UNRELATED FLAG   Y02072 07341202
         DROP  RWK3                                                     07341402
NTONEIOB EQU   *                                                 A37507 07341621
         TM    DISPSN(RPARC),INP        FILE FOR INPUT           S19015 07342019
         BO    SOP240A                  NO--CP WILL BE BUILT     S19015 07344019
*                                       HERE                     S19015 07346019
         MODESET  EXTKEY=DATAMGT                                 Y02072 07359602
         USING WTGENTRY,RWTGC                                    Y02072 07359702
         MVC   WTGIDTTR,SOPSLDIN       CP TO BE BUILT IN 1910  @Z30TSCF 07360003
         TM    JFCBMASK+D6,SDFLG        SEARCH DIRECT USED       S20201 07367202
         BNO   NOSD5                    BRANCH NO                S20201 07368802
         MVC   WTGIDTTR,SOPSD         MOVE IN SEARCH DIRECT ID @Z30TSCF 07370403
NOSD5    EQU   *                                                 S20201 07375202
         B     RELOOP                   GO PROCESS DCBS          S20201 07376802
*                                                                       07378402
*                                                                       07380000
SOP240A  EQU   *                                                 S19015 07390019
         LR    RC,RB                    SET UP WORK REG                 07420000
         LR    RD,RB                    SET UP WORK REG                 07440000
         SPACE 2                                                        07660000
*                                                                       07680000
SOP242   EQU   *                                                        07700000
*                                                                       07720000
         ST    RB,0(RD)                 LINK NEW IOB TO LAST ONE BUILT  07740000
         LR    RD,RB                    UPDATE CURRENT IOB POINTER      07760000
         LA    RB,4(RB)                 POINT TO ECB SLOT               07780000
         OI    0(RB),X'7F'              SET ECB COMPLETE WITHOUT ERROR  07800000
         ST    RB,12(RD)                STORE ECB ADDR IN IOB           07820000
         LA    RB,20(RB)                POINT TO CP POINTER SLOT        07840000
         LR    RC,RB                    SAVE ADDR                       07860000
         LA    RB,24(RB)                POINT TO CP START ADDR          07880000
SOP243   EQU   *                                                        07900000
         ST    RB,0(RC)                 STORE CP STARTAD IN IOB         07920000
         L     RWK1,DXUDCBAD            GET ADDR OF USERS DCB    Y02072 07930002
         USING IOBSIOCC,RWK2                                     Y02072 07940002
         ST    RWK1,IOBDCBPT            USERS DCB ADDR TO IOB    Y02072 07942002
         DROP  RWK2                                              Y02072 07944002
         MVC   40(8,RD),DCBFDAD        INITIALIZE IOBFDAD.              07950013
*                                                                       07960000
*********************************************************************** 07980000
*                                                                       08000000
*     CONSTRUCTION OF CHANNEL PROGRAM FOLLOWS                           08020000
*                                                                       08040000
*********************************************************************** 08060000
*                                                                       08080000
SOP255   EQU   *                                                        08100000
*                                                                       08120000
         LA    RC,19(RC)                POINT TO CCHHR FIELD IN IOB     08140000
*                                                                       08148020
* CHECK FOR RCD READY FEATURE ON ALL DEVICES FOR DATA SET AND IF ON     08156020
* ALL DEVICES BUILD RCD READY CHPS, BIT 2 OF JFCBMASK BEING A ONE       08164020
* SAYS ALL DEVICES DO NOT HAVE RCD READY FEATURE                        08172020
*                                                                       08180020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD      S20201 08188020
*                                       READY                    S20201 08196020
         BO    SOP257                   BRANCH IF YES            S20201 08204020
         BAL   RJ,SOP2STA               GO BUILD SET SECTOR CMND S20201 08212020
SOP257   EQU   *                                                 S20201 08220020
*                                                                       08228020
         BAL   RJ,SOP2SCH               GO BUILD SRCH AND TIC    S20201 08236020
*                                                                       08244020
         SR    RC,RC                    CLEAR REG                S20201 08252020
         IC    RC,DCBKEYLE              GET KL                   S20201 08260020
         AH    RC,DCBBLKSI              ADD DL                   S20201 08268020
         SR    RB,RE                    BACK UP CCW PTR          S20201 08276020
         STH   RC,D6(RB)                KL+DL IN RH OF TIC FOR   S20201 08284020
*                                       EOB                      S20201 08292020
*                                       ROUTINE                         08300020
         AR    RB,RE                    RESTORE CCW PTR          S20201 08308020
*                                                                       08320000
*     SRCH AND TIC CCWS HAVE BEEN GENERATED AT THIS POINT               08340000
*                                                                       08360000
*********************************************************************** 08380000
*                                                                       08400000
*                                                                       10540000
*********************************************************************** 10560000
*                                                                       10580000
*     CONSTRUCTION OF WRITE CHANNEL PROGRAMS FOLLOW                     10600000
*                                                                       10620000
*********************************************************************** 10640000
*                                                                       10660000
*                                                                       10680000
SOP260   EQU   *                                                        10700000
         LR    RC,RB                    TEMP HOLD ADDR OF WCKD   S20201 10820020
         OI    FLAGOFF(RB),DATACH       SET FLAGS                S20201 10840020
         MVI   CNTOFF(RB),B8            SET BYTE COUNT TO EIGHT  S20201 10860020
         AR    RB,RE                    INCR CCW PTR             S20201 10880020
*                                                                       10900020
         LR    RF,RB                    GET ADDR OF WRT CCW      S20201 10920020
         SR    RB,RD                    GET WRT CCW OFFSET       S20201 10940020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 10942002
         STC   RB,DCBOFFSW              PUT IN DCB               S20201 10960020
         TM    DCBMACRF+1,POINTB        NOTE-POINT NEEDED               10960402
         BZ    AA                       BRANCH IF ZEROS            DM0I 10960802
         MVI   DCBCNTRZ,QSAMZ           MOVE ID                    DM0I 10961202
AA       EQU   *                        COME HERE                  DM0I 10961602
         MVI   DCBWCPO,48               OFFSET FOR START OF CP.         10961702
         MVI   DCBWCPL,X'04'            WRT C.P. LEN IN DBLE WRDS       10961802
         MODESET  KEYADDR=DXUKEY,WORKREG=11 GET INTO USER KEY    Y02072 10962002
         AR    RB,RD                    RESTORE PTR              S20201 10980020
*                                                                       11080000
         TM    DCBCIND2,QSAMB           IS QSAM USED                    11100000
         BC    14,SOP262                NO BRANCH                       11120000
*                                                                       11140000
* FILL IN BUFFER ADDRESS AND BYTE COUNT                                 11150002
*                                                                       11152020
         L     RWK4,DCBBUFCB            BUFFER CNTRL BLK ADDRESS YM7595 11162002
         USING BCBLK,RWK4                                        YM7595 11164002
         L     RBUFADR,BCBBUFPT         NEXT AVAIL BUFFER        YM7595 11166002
         LTR   RBUFADR,RBUFADR          IS BUFFER ADDR ZERO      YM7595 11168002
         BZ    BUFERR                   YES, ISSUE DMABCOND      YM7595 11168402
         USING CCW,RF                                            YM7595 11168802
         STCM  RBUFADR,B'0111',CCWADDRB  BUFFER ADDR TO CCW      YM7595 11169202
         MVC   CCWBYTE,DCBBLKSI         BYTE COUNT TO CCW        YM7595 11169602
         USING BUFFER,RBUFADR                                    YM7595 11169702
         MVC   BCBBUFAD,BUFNXPTB        UPDATE TO NEXT AVAIL BUF YM7595 11169802
         DROP  RWK4,RBUFADR,RF                                   YM7595 11169902
SOP262   EQU   *                                                 S20201 11170020
         AR    RB,RE                    INCR PTR                 S20201 11176020
*                                                                       11182020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD      S20201 11188020
*                                       READY                    S20201 11194020
         BO    SOP265                   BRANCH IF YES            S20201 11200020
         BAL   RJ,SOP2RTA               GO BUILD RD SECTOR CMND  S20201 11206020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 11208002
         MVI   DCBWCPL,SIX              SET CHP LENGTH TO        S20201 11212020
*                                       INCLUDE                  S20201 11218020
*                                       RCD RDY                         11224020
         MODESET  KEYADDR=DXUKEY,WORKREG=11 GET INTO USER KEY    Y02072 11226002
SOP265   EQU   *                                                 S20201 11230020
         TM    DCBOPTCD,WRTCK           IS WRITE VALIDITY CHECK SPEC    11240000
         BC    14,SOP263               NO. BRANCH                       11260000
*                                                                       11280000
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 11282002
         MVI   DCBWCPL,X'07'            WRITE CHAN PORG LENGTH IF       11300000
*                                       WRITE CHECK IS SPECIFIED        11320000
         MODESET  KEYADDR=DXUKEY,WORKREG=11 GET INTO USER KEY    Y02072 11320402
         SR    RB,RE                    BACK UP CCW PTR          S20201 11330020
         OI    FLAGOFF(RB),CC           SET CMND CHAIN IN        S20201 11340020
*                                       PREVIOUS                 S20201 11350020
*                                       CCW                             11360020
         AR    RB,RE                    RESTORE PTR              S20201 11370020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD      S20201 11380020
*                                       READY                    S20201 11390020
         BO    SOP262A                  BRANCH IF YES            S20201 11400020
         BAL   RJ,SOP2RTA               GO TO RD SECT BUILD RTN  S20201 11410020
         SR    RB,RE                    BACKUP CCW PTR           S20201 11420020
         OI    FLAGOFF(RB),CC           TURN ON CMND CHAIN       S20201 11430020
         MVI   D0(RB),SETSC             CHANGE CMND TO SET SECT  S20201 11440020
         AR    RB,RE                    RESTORE PTR              S20201 11450020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 11450402
         MVI   DCBWCPL,TEN              SET CHP SIZE TO INCLD.   S20201 11460020
*                                       RCD                      S20201 11470020
         MODESET  KEYADDR=DXUKEY,WORKREG=11 GET INTO USER KEY    Y02072 11470402
SOP262A  EQU   *                                                 S20201 11480020
         LA    RF,B24(RB)               PT RF TO CNT FIELD AT    S20201 11490020
*                                       END                      S20201 11500020
*                                       CHANNEL PROG                    11510020
*                                                                       11520020
         ST    RF,D0(RC)                PUT ADD IN WRT CKD CCW   S20201 11530020
         MVI   D0(RC),WRTCKD            PUT IN CCW CMND          S20201 11540020
*                                                                       11550020
         LR    RC,RF                    PUT ADDR IN REG FOR SRCH S20201 11560020
*                                       AND TIC RTN                     11570020
         BAL   RJ,SOP2SCH               GO BLD SCH CCW           S20201 11580020
*                                                                       11590020
         MVI   D0(RB),RDKD              SET READ CMND FOR WRT    S20201 11600020
*                                       CHK                      S20201 11610020
         OI    FLAGOFF(RB),SKIP         TURN ON SKIP FLAG        S20201 11620020
         AR    RB,RE                    INCR PTR                 S20201 11630020
*                                                                       11640020
         B     SOP266                   GO TO FIN IOB            S20201 11650020
SOP263   EQU   *                                                 S20201 11660020
         ST    RB,D0(RC)                PUT ADDR IN WRT CKD      S20201 11670020
         MVI   D0(RC),WRTCKD            PUT IN WRT CKD CMND      S20201 11680020
*                                                                       11690020
*                                                                       11700020
SOP266   EQU   *                                                 S20201 11710020
         MVC   D5(B1,RB),DCBKEYLE       INIT KEY LENGTH          S20201 11720020
         AR    RB,RE                    INCR PTR                 S20201 11730020
         BCT   RUCB,SOP242             NOT LAST IOB - BRANCH     A37507 11780021
         MODESET  EXTKEY=DATAMGT        KEY OF AUDIT TRAIL              11790002
         SPACE                                                          11800002
         OI    FCAOPEN2,FCAOIOBC        IOBS COMPLETED           YM7595 11810002
         MODESET  KEYADDR=DXUKEY,WORKREG=12                             11820002
         SPACE                                                          11822002
         L     RB,DCBIOBA              LAST IOB - LINK IOB'S     A37507 11830021
         USING IOBQSAMN,RD              ESTABLISH ADDR FOR IOB          11880002
*                                       DSECT                    A37507 11930021
         ST    RB,IOBNIOBA                FIRST TO LAST          A37507 11980021
         DROP  RD                                                       12050002
*                                                                       12120000
*********************************************************************** 12140000
*                                                                       12160000
SOP2END  EQU   *                                                        12180000
*                                                                       12200000
*                                                                       12220000
*********************************************************************** 12240000
         TM    DCBDSORG,X'02'          DCB FOR PO                       12260000
         BC    8,SOP2ENDA              NO, BRANCH                       12280000
*                                                                       12300000
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 12302002
         MVI   DCBCNTRZ,QSAMZ                                      DM0I 12320000
         MODESET  KEYADDR=DXUKEY,WORKREG=11 GET INTO USER KEY    Y02072 12322002
*                                                                       12340000
SOP2ENDA EQU   *                                                        12360000
*                                                                       12380000
         L     RB,DCBIOBA               GET FIRST IOB                   12400000
         OI    0(RB),FIRSTIOB           SET INDICATOR ON FOR CLOSE      12420000
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 12440402
         TM    DCBRECFM,FORMATV         VARIABLE FORMAT ?          DM0I 12450000
         BZ    SOP2STOP                 BRANCH NOT V FORMAT        DM0I 12460000
         TM    DCBRECFM,FORMATF         FIXED FORMAT               DM0I 12470000
         BC    1,SOP2STOP               YES, BRANCH                DM0I 12480000
         USING WTGENTRY,RWTGC                                    Y02072 12482002
         MVC   WTGIDTTR,SOPSLDVT        VARIABLE, GET 1915     @Z30TSCF 12484003
         B     RELOOP                   BACK TO MAIN LINE          DM0I 12500000
SOP2STOP EQU   *                                                        12540000
         MVC   WTGIDTTR,SOPSLDFT        NON-VARIABLE, GET 1910 @Z30TSCF 12550003
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURR WTG ENTRY        12600000
         LA    RPARC,PLOFF(0,RPARC)     INCR CURRENT DCB ENTRY PRTR     12620000
         CLC   0(2,RWTGC),AMIDCNST      THIS RT NEEDED AGAIN            12640000
         BCR   RWTGC,RBASE              BACK TO OPEN CONTROL ROUTINDM0I 12660000
*                                                                       12680000
         CLC   0(2,RWTGC),OPIDCNST      END OF TABLE                    12700000
         BC    7,RELOOP                 NO,CHECK NEXT ENTRY             12720000
*                                                                       12740000
         LR    RPARC,RPAR                                               12760000
         LA    RWTGC,WAOFF(0,RWTG)      REINITIALIZE WTG LIST PTR       12780000
ZCHEK    CLI   0(RWTGC),X'00'          IS THIS ENTRY COMPLETE           12800000
         BC    7,TCTLRTN                IF NOT TRANSFER CONTROL         12820000
*                                                                       12840000
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY                  12860000
         LA    RPARC,PLOFF(0,RPARC)                                     12880000
         B     ZCHEK                    TO ZERO CHECK              DM0I 12900000
*                                                                       12920000
TCTLRTN  EQU   *                                                        12940000
         USING WTG,RWTG                                                 12990003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*13040003
               MODID=WTGENTRY                                  @Z30TSCF 13090003
         DROP  RWTGC,RWTG                                      @Z30TSCF 13140003
*                                                                       13420000
**********************************************************************  13440000
*                                                                    *  13460000
BUFERR   EQU   *                                                  M1552 13464000
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 13466002
         DMABCOND OABD060,PDLOAD,RETURN=NONE,RES=NO,REGSAVE=YES  S21042X13468021
                                        CALL PROBLEM DETERMINATION      13472021
         B     TCTLRTN                                           S21042 13476021
WAOFF    EQU   32                                                       13480000
PLOFF    EQU   4                        OFFSET OF DCB ENTRIES           13500000
WGOFF    EQU   8                        OFFSET OF WTG ENTRIES           13520000
OPIDCNST DC    C'0S'                    ID                         DM0I 13540000
AMIDCNST DC    C'1D'                    ID                         DM0I 13560000
ONEIOB   DC    H'1'                    TEST FOR ONE IOB          A37507 13570021
*                                                                       13580000
*********************************************************************** 13600000
*                                                                       13604020
* SEARCH AND TIC BUILDING RTN                                           13608020
*                                                                       13612020
SOP2SCH  EQU   *                                                 S20201 13616020
         ST    RC,D0(RB)                STORE SRCH ADDR IN CCW   S20201 13620020
         MVI   CNTOFF(RB),FIVE          SET CNT TO FIVE          S20201 13624020
         OI    FLAGOFF(RB),CC           SET CMND CHAIN FLAG      S20201 13628020
         MVI   D0(RB),SRCHE             PUT IN SRCH CMND         S20201 13632020
         ST    RB,B8(RB)                PUT SRCH ADDR IN NEXT    S20201 13636020
*                                       CCW                      S20201 13640020
         AR    RB,RE                    INCR PTR FOR SEARCH      S20201 13644020
         MVI   D0(RB),TIC               PUT IN TIC CMND          S20201 13648020
         AR    RB,RE                    INCR PTR FOR TIC         S20201 13652020
         BR    RJ                       RETURN                   S20201 13656020
*                                                                       13660020
* SET SECTOR BUILD RTN                                                  13664020
*                                                                       13668020
SOP2STA  EQU   *                                                 S20201 13672020
         L     RF,DXCCW11               GET THETA ADDR           S20201 13676020
         ST    RF,D0(RB)                PUT IN CCW               S20201 13680020
         OI    FLAGOFF(RB),CC           TURN ON CMND CHAIN       S20201 13684020
         MVI   D0(RB),SETSC             PUT IN CMND              S20201 13688020
         B     SOP2FIN                  GO TO FINISH CCW         S20201 13692020
*                                                                       13696020
*                                                                       13700020
*                                                                       13704020
* READ SECTOR BUILD RTN                                                 13708020
*                                                                       13712020
SOP2RTA  EQU   *                                                 S20201 13716020
         L     RF,DXCCW11               GET THETA ADDR           Y02072 13720002
         ST    RF,D0(RB)                PUT IN CCW               S20201 13724020
         SR    RB,RE                    BACK UP PTR              S20201 13728020
         OI    FLAGOFF(RB),CC           TURN CMND CHAIN ON IN    S20201 13732020
         AR    RB,RE                    RESTORE PTR              S20201 13736020
         MVI   D0(RB),RDSC              PUT IN CCW CMND          S20201 13740020
SOP2FIN  EQU   *                                                 S20201 13744020
         MVI   CNTOFF(RB),B1            SET BYTE CNT TO ONE      S20201 13748020
         AR    RB,RE                    INCR PTR                 S20201 13752020
         BR    RJ                       RETURN                   S20201 13756020
*                                                                       13780000
* MODULE IDS                                                            13830002
*                                                                       13880002
SOPSLDFT DC    C'10',VL3(IGG01910)      IGG01910               @Z30TSCF 13890003
SOPSLDVT DC    C'15',VL3(IGG01915)      IGG01915               @Z30TSCF 13900003
SOPSLDIN DC    C'1O',VL3(IGG0191O)      IGG0191O               @Z30TSCF 13902003
PDLOAD   DC    C'6M',VL3(IGG0196M)      IGG0196M               @Z30TSCF 13904003
SOPSD    DC    C'9O',VL3(IGG0199O)      IGG0199O               @Z30TSCF 13906003
*                                                                       13956002
* PATCH AREA                                                            13966002
*                                                                       13976002
PATCH    DC    0H'0',50X'00'            PATCH AREA               Y02072 13978002
END      EQU   *                        END OF MODULE            Y02072 13988002
         EJECT                                                          13988403
CVT      DSECT                                                 @Z30TSCF 13988803
         CVT                                                   @Z30TSCF 13989203
         IECDSECS DCB,WTG,(MAIN,(IOB,NO)),PREFX,EXPAND=YES     @Z30TSCF 13990003
         ORG   WTGIDTTR                                          Y02072 14000002
WTGID    DS    CL2                      ID NEXT MOD              Y02072 14010002
DCBCNTRZ EQU   DCBCNTRL+1                                          DM0I 14026000
DCBCNTRX EQU   DCBCNTRL+3                                          DM0I 14032000
         EJECT                                                          14032102
FORCORE  DSECT                                                   Y02072 14032402
         IHAFCAUD  ORG=YES                                       Y02072 14032802
         EJECT                                                          14032902
         IHACCW  DSECT=YES                                       Y02072 14033202
         EJECT                                                          14033602
         IEZIOB                                                  Y02072 14034002
         EJECT                                                          14084002
         IGGBCB  TYPE=SAM                                               14134002
           END                                                          14780000
