         TITLE 'IGG0191N-DEB CONSTRUCTION FOR D.A.DEVICE EXTENTS'       00100000
IGG0191N CSECT                                                          00120021
*                                                                       00122002
*MODULE NAME - IGG0191N                                          Y02072 00124002
*                                                                       00126002
*DESCRIPTIVE NAME - BUILD DA SECTION OF DEB                      Y02072 00128002
*                                                                       00128402
*COPYRIGHT - NONE                                                Y02072 00128802
*                                                                       00129202
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00129602
*                                                                       00129702
*        VS1 RELEASE 2 DELETIONS                                        00129802
*D329000                                                        XA02093 00129902
*                                                                       00130021
*        VS2 RELEASE 2 DELETIONS                                 Y02072 00180002
*001100,003600,093000,174500,175500-175800,194000-207000,209000, Y02072 00190002
*250500,252500-252800,272500,273500-274000,478000-512000,        Y02072 00192002
*514000-515000,425100,377000,382630,383000,405000,409000,425100, Y02072 00194002
*342070-342840                                                   Y02072 00204002
*                                                                YM1168 00214002
*          VS2 RELEASE 3 DELETIONS                                      00214403
*0000101000-110000,113000-114000,116000-118000,118820,         @Y30LSBS 00216003
*142000-143000,425400                                          @Y30LSBS 00218003
*                                                              @ZA04216 00218137
*                                                              @Z30TSCF 00218403
*          RELEASE VS2-3 ADDITTIONS AND CHANGES                         00218637
*A350500                                                       @ZA02655 00218737
*A242010,242020,266000 OZ10225 IS SYSROUTE FROM OY11230        @ZA02655 00218837
*A119161,119461                                                @ZA10592 00218937
*C368320-368350                                                @ZA10592 00219037
*A119101,368311,368312                                         @ZA12185 00219237
*C100000-100540,119160-119170,368161-369879,409610-409980,     @ZA17532 00219424
*C487500                                                       @ZA17532 00219524
*A369363,369414,369416,369456,369458                           @ZA26462 00219624
*C369482                                                       @ZA30847 00219724
*A369483,369484                                                @ZA30847 00221724
*                                                                       00223724
*          RELEASE 20 DELETIONS                                         00228024
*0973329000                                                      A33681 00230020
*0973328400,328800,329200,329600                                 M1055  00235020
*          RELEASE 21 DELETIONS                                         00240000
* 297000-299600                                                  A50696 00240421
*2880                                                            A43880 00242021
*2880                                                            A43880 00245021
*2880                                                            A39782 00250021
*D001400-001980,002600-002800,003200,011000-012000,152000,      SA54462 00250121
*D417000-424200,425800-428000,513000                            SA54462 00250221
*STATUS CHANGE LEVEL 007                                                00270224
*                                                                       00290224
*OZ28203  - MSS ACQUIRE ENHANCEMENTS                            OZ28203 00310224
*C100020,368206,369456                                          OZ28203 00330224
*A368207,368281-368300                                          OZ28203 00350224
*                                                                       00400000
* FUNCTION - THIS EXECUTOR IS ENTERED FOR USERS OF SAM AND EXCP DURING  00500021
*            OPEN FOR THE CONSTRUCTION OF DEBS. THIS EXEC SUPPLEMENTS   00600021
*            IGG0191A BY BUILDING THE EXTENT PORTION (DEVICE DEPENDENT  00700021
*            SECTION) FOR DIRECT ACCESS DEVICES.                        00800021
*            THE MODULE ALSO CHECKS THE AUTHORIZED LIBRARY       Y02072 00850002
*            TABLE (ALT) TO DETERMINE IF THE DATASET BEING       Y02072 00860002
*            OPENED BELONGS TO AN AUTHORIZED LIBRARY.  IF THE    Y02072 00870002
*            DATASET DOES BELONG TO AN AUTHORIZED LIBRARY, A BIT Y02072 00880002
*            IS SET IN THE DEB.                                  Y02072 00890002
*            UPON COMPLETION OF THE DEB, A LOOP THROUGH ITS             00891003
*            EXTENTS IS MADE TO BUILD PARAMETER LISTS FOR  AC-          00892003
*            QUIRING VIRTUAL DASD SPACE FOR ANY MSS  SUBSYSTEM          00893003
*            VIRTUAL DASD PACKS.                                        00894003
*                                                                       00900000
* ENTRY POINT - IGG0191N (ENTERED FROM IGG0191A VIA XCTL)               01000021
*                                                                       01300000
* INPUT -  DCB ADDRESS                                                  01400021
*          WORK AREA ADDRESS                                            01500000
*          WHERE TO GO TABLE                                            01600000
*          PARAMETER LIST                                               01700000
*          CURRENT ENTRY IN WHERE TO GO TABLE                           01800000
*          CURRENT PARAMETER (DCB)                                      01900000
*                                                                       02000000
* OUTPUT- DA EXTENT SECTION AS OUTLINED BELOW.                          02100021
*                                                                       02200000
*MACROS-MAPPING - IEFUCBOB, DCBD, TCB, IEZDEB, IECDSECS, ALTABLE,       02250003
*                 ICBACREL                                     @Y30LSBS 02260003
*                                                                       02300000
*        BASIC DEB LAYOUT FOR ALL I/O DEVICES SUPPORTED                 02400000
*                                                                       02500000
*        **********************************                             02600000
*   -16  *I/OS* I/O SUPPORT DCB ADDRESS   *                             02700000
*   -12  *    * RESERVED                  *                             02800000
*   -08  *    * DCB MODIF MASK            *                             02900000
*   -04  *DEBL*                           *                             03000000
*   +00  *SUBL* TCB ADDRESS               *                             03100000
*   +04  *AML * DEB LINK FIELD            *                             03200000
*   +08  *DPAT* IRB ADDRESS               *                             03300000
*   +12  *FLTP* SYSTEM PUTGE CHAIN        *                             03400000
*   +16  *NEXT* USER PURGE CHAIN          *                             03500000
*   +20  *PRTY* ECB ADDRESS               *                             03600000
*   +24  *KEYD* DCB ADDRESS               *                             03700000
*   +28  *SCAL* APPENDAGE ADDRESS         *                             03800000
*        **********************************                             03900000
*                                                                       04000000
*                                                                       04100000
*        DEVICE DEPENDENT SECTION OF DEB                                04200000
*                                                                       04300000
* TAPE/URE                                                              04400000
*                                                                       04500000
*                                                                       04600000
*        **********************************                             04700000
*   +32  *DMOD*  UCB ADDRESS              *                             04800000
*   +36  *VOL SEQ NO     *NO. OF VOLS.    *                             04900000
*        **********************************                             05000000
*                                                                       05100000
*                                                                       05200000
* FOLLOWING ARE DA EXTENTS BUILT BY THIS EXEC.                          05300000
*                                                                       05400000
* D.A.SAM DEB.                                                          05500000
*        **********************************                             05600000
*   +32  *FMSK*  UCB ADDRESS              *                             05700000
*   +36  *EXTENT FIELD BBCCHHCCHH         *                             05800000
*   +40  *                                *                             05900000
*   +44  *               *NO.TRACKS ALL.  *                             06000000
*   +48  *VOL SEQ NO     *NO. OF VOLS     *                             06100000
*        **********************************                             06200000
*                                                                       06300000
*                                                                       06400000
* NOTE.+32 - +44 IS REPEATED PER EXTENT                                 06500000
*                                                                       06600000
*                                                                       06700000
* D.A.TO MEMBER FOR OUTPUT                                              06800000
*        **********************************                             06900000
*   +E2  *MEMBER NAME THAT IS OPENING     *                             07000000
*   +56  *MEMBER NAME THAT IS OPENING     *                             07100000
*        **********************************                             07200000
*                                                                       07300000
*                                                                       07400000
* DA BPAM CONCATENATION (INPUT)                                         07500000
*        **********************************                             07600000
*   +48  *DSNO DSNO  DSNO DSNO            *                             07700000
*        *EXTU EXT2  EXT3 EXT4            *                             07800000
*        **********************************                             07900000
*                                                                       08000000
*                                                                       08100000
* NOTES- BPAM DEB SAME AS SAM DEB WITH EXCLUSSION OF FIELD AT +48       08200021
*                                                                       08300000
*        USER LABEL EXTENT IS NOT INCLUDED IN F1 EXTENT COUNT           08330018
*        AND IS NOT INCLUDED IN DEB EXTENTS.                            08360018
*                                                                       08400000
*        ROUTINE ALSO MERGES CLASS BYTE AND DEVICE BYTE OF UCB/SRT      08500000
*        INTO DCB FIELD (DEVT)                                          08600000
*                                                                       08700000
* EXITS NORMAL - XCTL TO IGG0191B  SAM MAIN EXECUTOR                    08800021
*                                                                       08810021
* EXITS ERROR - XCTL TO PROB DET FOR 413-2C ABEND IF ERROR              08900003
*               IS DISCOVERED UPON RETURN FROM ICBACREL MACRO           08950003
*                                                                       09000000
* TABLES/WORKAREA - SEE DSECTS AT END OF LISTING.                       09100021
*                   DXRGSAVE-USED TO SAVE REGISTER CONTENTS      Y02072 09150002
*                                                                       09200000
* ATTRIBUTES - REENTRANT, REUSABLE, RUNS IN DATA MANAGEMENT KEY, Y02072 09300002
*              SUPERVISOR STATE                                  Y02072 09400002
*                                                                       09500000
*                                                                       09600000
*                                                                       09700000
*******************************************************************     09800000
*********************************************************************   09900000
         EJECT                                                 @ZA17532 10000024
*        THE FOLLOWING TABLE SHOWS WHAT STAGING IS PERFORMED   @ZA17532 10001024
*        FOR DATA SETS RESIDING ON AN MSS VIRTUAL VOLUME       @ZA17532 10002024
*        NOTE:                                                  OZ28203 10003024
*        (1)  THAT A  ( ? ) - INDICATES A NOT TESTED CONDITION  OZ28203 10004024
*        (2)  PROCESS (OUT) = OPENED FOR(OUTPUT OR OUTIN)       OZ28203 10005024
*                     (IN)  = OPEN FOR(INPUT,INOUT OR UPDATE)   OZ28203 10006024
*-------------------------------------------------------------  OZ28203 10007024
*PROCESS| DISP| ALLOC| TTRLL  |DSORG |ACCESS|  TYPE OF STAGING  OZ28203 10008024
*       |     |      |        |      |METHOD|      REQUEST      OZ28203 10009024
*-------------------------------------------------------------  OZ28203 10010024
* IN    |  ?  | TEMP |   ?    |   ?  |  ?    |NO STAGING        OZ28203 10011024
*       |     |      |        |      |       |                  OZ28203 10012024
*   ?   | NEW |  ?   | NOT=0  |  PS  |  ?    |NO STAGING        OZ28203 10013024
* IN    | NEW |  ?   |  =0    |  PS  |NOT PDS|STAGE ALL EXTENTS OZ28203 10014024
* OUT   | NEW | CYL  |  =0    |  PS  |NOT PDS|INHIBIT STAGE ALL OZ28203 10015024
* OUT   | NEW | TRK  |  =0    |  PS  |NOT PDS|STAGE ALL EXTENTS OZ28203 10016024
*       |     |      |        |      |       |                  OZ28203 10017024
* IN    | OLD |  ?   | NOT=0  |  PS  |NOT PDS|STAGE TO EOF      OZ28203 10018024
* IN    | OLD |  ?   |  =0    |  PS  |NOT PDS|STAGE ALL EXTENTS OZ28203 10019024
* OUT   | OLD | TEMP | NOT=0  |  PS  |  ?    |NO STAGING        OZ28203 10020024
* OUT   | OLD | TRK  |   ?    |  PS  |NOT PDS|STAGE ALL EXTENTS OZ28203 10021024
* OUT   | OLD | CYL  |   ?    |  PS  |EXCP   |STAGE ALL EXTENTS OZ28203 10022024
* OUT   | OLD | CYL  |   ?    |  PS  |SAM    |IF(MACRF POINT)   OZ28203 10023024
*       |     |      |        |      |       |STAGE ALL. ELSE   OZ28203 10024024
*       |     |      |        |      |       |INHIBIT STAGE ALL OZ28203 10025024
*       |     |      |        |      |       |                  OZ28203 10026024
* IN    | MOD |  ?   | NOT=0  |  PS  |NOT PDS|STAGE TO EOF      OZ28203 10027024
* IN    | MOD |  ?   |  =0    |  PS  |NOT PDS|STAGE ALL EXTENTS OZ28203 10028024
* OUT   | MOD | CYL  |   ?    |  PS  |SAM    |STAGE CYL OF LAST OZ28203 10029024
*       |     |      |        |      |       |RECORD INHBIT TO  OZ28203 10030024
*       |     |      |        |      |       |EOF.              OZ28203 10031024
* OUT   | MOD | TRK  |   ?    |  PS  |SAM    |STAGE CYL OF LAST OZ28203 10032024
*       |     |      |        |      |       |RECORD TO EOF.    OZ28203 10033024
* IN    | ?   |  ?   |   ?    |  PS  |PDS    |STAGE DIRECTORY   OZ28203 10034024
* IN    | ?   |  ?   |   ?    |  PO  |PDS    |STAGE ALL EXTENTS OZ28203 10035024
*       |     |      |        |      |       |                  OZ28203 10036024
* OUT   | ?   | CYL  |   ?    |  PS  |PDS    |STAGE DIRECTORY   OZ28203 10037024
*       |     |      |        |      |       |CYL OF EOF        OZ28203 10038024
*       |     |      |        |      |       |INHIBIT TO EOD    OZ28203 10039024
* OUT   | ?   | TRK  |   ?    |  PS  |PDS    |STAGE DIRECTORY   OZ28203 10040024
*       |     |      |        |      |       |CYL OF EOF TO EOD OZ28203 10041024
*-------------------------------------------------------------  OZ28203 10042024
         EJECT                                                 @ZA17532 10054024
* MASK'S TO TEST PARAMETER LIST WITH                                    10100000
DEBBSLNG EQU   80                                                       11100000
COMMUTAB EQU   16                                                       11200000
NEXTCORE EQU   140                                                      11500000
UCBADDR  EQU   NEXTCORE+4               ADDR OF UCB (OTHER THAN  Y02072 11550002
*                                         FIRST) FOR BPAM DS     Y02072 11560002
ULEXTYP  EQU   X'40'  EXTENT TYPE INDICATOR FOR USER LABEL TRACK   UL17 11850000
INMASK   EQU   X'0E'                    MASK FOR INPUT TEST        UT18 11858018
POTEST   EQU   X'02'                    MASK FOR PO DATA SET       UT18 11866018
TOTMASK  EQU   X'02'                    MASK FOR TOTALING TEST     UT18 11874018
ZERO     EQU   0                        PARAMETRIC VALUE OF 0      UT18 11890018
ONE      EQU   1                        CONSTANT OF 1            A50696 11890421
XNTOFSET EQU   6                       OFFSET TO EXTENT IN DSCB  A43880 11891021
EIGHT    EQU   8                       8 BYTES                   A43880 11892021
ADDRLEN  EQU   B'0111'                 TO GET AN ADDR THAT IS    Y02072 11894002
*                                        LEFT ALIGNED            Y02072 11896002
JFQMPREF EQU   X'10'                    LEN OF QUE MANAG PREFIX  YM1168 11898002
*                                         TO THE JFCB            YM1168 11898402
*                                                                       11900000
*    SOME MSS  EQUATES AND MASKS                               @Y30LSBS 11902003
*                                                              @Y30LSBS 11903003
INHIBST  EQU   X'20'                    INHIBIT STAGING        @Y30LSBS 11910024
OUTIN    EQU   X'07'                    MASK FOR OUTPUT/OUTIN  @ZA17532 11916024
DEBCYL   EQU   X'18'                    CYL ALLOC IN DEB EXTENT@ZA17532 11917024
X7F      EQU   X'7F'                    VERY HI EXTENT NUMBER  @Y30LSBS 11918024
D1       EQU   1                        DISPLACEMENT OF ONE    @Y30LSBS 11922003
D3       EQU   3                        DISPLACEMENT OF THREE  @Y30LSBS 11924024
D4       EQU   4                        DISPLACEMENT OF FOUR   @Y30LSBS 11954024
******************************           ****************************** 12000000
*                                                                       12100000
*                                                                       12200000
*                                                                       12300000
*                                                                       12400000
*                                                                       12500000
*REGISTERS ARE REFERENCED SYMBOLICALLY WHERE APPROPRIATE                12600000
RE       EQU   0         WORK REG5                                      12700003
RWK3     EQU   RE        WORK REGISTER                           Y02072 12750003
RF       EQU   1         WORK REG6                                      12760003
R1       EQU   1         PARAMETER LIST REGISTER               @Y30LSBS 12770003
RDCB     EQU   2         DCB REGISTER                                   12800000
RWK1     EQU   RDCB      WORK REGISTER                           Y02072 12850002
RBASE    EQU   3         BASE REGISTER                                  12900000
RCORE    EQU   4         WORK AREA ADDRESS                              13000000
RPAR     EQU   5         TOP OF PARAMETER LIST                          13100000
RWK4     EQU   RPAR      WORK REGISTER                           Y02072 13150002
RWTG     EQU   6         TOP OF WTG TABLE                               13200000
RWK5     EQU   RWTG      WORK REGISTER                           Y02072 13250002
RPARC    EQU   7         CURRENT PARAMETER                              13300000
RWTGC    EQU   8         CURRENT TRANS LOAD                             13400000
RTIOT    EQU   9         USED HERE AS WRK REG AND  COMM VECTOR ADDR.    13500000
RUCB     EQU   10        USED HERE AS A COUNTER IN IOB GENERATION       13600000
RWK6     EQU   RUCB      WORK REGISTER                          XA02093 13650002
RDEB     EQU   11        DEB ADDRESS                                    13700000
RB       EQU   12        WORK REG1  **                                  13800000
RC       EQU   13        WORK REG2  **  USED IN IOB GENERATION          13900000
RD       EQU   14        WORK REG3  **                                  14000000
RWK2     EQU   RD        WORK REGISTER                           Y02072 14050002
RJ       EQU   15        WORK REG4                                      14100000
*                                                                       14400000
*                                                                       14500000
*                                                                       14600000
*********************************************************************** 14700000
*                                                                       14800000
*                                                                       14900000
*                                                                       15000000
*                                                                       15100000
*                                                                       15300000
         BALR  RBASE,0                                                  15400000
         USING PO,RBASE                                                 15500000
         USING IHADCB,RDCB                                              15600000
         USING FORCORE,RCORE                                            15700000
         USING   TCB,RD                                                 15900000
         USING TIOT,RTIOT                                               16000000
         USING UCBOB,RUCB                                               16100000
*                                                                       16200000
*                                                                       16300000
*                                                                       16400000
*                                                                       16500000
PO       EQU   *                                                        16600000
         B     BEGIN                                           @Z30TSCF 16650003
         DC    C'IGG0191N'              MODULE NAME            @Z30TSCF 16660003
         DC    C'&SYSDATE'              LAST SHIP DATE         @ZA17532 16670024
         DC    C'@ZA30847'              LAST SHIP CODE         @ZA17532 16676024
BEGIN    DS    0H                                              @Z30TSCF 16690003
*                                                                       16700000
         L     RDCB,0(RPARC)            GET DCB ADDRESS                 16800000
         L     RCORE,4(RWTGC)           GET WORK AREA                   16900000
         L     RD,COMMUTAB         CALCULATE TCB ADDRESS                17000000
         L     RD,0(0,RD)                                               17100000
         L     RD,4(0,RD)               TCB  ADDR                       17200000
         L     RTIOT,TCBTIO                                             17300000
         AH    RTIOT,DCBTIOT       RESET TIOT POINTER                   17400000
         L     RDEB,DCBDEBAD                                            17500000
         USING DEBBASIC,RDEB                                     Y02072 17550002
         TM    DSCFILTY,POTEST          IS DATA SET PARTIONED    Y02072 17560002
         BNO   OBPAM170                 NO, BR AROUND            Y02072 17570002
         OI    DEBFLGS1,DEBAPFIN        ASSUME DATASET IS IN ALT Y02072 17580002
OBPAM170 EQU   *                        COME HERE IF NOT PO      Y02072 17590002
         SR    RC,RC                                                    17600000
         IC    RC,DEBNMEXT                                              17700000
*                                                                       17800000
*        EXTENTS                                                        17900000
*                                                                       18000000
         LR    RB,RC                    NO OF EXTENTS                   18100000
         SLL   RB,4                                                     18200000
         LA    RB,32(RDEB,RB)           POINT TO ACCESS METHOD SECTION  18300000
*                                                                       18400000
         DROP  RDEB                                              Y02072 18450002
         USING DEBDASD-(DEBBASND-DEBBASIC),RDEB                  Y02072 18460002
         LA    RJ,DEBUCBAD              FIRST DEB EXTENT                18500000
         DROP  RDEB                                              Y02072 18550002
         LR    RDCB,RCORE                                               18600000
         SH    RDCB,OBPAMK44            FIRST DSCB                      18700000
         LR    RDEB,RDCB                SAVE CURRENT DSCB ADDR          18800000
         SR    RF,RF                    START M COUNTER WITH ZERO       18900000
         SR    RD,RD                                                    19000000
         ST    RD,DXCCW4                SET TOTAL TT CTR TO ZERO        19100000
         L     RUCB,DXUCBADR            ADDR OF ONLY UCB FOR SAM Y02072 19150002
*                                         OF FIRST UCB FOR BPAM  Y02072 19160002
*                                                                       19200000
OBPAM180 EQU   *                                                        19300000
         STH   RD,4(0,RJ)               ZERO BB FIELD                   19310002
         USING UCBOB,RUCB                                               20800000
*                                                                       20810002
* MUST NEXT TEST TO SEE IF THE DATASET BEING OPENED IS A MEMBER  Y02072 20820002
* OF THE AUTHORIZED LIBRARY TABLE.  IF IT DOES BELONG TO THE ALT Y02072 20830002
* A BIT MUST BE SET IN THE DEB.                                  Y02072 20840002
*                                                                       20842002
         TM    DSCFILTY,POTEST          DATA SET PARTITIONED     Y02072 20850002
         BZ    OBPAM186                 NO, BYPASS ALT TESTING   Y02072 20860002
         STM   RWK4,RWK5,DXRGSAVE       SAVE REGS                Y02072 20862002
         L     RWK2,CVTPTR              GET CVT ADDRESS          Y02072 20870002
         USING CVTMAP,RWK2                                       Y02072 20880002
         L     RWK2,CVTAUTHL            GET ADDRESS OF ALT       Y02072 20890002
         DROP  RWK2                                              Y02072 20892002
         LTR   RWK2,RWK2                WAS AN ALT BUILT         Y02072 20894002
         BZ    OBPAM184                 NO, BYPASS ALT TESTING   Y02072 20896002
         USING ALTABLE,RWK2                                      Y02072 20898402
         SR    RWK3,RWK3                PREPARE TO GET NUMBER OF Y02072 20898802
*                                         ENTRIES IN THE ALT FOR Y02072 20898902
*                                         LOOP CONTROL           Y02072 20899002
         IC    RWK3,ALTNOENT            GET NUMBER OF ENTRIES    Y02072 20899602
         LA    RWK2,ALTENT              INCR TO THE FIRST ENTRY  Y02072 20899702
         DROP  RWK2                                              Y02072 20899802
         USING ALTENTRY,RWK2                                     Y02072 20899902
         SR    RWK4,RWK4                PREPARE REG FOR COUNT    Y02072 20933202
*                                         FOR CLC INST           Y02072 20935202
OBPAM182 EQU   *                                                 Y02072 20943202
         IC    RWK4,ALTLNENT            INIT REG FOR INST TO GET Y02072 20953202
*                                         TO THE NEXT ENTRY      Y02072 20963202
         CLC   ALTVOLID,UCBVOLI         UCB VOLID EQUAL TO ALT   Y02072 20965202
*                                         ENTRY VOLID            Y02072 20965602
         BNE   OBPAM183                 NO, GO INCR TO NXT ENTRY Y02072 20966002
         SH    RWK4,VLIDLNP1            SUBT LEN OF ENTRY FOR    Y02072 20966402
*                                         VOLID PLUS ONE FOR     Y02072 20966502
*                                         EXECUTE INST           Y02072 20966602
         ICM   RWK5,ADDRLEN,TIOEJFCB    GET ADDR OF JFCB         Y02072 20976602
         LA    RWK5,JFQMPREF(RWK5)      ADD LEN OF PREFIX        YM1168 20977002
         EX    RWK4,CLCINST             EXECUTE CLC INST FOR DSN Y02072 20977702
         BNE   NEXTALT                  GO PREPARE FOR NEXT ALT OZ03183 20987737
         CL    RWK4,OBPAMK43            IS DSN 44 BYTES LONG?   OZ03183 20987837
         BE    OBPAM185                 YES, VALID JFCB DSN     OZ03183 20987937
         AR    RWK5,RWK4                POINT END OF JFCB DSN   OZ03183 20988037
         USING INFMJFCB,RWK5                                    OZ03183 20988137
         CLI   JFCBDSNM+1,C' '          BLANK AT END OF DSN?    OZ03183 20988237
         BNE   NEXTALT                  NO, PREPARE FOR NEXT ALTOZ03183 20988337
         LA    RWK4,3(,RWK4)            DETERMINE NUMBER        OZ03183 20988437
         LCR   RWK4,RWK4                    OF BLANKS TO BE     OZ03183 20988537
         AH    RWK4,OBPAMK44               CHECKED IN EX INST   OZ03183 20988637
         BM    OBPAM185                 MINUS, VALID 43 BYTE DSNOZ03183 20988737
         EX    RWK4,DSNCLC              CHECK FOR ALL BLANKS    OZ03183 20988837
         BE    OBPAM185                 YES, DS BELONGS TO ALT  OZ03183 20988937
         IC    RWK4,ALTLNENT            INIT REG FOR NEXT ALT   OZ03183 20989037
         B     OBPAM183                 GO INCR TO NEXT ENTRY   OZ03183 20989137
NEXTALT  AH    RWK4,VLIDLNP1            NOT EQUAL, PREPARE FOR  OZ03183 20989237
*                                         NEXT ENTRY IN THE ALT OZ03183 20989337
OBPAM183 EQU   *                                                 Y02072 20989437
         LA    RWK2,L'ALTLNENT(RWK4,RWK2) INCR TO THE NEXT ENTRY Y02072 20989537
*                                         (CONTENTS OF ALTLNENT  Y02072 20990802
*                                         PLUS 1 FOR LENGTH OF   Y02072 20991202
*                                         ALTLNENT)              Y02072 20991602
         BCT   RWK3,OBPAM182            RETURN IF MORE ENTRIES   Y02072 20992502
OBPAM184 L     RWK5,0(RPARC)            GET DCB ADDR             Y02072 20992902
         DROP  RDCB                                              Y02072 20993302
         USING IHADCB,RWK5                                       Y02072 20993702
         L     RWK5,DCBDEBAD            GET DEB ADDR             Y02072 20994102
         DROP  RWK5                                              Y02072 20994202
         USING DEBBASIC,RWK5                                     Y02072 20994302
         NI    DEBFLGS1,X'FF'-DEBAPFIN  TURN BIT OFF IF NO MORE  Y02072 20994502
*                                         ENTRIES OR NO ALT      Y02072 20994902
OBPAM185 EQU   *                                                 Y02072 20995002
         LM    RWK4,RWK5,DXRGSAVE       RESTORE REG VALUE        Y02072 20995102
         DROP  RWK5                                              Y02072 20995502
OBPAM186 EQU   *                                                 Y02072 20996102
         ST    RUCB,0(0,RJ)             MAIN UCB PTR IN CURRENT EXTENT. 20996302
         SR    RD,RD                                                    21000000
         IC    RD,59(0,RDCB)            GET NO OF EXTENT ON THIS DS     21100000
         LA    RDCB,105(0,RDCB)         POINT TO 1ST EXTENT ENTRY  UL17 21110000
         LA    RUCB,3                   MAX OF 3 EXTENTS           UL17 21120000
         CLI   0(RDCB),ULEXTYP          CHECK,BR IF 1ST EXTENT NOT UL17 21130000
         BC    7,OBPAM187               A USER LABEL TRACK         UL17 21140000
         LA    RDCB,10(0,RDCB)          POINT TO 2ND EXTENT ENTRY  UL17 21150000
         BCTR  RUCB,0                   DEC MAX NO EXTENTS LEFT    UL17 21160000
OBPAM187 EQU   *                                                   UL17 21180000
         LTR   RD,RD                    CHECK FOR ZERO                  21200000
         BC    7,OBPAM190               NO BRANCH                       21300000
*                                                                       21400000
         LA    RD,1                     TO FORM DUMMY EXTENT            21500000
OBPAM190 EQU   *                                                        21600000
*                                                                       21700000
         TM    0(RPARC),X'0F'           CK FOR INPUT                    21900000
         BC    8,OBPAM200              BR IF YES                        22000000
         MVI   0(RJ),X'10'              INH WR HA, R0 PERM HEAD SEEKS   22100000
         BC    15,OBPAM210                                              22200000
*                                                                       22300000
OBPAMK43 DC    H'43'                                            OZ03183 22350037
OBPAMK44 DC    H'44'                                                    22400000
*                                                                       22500000
OBPAM200 EQU   *                                                        22600000
         MVI   0(RJ),X'50'              INH ALL WR PERM HEAD SEEKS      22700000
*                                                                       22800000
OBPAM210 EQU   *                                                        22900000
         SR    RE,RE                    SET FORMAT 3 SW OFF             23000000
*                                                                       23200000
OBPAM220 EQU   *                                                        23300000
         MVC   6(8,RJ),2(RDCB)          SET UP ONE EXTENT CCHH TO CCHH  23400000
*    APAR 43880 RESULTED FROM THE USER BEING ABLE TO SPECIFY     A43880 23410021
*    ZERO FOR PRIMARY SPACE ALLOCATION AND THUS GETTING EXTENT   A43880 23420021
*    SECTION OF DEB ALL ZEROS.                                   A43880 23430021
         CLC   XNTOFSET(EIGHT,RJ),NOALLOC  IS THE EXTENT ALL 0   A43880 23440021
         BNE   ALLOC                   IF NOT   NO PROBLEM       A43880 23450021
         MVC   XNTOFSET(L'FOXES,RJ),FOXES INVALIDATE DEB        SA54462 23460021
ALLOC    EQU   *                                                 A43880 23470021
         CLI   0(RDCB),X'81'            CHECK FOR CYLINDER BOUNDRY      23500000
         BE    OBPAM224                 YES BRANCH. PERMIT HEAD SEEKS.  23600000
         OI    0(RJ),X'18'              INHIBIT ALL SEEKS               23700000
OBPAM224 EQU   *                                                        23800000
*                                                                       23900000
*                                                                       24000000
*        SET NO OF TRACKS                                               24100000
*                                                                       24200000
         CLC   XNTOFSET(L'FOXES,RJ),FOXES  DEB INVALID?        @ZA10225 24230037
         BE    BYPASS                      YES,BYPASS CONVERT  @ZA10225 24260037
         STM   RE,RJ,DXCCW5             SAVE ALL REGS                   24300000
         LR    RPAR,RJ                  SAVE CURR EXTNT PNTR            24400000
         STC   RF,DXDAADDR              SET CONST M FOR CONVERT         24500000
         MVC   DXDAADDR+1(2),4(RJ)      BB                              24600000
         MVC   DXDAADDR+3(4),10(RJ)     END CCHH IN EXTENT              24700000
*                                                                       24800000
*        USE CONVERT ROUTINE                                            24900000
*                                                                       25000000
         L     RF,0(0,RPARC)            DCB PTR                         25100000
         L     RF,DCBOFSET(0,RF)   PT TO DEB                            25200000
         LA    RDCB,DXDAADDR            PT TO CONST FOR CONVERT RTNE    25300000
         L     RJ,CVTPTR                GET COMM VECTOR ADDRESS         25400000
         L     RJ,CVTPRLTV-CVT(0,RJ)    CONVERT RTNE                    25500000
         BALR  RD,RJ                                                    25600000
*                                                                       25700000
         LR    RF,RE                    MOVE TTR TO RF                  25800000
         SRL   RF,16                    USE TT ONLY                     25900000
         LA    RF,1(0,RF)               ADD ONE TO TT                   26000000
         SH    RF,DXCCW4                SUBTRACT TT OF LAST EXTENT      26100000
         STH   RF,14(0,RPAR)            STORE NO OF TRKS IN EXTNT       26200000
         AH    RF,DXCCW4                RESET TOTAL TT CTR              26300000
         STH   RF,DXCCW4                                                26400000
         LM    RE,RJ,DXCCW5             RESTORE ALL REGS                26500000
BYPASS   EQU   *                                               @ZA10225 26600037
         LA    RF,1(0,RF)              ADD 1 TO M CTR, PT TO NEXT EXTNT 26700000
*                                                                       26800000
         BCT   RC,OBPAM260              NEXT                            26900000
*                                                                       27000000
         USING DEBBASIC,RDEB                                     Y02072 27050002
         USING IHADCB,RDCB                                       Y02072 27060002
*                                                                       27100000
         L     RDCB,0(0,RPARC)          RE-SET DCB PTR                  27200000
         L     RDEB,DCBDEBAD            RE-SET DEB PTR                  27300000
         TM    DCBDSORG,POTEST          TEST FOR PO DATA SET       UT18 27420018
         BZ    OBPAM227                 BR IF NOT SPECIFIED        UT18 27440018
*                                                                  UT18 27460018
         SR    RC,RC                   ZERO REG. FOR IC INSTR.     5798 27500000
         IC    RC,DEBAMLNG             PICK UP NO. OF DATA SET     5798 27600000
         LTR   RC,RC                                               5798 27700000
         BZ    OBPAM227                BRANCH IF ZERO              5798 27800000
         OI    DEBOFLGS,1              SET CONCATENATION IND.      5798 27900000
OBPAM227 EQU   *                                                   5798 28000000
*                                                                  5798 28100000
         TM    DCBMACRF,X'80'           DCB USING EXCP MACRO            28200000
         BC    8,OBPAM230               NO BRANCH                       28300000
         TM    DCBMACRF,X'40'          CK FOR FOUND EXT                 28400000
         BC    1,OBPAM230               YES BRANCH                      28500000
*                                                                       28600000
         TM    DSCFILTY,X'02'           PO IN DSCB                      28700000
         BC    8,OBPAM232               NO BRANCH                       28800000
         B     OBPAM250                                                 28900000
*                                                                       29000000
OBPAM230 EQU   *                                                        29100000
*                                                                       29200000
         TM    DCBDSORG,X'02'           CK FOR PO                       29300000
         BC    1,OBPAM240               BR IF YES                       29400000
OBPAM232 EQU   *                                                        29500000
         SR    RD,RD                                              MC0W  29510000
         SR    RC,RC                                              MC0W  29520000
         IC    RD,JFCBNVOL              PICK UP NO. OF VOLUMES    MC0W  29530000
         IC    RC,JFCBVLCT              GET VOLUME COUNT          MC0W  29540000
         CR    RC,RD                                              MC0W  29550000
         STH   RC,18(RJ)                IS VOLUME COUNT GREATER   MC0W  29560000
         BH    OBPAM172                 YES USE VOLUME COUNT      MC0W  29570000
         STH   RD,18(RJ)                NO USE NUMBER OF VOLUMES  MC0W  29580000
OBPAM172 EQU   *                                                  MC0W  29590000
         LH    RD,JFCBVLSQ              LOAD VOL SEQ NO          A50696 29640021
         TM    JFCBIND2,X'40'         TEST FOR OLD OR NEW          6831 29760013
         BNE   OBPAM234               BIF EITHER.                       29820013
         TM    0(RPARC),X'07'   TEST FOR OUT-OUT/IN. MVT SYSOUT PROB.   29880013
         BC    12,OBPAM234            BIF NEITHER.   MVT SYSOUT PROB.   29940013
         LTR   RD,RD                    TEST FOR ZERO             18987 29980000
         BE    OBPAM233                 YES                       18987 30000000
         STH   RD,16(RJ)                STORE VOL SEQ NO. IN DEB  18987 30020000
         B     OBPAM23A                                           18987 30040000
OBPAM233 EQU   *                                                  18987 30060000
         CLI   DXVOLSEQ+1,X'00'         TEST FOR ZERO          @ZA05445 30063037
         BC    8,OBPAM23B               YES                    @ZA05445 30066037
         IC    RD,DXVOLSEQ+1            PICK UP DEBVOLSEQ      @ZA05445 30069037
         B     OBPAM234                                        @ZA05445 30072037
OBPAM23B EQU   *                                               @ZA05445 30075037
         IC    RD,JFCBNVOL              PICK UP NO. OF VOLUMES    18987 30080000
OBPAM234 EQU   *                                                        30100000
         LTR   RD,RD                    VOL SEQ ZERO             A50696 30150021
         BNZ   OBPAM235                 NO, BR                   A50696 30200021
         LA    RD,ONE                   YES, USE VOL 1           A50696 30210021
OBPAM235 EQU   *                                                 A50696 30220021
         STH   RD,16(RJ)                USE VOL SEQ FROM JFCB    A50696 30230021
OBPAM23A EQU   *                                                  18987 30250000
         LA    RJ,4(RJ)                 SKIP PS SECTION                 30300000
         LNR   RJ,RJ                    MAKE NEGATIVE FOR BPAM   A25961 30360019
*                                       TEST BELOW                      30420019
         MVI   DEBAMLNG,X'10'           16 BYTE ACCESS METHOD    A25961 30480019
*                                       SECTION                         30540019
OBPAM240 EQU   *                                                        30600000
         TM    DSCFILTY,X'02'           CK PO IN DSCB                   30700000
         BC    8,DEBFINI                BRANCH IF NO                    30800000
OBPAM250 EQU   *                                                        30900000
*                                                                       31000000
         TM    0(RPARC),X'0F'           CK FOR INPUT                    31100000
         BC    8,DEBFINI                BRANCH IF YES                   31200000
*                                                                       31300000
         CLI   JFCBELNM,X'40'           CK FOR MEMBER NAME              31400000
         BC    8,DEBFINI                BRANCH IF NO                    31500000
*                                                                       31600000
*     CHECK FOR GDG RELATIVE GENERATION SPECIFICATION             18185 31610000
         CLI   JFCBELNM,C'+'                                      18185 31620000
         BC    8,DEBFINI               BRANCH IF PLUS             18185 31630000
         CLI   JFCBELNM,C'-'                                      18185 31640000
         BC    8,DEBFINI               BRANCH IF MINUS            18185 31650000
         TM    JFCBELNM,X'F0'                                     18185 31660000
         BC    1,DEBFINI               BRANCH IF NUMERIC          18185 31670000
         LTR   RJ,RJ                    TEST FOR BPAM ACCESS     A25961 31690019
*                                       METHOD SECTION                  31710019
         BP    OBPAM253                 BR IF YES                A25961 31730019
         LPR   RJ,RJ                    MAKE RJ POSITIVE         A25961 31750019
         B     OBPAM256                 ACCESS METHOD LENGTH     A25961 31770019
*                                       ALLREADY SET TO 16              31790019
OBPAM253 OI    DEBAMLNG,X'08'           8 BYTE BPAM SECTION      A25961 31810019
*                                       FOR MEMBER NAME                 31830019
OBPAM256 MVC   16(8,RJ),JFCBELNM        STORE MEMBER NAME IN     A25961 31850019
*                                       DEB                             31870019
         BC    15,DEBFINI                                               31900000
*                                                                       32000000
*                                                                       32100000
*                                                                       32200000
OBPAM260 EQU   *                                                        32300000
         BCT   RD,OBPAM280              BR IF MORE EXTENT ON CURRENT DS 32400000
         STC   RF,0(0,RB)               PUT M PTR IN AM SECTION         32500000
         LA    RB,1(0,RB)               NEXT ENTRY IN AM SECTION        32600000
         L     RDEB,NEXTCORE(0,RDEB)    NEXT DSCB ADDR                  32700000
         SR    RWK6,RWK6                PREPARE REG FOR IC INST XA02093 32710002
         IC    RWK6,TIOELNGH            GET LEN OF THIS DD ENT  XA02093 32720002
         LA    RTIOT,0(RWK6,RTIOT)      INCRE TO NEXT DD ENTRY  XA02093 32730002
         L     RUCB,UCBADDR(RDEB)       RE-INIT UCB REG FOR BPAM Y02072 32750002
*                                         MULTI VOL DATA SETS    Y02072 32760002
         LR    RDCB,RDEB                NEW CORE                        32800000
         LA    RJ,16(0,RJ)              NEXT DEB EXTENT                 33000000
         BC    15,OBPAM180                                              33100000
*                                                                       33200000
*        MORE EXTENTS FOR CURRENT DATA SET                              33300000
*                                                                       33400000
OBPAM280 EQU   *                                                        33500000
         LA    RDCB,10(0,RDCB)          UPDATE DSCB PTR                 33600000
         BCT   RUCB,OBPAM300            BR IF MORE EXT FOR CURR FORMAT  33700000
         LA    RDCB,1(0,RDCB)           UPDATE DSCB EXTNT PNTR          33800000
         LTR   RE,RE                    IS IT WORKING ON FORMAT 3       33900000
         BC    7,OBPAM320               BR IF YES                       34000000
*                                                                       34100000
         L     RDCB,4(RDCB)             GET NEXT FORMAT 3 DSCB          34200000
         LR    RDEB,RDCB                SAVE CURRENT DSCB ADDR          34300000
         LA    RDCB,4(0,RDCB)           UPDATE DSCB PNTR                34400000
         LA    RUCB,4                   START WITH 4 EXTENTS IN KEY     34500000
         LA    RE,1                     SET FORMAT 3 SW ON              34600000
*                                                                       34700000
OBPAM300 EQU   *                                                        34800000
         MVC   16(6,RJ),0(RJ)           MOD,UCB AND BB FOR NEXT EXTENT  34900000
         LA    RJ,16(0,RJ)              NEXT DEB EXTENT                 35000000
         NI    0(RJ),X'F7'              RESET FILE MASK        @ZA02655 35050037
         BC    15,OBPAM220                                              35100000
*                                                                       35200000
*                                                                       35300000
OBPAM320 EQU   *                                                        35400000
         LA    RUCB,9                   MAX 9 MORE EXTENTS              35500000
         SR    RE,RE                    FORMAT 3 SW OFF                 35600000
         BC    15,OBPAM300                                              35700000
*                                                                       35800000
DEBFINI  EQU   *                                                        35900000
         L     RF,DEBAPPAD              ADDRESS OF FIRST BYTE OF GOTTEN 36000000
*                                       CORE FOR DEB. USED TO ADDRESS   36100000
*                                       THE DEBDSCBA FIELD IN THE PRE-  36200000
*                                       FIX.                            36300000
         DROP  RDEB                                              Y02072 36350002
         USING DEBDASD-(DEBBASND-DEBBASIC),RDEB                  Y02072 36360002
         MVC   21(2,RF),DEBBINUM        BB- COMPLETES FDAD FOR F1 DSCB. 36400000
*                                       CCHHR WAS PUT IN BY 191A.       36500000
         DROP  RDEB                                              Y02072 36550002
         USING DEBBASIC,RDEB                                     Y02072 36560002
*                                                                       36600000
*                                                                       36700000
         L     RDCB,0(RPARC)            RESTORE DCB ADDRESS             36800000
*                                                                       36801003
*        THIS ROUTINE SCANS THROUGH THE DEB EXTENTS TO PICK UP @Y30LSBS 36802003
*        THOSE EXTENTS WHICH RESIDE ON VIRTUAL MSS  DASD.  THE @Y30LSBS 36803003
*        UCBTBYT2, X'08' OF EACH EXTENT IDENTIFIES  A          @Y30LSBS 36804003
*        VIRTUAL DASD VOLUME.   IF AN                          @Y30LSBS 36804403
*        EXTENT RESIDES ON VIRTUAL DASD, THE HIGH AND LOW      @Y30LSBS 36805003
*        EXTENT VALUES ARE PUT INTO A PARM LIST APPROPRIATLY   @Y30LSBS 36806003
*        FORMATTED FOR THAT PARTICULAR VOLUME.  THE            @Y30LSBS 36807003
*        LIST IS USED TO ACQUIRE THE DASD SPACE FOR THE        @Y30LSBS 36808003
*        EXTENTS AND PROPERLY STAGE OR INHIBIT STAGE THE DATA. @Y30LSBS 36809003
*                                                              @Y30LSBS 36814003
*                                                              @Y30LSBS 36815003
VIRTPROC EQU   *                                               @Y30LSBS 36816003
         STM   RPAR,RTIOT,DXCCW6        SAVE REGISTERS         @ZA17532 36816124
         XC    DXCCW12+4(4),DXCCW12+4   NO ACQUIRE LIST YET    @ZA17532 36816424
*                                       THIS IS USED AS ANCHOR @ZA17532 36816724
*                                       POINT FOR ACQUIRE LISTS@ZA17532 36817024
         SR    RD,RD                    CLEAR WORK REGISTER    @ZA17532 36817324
         IC    RD,DEBNMEXT              NUMBER OF DEB EXTENTS  @ZA17532 36817624
         LR    RC,RCORE                 USE THIS 'TRICK' SO CAN@ZA17532 36817924
         SH    RC,OBPAMK44              ADDR ALL DSCB'S ALIKE  @ZA17532 36818224
         DROP  RCORE                                           @ZA17532 36818524
         USING FORCORE-L'JFCBDSNM,RC                           @ZA17532 36818824
         LA    RPAR,DEBBASND            POINT TO DEB EXTENT    @ZA17532 36819124
         USING DEBDASD,RPAR                                    @ZA17532 36819424
OBPAM322 EQU   *                                               @ZA17532 36819724
         L     RUCB,DEBUCBAD            GET UCB ADDRESS        @ZA17532 36820024
         TM    UCBTBYT2,UCBRVDEV        IS IT VIRTUAL DASD     @Y30LSBS 36820324
         BO    VIRTRTN                  YES, PROCESS           @OZ28203 36820624
NOACQ    EQU   *                        CHECK FOR CANCAT PDS   @OZ28203 36820724
         TM    DEBOFLGS,DEBRERR         IS IT CONCATENATED PDS @ZA17532 36820924
         BNO   OBPAM600                 NO, GO AROUND VIRT RTN.@Y30LSBS 36821224
OBPAM324 EQU   *                        BYPASS DATA SET        @ZA17532 36821524
         SR    RB,RB                    PICK UP NUMBER OF      @ZA17532 36821824
         IC    RB,DSCNOEXT              EXTENTS IN THE DEB FOR @ZA17532 36822124
*                                       THIS DATA SET. NOTE NO @ZA17532 36822424
*                                       USER LABELS FOR PDS    @ZA17532 36822724
         SR    RD,RB                    REDUCE NUM OF EXTENTS  @ZA17532 36823024
         SLL   RB,4                     ADJUST DEB PTR TO      @ZA17532 36823324
         AR    RPAR,RB                  BYPASS THIS DATA SET   @ZA17532 36823624
OBPAM328 EQU   *                                               @ZA17532 36823924
         L     RC,DSCCORE               GET NEXT DSCB IN CHAIN @ZA17532 36824224
         LTR   RC,RC                    IS THERE ONE?          @ZA17532 36824524
         BZ    OBPAM330                 NO,ANY OF THEM VV?     @ZA17532 36824824
         CLI   DSCFMTID,C'1'            YES,IS IT A FORMAT 1?  @ZA17532 36825124
         BNE   OBPAM328                 NO,ANY MORE?           @ZA17532 36825424
         B     OBPAM322                 YES,IS IT A VV?        @ZA17532 36825724
OBPAM330 EQU   *                                               @ZA17532 36826024
         DROP  RC                                              @ZA17532 36826324
         USING FORCORE,RCORE                                   @ZA17532 36826624
         NC    DXCCW12+4(4),DXCCW12+4   ANY DATA SET ON VV?    @ZA17532 36826924
         BZ    OBPAM600                 NO,WE ARE DONE         @ZA17532 36827224
         B     OBPAM540                 YES,GO ISSUE ACQUIRE   @ZA17532 36827524
VIRTRTN  EQU   *                        START OF STAGING LOGIC @ZA17532 36827824
*      CHECK FOR PREVIOUSLY ACQUIRED DATA SETS                 @OZ28203 36828124
*      (1) NEW DATA WITH TTR OF ZERO                           @OZ28203 36828224
*      (2) TEMP DATA SET PASSED FROM STEP TO STEP              @OZ28203 36828324
         TM    JFCBIND2,JFCNEW          NEW  DATA SET?         @OZ28203 36828424
         BO    CKPOTTR                  YES CHECK TTR          @OZ28203 36828524
         TM    JFCBIND2,JFCTEMP         TEMP DATA SET?         @OZ28203 36828624
         BNO   DOACQ                    NO PROCESS             @OZ28203 36828724
         TM    UCBSTAT,UCBRESV+UCBPRES  PERM MOUNTED VOLUME ?  @OZ28203 36828824
         BM    CKOUTPUT                 YES, GO CHECK OUTPUT   @OZ28203 36828924
         BO    CKOUTPUT                                        @OZ28203 36829024
         B     DOACQ                    NO, DO ACQUIRE         @OZ28203 36829124
CKOUTPUT EQU   *                                               @OZ28203 36829224
         TM    DEBOPATB,OUTIN           OUTPUT PROCESSING ?    @OZ28203 36829324
         BNO   NOACQ                    NO , BY PASS ACQUIRE   @OZ28203 36829424
CKPOTTR  EQU   *                        CHECK FOR TTR OF ZERO  @OZ28203 36829524
         TM    DSCFILTY,POTEST          P.O. DATASET ?         @OZ28203 36829624
         BO    DOACQ                    YES.TTR IS NEVER ZERO  @OZ28203 36829724
         CLC   DSCLSTAR(3),NOALLOC      TTR = ZERO ?           @OZ28203 36829824
         BNE   NOACQ                    NO  , BY PASS ACQUIRE  @OZ28203 36829924
DOACQ    EQU   *                                               @OZ28203 36830024
         CLC   DEBSTRCC,FOXES           VALID EXTENT?          @ZA17532 36830124
         BE    OBPAM600                 NO,EXIT                @ZA17532 36830224
*                                                              @ZA17532 36830324
*        INITIALIZE FOR VIRTUAL DASD PROCESSING                @ZA17532 36830424
*                                                              @ZA17532 36830524
         BAL   RPARC,GETMAIN            YES,GETMAIN FOR ACQUIRE@ZA17532 36830624
         USING ACQLST,RTIOT                                    @ZA17532 36830724
         SR    RJ,RJ                    NO EXTENTS IN LIST YET @ZA17532 36830824
*                                       THIS REGISTER USED TO  @ZA17532 36830924
*                                       COUNT NUM OF EXTENTS   @ZA17532 36831024
*                                       IN ACQUIRE LIST        @ZA17532 36831324
         NC    DXCCW12+4(4),DXCCW12+4   FIRST ACQUIRE LIST?    @ZA17532 36831424
         BNZ   OBPAM332                 NO,CHAIN TO LAST       @ZA17532 36831724
         ST    R1,DXCCW12+D4            SAVE THE POINTER       @Y30LSBS 36832024
         B     OBPAM334                 CONTINUE               @ZA17532 36832324
OBPAM332 EQU   *                                               @ZA17532 36832624
         ST    R1,ARNEDB                CHAIN ACQUIRE LIST     @ZA17532 36832924
*                                                              @ZA17532 36833224
*        THIS LOGIC KEEPS TRACK OF ACQUIRE LISTS AS FOLLOWS    @ZA17532 36833524
*              RTIOT  ADDRESS OF BEGINNING OF ACQUIRE LIST     @ZA17532 36833824
*              RWTGC  ADDRESSABILITY FOR FILLING IN EXTENTS    @ZA17532 36834124
*                                                              @ZA17532 36834424
OBPAM334 EQU   *                                               @ZA17532 36834724
         LR    RTIOT,R1                 SAVE ACQUIRE LIST      @ZA17532 36835024
         LR    RWTGC,RTIOT              NEW NOW CURRENT        @ZA17532 36835324
         TM    DSCFILTY,POTEST          IS THIS A PDS?         @ZA17532 36835624
         BZ    OBPAM338                 NO,BRANCH              @ZA17532 36835924
*                                                              @ZA17532 36836224
*        PDS PROCESSING                                        @ZA17532 36836524
*                                                              @ZA17532 36836824
         DROP  RTIOT                                           @ZA17532 36837124
         USING ACQLST,RWTGC                                    @ZA17532 36837724
         BAL   RPARC,CONVERT            FIND EOF               @ZA17532 36838024
         MVC   AREXT(2),DEBSTRCC        STAGE FIRST CYLINDER   @ZA17532 36838324
         MVC   AREXT+2(2),AREXT         (CONTAINS DIRECTORY)   @ZA17532 36838924
         LA    RJ,1(RJ)                 ONE EXTENT IN ACQUIRE  @ZA17532 36839524
         TM    DEBOPATB,OUTIN           OUTPUT?                @ZA17532 36840124
         DROP  RWTGC                                           @ZA17532 36840724
         USING ACQLST,RTIOT                                    @ZA17532 36841324
         STC   RJ,ARNMEXTS              ONE EXTENT             @ZA17532 36841924
         LA    RWTGC,L'AREXT(RWTGC)     DIRECTORY IN LIST      @ZA17532 36842524
         BNO   OBPAM324                 NO,GO BYPASS THIS D.S. @ZA17532 36843124
         DROP  RTIOT                                           @ZA17532 36844324
         USING ACQLST,RWTGC                                    @ZA17532 36844924
         CLC   AREXT-4(2),DXCCW5+4      IS EOF ON CYL CONTAIN- @ZA17532 36845924
*                                       ING THE DIRECTORY      @ZA17532 36846224
         BNE   OBPAM403                 NO,GO STAGE EOF        @ZA17532 36846524
         B     OBPAM404                 YES,DON'T STAGE IT ANEW@ZA17532 36846824
OBPAM338 EQU   *                                               @ZA17532 36847424
         TM    DEBOPATB,OUTIN           OUTPUT OR OUTIN?       @ZA17532 36848124
         BO    OBPAM400                 YES,OUTPUT PROCESSING  @ZA17532 36848824
*                                                              @ZA17532 36849524
*        INPUT PROCESSING   - INPUT,INOUT,UPDAT                @ZA17532 36850224
*        ACQUIRE (WITH STAGE) UP TO AND INCLUDING EOF          @ZA17532 36850924
         CLC   DSCLSTAR(5),NOALLOC      EMBEDDED EOF?          @ZA17532 36853024
         MVI   DXCCW5,X7F               IF NO,STAGE ALL        @ZA17532 36853724
         BE    OBPAM350                 NO,NO CVT TTR CONVERT  @ZA17532 36854424
         BAL   RPARC,CONVERT            CONVERT TTR TO MBBCCHHR@ZA17532 36855124
*                                       AND PLACE IT IN DXCCW5 @ZA17532 36855824
*                                                              @ZA17532 36856524
*        AT THIS POINT DXCCW5 CONTAINS 7F OR 0MBBCCHH          @ZA17532 36857224
OBPAM350 EQU   *                        LOOP FOR FILLING IN    @ZA17532 36857924
*                                       ACQUIRE LIST EXTENTS   @ZA17532 36858624
         MVC   AREXT(2),DEBSTRCC        STARTING CC OF EXTENTCS@ZA17532 36860724
         CH    RJ,DXCCW5                THIS EXT HAVE LAST REC @Y30LSBS 36861424
*                                       COMPARING EXTENT NUM   @ZA17532 36862124
*                                       TO M OF MBBCCHHR       @ZA17532 36862824
         BE    OBPAM370                 YES,GO HANDLE IT       @ZA17532 36863524
         MVC   AREXT+2(2),DEBENDCC      NO,END CC TO PARM LIST @ZA17532 36864224
         B     OBPAM390                 GO SEE IF MORE EXTENTS @ZA17532 36864924
OBPAM370 EQU   *                                               @ZA17532 36865624
         LH    R1,DXCCW5+4              CYL WHERE LAST REC IS  @ZA17532 36866324
         CLC   DXCCW5+6(2),DEBENDHH     IS LAST TRACK OF D.S.  @ZA17532 36867024
*                                       ON THIS CYLINDER?      @ZA17532 36867724
         BNE   OBPAM380                 NO,STAGE UP TO AND     @ZA17532 36868424
*                                       INCLUDING THIS CYLINDER@ZA17532 36869124
         CH    R1,DEBENDCC              ON LAST CYLINDER OF    @ZA17532 36869824
*                                       THIS EXTENT?           @ZA17532 36870524
         BE    OBPAM382                 YES, IGNORE EOF MARKER @ZA17532 36871224
         LA    R1,1(R1)                 NO,EOF MAY BE ON NEXT  @ZA17532 36871924
OBPAM380 EQU   *                                               @Y30LSBS 36872624
         STH   R1,AREXT+2               LAST CYL TO BE STAGED  @ZA17532 36873324
         B     OBPAM384                 GO ACCOUNT FOR THIS EXT@ZA17532 36874024
*                                                              @ZA17532 36874724
*        THIS CODE IS REQUIRED IN THE UNUSUAL CONDITION WHERE  @ZA17532 36875424
*        THE EOF WAS WRITTEN ON THE NEXT EXTENT.               @ZA17532 36876124
*                                                              @ZA17532 36876824
OBPAM382 EQU   *                                               @ZA17532 36877524
         STH   R1,AREXT+2               LAST CYL OF THIS EXTENT@ZA17532 36878224
         LA    RJ,1(RJ)                 ACCOUNT FOR THIS EXTENT@ZA17532 36878924
         CR    RJ,RD                    EXHAUSTED ALL EXTENTS? @ZA17532 36879624
         BE    OBPAM500                 YES,NO EOF WRITTEN     @ZA17532 36880324
         LA    RPAR,DEBEXTLN            NO,POINT TO NEXT       @ZA17532 36881024
         LA    RWTGC,L'AREXT(RWTGC)     EXTENT LISTS           @ZA17532 36881724
         MVC   AREXT(2),DEBSTRCC        EOF MAY BE ON THE FIRST@ZA17532 36882424
         MVC   AREXT+2(2),DEBSTRCC      TRACK OF THIS EXTENT   @ZA17532 36883124
OBPAM384 EQU   *                                               @ZA17532 36883824
         LA    RJ,D1(RJ)                PUT EXT NUMBER IN LIST @Y30LSBS 36884524
         B     OBPAM500                 GO TO ISSUE ACQUIRE    @ZA17532 36885224
*                                                              @ZA17532 36885924
*        SEE IF EXHAUSTED ALL EXTENTS                          @ZA17532 36886624
*                                                              @ZA17532 36887324
OBPAM390 EQU   *                                               @ZA17532 36888024
         LA    RJ,1(RJ)                 INCREMENT NUM OF EXTENT@ZA17532 36888724
         LA    RWTGC,L'AREXT(RWTGC)     NEXT EXTENT IN ACQUIRE @ZA17532 36889424
         CR    RJ,RD                    PROCESSED ALL EXTENTS? @ZA17532 36890124
         LA    RPAR,DEBEXTLN            NEXT DEB EXTENT        @ZA17532 36890824
         BNE   OBPAM350                 NO,GO PROCESS THIS ONE @ZA17532 36891524
         B     OBPAM500                 YES,GO ISSUE ACQUIRE   @ZA17532 36892224
*                                                              @ZA17532 36892924
*        OUTPUT PROCESSING - OUTPUT OR OUTIN                   @ZA17532 36893624
*                                                              @ZA17532 36894324
OBPAM400 EQU   *                                               @ZA17532 36895024
         TM    JFCBIND2,JFCOLD          IS DATA SET OLD OR NEW?@ZA17532 36895724
         BO    OBPAM408                 YES,THEN NOT MOD       @ZA17532 36896424
*                                                              @ZA17532 36897124
*        DISP=MOD PROCESSING                                   @ZA17532 36897824
*                                                              @ZA17532 36898524
*        FOR DISP=MOD,THE CYLINDER CONTAINING THE EOF IS STAGED@ZA17532 36899224
*        NO ACQUIRE IS ISSUED FOR THE CYLINDERS PRECEEDING THE @ZA17532 36899924
*        EOF. ALL EXTENTS BEYOND EOF ARE TREATED AS NORMAL     @ZA17532 36900624
*        OUTPUT IE. WE WILL ACQUIRE ALL EXTENTS - WITH INHIBIT @ZA17532 36901324
*        STAGE IF POSSIBLE.                                    @ZA17532 36902024
*                                                              @ZA17532 36902724
         BAL   RPARC,CONVERT            CONVERT TTRN OF EOF    @ZA17532 36904124
OBPAM403 EQU   *                                               @ZA17532 36904824
         MVC   AREXT(2),DXCCW5+4        STAGE CYLINDER CONTAIN-@ZA17532 36905524
         MVC   AREXT+2(2),DXCCW5+4      ING LAST RECORD        @ZA17532 36906224
         LA    RJ,1(RJ)                 ACCOUNT FOR THIS CYL   @ZA17532 36906924
         DROP  RWTGC                                           @ZA17532 36907124
         USING ACQLST,RTIOT                                    @ZA17532 36907324
         STC   RJ,ARNMEXTS              NUM OF EXTENTS IN ACQ  @ZA17532 36907624
         SR    RB,RB                    CLEAR WORK REGISTER    @ZA17532 36908324
OBPAM402 EQU   *                                               @ZA17532 36909024
         CH    RB,DXCCW5                LAST REC IN THIS EXTENT@ZA17532 36909724
         BE    OBPAM404                 YES,NOW GO SET UP NEW  @ZA17532 36910424
         LA    RPAR,DEBEXTLN            NO,SET UP TO CHECK NEXT@ZA17532 36911124
         LA    RB,1(RB)                 INCREASE M             @ZA17532 36911824
         BCT   RD,OBPAM402              GO CHECK THIS EXTENT   @ZA17532 36912524
OBPAM404 EQU   *                                               @ZA17532 36914624
         LH    RB,DXCCW5+4              LAST REC IN THIS CYL   @ZA17532 36915324
         CH    RB,DEBENDCC              LAST CYLINDER OF EXTENT@ZA17532 36916024
         BNE   OBPAM406                 NO,ACQUIRE REST OF EXT @ZA17532 36916724
         BCTR  RD,0                     YES,ANY MORE EXTENTS?  @ZA17532 36917424
         BZ    OBPAM540                 NO,GO ISSUE ACQUIRE    @ZA17532 36918124
         LA    RPAR,DEBEXTLN            YES,POINT TO NEXT ONE  @ZA17532 36918824
         LH    RB,DEBSTRCC              FIRST CYL OF NEW EXT   @ZA17532 36919524
         B     OBPAM407                 TO ACQUIRE LIST        @ZA17532 36920224
OBPAM406 EQU   *                                               @ZA17532 36920924
         LA    RB,1(RB)                 CYLINDER AFTER LAST REC@ZA17532 36921624
OBPAM407 EQU   *                                               @ZA17532 36922324
         BAL   RPARC,GETMAIN            ACQUIRE LIST FOR REST  @ZA17532 36923024
         ST    R1,ARNEDB                CHAIN IT TO PREVIOUS   @ZA17532 36925124
         LR    RWTGC,R1                 ADDRESSABILITY FOR     @ZA17532 36925824
         LR    RTIOT,R1                 NEW ACQUIRE LIST       @ZA17532 36926524
         OI    ARFLAG,INHIBST           INHIBIT STAGE THIS TIME@ZA17532 36927224
         DROP  RTIOT                                           @ZA17532 36927924
         USING ACQLST,RWTGC                                    @ZA17532 36928624
         STH   RB,AREXT                 FIRST CYL TO ACQUIRE   @ZA17532 36929324
         SR    RJ,RJ                    NO EXTENTS IN LIST     @ZA17532 36930024
         B     OBPAM412                 CONTINUE AS NORMAL OUT @ZA17532 36930724
*                                                              @ZA17532 36931424
*        OUPUT PROCESSING - DISP=OLD OR NEW                    @ZA17532 36932124
*                                                              @ZA17532 36932824
*        IF ANY EXTENT OF THE DATA SET IS NOT ON A CYLINDER    @ZA17532 36933524
*        BOUNDARY,THEN ALL EXTENTS WILL BE STAGED              @ZA17532 36934224
*                                                              @ZA17532 36934924
OBPAM408 EQU   *                                               @ZA17532 36935624
         DROP  RWTGC                                           @ZA26462 36936324
         USING ACQLST,RTIOT                                    @ZA17532 36936624
         OI    ARFLAG,INHIBST           SET INHIBIT STAGE BIT  @ZA17532 36936924
OBPAM410 EQU   *                        LOOP FOR FILLING IN    @ZA17532 36937224
*                                       EXTENTS IN ACQUIRE LIST@ZA17532 36937524
         DROP  RTIOT                                           @ZA17532 36937824
         USING ACQLST,RWTGC                                    @ZA17532 36938124
         MVC   AREXT(2),DEBSTRCC        STARTING CYL TO LIST   @ZA17532 36938424
OBPAM412 EQU   *                                               @ZA17532 36939124
         MVC   AREXT+2(2),DEBENDCC      ENDING CC TO LIST      @ZA17532 36939824
         TM    DEBDVMOD,DEBCYL          CYLINDER BOUNDARY?     @ZA17532 36940524
         BNO   OBPAM416                 YES,DON'T RESET        @ZA17532 36941224
         DROP  RWTGC                                           @ZA26462 36941424
         USING ACQLST,RTIOT                                    @ZA26462 36941524
         NI    ARFLAG,X'FF'-INHIBST     NO,RESET INHIBIT BIT   @ZA17532 36941924
OBPAM416 EQU   *                                               @ZA17532 36942624
         LA    RWTGC,L'AREXT(RWTGC)     NEXT ACQUIRE EXTENT    @ZA17532 36943324
         LA    RPAR,DEBEXTLN            NEXT DEB EXTENT        @ZA17532 36944024
         LA    RJ,1(RJ)                 COUNT THIS EXTENT      @ZA17532 36944724
         BCT   RD,OBPAM410              ACQUIRE ALL EXTENTS    @ZA17532 36945424
         TM    JFCBIND2,JFCNEW          NEW DATA SET?          @OZ28203 36945624
         BO    OBPAM500                 YES,CAN INHIBIT        @ZA26462 36946024
         TM    DCBMACRF,DCBMRECP        DCB USING EXCP MACRO?  @ZA17532 36946124
         BO    OBPAM418                 YES,STAGE ALL          @ZA17532 36946824
         TM    DCBMACRF,DCBMRPT1        USING READ NOTE/POINT? @ZA17532 36947524
         BO    OBPAM418                 BIF YES TO STAGE DATA  @ZA30847 36947724
         TM    DCBMACF2,DCBMRPT2        USING WRITE NOTE/POINT @ZA30847 36947924
         BZ    OBPAM500                 BIF NO, CAN INHIBIT    @ZA30847 36948124
OBPAM418 EQU   *                                               @ZA17532 36948924
         NI    ARFLAG,X'FF'-INHIBST     YES,STAGE ALL          @ZA17532 36951024
*                                                              @ZA17532 36951724
*        THIS IS THE ACQUIRE ROUTINE.  IT ISSUES THE ICBACREL  @Y30LSBS 36952424
*        MACRO TO GET DASD SPACE IF THE DATA SET IS ON MSS     @Y30LSBS 36953124
*        VIRTUAL DASD.                                         @ZA17532 36953824
*                                                              @Y30LSBS 36957024
OBPAM500 EQU   *                                               @Y30LSBS 36957624
         STC   RJ,ARNMEXTS              YES, STORE NUMB EXTENTS@Y30LSBS 36958224
*                                                              @Y30LSBS 36963003
*              ISSUE THE ACQUIRE.  IF IT FAILS, XCTL TO        @Y30LSBS 36963703
*              PROBLEM DETERMINATION FOR A 413-2C ABEND.       @Y30LSBS 36965003
*                                                              @Y30LSBS 36965403
OBPAM540 EQU   *                                               @Y30LSBS 36966003
         L     RTIOT,DXCCW12+4          GET FIRST ACQUIRE LIST @ZA17532 36967024
         LR    R1,RTIOT                 SET UP FOR ACQUIRE     @ZA17532 36967524
         ICBACREL TYPE=ACQ,MF=(E,ACQLST)   GET THE DASD SPACE  @Y30LSBS 36968024
         LTR   RJ,RJ                    ANY ERRORS             @Y30LSBS 36968524
         BZ    OBPAM550                 NO                     @Y30LSBS 36969024
*        ACQUIRE FAILED - ABEND                                @Y30LSFY 36969524
*        NOTE IFG0199B DESTROYS SECOND WORD OF PARM LIST       @ZA17532 36970024
*                                                              @ZA17532 36970524
OBPE111  EQU   111                      IDMS FAILURE CODE      @Y30LSFY 36971024
         LM    RPAR,RTIOT,DXCCW6        RESTORE REGS           @ZA17532 36971524
         LR    RDEB,R1                  PASS PARM LIST PTR     @Y30LSFY 36972103
         DMABCOND OBPE111,SOP6M,RES=NO,REGSAVE=YES,RETURN=NONE @Y30LSFY 36972803
         B     TCTLRTN                  XCTL TO PROB DET       @Y30LSFY 36973503
OBPAM550 EQU   *                                               @Y30LSBS 36974203
*                                                              @Y30LSBS 36974924
*        FREE UP ALL THE CORE                                  @Y30LSBS 36975924
*                                                              @Y30LSBS 36976924
         LR    R1,RTIOT                 AREA TO BE FREED       @ZA17532 36977924
         L     RTIOT,ARNEDB             ADDR OF CHAIN IF ANY   @ZA17532 36978924
         USING WTG,RWTG                                        @ZA17532 36979924
OBPAMFRE IECRES FREE,A=(R1),PREFIX=YES,STM=(RDCB,RJ,WTGPREFX)  @Y30LSBS 36980924
         LTR   RTIOT,RTIOT              ANOTHER ACQUIRE LIST?  @ZA17532 36981924
         BNZ   OBPAM550                 YES,GO FREE IT         @ZA17532 36982924
OBPAM600 EQU   *                        END OF MSS ROUTINE     @ZA17532 36983924
         LM    RPAR,RTIOT,DXCCW6        RESTORE REGS           @ZA17532 36984924
         DROP  RWTG                                            @ZA17532 36985924
         DROP  RTIOT                                           @ZA17532 36986924
         DROP  RPAR                                            @ZA17532 36987924
         EJECT                                                          36996103
*********************************************************************** 37000000
*                                                                       37100000
*      TEST FOR USER OF EXCP NOT BSAM OR QSAM                           37200000
*                                                                       37300000
*********************************************************************** 37400000
*                                                                       37500000
         TM    DCBMACRF,X'80'           EXCP BIT ON                     37600000
         BC    8,SAMOUT                 NO BRANCH                       37700000
         USING WTGENTRY,RWTGC                                    Y02072 37750002
         MVC   WTGIDTTR,SOP11           COPY DCB BACK TO USER  @Z30TSCF 37760003
         B     RELOOP                                                   37900000
*                                                                       38000000
SAMOUT   EQU   *                                                        38100000
*                                                                       38200000
         TM    ZERO(RPARC),INMASK       TEST FOR INPUT DATA SET    UT18 38209018
         BZ    SAMOUT1                  BR IF INPUT                UT18 38218018
         TM    DCBDSORG,POTEST          TEST FOR PO DATA SET       UT18 38227018
         BO    SAMOUT1                  BR IF  PO DATA SET         UT18 38236018
         TM    DCBOPTCD,TOTMASK         TEST FOR TOTALING          UT18 38245018
         BZ    SAMOUT1                  BR IF NOT SPECIFIED        UT18 38254018
         MVC   WTGIDTTR,SOP1Y           ST ID IN WTG TABLE     @Z30TSCF 38256003
         B     RELOOP                   UNCONDITIONAL BRANCH       UT18 38272018
*                                                                  UT18 38281018
SAMOUT1  EQU   *                        SYMBOLIC ADDR              UT18 38290018
         MVC   WTGIDTTR,SOP1B           ST ID IN WTG TABLE     @Z30TSCF 38292003
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)     UPDATE WHERE TO GO ENTRY        38600000
         LA    RPARC,PLOFF(0,RPARC)     UPDATE PARA LIST ENTRY          38700000
         CLC   0(2,RWTGC),AMIDCNST      THIS RT NEEDED AGAIN            38800000
         BCR   8,RBASE                  YES BR BACK TO BEGINNING        38900000
*                                                                       39000000
         CLC   0(2,RWTGC),OPIDCNST      END OF TABLE                    39100000
         BC    7,RELOOP                 NO BRANCH                       39200000
*                                                                       39300000
         LR    RPARC,RPAR                                               39400000
         LA    RWTGC,WAOFF(0,RWTG)      RE INIT  WTG LIST               39500000
ZCHEK    CLI   0(RWTGC),X'00'          IS THIS ENTRY COMPLETE           39600000
         BC    7,TCTLRTN                NO XCTL                         39700000
*                                                                       39800000
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY                  39900000
         LA    RPARC,PLOFF(0,RPARC)                                     40000000
         BC    15,ZCHEK                                                 40100000
*                                                                       40200000
TCTLRTN  EQU   *                                                        40300000
         USING WTG,RWTG                                                 40850003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*40900003
               MODID=WTGENTRY                                  @Z30TSCF 40950003
         DROP  RWTGC,RWTG                                      @Z30TSCF 40960003
*                                                              @ZA17532 40961024
*        THIS ROUTINE BALRS TO THE RESIDENT CONVERT ROUTINE TO @ZA17532 40962024
*        DETERMINE IN WHAT EXTENT AND WHERE THE LAST PHYSICAL  @ZA17532 40963024
*        RECORD OF THE DATA SET IS.                            @ZA17532 40964024
*                                                              @ZA17532 40965024
CONVERT  EQU   *                                               @ZA17532 40966024
         USING ACQLST,RTIOT                                    @ZA17532 40967024
         ST    RDCB,DXCCW12             SAVE DCB ADDRESS       @ZA17532 40968024
         STM   RTIOT,RJ,DXCCW8          SAVE WORK REGS         @ZA17532 40969024
         SR    RE,RE                    ZERO WORK REGISTER     @ZA17532 40970024
         ICM   RWK3,B'1110',DSCLSTAR    GET TTR                @ZA17532 40971024
         LA    RDCB,AREXT               GET RETURN ADDRESS     @ZA17532 40972024
         LR    R1,RDEB                  REG 1 NEEDS DEB        @ZA17532 40973024
         L     RJ,CVTPTR                GET      CVT           @ZA17532 40974024
         USING CVT,RJ                   ADDRESSABILITY         @ZA17532 40975024
         L     RJ,CVTPCNVT              GET CONVERT ROUTINE    @ZA17532 40976024
         DROP  RJ                                              @ZA17532 40977024
         BALR  RD,RJ                    GO TO CONVERT ROUTINE  @ZA17532 40978024
         L     RDCB,DXCCW12             RESTORE DCB ADDRESS    @ZA17532 40979024
         LM    RTIOT,RJ,DXCCW8          RESTORE THE REGS       @ZA17532 40980024
         MVC   DXCCW5,AREXT-1           SAVE 0MBBCCHH          @ZA17532 40981024
         XC    AREXT(8),AREXT           CLEAN UP               @ZA17532 40981524
         BR    RPARC                    RETURN                 @ZA17532 40982024
         DROP  RTIOT                                           @ZA17532 40983024
*                                                              @ZA17532 40984024
*        THIS ROUTINE OBTAINS CORE FOR AN ACQUIRE LIST         @ZA17532 40985024
*        THE CORE IS CLEARED AND KNOWN VALUES ARE INSERTED     @ZA17532 40986024
*                                                              @ZA17532 40987024
         USING WTG,RWTG                                        @ZA17532 40988024
GETMAIN  IECRES GET,PREFIX=YES,SP=230,LV=ACQPLN,ID=MSS1,       @ZA17532.40989024
               STM=(RDCB,RJ,WTGPREFX)   OBTAIN CORE FOR LIST   @ZA17532 40990024
         USING ACQLST,R1                ACQUIRE ADDRESSABILITY @ZA17532 40991024
         XC    ACQLST(ACQPLN),ACQLST    CLEAR CORE             @ZA17532 40992024
         MVC   ARVOL,UCBVOLI            MOVE IN VOLID          @ZA17532 40993024
         MVI   ACQLST+D3,ACQPLN         SET LIST LENGTH        @ZA17532 40994024
         MVI   AROP,ACQOP               SET ACQUIRE OPTION     @ZA17532 40995024
         BR    RPARC                    RETURN                 @ZA17532 40996024
         DROP  RWTG                                            @ZA17532 40997024
         DROP  R1                                              @ZA17532 40998024
*                                                                       41000000
WAOFF    EQU   32                  OFFSET OF FIRST ENTRY IN WTG TABLE   41100000
PLOFF    EQU   4                   OFFSET OF DCB ENTRIES                41200000
WGOFF    EQU   8                   OFFSET OF WTG ENTRIES                41300000
*                                                                       41350002
*  MODULE ID'S                                                          41360002
*                                                                       41370002
SOP11    DC    C'11',VL3(IGG01911)      LAST EXECUTOR          @Z30TSCF 41380003
SOP1Y    DC    C'1Y',VL3(IGG0191Y)      USER TOTALING EXECUTO  @Z30TSCF 41390003
SOP1B    DC    C'1B',VL3(IGG0191B)      ANY OTHER CONDITION    @Z30TSCF 41392003
SOP6M    DC    C'6M',VL3(IGG0196M)      PROBLEM DET.           @ZA04216 41392237
OPIDCNST DC    C'0S'                                                    41400000
AMIDCNST DC    C'1N'                    THIS EXEC'S ID.                 41500000
*                                                                       41502002
*  OTHER CONSTANTS                                                      41504002
*                                                                       41506002
NOALLOC  DC    2F'0'                   COMPARE FOR 0 IN EXTENT   A43880 41510021
FOXES    DC    F'-1'                    INVALID EXTENT FOR DEB  SA54462 41520021
         USING INFMJFCB,RWK5                                     Y02072 41530002
DSNCLC   CLC   JFCBDSNM+1(0),JFCBDSNM+2 IS REST OF DSN BLANK?   OZ03183 41550037
CLCINST  CLC   JFCBDSNM(0),ALTDSNAM     USED TO COMPARE DSN IN   Y02072 41570002
*                                         ALT AGAINST DSN IN     Y02072 41580002
*                                         THE JFCB               Y02072 41590002
VLIDLNP1 DC    0H'0',AL2(L'ALTVOLID+1)  LENGTH OF THE ALT VOLID  Y02072 41592002
*                                         FIELD PLUS '1' FOR AN  Y02072 41594002
*                                         EXECUTE INSTRUCTION    Y02072 41596002
*                                                                       41600000
*                                                                       42520021
PATCH    DC    0H'0',50X'00'            PATCH AREA             @Z30TSCF 42540003
END      EQU   *                        END OF MODULE            Y02072 42620002
         EJECT                                                          42670002
SRT      DSECT                                                          42900000
         IEFUCBOB                                                       43000000
*                                                                       43100000
         EJECT                                                          43200000
         DCBD  DSORG=PS                                                 43300021
CVT      DSECT                                                          43400000
         CVT                                                            43500000
*   TASK CONTROL BLOCK                                                  43600000
         CNOP  0,4                                                      43700000
TCB      DSECT                                                          43800000
TCBRBP   DS    F                       PO9NTER TO EXECUTING RB          43900000
TCBPIE   DS    F                       POINTER TO PROG. INTERRUPT EL.   44000000
TCBDEB   DS    F                       POINTER TO DEB QUEUE             44100000
TCBTIO   DS    F                       POINTER TO TIOT                  44200000
TCBCMP   DS    F                       TASK COMPLETION CODE             44300000
TCBTRN   DS    F                       TESTRAN FIELD                    44400000
TCBMSS   DS    F                       DATA BLOCK QUEUE ELEMENT POINTER 44500000
TCBPKF   DS    CL1                     RESERVED FOR FUTURE USE          44600000
TCBFLGS  DS    FL5                     FLAG BYTES                       44700000
TCBLMP   DS    CL1                     RESERVED FOR FUTURE USE          44800000
TCBDSP   DS    CL1                     RESERVED FOR FUTURE USE          44900000
TCBLLS   DS    F                       POINTER TO LOAD LIST             45000000
TCBJLB   DS    F                       POINTER TO JOBLIB DCB            45100000
TCBJSE   DS    F                       LIST OF INACTIVE PROGRAMS ADDR.  45200000
TCBGRS   DS    CL64                    GENERAL REGISTER SAVE AREA       45300000
TCBIDF   DS    CL1                     TCB IDENTIFIER FIELD             45400000
TCBFSA   DS    CL3                     POINTER TO 1ST PROB.PROG.SAVEAR  45500000
TCBTCB   DS    F                       RESERVED FOR FUTURE USE          45600000
TCBTME   DS    F                       POINTER TO TIMER ELEMENT         45700000
         DS    CL24                                                     45800000
TIOT     DSECT                                                          45900000
TIOELNGH DS    CL1                           LENGTH OF THIS ENTRY       46000000
TIOESTTA DS    CL1                           STATUS -A-                 46100000
TIOERLOC DS    CL2                           REL. LOC OF POOL           46200000
TIOEDDNM DS    2F                            DDNAME                     46300000
TIOEJFCB DS    1F                            JFCB DISK ADDR             46400000
TIOESTTB DS    0CL1                                                     46500000
TIOEFSRT DS    CL4                                                      46600000
         DS    CL1                                                      46700000
*        TIOT POOL ENTRY                                                46800000
TIOPNSLT DS    XL1                           NR.OF SLOTS FOR POOL       46900000
         DS    CL1                                                      47000000
TIOPNSRT DS    XL1                           NR.OF DEVICES (FILLED      47100000
*                                             SLOTS)                    47200000
TIOPPOOL DS    CL8                           POOL NAME                  47300000
TIOPSTTB DS    XL1                           STATUS OF SLOT             47400000
TIOPSLOT DS    XL3                           SRT ADDRESS OR EMPTY SLOT  47500000
TIOTFEND DS    1F                            FINAL END OF AN ENTRY      47600000
         SPACE 1                                                        47700000
         IEZDEB                                                         47750003
DEBEXTLN EQU   DEBNMTRK+L'DEBNMTRK                             @ZA17532 48750024
         IECDSECS  MAIN,WTG,PREFX,EXPAND=YES                   @Z30TSCF 51250003
         ORG   WTGIDTTR                                          Y02072 51260002
WTGID    DS    CL2                      NEXT MODS ID             Y02072 51270002
DXRGSAVE EQU   DXCCW5                   SAVE AREA FOR REGISTER   Y02072 51300002
CCWOFSET EQU   DXXCTL-FORCORE           XCTL PARM LIST OFFSET  @Y30LSFY 51600003
DCBOFSET EQU   DCBDEBAD-IHADCB     DEB RLCATBL OFFSET IN DCB            51700000
DXUCBA   EQU   DSCBEND                  UCB ADDR FOR CURRENT VOL Y02072 51710002
*                                                                       51750002
* DSECT FOR THE AUTHORIZED LIBRARY TABLE                         Y02072 51760002
*                                                                       51770002
ALTABLE  DSECT                                                   Y02072 51780002
ALTLENTH DS    X                        LENGTH OF TABLE DBL WDS  Y02072 51790002
ALTNOENT DS    X                        NUMBER OF ENTRIES IN ALT Y02072 51792002
ALTENT   EQU   *                        FOR ADDRESSABILITY FROM  Y02072 51792402
*                                         ALTABLE DSECT          Y02072 51792502
ALTENTRY DSECT                          DATA SET ENTRY           Y02072 51792802
ALTLNENT DS    X                        LEN OF ALTVOLID+ALTDSNAM Y02072 51794002
ALTVOLID DS    CL6                      VOLUME ID FOR DATASET    Y02072 51796002
ALTDSNAM DS    C                        DATASET NAME - LEN VAR   Y02072 51798002
ACQLST   DSECT                                                 @Y30LSBS 51798424
ACQOP    EQU   X'02'                    ACQUIRE OP CODE        @Y30LSBS 54798424
ACQPLN   EQU   96                       PARM LIST LENGTH       @Y30LSBS 57798424
         ICBACREL TYPE=ACQ,MF=L         LIST FORM              @Y30LSBS 60798424
           END                                                          63798424
