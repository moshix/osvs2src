 TITLE 'IGG0191O--STAGE 2 OPEN EXECUTOR FOR INPUT ON DA'                00100002
IGG0191O CSECT                                                          00101019
*MODULE NAME - IGG0191O                                          Y02072 00103002
*                                                                       00105002
*DESCRIPTIVE NAME - BUILD IOBS                                   Y02072 00107002
*                                                                       00107402
*COPYRIGHT - NONE                                                Y02072 00107802
*                                                                       00108202
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00108602
*                                                                       00109002
*          VS 1 RELEASE 3 DELETIONS/CHANGES                             00109402
*                                                                XA2057 00109802
*          VS2 RELEASE 2 DELETIONS                               Y02072 00111002
*019800,307600-307800,312000,337000,467080,520000-522000,        Y02072 00121002
*530000-532000,651000,537000,540000,561000,568000,651000         Y02072 00131002
*                                                                YM7595 00133002
*                                                                       00135003
*          VS2 RELEASE 3 DELETIONS                                      00137003
*                                                              @Z30TSCF 00139003
*                                                                       00140019
*          RELEASE 20 DELETIONS                                       * 01500019
*3632107000-109000,179000,233000,310100-310400,314000-322000,    S20201 01520020
*3632353000-354000,382000-388000,402000-403000,416000,425000-    S20201 01540020
*3632438000,440000-449000,452000-453000,457000-459000,466000-    S20201 01560020
*3632467000,471000-475000,479100-479200,488000-489000,603000     S20201 01580020
*          RELEASE 21 DELETIONS                                       * 01600019
*0091042000,566000,589000-591000,613000-619000,651000,689000-    S21042 01630021
*0091690000                                                      S21042 01660021
*  REFER TO CODE FLAGGED XA2057                                 SA62781 01710002
*                                                                       01950019
*STATUS CHANGE LEVEL 003                                                01980002
*                                                                       02010019
*FUNCTION/OPERATION--FOR DCB'S BEING OPENED FOR INPUT                   02100019
*      IT WILL LINK THE IOB'S AND INITIALIZE THEM.                      02700019
*      IT WILL CONSTRUCT CHANNEL PROGRAMS NEEDED FOR PROPER EXECUTION.  02800019
*      IT WILL SET UP THE NUMBER OF EXTENTS NEEDED AND PLACE THE        02900019
*      ADDRESSES IN THE DCB AND IOB'S.                                  03000019
*                                                                       03100019
*      THIS MODULE WAS SPLIT FROM IGG0191D FOR RELEASE 19               03110019
*                                                                       03120019
*ENTRY POINTS--ENTERED FROM IGG0191D BY USE OF THE XCTL MACRO.          03200019
*                                                                       03300019
*INPUT--SEE DESCRIPTION OF REGISTERS, DCB(USERS).                       03400019
*OUTPUT--IOB(USER), SEE DESCRIPTION OF THE REGISTERS, DCB(USERS)        03500019
*                                                                       03600019
*                                                                       03700019
*EXTERNAL ROUTINES--NONE.                                               03800019
*                                                                       03900019
*EXITS-NORMAL--XCTL TO IGG01915 TO LOAD ROUTINES                        04000019
*                                                                       04100019
*EXITS-ERROR--XCTL TO PROB DET (IGG0196M) FOR WTP AND 013 ABEND         04160021
*            INSUFFICIENT BUFFERS AVAILABLE IN                          04220021
*            BUFFER POOL TO SATISFY DCB BUFFER REQUIREMENTS       M1552 04300019
*                                                                       04350002
*MACROS-ACTION-MODESET, XCTL, XCTLTABL, DMABCOND                 Y02072 04360002
*                                                                       04370002
*MACROS-MAPPING-IECDSECS(DCB,IOB,WTG),IHACCW,IGGBCB,IHAFCAUD     Y02072 04380002
*                                                                       04400019
*TABLES/WORKAREAS-- WHERE TO GO TABLE  (WTG)                            04500019
*                                                                       04600019
*   BYTE 0-7   NAME                                                     04700019
*   BYTE 8-10  RELATIVE DISK ADDRESS (TTR) OF FIRST RECORD              04800019
*   BYTE 11    CONCATENATION NUMBER                                     04900019
*   BYTE 12    ZERO                                                     05000019
*   BYTE 13    ALIAS INDICATOR AND USER DATA FIELD DESCRIPTOR           05100019
*              ALIAS INDICATOR 1 BIT                                    05200019
*              NUMBER OF TTRS IN USERS DATA FIELD  2 BITS               05300019
*   BYTE 14-16 TTR OF FIRST TEXT RECORD                                 05400019
*   BYTE 17    ZERO                                                     05500019
*   BYTE 18-19 TTR OF NOTE LIST OR SCATTER LIST                         05600019
*   BYTE 20    TRANSLATION TABLE                                        05700019
*   BYTE 21    ZERO OR NUMBER OF ENTRIES IN THE NOTE LIST               05800019
*   BYTE 22-23 ATTRIBUTES                                               05900019
*   BYTE 24-26 TOTAL CONTIGUOUS MAIN STORAGE REQUIRED FOR MODULE        06000019
*   BYTE 27-28 LENGTH OF FIRST TEXT RECORD                              06100019
*   BYTE 29    LENGTH OF WTG TABLE  (IN DOUBLE WORDS)                   06200019
*   BYTE 30-31 PATH THROUGH LOADS OF ROUTINES                           06300019
*   BYTE 32-34 IDTTR OF EXECUTOR FOR 1ST DCB                            06400019
*   BYTE 35    WORKAREA ADDRESS FOR 1ST DCB                             06500019
*   BYTE 36-39 TABLE OF IDTTR'S                                         06600019
*                                                                       06700019
*        32+N(8)   IDTTR OF EXECUTOR FOR NTH DCB      (3 BYTES)         06800019
*                  WORKAREA ADDRESS FOR NTH DCB       (1 BYTE)          06900019
*                  IDTTR OF LAST ROUTINE  LOAD        (3 BYTES)         07000019
*                  NOT USED                           (1 BYTE)          07100019
*                                                                       07200019
*                                                                       07300019
*********************************************************************** 07400019
*ATTRIBUTES--REENTRANT, REUSABLE, SUPERVISOR STATE,              Y02072 07500002
*            RUNS IN USER KEY UNLESS OTHERWISE SPECIFIED         Y02072 07550002
*                                                                       07600019
*                                                                       07700019
*********************************************************************** 07800019
*                                                                       07900019
*                                                                       08000019
*  REGISTER CONVENTIONS USED THROUGH OUT ALL OPEN PASSES                08100019
*                                                                       08200019
*********************************************************************** 08300019
*                                                                       08400019
RDCB     EQU   2                        DCB REGISTER                    08500019
RBASE    EQU   3                        BASE REGISTER                   08600019
RCORE    EQU   4                        WORK AREA ADDRESS               08700019
RPAR     EQU   5                        TOP OF PARAMETER LIST           08800019
RWTG     EQU   6                        TOP OF WTG TABLE                08900019
RPARC    EQU   7                        CURRENT PARAMETER               09000019
RWTGC    EQU   8                        CURRENT TRANS LOAD              09100019
RBUFADR  EQU   9                        MAINTAINS ADDR OF NEXT   Y02072 09150002
*                                         AVAILABLE BUFFER       Y02072 09160002
RUCB     EQU   10                       COUNTER IN IOB GENERATION       09300019
RDEB     EQU   11                       DEB ADDRESS                     09400019
RB       EQU   12                       WORK REG1  **                   09500019
RC       EQU   13                       WORK REG2  **  IOB GENERATION   09600019
RWK1     EQU   RC                       WORK REGISTER            Y02072 09650002
RD       EQU   14                       WORK REG3  **                   09700019
RJ       EQU   15                       WORK REG4                       09800019
CPR      EQU   RJ                       ADDR OF CHANNEL PROG            09900019
RWK2     EQU   RJ                       WORK REGISTER            Y02072 09950002
RE       EQU   0                        WORK REG5                       10000019
RF       EQU   1                        WORK REG6                       10100019
*                                                                       10200019
*                                                                       10300019
PARAR    EQU   RPARC                                                    10400019
*                                                                       10500019
*********************************************************************** 10600019
*                                                                       10610020
* DISPLACEMENTS AS EQUATES                                              10620020
*                                                                       10630020
D0       EQU   0                        DISPLACEMENT OF ZERO     S20201 10640020
D1       EQU   1                        DISPLACEMENT OF ONE      S20201 10650020
D4       EQU   4                        DISPLACEMENT OF FOUR     S20201 10660020
D6       EQU   6                        DISPLACEMENT OF SIX      S20201 10670020
D7       EQU   7                        DISPLACEMENT OF SEVEN    S20201 10680020
D8       EQU   8                        DISPLACEMENT OF EIGHT    S20201 10690020
D16      EQU   16                       DISPLACEMENT OF SIXTEEN  S20201 10700020
*                                         DMO                    S20201 10710020
D24      EQU   24                       DISPLACEMENT OF 24       S20201 10720020
D28      EQU   28                       DISPLACEMENT OF          S20201 10730020
*                                       TWENTYEIGHT              S20201 10740020
D31      EQU   31                       DISPLACEMENT OF          S20201 10750020
*                                       THIRTYONE                S20201 10760020
D36      EQU   36                       DISPLACEMENT OF          S20201 10770020
*                                       THIRTYSIX                S20201 10780020
D40      EQU   40                       DISPLACEMENT OF FORTY    S20201 10790020
D44      EQU   44                       DISPLACEMENT OF          S20201 10800020
*                                       FORTYFOUR                S20201 10810020
D47      EQU   47                       DISPLACEMENT OF          S20201 10820020
*                                       FORTYSEVEN               S20201 10830020
D48      EQU   48                       DISPLACEMENT OF 48       S20201 10840020
D64      EQU   64                       DISPLACEMENT OF 64       S20201 10850020
*                                                                       10860020
* BYTE COUNTS AS EQUATES                                                10870020
*                                                                       10880020
B0       EQU   0                        BYTE COUNT OF ZERO       S20201 10890020
B1       EQU   1                        BYTE COUNT OF ONE        S20201 10900020
B8       EQU   8                        BYTE COUNT OF EIGHT      S20201 10910020
*                                                                       10920020
*********************************************************************   11000019
* MASK'S TO TEST PARAMETER LIST WITH                                    11100019
INP      EQU   X'0F'                                                    11200019
OUTP       EQU   X'0F'                                                  11300019
UPDATE     EQU   X'04'                                                  11400019
INOUT      EQU   X'03'                                                  11500019
OUTIN      EQU   X'07'                                                  11600019
RDBACK     EQU   X'01'                                                  11700019
*                                                                       11800019
*                                                                       11900019
*********************************************************************   12000019
*                                                                       12100019
*                                                                       12200019
* OFFSET FOR PARAMETER TESTS                                            12300019
*                                                                       12400019
ONE        EQU   X'01'                                                  12500019
FRTYATE    EQU   48                                                     12600019
DISPSN     EQU   X'0'                                                   12700019
*                                                                       12800019
*                                                                       12900019
*********************************************************************   13000019
*                                                                       13100019
* OFFSETS FOR DEB REFERENCE                                             13200019
*                                                                       13300019
*                                                                       13400019
BIN        EQU   36                     BIN NOS.                   DM0I 13500019
BEXT       EQU   38                     BIN EXTENT                 DM0I 13600019
*                                                                       13700019
*                                                                       13800019
*                                                                       13900019
*********************************************************************   14000019
*                                                                       14100019
* MASK'S USED TO TEST OPTION FIELDS IN DCB                              14200019
*                                                                       14300019
*                                                                       14400019
*                                                                       14500019
DOUBLE     EQU   X'01'                                                  14600019
*                                                                       14700019
*                                                                       14800019
STOWB      EQU   X'80'                                                  14900019
WRTCK      EQU   X'80'                  WRITE CHECK                DM0I 15000019
OVRFLO     EQU   X'20'                                                  15100019
PCI        EQU   X'20'                                                  15200019
MINKEY     EQU   X'01'                                                  15300019
CONCAT     EQU   X'FF'                                                  15400019
*                                                                       15500019
*********************************************************************   15600019
*                                                                       15700019
* MASKS FOR ACCESS METHODS IN SAM                                       15800019
*                                                                       15900019
QSAMB      EQU   X'01'                                                  16000019
BSAMBIT    EQU   X'00'                                                  16100019
PAM        EQU   X'02'                                                  16200019
*                                                                       16300019
*                                                                       16400019
* MASKS FOR MACRO'S TO BE USED                                          16500019
*                                                                       16600019
GETB       EQU   X'40'                                                  16700019
PUTB       EQU   X'40'                                                  16800019
READB      EQU   X'20'                                                  16900019
WRITEB     EQU   X'20'                                                  17000019
POINTB     EQU   X'04'                                                  17100019
CNTRLB     EQU   X'02'                                                  17200019
*                                                                       17300019
*                                                                       17400019
*********************************************************************   17500019
*                                                                       17600019
* MASKS FOR DEVICES TO BE SUPPORTED                                     17700019
*                                                                       17800019
SRCHDRK  EQU   X'40'                    SRCH DIRECT MASK         S20201 17840020
NOTSILI  EQU   X'DF'                    NOT SIL BIT MASK         S20201 17880020
NORCDRY  EQU   X'20'                    NO RCD READY FOR ENTIRE  S20201 17920020
*                                       DATA SET MASK                   17960020
*                                                                       18000019
*********************************************************************   18100019
*                                                                       18200019
*                                                                       18300019
COFFSR   EQU   88                       OFFSET OF RDCCW IF RCD   S20201 18310020
*                                       READY USED                      18320020
CSTOFFSR EQU   72                       OFFSET OF RDCCW IF RCD   S20201 18330020
*                                       READY AND F-STD RCDS            18340020
SRCHD    EQU   X'40'                    SEARCH DIRECT MASK       S20201 18350020
*                                         DMO                    S20201 18360020
*                                                                  DMOR 18370020
*                                                                       18400019
*                                                                       18500019
*********************************************************************   18600019
*                                                                       18700019
* MASKS FOR STATUS BITS TO BE TESTED                                    18800019
*                                                                       18900019
*                                                                       19000019
EXCPN      EQU   X'30'                                                  19100019
COMPLETE   EQU   X'60'                  COMPLETE MASK              DM0I 19200019
FIRSTIOB   EQU   X'01'                                                  19300019
*                                                                       19400019
*                                                                       19500019
*                                                                       19600019
*********************************************************************   19700019
*                                                                       19800019
* MASKS FOR BUFFER TECHNIQUE'S                                          19900019
*                                                                       20000019
BFTEKR     EQU   X'20'                  BDAM VS                         20100019
VSBITS     EQU   X'48'                  VS BITS IN DCBRECFM             20200019
CYCLICB    EQU   X'20'                                                  20300019
EXCHANGB   EQU   X'10'                                                  20400019
SIMPLEB    EQU   X'40'                                                  20500019
EXCHCYCL   EQU   X'30'                                                  20600019
*                                                                       20700019
*********************************************************************   20800019
*                                                                       20900019
*                                                                       21000019
* MODES OF OPERATION FOR QSAM                                           21100019
*                                                                       21200019
LOCATEB    EQU   X'08'                                                  21300019
MOVEB      EQU   X'10'                                                  21400019
SUBSTUTB   EQU   X'04'                                                  21500019
*                                                                       21600019
*                                                                       21700019
*********************************************************************   21800019
*                                                                       21900019
*                                                                       22000019
* COMMAND BYTES FOR THE 2841                                            22100019
*                                                                       22200019
*       CONTROL UNIT                                                    22300019
*                                                                       22400019
*                                                                       22500019
*                                                                       22600019
SRCHE      EQU   X'31'                                                  22700019
WRTCKD     EQU   X'1D'                                                  22800019
RDC        EQU   X'92'                                                  22900019
RDKD       EQU   X'8E'                                                  23000019
RDD        EQU   X'86'                                                  23100019
TIC        EQU   X'08'                                                  23200019
MTRCT    EQU   X'92'                    M/T RD CNT CCW CMND      S20201 23240020
SETSC    EQU   X'23'                    SET SECTOR CCW CMND      S20201 23280020
RDSC     EQU   X'22'                    READ SECTOR CCW CMND     S20201 23320020
*                                                                       23360020
*                                                                       23400019
*********************************************************************   23500019
*                                                                       23600019
*                                                                       23700019
* MASKS FOR RECORD FORMATS                                              23800019
*                                                                       23900019
*                                                                       24000019
STANDRDF   EQU   X'88'                  STANDARD FORMORT           DM0I 24100019
FORMATU    EQU   X'C0'                                                  24200019
FORMATF    EQU   X'80'                                                  24300019
FORMATV    EQU   X'40'                                                  24400019
BLOCKED    EQU   X'10'                                                  24500019
*                                                                       24600019
*                                                                       24700019
*********************************************************************   24800019
*                                                                       24900019
*                                                                       25000019
*   CHANNEL CONTROL WORD FLAGS                                          25100019
*                                                                       25200019
SKIP       EQU   X'10'                                                  25300019
SLI        EQU   X'20'                                                  25400019
SLIBIT     EQU   X'DF'                  TO TURN OFF SLI BIT             25500019
CCWNOP     EQU   X'03'                  NOP                             25600019
CC         EQU   X'40'                                                  25700019
DATACH     EQU   X'A0'                                                  25800019
SLICC      EQU   X'60'                                                  25900019
SLICCSK    EQU   X'70'                                                  26000019
*                                                                       26100019
*                                                                       26200019
*********************************************************************   26300019
*                                                                       26400019
*                                                                       26500019
KEYS       EQU   X'01'                                                  26600019
QSAM       EQU   X'01'                                                  26700019
*                                                                       26800019
*                                                                       26900019
*********************************************************************   27000019
*                                                                       27100019
GETMAIN    EQU   4                                                      27200019
QSAMZ      EQU   X'05'                  MASK                       DM0I 27300019
NRMLEND    EQU   X'7F'                  NORMAL END CODE FOR ECB         27310019
SRCHDRCT   EQU   X'40'                  SEARCH DIRECT--DCBCIND1         27320019
POBIT      EQU   X'02'                  PARTITIONED ORGANIZATION        27330019
ABCODE     EQU   X'013'                  ABEND CODE                     27340019
COMMTABL   EQU   16                     MASK                       DM0I 27400019
NULL       EQU   0                      CONSTANT 0                      27410019
IOBNUM     EQU   1                      DEFAULT NO OF IOB'S             27500019
K2         EQU   2                      CONSTANT 2                      27510019
K3         EQU   3                      CONSTANT 3                      27520019
WORD       EQU   4                      LENGTH OF A FULL WORD           27530019
K5         EQU   5                      CONSTANT 5                      27540019
K6         EQU   6                      CONSTANT 6                      27550019
K7         EQU   7                      CONSTANT 7                      27551019
K8         EQU   8                      CONSTANT 8                      27560019
L1CCW      EQU   8                      LENGTH OF 1 CCW                 27600019
K12        EQU   12                     CONSTANT 12                     27610019
K14        EQU   14                     CONSTANT 14                     27620019
K16        EQU   16                     CONSTANT 16                     27630019
L2CCW      EQU   16                     LENGTH OF 2 CCW'S               27700019
K19        EQU   19                     CONSTANT 19                     27710019
K20        EQU   20                     CONSTANT 20                     27720019
K23        EQU   23                     CONSTANT 23                     27730019
L3CCW      EQU   24                     LENGTH OF 3 CCW'S               27800019
K24        EQU   24                     CONSTANT 24                     27810019
K28        EQU   28                     CONSTANT 28                     27820019
K31        EQU   31                     CONSTANT 31                     27830019
K32        EQU   32                     CONSTANT 32                     27840019
K36        EQU   36                     CONSTANT 36                     27850019
L5CCW      EQU   40                     LENGTH OF 5 CCW'S               27900019
K40        EQU   40                     CONSTANT 40                     27910019
K43        EQU   43                     CONSTANT 43                     27920019
IOBLNGTH   EQU   48                     LENGTH OF IOB                   28000019
K48        EQU   48                     CONSTANT 48                     28001019
CPLNGTH    EQU   64                     LENGTH OF CHANNEL PRGM          28010019
K64        EQU   64                     CONSTANT 64                     28020019
K80        EQU   80                     CONSTANT 80                     28030019
K83        EQU   83                     CONSTANT 83                     28040019
K104       EQU   104                    CONSTANT 104                    28050019
OABD064  EQU   64                                                S21042 28070021
*********************************************************************   28100019
*                                                                       28200019
*                                                                       28300019
*                                                                       28400019
*                                                                       28500019
*                                                                       28600019
*                                                                       28800019
*                                                                       28900019
*                                                                       29000019
         BALR  RBASE,NULL               REG 3 IS BASE                   29100019
         USING SOP2,RBASE                                               29200019
         USING IHADCB,RDCB              REG 2 IS DCB                    29300019
         USING FORCORE,RCORE            REG 4 IS WORK AREA ADDR         29500019
SOP2     EQU   *                                                        30100019
*                                                                       30150002
         B     BEGIN                    BR AROUND CONSTANTS      Y02072 30160002
         DC    C'IGG0191O'              MODULE NAME              Y02072 30170002
         DC    C'@Z30TSCF'              LAST SHIP CODE         @Z30TSCF 30180003
         DC    C'10/18/74'              LAST DATE MODIFIED     @Z30TSCF 30190003
BEGIN    DS    0H                                                Y02072 30192002
*                                                                       30200019
         L     RDCB,NULL(RPARC)         GET DCB ADDRESS                 30300019
         LA    RDCB,NULL(RDCB)          CLEAR HI BYTE                   30400019
         L     RCORE,WORD(RWTGC)        GET WORK AREA ADDRESS           30500019
*                                                                       30600019
         L     RB,DCBIOBA               GET FIRST IOB ADDR              30700019
         MODESET  KEYADDR=DXUKEY,WORKREG=9  GET INTO USER KEY    Y02072 30742002
         LR    RC,RB                    SET UP WORK REG                 30800019
         LR    RD,RB                    SET UP WORK REG                 30900019
         SR    RF,RF                    CLEAR FOR IC                    31000019
         IC    RF,DCBNCP                GET NO OF IOB'S                 31100019
         TM    DCBCIND2,QSAMB           QSAM USED                S20201 31120020
         BNO   SOP230                   BRANCH IF NO             S20201 31140020
         IC    RF,DCBBUFNO              USE BUFFER NO FOR IOB    S20201 31160020
*                                       CNT                      S20201 31180020
SOP230   EQU   *                                                 S20201 31400020
         LR    RUCB,RF                  LOAD REGISTER            S20201 31500020
         LR    RDEB,RUCB                PUT COUNT IN DECR REG    S20201 31600020
*                                         DMO                    S20201 31700020
SOPSTART EQU   *                                                 S20201 31800020
*                                                                       31900020
* START OF IOB BUILD ROUTINE                                            32000020
*                                                                       32100020
         SPACE 2                                                        32300019
*                                                                       32400019
SOP242   EQU   *                                                        32500019
*                                                                       32600019
         ST    RB,NULL(RD)              LINK NEW IOB TO LAST ONE BUILT  32700019
         LR    RD,RB                    UPDATE CURRENT IOB POINTER      32800019
         LA    RB,WORD(RB)              POINT TO ECB SLOT               32900019
         OI    NULL(RB),NRMLEND         SET ECB COMPLETE WITHOUT ERROR  33000019
         ST    RB,K12(RD)               STORE ECB ADDR IN IOB           33100019
         LA    RB,K20(RB)               POINT TO CP POINTER SLOT        33200019
         LR    RC,RB                    SAVE ADDR                       33300019
         LA    RB,K24(RB)               POINT TO CP START ADDR          33400019
SOP243   EQU   *                                                        33500019
         ST    RB,NULL(RC)              STORE CP STARTAD IN IOB         33600019
         L     RWK2,DXUDCBAD            GET USERS DCB ADDR       Y02072 33700002
         USING IOBSIOCC,RC                                       Y02072 33750002
         ST    RWK2,IOBDCBPT            DCB ADDR TO IOB          Y02072 33760002
         DROP  RC                                                Y02072 33770002
         MVC   K40(L'DCBFDAD,RD),DCBFDAD  INITIALIZE IOBFDAD.           33800019
*                                                                       33900019
*********************************************************************** 34000019
*                                                                       34100019
*    CONSTRUCTION OF READ CHANNEL PROGRAM FOLLOWS                       34200019
*                                                                       34300019
*********************************************************************** 34400019
*                                                                       34500019
SOP255   EQU   *                                                        34600019
*                                                                       34700019
         LA    RC,K19(RC)               POINT TO CCHHR FIELD IN IOB     34800019
         TM    JFCBMASK+D6,NORCDRY      ANY NON RPS DEVICES      S20201 34810020
         BO    SOP2NC1                  BRANCH IF YES            S20201 34820020
         BAL   RJ,SOP2STA               IF NOT GO BUILD SET      S20201 34830020
*                                       SECTOR                   S20201 34840020
SOP2NC1  EQU   *                                                 S20201 34850020
         ST    RC,NULL(RB)              STORE ADDR IN SRCH CCW          34900019
         MVI   NULL(RB),SRCHE           STORE CMD BYTE                  35000019
         MVI   K7(RB),K5                STORE COUNT OF 5 IN CCW         35100019
         OI    WORD(RB),CC              SET CMD CHAIN FLAG ON           35200019
         ST    RB,D8(RB)                PUT SEARCH ADDR IN TIC   S20201 35270020
*                                       CCW DMO                  S20201 35340020
         LR    RC,RB                    UPDATE PTR               S20201 35410020
         MVI   K8(RB),TIC               STORE TIC CMD BYTE              35500019
         SR    RE,RE                                              17363 35600019
         IC    RE,DCBKEYLE              OBTAIN KL                 17363 35700019
         AH    RE,DCBBLKSI              ADD DL                    17363 35800019
*     KL+DL TO RH OF TIC FOR USE BY EOB ROUT                      17363 35810019
         STH   RE,K14(RB)                                         17363 35900019
SOP255B  EQU   *                                                  17363 36000019
*                                                                       36100019
*                                                                       36200019
*     SRCH AND TIC CCWS HAVE BEEN GENERATED AT THIS POINT               36300019
*                                                                       36400019
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 36410002
         MVI   DCBOFFSR,K80             OFFSET TO RD CCW                36500019
         TM    DCBMACRF,POINTB          POINT MACRO USED ON INPUT       36600019
         BZ    SOP255A0                 NO BRANCH                       36700019
         MVI   DCBCNTRZ,QSAMZ           MOVE ID                    DM0I 36800019
         B     SOP2550                  GO ON                      DM0I 36900019
*                                                                       37000019
SOP255A0 EQU   *                                                        37100019
         TM    DCBRECFM,STANDRDF        STANDARD F RECORDS USED         37200019
         BO    SOP258                   YES BRANCH                      37300019
*                                                                       37400019
SOP2550  EQU   *                                                        37500019
         MODESET  KEYADDR=DXUKEY,WORKREG=15 GET INTO USER KEY    YM1393 37510002
         LA    RE,K24(RB)                                               37600019
         ST    RE,K16(RB)                                               37700019
         MVI   K16(RB),TIC              STORE TIC CMD BYTE              37800019
         OI    K20(RB),SLICCSK          SET SLI,CC,AND SKIP FLAGS       37900019
         MVI   K23(RB),ONE              STORE A COUNT OF ONE            38000019
*                                                                       38100019
         CH    RUCB,CONONE              ONE IOB TO BE BUILT      S20201 38300020
*                                         DMO                    S20201 38500020
SOP256   BE    SOP256C                  YES BRANCH                      38900019
*                                                                       39000019
*                                                                       39100019
SOP256A  LA    RC,K83(RC)               POINT TO NEXT DA ADDR FIELD     39200019
SOP256B  ST    RC,K24(RB)               STORE IN RD COUNT CCW           39300019
         MVI   K24(RB),RDC              STORE RD CNT CMD BYTE           39400019
         B     SOP257                   GO ON                      DM0I 39500019
*                                                                       39600019
SOP256C  L     RDCB,DXUDCBAD            GET ADDR OF USERS COPY   Y02072 39650002
         LA    RC,DCBFDAD+K3            POINT TO CCHHR IN DCB           39700002
         L     RDCB,0(RPARC)            GET ADDR OF PROTECTED    Y02072 39750002
         B     SOP256B                  BACK                       DM0I 39800019
*                                                                       39900019
SOP257   MVI   K31(RB),K5               STORE COUNT OF 5 IN RDC CCW     40000019
         OI    K28(RB),SLICC            SET SLI AND CC FLAGS            40100019
*                                                                       40120020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD      S20201 40140020
*                                       READY                    S20201 40160020
         BO    SOP258A                  BRANCH IF YES            S20201 40180020
         MVI   D31(RB),B8               SET BYTE COUNT TO EIGHT  S20201 40200020
         LA    RE,D48(RB)               GET DW END CHP           S20201 40220020
         ST    RE,D24(RB)               PUT AS ADDRESS IN CCW    S20201 40240020
         MVI   D24(RB),RDC              PUT IN RD CNT CCW        S20201 40260020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 40262002
         MVI   DCBOFFSR,COFFSR          PUT IN CARN OFFSET       S20201 40280020
         MODESET  KEYADDR=DXUKEY,WORKREG=15 GET INTO USER KEY    YM1393 40282002
         OI    D36(RB),SLI              SILI ON FOR ALL BUT      S20201 40300020
*                                       STNDRD                   S20201 40320020
         NI    D28(RB),NOTSILI          CLEAR SILI BIT           S20201 40340020
         B     SOP258A                  EVER ONWARD              S20201 40360020
SOP258   SH    RB,SXTEN                 SUBT 16 FROM START OF CP ADDR   40400019
         MVI   DCBCNTRL+K3,ONE          EPD2 ID NUMBER                  40500019
         OI    DCBCIND1,SRCHDRCT        SET SRCH DIRECT FLAG            40600019
         MODESET  KEYADDR=DXUKEY,WORKREG=15 GET INTO USER KEY    YM1393 40610002
*                                                                       40700019
SOP258A  EQU   *                                                        40800019
         TM    DCBCIND2,QSAMB           QSAM USED                       40900019
         BO    SOP259                   YES BRANCH                      41000019
*                                                                       41100019
         CLI   DCBKEYLE,ONE             IS KEY LENGTH SPECIFIED         41200019
         BL    SOP259A                  NO BRANCH                       41300019
*                                                                       41400019
         MVI   K32(RB),RDKD             STORE RD KEY&DATA CMD BYTE      41500019
         B     SOP259C                  GO AROUND NEXT           S20201 41600020
*                                                                       41700019
SOP259   EQU   *                                                        41800019
         LA    RF,K32(RB)               POINT TO ACTUAL RD DATA CCW     41900019
*                                                                       41950002
* FILL IN CCW WITH BUFFER ADDRESS AND BYTE COUNT                        42000002
*                                                                       42050002
         L     RWK2,DCBBUFCB            ADDR OF BUF CNTRL BLK    YM7595 42100002
         USING BCBLK,RWK2                                               42150002
         L     RBUFADR,BCBBUFPT         ADDR OF NEXT AVAIL BUF   YM7595 42160002
         LTR   RBUFADR,RBUFADR          IS BUFFER ADDR VALID     YM7595 42170002
         BZ    BUFERR                   NO, GO ISSUE DMABCOND    YM7595 42180002
         USING BUFFER,RBUFADR                                           42190002
         MVC   BCBBUFAD,BUFNXPTB        UPDATE WITH NEW BUF ADD  YM7595 42192002
         USING CCW,RF                                                   42194002
         STCM  RBUFADR,B'0111',CCWADDRB  BUF ADDR TO CCW         YM7595 42196002
         MVC   CCWBYTE,DCBBLKSI         BYTE COUNT TO CCW        YM7595 42198002
         DROP  RF,RWK2,RBUFADR                                          42198402
SOP259A  EQU   *                                                        42200019
         MVI   K32(RB),RDD              STORE RD DATA CMD BYTE          42300019
*                                                                       42400019
*                                                                       42440020
SOP259C  EQU   *                                                 S20201 42480020
*                                                                       42520020
         TM    DCBRECFM,FORMATU         FORMAT U RECORDS         S20201 42560020
*                                         DMO                    S20201 42600020
         BM    SOP259XB                 BRANCH IF NO             S20201 42640020
*                                         DMO                    S20201 42680020
         OI    D36(RB),SLI              TURN ON SILI FLAG        S20201 42720020
*                                         DMO                    S20201 42760020
SOP259XB EQU   *                                                 S20201 42800020
         TM    DCBCIND1,SRCHDRK         SERARCH DIRECT USED      S20201 42840020
         BNO   SOP2NST                  IF NO BRANCH             S20201 42880020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 42882002
         MVI   DCBOFFSR,D64             SET OFFSET FOR NORM F    S20201 42920020
*                                       RCDS                     S20201 42960020
         MODESET  KEYADDR=DXUKEY,WORKREG=15 GET INTO USER KEY    YM1393 42962002
         TM    JFCBMASK+D6,NORCDRY      STAND F AND RCD READY    S20201 43000020
         BO    SOP259G                  BRANCH IF NO             S20201 43040020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 43042002
         MVI   DCBOFFSR,CSTOFFSR        IF NO PUT CARNIVAL       S20201 43080020
*                                       OFFSET                   S20201 43120020
         MODESET  KEYADDR=DXUKEY,WORKREG=15 GET INTO USER KEY    YM1393 43122002
         MVI   D40(RB),MTRCT            IF YES PUT IN MT RD CNT  S20201 43160020
         OI    D36(RB),CC               TURN ON CMND CHAIN IN    S20201 43200020
*                                       PRE-                     S20201 43240020
*                                       VIOUS CCW                       43280020
         OI    D44(RB),CC+SLI+SKIP      CMND CHAIN + SLI + SKIP  S20201 43320020
*                                       IN THIS CCW                     43360020
         MVI   D47(RB),B1               SET BYTE CNT TO ONE      S20201 43400020
         LA    RB,B8(RB)                INCR PTR                 S20201 43440020
SOP2NST  EQU   *                                                 S20201 43480020
*                                                                       43520020
         TM    JFCBMASK+D6,NORCDRY      NOT STND F, BUT WITH RCD S20201 43560020
*                                       READY                           43600020
         BO    SOP2NRR                  BRANCH IF NO             S20201 43640020
         BAL   RJ,SOP2RTA               GO BUILD RD SECTOR CCW   S20201 43680020
SOP2NRR  EQU   *                                                 S20201 43720020
*                                                                       43760020
*******************************************************************DMOR 43800020
SOP259D  EQU   *                                                        43900019
         CH    RUCB,CONONE              ONE IOB TO BE BUILT      S20201 44200020
*                                         DMO                    S20201 44500020
SOP259E1 BE    SOP259G                  YES BRANCH                      45000019
*                                                                       45100019
         CH    RDEB,CONONE              THIS LAST IOB            S20201 45200020
         BNE   SOP259G                  BRANCH IF NO             S20201 45300020
*                                                                       45400019
         L     RC,DCBIOBA               GET FIRST IOB GENERATED         45500019
         LA    RC,K43(RC)               POINT TO CCHHR FIELD            45600019
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD      S20201 45630020
*                                       READY  DMO               S20201 45660020
         BNO   SOP259G                  BRANCH IF NO             S20201 45690020
*                                         DMO                    S20201 45720020
         ST    RC,D24(RB)               RD CNT OF LAST IOB TO    S20201 45750020
*                                       FRST DMO                 S20201 45780020
         MVI   D24(RB),RDC              RESTORE CCW CMND         S20201 45810020
*                                         DMO                    S20201 45840020
SOP259G  EQU   *                                                  20185 45910019
         TM    DCBCIND1,SRCHDRCT        IS THIS SRCH DIRECT       20185 46100019
         BO    SOP259H                  YES, BRANCH               20185 46200019
         TM    DCBCIND2,QSAMB           QSAM USED                       46201019
         BO    SOP259I                  YES--BRANCH                     46202019
         TM    DCBBFTEK,BFTEKR          OFFSET READ                     46210019
         BZ    SOP259I                  NO--BRANCH                      46220019
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD      S20201 46225020
*                                       READY  DMO               S20201 46230020
         BNO   SOP259I                  IF NO RCD READY          S20201 46235020
*                                       ACCOMPLISH DMO           S20201 46240020
*                                       ES OFFSET RD FUNCTION      DMOR 46245020
         LA    RB,CPLNGTH(RB)           TO NEXT IOB LOC                 46250019
         B     SOP240                   RETURN FOR NEXT IOB             46260019
SOP259I  EQU   *                                                        46270019
         LA    RB,K40(RB)               TO NEXT POSSIBLE IOB LOC  20185 46300019
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD      S20201 46310020
*                                       READY  DMO               S20201 46320020
         BO    SOP259GX                 BRANCH IF YES            S20201 46330020
*                                         DMO                    S20201 46340020
         LA    RB,B8(RB)                INCR PTR                 S20201 46350020
*                                         DMO                    S20201 46360020
SOP259GX EQU   *                                                 S20201 46370020
*                                         DMO                    S20201 46380020
         B     SOP240                   RETURN FOR NEXT IOB       20185 46400019
SOP259H  EQU   *                                                  20185 46500019
         LA    RB,D40(RB)               PT TO NEXT POSS IOB      S20201 46508020
SOP240   EQU   *                                                 S20201 46516020
         SH    RDEB,CONONE              DECR IOB COUNT           S20201 46524020
*                                         DMO                    S20201 46532020
         BP    SOPSTART                 IF MOR IOBS BRANCH       S20201 46540020
         L     RB,DCBIOBA               IF NOT LINK LAST TO      S20201 46548020
*                                       FIRST  DMO               S20201 46556020
         ST    RB,D0(RD)                PUT FIRST ADDR IN LAST   S20201 46564020
*                                         DMO                    S20201 46572020
         B     OFFSETRD                 GO AROUND INTERNAL       S20201 46580020
*                                       SUBROUT DMO              S20201 46588020
*                                                                       46596020
* SET SECTOR CCW BUILD RTN                                              46604020
*                                                                       46612020
SOP2STA  EQU   *                                                 S20201 46620020
         L     RE,DXCCW11               GET SET SECTOR ADDR      S20201 46628020
         ST    RE,D0(RB)                PUT IN CCW               S20201 46636020
         MVI   D0(RB),SETSC             PUT IN CCW CMND          S20201 46644020
         MVI   D7(RB),B1                SET BYTE CNT TO ONE      S20201 46652020
         OI    D4(RB),CC                TURN ON CMND CHAIN       S20201 46660020
         B     CMNDFIN                  GO TO FINISH DETAILS     S20201 46668020
*                                                                       46676020
* READ SECTOR CCW BUILD RTN                                             46684020
*                                                                       46692020
SOP2RTA  EQU   *                                                 S20201 46700020
         L     RE,DXCCW11               GET READ SECTOR ADDR     Y02072 46708002
         ST    RE,D40(RB)               PUT IN CCW               S20201 46716020
         MVI   D40(RB),RDSC             PUT IN RD SECT CMND      S20201 46724020
         OI    D36(RB),CC               CMND CHAIN PREVIOUS CCW  S20201 46732020
         MVI   D47(RB),B1               SET BYTE CNT TO ONE      S20201 46740020
CMNDFIN  EQU   *                                                 S20201 46748020
         LA    RB,B8(RB)                INCR PTR                 S20201 46756020
         BR    RJ                       RETURN                   S20201 46764020
*                                                                       46772020
*                                                                       46780020
*                                                                       46800019
*                                                                       46900019
*                                                                       47000019
*                                                                       47030020
*                                                                       47060020
OFFSETRD EQU   *                                                 S20201 47090020
*                                                                       47120020
* IF RCD READY CHANNEL PROGRAM USED OFFSET RD FUNCTION ALREADY          47150020
* INSTITUTED                                                            47180020
*                                                                       47210020
         TM    DCBCIND2,QSAMB           IS IT QSAM               S20201 47240020
         BO    SOP2END                  YES LEAVE THIS RTN       S20201 47270020
         SR    RE,RE                    ELSE ZERO OUT A REG      S20201 47300020
         IC    RE,DCBNCP                GET NUMBER OF IOBS       S20201 47330020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD      S20201 47360020
*                                       READY                    S20201 47390020
         BNO   SOP260                   BRANCH IF NO, SINCE CHP  S20201 47420020
*                                       AL-                      S20201 47450020
*                                       READY HAS FUNCTION              47480020
*                                       INCORPORATED IN CHANNEL PROG    47510020
* THE READ CHANNEL PROGRAMS WHICH HAVE JUST BEEN GENERATED MUST BE      47600019
* MODIFIED IF THE DCB IS BEING OPENED FOR OFFSET READ.                  47700019
*                                                                       47800019
         USING CPDEF,CPR                                                47900019
         TM    DCBBFTEK,BFTEKR          OFFSET READ                     48000019
         BZ    SOP2END                  NO--BRANCH                      48100019
         SR    RF,RF                    CLEAR FOR IC                    48400019
         IC    RF,DCBOFFSR              OFFSET TO READ CCW              48500019
         LA    RF,L1CCW(RF)             INCREMENT                       48600019
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 48610002
         STC   RF,DCBOFFSR              UPDATE OFFSET                   48700019
         MODESET  KEYADDR=DXUKEY,WORKREG=15 GET INTO USER KEY    YM1393 48710002
SOP260   EQU   *                                                        49000019
         LA    CPR,IOBLNGTH(RB)         ADDR OF CHANNEL PROG            49100019
         TM    JFCBMASK+D6,NORCDRY      IS IT RPS                S20201 49120020
         BNO   SOP2ENDX                 YES INITIALIZE COUNT     S20201 49140020
*                                       FIELD                    S20201 49160020
*                                                                       49200019
*    THE TOTAL EFFECT OF THE NEXT THREE INSTRUCTIONS IS TO PUSH         49300019
*    THE EXISTING CCW'S DOWN TO MAKE ROOM FOR AN EXTRA CCW AT THE       49400019
*    BEGINNING OF THE CHANNEL PROGRAM.                                  49500019
         MVC   CPRDKD(L3CCW),CPTIC1                                     49600019
         MVC   CPTIC2(L2CCW),CPNOP1                                     49610019
         MVC   CPSCH(L5CCW),CPTIC2                                      49800019
*                                                                       49900019
         MVI   NOP1CC,CCWNOP            NOP COMMAND                     50000019
         OI    NOP1FLAG,CC              CHAIN CCW                       50100019
         L     RF,CPTIC1                FIRST TIC                       50200019
         LA    RF,L1CCW(RF)             UPDATE DATA ADDR                50300019
         ST    RF,CPTIC1                                                50400019
         MVI   CPTIC1,TIC               TIC COMMAND                     50500019
         L     RF,CPTIC2                SECOND TIC                      50600019
         LA    RF,L1CCW(RF)             UPDATE DATA ADDR                50700019
         ST    RF,CPTIC2                                                50800019
         MVI   CPTIC2,TIC               TIC COMMAND                     50900019
         MVI   NOP2CC,CCWNOP            NOP COMMAND                     51000019
         L     RF,NULL(RB)              NEXT IOB ADDR                   51010019
         LA    RF,K104(RF)              AREA TO READ COUNT INTO         51100019
         ST    RF,RCTDATAD              STORE IN READ COUNT CCW         51200019
         NI    RCTFLAGS,SLIBIT          TURN OFF SLI BIT                51300019
         MVI   RCTBYTCT+ONE,L'CPCOUNT   READ ENTIRE COUNT FIELD         51400019
         MVI   RCTCC,RDC                RESTORE COMMAND CODE            51500019
SOP2ENDX EQU   *                                                 S20201 51550020
         TM    DCBRECFM,DCBRECF+DCBRECSB  FIXED STANDARD         XA2057 51560002
         BO    SOP2ENDY                 YES, BYPASS MOVING ID    XA2057 51570002
*                                         AS CCHHR FIELD DOES    XA2057 51580002
*                                         NOT EXIST              XA2057 51590002
         MVC   CPCOUNT(K5),K43(RB)      FIRST BLOCK ID                  51600019
SOP2ENDY EQU   *                                                 XA2057 51650002
         L     RB,NULL(RB)              NEXT IOB                        51700019
         BCT   RE,SOP260                NEXT CHANNEL PROG               51800019
SOP2END  EQU   *                                                        51900019
         L     RB,DCBIOBA               GET FIRST IOB            Y02072 51950002
         OI    NULL(RB),FIRSTIOB        SET INDIC ON FOR CLOSE   Y02072 52000002
         LR    RC,RB                    SAVE ADDR FOR QSAM USE   Y02072 52050002
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 52150002
         SPACE                                                          52200002
         OI    FCAOPEN2,FCAOIOBC        IOBS COMPLETED           YM7595 52250002
         TM    DCBDSORG,POBIT          DCB FOR PO                       52300019
         BZ    SOP2ENDA                NO, BRANCH                       52400019
*                                                                       52500019
         MVI   DCBCNTRZ,QSAMZ                                      DM0I 52600019
*                                                                       52700019
SOP2ENDA EQU   *                                                        52800019
*                                                                       52900019
         TM    DCBRECFM,FORMATV         VARIABLE FORMAT            DM0I 53300019
         BZ    SOP2STOP                 BRANCH NOT V FORMAT        DM0I 53400019
         TM    DCBRECFM,FORMATF         FIXED FORMAT               DM0I 53500019
         BO    SOP2STOP                 YES, BRANCH                DM0I 53600019
         USING WTGENTRY,RWTGC                                    Y02072 53610002
         MVC   WTGIDTTR,SOPSLDVT        VARIABLE, GET 1915     @Z30TSCF 53650003
         B     RELOOP                   BACK TO MAIN LINE          DM0I 53800019
SOP2STOP EQU   *                                                        53900019
         MVC   WTGIDTTR,SOPSLDFT        FIXED, GET 1910        @Z30TSCF 53950003
RELOOP   LA    RWTGC,WGOFF(RE,RWTGC)    INCREMENT CURR WTG ENTRY        54200019
         LA    RPARC,PLOFF(NULL,RPARC)  INCR CURRENT DCB ENTRY PRTR     54210019
         CLC   NULL(L'AMIDCNST,RWTGC),AMIDCNST  THIS RT NEEDED AGAIN    54400019
         BCR   RWTGC,RBASE              BACK TO OPEN CONTROL ROUTINDM0I 54500019
*                                                                       54600019
         CLC   NULL(L'OPIDCNST,RWTGC),OPIDCNST  END OF TABLE            54700019
         BNE   RELOOP                   NO,CHECK NEXT ENTRY             54800019
*                                                                       54900019
         LR    RPARC,RPAR                                               55000019
         LA    RWTGC,WAOFF(NULL,RWTG)   REINITIALIZE WTG LIST PTR       55100019
ZCHEK    CLI   NULL(RWTGC),NULL         IS THIS ENTRY COMPLETE          55200019
         BNE   TCTLRTN                  IF NOT TRANSFER CONTROL         55300019
*                                                                       55400019
         LA    RWTGC,WGOFF(NULL,RWTGC)  GET NEXT ENTRY                  55500019
         LA    RPARC,PLOFF(NULL,RPARC)                                  55600019
         B     ZCHEK                    TO ZERO CHECK              DM0I 55700019
*                                                                       55800019
TCTLRTN  EQU   *                                                        55900019
         USING WTG,RWTG                                                 55950003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*56000003
               MODID=WTGENTRY                                  @Z30TSCF 56050003
         DROP  RWTGC,RWTG                                      @Z30TSCF 56100003
         EJECT                                                          56850002
*                                                                       58500019
**********************************************************************  58600019
*                                                                    *  58700019
BUFERR   EQU   *                                                  M1552 58800019
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 58810002
         DMABCOND OABD064,PDLOAD,RETURN=NONE,RES=NO,REGSAVE=YES  S21042X58900021
                                        CALL PROBLEM DETERMINATION      59000021
         B     TCTLRTN                                           S21042 59100021
WAOFF    EQU   32                                                       59200019
PLOFF    EQU   4                        OFFSET OF DCB ENTRIES           59300019
WGOFF    EQU   8                        OFFSET OF WTG ENTRIES           59400019
OPIDCNST DC    C'0S'                    ID                         DM0I 59500019
AMIDCNST DC    C'1O'                    ID                         DM0I 59600019
*                                                                       59700019
*********************************************************************** 59800019
*      CONSTANTS AND RESERVED STORAGE.                                  59900019
*                                                                       60000019
*                                                                       60100019
SXTEN    DC    H'16'                    SIXTEEN                    DM0I 60200019
CONONE   DC    H'1'                     CONSTANT OF ONE          S20201 60300020
SOPSLDFT DC    C'10',VL3(IGG01910)      FIXED LEN RECORDS      @Z30TSCF 60350003
SOPSLDVT DC    C'15',VL3(IGG01915)      VARIABLE LEN RECORDS   @Z30TSCF 60400003
PDLOAD   DC    C'6M',VL3(IGG0196M)      PROB DETERMINATION     @Z30TSCF 60450003
         SPACE 3                                                        60550002
PATCH    DC    25H'0'                   PATCH AREA               Y02072 60600002
END      EQU   *                        END OF MODULE            Y02072 60650002
         EJECT                                                          60660003
CVT      DSECT                                                 @Z30TSCF 60670003
         CVT                                                   @Z30TSCF 60680003
         EJECT                                                          60700002
CPDEF    DSECT                          OFFSET READ CHANNEL PROG        62200019
CPNOP1   DS    0D                       NOP OR SET SECTOR               62300019
NOP1CC   DS    0X                       COMMAND CODE                    62400019
NOP1DATA DS    A                        DATA ADDR                       62500019
NOP1FLAG DS    BL1                      FLAGS                           62600019
         DS    1X                       NOT USED                        62700019
NOP1BYTC DS    2X                       BYTE COUNT                      62800019
CPSCH    DS    D                        SEARCH ID EQUAL                 62900019
CPTIC1   DS    D                        TIC TO SEARCH                   63000019
CPTIC2   DS    D                        TIC TO READ COUNT               63100019
CPRDCNT  DS    0D                       READ COUNT                      63200019
RCTCC    DS    0X                       COMMAND CODE                    63300019
RCTDATAD DS    A                        DATA ADDR                       63400019
RCTFLAGS DS    BL1                      FLAGS                           63500019
         DS    1X                       NOT USED                        63600019
RCTBYTCT DS    2X                       BYTE COUNT                      63700019
CPRDKD   DS    0D                       READ (KEY) DATA                 63800019
RKDCC    DS    0X                       COMMAND CODE                    63900019
RKDDATAD DS    A                        DATA ADDR                       64000019
RKDFLAGS DS    BL1                      FLAGS                           64100019
         DS    1X                       NOT USED                        64200019
RKDBYTCT DS    2X                       BYTE COUNT                      64300019
CPNOP2   DS    0D                       NOP OR READ SECTOR              64400019
NOP2CC   DS    0X                       COMMAND CODE                    64500019
NOP2DATA DS    A                        DATA ADDR                       64600019
NOP2FLAG DS    BL1                      FLAGS                           64700019
         DS    1X                       NOT USED                        64800019
NOP2BYTC DS    2X                       BYTE COUNT                      64900019
CPCOUNT  DS    D                        FIELD TO READ COUNT INTO        65000019
         IECDSECS DCB,(MAIN,(IOB,NO)),IOB,WTG,PREFX,EXPAND=YES @Z30TSCF 65100003
         ORG   WTGIDTTR                                          Y02072 65150002
WTGID    DS    CL2                      2 BYTE ID OF MODULE      Y02072 65160002
DCBCNTRZ EQU   DCBCNTRL+1                                          DM0I 65200019
DCBCNTRX EQU   DCBCNTRL+3                                          DM0I 65300019
         EJECT                                                          65310002
FORCORE  DSECT                                                          65312002
         IHAFCAUD ORG=YES                                               65320002
         EJECT                                                          65350002
         IHACCW  DSECT=YES                                       Y02072 65360002
         EJECT                                                          65400002
         IGGBCB  TYPE=SAM                                               65450002
           END                                                          69100019
