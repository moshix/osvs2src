         TITLE 'IGG0191T - UCS LOAD,FCB PATH DETERMINER'         M0191  00100021
IGG0191T CSECT                                                          00102021
*                                                                       00180001
*MODULE NAME - IGG0191T                                          Y02072 00230002
*                                                                       00280002
*DESCRIPTIVE NAME - UCSB/FCB PATH DETERMINER                     Y02072 00330002
*                                                                       00380002
*COPYRIGHT - NONE                                                Y02072 00430002
*                                                                       00480002
*CHANGE ACTIVITY - AS FOLLOWS                                    Y02072 00490002
*          RELEASE 19 DELETIONS                                         00500000
*                                                                M4179  00550019
*          RELEASE 20 DELETIONS                                         00600000
*1355183000,186000,188000,344600-346200                          A33665 00650020
*1355020000-023000,027000-028000,041000,045000-048000,052000,    S20202 00660020
*1355242000,302000-306000,322000,328000,350000-358000,415000-    S20202 00670020
*1355418000,431000,455000-531000,536000,552000,708000,714000-    S20202 00680020
*1355717000                                                      S20202 00690020
*1355255000                                                      M5143  00695020
*          RELEASE 21 DELETIONS                                         00700000
*0791276005-276015,287600,566360                                 M0151  00701021
*0791046400,141001-141002,566480-56662                           M1830  00702021
*0791552080-552110,552140-552200,552260-552290,552320-552350,    M0009  00710021
*0791552380-552410                                               M0009  00720021
*0791                                                            S21092 00750021
*0791                                                             M0191 00760021
*0791001200,001400,001500,004000,004500,004600,004700,004800,    A50376 00768021
*0791008000,009000,010000,011000,012000,113200,622050,708000,    A50376 00776021
*0791709000,710000,711000,712000,713000,713800,714600,715400,    A50376 00784021
*0791716200,717000,718000,719000,720000                          A50376 00792021
*                                                                       01100021
*        VS2    RELEASE 01 DELETIONS                                    01112001
*552440,552470                                                   YM3213 01122001
*                                                                       01124002
*        VS2 RELEASE 02 DELETIONS                                       01126002
*001010,011100,011320,012000,058000,113200-113600,158000,169500, Y02072 01128002
*170500-171000,219300-219500,276415-276430,341000-343800,        Y02072 01130002
*356000-361000,579000,606070-606980,622050-622600,693000-697600, Y02072 01130402
*699500,707600,733000-734000,746000,747000,748000-785100,785200  Y02072 01130802
*063000,641000,673000,677000,580000,692000                       Y02072 01131202
*                                                                YM4697 01131602
*D238000-241000                                                  YM6054 01131702
*                                                                YM7889 01131802
*                                                                       01131903
*        VS2 RELEASE 3 DELETIONS                                        01154603
*                                                              @Z30TSCF 01164603
*                                                                       01177303
*STATUS CHANGE LEVEL 009                                                01200002
*                                                                       01300000
*FUNCTION/OPERATION - EXECUTE BLOCK DATA CHECK OR RESET BLOCK DATA      01400000
*                     CHECK                                             01500000
*                                                                       01550002
*                   - LOAD MSG CSECT FOR WTO'S/WTOR'S            Y02072 01600002
*                                                                       01650002
*                   - FOR PRINTERS WITH UCS:                     Y02072 01700002
*                     1) ISSUE IEC123D TO REQUEST OPERATOR TO    Y02072 01750002
*                        TO SPECIFY A UCS IMAGE TO BE USED IF    Y02072 01800002
*                        UCS IS NOT SPECIFIED IN THE DD CARD AND Y02072 01850002
*                        CURRENT IMAGE IS NOT A DEFAULT OR NO    Y02072 01900002
*                        IMAGE IS CURRENTLY LOADED.              Y02072 01910002
*                     2) SET SWITCHES TO INDICATE TO SUBSEQUENT  Y02072 02100002
*                        OPEN EXECUTORS WHAT WORK IS TO BE DONE  Y02072 02150002
*                   - FOR PRINTERS WITH FCB'S BUT NOT UCSB'S:    Y02072 02200002
*                     1) ISSUE IEC129D TO REQUEST OPERATOR TO    Y02072 02250002
*                        SPECIFY AN FCB IMAGE TO BE USED IF A    Y02072 02252002
*                        FCB IMAGE IS NOT SPECIFIED IN THE DD    Y02072 02254002
*                        CARD OR THE CURRENT IMAGE IS NOT A      Y02072 02256002
*                        DEFAULT.                                Y02072 02258002
*                   - FOR PRINTERS WITH FCB'S AND UCSB'S:        Y02072 02258402
*                     1) SET SWITCHES TO INDICATE TO SUBSEQUENT  Y02072 02258802
*                        OPEN EXECUTORS WHAT WORK IS TO BE DONE  Y02072 02259202
*                                                                       02260020
*                   _ ISSUES SVC 105 TO BUILD A DCB AND DEB FOR         02290002
*                     SYS1.IMGLIB AND SETS AN AUDIT TRAIL BIT    YM4697 02320002
*                     INDICATING TO FORCE CLOSE THAT             YM4697 02400002
*                     SYS1.IMAGELIB HAS BEEN OPENED              YM4697 02450002
*                                                                       02470002
*ENTRY POINT - ENTERED FROM THE FOLLOWING EXECUTORS BY USE OF THE XCTL  02500000
*              MACRO                                                    02600000
*              *FROM IGG0196A IF DCB IS EXCP THAT'S BEING OPENED TO     02660020
*               A 1403 WITH UCS OR A 3211 PRINTER                       02720020
*              *FROM IGG0196B IF DCB IS BEING OPENED TO A 1403 WITH     02780020
*               UCS OR 3211 PRINTER                                     02840020
*              *FROM 6A OR 6B IF A 2245 PRINTER.                        02870021
*                                                                       02900000
*INPUT - DCB ADDRESS                                                    03000000
*      - OPEN WORK AREA ADDRESS                                         03100000
*      - WHERE-TO-GO TABLE                                              03200000
*      - PARAMETER LIST                                                 03300000
*      - CURRENT ENTRY IN W-T-G TABLE                                   03400000
*      - CURRENT PARAMETER(DCB)                                         03500000
*                                                                       03600000
*OUTPUT - IF NO UCS IMAGE IS SPECIFIED AND THE UCS IMAGE LOADED BY      03700000
*         PREVIOUS JOB STEP WAS NOT A DEFAULT IMAGE,THE MESSAGE         03800000
*         'IEC123D XXX SPECIFY UCS PARAMETER' IS DISPLAYED.             03900000
*       - IF A UCS IMAGE IS NOT TO BE LOADED, THE MESSAGE        Y02072 03930002
*         'IEC129D XXX,SPECIFY FCB PARAMETERS' IS DISPLAYED      Y02072 03940002
*                                                                       04000000
*EXTERNAL ROUTINES _ A SVC 105 IS ISSUED TO CONSTRUCT A DCB AND A DEB   04050020
*                    FOR SYS1.IMAGELIB SO A UCS AND/OR A FCB IMAGE      04100002
*                    CAN TO BE LOADED INTO CORE                         04150002
*                                                                       04152002
*EXTERNAL REFERENCES - MESSAGE CSECT FOR WTO/WTOR'S              Y02072 04154002
*                                                                       04200000
*EXIT - NORMAL - FOR PRINTERS WITH UCSB'S, XCTL TO IGG0191U      Y02072 04250002
*              - FOR PRINTERS WITHOUT UCSB'S, XCTL TO IGG0197E   Y02072 04260002
*              - FOR COMPOSIT CONSOLES, XCTL TO IGG0191V TO      Y02072 04310002
*                DETERMINE 2ND STAGE EXECUTOR.                   Y02072 04360002
*                                                                       05100000
*EXIT - ERROR - IF AN ERROR OCCURED WHILE DCB AND DEB FOR SYS1.IMGLIB   05150002
*               WERE BEING CONSTRUCTED AN ABEND RETURN CODE IS SET      05200020
*               AND AN EXIT IS MADE TO IGG0191V TO ABEND                05250020
*             - IF EXCP IS UNSUCCESSFUL WHEN TRYING TO SET LATCH Y02072 05260002
*               FOR BLK/UNBLK OF DATA CHECKS AN EXIT TO IGG0191V Y02072 05270002
*               IS MADE TO GET A WTP.                            Y02072 05272002
*                                                                       05280002
*MACROS-ACTION:MODESET, EXCP, WAIT, XCTL                         Y02072 05290002
*                                                                       05292002
*MACROS-MAPPING:IKJTCB, IEZDEB, IHAPSA, IEFUCBOB, IGGMSG,        Y02072 05294002
*              IECDSECS(MAIN,WTG), DCBD, IGGSCW, IHAFCAUD,       Y02072 05296002
*              IEECUCM                                           YM6054 05300002
*                                                                       05350002
*TABLES/WORK AREAS - WHERE-TO-GO TABLE (SEE LISTING OF EXECUTOR         05400000
*                                       IGG0191B)                       05500000
*                  - OPEN WORK AREA (SEE IECDSECT IN THIS LISTING)      05600000
*                                                                       05700000
*ATTRIBUTES - REENTRANT, REUSABLE, RUNS IN DATA MANAGEMENT KEY   Y02072 05800002
*             UNLESS OTHERWISE SPECIFIED, SUPER STATE            Y02072 05850002
*                                                                       05900000
*NOTES - EXCP/WAIT SVCS IS USED TO EXECUTE DATA CHECK COMMAND           06000000
*        DATA CHECK.                                                    06100000
*      - WTO/WTOR SVC IS USED TO REQUEST AN OPERATOR REPLY              06200000
*      - IOB/ECB IN OPEN WORK AREA IS USED FOR EXCP                     06400000
*      - IF THE PRINTER IS FOR A COMPOSITE CONSOLE,THE UCS SUPPORT IS   06500000
*        NOPED.                                                         06600000
*      - BEFORE ISSUING A WTO/WTOR, THE MESSAGE TEXT MUST FIRST  Y02072 06650002
*        BE EXTRACTED FROM A MESSAGE CSECT.                      Y02072 06660002
*                                                                       06700000
*********************************************************************** 06800000
*                                                                       06900000
         EJECT                                                          07000000
*                                                                       07100000
**********************************************************************  07200000
*                                                                       07300000
*   REGISTER CONVENTIONS USED THROUGH OUT OPEN EXECUTORS                07400000
*                                                                       07500000
**********************************************************************  07600000
*                                                                       07700000
RE       EQU   0                        WORK/PARAMETER REGISTER         07800000
R0       EQU   RE                       INPUT TO GETMAIN, FREEMN Y02072 07810002
RWK1     EQU   RE                       WORK REGISTER            Y02072 07850002
RF       EQU   1                        WORK/PARAMETER REGISTER         07900000
R1       EQU   RF                       INPUT TO EXCP, WAIT      Y02072 07910002
RWK2     EQU   RF                       WORK REGISTER            Y02072 07950002
RDCB     EQU   2                        ADDR OF USERS DCB               08000000
RBASE    EQU   3                        BASE REGISTER                   08100000
RCORE    EQU   4                        ADDR OF OPEN WORK AREA          08200000
RPAR     EQU   5                        PARAMETER LIST                  08300000
RWTG     EQU   6                        START OF WTG                    08400000
RPARC    EQU   7                        CURRENT ENTRY IN PARAMETER LIST 08500000
RWTGC    EQU   8                        CURRENT ENTRY IN WTG TABLE      08600000
RTCB     EQU   9                        TCB ADDR/WORK REGISTER   Y02072 08700002
RWK3     EQU   RTCB                     WORK REGISTER            Y02072 08750002
RUCB     EQU   10                       UCB ADDR                        08800000
RDEB     EQU   11                       DEB ADDR                        08900000
RWK7     EQU   RDEB                     WORK REGISTER            Y02072 08950002
RB       EQU   12                       WORK AREA BASE REGISTER         09000000
RWK5     EQU   RB                       WORK REGISTER            Y02072 09050002
RC       EQU   13                       WORK REGISTER                   09100000
RWK6     EQU   RC                       WORK REGISTER            Y02072 09150002
RD       EQU   14                       WORK/PARAMETER REGISTER         09200000
RWK8     EQU   RD                       WORK REGISTER            Y02072 09250002
RJ       EQU   15                       WORK/PARAMETER REGISTER         09300000
RWK4     EQU   RJ                       WORK REGISTER            Y02072 09350002
R15      EQU   RJ                       RETURN CODE REGISTER     Y02072 09360002
*                                                                       09400000
*********************************************************************** 09500000
*                                                                       10500000
*   EQUATE WTG OFFSET                                                   10600000
*                                                                       10700000
WGOFF    EQU   8                        OFFSET OF CURRENT WTG ENTRIES   10800000
PLOFF    EQU   4                        OFFSET OF CURRENT DCB ENTRIES   10900000
WAOFF    EQU   32                       OFFSET OF 1ST ENTRY IN WTG TBL  11000000
*                                                                       11100000
*   MASKS                                                               11200000
*                                                                       11300000
TWENTY   EQU   X'14'                    X'14'                           11400000
UNRLMASK EQU   X'02'                    IOB IS UNRELATED                11500000
SILIMASK EQU   X'20'                    SILI BIT IS ON                  11600000
ONE      EQU   X'01'                    X'01'                           11700000
BLOCKCCW EQU   X'73'                    COMMAND CODE = BLOCK DATA CHECK 11800000
UNBLKCCW EQU   X'7B'                    COMMAND CODE = UNBLK DATA CHECK 11900000
BLOCKMSK EQU   X'40'                    DCB OPTCD=U (X'40')             12000000
IEC120RQ EQU   X'40'                    IF ON, MSG IEC120 IS REQ Y02072 12092002
IEC123RQ EQU   X'80'                    IF ON, MSG IEC123 IS REQ Y02072 12096002
NULL     EQU   X'00'                    X'00'                           12100000
THREE    EQU   X'03'                    X'03'                           12200000
BLANK    EQU   X'40'                    X'40'                           12300000
ABENDBIT EQU   X'80'                    ABEND TERMINATION IN PROCESS    14100000
PRTM3211 EQU   X'09'                    MASK FOR 3211 PRINTER    S20202 14100320
SHIFTRHT EQU   X'02'                    FLAG USED TO SET FCB     S20202 14100520
*                                       OPTIONS                  S20202 14100620
SHIFTLFT EQU   X'06'                    FLAG USED TO SET FCB     S20202 14100720
*                                       OPTIONS                  S20202 14100820
IEC129RQ EQU   X'80'                    MESSAGE IEC129 REQ'D     S20202 14101102
IMCLOSED EQU   X'FF'                    FLAG SET FOR IMAGELIB    S20202 14102720
*                                       NOT OPENED               S20202 14102802
STAGE2   EQU   X'FF'                    TO INDIC TO 191V ENTRY   Y02072 14102902
*                                         TO FIND 2ND STG EXEC   Y02072 14103002
BUFPAR   EQU   X'01'                    UCSB BUFFER PARITY ERROR Y02072 14103102
DEFALT   EQU   X'80'                    IF ON IN IMAGE, IMAGE    Y02072 14103202
*                                         IS A DEFAULT           Y02072 14103302
ABEND    EQU   X'FF'                    INDICATES TO SUBSEQUENT  Y02072 14103402
*                                         LOADS ENTRY FOR ABEND  Y02072 14103502
*                                                                       14103602
*   EQUATES FOR CONSTANTS                                               14103702
*                                                                       14103802
K1       EQU   1                        CONSTANT EQUATED TO 1    S20202 14103902
K7       EQU   7                        CONSTANT EQUATED TO 7    S20202 14104002
K15      EQU   15                       CONSTANT EQUATED TO 15   S20202 14104420
PRT2245  EQU   X'0B'                    MASK FOR 2245 PRINTER    S21092 14107521
*                                                                  DM0Q 14110018
*    EQUATES FOR CONSTANTS                                         DM0Q 14120018
*                                                                  DM0Q 14130018
K4       EQU   4                                                   DM0Q 14140018
OABD095  EQU   95                       INTERNAL CODE 95         M0009  14170021
EXCPFAIL EQU   100                      INTERNAL CODE FOR EXCP   Y02072 14180002
*                                         FAILED                 Y02072 14190002
*                                                                       14190202
*  THE FOLLOWING MESSAGE NUMBERS ARE EQUAL TO THEIR POSITION     Y02072 14190402
*  IN THE MESSAGE CSECT (RELATIVE TO ZERO), MULT BY 2 (LENGTH    Y02072 14190802
*  OF AN INDEX)                                                  Y02072 14191202
*                                                                       14191602
MSG123   EQU   2*2                      MESSAGE NO IN MSG CSECT  Y02072 14192002
MSG129   EQU   3*2                      MESSAGE NO IN MSG CSECT  Y02072 14194002
*                                                                       14200000
*********************************************************************** 14300000
*                                                                       14400000
*                                                                       14500000
*********************************************************************** 14600000
*                                                                       14700000
*                                                                       14800000
*   INITIALIZE REGISTERS                                                14900000
*                                                                       15000000
*                                                                       15100000
*********************************************************************** 15200000
*                                                                       15300000
         BALR  RBASE,0                                                  15400000
         USING UCSTART,RBASE                                            15500000
         USING IHADCB,RDCB                                              15600000
         USING FORCORE,RCORE                                            15700000
         USING DEBBASIC,RDEB                                     Y02072 15800002
         USING UCBOB,RUCB                                               15900000
*                                                                       16100000
*********************************************************************** 16200000
*                                                                       16300000
UCSTART  EQU   *                                                        16400000
*                                                                       16500000
*********************************************************************** 16600000
*                                                                       16700000
         B     AROUND                   BR AROUND CONSTANTS      Y02072 16750002
         DC    C'IGG0191T'              MODULE NAME              Y02072 16760002
         DC    C'@Z30TSCF'              LAST SHIP CODE         @Z30TSCF 16770003
         DC    C'10/10/74'              LAST DATE MODIFIED     @Z30TSCF 16780003
AROUND   DS    0H                                                Y02072 16790002
*                                                                       16792002
         L     RDCB,0(RPARC)            GET DCB ADDR                    16800000
         L     RCORE,4(RWTGC)           GET WORK AREA                   16900000
         L     RDEB,DCBDEBAD            GET DEB ADDR                    17000000
         L     RUCB,DEBSUCBA            GET UCB ADDR             Y02072 17100002
         DROP  RDEB                                              Y02072 17150002
*                                                                       17200000
*                                                                       17210020
*   SET FLAG TO INDICATE THAT DCB AND DEB FOR SYS1.IMAGELIB HAVE NOT    17220020
*   BEEN CONSTRUCTED                                                    17230020
*                                                                       17240020
         XC    DXFCBUCS,DXFCBUCS        CLEAR PARM LISTS         Y02072 17240402
         MVI   DXIMGDCB,IMCLOSED        MOVE IN FLAG FOR         Y02072 17242002
*                                       IMAGELIB CLOS            S20202 17260020
         MVC   DXEROPT,DXCCW6           SAVE DCB EROPT FIELD     Y02072 17262002
*                                                                       17270020
*********************************************************************** 17300000
*                                                                       17400000
WTORTN   EQU   *                                                        17500000
*                                                                       17600000
*********************************************************************** 17700000
*                                                                       17800000
*   INTIALIZE WTO/WTOR AREA IN OPEN WORK AREA                           17900000
*                                                                       18000000
*********************************************************************** 18100000
*                                                                       18200000
         LA    RD,RPLY                  LOAD REPLY ADDRESS       A33665 18300020
         ST    RD,REPLYLTH              STORE REPLY ADDR                18400000
         MVI   REPLYLTH,TWENTY          MOVE REPLY LENGTH=20            18500000
         LA    RD,RPLYECB               LOAD ADDR OF ECB FOR     A33665 18560020
*                                       WTOR                     A33665 18620020
         ST    RD,REPLYECB              STORE REPLY ECB ADDR            18700000
         MVC   LOMASK(8),LOWER          MOVE X'40'S TO WORK AREA A33665 18800020
*                                                                       18810021
*********************************************************************** 18820021
*                                                                       18830021
*    IS DEVICE A 2245 PRINTER                                           18840021
*                                                                       18850021
*********************************************************************** 18860021
*                                                                       18870021
         CLI   UCBTBYT4,PRT2245        IS DEVICE A 2245 PRINTER  S21092 18880021
         BE    SYSABEND                YES, CHECK FOR ABEND      S21092 18890021
*                                                                       18900000
*********************************************************************** 19000000
*                                                                       19100000
BLKDATA  EQU   *                                                        19200000
*                                                                       19300000
**********************************************************************  19400000
*                                                                       19500000
*   EXCP BLOCK/RESET BLOCK DATA CHECK ACCORDING TO DCB SPECIFICATION    19600000
*                                                                       19700000
*********************************************************************** 19800000
*                                                                       19900000
         MVI   IOBFLAG1,UNRLMASK        SET UNRELATED BIT ON            20000000
         XC    DXCCW1(8),DXCCW1         RESET CCW AREA                  20100000
         MVI   DXCCW1+4,SILIMASK        SET SILI FLAG ON                20200000
         MVI   DXCCW1+7,ONE             SET LENGTH=1                    20300000
         MVI   DXCCW1,BLOCKCCW          COMMAND CODE = BLOCK DATA CHECK 20400000
*                                                                 20961 20410018
*   TEST IF OPTCD IN DCB SPECIFIES UCS FEATURE                    20961 20420018
*                                                                 20961 20430018
         TM    DCBMACRF,X'80'           TEST IF DCB MACRF=E       20961 20440018
         BO    EXCPGOGO                 IF YES,GOTO EXCP RTN      20961 20450018
*                                                                 20961 20460018
*                                                                       20500000
*   TEST IF OPTCD IN DCB SPECIFIES RESET BLOCK DATA CHECK               20600000
*                                                                       20700000
         TM    DCBOPTCD,BLOCKMSK        TEST IF DCB OPTCD=U             20800000
         BC    14,EXCPGOGO              IF NOT,GOTO EXCP RTN            20900000
*                                                                       21000000
         MVI   DXCCW1,UNBLKCCW          IF YES,SET CCW= UNBLK DATA CHK  21100000
*                                                                       21200000
EXCPGOGO EQU   *                                                        21300000
*                                                                       21400000
         LA    RF,DXIOB                 LOAD IOB ADDR                   21500000
         EXCP  (1)                       EXCP ON DATA CHECK             21600000
*                                                                       21700000
         WAIT  ECB=DXECB                WAIT ON EXCP                    21900002
         TM    DXECB,X'20'              TEST FOR SUCCESSFUL I/O   8M226 21910018
         BO    CONSOLE                  BRANCH IF O.K.            8M226 21920018
         LA    RWK4,EXCPFAIL            INTERNAL CODE FOR PROB   Y02072 21970002
*                                         DETERMINATION          Y02072 21980002
         B     PDEXIT                   GO TO SET UP WTP         Y02072 21990002
*                                                                       22000000
*********************************************************************** 22100000
*                                                                       22200000
CONSOLE  EQU   *                                                        22300000
*                                                                       22400000
*********************************************************************** 22500000
*                                                                       22600000
*   THIS ROUTINE CHECKS IF THE OPEN IS FOR A COMPOSITE CONSOLE.IF YES,  22700002
*   XCTL TO A 2ND STAGE EXECUTOR BECAUSE ANY WTO/WTOR WILL PUT   YM6054 22800002
*   THE COMMUNICATIONS TASK INTO A WAIT STATE.                   YM6054 22850002
*                                                                       22900000
*********************************************************************** 23000000
*                                                                       23100000
         USING PSA,0                                             Y02072 23150002
         L     RTCB,PSATOLD             GET CURRENT TCB ADDR     Y02072 23200002
         USING TCB,RTCB                                          Y02072 23600002
         L     RWK6,CVTPTR              ADDR OF CVT              YM6054 23650002
         USING CVT,RWK6                                          YM6054 23700002
         L     RWK6,CVTCUCB             ADDR OF UCM              YM6054 23750002
         DROP  RWK6                                              YM6054 23800002
         USING UCM,RWK6                                          YM6054 23850002
         L     RWK6,UCMPXA              COMM TASKS TCB ADDR      YM6054 23900002
         CR    RWK6,RTCB                IS THIS COMM TASK        YM6054 23950002
         DROP  RWK6                                              YM6054 24000002
         BNE   SYSABEND                 NO, GO TEST FOR ABEND IN Y02072 24150002
*                                         CONTROL                Y02072 24200002
         MVI   DXSTAGE2,STAGE2          ENTRY TO XCTL TO 2ND STG Y02072 24250002
         B     XCTL191V                 GO XCTL                  Y02072 24260002
*                                                                       24300000
*********************************************************************** 24400000
*                                                                       24500000
SYSABEND EQU   *                                                        24600000
*                                                                       24700000
*********************************************************************** 24800000
*                                                                       24900000
*   THIS ROUTINE CHECKS IF ABEND HAS CONTROL.IF YES,SET A SWITCH TO     25000002
*   AVOID ISSUING ANOTHER ABEND.                                        25100000
*                                                                       25200000
*********************************************************************** 25300000
*                                                                       25400000
         TM    TCBFLGS1,TCBFA           TEST IF ABEND IS IN PROCESS     25700001
         BNO   LDMSGCST                 IF NO, GO LOAD MSG CSECT Y02072 25750002
         MVI   DXNABEND,ABENDBIT        INDIC DO NOT ABEND AGAIN Y02072 25950002
*                                                                       26100000
*********************************************************************** 26200000
*                                                                       26300000
LDMSGCST EQU   *                                                 Y02072 26400002
*                                                                       26500000
*********************************************************************** 26600000
*                                                                       26700000
*   UCS PARM FIELD  (DXUCSP) - BYTE 0   - DXUCSSW1               Y02072 26750002
*                                           B0 - IEC123 REQUIRED Y02072 26760002
*                                           B1 - IEC120 REQUIRED Y02072 26770002
*                              BYTE 1   - EROPT                  Y02072 26800002
*                              BYTE 2   - DXNABEND               Y02072 26850002
*                              BYTE 3   - DXUCSOPT               Y02072 26900002
*                                           B0 - NOT USED        Y02072 26910002
*                                           B1 - FOLD REQUESTED  Y02072 26920002
*                                           B3 - NOT USED        Y02072 26930002
*                                           B4 - VERIFY REQ      Y02072 26940002
*                              BYTE 4-7 - UCS ID                        26950002
*                                                                       27100000
*********************************************************************** 27200000
*                                                                       27412002
* LOAD THE MESSAGE CSECT FOR WTO'S/WTOR'S                        Y02072 27414002
* PASS LOAD THE ADDRESS OF LINK LIB'S DCB. THIS WILL CAUSE LPA   Y02072 27414402
* TO BE SEARCHED.                                                Y02072 27414802
*                                                                       27416002
         L     RWK2,CVTPTR              GET CVT ADDRESS          Y02072 27416402
         USING CVT,RWK2                                          Y02072 27416802
         L     R1,CVTLINK               DCB ADDR FOR LINK LIB    Y02072 27417202
         DROP  RWK2                                              Y02072 27417602
         LOAD  EPLOC=MSGCSECT,DCB=(1)   MACRO TO GET MSG CSECT   Y02072 27418002
         ST    RWK1,DXMSGADR            SAVE CSECT ADDRESS       Y02072 27418402
         L     RWK4,UCBXTADR            GET UCB EXT ADDRESS      Y02072 27420002
         USING UCBUCS,RWK4                                       Y02072 27422002
         CLI   UCBTBYT4,PRT2245        CHECK FOR 2245 PRINTER    S21092 27430021
         BE    WKARINFO                YES, SKIP UCS CODE        S21092 27460021
         MVC   DXUCSID,JFCUCSID         MOVE UCS ID IN JFCB      Y02072 27470002
         MVC   DXUCSOPT,JFCUCSOP        MOVE UCS OPTION BITS     Y02072 27480002
         CLI   UCBTBYT4,PRTM3211        CK IF DCB BEING OPENED   S20202 27602020
*                                       FOR 3211                 S20202 27602502
         BNE   TESTUCS                  NO GO CK UCS PARAMETER   Y02072 27603002
*                                       FOR 1403                 S20202 27603502
*                                                                       27604020
*********************************************************************** 27604520
*                                                                       27605020
*   FCB PARM FIELD  (DXFCBP) - BYTE 0   - DXFCBSW1               Y02072 27605502
*                                           B0 - IEC129 REQUIRED Y02072 27605902
*                                           B1 - CORE TRANSFER   Y02072 27606102
*                              BYTE 1   - FCB FLAG BYTE          Y02072 27607502
*                              BYTE 2   - FLAG BYTE              Y02072 27607702
*                              BYTE 3   - DXFCBOPT               Y02072 27607902
*                                           B0 - ALIGN REQUESTED Y02072 27608002
*                                           B1 - VERIFY REQ      Y02072 27608102
*                              BYTE 4-8 - FCB IMAGE ID           Y02072 27608802
*                                                                       27608902
*********************************************************************** 27609002
*                                                                       27609102
WKARINFO EQU   *                                                 S21092 27609202
*                                                                       27609302
*********************************************************************** 27609402
*                                                                       27609502
         MVC   DXFCBID,JFCFCBID         MOVE FCB ID TO WKAREA    Y02072 27609902
*                                                                       27621502
*    THIS ROUTINE PUTS THE FCB OPTIONS INTO THE FCB WORKAREA FROM JFCB  27622002
*                                                                       27624002
         IC    RB,JFCUCSOP              LOAD FCB OPTIONS INTO    S20202 27624502
*                                       REG 12                   S20202 27625002
         SRL   RB,SHIFTRHT              SHIFT OUT BITS 6 & 7 OF  S20202 27625502
*                                       BYTE 3                   S20202 27626002
         SLL   RB,SHIFTLFT              SHIFT BITS 6 & 7 OF BYTE S20202 27626502
*                                       3 TO                     S20202 27627002
*                                       BITS 0 & 1 OF BYTE 3            27627502
         STC   RB,DXFCBOPT              LOAD FCB OPT INTO        Y02072 27627902
*                                       WORKAREA                 S20202 27628502
*                                                                       27629002
*                                                                       27629502
*********************************************************************** 27630002
*                                                                       27630502
*   TEST IF FCB PARAMETERS ARE SPECIFIED IN DD STATEMENT FOR DCB        27631002
*   AND SET SWITCHES (DXFCBSW1) FOR FCB                          Y02072 27631502
*                                                                       27634502
*********************************************************************** 27635002
*                                                                       27635502
         CLI   DXFCBID,0                CK IF FCB SPECIFIED IN   Y02072 27635902
*                                       DD ST                    S20202 27636502
         BNE   PADFCBID                 YES GO PAD FCB ID WITH   S20202 27637002
*                                       BLANKS                   S20202 27637502
*                                                                       27638002
*********************************************************************** 27638502
*                                                                       27639002
*   WHEN FCB NOT SPECIFIED IN DD STATEMENT,CHECK IF CURRENT FCB IN THE  27639502
*   BUFFER IS A DEFAULT                                                 27640002
*                                                                       27640502
*********************************************************************** 27641002
*                                                                       27641502
         CLI   UCBFCBID,0               CK IF FCB ID IN UCB      Y02072 27641902
         BE    GTMSG129                 IF NOT, GO WTOR IEC129   Y02072 27643502
         TM    UCBFCBOP,DEFALT          CK IF CURRENT FCB IS A   Y02072 27643902
*                                       DEFAULT                  S20202 27644502
         BZ    GTMSG129                 NO GO TO WTOR IEC129     Y02072 27645002
         MVC   DXFCBID,UCBFCBID         SET UP FOR FCB LOAD      Y02072 27645402
         MVI   DXFCBOPT,0               CLR FLAG AS USER CANNOT  Y02072 27645802
*                                         SPEC OPTIONS IF HE     Y02072 27646202
*                                         DOES NOT SPEC IMAGE ID Y02072 27646302
         B     UCSIDTST                 GO TEST FOR UCS          S20202 27646502
*                                       PARAMETERS               S20202 27647002
*                                                                       27647502
*********************************************************************** 27648002
*                                                                       27648502
*   WHEN THE FCB IMAGE IN THE BUFFER IS NOT A DEFAULT OR NO FCB IMAGE   27649002
*   LOADED REQUEST OPERATOR TO SPECIFY AN ALTERNATE BY ISSUEING A WTOR  27649502
*   'IEC129D XXX SPECIFY FCB PARAMETER'                                 27650002
*                                                                       27650502
*********************************************************************** 27651002
*                                                                       27651502
GTMSG129 EQU   *                                                 Y02072 27652002
         OI    DXFCBSW1,IEC129RQ        SET SWITCH FOR IEC129    Y02072 27655002
*                                       REQUIRED                 S20202 27655402
         B     UCSIDTST                 GO TEST UCS PARAMETERS   S20202 27655802
WTOR129  EQU   *                                                 Y02072 27681002
         TM    DXFCBSW1,IEC129RQ        IS MSG129 REQUIRED       Y02072 27683002
         BZ    XCTL197E                 NO, XCTL TO 197E         Y02072 27683402
         LA    RWK5,MSG129              MSG ID FOR MSG ROUTINE   Y02072 27683502
         BAL   RWK6,MSGRTN              GO GET MSG TEXT FOR WTOR Y02072 27683602
*                                                                       27684002
* GO FILL IN DEVICE ADDR AND ISSUE WTOR                          Y02072 27684402
*                                                                       27684802
         BAL   RD,WTORSEQ               ISSUE WTOR               Y02072 27684902
*                                                                       27685002
*   LOAD ID OF IGG0197E AND GO ISSUE SVC 105 TO BUILD DCB AND DEB       27685202
*                                                                       27685502
XCTL197E EQU   *                                                 S20202 27687002
*                                                                       27687502
         LA    RDEB,MODNM7E             LOAD ADDR OF TTR FOR     S20202 27688502
*                                       IGG0197E                 S20202 27689002
         B     OPENIMLB                 GO OPEN SYS1.IMAGELIB    S20202 27689502
*                                                                       27900000
*********************************************************************** 27960002
*                                                                       27970002
*   WHEN FCB SPECIFIED IN DD STATEMENT,PAD FCB IMAGE ID WITH BLANKS     27980002
*                                                                       27990002
*********************************************************************** 27992002
*                                                                       27994002
PADFCBID EQU   *                                                 S20202 27996002
*                                                                       27998002
         LA    RB,DXFCBID+1             LOAD ADDR OF FCB ID + 1  Y02072 27998402
         BAL   RD,PADNAME               GO PAD FCB ID WITH       S20202 27998802
*                                       BLANKS                   S20202 27999202
UCSIDTST EQU   *                                                        28000000
*                                                                       28100000
*********************************************************************** 28200000
*                                                                       28300000
*   TEST IF UCS PARAMETER IS SPECIFIED IN DD STATEMENT FOR THE DCB      28400000
*                                                                       28500000
**********************************************************************  28600000
*                                                                       28700000
         CLI   UCBTBYT4,PRT2245        CHECK FOR 2245 PRINTER    S21092 28730021
         BE    WTOR129                 YES, GO TEST FOR MSG      Y02072 28760002
*                                         IEC129 REQUIRED        Y02072 28760402
TESTUCS  EQU   *                                                 Y02072 28762002
         CLI   DXUCSID,0                TEST FOR UCS IN DD STAT  Y02072 28770002
         BC    7,PADUCSID               IF YES,GOTO PAD UCS ID ROUTINE  28900000
*                                                                       29200000
NOUCSID  EQU   *                                                        29300000
*                                                                       29400000
*********************************************************************** 29500000
*                                                                       29600000
*   WHEN UCS IS NOT SPECIFIED IN DD STATEMENT, CHECK UCB TO SEE IF A    29700002
*   DEFALT UCS IMAGE IS IN THE BUFFER                                   29800000
*                                                                       29900000
*********************************************************************** 30000000
*                                                                       30100000
         CLI   UCBUCSID,0               CK IF UCS ID IN UCB      Y02072 30150002
         BE    WTOR123                  IF NOT, GO WTOR IEC123   Y02072 30220002
         TM    UCBUCSOP,DEFALT          TEST IF UCS IMAGE IS A   Y02072 30230002
*                                       DEFAULT                  S20202 30300020
         BNO   WTOR123                  NO GO TO WTOR IEC123     S20202 30320020
         MVC   DXUCSID,UCBUCSID         MOVE UCS ID TO PARM LIST Y02072 30370002
         MVC   DXUCSOPT,UCBUCSOP        MOVE UCS OP TO PARM LIST Y02072 30380002
         NI    DXUCSOPT,X'FF'-BUFPAR-DEFALT  LEAVE LOAD MODE ON  Y02072 30430002
         B     XCTL191U                 GO XCTL TO NEXT EXEC     Y02072 30480002
*                                                                       30700000
*********************************************************************** 33000000
*                                                                       33100000
WTOR123  EQU   *                                                        33200000
*                                                                       33205020
*********************************************************************** 33210020
*                                                                       33215020
*   SET SWITCH TO INDICATE ENTRY TO IGG191U WILL BE FROM IEC123         33220020
*                                                                       33225020
*********************************************************************** 33230020
*                                                                       33235020
         OI    DXUCSSW1,IEC123RQ        SET SW FOR IEC123 REQ    Y02072 33245002
         LA    RD,XCTL191U              GET ADDRESS OF XCTL191U  S20202 33250020
*                                       ROUTINE TO LOAD ID OF           33255002
*                                       MODULE IGG0191U                 33260020
*                                                                       33300000
*********************************************************************** 33400000
*                                                                       33500000
*   WHEN THE IMAGE IN THE BUFFER IS NOT A DEFALT, REQUEST AN ALTERNATE  33600002
*   UCS IMAGE AND CHAIN TO BE MOUNTED                                   33700000
*   WTOR 'IEC123D SPECIFY UCS PARAMETER'                                33800000
*                                                                       33900000
*********************************************************************** 34000000
         LA    RWK5,MSG123              MESSAGE NO. FOR MSG RTN  Y02072 34050002
         BAL   RWK6,MSGRTN              GO GET MESSAGE           Y02072 34100002
         USING MSGENTRY,RWK2                                     Y02072 34259002
WTORSEQ  EQU   *                                                 S20202 34260002
         IC    RWK7,MSGOFF1             OFFSET TO FIRST VAR FLD  Y02072 34290002
         LA    RWK3,MSGAREA(RWK7)       ADDRESS OF FIRST VAR FLD Y02072 34340002
         MVC   0(L'UCBNAME,RWK3),UCBNAME  MOVE DEV NAME TO MSG   Y02072 34390002
         MVI   RPLY,BLANK                                        A33665 34460020
         MVC   RPLY+1(19),RPLY          CLEAR REPLY AREA         A33665 34540020
         MVI   RPLYECB,NULL             RESET REPLY ECB          A33665 34620020
         LA    RF,REPLYLTH              LOAD WTOR ADDR                  34700000
*                                                                       34800000
         SVC   35                       ISSUE WTOR SVC                  34900000
*                                                                       35000020
*                                                                       35100020
*                                                                       35200020
         BR    RD                       GO TO ADDRESS IN         S20202 35300020
*                                       REGISTER 14              S20202 35400020
         DROP  RWK2                                              Y02072 35490002
*                                                                       35500020
PADUCSID EQU   *                                                        36200000
*                                                                       36300000
*********************************************************************** 36400000
*                                                                       36500000
*   WHEN UCS IS SPECIFIED IN DD STATEMENT,PAD UCS IMAGE ID WITH X'40'   36600000
*                                                                       36700000
*********************************************************************** 36800000
*                                                                       36900000
         LA    RD,COMPUCS               RET ADDR FROM PAD RTN    Y02072 36930002
         LA    RB,DXUCSID+1             LOAD UCS ID + 1 ADDR     Y02072 36970002
*                                                                       37020020
PADNAME  EQU   *                                                 S20202 37040020
*                                                                       37060020
*                                                                       37080020
         LA    RC,THREE                 LOAD X'03'                      37100000
*                                                                       37200000
COMPBYTE EQU   *                                                        37300000
*                                                                       37400000
         CLI   NULL(RB),NULL            TEST IF UCS IMAGE HAS X'00'     37500000
         BC    7,NEXTBYTE               IF NOT,GOTO TEST NEXT BYTE      37600000
*                                                                       37700000
         MVI   NULL(RB),BLANK           IF YES,REPLACE X'00' BY X'40'   37800000
*                                                                       37900000
NEXTBYTE EQU   *                                                        38000000
*                                                                       38100000
         LA    RB,ONE(RB)               INCREMENT REG. BY '1'           38200000
         BCT   RC,COMPBYTE              GOTO COMPARE NEXT BYTE          38300000
         BR    RD                       BRANCH TO SET SWITCHES   S20202 38350020
*                                                                       40600000
COMPUCS  EQU   *                                                        40700000
*                                                                       40800000
*********************************************************************** 40900000
*                                                                       41000000
*   TEST IF UCS PARAMETERS IN UCB = UCS PARAMETERS IN DD STATEMENT      41100000
*                                                                       41200000
*********************************************************************** 41300000
*                                                                       41400000
         CLC   UCBUCSID,DXUCSID         CK IF SPECIFIED          Y02072 41410002
*                                       UCS=CURRENT              S20202 41540020
         BE    XCTL191U                 NO IEC120 REQ IF EQ      Y02072 41542002
         OI    DXUCSSW1,IEC120RQ        SET IEC120 REQ TO GET    Y02072 41544002
*                                         THE TRAIN MOUNTED      Y02072 41560002
*                                                                       54300000
XCTL191U EQU   *                                                        54400000
*                                                                       54500000
*********************************************************************** 54600000
*                                                                       54700000
*   XCTL TO EXECUTOR IGG0191U TO LOAD IMAGE.                            54800000
*                                                                       54900000
*********************************************************************** 55000000
*                                                                       55100000
*                                                                       55103020
*                                                                       55106020
*                                                                       55109020
         LA    RDEB,MODNM1U             LOAD ADDR OF TTR FOR     S20202 55112020
*                                       IGG0191U                 S20202 55115002
*                                                                       55118020
*                                                                       55121020
*                                                                       55124020
OPENIMLB EQU   *                                                 S20202 55127020
*                                                                       55130020
*                                                                       55133020
         SR    RF,RF                    ZERO OUT REGISTER 1      S20202 55136020
*                                                                       55139020
*  ISSUE SVC TO OPEN SYS1.IMAGELIB                                      55142020
*                                                                       55145020
         SVC   105                      ISSUE SVC TO OPEN        S20202 55148020
*                                       SYS1.IMAGELI             S20202 55151020
         LTR   RF,RF                    TEST IF IMAGELIB OPENED  S20202 55154020
*                                       SUCCES                   S20202 55157020
         BE    IMAGEROR                 IF NOT GO LOAD TTR OF    S20202 55160020
*                                       OPEN MOD                 S20202 55163020
         ST    R1,DXIMGDCB              SAVE ADDR OF IMGLIB DCB  Y02072 55165002
         OI    FCAOPEN2,FCAOIMGL        INDIC IMAGELIB OPENED    YM4697 55175002
         LR    RF,RDEB                  GET ADDR OF OPEN         S20202 55181020
*                                       EXECUTOR TTR             S20202 55184020
         BC    K15,MVEIDTTR             GOTO MOVE ID TTR ROUTINE S20202 55187020
*                                                                       55196020
IMAGEROR EQU   *                                                 S20202 55199020
*                                                                       55205020
*   THIS ROUTINE CONVERTS RETURN CODE FROM IMAGELIB TO AN               55207021
*   INTERNAL CODE FOR PROBLEM DETERMINATION                             55209021
*              RETURN CODE              INTERNAL CODE                   55211021
*              X'04'                    95                              55213021
*              X'08'                    96                              55215021
*              X'0C'                    97                              55217021
*                                                                       55223020
         LA    RF,OABD095-K1            PUT INTERNAL CODE IN REG M0009  55227021
         SRL   RJ,2                     DIVIDE RTN CODE BY 4     YM3213 55227401
         AR    RJ,RF                    IF REG15=1, THEN         M0009  55228021
*                                       INTERNAL CODE IS 95,            55229021
*                                       ABEND CODE IS B13-20            55230021
*                                       IF REG 15=2, THEN               55231021
*                                       INTERNAL CODE IS 96,            55232021
*                                       ABEND CODE IS B13-24            55233021
*                                       IF REG 15=3, THEN               55234021
*                                       INTERNAL CODE IS 97,            55235021
*                                       ABEND CODE IS B13-28            55236021
PDEXIT   EQU   *                        GO TO PROB DET           Y02072 55246002
         MVI   DXABEND,ABEND            SET ABEND FLAG           Y02072 55248002
         STC   RJ,DXABRETC              STORE RETURN CODE        Y02072 55250002
XCTL191V EQU   *                                                 Y02072 55252002
         LA    RF,MODNM1V               GET IDTTR OF IGGO191V    S20202 55256020
MVEIDTTR EQU   *                                                        63300000
*                                                                       63400000
*********************************************************************** 63500000
*                                                                       63600000
*   MOVE IDTTR TO XCTL WTG TABLE                                        63700000
*                                                                       63800000
*********************************************************************** 63900000
*                                                                       64000000
         USING WTGENTRY,RWTGC                                    Y02072 64050002
         MVC   WTGIDTTR,0(RF)           ST NEXT MOD ID IN WTG  @Z30TSCF 64060003
*                                                                       64200000
*********************************************************************** 64300000
*                                                                       64400000
RELOOP   EQU   *                                                        64500000
*                                                                       64600000
*********************************************************************** 64700000
*                                                                       64800000
*   UPDATE WTG TABLE AND XCTL TO NEXT MODULE                            64900000
*                                                                       65000000
*********************************************************************** 65100000
*                                                                       65200000
         LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURRENT WTG ENTRY     65300000
         LA    RPARC,PLOFF(0,RPARC)     INCREMENT CURRENT DCB ENTRY     65400000
         CLC   0(2,RWTGC),AMIDCNST      IS THE RTN NEEDED AGAIN         65500000
         BCR   8,RBASE                  IF YES,RETURN TO PROCESS        65600000
*                                                                       65700000
         CLC   0(2,RWTGC),OPIDCNST      TEST END OF WTG TABLE           65800000
         BC    7,RELOOP                 IF NOT,CHECK NEXT ENTRY         65900000
*                                                                       66000000
         LR    RPARC,RPAR               RESET REG TO '0'                66100000
         LA    RWTGC,WAOFF(0,RWTG)      RESET WTG REG TO POINT +32(WTG) 66200000
ZCHECK   CLI   0(RWTGC),X'00'           TEST IF THIS ENTRY COMPLETE     66300000
         BC    7,TCTLRTN                IF NOT,XCTL                     66400000
*                                                                       66500000
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY OF WTG TABLE     66600000
         LA    RPARC,PLOFF(0,RPARC)     GET NEXT ENTRY OF DCB           66700000
         BC    15,ZCHECK                GOTO TEST COMPLETION            66800000
*                                                                       66900000
TCTLRTN  EQU   *                                                        67000000
*                                                                       67050003
         USING WTG,RWTG                                                 67100003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*67150003
               MODID=WTGENTRY                                  @Z30TSCF 67200003
         DROP  RWTGC,RWTG                                      @Z30TSCF 67250003
*                                                                       67800000
         EJECT                                                          67802002
*********************************************************************** 67810002
*  'MSGRTN' SUBROUTINE                                           Y02072 67820002
*  THIS SUBROUTINE EXTRACTS THE REQUIRED MESSAGE FROM THE MSG    Y02072 67830002
*  CSECT AND MOVES IT TO THE WTO/WTOR AREA.                      Y02072 67832002
*                                                                       67834002
*    INPUT TO THIS ROUTINE:                                      Y02072 67836002
*      REG 12 - MESSAGE NUMBER IN MSG CSECT                      Y02072 67838002
*      REG 13 - RETURN ADDRESS                                   Y02072 67838402
*                                                                       67838802
*    OUTPUT FROM THIS ROUTINE:                                   Y02072 67839202
*      MESSAGE TEXT IN WTO/WTOR AREA                             Y02072 67839602
*      REG 1 - POINTER TO MESSAGE ENTRY IN THE MESSAGE CSECT     Y02072 67839702
*********************************************************************** 67840002
MSGRTN   EQU   *                        ENTRY POINT, MSG ROUTINE Y02072 67850002
         L     RWK7,DXMSGADR            GET ADDR OF MSG CSECT    Y02072 67860002
         LH    RWK2,0(RWK7,RWK5)        GET INDEX TO MESSAGE     Y02072 67870002
         LA    RWK2,0(RWK7,RWK2)        ADDR OF MESSAGE ENTRY    Y02072 67880002
         USING MSGENTRY,RWK2                                     Y02072 67890002
         SR    RWK3,RWK3                PREPARE REGISTER         Y02072 67892002
         IC    RWK3,MSGOFF              GET OFFSET TO TEXT IN    Y02072 67894002
*                                         ENTRY                  Y02072 67896002
         LA    RWK3,0(RWK2,RWK3)        ADDR OF MESSAGE TEXT     Y02072 67898002
         SR    RWK7,RWK7                PREPARE REGISTER FOR RET Y02072 67898402
         USING MSGTXTD,RWK3                                      Y02072 67898802
         IC    RWK7,MSGLNG              GET LEN OF MSG - 1       Y02072 67899202
         EX    RWK7,MVCINST             MOVE MESSAGE             Y02072 67899602
         BR    RWK6                     RETURN                   Y02072 67899702
MVCINST  MVC   MSGAREA(0),MSGTXT        EXECUTED BY EX INST      Y02072 67899802
         EJECT                                                          67899902
*                                                                       68338502
*********************************************************************** 68359002
*                                                                       68379502
*   CONSTANTS                                                           68400000
*                                                                       68500000
*********************************************************************** 68600000
*                                                                       68900000
OPIDCNST DC    C'0S'                                                    69000000
AMIDCNST DC    C'1T'                                                    69100000
LOWER    DC    X'4040404040404040'      MASK TO OR REPLY                69800000
MSGCSECT DC    CL8'IGGMSG01'            NAME OF MSG CSECT        Y02072 69950002
*                                                                       70100000
*********************************************************************** 70200000
*                                                                       70300000
*   XCTL TABLE                                                          70400000
*                                                                       70500000
*********************************************************************** 70600000
*                                                                       70700000
MODNM1U  DC    C'1U',VL3(IGG0191U)      MODULE IGG0191U        @Z30TSCF 70724003
MODNM1V  DC    C'1V',VL3(IGG0191V)      MODULE IGG0191V        @Z30TSCF 70726003
MODNM7E  DC    C'7E',VL3(IGG0197E)      MODULE IGG0197E        @Z30TSCF 70728403
         SPACE                                                          70729202
PATCH    DC    0H'0',50X'00'            PATCH AREA               Y02072 70729902
END      EQU   *                        END OF MODULE            Y02072 70730002
         EJECT                                                          70740002
         IEECUCM FORMAT=NEW                                      YM6054 70750002
         EJECT                                                          70780002
         IHAPSA                                                  Y02072 70830002
         EJECT                                                          70880002
         DCBD  DSORG=PS                                                 72900000
         EJECT                                                          73250002
         IGGMSG                                                  Y02072 73260002
         EJECT                                                          73270002
         IECDSECS  MAIN,WTG,PREFX,EXPAND=YES                   @Z30TSCF 73280003
         ORG   WTGIDTTR                                          Y02072 73330002
WTGID    DS    CL2                      NEXT MOD ID              Y02072 73380002
FORCORE  DSECT                                                   Y02072 73430002
         ORG   REPLYLTH+52                                       A33665 73440020
RPLY     DS    20C                                               A33665 73480020
RPLYECB  DS    F                                                 A33665 73520020
MCSMASK  DS    H                                                 A33665 73560020
LOMASK   DS    8C                                                A33665 73600020
UCSID    DS    4C                                                A33665 73640020
         ORG   MSGLSTSZ                                          Y02072 73650002
MSGAREA  DS    0CL64                    TAREA TO MOVE 64 BYTES   Y02072 73660002
*                                         TO FOR WTO/WTOR'S      Y02072 73670002
         EJECT                                                          73680002
         IGGSCW                                                  Y02072 73682002
         EJECT                                                          73690002
         IHAFCAUD  ORG=YES                                       YM4697 73740002
         EJECT                                                          73790002
SRT      DSECT                                                          74000000
         IEFUCBOB                                                       74100000
         EJECT                                                          74600002
         IEZDEB                                                  Y02072 74650002
         EJECT                                                          74700002
         IKJTCB                                                  Y02072 74750002
         EJECT                                                          74800002
         CVT  DSECT=YES,LIST=NO                                  Y02072 74850002
         END                                                            78800000
