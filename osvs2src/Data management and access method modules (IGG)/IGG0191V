191V   TITLE 'IGG0191V -SAM && EXCP PRINTER UCS BUFFER LOADING'         00100003
IGG0191V CSECT                                                          00400000
*                                                                       00450002
*MODULE NAME - IGG0191V                                          Y02072 00500002
*                                                                       00510002
*DESCRIPTIVE NAME - SAM & EXCP PRINT UCS BUFFER LOADING                 00512003
*                                                                       00514002
*COPYRIGHT - NONE                                                Y02072 00516002
*                                                                       00518002
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00518402
*                                                                       00518802
*          RELEASE 20 DELETIONS                                         00520000
*0216109000                                                      A38811 00525020
*0216609000-611000,615000,620000-621000,624000,627000,629000,    A33665 00530020
*0216632000,635000                                               A33665 00540020
*0216008000-015000,017000,028000-030000,035000,041000-042000,    S20202 00542020
*0216045000-048000,123000-133000,177000,189000,231000,235000,    S20202 00544020
*0216272000,284000-287000,316000-324000,443000-660000,693000,    S20202 00546020
*0216756000-759000,762000-763000,764000-772000,780000,786000     S20202 00548020
*0216109000                                                      M5148  00548520
*0216317800,318200-318500                                        M5143  00549020
*          RELEASE 21 DELETIONS                                         00550000
*0934125600-125800,319800,321600                                 M1803  00552021
*0934041000,136000,257000,439000,665000-667000,670000-680000,    S21042 00560021
*0934734000-738000,780000-786000,802000-803000                   S21042 00570021
*0934                                                            M0092  00575021
*A                                                               XM5898 00575101
*        VS2 RELEASE 02 DELETIONS                                       00625102
*001600-003400,007400,054000,106200-106600,162500,163500-163800, Y02072 00675102
*250000-253000,271800-271920,272120-272984,317700-318000,318100, Y02072 00725102
*343000,370060-370840,386050-386600,753000-763600,781000-791000, Y02072 00735102
*802000,405000,437000,441000,344000,750500-750900,752000         Y02072 00737102
*192390-192470,192500-192560                                     SM5451 00737502
*                                                                YM4697 00737902
*                                                                       00738303
*        VS2 RELEASE 3.0 CHANGES                                        00738703
*                                                              @Z30TSCF 00738803
*A733500                                                       @ZA04647 00739003
*        VS2 RELEASE 4.0 CHANGES                                        00739103
*A190200-191840,270200                                         @ZA02191 00739203
*C239000                             ABEND 0C4 IF UCS NOT RENT @ZA02191 00739403
*D192180-192250,203000-208000,219120,219400-219500             @ZA02191 00739603
*                                                                       00764603
*STATUS - SEE BEGINNING OF OBJECT CODE                                  00777303
*                                                                       00790002
*FUNCTION/OPERATION - EXECUTE UCS IMAGE LOAD INTO STORAGE AND THEN INTO 00800002
*                     UCS BUFFER                                        01050002
*                   - SET AUDIT TRAIL BIT FOR FORCE CLOSE        YM4697 01100002
*                     INDICATING LOAD ISSUED FOR UCS IMAGE       YM4697 01110002
*                   - RESET AUDIT TRAIL BITS TO INDICATE UCS     YM4697 01120002
*                     IMAGE DELETED AND IMAGELIB CLOSED          YM4697 01122002
*                   - UPDATE UCB TO REFLECT STATUS OF IMAGE IN BUFFER   01130020
*                     IF VERIFY NOT SPECIFIED                           01210020
*                   - DETERMINE NEXT OPEN EXECUTOR TO XCTL TO AND IF    01290020
*                     NECESSARY ISSUE MESSAGE IEC129 TO OPERATOR        01370020
*                   - CLOSE SYS1.IMAGELIB IF PRINTER IS 1403            01450003
*                                                                       01600000
*ENTRY POINT - ENTERED FROM IGG0191T OR IGG0191U BY USE OF IECRES MACRO 01700003
*                                                                       01800000
*INPUT - DCB ADDRESS                                                    01900000
*      - OPEN WORK AREA ADDRESS                                         02000000
*      - WHERE-TO-GO TABLE                                              02100000
*      - PARAMETER LIST                                                 02200000
*      - CURRENT ENTRY IN W-T-G TABLE                                   02300000
*      - CURRENT PARAMETER(DCB)                                         02400000
*      - THE ADDRESS OF UCS IMAGE RETRIEVED                             02500000
*      - THE ADDRESS OF SYS1.IMAGELIB DCB IN OPEN WORKAREA(DXCCW8)      02550020
*                                                                       02600000
*OUTPUT - UCS BUFFER LOAD                                               02700000
*       - UPDATED UCB TO REFLECT THE STATUS OF UCS BUFFER               03100002
*       - ISSUE REQUEST FOR OPERATOR TO SPECIFY FCB IMAGE               03130020
*                     'IEC129  XXX,SPECIFY ,FCB PARAMETERS'  MESSAGE    03160020
*       - ISSUE MESSAGE 'IEC126I XXX, UNCORRECTABLE ERROR        Y02072 03170002
*                       LOADING UCS BUFFER'                      Y02072 03180002
*                                                                       03200000
*EXTERNAL REFERENCES - MESSAGE CSECT                             Y02072 03300002
*                                                                       03400000
*EXIT - NORMAL - XCTL TO ONE OF THE FOLLOWING MODULES:           Y02072 03410002
*               *IGG0197U IF UCS IMAGE TO BE VERIFIED            Y02072 03460002
*               *IGG0197E IF AN FCB IMAGE IS TO BE LOADED               03520020
*               *IGG01911 IF THE DCB IS EXCP.                    Y02072 03600002
*               *IGG0191I IF BUFFER CNTRL BLOCK IS SPECIFIED.           03700000
*               *IGG0191G IF NORMAL SCHEDULING IS SPECIFIED.            03800000
*               *IGG0191Q IF CHAINED SCHEDULING IS SPECIFIED.           03900000
*                                                                       04000000
*EXIT - ERROR - XCTL TO PROBLEM DETERMINATION FOR WTP AND B13 ABEND     04060021
*               FOR ONE OF THE FOLLOWING:                               04120002
*              *MODULE IGG0191U SET SWITCH TO ABEND                     04200020
*              *PERMANENT I/O ERROR OCCURED DURING UCS BUFFER LOAD.     04300000
*                                                                       04900000
*TABLES/WORK AREAS - WHERE-TO-GO TABLE (SEE WTGTABLE IN THIS LISTING)   05000003
*                  - OPEN WORK AREA (SEE IECDSECT IN THIS LISTING)      05200000
*                                                                       05250002
*MACROS-ACTION:MODESET, LOAD, EXCP, WAIT,DELETE, XCTL, DMABCOND, Y02072 05260002
*              XCTLTABL                                          Y02072 05270002
*                                                                       05280002
*MACROS-MAPPING:IEFUCBOB, IGGMSG, IECDSECS(WTG,MAIN),DCBD,IGGSCW Y02072 05290002
*               IHAFCAUD                                         YM4697 05292002
*                                                                       05300000
*ATTRIBUTES - REENTRANT, REFRESHABLE, RUNS IN DATA MANAGEMENT KEYY02072 05400003
*             UNLESS OTHERWISE SPECIFIED, SUPER STATE            Y02072 05450002
*                                                                       05500000
*NOTES - EXCP/WAIT SVCS ARE USED TO LOAD UCS BUFFER AND WRITE IMAGE     05600002
*        ON THE PRINTER FOR VERIFICATION.                               05700000
*      - DELETE SVC IS USED TO DELETE THE RETRIEVED IMAGE.              05800000
*      - WTOR SVC IS USED TO REQUEST OPERATOR REPLY                     05900000
*      - IOB/ECB IN OPEN WORK AREA IS USED FOR EXCP                     06000000
*      - THE REPLY IS ORED TO ALLOW LOWER CASE ALPHA                    06100000
*      - SVC (105) IS USED TO DELETE DCB AND DEB OF SYS1.IMAGELIB       06150003
*      - BEFORE ISSUING A WTO/WTOR, THE MESSAGE TEXT MUST FIRST  Y02072 06170002
*        BE EXTRACTED FROM A MESSAGE CSECT.                      Y02072 06180002
*                                                                       06200000
*********************************************************************** 06300000
*                                                                       06400000
         EJECT                                                          06500000
*                                                                       06600000
*********************************************************************** 06700000
*                                                                       06800000
*   REGISTER CONVENTIONS USED THROUGH OUT ALL OPEN PASSES               06900000
*                                                                       07000000
*********************************************************************** 07100000
*                                                                       07200000
*                                                                       07300000
RE       EQU   0                        WORK/PARAMETER REGISTER         07400000
RF       EQU   1                        WORK/PARAMETER REGISTER         07500000
RWK2     EQU   RF                       WORK REGISTER            Y02072 07550002
RDCB     EQU   2                        ADDR OF USER'S DCB              07600000
RBASE    EQU   3                        BASE REGISTER                   07700000
RCORE    EQU   4                        ADDR OF OPEN WORK AREA          07800000
RPAR     EQU   5                        PARAMETER LIST                  07900000
RWTG     EQU   6                        START OF WTG                    08000000
RPARC    EQU   7                        CURRENT ENTRY IN PARAMETER LIST 08100000
RWTGC    EQU   8                        CURRENT ENTRY IN WTG TABLE      08200000
RWK3     EQU   9                        WORK REGISTER            Y02072 08300002
RUCB     EQU   10                       UCB ADDR/WORK REGISTER          08400000
RDEB     EQU   11                       DEB ADDR                        08500000
RWK6     EQU   RDEB                     WORK REGISTER            Y02072 08550002
RB       EQU   12                       WORK REGISTER/BREG FOR DSECT    08600000
RC       EQU   13                       WORK REGISTER                   08700000
RD       EQU   14                       WORK/PARAMETER REGISTER         08800000
RJ       EQU   15                       WORK/PARAMETER REGISTER         08900000
RWK7     EQU   RJ                       WORK REGISTER            Y02072 08950002
*                                                                       09000000
*********************************************************************** 09100000
*                                                                       09200000
*                                                                       09300000
*   EQUATE WTG OFFSET                                                   09400000
*                                                                       09500000
WGOFF    EQU   8                        OFFSET OF CURRENT WTG ENTRIES   09600000
PLOFF    EQU   4                        OFFSET OF CURRENT DCB ENTRIES   09700000
WAOFF    EQU   32                       OFFSET OF 1ST ENTRY IN WTG TBL  09800000
*                                                                       09900000
*   EQUATE ABEND CODE AND RETURN CODE                                   10000000
*                                                                       10100000
PCIMASK  EQU   X'20'                    OPTCD=PCI SPECIFIED             10700000
BFCNTRL  EQU   X'01'                    BUFFER CNTRL BLOCK SPECIFIED    10800000
EXCPMASK EQU   X'80'                    LOAD EXCP                A38811 10900020
UNRLMASK EQU   X'42'                    IOB IS UNRELATED AND C.C.       11000000
NULL     EQU   X'00'                    X'00'                           11100000
CNTRLMSK EQU   X'EB'                    COMMAND CODE = CNTRL            11200000
SILIMASK EQU   X'60'                    C.C. AND SILI ON                11300000
ONEMASK  EQU   X'01'                    X'01'                           11400000
UCSLNGTH EQU   X'F0'                    UCS IMAGE LENGTH                11500000
TWOMASK  EQU   X'02'                    X'02'                           11600000
UNFLCCW  EQU   X'FB'                    COMMAND CODE = LOAD NO FOLD     11700000
FLDCCW   EQU   X'F3'                    COMMAND CODE = LOAD FOLD        11800000
FOLDMASK EQU   X'40'                    LOAD MODE = FOLD                11900000
VERIFY   EQU   X'10'                    VERIFY = YES                    12000000
RESETMSK EQU   X'CF'                    RESET VERIFY                    12100000
*                                                                       12220020
*   EQUATES FOR SYS1.IMAGELIB SUPPORT AND 3211 PRINTER SUPPORT          12240020
*                                                                       12260020
PARITYER EQU   X'01'                    BUFFER PARITY ERR        Y02072 12270002
*                                         IN UCSB                Y02072 12272002
ABEND    EQU   X'FF'                    1U ABEND SWITCH          S20202 12280020
NONZERO  EQU   X'01'                    NON-ZERO BYTE COUNT      SM5451 12410002
SILIMSK  EQU   X'20'                    SILI FLAG FOR CCW'S      SM5451 12420002
UCSLDCC  EQU   X'FB'                    UCS LOAD COMMAnD         S20202 12440020
ABENDBIT EQU   X'80'                    ABEND IN PROCESS SWITCH  S20202 12480020
UCSFLDCC EQU   X'43'                    COMMAND CODE = FOLD UCS  S20202 12600020
UCSUNFLD EQU   X'23'                    COM CODE TO UNFOLD UCS   SM5451 12610002
PRTM3211 EQU   X'09'                    MASK FOR 3211 PRINTER    S20202 12620020
IEC129RQ EQU   X'80'                    MESSAGE IECU29D REQUIRED S20202 12640002
*                                       MASK                     S20202 12660020
UCSIDOFS EQU   X'00'                    UCS OFFSET FROM START    S20202 12680020
*                                       UCB WK A                 S20202 12700020
UCSOPOFS EQU   X'04'                    UCS OPTIONS OFFSET       S20202 12720020
IMCLOSED EQU   X'FF'                    FLAG SET FOR IMAGELIB    S20202 12840020
*                                         NOT OPEN                      12890002
K1       EQU   1                        CONSTANT EQUATED TO 1    S20202 12920020
K2       EQU   2                        CONSTANT EQUATED TO 2    S20202 12940020
K4       EQU   4                        CONSTANT EQUATED TO 4    S20202 12980020
K6       EQU   6                        CONSTANT EQUATED TO 6    S20202 13020020
K8       EQU   8                        CONSTANT EQUATED TO 8    S20202 13060020
K35      EQU   35                       CONSTANT EQUATED TO 35   S20202 13280020
OABD069  EQU   69                                                S21042 13650021
*  THE FOLLOWING MESSAGE NUMBERS ARE EQUAL TO THEIR POSITION     Y02072 13652002
*  IN THE MESSAGE CSECT (RELATIVE TO ZERO), MULT BY 2 (LENGTH    Y02072 13654002
*  OF AN INDEX)                                                  Y02072 13656002
MSG126   EQU   10*2                     MESSAGE NO IN MSG CSECT  Y02072 13660002
MSG129   EQU   3*2                      MESSAGE NO IN MSG CSECT  Y02072 13670002
*                                                                       13700000
*********************************************************************** 13800000
*                                                                       13900000
*   HOUSE KEEPING                                                       14000000
*                                                                       14100000
*********************************************************************** 14200000
*                                                                       14300000
         BALR  RBASE,0                                                  14400000
         USING *,RBASE                                                  14500003
         USING IHADCB,RDCB                                              14600000
         USING FORCORE,RCORE                                            14700000
         USING DEB,RDEB                                                 14800000
         USING UCBOB,RUCB                                               14900000
*                                                                       15000000
*                                                                       15200000
*                                                                       15400000
*********************************************************************** 15500000
*                                                                       15600000
*   INITIALIZE REGISTERS                                                15700000
*                                                                       15800000
*********************************************************************** 15900000
*                                                                       16000000
         B     AROUND                   BR AROUND CONSTANTS      Y02072 16050002
         DC    C'IGG0191V'              MODULE NAME              Y02072 16060002
         DC    C' ZA02191'              LAST SHIP CODE         @ZA02191 16070003
         DC    C' 7/29/75'              LAST DATE MODIFIED     @ZA02191 16080003
AROUND   DS    0H                                                Y02072 16090002
*                                                                       16092002
         L     RDCB,0(RPARC)            LOAD CURRENT DCB ADDR           16100000
         L     RCORE,4(RWTGC)           LOAD CURRENT WORK AREA ADDR     16200000
         L     RDEB,DCBDEBAD            LOAD DEB ADDR                   16300000
         L     RUCB,DEBUCBAD            LOAD UCB ADDR                   16400000
         DROP  RDEB                                              Y02072 16450002
*                                                                       16500000
*                                                                       16503020
*********************************************************************** 16504020
*                                                                       16505020
*   THIS ROUTINE TESTS FLAG BYTES SET BY IT OR 1U TO DETERMINE WHAT     16506002
*   ACTIONS ARE TO BE TAKEN BY THIS MODULE                              16507002
*                                                                       16508020
*********************************************************************** 16509020
*                                                                       16510020
         CLI   DXSTAGE2,0               IF NOT ZERO, ENTRY IS TO Y02072 16512002
*                                         XCTL TO 2ND STAGE EXEC Y02072 16514002
*                                         (COMPOSITE CONSOLES)   Y02072 16514402
         BNE   TSTEXCP                  GO XCTL TO 2ND STG EXEC  Y02072 16516002
         CLI   DXABEND,ABEND            ABEND SWITCH ON          Y02072 16516402
         BE    ABENROUT                 GO SET ABEND CODE        S20202 16518020
*                                                                       16528020
*********************************************************************** 16529020
*                                                                       16530020
*   LOAD UCS IMAGE FROM SYS1.IMAGELIB                                   16531020
*                                                                       16532020
*********************************************************************** 16533020
*                                                                       16534020
         LA    RE,DXBLDLIM              LOAD BLDL LIST ADDR      Y02072 16534402
*                                                                       16536020
         L     RF,DXIMGDCB              GET ADDR OF IMAGELIB     Y02072 16536403
*                                       DCB                      S20202 16538020
*                                                                       16539020
         LOAD  DE=(0),DCB=(1)           LOAD UCS SET FROM        S20202 16540020
*                                       SYS1.IMAGELIB            S20202 16541003
*                                                                       16542020
         LR    RB,RE                    RETAIN LOAD ADDR IN REG. S20202 16543020
*                                       RB                       S20202 16544020
         MVC   DXSAVUCS,DXBLDLIM        SAVE UCS IMAGE NAME      Y02072 16546402
         OI    FCAOPEN2,FCAOUCSL        INDIC UCS IMAGE LOADED   YM4697 16596402
*                                                                       16600000
*********************************************************************** 16700000
*                                                                       16800000
*   SET UP DXCCW1 FOR EXCP TO LOAD UCSB                          Y02072 16900002
*                                                                       17000000
*********************************************************************** 17100000
*                                                                       17200000
         MVI   IOBFLAG1,UNRLMASK        SET IOBFLAG= C.C/UNRELATED 'ON' 17300000
         XC    DXCCW1(16),DXCCW1        RESET CCW AREA TO X'00'         17400000
*                                                                       17800000
*                                                                       18200000
*********************************************************************** 18300000
*                                                                       18400000
*   WHEN UCS IS TO BE LOADED, BUILD CCWS IN WORK AREA                   18500003
*                                                                       18600000
*********************************************************************** 18700000
*                                                                       18800000
         LA    RC,TWOMASK               LOAD NUMBER OF RETRIES   S20202 18900020
*                                                                       19000000
*      WE NOW MUST GET INTO PROTECTION KEY ZERO TO ACCESS THE UCS       19020003
* IMAGE BECAUSE THE USER MAY HAVE LINK EDITED IT INTO SYS1.IMAGELIB     19040003
* WITHOUT THE 'RENT' ATTRIBUTE, AND IT THEREFORE HAS BEEN LOADED        19060003
* INTO VIRTUAL STORAGE IN THE USER'S KEY ACCORDING TO TCBPKF.  IT       19080003
* WOULD BE FETCH PROTECTED.                                             19100003
         MODESET EXTKEY=SUPR           GET INTO PROT.KEY ZERO  @ZA02191 19120003
         SR    RF,RF                   PREPARE TO GET LINE NUM @ZA02191 19160003
         IC    RF,1(RB)                GET NUM OF VERIFY LINES @ZA02191 19180003
         LA    RE,2(RF,RB)             PT TO REAL UCS IMAGE    @ZA02191 19184003
*                                                                       19200000
*********************************************************************** 19201020
*                                                                       19202020
*   DETERMINE WHICH CCW CHAIN IS TO BE GENERATED TO LOAD THE UCS        19203020
*   (1) FOR 1403/2821 THE SEQ IS A GATE LOAD FOLLOWED BY A LOAD OR      19204020
*       LOAD AND FOLD.                                                  19205020
*   (2) FOR 3211/3811 THE SEQUENCE IS A LOAD FOLLOWED BY A FOLD OR      19206020
*       JUST A LOAD COMMAND                                             19207020
*                                                                       19208020
*********************************************************************** 19209020
*                                                                       19210020
         CLI   UCBTBYT4,PRTM3211        CK IF DCB BEING OPENED   S20202 19211020
*                                       FOR 321                  S20202 19212020
         BNE   GOCNSTGL                 NO GO CONSTRUCT GATE     S20202 19213020
*                                       LOAD SEQ.                S20202 19214020
*                                       YES FALLS THROUGH TO FORM LOAD  19215020
*                                       OR LOAD AND FOLD CCW'S          19216020
*                                                                       19217020
*                                                                       19226020
*   BUILD CCW'S TO LOAD UCS BUFFER FOR 3211/3811                        19227020
*                                                                       19228020
         ST    RE,DXCCW1                STORE ADDRESS OF IMAGE   S20202 19229020
*                                       IN CCW                   S20202 19230020
         MVI   DXCCW1,UCSLDCC           MOVE LOAD UCS COMMAND CD S20202 19231020
*                                       TO CC                    S20202 19232020
         MVC   DXCCW1+K6(K2),UCSLTHEX   MOVE LENGTH OF UCS TO    S20202 19233020
*                                       CCW                      S20202 19234020
         MVI   DXCCW1+K4,SILIMASK       SET CCW FLAGS FOR CC AND S20202 19235020
*                                       SILI                     S20202 19236020
*                                                                       19236402
*  FORM CCW TO FOLD OR UNFOLD UCS IMAGE SM5451                          19236802
*                                                                       19236902
         MVI   DXCCW2+7,NONZERO         NON-ZERO COUNT TO CCW    SM5451 19239002
         MVI   DXCCW2+4,SILIMSK         SET SILI FLAG            SM5451 19241002
         MVI   DXCCW2,UCSFLDCC          ASSUME FOLDING OF IMAGE  SM5451 19243002
         TM    DXUCSOPT,FOLDMASK        CK IF FOLD SPEC FOR      Y02072 19243102
*                                       UCS                      S20202 19245402
         BO    EXCPGOGO                 YES, GO ISSUE EXCP TO    SM5451 19247402
*                                         LOAD + FOLD IMAGE      SM5451 19247602
         MVI   DXCCW2,UCSUNFLD          NO, RESET COM CODE TO    SM5451 19247702
*                                         UNFOLD IMAGE           SM5451 19247802
         B     EXCPGOGO                 GO ISSUE EXCP TO LOAD    SM5451 19247902
*                                                                       19285302
*   BUILD CCW'S TO LOAD UCS BUFFER FOR PRINTERS USING 2821 CONTROL UNIT 19287402
*                                                                       19289502
GOCNSTGL EQU   *                                                 S20202 19291602
*                                                                       19293702
*   CONSTRUCT CONTROL COMMAND                                           19295802
*                                                                       19297902
         MVI   DXCCW1,CNTRLMSK          COMMAND CODE = GATE LOAD        19300000
         MVI   DXCCW1+4,SILIMASK        SET SILI AND C.C ON             19400000
         MVI   DXCCW1+7,ONEMASK         SET LENGTH=X'01'                19500000
*                                                                       19800000
*   CONSTRUCT LOAD COMMAND                                              19900000
*                                                                       20000000
         MVI   DXCCW2+7,UCSLNGTH        MOVE UCS IMAGE LENGTH = 240     20100000
*                                                                       20200000
         ST    RE,DXCCW2                STORE UCS ADDR IN CCW           20900003
*                                                                       21000000
         MVI   DXCCW2,UNFLCCW           COMMAND CODE = LOAD UCS,UNFOLD  21100000
*                                                                       21200000
         TM    DXUCSOPT,FOLDMASK        TEST IF FOLD IS SPEC     Y02072 21250002
         BC    14,EXCPGOGO              IF NOT,GOTO EXCP ROUTINE        21400000
*                                                                       21500000
         MVI   DXCCW2,FLDCCW            COMMAND CODE = LOAD UCS,FOLD    21600000
*                                                                       21700000
EXCPGOGO EQU   *                                                        21800000
*                                                                       21900000
         L     RF,UCBXTADR              LOAD UCB EXTENSION ADDR  M0092  21910021
         MVC   UCBUCSID-UCBUCSID(4,RF),DXUCSID   PUT UCS IMAGE ID       21922003
*                                       IN UCB EXTENSION AREA           21930003
         LA    RF,DXIOB                 LOAD IOB ADDR IN REG.1          22000000
         EXCP  (1)                                                      22100000
*                                                                       22200000
         WAIT  ECB=DXECB                WAIT ON THE ABOVE EXCP          22400003
*                                                                       22500000
         CLI   DXECB,X'7F'              TEST COMP CODE OF ABOVE EXCP    22600000
         BC    8,UCSVRFY                IF YES,GOTO TEST VERIFY OPTION  22700000
*                                                                       22800000
*********************************************************************** 22900000
*                                                                       23000000
*   IF ERROR ,REPEAT UCS LOAD EXCP ONE TIME                             23100020
*                                                                       23200000
*********************************************************************** 23300000
*                                                                       23400000
         BCT   RC,EXCPGOGO              IF ERROR REPEAT ONCE     S20202 23500020
*                                                                       23600000
*********************************************************************** 23700000
*                                                                       23800000
         MODESET EXTKEY=DATAMGT         GET BACK IN OUR KEY    @ZA02191 23900003
*                                                                       24000000
*********************************************************************** 24100000
*                                                                       24200000
*   WHEN THERE WAS AN I/O ERROR DURING LOAD UCS,UPDATE UCB WITH X'00'   24300000
*   TO SHOW NO IMAGE IN THE BUFFER.RETURN CODE = X'0C' IN REG.15        24400000
*   WTO 'IEC126I XXX UCS PARITY ERROR.COMP CODE=B13' TO AN OPERATOR     24500000
*   RUN C.E. DIAGNOSTICS FOR THE UCS FEATURE.                           24600000
*   +280(REG.4) POINTS TO THE IOB USED FOR THE EXCP ABOVE.              24700000
*                                                                       24800000
*********************************************************************** 24900000
         LA    RWK3,MSG126              MESSAGE NO FOR MSG RTN   Y02072 24910002
         BAL   RWK6,GETMSG              GO GET MESSAGE           Y02072 24920002
         LA    RF,MSGLSTSZ              LOAD WTO ADDR                   25400000
         SVC   35                       ISSUE WTO SVC                   25500000
*                                                                       25600000
         LA    RB,OABD069               INTERNAL CODE 69         S21042 25700021
*                                                                       25800000
         BC    15,UPUCBEND              GOTO UPDATE UCB WITH X'00'      25900000
*                                                                       26000000
*********************************************************************** 26100000
*                                                                       26200000
UCSVRFY  EQU   *                                                        26300000
*                                                                       26400000
*********************************************************************** 26500000
*                                                                       26600000
*   TEST IF VERIFY OPTION IS SPECIFIED.                                 26700000
*                                                                       26800000
*********************************************************************** 26900000
*                                                                       27000000
         MODESET EXTKEY=DATAMGT         GET BACK IN OUR KEY    @ZA02191 27020003
         TM    DXUCSOPT,VERIFY          TEST IF VERIFY IS SPEC   Y02072 27050002
         BC    K8,UPDTUCB               IF NO GO UPDATE UCB-UCS  S20202 27110002
*                                       FIELDS                   S20202 27120020
*                                                                       27130020
*   VERIFY SPECIFIED GO LOAD ADDRESS IGG0197U AND XCTL                  27140020
*                                                                       27150020
*                                                                       27160020
         LA    RF,MODNM7U               LOAD ' MOD IGG0197U      S20202 27200020
         B     MVEIDTTR                 GO TO WTG SEQUENCE       S20202 27210020
*                                                                       27300000
*********************************************************************** 27400000
*                                                                       27500000
UPDTUCB  EQU   *                                                        27600000
*                                                                       27700000
*********************************************************************** 27800000
*                                                                       27900000
*   UPDATE UCB - UCS FIELDS                                             28000000
*                                                                       28100000
*********************************************************************** 28200000
*                                                                       28300000
         L     RJ,UCBXTADR              GET ADDRESS OF UCB       S20202 28350020
*                                       EXTENTION                S20202 28400020
         MODESET  EXTKEY=SUPR           GET INTO SUPER KEY       Y02072 28410002
         SPACE                                                          28420002
         MVC   UCSOPOFS(1,RJ),DXUCSOPT  MVOE UCS OPTION BITS     Y02072 28510002
*                                       TO UCB                   S20202 28600020
         OC    UCSOPOFS(K1,RJ),NULL(RB) SET DEFAULT BIT IF ANY   S20202 28650020
         NI    UCSOPOFS(RJ),RESETMSK    RESET VERIFY IF ANY      S20202 28700020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 28750002
*                                                                       30178020
*********************************************************************** 30200000
*                                                                       30300000
*   DELETE UCS IMAGE                                                    30400000
*                                                                       30500000
*********************************************************************** 30600000
*                                                                       30700000
         LA    RE,DXSAVUCS              LOAD ADDR OF ENTRY PT    Y02072 30750002
*                                                                       30900000
         DELETE EPLOC=(0)               DELETE UCS IMAGE                31000000
         NI    FCAOPEN2,X'FF'-FCAOUCSL  INDIC IMAGE DELETED      YM4697 31050002
*                                                                       31100000
*********************************************************************** 31200000
*                                                                       31510020
UCSEXIT  EQU   *                                                 S20202 31520020
*                                                                       31530020
         CLI   UCBTBYT4,PRTM3211        IF NOT 3211, GO TO 2ND   Y02072 31530402
*                                         STAGE EXECUTOR         Y02072 31530802
         BNE   RESTERPT                 GO RESTORE DCB EROPT     Y02072 31531202
         MVI   DXFLAG1,0                RESET FCB SW TO BE USED  Y02072 31532002
*                                       BY IGG0197E                     31560002
         TM    DXFCBSW1,IEC129RQ        CK IF IEC129 MSG REQ     Y02072 31582002
         BNO   XCTL197E                 NO GO LOAD FCB IMAGE IN  S20202 31670003
*                                       IGG0197E                 S20202 31680002
*                                                                       31690020
**********************************************************************  31700020
*                                                                       31710020
*        ISSUE MESSAGE IEC129 AND XCTL TOIGG0197E                       31720020
*                                                                       31730020
**********************************************************************  31740020
*                                                                       31750020
         LA    RWK3,MSG129              MESSAGE NO FOR MSG RTN   Y02072 31810002
         BAL   RWK6,GETMSG              GO GET MESSAGE           Y02072 31820002
         XC    RPLY(24),RPLY           CLEAR REPLY AREA AND ECB  M5143  31830020
*                                       COMPLETE                 S20202 31860020
         LA    RF,REPLYLTH              GET ADDR FOR WTOR        S20202 31870020
         SVC   K35                      ISSUE WTOR IEC129        S20202 31880020
*                                                                       31890020
XCTL197E EQU   *                                                 S20202 31900020
*                                                                       31910020
         LA    RF,MODNM7E               GET IDTTR ADDR OF        S20202 31920020
*                                       IGG0197E                 S20202 31930003
         B     MVEIDTTR                 GO TO WTG SEQ            S20202 31940020
*********************************************************************** 32060020
*                                                                       32070020
*   RESTORE DCB EROPT                                                   32080020
*                                                                       32090020
*********************************************************************** 32100020
*                                                                       32110020
RESTERPT EQU   *                                                 S20202 32120020
*                                                                       32130020
         MVC   DXCCW6(1),DXEROPT        MOVE IN DCB EROPT        Y02072 32164002
*                                                                       32180020
*                                                                       32190020
*   SEE IF SYS1.IMAGELIB HAS BEEN OPENED IF YES CLOSE IT                32200020
*                                                                       32210020
         CLI   DXIMGDCB,IMCLOSED        CK IF IMAGELIB CLOSED    Y02072 32212003
         BE    TSTEXCP                  IF NOT GO TEST IF EXCP   S20202 32230020
*                                       SPECIFED                 S20202 32240003
*                                                                       32250020
         L     RF,DXIMGDCB              GET ADDR OF IMAGELIB     Y02072 32252003
*                                       DCB                      S20202 32270020
         SVC   105                      ISSUE SVC TO CLOSE       S20202 32280020
*                                       SYS1.IMAGEL              S20202 32290020
         NI    FCAOPEN2,X'FF'-FCAOIMGL  INDIC IMAGELIB CLOSED    YM4697 32340002
*                                                                       32500000
*********************************************************************** 32600000
*                                                                       32700000
*   DETERMINE THE NEXT STAGE 2 EXECUTOR TO BE XCTLED                    32800000
*                                                                       32900000
*********************************************************************** 33000000
*                                                                       33100000
TSTEXCP  EQU   *                                                        33200000
*                                                                       33300000
*********************************************************************** 33400000
*                                                                       33500000
*   TEST IF EXCP IS SPECIFIED.IF YES,XCTL TO THE LAST OPEN EXECUTOR     33600000
*                                                                       33700000
*********************************************************************** 33800000
*                                                                       33900000
         TM    DCBMACRF,EXCPMASK        TEST IF EXCP IS SPECIFIED       34000000
         BC    14,TSTBLKBF              IF NOT,GOTO BUFFER CNTRL BLK    34100000
*                                                                       34200000
         LA    RF,MODNM11               GO DO DCB COPY BACK      Y02072 34210002
         BC    15,MVEIDTTR              GOTO WTG TABLE UPDATE    Y02072 34400002
*                                                                       34500000
*********************************************************************** 34600000
*                                                                       34700000
TSTBLKBF EQU   *                                                        34800000
*                                                                       34900000
*********************************************************************** 35000000
*                                                                       35100000
*   TEST IS BUFFER CONTROL BLOCK IS SPECIFIED.IF YES,XCTL TO IGG0911I   35200000
*                                                                       35300000
*********************************************************************** 35400000
*                                                                       35500000
         TM    DCBBUFNO+3,BFCNTRL       BUFFER CONTROL BLOCK SPECIFIED  35600000
         BC    14,TSTPCI                IF YES,GOTO TEST PCI ROUTINE    35700000
*                                                                       35800000
         CLI   DCBBUFNO,0               SEE IF BUFFER POOL REQUESTED    36000003
         BE    TSTPCI                   IF YES, GO TO TEST CH. SCHED.   36200003
*                                                                       36300000
         LA    RF,MODNM1I               LOAD ADDR OF IDTTR OF IGG0191I  36400000
         BC    15,MVEIDTTR              GOTO MOVE IDTTR ROUTINE         36500000
*                                                                       36600000
*********************************************************************** 36700000
*                                                                       36800000
TSTPCI   EQU   *                                                        36900000
*                                                                       37000000
*********************************************************************** 37100000
*                                                                       37200000
*   TEST IF CHAINED SCHEDULING IS REQUESTED.  IF YES, XCTL TO IGG0191Q. 37300003
*                                                                       37400000
*********************************************************************** 37500000
*                                                                       37600000
         TM    DCBOPTCD,PCIMASK         TEST IF CHAINED SCHED.REQUESTED 37700003
         BC    14,BQSAMOUT              IF NOT,GOTO BSAM/QSAM ROUTINE   37800003
*                                                                       37900000
         LA    RF,MODNM1Q               LOAD ADDR OF IDTTR OF IGG0191Q  38000000
         BC    15,MVEIDTTR              GOTO MOVE IDTTR ROUTINE         38100000
*                                                                       38200000
*********************************************************************** 38300000
*                                                                       38400000
BQSAMOUT EQU   *                                                        38500000
*                                                                       38600000
*********************************************************************** 38700000
*                                                                       38800000
*   BSAM/QSAM EXIT.XCTL TO IGG0191G                                     38900000
*                                                                       39000000
*********************************************************************** 39100000
*                                                                       39200000
         LA    RF,MODNM1G               LOAD ADDR OF IDTTR IF IGG0191G  39300000
*                                                                       39400000
*********************************************************************** 39500000
*                                                                       39600000
MVEIDTTR EQU   *                                                        39700000
*                                                                       39800000
*********************************************************************** 39900000
*                                                                       40000000
*   MOVE IDTTR TO XCTL WTG TABLE                                        40100000
*                                                                       40200000
*********************************************************************** 40300000
*                                                                       40400000
         USING WTGENTRY,RWTGC                                    Y02072 40450002
         MVC   WTGIDTTR,0(RF)         ST NEXT MODULE ID IN WTG @Z30TSCF 40460003
*                                                                       40600000
*********************************************************************** 40700000
*                                                                       40800000
RELOOP   EQU   *                                                        40900000
*                                                                       41000000
*********************************************************************** 41100000
*                                                                       41200000
*   UPDATE WTG TABLE AND XCTL TO NEXT MODULE                            41300000
*                                                                       41400000
*********************************************************************** 41500000
*                                                                       41600000
         LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURRENT WTG ENTRY     41700000
         LA    RPARC,PLOFF(0,RPARC)     INCREMENT CURRENT DCB ENTRY     41800000
         CLC   0(2,RWTGC),AMIDCNST      IS THE RTN NEEDED AGAIN         41900000
         BCR   8,RBASE                  IF YES,RETURN TO PROCESS        42000000
*                                                                       42100000
         CLC   0(2,RWTGC),OPIDCNST      TEST END OF WTG TABLE           42200000
         BC    7,RELOOP                 IF NOT,CHECK NEXT ENTRY         42300000
*                                                                       42400000
         LR    RPARC,RPAR               RESET REG TO '0'                42500000
         LA    RWTGC,WAOFF(0,RWTG)      RESET WTG REG TO POINT +32(WTG) 42600000
ZCHECK   CLI   0(RWTGC),X'00'           TEST IF THIS ENTRY COMPLETE     42700000
         BC    7,TCTLRTN                IF NOT,XCTL                     42800000
*                                                                       42900000
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY OF WTG TABLE     43000000
         LA    RPARC,PLOFF(0,RPARC)     GET NEXT ENTRY OF DCB           43100000
         B     ZCHECK                   GO CHECK NEXT ENTRY      XM5898 43150001
TCTLRTN  EQU   *                                                        43498801
*                                                                       43500000
         USING WTG,RWTG                                                 43550003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*43600003
               MODID=WTGENTRY                                  @Z30TSCF 43650003
         DROP  RWTGC,RWTG                                      @Z30TSCF 43700003
*                                                                       44200000
*   IF THE I/O ERROR PERSISTS,RUN C.E. DIAGNOSTICS ON THE PRINTER       66100000
*                                                                       66200000
*********************************************************************** 66300000
*                                                                       66400000
*                                                                       66710020
ABENROUT EQU   *                                                 S20202 66720020
*                                                                       66730020
         SR    RB,RB                    ZERO OUT REG 12          S20202 66740020
         IC    RB,DXABRETC              PUT COMP CODE INTO       Y02072 66742002
*                                       REG 1                    S20202 66760020
         B     ABENDRTN                 GO TO ABEND ROUTINE      S20202 66770020
*********************************************************************** 66800000
*                                                                       66900000
*                                                                       68100000
*********************************************************************** 68200000
*                                                                       68300000
UPUCBEND EQU   *                                                        68400000
*                                                                       68500000
*********************************************************************** 68600000
*                                                                       68700000
*   UPDATE THE UCB WITH X'00' TO INDICATE THAT THE IMAGE IN THE BUFFER  68800000
*   IS NOT USABLE                                                       68900000
*                                                                       69000000
*********************************************************************** 69100000
*                                                                       69200000
         L     RJ,UCBXTADR              GET ADDRESS OF UCB       S20202 69250020
*                                       EXTENTION                S20202 69300020
         MODESET  EXTKEY=SUPR           GET INTO SUPER KEY       Y02072 69310002
         SPACE                                                          69320002
         USING UCBUCS,RJ                                         Y02072 69330002
         XC    UCBUCSID,UCBUCSID        CLR UCS IMAGE ID         Y02072 69344002
         NI    UCBUCSOP,PARITYER        LEAVE PAR ER BIT ON      Y02072 69346002
*                                         IF ON                  Y02072 69348002
         DROP  RJ                                                Y02072 69358002
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 69360002
*                                                                       71100000
*********************************************************************** 71200000
*                                                                       71300000
*   DELETE THE UCS IMAGE LOADED                                         71400000
*                                                                       71500000
*********************************************************************** 71600000
*                                                                       71700000
         LA    RE,DXSAVUCS              LOAD ADDR OF IMAGE ID    Y02072 71750002
         DELETE EPLOC=(0)                                               71900000
         NI    FCAOPEN2,X'FF'-FCAOUCSL  INDIC UCS IMAGE DELETED  YM4697 71950002
*                                                                       72000000
*********************************************************************** 72100000
*                                                                       72200000
ABENDRTN EQU   *                                                        72300000
*                                                                       72400000
*********************************************************************** 72500000
*                                                                       72600000
*   ABEND ROUTINE.COMPLETION CODE=B13.RETURN CODE IS IN REG15.          72700000
*                                                                       72800000
*********************************************************************** 72900000
*                                                                       73000000
         TM    DXNABEND,ABENDBIT         TEST IF ABEND IN CNTRL  Y02072 73050002
         BC    1,UCSEXIT                IF YES,GOTO EXIT ROUTINE        73200000
*                                                                       73300000
         L     RWK3,DXREG9              SAVE DCB ADDRESS       @ZA04647 73350003
         DMABCOND (RB),PDLOAD,RETURN=NONE,RES=NO,REGSAVE=YES     S21042X73400021
                                        XCTL TO PROBLEM DETERMINATION   73500021
         B     TCTLRTN                                           S21042 73600021
         EJECT                                                          73650002
*********************************************************************** 73700002
*  'GETMSG' SUBROUTINE                                           Y02072 73750002
*  THIS SUBROUTINE EXTRACTS THE REQUIRED MESSAGE FROM THE MSG    Y02072 73800002
*  CSECT AND MOVES IT TO THE WTO/WTOR AREA.                      Y02072 73850002
*                                                                       73860002
*    INPUT TO THIS ROUTINE:                                      Y02072 73870002
*      REG 9 - MESSAGE NUMBER IN CSECT                           Y02072 73880002
*      REG 11 - RETURN ADDRESS                                   Y02072 73890002
*                                                                       73892002
*    OUTPUT FROM THIS ROUTINE:                                   Y02072 73894002
*      MESSAGE TEXT IN WTO/WTOR AREA                             Y02072 73898002
*********************************************************************** 73898402
GETMSG   EQU   *                        ENTRY POINT, MSG RTN     Y02072 73898802
         L     RWK7,DXMSGADR            GET ADDR OF MSG CSECT    Y02072 73899202
         LH    RWK2,0(RWK7,RWK3)        GET INDEX TO MESSAGE     Y02072 73899602
         LA    RWK2,0(RWK7,RWK2)        ADDR OF MESSAGE ENTRY    Y02072 73899702
         USING MSGENTRY,RWK2                                     Y02072 73899802
         SR    RWK3,RWK3                PREPARE REGISTER         Y02072 73899902
         IC    RWK3,MSGOFF              GET OFFSET TO TEXT IN    Y02072 73933202
*                                         ENTRY                  Y02072 73943202
         LA    RWK3,0(RWK2,RWK3)        ADDR OF MESSAGE TEXT     Y02072 73953202
         USING MSGTXTD,RWK3                                      Y02072 73963202
         SR    RWK7,RWK7                PREPARE REG FOR RETURN   Y02072 73965202
         IC    RWK7,MSGLNG              LEN OF MSG - 1           Y02072 73965602
         EX    RWK7,MVCINST             MOVE MESSAGE TO AREA     Y02072 73966002
         IC    RWK7,MSGOFF1             OFFSET TO FIRST VAR FLD  Y02072 73966102
         LA    RWK3,MSGAREA(RWK7)       ADDRESS OF FIRST VAR FLD Y02072 73966202
         MVC   0(L'UCBNAME,RWK3),UCBNAME  MOVE DEV NAME TO MSG   Y02072 73966302
         BR    RWK6                     RETURN                   Y02072 73966402
MVCINST  MVC   MSGAREA(0),MSGTXT        EXECUTED BY A EX INST    Y02072 73966502
         EJECT                                                          73966602
*                                                                       73966702
*********************************************************************** 74000000
*                                                                       74100000
*********************************************************************** 74200000
*                                                                       74300000
*   CONSTANTS                                                           74400000
*                                                                       74500000
*********************************************************************** 74600000
*                                                                       74700000
*   FOR WTG TABLE                                                       74800000
*                                                                       74900000
OPIDCNST DC    C'0S'                                                    75000000
AMIDCNST DC    C'1V'                                                    75100000
UCSLTHEX DC    X'0200'                  UCS LENGTH CONSTANT =    S20202 76660020
*                                       512                      S20202 76960020
*                                                                       77300000
*********************************************************************** 77400000
*                                                                       77500000
*   XCTL TABLE                                                          77600000
*                                                                       77700000
*********************************************************************** 77800000
*                                                                       77900000
MODNM1G  DC    C'1G',VL3(IGG0191G)      MOD IGG0191G           @Z30TSCF 77950003
MODNM1I  DC    C'1I',VL3(IGG0191I)      MOD IGG0191I           @Z30TSCF 77960003
MODNM1Q  DC    C'1Q',VL3(IGG0191Q)      MOD IGG0191Q           @Z30TSCF 77972003
MODNM7E  DC    C'7E',VL3(IGG0197E)      MOD IGG0197E           @Z30TSCF 77980003
MODNM7U  DC    C'7U',VL3(IGG0197U)      MOD IGG0197U           @Z30TSCF 77992003
MODNM11  DC    C'11',VL3(IGG01911)      MOD IGG01911           @Z30TSCF 77994003
PDLOAD   DC    C'6M',VL3(IGG0196M)      MOD IGG0196M           @Z30TSCF 77996003
         SPACE                                                          77998002
PATCH    DC    0H'0',50X'00'            PATCH AREA               Y02072 78048002
END      EQU   *                        END OF MODULE            Y02072 78148002
*                                                                       79200000
*   DSECT                                                               79300000
*                                                                       79400000
*********************************************************************** 79500000
*                                                                       79600000
*                                                                       79700000
         DCBD  DSORG=PS,DEVD=PR         MAP A PRINTER DCB               79800003
*                                                                       79900000
*********************************************************************** 80000000
*                                                                       80100000
         EJECT                                                          80150002
CVT      DSECT                                                 @Z30TSCF 80160003
         CVT                                                   @Z30TSCF 80170003
         EJECT                                                          80172003
         IECDSECS MAIN,EXPAND=YES                                S21042 80180021
         ORG   REPLYLTH+52                                       A33665 80340020
RPLY     DS    20C                                               A33665 80380020
RPLYECB  DS    F                                                 A33665 80420020
MCSMASK  DS    H                                                 A33665 80460020
LOMASK   DS    8C                                                A33665 80500020
UCSID    DS    4C                                                A33665 80540020
         ORG   MSGLSTSZ                                          Y02072 80590002
MSGAREA  DS    0CL64                    AREA TO MOVE 64 BYTES    Y02072 80592002
*                                         TO FOR WTO/WOTR'S      Y02072 80594002
*                                                                       80600000
         EJECT                                                          80610002
         IGGSCW                                                  Y02072 80620002
         EJECT                                                          80630002
         IHAFCAUD  ORG=YES                                       YM4697 80640002
         EJECT                                                          80650002
         IECDSECS  WTG,PREFX,EXPAND=YES                        @Z30TSCF 80660003
         ORG   WTGIDTTR                                          Y02072 80662002
WTGID    DS    CL2                      NEXT MOD ID              Y02072 80664002
         EJECT                                                          80670002
         IGGMSG                                                  Y02072 80680002
*********************************************************************** 80700000
*                                                                       80800000
SRT      DSECT                                                          80900000
         IEFUCBOB                                                       81000000
*                                                                       81100000
*********************************************************************** 81200000
*                                                                       81300000
*   DATA EXTENT BLOCK  (UNTIL PROTIOS CHANGES)                          81400000
DEB      DSECT                                                          81500000
DEBNMSUB DS    0CL1                                                     81600000
DEBTCBAD DS    CL4                                                      81700000
DEBAMLNG DS    0CL1                                                     81800000
DEBDEBAD DS    CL4                                                      81900000
DEBOFLGS DS    0CL1                                                     82000000
DEBIRBAD DS    CL4                                                      82100000
DEBOPATB DS    0CL1                                                     82200000
DEBSYSPG DS    CL4                                                      82300000
DEBNMEXT DS    0CL1                                                     82400000
DEBUSRPG DS    CL4                                                      82500000
DEBPRIOR DS    0CL1                                                     82600000
DEBECBAD DS    CL4                                                      82700000
DEBPROTG DS    0CL1                                                     82800000
DEBDEBID DS    0CL1                                                     82900000
DEBDCBAD DS    CL4                                                      83000000
DEBEXSCL DS    0CL1                                                     83100000
DEBAPPAD DS    CL4                                                      83200000
DEBDVMOD DS    0CL1                                                     83300000
DEBUCBAD DS    CL4                                                      83400000
DEBTVLSQ DS    0CL2                VOL SEQ FOR TAPE                     83500000
DEBBINUM DS    CL2                                                      83600000
DEBTVLNM DS    0CL2                NO OF VOL FOR TAPE                   83700000
DEBSTRCC DS    CL2                                                      83800000
DEBSTRHH DS    CL2                                                      83900000
DEBENDCC DS    CL2                                                      84000000
DEBENDHH DS    CL2                                                      84100000
DEBNMTRK DS    CL2                                                      84200000
*  FOR ADDITIONAL EXTENT ON DIRECT ACCESS THE FOLLOWING FIELDS          84300000
*  WILL HAVE TO BE OFFSET ANOTHER 16 BYTES                              84400000
DEBVOLSQ DS    H                                                        84500000
DEBVOLNM DS    H                                                        84600000
*  FOR EACH SUBROUTINE LOADED BUMP THIS OFFSET BY 2                     84700000
DEBSUBID DS    H                                                        84800000
*                                                                       84900000
         END                                                            85200000
