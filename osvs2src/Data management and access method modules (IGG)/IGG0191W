         TITLE ' IGG0191W OUTPUT DA EXECUTOR FOR PCI SCHEDULING'        00008020
IGG0191W CSECT                                                          00016020
*MODULE NAME - IGG0191W                                          Y02072 00016402
*                                                                       00016802
*DESCRIPTIVE NAME - BUILD IOBS                                   Y02072 00017202
*                                                                       00017602
*COPYRIGHT - NONE                                                Y02072 00017702
*                                                                       00017802
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00017902
*                                                                       00018002
*          VS2 RELEASE 2 DELETIONS                                      00018402
*000550,011000,052200,068940-069000,077200,119600,122800-124000, Y02072 00020002
*139780,149814,154200-154400,161200,000260-000377,000440-000500  Y02072 00022002
*56500,129071,129306,133200,134800                               Y02072 00032002
*                                                                YM2396 00034002
*                                                                YM2424 00036002
*                                                                YM4697 00036402
*                                                                YM5373 00036802
*                                                                YM6583 00036902
*                                                                YM7595 00037502
*                                                                       00037903
*          VS2 RELEASE 3 DELETIONS                                      00039403
*                                                              @Z30TSCF 00041403
*          RELEASE 20 DELETIONS                                         00041503
*0000064200                                                      M6190  00043003
*0000002800,052600,058600,058720,059380,064400,064800,066400-    M5725  00044503
*0000066600,068760,070200,070600-071000,071600-072000,073200,    M5725  00046003
*0000075800,075920,076000,077600,084200,103900,105400,111500,    M5725  00047503
*0000128880-129080,136600-138350,142000-143800,146400,146600-    M5725  00049003
*0000147600,155000-160400                                        M5725  00050503
*          RELEASE 21 DELETIONS                                         00052003
*                                                                       00053503
*STATUS CHANGE LEVEL 002                                                00055002
*FUNCTION/OPERATION -- THIS EXECUTOR BUILDS THE MAIN IOB & ICBS THAT    00060020
*                      WILL CONTROL THEIR ASSOCIATED CHANNEL PROGRAMS.  00080020
*                      IT ALSO CONSTRUCTS INPUT OR OUTPUT CHANNEL PROG. 00100020
*                      AND FILLS IN DEVICE DEPENDANT FIELDS IN THE DCB. 00120020
*                      FOR QSAM THE CHANNEL PROGRAMS INCLUDE THE BUFFER 00140020
*                      ADDRESS,THE PHYSICAL BLOCK SIZE AND ASSC FLAGS.  00160020
*                      ALL ICBS ARE LINKED TOGETHER                     00180020
*                      THE GETMAIN MACRO IS USED TO OBTAIN SPACE FOR    00200020
*                      THE IOB & ICBS.                                  00220020
*                      IT SETS AN AUDIT TRAIL BIT IN THE OPEN    Y02072 00230002
*                      WORKAREA INDICATING TO FORCE CLOSE THAT   Y02072 00232002
*                      THE CORE GETMAINED FOR THE IOB'S CAN BE   Y02072 00234002
*                      FREEMAINED.                               Y02072 00236002
*                                                                       00260020
*ENTRY POINTS  -   ENTERED AT IGG0191W FROM LEVEL ONE                   00280020
*                      EXECUTOR IGG0191B VIA THE XCTL MACRO             00300020
*                                                                       00320020
*INPUT SUPPLIED-   USER DCB AND OPEN PARAMETERS -- SEE REGISTER USAGE   00340020
*                                                                       00360020
*OUTPUT GIVEN  -   MAIN IOB , ICBS AND CHANNEL PROGRAMS , DCB INITIAL   00380020
*                                                                       00400020
*                                                                       00420020
*EXTERNAL RTS. -   NONE                                                 00440020
*                                                                       00460020
*EXITS-NORMAL: XCTL TO IGG01910(IECOSLDA)    TO LOAD ROUTINES           00480020
*                                                                       00500020
*EXITS-ERROR: NONE.                                                     00520020
*                                                                       00540020
*MACROS - MAPPING : IECDSECS, IEZIOB, IEZDEB, IKJTCB, IHAICB,    Y02072 00550002
*                   IHACCW, DCBD, IHAFCAUD, IGGBCB               Y02072 00552002
*                                                                       00554002
*MACROS - ACTION : MODESET, GETMAIN, XCTL, XCTLTABL, DMABCOND    Y02072 00556002
*                                                                       00558002
*TABLES/WORKAREAS- WHERE TO GO TABLE (WTG)                              00560020
*                                                                       00580020
*      BYTE  0-7  NAME                                                  00600020
*      BYTE  8-10 RELATIVE DISK ADDRESS(TTR) OF FIRST RECORD            00620020
*      BYTE 11    CONCATENATION NUMBER                                  00640020
*      BYTE 12    ZERO                                                  00660020
*      BYTE 13    ALIAS INDICATOR AND USER DATA FIELD DESCRIPTOR.       00680020
*                        ALIAS INDICATOR 1 BIT                          00700020
*                        NUMBER OF TTRS IN USERS DATA FIELD 2 BITS      00720020
*      BYTE 14-16 TTR OF FIRST TEXT RECORD                              00740020
*      BYTE 17    ZERO                                                  00760020
*      BYTE 18-19 TTR OF NOTE LIST OR SCATTER LIST                      00780020
*      BYTE 20    TRANSLATION TABLE                                     00800020
*      BYTE 21    ZERO OR NUMBER OF ENTRIES IN THE NOTE LIST            00820020
*      BYTE 22-23 ATTRIBUTES                                            00840020
*      BYTE 24-26 TOTAL CONTIGUOUS MAIN STORAGE REQUIRED FOR MODULE     00860020
*      BYTE 27-28 LENGTH OF FIRST TEXT RECORD                           00880020
*      BYTE 29    LENGTH OF WTG TABLE (IN DOUBLE WORDS)                 00900020
*      BYTE 30-31 PATH THROUGH LOADS OF ROUTINES                        00920020
*      BYTE 32-34 IDTTR OF EXECUTOR FOR FIRST DCB                       00940020
*      BYTE 35    WORKAREA ADDRESS FOR FIRST DCB                        00960020
*      BYTE 36-39 TABLE OF IDTTR'S                                      00980020
*      BYTE 32+N(8) IDTTR OF EXECUTOR FOR  N TH DCB  (3 BYTES)          01000020
*                   WORKAREA ADDRESS FOR N TH DCB    (1 BYTE )          01020020
*                   IDTTR OF LAST ROUTINE LOAD       (3 BYTES)          01040020
*                   NOT USED                         (1 BYTE)           01060020
*                                                                       01080020
*ATTRIBUTES: REENTRANT, REUSABLE, RUNS IN DATA MANAGEMENT KEY    Y02072 01100002
*            UNLESS OTHERWISE SPECIFIED, SUPER STATE             Y02072 01120002
*                                                                       01140020
*********************************************************************** 01160020
*                                                                       01180020
*                                                                       01200020
*  REGISTER CONVENTIONS USED THROUGH OUT ALL OPEN PASSES                01220020
*                                                                       01240020
*********************************************************************** 01260020
*                                                                       01280020
RDCB     EQU   2         DCB REGISTER                                   01300020
RBASE    EQU   3         BASE REGISTER                                  01320020
RCORE    EQU   4         WORK AREA ADDRESS                              01340020
RPAR     EQU   5         TOP OF PARAMETER LIST                          01360020
RWTG     EQU   6         TOP OF WTG TABLE                               01380020
RPARC    EQU   7         CURRENT PARAMETER                              01400020
RWTGC    EQU   8         CURRENT TRANS LOAD                             01420020
RTIOT    EQU   9         USED HERE AS WRK REG AND  COMM VECTOR ADDR.    01440020
RUCB     EQU   10        USED HERE AS A COUNTER IN IOB GENERATION       01460020
RDEB     EQU   11        DEB ADDRESS                                    01480020
RWK2     EQU   RDEB                     WORK REGISTER            Y02072 01490002
RB       EQU   12        WORK REG1  **                                  01500020
RWK3     EQU   RB                       WORK REGISTER            Y02072 01510002
RC       EQU   13        WORK REG2  **  USED IN IOB GENERATION          01520020
RD       EQU   14        WORK REG3  **                                  01540020
RJ       EQU   15        WORK REG4                                      01560020
RBUFADR  EQU   RJ        BUFFER ADDRESS REGISTER                 YM7595 01575002
RE       EQU   0         WORK REG5                                      01580020
RF       EQU   1         WORK REG6                                      01600020
RWK6     EQU   RF                       WORK REGISTER            Y02072 01610002
*                                                                       01620020
*                                                                       01640020
PARAR    EQU   RPARC                                                    01660020
*                                                                       01680020
*********************************************************************** 01700020
*                                                                       01720020
*                                                                       01740020
*                                                                       01760020
*********************************************************************   01780020
* MASK'S TO TEST PARAMETER LIST WITH                                    01800020
INP      EQU   X'0F'                                                    01820020
OUTP       EQU   X'0F'                                                  01840020
UPDATE     EQU   X'04'                                                  01860020
INOUT      EQU   X'03'                                                  01880020
OUTIN      EQU   X'07'                                                  01900020
RDBACK     EQU   X'01'                                                  01920020
*                                                                       01940020
*                                                                       01960020
*********************************************************************   01980020
*                                                                       02000020
*                                                                       02020020
* OFFSET FOR PARAMETER TESTS                                            02040020
*                                                                       02060020
ONE        EQU   X'01'                                                  02080020
FRTYATE    EQU   48                                                     02100020
DISPSN     EQU   X'0'                                                   02120020
*                                                                       02140020
*                                                                       02160020
*********************************************************************   02180020
*                                                                       02200020
* OFFSETS FOR DEB REFERENCE                                             02220020
*                                                                       02240020
*                                                                       02260020
*                                                                       02280020
*                                                                       02300020
*                                                                       02320020
*********************************************************************   02340020
*                                                                       02360020
* MASK'S USED TO TEST OPTION FIELDS IN DCB                              02380020
*                                                                       02400020
*                                                                       02420020
*                                                                       02440020
DOUBLE     EQU   X'01'                                                  02460020
*                                                                       02480020
*                                                                       02500020
STOWB      EQU   X'80'                                                  02520020
WRTCK    EQU   X'80'                                                    02540020
OVRFLO     EQU   X'20'                                                  02560020
PCIB     EQU   X'20'                                                    02580020
MINKEY     EQU   X'01'                                                  02600020
CONCAT     EQU   X'FF'                                                  02620020
SRCHDIRB EQU   X'40'                                                    02640020
ONONYES  EQU   X'0C'                                                    02660020
*                                                                       02680020
*********************************************************************   02700020
*                                                                       02720020
* MASKS FOR ACCESS METHODS IN SAM                                       02740020
*                                                                       02760020
QSAMB      EQU   X'01'                                                  02780020
BSAMBIT    EQU   X'00'                                                  02800020
PAM        EQU   X'02'                                                  02820020
*                                                                       02840020
*                                                                       02860020
* MASKS FOR MACRO'S TO BE USED                                          02880020
*                                                                       02900020
GETB       EQU   X'40'                                                  02920020
PUTB       EQU   X'40'                                                  02940020
READB      EQU   X'20'                                                  02960020
WRITEB     EQU   X'20'                                                  02980020
POINTB     EQU   X'04'                                                  03000020
CNTRLB     EQU   X'02'                                                  03020020
*                                                                       03040020
*                                                                       03060020
*********************************************************************   03080020
*                                                                       03100020
* MASKS FOR DEVICES TO BE SUPPORTED                                     03120020
*                                                                       03140020
NORCDRY  EQU   X'20'                    NO RCD READY MASK               03160020
*                                                                       03180020
*********************************************************************   03200020
*                                                                       03220020
* MASKS FOR STATUS BITS TO BE TESTED                                    03240020
*                                                                       03260020
*                                                                       03280020
EXCPN      EQU   X'30'                                                  03300020
COMPLETE EQU   X'60'                                                    03320020
FIRSTIOB   EQU   X'01'                                                  03340020
IOBCEXCP EQU   X'80'                    IOBCNOPA FLAG            YM6583 03350002
*                                                                       03360020
*                                                                       03380020
*                                                                       03400020
*********************************************************************   03420020
*                                                                       03440020
* MASKS FOR BUFFER TECHNIQUE'S                                          03460020
*                                                                       03480020
EXCHANGB   EQU   X'10'                                                  03500020
SIMPLEB    EQU   X'40'                                                  03520020
*                                                                       03540020
*********************************************************************   03560020
*                                                                       03580020
*                                                                       03600020
* MODES OF OPERATION FOR QSAM                                           03620020
*                                                                       03640020
LOCATEB    EQU   X'08'                                                  03660020
MOVEB      EQU   X'10'                                                  03680020
SUBSTUTB   EQU   X'04'                                                  03700020
*                                                                       03720020
*                                                                       03740020
*********************************************************************   03760020
*                                                                       03780020
*                                                                       03800020
* COMMAND BYTES FOR THE 2841                                            03820020
*                                                                       03840020
*       CONTROL UNIT                                                    03860020
*                                                                       03880020
*                                                                       03900020
*                                                                       03920020
SRCHE      EQU   X'31'                                                  03940020
WRTCKD     EQU   X'1D'                                                  03960020
RDC        EQU   X'92'                                                  03980020
RDKD       EQU   X'8E'                                                  04000020
RDD        EQU   X'86'                                                  04020020
NOP      EQU   X'03'                                                    04040020
TIC        EQU   X'08'                                                  04060020
SETSC    EQU   X'23'                    SET SECTOR CCW CMND             04067020
RDSC     EQU   X'22'                    READ SECTOR CCW CMND            04074020
RDHA     EQU   X'1A'                    READ HOME ADDR                  04081020
MTSID    EQU   X'B1'                    MULTI-TRK SRCH ID               04088020
TICNOP   EQU   X'88'                    RCD READY TIC NOP               04095020
*                                                                       04102020
*                                                                       04109020
*********************************************************************   04120020
*                                                                       04140020
*                                                                       04160020
* MASKS FOR RECORD FORMATS                                              04180020
*                                                                       04200020
*                                                                       04220020
STANDRDF   EQU   X'08'                                                  04240020
FORMATU    EQU   X'C0'                                                  04260020
FORMATF    EQU   X'80'                                                  04280020
FORMATV    EQU   X'40'                                                  04300020
BLOCKED    EQU   X'10'                                                  04320020
FSTANDRD EQU   X'88'                                                    04340020
FIXBKD   EQU   X'90'                                                    04360020
NOTPNTID EQU   X'05'                                                    04380020
FORMATVS EQU X'48'    VARIABLE SPANNED                           M3641  04390020
*                                                                       04400020
*                                                                       04420020
*********************************************************************   04440020
*                                                                       04460020
*                                                                       04480020
*   CHANNEL CONTROL WORD FLAGS                                          04500020
*                                                                       04520020
SKIP       EQU   X'10'                                                  04540020
SLI        EQU   X'20'                                                  04560020
PCI      EQU   X'08'                                                    04580020
CC         EQU   X'40'                                                  04600020
DATACH     EQU   X'A0'                                                  04620020
SLICC      EQU   X'60'                                                  04640020
SLICCSK    EQU   X'70'                                                  04660020
*                                                                       04680020
*                                                                       04700020
*********************************************************************   04720020
*                                                                       04740020
*                                                                       04760020
KEYS       EQU   X'01'                                                  04780020
QSAM       EQU   X'01'                                                  04800020
*                                                                       04820020
*                                                                       04840020
*********************************************************************   04860020
*                                                                       04880020
COMMTABL EQU   16                                                       04900020
*                                                                       04920020
*********************************************************************   04940020
*                                                                       04960020
*                                                                       04980020
* DISPLACEMENTS, BYTE COUNTS AS EQUATES                                 04983020
*                                                                       04986020
D0       EQU   0                        DISPLACEMENT OF 0               04989020
D1       EQU   1                        DISPLACEMENT OF 1               04992020
D2       EQU   2                        DISPLACEMENT OF 2               04995020
D3       EQU   3                        DISPLACEMENT OF 3               04998020
D4       EQU   4                        DISPLACEMENT OF 4               05001020
D5       EQU   5                        DISPLACEMENT OF 5               05004020
D6       EQU   6                        DISPLACEMENT OF 6               05007020
D7       EQU   7                        DISPLACEMENT OF 7               05010020
D8       EQU   8                        DISPLACEMENT OF 8               05013020
D12      EQU   12                       DISPLACEMENT OF 12              05016020
D16      EQU   16                       DISPLACEMENT OF 16              05019020
D25      EQU   25                       DISPLACEMENT OF 25              05022020
D32      EQU   32                       DISPLACEMENT OF 32              05025020
D35      EQU   35                       DISPLACEMENT OF 35              05028020
D40      EQU   40                       DISPLACEMENT OF 40              05031020
D51      EQU   51                       DISPLACEMENT OF 51              05034020
D52      EQU   52                       DISPLACEMENT OF 52              05037020
D56      EQU   56                       DISPLACEMENT OF 56              05040020
D80      EQU   80                       DISPLACEMENT OF 80       M5725  05041020
D255     EQU   255                      DISPLACEMENT OF 255      M5725  05042020
*                                                                       05043020
* BYTE COUNTS AS EQUATES                                                05046020
*                                                                       05049020
B1       EQU   1                        BYTE CNT OF 1                   05052020
B2       EQU   2                        BYTE CNT OF 2                   05055020
B3       EQU   3                        BYTE CNT OF 3                   05058020
B4       EQU   4                        BYTE CNT OF 4                   05061020
B5       EQU   5                        BYTE CNT OF 5                   05064020
B8       EQU   8                        BYTE CNT OF 8                   05067020
B16      EQU   16                       BYTE COUNT OF 16                05070020
B24      EQU   24                       BYTE COUNT OF 24                05073020
*                                                                       05076020
* MISCELLANEOUS EQUATES                                                 05079020
*                                                                       05082020
RRWCHPL  EQU   10                       RCD READY WRT CHP LEN           05085020
RRNWCHPL EQU   6                        RCD READY NORM WRT CHP LEN      05088020
*                                       IN DOUBLE WORDS                 05091020
NWNOPOFF EQU   72                       NORM NOP OFFSET                 05094020
FLAGOFF  EQU   4                        FLAG OFFSET IN CCW              05097020
CNTOFF   EQU   7                        CNT FLD OFFSET                  05100020
OABD065  EQU   65                       INTERNAL ABEND CODE 65   I21042 05102021
*                                                                       05103020
*                                                                       05106020
*                                                                       05120020
*                                                                       05140020
         BALR  RBASE,0                  REG 3 IS BASE                   05160020
         USING SOPA,RBASE               ESTABLISH BASE REGISTER         05180020
         USING IHADCB,RDCB              REG 2 IS DCB                    05200020
         USING FORCORE,RCORE            REG 4 IS WORK AREA ADDR         05240020
*                                                                       05280020
*                                                                       05300020
SOPA     EQU   *                        FOR ADDRESSABILITY              05320020
*                                                                       05340020
         B     BEGIN                    BR AROUND CONSTANTS      Y02072 05350002
         DC    C'IGG0191W'              MODULE NAME              Y02072 05352002
         DC    C'@Z30TSCF'              LAST SHIP CODE         @Z30TSCF 05354003
         DC    C'10/17/74'              LAST DATE MODIFIED     @Z30TSCF 05356003
BEGIN    DS    0H                                                Y02072 05358002
*                                                                       05360020
         L     RDCB,0(RPARC)            GET DCB ADDRESS                 05380020
         L     RCORE,4(RWTGC)           GET WORK AREA ADDRESS           05420020
*                                                                       05440020
         SR    RTIOT,RTIOT                                              05500020
         ST    RTIOT,DCBCNTRL                                           05560020
         IC    RTIOT,DCBNCP             GET NUMBER OF ICBS TO BUILD     05640020
         USING WTGENTRY,RWTGC                                    Y02072 05642002
         MVC   WTGIDTTR,SOP2            NON-PCI EXECUTOR       @Z30TSCF 05644003
         TM    DCBMACRF+1,POINTB        NOTE/POINT MACRO USED           05720020
         BC    8,SOPA001                NO BRANCH                       05740020
*                                                                       05760020
         MVI   DCBCNTRL+1,NOTPNTID      STORE INDEX FOR NOTE/POINT ID.  05780020
*                                                                       05800020
SOPA001  EQU   *                                                        05820020
         LA    RF,88                    SIZE OF OUTPUT ICB +CP.         05840020
         LA    RUCB,B8                  DOUBLE WORD CONSTANT     M5725  05850020
*                                                                       05862020
* CHECK FOR RCD READY AND IF USED INCR ICB SIZE                         05864020
*                                                                       05866020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD READY       05868020
         BO    SOPA01A                  BRANCH IF YES                   05870020
         AR    RF,RUCB                  INCR ICB SIZE            M5725  05872020
SOPA01A  EQU   *                                                        05874020
         MVI   DCBCNTRL+3,1             STORE INDEX FACTOR FOR PCI EOB  05880020
         TM    DCBOPTCD,WRTCK           WRITE VALIDITY SPECIFIED        05900020
         BC    8,SOPA007                NO BRANCH                       05920020
         TM    JFCBMASK+D6,NORCDRY      RCD READY WITH WRT CHK          05926020
         BO    SOPA01D                  BRANCH IF YES                   05932020
         AR    RF,RUCB                  INCR ICB SIZE            M5725  05938020
SOPA01D  EQU   *                                                        05944020
*                                                                       05950020
         LA    RF,24(RF)                ADD CNST TO ICB & CP LENGTH     05960020
SOPA007  EQU   *                                                        06240020
*                                                                       06260020
         LR    RC,RF                    SAVE ICB SIZE                   06270020
         TM    DCBCIND2,QSAMB           IS QSAM BEING USED              06280020
         BC    8,SOPA009                NO BRANCH                       06300020
*                                                                       06320020
         IC    RTIOT,DCBBUFNO           GET NO. OF ICBS TO GENERATE     06340020
SOPA009  EQU   *                                                        06360020
*                                                                       06380020
         CH    RTIOT,RCCWCNST+2         BUFFER # =1 ?            M6190  06420020
*                                                                       06460020
         BNH   RELOOP                   BRANCH IF NOT GT ONE     M5725  06480020
*                                                                       06500020
*                                                                       06520020
SOPA011  EQU   *                                                        06540020
*                                                                       06560020
         LR    RE,RF                    COPY ICB SIZE                   06580020
         SRL   RE,3                     DIVIDE BY EIGHT                 06600020
         STC   RE,DCBIOBL               SAVE FOR CLOSE                  06620020
         MR    RE,RTIOT                 COMPUTE SPACE REQ        M5725  06650020
         LA    RF,80(RF)                ADD SPACE FOR MAIN IOB          06680020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD READY       06682020
         BO    SOPA11A                  BRANCH IF YES                   06684020
         LA    RF,B16(RF)               INCR FOR THETA VALUES AND       06686020
*                                       SET SECTOR IN MIOB              06688020
SOPA11A  EQU   *                                                        06690020
*                                                                       06692020
         LR    RB,RF                    SAVE FOR CLEARING RT.           06700020
         OI    DCBCIND2,DCBCNCHS        SET TRUE PCI INDICATOR   YM4697 06710002
*                                                                       06720020
*  THE FOLLOWING SAVES THE AMOUNT OF CORE GETMAINED FOR THE      YM4697 06730002
*  IOB AND ICBS IN THE FORCE CLOSE AUDIT TRAIL FOR THE FORCE     YM4697 06732002
*  CLOSE EXECUTOR.                                               YM4697 06734002
*                                                                       06736002
         ST    RF,DXATEXC2              SAVE LENGTH              YM4697 06738002
*                                                                       06760020
         MODESET  KEYADDR=DXUKEY,WORKREG=11  GET INTO USER KEY   Y02072 06770002
         GETMAIN R,LV=(RF),SP=0                                  Y02072 06780002
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 06790002
*                                                                       06800020
*                                                                       06820020
**********************************************************************  06840020
*                                                                       06846020
* OBTAIN THETA ADDRS MAY BE USED LATER                                  06852020
*                                                                       06858020
         LR    RJ,RB                    GET AREA SIZE                   06864020
         AR    RJ,RF                    GET LAST AREA + 1 ADDR          06870020
         SR    RJ,RUCB                  BACK UP AREA ADDR ONE DW        06882020
         ST    RJ,DXCCW11               TEMP STORE SET SECT ADDR        06888020
*                                                                       06906020
**********************************************************************  06920020
**                                                                      06940020
*    THIS SECTION CLEARS THE SPACE RECIEVED FROM GETMAIN                06960020
**                                                                      06980020
*                                                                       07000020
         ST    RF,DCBIOBAD              STORE MAIN IOB ADDRESS          07040020
         OI    FCAOPEN,FCAOIOB          INDIC IOB'S CAN BE FREED Y02072 07050002
         BCTR  RB,0                     REDUCE AMT BY ONE        M5725  07060020
         MODESET  KEYADDR=DXUKEY,WORKREG=11  GET INTO USER KEY   Y02072 07062002
         LA    RJ,D255                  GET MAX AMT CAN CLEAR    M5725  07080020
COMPARE  CR    RB,RJ                    IS AMT TO CLEAR GT 255   M5725  07100020
         BC    12,ONECLEAR              NO BRANCH                       07120020
*                                                                       07140020
         EX    RJ,CLEAR                 CLEAR 256 BYTES          M5725  07150020
         SR    RB,RJ                    SUBT 255 FROM AMT TO     M5725  07160020
*                                       CLEAR                    M5725  07170020
         BCTR  RB,0                     SUBT ONE MORE BYTE       M5725  07180020
         LA    RF,256(RF)               UPDATE AREA ADDR BY 256         07220020
         B     COMPARE                                                  07240020
*                                                                       07260020
CLEAR    XC    0(1,RF),0(RF)            ACTUAL CLEAR INSTRUCTION        07280020
*                                                                       07300020
ONECLEAR EX    RB,CLEAR                 CLEARS LESS THAN 256     M5725  07320020
*                                                                       07340020
*                                                                       07360020
*                                                                       07380020
         L     RB,DCBIOBAD              GET MAIN IOB ADDRESS            07400020
*                                                                       07480020
*    THIS SECTION OF CODE WILL BUILD THE MAIN IOB & CHANNEL PROGRAM     07500020
*                                                                       07520020
SOPA013  EQU   *                                                        07540020
*                                                                       07560020
         LA    RJ,D80(RB)               POINT TO FIRST ICB       M5725  07570020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD READY       07584020
         BO    SOPA13A                  BRANCH IF YES                   07588020
         AR    RJ,RUCB                  INCR ICB PTR             M5725  07592020
SOPA13A  EQU   *                                                        07596020
         ST    RJ,D8(RB)                STORE IN MAIN IOB        M5725  07606020
         LA    RD,4(RB)                 POINT TO ECB IN MAIN IOB        07620020
*                                                                       07640020
         MVI   0(RD),X'7F'              POST MAINIOB COMPLETE           07660020
*                                                                       07680020
         LA    RF,56(RB)                POINT TO CP START ADDRESS       07700020
         USING IOBQSAMC,RWK3                                     Y02072 07710002
         ST    RD,IOBECBPT              ECB ADDR TO IOB          Y02072 07720002
         ST    RF,IOBSTART              CHAN PGM ADDR TO IOB     Y02072 07730002
         L     RWK2,DXUDCBAD            GET USERS DCB ADDRESS    Y02072 07732002
         ST    RWK2,IOBDCBPT            DCB ADDR TO IOB          Y02072 07734002
         DROP  RWK3                                              Y02072 07736002
         MVC   48(8,RB),DCBFDAD         MOVE D.A. ADDRESS TO MAIN IOB   07740020
         LR    RD,RC                    PUT ICB SIZE IN INDEX REG       07750020
*                                                                       07770020
* CHECK FOR RCD READY AND IF USED GO BUILD SET SECTOR                   07780020
*                                                                       07790020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICE W/O RCD READY        07800020
         BO    SOPA13D                  BRANCH IF YES                   07810020
         L     RE,DXCCW11               GET THETA ADDR                  07820020
         BAL   RJ,SOPASTA               GO BUILD SET SECTOR             07830020
SOPA13D  EQU   *                                                        07840020
*                                                                       07850020
* CONSTRUCTION OF SEARCH AND TIC FOLLOWS                                07860020
*                                                                       07870020
         LA    RE,D51(RB)               PT TO CCHHR IN MAIN IOB         07880020
         BAL   RJ,SOPSRCH               GO BUILD SRCH AND TIC           07890020
*                                                                       07900020
         AR    RF,RUCB                  CHP PTR TO TIC                  07910020
         SR    RC,RC                    CLEAR REG                       07920020
         IC    RC,DCBKEYLE              GET KEY LENGTH                  07930020
         AH    RC,DCBBLKSI              ADD BLOCK SIZE                  07940020
         ST    RC,D4(RF)                PUT IN RH OF TIC                07950020
*                                                                       07960020
         AR    RF,RUCB                  INCR PTR                        07970020
         MVI   D0(RF),TIC               PUT TIC CMND IN CCW             07980020
*                                                                       07990020
         AR    RF,RUCB                                                  08000020
*                                                                       08010020
* MAIN IOB COMPLETE, FROM HERE ON RB=ICB, RF=CHP PTR, RUCB=8,           08020020
* RD=ICB SIZE,RDEB=16 HERE FOR INDEX TO NORM CHP ADDR                   08030020
*                                                                       08040020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 08040402
         ST    RF,DCBIOBA               PUT ICB PTR IN DCB              08050020
         LR    RB,RF                    COPY ADDRESS                    08060020
         MODESET  KEYADDR=DXUKEY,WORKREG=11  GET INTO USER KEY   YM2396 08112402
         SPACE                                                          08112802
ICBLOOP  EQU   *                                                        08120020
*                                                                       08140020
************** CONSTRUCTION OF ICB & CP COMMENCE ********************** 08260020
*                                                                       08300020
         ST    RF,D0(RB)                LINK ICBS, REDUNDANT FOR        08310020
*                                       FIRST SINCE RF=RB               08320020
         LR    RB,RF                    UPDATE ICB PTR                  08330020
         LA    RC,4(RB)                 POINT TO ECB IN ICB             08360020
         ST    RC,12(RB)                STORE ECB ADDRESS IN ICB        08380020
         MVI   4(RB),X'7F'              POST ECB COMPLETE FOR NOW       08400020
         LA    RC,56(RB)                POINT TO ICBS NORMAL CP  M5725  08420020
         ST    RC,24(RB)                STORE CP ADDRESS IN ICB         08440020
         MVC   32(8,RB),DCBFDAD         STORE D.A. ADDRESS IN ICB       08460020
*                                                                       08480020
*                                                                       08500020
*        NOTE THAT THE DCB ADDRESS IS NOT STORED IN THE ICB             08520020
*                                                                       08540020
*                                                                       08560020
*********************************************************************** 10100020
*                                                                       10120020
SOPA025  EQU   *                                                        10140020
*                                                                       10160020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 10162002
         MVC   DCBWCPO(4),PCIOFST       STORE CP OFFSETS IN DCB         10180020
         MODESET  KEYADDR=DXUKEY,WORKREG=11  GET INTO USER KEY   Y02072 10180402
         LA    RF,D40(RB)               PT RF TO CHP START              10190020
         L     RC,DCBIOBAD              GET MAIN IOB PTR                10200020
         LA    RE,D35(RB)               PT TO ICB CCHHR FLD             10210020
         BAL   RJ,SOPSRCH               GO BUILD SRCH AND TIC           10220020
         MVI   D0(RF),MTSID             CHANGE CMND TO MULTI-TRK        10230020
         AR    RF,RUCB                  INCR CHP PTR FOR SRCH           10240020
         AR    RF,RUCB                  INCR CHP PTR FOR TIC            10250020
*                                                                       10260020
* WRT CCW BUILD  RTN                                                    10270020
*                                                                       10280020
         LA    RE,D0(RB,RD)             PT TO NEXT ICB                  10290020
         SR    RE,RUCB                  BACK UP ONE DW                  10300020
         ST    RE,D0(RF)                PUT IN CHP AS CCHHRKDD FLD      10310020
         MVI   D0(RF),WRTCKD            PUT IN CCW CMND                 10320020
         MVC   FLAGOFF(B4,RF),WCCWCNST  FLAGS AND LENT TO CCW           10330020
*                                                                       10330402
* MUST TEST TO SEE IF THIS JOB IS RUNNING IN A VIRTUAL ENVIRON-  Y02072 10330802
* MENT.  IF YES, PCI BIT SHOULD NOT BE LEFT ON.  IF NO, PCI BIT  Y02072 10331202
* SHOULD BE LEFT ON.                                             Y02072 10331602
*                                                                       10331702
         L     RDEB,DCBDEBAD            GET DEB ADDR             Y02072 10332002
         USING DEBBASIC,RDEB                                     Y02072 10334002
         L     RWK2,DEBTCBAD            TCB ADDR FOR V=R TEST    Y02072 10336002
         DROP  RDEB                                              Y02072 10338002
         USING TCB,RWK2                                          Y02072 10338402
         TM    TCBFLGS6,TCBRV           JOB RUNNING VIRT         Y02072 10338802
         BO    SOPA027                  NO, LEAVE PCI ON         Y02072 10339202
         DROP  RWK2                                              Y02072 10339302
         USING CCW,RWK6                                          Y02072 10339602
         NI    CCWFLGS,X'FF'-CCWPCI     YES, TURN PCI FLAG OFF   Y02072 10339702
         DROP  RWK6                                              Y02072 10339802
SOPA027  EQU   *                        LEAVE PCI FLAG ON        Y02072 10339902
         AR    RF,RUCB                  INCR PTR                        10346702
*                                                                       10350020
*                                                                       10360020
         TM    DCBCIND2,QSAMB           QSAM USED                       10370020
         BZ    SOPA029                  BRANCH IF NO                    10380020
         L     RWK2,DCBBUFCB            ADDR OF BUF CNTRL BLK    YM7595 10383002
         USING BCBLK,RWK2                                               10386002
         L     RBUFADR,BCBBUFPT         ADDR NEXT AVAIL BUFFER   YM7595 10389002
         LTR   RBUFADR,RBUFADR          IS THERE A BUFFER        Y02072 10390402
         BZ    ABEND                    NO, ISSUE DMABCOND       Y02072 10390802
         USING BUFFER,RBUFADR                                           10392002
         MVC   BCBBUFAD,BUFNXPTB        NEXT AVAIL BUFFER        YM7595 10392602
         USING CCW,RF                                            Y02072 10393202
         STCM  RBUFADR,B'0111',CCWADDRB  YES, STORE ADDR IN CCW  Y02072 10394402
         MVC   CCWBYTE,DCBBLKSI         BLKSIZE TO CCW           M5725  10400602
         DROP  RF,RWK2,RBUFADR                                          10403602
SOPA029  EQU   *                                                        10405302
         OI    FLAGOFF(RF),SLI          SET SILI BIT                    10410020
         AR    RF,RUCB                  INCR PTR FOR 2ND WRT CCW        10420020
*                                                                       10430020
* CHECK FOR WRT CHK                                                     10440020
*                                                                       10450020
         TM    DCBOPTCD,WRTCK           WRT CHK SPECIFIED               10460020
         BZ    SOPA444                  BRANCH IF NO                    10470020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 10470402
         MVI   DCBWCPL,B8               SET WRT CHP LEN                 10480020
         MODESET  KEYADDR=DXUKEY,WORKREG=11  GET INTO USER KEY   Y02072 10480402
         SR    RF,RUCB                  BACK UP CHP PTR                 10490020
         OI    FLAGOFF(RF),CC           CMND CHAIN PREVIOUS CCW         10500020
         AR    RF,RUCB                  RESTORE PTR                     10510020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICE W/O RCD READY        10520020
         BO    SOPA29A                  BRANCH IF YES                   10530020
         BAL   RJ,SOPARTA               GO BUILD RD SECT CMND           10550020
         USING CCW,RF                                           SA57269 10552002
         SR    RF,RUCB                  POSITION AT RD SECT CCW YM5373  10554002
         OI    CCWFLGS,CCWCC            SET COM CHAIN TO SET    SA57269 10562002
*                                         SECTOR CCW            SA57269 10572002
         AR    RF,RUCB                  POSITION AT SET SEC CCW YM5373  10572402
         DROP  RF                                               SA57269 10574002
         L     RE,DXCCW11               GET THETA ADDR           Y02072 10580002
         BAL   RJ,SOPASTA               GO BUILD SET SECTOR CMND        10590020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 10590402
         MVI   DCBWCPL,RRWCHPL          SET WRT CHP LEN FOR RCD RDY     10600020
         MODESET  KEYADDR=DXUKEY,WORKREG=11  GET INTO USER KEY   Y02072 10600402
SOPA031  EQU   *                                                        10610020
SOPA29A  EQU   *                                                        10620020
         LA    RE,D0(RB,RD)             PT OT NEXT ICB                  10630020
         SR    RE,RUCB                  BACK UP TO CCHHRKDD ADDR        10640020
         BAL   RJ,SOPSRCH               GO BUILD SRCH AND TIC           10650020
         AR    RF,RUCB                  INCR PTR FOR SRCH               10660020
         AR    RF,RUCB                  INCR PTR FOR TIC                10670020
*                                                                       10680020
*                                                                       10690020
         MVI   D0(RF),RDD               PUT IN RD DATA CMND             10700020
         MVC   FLAGOFF(B4,RF),RCCWCNST  PUT IN FLAGS AND LEN            10710020
*                                                                       10720020
         TM    DCBCIND2,QSAMB           QSAM USED                       10730020
         BO    SOPA035                  BRANCH IF YES                   10740020
         CLI   DCBKEYLE,B1              KEY LENGTH SPECIFIED            10750020
         BNH   SOPA035                  BRANCH IF NO                    10760020
         MVI   D0(RF),RDKD              PUT IN RD KEY DATA CMND         10770020
*                                                                       10780020
SOPA035  EQU   *                                                        10790020
         SR    RF,RB                    OBTAIN RD OFFSET                10800020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 10800402
         STC   RF,DCBOFFSR              PUT IN DCB                      10810020
         MODESET  KEYADDR=DXUKEY,WORKREG=11  GET INTO USER KEY   Y02072 10810402
         LA    RF,B8(RF,RB)             RESTORE AND INCR PTR            10820020
SOPA444  EQU   *                                                        10830020
         TM    DCBCIND2,QSAMB           QSAM USED                       10840020
         BO    SOPA449                  BRANCH IF YES                   10850020
         LA    RC,D0(RB,RD)             PT TO NEXT ICB                  10860020
         SR    RC,RUCB                  BACK UP TO CCHHRKDD FLD         10870020
         MVC   B5(B1,RC),DCBKEYLE       MOVE IN KEY LENGTH              10880020
SOPA449  EQU   *                                                        10890020
*                                                                       10900020
*                                                                       10910020
         SR    RF,RB                    OBTAIN NOP OFFSET               10920020
         L     RC,DCBIOBAD              GET MIOB                        10930020
         STC   RF,D3(RC)                PUT IN MAIN IOB                 10940020
         AR    RF,RB                    RESTORE PTR                     10950020
*                                                                       10960020
*                                                                       10970020
         LA    RC,D56(RD,RB)            PT TO NEXT ICB CHP              10980020
         ST    RC,D0(RF)                PUT IN CCW                      10990020
         MVI   D0(RF),NOP               MOVE IN NOP CMND                11000020
         OI    FLAGOFF(RF),SLI          SILI FLAG ON                    11010020
         MVI   D7(RF),B1                BYTE COUNT TO ONE               11020020
         AR    RF,RUCB                  INCR POINTER                    11030020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD READY       11040020
         BO    SOPA477                  BRANCH IF YES                   11050020
         TM    DCBOPTCD,WRTCK           WRITE CHECK USED                11060020
         BO    SOPA477                  BRANCH IF YES                   11070020
         SR    RF,RUCB                  BACK UP POINTER                 11080020
         MVC   D5(B3,RF),D1(RF)         MOVE NEXT ICBADDR TO RH         11090020
*                                       OF CCW                          11100020
         LA    RDEB,D8(RF)              PT TO NEXT CCW                  11110020
         ST    RDEB,D0(RF)              PUT IN CCW                      11120020
         MVI   D0(RF),TICNOP            PUT IN TIC CMND                 11130020
         AR    RF,RUCB                  INCR PTR FOR NOP-TIC            11140020
         BAL   RJ,SOPARTA               GO BUILD RD THETA               11160020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 11160402
         MVI   DCBWCPL,RRNWCHPL         SET CHP LENGTH                  11170020
         MODESET  KEYADDR=DXUKEY,WORKREG=11  GET INTO USER KEY   Y02072 11170402
SOPA477  EQU   *                                                        11180020
         AR    RF,RUCB                  INCR PTR FOR CNT                11190020
         BCT   RTIOT,ICBLOOP            IF MORE TO BUILD DECR AND       11200020
*                                       GO DO IT AGAIN                  11210020
*                                                                       11220020
*                                                                       11780020
*                                                                       11800020
*                                                                       11820020
SOPAEND  EQU   *                                                        11840020
         SPACE                                                          11855002
         MODESET  EXTKEY=DATAMGT                                        11870002
         SPACE                                                          11885002
         OI    FCAOPEN2,FCAOIOBC        INDIC ICBS COMPLETED     YM7595 11900002
         SPACE                                                          11915002
         MODESET  KEYADDR=DXUKEY,WORKREG=10                             11930002
         SPACE                                                          11945002
         L     RUCB,DCBIOBA             GET FIRST ICB GENERATED         11980020
         ST    RUCB,0(RB)               TIE LAST ICB TO FIRST           12000020
         LA    RDEB,D56(RUCB)           PT TO FIRST ICB CHP             12010020
         L     RD,DCBIOBAD              GET MAIN IOB ADDR               12020020
*                                                                       12040020
         SR    RC,RC                    CLEAR REG                       12050020
         IC    RC,D3(RD)                GET NOP OFFSET                  12060020
         AR    RC,RB                    OBTAIN NOP ADDR                 12070020
         TM    JFCBMASK+D6,NORCDRY      ANY DEVICES W/O RCD READY       12080020
         BO    SOPAXX                   BRANCH IF YES                   12090020
         TM    DCBOPTCD,WRTCK                                           12100020
         BO    SOPAXX                   BR IF WRT CHK SPECIFIED         12110020
         ST    RDEB,D4(RC)              PUT RDEB IN RH OF TIC           12120020
         B     SOPAXZ                   GO AROUND NEXT                  12130020
SOPAXX   EQU   *                                                        12140020
         ST    RDEB,D0(RC)              PUT IN PTR TO FIRST ICB         12150020
         MVI   D0(RC),NOP               RESTORE NOP                     12160020
SOPAXZ   EQU   *                                                        12170020
         SR    RC,RB                    RECOVER OFFSET OF NOP           12500020
         AR    RC,RUCB                  GET FIRST ICB NOP ADDR          12530020
         ST    RC,D12(RD)               PUT IN MAIN IOB                 12560020
         MVI   D12(RD),IOBCEXCP         SET EXCP NEEDED FLAG     YM6583 12570002
         MVC   D32(B8,RUCB),DCBFDAD     INITIALIZE ICB SEEK             12590020
         L     RUCB,D0(RUCB)            SPECIAL CONSIDERATIONS          12620020
         MVC   D32(B8,RUCB),DCBFDAD     INITIALIZE ICB SEEK             12650020
*                                                                       12680020
*                                                                       12780020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 12790002
*                                                                       12800020
         TM    DCBDSORG,DCBDSGPO        DCB USING PAM            Y02072 12812002
         BZ    SOPAEND2                 NO BRANCH                Y02072 12814002
         MVI   NTPTINDX+1,5             STORE INDEX FOR          Y02072 12816002
*                                         NOTE-POINT ID          Y02072 12818002
*********************************************************************** 12820020
*                                                                       12840020
*                                                                       12880020
*        SELECT 3RD STAGE EXECUTOR                                      12884020
*                                                                       12884402
SOPAEND2 EQU   *                                                        12897702
*                                                                       12902402
         USING FORCORE,RCORE                                     Y02072 12902802
         USING WTGENTRY,RWTGC                                    Y02072 12904402
         MVC   WTGIDTTR,SOPSLDFT        GET NON-SPAN EXEC      @Z30TSCF 12906403
         TM    DCBRECFM,FORMATVS        VAR SPAN TEST            M5725  12911802
         BNO   RELOOP                   NO CHANCE FOR VS         M5725  12916502
         TM    DCBRECFM,FORMATU         UNDEFINED                M5725  12921202
         BO    RELOOP                   YES,NOT VS               M5725  12925902
         MVC   WTGIDTTR,SOP3            GET SPAN LOAD EXEC     @Z30TSCF 12927903
*                                                                       12935302
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURR WTG ENTRY        12940020
         LA    RPARC,PLOFF(0,RPARC)     INCR CURRENT DCB ENTRY PRTR     12960020
         CLC   0(2,RWTGC),AMIDCNST      THIS RT NEEDED AGAIN            12980020
         BCR   8,RBASE                                                  13000020
*                                                                       13020020
         CLC   0(2,RWTGC),OPIDCNST      END OF TABLE                    13040020
         BC    7,RELOOP                 NO,CHECK NEXT ENTRY             13060020
*                                                                       13080020
         LR    RPARC,RPAR                                               13100020
         LA    RWTGC,WAOFF(0,RWTG)      REINITIALIZE WTG LIST PTR       13120020
ZCHEK    CLI   0(RWTGC),X'00'          IS THIS ENTRY COMPLETE           13140020
         BC    7,TCTLRTN                IF NOT TRANSFER CONTROL         13160020
*                                                                       13180020
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY                  13200020
         LA    RPARC,PLOFF(0,RPARC)                                     13220020
         BC    15,ZCHEK                                                 13240020
*                                                                       13260020
TCTLRTN  EQU   *                                                        13280020
         USING WTG,RWTG                                                 13330003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*13380003
               MODID=WTGENTRY                                  @Z30TSCF 13430003
         DROP  RWTGC,RWTG                                      @Z30TSCF 13480003
**                                                                      13500020
*                                                                       13520020
*********************************************************************   13540020
*                                                                       13560020
*                                                                       13580020
*   THIS SECTION OF CODE FILLS IN RD/WRT CCW WITH BUFFER AND LENGTH     13600020
*                                                                       13620020
*********************************************************************** 13640020
*                                                                       13842020
* SEARCH AND TIC BUILD RTN                                              13849020
*                                                                       13856020
SOPSRCH  EQU   *                                                        13863020
         ST    RE,D0(RF)                SRCH ADDR TO CCW                13870020
         MVI   D0(RF),SRCHE             SEARCH CMND                     13877020
         ST    RF,D8(RF)                SRCH ADDR TO TIC CCW            13884020
         MVC   FLAGOFF(B5,RF),SCCWCNST  FLAGS, LEN AND TIC CMND         13891020
         BR    RJ                       RETURN                          13898020
*                                                                       13905020
* SET SECTOR BUILD RTN                                                  13912020
SOPASTA  EQU   *                                                        13919020
         ST    RE,D0(RF)                THETA ADDR TO CCW               13926020
         MVI   D0(RF),SETSC             SET SECT CMND                   13933020
         OI    FLAGOFF(RF),CC           CMND CHAIN                      13940020
         B     CMNDFIN                  GO FINISH CMND                  13947020
*                                                                       13954020
* READ SECTOR BUILD RTN                                                 13961020
*                                                                       13968020
SOPARTA  EQU   *                                                        13975020
         L     RE,DXCCW11               GET THETA ADDRESS        Y02072 13978002
         ST    RE,D0(RF)                THETA ADDR TO CCW               13982020
         MVI   D0(RF),RDSC              RD SECT CMND                    13989020
         SR    RF,RUCB                  BACK UP PTR                     13996020
         OI    FLAGOFF(RF),CC           CMND CHAIN PREV CCW             14003020
         AR    RF,RUCB                  RESTORE PTR                     14010020
CMNDFIN  EQU   *                                                        14017020
         MVI   CNTOFF(RF),B1            BYTE CNT TO ONE                 14024020
         AR    RF,RUCB                  INCR PTR                        14031020
         BR    RJ                       RETURN                          14038020
*                                                                       14045020
ABEND    EQU   *                                                        14060020
*                                                                       14080020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 14082002
         SPACE                                                          14092002
         DMABCOND OABD065,PDLOAD,RES=NO,REGSAVE=YES              I21042X14100021
                                        CALL PD FOR 013 ABEND           14110021
         B     TCTLRTN                                           I21042 14120021
*                                                                       14160020
*                                                                       14180020
**********************************************************************  14400020
*                                                                    *  14420020
WAOFF    EQU   32                                                       14440020
PLOFF    EQU   4                        OFFSET OF DCB ENTRIES           14460020
WGOFF    EQU   8                        OFFSET OF WTG ENTRIES           14480020
AMIDCNST DC    C'1W'                    ID OF THIS MODULE               14500020
OPIDCNST DC    C'0S'                                                    14520020
SOPSLDFT DC    C'13',VL3(IGG01913)      NON-SPANNED EXEC       @Z30TSCF 14530003
SOP3     DC    C'16',VL3(IGG01916)      SPANNED RECORDS        @Z30TSCF 14532003
SOP2     DC    C'1D',VL3(IGG0191D)   ABNORMAL, PCI UNSUPPORT   @Z30TSCF 14534003
PDLOAD   DC    C'6M',VL3(IGG0196M)      PROBLEM DETERMINATION  @Z30TSCF 14536003
*                                                                       14540020
*********************************************************************** 14560020
*      CONSTANTS AND RESERVED STORAGE.                                  14580020
*                                                                       14600020
*                                                                       14620020
WCCWCNST DC    X'A8000008'                                              14780020
RCCWCNST DC    X'50000001'                                              14800020
SCCWCNST DC    X'4000000508'                                            14820020
PCIOFST  DC    X'28'                                                    14840020
         DC    X'05'                    NUMBER OF DBL WRDS IN CP        14860020
         DC    X'00'                    READ CCW OFFSET                 14880020
         DC    X'40'                    WRITE CCW OFFSET                14900020
         SPACE                                                          14950002
PATCH    DC    0H'0',54X'00'            PATCH AREA               Y02072 14960002
END      EQU   *                        END OF MODULE            Y02072 15050002
         EJECT                                                          15053002
         IGGBCB  TYPE=SAM                                               15065002
         EJECT                                                          15100002
         DCBD  DSORG=PS                                                 15400002
NTPTINDX EQU   DCBCNTRL                 NOTE/POINT INDEX         Y02072 15450002
         EJECT                                                          15500003
CVT      DSECT                                                 @Z30TSCF 15550003
         CVT                                                   @Z30TSCF 15600003
         IECDSECS (MAIN,(IOB,NO)),IOB,WTG,PREFX,EXPAND=YES     @Z30TSCF 16120003
         ORG   WTGIDTTR                                          Y02072 16122002
WTGID    DS    CL2                      NEXT MODS ID             Y02072 16124002
         EJECT                                                          16126002
FORCORE  DSECT                                                   Y02072 16128002
         IHAFCAUD  ORG=YES                                       Y02072 16128402
         EJECT                                                          16128802
         IEZDEB                                                  Y02072 16130002
         EJECT                                                          16132002
         IHAICB                                                  Y02072 16140002
         ORG   ICBR+1                                            Y02072 16150002
         EJECT                                                          16150402
         IHACCW  DSECT=YES                                       Y02072 16152002
         EJECT                                                          16152402
         IKJTCB                                                  Y02072 16154002
           END                                                          16160020
