         TITLE 'IGG01926 - SAM STAGE 3 OPEN EXECUTOR'                   00090021
IGG01926 CSECT                                                          00180021
*MODULE NAME - IGG01926                                          Y02072 00190002
*                                                                       00200002
*DESCRIPTIVE NAME - LOAD ACCESS METHOD ROUTINES                  Y02072 00210002
*                                                                       00220002
*COPYRIGHT - NONE                                                Y02072 00222002
*                                                                       00224002
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00226002
*                                                                       00230002
*        VS2 RELEASE 02 DELETIONS                                Y02072 00240002
*002700,007200,013400,103800,110800152400-152600,136900,151100   Y02072 00250002
*116800-117000,117800,119000-122600,123200                       Y02072 00252002
*                                                                YM1140 00254002
*                                                                       00256003
*        VS2 RELEASE 3 DELETIONS                                        00258003
*                                                              @Z30TSCF 00258403
*                                                                       00260002
*STATUS CHANGE LEVEL 001                                                00270002
*                                                                       00380021
*FUNCTION/OPERATION - THIS MODULE IS A CONTINUATION OF MODULE      UT18 00400021
*    IGG01919 AND LOADS THE REMAINING I/O MODULES.  WHAT IS TO          00420021
*      BE LOADED IS DETERMINED FROM THE CODES IN THE DCBCNTRL      UT18 00440021
*      FIELD WHICH WAS SET BY PREVIOUS LOADS OF THE OPEN EXECUTORS.UT18 00460021
*      IT WILL PLACE THE ADDRESS OF THE LOADED MODULES IN THE           00480021
*      APPROPRIATE DCB FIELDS, AND THE ID'S IN THE DEB.                 00500021
*      IT WILL BRING IN THE APPROPRIATE END-OF-BLOCK(EOB) ROUTINE       00520021
*                                                                       00560021
*ENTRY POINTS - ENTERED ONLY FROM IGG01919 BY USE OF XCTL MACRO         00580021
*                                                                       00600021
*INPUT: SEE DESCRIPTION OF REGISTERS, DCB(USERS)                        00620021
*                                                                       00640021
*OUTPUT: DCB(USERS),IOB(USERS).                                         00660021
*                                                                       00680021
*EXTERNAL ROUTINES: NONE.                                               00700021
*EXITS-NORMAL: XCTL TO IGG01911                                  Y02072 00720002
*                                                                       00740021
*EXITS-ERROR: NONE.                                                     00760021
*                                                                       00770002
*MACROS-MAPPING:IECDSECS(MAIN,WTG), DCBD, CVT                    Y02072 00772002
*                                                                       00780021
*TABLES/WORKAREAS- WHERE TO GO TABLE (WTG)                              00800021
*                                                                       00820021
*      BYTE  0-7  NAME                                                  00840021
*      BYTE  8-10 RELATIVE DISK ADDRESS(TTR) OF FIRST RECORD            00860021
*      BYTE 11    CONCATENATION NUMBER                                  00880021
*      BYTE 12    ZERO                                                  00900021
*      BYTE 13    ALIAS INDICATOR AND USER DATA FIELD DESCRIPTOR.       00920021
*                        ALIAS INDICATOR 1 BIT                          00940021
*                        NUMBER OF TTRS IN USERS DATA FIELD 2 BITS      00960021
*      BYTE 14-16 TTR OF FIRST TEXT RECORD                              00980021
*      BYTE 17    ZERO                                                  01000021
*      BYTE 18-19 TTR OF NOTE LIST OR SCATTER LIST                      01020021
*      BYTE 20    TRANSLATION TABLE                                     01040021
*      BYTE 21    ZERO OR NUMBER OF ENTRIES IN THE NOTE LIST            01060021
*      BYTE 22-23 ATTRIBUTES                                            01080021
*      BYTE 24-26 TOTAL CONTIGUOUS MAIN STORAGE REQUIRED FOR MODULE     01100021
*      BYTE 27-28 LENGTH OF FIRST TEXT RECORD                           01120021
*      BYTE 29    LENGTH OF WTG TABLE (IN DOUBLE WORDS)                 01140021
*      BYTE 30-31 PATH THROUGH LOADS OF ROUTINES                        01160021
*      BYTE 32-36 IDTTR OF EXECUTOR FOR FIRST DCB                       01180021
*      BYTE 37-39 WORKAREA ADDRESS FOR FIRST DCB                        01200021
*      BYTE 40-   TABLE OF IDTTR'S                                      01220021
*      BYTE 32+N(8) IDTTR OF EXECUTOR FOR N TH DCB   (5 BYTES)          01240021
*                   WORKAREA ADDRESS FOR N TH DCB    (3 BYTES)          01260021
*                   IDTTR OF LAST ROUTINE LOAD       (5 BYTES)          01280021
*                   NOT USED                         (3 BYTES)          01300021
*                                                                       01320021
*ATTRIBUTES: REENTRANT, REUSABLE, RUNS IN DATA MANAGEMENT KEY    Y02072 01340002
*            AND SUPERVISOR STATE                                Y02072 01350002
*                                                                       01360021
*NOTES: THIS ROUTINE HAS A LIST OF ALL BSAM, QSAM MODULES SUPPORTED.    01380021
*                                                                       01400021
*********************************************************************** 01420021
*                                                                       01440021
*                                                                       01460021
*  REGISTER CONVENTIONS USED THROUGH OUT ALL OPEN PASSES                01480021
*                                                                       01500021
*********************************************************************** 01520021
*                                                                       01540021
RE       EQU   0         WORK REG5                                      01550002
RF       EQU   1         WORK REG6                                      01552002
R1       EQU   RF        PARM REG                                YM1140 01554002
RDCB     EQU   2         DCB REGISTER                                   01560021
RBASE    EQU   3         BASE REGISTER                                  01580021
RCORE    EQU   4         WORK AREA ADDRESS                              01600021
RPAR     EQU   5         TOP OF PARAMETER LIST                          01620021
RWTG     EQU   6         TOP OF WTG TABLE                               01640021
RPARC    EQU   7         CURRENT PARAMETER                              01660021
RWTGC    EQU   8         CURRENT TRANS LOAD                             01680021
RTIOT    EQU   9         USED HERE AS WRK REG AND  COMM VECTOR ADDR.    01700021
RUCB     EQU   10        USED HERE AS A COUNTER IN IOB GENERATION       01720021
RDEB     EQU   11        DEB ADDRESS                                    01740021
RB       EQU   12        WORK REG1  **                                  01760021
RC       EQU   13        WORK REG2  **  USED IN IOB GENERATION          01780021
RD       EQU   14        WORK REG3  **                                  01800021
RJ       EQU   15        WORK REG4                                      01820021
*                                                                       01880021
*                                                                       01900021
PARAR    EQU   RPARC                                                    01920021
*                                                                       01940021
*********************************************************************** 01960021
*                                                                       01980021
*********************************************************************** 02000021
*                                                                       02020021
* MASK'S TO TEST PARAMETER LIST WITH                                    02040021
*                                                                       02060021
*********************************************************************   02080021
INP      EQU   X'0F'                                                    02100021
OUTP       EQU   X'0F'                                                  02120021
UPDATE     EQU   X'04'                                                  02140021
INOUT      EQU   X'03'                                                  02160021
OUTIN      EQU   X'07'                                                  02180021
RDBACK     EQU   X'01'                                                  02200021
INPRDBK  EQU   X'0E'               MASK TO CK INPUT AND RDBACK     UT18 02220021
*                                                                       02240021
*                                                                       02260021
*********************************************************************   02280021
*                                                                       02300021
*                                                                       02320021
* OFFSET FOR PARAMETER TESTS                                            02340021
*                                                                       02360021
ONE        EQU   X'01'                                                  02380021
FRTYATE    EQU   48                                                     02400021
DISPSN     EQU   X'0'                                                   02420021
*                                                                       02440021
*                                                                       02460021
*********************************************************************   02480021
*                                                                       02500021
* OFFSETS FOR DEB REFERENCE                                             02520021
*                                                                       02540021
*                                                                       02560021
BIN      EQU   36                                                       02580021
BEXT     EQU   38                                                       02600021
*                                                                       02620021
*                                                                       02640021
*                                                                       02660021
*********************************************************************   02680021
*                                                                       02700021
* MASK'S USED TO TEST OPTION FIELDS IN DCB                              02720021
*                                                                       02740021
*                                                                       02760021
*                                                                       02780021
DOUBLE     EQU   X'01'                                                  02800021
*                                                                       02820021
*                                                                       02840021
STOWB      EQU   X'80'                                                  02860021
WRTCK      EQU   X'80'                                                  02880021
OVRFLO   EQU   X'20'                                                    02900021
PCI        EQU   X'20'                                                  02920021
MINKEY     EQU   X'01'                                                  02940021
CONCAT     EQU   X'FF'                                                  02960021
UTFMASK  EQU   X'02'                    MASK FOR TOTALING FACILITY UT18 02980021
*                                                                       03000021
*********************************************************************   03020021
*                                                                       03040021
* MASKS FOR ACCESS METHODS IN SAM                                       03060021
*                                                                       03080021
QSAMB      EQU   X'01'                                                  03100021
BSAMBIT    EQU   X'00'                                                  03120021
PAM        EQU   X'02'                                                  03140021
*                                                                       03160021
*                                                                       03180021
* MASKS FOR MACRO'S TO BE USED                                          03200021
*                                                                       03220021
GETB       EQU   X'40'                                                  03240021
PUTB       EQU   X'40'                                                  03260021
READB      EQU   X'20'                                                  03280021
WRITEB     EQU   X'20'                                                  03300021
POINTB     EQU   X'04'                                                  03320021
CNTRLB     EQU   X'02'                                                  03340021
*                                                                       03360021
*                                                                       03380021
*********************************************************************   03400021
*                                                                       03420021
* MASKS FOR DEVICES TO BE SUPPORTED                                     03440021
*                                                                       03460021
*                                                                       03480021
*                                                                       03500021
*********************************************************************   03520021
*                                                                       03540021
*                                                                       03560021
*                                                                       03580021
*                                                                       03600021
*********************************************************************   03620021
*                                                                       03640021
* MASKS FOR STATUS BITS TO BE TESTED                                    03660021
*                                                                       03680021
*                                                                       03700021
EXCPN      EQU   X'30'                                                  03720021
COMPLETE   EQU   X'80'                                                  03740021
FIRSTIOB   EQU   X'01'                                                  03760021
*                                                                       03780021
*                                                                       03800021
*                                                                       03820021
*********************************************************************   03840021
*                                                                       03860021
* MASKS FOR BUFFER TECHNIQUE'S                                          03880021
*                                                                       03900021
EXCHANGB   EQU   X'10'                                                  03920021
SIMPLEB    EQU   X'40'                                                  03940021
*                                                                       03960021
*********************************************************************   03980021
*                                                                       04000021
*                                                                       04020021
* MODES OF OPERATION FOR QSAM                                           04040021
*                                                                       04060021
LOCATEB    EQU   X'08'                                                  04080021
MOVEB      EQU   X'10'                                                  04100021
MOVEXCHB EQU X'14'                                                      04120021
SUBSTUTB   EQU   X'04'                                                  04140021
*                                                                       04160021
*                                                                       04180021
*********************************************************************   04200021
*                                                                       04220021
*                                                                       04240021
* COMMAND BYTES FOR THE 2841                                            04260021
*                                                                       04280021
*       CONTROL UNIT                                                    04300021
*                                                                       04320021
*                                                                       04340021
*                                                                       04360021
SRCHE      EQU   X'31'                                                  04380021
WRTCKD     EQU   X'1D'                                                  04400021
RDC        EQU   X'92'                                                  04420021
RDKD       EQU   X'8E'                                                  04440021
RDD        EQU   X'86'                                                  04460021
TIC        EQU   X'08'                                                  04480021
*                                                                       04500021
*                                                                       04520021
*********************************************************************   04540021
*                                                                       04560021
*                                                                       04580021
* MASKS FOR RECORD FORMATS                                              04600021
*                                                                       04620021
*                                                                       04640021
STANDRDF   EQU   X'08'                                                  04660021
FORMATU    EQU   X'C0'                                                  04680021
FORMATF    EQU   X'80'                                                  04700021
FORMATV    EQU   X'40'                                                  04720021
BLOCKED    EQU   X'10'                                                  04740021
FIXEDBLK   EQU   X'90'                                                  04760021
*                                                                       04780021
*                                                                       04800021
*********************************************************************   04820021
*                                                                       04840021
*                                                                       04860021
*   CHANNEL CONTROL WORD FLAGS                                          04880021
*                                                                       04900021
SKIP       EQU   X'10'                                                  04920021
SLI        EQU   X'20'                                                  04940021
CC         EQU   X'40'                                                  04960021
DATACH     EQU   X'A0'                                                  04980021
SLICC      EQU   X'60'                                                  05000021
SLICCSK    EQU   X'70'                                                  05020021
*                                                                       05040021
*                                                                       05060021
*********************************************************************   05080021
*                                                                       05100021
*                                                                       05120021
KEYS       EQU   X'01'                                                  05140021
QSAM       EQU   X'01'                                                  05160021
*                                                                       05180021
*                                                                       05200021
*********************************************************************   05220021
*                                                                       05240021
*                                                                       05260021
*********************************************************************   05280021
*                                                                       05300021
*                                                                       05320021
**********************************************************************  05340021
ASA        EQU   X'04'                                                  05360021
BKREAD     EQU   X'01'                                                  05380021
URBITS   EQU   X'40'                                                    05400021
TAPEB    EQU   X'80'                                                    05420021
DABIT    EQU   X'20'                                                    05440021
WAOFF    EQU   32                                                       05460021
PLOFF    EQU   4                        OFFSET OF DCB ENTRIES           05480021
WGOFF    EQU   8                        OFFSET OF WTG ENTRIES           05500021
IDLEN    EQU   2                        LENGTH OF A MODULE ID    Y02072 05510002
*                                                                       05520021
**********************************************************************  05540021
*                                                                       06000021
*                                                                       06020021
*                                                                       06040021
*                                                                       06060021
*                                                                       06080021
*                                                                       06100021
*                                                                       06120021
*                                                                       06140021
*                                                                       06160021
*                                                                       06180021
*                                                                       06200021
*                                                                       06220021
*                                                                       06240021
*                                                                       06260021
         BALR  RBASE,0                                                  06280021
         USING SLDA,RBASE                                               06300021
         USING IHADCB,RDCB                                              06320021
         USING BLDEB,RDEB                                               06340021
         USING FORCORE,RCORE                                            06360021
*                                                                       06400021
*                                                                       06420021
SLDA     EQU   *                                                        06440021
         B     BEGIN                    BR AROUND MODULE ID    @Z30TSCF 06450003
         DC    C'IGG01926'              MODULE NAME            @Z30TSCF 06452003
         DC    C'@Z30TSCF'              LAST SHIP CODE         @Z30TSCF 06454003
         DC    C'10/09/74'              LAST SHIP DATE         @Z30TSCF 06456003
BEGIN    DS    0H                                              @Z30TSCF 06458003
*                                                                       06460021
*                                                                       06480021
         L     RDCB,0(RPARC)            GET DCB ADDRESS                 06500021
         LA    RDCB,0(RDCB)             CLEAR HI BYTE                   06520021
         L     RDEB,DCBDEBAD            GET DEB ADDRESS                 06540021
         L     RCORE,4(RWTGC)           GET WORK AREA                   06560021
*                                                                 OC034 06580021
*   THIS SECTION OF CODE UP TO THE LABEL ENDOVR WILL ENSURE THAT  OC034 06600021
*   THE EOB ROUTINE IGG019CT GETS LOADED FOR ANY OPEN OVERRIDE.   OC034 06620021
         TM    JFCBMASK+6,X'C0'         WAS AN OVERRIDE USED      OC034 06640021
         BNO   ENDOVR                   BR IF NO                 A32160 06660021
         TM    0(RPARC),X'0F'           WAS IT LABEL=(,,,IN)     A32160 06680021
         BZ    INCHNG                   BR IF YES                A32160 06700021
         MVC   DCBCNTRL+2(1),DCBCNTRL+3 SAVE WRITE EOB DISP       OC034 06720021
         MVI   DCBCNTRL+3,X'0B'         SET READ EOB ROUTINE FOR  OC034 06740021
*                                       THE ERROR EOB ROUTINE     OC034 06760021
         B     ENDOVR                   CONTINUE                  OC034 06780021
INCHNG   MVI   DCBCNTRL+2,X'0B'         SET WRITE EOB ROUTINE FOR OC034 06800021
*                                       THE ERROR EOB ROUTINE     OC034 06820021
ENDOVR   EQU   *                        CONTINUE                  OC034 06840021
         MVI   22(RWTG),X'CB'          CHANGE DE ATTR.TO ONLY LOADABLE  06860021
*                                                                       06880021
         SR    RUCB,RUCB                CLEAR REG                       06920021
         SR    RF,RF                    CLEAR RER                       06940021
         IC    RUCB,DEBNMEXT            GET NUMBER OF EXTENTS           06960021
         IC    RF,DEBEXSCL              GET SCALING FACTOR              06980021
         SLL   RUCB,0(RF)               SHIFT ACCORDING TO EXTENT SIZE  07000021
         IC    RF,DEBAMLNG              GET ACCESS METHOD LENGTH        07020021
         LA    RUCB,0(RF,RUCB)          ADD TO POINT TO SUBRT ID FLD    07040021
         LA    RUCB,32(RUCB,RDEB)       ADD BASIC DEB SZ TO DEB AD      07060021
*                                                                       07080021
*  RUCB NOW POINTS TO THE SUBROUTINE ID FIELD IN THE DEB AND MUST  UT18 07100021
*  NOW BE INCREMENTED TO POINT BEYOND THE LAST ENTRY.              UT18 07120021
*                                                                  UT18 07140021
SLDAA    CLI   0(RUCB),X'00'            IS RUCB BEYOND LAST ENTRY  UT18 07160021
         BE    SLDAB                    BR IF YES                  UT18 07180021
         LA    RUCB,2(RUCB)             INCREMENT TO NEXT ID FIELD UT18 07200021
         B     SLDAA                    TEST NEXT FIELD            UT18 07220021
*                                                                  UT18 07240021
*  RUCB NOW POINTS TO THE NEXT AVAILABLE SUBROUTINE ID FIELD IN    UT18 07260021
*  THE DEB.                                                        UT18 07280021
*                                                                       07300021
SLDAB    EQU   *                                                        07320021
*                                                                  UT18 07340021
*  IF USER TOTALING IS TO BE USED, EOB ROUTINES WHICH CONTAIN THE  UT18 07360021
*  TOTALING LINKAGE MUST BE LOADED INSTEAD OF THE NORMAL EOB RTNS. UT18 07380021
*  THIS IS ACCOMPLISHED BY DOING A TRANSLATE OF THE DCBCNTRL FIELD UT18 07400021
*  TO CONVERT NORMAL EOB DISPLACEMENTS INTO DISPLACEMENTS FOR THE  UT18 07420021
*  UTF EOB ROUTINES.                                               UT18 07440021
*                                                                       07460021
         TM    DCBOPTCD,UTFMASK         TEST FOR TOTALING OPTION   UT18 07480021
         BZ    SLDAC                    BR IF NOT SPECIFIED        UT18 07500021
         TM    0(RPARC),INPRDBK         IS OPEN FOR INPUT/RDBACK   UT18 07520021
         BZ    SLDAC                    IF YES, NO TOTALING REQ'D  UT18 07540021
         TR    DCBCNTRL(4),UTFTBL       CHANGE TO UTF DISPLACEMENT UT18 07560021
SLDAC    EQU   *                                                   UT18 07580021
*                                                                       07600021
*                                                                       07620021
*********************************************************************** 07640021
*      GET THE EOB MODULES NEEDED FOR THIS FILE                         07660021
*********************************************************************   07680021
*                                                                       07700021
         BAL   RF,EOBROUT               GET EOB RT ID                   10260021
*                                                                       10280021
         BAL   RC,SLDROUT               LOAD ROUTINE                    10300021
*                                                                       10320021
         USING WTGENTRY,RWTGC                                    Y02072 10330002
         MVC   WTGIDTTR,SOP9            NEXT EXECUTOR          @Z30TSCF 10332003
         TM    DCBCIND2,QSAMB           QSAM BEING USED                 10340021
         BO    SLDEOB9                 YES,BRANCH                       10360021
*                                                                       10400021
SLDEOB2  EQU   *                                                        10420021
*                                                                       10440021
         MVC   DCBEOBR+1(3),25(RWTG)  LOAD EOB ADDR IN DCB              10460021
*                                                                       10480021
SLDEOB20 EQU   *                                                        10500021
*                                                                       10520021
         MVC   DCBEOBW+1(3),25(RWTG)    LOAD EOB WRITE ADDRESS IN DCB   10540021
*                                                                       10560021
SLDEOB4  EQU   *                                                        10580021
*                                                                       10600021
         BAL   RF,EOBROUT               GET POSSIBLE WRT ROUT (IN/OUT)  10620021
*                                                                       10640021
         LTR   RC,RC                    DCB FOR IN/OUT                  10660021
         BC    8,SLDEOB6                NO BRANCH                       10680021
*                                                                       10700021
         BAL   RC,SLDROUT               LOAD WRT EOB RT.                10720021
*                                                                       10740021
         MVC   DCBEOBW+1(3),25(RWTG)    LOAD EOB WRITE ADDRESS IN DCB   10760021
*                                                                       10780021
SLDEOB6  EQU   *                                                        10800021
*                                                                       10820021
         BAL   RF,EOBROUT               IS NOTE/POINT USED              10840021
*                                                                       10860021
         LTR   RC,RC                    TEST FOR ITS ID                 10880021
         BC    8,SLDEOBC                NO BRANCH                       10900021
*                                                                       10920021
SLDEOB8  EQU   *                                                        10940021
*                                                                       10960021
*                                                                       10980021
         BAL   RC,SLDROUT               LOAD NOTE/POINT ROUTINE         11000021
         MVC   DCBCNTRL+1(3),25(RWTG)   STORE NOTE/POINT ADDRESS        11020021
         B     SLDEOBE                                                  11040021
SLDEOB9  EQU   *                                                        11060021
         MVC   DCBEOB+1(3),25(RWTG)    STORE EOB ROUTINE                11100021
*                                                                       11120021
SLDEOBC  EQU   *                                                        11140021
         XC    DCBCNTRL(4),DCBCNTRL     CLEAR PARA LIST                 11160021
         OI    DCBCNTRL+3,X'01'         SET VECTOR  TO  ONE             11180021
SLDEOBE  EQU   *                        END.                            11200021
         MVC    DCBEROPT(1),DXCCW6      REPLACE QSAM ERROR OPTIONS      11220021
*                                                                       11240021
*                                                                       11260021
*********************************************************************** 11280021
*                                                                       11300021
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURR WTG ENTRY        11320021
         LA    RPARC,PLOFF(0,RPARC)     INCR CURRENT DCB ENTRY PRTR     11340021
         CLC   0(2,RWTGC),AMIDCNST      THIS RT NEEDED AGAIN            11360021
         BCR   8,RBASE                                                  11380021
*                                                                       11400021
         CLC   0(2,RWTGC),OPIDCNST      END OF TABLE                    11420021
         BC    7,RELOOP                 NO,CHECK NEXT ENTRY             11440021
*                                                                       11460021
         LR    RPARC,RPAR                                               11480021
         LA    RWTGC,WAOFF(0,RWTG)      REINITIALIZE WTG LIST PTR       11500021
ZCHEK    CLI   0(RWTGC),X'00'          IS THIS ENTRY COMPLETE           11520021
         BC    7,TCTLRTN                IF NOT TRANSFER CONTROL         11540021
*                                                                       11560021
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY                  11580021
         LA    RPARC,PLOFF(0,RPARC)                                     11600021
         BC    15,ZCHEK                                                 11620021
*                                                                       11640021
TCTLRTN  EQU   *                                                        11660021
         USING WTG,RWTG                                                 11710003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*11760003
               MODID=WTGENTRY                                  @Z30TSCF 11770003
         DROP  RWTGC,RWTG                                      @Z30TSCF 11780003
*                                                                       11800021
*                                                                       11820021
*                                                                       11840021
*                                                                       11860021
SLDROUT  EQU   *                                                        11880021
         USING WTGMODNM,RWTG                                     Y02072 11930002
         MVC   WTGMODID,0(RB)           ID TO MODULE NAME        Y02072 11980002
         DROP  RWTG                                              Y02072 12030002
         L     R1,CVTPTR                LOAD CVT ADDRESS         YM1140 12080002
         USING CVT,R1                   CVT ADDRESSABILITY       YM1140 12130002
         L     R1,CVTLINK               GET LPALIB DCB ADDRESS   YM1140 12180002
         DROP  R1                       DROP CVT BASE            YM1140 12230002
*                                                                       12280021
*                                                                       12300021
         LOAD  EPLOC=(RWTG),DCB=(1)                              YM1140 12320002
*                                                                       12340021
*                                                                       12360021
*                                                                       12380021
         SR    RD,RD                                                    12400021
         IC    RD,DEBNMSUB              GET NO OF SUBROUTINES LOADED    12420021
         LA    RD,1(RD)                 ADD ONE TO TOTAL                12440021
         STC   RD,DEBNMSUB              STORE NEW TOTAL OF SUBRT LOADED 12460021
         ST    RE,24(RWTG)              TEMP STORE OF ROUTINE ADDR,     12480021
SLDROUT1 MVC   0(2,RUCB),0(RB)          STORE ROUTINES ID IN DEB        12500021
         LA    RUCB,2(RUCB)             UPDATE SUBRT PNTR               12520021
         BR    RC                      RETURN                           12540021
*                                                                       12560021
*                                                                       12580021
*********************************************************************** 12600021
*                                                                       12620021
*                                                                       12640021
*********************************************************************** 12660021
*                                                                       12680021
EOBROUT  EQU   *                                                        12700021
*                                                                       12720021
         SR    RC,RC                                                    12740021
         LA    RE,EOBTABL               GET TABLE OF NAMES              12760021
         LA    RB,IDLEN                 LEN OF MODULE ID         Y02072 12780002
         IC    RC,DCBCNTRL+3            GET ID NO. DEVICE DEP.          12800021
         L     RJ,DCBCNTRL              SHIFT IDS RIGHT BY ONE BYTE     12820021
         SRL   RJ,8                                                     12840021
         ST    RJ,DCBCNTRL                                              12860021
         MR    RB,RB                    CALCULATE WHERE ID IS           12880021
         LR    RB,RC                    PREPARE TO LOAD  MODULE         12900021
         AR    RB,RE                    POINT TO CORRECT ID             12920021
         BR    RF                       RETURN                          12940021
OPIDCNST DC    C'0S'                                                    13060021
AMIDCNST DC    C'19'                    ID OF THIS MODULE          UT18 13080021
*                                                                       13280021
*      THE FOLLOWING TABLE IS USED WITH A TRANSLATE INSTRUCTION TO UT18 13300021
*      CONVERT DISPLACEMENTS FOR THE EOB TABLE INTO THE ENTRIES    UT18 13320021
*      FOR THE CORRESPONDING UTF EOB ROUTINES.                     UT18 13340021
*                                                                       13360021
UTFTBL   DC    X'00'                    NO CHANGE                  UT18 13380021
         DC    X'0E'                    IGG019CV BECOMES IGG019TV  UT18 13400021
         DC    X'0F'                    IGG019CW BECOMES IGG019TW  UT18 13420021
         DC    X'03'                    NO CHANGE                  UT18 13440021
         DC    X'04'                    NO CHANGE                  UT18 13460021
         DC    X'05'                    NO CHANGE                  UT18 13480021
         DC    X'06'                    NO CHANGE                  UT18 13500021
         DC    X'07'                    NO CHANGE                  UT18 13520021
         DC    X'0D'                    IGG019CC BECOMES IGG019TC  UT18 13540021
         DC    X'10'                    IGG019C2 BECOMES IGG019T2  UT18 13560021
         DC    X'0A'                    NO CHANGE                  UT18 13580021
         DC    X'0B'                    NO CHANGE                  UT18 13600021
SOP9     DC    C'11',VL3(IGG01911)  IGGO1911 OR IECOS90X -QSAM @Z30TSCF 13740003
*                                                                       13800021
*********************************************************************** 14500021
*                                                                       14520021
*        DEVICE DEPENDENT ROUTINES SUPPORTED                            14540021
*                                                                       14560021
EOBTABL  EQU   *                                                        14580021
         DC    C'  '                                                    14600002
EPD2     DC    C'CV'                                                    14620002
EGP2     DC    C'CW'                                                    14640002
DDA2     DC    C'CX'                                                    14660002
DDB2     DC    C'CY'                                                    14680002
NPD2     DC    C'BK'                    NOTE-POINT  DA  WITH PCI        14700002
NPT2     DC    C'BL'                    NOTEPOINT  TAPE  WITH PCI       14720002
NPD3     DC    C'BC'                    NOTE/POINT DISK                 14740002
EGP3     DC    C'CC'                    EOB RT. DISK-TP-RDR INP/OUTP    14760002
EOB2     DC    C'C2'                    EOB USED BY TRACK OVERFLOW      14780002
DUMY     DC    C'AV'                                                    14800002
OVRD     DC    C'CT'                    OPEN OVERRIDE ERROR RTN   OC034 14820002
UTF1     DC    C'TD'                    USER TOTALLING EOB ROUTINE UT18 14840002
UTF2     DC    C'TC'                    USER TOTALLING EOB ROUTINE UT18 14860002
UTF3     DC    C'TV'                    USER TOTALLING EOB ROUTINE UT18 14880002
UTF4     DC    C'TW'                    USER TOTALLING EOB ROUTINE UT18 14900002
UTF5     DC    C'T2'                    USER TOTALLING EOB ROUTINE UT18 14920002
         SPACE                                                          14924002
PATCH    DC    0H'0',XL50'00'           PATCH AREA             @Z30TSCF 14930003
END      EQU   *                        END OF MODULE            Y02072 14932002
         EJECT                                                          14940002
         IECDSECS  MAIN,WTG,PREFX,EXPAND=YES                   @Z30TSCF 15270003
         ORG   WTGIDTTR                                          Y02072 15272002
WTGID    DS    CL2                      NEXT MODS ID             Y02072 15274002
*                                                                       15280021
*                                                                       15300021
CVT      DSECT                                                          15320021
         CVT                                                            15340021
*                                                                       15360021
*                                                                       15380021
BLDEB    DSECT                                                          15400021
DEB      DS    0F                                                       15420021
DEBNMSUB DS    0CL1                                                     15440021
DEBTCBAD DS    CL4                                                      15460021
DEBAMLNG DS    0CL1                                                     15480021
DEBDEBAD DS    CL4                                                      15500021
DEBOGLGS DS    0CL1                                                     15520021
DEBIRBAD DS    CL4                                                      15540021
DEBOPATB DS    0CL1                                                     15560021
DEBSYSPG DS    CL4                                                      15580021
DEBNMEXT DS    0CL1                                                     15600021
DEBUSRPG DS    CL4                                                      15620021
DEBPRIOR DS    0CL1                                                     15640021
DEBECBAD DS    CL4                                                      15660021
DEBPROTG DS    0CL1                                                     15680021
DEBDEBID DS    0CL1                                                     15700021
DEBDCBAD DS    CL4                                                      15720021
DEBEXSCL DS    0CL1                                                     15740021
DEBAPPAD DS    CL4                                                      15760021
DEBDVMOD DS    0CL1                                                     15780021
DEBUCBAD DS    CL4                                                      15800021
DEBBINUM DS    CL2                                                      15820021
DEBSTRCC DS    CL2                                                      15840021
DEBSTRHH DS    CL2                                                      15860021
DEBENDCC DS    CL2                                                      15880021
DEBENDHH DS    CL2                                                      15900021
DEBNMTRK DS    CL2                                                      15920021
*                                                                       15940021
           DCBD  DSORG=PS                                               15960021
*                                                                       15980021
**********************************************************************  16000021
*                                                                       16020021
           END                                                          16040021
