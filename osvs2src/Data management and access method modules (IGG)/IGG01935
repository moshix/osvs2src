         TITLE 'IGG01935 LOAD 1 OF LINE GROUP OPEN'                     00100010
IGG01935 CSECT                                                          00200010
*A-000000-999999                                               @X31X8N0 00201010
         SPACE 3                                                        00202010
*  CHANGE ACTIVITY AS FOLLOWS                                           00204010
******************** MICROFICHE FLAGS *********************** SUPT CODE 00206010
*A088000,141000                                                  A51063 00210010
*D499992,598000-603000,611000-612000                             A51063 00210610
*A318000,538840,590500,605000                                    A44886 00211210
*A095300,095600                                                   M1571 00211810
*C499996,500432                                                   M1571 00212410
*A605800                                                          M1571 00213010
*C153000,162000                                                  S22026 00213610
*C087000,088000,225000-227000,240000,311000,368000,442000,456000 S22025 00214210
*C499999,584000-589600,591000-592400,594000-597000,602000,603000 S22025 00214810
*C608000,611000-612600,615000-618000,633000,634000,638000,640000 S22025 00215410
*C641000                                                         S22025 00216010
*A002930,002960,055500                                           S22025 00216610
*C284300,360300,591700                                          SA65392 00216910
*A284000,329000,360000,581000                                   SA62357 00217210
*C329000,591700                                                 SA62357 00217810
*D327000                                                        SA62357 00218410
*A462000,637000                                                  X01004 00218510
*C249000-252000,374000,591700,628000                             X01004 00218610
*D080000,082000,329000,388000-425900,538070-538840,593200,       X01004 00218710
*D605300-605600,614000-618000,643000-645000,654000               X01004 00218810
*A107000,297000,606000                                           Y01004 00218910
*C252200,628500                                                  Y01004 00219010
*A095600,467000,572000                                           X02004 00219110
*A095900,457000,628900                                           Y05330 00219210
*C095800,452000                                                  Y05330 00219310
*D430100-430700                                                  Y05330 00219410
*C004600,024000,027000,033000,035000,049000,091600-094000,095780 Y02027 00219710
*C107000,252000,279000-283000,460000,576000-581000,582000-583000 Y02027 00220010
*C593500,604000,605000,605100,607000,609000,610000               Y02027 00220310
*D095000-095600                                                  Y02027 00220610
*A082000,091200,094500,297400,472300,473400,523160-523880        Y02027 00220910
*A612800-613200                                                  Y02027 00221210
*C300000,311000,342000,350000,351000,352000,353000,354000        Y02027 00221510
*C360000-360600,366000,376300,377000,380000,384000,427000,428000 Y02027 00221810
*C499700,499940,499984,499996,499998,500432,500532,572000,586400 Y02027 00222110
*D085000,581500,588000,588800,602100                             Y02027 00222410
*A228500*A228500,278500,297050,327000,647200-647600              Y02027 00222710
*C360700,360800                                                  Y02027 00223010
*C619800                                                        SA68037 00224410
*A373000,603000                                                @SA63601 00225410
*A360700,360800,602100                                          OY03305 00226410
*D373100-373700                                                @SA73348 00246410
*A364000                                                       @SA73348 00266410
*C004600,229000,243000,570040                                    X03039 00296010
*D095620-095860,225000,637300-637600                             X03039 00296410
*A002000,094500                                                @Z30X8NM 00296610
*C004600,430000,452000-452800,567000                           @Z30X8NM 00296810
*D453500,457000-457800,628640-628740,632500,635000             @Z30X8NM 00297010
*D637000-638000                                                @Z30X8NM 00297210
         SPACE 3                                                        00297410
*A352000,628560                                                @XA09807 00297810
*********************************************************************** 00298210
*                                                                     * 00299010
*  TITLE:  ' IGG01935 '  LOAD 1 OF LINE GROUP OPEN                    * 00300010
*                                                                     * 00320010
*  MODULE NAME = IGG01935                                             * 00340010
*                                                                     * 00360010
*  DESCRIPTIVE NAME = FIRST LOAD OF LINE GROUP OPEN                   * 00380010
*                                                                     * 00400010
*  COPYRIGHT = 'NONE'                                                 * 00420010
*                                                                     * 00440010
*  STATUS = CHANGE LEVEL 8                                     @Z30X8NM 00460010
*                                                                     * 00500010
*FUNCTION/OPERATION - THIS ROUTINE EXAMINES THE TASK INPUT/           * 00600010
*   OUTPUT TABLE TO DETERMINE THE NUMBER OF LINES IN THIS             * 00700010
*   LINE GROUP, AND GETS MAIN STORAGE FOR AND INITIALIZES A           * 00800010
*   DATA EXTENT BLOCK.  IT CHECKS EACH UNIT CONTROL BLOCK TO          * 00900010
*   VERIFY THAT SIMILAR DEVICES ARE ATTACHED TO EACH LINE,            * 01000010
*   AND THAT EITHER A 2701, 2702, OR 2703 CONTROL UNIT IS             * 01100010
*   BEING USED.  IGG01935 ALSO LOCATES A TYPICAL ENTRY IN             * 01200010
*   THE DEVICE CHARACTERISTICS TABLE FOR EACH LINE GROUP, SETS        * 01300010
*   AN INDEX INTO THE BRANCH TABLE IN IGG01936, AND CLEARS            * 01400010
*   A REGISTER TO CONTAIN THE LINE CONTROL BLOCK SIZE.                * 01500010
*                                                                     * 01600010
*ENTRY POINTS - THIS ROUTINE IS ENTERED AT IGG01935 VIA AN            * 01700010
*   XCTL FROM AN I/O SUPPORT MODULE OR FROM ANOTHER ACCESS            * 01800010
*   METHOD'S OPEN EXECTUTOR.  IT MAY ALSO BE RE-ENTERED FROM          * 01900010
*   THE RE-LOOP PORTION OF THIS ROUTINE IF IT DETERMINES THAT         * 02000010
*   THERE IS ANOTHER DATA CONTROL BLOCK TO BE OPENED.                 * 02100010
*                                                                     * 02200010
*INPUT - THE REGISTERS 5, 6, 7, AND 8 ARE THE INPUT AS FOLLOWS        * 02300010
*   5 - THE ADDRESS OF THE WTG TABLE PREFIX                      Y02027 02400010
*   6 -  THE ADDRESS OF THE BEGINNING OF THE WHERE-TO-GO TABLE.       * 02600010
*   7 - THE ADDRESS OF THE COPY OF THE CURRENT DCB               Y02027 02700010
*   8 -  THE ADDRESS OF THE CURRENT ENTRY IN THE WHERE-TO-GO          * 02900010
*        TABLE .                                                      * 03000010
*                                                                     * 03100010
*OUTPUT - REGISTERS 7 AND 8 WILL BE POSITIONED AT THE NEXT            * 03200010
*   ENTRIES IN THE DATA CONTROL BLOCK COPY LIST AND THE          Y02027 03300010
*   WHERE-TO-GO TABLE RESPECTIVELY.  A DEB WILL HAVE BEEN             * 03400010
*   BUILT AND INITIALIZED IN SUBPOOL 230.  THIS EXECUTOR'S       Y02027 03500010
*   ENTRY OR ENTRIES IN THE WHERE-TO-GO TABLE WILL HAVE BEEN          * 03600010
*   UPDATED TO IDENTIFY LINE GROUP LOAD II (IGG01936).                * 03700010
*                                                                     * 03800010
*EXTERNAL ROUTINES - NONE                                             * 03900010
*                                                                     * 04000010
*EXITS - NORMAL                                                       * 04100010
*   THIS ROUTINE EXITS VIA AN XCTL TO THE EXECUTOR IDENTIFIED         * 04200010
*   BY THE NEXT NON-ZERO ENTRY IN THE WHERE-TO-GO TABLE.              * 04300010
*                                                                     * 04400010
*      - ERROR                                                        * 04500010
*TABLES/WORKAREAS - THE WHERE-TO-GO TABLE CONTAINS THE ID AND         * 04700010
*   TTR OF THE OPEN EXECUTORS.  THE DATA CONTROL BLOCK                * 04800010
*   COPY LIST CONTAINS THE ADDRESSES OF THE COPY OF EACH DCB     Y02027 04900010
*   SPECIFIED IN THE OPEN MACRO INSTRUCTION.  THE ADDRESS             * 05000010
*   VECTOR TABLE IS A RESIDENT VECTOR LIST USED TO LOCATE             * 05100010
*   CERTAIN PARAMETERS WHICH ARE NEEDED IN BUILDING THE DEB.          * 05200010
*                                                                     * 05300010
*ATTRIBUTES - THIS ROUTINE IS EXECUTED IN THE TRANSIENT AREA          * 05400010
*   AS ENABLED, PRIVILEGED, AND REENTRANT.                            * 05500010
*********************************************************************** 05550010
         EJECT                                                          05600010
*  REGISTER USAGE                                                       05700010
*                                                                       05800010
RE       EQU   0                        WORK REGISTER                   05900010
RF       EQU   1                        WORK REGISTER                   06000010
RDCB     EQU   2                        ADDRESS OF THE CURRENT DCB      06100010
RTIOT    EQU   3                        ADDRESS OF THE TIOT             06200010
RCORE    EQU   4                        ADDRESS OF DCB WORK AREA        06300010
RPAR     EQU   5                        ADDRESS OF FIRST ENTRY IN       06400010
*                                                                       06500010
RWTG     EQU   6                        ADDRESS OF WHERE-TO-GO          06600010
*                                         TABLE                         06700010
RPARC    EQU   7                        ADDRESS OF CURRENT ENTRY IN     06800010
*                                         DCB PARAMETER LIST            06900010
RWTGC    EQU   8                        ADDRESS OF THE CURRENT          07000010
*                                         ENTRY IN WTG TABLE            07100010
RAVT     EQU   9                        ADDRESS OF THE AVT              07200010
RUCB     EQU   10                       ADDRESS OF CURRENT UCB          07300010
RDEB     EQU   11                       ADDRESS OF THE DEB              07400010
RBASE    EQU   12                       BASE OF THIS ROUTINE            07500010
RC       EQU   13                       WORK REGISTER                   07600010
RD       EQU   14                       WORK REGISTER                   07700010
RJ       EQU   15                       WORK REGISTER                   07800010
*                                                                       07900010
         USING IHADCB,RDCB              DCB DSECT                       08100010
         USING FORCORE,RCORE            OPEN WORK AREA DSECT     Y02027 08200010
         USING IEDQAVTD,RAVT            AVT DSECT                       08300010
         USING IEDQDEB,RDEB             DEB DSECT                       08400010
*                                                                       08600010
         BALR  RBASE,0                  SET UP BASE REGISTER     S22025 08700010
         USING *,RBASE                  AND ADDESSABILITY        S22025 08800010
         SPACE 2                                                        08820010
IGG01935 IEDHJN DATE                    MODULE ID AND DATE       S22025 08850010
*                                                                       08900010
RESTART  EQU   *                                                        09000010
         EJECT                                                   Y02027 09100010
         MODESET EXTKEY=SUPR            GET INTO KEY 0           Y02027 09120010
         SPACE 2                                                        09140010
         L     RCORE,OPWKAD(RWTGC)      LOAD THE ADDRESS OF      Y02027 09160010
*                                         THE OPEN WORK AREA     Y02027 09200010
         L     RDCB,DXUDCBAD            LOAD THE ADDRESS OF THE  Y02027 09230010
*                                         USER'S DCB             Y02027 09260010
         L     RAVT,DCBIOBAD            LOAD THE AVT ADDRESS     Y02027 09300010
         XC    DXCCW10(FOUR),DXCCW10    CLEAR IN CASE OF OPEN    Y02027 09330010
*                                         ERRORS                 Y02027 09360010
         CLI   DXUKEY,KEY6              IS INVOKER IN KEY 6      Y02027 09400010
         BNE   NOTKEY6                  NO, GO SET ERROR CODE    Y02027 09450010
         LA    RF,AVTEZERO(RAVT)        ADDRESS OF  AVT        @Z30X8NM 09480010
         SH    RF,AVTHA4                BACKUP TO PREFIX       @Z30X8NM 09510010
         CLI   ONE(RF),VSTCAM           CHECK VS ASSEMBLY      @Z30X8NM 09540010
         BNE   OSMCP                    NO, SET ERROR          @Z30X8NM 09570010
         CLC   0(TWO,RCORE),OPENERP     IS THIS A RETURN FROM THE       09600010
*                                         ERROR MODULE                  09700010
         BNE   TSTBUFIN                 NO, BRANCH                      09800010
         EJECT                                                          09900010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     10000010
*                                                                 *     10100010
*        THIS SECTION OF CODE IS EXECUTED ONLY WHEN THIS          *     10200010
*        MODULE IS RE-ENTERED FROM THE OPEN ERROR RECOVERY        *     10300010
*                  MODULE IGG01933                                *     10400010
*                                                                 *     10500010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     10600010
         L     RDEB,DCBDEBAD            LOAD ADDRESS OF THE      Y02027 10700010
*                                         CURRENT DEB                   10800010
         LA    RE,DEBPRFIX              LOAD THE LENGTH OF THE DEB      10900010
*                                         PREFIX                        11000010
         SR    RDEB,RE                  SET THE DEB BASE REGISTER       11100010
*                                         ADDRESS                       11200010
         L     RD,DEBUCBAD              LOAD THE ADDRESS OF THE         11300010
*                                         FIRST UCB                     11400010
         B     TESTDVCL                 TEST THE DEVICE CLASS FIELD     11430010
*                                         OF THE UCB                    11460010
         EJECT                                                          12300010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     12400010
*                                                                 *     12500010
*         THIS SECTION OF CODE INSURES THAT CERTAIN                *    12600010
*        MINIMUM VALUES ARE IN THIS DCB PRIOR TO                   *    12700010
*                  OPENING THE DCB                                *     12800010
*                                                                 *     12900010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     13000010
TSTBUFIN EQU   *                                                        13100010
         TM    DCBBUFIN,X'F0'           HAVE BUFFERS BEEN ASSIGNED      13200010
*                                         FOR RECEIVE OPERATIONS        13300010
         BNZ   TSTBUFOT                 YES, BRANCH                     13400010
         OI    DCBBUFIN,X'10'           NO, ASSIGN AT LEAST ONE         13500010
*                                         BUFFER FOR RECEIVE            13600010
*                                         OPERATIONS                    13700010
TSTBUFOT EQU   *                                                        13800010
         TM    DCBBUFOU,X'0E'           HAVE BUFFERS BEEN ASSIGNED      13900010
*                                         FOR SENDING OPERATIONS        14000010
         BNZ   TSTBFMAX                 YES, BRANCH                     14100010
         NI    DCBBUFOU,X'F0'           TURN OFF X'01' BIT IF ON A51063 14150010
         OI    DCBBUFOU,X'02'           NO, ASSIGN AT LEAST TWO         14200010
*                                         BUFFERS FOR SENDING           14300010
*                                         OPERATIONS                    14400010
TSTBFMAX EQU   *                                                        14500010
         TM    DCBBUFMA,X'0E'           HAVE THE MINIMUM NUMBER OF      14600010
*                                         BUFFERS BEEN ASSIGNED FOR     14700010
*                                         DATA TRANSFER                 14800010
         BNZ   TESTPCI                  YES, BRANCH                     14900010
         OI    DCBBUFMA,X'02'           ASSIGN AT LEAST TWO             15000010
*                                         BUFFERS FOR DATA TRANSFER     15100010
TESTPCI  EQU   *                                                        15200010
         TM    DCBPCI,X'AA'             HAS A PCI OPTION BEEN    S22026 15300010
*                                         SPECIFIED FOR RECEIVING       15400010
*                                         OPERATIONS                    15500010
         BNZ   TESTPCIS                 YES, BRANCH                     15600010
         OI    DCBPCI,X'20'             NO, PCI WILL OCCUR DURING       15700010
*                                         FILLING OF THE SECOND         15800010
*                                         BUFFER FOR RECEIVE            15900010
*                                         OPERATIONS                    16000010
TESTPCIS EQU   *                                                        16100010
         TM    DCBPCI,X'55'             HAS A PCI OPTION BEEN    S22026 16200010
*                                         SPECIFIED FOR SENDING         16300010
*                                         OPERATIONS                    16400010
         BNZ   SETBFMAX                 YES, BRANCH                     16500010
         OI    DCBPCI,X'10'             NO, PCI WILL OCCUR DURING       16600010
*                                         EMPTYING OF THE SECOND        16700010
*                                         BUFFER FOR SENDING            16800010
*                                         OPERATIONS                    16900010
         EJECT                                                          16903010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     16906010
*                                                                 *     16909010
*        THIS SECTION OF CODE INSURES THAT BUFMAX IS AS GREAT     *     16912010
*        AS OR GREATER THAN THE GREATER OF BUFIN AND BUFOUT       *     16915010
*                                                                 *     16918010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     16921010
SETBFMAX EQU   *                                                        16924010
         SR    RF,RF                    CLEAR A REGISTER                16927010
         LA    RE,FIFTEN                LOAD AN ANDING VALUE            16930010
         IC    RD,DCBBUFOU              GET THE BUFOUT VALYE            16933010
         NR    RD,RE                    CLEAR THE BUFIN VALUE           16936010
         IC    RF,DCBBUFIN              GET THE BUFIN VALUE             16939010
         SRL   RF,FOUR                  CLEAR THE LOW ORDER 4 BITS      16942010
         CR    RF,RD                    COMPARE THE 2 VALUES            16945010
         BL    USEOTHER                 BRANCH IF BUFIN IS LOW          16948010
         LR    RD,RF                    COPY THE LARGER VALUE           16951010
USEOTHER EQU   *                                                        16954010
         IC    RF,DCBBUFMA              LOAD THE BUFMAX VALUE           16957010
         NR    RF,RE                    CLEAR THE LEADING 4 BITS        16960010
         CR    RF,RD                    COMPARE THE 2 VALUES            16963010
         BNL   BUFFERTN                 BRANCH IF RF IS NOT LESS        16966010
         STC   RD,DCBBUFMA              STORE THE NEW VALUE FOR         16969010
*                                         BUFMAX                        16972010
         EJECT                                                          16975010
BUFFERTN EQU   *                                                        17000010
         IC    RD,DCBUNTCT              INSERT THE SPECIAL              17100010
*                                         CHARACTERS OFFSET             17200010
         STC   RD,DCBSCTAD+2            STORE THE SPECIAL               17300010
*                                         CHARACTERS OFFSET IN          17400010
*                                         ANOTHER LOCATION              17500010
         SR    RE,RE                    CLEAR REMAINDER REGISTER        17600010
         LH    RJ,AVTKEYLE              GET THE SIZE OF 1 UNIT          17650010
         LH    RF,DCBBUFSI              LOAD THE DESIRED BUFFER         17700010
*                                         SIZE                          17800010
         LTR   RF,RF                    CHECK FOR NO BUFSIZ SPECIFD     17900010
         BNZ   BUFSIZ                   BRANCH IF IN DCB                18000010
         LR    RF,RJ                    DEFAULT TO AVTKEYLE VALUE       18100010
         STH   RF,DCBBUFSI              STORE THE DEFAULT VALUE IN      18130010
*                                         THE DCB                       18160010
BUFSIZ   EQU   *                                                        18200010
         DR    RE,RJ                    DIVIDE THE BUFFER SIZE BY       18400010
*                                         THE SIZE OF 1 LINE UNIT       18500010
         LTR   RE,RE                    WAS THERE A REMAINDER           18600010
         BZ    UNITCNT                  NO, BRANCH                      18700010
         LA    RF,1(RF)                 INCREMENT UNIT COUNT BY 1       18800010
UNITCNT  EQU   *                                                        18900010
         STC   RF,DCBUNTCT              STORE THE NUMBER OF UNITS       19000010
*                                         REQUIRED FOR 1 BUFFER         19100010
         EJECT                                                          19200010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     19300010
*                                                                 *     19400010
*        THIS SECTION OF CODE INSURES THAT THE HEADER PREFIX      *     19500010
*        SIZE AND THE NUMBER OF IDLE CHARACTERS RESERVED FOR      *     19600010
*        RECEIVING OPERATIONS PLUS ONE DO NOT EXCEED ONE          *     19700010
*                       LOGICAL UNIT                              *     19800010
*                                                                 *     19900010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     20000010
         SR    RF,RF                    CLEAR A SIZE REGISTER           20100010
         IC    RF,DCBRESER              INSERT THE NUMBER OF IDLE       20200010
*                                         CHARACTERS RESERVED FOR       20300010
*                                         RECEIVING OPERATIONS          20400010
         LA    RF,AVTHDRSZ+1(RF)        ADD TO THIS THE SIZE OF A       20500010
*                                         HEADER PREFIX + 1             20600010
         CR    RF,RJ                    COMPARE THIS SIZE TO THE        20700010
*                                         SIZE OF ONE LOGICAL UNIT      20800010
         BNH   LOADTCB                  BRANCH, UNIT SIZE IS LARGER     20900010
         MVI   AVTOPERT,TCAMER12        MOVE THE ERROR IDENTIFIER       21000010
*                                         FOR TCAM INTO THE AVT         21100010
         B     WTGSETUP                 SET THE WHERE-TO-GO ENTRY       21500010
         EJECT                                                          21600010
LOADTCB  EQU   *                                                        21700010
         L     RD,AVTTCB                LOAD THE TCB ADDRESS FROM       21800010
*                                         THE AVT                       21900010
         L     RTIOT,TIOTPTR(RD)        GET POINTER TO THE TIOT         22000010
         AH    RTIOT,DCBTIOT            ADD DDOFFSET TO STARTING        22100010
*                                         POINT OF TIOT                 22200010
         LR    RD,RTIOT                 COPY TIOT ENTRY POINTERS        22300010
*                                                                       22400010
         SR    RC,RC                    WORK                     S22025 22600010
         SR    RCORE,RCORE              REGISTERS                S22025 22700010
         LA    RJ,TIOTENT               LOAD THE SIZE OF A STANDARD     22800010
*                                         TIOT ENTRY             X03039 22810010
         EJECT                                                          22820010
DDNAM01  EQU   *                                                 X03039 22930010
         SR    RF,RF                    CLEAR FOR AN INSERT      X03039 22960010
         LA    RCORE,ONE(RCORE)         INCREMENT COUNTER FOR EACH      23000010
*                                         CONCATENATED DDNAME           23100010
         IC    RF,0(RD)                 GET LENGTH OF THE DD ENTRY      23200010
         AR    RD,RF                    GET POINTER TO NEXT ENTRY       23300010
*                                         IN TIOT                       23400010
         SR    RF,RJ                    SUBTRACT THE SIZE FROM THE      23500010
*                                         TOTAL ENTRY LENGTH            23600010
         AR    RC,RF                    TOTAL UCB'S FOR THE NUMBER      23700010
*                                         OF EXTENTS                    23800010
         CLI   0(RD),X'00'              TEST FOR END OF TIOT            23900010
         BE    DEBSIZE                  BRANCH IF END            S22025 24000010
*                                                                       24100010
         CLI   4(RD),X'40'              TEST FOR A BLANK DDNAME         24200010
         BE    DDNAM01                  DATA SET IS CONCATENATED X03039 24300010
*                                                                       24400010
         EJECT                                                          24500010
DEBSIZE  EQU   *                                                        24600010
         LA    RF,MINDEBSZ(RC)          MINIMUM DEB SIZE TO THE         24700010
*                                         NUMBER OF UXB'S               24800010
         SRL   RF,THREE                 GET NUMBR OF DOUBLEWORDS X01004 24900010
*                                         IN DEB                 X01004 24950010
         LR    RUCB,RF                  SAVE DEB SIXE            X01004 25000010
         SLL   RF,THREE                 BYTE LENGTH FOR GETMAIN  X01004 25100010
         MVI   AVTGETMN+NINE,SP230      SUBPOOL FOR DEB.         Y02027 25200010
         LA    RE,AVTGETMN+4            GET ADDRESS OF WORD TO HOLD     25400010
*                                         ADDRESS OF DEB                25500010
         BAL   RD,AVTPAR                SET UP GETMAIN PARAMETER        25600010
*                                         LIST                          25700010
*                                                                       25800010
         L     RDEB,AVTGETMN+4          LOAD ADDRESS OF THE DEB         25900010
         XC    0(68,RDEB),0(RDEB)       CLEAR THE DEB                   26000010
         L     RF,CVT                   LOAD THE CVT ADDRESS            26100010
         L     RF,20(RF)                LOAD THE ADDRESS OF THE IOS     26200010
*                                         APPENDAGE TABLE               26300010
         MVC   0(20,RDEB),0(RF)         MOVE THE APPENDAGE              26400010
*                                       ADDRESSES INTO THE DEB          26500010
         SRL   RC,TWO                   DIVIDE UCB SUZE BY 4 TO GET     26600010
*                                         NUMBER OF EXTENTS             26700010
         STC   RC,DEBNMEXT              STORE NUMBER OF EXTENTS IN      26800010
*                                         THE DEB                       26900010
*                                                                       27000010
         MVC   DEBTCBAD+1(3),AVTTCB+1   MOVE THE TCB ADDRESS            27100010
*                                         INTO THE DEB                  27200010
         ST    RDEB,DEBAPPAD            STORE THE ADDRESS OF THE        27300010
*                                         DEB APPENDAGE                 27400010
         MVI   DEBEXSCL,X'02'           MOVE IN 2 FOR NON-DIRECT        27500010
*                                         ACCESS DEVICE                 27600010
         L     RD,AVTTCB                LOAD THE TCB ADDRESS FROM       27700010
*                                         THE AVT                       27800010
         USING IEDQTCB,RD               TCB DSECT                Y02027 27850010
         L     RE,TCBDEB                ADDR 1ST DEB IN CHAIN    Y02027 27900010
         LA    RF,DEBNMSUB              GET ADDR OF NEW DEB      Y02027 28000010
CHAINDEB ST    RE,DEBDEBAD              POINT NEW DEB TO 1ST     Y02027 28100010
         CS    RE,RF,TCBDEB             CHAIN NEW TO TCB IF      Y02027 28200010
         BNE   CHAINDEB                   TCBDEB HAS NOT CHNGED  Y02027 28300010
         MVI   DEBAMLNG,AMLNG           SET SIZE OF ACCESS METH SA65392 28430010
*                                         WORKAREA              SA62357 28460010
         ST    RF,DCBDEBAD              STORE THE DEB ADDRESS INTO      28900010
*                                         THE DCB                       29000010
         ST    RDCB,DEBDCBAD            STORE THE DCB ADDRESS INTO      29100010
*                                         THE DEB                       29200010
         MVC   DEBPROTG(1),TCBPKF       MOVE PROTECTION TAG FROM        29300010
*                                         THE TCB TO THE DEB            29400010
         OI    DEBPROTG,X'0F'           OR IN A DEB IDENTIFIER          29500010
         STC   RUCB,DEBLNGTH            STORE NUMBER OF DOUBLES         29600010
*                                         WORDS IN THE DEB              29700010
         DROP  RD                       DROP TCB DSECT           Y02027 29705010
         SPACE 2                                                        29710010
         DEBCHK (RDCB),TYPE=ADD,AM=TCAM INSERT DEB IN CHAIN      Y01004 29720010
         SPACE 2                                                        29730010
         ST    RF,DCBDEBAD              STORE DEB ADDR.          Y02027 29740010
         LA    RJ,DEBUCBAD              LOAD THE ADDRESS OF THE         29800010
*                                         FIRST DEB EXTENT              29900010
         LA    RE,TIOTENT+ONE           LOAD THE LENGTH OF TIOT  Y02027 30000010
*                                         ENTRY + 1                     30100010
         EJECT                                                          30200010
DEBMOVE  EQU   *                                                        30300010
         SR    RF,RF                    CLEAR WORK REGISTER             30400010
         IC    RF,0(RTIOT)              GET LENGTH OF TIOT ENTRY        30500010
*                                                                       30600010
*    START OF TIOT                                                      30700010
         SR    RF,RE                    SUBTRACT 17 FROM THE LENGTH     30800010
*                                         16 FOR ENTRY AND 1 FOR        30900010
*                                         THE EXECUTE                   31000010
         EX    RF,MOVEUCB               MOVE UCB INFO FROM       Y02027 31100010
*                                         THE TIOT TO THE DEB           31200010
         MVI   ZIP(RJ),ZIP              CLEAR TIOT STATUS BYTE   Y02027 31230010
*                                       FROM UCB INFO            Y02027 31260010
         LA    RJ,1(RJ,RF)              INCREASE DEB POINTER BY         31300010
*                                         LENGTH OF UCB INFORMATION     31400010
         LA    RTIOT,17(RTIOT,RF)       BUMP POINTER TO NEXT ENTRY      31500010
*                                         IN TIOT                       31600010
         BCT   RCORE,DEBMOVE            DECREASE THE NUMBER OF DD       31700010
*                                         ENTRIES BY 1                  31800010
         TM    0(RPARC),OUTONLY         LINE BEING OPENED FOR    A44886 31810010
*                                         OUTPUT ONLY            A44886 31820010
         BO    DEVANLYZ                 BR, YES                  A44886 31830010
         CLC   DEBNMEXT,DCBILCT         EXTENTS RELATIVE TO THE  A44886 31840010
*                                         INVITATION LISTS       A44886 31850010
         BH    TERMERR                  BR, INSUFFICIENT         A44886 31860010
         EJECT                                                          31900010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     32000010
*                                                                 *     32100010
*       THE FOLLOWING SECTION OF CODE TESTS ALL UCB DEVICE CODES  *     32200010
*       IN THIS LINE GROUP                                        *     32300010
*                                                                 *     32400010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     32500010
DEVANLYZ EQU   *                                                        32600010
         USING UCB,RD                   UCB ADDRESSABILITY       Y02027 32700010
         SR    RJ,RJ                    REGISTER                        32800010
         IC    RJ,DEBNMEXT              NUMBER EXTENTS          SA62357 32910010
         SLL   RJ,TWO                   TIMES FOUR              SA62357 32920010
         LA    RTIOT,DEBUCBAD(RJ)       POINT TO ACCESS METHOD  SA62357 32930010
*                                         WORK AREA             SA62357 32940010
         SR    RJ,RJ                    CLEAR WORK REGISTER     SA62357 32950010
         LA    RE,FOUR                  SET AN INCREMENT OF 4           33000010
         LR    RF,RC                    SET THE NUMBER OF EXTENTS       33100010
         BCTR  RF,0                     REDUCE THE NUMBER OF            33200010
*                                         EXTENTS BY 1                  33300010
         SLL   RF,TWO                   NULTIPLY THE NUMBER OF          33400010
*                                         EXTENTS BY 4                  33500010
         SR    RC,RC                    CLEAR A REGISTER TO HOLD        33600010
*                                         THE CONTROL UNIT TYPE         33700010
DUMYTEST EQU   *                                                        33800010
         L     RD,DEBUCBAD(RJ)          LOAD THE ADDRESS OF THE         33900010
*                                         FIRST/NEXT UCB                34000010
         LTR   RD,RD                    IS THIS A // DD DUMMY ENTRY     34100010
         BNZ   LOOPUCB                  NO, BRANCH               Y02027 34200010
         BXLE  RJ,RE,DUMYTEST           INCREMENT THE INDEX             34300010
         B     DUMMYDCB                 BRANCH THERE HAS BEEN AN        34400010
*                                         ERROR                         34500010
NEXTUCB  EQU   *                                                        34600010
         L     RCORE,DEBUCBAD(RJ)       LOAD THE ADDRESS OF THE         34700010
*                                         NEXT UCB                      34800010
         LTR   RCORE,RCORE              IS THIS A // DD DUMMY ENTRY     34900010
         BZ    LOOPUCB                  YES, BRANCH              Y02027 35000010
         MVC   ZIP(FOUR,RWTGC),UCBTYP   MOVE FIRST UCB DEVICE    Y02027 35100010
*                                       CODE TO THE WORK AREA    Y02027 35200010
         XC    ZIP(FOUR,RWTGC),UCBTYP-UCBOB(RCORE) COMPARE DEVICEY02027 35300010
*                                       CODES OF FIRST/NEXT UCB  Y02027 35400010
         CLI   EIGHTEEN(RD),GRAPHIC     GRAPHICS DEVICE        @XA09807 35410010
         BNE   UCBTEST                  NO, BRANCH             @XA09807 35420010
         CLI   NINETEEN(RD),D3277       3277 DISPLAY           @XA09807 35430010
         BNE   UCBTEST                  NO, BRANCH             @XA09807 35440010
         NI    ONE(RWTGC),ALARMOFF      TURN OFF AUDIBLE ALARM @XA09807 35450010
UCBTEST  EQU   *                                               @XA09807 35460010
         NC    0(4,RWTGC),HOLDMASK      REMOVE ALL IRELEVENT BITS       35500010
*                                         FROM DEVICE CODE              35600010
         BC    4,BADEVICE               BRANCH IF NOT ZERO TO           35700010
*                                         DEVICE ERROR                  35800010
         EJECT                                                          35900010
LOOPUCB  EQU   *                                                 Y02027 36000010
         L     RCORE,UCBEXTPT           POINT TO UCB EXTENSION   Y02027 36010010
         MVC   FOUR(ONE,RTIOT),UCBETI-UCBCMEXT(RCORE) SAVE       Y02027 36030010
*                                       ERROR TAB                Y02027 36060010
         MVC   FIVE(ONE,RTIOT),UCBATI-UCBCMEXT(RCORE) SAVE       Y02027 36070010
*                                       ATTENTION TAB            Y02027 36080010
         BXLE  RJ,RE,NEXTUCB            ADD 4 TO RJ,COMPARE TO RF,      36100010
*                                         AND GO TO NEXTUCB IF          36200010
*                                         TOTAL IS LOW OR EQUAL TO      36300010
*                                         TOTAL IN RF                   36400010
         TM    UCBUNTYP,TYP3270         COULD THIS BE A 3270   @SA73348 36410010
*                                        DEVICE ?              @SA73348 36420010
         BZ    TESTDVCL                 NO, BRANCH TO CONTINUE @SA73348 36430010
         TM    UCBUNTYP,TYPE3270        IS THIS A 3277,3284    @SA73348 36440010
*                                        OR 3286               @SA73348 36450010
         BZ    TESTDVCL                 NO, BRANCH TO CONTINUE @SA73348 36460010
         TM    DCBPCI,DCBPCIN1          IS PCI 'N' SPECIFIED   @SA73348 36470010
         BO    TESTDVCL                 YES, PCI OK FOR 3270   @SA73348 36480010
         MVI   DCBPCI,DCBPCIX1+DCBPCIN2  SET PCI TO 'XN'       @SA73348 36490010
TESTDVCL EQU   *                                                        36500010
         CLI   UCBDVCLS,TPDEVCD         IS THIS TP               Y02027 36600010
*                                         EQUIPMENT                     36700010
         BE    TESTADPT                 BRANCH IF YES            S22025 36800010
         CLI   UCBDVCLS,GRAPHICS        IS THE TGRAPHICS EQUIP.  Y02027 36900010
         BNE   BADVCLS                  AN ERROR, SOMETHING BESIDES     37000010
*                                         TELECOMMUNICATIONS            37100010
*                                         OR GRAPHICS EQUIPMENT WAS     37200010
*                                         SPECIFIED                     37300010
         B     ENDLOAD1                 THIS IS A 2260 LOCAL, DO X01004 37400010
*                                         NOT TEST THE ADAPTER TYPE     37500010
TESTADPT EQU   *                                                        37600010
         CLI   UCBUNTYP,AUDIOCTL        IS THIS A 7770 AUDIO UNITY02027 37630010
         BE    INSERT                   YES, BRANCH                     37660010
         TM    UCBUNTYP,CNTRLUNT        COULD THIS POSSIBLY BE   Y02027 37700010
*                                         2701, 2702, OR A 2703         37800010
         BZ    BADCNTRL                 NO, BRANCH                      37900010
         TM    UCBUNTYP,NOCONTRL        COULD IT BE SOMETHING    Y02027 38000010
*                                         BESIDES THE NORMAL            38100010
*                                         CONTROL UNIT                  38200010
         BNZ   BADCNTRL                 YES, BRANCH                     38300010
INSERT   EQU   *                                                        38350010
         IC    RC,UCBUNTYP              PICK UP THE ADAPTER AND  Y02027 38400010
*                                         CONTROL UNIT BITS             38500010
         SRL   RC,FOUR                  CLEAR OUT LOW ORDER BITS OF     38600010
*                                         2701,2702,OR 2703             38700010
         EJECT                                                          42595010
ENDLOAD1 EQU   *                                                        42600010
         LA    RD,UCBTYP                INCREMENT THE UCB        Y02027 42700010
*                                       STARTING ADDRESS         Y02027 42800010
         SR    RUCB,RUCB                CLEAR INDEX REGISTER            42900010
         MVC   AVTEZERO(TWO,RWTGC),AQTAMLD2 MOVE ID TO WTG TBL @Z30X8NM 43000010
         L     RJ,FOUR(RWTGC)           LOAD ADDRESS OF THE WORK        43100010
*                                         AREA                          43200010
         STM   0,15,0(RJ)               SAVE REGISTERS IN WORK AREA     43300010
*                                                                       43400010
RELOOP   EQU   *                                                        43500010
         LA    RWTGC,EIGHT(RWTGC)       INCREMENT CURRENT WTG           43600010
*                                         REGISTER                      43700010
         LA    RPARC,FOUR(RPARC)        INCREMENT CURRENT DCB           43800010
*                                         REGISTER                      43900010
         CLC   0(2,RWTGC),AMIDCNST      IS THIS EXECUTOR NEEDED         44000010
*                                         AGAIN                         44100010
         BE    RESTART                  YES, BRANCH FOR NEXT DCB S22025 44200010
*                                                                       44300010
         CLC   0(2,RWTGC),OPIDCNST      TEST FOR END OF WTG TABLE       44400010
         BNE   RELOOP                   GO CHECK NEXT ENTRY             44500010
*                                                                       44600010
         LR    RPARC,RPAR               RESET DCB AND                   44700010
         LA    RWTGC,FIRSTID(RWTG)      WTG POINTERS                    44800010
*                                                                       44900010
ZCHECK   EQU   *                                                        45000010
         CLI   0(RWTGC),X'00'           IS THE FIRST ENTRY ZERO         45100010
         BNE   XCTLRTNE                 NO, XCTL TO NEXT LOAD  @Z30X8NM 45200010
*                                                                       45300010
         LA    RWTGC,EIGHT(RWTGC)       IF ZERO, INCREMENT POINTERS     45400010
         LA    RPARC,FOUR(RPARC)          AND RETURN TO ZCHECK          45500010
         B     ZCHECK                   XCTL TO NEXT MODULE      S22025 45600010
*                                                                       45800010
XCTLRTNE EQU   *                                                        45900010
         LA    RJ,DXCCW12-FORCORE(RJ)   POINT TO DOUBL WORD LIST Y02027 46000010
         MVC   6(2,RWTG),0(RWTGC)       MOVE ID TO NAME FIELD           46100010
         MVC   14(3,RWTG),2(RWTGC)      MOVE TTR TO WTG TABLE           46200010
ENDLOAD3 EQU   *                                                 X01004 46250010
         XCTL  DE=(RWTG),SF=(E,(15))                                    46300010
         EJECT                                                          46400010
AVTPAR   EQU   *                                                        46500010
         ST    RF,AVTGETMN              STORE BYTE COUNT IN AVT         46600010
*                                         PARAMETER LIST                46700010
         ST    RE,AVTGETMN+4            STORE ADDRESS OF WORD IN        46800010
*                                         SECOND WORD OF AVT            46900010
*                                         PARAMETER LIST                47000010
         LA    RF,AVTGETMN              LOAD ADDRESS OF AVT             47100010
*                                         PARAMETER LIST                47200010
         MODESET EXTKEY=DATAMGT         GET INTO KEY 5           Y02027 47230010
         SPACE 2                                                        47260010
         GETMAIN  ,MF=(E,(1))           GETMAIN MACRO                   47300010
         SPACE 2                                                        47320010
         MODESET EXTKEY=SUPR            RETURN TO KEY 0          Y02027 47340010
         SPACE 2                                                        47360010
         LTR   RJ,RJ                    TEST THE RETURN CODE            47400010
         BNE   GETERR                   GETMAIN FAILED                  47500010
         BR    RD                       RETURN TO CALLER                47600010
         EJECT                                                          47610010
OSMCP    EQU   *                                                 X02004 47620010
         MVI   AVTOPERT,EXERROS         SET OPEN ERROR TYPE      X02004 47630010
         MVI   AVTOPERL,EXERR06         SET MODULE LOAD ID       X02004 47640010
         B     WTGSETUP                 EXIT TO ERROR MODULE     X02004 47650010
         EJECT                                                          47700010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     47800010
*                                                                 *     47900010
*        THIS SECTION OF ERROR CODE IS EXECUTED ONLY WHEN         *     48000010
*        WE ARE UNABLE TO GET ENOUGH MAIN STOTAGE TO BUILD        *     48100010
*                       A LINE GROUP DEB                          *     48200010
*                                                                 *     48300010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     48400010
GETERR   EQU   *                                                        48500010
         MVI   AVTOPERT,TCAMER01        MOVE THE ERROR IDENTIFIER       48600010
*                                         FOR TCAM INTO THE AVT         48700010
         B     WTGSETUP                 SET THE WHERE-TO-GO ENTRY       49100010
         EJECT                                                          49200010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     49300010
*                                                                 *     49400010
*        THIS SECTION OF ERROR CODE IS EXECUTED ONLY WHEN         *     49500010
*        UNLIKE DEVICES ARE FOUND TO BE IN THE SAME LINE GROUP    *     49600010
*                                                                 *     49700010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     49800010
BADEVICE EQU   *                                                        49900010
         TM    0(RWTGC),FIFTEN          ARE THE MODEL CODES DIFFERENT   49950010
         BZ    SHIFTDEB                 NO, BRANCH                      49960010
         TM    UCBUNTYP,TYPEI           IS THIS A TYPE I ADAPTER Y02027 49970010
         BZ    SHIFTDEB                 NO, BRANCH                      49980010
         L     RCORE,DEBUCBAD(RJ)       LOAD THE UCB ADDRESS OF THE     49990010
*                                         SECOND DEVICE                 49992010
         TM    UCBTBYT1,TST2741C        IS THIS A 2741           Y02027 49994010
*                                         CORRESPONDENCE DEVICE         49996010
         BO    TEST01                   YES, BRANCH                     49998010
         TM    UCBTBYT1,TST2741E        IS THIS A 2741 EBCD DEV  Y02027 49998410
         BNO   SHIFTDEB                 NO, BRANCH                      49998810
         TM    UCBTBYT1-UCBOB(RCORE),TST2741C OTHER DEV A 2741   Y02027 49999610
*                                         CORRESPONDENCE TERMINAL       49999710
         BO    LOOPUCB                  YES, IGNORE THE ERROR    Y02027 49999810
         B     SHIFTDEB                 OTHERWISE, ERROR IS SET  S22025 49999910
TEST01   EQU   *                                                        50033210
         TM    UCBTBYT1-UCBOB(RCORE),TST2741E OTHER DEV A 2741E  Y02027 50043210
         BO    LOOPUCB                  YES, IGNORE THE ERROR    Y02027 50053210
SHIFTDEB EQU   *                                                        50063210
         SRL   RJ,TWO                   DIVIDE THE BXLE INDEX BY 4      50066710
*                                         TO DETERMINE THE NUMBER       50100010
*                                         OF GOOD EXTENTS               50200010
         STC   RJ,DEBNMEXT              STORE THIS VALUE IN THE DEB     50300010
         MVI   AVTOPERT,TCAMER02        MOVE THE ERROR IDENTIFIER       50400010
*                                         FOR TCAM INTO THE AVT         50500010
         B     WTGSETUP                 SET THE WHERE-TO-GO ENTRY       50900010
         EJECT                                                          51000010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     51100010
*                                                                 *     51200010
*        THIS SECTION OF ERROR CODE IS EXECUTED ONLY WHEN         *     51300010
*        AN UNACCEPTABLE DEVICE CLASS IS FOUND IN THE UCB         *     51400010
*                                                                 *     51500010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     51600010
BADVCLS  EQU   *                                                        51700010
         MVI   AVTOPERT,TCAMER03        MOVE THE ERROR IDENTIFIER       51800010
*                                         FOR TCAM INTO THE AVT         51900010
         B     WTGSETUP                 SET THE WHERE-TO-GO ENTRY       52300010
         SPACE 3                                                 Y02027 52308010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *Y02027 52316010
*                                                               *Y02027 52324010
*        THIS SECTION OF ERROR CODE IS EXECUTED ONLY WHEN       *Y02027 52332010
*        THE INVOKER OF THIS MODULE IS NOT RUNNING IN KEY 6     *Y02027 52340010
*                                                               *Y02027 52348010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *Y02027 52356010
NOTKEY6  EQU   *                                                 Y02027 52364010
         MVI   AVTOPERT,UNAUTHL         INDICATE THAT INVOKER IS Y02027 52372010
*                                       NOT IN KEY 6             Y02027 52380010
         B     WTGSETUP                 SET THE WHERE-TO-GO ENTRYY02027 52388010
         EJECT                                                          52400010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     52500010
*                                                                 *     52600010
*        THIS SECTION OF ERROR CODE IS EXECUTED ONLY WHEN         *     52700010
*        THE USER HAS FAILED TO PROVIDE ANY VALID UCB             *     52800010
*        NAMES ON HIS DD CARDS OTHER THAN 'DUMMY'                 *     52900010
*                                                                 *     53000010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     53100010
DUMMYDCB EQU   *                                                        53200010
         MVI   AVTOPERT,TCAMER11        MOVE THE ERROR IDENTIFIER       53300010
*                                         FOR TCAM INTO THE AVT         53400010
         B     WTGSETUP                 SET THE WHERE-TO-GO ENTRY       53800010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *A44886 53885010
*                                                                A44886 53886010
*        THIS SECTION OF ERROR CODE IS EXECUTED WHEN THE NUMBER  A44886 53887010
*        OF INVITATION LISTS IS LESS THAN THE ONE PER LINE       A44886 53888010
*        REQUIREMENT FOR EACH LINE IN THE LINE GROUP             A44886 53889010
*                                                                A44886 53890010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *A44886 53891010
*                                                                A44886 53892010
TERMERR  EQU   *                                                 A44886 53893010
         MVI   AVTOPERT,TCAMER24        SET THE ERROR INDICATOR  A44886 53894010
         B     WTGSETUP                 TAKE ERROR EXIT          A44886 53895010
         EJECT                                                          53900010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     54000010
*                                                                 *     54100010
*        THIS SECTION OF ERROR CODE IS EXECUTED ONLY WHEN         *     54200010
*        AN UNSUPPORTED CONTROL UNIT IS FOUND IN THE UCB          *     54300010
*                                                                 *     54400010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     54500010
BADCNTRL EQU   *                                                        54600010
         MVI   AVTOPERT,TCAMER04        MOVE THE ERROR IDENTIFIER       54700010
*                                         FOR TCAM INTO THE AVT         54800010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     55200010
*                                                                 *     55300010
*        THIS SECTION OF CODE IS USED TO SAVE THE ID OF THE       *     55400010
*        CURRENT OPEN EXECUTOR AND TO MOVE THE ID OF THE          *     55500010
*        ERROR RECOVERY MODULE INTO THE WHERE-TO-GO PARAMETER     *     55600010
*                            LIST                                 *     55700010
*                                                                 *     55800010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     55900010
WTGSETUP EQU   *                                                        56000010
         L     RJ,FOUR(RWTGC)           LOAD THE ADDRESS OF THE         56100010
*                                         OPEN WORK AREA                56200010
         MVC   AVTOPXCL(2),AMIDCNST     MOVE THE ID OF THE CURRENT      56300010
*                                         EXECUTOR INTO THE AVT         56400010
*                                         FOR THE RETURN TO THIS        56500010
*                                         EXECUTOR                      56600010
         MVC   AVTEZERO(TWO,RWTGC),OPENERP MOVE ID FOR THE     @Z30X8NM 56700010
*                                         ERROR MODULE INTO THE         56800010
*                                         WHERE-TO-GO PARAMETER LIST    56900010
         B     XCTLRTNE                 BRANCH TO THE XCTL ROUTINE      57000010
         EJECT                                                          57100010
MOVEUCB  MVC   ZIP(ONE,RJ),TIOTUCB(RTIOT) MOVE UCB INFO          Y02027 57200010
EXERROS  EQU   31                       CODE OF OS ASSEMBLY MCP  X02004 57300010
ALL      EQU   15                       MASK FOR ICM OF 4 BYTES  X02004 57400010
ONE      EQU   1                        NUMERIC CONSTANT         Y02027 57600010
TWO      EQU   2                        NUMERIC CONSTANT         Y02027 57650010
THREE    EQU   3                        NUMERIC CONSTANT         Y02027 57700010
FOUR     EQU   4                        NUMERIC CONSTANT         Y02027 57800010
FIVE     EQU   5                        NUMERIC CONSTANT         Y02027 57900010
EIGHT    EQU   8                        NUMERIC CONSTANT         Y02027 58000010
TIOTPTR  EQU   12                       TIOT POINTER IN TCB      Y02027 58200010
FIFTEN   EQU   15                       NUMERIC CONSTANT         Y02027 58250010
TIOTENT  EQU   16                       TIOT SIZE                Y02027 58300010
CVT      EQU   16                       CVT ADDRESS              S22025 58400010
MODLCODE EQU   16                       MODEL CODE OFFSET IN UCB S22025 58480010
TCAMER11 EQU   17                       INVALID UCB ADDRESS      S22025 58560010
TIOTUCB  EQU   16                       TIOT OFFSET OF UCB INFO  Y02027 58640010
TCAMER12 EQU   18                       INCORRECT BUFFER SIZE    S22025 58720010
TCAMER22 EQU   22                       INVALID OPTIONAL FEATURESS22025 58960010
TCAMER24 EQU   24                       TCAM ERROR CODE 24       A44886 59070010
DEBPRFIX EQU   36                       SIZE OF DEB PREFIX       S22025 59100010
MINDEBSZ EQU   104                      MINIMUM DEB SIZE         X01004 59170010
AMLNG    EQU   6                        ACCESS METHOD SECTION   SA65392 59190010
*                                         LENGTH IN THE DEB     SA65392 59210010
TCAMER01 EQU   X'01'                    NO CORE FOR DEB          S22025 59240010
AUDIOCTL EQU   X'00'                    7770 AUDIO UNIT          Y02027 59350010
TCAMER02 EQU   X'02'                    INCOMPATIBLE STATIONS    S22025 59400010
CNTRLUNT EQU   X'03'                    270X CONTROL UNIT        S22025 59500010
TCAMER03 EQU   X'03'                    NOT TP OR GRAPHICS UCB   S22025 59600010
TCAMER04 EQU   X'04'                    INVALID CONTROL UNIT     S22025 59700010
TST2741E EQU   X'06'                    2741 EBCD                S22025 60200010
TST2741C EQU   X'05'                    2741 CORRESPONDENCE      S22025 60300010
TYP3270  EQU   X'08'                    USEDTO TEST FOR        @SA63601 60310010
TYPE3270 EQU   X'03'                    3270 DEVICES           @SA63601 60320010
*                                       09=3277                @SA63601 60330010
*                                       0A=3284                @SA63601 60340010
*                                       0B=3286                @SA63601 60350010
EXERR06  EQU   X'06'                    ERROR ID                 Y02027 60400010
NOCONTRL EQU   X'0C'                    NOT CONTROL UNIT         Y02027 60450010
OUTONLY  EQU   X'0F'                    OUTPUT ONLY              Y02027 60505010
TYPEI    EQU   X'10'                    TYPE I ADAPTER           Y02027 60510010
FIRSTID  EQU   32                       OFFSET TO 1ST WTG ENTRY  Y02027 60600010
AMIDCNST DC    C'35'                    ID OF THIS OPEN MODULE   S22025 60800010
GRAPHICS EQU   X'10'                    GRAPHICS DEVICE          Y02027 60900010
TPDEVCD  EQU   X'40'                    TP DEVICE                Y02027 61000010
OPIDCNST DC    C'0S'                    END OF WTG TABLE         S22025 61260010
OPWKAD   EQU   4                        OPEN WK AREA ADDR OFFSET Y02027 61280010
KEY6     EQU   X'60'                    KEY 6.                   Y02027 61300010
UNAUTHL  EQU   32                       UNAUTH. ERROR NUMB.      Y02027 61320010
         EJECT                                                          61350010
HOLDMASK DS    0F            BITS       FIELD                           61900010
         DC    X'FF'                    IOSFLAGS AND MODEL CODE         61920010
         DC    X'FC'                    OPT FEAT. AND SAD COMMAND       61940010
         DC    X'FF'                    DEVICE CLASS                    61960010
         DC    X'FC'                    ADAPTER AND CONTROL UNITSA68037 61980010
         EJECT                                                          62700010
ZIP      EQU   0                        CONSTANT OF 0            X01004 62800010
SIX      EQU   6                        CONSTANT OF 6            X01004 62808010
NINE     EQU   9                        CONSTANT OF 9            X01004 62816010
TWOTWO   EQU   22                       CONSTANT OF 22           X01004 62824010
FOURTEEN EQU   14                       CONSTANT OF 14           X01004 62832010
EIGHTEEN EQU   18                       CONSTANT OF 18         @XA09807 62834010
NINETEEN EQU   19                       CONSTANT OF 19         @XA09807 62836010
TWOFIVE  EQU   25                       CONSTANT OF 25           X01004 62840010
SP230    EQU   230                      SUBPOOL FOR DEBS.               62848010
RLD      EQU   X'FE'                    FLAG FOR RLD PRESENT     X01004 62856010
GRAPHIC  EQU   X'10'                    GRAPHIC DEVICE         @XA09807 62864010
D3277    EQU   X'09'                    3277 DISPLAY           @XA09807 62872010
ALARMOFF EQU   X'EF'                    FLAG FOR AUDIBLE ALARM @XA09807 62880010
VSTCAM   EQU   C'V'                     VS TCAM MCP ID           Y05330 62888010
AQTAMLD2 DC    C'36'                    ID OF NEXT LOAD OF OPEN  S22025 63400010
OPENERP  DC    C'33'                    OPEN ERROR MODULE               63600010
         EJECT                                                          64200010
         TDEBD                                                          64700010
         EJECT                                                          64720010
UCB      DSECT                                                          64740010
         IEFUCBOB                                                       64760010
         EJECT                                                          64800010
FORCORE  DSECT                                                   Y02027 64820010
         IECDSECT                                                Y02027 64840010
         EJECT                                                          64860010
         TTCBD                                                          64900010
         EJECT                                                          65000010
         TAVTD                                                          65100010
         EJECT                                                          65200010
         DCBD  DSORG=TX                                                 65300010
         END                                                            65500010
