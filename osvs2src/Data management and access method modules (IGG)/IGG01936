         TITLE 'IGG01936 LOAD 2 OF LINE GROUP OPEN'                     00100020
IGG01936 CSECT                                                          00120054
*A-000000-999999                                               @X31X8N0 00130008
         SPACE 3                                                        00140054
* CHANGE ACTIVITY AS FOLLOWS                                            00160054
******************** MICROFICHE FLAGS *********************** SUPT CODE 00180054
*A382550,529800                                                  A48258 00200054
*A102000                                                         A42373 00200154
*C245000                                                         S21101 00200254
*C157000,447000                                                  A42373 00200354
*D238000-243000                                                  S21101 00200454
*D448500-448800                                                  A42373 00200554
*A086000,096000,102000,317000,430000,445000,464000,513600,526000,X01004 00200654
*A529000,543000,555000                                           X01004 00200754
*C091000,112000,344000-346000,352000,361000,367000-372000,381000-X01004 00200854
*C401000,509000                                                  X01004 00200954
*D357000-360000                                                  X01004 00201054
*A317600,380000,361000,437000,525000                             Y01004 00201154
*C440000,447000-449000                                           Y01004 00201254
*D382200-382400                                                  Y01004 00201354
*A102000,107000                                                  S99228 00202354
*A497100-497300                                                  S21903 00203354
*C088000,114000,118000,429000,528000,535000,536000,540000,542000,S21903 00204354
*C543000                                                         S21903 00205354
*A333000,346000                                                 SA65392 00206354
*D463220,498000,505000,507000,512000-513000,516000-517000       SA65392 00207354
*D524800-525000,529000                                          SA65392 00208354
*C006000,011700-011800,102020,245000,317100-317300,317450-317550,X02004 00209354
*C345250-345350,345500,345600-345700,526960                      X02004 00210354
*D102080-102400,346210-346420                                    X02004 00211354
*A393800,526400                                                 OY00530 00212354
*A317010                                                       @YA04393 00212661
*C004000,020000,023000,029000,046000,047000,096260,288000,344300 Y02027 00300006
*C355000,356000,437150,437180,448720,529950,527000               Y02027 00300106
*D530000-543600                                                  Y02027 00300206
*A096270,385630,385660,443400,444400,525960,525970               Y02027 00300306
*A527200-527600,552300                                           Y02027 00300406
*A001200                                                       @Z30X8NM 00300508
*C004000,004110,306000,344050,403000,437600,448240-448400      @Z30X8NM 00300608
*C448560,448720,493000,527000                                  @Z30X8NM 00300708
*D307000-308000,311000-312000,344100-344350,345250-345450      @Z30X8NM 00301008
*D345650,345750,437690-437750,448320-448360,448600-448640      @Z30X8NM 00301108
*D448760-448840,525860,525950,526250,526610,526670             @Z30X8NM 00301208
*D390900                                                       @ZA01156 00340461
*A390540,394300,526100                                         @XA03965 00370481
*D345150,345200                                                @XA09789 00370581
*C174000,175000                                                @YA05471 00370681
*A177000                                                       @YA05471 00370781
*C391600,555070                                                @ZA06161 00370881
*C447180                                                       @XA11331 00370981
*C333200,C346210,C346630,C526590                               @OZ24288 00372900
*               TCAM 10.0 CHANGES                              @G36XRNP 00374900
*A096480,303000,361500,544000                                  @G36XRNP 00378900
*C096480,096760,096880,145000,152000,155000,170000,178000      @G36XRNP 00382900
*C180000,188000,191000,205000,217000,231000                    @G36XRNP 00386900
*D086300,096020-096040,520900,522300-523000,529500,529800      @G36XRNP 00390900
*C345500,345800,526640 526700                                  @OZ24143 00392900
*D332000-333600,A346140,D346420,C344750                        @OZ26781 00393086
*                                                              @G36XRNP 00394900
*A096200,096300                                                @OZ30963 00395086
*A289000,526490                                                @OZ30850 00395186
*********************************************************************** 00401054
*                                                                     * 00402054
*  TITLE 'IGG01936' LOAD 2 OF LINE GROUP OPEN                         * 00403054
*                                                                     * 00404054
*  MODULE NAME = IGG01936 (TCAM,INITIALIZATION)                @G36XRNP 00405000
*                                                                     * 00406054
*  DESCRIPTIVE NAME = LOAD 2 OF LINE GROUP OPEN                       * 00407054
*                                                                     * 00408054
*  COPYRIGHT = 'NONE'                                                 * 00409054
*                                                                     * 00410054
*  STATUS = VERSION 10.0                                       @G36XRNP 00411000
*                                                                     * 00412054
*                                                                     * 00498054
*                                                                     * 00500020
*FUNCTION/OPERATION - THIS ROUTINE LOCATES A TYPICAL ENTRY IN THEX02004 00600005
*   DEVICE CHARACTERISTICS TABLE, AND SETS AN INDEX INTO THE     X02004 00630005
*   DEVICE TYPE BRANCH TABLE. IT THEN PROVIDES THE NUMBER OF     X02004 00660005
*   CHANNEL COMMAND WORDS (CCW'S) REQUIRED FOR A MINIMUM              * 00700020
*   CHANNEL PROGRAM FOR ALL DEVICES.  ADDITIONAL CCW'S ARE            * 00800020
*   PROVIDED AS DETERMINED BY EXAMINING THE OPTIONAL FEATURE          * 00900020
*   BITS OF THE UCB AND A TYPICAL ENTRY IN THE DEVICE                 * 01000020
*   CHARACTERISTICS TABLE FOR THIS PARTICULAR DEVICE                  * 01100020
*   IGG01936 ALSO PLACES THE SEND SCHEDULER STCB IN THE STCB          * 01110020
*   CHAIN OF EACH DESTINATION QCB FOR THE LINES IN THIS LINE GROUP    * 01120020
*   THIS MODULE ALSO PERFORMS SOME ERROR CHECKING TO INSURE           * 01130020
*   THAT THE DATA SETS SPECIFIED BY THE 'QUEUES=' PARAMETER           * 01140020
*   OF THE TERMINAL MACROS FOR THE LINES IN THIS LINE GROUP           * 01150020
*   HAVE INDEED BEEN OPENED OR PROVIDED BY THE USER.                  * 01160020
*   THIS EXECUTOR ISSUES GETMAIN REQUESTS FOR ALL LCB'S AND      X02004 01170005
*   SCB'S REQUIRED BY EACH LINE GROUP IT OPENS.                  X02004 01180005
*                                                                     * 01200020
*ENTRY POINTS - THIS ROUTINE IS ENTERED AT IGG01936 VIA AN XCTL       * 01300020
*   FROM THE OPEN EXECUTOR IGG01935.  IT MAY ALSO BE RE-ENTERED       * 01400020
*   FROM THE RELOOP PORTION OF THIS ROUTINE IF IT IS DETERMINED       * 01500020
*   THAT THERE IS ANOTHER LINE GROUP DATA CONTROL BLOCK TO BE         * 01600020
*   OPENED AT THIS TIME                                               * 01700020
*                                                                     * 01800020
*INPUT - THE REGISTERS 5, 6, 7, AND 8 ARE THE INPUT AS FOLLOWS        * 01900020
*   5    THE ADDRESS OF THE WTG TABLE PREFIX                     Y02027 02000006
*   6 -  THE ADDRESS OF THE BEGINNING OF THE WHERE-TO-GO TABLE.       * 02200020
*   7    THE ADDRESS OF THE COPY OF THE CURRENT DCB              Y02027 02300006
*   8 -  THE ADDRESS OF THE CURRENT ENTRY IN THE WHERE-TO-GO          * 02500020
*        TABLE .                                                      * 02600020
*                                                                     * 02700020
*OUTPUT - REGISTERS 7 AND 8 WILL BE POSITIONED AT THE NEXT            * 02800020
*   ENTRIES IN THE DATA CONTROL BLOCK COPY LIST AND THE          Y02027 02900006
*   WHERE-TO-GO TABLE RESPECTIVELY.  LINE CONTROL BLOCKS WILL         * 02910020
*   HAVE BEEN BUILT FOR EACH LINE IN THE LINE GROUP AND               * 02920020
*   THE SEND SCHEDULER STCB WILL HAVE BEEN BUILT IN EACH              * 02930020
*   DESTINATION QCB FOR THIS LINE GROUP.                              * 02940020
*                                                              @G36XRNP 03240000
*EXTERNAL ROUTINES - NONE                                             * 03700020
*                                                                     * 03800020
*EXIT NORMAL =                                                 @G36XRNP 03900000
*   THIS ROUTINE EXITS VIA AN XCTL TO THE EXECUTOR IDENTIFIED         * 04000020
*   BY THE NEXT NON-ZERO ENTRY IN THE WHERE-TO-GO TABLE.              * 04100020
*                                                                     * 04200020
*EXIT ERROR = NONE                                             @G36XRNP 04300000
*                                                              @G36XRNP 04305000
*EXTERNAL REFERENCES = SEE BELOW                               @G36XRNP 04310000
*                                                              @G36XRNP 04315000
*   ROUTINES = NONE                                            @G36XRNP 04320000
*                                                              @G36XRNP 04325000
*   DATA AREAS = OPEN/CLOSE DATA AREA                          @G36XRNP 04330000
*                                                              @G36XRNP 04335000
*   CONTROL BLOCKS = AVT                                       @G36XRNP 04340000
*                    DCB                                       @G36XRNP 04345000
*                    DCT                                       @G36XRNP 04350000
*                    DEB                                       @G36XRNP 04355000
*                    TTE                                       @G36XRNP 04360000
*                    TIOT                                      @G36XRNP 04365000
*                    LCB                                       @G36XRNP 04370000
*                    QCB                                       @G36XRNP 04375000
*                    SCB                                       @G36XRNP 04380000
*                    UCB                                       @G36XRNP 04385000
*                                                                     * 04400020
*   TABLES/WORK AREAS - THE WHERE-TO-GO TABLE CONTAINS THE ID AND     * 04500000
*   TTR OF THE REQUIRED OPEN EXECUTORS.  THE WTG TABLE           Y02027 04600006
*   PREFIX CONTAINS THE ADDRESS OF A COPY OF EACH DCB            Y02027 04700006
*   SPECIFIED IN THE OPEN MACRO INSTRUCTION.  THE DEVICE              * 04800020
*   CHARACTERISTICS TABLE CONSISTS OF ENTRIES DESCRIBING              * 04900020
*   THE CHARACTERISTICS OF ALL THE TERMINALS IN THE SYSTEM.           * 05000020
*                                                              @G36XRNP 05010000
*   MACROS = IEDHJN                                            @G36XRNP 05020000
*            MODESET                                           @G36XRNP 05030000
*            GETMAIN                                           @G36XRNP 05040000
*            PGFIX                                             @G36XRNP 05050000
*            WAIT                                              @G36XRNP 05060000
*            XCTL                                              @G36XRNP 05070000
*                                                                     * 05100020
*ATTRIBUTES - THIS ROUTINE IS EXECUTED IN THE TRANSIENT AREA          * 05200020
*   AS ENABLED, PRIVILEGED, AND RE-ENTRANT.                           * 05300020
*                                                                     * 05400020
*                                                                     * 05500020
*********************************************************************** 05600054
         EJECT                                                          05700054
*                                                                       05880005
* REGISTER USAGE                                                        05900020
*                                                                       06000020
RE       EQU   0                        WORK REGISTER                   06100020
RF       EQU   1                        WORK REGISTER                   06200020
RDCB     EQU   2                        ADDRESS OF THE CURRENT DCB      06300020
RTIOT    EQU   3                        ADDRESS OF THE TIOT             06400020
RCORE    EQU   4                        ADDRESS OF DCB WORK AREA        06500020
RPAR     EQU   5                        ADDRESS OF FIRST ENTRY IN       06600020
*                                         DCB PARAMETER LIST            06700020
RWTG     EQU   6                        ADDRESS OF WHERE-TO-GO          06800020
*                                         TABLE                         06900020
RPARC    EQU   7                        ADDRESS OF CURRENT ENTRY IN     07000020
*                                         DCB PARAMETER LIST            07100020
RWTGC    EQU   8                        ADDRESS OF CURRENT ENTRY IN     07200020
*                                         IN WTG TABLE                  07300020
RAVT     EQU   9                        ADDRESS OF THE AVT              07400020
RUCB     EQU   10                       ADDRESS OF THE CURRENT UCB      07500020
RDEB     EQU   11                       ADDRESS OF THE DEB              07600020
RBASE    EQU   12                       BASE OF THIS ROUTINE            07700020
RC       EQU   13                       WORK REGISTER                   07800020
RD       EQU   14                       WORK REGISTER                   07900020
RJ       EQU   15                       WORK REGISTER                   08000020
*                                                                       08100020
         USING IHADCB,RDCB                                              08200020
         USING IEDQQCB,RTIOT            QCB DSECT                       08300020
         USING IEDQAVTD,RAVT                                            08400020
         USING IEDQDEB,RDEB             DEB DSECT                       08500020
         USING IEDQTNTD,RJ              TERMINAL NAME TABLE DSECT       08600020
         USING IEDQTRM,RF               TERMINAL TABLE DSECT     X01004 08660005
*                                                                       08700020
         BALR  RBASE,0                  BASE REG SETUP           S21903 08800022
         USING *,RBASE                                                  08900020
*                                                                       09000020
         LA    RBASE,0(RBASE)           CLEAR HIGH BYTE          X01004 09100005
IGG01936 IEDHJN RESTART                                          X01004 09150005
         L     RJ,4(RWTGC)              RESTORE ADDRESS OF REGISTER     09200020
*                                         SAVE AREA                     09300020
         LM    RE,RDEB,0(RJ)            RESTORE THE REGISTERS SAVED     09400020
         LM    RC,RD,52(RJ)             BY THE PREVIOUS LOAD OF OPEN    09420020
         CLC   0(TWO,RJ),OPENERP        IS THIS A RETURN FROM THE       09440020
*                                         ERROR MODULE                  09460020
         BE    RECOVER                  YES, BRANCH                     09480020
         L     RJ,AVTRNMPT              ADDRESS OF THE TERMNAME  X01004 09606005
*                                         TABLE                  X01004 09608005
         LR    RTIOT,RD                 SAVE UCB ADDRESS         X01004 09610005
         LH    RUCB,TNTLEN              LENGTH OF TERMNAME ENTRY X01004 09612005
         N     RUCB,AVTCLRHI            CLEAR HI-ORDER HALF WORD X01004 09614005
TNTLOOP  EQU   *                                                 X01004 09616005
         LR    RF,RUCB                  TERMNAME TABLE OFFSET    X01004 09618005
         BALR  RD,RJ                    GET ADDR OF TERM ENTRY   X01004 09620005
         LTR   RF,RF                    TTE POINTER ZERO?      @OZ30963 09620686
         BZ    BLANKENT                 IF SO SKIP IT          @OZ30963 09621286
         USING IEDQQCB,RD                                        X01004 09622005
         ICM   RD,AD,TRMDESTQ           GET QCB ADDRESS          X01004 09624005
         CLM   RDCB,AD,QCBDCBAD         DOES THIS TERMINAL       Y02027 09626006
*                                       BELONG TO THIS DCB       Y02027 09627006
         DROP  RD                                                X01004 09628005
         BE    OUTLOOP                  BRANCH IF EQUAL          X01004 09630005
BLANKENT EQU   *                                               @OZ30963 09631086
         BCT   RUCB,TNTLOOP             GET NEXT TNT OFFSET FOR  X01004 09632005
*                                         LOOP                   X01004 09634005
OUTLOOP  EQU   *                                                 X01004 09636005
         LR    RD,RTIOT                 RESTORE UCB ADDRESS      X01004 09638005
         SR    RUCB,RUCB                CLEAR TERMINAL COUNT     X01004 09640005
         IC    RUCB,TRMCHCIN            DEVICE CHARACTERISTIC    X01004 09642005
*                                         INDEX                  X01004 09644005
         BCTR  RUCB,ZERO                SUBTRACT 1 FROM INDEX    X01004 09646005
         MH    RUCB,AVTDCTLN            MULTIPLY INDEX BY DCT  @G36XRNP 09646400
*                                       ENTRY SIZE             @G36XRNP 09646800
         L     RCORE,AVTCSTCS           ADDRESS OF THE DEVICE  @G36XRNP 09647200
*                                       CHARACTERISTICS TABLE  @G36XRNP 09647600
         AR    RCORE,RUCB               ADDR OF TYPICAL ENTRY    X01004 09650005
         USING IEDDCT,RCORE             DCT ADDRESSABILITY     @G36XRNP 09651000
         CLI   DEVCLASS(RD),GRAPHICS    IS THIS GRAPHICS EQUIPT  X01004 09652005
         BE    STRT1936                 YES, BRANCH              X01004 09654005
         SR    RF,RF                    CLEAR FOR MODEL CODE     X01004 09656005
         IC    RF,MODLCODE(RD)          GET MODEL CODE BITS      X01004 09658005
         LA    RTIOT,ALL                MASK FOR MODEL CODE      X01004 09660005
         NR    RF,RTIOT                 CLEAR EXTRANEOUS BITS    X01004 09662005
         AR    RF,RF                    DOUBLE MODEL INDEX       X01004 09664005
         AR    RC,RF                    ADD MODEL INDEX TO THE   X01004 09666005
*                                         ADAPTER INDEX          X01004 09668005
         SLL   RC,TWO                   MULTIPLY INDEX BY 4      X01004 09670005
         CLI   ADAPTYPE(RD),AUDIOCTL    AUDIO LINE               X01004 09672005
         BNE   TSTBISC                  NO, BRANCH               X01004 09674005
         TM    DCTBYTE2,DCTAUDIO        DO CHARACTERISTICS     @G36XRNP 09676000
*                                         INDICATE AUDIO LINE    X01004 09678005
         BZ    ERR01                    NO, BRANCH               X01004 09680005
TSTBISC  EQU   *                                                 X01004 09682005
         TM    ADAPTYPE(RD),BISC        IS THIS A BISC LINE      X01004 09684005
         BNO   STRT1936                 NO, BRANCH               X01004 09686005
         TM    DCTBYTE2,DCTBISYN        DO THE CHARACTERISTICS @G36XRNP 09688000
*                                         INDICATE A BISC LINE   X01004 09690005
         BZ    ERR01                    NO, BRANCH               X01004 09692005
         EJECT                                                          09693006
STRT1936 EQU   *                                                 X01004 09694005
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     09700020
*                                                                 *     09800020
*        THIS SECTION OF CODE SETS THE PRELIMINARY SIZE FOR       *     09900020
*        CHANNEL PROGRAMS FOR ALL DEVICES IN THIS LINE GROUP      *     10000020
*                                                                 *     10100020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     10200020
         LA    RUCB,ONE                 SET INITIAL CCW COUNT    X02004 10202005
         L     RJ,FOUR(RWTGC)           ADDR OF OPEN WORK AREA   X01004 10204005
         MVI   DXCCW12-1(RJ),AVTEZERO     SET 5041 SWITCH        A42373 10250020
         TM    TWO(RD),GRAPHICS         IS THIS A GRAPHICS DEVICE       10300020
         BNZ   SETCCWSZ                 YES, BRANCH                     10400020
         TM    1(RD),X'40'              IS THIS LINE AUTO-POLLED        10500020
         BZ    SETCCWSZ                 NO, BRANCH                      10600020
         TM    0(RD),BSCMULTI           IS THIS A BISC MULTIPOINT       10620020
*                                         DEVICE                        10640020
         BO    SETCCWSZ                 YES, BRANCH                     10670020
         LA    RUCB,AUTOPOLL(RE,RUCB)   SET THE CHANNEL PROGRAM  S99228 10700022
*                                         SIZE FOR ALL AUTOPOLLED       10800020
*                                         DEVICES                       10900020
         B     ENDLOAD2                 GO TO ROUTINE END               11000020
SETCCWSZ EQU   *                                                        11100020
         LA    RUCB,THREE(RUCB)         PROVIDE 3 CCW'S FOR THE  X01004 11200005
*                                         READ-SKIP LOOP                11300020
         B     DEVTYPE(RC)              GO TO BRANCH TABLE       S21903 11400022
         EJECT                                                          11500020
DEVTYPE  EQU   *                                                        11600020
         B     SET2260L                 BRANCH FOR A 2260 LOCAL         11700020
         B     ERROR                    ERROR ENTRY              S21903 11800022
         B     TEST7770                 SET THE 7770 CHANNEL PROGRAM    11900020
         B     TEST1050                 BRANCH FOR A 1050               12000020
         B     TEST1030                 BRANCH FOR A 1030               12100020
         B     TST5060                  BRANCH FOR EITHER A 1050 OR     12200020
*                                         A 1060                        12300020
         B     TEST115A                 TEST FOR AN 83B3                12400020
         B     TESTTWX                  BRANCH FOR A TWX                12500020
         B     TEST115A                 TEST FOR A 115A                 12600020
         B     TEST2740                 BRANCH FOR A 2740               12700020
         B     T10502                   BRANCH FOR A 2260               12800020
         B     TEST2741                 TEST FOR A 2741 DEVICE          12900020
         B     ERROR                    48                              13000020
         B     WTTA2741                 TEST FOR EITHER A WORLD         13100020
*                                         TRADE DEVICE OR A 2741        13200020
         B     ERROR                    56                              13300020
         B     ERROR                    INVALID BRANCH INDEX            13400020
         B     ERROR                    INVALID INDEX, ERROR            13500020
         B     ERROR                    INVALID INDEX, ERROR            13600020
         B     ERROR                    INVALID INDEX, ERROR            13700020
         B     TESTBISC                 TEST FOR A BISYNC DEVICE        13800020
         B     ERROR                    INVALID INDEX, ERROR            13900020
         B     TESTBSCD                 TEST FOR A BISC DEVICE          14000020
         B     ERROR                    INVALID INDEX, ERROR            14100020
         B     TESTBISC                 TEST FOR BISC MULTIPOINT        14200020
         EJECT                                                          14300020
WTTA2741 EQU   *                                                        14400020
         TM    DCTBYTE3,DCTWTTA         IS THIS A WORLD TRADE  @G36XRNP 14500000
*                                         TELEGRAPH DEVICE              14600020
         BNO   TEST2741                 NO, BRANCH                      14700020
         LA    RUCB,SIX(RUCB)           ASSIGN 8 CCW'S FOR THE          14800020
*                                         CHANNEL PROGRAM SIZE          14900020
         B     ENDLOAD2                 GO TO ROUTINE END               15000020
TEST2741 EQU   *                                                        15100020
         TM    DCTBYTE1,DCT5041         IS THIS A 2741/1050    @G36XRNP 15200000
*                                         LINE GROUP                    15300020
         BO    SET2741                  YES, BRANCH                     15400020
         TM    DCTBYTE1,DCT2741         IS THIS A TRUE 2741    @G36XRNP 15500000
         BNO   DEVCHRER                 NO, BRANCH                      15600020
         OI    DXCCW12-1(RJ),X'80'      SET FLAG IN OPEN WRKA TO A42373 15700020
*                                         INDICATE THAT THIS IS A       15800020
*                                         2741 TERMINAL                 15900020
SET2741  EQU   *                                                        16000020
         LA    RUCB,FIVE(RUCB)          INCREASE THE CHANNEL            16030020
*                                         PROGRAM SIZE TO 7 CCW'S       16060020
         TM    1(RD),X'90'              TEST FOR A DIAL LINE            16300020
         BZ    ENDLOAD2                 NO, ASSUME CONTENTION ONLY      16400020
         LA    RUCB,2(RUCB)             ADD 2 ADDITIONAL CCW'S FOR      16500020
*                                         A DIAL LINE                   16600020
         B     ENDLOAD2                 TRANSFER CONTROL                16700020
TEST1050 EQU   *                                                        16900020
         TM    DCTBYTE1,DCT5041         IS THIS A 2741/1050    @G36XRNP 17000000
*                                         LINE GROUP                    17100020
         BO    SET2741                  YES, BRANCH                     17200020
         TM    1(RD),X'90'              TEST FOR A DIAL LINE            17300020
         BZ    T10502A                  NON-DIAL, BRANCH       @YA05471 17400081
         LA    RUCB,2(RUCB)             ADD 2 ADDITIONAL CCW'S @YA05471 17500081
*                                         FOR A 1050 DIAL LINE          17600020
T10502   EQU   *                                                        17700020
         LA    RUCB,1(RUCB)             ADD 1 CCW FOR 2260 AND @YA05471 17720081
*                                         DIAL 1050            @YA05471 17740081
T10502A  EQU   *                                               @YA05471 17760081
         TM    DCTBYTE2,DCTSTCTL        TEST FOR STATION CNTRL @G36XRNP 17800000
         BNO   DEVCHRER                 NO, BRANCH                      17900020
         TM    DCTBYTE3,DCTCHECK+DCTCONTN        CHECKING AND  @G36XRNP 18000000
*                                       CAPABLE OF CONTINUE             18100020
         BNO   DEVCHRER                 NO, BRANCH                      18200020
         LA    RUCB,5(RUCB)             ADD 5 CCW'S TO THE CHANNEL      18300020
*                                         PROGRAM SIZE                  18400020
         B     ENDLOAD2                 TRANSFER CONTROL                18500020
TEST1030 EQU   *                                                        18700020
         TM    DCTBYTE2,DCTSTCTL        TEST FOR THE STATION   @G36XRNP 18800000
*                                         CONTROL FEATURE               18900020
         BNO   DEVCHRER                 NO, BRANCH                      19000020
         TM    DCTBYTE3,DCTCHECK        TEST FOR CHECKING      @G36XRNP 19100000
         BNO   DEVCHRER                 NO, BRANCH                      19200020
         LA    RUCB,5(RUCB)             ADD 5 ADDITIONAL CCW'S TO       19300020
*                                         THE CHANNEL PROGRAM SIZE      19400020
         B     ENDLOAD2                 TRANSFER CONTROL                19500020
*                                                                       19600020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     19700020
TST5060  EQU   *                                                        19800020
         TM    0(RD),X'01'              TEST FOR A 1050 WITH A TYPE     19900020
*                                         3 ADAPTER                     20000020
         BO    TEST1050                 TEST FOR 1050 FEATURES          20100020
         B     TEST1030                 TEST FOR STATION CONTROL        20200020
TESTTWX  EQU   *                                                        20400020
         TM    DCTBYTE2,DCTTWX          IS THIS A TWX          @G36XRNP 20500000
         BNO   DEVCHRER                 NO, BRANCH                      20700020
         LA    RUCB,SIX(RUCB)           ADD 6 ADDITIONAL CCW'S TO       20800020
*                                         THE CHANNEL PROGRAM SIZE      20900020
         B     ENDLOAD2                 TRANSFER CONTROL                21000020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     21100020
TEST2740 EQU   *                                                        21200020
         LA    RUCB,5(RUCB)             SET THE PRELIMINARY CHANNEL     21300020
*                                         PROGRAM SIZE                  21400020
         TM    1(RD),X'90'              IS THIS A DIAL LINE             21500020
         BZ    ENDLOAD2                 NO, BRANCH                      21600020
         TM    DCTBYTE2,DCTCONT         IS THIS A CONTENTION   @G36XRNP 21700000
         BNO   XMITCTL                  NO, BRANCH                      21800020
         LA    RUCB,3(RUCB)             ADD 3 ADDITIONAL CCW'S TO       21900020
*                                       THE CHANNEL PROGRAM             22000020
         B     ENDLOAD2                 GO TO ROUTINE END               22100020
XMITCTL  EQU   *                                                        22200020
         TM    1(RD),X'04'              DOES THIS DEVICE HAVE           22300020
*                                         TRANSMISSION CONTROL          22400020
         BNO   DEVCHRER                 NO, BRANCH                      22500020
         LA    RUCB,2(RUCB)             ADD 2 ADDITIONAL CCW'S TO       22600020
*                                         THE CHANNEL PROGRA            22700020
         B     ENDLOAD2                 TRANSFER CONTROL                22800020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     22900020
TEST115A EQU   *                                                        23000020
         TM    THREE(RD),WTTADPTR       IS THIS A WORLD TRADE           23020020
*                                         TELEGRAPH ADAPTER             23040020
         BO    WTTA2741                 YES, BRANCH                     23060020
         TM    DCTBYTE2,DCTSTCTL        TEST FOR THE STATION   @G36XRNP 23100000
*                                         CONTROL FEATURE               23200020
         BNO   DEVCHRER                 NO, THEN THERE IS AN ERROR      23300020
         LA    RUCB,5(RUCB)             ADD 5 ADDITIONAL CCW'S TO       23400020
         B     ENDLOAD2                 TRANSFER CONTROL                23500020
TESTBSCD EQU   *                                                        23700020
TESTBISC EQU   *                                                        24400020
         LA    RUCB,NINE(,RUCB)         GET 9 MORE CCW'S         X02004 24500005
*                                         THE CHANNEL PROGRAM SIZE      24600020
         B     ENDLOAD2                 GO TO ROUTINE END               24700020
SET2260L EQU   *                                                        24800020
         LA    RUCB,THREE(RUCB)         ADD 3 ADDITIONAL CCW'S TO       24900020
*                                         THE 2260 LOCAL CHANNEL        25000020
*                                         PROGRAM                       25100020
         B     ENDLOAD2                 GO TO ROUTINE END               25200020
TEST7770 EQU   *                                                        25300020
         LA    RUCB,FIVE(RUCB)          MAKE THE SIZE OF THE 7770       25330020
*                                         CHANNEL PROGRAM 7 CCW'S       25360020
ENDLOAD2 EQU   *                                                        25700020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     25800020
*                                                                 *     25900020
*        THIS SECTION OF CODE PLACES THE SEND SCHEDULER STCB      *     26000020
*              IN THE STCB CHAIN OF THE DESTINATION QCB           *     26100020
*                                                                 *     26200020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     26300020
         L     RJ,AVTRNMPT              ADDRESS OF THE TERMNAME         26400020
*                                         TABLE                         26500020
         LH    RE,TNTLEN                THE NUMBER OF ENTRIES IN THE    26600020
*                                         TERMNAME TABLE                26700020
         LA    RF,TNTFIRST              GET THE ADDRESS OF THE          26800020
*                                         FIRST ENTRY                   26900020
         SR    RC,RC                    CLEAR LENGTH REGISTER           27000020
          IC   RC,TNTENLEN              LENGTH OF COMPARAND FIELD       27100020
TERMAD    EQU  *                                                        27200020
         LA    RF,0(RC,RF)              LOCATE THE TERMINAL ENTRY       27300020
*                                         ADDRESS FOR THIS TERMINAL     27400020
         MVC   AVTGETMN+5(THREE),0(RF)   MOVE THE CURRENT TERMINAL      27500020
*                                          ADDRESS INTO A SCRATCH       27600020
*                                          AREA                         27700020
         L     RTIOT,AVTGETMN+4         LOAD THE TERMINAL ADDRESS       27800020
         TM    TRMDSORG-IEDQTRM(RTIOT),TRMLGB IS THIS A 3705     S22024 27820022
*                                        LINE GROUP ENTRY        S22024 27840022
         BO    TERMADL                  YES, SKIP TO NEXT ENTRY  S22024 27860022
         L     RTIOT,0(RTIOT)           ADDRESS OF THE DESTINATION      27900020
*                                         QCB                           28000020
         LA    RTIOT,0(RTIOT)           CLEAR THE HIGH ORDER BYTE       28100020
*                                         OF THE QCB ADDRESS            28200020
         LA    RDCB,0(RDCB)             CLEAR THE HIGH ORDER BYTE       28600020
*                                         OF THE DCB ADDRESS            28700020
         CLM   RDCB,AD,QCBDCBAD         IS THIS THE SAME DCB     Y02027 28800006
         BNE   TERMADL                  GO TO NEXT ENTRY                28900020
         SR    RJ,RJ                    CLEAR INDEX REGISTER   @OZ30850 28908086
         L     RCORE,AVTGETMN+4         GET CURRENT TTE        @OZ30850 28916086
         IC    RJ,TRMCHCIN-IEDQTRM(RCORE) DEVICE               @OZ30850 28924086
*                                       CHARACTERISTICS INDEX  @OZ30850 28932086
         BCTR  RJ,ZERO                  SUBTRACT 1 FROM INDEX  @OZ30850 28940086
         MH    RJ,AVTDCTLN              MULITPLY INDEX BY DCT  @OZ30850 28948086
*                                       ENTRY SIZE             @OZ30850 28956086
         L     RCORE,AVTCSTCS           ADDRESS OF THE DEVICE  @OZ30850 28964086
*                                       CHARACTERISTICS TABLE  @OZ30850 28972086
         AR    RCORE,RJ                 ADD DISPLACEMENT TO    @OZ30850 28980086
*                                       DCT BASE ADDRESS       @OZ30850 28988086
         SR    RJ,RJ                    CLEAR FOR THE RELATIVE LINE     29000020
*                                         NUMBER                        29100020
         IC    RJ,QCBRELLN              GET THE RELATIVE LINE           29200020
*                                         NUMBER ASSOCIATED WITH        29300020
*                                         THIS LINE                     29400020
         TM    QCBDSFLG,QCBDISK         DOES THIS TERMINAL ENTRY        29403020
*                                         SPECIFY DISK QUEUEING         29406020
         BZ    TESTCORE                 NO, BRANCH                      29409020
         TM    AVTBIT1,AVTDISKN         DOES THE AVT SUPPORT DISK       29412020
*                                         QUEUEING                      29415020
         BZ    ERROR01                  NO, THEN THERE CAN BE NO        29418020
*                                         DISK QUEUEING                 29421020
         TM    QCBDSFLG,QCBREUS         DOES IT SPECIFY REUSABLE        29424020
*                                         QUEUEING                      29427020
         BZ    TNONREUS                 NO, BRANCH                      29430020
         NC    AVTADEBR+1(THREE),AVTADEBR+1  HAS A REUSABLE MESSAGE     29433020
*                                         QUEUES DATA SET BEEN          29436020
*                                         OPENED                        29439020
         BNZ   TESTCORE                 YES, BRANCH                     29442020
         B     ERROR01                  NO, THEN  IT IS AN ERROR        29445020
TNONREUS EQU   *                                                        29448020
         NC    AVTADEBN+1(THREE),AVTADEBN+1  HAS A NON-REUSABLE         29451020
*                                            MESSAGE QUEUES DATA        29454020
*                                         SET BEEN OPENED               29457020
         BZ    ERROR01                  NO, BRANCH                      29460020
TESTCORE EQU   *                                                        29463020
         TM    QCBDSFLG,QCBCORE         DOES THIS TERMINAL ENTRY        29466020
*                                         SPECIFY CORE QUEUEING         29469020
         BZ    GOLOOP                   NO, BRANCH                      29472020
         NC    AVTTOTNC(FOUR),AVTTOTNC  HAS A CORE QUEUE DATA SET       29475020
*                                         BEEN PROVIDED                 29478020
         BZ    ERROR01                  NO, BRANCH                      29481020
GOLOOP   EQU   *                                                        29484020
         SLL   RJ,TWO                   MULTIPLY BY 4                   29500020
         LA    RJ,DEBUCBAD-4(RJ)        ACCESS THE UCB ADDRESS FOR      29600020
*                                         THIS LINE                     29700020
         L     RJ,0(RJ)                 LOAD THE UCB ADDRESS            29800020
         LTR   RJ,RJ                    IS THIS LINE ASSOCIATED         29900020
*                                         WITH A // DD DUMMY ENTRY      30000020
         BZ    TERMADL                  YES, DO NOT PUT THE SEND        30100020
*                                         SCHEDULER IN THE STCB         30200020
*                                         CHAIN OF THIS QCB             30300020
         L     RJ,AVTGETMN+4            GET SAVED TTE          @G36XRNP 30310000
         TM    DCTBYTE1,DCTUMASK        IS THIS A GEN POLL     @G36XRNP 30320000
*                                       CLUSTER                @G36XRNP 30330000
         BO    TERMADL                  YES, DO NOT PUT THE    @G36XRNP 30340000
*                                       SEND SCHEDULER IN STCB @G36XRNP 30350000
         LA    RJ,QCBSTVTO              LOAD THE ADDRESS OF THE QCB     30400020
*                                         SUBTASK VECTOR INDEX          30500020
         STCM  RJ,AD,QCBSTVTO+ONE       STORE THE ADDRESS OF   @Z30X8NM 30600008
*                                         FIRST STCB INTO THE STCB      30900020
*                                         CHAIN FIELD IN THE QCB        31000020
TERMADL  EQU   *                                                        31300020
         LA    RF,THREE(RF)             POINT TO THE NEXT TERMNAME      31400020
*                                         TABLE ENTRY                   31500020
         BCT   RE,TERMAD                DECREMENT THE NUMBER OF         31600020
*                                         ENTRIES AND BRANCH            31700020
         ST    RE,DEBEOEA               CLEAR MH FLAGS         @YA04393 31701061
         ICM   RC,AD,DCBMH              ADDRESS OF STARTMH PARMS X01004 31703005
         LA    RF,ONE(RE)               SET LOOP COUNT TO ONE    X02004 31706005
         LA    RJ,DEBEOEA               LOCATION FOR SAVING MH   X02004 31709005
*                                       FLAGS                    X02004 31712005
         NC    ONE(THREE,RC),ONE(RC)    IS THERE AN ALTERNATE MH X02004 31715005
         BE    MHLOOP                   BRANCH IF NO             X02004 31718005
         OI    DEBEOEA+TWO,AVTE80       SET ALT. MH FOR LINEEND  X02004 31721005
         AR    RF,RF                    SET LOOP COUNT TO TWO    X02004 31724005
MHLOOP   EQU   *                        START OF LOOP TO MOVE MH X02004 31727005
*                                       FLAGS TO DEB             X02004 31730005
         MVC   ZERO(ONE,RJ),TWELVE(RC)  MOVE INDEX AND FLAGS     X02004 31733005
         NI    ZERO(RJ),LMD             ONLY LMD FLAGS REMAIN    X02004 31736005
         OC    ZERO(ONE,RJ),FOUR(RC)    ADD OTHER MH FLAGS       X02004 31739005
         NI    ZERO(RJ),FOX-MHBT        RESET CONT/STOP FLAG     X02004 31742005
         CLC   NINE(THREE,RC),TRETEN(RC)  EOB CKG SPECIFIED FOR  X01004 31745005
*                                         STARTMH                X01004 31748005
         BE    ALTERMH                  NO, BRANCH               X02004 31751005
         OI    ZERO(RJ),MHBT            YES, SET BT PRESENT      X02004 31754005
ALTERMH  EQU   *                                                 X02004 31757005
         LA    RJ,ONE(RJ)               BUMP TO NEXT LOCATION    X02004 31760005
*                                       FOR SAVING ALTERNATE MH  X02004 31763005
         L     RC,ZERO(RC)              ALTERNATE STARTMH PARMS. X02004 31766005
         BCT   RF,MHLOOP                GO BACK THRU LOOP IF     X02004 31769005
*                                       THERE IS STILL AN        X02004 31772005
*                                       ALTERNATE MH TO PROCESS. X02004 31775005
         LR    RE,RDEB                  COPY DEB ADDRESS         Y01004 31778005
         SR    RF,RF                    CLEAR FOR INSERT         Y01004 31781005
         IC    RF,DEBLNGTH              DOUBLE WORD LENGTH OF DEBY01004 31784005
         SLL   RF,THREE                 LENGTH OF DEB            Y01004 31787005
         BAL   RC,FIXPAGE               FIX DEB                  Y01004 31790005
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     31900020
*                                                                 *     32000020
*        THIS SECTION GETMAINS AND INITIALIZES AN LCB/IOB         *     32100020
*        AREA FOR ALL LINES IN THIS PARTICULAR LINE GROUP         *     32200020
*                                                                 *     32300020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     32400020
         SLL   RUCB,3                   NUMBER OF BYTES IN CHANNEL      32500020
*                                         PROGRAM                       32600020
         LA    RF,LCBCPA-IEDQLCB        GET THE SIZE OF AN LCB          32700020
*                                         WITHOUT A CHANNEL PROGRAM     32800020
         AR    RUCB,RF                  ADD THE SIZE OF THE LCB TO      32900020
*                                         THE SIZE OF THE CHANNEL       33000020
*                                         PROGRAM                       33100020
         STC   RUCB,DCBEIOBX            PUT IN LENGTH OF LCB   @ZM47876 33120000
         SR    RE,RE                    CLEAR REGISTERS                 33400020
         SR    RC,RC                    CLEAR A LINE COUNT REGISTER     33500020
         IC    RC,DEBNMEXT              INSERT THE NUMBER OF LINES      33600020
*                                         IN THIS LINE GROUP            33700020
         LTR   RC,RC                    ARE THERE ANY ACTIVE LINES      33730020
         BZ    ERROR02                  NO, BRANCH                      33760020
         LR    RF,RC                    COPY THE LINE COUNT             33800020
         AH    RC,AVTLNCNT              ADD TO THIS LINE GROUP THE      33900020
*                                         PREVIOUS COUNT OF TOTAL       34000020
*                                         LINES IN THE SYSTEM           34100020
         STH   RC,AVTLNCNT              STORE THE UP-DATED COUNT IN     34200020
*                                         THE AVT                       34300020
         LR    RJ,RF                    SAVE NUMBER OF LCBS      X01004 34400005
         LH    RF,PAGE4K                PAGE SIZE IS 4K        @Z30X8NM 34405008
         DR    RE,RUCB                  DIV PG SIZE BY LCB SIZE  X01004 34440005
*                                        TO FIND LCBS PER PAGE   X01004 34445005
         LR    RCORE,RF                 SAVE NO. LCBS PER PAGE   X01004 34450005
         LR    RTIOT,RE                 SAVE REMAINDER FROM DIV  X01004 34455005
         LR    RF,RJ                    NUMBER OF LCBS REQUESTED X01004 34460005
         MVI   AVTOPERT,TCAMER07        ERROR IDENTIFICATION     X01004 34465005
         SR    RF,RCORE                 NO. OF LCBS IN NEXT PAGE X01004 34470005
         BNM   CKMAX                    MORE THAN ONE PAGE     @OZ26781 34475086
         SR    RTIOT,RTIOT              LESS THAN 1 PAGE NEEDED  X01004 34480005
CKMAX    CR    RF,RCORE                 REQUEST FOR MORE THAN    X01004 34500005
*                                        TWO PAGES               X01004 34505005
         BNH   FITLCB                   NO, BRANCH               X01004 34510005
         LA    RF,VS2MAX                82 IS MAX LINES IN GRP @OZ24143 34550000
         LA    RTIOT,BIGLCB2            SET PAGE OFFSET FOR VS/2 X02004 34555005
*                                       PAGE BOUNDARY ALLIGNMENT X02004 34560005
         CR    RJ,RF                    REQUEST FOR MORE THAN    X02004 34570005
*                                         AOS/2 MAX OF 82 LCB'S@OZ24143 34580000
         BH    WTGSETUP                 YES, CAN'T HANDLE        X01004 34600005
         LA    RUCB,LCB248              RESET LCB SIZE TO 248    X01004 34607005
         STC   RUCB,DCBEIOBX            SET LCB LENGTH IN DCB    X01004 34614005
FITLCB   EQU   *                                               @OZ26781 34617086
         AH    RUCB,HALF12              ADD 12 BYTES TO        @OZ24288 34621000
*                                         LCB AREA TO HOLD      SA65392 34628005
*                                         THRESHHOLD VALUES     SA65392 34635005
         LR    RF,RJ                    FIND NO. OF BYTES NEEDED X01004 34649005
         MR    RE,RUCB                   FOR LCBS                X01004 34656005
         SH    RUCB,HALF12              TRUE LCB SIZE          @OZ24288 34663000
         LR    RE,RTIOT                 COPY OFFSET INTO PAGE    Y01004 34670005
*                                         NEEDED TO ALLIGN ON    Y01004 34677005
*                                         PAGE BOUNDARY          Y01004 34684005
         SR    RTIOT,RTIOT              CEAR FOR DIAL INDEX      X01004 34691005
         TM    TWO(RD),GRAPHICS         IS THIS A GRAPHICS DEVICE       34700020
         BNZ   SETSUB                   YES, BRANCH                     34800020
         TM    1(RD),X'90'              IS THIS A DIAL LINE             34900020
         BZ    SETSUB                   NO, SKIP THE NEXT               35000020
*                                         INSTRUCTION                   35100020
         LA    RTIOT,EIGHT              SET TO EIGHT FOR DIAL    X01004 35200005
*                                         THE ENTIRE LCB AREA           35300020
SETSUB   EQU   *                                                        35400020
         MVI   AVTGETMN+NINE,LCBPOOL    SET THE SUBPOOL VALUE    Y02027 35500006
*                                       FOR THE LCB              Y02027 35600006
         AR    RF,RTIOT                 BUMP FOR DIAL            X01004 36100005
         SR    RE,RTIOT                 ADJUST FOR DIAL          Y01004 36110005
         BNM   SETSUB1                  BRANCH R0 NOT NEGATIVE   Y01004 36120005
         SR    RE,RE                    CLEAR R0 FOR NO PAGE     Y01004 36130005
*                                         ALLIGNMENT             Y01004 36140005
SETSUB1  EQU   *                                                 Y01004 36150005
         DROP  RCORE                    DROP DCT ADDRESSABILITY@G36XRNP 36160000
         USING IEDQLCB,RCORE            LCB ADDRESSABILITY     @G36XRNP 36170000
         BAL   RC,AVTPAR                BRANCH TO THE GETMAIN           36200020
*                                         ROUTINE                       36300020
         L     RCORE,AVTGETMN+4         LOAD THE ADDRESS OF THE         36500020
*                                         LCB AREA                      36600020
         LR    RE,RCORE                 LCB ADDRESS TO FIX       X01004 36700005
         ICM   RF,AD,AVTGETMN+ONE       LENGTH TO FIX            X01004 36750005
*                                                                X01004 36800005
         BAL   RC,FIXPAGE               FIX LCB                  X01004 36900005
*                                                                X01004 37000005
         LTR   RTIOT,RTIOT              DIAL LINE                X01004 37100005
         BZ    SETLCB                   NO, BRANCH               X01004 37150005
         LA    RCORE,0(RCORE)           CLEAR THE HIGH ORDER BYTE OF    37300020
*                                         THE CALL QUEUE ADDRESS        37400020
         ST    RCORE,0(RCORE)           STORE THE ADDRESS OF THE        37500020
*                                         FIRST ELEMENT                 37600020
         ST    RCORE,FOUR(RCORE)        INITIALIZE THE LINK FIELD       37700020
*                                         OF THE FIRST ELEMENT          37800020
         LA    RCORE,8(RCORE)           INCREMENT THE BEGINNING         37900020
*                                         ADDRESS OF THE LCB AREA       38000020
SETLCB   EQU   *                                                 X01004 38100005
         LA    RF,IOBPTR(RCORE)         LOAD ADDRESS OF THE IOB  X01004 38110005
*                                        PORTION OF THE LCB      X01004 38120005
         SR    RF,RUCB                  SUBTRACT SIZE OF 1 LCB   X01004 38130005
         STCM  RF,AD,DCBIOBAD+ONE       STORE STARTING ADDR OF   X01004 38140005
         LR    RJ,RTIOT                  THE IOB IN THE DCB      X01004 38150005
         SR    RTIOT,RTIOT                                       X01004 38160005
         SR    RF,RF                                             X01004 38170005
         IC    RF,DEBNMEXT              NUMBER OF EXTENTS        X01004 38180005
         BCTR  RUCB,ZERO                DECREMENT FOR EXECUTE    X01004 38190005
STARTIOB EQU   *                                                 X01004 38200005
         EX    RUCB,CLEAR               CLEAR ONE LCB            X01004 38210005
         LA    RC,LCBKEY                ADDRESS OF LCB           X01004 38220005
         ST    RC,LCBKEY                POINT LCB TO ITSELF      X01004 38230005
         L     RC,FOUR(RWTGC)           OPEN WORK AREA ADDRESS   X01004 38240005
         TM    DXCCW12-ONE(RC),L2741    2741 ATTACHED TO LINE    X01004 38250005
         BZ    SETCPA                   NO, BRANCH               X01004 38260005
         OI    LCBTSOB,LCB2741N         YES-SET 2741 BIT IN LCB  X01004 38300005
SETCPA   EQU   *                                                 X01004 38310005
         LA    RC,LCBCPA                ADDR OF CHANNEL PROGRAM  X01004 38320005
*                                        AREA                    X01004 38330005
         ST    RC,LCBSIOCC              STORE IN LCB             X01004 38340005
         LA    RC,LCBRSKEY              ADDRESS OF FIRST STCB    X01004 38350005
         ST    RC,LCBRSKEY              STORE STCB ADDR. IN LCB  X01004 38360005
         MVI   LCBTDL,TIMDELAY          OFFSET FOR TIME DELAY    X01004 38370005
         LTR   RJ,RJ                    DIAL LINE                X01004 38380005
         BZ    SETKEY                   NO, BRANCH               X01004 38390005
         MVI   LCBRSKEY,DIALREV         SET DIAL RECEIVE SCHED.  X01004 38400005
         MVI   LCBRSPRI,SENDPRI         SET SEND PRIORITY FOR    A48258 38410005
*                                       ALL DIAL LINES           A48258 38420005
         OI    LCBSTAT2,LCBDIAL         SET DIAL IN STATUS       X01004 38430005
         LTR   RTIOT,RTIOT              SCB'S ALREADY GOTTEN     X01004 38440005
         BNZ   LOADSCBA                 YES, BRANCH              X01004 38450005
         LR    RTIOT,RF                 COPY NUMBER OF EXTENTS   X01004 38460005
         IC    RF,AVTSCBSZ              SIZE OF A STATN CONTROL  X01004 38470005
*                                        BLOCK                   X01004 38480005
         MR    RE,RTIOT                 MULTIPLY SIZE BY NUMBER  X01004 38490005
*                                        FOR TOTAL SIZE NEEDED   X01004 38500005
         SR    RE,RE                    NO OFFSET REQUIRED INTO  Y01004 38540005
*                                         PAGE FOR SCB           Y01004 38550005
         MVI   AVTOPERT,TCAMER08        ERROR ID                 X01004 38560005
         MVI   AVTGETMN+NINE,SCBPOOL    SET THE SUBPOOL VALUE    Y02027 38563006
*                                       FOR THE SCB              Y02027 38566006
         BAL   RC,AVTPAR                GETMAIN SCB AREA         X01004 38570005
*                                                                X01004 38580005
         LM    RE,RF,AVTGETMN           LGTH AND START OF SCBS   X01004 38590005
         LR    RDEB,RF                  SAVE SCB ADDRESS         X01004 38600005
         LR    RJ,RE                    LENGTH OF SCB'S          X01004 38610005
SCBMOVE  EQU   *                                                 X01004 38620005
         MVI   ZERO(RF),ZERO            CLEAR SCB AREA           X01004 38630005
         LA    RF,ONE(RF)               BUMP TO NEXT BYTE        X01004 38640005
         BCT   RE,SCBMOVE               CLEAR NEXT BYTE          X01004 38650005
         LR    RE,RDEB                  ADDRESS OF SCB'S TO FIX  X01004 38660005
         LR    RF,RJ                    LENGTH OF SCB'S TO FIX   X01004 38670005
*                                                                X01004 38680005
         BAL   RC,FIXPAGE               FIX SCB                  X01004 38690005
*                                                                X01004 38700005
         SR    RJ,RJ                    CLEAR FOR INSERT         X01004 38710005
         LR    RF,RTIOT                 RESTORE COUNT OF DEB     X01004 38720005
         SR    RTIOT,RTIOT               EXTENTS                 X01004 38730005
         IC    RJ,AVTSCBSZ              SIZE OF ONE LCB          X01004 38740005
LOADSCBA EQU   *                                                 X01004 38750005
         DROP  RDEB                                              X01004 38760005
         USING IEDQSCB,RDEB                                      X01004 38770005
         ST    RDEB,LCBMSGFM            SET SCB POINTER IN LCB   X01004 38780005
         LA    RC,AVTBFRTB              BUFFER RETURN QCB ADDR   X01004 38790005
         ST    RC,SCBDESTQ-ONE          STORE IN SCB             X01004 38800005
         OI    SCBQTYPE,SCBBBFTM        SET MID BATCH BIT        X01004 38810005
         LA    RC,AVTINOUT              INEND/OUTEND PARM LIST   X01004 38820005
         ST    RC,SCBMACR-ONE           STORE IN SCB             X01004 38830005
         AR    RDEB,RJ                  ADDRESS OF NEXT SCB      X01004 38840005
         B     SETQEVNT                 SET QEVENT IN LCB        X01004 38850005
         DROP  RDEB                                              X01004 38860005
         USING IEDQDEB,RDEB                                      X01004 38870005
SETKEY   EQU   *                                                 X01004 38880005
         MVI   LCBRSKEY,LEASREV         SET RECEIVE SCHED. KEY   X01004 38890005
         TM    TWO(RD),GRAPHICS         2260 LOCAL DATA SET      X01004 38900005
         BZ    SETQEVNT                 NO, BRANCH               X01004 38910005
         MVI   LCBRSKEY,LOCALKEY        SET 2260L RECEIVE SCHED. X01004 38920005
SETQEVNT EQU   *                                                 X01004 38930005
         SLL   RTIOT,TWO                MULT UCB COUNT BY FOUR   X01004 38940005
         L     RC,DCBINVLI(RTIOT)       ADDRESS INVITATION LIST  X01004 38950005
         LA    RC,EIGHT(RC)             FIRST ACTIVE ENTRY       X01004 38960005
         ST    RC,LCBINVPT-ONE          SAVE IN LCB              X01004 38970005
         STCM  RDCB,AD,LCBDCBPT+ONE     SAVE DCB IN LCB          X01004 38980005
         MVC   LCBRSLNK(THREE),AVTDELAD+ONE ADDR OF DUMMY LAST   X01004 38990005
*                                        ELEMENT                 X01004 39000005
         MVI   LCBFLAG1,IOSFLAG         SET IOS FLAG             X01004 39009005
         MVC   LCBTPCD(FOUR),TPOPCODE   MOVE OP CODE TO LCB      X01004 39018005
         LA    RC,AVTDMECB              ADDRESS OF A DUMMY ECB   X01004 39027005
         ST    RC,LCBECBCC              STORE ECB PTR INTO LCB   X01004 39036005
         SRL   RTIOT,TWO                REDUCE UCB COUNT         X01004 39045005
         STC   RTIOT,LCBUCBX            ZERO FIRST UCB INDEX     X01004 39054005
         ST    RCORE,AVTDOUBL           SAVE REPRESENTATIVE    @XA03965 39057081
*                                       LCB ADDRESS            @XA03965 39060081
         LA    RTIOT,ONE(RTIOT)         BUMP UCB INDEX           X01004 39063005
         LA    RCORE,ONE(RUCB,RCORE)    BUMP TO NEXT LCB         X01004 39072005
         BCT   RF,STARTIOB              DECREMENT EXTENTS AND    X01004 39081005
*                                        PROCESS NEXT LCB        X01004 39100005
         L     RJ,FOUR(RWTGC)           OPEN WORK AREA ADDRESS   X01004 39110005
         NI    DXCCW12-ONE(RJ),CLEARBIT  TURN OFF BITS SET BY    X01004 39120005
*                                        IGG01936                X01004 39130005
         EJECT                                                   X01004 39140005
         LR    RE,RDCB                  DCB ADDRESS              X01004 39150005
         SR    RF,RF                    CLEAR REG              @ZA06161 39160081
         IC    RF,DCBILCT               NUMBER OF ELEMENTS IN  @ZA06161 39162081
*                                        INVITATION LIST       @ZA06161 39164081
         SLL   RF,TWO                   INVITATION LIST LENGTH @ZA06161 39166081
         LA    RF,DCBEND(0,RF)          LENGTH OF DCB          @ZA06161 39168081
*                                                                X01004 39170005
         BAL   RC,FIXPAGE               FIX DCB                  X01004 39180005
*                                                                X01004 39190005
         SR    RTIOT,RTIOT              CLEAR FOR INSERT         X01004 39200005
         IC    RTIOT,DCBILCT            GET NUMBER OF INVITATION X01004 39210005
*                                         LISTS                  X01004 39220005
INVFIX   EQU   *                                                 X01004 39230005
         LR    RCORE,RTIOT              GET INVITATION LISTS YET X01004 39240005
*                                         TO FIX                 X01004 39250005
         BCTR  RCORE,ZERO               SUBTRACT ONE             X01004 39260005
         SLL   RCORE,TWO                MULTIPLY BY FOUR         X01004 39270005
         L     RUCB,DCBINVLI(RCORE)     ADDRESS OF INVITATION    X01004 39280005
*                                         LIST                   X01004 39290005
         SR    RC,RC                                             X01004 39300005
         SR    RF,RF                                             X01004 39310005
         IC    RC,ZERO(RUCB)            GET NUMBER OF ENTRIES    X01004 39320005
         IC    RF,TWO(RUCB)             GET LENGTH OF EACH ENTRY X01004 39330005
         MR    RE,RC                    GET LENGTH OF LIST       X01004 39340005
         AR    RC,RC                    MULT NUMBER OF ENTRIES   X01004 39350005
*                                         BY TWO TO GET SIZE OF  X01004 39360005
*                                         INVITATION LIST PREFIX X01004 39370005
         AR    RF,RC                    SET LENGTH TO FIX        X01004 39380005
         LA    RF,NINE(RF)              INCR SIZE= DW & DELIM   OY00530 39381054
         TM    THREE(RUCB),X80          EOT SIZE PRESENT ?      OY00530 39382054
         BNO   NOEOT                    NO, BRANCH              OY00530 39383054
         LA    RF,ONE(RF)               BUMP SIZE               OY00530 39384054
NOEOT    EQU   *                                                OY00530 39385054
         SR    RUCB,RC                  GET ADDRESS OF PREFIX    X01004 39390005
         LR    RE,RUCB                  ADDRESS TO FIX           X01004 39400005
         BAL   RC,FIXPAGE               FIX INVITATION LIST      X01004 39430005
         L     RUCB,AVTDOUBL            GET LCB ADDRESS        @XA03965 39432081
         CLI   LCBRSKEY-IEDQLCB(RUCB),BUFKEY  LCB FOR BUFF TERM@XA03965 39434081
         BE    NOCPUID                  BRANCH IF YES          @XA03965 39436081
         L     RUCB,DCBINVLI(RCORE)     ADDR OF INVITATION LIST@XA03965 39438081
         CLI   FIVE(RUCB),ZERO          CPUID ADDRESS HERE     @XA03965 39440081
         BE    NOCPUID                  BRANCH IF NO           @XA03965 39442081
         L     RUCB,FOUR(,RUCB)         CPUID ADDRESS          @XA03965 39444081
         LR    RE,RUCB                  SET PGFIX PARM         @XA03965 39446081
         SR    RF,RF                    CLEAR FOR INSERT       @XA03965 39448081
         IC    RF,ZERO(,RUCB)           NO. OF CHARS IN CPUID  @XA03965 39450081
         LA    RF,ONE(,RF)              ADD ONE FOR PREFIX     @XA03965 39452081
         BAL   RC,FIXPAGE               FIX CPID               @XA03965 39454081
NOCPUID  EQU   *                                               @XA03965 39456081
         BCT   RTIOT,INVFIX             GET NEXT LIST            X01004 39460005
         MVC   AVTEZERO(TWO,RWTGC),AQTAMLD3 MOVE ID TO THE     @Z30X8NM 40300008
*                                         WHERE-TO-GO TABLE             40400020
         L     RJ,FOUR(RWTGC)           ADDRESS OF OPEN WORK AREA       40500020
         STM   RE,RJ,0(RJ)              SAVE REGISTERS IN THE OPEN      40600020
*                                         WORK AREA                     40700020
RELOOP   EQU   *                                                        40800020
         LA    RWTGC,EIGHT(RWTGC)       BUMP POINTER TO NEXT ENTRY      40900020
*                                         IN WTG TABLE                  41000020
         LA    RPARC,FOUR(RPARC)        BUMP POINTER TO NEXT DCB        41100020
*                                         CALL FOR THIS EXECTOR         41200020
         STC   RTIOT,AVTOPERL           CLEAR THE LINE NUMBER FIELD     41250020
          CLC   0(2,RWTGC),AMIDCNST      IS THIS EXECUTOR REQUII-ED     41300020
*                                         AGAIN                         41400020
         BE    RESTART                  RETURN TO BEGINNING             41500020
*                                                                       41600020
         CLC   0(TWO,RWTGC),OPIDCNST    TEST FOR END OF WTG TABLE       41700020
         BNE   RELOOP                   TEST NEXT ENTRY                 41800020
         LR    RPARC,RPAR               INITIALIZE CURRENT DCB REG      41900020
         LA    RWTGC,32(RWTG)             AND WTG REGISTER              42000020
*                                                                       42100020
ZCHECK   EQU   *                                                        42200020
         CLI   0(RWTGC),X'00'           IS THIS ENTRY COMPLETED         42300020
         BNE   XCTRTNE                  IF ENTRY IS NOT COMPLETE,       42400020
*                                         TRANSFER CONTROL              42500020
         LA    RWTGC,EIGHT(RWTGC)       BUMP POINTER TO TEST FOR        42600020
         LA    RPARC,FOUR(RPARC)          COMPLETION OF THE NEXT        42700020
*                                         ENTRY                         42800020
         B     ZCHECK                   BRANCH TO CHECK ENTRY    S21903 42900022
XCTRTNE EQU    *                                                  *     43000020
         OI    RLD(RWTG),ONE            RESET LENGTH INDICATORS  X01004 43030005
         MVC   RECLNG(TWO,RWTG),RECLNG+TWO(RWTG)  LENGTH TO 1K   X01004 43060005
         LA    RJ,DXCCW12(RJ)           POINT TO DOUBLE WORD LIST *     43100020
         MVC   6(TWO,RWTG),0(RWTGC)     MOVE ID TO NAME FIELD     *     43200020
         MVC   14(THREE,RWTG),TWO(RWTGC) MOVE TTR TO WTG TABLE    *     43300020
         XCTL  DE=(RWTG),SF=(E,(15))    TRANSFER CONTROL          *     43400020
         CNOP  0,4                                                      43600020
AVTPAR   EQU   *                                                        43700020
         ST    RE,AVTDOUBX              SAVE ALIGNMENT          SA65392 43703005
         STM   RC,RD,AVTDOUBL           SAVE REGS OVER GETMAIN   Y01004 43706005
*                                         REQUEST                Y01004 43709005
         L     RJ,CVT(,RE)              ADDRESS OF CVT           Y01004 43712005
         L     RJ,AVTCVTPT(RJ)          ADDR OF TCAM WORK AREA   Y02027 43715006
         LA    RJ,TCXAVAIL-IEDQTCX(RJ)  ADDR OF AVAILABLE CORE   Y02027 43718006
*                                         FOR LCB'S AND SCB'S    Y01004 43721005
         LA    RF,SEVEN(RF)             ROUND UP TO DOUBLEWORD   Y01004 43721705
         SRL   RF,THREE                 LENGTH                   Y01004 43722405
         SLL   RF,THREE                 RESTORE TO BYTE LENGTH   Y01004 43723105
         LR    RD,RF                    SAVE LENGTH REQUESTED    Y01004 43724005
         NC    0(FOUR,RJ),0(RJ)         CHAIN EMPTY              Y01004 43727005
         BZ    AVTPAR2                  YES, ISSUE GETMAIN       Y01004 43730005
AVTPAR1  EQU   *                                                 Y01004 43733005
         LR    RC,RJ                    SAVE OLD CHAIN POINTER   Y01004 43736005
         L     RJ,0(RJ)                 GET NEW CHAIN POINTER    Y01004 43739005
         CLM   RF,AD,FIVE(RJ)           REQUEST SATISFIED IN THISY01004 43742005
*                                         PAGE                   Y01004 43745005
         BNH   AVTPAR6                  YES, BRANCH              Y01004 43748005
         CLC   0(FOUR,RJ),AVTFZERO      END OF CHAIN             Y01004 43751005
         BNE   AVTPAR1                  NO, BUMP TO NEXT PAGE    Y01004 43754005
AVTPAR2  EQU   *                                                 Y01004 43757005
         LR    RC,RE                    COPY ALIGNMENT          SA65392 43760005
         AR    RC,RD                    ADD GETMAIN LENGTH      SA65392 43762005
         SR    RE,RE                    CLEAR FOR CALULATION    SA65392 43764005
         LH    RF,PAGE4K                PAGE SIZE IS 4K        @Z30X8NM 43766008
AVTPAR33 EQU   *                                                 Y01004 43778005
         AR    RE,RF                    ADD ONE PAGE             Y01004 43781005
         CR    RC,RE                    LARGE ENOUGH FOR GETMAINSA65392 43784005
         BH    AVTPAR33                 NO, BUMP GETMAIN SIZE    Y01004 43787005
         ST    RE,AVTGETMN              STORE BYTE COUNT IN     SA65392 43800005
*                                         PARAMETER LIST                43900020
         OI    AVTGETMN+EIGHT,PAGE      GETMAIN ON PAGE BOUNDARY Y01004 44000005
         ST    RJ,AVTGETMN+FOUR         RECEIVE ADDR IN SECONDY  Y01004 44050005
*                                         WORD OF PARAMETER LIST        44100020
         LA    RF,AVTGETMN              LOAD THE ADDRESS OF THE         44200020
*                                         PARAMETER LIST                44300020
         SPACE 2                                                        44320006
         MODESET EXTKEY=TCAM            GET INTO KEY 6           Y02027 44340006
         SPACE 2                                                        44360006
         GETMAIN  ,MF=(E,(1))           GETMAIN MACRO                   44400020
         SPACE 2                                                        44420006
         MODESET EXTKEY=SUPR            RETURN TO KEY 0          Y02027 44440006
         SPACE 2                                                        44460006
         EJECT                                                          44500006
         NI    AVTGETMN+EIGHT,FOX-PAGE  RESET PAGE BOUNDARY      X01004 44550005
         LTR   RJ,RJ                    TEST THE RETURN CODE            44600020
         BNZ   AVTPAR8                  BRANCH IF NOT ZERO       Y01004 44700005
         L     RC,AVTGETMN+FOUR         ADDRESS OF GOTTEN CORE   Y01004 44702005
*                                         ADDRESS                Y01004 44704005
         L     RF,AVTGETMN              LENGTH OF GOTTEN CORE    Y01004 44706005
         L     RJ,0(RC)                 ADDRESS OF GOTTEN CORE   Y01004 44708005
         MVC   0(FOUR,RJ),AVTFZERO      SET END OF CHAIN         Y01004 44710005
         SR    RF,RD                    FIND CORE TO REMAIN IN   Y01004 44712005
*                                         CHAIN                  Y01004 44714005
         BZ    AVTPAR7                  REQUEST = AVAILABLE      Y01004 44716005
         SR    RE,RE                    CLEAR                  @XA11331 44718081
         ICM   RE,SEVEN,AVTDOUBX+ONE    GET ALIGNMENT          @XA11331 44719081
         BZ    AVTPAR4                  NO ALLIGN               SA65392 44720005
         ST    RE,FOUR(RJ)              UPDATE AVAILABLE CORE   SA65392 44722005
         LA    RC,ZERO(RJ,RD)           CORE AVAIL. AT END      SA65392 44724005
         AR    RC,RE                    ADJUST FOR EXTRA CORE   SA65392 44726005
         CR    RF,RE                   CORE LEFT EQUAL ALIGNMENTSA65392 44726605
         BE    AVTPAR5                 YES,BRANCH               SA65392 44727205
         MVC   ZERO(FOUR,RC),AVTFZERO   SET END OF CHAIN        SA65392 44728005
         ST    RC,ZERO(RJ)              CHAIN AVAILABLE CORE    SA65392 44730005
         SR    RF,RE                    ADJUST FOR EXTRA CORE   SA65392 44732005
         ST    RF,FOUR(RC)              UPDATE AVAILABLE CORE   SA65392 44734005
         LR    RF,RE                    SET INDEX TO AVAIL. CORESA65392 44735005
         B     AVTPAR5                  RETURN                  SA65392 44736005
AVTPAR4  EQU   *                                                SA65392 44738005
         ST    RF,FOUR(RJ)              UPDATE AVAILABLE CORE IN Y01004 44740005
*                                         PAGE                   Y01004 44742005
AVTPAR5  EQU   *                                                 Y01004 44744005
         LA    RJ,0(RF,RJ)              BUMP TO ALLOCATED CORE   Y01004 44746005
         ST    RJ,AVTGETMN+FOUR         RETURN ADDRESS TO CALLER Y01004 44748005
*                                         OF ALLOCATED CORE      Y01004 44750005
         ST    RD,AVTGETMN              RETURN LENGTH TO CALLER  Y01004 44752005
         LM    RC,RD,AVTDOUBL           RESTORE TEMP. REGISTERS  Y01004 44754005
         BR    RC                       RETURN TO CALLER         Y01004 44756005
AVTPAR6  EQU   *                                                 Y01004 44758005
         L     RF,FOUR(RJ)              GET LENGTH AVAILABLE IN  Y01004 44760005
*                                         PAGE                   Y01004 44762005
         SR    RF,RD                    FIND CORE TO REMAIN IN  SA65392 44764005
*                                         CHAIN                 SA65392 44766005
         BZ    AVTPAR7                  REQUEST = AVAILABLE     SA65392 44768005
         ST    RF,FOUR(RJ)              UPDATE AVAILABLE CORE INSA65392 44770005
*                                         PAGE                  SA65392 44772005
         B     AVTPAR5                  RETURN CORE TO CALLER   SA65392 44774005
AVTPAR7  EQU   *                                                 Y01004 44776005
         MVC   0(FOUR,RC),0(RJ)         REMOVE PAGE FROM CHAIN   Y01004 44778005
         B     AVTPAR5                  RETURN CORE TO CALLER    Y01004 44800005
AVTPAR8  EQU   *                                                 Y01004 44804005
         LM    RC,RD,AVTDOUBL           RESTORE USED REGS        Y01004 44808005
         B     WTGSETUP                 BRANCH TO ERROR RTN.     Y01004 44812005
FIXPAGE  EQU   *                                                 X01004 44816005
         LR    RJ,RE                    COPY ADDRESS TO FIX      X01004 44820005
         LA    RJ,ZERO(RF,RJ)           END ADDRESS + ONE      @Z30X8NM 44824008
         LR    RF,RE                    START ADDRESS          @Z30X8NM 44834008
         LA    RE,AVTDMECB              ADDRESS OF FIX ECB       X01004 44844005
         XC    AVTDMECB(FOUR),AVTDMECB  CLEAR ECB                X01004 44848005
*                                                                X01004 44852005
         PGFIX R,A=(1),EA=(15),ECB=(0)  FIX DATA AREA          @Z30X8NM 44856008
*                                                                X01004 44868005
         WAIT  ECB=AVTDMECB             WAIT FOR PAGE FIX      @Z30X8NM 44872008
*                                                                X01004 44888005
         TM    AVTDMECB+THREE,FOUR      CHECK RETURN CODE        X01004 44892005
         BCR   EIGHT,RC                 RETURN TO CALLER         X01004 44896005
         B     WTGSETUP                 EXIT TO OPEN ERROR RTNE  X01004 44900005
RECOVER  EQU   *                                                        44910020
         L     RE,SAVE0(RJ)             PICK UP THE NUMBER OF           44920020
*                                         TERMINAL ENTRIES STILL TO     44930020
*                                         BE CHECKED                    44940020
         B     TERMADL                  CONTINUE THE TESTING LOOP       44950020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     45000020
*                                                                 *     45100020
*        THIS SECTION OF ERROR CODE IS EXECUTED ONLY WHEN         *     45200020
*        A BAD BRANCHING INDEX IS GENERATED FROM THE UCB          *     45300020
*                                                                 *     45400020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     45500020
ERROR    EQU   *                                                        45600020
         MVI   AVTOPERT,TCAMER05        MOVE THE ERROR IDENTIFIER       45700020
*                                         FOR TCAM INTO THE AVT         45800020
         B     WTGSETUP                 SET THE WHERE-TO-GO ENTRY       46200020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     46301020
*                                                                 *     46302020
*        THIS SECTION OF ERROR CODE IS EXECUTED ONLY WHEN         *     46303020
*        AN ENTRY IN THE TERMINAL TABLE HAS SPECIFIED A           *     46304020
*        PARTICULAR TYPE OF QUEUEING AND THE USER HAS             *     46305020
*        FAILED TO PROVIDE THE NECESSARY DATA SET                 *     46306020
*                                                                 *     46307020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     46308020
ERROR01  EQU   *                                                        46309020
         MVI   AVTOPERT,TCAMER19        MOVE THE ERROR IDENTIFIER       46310020
*                                         FOR TCAM INTO THE AVT         46311020
         L     RJ,FOUR(RWTGC)           LOAD THE ADDRESS OF THE         46312020
*                                         OPEN WORK AREA                46313020
         STM   RF,RE,FOUR(RJ)           SAVE REGISTERS 1 THRU 0 IN      46314020
*                                         THE OPEN WORK AREA            46315020
         SR    RE,RE                    CLEAR A COUNT REGISTER          46316020
         IC    RE,AVTOPERL              PICK UP THE LAST SAVED          46317020
*                                         RELAYIVE LINE NUMBER          46318020
         LTR   RE,RE                    HAS THIS EXIT BEEN TAKEN        46319020
*                                         FOR THIS DCB                  46320020
         BZ    LINESAVE                 NO, BRANCH                      46321020
         CLC   QCBRELLN(ONE),AVTOPERL   COMPARE THE RELATIVE LINE       46323020
*                                         NUMBERS                       46324020
         BH    WTGSETUP                 IF SAVED LINE NUMBER IS         46325020
*                                         LOWER, BRANCH                 46326020
LINESAVE EQU   *                                                        46327020
         SR    RJ,RJ                    CLEAR A LINE REGISTER           46328020
         IC    RJ,QCBRELLN              PICK UP THE LOWER RELATIVE      46329020
*                                         LINE NUMBER                   46330020
         LTR   RJ,RJ                    IS THIS A LEGITIMATE LINE       46331020
*                                         NUMBER                        46332020
         BNZ   SETLINE                  YES, BRANCH                     46333020
         MVI   AVTOPERT,TCAMER21        MOVE THE ERROR IDENTIFIER       46334020
*                                         FOR TCAM INTO THE AVT         46335020
         STC   RJ,AVTOPERL              CLEAR THE LOWEST LINE           46336020
*                                         NUMBER SAVED                  46337020
         B     WTGSETUP                 GO TO THE ERROR EXIT            46338020
SETLINE  EQU   *                                                        46339020
         STC   RJ,AVTOPERL              SAVE THE LOWEST RELATIVE        46340020
*                                         LINE  NUMBER                  46341020
         BCTR  RJ,0                     REDUCE THE LINE NUMBER BY 1     46342020
         STC   RJ,DEBNMEXT              RESET THE NUMBER OF OPENED      46343020
*                                         LINES                         46344020
         B     WTGSETUP                 GO TO THE EXIT ROUTINE          46345020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     46347020
*                                                                 *     46348020
*        THIS SECTION OF ERROR CODE IS EXECUTED ONLY WHEN         *     46349020
*        THERE ARE NO ACTIVE LINES IN A LINE GROUP DUE TO         *     46350020
*                            UNOPENED DATA SETS                   *     46351020
*                                                                 *     46352020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     46353020
ERROR02  EQU   *                                                        46354020
         MVI   AVTOPERT,TCAMER20        MOVE THE ERROR IDENTIFIER       46355020
*                                         FOR TCAM INTO THE AVT         46356020
         B WTGSETUP                     GO TO THE ERROR EXIT            46357020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     46400020
*                                                               *X01004 46408005
*        THIS SECTION OF ERROR CODE IS EXECUTED ONLY WHEN A     *X01004 46416005
*        CONFLICT IS FOUND BETWEEN THE OPTIONAL FEATURES        *X01004 46424005
*        SPECIFIED IN THE UCB AND THE OPTIONAL FEATURES         *X01004 46432005
*        REFLECTED IN THE DEVICE CHARACTERISTICS TABLE.         *X01004 46440005
*                                                               *X01004 46448005
*****************************************************************X01004 46456005
ERR01 EQU *                                                      X01004 46464005
         MVI   AVTOPERT,TCAMER22        ERROR ID FOR TCAM        X01004 46472005
         B     WTGSETUP                 TAKE ERROR EXIT          X01004 46480005
*****************************************************************X01004 46488005
*                                                                 *     46500020
*        THIS SECTION OF ERROR CODE IS EXECUTED ONLY WHEN AN      *     46600020
*        ERROR IS DETECTED WHILE EXAMINING THE DEVICE             *     46700020
*        CHARACTERISTICS TABLE ENTRY FOR THIS TERMINAL TYPE       *     46800020
*                                                                 *     46900020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     47000020
DEVCHRER EQU   *                                                        47100020
         MVI   AVTOPERT,TCAMER06        MOVE THE ERROR IDENTIFIER       47200020
*                                         FOR TCAM INTO THE  AVT        47300020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     47800020
*                                                                 *     47900020
*        THIS SECTION OF CODE IS USED TO SAVE THE ID OF THE       *     48000020
*        CURRENT OPEN EXECUTOR AND TO MOVE THE ID OF THE          *     48100020
*        ERROR RECOVERY MODULE INTO THE WHERE-TO-GO PARAMETER     *     48200020
*                            LIST                                 *     48300020
*                                                                 *     48400020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     48500020
WTGSETUP EQU   *                                                        48600020
         L     RJ,FOUR(RWTGC)           LOAD THE ADDRESS OF THE         48700020
*                                         OPEN WORK AREA                48800020
         MVC   AVTOPXCL(TWO),AMIDCNST   MOVE THE ID OF THE CURRENT      48900020
*                                         EXECUTOR INTO THE AVT         49000020
*                                         FOR THE RETURN TO THIS        49100020
*                                         EXECUTOR                      49200020
         MVC   AVTEZERO(TWO,RWTGC),OPENERP MOVE ID FOR THE     @Z30X8NM 49300008
*                                         ERROR MODULE INTO THE         49400020
*                                         WHERE-TO-GO PARAMETER LIST    49500020
         B     XCTRTNE                  GO TO THE XCTL ROUTINE          49600020
         EJECT                                                          49700020
*********************************************************************** 49710022
*        PROGRAM EQUATES                                              * 49720022
*********************************************************************** 49730022
ZERO     EQU   0                        DISPLACEMENT             X01004 49810005
ONE      EQU   1                        DISPLACEMENT             S22024 49890022
TWO      EQU   2                        DISPLACEMENT             S22024 49980022
THREE    EQU   3                        FLAG                     S22024 50070022
FOUR     EQU   4                        DISPLACEMENT             S22024 50160022
FIVE     EQU   5                        DISPLACEMENT             S22024 50250022
SIX      EQU   6                        DISPLACEMENT             S22024 50340022
BSCMULTI EQU   7                        DISPLACEMENT             S22024 50430022
SEVEN    EQU   7                        DISPLACEMENT             S22024 50520022
EIGHT    EQU   8                        DISPLACEMENT             S22024 50610022
NINE     EQU   9                        DISPLACEMENT             X01004 50700005
TEN      EQU   10                       DISPLACEMENT             S22024 50790022
AUTOPOLL EQU   12                       NUMBER OF CCW'S IN THE   X01004 50900005
*                                         CHANNEL PROGRAM FOR AN        51000020
*                                         AUTOPOLLED DEVICE             51100020
TWELVE   EQU   12                       DISPLACEMENT             X01004 51150005
LMD      EQU   X'03'                    LMD SPECIFIED ON STARTMH X01004 51200005
MHBT     EQU   X'08'                    SET BT FOR LINEEND       Y01004 51250005
TCAMER19 EQU   19                       ERROR CODE               S22024 51320022
TCAMER20 EQU   20                       ERROR CODE               S22024 51390022
TCAMER21 EQU   21                       ERROR CODE               S22024 51460022
TCAMER22 EQU   22                       UCB INVALID CODE         X01004 51490005
IOBPTR   EQU   32                       IOB POINTER              S22024 51530022
SAVE0    EQU   64                       SAVE LENGTH              S22024 51600022
DEBUCB   EQU   68                       DEB & UCB                S22024 51670022
EXERR01  EQU   X'01'                    FLAG                     S22024 51740022
EXERR02  EQU   X'02'                    FLAG                     S22024 51810022
TCAMER05 EQU   X'05'                    FLAG                     S22024 51880022
TCAMER06 EQU   X'06'                    FLAG                     S22024 51950022
TCAMER07 EQU   X'07'                    FLAG                     S22024 52020022
GRAPHICS EQU   X'10'                    FLAG                     S22024 52160022
WTTADPTR EQU   X'60'                    FLAG                     S22024 52370022
CLEARBIT EQU   X'7F'                    FLAG                     S22024 52440022
DIAL     EQU   X'90'                    FLAG                     S22024 52510022
DXCCW12  EQU   X'1C8'                   FLAG                     S22024 52580022
CHAINLCB EQU   60                       OFFSET TO LCB CORE       Y01004 52583005
FIXPG    EQU   X'52'                    PAGE FIX FLAGS           X01004 52589005
PGFIX    EQU   113                      SVC PAGE FIX             X01004 52592005
LCBPOOL  EQU   250                      SUBPOOL FOR THE LCB      Y02027 52596006
SCBPOOL  EQU   250                      SUBPOOL FOR THE SCB      Y02027 52597006
TCAMER08 EQU   8                        SCB GETMAIN FAILED       X01004 52598005
TIMDELAY EQU   X'14'                    TIME DELAY OFFSET        X01004 52601005
DIALREV  EQU   X'18'                    DIAL RECEIVE SCHED. CODE X01004 52604005
LOCALKEY EQU   X'1E'                    LOCAL RECEIVE SCHED. CODEX01004 52607005
LEASREV  EQU   X'0C'                    RECEIVE SCHED. CODE      X01004 52610005
BUFKEY   EQU   X'1A'                    BUFF TERM SCHED CODE   @XA03965 52611081
RECLNG   EQU   25                       OFFSET TO MODULE SIZE    X01004 52613005
RLD      EQU   22                       OFFSET TO RLD FLAG       X01004 52616005
HI       EQU   8                        ICM0STCM MASK            X01004 52619005
SYSTYPE  EQU   116                      SYSTEM TYPE CVT OFFSET   X01004 52622005
AD       EQU   7                        ICM/STCM MASK            X01004 52628005
TRETEN   EQU   13                       OFFSET OF 13             X01004 52631005
CVT      EQU   16                       OFFSET TO CVT            X01004 52634005
PAGE     EQU   X'10'                    PAGE BOUNDARY FLAG       X01004 52637005
L2741    EQU   X'80'                    2741 FLAG                X01004 52640005
X80      EQU   X'80'                                            OY00530 52641054
IOSFLAG  EQU   X'C2'                    FLAG IOB FOR IOS         X01004 52643005
FOX      EQU   X'FF'                    CONSTANT OF FF           X01004 52646005
LCB248   EQU   248                      MAX. LCB SIZE            X01004 52649005
CLEAR    XC    0(ONE,RCORE),0(RCORE)    CLEAR ONE LCB            X01004 52652005
LCB200   DC    H'208'                   LCB SIZE FOR 2260 LOCAL SA65392 52655005
*                                        PLUS EIGHT             SA65392 52657005
HALF12   DC    H'12'                    HALFWORD OF 12         @OZ24288 52659000
BIGLCB2  EQU   16                       VS/2 PAGE ALLIGN OFFSET@OZ24143 52664000
VS2MAX   EQU   82                       MAX LINES IN VS/2 GROUP@OZ24143 52670000
PAGE4K   DC    H'4096'                  PAGE SIZE              @Z30X8NM 52700008
OPIDCNST DC    C'0S'                    ID FOR COMMON OPEN       Y02027 52720006
AQTAMLD3 DC    C'37'                    NEXT LOAD OF OPEN        Y02027 52740006
OPENERP  DC    C'33'                    ERROR RECOVERY MODULE    Y02027 52760006
AMIDCNST DC    C'36'                    CONSTANT                 S21903 52800022
TPOPCODE DC    X'02020202'              TP OP CODE               X01004 52900005
DEVCLASS EQU   2                        UCBTYPE OFFSET TO CLASS  X01004 52910005
MODLCODE EQU   0                        UCBTYPE MODEL CODE       X01004 52920005
ALL      EQU   15                       MODEL CODE MASK          X01004 52930005
AUDIOCTL EQU   X'00'                    AUDIO LINE MASK          X01004 52940005
ADAPTYPE EQU   3                        UCBTYPE ADAPTER OFFSET   X01004 52960005
BISC     EQU   X'90'                    BISC LINE MASK           X01004 52970005
SENDPRI  EQU   X'20'                    SEND PRIORITY            A48258 52990005
         EJECT                                                          54400020
         TDCTD                                                 @G36XRNP 54430000
         EJECT                                                          54460000
         TDEBD                                                          54500020
         EJECT                                                          54600020
         TTNTD                                                          54700020
         EJECT                                                          54800020
         TLCBD                                                          54900020
         EJECT                                                          55000020
         TQCBD                                                          55100020
         EJECT                                                          55200020
         TTCXD                                                   Y02027 55230006
         EJECT                                                          55260006
         TAVTD                                                          55300020
         EJECT                                                          55400020
         DCBD  DSORG=TX                                                 55500020
DCBEND   EQU   DCBINVLI-IHADCB          END OF DCB             @ZA06161 55507081
         EJECT                                                   X01004 55514005
         TSCBD                                                   X01004 55521005
         EJECT                                                          55530022
         TTRMD                                                          55560022
         END                                                            55600020
