         TITLE 'IGG01938 FOURTH LOAD OF LINE GROUP OPEN'                00100010
IGG01938 CSECT                                                          00200010
         SPACE 3                                                        00200510
*CHANGE-ACTIVITY = AS FOLLOWS                                    S21903 00201010
******************** MICROFICHE FLAGS *********************** SUPT CODE 00201510
*A430000,451000                                                 SA54300 00202010
*A092000                                                         A44912 00202110
*A126000,152000                                                  A44912 00202210
*D154000-159000,166000                                           A44912 00202310
*C139000                                                         A44912 00202410
*A535000                                                         S21101 00202510
*C391000                                                         S21101 00202610
*A562000                                                         A44908 00202710
*C092000,442000-447000                                           A44908 00202810
*C092400,436000-446800                                            M1178 00202910
*D468000,476000,092050-092150                                     M1178 00203010
*A435600,477420,477740                                          SA51084 00203110
*A390200                                                        SA52995 00203210
*C092400,390200                                                 SA52995 00203310
*D391400-394000                                                 SA52995 00203410
*A002000                                                         S21903 00203510
*C003000,090000,147000,149000,345000,347000,355000,515000-516000 S21903 00203610
*C522000-523000,528000-533000,568000,570000,573000-576000        S21903 00203710
*D390300                                                        SA61064 00203810
*A559000                                                         Y01004 00203910
*C092000-093000,101000                                           Y01004 00204010
*A105000                                                        SA65392 00223810
*D107000,335000,522000-523000,526000,534000-535000,536000       SA65392 00243810
*D543000,548300-548600,562300-562600                            SA65392 00263810
*C004000,015000,018000,029000,030000,031000,031500,047000,048000 Y02027 00263910
*C087000,088000,096000,097000,098000,099000,100000,101000,358000 Y02027 00264010
*C490000,521000,537000,538000-541000,544000-556000,558000        Y02027 00264110
*D559000-559600                                                  Y02027 00264210
*A029500,032500-035500,083500,091500,180500                      Y02027 00264310
*A194500,223500,278500,334500-335500,435840-435960               Y02027 00264410
*A537300,537600,580100-580600                                    Y02027 00264510
*C181000,189000,192000,196000,201000,230000,237050,248000        Y02027 00264610
*C273000,277000,372000,396000,403000,410000,424000,538000,539000 Y02027 00264710
*D086500,537000,537300                                           Y02027 00264810
*A166000,181500,192500,372500,396500,403500,410500,477190,539500 Y02027 00264910
*A576200-576600                                                  Y02027 00265010
*A101000                                                       @ZA01156 00273010
*C105350                                                       @ZA01156 00281010
*A141000,151000,533000                                         @SA73558 00289010
*C190000-194000                                                @ZA02632 00294010
*A461000                                                       @OS76977 00294110
*D564000-568500,573000-576000                                  @OS76977 00294210
*A430000,5620000                                                X30X5MT 00294310
*A221100                                                       @YA14062 00295310
*C183000-188000,190000,193500,196000-197000,220000-221000      @YA14062 00296310
*D198000-203000                                                @YA14062 00297310
*C105770                                                       @OX16393 00297410
*A187800                                                       @OY16102 00297510
*D190600-192400,211000-219000                                  @OY16102 00297610
*A220400,221600                                                @OS78352 00297710
*C105770                                                       @OZ24288 00298010
*A126500,525000                                                @OY18871 00298310
*D562300                                                       @OY18871 00298610
         SPACE 3                                                        00300010
*********************************************************************** 00310010
*                                                                     * 00320010
*MODULE-NAME = IGG01938                                          S21903 00330010
*                                                                S21903 00340010
*DESCRIPTIVE-NAME = FOURTH LOAD OF LINE GROUP OPEN               S21903 00350010
*                                                                S21903 00360010
*COPYRIGHTS = 'NONE'                                             S21903 00370010
*                                                                S21903 00380010
*STATUS = CHANGE LEVEL 6                                         Y02027 00400010
*                                                                     * 00500010
*FUNCTION/OPERATION - THIS EXECUTOR CALCULATES THE NUMBER OF          * 00509010
*   STCB'S IN THE STCB CHAIN OF EACH LCB IN THIS LINE GROUP           * 00518010
*   AND STORES THIS NUMBER IN THE INVITATION LIST FOR THIS            * 00527010
*   LINE.                                                             * 00536010
*   IT MODIFIES THE ERRTAB AND ATNTAB FIELDS IN THE UCB FOR           * 00545010
*   EACH LINE.                                                        * 00554010
*   IT BUILDS THE INITIAL CONTACT CHANNEL PROGRAM IN THE LCB          * 00563010
*   FOR EACH LINE.                                                    * 00572010
*   IT DETERMINES HOW EACH LINE IS TO BE STARTED AND THIS             * 00581010
*   STATUS IS INDICATED IN THE LCB.                                   * 00590010
*                                                                     * 01300010
*INPUT - THE REGISTERS 5, 6, 7, AND 8 ARE THE INPUT AS FOLLOWS        * 01400010
*   5 -  THE ADDRESS OF THE WTG TABLE PREFIX                     Y02027 01500010
*   6 -  THE ADDRESS OF THE BEGINNING OF THE WHERE-TO-GO TABLE.       * 01700010
*   7 -  THE ADDRESS OF THE COPY OF THE CURRENT DCB              Y02027 01800010
*   8 -  THE ADDRESS OF THE CURRENT ENTRY IN THE WHERE-TO-GO          * 02000010
*        TABLE .                                                      * 02100010
*                                                                     * 02200010
*ENTRY POINTS - THIS ROUTINE IS ENTERED AT IGG01938 VIA AN            * 02300010
*   XCTL FROM THE OPEN EXECUTOR IGG01937.  IT MAY ALSO BE             * 02400010
*   RE-ENTERED FROM THE RELOOP PORTION OF THIS ROUTINE IF             * 02500010
*   IT IS DETERMINED THAT THERE IS ANOTHER DATA CONTROL               * 02600010
*   BLOCK TO BE OPENED.                                               * 02700010
*                                                                     * 02800010
*OUTPUT -                                                        Y02027 02900010
*   REGISTER 7 WILL BE POSITIONED AT THE ADDRESS OF THE          Y02027 02950010
*   COPY OF THE NEXT DCB TO BE PROCESSED                         Y02027 03000010
*                                                                Y02027 03100010
*   REGISTER 8 WILL BE POSITIONED AT THE NEXT ENTRY IN           Y02027 03150010
*   THE WHERE-TO-GO PARAMETER LIST                               Y02027 03250010
*                                                                Y02027 03350010
*   INITIAL CHANNEL PROGRAMS WILL HAVE BEEN BUILT IN             Y02027 03450010
*                   EACH LCB                                     Y02027 03550010
*EXTERNAL ROUTINES - NONE                                             * 03700010
*                                                                     * 03800010
*EXITS - NORMAL                                                       * 03900010
*   THIS ROUTINE EXITS VIA AN XCTL TO THE EXECUTOR IDENTIFIED         * 04000010
*   BY THE NEXT NON-ZERO ENTRY IN THE WHERE-TO-GO TABLE,              * 04100010
*   NAMELY IGG01939.                                                  * 04200010
*                                                                     * 04300010
*      - ERROR                                                        * 04400010
*                                                                     * 04500010
*TABLES/WORK AREAS - THE WHERE-TO-GO TABLE CONTAINS THE ID AND        * 04600010
*   TTR OF THE OPEN EXECUTORS AS WELL AS THE ADDRESS             Y02027 04700010
*   OF A COPY OF EACH DCB SPECIFIED IN THE OPEN                  Y02027 04800010
*   MACRO INSTRUCTION.  THE SPECIAL CHARACTERS TABLE CONSISTS         * 04900010
*   OF ENTRIES GIVING THE SPECIAL CHARACTERS REQUIRED FOR             * 05000010
*   DEVICE I/O FOR EACH TERMINAL                                      * 05100010
*                                                                     * 05200010
*ATTRIBUTES - THIS ROUTINE IS EXECUTED IN THE TRANSIENT AREA AS       * 05300010
*   ENABLED, PRIVILEGED, AND RE-ENTRANT.                              * 05400010
*                                                                     * 05500010
*********************************************************************** 05550010
         EJECT                                                          05600010
*                                                                       05800010
*    REGISTER USAGE                                                     05900010
*                                                                       06000010
*                                                                       06100010
RE       EQU   0                        WORK REGISTER                   06200010
RF       EQU   1                        WORK REGISTER                   06300010
RDCB     EQU   2                        ADDRESS OF THE CURRENT DCB      06400010
RTIOT    EQU   3                        WORK REGISTER                   06500010
RCORE    EQU   4                        ADDRESS OF DCB WORK AREA        06600010
RPAR     EQU   5                        ADDRESS OF FIRST ENTRY IN       06700010
*                                         DCB PARAMETER LIST            06800010
RWTG     EQU   6                        ADDRESS OF THE WHERE-TO-GO      06900010
*                                         TABLE                         07000010
RPARC    EQU   7                        ADDRESS OF THE CURRENT          07100010
*                                         ENTRY IN DCB PARAMETER        07200010
*                                         LIST                          07300010
RWTGC    EQU   8                        ADDRESS OF THE CURRENT          07400010
*                                         ENTRY IN THE WTG TABLE        07500010
RAVT     EQU   9                        ADDRESS OF THE AVT              07600010
RUCB     EQU   10                       WORK REGISTER                   07700010
RDEB     EQU   11                       WORK REGISTER                   07800010
RBASE    EQU   12                       BASE OF THIS ROUTINE            07900010
RC       EQU   13                       WORK REGISTER                   08000010
RD       EQU   14                       WORK REGISTER                   08100010
RJ       EQU   15                       WORK REGISTER                   08200010
*                                                                       08300010
         USING IEDQTCX,RF               TCX DSECT                Y02027 08350010
         USING IHADCB,RDCB              DCB DSECT                       08400010
         USING IEDQLCB,RCORE            LCB/IOB DSECT                   08500010
         USING IEDQAVTD,RAVT            AVT DSECT                       08600010
         USING DEBNMSUB,RDEB            DEB DSECT                Y02027 08700010
         USING FORCORE,RJ               OPEN WORK AREA DSECT     Y02027 08800010
*                                                                       08900010
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY S21903 09000010
         USING *,RBASE                                                  09100010
         SPACE 2                                                        09150010
IGG01938 IEDHJN RESTART                 ASSEMBLY DATE            S21903 09200010
         EJECT                                                          09400010
         L     RJ,4(RWTGC)              RESTORE THE ADDRESS OF THE      09500010
*                                       OPEN WORK AREA           Y02027 09600010
         L     RDCB,DXUDCBAD            GET THE CURRENT DCB ADDR Y02027 09700010
         L     RF,CVT                   GET THE CVT ADDRESS      Y02027 09800010
         L     RF,AVTCVTPT(RF)          GET THE TCX ADDRESS      Y02027 09900010
         L     RAVT,TCXAVT              GET THE AVT ADDRESS      Y02027 10000010
         L     RDEB,DCBDEBAD            GET THE DEB ADDRESS      Y02027 10100010
         SR    RJ,RJ                    CLEAR FOR IC           @ZA01156 10120010
         SR    RD,RD                    CLEAR FOR IC           @ZA01156 10140010
         IC    RJ,DEBNMEXT              NUMBER OF EXTENTS      @ZA01156 10160010
         IC    RD,DCBEIOBX              SIZE OF LCB            @ZA01156 10180010
         MR    RD,RD                    SIZE OF LCB POOL       @ZA01156 10200010
         SR    RD,RD                    CLEAR FOR IC           @ZA01156 10220010
         IC    RD,DCBEIOBX              SIZE OF LCB            @ZA01156 10240010
         L     RCORE,DCBIOBAD           IOB AREA               @ZA01156 10260010
         LA    RJ,0(RJ,RCORE)           IOB AREA + LCB POOL SZ @ZA01156 10280010
         AR    RJ,RD                    ADD SIZE OF LCB        @ZA01156 10300010
         LR    RD,RJ                    SAVE REG               @ZA01156 10320010
         LA    RJ,LCBFLAG1-IEDQLCB      LCB PREFIX SIZE        @ZA01156 10340010
         SR    RD,RJ                    THRESHOLD AREA         @ZA01156 10360010
         SR    RC,RC                    CLEAR WORK REGISTER     SA65392 10507010
         IC    RC,DEBNMEXT              GET NUMBER EXTENTS      SA65392 10514010
         LR    RCORE,RC                 COPY NUMBER EXTENTS     SA65392 10521010
         SLL   RCORE,TWO                SIZE OF UCB ADDRESSES   SA65392 10528010
         ST    RD,DEBUCBAD(RCORE)       SAVE THRESHOLD COUNTER @ZA01156 10535010
*                                         POINTER IN ACCESS     SA65392 10542010
*                                         METHOD SECTION OF DEB SA65392 10549010
INIT     EQU   *                                                SA65392 10556010
         MVC   AVTEZERO(FOUR,RD),AVTHRESH INITIALIZE THRESHHOLD SA65392 10563010
         MVI   AVTEZERO(RD),AVTEZERO    TRANSMISSIONS ARE ZERO  SA65392 10570010
         LA    RD,12(,RD)               BUMP TO NEXT ENTRY     @OZ24288 10577010
         BCT   RC,INIT                  CONTINUE TIL END        SA65392 10584010
         LA    RD,DEBUCBAD              ADDRESS OF DEB EXTENTS          10600010
         IC    RC,DCBEIOBX              GET THE SIZE OF AN LCB          10800010
         L     RCORE,DCBIOBAD           LOAD THE ADDRESS OF THE         10900010
*                                         FIRST IOB                     11000010
         LA    RF,PTRIOB                LOAD THE DISPLACEMENT OF        11100010
*                                         THE IOB                       11200010
         SR    RCORE,RF                 SET THE BEGINNING ADDRESS       11300010
*                                         OF THE LCB                    11400010
         LA    RCORE,0(RC,RCORE)        ADD BACK THE SIZE OF 1 LCB      11500010
         EJECT                                                          11600010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     11700010
*                                                                 *     11800010
*        THIS SECTION OF CODE CALCULATES THE NUMBER OF STCB'S     *     11900010
*        CHAINED OFF THIS PARTICULAR LINE CONTROL BLOCK AND       *     12000010
*        STORES THIS NUMBER IN THE INVITATION LIST FOR THIS DCB   *     12100010
*                                                                 *     12200010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     12300010
         SR    RE,RE                    CLEAR A REGISTER FOR AN  A44912 12310010
*                                       EXTENT COUNT             A44912 12320010
         IC    RE,DEBNMEXT              THE NUMBER OF EXTENTS TO A44912 12330010
*                                       BE USED AS A LOOP CONTROLA44912 12340010
         SR    RF,RF                    CLEAR A REGISTER FOR THE A44912 12350010
*                                       INVITATION LIST OFFSETS  A44912 12360010
NEXTLIN  EQU   *                                                 A44912 12370010
         CLI   LCBRSKEY,BUFRDTRM        IS THIS LCB FOR A BUFFERED      12400010
*                                         TERMINAL                      12500010
         BNE   DEBSET                   NO, BRANCH                      12600010
         LR    RC,RF                    SAVE INVLIST ENTRY INDEX A44912 12650010
         TM    0(RPARC),OUTONLY         IS THIS LINE OPENED    @OY18871 12655010
*                                        FOR OUTPUT ONLY       @OY18871 12660010
         BNO   STCBADDR                 NO, BRANCH             @OY18871 12665010
         L     RJ,DCBINVLI(RC)          LOAD ADDR OF INVITATION@OY18871 12670010
*                                        LIST FOR THIS DCB     @OY18871 12675010
         CLC   0(8,RJ),DBLZERO          IS THIS A DUMMY        @OY18871 12680010
*                                        INVITATION LIST       @OY18871 12685010
         BE    NOEOT                    YES, BRANCH            @OY18871 12690010
STCBADDR EQU   *                                               @OY18871 12695010
         SR    RF,RF                    CLEAR A COUNT REGISTER          12700010
         L     RJ,LCBRSLNK-1            LOAD THE ADDRESS OF THE         12800010
*                                         FIRST STCB ON THE CHAIN       12900010
STCBCHK  EQU   *                                                        13000010
         LA    RF,ONE(RF)               INCREMENT THE STCB COUNT        13100010
         CLC   FIVE(THREE,RJ),AVTDELAD+1     IS THIS THE LAST STCB      13200010
*                                            ON THE CHAIN               13300010
         BE    STCBEND                  YES, BRANCH                     13400010
         L     RJ,FOUR(RJ)              LOAD THE ADDRESS OF THE         13500010
*                                         NEXT STCB                     13600010
         B     STCBCHK                  INCREMENT THE COUNT             13700010
STCBEND  EQU   *                                                        13800010
         L     RJ,DCBINVLI(RC)          LOAD THE ADDRESS OF THE  A44912 13900010
*                                         INVITATION LIST FOR THIS      14000010
*                                         DCB                           14100010
         LR    RTIOT,RJ                 SAVE INVITATION LIST   @SA73558 14150010
         STC   RF,FOUR(RJ)              STORE THE STCB COUNT IN THE     14200010
*                                         INVITATION LIST               14300010
         STC   RF,SEVEN(RJ)             STORE THE STCB COUNT AGAIN      14400010
ILOOP    EQU   *                                                        14500010
         CLI   8(RJ),X'FE'                                              14600010
*                                       END OF ACTIVE ENTRIES    S21903 14700010
         BE    ISTORE                   YES,BRANCH               S21903 14750010
         LA    RJ,1(0,RJ)                                               14800010
*                                       BUMP TO NEXT BYTE AND    S21903 14900010
         B     ILOOP                    CHECK FOR END OF LIST    S21903 14950010
ISTORE   EQU   *                                                        15000010
         LA    RJ,8(0,RJ)                                               15100010
         TM    THREE(RTIOT),HEX80       EOT PRESENT            @SA73558 15120010
         BNO   NOEOT                    BR NO, NO EOT          @SA73558 15140010
         BCTR  RJ,0                     BACK UP TO EOT         @SA73558 15160010
NOEOT    EQU   *                                               @SA73558 15180010
         ST    RJ,LCBINVPT-1                                            15200010
         LR    RF,RC                    RESTORE INVLIST INDEX    A44912 15230010
         IC    RC,DCBEIOBX              GET SIZE OF ONE LCB      A44912 15260010
DEBSET   EQU   *                                                        15300010
         EJECT                                                          16000010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     16100010
*                                                                 *     16200010
*        BUILD A NOP COMMAND FOR ANY DIAL LINES                   *     16300010
*                                                                 *     16400010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     16500010
         USING UCB,RUCB                 UCB DSECT                Y02027 16600010
         L     RJ,LCBSIOCC              ADDRESS OF THE CHANNEL          16700010
*                                         PROGRAM AREA                  16800010
         LA    RTIOT,FOUR               LOAD AN INCREMENT OF FOUR       16900010
         SR    RJ,RTIOT                 DECREMENT THE CPA POINTER       17000010
         L     RUCB,0(RD)               GET THE ADDRESS OF THE          17100010
*                                         FIRST/NEXT UCB                17200010
         LTR   RUCB,RUCB                IS THIS A // DD DUMMY ENTRY     17300010
         BZ    SETADDR                  YES, BRANCH                     17400010
         ST    RAVT,FOUR(RJ)            STORE ANY VALID ADDRESS IN      17500010
*                                         THIS CCW                      17600010
         MVI   4(RJ),X'03'              SET THE COMMAND CODE FOR A      17700010
*                                         NOP                           17800010
         MVC   8(4,RJ),NOP              BUILD THE REST OF THE NOP       17900010
*                                         COMMAND                       18000010
         SPACE 2                                                        18050010
         LR    RTIOT,RUCB               SET UCB ADDRESS          Y02027 18100010
         IOSGEN TP,VAR=2F,UCB=(RTIOT)   SET ERROR TAB            Y02027 18150010
         EJECT                                                          18200010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @YA14062 18300010
*                                                           *  @YA14062 18360010
*        NEW OPTION AUTO= YES OR NO IN INVITATION LIST      *  @YA14062 18420010
*        ALLOWS SPECIFICATION OF AUTOPOLL ON A LINE         *  @YA14062 18480010
*        THE FOLLOWING ROUTINE WILL RESET THE AUTOPOLL      *  @YA14062 18540010
*        BIT IN THE CONTROL WORD IF THE AUTOPOLL BIT        *  @YA14062 18600010
*        IS NOT ON IN THE UCB                               *  @YA14062 18660010
*                                                           *  @YA14062 18720010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @YA14062 18780010
         LA    RTIOT,DCBINVLI           LOAD THE ADDRESS OF    @OY16102 18790010
*                                       THE 1ST INVITATION     @OY16102 18800010
*                                       LIST FOR THIS DCB.     @OY16102 18810010
         AR    RTIOT,RF                 ACCESS THE ADDRESS OF  @OY16102 18820010
*                                       THE INVITATION LIST    @OY16102 18830010
*                                       FOR THE CURRENT ENTRY. @OY16102 18840010
         L     RTIOT,0(RTIOT)           LOAD THE ADDRESS OF    @OY16102 18850010
*                                       THE CONTROL WORD FOR   @OY16102 18860010
*                                       THE CURRENT ENTRY.     @OY16102 18870010
         TM    UCBDVCLS,GRAPHICS        IS THIS 2260 LOCAL       Y02027 18900010
         BZ    TSTAPOLL                 BRANCH NO              @YA14062 19000010
         NI    THREE(RTIOT),AVTEFF-APBIT RESET AUTOPOLL BIT	   @YA14062 19300010
         B     STARTLIN                 START TERMINAL         @YA14062 19360010
         EJECT                                                          19450010
TSTAPOLL EQU   *                                                        19500010
         TM    17(RUCB),AUTOPOLL        UCB INDICATE AUTOPOLL  @YA14062 19600010
         BO    TESTBFRD                 YES, BRANCH            @YA14062 19700010
         TM    AVTBIT2,AVTSTRTN         IS A RESTART IN PROGRESS        20400010
         BZ    INVLIST1                 NO, BRANCH                      20500010
         TM    AVTBIT3,AVTSTAIN         HAS THE USER REQUESTED THAT     20600010
*                                         HIS INVITATION LISTS BE       20700010
*                                         CHECKPOINTED                  20800010
         BO    CUTEST                   YES, BRANCH                     20900010
INVLIST1 EQU   *                                                        21000010
         NI    THREE(RTIOT),AVTEFF-APBIT  TURN OFF AUTOPOLL    @YA14062 22000010
*                                         BIT IN CONTROL WORD  @YA14062 22040010
         B     CUTEST                   BYPASS BUF TERM TEST   @OS78352 22060010
TESTBFRD EQU   *                                               @YA14062 22080010
         CLI   LCBRSKEY,BUFRDTRM        IS THIS AN LCB FOR A            22120010
*                                         BUFFERED TERMINAL             22140010
         BNE   CUTEST                   NO, BRANCH                      22160010
         TM    THREE(RTIOT),APBIT       USER SPECIFIED AUTOPLL @OS78352 22170010
         BZ    CUTEST                   NO, BRANCH             @OS78352 22180010
         OI    5(RTIOT),APBIT           TURN ON THE SECOND AUTOPOLL     22200010
*                                         BIT IN THE INVITATION LIST    22300010
         EJECT                                                          22350010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     22400010
*                                                                 *     22500010
*    TEST FOR A 2702 CONTROL UNIT                                       22600010
*                                                                 *     22700010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     22800010
CUTEST   EQU   *                                                        22900010
         IC    RTIOT,UCBUNTYP           LOAD THE CNTL UNIT BITS  Y02027 23000010
*                                         FROM THE UCB                  23100010
         N     RTIOT,ANDMASK            CLEAR ALL UNWANTED BITS         23200010
*                                         FROM RTIOT                    23300010
         LTR   RTIOT,RTIOT              HAS A CONTROL UNIT BEEN         23400010
*                                         SPECIFIED FOR THIS DEVICE     23500010
         BZ    STARTLIN                 NO, THEN ASSUME THE DEVICE      23600010
*                                         IS A 7770                     23700010
         CLI   UCBUNTYP,CONTTYP3        TEST FOR A 2701 CONTROL  Y02027 23705010
*                                         UNIT WITH AN IBM TYPE III     23710010
*                                         ADAPTER                       23715010
         BE    STARTLIN                 IF YES, START THE LINE          23720010
*                                                                       23725010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     23730010
*                                                                 *     23735010
*                  BUILD A DISABLE COMMAND                        *     23740010
*                                                                 *     23745010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     23750010
         ST    RAVT,FOUR(RJ)            STORE ANY VALID ADDRESS IN      23755010
*                                         THIS CCW                      23760010
         MVI   FOUR(RJ),DISABLE         SET THE COMMAND CODE FOR A      23765010
*                                         DISABLE                       23770010
         MVC   EIGHT(FOUR,RJ),NOP       BUILD THE REST OF THE           23775010
*                                         DISABLE COMMAND               23780010
         LA    RJ,EIGHT(RJ)             INCREMENT THE CCW POINTER       23785010
         BCT   RTIOT,NOT2702            IS EITHER A 2701 OR 2703        23800010
*                                         CONTROL UNIT                  23900010
*                                                                       24000010
         EJECT                                                          24100010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     24200010
*                                                                 *     24300010
*    SET UP THE CORRECT SAD COMMAND FOR THIS 2702 CONTROL UNIT          24400010
*                                                                 *     24500010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     24600010
*                                                                       24700010
         IC    RTIOT,UCBTBYT2           LOAD FEATURE BYTE FROM   Y02027 24800010
*                                         THE UCB                       24900010
         N     RTIOT,ANDMASK            CLEAR EXTRANEOUS FEATURE        25000010
*                                         BITS FROM RTIOT               25100010
         IC    RTIOT,SADCODE(RTIOT)     INSERT ACTUAL SAD COMMAND       25200010
         ST    RAVT,FOUR(RJ)            STORE ANY VALID ADDRESS IN      25300010
*                                         THIS CCW                      25400010
         STC   RTIOT,4(RJ)              STORE THE SAD CODE IN THE       25500010
*                                         CHANNEL PROGRAM AREA          25600010
         MVC   8(4,RJ),NOP              BUILD THE REST OF THE SAD       25700010
*                                         COMMANDS                      25800010
         OI    0(RJ),CMDCHAIN           TURN ON THE COMMAND CHAINING    25830010
*                                         FLAG IN THE PREVIOUS CCW      25860010
         LA    RJ,8(RJ)                 BUMP POINTER TO NEXT DOUBLE     25900010
*                                         WORD IN THE CPA AREA          26000010
         EJECT                                                          26100010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     26200010
*                                                                 *     26300010
*    SET CORRECT COMMANDS FOR THE 2701 AND 2703 CONTROL UNITS     *     26400010
*                                                                 *     26500010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     26600010
NOT2702  EQU   *                                                        26700010
         TM    UCBUNTYP,BSCTYP2         DO WE HAVE A BINARY      Y02027 27300010
*                                         SYNCHRONOUS ADAPTER,          27400010
*                                         TYPE II                       27500010
         BO    SETBISCP                 YES, BRANCH                     27600010
         TM    UCBTBYT2,DIALLINE        TEST FOR A DIAL LINE     Y02027 27700010
         BNZ   STARTLIN                 GO TO START THE LINE            27800010
         SPACE 2                                                        27850010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     27900010
*                                                                 *     28000010
*        BUILD AN ENABLE COMMAND IF NOT A DIAL LINE               *     28100010
*                                                                 *     28200010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     28300010
ENABLE   EQU   *                                                        28400010
         ST    RAVT,FOUR(RJ)            STORE ANY VALID ADDRESS IN      28500010
*                                         THIS CCW                      28600010
         MVI   4(RJ),X'27'              SET THE COMMAND CODE FOR        28700010
*                                         AN ENABLE                     28800010
         MVC   8(4,RJ),NOP              BUILD THE REST OF THE ENABLE    28900010
*                                         COMMAND                       29000010
         OI    0(RJ),CMDCHAIN           TURN ON THE COMMAND CHAIN       29100010
*                                         FLAG IN THE PRIOR             29200010
*                                         COMMAND                       29300010
         EJECT                                                          29400010
STARTLIN EQU   *                                                        29500010
         OI    LCBSTAT1,LCBRECVN        INDICATE THAT THIS LINE IS      29600010
*                                         TO BE OPENED NORMALLY         29700010
         MVI   LCBTSTSW,SWITCHON        SET THE TEST AND SET SWITCH     29800010
*                                         IN THE LCB                    29900010
         OI    LCBSTAT2,LCBNEGRP        SET THE NEGATIVE RESPONSE       30000010
*                                         TO POLLING BIT IN THE         30100010
*                                         SECOND STATUS BYTE            30200010
         TM    0(RPARC),OUTPUT          IS THIS LINE OPENED FOR         30300010
*                                         OUTPUT                        30400010
         BZ    TESTIDLE                 NO, BRANCH                      30500010
         TM    0(RPARC),OUTONLY         IS THIS LINE OPENED FOR         30600010
*                                         OUTPUT ONLY                   30700010
         BNO   SETOUT                   NO, BRANCH                      30800010
         OI    DEBOPATB,OUTONLYM        SET THE OUTPUT ONLY FLAG IN     30900010
*                                         THE DEB                       31000010
SETOUT   EQU   *                                                        31100010
         OI    DEBOPATB,OUTPUTM         SET THE OUTPUT FLAG IN THE      31200010
*                                         DEB                           31300010
TESTIDLE EQU   *                                                        31400010
         TM    AVTBIT2,AVTSTRTN         IS A RESTART IN PROGRESS        31500010
         BNZ   QCBCHK                   YES, BRANCH                     31600010
IDLETEST EQU   *                                                        31700010
         TM    0(RPARC),TCAMIDLE        IS THIS LINE TO BE OPENED       31800010
*                                         IDLE                          31900010
         BNO   SETADDR                  NO, IT IS TO BE OPENED          32000010
*                                         NORMALLY                      32100010
SETIDLE  EQU   *                                                        32200010
         MVI   LCBSTAT1,X'00'           INDICATE THAT THIS LINE IS      32300010
*                                         TO BE OPENED IDLE             32400010
SETADDR  EQU   *                                                        32500010
         AR    RCORE,RC                 ADDRESS OF THE NEXT LCB         32600010
         LA    RD,4(RD)                 ADDRESS OF THE NEXT UCB         32700010
         LA    RF,FOUR(RF)              INCREMENT THE INVITATION        32800010
*                                         LIST OFFSET TO THE NEXT       32900010
*                                         INVITATION LIST ADDRESS       33000010
         BCT   RE,NEXTLIN               BRANCH IF THERE ARE MORE        33100010
*                                         CHANNEL PROGRAMS TO BE        33200010
*                                         BUILT                         33300010
         EJECT                                                          33400010
         DROP  RJ                       DROP MASTER QCB DSECT    Y02027 33450010
         USING FORCORE,RJ               OPEN WORK AREA DSECT     Y02027 33500010
         SPACE 2                                                        33550010
         MVC   0(5,RWTGC),TCAMLD5       SET THE ID FOR THE FIFTH        33600010
*                                         LOAD OF OPEN                  33700010
         L     RJ,4(RWTGC)              ADDRESS OF OPEN WORK AREA       33800010
RELOOP   EQU   *                                                        34000010
         LA    RWTGC,8(RWTGC)           NEXT WTG ENTRY                  34100010
         LA    RPARC,4(RPARC)           NEXT DCB LIST ENTRY             34200010
         CLC   0(2,RWTGC),AMIDCNST      IS THIS EXECUTOR NEEDED         34300010
*                                         AGAIN                         34400010
         BE    RESTART                  BRANCH IF YES            S21903 34500010
         CLC   0(2,RWTGC),OPIDCNST      END OF WTG TABLE                34600010
         BNE   RELOOP                   IF NO, BRANCH            S21903 34700010
         LR    RPARC,RPAR               REINITIALIZE WTG AND            34800010
         LA    RWTGC,32(RWTG)           PARAMETER REGISTERS             34900010
ZCHECK   EQU   *                                                        35000010
         CLI   0(RWTGC),X'00'           IS THIS ENTRY ZERO              35100010
         BNE   XCTLRTNE                 IF NOT ZERO, TRANSFER CNTRL     35200010
         LA    RWTGC,8(RWTGC)           ADDRESS OF NEXT ENTRY           35300010
         LA    RPARC,4(RPARC)           ADDRESS OF NEXT DCB             35400010
         B     ZCHECK                   CHECK NEXT ENTRY         S21903 35500010
*                                                                       35600010
XCTLRTNE EQU   *                                                        35700010
         LA    RJ,DXCCW12               ADDRESS OF A DOUBLE WORD Y02027 35800010
*                                         SAVE AREA                     35900010
         MVC   6(2,RWTG),0(RWTGC)       MOVE ID TO NAME FIELD           36000010
         MVC   14(3,RWTG),2(RWTGC)      MOVE TTR TO WTG TABLE           36100010
         XCTL  DE=(RWTG),SF=(E,(15))                                    36200010
         EJECT                                                          36300010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     36400010
*                                                                 *     36500010
*        THIS ROUTINE BUILDS THE CHANNEL PROGRAM FOR              *     36600010
*        AND MODIFIES THE ERROR TAB IN THE UCB FOR ALL TCAM       *     36700010
*              BINARY SYNCHRONOUS DEVICES                         *     36800010
*                                                                 *     36900010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     37000010
SETBISCP EQU   *                                                        37100010
         LR    RTIOT,RUCB               SET UCB ADDRESS          Y02027 37200010
         IOSGEN TP,VAR=30,UCB=(RTIOT)   MODIFY ERROR TAB         Y02027 37250010
*                                                                       37300010
         OI    LCBSTAT2,LCBSYNC         TURN ON THE BIT TO INDICATE     37400010
*                                         THAT THIS IS A BINARY         37500010
*                                         SYNCHRONOUS LINE              37600010
         LA    RTIOT,DCBINVLI           LOAD THE ADDRESS OF THE         38400010
*                                         FIRST INVITATION LIST IN      38500010
*                                         THE DCB                       38600010
         AR    RTIOT,RF                 ACCESS THE ADDRESS OF THE       38700010
*                                         FIRST/NEXT INVITATION         38800010
*                                         LIST ADDRESS                  38900010
         TM    UCBTBYT2,DIALLINE        IS THIS A DIAL LINE      Y02027 39000010
         BZ    TESTADPT                 BRANCH IF NOT           SA52995 39020010
         CLI   DCBCPRI,EQUALPRI         EQUAL PRIORITY FOR BSC DIS21101 39040010
         BNE   TESTADPT                 BRANCH NO, DEFAULT IS SENS21101 39060010
*                                         -SET BY PREVIOUS LOAD  S21101 39080010
         SPACE 1                                                 S21101 39100010
         MVI   LCBRSPRI,PRIEQ           SET STCB PRIORITY        S21101 39120010
TESTADPT EQU   *                                                        39500010
         TM    UCBUNTYP,CU2703          IS THIS A 2703 CONTROL   Y02027 39600010
*                                       UNIT                     Y02027 39650010
         BO    SETMODE                  YES, BRANCH                     39700010
         TM    0(RTIOT),X'20'           IS THE DUAL COMMUNICATION       39800010
*                                         INTERFACE SET TO              39900010
*                                         INTERFACE B                   40000010
         BNO   TESTCODE                 NO, INTERFACE A WAS             40100010
*                                         SPECIFIED                     40200010
*                                       YES                      Y02027 40300010
         TM    UCBTBYT2,GOODINTF        IS IT LEGAL              Y02027 40350010
         BZ    BISERROR                 NO, IT IS AN ERROR              40400010
TESTCODE EQU   *                                                        40500010
         TM    0(RTIOT),X'08'           IS THE DUAL CODE FEATURE        40600010
*                                         SET TO TRANSMISSION CODE      40700010
*                                         B                             40800010
         BZ    SETMODE                  NO, BRANCH                      40900010
*                                       YES                      Y02027 41000010
         TM    UCBTBYT2,GOODTRAN        IS IT LEGAL              Y02027 41050010
         BZ    BISERROR                 NO, IT IS AN ERROR              41100010
SETMODE  EQU   *                                                        41200010
         ST    RTIOT,4(RJ)              STORE THE DATA ADDRESS (THE     41300010
*                                         ADDRESS OF THE INVITATION     41400010
*                                         LIST ADDRESS FOR THIS         41500010
*                                         LINE) IN THE SECOND CCW       41600010
         MVI   4(RJ),X'23'              PUT THE SET MODE COMMAND        41700010
*                                         CODE IN THE SECOND CCW        41800010
         MVC   8(4,RJ),NOP              BUILD THE REST OF THE SET       41900010
*                                         MODE COMMAND                  42000010
         OI    0(RJ),CMDCHAIN           TURN ON THE COMMAND CHAIN       42100010
*                                         FLAG IN THE FIRST CCW         42200010
         LA    RJ,8(RJ)                 INCREMENT THE CCW POINTER       42300010
         TM    UCBTBYT2,DIALLINE        IS THIS A DIAL LINE      Y02027 42400010
         BNZ   STARTLIN                 YES, BRANCH                     42500010
         B     ENABLE                   BRANCH TO BUILD AN ENABLE       42600010
*                                         AS THE THIRD CCW IN THE       42700010
*                                         CHANNEL PROGRAM               42800010
         EJECT                                                          42900010
QCBCHK   EQU   *                                                        43000010
         L     RJ,AVTRDYA              GET ADDR OF EXIT ROUTINE X30X5MT 43004010
         CLI   OPENCHK(RJ),IDLE        COMPARE FOR RESTART CONDIX30X5MT 43008010
         BH    IDLETEST                RESTART WITH OPEN MACRO  X30X5MT 43012010
*                                      SPECIFIED CONDITION      X30X5MT 43016010
         BE    SETIDLE                 RESTART WITH ALL LINES IDX30X5MT 43020010
*                                      RESTART WITH CHECK POINT X30X5MT 43024010
         CLI   LCBRSKEY,BUFRDTRM        BUFFERRED TERM LCB      SA54300 43030010
         BE    NOTSEND1                 BRANCH IF YES           SA54300 43060010
         CLI   LCBRSPRI,SEND            DOES THIS LCB SPECIFY SEND      43100010
*                                         PRIORITY                      43200010
         BNE   NOTSEND                  NO, BRANCH                      43300010
         CLI   LCBRSKEY,DIAL            IS THIS A DIAL LCB              43400010
         BNE   NDIALSND                 NO, BRANCH                      43500010
         TM    AVTBIT1,AVTTSON          IS THIS A TSO DIAL LINE         43530010
         BO    FTSOQCB1                 YES, BRANCH                     43560010
MIXED    EQU   *                                                SA51084 43580010
         SPACE 2                                                        43584010
         DROP  RJ                       DROP WORK AREA DSECT     Y02027 43588010
         USING IEDQQCB,RJ               MASTER QCB DSECT         Y02027 43592010
         SPACE 2                                                        43596010
         L     RJ,LCBLINK-ONE           GET ADDRESS OF QCB        M1178 43600010
         XC    LCBLINK,LCBLINK          CLEAR LCB LINK FIELD      M1178 44000010
         B     FTSOQCB3                 CHECK STATUS OF LINE      M1178 44400010
NOTSEND  EQU   *                                                        44800010
         TM    0(RPARC),OUTPONLY        IS THIS LINE TO BE OPENED       44900010
*                                         FOR OUTPUT ONLY               45000010
         BO    NDIALSND                 YES, BRANCH                     45100010
NOTSEND1 EQU   *                                                SA54300 45150010
         L     RJ,LCBRSPRI              GET THE STCB ADDRESS FOR        45200010
*                                         THE FIRST QCB                 45300010
         B     SETQCBAD                 BRANCH                          45400010
NDIALSND EQU   *                                                        45500010
         L     RJ,LCBRSKEY              GET THE STCB ADDRESS FOR        45600010
*                                         THE FIRST QCB IN THE QUEUE    45700010
SETQCBAD EQU   *                                                        45800010
         LA    RUCB,EIGHT               LOAD A VALUE OF 8               45900010
         SR    RJ,RUCB                  SET THE BEGINNING ADDRESS       46000010
*                                         OF THE QCB                    46100010
         TM    0(RPARC),OUTPONLY        INPUT ONLY             @OS76977 46100210
         BNZ   FTSOQCB3                 BRANCH IF NO           @OS76977 46100410
         STM   RE,RD,AVTSAVE3           SAVE ALL REGS BUT REG15@OS76977 46100610
         SR    RC,RC                    CLEAR WORK REG         @OS76977 46100810
         IC    RC,LCBUCBX               RLN - 1                @OS76977 46101010
         SLL   RC,TWO                   MULTIPLY BY FOUR       @OS76977 46101210
         L     RC,DCBINVLI(RC)          GET INVLIST FOR THIS   @OS76977 46101410
*                                        LINE                  @OS76977 46101610
         BCTR  RC,RE                    BACK UP TO GET         @OS76977 46101810
         BCTR  RC,RE                    A TNT OFFSET           @OS76977 46102010
         LH    RF,0(,RC)                GET TNT OFFSET         @OS76977 46102210
         N     RF,AVTCLRHI              CLEAR HIGH HALFWORD    @OS76977 46102410
         L     RJ,AVTRNMPT              TNT CONVERSION CODE    @OS76977 46102610
         BALR  RD,RJ                    GET TERM ENTRY ADDRESS @OS76977 46102810
         L     RJ,0(,RF)                GET QCB ADDRESS        @OS76977 46103010
         LM    RE,RD,AVTSAVE3           RESTORE ALL BUT REG 15 @OS76977 46103210
FTSOQCB3 EQU   *                                                        46105010
         TM    QCBLINK+1,LCBTRACE       IS THE I/O TRACE ACTIVE FOR     46110010
*                                         THIS LINE                     46120010
         BZ    CHKLINK                  NO, BRANCH                      46130010
         OI    LCBSTAT2,LCBTRACE        INDICATE THE I/O TRACE IS       46140010
*                                         ACTIVE FOR THIS LINE          46150010
CHKLINK  EQU   *                                                        46200010
         CLI   QCBLINK,NORMAL           IS THIS LINE TO BE OPENED       46300010
*                                         NORMALLY                      46400010
         BL    SETIDLE                  NO, BRANCH                      46500010
         BE    SETADDR                  DON'T CHECK PARAMETER LIST      46600010
         BH    IDLETEST                 TEST THE PARAMETER LIST         46700010
         EJECT                                                          47700010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     47702010
*                                                                 *     47704010
*            THIS SECTION OF CODE IS USED TO LOCATE THE           *     47706010
*            QCB FOR EACH TSO DIAL LINE IN ORDER TO               *     47708010
*            DETERMINE THE LINE STATUS FOR EACH LINE              *     47710010
*            IN THE EVENT OF A RESTART                            *     47712010
*                                                                 *     47714010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     47716010
FTSOQCB1 EQU   *                                                        47718010
         USING IEDQTNTD,RUCB            TNT DSECT                Y02027 47719010
         L     RUCB,AVTRNMPT            LOAD THE ADDRESS OF THE         47720010
*                                         TERMNAME TABLE                47722010
         SR    RJ,RJ                    CLEAR A LENGTH REGISTER         47724010
         IC    RJ,TNTENLEN              GET THE MAXIMUM LENGTH OF A     47726010
*                                         TERMNAME TABLE ENTRY          47728010
         LA    RJ,THREE(RJ)             ADD 3 BYTES TO THE LENGTH       47730010
         LA    RUCB,TNTFIRST            GET THE ADDRESS OF THE          47732010
*                                         FIRST ENTRY IN THE TABLE      47734010
         SR    RUCB,RJ                  SET THE POINTER FOR THE         47736010
*                                         LINE ENTRY INDEX              47738010
         LH    RTIOT,LCBLNENT           GET THE LINE ENTRY OFFSET       47740010
*                                         FROM THE LCB                  47742010
         N     RTIOT,AVTCLRHI           CLEAR HIGH-ORDER HALF   SA51084 47742510
         LTR   RTIOT,RTIOT              MIXED LINE, NOT TSO     SA51084 47743010
         BZ    MIXED                    BRANCH IF YES           SA51084 47743510
FTSOQCB2 EQU   *                                                        47744010
         AR    RUCB,RJ                  INCREMENT THE TERMNAME          47746010
*                                         TABLE ADDRESS                 47748010
         BCT   RTIOT,FTSOQCB2           DECREMENT THE LINE ENTRY        47750010
*                                         INDEX                         47752010
         LA    RTIOT,THREE              GET THE LENGTH OF AN ADDRESS    47754010
         SR    RJ,RTIOT                 GET THE LENGTH OF A             47756010
*                                         TERMNAME TABLE ENTRY          47758010
         AR    RUCB,RJ                  LOCATE THE TERMINAL TABLE       47760010
*                                         ADDRESS FOR THIS ENTRY        47762010
         MVC   AVTGETMN+1(THREE),0(RUCB)     MOVE THE TERMINAL TABLE    47764010
*                                         ADDRESS TO A SCRATCH AREA     47766010
         L     RJ,AVTGETMN              LOAD THE TERMINAL TABLE         47768010
*                                         ADDRESS                       47770010
         L     RJ,0(RJ)                 LOAD THE QCB ADDRESS FOR THIS   47772010
*                                         TERMINAL                      47774010
         TM    0(RJ),QCBDISK+QCBCORE    TSO LINE                SA51084 47774610
         BNZ   MIXED                    BRANCH IF NO            SA51084 47775210
         B     FTSOQCB3                 CHECK THE LINE STATUS           47776010
         EJECT                                                          47778010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     47800010
*                                                                 *     47900010
*        THIS SECTION OF ERROR CODE IS EXECUTED ONLY WHEN         *     48000010
*        AN ERROR IS DETECTED WHILE BUILDING THE INITIAL          *     48100010
*        CHANNEL PROGRAM FOR BINARY SYNCHRONOUS DEVICES,          *     48200010
*        EITHER THE DUAL COMMUNICATION INTERFACE OR THE           *     48300010
*        DUAL CODE FEATURE WAS SPECIFIED INCORRECTLY              *     48400010
*                                                                 *     48500010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     48600010
BISERROR EQU   *                                                        48700010
         MVI   AVTOPERT,TCAMER09        MOVE THE ERROR IDENTIFIER       48800010
*                                         FOR TCAM INTO THE AVT         48900010
         SPACE 2                                                        49000010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     49400010
*                                                                 *     49500010
*        THIS SECTION OF CODE IS USED TO SAVE THE ID OF THE       *     49600010
*        CURRENT OPEN EXECUTOR AND TO MOVE THE ID OF THE          *     49700010
*        ERROR RECOVERY MODULE INTO THE WHERE-TO-GO PARAMETER     *     49800010
*                            LIST                                 *     49900010
*                                                                 *     50000010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     50100010
         L     RJ,FOUR(RWTGC)           LOAD THE ADDRESS OF THE         50200010
*                                         OPEN WORK AREA                50300010
         MVC   AVTOPXCL(TWO),AMIDCNST   MOVE THE ID OF THE CURRENT      50400010
*                                         EXECUTOR INTO THE AVT FOR     50500010
*                                         THE RETURN TO THIS            50600010
*                                         EXECUTOR                      50700010
         MVC   0(FIVE,RWTGC),OPENERP    MOVE THE ID AND TTR FOR THE     50800010
*                                         ERROR MODULE INTO THE         50900010
*                                         WHERE-TO-GO PARAMETER LIST    51000010
         B     XCTLRTNE                 BRANCH TO THE XCTL ROUTINE      51100010
         EJECT                                                          51200010
AMIDCNST DC    C'38'                    ID OF THIS EXECUTOR             51300010
         DS    0F                                                       51400010
ANDMASK  DC    X'00000003'              MASK TO CLEAR ALL BUT    S21903 51500010
*                                       LOW ORDER TWO BYTES      S21903 51560010
OPIDCNST DC    C'0S'                    ID OF LAST OPEN MODULE   S21903 51620010
SADCODE  DC    X'13'                    SADZERO CODE                    51700010
         DC    X'17'                    SADONE CODE                     51800010
         DC    X'1B'                    SADTWO CODE                     51900010
         DC    X'1F'                    SADTHREE CODE                   52000010
SWITCHON EQU   X'F0'                    TEST & SET SWITCH IN LCB Y02027 52100010
NOP      DC    X'20000001'              NOP COMMAND                     52400010
CMDCHAIN EQU   X'40'                    COMMAND CHAINING BIT            52500010
DBLZERO  DC    D'0'                     CONSTANT FOR DUMMY     @OY18871 52550010
*                                        INVITATION LIST       @OY18871 52600010
ONE      EQU   1                        NUMERIC CONSTANT                52700010
TWO      EQU   2                        NUMERIC CONSTANT         S21903 52800010
THREE    EQU   3                        NUMERIC CONSTANT         S21903 52900010
FOUR     EQU   4                        NUMERIC CONSTANT         S21903 53000010
FIVE     EQU   5                        NUMERIC CONSTANT         S21903 53100010
SEVEN    EQU   7                        NUMERIC CONSTANT         S21903 53200010
EIGHT    EQU   8                        NUMERIC CONSTANT         S21903 53300010
HEX80    EQU   X'80'                    EOT CONSTANT           @SA73558 53400010
EQUALPRI EQU   X'02'                    DCB EQUAL PRIORITY MASK  S21101 53530010
PRIEQ    EQU   X'40'                    LCB STCB EQUAL PRIORITY  S21101 53560010
CVT      EQU   16                       ADDRESS OF CVT POINTER   Y02027 53760010
CONTTYP3 EQU   X'82'                    2701, IBM TYPE 3 ADAPTER Y02027 53800010
BSCTYP2  EQU   X'90'                    BSC ADAPTER, TYPE 2      Y02027 53830010
DIALLINE EQU   X'90'                    DIAL LINE                Y02027 53860010
CU2703   EQU   X'03'                    2703 CONTROL UNIT        Y02027 53890010
GOODINTF EQU   X'20'                    LEGAL INTERFACE          Y02027 53920010
GOODTRAN EQU   X'04'                    LEGAL TRANSMISSION CODE  Y02027 53950010
PTRIOB   EQU   32                       IOB OFFSET IN LCB        Y02027 54000010
TCAMIDLE EQU   32                       OPEN IDLE SWITCH         Y02027 54100010
DEBPRFIX EQU   36                       DEB PREFIX LENGTH               54200010
OUTPUTM  EQU   X'01'                    OUTPUT FLAG IN DEB       Y02027 54400010
OUTONLYM EQU   X'02'                    OUTPUT ONLY FLAG IN DEB  Y02027 54500010
NORMAL   EQU   X'02'                    NORMAL OPEN              Y02027 54600010
OUTPUT   EQU   X'03'                    OPENED FOR OUTPUT        Y02027 54700010
BSCMPDEV EQU   X'07'                    BISYNC MULTIPOINT        Y02027 54800010
TCAMER09 EQU   X'09'                    ERROR ID                 Y02027 54900010
OUTONLY  EQU   X'0C'                    OPEN OUTPUT ONLY         Y02027 55000010
OUTPONLY EQU   X'0F'                    OUTPUT ONLY              Y02027 55100010
GRAPHICS EQU   X'10'                    2260 LOCAL               Y02027 55200010
DIAL     EQU   X'18'                    DIAL LCB                 Y02027 55300010
BUFRDTRM EQU   X'1A'                    BUFFERED TERMINAL        Y02027 55400010
SEND     EQU   X'20'                    SEND PRIORITY IN LCB     Y02027 55500010
DISABLE  EQU   X'2F'                    DISABLE COMMAND CODE            55650010
AUTOPOLL EQU   X'40'                    AUTOPOLL BIT IN THE UCB         55700010
BSCADPTR EQU   X'90'                    BISYNC ADAPTER           Y02027 55800010
APBIT    EQU   X'01'                    AUTOPOLL BIT IN THE CONTROL     56000010
*                                         WORD OF THE INVITATION        56100010
*                                         LIST                          56200010
IDLE     EQU   X'40'                                            X30X5MT 56210010
OPENCHK  EQU   16                      OFFSET TO OPEN CHK FLAG  X30X5MT 56220010
END      EQU   *                                                        56260010
         EJECT                                                          56300010
TCAMLD5  DC    C'39'                    ID OF IGG01939                  56900010
         DC    XL4'0'                   TTR                      S21903 57000010
OPENERP  DC    C'33'                    ERROR RECOVERY MODULE           57100010
         DC    XL4'0'                     TTR AND LENGTH                57200010
         EJECT                                                          57620010
UCB      DSECT                                                          57640010
         IEFUCBOB                                                       57660010
         EJECT                                                          57700010
         TTNTD                                                          57730010
         EJECT                                                          57760010
         TQCBD                                                          57800010
         EJECT                                                          57900010
         TAVTD                          AVT DSECT                       58000010
         EJECT                                                          58010010
         TTCXD                                                   Y02027 58020010
         EJECT                                                          58030010
FORCORE  DSECT                                                          58040010
         IECDSECT                                                       58050010
         EJECT                                                   Y02027 58060010
         TLCBD                                                          58100010
         TDEBD                                                          58200010
         DCBD  DSORG=TX                                                 58400010
*                                                                       58500010
         END                                                            58600010
