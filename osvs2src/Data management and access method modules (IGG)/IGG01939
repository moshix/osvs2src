         TITLE 'IGG01939 FIFTH LOAD OF LINE GROUP OPEN'                 00000110
IGG01939 CSECT                                                          00000210
*CHANGE ACTIVITY= AS FOLLOWS:                                           00000310
*A122373-122376,122388,144393,172600,436500,452230,452550,       X01004 00000410
*A489100-493900,502000                                           X01004 00000510
*C122370,279000,291000,452020-452220,488300                      X01004 00000610
*D122010-122258,122390,452240-452380,486600,488600               X01004 00000710
*A097500,398340-398500,494700-495500                             Y01004 00000810
*C097000,398300                                                  Y01004 00000910
*A122332,122382-122386,398540,530600-531200                      X02004 00001010
*C004310,122324,122380,142393,282000                             X02004 00001110
*D004610-006410,122330,285000-288000                             X02004 00001210
*C003000,022000,026000,047000-048200,083500,088240-095000        Y02027 00001310
*C338000,452170,459000-467000,468500-473500,474200-474800        Y02027 00001410
*C480000,483000,493900                                           Y02027 00001510
*D097000-097500                                                  Y02027 00001610
*A196000,436560-436920                                           Y02027 00001710
*C205000,207000,388000-390000,427000-432000,452040-452090,452130 Y02027 00001810
*C452180,522000-525000,437200                                    Y02027 00001910
*D433000,434000,452140,452150,452190,452200                      Y02027 00002010
*D468000,469500,488070,488300-489900,498000-501000               Y02027 00002110
*D518100                                                         Y02027 00002210
*D436680,436740                                                @ZA04035 00032210
*A436860,436920                                                @ZA04035 00062210
*A063000,122267-122320,126393,205000,412020-458400,488070-488210 S99228 00107010
*A498000,509260-509320,516000                                    S99228 00108010
*D371000-378000,412020-414720,477600,479000,481000,516000        S99228 00109010
*A089000,122030,122230,122390                                    A41031 00110010
*C122060,133600                                                  A41031 00115010
*D089200-089800,091000-096000,373000-375000                      S21101 00120010
*A090000,366000,412000,412200,412500                             S21101 00125010
*A001000,079000,089800,122010,122130,122220,122340,153600,179200 CLUP21 00130010
*A195000,203000,206000,309000,318000,329000,398000,406000,420000 CLUP21 00135010
*A436000,453000,462000,474800,477600,483000,488000,508000        CLUP21 00140010
*C004010-004900,063000,075000,089600,122020-122070,122150,157600 CLUP21 00145010
*C160000,168800,347000,364000-366600,403000-404000,412100-414000 CLUP21 00150010
*C418000,498000                                                  CLUP21 00155010
*D029600,054000-054600,080000,082000,085000,102000-110000,122140 CLUP21 00160010
*D122220-122300,122350-122360,122393-147000,181000-193000        CLUP21 00165010
*D207000-309000,311000,371000-384000,437000-451000,452320-452340 CLUP21 00170010
*D457000-458000,463000,465000-466000,469500,472000-473000        CLUP21 00175010
*D475400-477300,478000,481000-482000,484000-486300,487000-487500 CLUP21 00180010
*D503000-504000,509000-518000,520600-520800,528000-529000,531000 CLUP21 00185010
*D514600-514800                                                  S22026 00188010
*C122267-122275,364000,412020-412580,513800-514400,515000        S22026 00191010
*A475000-475200,503000-504000,513260-513320,515800-518600        S22026 00194010
*C087000,325000-325500,327000,335000,335500,453150,453240,453300 S22025 00194810
*C453390-453540,453780-453870,455000,502000,502500,513000        S22025 00195610
*C521000,523000,524000                                           S22025 00196410
*A001960,001980,052500,088060                                    S22025 00197210
*A001980,513600                                                  S21903 00197310
*C001988,122267,166400-179200,314000-315000,352000,354000-385000 S21903 00197410
*D122312,128393,166400-179200,314000-315000,352000,354000-385000 S21903 00197510
*D401000-414810,452740-452760,456000-458400,464000,471000,475000 S21903 00197610
*D475200,484800,489000-496000,502000-503000,506000,508000,509200 S21903 00197710
*D509320,509600,510000,510400,510800,511200,511600,512000,512400 S21903 00197810
*D512800,513200-513320,513600-518600                             S21903 00197910
*********************************************************************** 00198010
*                                                                S21903 00198810
*MODULE-NAME= IGG01939                                           S21903 00199010
*                                                                S21903 00199210
*DESCRIPTIVE-NAME= TCAM LINE GROUP OPEN ROUTINE (FIFTH LOAD)     S21903 00199410
*                                                                S21903 00199610
*COPYRIGHT= 'NONE'                                               S21903 00199810
*                                                                     * 00200010
*STATUS = CHANGE LEVEL 6                                         Y02027 00300010
*                                                                     * 00400010
*FUNCTION/OPERATION - IGG01939 IS THE FIFTH LOAD OF TCAM LINE    CLUP21 00401010
*   GROUP OPEN.                                                  X02004 00431010
*                                                                CLUP21 00671010
*   IGG01939 ATTEMPTS TO OPTIMIZE SPACE IN SUBPOOL 252 BY        CLUP21 00701010
*   LOADING LARGER MODULES FIRST SO THAT SMALLER MODULES WILL    CLUP21 00731010
*   FIT ABOVE THEM IN THE SAME 2K BLOCK. THE LARGEST MODULE, THE CLUP21 00761010
*   LINE END APPENDAGE ROUTINE, IS LOADED FIRST AND ITS ADDRESS  CLUP21 00791010
*   SAVED IN THE DEB AS BOTH THE NORMAL AND ABNORMAL LINE END    CLUP21 00821010
*   APPENDAGE. IF THE DCB INDICATES THE USER HAS REQUESTED PCI,  CLUP21 00851010
*   THE PCI APPENDAGE IS LOADED AND ITS ADDRESS SAVED IN THE DEB.CLUP21 00881010
*   THE I/O TRACE ROUTINE IS LOADED IF THERE IS AN I/O TRACE     CLUP21 00911010
*   AREA, ITS ADDRESS SAVED IN THE AVT, AND IF THE USER HAS      CLUP21 00941010
*   PROVIDED AN EXIT ROUTINE THE CIRB MACRO IS ISSUED TO BUILD   CLUP21 00971010
*   AND INITIALIZE AN INTERRUPT REQUEST ELEMENT. THE LAST        CLUP21 01001010
*   ROUTINE TO BE LOADED IS THE DEVICE DEPENDENT SPECIAL         CLUP21 01031010
*   CHARACTERS TABLE. ITS ADDRESS IS SAVED IN THE DCB.           CLUP21 01061010
*                                                                     * 01300010
*ENTRY POINTS - THIS ROUTINE IS ENTERED AT IGG01939 VIA AN            * 01400010
*   XCTL FROM THE PREVIOUS EXECUTOR (IGG01938).  IT MAY               * 01500010
*   ALSO BE RE-ENTERED FROM THE RELOOP PORTION OF THIS ROUTINE        * 01600010
*   IF IT IS DETERMINED THAT ANOTHER DATA CONTROL BLOCK IS TO         * 01700010
*   BE PROCESSED BY IGG01939.                                         * 01800010
*                                                                     * 01900010
*INPUT - REGISTERS 5,6,7, AND 8 ARE THE INPUT AS FOLLOWS              * 02000010
*                                                                     * 02100010
*   5 - THE ADDRESS OF THE WTG TABLE PREFIX                      Y02027 02200010
*                                                                     * 02300010
*   6 - THE ADDRESS OF THE BEGINNING OF THE WHERE-TO-GO TABLE         * 02400010
*                                                                     * 02500010
*   7 - THE ADDRESS OF THE COPY OF THE CURRENT DCB               Y02027 02600010
*                                                                     * 02700010
*   8 - THE ADDRESS OF THE CURRENT EXECUTOR'S ENTRY IN THE            * 02800010
*       WHERE-TO-GO TABLE                                             * 02900010
*OUTPUT - THE DISPATCHER WILL HAVE BEEN LOADED ALONG WITH             * 03030010
*   THE CORRECT SCHEDULER OR SCHEDULERS FOR THIS LINE GROUP.          * 03060010
*                                                                     * 03400010
*EXTERNAL ROUTINES - NONE                                             * 03500010
*                                                                     * 03600010
*EXITS - NORMAL                                                       * 03700010
*   THIS ROUTINE EXITS VIA AN XCTL TO THE MODULE IDENTIFIED BY        * 03800010
*   THE NEXT NON-ZERO ENTRY IN THE WHERE-TO-GO TABLE,                 * 03900010
*   NAMELY, IGG01940                                                  * 04000010
*                                                                     * 04100010
*      - ERROR                                                        * 04200010
*   NONE                                                              * 04300010
*                                                                     * 04400010
*TABLES/WORKAREAS - THE WHERE-TO-GO TABLE CONTAINS THE ID             * 04500010
*   AND TTR OF THE OPEN EXECUTOR TO BE GIVEN CONTROL.                 * 04600010
*   THE WHERE-TO-GO TABLE PREFIX CONTAINS THE ADDRESS OF A       Y02027 04700010
*   COPY OF EACH DCB THAT WAS SPECIFIED IN THE OPEN MACRO        Y02027 04760010
*   INSTRUCTION                                                  Y02027 04820010
*                                                                     * 04900010
*ATTRIBUTES - THIS ROUTINE IS EXECUTED IN THE TRANSIENT AREA          * 05000010
*   AS ENABLED, PRIVILEGED, AND REENTRANT.                            * 05100010
*                                                                     * 05200010
*********************************************************************** 05250010
         EJECT                                                          05300010
*                                                                       05500010
*    REGISTER USAGE                                                     05600010
*                                                                       05700010
*                                                                       05800010
RE       EQU   0                        WORK REGISTER                   05900010
RF       EQU   1                        WORK REGISTER                   06000010
RDCB     EQU   2                        ADDRESS OF THE CURRENT DCB      06100010
RTIOT    EQU   3                        WORK REGISTER                   06200010
RCORE    EQU   4                        WORK REGISTER            CLUP21 06300010
R4       EQU   4                        WORK REG                 S99228 06350010
RPAR     EQU   5                        ADDRESS OF FIRST ENTRY IN       06400010
*                                         DCB PARAMETER LIST            06500010
RWTG     EQU   6                        ADDRESS OF THE WHERE-TO-GO      06600010
*                                         TABLE                         06700010
RPARC    EQU   7                        ADDRESS OF THE CURRENT          06800010
*                                         ENTRY IN DCB PARAMETER        06900010
*                                         LIST                          07000010
RWTGC    EQU   8                        ADDRESS OF THE CURRENT          07100010
*                                         ENTRY IN THE WTG TABLE        07200010
RAVT     EQU   9                        ADDRESS OF THE AVT              07300010
RUCB     EQU   10                       WORK REGISTER                   07400010
RDEB     EQU   11                       ADDRESS OF CURRENT DEB   CLUP21 07500010
RBASE    EQU   12                       BASE OF THIS ROUTINE            07600010
RC       EQU   13                       WORK REGISTER                   07700010
RD       EQU   14                       WORK REGISTER                   07800010
RJ       EQU   15                       WORK REGISTER                   07900010
         SPACE 2                                                        08000010
         USING IEDQDEB,RDEB             DEB DSECT                       08100010
         USING IEDQAVTD,RAVT            AVT DSECT                       08300010
         USING FORCORE,RCORE            OPEN WORK AREA DSECT     Y02027 08350010
         USING IHADCB,RDCB              DCB DSECT                       08400010
*                                                                       08600010
         BALR  RBASE,0                  SET UP BASE REGISTER     S22025 08700010
         USING *,RBASE                                                  08800010
         SPACE 2                                                        08803010
IGG01939 IEDHJN RESTART                                          S22025 08806010
         EJECT                                                          08824010
**************************************************************** Y02027 08830010
*                                                              *        08838010
*        THIS SECTION OF CODE ESTABLISHES ADDRESSABILTY        * Y02027 08846010
*        FOR THE DEB AND COMPUTES THE OFFSET INTO THE          * Y02027 08854010
*        DEB OF THE SUBROUTINE - ID SECTION.                   * Y02027 08862010
*                                                              * Y02027 08870010
**************************************************************** Y02027 08878010
*                                                                CLUP21 08890010
         L     RCORE,FOUR(RWTGC)        LOAD THE ADDRESSES OF THEY02027 08900010
*                                       OPEN WORK AREA           Y02027 09100010
         L     RDCB,DXUDCBAD            GET THE CURRENT DCB ADDR Y02027 09300010
         L     RDEB,DCBDEBAD            GET THE DEB ADDRESS      Y02027 09500010
         LA    RF,DEBPTR                LOAD THE LENGTH OF THE DEB      09800010
*                                         PREFIX                        09900010
         SR    RDEB,RF                  SET THE BEGINNING ADDRESS       10000010
*                                         AT THE DEB PREFIX             10100010
         SR    RTIOT,RTIOT              CLEAR A REGISTER FOR THE        11100010
*                                         COUNT OF LOADED               11200010
*                                         SUBROUTINES                   11300010
         SR    RD,RD                    CLEAR SIZE REGISTER             11400010
         IC    RD,DEBNMEXT              GET THE NUMBER OF EXTENTS       11500010
         SLL   RD,2                     MULTIPLY EXTENTS BY 4           11600010
         LA    RUCB,DEBUCBAD(RD)        ADDRESS OF ACCESS METHOD        11700010
*                                         DEPENDENT SECTION             11800010
         SR    RD,RD                    CLEAR LENGTH RECORD             11900010
         IC    RD,DEBAMLNG              LENGTH OF ACCESS METHOD         12000010
         AR    RUCB,RD                  ADDRESS OF SUB-ROUTINE ID       12100010
*                                         SECTION                       12200010
         EJECT                                                          12210010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 12225910
*                                                                CLUP21 12226010
*        THIS SECTION OF CODE LOADS THE APPROPRIATE LINE END     CLUP21 12226110
*        APPENDAGE AND THE PCI APPENDAGE IF NEEDED.              CLUP21 12226210
*                                                                CLUP21 12226310
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 12226410
*                                                                CLUP21 12226510
GETAPNDG EQU   *                                                 CLUP21 12226610
         IC    RF,AVTBIT2               LINE CONFIGURATION BITS  S21903 12226710
         LA    RD,THREE                                          S21903 12227110
         NR    RF,RD                    CLEAR EXTRANEOUS BITS    S21903 12227510
         AR    RF,RF                    GET TWO BYTE INDEX       S21903 12227910
         LA    RC,LINEEND(RF)           ADDRESS OF APPENDAGE     S21903 12228310
*                                         TO BE LOADED           S21903 12228710
         CLC   0(TWO,RC),APNDGQ3        LOADING START/STOP       S21903 12229110
         BNE   BALOAD                   NO, BRANCH               S21903 12229510
         TM    AVTBIT1,AVTTSON          TSO OR MIXED ENVIRONMENT S99228 12230610
         BO    BALOAD                   BRANCH YES               S99228 12230910
         LA    RC,APNDGQ5               LOAD ADDR Q5 ID          S99228 12231510
BALOAD   EQU   *                                                 S99228 12231810
         BAL   RD,LOADRTNE              LOAD LINE APPENDAGE      S99228 12232110
         ST    RC,DEBCEA                STORE APPENDAGE ADDR     X02004 12232410
         ST    RC,DEBXCEA               STORE SAME ADDRESS FOR   X02004 12233210
*                                         THE ABNORMAL END APPENDAGE    12234010
         BAL   RD,FIXPAGE               FIX LINE END APPENDAGE   X01004 12237010
         LA    RC,SIOAPNDG              ADDRESS OF SIO APPENDAGE X01004 12237310
         BAL   RD,LOADRTNE              LOAD SIO APPENDAGE       X01004 12237610
         ST    RC,DEBSIOA               SAVE ADDRESS IN DEB      X02004 12238010
         OI    DEBSIOA,DEBSIOX+DEBIOVR  SET EXCPVR VALID AND SIO X02004 12238210
*                                       APG TO BE ENTERED WHEN   X02004 12238410
*                                       ERP ACTIVE               X02004 12238610
         BAL   RD,FIXPAGE               FIX START I/O APPENDAGE  X01004 12238810
         TM    DCBPCI,NOPCI             HAS USER SPECIFIED NO PCICLUP21 12239310
         BO    LOADTRAC                 YES, BRANCH              CLUP21 12639310
         LA    RC,PCIAPNDG              ADDRESS OF PCI APPENDAGE CLUP21 13039310
         BAL   RD,LOADRTNE              LOAD IGG019RN            CLUP21 13439310
*                                                                CLUP21 13839310
         ST    RC,DEBPCIA               STORE PCI ADDRESS IN DEB X02004 14239310
         BAL   RD,FIXPAGE               FIX PCI APPENDAGE        X01004 14439310
         EJECT                                                          14800010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     14880010
*                                                                 *     14960010
*        THIS SECTION OF CODE LOADS THE I/O TRACE ROUTINE         *     15040010
*        AND ISSUES THE CIRB MACRO TO BUILD AN INTERRUPT          *     15120010
*        QUEUE ELEMENT FOR THE I/O TRACE ROUTINE                  *     15200010
*                                                                 *     15280010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     15360010
*                                                                CLUP21 15380010
LOADTRAC EQU   *                                                 CLUP21 15400010
         L     RJ,AVTIOT                LOAD THE VALUE STORED AT        15440010
*                                         AVTIOT                        15520010
         LTR   RJ,RJ                    HAVE WE PREVIOUSLY LOADED       15600010
*                                         THE I/O TRACE ROUTINE         15680010
         BNZ   TEST2260                 YES, BRANCH              CLUP21 15760010
         L     RJ,AVTRACE               LOAD THE VALUE AT AVTRACE       15840010
         LTR   RJ,RJ                    IS THERE ANY I/O TRACE AREA     15920010
         BZ    TEST2260                 NO, BRANCH               CLUP21 16000010
         LA    RC,IOTRACE               LOAD THE ADDRESS OF THE I/O     16080010
*                                         TRACE ROUTINE                 16160010
         BAL   RD,LOADRTNE              RETURN LINKAGE ESTABLISHED      16240010
*                                                                       16320010
         ST    RE,AVTIOT                STORE THE ADDRESS OF THE        16400010
*                                         LOADED TRACE ROUTINE IN       16480010
*                                         THE AVT                       16560010
         BAL   RD,FIXPAGE               FIX I/O TRACE ROUTINE    X01004 17260010
         EJECT                                                          18000010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 18100010
*                                                                CLUP21 18200010
*        THIS SECTION OF CODE LOADS IN THE APPROPRIATE SPECIAL   CLUP21 18300010
*        CHARACTERS TABLE.                                       CLUP21 18400010
*                                                                CLUP21 18500010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 18600010
*                                                                CLUP21 18700010
TEST2260 EQU   *                                                        19400010
         SR    RJ,RJ                    CLEAR AN INDEX REGISTER         19500010
*                                                                CLUP21 19550010
TESTUCB1 EQU   *                                                        19600010
         USING UCB,RF                   UCB ADDRESSABILITY       Y02027 19650010
         L     RF,DEBUCBAD(RJ)          LOAD THE ADDRESS OF THE         19700010
*                                         FIRST/NEXT UCB                19800010
         LTR   RF,RF                    IS THIS A // DD DUMMY ENTRY     19900010
         BNZ   UCBTEST                  NO, BRANCH                      20000010
         LA    RJ,FOUR(RJ)              INCREMENT THE UCB ADDRESS       20100010
*                                         INDEX                         20200010
         B     TESTUCB1                 BRANCH                          20300010
*                                                                CLUP21 20350010
UCBTEST  EQU   *                                                        20400010
         TM    UCBDVCLS,GRAPHICS        GRAPHICS DEVICE ?        Y02027 20500010
*                                       OR A 3270 LOCAL DEVICE   S99228 20550010
         BO    LOAD2260                 YES, BRANCH                     20600010
         TM    UCBUNTYP,CNTRLUNT        IS CONTROL UNIT SPECIFIEDY02027 20700010
         BZ    AUDIOLD                  NO, AUDIO TERMINAL       CLUP21 21000010
         LA    RE,CHATRANS              STARTING OFFSET OF THE   CLUP21 21300010
*                                         SPECIAL CHARACTERS     CLUP21 21600010
*                                         TRANSLATE TABLE        CLUP21 21900010
         SR    RF,RF                    CLEAR FOR SPECIAL        CLUP21 22200010
*                                         CHARACTERS INDEX       CLUP21 22500010
         IC    RF,DCBSCTAD+2            GET TRANSLATE TABLE INDEXCLUP21 22800010
*                                         FROM THE DCB           CLUP21 23100010
         LTR   RF,RF                    IS THE INDEX ZERO        CLUP21 23400010
         BZ    LOADSPEC                 YES, BRANCH              CLUP21 23700010
         SR    RF,RE                    ADJUST INDEX TO START OF CLUP21 24000010
*                                         TRANSLATE TABLE        CLUP21 24300010
         STC   RF,AVTGETMN              STORE SPECIAL CHARS INDEXCLUP21 24600010
         TR    AVTGETMN(1),CHARTBL      TRANSLATE INDEX INTO     CLUP21 24900010
*                                         ADDRESS OFFSET TO ID   CLUP21 25200010
         IC    RF,AVTGETMN              GET OFFSET TO SCT ID     CLUP21 25500010
*                                                                CLUP21 25800010
LOADSPEC EQU   *                                                 CLUP21 26100010
         LA    RC,SPECIALC(RF)          ADDRESS OF SCT ID        CLUP21 26400010
*                                                                CLUP21 26700010
LOADIT   EQU   *                                                 CLUP21 27000010
         BAL   RD,LOADRTNE              LOAD SPECIAL CHARACTERS  CLUP21 27300010
*                                         TABLE                  CLUP21 27600010
         STCM  RE,AD,DCBSCTAD          SAVE ADDR OF SCT IN DCB   X01004 27900010
         STCM  RE,HI,DEBEOEA+THREE      SAVE LENGTH FOR CLOSE    X02004 28200010
         BAL   RD,FIXPAGE               FIX SPECIAL CHARACTERS   X01004 29100010
         EJECT                                                          31000010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 31100010
*                                                                CLUP21 31110010
*        THIS SECTION OF CODE SAVES THE COUNT OF SUBROUTINES     CLUP21 31120010
*        LOADED IN THE DEB AND DETERMINES IF THIS EXECUTOR IS    CLUP21 31130010
*        REQUIRED AGAIN (MULTIPLE DCB'S BEING OPEN'ED). AFTER    CLUP21 31140010
*        ALL DCB'S HAVE BEEN PROCESSED, PARAMETERS ARE SET UP FORCLUP21 31150010
*        TRANSFER OF CONTROL TO THE NEXT LOAD OF OPEN - IGG01940.CLUP21 31160010
*                                                                CLUP21 31170010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 31180010
*                                                                CLUP21 31190010
         STC   RTIOT,DEBNMSUB           STORE THE COUNT OF LOADED       31200010
*                                         SUBROUTINES IN THE DEB        31300010
         MVC   0(5,RWTGC),TCAMLD6       SET THE ID AND TTR FOR THE      31600010
*                                         LAST LOAD OF LINE  OPEN       31700010
         L     RJ,4(RWTGC)              ADDRESS OF OPEN WORK AREA       31800010
*                                                                CLUP21 31900010
RELOOP   EQU   *                                                        32000010
         LA    RWTGC,8(RWTGC)           NEXT WTG ENTRY                  32100010
         LA    RPARC,4(RPARC)           NEXT DCB LIST ENTRY             32200010
         CLC   0(2,RWTGC),AMIDCNST      IS THIS EXECUTOR NEEDED         32300010
*                                         AGAIN                         32400010
         BE    RESTART                  BRANCH IF YES TO PROCESS S22025 32500010
*                                       NEXT DCB                 S22025 32550010
         CLC   0(2,RWTGC),OPIDCNST      END OF WTG TABLE                32600010
         BNE   RELOOP                   BRANCH IF NO FOR NEXT DCBS22025 32700010
         LR    RPARC,RPAR               REINITIALIZE WTG AND            32800010
         LA    RWTGC,32(RWTG)           PARAMETER REGISTERS             32900010
*                                                                CLUP21 32950010
ZCHECK   EQU   *                                                        33000010
         CLI   0(RWTGC),X'00'           IS THIS ENTRY ZERO              33100010
         BNE   XCTLRTNE                 IF NOT ZERO, TRANSFER CNTRL     33200010
         LA    RWTGC,8(RWTGC)           ADDRESS OF NEXT ENTRY           33300010
         LA    RPARC,4(RPARC)           ADDRESS OF NEXT DCB             33400010
         B     ZCHECK                   TRANSFER CONTROL TO NEXT S22025 33500010
*                                       ENTRY                    S22025 33550010
*                                                                       33600010
XCTLRTNE EQU   *                                                        33700010
         LA    RJ,DXCCW12-FORCORE(RJ)   ADDR OF A DOUBLE WORD    Y02027 33800010
*                                         SAVE AREA                     33900010
         MVC   6(2,RWTG),0(RWTGC)       MOVE ID TO NAME FIELD           34000010
         MVC   14(3,RWTG),2(RWTGC)      MOVE TTR TO WTG TABLE           34100010
         XCTL  DE=(RWTG),SF=(E,(15))                                    34200010
*                                                                       34300010
         EJECT                                                          34400010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     34500010
*                                                                 *     34600010
*        STANDARD LOAD SUBROUTINE. UPON ENTRY REGISTER 13 POINTS CLUP21 34700010
*        TO THE TWO-CHARACTER ID OF THE MODULE TO BE LOADED. THE CLUP21 34710010
*        APPROPRIATE ATTRIBUTES ARE SET AND THE LOAD SVC ISSUED. CLUP21 34720010
*        THE TWO-CHARACTER ID IS PLACED IN THE DEB AND THE COUNT CLUP21 34730010
*        OF LOADED MODULES INCREMENTED. UPON EXIT, REGISTERS 0   CLUP21 34740010
*        AND 13 CONTAIN THE ADDRESS OF THE LOADED ROUTINE.       CLUP21 34750010
*                                                                 *     34800010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     34900010
*                                                                       35000010
LOADRTNE EQU   *                                                        35100010
         MVC   6(2,RWTG),0(RC)          MOVE ID TO WTG TABLE            35300010
         LR    RE,RWTG                  LOAD THE ADDRESS OF THE         38600010
*                                         PARAMETER LIST                38700010
         L     RF,CVTPTR                GET ADDRESS OF CVT       Y02027 38800010
         L     RF,CVTSVDCB-CVTMAP(RF)   GET ADDRESS OF THE DCB   Y02027 38900010
*                                       FOR SVCLIB               Y02027 39000010
         LOAD  EPLOC=(0),DCB=(1)        LOAD THE ROUTINE         S21903 39100010
*                                                                       39200010
         MVC   0(2,RUCB),0(RC)          MOVE SUB-ROUTINE ID TO THE      39300010
*                                         DEB                           39400010
         LA    RUCB,2(0,RUCB)           BUMP POINTER TO NEXT ID         39500010
*                                         POSITION IN THE DEB           39600010
         LA    RTIOT,1(0,RTIOT)         KEEP A COUNT OF ALL LOADED      39700010
*                                         SUBROUTINES                   39800010
         ICM   RE,HI,IDEND              CLEAR HIGH ORDER BYTE    Y01004 39830010
         LR    RC,RF                    COPY LENGTH OF MODULE    Y01004 39834010
         SLL   RC,BLDOFF                SHIFT LENGTH TO HIGH     Y01004 39838010
*                                         ORDER BYTE             Y01004 39842010
         OR    RC,RE                    COPY MODULE ADDRESS      Y01004 39846010
         LR    RE,RC                    RETURN WITH MODULE ADDR  Y01004 39850010
         LA    RC,FOUR(RC)              RETURN WITH ADDR + FOUR  X02004 39854010
*                                         IN TWO REGISTERS       CLUP21 39860010
         BR    RD                       RETURN                          39900010
         EJECT                                                          40000010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     41500010
*                                                                 *     41600010
*        THIS SECTION OF CODE LOADS THE ATTENTION ROUTINE         *     41700010
*        AND THE SPECIAL CHARACTERS TABLE FOR 2260 LOCAL DEVICES.CLUP21 41800010
*        IT ALSO LOADS THE SPECIAL CHARACTERS TABLE FOR AUDIO    CLUP21 41830010
*        DEVICES.                                                CLUP21 41860010
*                                                                 *     41900010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     42000010
*                                                                CLUP21 42050010
LOAD2260 EQU   *                                                        42100010
         LR    R4,RF                    SAVE UCB ADDR            S99228 42150010
         LA    RC,ATEN2260              LOAD THE ADDRESS OF THE         42200010
*                                         2260 LOCAL ATTENTION          42300010
*                                         ROUTINE                       42400010
         BAL   RD,LOADRTNE              RETURN LINKAGE ESTABLISHED      42500010
*                                                                       42600010
         L     RC,CVTPTR                GET CVT ADDRESS          Y02027 42700010
         USING CVT,RC                   CVT ADDRESSABILITY       Y02027 42800010
         L     RJ,CVTAQAVT              GET TCX ADDRESS          Y02027 42900010
         USING IEDQTCX,RJ               TCX ADDRESSABILITY       Y02027 43000010
         ST    RE,TCXATTEN              SET ADDR OF ATTN RTN     Y02027 43100010
         OI    CVTTCMFG,LOCALBIT        SET BIT TO INDICATE      Y02027 43200010
*                                         THE PRESENCE OF A 2260        43500010
*                                         LOCAL DEVICE                  43600010
         BAL   RD,FIXPAGE               FIX ATTENTION ROUTINE    X01004 43650010
         SPACE 2                                                 Y02027 43656010
         L     RJ,CVTAQAVT              GET TCX ADDRESS          Y02027 43662010
         LA    RD,IECITABT              GET TCAM ATTN INDEX      Y02027 43668010
         LH    RC,TCXASID               GET ASID OF TCAM         Y02027 43680010
         L     RJ,TCXATTEN              GET ATTN RTN ADDR        Y02027 43686010
         SR    R4,R4                    CLEAR FOR IC           @ZA04035 43686410
         IC    R4,DEBNMEXT              GET NO. OF EXTENTS     @ZA04035 43686810
UCBLOOP  EQU   *                                               @ZA04035 43687210
         SLL   R4,2                     MULT BY FOUR FOR INDEX @ZA04035 43687610
         L     RF,DEBUCBAD-4(R4)        GET UCB ADDRESS        @ZA04035 43688010
         LA    RD,IECITABT              GET TCAM ATTN INDEX    @ZA04035 43688410
         LA    RF,0(RF)                 CLEAR HI ORDER BYTE    @ZA04035 43688810
         SRL   R4,2                     RESTORE RLN            @ZA04035 43689210
         LTR   RF,RF                    DD DUMMY ENTRY         @ZA04035 43689610
         BZ    NXTUCB                   YES,SKIP               @ZA04035 43690010
*                                            ATTNTAB SETTING   @ZA04035 43690410
         LR    RE,RF                    SAVE GOOD UCB ADDR.    @ZA04035 43690810
         IOSGEN TP,VAR=ATNMOD,UCB=RF,TABLE=RD,REG=(RJ,RC)        Y02027 43692010
NXTUCB   EQU   *                                               @ZA04035 43694010
         BCT   R4,UCBLOOP               LOOP THRU ALL UCB'S    @ZA04035 43696010
         LR    R4,RE                    RESTORE LAST UCB ADDR  @ZA04035 43698010
         LA    RC,SPC2260L              ADDRESS OF 2260L SCT ID  CLUP21 43700010
         CLI   UCBUNTYP-UCBOB(R4),LOC3270 UNIT TYPE 3270L        Y02027 43720010
         BL    LOADIT                   NO-GO LOAD 2260 SCT      S99228 43740010
         LA    RC,SPC3270L              ADDR OF 3270L SCT ID     S99228 43760010
         B     LOADIT                   SET THE ATTRIBUTES       CLUP21 43800010
*                                                                CLUP21 43900010
AUDIOLD  EQU   *                                                 CLUP21 44000010
         LA    RC,AUDIOSPC              ADDRESS OF SPECIAL       CLUP21 44100010
*                                         CHARACTERS TABLE ID    CLUP21 44200010
*                                         FOR AUDIO DEVICES      CLUP21 44300010
         B     LOADIT                   LOAD AUDIO SCT           CLUP21 44400010
         EJECT                                                          45200010
FIXPAGE  EQU   *                                                 X01004 45202010
         SLL   RF,THREE                 CONVERT TO BYTE LENGTH   X01004 45203010
         LR    RJ,RE                    GET START ADDRESS        Y02027 45204010
         LA    RJ,0(RF,RJ)              SET END ADDRESS          Y02027 45206010
         LR    RF,RE                    SET START ADDRESS        Y02027 45208010
         LA    RE,AVTDMECB              ADDRESS OF FIX ECB       X01004 45210010
         XC    AVTDMECB(FOUR),AVTDMECB  CLEAR ECB                X01004 45211010
*                                                                X01004 45212010
         PGFIX R,A=(1),EA=(15),ECB=(0)  ISSUE PAGE FIX           Y02027 45213010
*                                                                X01004 45216010
         LA    RF,AVTDMECB              ADDRESS OF FIX ECB       Y02027 45217010
         WAIT  ECB=(RF)                 WAIT FOR PAGE FIX        Y02027 45218010
*                                                                X01004 45221010
         TM    AVTDMECB+THREE,FOUR      CHECK RETURN CODE        X01004 45222010
         BCR   EIGHT,RD                 RETURN TO CALLER         X01004 45223010
         EJECT                                                          45231010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     45240010
*                                                                 *     45242010
*        THIS SECTION OF CODE IS USED TO SAVE THE ID OF THE       *     45244010
*        CURRENT OPEN EXECUTOR AND TO MOVE THE ID OF THE          *     45246010
*        ERROR HANDLER INTO THE WHERE-TO-GO PARAMETER LIST        *     45248010
*                                                                 *     45250010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     45252010
WTGSETUP EQU   *                                                        45254010
         MVI   AVTOPERT,TCAMER23        SET TCAM ERROR INDEX     X01004 45255010
         L     RCORE,FOUR(RWTGC)        LOAD THE ADDRESS OF THE         45256010
*                                         OPEN WORK AREA                45258010
         MVC   AVTOPXCL(TWO),AMIDCNST   MOVE THE ID OF THE CURRENT      45260010
*                                         EXECUTOR INTO THE AVT         45262010
*                                         FOR THE RETURN TO THIS        45264010
*                                         EXECUTOR                      45266010
         MVC   0(FIVE,RWTGC),OPENERP    MOVE THE ID AND TTR FOR THE     45268010
*                                         ERROR HANDLER INTO THE        45270010
*                                         WHERE-TO-GO PARAMETER LIST    45272010
         B     XCTLRTNE                 BRANCH TO THE XCTL ROUTINE      45278010
         EJECT                                                          45300010
CHARTBL  EQU   *                        TRANSLATE TABLE FOR      CLUP21 45303010
*                                         SPECIAL CHAR MODULES   CLUP21 45306010
         DC    X'00'                    INDEX TO 1030 CHARACTERS CLUP21 45309010
         DC    X'00'                    INDEX TO 1050 CHARACTERS CLUP21 45312010
         DC    X'00'                    INDEX TO 1050 FOLDED     S22025 45315010
         DC    X'00'                    INDEX TO 1060 CHARACTERS CLUP21 45318010
         DC    X'08'                    INDEX TO 2260R SCT       S21903 45321010
         DC    X'00'                    INDEX TO 2265 CHARACTERS S22025 45324010
         DC    X'00'                    INDEX TO 2740 CHARACTERS CLUP21 45327010
         DC    X'00'                    INDEX TO 2740 FOLDED     S22025 45330010
         DC    X'0E'                    INDEX TO WTTA SCT        S21903 45333010
         DC    X'0E'                    INDEX TO WTTA SCT        S21903 45336010
         DC    X'0A'                    INDEX TO 83B3 SCT        S21903 45339010
         DC    X'10'                    INDEX TO TWX SCT         S21903 45342010
         DC    X'00'                    RESERVED                 S22025 45345010
         DC    X'00'                    FOR                      S22025 45348010
         DC    X'00'                    FUTURE                   S22025 45351010
         DC    X'00'                    USE                      S22025 45354010
         DC    X'0A'                    INDEX TO 83B3 & 115A SCT S21903 45357010
         DC    X'10'                    INDEX TO TWX SCT         S21903 45360010
         DC    X'0C'                    INDEX TO TWX SCT         S21903 45363010
         DC    X'06'                    INDEX TO 6-BIT SCT       S21903 45366010
         DC    X'04'                    INDEX TO ASCHII SCT      S21903 45369010
         DC    X'02'                    INDEX TO EBCDIC SCT      S21903 45372010
         DC    X'00'                    INDEX TO 2741 CHARACTERS CLUP21 45375010
         DC    X'00'                    INDEX TO 2741 EBCDIC     S22025 45378010
         DC    X'00'                    INDEX TO 2741 CORRESP.   S22025 45381010
         DC    X'00'                    RESERVED FOR             S22025 45384010
         DC    X'00'                    FUTURE USE               S22025 45387010
         EJECT                                                          45390010
AMIDCNST DC    C'39'                    ID OF THIS MODULE               45400010
OPIDCNST DC    C'0S'                    END OF WTG TABLE         S22025 45500010
TWO      EQU   2                        NUMERIC CONSTANT         Y02027 45900010
THREE    EQU   3                        NUMERIC CONSTANT         Y02027 46000010
FOUR     EQU   4                        NUMERIC CONSTANT         Y02027 46100010
FIVE     EQU   5                        NUMERIC CONSTANT         Y02027 46200010
EIGHT    EQU   8                        NUMERIC CONSTANT         Y02027 46300010
NINE     EQU   9                        NUMERIC CONSTANT         Y02027 46400010
TWELVE   EQU   12                       NUMERIC CONSTANT         Y02027 46500010
CHATRANS EQU   16                       OFFSET TO SPECIAL CHAR   Y02027 46600010
*                                       OFFSET TABLE             Y02027 46700010
SIXTEN   EQU   16                       NUMERIC CONSTANT         Y02027 46850010
TCAMER23 EQU   23                       TCAM ERROR ID            Y02027 47050010
DEBPTR   EQU   36                       LENGTH OF THE DEB PREFIX        47400010
IQE      EQU   100                                                      47420010
IQETRCAD EQU   105                                                      47440010
IQEIRBAD EQU   108                                                      47460010
IQETCBAD EQU   113                                                      47480010
CNTRLUNT EQU   X'03'                                             CLUP21 47540010
NOPCI    EQU   X'0C'                    TO TEST FOR NO PCI       CLUP21 47800010
GRAPHICS EQU   X'10'                    2260 LOCAL               Y02027 48000010
LOCALBIT EQU   X'40'                    2260 LOCAL SW. IN AVT    Y02027 48300010
PURGESIZ EQU   X'C0'                    FOR GETMAIN IN PURGE RTN CLUP21 48400010
SP252    EQU   X'FC'                    SUBPOOL 252 INDICATOR    CLUP21 48560010
LOC3270  EQU   X'09'                    09 OR 0A INDICATE LOCAL  S99228 48814010
*                                       3270 DEVICE              S99228 48821010
ONE      EQU   1                        CONSTANT OF ONE          X01004 49070010
LOW      EQU   3                        ICM/STCM MASK            X01004 49150010
AD       EQU   7                        ICM/STCM MASK            X01004 49230010
HI       EQU   8                        ICM/STCM MASK            X01004 49310010
BLDOFF   EQU   24                       SHIFT LENGTH             Y02027 49390010
         EJECT                                                          49700010
SIOAPNDG DC    C'QE'                    ID OF SIO APPENDAGE      X01004 50200010
*                                       FOLLOWING MODULES < 1K   S22026 50400010
ATEN2260 DC    C'R5'                    2260L ATTENTION ROUTINE         50500010
IOTRACE  DC    C'Q0'                    I/O TRACE MODULE                50700010
SPC2260L DC    C'RV'                    2260L SPECIAL CHARACTERS CLUP21 50900010
SPC3270L DC    C'EM'                    3270 SPECIAL CHARS TBL   S99228 50926010
AUDIOSPC DC    C'RY'                    AUDIO SPECIAL CHARACTERS CLUP21 50940010
SPECIALC DC    C'RR'                    ID FOR SPECIAL CHARS     CLUP21 50980010
         DC    C'R7'                    EBCDIC TRANSMISSION CODE CLUP21 51020010
         DC    C'R8'                    ASCHII TRANSMISSION CODE CLUP21 51060010
         DC    C'R9'                    6 BIT  TRANSMISSION CODE CLUP21 51100010
         DC    C'RS'                    2260R  TRANSMISSION CODE CLUP21 51140010
         DC    C'RT'                    83B3 & 115A SCT ID       CLUP21 51180010
         DC    C'RU'                    TWX    TRANSMISSION CODE CLUP21 51220010
         DC    C'RW'                    WTTA   TRANSMISSION CODE CLUP21 51260010
         DC    C'RX'                    EVEN PARITY TWX TRANS C. S22025 51300010
PCIAPNDG DC    C'RN'                    ID OF PCI APPENDAGE      CLUP21 51340010
LINEEND  DC    C'R0'                    START/STOP & BSC APPNDG  S21903 51360010
         DC    C'Q2'                    BSC APPNDG               S21903 51450010
APNDGQ3  DC    C'Q3'                    START/STOP & TSO APPNDG  S21903 51540010
         DC    C'Q4'                    MINI APPNDG              S21903 51630010
APNDGQ5  DC    C'Q5'                    START/STOP APPNDG        S21903 51720010
TCAMLD6  DC    C'40'                    LAST LOAD OF OPEN               51900010
         DC    XL4'0'                   TTR AND LENGTH                  52000010
OPENERP  DC    C'33'                    ID OF THE OPEN ERROR HANDLER    52020010
         DC    XL4'00'                    TTR AND LENGTH                52040010
IDEND    DC    X'0000'                  END OF TABLE             S22025 52100010
         EJECT                                                   Y02027 52200010
         TTCXD                                                   Y02027 52230010
         EJECT                                                   Y02027 52260010
UCB      DSECT                                                   Y02027 52290010
         IEFUCBOB                                                       52320010
         EJECT                                                   Y02027 52350010
CVT      DSECT                                                   Y02027 52380010
         CVT                                                            52410010
         EJECT                                                   Y02027 52440010
         IECDIOCM                                                       52470010
         EJECT                                                   Y02027 52500010
         IECDATB                                                        52530010
         EJECT                                                          52600010
         TAVTD                          AVT DSECT                       52700010
         EJECT                                                          52760010
FORCORE  DSECT                                                   Y02027 52820010
         IECDSECT                                                       52880010
         EJECT                                                          52940010
         TDEBD                                                          53000010
DEBSIOX  EQU   X'40'                    ENTER SIO APG FROM ERP   X02004 53060010
DEBIOVR  EQU   X'20'                    EXCPVR VALID FOR THIS DEBX02004 53120010
         DCBD  DSORG=TX                                                 53200010
         END                                                            53300010
