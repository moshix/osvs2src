 TITLE 'IGG0193M  BTAM LINE GROUP OPEN EXECUTOR - LOAD 1'               00200019
*********************************************************************** 00400002
*                                                                     * 00450002
* MODULE NAME: IGG0193M  (OS/VS)                                      * 00500002
*                                                                     * 00550002
* DESCRIPTIVE NAME: BTAM LINE GROUP OPEN EXECUTOR - LOAD 1            * 00560002
*                                                                     * 00570002
* COPYRIGHT: NONE                                                     * 00580002
*                                                                     * 00600002
* STATUS: RELEASE 2                                                   * 00800002
*                                                                     * 01000019
* FUNCTION/OPERATION: THIS ROUTINE GETS MAIN STORAGE FOR AND INITIAL- * 01200002
*   IZES A DATA EXTENT BLOCK.  IT ANALYZES DEVICE TYPE INFORMATION    * 01400002
*   PROVIDED IN THE UNIT CONTROL BLOCK TO DETERMINE WHAT TYPE OF      * 01600002
*   TERMINAL DEVICES ARE ATTACHED TO THE GROUP OF LINES THAT MAKE UP  * 01800002
*   THIS LINE GROUP.                                                  * 02000002
*                                                                     * 02200019
* ENTRY POINTS: THIS ROUTINE IS ENTERED AT IGG0193M VIA AN XCTL FROM  * 02400002
*   AN I/O SUPPORT MODULE OR FROM ANOTHER ACCESS METHOD'S OPEN        * 02600019
*   EXECUTOR.  IT MAY ALSO BE RE-ENTERED FROM THE RELOOP PORTION OF   * 02800002
*   THIS ROUTINE IF IT DETERMINES THAT THERE IS ANOTHER DATA CONTROL  * 03000019
*   BLOCK TO BE OPENED.                                               * 03200019
*                                                                     * 03400019
* INPUT: THE REGISTERS 5, 6, 7, AND 8 ARE THE INPUT, AS FOLLOWS,      * 03600002
*   5- THE ADDRESS OF THE FIRST ENTRY IN THE COPIED DCB PARAMETER LIST* 03800002
*   6- THE ADDRESS OF THE BEGINNING OF THE WHERE-TO-GO TABLE,         * 04000002
*   7- THE ADDRESS OF THE CURRENT ENTRY IN THE COPIED DCB PARAMETER   * 04200002
*      LIST,                                                          * 04250002
*   8- THE ADDRESS OF THE CURRENT EXECUTOR'S ENTRY IN THE WHERE-TO-GO * 04400019
*      TABLE.                                                         * 04600019
*                                                                     * 04650002
* OUTPUT:  THE REGISTERS 7 AND 8 WILL BE POSITIONED AT THE NEXT       * 04800002
*   ENTRIES IN THE COPIED DCB PARAMETER LIST AND THE WHERE-TO TABLE.  * 05000002
*   A DEB WILL HAVE BEEN CONSTRUCTED IN SUBPOOL 230.                  * 05200002
*  SOME OF THE DCB FIELDS WILL HAVE BEEN INITIALIZED.                 * 05400019
*  THIS EXECUTOR'S ENTRY (OR ENTRIES) IN THE WHERE - TO -             * 05600019
*   GO TABLE WILL HAVE BEEN UPDATED TO IDENTIFY LOAD 2 (IGG0194N -    * 05800002
*   FOR NON LOCAL 3270 DEVICES) OR (IGG0194P - FOR LOCAL 3270 DEVICES)* 05850002
*                                                                     * 05900002
* EXTERNAL ROUTINES:  NONE                                            * 06000002
*                                                                     * 06200019
* EXITS-NORMAL:  THIS ROUTINE EXITS VIA AN XCTL TO THE MODULE         * 06400002
*   IDENTIFIED BY THE NEXT NON-ZERO ENTRY IN THE WHERE-TO-GO TABLE,   * 06600019
*   NAMELY IGG0194N OR IGG0194P.                                      * 06800002
*                                                                     * 07000019
*     -ERRORS-  THIS ROUTINE EXITS VIA ABEND FOR THE FOLLOWING        * 07200019
*   ERROR CONDITIONS-                                                 * 07400019
*   ABEND CODE ERROR CONDITION                                        * 07600019
*   00090000    A DEVICE OTHER THAN A COMMUNICATIONS DEVICE HAS BEEN  * 07800019
*               ALLOCATED TO THIS DCB.                                * 08000019
*   00091000    AN INVALID OR UNSUPPORTED CONTROL UNIT HAS BEEN       * 08200019
*               SPECIFIED                                             * 08400019
*   00092000    AN INVALID OR UNSUPPORTED TYPE OF TERMINAL CONTROL    * 08600019
*               OR ADAPTER HAS BEEN SPECIFIED                         * 08800019
*   00093000    AN INVALID OR UNSUPPORTED TERMINAL TYPE HAS BEEN      * 09000019
*               SPECIFIED.                                            * 09200019
*   00094000    AN INVALID OR UNSUPPORTED OPTIONAL FEATURE (OR MODE OF* 09400019
*               OPERATION) HAS BEEN SPECIFIED.                        * 09600019
*   00095000    INCOMPATABLE DEVICES ARE DEFINED TO BE ON THE SAME    * 09800019
*               LINE GROUP.                                           * 10000019
*                                                                     * 10200019
* TABLES/WORK AREAS: THE WHERE-TO-GO TABLE CONTAINS THE ID AND TTR    * 10400002
*       OF THE OPEN EXECUTOR LOAD 2. THE DCB PARAMETER LIST CONTAINS  * 10600019
*       THE ADDRESS OF EACH DCB SPECIFIED IN THE OPEN MACRO. THE      * 10800002
*       COMMUNICATION VECTOR TABLE IS A RESIDENT VECTOR LIST USED     * 11000019
*       TO LOCATE THE TIOT, WHICH IS NEEDED IN DEB CONSTRUCTION.      * 11200002
*                                                                     * 11400019
* ATTRIBUTES: THIS ROUTINE IS EXECUTED IN THE DATA MANAGEMENT KEY OF  * 11600002
*       5 AS ENABLED, PRIVILEGED, AND REENTRANT.                      * 11800002
*                                                                     * 12000019
* NOTES: THIS ROUTINE INITIATES THE OPEN PROCESSING FOR               * 12200002
*  TELECOMMUNICATIONS. IT CONSTRUCTS AND INITIALIZES THE DEB          * 12400002
*  (INCLUDING THE UCB ADDRESSES IN THE DEB). FOR SECURITY AND         * 12450002
*  INTEGRITY PURPOSES, OPEN PROCESSING WILL BE ONLY ON THE COPIED     * 12500002
*  DCB AND COPIED DCB PARAMETER LIST. BTAM OPEN LOADS MUST KEEP       * 12550002
*  THE USER DCB AND THE COPIED DCB SYNCHRONIZED. THE LAST BTAM        * 12560002
*  OPEN LOAD WILL SYNCHRONIZE THE DCB'S. UPON COMPLETION OF THIS      * 12570002
*  MODULE, CONTROL IS PASSED TO THE SECOND OPEN MODULE THROUGH        * 12620002
*  THE WHERE-TO-GO TABLE ENTRY.                                       * 12670002
*                                                                     * 13200019
* CHANGE ACTIVITY AS FOLLOWS:                                         * 13250002
*            APARS                           PTMS                     * 13300002
*       YA02170  (10/5/73)               YM5663  (12/11/73) PROLOG    * 13350002
*       YA03251  (2/1/74)                                             * 13352000
*       AZ04858  (10/06/75)                                           * 13356000
*       AZ10016  (03/30/76)                                           * 13358000
*       AZ26035  (09/16/77)                                           * 13360000
*       AZ17697  (11/10/77)                                           * 13370000
*********************************************************************** 13400002
         EJECT                                                          13410002
*/*IGG0193M: CHART                                                   */ 13430000
*/*HEADER                                                               13442000
*/*CHART A1-A  BTAM OPEN EXECUTOR - LOAD 1 (IGG0193M; VS2 RELEASE 2) */ 13444000
*/*IGG0193M: E IGG0193M */                                              13448000
*/*          P ESTABLISH COPIED DCB ADDRESSABILITY */                   13448400
*/*          D (NO,,YES,BYPASS) IS THIS A STRAM DCB? */                 13448800
*/*          P LOCATE DD ENTRY IN TIOT */                               13449200
*/*DDCONCAT  P ACCUMULATE SPACE REQUIREMENTS FOR UCB ADDRESSES */       13449600
*/*          D (YES,ENDD,NO,) END OF TIOT? */                           13449700
*/*          D (YES,DDCONCAT,NO,) NEXT DD ENTRY CONCATENATED? */        13449800
*/*ENDD      D (YES,DEBMAX,NO,) DYNAMIC BUFFERING SPECIFIED? */         13449900
*/*          D (YES,DEBMID,NO,) DOES BUFFER POOL EXIST? */              13499900
*/*          D (NO,DEBMIN,YES,) ARE ANY BUFFERS REQUESTED? */           13509900
*/*          D (YES,DEBMIN,NO,DEBMID) BUFFER LENGTH ZERO? */            13519900
*/*DEBMAX    P INCREMENT DEB SIZE BY 10 */                              13529900
*/*DEBMID    P INCREMENT DEB SIZE BY 6 */                               13539900
*/*DEBMIN    P INCREMENT DEB SIZE BY BASIC DEB SIZE OF 89 */            13541900
*/*          L SVC 10 - GETMAIN FOR DEB FROM SUBPOOL 230 */             13543900
*/*CLEARDEB  P CLEAR DEB AND INITIALIZE DEB AND COPIED DCB FIELDS */    13545900
*/*CHAIN     P PUT DEB ON TCB-DEB CHAIN */                              13547900
*/*          D (YES,SETERP,NO,) IS ERP REQUESTED? */                    13548300
*/*          P SET NO ERP FLAG IN DCB */                                13548700
*/*SETERP    P PLACE USER'S DCB ADDRESS IN DEB */                       13549100
*/*          L SVC 117 - DEBCHK,TYPE=ADD */                             13549500
*/*          P PRIME REG1 WITH ABEND CODE 90 */                         13549600
*/*UCBMOVE   P MOVE UCB ADDRESSES TO DEB */                             13549700
*/*          P SET IOS APPENDAGES ADDR IN FIRST 20 BYTES OF DCB */      13549800
*/*          D (YES,ANRLOAD2,NO,) DEVICE CLASS = GRAPHICS? */           13566500
*/*NEXTUCB   D (NO,AB5,YES,) ALL DEVICES IN LINE GROUP COMPATIBLE? */   13576500
*/*TESTTCU   D (NO,AB0,YES,) TELECOMMUNICATIONS UCB? */                 13578500
*/*          D (NO,AB1,YES,) VALID CONTROL UNIT? */                     13580500
*/*          D (NO,AB2,YES,) VALID ADAPTER? */                          13582500
*/*          D (NO,AB3,YES,) VALID TERMINAL? */                         13582900
*/*          D (NO,AB4,YES,) VALID FEATURES? */                         13583000
*/*ENDLOD1   P SAVE INDEX FOR DEVTAB IN DCB FOR LOAD2 */                13583100
*/*          P SET WTG TABLE FOR IGG0194N */                            13583200
*/*IGG0193M: END */                                                     13588800
         EJECT                                                          13596400
IGG0193M CSECT                                                          13598400
         SPACE 5                                                        13600002
RPARM0   EQU   0                        PARAMETER REGISTER 0            13800019
RPARM1   EQU   1                        PARAMETER REGISTER 1            14000019
RW1      EQU   2                        WORK REGISTER 1                 14200019
RW2      EQU   3                        WORK REGISTER 2                 14400019
RW3      EQU   4                        WORK REGISTER 3                 14600019
RPAR     EQU   5                        ADDRESS OF COPIED DCB    Y02947 14800002
*                                       PARAMETER LIST           Y02947 14850002
RWTG     EQU   6                        ADDRESS OF WTG TABLE            15000019
RPARC    EQU   7                        ADDRESS OF CURRENT       Y02947 15200002
*                                       COPIED DCB ENTRY         Y02947 15250002
RWTGC    EQU   8                        ADDRESS OF CURRENT WTG ENTRY    15400019
RTIOT    EQU   9                        ADDRESS OF TASK I/O TABLE       15600019
RDCB     EQU   10                       ADDRESS OF COPIED DCB    Y02947 15800002
RDEB     EQU   11                       ADDRESS OF DEB                  16000019
RBASE    EQU   12                       BASE REGISTER                   16200019
RSAVE    EQU   13                       ADDRESS OF TASK CONTROL BLOCK   16400019
RUCB     EQU   14                       NO. OF UCB'S/ADDRESS OF UCB     16600019
RSIZE    EQU   15                       SIZE OF DEB IN DOUBLE WORDS     16800019
         BALR  RBASE,0                  SET UP BASE REGISTER            17000019
         USING *,RBASE                                                  17200019
         USING IHADCB,RDCB                                              17400019
         USING IECTDEB,RDEB                                             17600019
         SPACE 4                                                        17800019
         B     AROUND                   BRANCH AROUND ID         Y02947 17850002
         DC    C'IGG0193M'              OPEN ID                  Y02947 17900002
         DC    C'UZ06851'               CURRENT PTF NUMBER     @ZA26035 17910000
         DS    0F                                                Y02947 17920002
PATCH    DC    XL50'00'                 PATCH AREA               Y02947 17930002
         SPACE 4                                                 Y02947 17950002
AROUND   L     RDCB,0(RPARC)            LOAD COPIED DCB ADDRESS  Y02947 18000002
*                                       IF THE SAME DCB OCCURS IN THE   18400019
*                                            PARAMATER LIST MORE THAN   18600019
*                                            ONCE, IT SHOULD BE PRO-    18800019
*                                            CESSED ONLY THE FIRST TIME 19000019
*       FOUR LINES DELETED BY THE FOLLOWING APAR                YA03251 19200000
         SPACE 1                                                        19800019
         TM    DCBDEVTP,STR             TEST FOR STRAM                  20000019
         BO    BYPASS                   IF SO, BRANCH OUT               20200019
         SPACE 1                                                 Y02947 20210002
         USING CVT,RSAVE                CVT ADDRESSABILITY       Y02947 20250002
         L     RSAVE,SIXT               LOCATE DDNAME VIA CVT,   Y02947 20400002
         L     RSAVE,CVTTCBP                 TASK CONTROL BLOCK, Y02947 20600002
         L     RSAVE,CURNTTCB(RSAVE)         AND CURRENT TASK CONTROL   20800019
         L     RTIOT,TCBTIO(RSAVE)           BLOCK.  LOAD ADRS OF TASK  21000019
         AH    RTIOT,DCBTIOT                 I/O TABLE, ADD OFFSET TO   21200019
*                                            LENGTH FIELD               21400019
         DROP RSAVE                    DROP CVT ADDRESS          Y02947 21450002
         EJECT                                                   Y02947 21500002
         LR    RW1,RTIOT                LOAD ADRS INTO WORK REGISTER    21600019
         SR    RW2,RW2                  RESET REGISTERS                 21800019
         SR    RW3,RW3                                                  22000019
         SR    RUCB,RUCB                                                22200019
         SPACE 1                                                 Y02947 22250002
         MODESET EXTKEY=ZERO            KEY ZERO                 Y02947 22300002
         SPACE 1                                                 Y02947 22350002
DDCONCAT LA    RW2,1(RW2)               ADD 1 FOR COUNT OF CONCAT DD'S  22400019
         IC    RW3,0(RW1)               LOAD TIOT LENGTH                22600019
         AR    RW1,RW3                  ADD TO START OF DD ENTRY        22800019
         SH    RW3,SIXTEEN              SUBTRACT SIZE OF DD INFORMATION 23000019
         AR    RUCB,RW3                 RESULT=NO OF DEVICES, ACCUMULAT 23200019
         NC    0(4,RW1),0(RW1)          TEST FOR ZERO END WORD          23400019
         BZ    ENDD                     IF ZERO BRANCH                  23600019
         CLI   4(RW1),BLNK              TEST FOR CONCATENATED DD        23800019
         BE    DDCONCAT                 IF SO, LOOP                     24000019
         SPACE 1                                                 Y02947 24250002
ENDD     EQU   *                                                 Y02947 24252002
         MODESET EXTKEY=DATAMGT         DATAMGT KEY              Y02947 24260002
         SPACE 1                                                 Y02947 24270002
         ST    RW2,DCBDEBAD            SAVE COUNT OF DD'S        A26886 24300002
         SR    RW2,RW2                                           A26886 24400019
         LR    RW3,RUCB                                                 24600019
         TM    DCBBFTEK,DYNBUF          TEST FOR DYNAMIC BUFFERING      24800019
         BO    DEBMAX                   IF SPECIFIED BRANCH             25000019
         CLI   DCBBUFCB+3,X'01'         IS THERE A BUFFER POOL          25200019
         BNE   DEBMID                   IF SO, BRANCH (X'01'=NO BFR PL) 25400019
         CLI   DCBBUFNO,X'00'           ARE ANY BUFFERS REQUESTED       25600019
         BE    DEBMIN                   IF NOT, BRANCH                  25800019
         CH    RW2,DCBBUFL              IF SO, TEST LENGTH              26000019
         BE    DEBMIN                   NO LENGTH IS SPECIFIED          26200019
         B     DEBMID                   LENGTH IS NOT ZERO              26400019
DEBMAX   LA    RW3,10(RW3)              INCREMENT SIZE                  26600019
         LA    RW2,8(RW2)               INCREMENT TYPE                  26800019
DEBMID   LA    RW3,6(RW3)               INCREMENT SIZE                  27000019
         LA    RW2,4(RW2)               INCREMENT TYPE                  27200019
DEBMIN   LA    RW3,89(RW3)              ADD BASIC DEB SIZE              27400019
         SRL   RW3,3                    COMPUTE DOUBLE WORDS IN DEB     27600019
         LR    RW1,RW3                  SAVE                            27800019
         SLL   RW3,3                    COMPUTES BYTES IN DEB           28000019
         LR    RPARM0,RW3               LOAD GET MAIN PARAMETER REG     28200019
         O     RPARM0,DEBPOOL           OR IN SUBPOOL NUMBER            28400019
         SPACE 2                                                 Y02947 28450002
*   GET CORE FOR DEB'S FROM SUBPOOL 230                          Y02947 28500002
         GETMAIN R,LV=(0)               REQUEST STORAGE FOR DEB         28600019
         EJECT                                                   Y02947 28800002
         LR    RDEB,RPARM1              PLACE DEB ADDRESS IN DEB REG    29000019
         SR    RPARM1,RPARM1            CLEAR REG               YA02170 29200002
         B     CLEARS                                                   29400019
CLEARDEB STC   RPARM1,0(RDEB,RW3)       ZERO DEB                        29600019
CLEARS   BCT   RW3,CLEARDEB             DECREMENT AND TEST COUNT        29800019
         STC   RPARM1,0(RDEB)                                           30000019
         STC   RW1,DEBLNGTH             STORE DEB SIZE (IN DBL WORDS)   30200019
         SRL   RUCB,2                                                   30400019
         STC   RUCB,DEBNMEXT            STORE UCB COUNT                 30600019
         ST    RSAVE,DEBTCBAD-1         STORE TCB ADDRESS               30800019
         ST    RDEB,DEBAPPAD-1          STORE DEB ADDRESS               31000019
         MVI   DEBEXSCL,X'02'           CODE AS NOT DIRECT ACCESS DEVIC 31200019
         STC   RW2,DEBAMLNG             STORE ACCESS METHOD SIZE IN DEB 31600019
         SPACE 1                                                 Y02947 31610002
         MODESET EXTKEY=ZERO            KEY OF ZERO              Y02947 31620002
         SPACE 1                                                 Y02947 31650002
         LA    RW3,DEBTCBAD-1           LOAD DEB ADDRESS         Y02947 31800002
         L     RW2,TCBDEB(RSAVE)        ADDR OF 1ST DEB ON TCB   Y02947 32000002
CHAIN    STCM  RW2,SEVEN,DEBDEBAD       CHAIN TO OUR DEB         Y02947 32050002
         CS    RW2,RW3,TCBDEB(RSAVE)    PUT OUR DEB AT TOP OF    Y02947 32060002
         BNE   CHAIN                       CHAIN OR PICK UP NEW  Y02947 32070002
*                                          TOP IF CHANGED        Y02947 32080002
         SPACE 1                                                 Y02947 32090002
         MODESET EXTKEY=DATAMGT         DATAMGT KEY              Y02947 32092002
         SPACE 1                                                 Y02947 32094002
         L     RUCB,DCBDEBAD           GET COUNT OF DD'S         A26886 32100019
         ST    RW3,DCBDEBAD             STORE DEB ADDRESS IN     Y02947 32200002
*                                       COPIED DCB               Y02947 32250002
         TM    DCBERROP,ERP             TEST FOR ERROR RECOVERY PROCED. 32400019
         BZ    SETERP                   IF ZERO, ERP REQUESTED          32600019
         MVI   DCBIFLGS,X'0C'           IF ONE, SET NO ERP BITS         32800019
         SPACE 1                                                 Y02947 32850002
SETERP   EQU  *                                                  Y02947 33000002
*         THE USER'S DCB ADDRESS RATHER THAN THE ADDRESS OF THE  Y02947 33010002
*         COPIED DCB MUST BE PLACED IN THE DEB FOR THE DEBCHK    Y02947 33020002
*         MACRO                                                  Y02947 33030002
         L     RW1,4(RWTGC)             ADDR OF OPEN WORK AREA   Y02947 33050002
         USING WORKAREA,RW1             WORKAREA ADDRESSABILITY  Y02947 33060002
         MVC   DEBDCBMK(4),DXDEBXAD     ADDR OF DEB XTENTION   @ZA17697 33065000
         SPACE 1                                                 Y02947 33070002
         MODESET KEYADDR=DXUKEY,WORKREG=15    USER'S KEY         Y02947 33080002
         SPACE 1                                                 Y02947 33090002
         L     RW1,DXUDCBAD             GET ADDR OF USER'S DCB   Y02947 33100002
         DROP  RW1                      DROP WORKAREA ADDRESS    Y02947 33110002
         DROP  RDCB                     DROP COPY DCB ADDRESS    Y02947 33120002
         USING IHADCB,RW1               USER DCB ADDRESSABILITY  Y02947 33130002
         ST    RW3,DCBDEBAD             PLACE DEB ADDRESS IN     Y02947 33140002
*                                       USER DCB                 Y02947 33142002
         DROP  RW1                      DROP USER DCB ADDRESS    Y02947 33144002
         USING IHADCB,RDCB              COPY DCB ADDRESSABILITY  Y02947 33146002
         SPACE 1                                                 Y02947 33148002
         MODESET EXTKEY=DATAMGT         DATAMGT KEY              Y02947 33148402
         SPACE 1                                                 Y02947 33148802
         ST    RW1,DEBDCBAD-1           PLACE USER'S DCB         Y02947 33150002
*                                       ADDRESS IN DEB           Y02947 33160002
         MVC   DEBPROTG(1),TCBPKF(RSAVE) MOVE PROTECTION KEY TO DEB     33200002
         OI    DEBPROTG,X'0F'           OR IN DEB ID                    33400019
         DEBCHK (RW1),AM=TAM,TYPE=ADD  ADD DEB TO SYSTEM TABLE   Y20947 33450002
         EJECT                                                   Y02947 33460002
         L     RPARM1,ABCODE            LOAD ABEND CODE         YA02170 33510002
         LA    RW3,DEBUCBAD             LOAD UCB ADDRESS                33800019
         SR    RW1,RW1                  RESET WORK REGISTER             34000019
UCBMOVE  IC    RW1,0(RTIOT)             LOAD UCB SIZE                   34200019
         SH    RW1,SEVENTEN             SUBTRACT 16                     34400019
         EX    RW1,UCBMVEX              MOVE UCB FROM TIOT TO DEB       34600019
         LA    RW3,1(RW1,RW3)           STEP ADDRESS                    34800019
         LA    RTIOT,17(RW1,RTIOT)      STEP ADDRESS                    35000019
         BCT   RUCB,UCBMOVE             DECREMENT COUNT OF UCB'S        35200019
         L     RUCB,DEBUCBAD            LOAD UCB ADDRESS                35400019
         USING CVT,RW1                  CVT ADDRESSABILITY       Y02947 35450002
         L     RW1,SIXT                 LOAD ADRS OF CVT         Y02947 35600002
         L     RW1,CVTXAPG          LOAD ADRS OF IOS RETURN ADRS Y02947 35800002
         DROP RW1                       DROP CVT ADDRESS         Y02947 35850002
         MVC   DEBEOEA(4),0(RW1)        MOVE IOS RETURN ADRS INTO DEB   36000019
         MVC   DEBSIOA(16),DEBEOEA      FOR EOEA, SIO, PCI, CE, & XCE   36200019
         CLI   UCBDVCLS(RUCB),GRAPHICS  GRAPHICS DEVICE CLASS IN UCB    36260002
         BE    ANRLOAD2            YES, GO TO SPECIAL LOAD FOR 3270     36320002
         LA    RW1,4                    SET 1ST WORK REG TO VALUE 4     36400019
         SR    RW2,RW2                  RESET REGISTER                  36600019
         IC    RW2,DEBNMEXT             LOAD NO OF UCB'S                36800019
         BCTR  RW2,0                    DECREMENT BY 1                  37000019
         SLL   RW2,2                    MULTIPLY BY 4, RESULT COUNT-1X4 37200019
         SR    RW3,RW3                  RESET WORK REGISTER             37400019
NEXTUCB  BXH   RW3,RW1,TESTTCU          INCREMENT & TEST COUNT          37600019
         MVC   0(4,RWTGC),16(RUCB)      MOVE 1ST UCB TO WORK AREA       37800019
         L     RSIZE,DEBUCBAD(RW3)      LOAD ADRS OF 2ND-NTH UCB        38000019
         XC    0(4,RWTGC),16(RSIZE)     X-OR 2ND-NTH UCB TO 1ST         38200019
         NC    0(4,RWTGC),HOLDMASK      AND OF VARIABLE BITS            38400019
         BNZ   AB5                      IF RESULT NON ZERO ERROR EXISTS 38600019
         B     NEXTUCB                  GO CHECK NEXT UCB               38800019
         SPACE 4                                                        39000019
TESTTCU  EQU   *                                                        39200019
         SR    RW1,RW1                                                  39400019
         SR    RW2,RW2                                                  39600019
         SR    RW3,RW3                                                  39800019
         SR    RPARM0,RPARM0                                            40000019
         SPACE                                                          40200019
         CLI   18(RUCB),TPDEVCCD        IS UCB FOR TELECOMMUNICATIONS   40400019
         BNE   AB0                      IF NOT, ABEND                   40600019
         TM    19(RUCB),X'03'           TEST FOR VALID XMSN CTRL UNIT   40800019
         BZ    AB1                      IF NOT ABEND                    41000019
         MVZ   DCBHOLD1(1),19(RUCB)     GET ADAPTER TYPE                41200019
         MVN   DCBHOLD1(1),16(RUCB)          MODEL TYPE                 41400019
         IC    RW2,17(RUCB)             GET SPECIAL FEATURES            41600019
         SRL   RW2,2                                                    41800019
         STC   RW2,DCBHOLD2                                             42000019
         SPACE 1                                                        42200019
         LA    RW1,TYPETAB                                              42400019
         LA    RW2,SPFETAB                                              42600019
         B     SCAN1                                                    42800019
         SPACE                                                          43000019
SCAN     LA    RW3,1(RW3)                                               43200019
         LA    RW1,1(RW1)                                               43400019
         LA    RW2,1(RW2)                                               43600019
         SPACE 1                                                        43800019
SCAN1    CLC   0(1,RW1),DCBHOLD1        SCAN FIRST FOR DEVICE TYPE      44000019
         BL    SCAN                                                     44200019
         BH    ERROR                                                    44400019
         SPACE                                                          44600019
         LH    RPARM0,ABINDEX                                           44800019
         CLC   0(1,RW2),DCBHOLD2            THEN FOR FEATURES           45000019
         BNE   SCAN                                                     45200019
         SPACE 4                                                        45400019
ENDLOD1  STC   RW3,DCBDEVTP                                             45600019
         MVC   0(5,RWTGC),BTAMLOD2      MOVE BTAM LOAD 2 ID             45800019
         B     BYPASS1                                                  46000019
         SPACE 1                                                        46200019
DUPDCB   MVC   0(2,RWTGC),ZERO          NO FURTHER OPEN PROCESSING      46400019
         B     BYPASS1                                                  46600019
ANRLOAD2 MVC   0(IDTTRSZ,RWTGC),ANRLD2ID  MOVE ID OF OPEN LOAD 2        46760002
*                                  FOR 3270 INTO WTG TABLE              46820002
         B     BYPASS1             GO TO END-OF-LOAD PROCESSING         46880002
*                                                                       46940002
         SPACE                                                          46952002
BYPASS   MVC   0(5,RWTGC),STRAMID                                       47000019
BYPASS1  L     RSIZE,4(RWTGC)           LOAD ADDRESS OF WORK AREA       47200019
RELOOP   LA    RWTGC,WGOFF(RWTGC)       INCREMENT REGISTER TO    Y02947 47400002
*                                       NEXT WTG ENTRY           Y02947 47450002
         LA    RPARC,PLOFF(RPARC)       INCREMENT REGISTER TO    Y02947 47600002
*                                       NEXT COPIED DCB ADDRESS  Y02947 47650002
         CLC   0(2,RWTGC),AMIDCNST      IS THIS OPEN TO BE CALLED NEXT  47800019
         BE    0(RBASE)                 IF SO, RETURN TO BEGINNING      48000019
         CLC   0(2,RWTGC),OPIDCNST      TEST FOR END OF TABLE           48200019
         BNE   RELOOP                   IF NOT END, LOOP                48400019
         LR    RPARC,RPAR               RESTORE REGISTERS               48600019
         LA    RWTGC,WAOFF(RWTG)                                        48800019
ZCHECK   CLI   0(RWTGC),X'00'           IS IT ZERO                      49000019
         BNE   XCTLRTNE                 IF NOT, GO EXIT                 49200019
         LA    RWTGC,WGOFF(RWTGC)       INCREMENT REGISTER TO    Y02947 49400002
*                                       NEXT WTG ENTRY           Y02947 49450002
         LA    RPARC,PLOFF(RPARC)       INCREMENT REGISTER TO    Y02947 49600002
*                                       NEXT COPIED DCB ADDRESS  Y02947 49650002
         B     ZCHECK                                                   49800019
XCTLRTNE EQU   *                                                        50000019
         LR    RW1,RSIZE                                                50100002
         USING WORKAREA,RW1             WORKAREA ADDRESSABILITY  Y02947 50150002
         LA    RSIZE,DXCCW12 POINT TO DOUBLE WORK LIST                  50200002
         DROP  RW1                      DROP WORKAREA ADDRESS    Y02947 50250002
         MVC   6(2,RWTG),0(RWTGC)       MOVE ID TO NAME FIELD.          50400019
         MVC   14(3,RWTG),2(RWTGC)      MOVE TTR TO WTG TABLE.          50600019
         L     RW1,SIXT                 CVT ADDRESS              Y02947 50650002
         USING CVT,RW1                  CVT ADDRESSABILITY       Y02947 50700002
         L     RW1,CVTSVDCB             SYS1.SVCLIB DCB          Y02947 50750002
         DROP  RW1                      DROP CVT ADDRESSABILITY  Y02947 50760002
         XCTL  DE=(RWTG),SF=(E,(15)),DCB=(RW1)                   Y02947 50800002
         SPACE 4                                                        51000019
AB5      AH    RPARM1,ABINDEX           ADD ONE TO ABEND CODE           51200019
AB4      AH    RPARM1,ABINDEX           ADD ONE TO ABEND CODE           51400019
AB3      AH    RPARM1,ABINDEX           ADD ONE TO ABEND CODE           51600019
AB2      AH    RPARM1,ABINDEX           ADD ONE TO ABEND CODE           51800019
AB1      AH    RPARM1,ABINDEX           ADD ONE TO ABEND CODE           52000019
AB0      ABEND (1)                                                      52200019
         SPACE                                                          52400019
*                                 ABEND S093/94                         52600019
ERROR    AR    RPARM1,RPARM0                                     A35728 52800020
         B     AB3                                               A35728 53000020
         DS    0F                                                       53200019
         SPACE                                                          53400019
         EJECT                                                          53600019
BLNK     EQU   X'40'                    EBCDIC BLANK CHARACTER          53800019
CURNTTCB EQU   4                        OFFSET CURRENT TASK CONTROL BLK 54000019
SIXT     EQU   16                       OFFSET OF CVT            Y02947 54200002
DYNBUF   EQU   X'08'                    DYNAMIC BUFFERING BIT           55000019
ERP      EQU   X'01'                    ERP MASK                        55200019
GRAPHICS EQU   X'10'               DEVICE CLASS FOR 3270 DEVICES        55300002
IDTTRSZ  EQU   5                   LENGTH OF IDTTR                      55350002
PLOFF    EQU   4                        OFFSET OF DCB ENTRIES           55400019
STR      EQU   X'FF'                                                    55600019
TCBPKF   EQU   28                                                       55800019
TCBTIO   EQU   12                                                       56000019
TPDEVCCD EQU   X'40'                                                    56200019
UCBDVCLS EQU   18                  DISP TO DEVICE CLASS FIELD IN UCB    56300002
WAOFF    EQU   32                       OFFSET OF FIRST WTG ENTRY FROM  56400019
WGOFF    EQU   8                        OFFSET OF WTG ENTRIES           56600019
OFF1C4   EQU   X'1C4'                   DCB PROCESSED BIT OFFSET  M4840 56660002
ON       EQU   X'80'                    DCB PROCESSED BIT         M4840 56720002
TCBDEB   EQU  8                         DISPLACEMENT INTO TCB    Y02947 56770002
*                                       FOR DEB ADDRESS          Y02947 56772002
SEVEN    EQU  7                         MASK FOR STCM            Y02947 56780002
*                                       INSTR (3 BYTES)          Y02947 56790002
         EJECT                                                          56800019
TYPETAB  EQU   *              NOTE: THIS TABLE IS IN PARALLEL WITH      57000019
*                                       SPFETAB AND OFFSETAB            57200019
         DC    5X'11'         1050                                      57400019
         DC    2X'12'         1060                                      57600019
         DC    4X'13'         2740C                                     57800019
         DC   22X'14'         2740                                      58000019
         DC    2X'15'         2741P                                     58200019
         DC    3X'16'         2741C                            @ZA10016 58400000
         DC    4X'17'         1050X                                     58600019
         DC    4X'18'         2740X                                     58800019
         DC    1X'19'        2740B                                 00MC 58900020
         DC    2X'21'         1030                                      59000019
         DC    5X'31'         1050                                      59200019
         DC    4X'32'         1050X                                     59400019
         DC    1X'41'         83B3                                      59600019
         DC    1X'42'         115A                                      59800019
         DC    4X'51'         TWX                              @ZA26035 60000000
         DC    1X'61'         WTTA                                      60200019
         DC    1X'81'         2848                                      60400019
         DC    4X'95'         BSC1                                      60600019
         DC   12X'96'         BSC2                                      60800019
         DC    4X'97'         BSC3                                      61000019
         DC    X'FF'     END OF TYPETAB                                 61200019
         EJECT                                                          61400019
SPFETAB  EQU   *              NOTE: THIS TABLE IS IN PARALLEL WITH      61600019
*                                       TYPETAB AND OFFSETAB            61800019
         SPACE                                                          62000019
*                **               N/A   (6 BITS ONLY)                   62200019
*                  *          D   AUTO DIAL                             62400019
*                   *         P   AUTO POLL                             62600019
*                    *        C   CHECKING                              62800019
*                     *       A   AUTO ANSWER                           63000019
*                      *      S   STATION CONTROL  (2740)               63200019
*                       *     T   TRANSMIT CONTROL (2740)               63400019
         DC    B'00000000'         1050                                 63600019
         DC    B'00000100'                                              63800019
         DC    B'00010000'                                              64000019
         DC    B'00100000'                                              64200019
         DC    B'00100100'                                              64400019
         DC    B'00000000'         1060                                 64600019
         DC    B'00010000'                                              64800019
         SPACE                                                          65000019
         DC    B'00001000'         2740C                                65200019
         DC    B'00001100'                                              65400019
         DC    B'00101000'                                              65600019
         DC    B'00101100'                                              65800019
         DC    B'00000000'         2740                                 66000019
         DC    B'00000010'                                              66200019
         DC    B'00000100'                                              66400019
         DC    B'00000101'                                              66600019
         DC    B'00001000'                                              66800019
         DC    B'00001010'                                              67000019
         DC    B'00001011'                                              67200019
         DC    B'00001100'                                              67400019
         DC    B'00001101'                                              67600019
         DC    B'00001111'                                              67800019
         DC    B'00010010'                                              68000019
         DC    B'00011010'                                              68200019
         DC    B'00100000'                                              68400019
         DC    B'00100001'                                              68600019
         DC    B'00100100'                                              68800019
         DC    B'00100101'                                              69000019
         DC    B'00101000'                                              69200019
         DC    B'00101001'                                              69400019
         DC    B'00101011'                                              69600019
         DC    B'00101100'                                              69800019
         DC    B'00101101'                                              70000019
         DC    B'00101111'                                              70200019
         SPACE                                                          70400019
         DC    B'00000000'         2741'S (2)-PTTC                      70600019
         DC    B'00000100'                                              70800019
         DC    B'00000000'         2741'S (2)-CORRS                     71000019
         DC    B'00000010'         2741 AUTO ANSWER            @ZA04858 71100000
         DC    B'00000100'                                              71200019
         DC    B'00000000'         1050X                                71400019
         DC    B'00000100'                                              71600019
         DC    B'00100000'                                              71800019
         DC    B'00100100'                                              72000019
         DC    B'00001000'         2740X                                72200019
         DC    B'00001100'                                              72400019
         DC    B'00101000'                                              72600019
         DC    B'00101100'                                              72800019
         DC    B'00001000'                                         00MC 72900020
         DC    B'00000000'         1030'S (2)                           73000019
         DC    B'00010000'                                              73200019
         DC    B'00000000'         1050'S (5)-IBM TELL                  73400019
         DC    B'00010000'                                              73600019
         DC    B'00100100'                                              73800019
         DC    B'00000100'                                              74000019
         DC    B'00100000'                                              74200019
         DC    B'00000000'         1050X                                74400019
         DC    B'00000100'                                              74600019
         DC    B'00100000'                                              74800019
         DC    B'00100100'                                              75000019
         DC    B'00000000'         83B3'S (1)                           75200019
         DC    B'00000000'         115A'S (1)                           75400019
         DC    B'00000000'         TWX'S  (4)                  @ZA26035 75600000
         DC    B'00100100'                                              75650000
         DC    B'00000100'                                              75800019
         DC    B'00100000'                                              76000019
         DC    B'00000000'         WTTA                                 76200019
         DC    B'00000000'         2848'S (1)                           76400019
         SPACE                                                          76600019
*                **               N/A   (6 BITS ONLY)                   76800019
*                  *              AUTO DIAL   (BSC2)                    77000019
*                   *             AUTO POLL   (BSC3)                    77200019
*                    *            DUAL INTERFACE                        77400019
*                     *           AUTO ANSWER (BSC2)                    77600019
*                      *          NOT USED = 00                         77800019
*                       *         DUAL CODE                             78000019
         DC    B'00000000'         BSC1                                 78200019
         DC    B'00000001'                                              78400019
         DC    B'00001000'                                              78600019
         DC    B'00001001'                                              78800019
         DC    B'00000100'         BSC2                                 79000019
         DC    B'00000101'                                              79200019
         DC    B'00001100'                                              79400019
         DC    B'00001101'                                              79600019
         DC    B'00100000'                                              79800019
         DC    B'00100001'                                              80000019
         DC    B'00100100'                                              80200019
         DC    B'00100101'                                              80400019
         DC    B'00101000'                                              80600019
         DC    B'00101001'                                              80800019
         DC    B'00101100'                                              81000019
         DC    B'00101101'                                              81200019
         DC    B'00010000'         BSC3                                 81400019
         DC    B'00010001'                                              81600019
         DC    B'00011000'                                              81800019
         DC    B'00011001'                                              82000019
         SPACE 2                                                        82200019
         SPACE 2                                                        82400019
ABCODE   DC    0F'0',X'80090000'                                        82600019
DEBPOOL  DC    0F'0',X'E6000000'        SUBPOOL NUMBER 230       Y02947 82800002
ZERO     DC    X'0000'                                                  83000019
SIXTEEN  DC    H'16'                                                    83200019
SEVENTEN DC    H'17'                                                    83400019
ABINDEX  DC    X'1000'                                                  83600019
         SPACE 2                                                        83800019
HOLDMASK DS    0F                                                       84000019
         DC    BL.8'11111111'   0-3 IOSFLAGS, 4-7 MODEL CODE            84200019
         DC    BL.8'11111100'   8-13 FEATURES, 14-15 SAD COMMAND        84400019
         DC    BL.8'11111111'   16-23 DEVICE CLASS,                     84600019
         DC    BL.8'11110000'   24-27 ADAPTER TYPE,                     84800019
*                                    28-31 CONTROL UNIT                 85000019
OPIDCNST DC    C'0S'                    ID OF LAST OPEN LOAD.           85200019
AMIDCNST DC    C'3M'                    ID OF THIS MODULE.              85400019
UCBMVEX  MVC   0(0,RW3),16(RTIOT)       UCB MOVE INSTRUCTION            85600019
         SPACE 4                                                        85800019
BTAMLOD2 DC    C'4N'                   ID FOR SECOND OPEN LOAD MODULE   87400019
         DC    X'00000000'             TTR AND L                        87600019
STRAMID  DC    C'3W'                                                    87800019
         DC    X'00000000'                                              88000019
ANRLD2ID DC    C'4P',XL4'0'        IDTTR OFR OPEN LOAD 2 FOR 3270       88100002
         EJECT                                                          89200019
         DCBD  DSORG=BX                                                 89400019
         SPACE 2                                                        89600019
DCBHOLD1 EQU   DCBREAD+2                                                89800019
DCBHOLD2 EQU   DCBHOLD1+1                                               90000019
         EJECT                                                          90200019
        IECTDEBX                                                        90400019
         EJECT                                                   Y02947 90450002
WORKAREA DSECT                                                          90460002
         IECDSECT                                                       90520002
         EJECT                                                   Y02947 90570002
CVT      DSECT                                                   Y02947 90580002
         CVT   LIST=NO                                           Y02947 90590002
         END                                                            90600019
