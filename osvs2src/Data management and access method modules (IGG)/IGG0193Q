 TITLE 'IGG0193Q  BTAM LINE GROUP OPEN EXECUTOR - LOAD 3'               00200017
*********************************************************************** 00400002
*                                                                     * 00450002
* MODULE NAME: IGG0193Q  (OS/VS)                                      * 00460002
*                                                                     * 00470002
* DESCRIPTIVE NAME: BTAM LINE GROUP OPEN EXECUTOR - LOAD 3            * 00480002
*                                                                     * 00490002
* COPYRIGHT: NONE                                                     * 00492002
*                                                                     * 00500002
* STATUS: RELEASE 2                                                   * 00700002
*                                                                     * 01000002
* FUNCTION/OPERATION: THIS ROUTINE GETS MAIN STORAGE FOR AND INITIAL- * 01200002
*   IZES AN IOB. IT COMPLETES ANALYSIS OF DEVICE TYPE INFORMATION     * 01400002
*   PROVIDED IN THE UNIT CONTROL BLOCK TO DETERMINE WHAT TYPE OF      * 01600002
*   TERMINAL DEVICES ARE ATTACHED TO THE GROUP OF LINES THAT MAKE UP  * 01800002
*   THIS LINE GROUP. IT THEN INITIALIZES THE LINE BY EXECUTING THE    * 02000002
*   APPROPIATE SET ADDRESS, ENABLE, OR SET MODE COMMAND.              * 02050002
*                                                                     * 02200017
*                                                                     * 02400017
* ENTRY POINT: ENTRY WILL BE TO THE FIRST BYTE OF THE MODULE BY AN    * 02600002
*  'XCTL' TO IGG0193Q THE THIRD  BTAM LOAD. CONTROL WILL BE TRANSFERED* 02800017
*   FROM LOAD 2. IT MAY ALSO BE RE-ENTERED FROM THE RELOOP PORTION OF * 03000017
*   THIS ROUTINE IF IT DETERMINES THAT THERE IS ANOTHER DATA CONTROL  * 03200017
*   BLOCK TO BE OPENED.                                               * 03400017
*                                                                     * 03600017
* INPUT:  THE REGISTERS 5, 6, 7, AND 8 ARE THE INPUT, AS FOLLOWS,     * 03800002
*   5- THE ADDRESS OF THE FIRST ENTRY IN THE COPIED DCB PARAMETER LIST* 04000002
*   6- THE ADDRESS OF THE BEGINNING OF THE WHERE-TO-GO TABLE,         * 04200002
*   7- THE ADDRESS OF THE CURRENT ENTRY IN THE COPIED DCB PARAMETER   * 04400002
*      LIST,                                                          * 04450002
*   8- THE ADDRESS OF THE CURRENT EXECUTOR'S ENTRY IN THE WHERE-TO-GO * 04600002
*      TABLE.                                                         * 04800017
*                                                                     * 05400017
*                                                                     * 05600017
* OUTPUT: THE REGISTERS 7 AND 8 WILL BE POSITIONED AT THE NEXT ENTRIES* 05800002
*   IN THE DCB PARAMETER LIST AND THE WHERE-TO TABLE. ONE IOB PER LINE* 06000017
*   WILL HAVE BEEN CONSTRUCTED IN SUBPOOL 250 IN THE USER'S KEY.      * 06200002
*   IF DYNAMIC BUFFERING WAS SPECIFIED AND VIRTUAL=VIRTUAL, ONE       * 06210002
*   VIRTUAL SUBAREA LIST AND TWO INDIRECT ADDRESSING LISTS WILL       * 06220002
*   BE OBTAINED FROM SUBPOOL 250 IN THE USER'S KEY FOR EACH IOB       * 06230002
*   IN THE LINE GROUP. DCB FIELDS (DEVTP, IOBAD, EIOBX,               * 06240002
*   IFLGS, DEBAD, AND READ/WRITE WILL HAVE BEEN INITIALIZED.          * 06400002
*   THIS EXECUTOR'S ENTRY (OR ENTRIES) IN THE WHERE-TO-               * 06600002
*   GO TABLE WILL HAVE BEEN UPDATED TO IDENTIFY LOAD 4 (IGG0193S).    * 06800017
*                                                                     * 07000017
* EXTERNAL ROUTINES: NONE                                             * 07200002
*                                                                     * 07400017
* EXITS-NORMAL:  THIS ROUTINE EXITS VIA AN XCTL TO THE MODULE         * 07600002
*   IDENTIFIED BY THE NEXT NON-ZERO ENTRY IN THE WHERE-TO-GO TABLE,   * 07800017
*   NAMELY IGG0193S (BTAM OPEN EXECUTOR - LOAD 4).                    * 08000017
*                                                                     * 08200017
* EXIT-ERRORS:                                                        * 08400002
*     -ERRORS-  THIS ROUTINE EXITS VIA ABEND FOR THE FOLLOWING        * 08600017
*   ERROR CONDITIONS-                                                 * 08800017
*   ABEND CODE ERROR CONDITION                                        * 09000017
*   00098000    DUAL COMMUNICATION INTERFACE B OR DUAL CODE FEATURE   * 09150002
*               B WAS NOT SPECIFIED IN THE UCB.                       * 09160002
*                                                                     * 09200017
* TABLES/WORK AREAS: 1.DCB PARAMETER LIST CONTAINS THE ADDRESS OF EACH* 09400002
*  DCB SPECIFIED IN THE OPEN MACRO INSTRUCTION. 2. THE WHERE-TO-GO    * 09600017
*  TABLE CONTAINS THE ID AND TTR OF THE ROUTINE NEEDED TO PROCESS THE * 09800017
*  DCB WHICH CORRESPONDS TO THIS ENTRY.                               * 10000002
*                                                                     * 10050002
* NOTES: FOR SECURITY AND INTEGRITY PURPOSES, OPEN PROCESSING WILL    * 10100002
*  BE ONLY ON THE COPIED DCB AND COPIED DCB PARAMETER LIST. BTAM      * 10150002
*  OPEN LOADS MUST KEEP THE USER DCB AND THE COPIED DCB               * 10160002
*  SYNCHRONIZED. UPON COMPLETION OF THIS MODULE, CONTROL IS PASSED    * 10170002
*  TO THE FOURTH OPEN MODULE THROUGH THE WHERE-TO-GO TABLE ENTRY.     * 10180002
*  BEFORE ISSUEING THE I/O TO INITIALIZE THE LINE, THE COPIED DCB     * 10182002
*  WILL BE MAPPED TO THE USER'S DCB.                                  * 10184002
*                                                                     * 10190002
* CHANGE ACTIVITY AS FOLLOWS:                                         * 10190402
*            APARS                           PTMS                     * 10190802
*       YA01249  (10/1/73)               YM4084  (10/29/73)           * 10191202
*       YA01260  (10/1/73)               YM5663  (12/12/73) PROLOG    * 10191602
*       YA02168  (N/A)                   YM5668  (12/14/73) IECRES    * 10191702
*       YA02172  (10/5/73)                                            * 10191802
*       ZA00535  (11/15/74)        ZA00544  (11/15/74)                * 10211800
*       ZA03207  (03/24/75)        ZA03589  (03/20/75)                * 10241800
*       AZ04187  (10/06/75)        AZ04865  (10/14/75)                * 10246800
*       AZ06399  (12/19/75)                                           * 10251800
*       AZ07636  (11/10/75)                                           * 10256800
*       AZ08051  (01/29/76)                                           * 10261800
*       AZ09356  (04/05/76) - DELETED APARS AZ04187 & AZ04865           10263800
*       AZ11430  (06/09/76)                                             10264800
*       AZ13169  (09/03/76)                                           * 10266800
*                                                                     * 10276800
*********************************************************************** 10283800
         EJECT                                                          10600017
IGG0193Q CSECT                                                          10650002
         SPACE 5                                                        10700002
RE       EQU   0                       WORK/PARAMREG                    10800017
RF       EQU   1                       WORK/PARAMREG                    11000017
RDCB     EQU   2                       COPIED DCB ADDRESS        Y02947 11200002
RBASE    EQU   3                       BASE REGISTER                    11400017
RCORE    EQU   4                       IOB ADDRESS                      11600017
RPAR     EQU   5                       START OF COPIED DCB       Y02947 11800002
*                                      PARAMETER LIST            Y02947 11850002
RWTG     EQU   6                       START OF WTG                     12000017
RPARC    EQU   7                       CURRENT ENTRY IN COPIED   Y02947 12200002
*                                      DCB PARAMETER LIST        Y02947 12250002
RWTGC    EQU   8                       CURRENT ENTRY IN WTG TABLE       12400017
RTIOT    EQU   9                       TIOT ADDRESS                     12600017
VSLREG   EQU   RTIOT                   VIRTUAL SUBAREA LIST      Y20947 12650002
*                                      ADDRESS                   Y02947 12700002
RUCB     EQU   10                      CURRENT UCB                      12800017
IOBNUM   EQU   RUCB                    NUMBER OF IOB'S           Y02947 12850002
RDEB     EQU   11                      DEB ADDRESS                      13000017
IDALREG  EQU   RDEB                    INDIRECT ADDRESSING LIST  Y02947 13050002
RB       EQU   12                      WORK REG                         13200017
RC       EQU   13                      WORK REG                         13400017
RD       EQU   14                      WORK/PARAMREG                    13600017
RJ       EQU   15                      WORK/PARAMREG                    13800017
TCBREG   EQU   RJ                      TCB ADDRESS               Y02947 13850002
         SPACE 3                                                        14000017
         USING IECTIOB,RCORE                                            14200017
         USING IHADCB,RDCB                                              14400017
         USING IECTDEB,RDEB                                             14600017
         BALR  RBASE,0                                                  14800017
         USING *,RBASE                                                  15000017
         SPACE 4                                                 Y02947 15050002
         B     AROUND                   BRANCH AROUND ID         Y02947 15100002
         DC    C'IGG0193Q'              OPEN ID                  Y02947 15150002
         DC    C'** MVS *'                                       Y02947 15151000
         DC    C'&SYSDATE'         DATE LAST ASSEMBLY       LD @ZA00544 15152803
PATCH    DC    XL90'00'                PATCH AREA                Y02947 15156002
         DS    0H                                                       15158000
         SPACE 4                                                 Y02947 15160002
AROUND   L     RDCB,0(RPARC)           ESTABLISH COPIED DCB ADDR Y02947 15200002
         L     RDEB,DCBDEBAD            ACCESS POINTER TO DEB    Y02947 15400002
         L     RDEB,28(RDEB)            LOAD DEB START FOR DSECT   000D 15600017
         L     RUCB,DEBUCBAD           GET UCB ADDRESS             000M 15610019
         TM    19(RUCB),X'90'          IS THIS A BSC DEVICE        000M 15620019
         BNO   TSTRETRY                                            000M 15630019
         MVC   92(4,RDCB),DCBBSTSX      SAVE IRB ENTRY POINT       000M 15640019
         SR    RF,RF               CLEAR REGISTER                  000M 15650019
         TM    DCBXCODE,USASCII    ASCII CODE TO BE USED           000M 15660019
         BO    ASCII               IF SO, BRANCH                   000M 15670019
         TM    DCBXCODE,TRANSCD    SIX BIT CODE TO BE USED         000M 15680019
         BO    SIXBIT              IF SO, BRANCH                   000M 15690019
         LA    RF,TBLOFFST(RF)     ADD OFFSET TO CORRECT TABLE     000M 15700019
SIXBIT   LA    RF,TBLOFFST(RF)     ADD OFFSET TO CORRECT TABLE     000M 15710019
ASCII    LA    RF,CHARTBL(RF)      GET ADDRESS OF CHAR TABLE       000M 15720019
         MVC   DCBBSRSV(TBLOFFST),0(RF)   MOVE IN CONTROL CHARS    000M 15730019
         EJECT                                                     000M 15740019
TSTRETRY EQU   *                                                   000M 15750019
         SR    RTIOT,RTIOT                                              15800017
         IC    RTIOT,DCBDEVTP           LOAD DEVICE OFFSET              16000017
         LM    RE,RF,RETRYMSK           GET RETRY MASK                  19800017
         SLDL  RE,0(RTIOT)              POSITION BIT               4113 20000017
         LTR   RE,RE                    TEST SIGN BIT                   20200017
         BM    IOBST1                   RETRYS ARE POSIBLE              20400017
         NI    DCBERROP,ALLON-RDRETRY                                   20600017
         EJECT                                                          20800017
IOBST1   SR    RC,RC                                               000D 21000017
         IC    RC,SZTABLE(RTIOT)        SET NORMAL SIZE            000D 21200017
         TM    DCBBFTEK,DYNBUF    BIT 4 ON INDICATES DYN BUFFERING      21400017
         BZ    SETSIZE                  IF NOT, BRANCH             000D 21600017
         LA    RC,24(RC)                ADD 24 FOR 3 CCW'S         000D 21800017
         SPACE 1                                                 Y02947 21810002
* 6 LINES OF CODE DELETED BY APAR ---------------------------- @ZA13169 21850000
         SPACE 1                                                 Y02947 21994002
SETSIZE  LA    RC,64(RC)                ADD BASIC IOB SIZE         000D 22000017
         TM    19(RUCB),X'90'      BSC DEVICE?                  YA01260 22050002
         BO    YESBSC              YES, CONTINUE                YA01260 22100002
         LA    RC,L32(RC)           NO, EXTEND IOB FOR         @ZA06399 22120000
*                                  START STOP SPECIAL CHARS     YA01260 22160002
YESBSC   EQU   *                                                YA01260 22170002
         STC   RC,DCBEIOBX              STORE IOB SIZE IN IOB      000D 22200017
         LA    RF,4(RC)                 INCREASE IOB SIZE BY 4 @ZA03207 22300000
*    FOR THE ERP EXTENSION. THERE IS ONE ERP EXT ENTRY PER IOB @ZA03207 22450000
         SR    RB,RB                    CLEAR REGISTER             000D 22600017
         IC    RB,DEBNMEXT              LOAD NUMBER OF IOB'S       000D 22800017
         MR    RE,RB                    MULTIPLY SIZE BY NO OF IOB 000: 23000017
         LA    RF,4(RF)                 ADD 4 MORE SINCE THE   @ZA03207 23020000
*                      0TH ENTRY OF THE ERP EXTENSION WILL     @ZA03207 23050000
*                      CONTAIN THE ADDR OF THE TRANSLATOR.     @ZA03207 23100000
*                      ALL OTHER ENTRIES CORRESPOND TO THEIR   @ZA03207 23150000
*                      RLN'S.                                  @ZA03207 23160000
         LR    RE,RF                    LOAD PRODUCT INTO REG 0    000D 23200017
         O     RE,IOBPOOL               OR IN SUBPOOL NUMBER       000E 23400017
         L     RJ,4(RWTGC)              ADDRESS OF OPEN WORKAREA Y02947 23450002
         USING WORKAREA,RJ              WORKAREA ADDRESSABILITY  Y02947 23500002
         SPACE 1                                                 Y02947 23510002
         MODESET KEYADDR=DXUKEY,WORKREG=14   ASSUME USER KEY     Y02947 23550002
         SPACE 1                                                 Y02947 23560002
*    GET CORE FOR IOB'S FROM SUBPOOL 250                         Y02947 23570002
         GETMAIN R,LV=(0)               GET CORE FOR THE IOB'S     000D 23600017
         SPACE 1                                                 Y02947 23650002
         LR    RCORE,RF                 LOAD THE ADDRESS OF THE IOB000D 24000017
         SR    RCORE,RC                 SUB IOB SIZE               000D 24200017
         SPACE 1                                                 Y02947 24210002
         MODESET EXTKEY=DATAMGT         BACK TO DATA MGT KEY     Y02947 24250002
         SPACE 1                                                 Y02947 24300002
         ST    RCORE,DCBIOBAD           STORE IOB ADRS MINUS SIZE  000D 24400017
         STC   RTIOT,DCBDEVTP           STORE DEVICE TYPE          000D 24600017
         L     RJ,DISP4(RWTGC)          RESTORE WORKAREA ADDR    Y02947 24610002
         SPACE 1                                                 Y02947 24650002
         MODESET KEYADDR=DXUKEY,WORKREG=14  ASSUME USER KEY      Y02947 24700002
         SPACE 1                                                 Y02947 24750002
         SR    RD,RD                    RESET REGISTER FOR RLN CNT 000D 24800017
         BCTR  RC,0                     SUBTRACT 1 FOR EXECUTE INST000D 25000017
STARTLP  LA    RCORE,1(RC,RCORE)        STEP IOB ADDRESS           000D 25200017
         EX    RC,CLEAR                 CLEAR IOB                  000D 25400017
         MVI   IOBFLAG1,X'C2'           SET BITS 0,1 AND 6 FOR BTAM000D 25600017
         LA    RF,IOBCPA                LOAD THE CHANNEL PROGRAM AD000D 25800017
         ST    RF,IOBSTART              STORE IN IOBSTART          000D 26000017
         MVC   IOBDCBPT(4),DXUDCBAD     USER'S DCB ADDR TO IOB   Y02947 26200002
         STC   RD,IOBUCBX               STORE RELATIVE LINE NUMBER 000D 26400017
         LA    RD,1(RD)                 ADD 1                      000D 26600017
         BCT   RB,STARTLP               DECREMENT & TEST IOB COUNT 000D 26800017
         LA    RCORE,1(RC,RCORE)        ADDR OF ERP EXT OR     @ZA03207 26805000
*                            ADDR OF END OF IOB'S              @ZA03207 26810000
         IC    RB,DEBNMEXT              GET NUMBER OF IOB'S    @ZA03207 26820000
         LA    RB,1(RB)                 THIS ENTRY IS FOR THE  @ZA03207 26830000
*                           ADDR OF THE TRANSLATOR (IECVTCCW)  @ZA03207 26832000
         SLL   RB,2                     MULTIPLY BY 4, THE     @ZA03207 26834000
*                      LENGTH OF EACH ENTRY IN THE ERP EXT     @ZA03207 26840000
         BCTR  RB,0                     DECREMENT BY 1 FOR     @ZA03207 26842000
*                      THE EXECUTE INSTRUCTION                 @ZA03207 26844000
         EX    RB,CLEAR                 CLEAR ALL ENTRIES IN   @ZA03207 26846000
*                      THE ERP EXTENSION                       @ZA03207 26848000
* 79 LINES OF CODE DELETED BY APAR --------------------------- @ZA13169 27188100
NODBEXT  EQU   *                                                 Y02947 27308002
         LA    RUCB,DEBUCBAD            GET ADRS OF UCB LIST       000E 27310402
         L     RUCB,0(RUCB)             GET ADRS OF UCB            000E 27312802
         CLI   DCBDEVTP,INTR1                                      000I 27315202
         BE    IRBPNT                                              000I 27317602
         CLI   DCBDEVTP,INTR2                                      000I 27320018
         BE    IRBPNT                                              000I 27360018
         TM    19(RUCB),X'90'           THIS A BISYNCH DEVICE      000E 27400017
         BNO   TSTONLT                  IF NOT, BRANCH             000E 27600017
         TM    DCBXCODE,GRAPHMSK        1130/2250 GRAPHICS         000E 27800017
         BO    IRBPNT                   IF SO, IRB POINTERS NEEDED 000E 28000017
TSTONLT  TM    DCBERROP,TRMTST          ONLINE TEST REQUESTED      000E 28200017
         BNO   NOPNTRS                  NO POINTERS NEEDED         000E 28400017
         SPACE 1                                                 Y02947 28450002
IRBPNT   MODESET EXTKEY=ZERO           KEY OF ZERO               Y02947 28500002
         SPACE 1                                                 Y02947 28550002
         LA    RE,16                    INDICATE NUMBER OF BYTES   000E 28600002
         O     RE,IOBPOOL               OR IN SUBPOOL NUMBER       000E 28800017
         SPACE 1                                                 Y02947 28850002
*    GET CORE FOR IRB'S FROM SUBPOOL 250                         Y02947 28900002
         GETMAIN  R,LV=(0)              GET CORE FOR POINTERS      000E 29000017
         SPACE 1                                                 Y02947 29010002
         XC    0(12,RF),0(RF)           CLEAR AREA                 000E 29020002
* 4 LINES OF CODE DELETED BY APAR ---------------------------- @ZA13169 29023000
         SPACE 1                                                 Y02947 29040002
         MODESET EXTKEY=DATAMGT         BACK TO DATA MGT KEY     Y02947 29050002
         SPACE 1                                                 Y02947 29100002
         ST    RF,DEBIRBAD-1            STORE ADDRESS IN DEB       000E 29200017
         L     RJ,DISP4(RWTGC)          WORKAREA ADDRESS         Y02947 29210002
         USING WORKAREA,RJ              WORKAREA ADDRESSABILITY  Y02947 29220002
         SPACE 1                                                 Y02947 29250002
         MODESET KEYADDR=DXUKEY,WORKREG=14  ASSUME USER KEY      Y02947 29300002
         SPACE 1                                                 Y02947 29310002
         DROP  RJ                       DROP WORKAREA ADDRESS    Y02947 29350002
         EJECT                                                          30000017
*                   INITIALIZE THE LINES WITH A SET MODE, SAD AND/OR    30200017
*                   AN ENABLE COMMAND AS APPROPRIATE                    30400017
         SPACE 3                                                        30600017
NOPNTRS  LA    RD,DEBUCBAD              POINT TO TABLE OF UCB      000E 30800017
*                                  ADDRESSES.                           31000017
         L     RCORE,DCBIOBAD           CALCULATE ADDRESS OF FIRST IOB. 31200017
         SR    RB,RB                                                    31400017
         IC    RB,DCBEIOBX                                              31600017
         AR    RCORE,RB                                                 31800017
         SR    RC,RC                    LOAD NUMBER OF EXTENTS TO BE    32000017
         IC    RC,DEBNMEXT         USED AS A LOOP COUNTER.              32200017
*    *    *    *    *    *    *    *    *    *    *    *    *    *    * 32400017
SADTEST  L     RUCB,0(RD)               LOAD UCB ADDRESS.               32600017
         TM    19(RUCB),X'90'           TEST FOR BXC (VIA ADAPTER TYPE( 32800017
         BNO   NOTBSC                   IF NOT BSC, BRANCH              33000017
CHKTCU   TM    19(RUCB),X'03'           TEST FOR 2703 T C U        000D 33200017
         BO SETMODE                     IF SO, NO FURTHER TESTS         33400017
         TM    DCBXMODE,DATAB           TEST FOR DATA INTERFACE B       33600017
         BZ    TESTCODE                 IF NOT SPECIFIED GO TEST CODE   33800017
         TM    17(RUCB),DATAB           IF SOK IS IT LEGAL              34000017
         BZ    AB7                      NO, ABEND              @ZA07636 34050000
TESTCODE TM    DCBXMODE,CODEB           TEST FOR TRANSMISSION CODE B    34400017
         BZ    SETMODE                  IF NOT SPECIFIED GO SET MODE    34600017
         TM    17(RUCB),CODEBUCB        IF SO, IS IT LEGAL              34800017
         BZ    AB7                      IF NOT, ABEND                   35000017
SETMODE  L     RJ,IOBDCBPT             GET DCB ADDR FROM IOB     YM4084 35050002
         LA    RJ,DCBXMODE-IHADCB(RJ)  GET ADDRESS OF MODE BYTE  YM4084 35200002
*                                      IN USER DCB               YM4084 35250002
         MVC   IOBCPA+8(8),ENABLE      MOVE IN SETMODE/SAD CCW   A26896 35300019
         MVI   IOBCPA,DISABLE          MOVE IN COMMAND CODE      A26896 35500019
         MVC   IOBCPA+1(7),ENABLE+1    COMPLETE CCW              A26896 35600019
         OI    IOBCPA+4,CMDCHAIN       CHAIN DISABLE TO SET MODE A26896 35700019
         TM    19(RUCB),X'90'          TEST FOR BSC              A26896 35720019
         BNO   SADRTNE                 IF NOT, BRANCH            A26896 35740019
         ST    RJ,IOBCPA+8             STORE MODE IN CCW         A26896 35760019
         MVI   IOBCPA+8,SETMODCM       MOVE IN COMMAND CODE      A26896 35800019
         B     TESTAA                                                   36000017
AB7      L     1,ERR7                                                   36200017
         ABEND (1)                                                      36400017
NOTBSC   TM    19(RUCB),X'01'           TEST FOR 2702/3                 36600017
         BZ    ENABCTL                                                  36800017
         TM    19(RUCB),X'0C'                                           37000017
         BZ    SETMODE                                           A26896 37200019
ENABCTL  MVC   IOBCPA(8),ENABLE         SET ENABLE CCW IN CHAN PGA30747 37400020
         TM    17(RUCB),X'90'           AUTO CALL OR AUTO ANSR   A30747 37600020
         BNZ   SETNOP                   BRANCH IF EITHER         A30747 37800020
         CLI   19(RUCB),X'82'           TEST FOR 2701 W/ TYPE 3 ADPTR   38000017
         BNE   EXCP                     NO, BRANCH               A30747 38200020
SETNOP   MVI   IOBCPA,X'03'             MOVE IN NOP COMMAND CODE A30747 38400020
         B     EXCP                                                     38600017
SADRTNE  SR    RDCB,RDCB                CLEAR REGISTER AND SET UP       38800017
         IC    RDCB,17(RUCB)       SAD COMMAND CODE.                    39000017
         N     RDCB,ANDMASK                                             39200017
         IC    RTIOT,SADCCODE(RDCB)     INSERT ACTUAL COMMAND CODE AND  39400017
         STC   RTIOT,IOBCPA+8          STORE IN IOB              A26896 39800019
TESTAA   TM    17(RUCB),X'90'           TEST FOR AUTO-CALL OR ANSWER    40200017
         BNZ   EXCP                     IF EITHER PRESENT, DO NOT ENABL 40400017
         MVC   IOBCPA+16(8),ENABLE     MOVE IN ENABLE COMMAND    A26896 40600019
         OI    IOBCPA+12,CMDCHAIN      CHAIN SETMODE TO ENABLE   A26896 40800019
*                                  TO SAD COMMAND.                      41000017
EXCP     EQU   *                                                 Y02947 41080002
         LA    RE,SIXTY                 MESSAGE AREA LENGTH      Y02947 41130002
         O     RE,POOLNUM               SUBPOOL 250              Y02947 41180002
         SPACE 1                                                 Y02947 41190002
         GETMAIN R,LV=(0)               GET CORE FOR MSG AREA    Y02947 41230002
         SPACE 1                                                 Y02947 41232002
         LR    RTIOT,RF                 LOAD BASE FOR MSG AREA   Y02947 41240002
         USING REPLYLTH,RTIOT           MSG AREA ADDRESSABILITY  Y02947 41280002
         ST    RTIOT,IOBCPA+32         ST ADD OF AREA IN IOB     A28619 41400019
         MVI   IOBCPA+32,X'FF'         SET FLAG FOR MSGWTR       A29575 41480019
         MVI   REPLYLTH,ZERO           SET REPLY LENGTH FIELD    Y02947 41690002
*                                      TO ZERO. THE ERP'S WILL   Y02947 41740002
*                                      CHANGE THIS FIELD TO      Y02947 41790002
*                                      REPLY LENGTH IF WE MUST   Y02947 41840002
*                                      ISSUE WTOR                Y02947 41842002
         SPACE 1                                                 Y02947 41850002
         MODESET EXTKEY=DATAMGT        DATAMGT KEY               Y02947 41900002
         LR    RF,RCORE                SAVE IOB ADDRESS          Y02947 41910002
         L     RCORE,DISP4(RWTGC)      WORK AREA ADDRESS         Y02947 41920002
         SPACE 1                                                 Y02947 41950002
         USING WTG,RWTG                 WTG ADDRESSABILITY       Y02947 41970002
         L     RJ,WTGPREFX              WTG PREFIX ADDRESS       Y02947 41980002
         STM   RE,RD,IECREGSV-IECPREFX(RJ) SAVE REGS             Y02947 41990002
         IECRES INIT,DCBCOPY=FRWKAR                              Y02947 41992002
         LR    RJ,RWTG                 REG SAVEAREA ADDR         YM5668 41992402
         LM    RE,RD,IECREGSV-IECPREFX(RJ) RESTORE REGS          Y02947 41994002
         LR    RCORE,RF                RESTORE IOB ADDRESS       Y02947 41994402
         DROP  RWTG                     DROP WTG ADDRESS         Y02947 41996002
         USING WORKAREA,RJ              WORKAREA ADDRESSABILITY  Y02947 41998002
         L     RJ,4(RWTGC)              WORKAREA ADDRESS         Y02947 41998402
         SPACE 1                                                 Y02947 41998802
         MODESET KEYADDR=DXUKEY,WORKREG=1     USER KEY           Y02947 41999202
         SPACE 1                                                 Y02947 41999602
         DROP  RJ                       DROP WORKAREA ADDRESS    Y02947 42049602
RETRY    EQU   *                                                 Y02947 42099602
         LA    RJ,IOBERCCW                                       Y02947 42109602
         ST    RJ,IOBECBPT              STORE ECB ADDRESS IN IOB Y02947 42119602
         LA    1,IOBFLAG1               LOAD IOB ADDRESS.               42149602
         EXCP  (1)                                                      42200017
         MVI   IOBINCAM+1,X'00'         SET BYTE TO ZERO           000E 42400017
         MVC   IOBCPA+36(TIMELNG),TIME  MOVE TIME VALUE        @ZA11430 42405000
         SPACE 1                                                 Y02947 42450002
STIMER   STIMER  WAIT,BINTVL=IOBCPA+36 WAIT ONE HALF SECOND LD @ZA11430 42600000
         SPACE 1                                                 Y02947 42650002
         L     1,IOBECBPT               LOAD POINTER TO IOB        000E 42800017
         TM    IOBFLAG1,X'24'           IS ERP IN CONTROL               42860017
         BO    STIMER                   WAIT FOR ERP TO COMPLETE        42920017
         TM    0(1),X'7F'               IS ECB POSTED              000E 43000017
         BNZ   POSTED                   BRANCH IF YES              000E 43200017
         CLI   IOBINCAM+1,X'0D'        HAS COUNT REACHED MAX 7   A26896 43400019
         BNL   PURGE                   YES, PURGE I/O       LD @ZA00535 43600003
         IC    RF,IOBINCAM+1            GET TIMER COUNT            000E 43800017
         LA    RF,1(RF)                 UPDATE COUNT               000E 44000017
         STC   RF,IOBINCAM+1            STORE TIMER COUNT          000E 44200017
         B     STIMER                                              000E 44400017
POSTED   CLI   0(1),X'7F'               TEST FOR NORMAL COMPLETION 000E 44600017
         BE    NORMALCP                                          A29575 44700019
         CLI   REPLYLTH,ZERO           ERP HAD CONTROL?          Y02947 44810002
         BE    SETERR                  NO, MSGWTOR NOT NEEDED    A27612 44820019
WTOR     EQU   *                                                 Y02947 44850002
         LR    RF,RTIOT                MSG AREA ADDRESS ADDR     Y02947 44860002
         MVI   REPLY+DISP8,ZERO        SET COMPLETION FLAG OFF   Y02947 44870002
*                                      THE 3RD WORD OF THE REPLY Y02947 44880002
*                                      AREA IS THE ECB           Y02947 44882002
         SPACE 3                                                 Y02947 44898802
         WTOR  MF=(E,(1))              WRITE CONTROL UNIT NOT OP A27612 44900019
         SPACE 3                                                 Y02947 44902002
         WAIT  ECB=REPLY+DISP8         WAIT FOR REPLY            Y02947 44910002
         SPACE 1                                                 Y02947 44912002
         CLC   REPLY(4),CONT           RETRY REQUESTED           A27612 44920019
         BE    RETRY                                             A27612 44930019
         CLC   REPLY(4),POST           LINE IDLE REQUESTED       A27612 44940019
         BNE   WTOR                    INVALID RESPONSE, RETRY MEA27612 44950019
         B     SETERR                                       LD @ZA00535 44960003
*                                                                       44970002
PURGE    EQU   *                                            LD @ZA00535 44980003
         MODESET EXTKEY=DATAMGT    DATA MANAGEMENT KEY      LD @ZA00535 44990003
         L     RJ,DISP4(RWTGC)     OPEN WORKAREA ADDR       LD @ZA00535 44992003
         USING WORKAREA,RJ         WORKAREA ADDRESSABILITY  LD @ZA00535 44994003
         XC    DXCCW(TWELVE),DXCCW CLEAR PURGE PARM LIST    LD @ZA00535 44996003
         LA    RDEB,HEX24(RDEB)        POINT TO DEB LOC'0'  L5 @ZA03589 44996200
         ST    RDEB,DXCCW          DEB ADDR IN PARM LIST    LD @ZA00535 44998003
         MVI   DXCCW,PURGEOPT      HALT I/O OPTION          LD @ZA00535 44998403
         PURGE DXCCW                                        LD @ZA00535 44998803
         L     RJ,DISP4(RWTGC)     OPEN WORKAREA ADDR       LD @ZA00535 44999000
         L     RDEB,28(RDEB)       LOAD DEB START FOR DSECT L5 @ZA03589 44999200
         MODESET KEYADDR=DXUKEY,WORKREG=15  USER'S KEY      LD @ZA00535 44999603
SETERR   OI    IOBINCAM,SADENER         SET ERROR FLAG IN IOB      000E 45000017
NORMALCP EQU   *                                                 Y02947 45100002
         LR    RF,RTIOT                MSG AREA ADDRESS          Y02947 45150002
         LA    RE,SIXTY                MSG AREA LENGTH           Y02947 45200002
         O     RE,POOLNUM              SUBPOOL 250               Y02947 45250002
         SPACE 1                                                 Y02947 45260002
         FREEMAIN R,LV=(0),A=(1)       FREE MSG AREA             Y02947 45300002
         SPACE 1                                                 Y02947 45310002
         XC    IOBCPA+32(4),IOBCPA+32  CLEAR WORKAREA IN IOB     A28619 45340019
SADLPCHK MVI   IOBINCAM+1,X'00'                                  A29575 45360019
         LA    RCORE,0(RB,RCORE)                                   000E 45400017
         LA    RD,4(RD)                 GET ADDRESS OF NEXT ENTRY IN    45600017
*                                  TABLE OF UCB ADDRESSES.              45800017
         BCT   RC,SADTEST               RETURN TO SADTEST IF ALL LINES  46000017
*                                  HAVE NOT YET BEEN INITIALIZED.       46200017
         DROP  RTIOT                   DROP MSG AREA ADDRESS     Y02947 46250002
         SPACE 3                                                        48800017
         EJECT                                                          49000017
ENDLOD2  EQU   *                                                 Y02947 49050002
         SPACE 1                                                 Y02947 49060002
         MODESET EXTKEY=DATAMGT         BACK TO DATA MGT KEY     Y02947 49100002
         SPACE 1                                                 Y02947 49150002
         MVC   0(5,RWTGC),BTAMLOD4      SET UP ID FOR LOAD 4 OF  Y02947 49200002
*                                       BTAM EXECUTOR.           Y02947 49400002
         L     RJ,4(RWTGC)                                              49600017
         USING WORKAREA,RJ              WORKAREA ADDRESSABILITY  Y02947 49650002
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURRENT WTG REGISTER. 49800017
         LA    RPARC,PLOFF(0,RPARC)     INCREMENT CURRENT PARAMETER     50000017
*                                  LIST REGISTER TO NEXT ENTRY.         50200017
         CLC   0(2,RWTGC),AMIDCNST      IF THE NEXT WTG ENTRY CALLS FOR 50400017
         BCR   8,RBASE             THIS EXECUTOR, RETURN TO BEGINNING.  50600017
         CLC   0(2,RWTGC),OPIDCNST      IF NOT, TEST FOR END OF TABLE.  50800017
         BNE   RELOOP              NOT END OF TABLE, RETURN TO CHECK    51000017
*                                  NEXT ENTRY.                          51200017
         LR    RPARC,RPAR               REINITIALIZE CURRENT WTG REG    51400017
         LA    RWTGC,WAOFF(0,RWTG) AND CURRENT PARAMETER LIST REG.      51600017
ZCHECK   CLI   0(RWTGC),X'00'                                           51800017
         BNE   XCTLRTNE            IF NOT ZERO, GO TO TRANSFER CONTROL  52000017
         LA    RWTGC,WGOFF(0,RWTGC) IF ZERO, GET NEXT ENTRY AND RETURN  52200017
         LA    RPARC,PLOFF(0,RPARC) TO ZCHECK.                          52400017
         B     ZCHECK                                                   52600017
         SPACE 3                                                        52800017
XCTLRTNE EQU   *                                                        53000017
         LA    RJ,DXCCW12               ADDR DOUBLE WORD LIST    Y02947 53200002
         MVC   6(2,RWTG),0(RWTGC)       MOVE ID TO NAME FIELD.          53400017
         MVC   14(3,RWTG),2(RWTGC)      MOVE TTR TO WTG TABLE.          53600017
         DROP  RJ                       DROP WORKAREA ADDRESS    Y02947 53650002
         L     RC,SIXT                  CVT ADDRESS              Y02947 53700002
         USING CVT,RC                   CVT ADDRESSABILITY       Y02947 53750002
         L     RC,CVTSVDCB              SYS1.SVCLIB DCB          Y02947 53760002
         DROP  RC                       DROP CVT ADDRESS         Y02947 53770002
         XCTL  DE=(RWTG),SF=(E,(15)),DCB=(RC)                    Y02947 53800002
         EJECT                                                          54000017
SZTABLE  EQU   *                                                        54100019
         SPACE 1                                                        54200019
         DC    AL1(S8)   00        1050                                 54300019
         DC    AL1(S9)   01             P                               54400019
         DC    AL1(SB)   02             AD                              54500019
         DC    AL1(SA)   03             A                               54600019
         DC    AL1(SB)   04             D                               54700019
         SPACE 1                                                        54800019
         DC    AL1(S5)   05        2740                                 54900019
         DC    AL1(S8)   06             AD                              55000019
         DC    AL1(S6)   07             A                               55100019
         DC    AL1(S7)   08             D                               55200019
         DC    AL1(S8)   09             ACDX                            55300019
         DC    AL1(S8)   0A             ACX                             55400019
         DC    AL1(S8)   0B             CDX                             55500019
         DC    AL1(S8)   0C             ADX                             55600019
         DC    AL1(S8)   0D             AX                              55700019
         DC    AL1(S8)   0E             DX                              55800019
         DC    AL1(S8)   0F             ACD                             55900019
         DC    AL1(S6)   10             AC                              56000019
         DC    AL1(S8)   11             CD                              56100019
         DC    AL1(S9)   12             CPS                             56200019
         DC    AL1(S8)   13             CS                              56300019
         DC    AL1(S8)   14             PS                              56400019
         DC    AL1(S7)   15             S                               56500019
         DC    AL1(S6)   16             C                               56600019
         SPACE 1                                                        56700019
         DC    AL1(S7)   17        1060                                 56800019
         DC    AL1(S9)   18             P                               56900019
         SPACE 1                                                        57000019
         DC    AL1(S8)   19        1030                                 57100019
         DC    AL1(S9)   1A             P                               57200019
         SPACE 1                                                        57300019
         DC    AL1(S6)   1B        83B3                                 57400019
         DC    AL1(S0)   1C             TT                              57500019
         SPACE 1                                                        57600019
         DC    AL1(S5)   1D        115A                                 57700019
         DC    AL1(S0)   1E             TT                              57800019
         SPACE 1                                                        57900019
         DC    AL1(S7)   1F        TWX  A                               58000019
         DC    AL1(S7)   20             AD                              58100019
         DC    AL1(S7)   21             D                               58200019
         SPACE 1                                                        58300019
         DC    AL1(S8)   22        2848                                 58400019
         SPACE 1                                                        58500019
         DC    AL1(S0)   23                                             58600019
         DC    AL1(S0)   24                                             58700019
         SPACE 1                                                        58800019
         DC    AL1(S9)   25        BSC1                                 58900019
         SPACE 1                                                        59000019
         DC    AL1(SC)   26        BSC2      (A, AD, OR D)       S99245 59100002
         SPACE 1                                                        59200019
         DC    AL1(SA)   27        BSC3      (P)                        59300019
         SPACE 1                                                        59400019
         DC    AL1(S0)   28                                             59500019
         DC    AL1(S0)   29                                             59600019
         SPACE 1                                                        59700019
         DC    AL1(S8)   2A        WTTA                                 59800019
         SPACE 1                                                        59900019
         DC    AL1(S6)   2B        2741                                 60000019
         DC    AL1(S6)   2C             A                               60100019
         SPACE 1                                                        60200019
         DC    AL1(S8)   2D        2740 C OIU                           60300019
         DC    AL1(S8)   2E             CD OIU                          60400019
         SPACE 1                                                        60500019
         DC    AL1(S8)   2F        1050X                                60600019
         DC    AL1(SB)   30             A,D,AD                          60700019
         SPACE 1                                                        60800019
         DC    AL1(S8)   31        2740X                                60900019
         DC    AL1(S8)   32             A,D,AD                          61000019
         SPACE 4                                                        61100019
S0       EQU   0                                                        61200019
S5       EQU   8*5                                                      61300019
S6       EQU   8*6                                                      61400019
S7       EQU   8*7                                                      61500019
S8       EQU   8*8                                                      61600019
S9       EQU   8*9                                                      61700019
SA       EQU   8*10                                                     61800019
SB       EQU   8*11                                                     61900002
SC       EQU   8*12          DVC DEPENDENT I/O LENGTH - BSC2     S99245 61950002
         EJECT                                                     000M 62000019
CHARTBL  EQU   *                                                   000M 62100019
*              USASCII CONTROL CHARACTERS                          000M 62200019
         DC    X'103F1002'         DLE WBT, DLE STX                000M 62300019
         DC    X'10031030'         DLE ETX, ACK 0                  000M 62400019
         DC    X'10310515'         ACK 1, INQ, NAK                 000M 62500019
         DC    X'17100416'         ETB, DLE, EOT, SYN              000M 62600019
         DC    X'10170125'         DLE ETB, SOH %                       62700019
         DC    X'103B103C'         DLE SAK, DLE RVI                000M 62800019
TBLOFFST EQU   *-CHARTBL                                           000M 62900019
*              TRANSCODE CONTROL CHARACTERS                        000M 63000019
         DC    X'1F401F0A'         DLE WBT, DLE STX                000M 63100019
         DC    X'1F2E1F20'         DLE ETX, ACK 0                  000M 63200019
         DC    X'1F232D3D'         ACK 1, INQ, NAK                 000M 63300019
         DC    X'0F1F1E3A'         ETB, DLE, EOT, SYN              000M 63400019
         DC    X'1F0F002C'         DLE ETB,SOH %                        63500019
         DC    X'1F291F32'         DLE SAK, DLE RVI                000M 63600019
*              EBCDIC CONTROL CHARACTERS                           000M 63700019
         DC    X'107F1002'         DLE WBT, DLE STX                000M 63800019
         DC    X'10031070'         DLE ETX, ACK 0                  000M 63900019
         DC    X'10612D3D'         ACK 1, INQ, NAK                 000M 64000019
         DC    X'26103732'         ETB, DLE, EOT, SYN              000M 64100019
         DC    X'1026016C'         DLE ETB, SOH %                       64200019
         DC    X'106B107C'         DLE SAK, DLE RVI                000M 64300019
USASCII  EQU   X'14'                                               000M 64400019
TRANSCD  EQU   X'28'                                               000M 64500019
TIMELNG  EQU   4                                               @ZA08051 64520000
         SPACE 4                                                        64600017
         EJECT                                                          64800017
TIME     DC    F'50'                                               000E 65000017
EIGHT    DC    F'8'                    LENGTH OF IOB DYNAMIC     Y02947 65010002
*                                      BUFFERING EXTENSION       Y02947 65020002
RPGFIX   DC    X'40000000'             REGISTER PGFIX FLAG FOR   Y02947 65040002
*                                      PAGE SERVICES             Y02947 65042002
POST     DC    C'POST'                                           A27612 65050019
CONT     DC    C'CONT'                                           A27612 65100019
POOLNUM  DC    X'FA000000'       SUBPOOL 250                     Y02947 65150002
ERR4     DC    0F'0',X'80094000'        NON-SUPPORTED FEATURE      000I 65300018
ERR7     DC    X'80098000'       ABEND FOR DUAL INTERFACE ERROR YA01249 65400002
*     ERR8                          DELETED BY FOLLOWING APAR   YA02172 65650002
ANDMASK  DC    X'00000003'                                              65800017
ENABLE   DC    X'2700000020240001'                                      66000017
IOBPOOL  DC    X'FA000000'              SUBPOOL NUMBER FOR IOB          66200017
SADCCODE DC    X'13'                    SADZER CODE                     66600017
         DC    X'17'                    SADONE CODE                     66800017
         DC    X'1B'                    SADTWO CODE                     67000017
         DC    X'1F'                    SADTHREE CODE                   67200017
RETRYMSK DS    0F             READ RETRY MASK                           67400017
   DC  BL.51'111110000111000111110010000000000010000001000111111'  000M 67500019
*        1050*****                                                 000K 67600018
*        2740     ******************                               000K 67700018
*        1060                       **                             000K 67800018
*        1030                         **                           000K 67900018
*        TEL1                           ****                       000K 68000018
*        TEL2                               ***                    000K 68100018
*        2260                                  *                   000K 68200018
*        S360                                   **                 000K 68300018
*        1130/2780                                ***              000K 68400018
*        2780 MULTIPOINT                             *             000K 68500018
*        2020 MULTIPOINT                              *            000K 68600018
*        WTTA                                          *           000K 68700018
*        2741                                           **         000K 68800018
*        2740 OIU                                         **       000K 68900018
*        1050X                                              **     000M 69300019
*        2740X                                                **   000M 69700019
         SPACE                                                          70200017
CLEAR    XC    0(1,RCORE),0(RCORE)                                      70400017
OPIDCNST DC    C'0S'                    ID OF LAST OPEN LOAD.           70600017
AMIDCNST DC    C'3Q'                    ID OF THIS MODULE.              70800017
MASK1    EQU   X'05'                                               000I 70900018
MASK     EQU   X'03'                    UCB MODEL BITS FOR 2780    000C 71000017
MPOFFSET EQU   X'26'                    OFFSET FOR 1130/2780 MPT   000C 71200017
DISP0    EQU   0                        DISPLACEMENT OF 0        Y02947 71250002
DISP4    EQU   4                        DISPLACEMENT OF 4        Y02947 71350002
DISP8    EQU   8                        DISPLACEMENT OF 8        Y02947 71360002
DISP160  EQU   160                      LENGTH OF ONE IDAL       Y02947 71370002
         SPACE 2                                                        71400017
CODEBUCB EQU   X'04'                    TRANSMISSION CODE B             71600017
CODEB    EQU   X'08'                    TRANSMISSION CODE B             71800017
DATAB    EQU   X'20'                    DATA INTERFACE B                72000017
SETMODCM EQU   X'23'                    SET MODE COMMAND                72200017
DISABLE  EQU   X'2F'                                             A26896 72300019
WAOFF    EQU   32                       OFFSET OF FIRST WTG ENTRY FROM  72400017
*                                  START OF WTG.                        72600017
PLOFF    EQU   4                        OFFSET OF DCB ENTRIES.          72800017
WGOFF    EQU   8                        OFFSET OF WTG ENTRIES.          73000017
SADENER  EQU   X'80'         FLAG FOR ERROR ON SAD OR ENABLE            73200017
ALLON    EQU   X'FF'                                                    73400017
RDRETRY  EQU   X'02'                                                    73600017
CMDCHAIN EQU   X'40'                                                    73800017
DYNBUF   EQU   X'08'                    CODE FOR BFTEK=D IN THE DCB,    74400017
GRAPHMSK EQU   X'40'                                               000E 74600017
ONLT     EQU   X'10'                    ON LINE TEST BIT           000D 74800017
TRMTST   EQU   X'10'                                               000E 75000017
TYP25    EQU   X'25'                                                    75200017
TYP26    EQU   X'26'                                                    75400017
TYP27    EQU   X'27'                                                    75600017
TYP2B    EQU   X'2B'                   2741 OFFSET                 000I 75640018
INTR1    EQU   X'2B'                                               000I 75680018
INTR2    EQU   X'2C'                                               000I 75720018
FEA      EQU   X'10'                    AUTO-ANSWER FEATURE        000I 75760018
M2020    EQU   X'04'                                                    75800017
ZERO     EQU   X'00'                                                    75820000
X90      EQU   X'90'                                           @ZA04187 75850000
L19      EQU   19                                              @ZA04187 75900000
HEX24    EQU   36                                           L5 @ZA03589 75950000
PURGEOPT EQU   X'A0'               OPTION BYTE FOR PURGE    LD @ZA00535 76010003
ONE      EQU   1                    VALUE OF 1                   Y02947 76050002
L2       EQU   2                                               @ZA04865 76050500
LEN4     EQU   4                    LENGTH OF 4                  Y02947 76052002
TWELVE   EQU   12                                           LD @ZA00535 76054003
SIXT     EQU   16                   CVT ADDRESS                  Y02947 76060002
TWENTY8  EQU   28                   VALUE OF 28                  Y02947 76070002
THIRTY2  EQU   32                   VSL LENGTH                   Y02947 76080002
L32      EQU   32                                              @ZA06399 76082000
IDALLEN  EQU   320                  LENGTH OF 2 IDAL'S           Y02947 76090002
ONEBIT   EQU   1                    MULTIPLY BY 2                Y02947 76092002
FIVEBITS EQU   5                    MULTIPLY BY 32               Y02947 76094002
SIXTY    EQU   X'60'                MESSAGE AREA LENGTH          Y02947 76096002
         SPACE 4                                                   000I 76100018
BTAMLOD4 DC    C'3S'                   ID FOR FOURTH OPEN LOAD   Y02947 77400002
         DC    X'00000000'             TTR AND L                        77600017
         EJECT                                                          78600017
         DCBD  DSORG=BX,DEVD=BS                                         78800017
         EJECT                                                   Y02947 78850002
        IECTIOBX                                                        79200017
         EJECT                                                          79400017
        IECTDEBX                                                        79600017
         EJECT                                                   Y02947 79610002
WORKAREA DSECT                                                   Y02947 79650002
         IECDSECT IOB=NO                                         Y02947 79700002
         EJECT                                                   Y02947 79702002
         IECDSECS WTG,PREFX,EXPAND=YES                           Y02947 79710002
         EJECT                                                   Y02947 79750002
CVT      DSECT                                                   Y02947 79760002
         CVT   LIST=NO                                           Y02947 79770002
         EJECT                                                   Y02947 79780002
         IKJTCB DSECT=YES,LIST=YES                               Y02947 79790002
         EJECT                                                   Y02947 79792002
         IHAPSA                                                  Y20947 79794002
         END                                                            79800017
