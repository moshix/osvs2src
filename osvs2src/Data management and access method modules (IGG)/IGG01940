         TITLE 'IGG01940 SIXTH LOAD OF TCAM LINE OPEN'                  00100010
IGG01940 CSECT                                                          00101010
*A-000000-999999                                               @X31X8N0 00102010
         SPACE 3                                                        00103010
*  CHANGE ACTIVITY AS FOLLOWS                                           00106410
******************** MICROFICHE FLAGS *********************** SUPT CODE 00106610
*A133831-133837,578300-578600                                    S22027 00107010
*C412000*                                                       SA53611 00107110
*C088600,412000,561000                                           S22027 00107210
*A460000,546000                                                  S21101 00107310
*C453000                                                         S21101 00107410
*088000,184630,184700                                            A41032 00107510
*A002300-002900                                                  S22025 00107610
*C087000,350000,352000,360000,513000,613000,615000-616000        S22025 00107710
*A133810-133970,447200-447600,584000-585000,592000-593000        S22026 00107810
*D576100-576300                                                  S22026 00107910
*C134200-134300,134500-134700,561000                             S22026 00108010
*A001000,079000,089000,125000,131000,134800,144500,156000,165000 CLUP21 00108110
*A176000,312000,320000,336000,343000,354000,392000,405000,422000 CLUP21 00108210
*A436000,444000,450000,532000,544000,548000,565000,578000        CLUP21 00108310
*C004600-012000,063000,075000,088600,091000-101000,134000,143000 CLUP21 00108410
*C161000,164000,166000-170000,175000,390000,479000,561000        CLUP21 00108510
*D054000-055000,080000,082000,138000-142000,145000-154000        CLUP21 00108610
*D177000-303000,313000,339000-340000,369000-386000,394000        CLUP21 00108710
*D406000-418000,430000,438000,451000-478000,480000-510000        CLUP21 00108810
*D521000-525000,528000-529000,530000,533000-536000,537000-540000 CLUP21 00108910
*D540500-542000,545000-547500,549000-550000,566000-576000        CLUP21 00109010
*D579000-610000,620000,623000                                    CLUP21 00109110
*A079000,217000,222000                                          SA52971 00109210
*C088400,088600-088700                                          SA52971 00109310
*D290000-295000,512000                                          SA52971 00109410
*A002400,607000                                                  S21903 00109510
*C002400,492000,561000                                           S21903 00109610
*D337000-338000,394000-394500,396000-423000,439000-502000,514000 S21903 00109710
*D538000,546000,552000,553000-559000,565000,567000,569000,571000 S21903 00109810
*D573000,578600,578800,583000,585000,591000,593000,599000,607000 S21903 00109910
*A330000                                                        SA62408 00110010
*A115000                                                        SA65396 00110110
*A527000                                                         X01004 00200010
*C142500-144500,274000-279000,282000-287000,331000               X01004 00205010
*A551000                                                         Y01004 00210010
*C097000                                                         X02004 00215010
*C003300,022000,026000,047000-048200,088200-089000               Y02027 00215110
*C091000-099000,205000-208000,363000,426000-428000,517000-527000 Y02027 00215210
*C531000,537000,543000-545000,551500                             Y02027 00215310
*D100000,101000,515000                                           Y02027 00215410
*A081600,082200,126500,552000,552500                             Y02027 00215510
*A001010                                                       @Z30X8NM 00215610
*C003300,341000                                                @Z30X8NM 00215710
*D205600-207400,561000-564000,607000,612000-617000             @Z30X8NM 00215810
*********************************************************************** 00220010
*                                                                     * 00240010
*  TITLE:  'IGG01940' -- SIXTH LOAD TCAM LINE OPEN                    * 00250010
*                                                                     * 00260010
*  MODULE NAME = IGG01940                                             * 00270010
*                                                                     * 00280010
*  DESCRIPTIVE NAME = SIXTH LOAD OF LINE OPEN                         * 00290010
*                                                                     * 00300010
*  COPYRIGHT = 'NONE'                                                 * 00310010
*                                                                     * 00320010
*  STATUS = CHANGE LEVEL 8                                     @Z30X8NM 00330010
*                                                                     * 00400010
*FUNCTION/OPERATION - THIS ROUTINE LOADS ADDITIONAL MODULES           * 00420010
*   THAT ARE REQUIRED FOR LINE OPERATION.  THESE MODULES              * 00440010
*   INCLUDE THE SEND AND RECEIVE SCHEDULERS.                     X03039 00460010
*   FOR NON-BUFFERED TERMINALS, THE QEVENT SUBTASK IS PLACED AT  CLUP21 00880010
*   THE END OF THE STCB CHAIN POINTED TO BY THE LCB. FOR ALL     CLUP21 00950010
*   TERMINALS THE ADDRESS OF THE STARTUP MESSAGE ROUTINE IS      CLUP21 01020010
*   PLACED IN THE LCB. FINAL PROCESSING PRIOR TO TRANSFERRING    CLUP21 01090010
*   CONTROL TO THE NEXT LOAD OF OPEN IS TO START I/O ON THE      CLUP21 01160010
*   LINES.                                                       CLUP21 01230010
*                                                                     * 01300010
*ENTRY POINTS - THIS ROUTINE IS ENTERED AT IGG01940 VIA AN            * 01330010
*   XCTL FROM THE PREVIOUS EXECUTOR (IGG01939).  IT MAY               * 01360010
*   ALSO BE RE-ENTERED FROM THE RELOOP PORTION OF THIS ROUTINE        * 01600010
*   IF IT IS DETERMINED THAT ANOTHER DATA CONTROL BLOCK IS TO         * 01700010
*   BE PROCESSED BY IGG01940.                                         * 01800010
*                                                                     * 01900010
*INPUT - REGISTERS 5,6,7, AND 8 ARE THE INPUT AS FOLLOWS              * 02000010
*                                                                     * 02100010
*   5 - THE ADDRESS OF THE WTG TABLE PREFIX                      Y02027 02200010
*                                                                     * 02300010
*   6 - THE ADDRESS OF THE BEGINNING OF THE WHERE-TO-GO TABLE         * 02400010
*                                                                     * 02500010
*   7 - THE ADDRESS OF THE COPY OF THE CURRENT DCB               Y02027 02600010
*                                                                     * 02700010
*   8 - THE ADDRESS OF THE CURRENT EXECUTOR'S ENTRY IN THE            * 02800010
*       WHERE-TO-GO TABLE                                             * 02900010
         EJECT                                                          03000010
*OUTPUT - ALL FUNCTIONS NEEDED FOR LINE OPERATION WILL HAVE           * 03100010
*   BEEN LOADED AND INITIAL I/O WILL HAVE BEEN STARTED ON             * 03200010
*   EACH LINE                                                         * 03300010
*                                                                     * 03400010
*EXTERNAL ROUTINES - NONE                                             * 03500010
*                                                                     * 03600010
*EXITS - NORMAL                                                       * 03700010
*   THIS ROUTINE EXITS VIA AN XCTL TO THE MODULE IDENTIFIED BY        * 03800010
*   THE NEXT NON-ZERO ENTRY IN THE WHERE-TO-GO TABLE,                 * 03900010
*   NAMELY IGG01948.                                                  * 04000010
*                                                                     * 04100010
*      - ERROR                                                        * 04200010
*   NONE                                                              * 04300010
*                                                                     * 04400010
*TABLES/WORKAREAS - THE WHERE-TO-GO TABLE CONTAINS THE ID             * 04500010
*   AND TTR OF THE OPEN EXECUTOR TO BE GIVEN CONTROL.                 * 04600010
*                                                                Y02027 04700010
*   THE WTG TABLE PREFIX CONTAINS THE ADDRESS OF A COPY          Y02027 04760010
*   OF EACH DCB SPECIFIED IN THE OPEN MACRO INSTRUCTION          Y02027 04820010
*                                                                     * 04900010
*ATTRIBUTES - THIS ROUTINE IS EXECUTED IN THE TRANSIENT AREA          * 05000010
*   AS ENABLED, PRIVILEGED, AND REENTRANT.                            * 05100010
*********************************************************************** 05200010
         EJECT                                                          05300010
*    REGISTER USAGE                                                     05600010
*                                                                       05700010
*                                                                       05800010
RE       EQU   0                        WORK REGISTER                   05900010
RF       EQU   1                        WORK REGISTER                   06000010
RDCB     EQU   2                        ADDRESS OF THE CURRENT DCB      06100010
RTIOT    EQU   3                        WORK REGISTER                   06200010
RCORE    EQU   4                        BASE REGISTER FOR LCB/IOBCLUP21 06300010
RPAR     EQU   5                        ADDRESS OF FIRST ENTRY IN       06400010
*                                         DCB PARAMETER LIST            06500010
RWTG     EQU   6                        ADDRESS OF THE WHERE-TO-GO      06600010
*                                         TABLE                         06700010
RPARC    EQU   7                        ADDRESS OF THE CURRENT          06800010
*                                         ENTRY IN DCB PARAMETER        06900010
*                                         LIST                          07000010
RWTGC    EQU   8                        ADDRESS OF THE CURRENT          07100010
*                                         ENTRY IN THE WTG TABLE        07200010
RAVT     EQU   9                        ADDRESS OF THE AVT              07300010
RUCB     EQU   10                       WORK REGISTER                   07400010
RDEB     EQU   11                       BASE REGISTER FOR DEB    CLUP21 07500010
RBASE    EQU   12                       BASE OF THIS ROUTINE            07600010
RC       EQU   13                       WORK REGISTER                   07700010
RD       EQU   14                       WORK REGISTER                   07800010
RJ       EQU   15                       WORK REGISTER                   07900010
         SPACE 2                                                SA52971 07910010
         EJECT                                                          08000010
         USING IEDQDEB,RDEB             DEB DSECT                       08100010
         USING FORCORE,RJ               WORK AREA DSECT          Y02027 08160010
         USING IEDQTCX,RF               TCX DSECT                Y02027 08220010
         USING IEDQAVTD,RAVT            AVT DSECT                       08300010
         USING IHADCB,RDCB              DCB DSECT                       08400010
         USING IEDQLCB,RCORE            LCB/IOB DSECT                   08500010
*                                                                       08600010
         BALR  RBASE,0                  ESTABLISH ADDRESSIBILITY S22025 08700010
         USING *,RBASE                                                  08800010
         SPACE 2                                                        08820010
IGG01940 IEDHJN DATE                                             Y02027 08850010
         EJECT                                                          08880010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 08910010
*                                                                CLUP21 08920010
*        THIS SECTION OF CODE ESTABLISHES ADDRESSIBILITY ON THE  CLUP21 08930010
*        DCB, AVT, DEB, AND COMPUTES THE OFFSET INTO THE DEB OF  CLUP21 08940010
*        THE SUBROUTINE-ID SECTION.                              CLUP21 08950010
*                                                                CLUP21 08960010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 08970010
*                                                                CLUP21 08980010
RESTART  EQU   *                                                        09000010
         L     RJ,FOUR(RWTGC)           ADDR OF OPEN WORK AREA   Y02027 09100010
         L     RF,CVTPTR                ADDRESS OF CVT           Y02027 09200010
         L     RF,CVTAQAVT-CVTD(RF)     LOAD ADDRESS OF          Y02027 09300010
*                                       TCAM EXTENSION           Y02027 09400010
         L     RAVT,TCXAVT              GET THE AVT ADDRESS      Y02027 09500010
         L     RDCB,DXUDCBAD            GET CURRENT DCB ADDRESS  Y02027 09600010
         L     RDEB,DCBDEBAD            GET THE DEB ADDRESS      Y02027 09700010
         LA    RF,DEBNMSUB-IEDQDEB      LOAD SIZE OF DEB PREFIX  Y02027 09800010
         SR    RDEB,RF                  RESET TO BEGINNING OF DEBY02027 09900010
         SR    RTIOT,RTIOT              CLEAR A REGISTER TO CONTAIN     10200010
*                                         THE COUNT OF LOADED           10300010
*                                         SUBROUTINES                   10400010
         IC    RTIOT,DEBNMSUB           GET THE NUMBER OF               10500010
*                                         SUBROUTINES LOADED BY         10600010
*                                         IGG01939                      10700010
         SR    RC,RC                    CLEAR AN EXTENT REGISTER        10800010
         IC    RC,DEBNMEXT              GET THE NUMBER OF EXTENTS       10900010
*                                         IN THIS DEB                   11000010
         SLL   RC,TWO                   MULTIPLY THE NUMBER OF          11100010
*                                         EXTENTS BY 4                  11200010
         LA    RUCB,DEBUCBAD(RC)        GET THE ADDRESS OF THE          11300010
*                                         ACCESS METHOD DEPENDENT       11400010
*                                         SECTION                       11500010
         SR    RC,RC                    CLEAR WORK REGISTER     SA65396 11550010
         IC    RC,DEBAMLNG              GET THE LENGTH OF THE ACCESS    11600010
*                                         METHOD                        11700010
         AR    RUCB,RC                  GET THE ADDRESS OF THE          11800010
*                                         SUBROUTINE ID SECTION         11900010
         LR    RC,RTIOT                 COPY THE COUNT OF LOADED        12000010
*                                         SUBROUTINES                   12100010
         SLL   RC,ONE                   MULTIPLY THE COUNT BY 2         12200010
         AR    RUCB,RC                  SET THE ADDRESS FOR THE         12300010
*                                         NEXT ID TO BE MOVED IN        12400010
         EJECT                                                          12500010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 12510010
*                                                                CLUP21 12520010
*        THIS SECTION OF CODE LOADS THE BUFFERED TERMINAL        CLUP21 12530010
*        SCHEDULER AND SAVES ITS ADDRESS IN THE AVT. FOR NON-    CLUP21 12540010
*        BUFFERED TERMINALS IT LOADS THE APPROPRIATE SEND        CLUP21 12550010
*        SCHEDULER AND SAVES ITS ADDRESS IN THE AVT.             CLUP21 12560010
*                                                                CLUP21 12570010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 12580010
*                                                                CLUP21 12590010
         L     RCORE,DCBIOBAD           GET THE IOB ADDRESS             12600010
         SR    RF,RF                    CLEAR FOR INSERT         Y02027 12650010
         IC    RF,DCBEIOBX              GET THE SIZE OF AN LCB          12700010
         LA    RD,IOBPTR                SET THS IOB OFFSET              12800010
         SR    RCORE,RD                 SET THE LCB - AN LCB ADDRESS    12900010
         AR    RCORE,RF                 SET THE ACTUAL LCB ADDRESS      13000010
         CLI   LCBRSKEY,BUFTSCHD        ARE THERE BUFFERED TERMINALS    13100010
         BNE   LOADSEND                 NO, BRANCH               CLUP21 13200010
         LA    RC,BUFTRMSH              LOAD ADDRESS OF ID FOR   CLUP21 13220010
*                                         BUFFERED TERM SCHED    CLUP21 13240010
         BAL   RD,LOADRTNE              LOAD IGG019RD            CLUP21 13260010
*                                                                CLUP21 13280010
         ST    RE,AVTHB                 STORE BUFFERED TERMINAL  CLUP21 13300010
*                                         SCHED ADDRESS IN AVT   CLUP21 13320010
         B     LOADRTN                  SKIP SEND SCHEDULERS     CLUP21 13340010
*                                                                CLUP21 13360010
LOADSEND EQU   *                                                 CLUP21 13380010
*                                                                S22026 13380410
*  DETERMINE PROPER SEND SCHEDULER(S) TO LOAD                    S22026 13380810
*                                                                S22026 13381210
         L     RC,DEBUCBAD              GET ADDRESS OF UCB       S22027 13381610
         CLI   DEVCLASS(RC),GRAPHICS    IS UCB FOR GRAPHICS      S22027 13382010
         BE    LOADNONC                 YES, BRANCH              S22027 13382410
         TM    AVTSCOPT,AVTCMBUF        IS COMMON BUFFER TRANS-  S22027 13383110
*                                         MISSION TO BE USED     S22027 13383210
         BZ    NOCMBF                   BRANCH IF NOT            S22027 13383310
         LA    RC,SENDCMBF              ADDR OF COMBUF SEND SCHEDS22027 13383410
         BAL   RD,LOADRTNE              LOAD COMBUF SEND SCHED   S22027 13383510
         ST    RE,AVTCMBSS              STORE ADDRESS IN AVT     S22027 13383610
NOCMBF   EQU   *                                                 S22027 13383710
         TM    AVTSCOPT,AVTCONCO+AVTCONC  IS CONC SEND SCHEDULER S22026 13384010
*                                          SPECIFIED             S22026 13385010
         BZ    LOADNONC                 NO, FIND PROPER NON CONC S22026 13386010
*                                         SCHEDULER TO LOAD      S22026 13387010
         LA    RC,SENDCONC              ADDR OF CONC SEND        S22026 13388010
*                                         SCHEDULER              S22026 13389010
         BAL   RD,LOADRTNE              LOAD CONC SEND SCHEDULER S22026 13390010
         ST    RE,AVTCSCH               STORE ADDRESS IN AVT     S22026 13391010
         TM    AVTSCOPT,AVTCONCO        IS ONLY CONC SEND        S22026 13392010
*                                         SCHEDULER SPECIFIED    S22026 13393010
         BO    LOADRTN                  YES, BYPASS LOADING ANY  S22026 13394010
*                                         OTHER SEND SCHEDULER   S22026 13395010
*                                                                S22026 13396010
LOADNONC EQU   *                                                 S22026 13397010
         LA    RC,SENDMINI              ADDR OF MINI SEND SCHEDULER     13410010
         TM    AVTSCOPT,AVTN2741+AVTNDIAL  IS MINI SCHEDULER     S22026 13420010
*                                            SPECIFIED           S22026 13426010
         BO    LOADSCHD                 YES, GO LOAD IGG019Q6    S22026 13432010
         LA    RC,SENDNTSO              ADDR OF NTSO SEND SCHEDULER     13440010
         TM    AVTSCOPT,AVTN2741        IS NON TSO, NON 2741     S22026 13450010
*                                         SCHEDULER SPECIFIED    S22026 13460010
         BO    LOADSCHD                 YES, GO LOAD IGG019Q7    S22026 13470010
         LA    RC,SENDSCHD              ADDR OF FULL SEND SCHEDULER     13480010
*                                                                CLUP21 13485010
LOADSCHD EQU   *                                                        13490010
         BAL   RD,LOADRTNE              RETURN LINKAGE ESTABLISHED      13600010
*                                                                       13700010
         STCM  RE,AD,AVTHD+ONE          SAVE ADDRESS IN AVT      X01004 14250010
         EJECT                                                          14500010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 14590010
*                                                                CLUP21 14680010
*        THIS SECTION OF CODE INSPECTS A TYPICAL UCB FOR LINES   CLUP21 14770010
*        IN THE LINE GROUP AND LOADS THE 2260 LOCAL RECEIVE      CLUP21 14860010
*        SCHEDULER FOR GRAPHICS DEVICES, THE DIAL SCHEDULER FOR  CLUP21 14950010
*        DIAL LINES, AND THE RECEIVE SCHEDULER FOR NON-BUFFERED  CLUP21 15040010
*        TERMINALS.                                              CLUP21 15130010
*                                                                CLUP21 15220010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 15310010
*                                                                CLUP21 15400010
LOADRTN  EQU   *                                                        15500010
         SR    RJ,RJ                    CLEAR AN INDEX REGISTER         15600010
*                                                                CLUP21 15650010
LOADRTN1 EQU   *                                                        15700010
         L     RF,DEBUCBAD(RJ)          LOAD THE ADDRESS OF THE         15800010
*                                         FIRST/NEXT UCB ADDRESS        15900010
         LTR   RF,RF                    IS THIS A // DD DUMMY ENTRY     16000010
         BNZ   TEST2260                 NO, BRANCH               CLUP21 16100010
         LA    RJ,FOUR(RJ)              INCREMENT THE INDEX REGISTER    16200010
         B     LOADRTN1                 BRANCH                          16300010
*                                                                CLUP21 16400010
TEST2260 EQU   *                                                 CLUP21 16450010
         TM    UCBDVCLS(RF),GRAPHICS    IS THIS A 2260 LOCAL DEVICE     16500010
         BZ    TESTDIAL                 NO, BRANCH               CLUP21 16600010
         LA    RC,RECV2260              2260 LOCAL RECEIVE SCHED.CLUP21 16640010
         BAL   RD,LOADRTNE              LOAD IGG019Q1            CLUP21 16680010
*                                                                CLUP21 16720010
         ST    RC,AVT2260L              STORE ADDRESS IN AVT     CLUP21 16760010
         ST    RE,AVTE7+4                                        CLUP21 16800010
         B     LOADRECV                 LOAD RECEIVE SCHED       CLUP21 16840010
*                                                                CLUP21 16880010
TESTDIAL EQU   *                                                 CLUP21 16920010
         TM    UCBDVCLS-1(RF),DIAL      IS THIS A DIAL LINE      CLUP21 16960010
         BZ    LOADRECV                 NO, BRANCH               CLUP21 17000010
         LA    RC,DIALSCHD              LOAD THE ADDRESS OF THE         17100010
*                                         DIAL SCHEDULER                17200010
         BAL   RD,LOADRTNE              RETURN LINKAGE ESTABLISHED      17300010
*                                                                       17400010
         ST    RC,AVTR1                 SAVE ADDRESS OF THE      CLUP21 17500010
*                                         DIAL SCHEDULER                17600010
*                                                                CLUP21 17700010
LOADRECV EQU   *                                                 CLUP21 17800010
         CLI   LCBRSKEY,BUFTSCHD        BUFFERED TERMINALS       CLUP21 17900010
         BE    GETADDR                  YES, BRANCH              CLUP21 18000010
         LA    RC,RECVSCHD              RECIEVE SCHEDULER ID     CLUP21 18100010
         BAL   RD,LOADRTNE              LOAD RECEIVE SCHEDULER   CLUP21 18200010
*                                                                CLUP21 18300010
         ST    RE,AVTHA                 SAVE RECEIVE SCHED. ADDR.CLUP21 18400010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 22400010
*                                                                CLUP21 22500010
*        THIS SECTION OF CODE COMPUTES THE ADDRESS OF THE QEVENT CLUP21 22600010
*        SUBTASK CONTROL BLOCK AND FOR NON-BUFFERED TERMINALS    CLUP21 22700010
*        CHAINS IT AS THE LAST ELEMENT IN THE SUBTASK CHAIN      CLUP21 22800010
*        POINTED TO BY THE LCB. FOR ALL TERMINALS, THE ADDRESS   CLUP21 22900010
*        OF THE STARTUP MESSAGE ROUTINE (IF IT HAS BEEN LOADED)  CLUP21 23000010
*        IS PLACED IN THE LCB.                                   CLUP21 23100010
*                                                                CLUP21 23200010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 23300010
GETADDR  EQU   *                                                        23400010
         LA    RE,TWO                                            CLUP21 23600010
         CLI   LCBRSKEY,BUFTSCHD        BUFFERED TERMINALS       CLUP21 23700010
         BNE   SETRECV                  NO, BRANCH               CLUP21 23800010
         L     RC,AVTHB                 ADDRESS OF BUFFERED SCHEDCLUP21 23900010
         SR    RC,RE                    LOCATE ORIGIN OF MODULE  CLUP21 24000010
         B     LOADCB                   INITIALIZE LCBS          CLUP21 24100010
*                                                                CLUP21 24200010
SETRECV  EQU   *                                                 CLUP21 24300010
         L     RC,AVTHA                 ADDRESS RECEIVE SCHEDULERCLUP21 24400010
         SR    RC,RE                    LOCATE BEGINING OF MODULECLUP21 24500010
         AH    RC,0(RC)                 OFFSET TO QEVENT SUBTASK CLUP21 24600010
*                                                                CLUP21 24700010
LOADCB   EQU   *                                                 CLUP21 24800010
         SR    RD,RD                    CLEAR SIZE REGISTER      CLUP21 24900010
         IC    RD,DCBEIOBX              SIZE OF AN LCB           CLUP21 25000010
         IC    RE,DEBNMEXT              NO. LINES IN THE GROUP   CLUP21 25100010
         SR    RJ,RJ                    CLEAR INDEX REGISTER     CLUP21 25200010
*                                                                CLUP21 25300010
TESTUCB  EQU   *                                                 CLUP21 25400010
         L     RF,DEBUCBAD(RJ)          ADDRESS OF FIRST/NEXT UCBCLUP21 25500010
         LTR   RF,RF                    //DD DUMMY ENTRY         CLUP21 25600010
         BNZ   LCBLOOP                  NO, BRANCH               CLUP21 25700010
         LA    RJ,FOUR(RJ)              BUMP UCB ADDRESS INDEX   CLUP21 25800010
         B     TESTUCB                  TEST NEXT UCB ENTRY      CLUP21 25900010
*                                                                CLUP21 26000010
LCBLOOP  EQU   *                                                 CLUP21 26100010
         CLI   LCBRSKEY,BUFTSCHD        BUFFERED TERMINALS       CLUP21 26200010
         BE    STARTEST                 YES, BRANCH              CLUP21 26300010
         LA    RJ,LCBRSKEY              ADDRESS OF FIRST ELEMENT CLUP21 26400010
*                                         ON THE CHAIN           CLUP21 26500010
NEXTELMT EQU   *                                                 CLUP21 26600010
         L     RF,0(RJ)                 ADDRESS OF NEXT ELEMENT  CLUP21 26700010
         CLI   FOUR(RF),ENDCHAIN        LAST ELEMENT ON CHAIN    CLUP21 26800010
         BE    SETQEVNT                 YES,BRANCH               CLUP21 26900010
         LA    RJ,FOUR(RF)              GET LINK TO NEXT ELEMENT CLUP21 27000010
         B     NEXTELMT                 TEST NEXT ELEMENT        CLUP21 27100010
*                                                                CLUP21 27200010
SETQEVNT EQU   *                                                 CLUP21 27300010
         STCM  RC,AD,ONE(RJ)            STORE ADDRESS OF QEVENT  X01004 27400010
*                                        SUBTASK IN LAST CHAIN   X01004 27600010
*                                        POINTER                 X01004 27800010
         TM    0(RPARC),OUTONLY         OPEN FOR OUTPUT ONLY     CLUP21 28000010
         BNO   STARTEST                 NO, BRANCH               CLUP21 28100010
         STCM  RC,AD,LCBRSLNK           STORE QEVENT SUBTASK ADDRX01004 28200010
*                                        INTO STCB LINK FIELD OF X01004 28400010
*                                        LCB                     X01004 28600010
*                                                                CLUP21 28800010
STARTEST EQU   *                                                 CLUP21 28900010
         AR    RCORE,RD                 BUMP TO NEXT LCB         CLUP21 29600010
         BCT   RE,LCBLOOP               DECREMENT LINE COUNT AND CLUP21 29700010
*                                         BRANCH                 CLUP21 29800010
         STC   RTIOT,DEBNMSUB           STORE THE COUNT OF LOADED       30400010
*                                         SUBROUTINES IN THE DEB        30500010
*                                                                       30600010
         EJECT                                                          30700010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     30800010
*                                                                 *     30900010
*        START I/O ON ALL LINES                                   *     31000010
*                                                                 *     31100010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     31200010
*                                                                CLUP21 31300010
         SR    RD,RD                    CLEAR THE LINE COUNT            31400010
         IC    RD,DEBNMEXT              NUMBER OF LINES                 31500010
         SR    RC,RC                    SIZE REGISTERS                  31600010
         IC    RC,DCBEIOBX              SIZE OF AN LCB                  31700010
         L     RCORE,DCBIOBAD           LOAD THE ADDRESS OF THE         31800010
*                                         FIRST IOB                     31900010
         SR    RUCB,RUCB                CLEAR AN INDEX REGISTER         32000010
*                                                                CLUP21 32050010
NEXTLINE EQU   *                                                        32100010
         LA    RF,0(RCORE,RC)           LOAD THE IOB ADDRESS            32200010
*                                         FOR IOS                       32300010
         AR    RCORE,RC                 BUMP THE POINTER TO THE         32400010
*                                         NEXT LCB                      32500010
         L     RTIOT,DEBUCBAD(RUCB)     LOAD THE ADDRESS OF THE         32600010
*                                         FIRST/NEXT UCB ADDRESS        32700010
         LTR   RTIOT,RTIOT              IS THIS A // DD DUMMY ENTRY     32800010
         BZ    BCT                      YES, BRANCH                     32900010
*                                                                       33000010
         DROP  RCORE                                            SA62408 33010010
         USING LCBFLAG1,RCORE           IOB ADDRESSABILITY      SA62408 33020010
         CLI   LCBSTAT1,AVTEZERO        OPEN IDLE REQUESTED     SA62408 33030010
         BNE   EXCPX                    BRANCH NO - DO EXCP     SA62408 33040010
         SPACE 1                                                SA62408 33050010
         MVI   LCBTPCD,AVTEZERO         INDICATE OPEN COMPLETE  SA62408 33060010
         B     BCT                      CONTINUE WITH NEXT LCB  SA62408 33070010
         SPACE 1                                                SA62408 33080010
EXCPX    EQU   *                                                SA62408 33090010
         EXCPVR (1),SUBSYS                                       X01004 33100010
*                                                                       33200010
BCT      EQU   *                                                        33300010
         LA    RUCB,FOUR(RUCB)          INCREMENT THE INDEX REGISTER    33400010
         BCT   RD,NEXTLINE              BRANCH IF THERE ARE MORE        33500010
*                                         LINES TO START                33600010
         EJECT                                                          33608010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 33616010
*                                                                CLUP21 33624010
*        THIS SECTION OF CODE DETERMINES IF THIS EXECUTOR IS     CLUP21 33632010
*        REQUIRED AGAIN (MULTIPLE DCB'S BEING OPEN'ED) AND IF SO CLUP21 33640010
*        RESTARTS. AFTER ALL DCB'S HAVE BEEN PROCESSED,          CLUP21 33648010
*        PARAMETERS ARE SET UP FOR TRANSFER OF CONTROL TO THE    CLUP21 33656010
*        LAST LOAD OF LINE OPEN - IGG01948.                      CLUP21 33664010
*                                                                CLUP21 33672010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 33680010
*                                                                CLUP21 33688010
         MVC   AVTEZERO(TWO,RWTGC),TCAMLD7 ID FOR              @Z30X8NM 34100010
*                                         LAST LOAD OF LINE  OPEN       34200010
         L     RJ,4(RWTGC)              ADDRESS OF OPEN WORK AREA       34300010
*                                                                CLUP21 34400010
RELOOP   EQU   *                                                        34500010
         LA    RWTGC,8(RWTGC)           NEXT WTG ENTRY                  34600010
         LA    RPARC,4(RPARC)           NEXT DCB LIST ENTRY             34700010
         CLC   0(2,RWTGC),AMIDCNST      IS THIS EXECUTOR NEEDED         34800010
*                                         AGAIN                         34900010
         BE    RESTART                  BRANCH IF YES            S22025 35000010
         CLC   0(2,RWTGC),OPIDCNST      END OF WTG TABLE                35100010
         BNE   RELOOP                   BRANCH IF NO             S22025 35200010
         LR    RPARC,RPAR               REINITIALIZE WTG AND            35300010
         LA    RWTGC,32(RWTG)           PARAMETER REGISTERS             35400010
*                                                                CLUP21 35450010
ZCHECK   EQU   *                                                        35500010
         CLI   0(RWTGC),X'00'           IS THIS ENTRY ZERO              35600010
         BNE   XCTLRTNE                 IF NOT ZERO, TRANSFER CNTRL     35700010
         LA    RWTGC,8(RWTGC)           ADDRESS OF NEXT ENTRY           35800010
         LA    RPARC,4(RPARC)           ADDRESS OF NEXT DCB             35900010
         B     ZCHECK                   CHECK NEXT ENTRY         S22025 36000010
*                                                                       36100010
XCTLRTNE EQU   *                                                        36200010
         LA    RJ,DXCCW12               ADDRESS OF A DOUBLE WORD Y02027 36300010
*                                         SAVE AREA                     36400010
         MVC   6(2,RWTG),0(RWTGC)       MOVE ID TO NAME FIELD           36500010
         MVC   14(3,RWTG),2(RWTGC)      MOVE TTR TO WTG TABLE           36600010
         XCTL  DE=(RWTG),SF=(E,(15))                                    36700010
*                                                                       36800010
         EJECT                                                          38700010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     38800010
*                                                                 *     38900010
*        STANDARD LOAD SUBROUTINE. UPON ENTRY REGISTER 13 POINTS CLUP21 39000010
*        TO THE TWO-CHARACTER ID OF THE MODULE TO BE LOADED. THE CLUP21 39010010
*        APPROPRIATE ATTRIBUTES ARE SET AND THE LOAD SVC ISSUED. CLUP21 39020010
*        THE TWO-CHARACTER ID IS PLACED IN THE DEB AND THE COUNT CLUP21 39030010
*        OF LOADED MODULES INCREMENTED. UPON EXIT REGISTER 13    CLUP21 39040010
*        CONTAINS THE ADDRESS OF THE LOADED ROUTINE, REGISTER 0  CLUP21 39050010
*        CONTAINS ITS ADDRESS + 2.                               CLUP21 39060010
*                                                                 *     39100010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     39200010
*                                                                CLUP21 39250010
LOADRTNE EQU   *                                                        39300010
         MVC   6(2,RWTG),0(RC)          MOVE ID TO WTG TABLE            39500010
         LR    RE,RWTG                  LOAD THE ADDRESS OF THE         42400010
*                                         PARAMETER LIST                42500010
         L     RF,CVTPTR                ADDRESS OF CVT           Y02027 42600010
         L     RF,CVTSVDCB-CVTD(RF)     GET ADDRESS OF THE       Y02027 42700010
*                                       DCB FOR SVC LIB          Y02027 42800010
         LOAD  EPLOC=(0),DCB=(1)        LOAD THE ROUTINE         S21903 42900010
         MVC   0(2,RUCB),0(RC)          MOVE SUB-ROUTINE ID TO THE      43100010
*                                         DEB                           43200010
         LA    RUCB,2(0,RUCB)           BUMP POINTER TO NEXT ID         43300010
*                                         POSITION IN THE DEB           43400010
         LA    RTIOT,1(0,RTIOT)         KEEP A COUNT OF ALL LOADED      43500010
*                                         SUBROUTINES                   43600010
         LR    RC,RE                    SAVE ADDRESS             CLUP21 43630010
         LA    RE,TWO(RC)               BUMP BY TWO              CLUP21 43660010
         BR    RD                       RETURN                          43700010
         EJECT                                                          51100010
OPIDCNST DC    C'0S'                    FLAG INDICATING END OF   S22025 51300010
*                                       'WHERE TO GO' TABLE      S22025 51350010
ONE      EQU   1                        NUMERIC CONSTANT                51600010
TWO      EQU   2                        NUMERIC CONSTANT         Y02027 51700010
THREE    EQU   3                        NUMERIC CONSTANT         Y02027 51900010
FOUR     EQU   4                        NUMERIC CONSTANT         Y02027 52100010
FIVE     EQU   5                        NUMERIC CONSTANT         Y02027 52300010
UCBDVCLS EQU   18                       UCB DEVICE CLASS         Y02027 52500010
AD       EQU   7                        ICM/STCM MASK            X01004 52900010
IOBPTR   EQU   32                       IOB OFFSET IN LCB        Y02027 53100010
ENDCHAIN EQU   X'00'                    LAST ELEMENT ON CHAIN    Y02027 53700010
GRAPHICS EQU   X'10'                    2260 LOCAL               Y02027 54300010
BUFTSCHD EQU   X'1A'                    BUFFERED TERMINAL        Y02027 54500010
OUTONLY  EQU   X'0F'                    OUTPUT ONLY              Y02027 54700010
DIAL     EQU   X'90'                    TO TEST FOR DIAL LINE    CLUP21 54900010
RLD      EQU   X'EF'                    TO INDICATE RLD PRESENT  CLUP21 55000010
HIGHPRI  EQU   X'FC'                    PRIORITY                 Y02027 55150010
AMIDCNST DC    C'40'                    ID FOR THIS EXECUTOR     Y02027 55200010
DEVCLASS EQU   18                       DEV CLASS OFFSET IN UCB  S22027 55250010
         EJECT                                                          56000010
RECV2260 DC    C'Q1'                    2260L RECEIVE SCHEDULER  CLUP21 56600010
RECVSCHD DC    C'R3'                    TCAM RECEIVE SCHEDULER   CLUP21 56800010
SENDCMBF DC    C'RE'                    COMBUF SEND SCHEDULER    S22027 57830010
DIALSCHD DC    C'R1'                    ID FOR THE DIAL SCHD     S22027 57870010
SENDMINI DC    C'Q6'                    MINI SEND SCH- NON DIAL, S22026 58400010
SENDNTSO DC    C'Q7'                    SEND SCHED - N/N TSO/2741CLUP21 58700010
SENDCONC DC    C'Q9'                    CONC SEND SCHEDULER ID   S22026 59200010
SENDSCHD DC    C'R4'                    TCAM SEND SCHEDULER      CLUP21 59500010
BUFTRMSH DC    C'RD'                    BUFFERED TERMINAL SCHED  CLUP21 60300010
TCAMLD7  DC    C'48'                    LAST LOAD OF OPEN               61100010
         EJECT                                                          61800010
         TAVTD                          AVT DSECT                       61900010
         EJECT                                                          61920010
         TTCXD                                                   Y02027 61940010
         EJECT                                                          61960010
FORCORE DSECT                                                           61980010
         IECDSECT                                                Y02027 62000010
         EJECT                                                          62020010
CVTD     DSECT                                                   Y02027 62040010
         CVT                                                     Y02027 62060010
         EJECT                                                          62080010
         TLCBD                                                          62100010
         TDEBD                                                          62200010
         DCBD  DSORG=TX                                                 62400010
         END                                                            62500010
