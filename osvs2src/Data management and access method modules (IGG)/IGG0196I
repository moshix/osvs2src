196I     TITLE  'IGG0196I  --  DEB CONSTRUCTION'                        00100000
IGG0196I CSECT                                                          00200021
*                                                                       00210002
*MODULE NAME - IGG0196I                                          Y02072 00220002
*                                                                       00230002
*DESCRIPTIVE NAME - BEGIN DEB CONSTRUCTION                       Y02072 00240002
*                                                                       00242002
*COPYRIGHT - NONE                                                Y02072 00244002
*                                                                       00246002
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00248002
*                                                                       00248402
*        VS1 RELEASE 02 DELETIONS                                       00248802
*D391300-391600                                                  OX1819 00249202
*                                                                       00250002
*        VS 2 RELEASE 02 DELETIONS                                      00300002
*012500,211000-222000,397000,428000,499000,455000,478000,482000, Y02072 00350002
*589000,590000                                                   Y02072 00352002
*                                                                YM4640 00352102
*C404000,421000                                                  YM7574 00362102
*                                                                YM7829 00372102
*                                                                       00382103
*        VS 2 RELEASE 03 DELETIONS                                      00392103
*                                                              @Z30TSCF 00394103
*                                                                       00400002
*        VS2 RELEASE 03 CHANGES/DELETIONS                               00450002
*A135500-136000,430500-430600                                   ZA01540 00500002
*C210600                                                        ZA00631 00510003
*   OZ14711 IS SYSROUTE FROM OY15702                           @ZA14711 00520037
*A346051,346052                                                @ZA14711 00530037
*                                                                       00550002
*          RELEASE 21 DELETIONS                                         00800021
*0000496000-502000                                               M0091  00810021
*0000                                                            M0053  00820021
*1394246130,246672-246676                                        A42897 00850021
*0000444000-445000                                               A46645 00900021
*                                                               SA53194 00902021
*                                                                       00910021
*  THIS MODULE WAS CREATED IN REL 21 BY SPLITTING IGG0191A              00950021
*     ( NEW FLOW - IGG0191A - IGG0196I - IGG0196A )                     01050021
*                                                                       01150021
*                                                                       01700021
*FUNCTION  THIS EXECUTOR IS ENTERED FOR USERS OF SAM AND EXCP           01800021
*          DURING OPEN FOR THE CONSTRUCTION OF DEBS.                    01900021
*          THE AMOUNT OF CORE NEEDED TO BUILD THE DEB IS                01940021
*          CALCULATED AND A GETMAIN IS ISSUED.                          01980021
*          CORE IS CLEARED AFTER GETMAIN                                02020021
*          POINTERS TO TCB & DCB PUT INTO DEB.                          02060021
*          DEBS ARE BUILT FOR ALL DEVICES SUPPORTED BY THE SEQUENTIAL   02100021
*          ACCESS METHODS OR PARTITIONED ACCESS METHOD.                 02200021
*                                                                       02300021
*ENTRY POINT--IGG0196I                                                  02400021
*                                                                       02500021
*          ENTERED FROM IGG0191A BY XCTL                                02600021
*                                                                       02800021
*INPUT--  DCB ADDRESS                                                   02900021
*          WORK AREA ADDRESS                                            03000021
*          WHERE TO GO TABLE                                            03100021
*          PARAMETER LIST                                               03200021
*          CURRENT ENTRY IN WHERE TO GO TABLE                           03300021
*          CURRENT PARAMETER (DCB)                                      03400021
*                                                                       03500021
*OUTPUT-   AS OUTLINED BELOW :                                          03600021
*                                                                       03800021
*        BASIC DEB LAYOUT FOR ALL I/O DEVICES SUPPORTED                 03900021
*                                                                       04000021
*        **********************************                             04100021
*   -16  *I/OS* I/O SUPPORT DCB ADDRESS   *                             04200021
*   -12  *    * RESERVED                  *                             04300021
*   -08  *    * DCB MODIF MASK            *                             04400021
*   -04  *DEBL*                           *                             04500021
*   +00  *SUBL* TCB ADDRESS               *                             04600021
*   +04  *AML * DEB LINK FIELD            *                             04700021
*   +08  *DPAT* IRB ADDRESS               *                             04800021
*   +12  *FLTP* SYSTEM PUTGE CHAIN        *                             04900021
*   +16  *NEXT* USER PURGE CHAIN          *                             05000021
*   +20  *PRTY* ECB ADDRESS               *                             05100021
*   +24  *KEYD* DCB ADDRESS               *                             05200021
*   +28  *SCAL* APPENDAGE ADDRESS         *                             05300021
*        **********************************                             05400021
*                                                                       05600021
*        DEVICE DEPENDENT SECTION OF DEB                                05700021
*                                                                       05800021
* TAPE/URE                                                              05900021
*                                                                       06100021
*        **********************************                             06200021
*   +32  *DMOD*  UCB ADDRESS              *                             06300021
*   +36  *VOL SEQ NO     *NO. OF VOLS.    *                             06400021
*        **********************************                             06500021
*                                                                       06600021
* REMAINDER OF THE DEB IS BUILT IN IGG0191N.                            06700021
*                                                                       06800021
* D.A.SAM DEB.                                                          06900021
*        **********************************                             07000021
*   +32  *FMSK*  UCB ADDRESS              *                             07100021
*   +36  *EXTENT FIELD BBCCHHCCHH         *                             07200021
*   +40  *                                *                             07300021
*   +44  *               *NO.TRACKS ALL.  *                             07400021
*   +48  *VOL SEQ NO     *NO. OF VOLS     *                             07500021
*        **********************************                             07600021
*                                                                       07800021
* NOTE.+32 - +44 IS REPEATED PER EXTENT                                 07900021
*                                                                       08100021
* D.A.TO MEMBER FOR OUTPUT                                              08200021
*        **********************************                             08300021
*   +E2  *MEMBER NAME THAT IS OPENING     *                             08400021
*   +56  *MEMBER NAME THAT IS OPENING     *                             08500021
*        **********************************                             08600021
*                                                                       08800021
* DA BPAM CONCATENATION (INPUT)                                         08900021
*        **********************************                             09000021
*   +48  *DSNO DSNO  DSNO DSNO            *                             09100021
*        *EXTU EXT2  EXT3 EXT4            *                             09200021
*        **********************************                             09300021
*                                                                       09500021
*NOTE. BPAM DEB SAME AS SAM DEB WITH EXCLUSSION OF FIELD AT +48         09600021
*                                                                       09700021
*        USER LABEL EXTENT IS NOT INCLUDED IN F1 EXTENT COUNT,          09800021
*        AND IS NOT INCLUDED IN DEB EXTENTS.                            09900021
*                                                                       10000021
*        ROUTINE ALSO MERGES CLASS BYTE AND DEVICE BYTE OF UCB/SRT      10100021
*        INTO DCB FIELD (DEVT)                                          10200021
*                                                                       10300021
* EXITS - NORMAL XCTL TO IGG0196A TO CONTINUE PROCESSING                10400021
*                                                                       10600021
*TABLES/WORKAREA - SEE DSECTS AT END OF LISTING.                        10700021
*                                                                       10800021
*ATTRIBUTES- RE-ENTRANT- RE-USABLE- RUNS IN DATA MANAGEMENT KEY, Y02072 10900002
*            RUNS IN SUPERVISOR STATE                            Y02072 10950002
*                                                                       11300021
*******************************************************************     11400021
*                                                                       11600021
* MASK'S TO TEST PARAMETER LIST WITH                                    11700021
OPPATRUB EQU   0                                                        12300021
DEBBSLNG EQU   80                                                       12700021
COMMUTAB EQU   16                                                       12800021
NEXTCORE EQU   140                                                      13100021
SUBRNTID EQU   20                       SUBROUTINE ID LENGHT.           13500021
DEBXNTP  EQU   28                       DISP IN DEB PREFIX      ZA01540 13550002
*                                       TO DEB EXTENSION PTR    ZA01540 13600002
ZERO     EQU   0                        PARAMETRIC ZERO            UT18 13700021
INFLAG   EQU   X'0E'                    FLAG FOR INPUT TEST        UT18 14000021
BFTEKR   EQU   X'20'                    DCBBFTEK=R               S19015 14200021
VSBITS   EQU   X'48'                    VS BITS IN DCBRECFM      S19015 14300021
RECFMB   EQU   X'10'                    BLOCKED RECORD FORMAT    S19015 14400021
QSAMB    EQU   X'01'                    QSAM BIT                 S19015 14600021
EXCP     EQU   X'80'               EXCP                          I19119 14800021
TIOTTERM EQU   X'20'                    DEVICE IS TERMINAL (TSO) S20016 15550021
SULEXNT  EQU  X'40'                     TEST IF USER LABEL EXTENTA46645 15600021
SPLTCYL  EQU  X'80'                     TEST IF SPLT CYL ALLOC   A46645 15610021
* * * * * * * * * * * *   3525    CODE      * * * * * * * * * * * * * * 15650021
RP       EQU   X'60'                   READ/PUNCH MASK           M0053  15750021
RW       EQU   X'50'                   READ/PRINT MASK           M0053  15850021
PW       EQU   X'30'                   PUNCH/PRINT MASK          M0053  15950021
D3525    EQU   X'0C'                   3525 UCB UNIT TYPE CODE   M0053  16050021
ASSOCDS  EQU   X'04'                   ASSOC. DATASET--3525     SA53194 16100021
FUNCOFF  EQU   3                       DCBFUNC OFFSET            M0053  16150021
DEBCORE  EQU   230                      SUBPOOL NUMBER FOR DEB   Y02072 16200002
FMTFOUR  EQU   C'4'                     DSCB FORMAT 4 IDENTIFIER Y02072 16250002
*                                                                       16300021
*REGISTERS ARE REFERENCED SYMBOLICALLY WHERE APPROPRIATE                16400021
*                                                                       16500021
RDCB     EQU   2         DCB REGISTER                                   16600021
RBASE    EQU   3         BASE REGISTER                                  16700021
RCORE    EQU   4         WORK AREA ADDRESS                              16800021
RPAR     EQU   5         TOP OF PARAMETER LIST                          16900021
RWTG     EQU   6         TOP OF WTG TABLE                               17000021
RPARC    EQU   7         CURRENT PARAMETER                              17100021
RWTGC    EQU   8         CURRENT TRANS LOAD                             17200021
RTIOT    EQU   9         USED HERE AS WRK REG AND  COMM VECTOR ADDR.    17300021
RUCB     EQU   10        USED HERE AS A COUNTER IN IOB GENERATION       17400021
RDEB     EQU   11        DEB ADDRESS                                    17500021
RB       EQU   12        WORK REG1  **                                  17600021
RC       EQU   13        WORK REG2  **  USED IN IOB GENERATION          17700021
RD       EQU   14        WORK REG3  **                                  17800021
RJ       EQU   15        WORK REG4                                      17900021
RE       EQU   0         WORK REG5                                      18000021
RWK1     EQU   RE                       WORK REGISTER            Y02072 18050002
RF       EQU   1         WORK REG6                                      18100021
*                                                                       18400021
*********************************************************************** 18500021
*                                                                       18900021
         BALR  RBASE,0                                                  19000021
         USING BEGIN,RBASE                                              19100021
         USING IHADCB,RDCB                                              19200021
         USING FORCORE,RCORE                                            19300021
         USING DEB,RDEB                                                 19400021
         USING   TCB,RD                                                 19500021
         USING TIOT,RTIOT                                               19600021
         USING UCBOB,RUCB                                               19700021
*                                                                       20100021
BEGIN    EQU   *                                                        20200021
         B     START                    BRANCH AROUND MODULE ID  YM4640 20202002
         DC    C'IGG0196I'              MODULE NAME              YM4640 20204002
         DC    C' ZA14711'              LAST SHIP CODE         @ZA14711 20206037
         DC    C'02/16/77'              LAST SHIP DATE         @ZA14711 20208037
START    DS    0H                       END OF MODULE ID         YM4640 20210002
*                                                                       20300021
         L     RDCB,0(RPARC)            GET DCB ADDRESS                 20400021
         L     RCORE,4(RWTGC)           GET WORK AREA                   20500021
         L     RD,COMMUTAB         CALCULATE TCB ADDRESS                20600021
         L     RD,0(0,RD)                                               20700021
         L     RD,4(0,RD)               TCB  ADDR                       20800021
         L     RTIOT,TCBTIO                                             20900021
         AH    RTIOT,DCBTIOT       RESET TIOT POINTER                   21000021
         TM    TIOELINK,TIOTTERM        IS THIS TSO?             S20016 21030021
         BO    OBPAM074                                         ZA00631 21060003
         L     RUCB,DXUCBADR            GET UCB PTR              Y02072 21100002
         USING UCBOB,RUCB                                               25200021
         TM    UCBTBYT3,UCB3DACC        OPENING A D A DEVICE            29900021
         BC    14,OBPAM070              NO BRANCH                       30000021
         SR    RB,RB               SET NUMBER OF DS COUNTER TO ZERO     30100021
         SR    RE,RE                                                    30200021
         SR    RC,RC                                                    30300021
         IC    RC,DSCNOEXT              GET NO OF EXT OF FIRST DS       30400021
         LTR   RC,RC                    NO OF EXTENTS = 0               30500021
         BC    7,OBPAM010               NO BRANCH                       30600021
         LA    RC,1                     SUPPLY  ONE DUMMY EXTENT        30800021
         CLI   DSCFMTID,FMTFOUR         FORMAT 4 DSCB            Y02072 30850002
         BE    OBPAM010                 YES, DON'T SET VOL FULL  Y02072 30860002
         TM    DCBMACRF,X'80'           EXCP BIT ON                     30900021
         BC    1,OBPAM010               BRANCH IF EXCP                  31000021
         OI    DCBCIND1,X'20'           SET VOL FULL IND DUMMY EXT      31100021
OBPAM010 EQU   *                                                        31300021
         L     RF,DSCCORE               GET NEXT DSCB ADDR              31500021
OBPAM020 EQU   *                                                        31700021
         LTR   RF,RF                    CK FOR MORE DSCB                31800021
         BC    8,OBPAM080          BRANCH IF NONE LEFT                  31900021
         CLI   44(RF),X'F1'             CK FOR FORMAT 1                 32000021
         BC    7,OBPAM040               BR IF NO                        32100021
*                                                                       32200021
*        THERE WILL BE FORMAT 1 ONLY IF CONCATENATION IS SPECIFIED      32300021
*                                                                       32400021
         IC    RE,59(0,RF)              GET NO OF EXTENT OF NEXT DS     32500021
         LTR   RE,RE                    NO OF EXTENTS = 0               32600021
         BC    7,OBPAM030               NO BRANCH                       32700021
         LA    RE,1                     SUPPLY ONE DUMMY EXTENT         32900021
OBPAM030 EQU   *                                                        33100021
         AR    RC,RE                    FORM TOTAL NO OF EXTENT         33300021
         LA    RB,1(0,RB)               ADD ONE TO NO OF DS             33400021
OBPAM040 EQU   *                                                        33600021
         L     RF,NEXTCORE(0,RF)        GET NEXT DSCB                   33700021
         BC    15,OBPAM020                                              33800021
OBPAM060 EQU   *                                                        34000021
         CLI   JFCBELNM,X'40'           CK FOR MEMBER NAME              34100021
         BC    8,OBPAM100               BR IF NO NAME                   34200021
         LA    RDEB,8(0,RDEB)           ADD 8 BYTES FOR MEMBER NAME     34300021
         BC    15,OBPAM100                                              34400021
OBPAM070 EQU   *                                                        34600021
* * * * * * * * * * * *   3525    CODE      * * * * * * * * * * * * * * 34605021
         TM    UCBTBYT3,UCB3UREC       UNIT RECORD DEVICE?     @ZA14711 34606037
         BNO   OBPAM074                BRANCH IF NO            @ZA14711 34607037
         CLI   UCBTBYT4,D3525          IS THIS A 3525            M0053  34610021
         BNE   OBPAM074                BRANCH IF NOT A 3525      M0053  34615021
         TM    DCBMODE+FUNCOFF,RP      READ/PUNCH ASSOCIATED     M0053  34620021
*                                       DATA SET                 M0053  34625021
         BO    OBPAM072                BRAMCH IF YES             M0053  34630021
         TM    DCBMODE+FUNCOFF,RW      REAR/PRINT ASSOCIATED     M0053  34635021
*                                       DATA SET                 M0053  34640021
         BO    OBPAM072                BRANCH IF YES             M0053  34645021
         TM    DCBMODE+FUNCOFF,PW      PUNCH/PRINT ASSOCIATED    M0053  34650021
*                                       DATA SET                 M0053  34655021
         BNO   OBPAM074                BRANCH IF NOT PUNCH/PRINT M0053  34660021
OBPAM072 EQU   *                                                 M0053  34665021
         OI    DCBQSWS,ASSOCDS         TURN ON BIT              SA53194 34667021
         LA    RDEB,16                 16 BYTE EXTENT FOR AN     M0053. 34670021
*                                       ASSOC D,S                M0053  34675021
         B     OBPAM075                BRANCH TO LOAD AM SECTION M0053  34680021
*                                       SIZE                     M0053  34685021
OBPAM074 EQU   *                                                 M0053  34690021
* * * * * * * * * * *   END OF 3525 CODE   * * * * * * * * * * * * * *  34695021
         LA    RDEB,4                   ONE FOUR BYTE EXTENT FOR TAPE   34700021
OBPAM075 EQU   *                                                 A25961 34800021
         LA    RDEB,16(RDEB)            16 BYTE AM SECTION       A25961 34900021
         B     OBPAM100                                                 35000021
OBPAM080 EQU   *                                                        35200021
         LR    RDEB,RC                  TOTAL NO OF EXTENTS             35300021
         SLL   RDEB,4                   MULT BY 16 EXT SIZE             35400021
         TM    DSCFILTY,X'02'           DSORG PO                 A25961 35500021
         BNO   OBPAM075                 BR IF NO                 A25961 35600021
         TM    OPPATRUB(RPARC),X'0F'    CK FOR OUTPUT                   35700021
         BC    1,OBPAM060               BR IF YES                       35800021
         LA    RDEB,0(RB,RDEB)          ADD NO OF DS FOR INPUT          35900021
OBPAM100 EQU   *                                                        36100021
         LA    RDEB,DEBBSLNG+SUBRNTID(RDEB)  ADD BASIC AND SUBRNT ID.   36200021
         TM    TIOELINK,TIOTTERM        IS THIS TSO?             S20016 36330021
         BO    OBPAM101                 BRANCH IF YES            S20016 36360021
         TM    DCBMACRF,EXCP            BR IF EXCP,  DCBOPTCD   OX01819 36370002
         BO    OBPAM115                   DOES NOT EXIST        OX01819 36380002
         TM    UCBTBYT3,UCB3DACC        IS DEVICA DA.                   36400021
         BC    14,OBPAM101              BRANCH IF NOT.                  36500021
         TM    DSCFILTY,X'02'           DCB REFERENCING A PDS           36600021
         BZ    OBPAM101                 BRANCH, IF NOT           A25961 36700021
         NI    DCBOPTCD,X'FD'           IF PO,IGNORE INVALID     A27334 36800021
OBPAM101 EQU   *                                                 S19015 37100021
*     THE NEXT SECTION OF CODE VALIDATES THE 'R' BIT IN THE DCBBFTEK    37300021
*     FIELD, IF IT IS ON.                                               37400021
         TM    DCBCIND2,QSAMB           QSAM BEING USED          S19015 37500021
         BO    OBPAM115                 YES--CONTINUE            S19015 37600021
         TM    DCBBFTEK,BFTEKR          VS SUPPORT NEEDED        S19015 37700021
         BZ    OBPAM115                 N0--CONTINUE             S19015 37800021
         TM    DCBRECFM,VSBITS          TEST FOR VS              S19015 37900021
         BNO   OBPAM112                 NOT VS--GO TURN OFF 'R'  S19015 38000021
*                                       BIT                      S19015 38100021
         TM    DCBRECFM,RECFMB          BLOCKED RECORDS          S19015 38200021
         BO    OBPAM112                 BLOCKED RECORDS NOT      S19015 38300021
*                                       SUPPORTED                S19015 38400021
         TM    ZERO(RPARC),INFLAG       INPUT                    S19015 38500021
         BC    7,OBPAM115               NO--CONTINUE             S19015 38600021
         XC    DCBOPTCD(L'DCBOPTCD),DCBOPTCD  CLEAR DCBOPTDC FIELD      38700021
         CLI   DCBKEYLE,ZERO            ARE THERE KEYS           S19015 38800021
         BNE   OBPAM115                 YES--R BIT WILL BE LEFT  S19015 38900021
*                                       ON                       S19015 39000021
OBPAM112 EQU   *                                                 S19015 39100021
         NI    DCBBFTEK,X'FF'-BFTEKR    TURN OFF BFTEKR BIT      S19015 39200021
OBPAM115 EQU   *                                                 S19015 39500021
         LA    RE,DEBCORE               GET CORE FROM SP 230     Y02072 39700002
         SLL   RE,24                                                    39800021
         OR    RE,RDEB                  SET UP FOR GETMAIN              39900021
         ST    RE,REGSAVE0              SAVE LEN ACROSS GETMAIN  YM7574 39950002
         GETMAIN R,LV=(0)               GET CORE FOR DEB                40000021
*                                                                       40100021
*        CONSTRUCT BASIC SECTION                                        40200021
*                                                                       40300021
         ST    RF,REGSAVE1              SAVE ADDR OF CORE        YM7574 40350002
         LA    RJ,256                   GET CONSTANT OF 256        UT18 40500021
OBPAM140 EQU   *                                                   UT18 40700021
         CR    RDEB,RJ                  IS LENGTH GRTR THAN 256    UT18 40800021
         BNH   OBPAM145                 BR IF NOT GRTR THAN 256    UT18 40900021
         BCTR  RJ,0                     DECR LNGTH TO 255 FOR MOVE UT18 41000021
         EX    RJ,CLEARDEB              EXECUTE MOVE OF 256 BYTES  UT18 41100021
         LA    RJ,1(0,RJ)               RESTORE TO 256             UT18 41200021
         SR    RDEB,RJ                  SUBTRACT 256 FROM LENGTH   UT18 41300021
         AR    RF,RJ                    INCR AREA ADDR BY 256      UT18 41400021
         B     OBPAM140                 BR TO MOVE MORE BYTES      UT18 41500021
OBPAM145 EQU   *                                                   UT18 41700021
         BCTR  RDEB,0                   DECR LNGTH FOR MOVE INSTR  UT18 41800021
         EX    RDEB,CLEARDEB            MOVE LESS THAN 256 BYTES   UT18 41900021
         LM    RE,RF,REGSAVE0           RESTORE LENGTH,ADDRESS   YM7574 42100002
         LR    RJ,RE                    CLEAR HIGH ORDER BYTE      UT18 42200021
         LA    RJ,0(RJ)                 OF LENGTH REGISTER         UT18 42300021
         LA    RDEB,36(0,RF)            DEB ADDR PT TO BASIC SECTION    42400021
         ST    RDEB,DCBDEBAD            DEB ADDR INTO DCB               42500021
         MVC   DCBIFLGS(1),DCBIFLG     RESTORE IFLAGS                   42600021
         NI    DCBDEBAD,X'3F'           TURN OFF IFLAGS                 42700021
         ST    RDCB,DEBDCBAD            DCB ADDR TO DEB          Y02072 42850002
         ST    RD,DEBTCBAD              TCB ADDR INTO DEB               42900021
         ST    RF,DEBAPPAD              APP ADDR                        43000021
         MVC   DEBXNTP(4,RF),DXDEBXAD   CONNECT DEB EXTENSION   ZA01540 43050002
*                                       TO DEB PREFIX           ZA01540 43060002
         STC   RB,DEBAMLNG              NO. OF DATA SETS - 1 IF  A25961 43100021
*                                       PARTITIONED. 0 IF NOT           43200021
         LA    RJ,7(RJ)                 ROUND OFF TO DW                 43300021
         SRL   RJ,3                     LENGTH OF DEB IN DW             43400021
         STC   RJ,32(RF)                                                43500021
         MVI   DEBOFLGS,X'C0'                                           43600021
         NC    DEBOFLGS,JFCBIND2        OPEN NEW OLD MOD INDICATOR      43700021
         TM    TIOELINK,TIOTTERM        IS THIS TSO?             S20016 43730021
         BO    FINISH                   BRANCH IF YES            S20016 43760021
         TM    UCBTBYT3,UCB3DACC        OPENING A D.A DEVICE      18987 43800021
         BC    14,OBPAM120              NO BYPASS TEST FOR LAST   18987 43900021
*                                       VOLUME INDICATOR          18987 44000021
         TM    DSCDSIND,X'80'           TEST LAST VOL IND IN DSCB 18987 44100021
         BC    8,OBPAM120               NO DONT SET EOF IND       18987 44200021
         OI    DEBOFLGS,X'20'           SET EOF IN DEBOFLGS       18987 44300021
*                                                                       44600021
*    APAR 46645 RESULTED FROM A USER SPECIFYING BOTH STANDARD    A46645 44610021
*    USER LABELS AND SPLIT CYLINDER ALLOCATION. SPLIT CYLINDER   A46645 44620021
*    ALLOCATION WOULD NOT BE GIVEN TO THE USER UNDER THESE       A46645 44630021
*    CONDITIONS.                                                 A46645 44640021
OBPAM120 EQU  *                                                  A46645 44650021
         CLI  DSCEXTYP,SULEXNT          USER LABEL EXTENT?       A46645 44660021
         BNE  AROUND                    NO, DON'T TEST 2ND EXENT A46645 44670021
         CLI  DSCEXT1,SPLTCYL           SPLIT CYLINDER           A46645 44680021
*                                          ALLOCATION?           A46645 44682021
         BNE  OBPAM160                  NO, DON'T SET SPLT CYL   A46645 44690021
*                                          BIT                   A46645 44690421
         B    SPCYL                     YES, SET SPLT CYL BIT    A46645 44692021
AROUND   EQU  *                                                  A46645 44694021
         CLI  DSCEXTYP,SPLTCYL          SPLIT CYLINDER           A46645 44696021
*                                          ALLOCATION?           A46645 44696421
         BNE  OBPAM160                  NO, DON'T SET BIT        A46645 44698021
SPCYL    EQU  *                                                  A46645 44698421
         OI    DEBOFLGS,X'04'           SET INDICATOR IN DEB            44700021
OBPAM160 EQU   *                                                        44800021
         STC   RC,DEBNMEXT              STORE NO. OF EXTENTS     M4878  45000021
FINISH   EQU   *                                                        45100021
         LA    RF,SOP6A                 SET UP FOR XCTL TO       S19033 45300021
*                                       IGG0196A                 S19033 45400021
         USING WTGENTRY,RWTGC                                    Y02072 45450002
         MVC   WTGIDTTR,0(RF)           ID OF NEXT MODULE      @Z30TSCF 45460003
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)     UPDATE WHERE TO GO ENTRY        45900021
         LA    RPARC,PLOFF(0,RPARC)     UPDATE PARA LIST ENTRY          46000021
         CLC   0(2,RWTGC),AMIDCNST      THIS RT NEEDED AGAIN            46100021
         BCR   8,RBASE                  YES BR BACK TO BEGINNING        46200021
         CLC   0(2,RWTGC),OPIDCNST      END OF TABLE                    46400021
         BC    7,RELOOP                 NO BRANCH                       46500021
         LR    RPARC,RPAR                                               46700021
         LA    RWTGC,WAOFF(0,RWTG)      RE INIT  WTG LIST               46800021
ZCHEK    CLI   0(RWTGC),X'00'          IS THIS ENTRY COMPLETE           46900021
         BC    7,TCTLRTN                NO XCTL                         47000021
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY                  47200021
         LA    RPARC,PLOFF(0,RPARC)                                     47300021
         BC    15,ZCHEK                                                 47400021
TCTLRTN  EQU   *                                                        47600021
         USING WTG,RWTG                                                 47700003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*47750003
               MODID=WTGENTRY                                  @Z30TSCF 47800003
         DROP  RWTGC,RWTG                                               47850003
WAOFF    EQU   32                  OFFSET OF FIRST ENTRY IN WTG TABLE   48400021
PLOFF    EQU   4                   OFFSET OF DCB ENTRIES                48500021
WGOFF    EQU   8                   OFFSET OF WTG ENTRIES                48600021
OPIDCNST DC    C'0S'                                                    48700021
AMIDCNST DC    C'6I'                                                    48800021
SOP6A    DC    C'6A',VL3(IGG0196A)      IGG0196A - NEXT MODULE @Z30TSCF 48850003
CLEARDEB XC    ZERO(ZERO,RF),ZERO(RF)   CLEAR CORE FOR DEB         UT18 48900021
         SPACE                                                          48950002
PATCH    DC    50X'0'                   PATCH AREA               YM4640 49000002
END      EQU   *                        END OF MODULE            Y02072 49050002
*********************************************************************   50300021
SRT      DSECT                                                          50400021
         IEFUCBOB                                                       50500021
*                                                                       50600021
         EJECT                                                          50700021
           DCBD  DSORG=PS                                               50800021
CVT      DSECT                                                          50900021
         CVT                                                            51000021
*   TASK CONTROL BLOCK                                                  51100021
         CNOP  0,4                                                      51200021
TCB      DSECT                                                          51300021
TCBRBP   DS    F                       PO9NTER TO EXECUTING RB          51400021
TCBPIE   DS    F                       POINTER TO PROG. INTERRUPT EL.   51500021
TCBDEB   DS    F                       POINTER TO DEB QUEUE             51600021
TCBTIO   DS    F                       POINTER TO TIOT                  51700021
TCBCMP   DS    F                       TASK COMPLETION CODE             51800021
TCBTRN   DS    F                       TESTRAN FIELD                    51900021
TCBMSS   DS    F                       DATA BLOCK QUEUE ELEMENT POINTER 52000021
TCBPKF   DS    CL1                     RESERVED FOR FUTURE USE          52100021
TCBFLGS  DS    FL5                     FLAG BYTES                       52200021
TCBLMP   DS    CL1                     RESERVED FOR FUTURE USE          52300021
TCBDSP   DS    CL1                     RESERVED FOR FUTURE USE          52400021
TCBLLS   DS    F                       POINTER TO LOAD LIST             52500021
TCBJLB   DS    F                       POINTER TO JOBLIB DCB            52600021
TCBJSE   DS    F                       LIST OF INACTIVE PROGRAMS ADDR.  52700021
TCBGRS   DS    CL64                    GENERAL REGISTER SAVE AREA       52800021
TCBIDF   DS    CL1                     TCB IDENTIFIER FIELD             52900021
TCBFSA   DS    CL3                     POINTER TO 1ST PROB.PROG.SAVEAR  53000021
TCBTCB   DS    F                       RESERVED FOR FUTURE USE          53100021
TCBTME   DS    F                       POINTER TO TIMER ELEMENT         53200021
         DS    CL24                                                     53300021
TIOT     DSECT                                                          53400021
TIOELNGH DS    CL1                           LENGTH OF THIS ENTRY       53500021
TIOESTTA DS    CL1                           STATUS -A-                 53600021
TIOERLOC DS    CL2                           REL. LOC OF POOL           53700021
TIOEDDNM DS    2F                            DDNAME                     53800021
TIOEJFCB DS    1F                            JFCB DISK ADDR             53900021
TIOESTTB DS    0CL1                                                     54000021
TIOEFSRT DS    CL4                                                      54100021
         DS    CL1                                                      54200021
*        TIOT POOL ENTRY                                                54300021
TIOPNSLT DS    XL1                           NR.OF SLOTS FOR POOL       54400021
         DS    CL1                                                      54500021
TIOPNSRT DS    XL1                           NR.OF DEVICES (FILLED      54600021
*                                             SLOTS)                    54700021
TIOPPOOL DS    CL8                           POOL NAME                  54800021
TIOPSTTB DS    XL1                           STATUS OF SLOT             54900021
TIOPSLOT DS    XL3                           SRT ADDRESS OR EMPTY SLOT  55000021
TIOTFEND DS    1F                            FINAL END OF AN ENTRY      55100021
TIOELINK EQU   TIOERLOC+1                                        S20016 55150021
         SPACE 1                                                        55200021
*   DATA EXTENT BLOCK  (UNTIL PROTIOS CHANGES)                          55300021
DEB      DSECT                                                          55400021
DEBNMSUB DS    0CL1                                                     55500021
DEBTCBAD DS    CL4                                                      55600021
DEBAMLNG DS    0CL1                                                     55700021
DEBDEBAD DS    CL4                                                      55800021
DEBOFLGS DS    0CL1                                                     55900021
DEBIRBAD DS    CL4                                                      56000021
DEBOPATB DS    0CL1                                                     56100021
DEBSYSPG DS    CL4                                                      56200021
DEBNMEXT DS    0CL1                                                     56300021
DEBUSRPG DS    CL4                                                      56400021
DEBPRIOR DS    0CL1                                                     56500021
DEBECBAD DS    CL4                                                      56600021
DEBPROTG DS    0CL1                                                     56700021
DEBDEBID DS    0CL1                                                     56800021
DEBDCBAD DS    CL4                                                      56900021
DEBEXSCL DS    0CL1                                                     57000021
DEBAPPAD DS    CL4                                                      57100021
DEBDVMOD DS    0CL1                                                     57200021
DEBUCBAD DS    CL4                                                      57300021
DEBTVLSQ DS    0CL2                VOL SEQ FOR TAPE                     57400021
DEBBINUM DS    CL2                                                      57500021
DEBTVLNM DS    0CL2                NO OF VOL FOR TAPE                   57600021
DEBSTRCC DS    CL2                                                      57700021
DEBSTRHH DS    CL2                                                      57800021
DEBENDCC DS    CL2                                                      57900021
DEBENDHH DS    CL2                                                      58000021
DEBNMTRK DS    CL2                                                      58100021
*  FOR ADDITIONAL EXTENT ON DIRECT ACCESS THE FOLLOWING FIELDS          58200021
*  WILL HAVE TO BE OFFSET ANOTHER 16 BYTES                              58300021
DEBVOLSQ DS    H                                                        58400021
DEBVOLNM DS    H                                                        58500021
*  FOR EACH SUBROUTINE LOADED BUMP THIS OFFSET BY 2                     58600021
DEBSUBID DS    H                                                        58700021
         TITLE 'IGG0196I - FORMAT OF GOTTEN CORE'                       58800002
         IECDSECS  (MAIN,(IOB,NO)),WTG,PREFX,EXPAND=YES        @Z30TSCF 58850003
         ORG   WTGIDTTR                                          Y02072 58900002
WTGID    DS    CL2                                               Y02072 58950002
CCWOFSET EQU   DXCCW12-FORCORE     CCW RELOCATABLE OFF SET FOR DXCCW12  59100021
FORCORE  DSECT                                                   YM7829 59110002
REGSAVE0 EQU   DXCCW11                  SAVE AREA FOR REG 0      YM7829 59150002
REGSAVE1 EQU   DXCCW11+4                SAVE AREA FOR REG 1      YM7829 59200002
           END                                                          59300021
