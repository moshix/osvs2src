197E TITLE  'IGG0197E - LOADS FCB, ANALYZES MESSAGES '                  00060037
IGG0197E CSECT                                                          00070021
*MODULE NAME - IGG0197E                                          Y02072 00072002
*                                                                       00074002
*DESCRIPTIVE NAME - FCB LOAD AND MESSAGE ANALYSIS                Y02072 00076002
*                                                                       00078002
*COPYRIGHT - NONE                                                Y02072 00078402
*                                                                       00078802
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00079202
*                                                                M0099  00080021
*0981409000-410000                                               M0084  00120021
*0981                                                            S21092 00150021
*0981001000,645000-655000                                        M0092  00170021
*136800,235240,669200-669600                                     M0191  00180021
*        VS1 RELEASE 01 DELETIONS                                       00182002
*120000,128000,323000,324000,325000                              YM3213 00184001
*                                                                       00200020
*        VS2 RELEASE 02 DELETIONS                                Y02072 00202002
*000620,001820,001860,002500,053000,075000,146000,162000,202500, Y02072 00204002
*204600,308000,329000-331000,357000-362000,445000-447000,        Y02072 00206002
*618000-627600,650000,032000-039000,571000,601000-602000,        Y02072 00208002
*606000,617000,650000                                            Y02072 00208402
*                                                                YM4697 00208802
*                                                                       00209203
*        VS2 RELEASE 3 DELETIONS                                        00209603
*                                                              @Z30TSCF 00209703
*C495100                                                       @ZA12979 00209837
*D498000-506100                                                @ZA12979 00209937
*C157700-157760                                                @ZA20901 00210037
*A279500-282500                                                @ZA20901 00210137
*C157700,157760                                                @ZA25670 00210237
*A297700,297800                                                @ZA25670 00220237
*C157700-157760                                                @ZA28402 00225237
*A282500,283100                                                @ZA28402 00226237
*A293500                                                       @ZA32079 00230237
*C635500-636000                                                @ZA01357 00240237
*                                                                       00250237
*FUNCTION/OPERATION - ISSUE WAIT FOR OPERATOR REPLY TO MESSAGE   Y02072 00310002
*                     IEC129 IF REQUIRED                         Y02072 00360002
*                   - DETERMINE IF FCB IMAGE IS SPECIFIED IN     Y02072 00410002
*                     DCB EXIT LIST:                             Y02072 00460002
*                     A) IF YES, USE IT                          Y02072 00510002
*                     B) IF NO, ISSUE BLDL TO LOCATE IMAGE IN    Y02072 00560002
*                        SYS1.IMAGELIB                           Y02072 00610037
*                        ISSUE LOAD TO READ IMAGE INTO MAIN STG  Y02072 00660002
*                        SET AN AUDIT TRAIL BIT INDICATING TO    YM4697 00710002
*                        FORCE CLOSE THAT AN FCB IMAGE HAS BEEN  YM4697 00760002
*                        LOADED                                  YM4697 00770002
*                   - WHEN FCB IMAGE IS NOT FOUND IN SYS1.IMAGELIB      00800037
*                     ISSUE MESSAGE TO REQUEST AN OPERATOR TO SPECIFY   00900020
*                     AN ALTERNATE FCB IMAGE                            01000020
*                   - ANALYZE REPLY FROM OPERATOR                Y02072 01100037
*                   - LOAD FCB IMAGE INTO FCB                           01350002
*                   - DETERMINE NEXT EXECUTOR TO XCTL TO.               01400020
*                                                                       01450002
*ENTRY POINT - ENTRY IS FROM IGG0191T,IGG0191V, OR IGG0197U BY   Y02072 01500002
*              USE OF XCTL MACRO                                        01600020
*                                                                       01700020
*INPUT - DCB ADDRESS                                                    01800020
*      - OPEN WORK AREA ADDRESS                                         01900020
*      - WHERE-TO-GO TABLE                                              02000020
*      - PARAMETER LIST                                                 02100020
*      - CURRENT ENTRY IN WTG TABLE                                     02200020
*      - CURRENT PARAMETER (DCB)                                        02300020
*      - REPLY IN OPEN WORK AREA                                        02400020
*                                                                       02500020
*OUTPUT - THE ADDRESS OF FCB RETRIEVED FROM SYS1.IMAGELIB               02600037
*       - A REQUEST TO AN OPERATOR TO SPECIFY ALTERNATE FCB IMAGE       02700020
*         'IEC127D XXX,IMAGE ID,FCB IMAGE NOT FOUND'                    02800037
*                                                                       02900020
*EXTERNAL REFERENCES - MESSAGE CSECT                             Y02072 03000002
*                                                                       03100020
*EXIT - NORMAL - IGG0197F FOR ALL CONDITIONS                     Y02072 03200002
*                                                                       04000020
*EXIT - ERROR - XCTL TO IGG0197F FOR THE FOLLOWING CONDITIONS    Y02072 04050002
*               TO GET A DMABCOND ISSUED:                        Y02072 04100002
*               1- PERMANENT I/O ERROR FROM BLDL                 Y02072 04150002
*               2- OPERATOR REPLIED CANCEL TO MESSAGES IEC129    Y02072 04200002
*                  OR IEC127                                     Y02072 04250002
*                                                                       04900020
*TABLES/WORK AREAS- OPEN WORK AREA     (SEE IECDSECTS)                  05000020
*                 - WHERE-TO-GO TABLE  (SEE LISTING OF IGG0191B)        05100020
*                                                                       05150002
*MACROS-ACTION:MODESET, BLDL, LOAD, EXCP, WAIT, DELETE, XCTL,    Y02072 05160002
*              XCTLTABL                                          Y02072 05170002
*                                                                       05172002
*MACROS-MAPPING:IGGMSG, DCBD, IECDSECT, IEFUCBOB, CVT, IGGSCW,   Y02072 05180002
*               IHAFCAUD                                         YM4697 05190002
*                                                                       05200020
*ATTRIBUTES - REENTRANT, REUSABLE, RUNS IN DATA MANAGEMENT KEY   Y02072 05300002
*             UNLESS OTHERWISE SPECIFIED, SUPER STATE            Y02072 05350002
*                                                                       05400020
*NOTES - USES BLDL MACRO TO LOCATE FCB IMAGE IN SYS1.IMAGELIB           05480037
*      - USES LOAD MACRO TO LOAD FCB IMAGE FROM SYS1.IMAGELIB           05560037
*     -  USES EXCP/WAIT MACRO TO LOAD IMAGE IN TO BUFFER                05650002
*      - USES WTO/WTOR SVC TO REQUEST OPERATOR REPLYS                   05700020
*      - USES DELETE MACRO TO DELETE FCB IMAGE IF NOT USEABLE           05800020
*      - BEFORE ISSUING A WTO/WTOR, THE MESSAGE TEXT MUST FIRST  Y02072 05860002
*        BE EXTRACTED FROM A MESSAGE CSECT.                      Y02072 05870002
*                                                                       05900020
         EJECT                                                          05950002
*********************************************************************** 06000020
*                                                                       06100020
*   REGESTER CONVENTIONS USED THRUOUT ALL OPEN PASSES                   06200037
*                                                                       06300020
*********************************************************************** 06400020
*                                                                       06500020
RE       EQU   0                        WORK/PARAMETER REGISTER         06600020
RWK1     EQU   RE                       WORK REGISTER            Y02072 06650002
RF       EQU   1                        WORK/PARAMETER REGISTER         06700020
RWK2     EQU   RF                       WORK REGISTER            Y02072 06750002
RDCB     EQU   2                        ADDRESS OF USER'S DCB           06800020
RBASE    EQU   3                        BASE REGISTER                   06900020
RCORE    EQU   4                        ADDRESS OF OPEN WORK AREA       07000020
RPAR     EQU   5                        PARAMETER LIST                  07100020
RWTG     EQU   6                        START OF WTG TABLE              07200020
RPARC    EQU   7                        CURRENT ENTRY IN PARAMETER LIST 07300020
RWTGC    EQU   8                        CURRENT ENTRY IN WTG TABLE      07400020
RWK3     EQU   9                        WORK REGISTER            Y02072 07500002
RUCB     EQU   10                       UCB ADDRESS/WORK REGISTER       07600020
RDEB     EQU   11                       DEB ADDRESS                     07700020
RWK5     EQU   RDEB                     WORK REGISTER            Y02072 07750002
RB       EQU   12                       WORK REGISTER/BREG FOR DSECT    07800020
RC       EQU   13                       WORK REGISTER                   07900020
RWK6     EQU   RC                       WORK REGISTER            Y02072 07950002
RD       EQU   14                       WORK/PARAMETER REGISTER         08000020
RJ       EQU   15                       WORK/PARAMETER REGISTER         08100020
RWK7     EQU   RJ                       WORK REGISTER            Y02072 08150002
*                                                                       08200020
*********************************************************************** 08300020
*                                                                       08400020
*   EQUATE WTG OFSET                                                    08500020
*                                                                       08600020
WGOFF    EQU   8                        OFFSET OF CURRENT WTG ENTRIES   08700020
PLOFF    EQU   4                        OFFSET OF CURRENT DCB ENTRIES   08800020
WAOFF    EQU   32                       OFFSET OF 1ST ENTRY IN WTG TAB  08900020
FCBOPTNS EQU   X'05'                    FCB OPTION DISPLACEMENT         09000020
*                                                                       09100020
**********************************************************************  09200020
*                                                                       09300020
*   GENERAL EQUATES                                                     09400020
*                                                                       09500020
*********************************************************************** 09600020
*                                                                       09700020
FOUR     EQU   X'04'                                                    10100020
TWO      EQU   2                        CONSTANT                        10150020
BLANK    EQU   X'40'                                                    10300020
NULL     EQU   X'00'                                                    10400020
NOREPETS EQU   X'05'                                                    10600020
COMMA    EQU   C','                                                     10700020
VERFYCN2 EQU   C'V'                                                     10900020
ALIGNCN2 EQU   C'A'                                                     11000020
ALIGNMSK EQU   X'80'                                                    11200020
VERFYMSK EQU   X'40'                                                    11300020
EXCPMASK EQU   X'80'                                                    11700020
BUFCNTRL EQU   X'01'                                                    11800020
PCIMASK  EQU   X'20'                                                    11900020
CORTRANS EQU   X'40'                    MASK FOR CORE TRANSFER   Y02072 12100002
EXLSTEND EQU   X'80'                    END OF EXIT LIST FLAG           12200020
FCBMASK  EQU   X'10'                    MASK FOR FCB ENTRY DCBXLST      12300020
FCBENDMK EQU   X'90'                    FCB AT END OF DCB EXLIST        12400020
UCBFCBOF EQU   X'08'                    FCB OFFSET IN UCB WORK AREA     12600020
ABEND    EQU   X'FF'                   ABEND SWITCH                     12700020
LNIEC124 EQU   X'34'                    LENGTH OF IEC124 MESS1G5        12900020
SUCCFLCC EQU   X'7F'                    SUCCESSFUL COMPLETION CODE      13000020
SILION   EQU   X'20'                    SET SILI BIT           @ZAXXXXX 13050037
FCBLDCC  EQU   X'63'                    COMMAND CODE=LOAD FCB           13100020
FCBLTHOS EQU   X'01'                    FCB IMAGE LENGTH OFFSET         13200020
BSTFCBIM EQU   X'02'                    BYTES TO START OF FCB IMAGE     13300020
UNRLBMSK EQU   X'42'                    UNRELATED BIT MASK              13500020
NRETRYS  EQU   X'02'                    NUMBER OF TIMES TRY TO LOAD FCB 13600020
STGETWO  EQU   X'C7'                    ENTRY FLAG FOR 197F      Y02072 13630002
TWENTY6  EQU   26                       CONSTANT                        13660020
PRT2245  EQU   X'0B'                    MASK FOR 2245 PRINTER    S21092 13670021
F2245ID  EQU   C'K'                    CONSTANT FOR 2245 ID'S     M0191 13680021
IEC129RQ EQU   X'80'                    191T, 191V, OR 197U      Y02072 13686602
*                                         ISSUED MSG IEC129;     Y02072 13688602
*                                         MUST WAIT ON OPER REP  Y02072 13690602
*                                                                       13714202
*  THE FOLLOWING MESSAGE NUMBERS ARE EQUAL TO THEIR POSITION     Y02072 13720802
*  IN THE MESSAGE CSECT (RELATIVE TO ZERO), MULT BY 2 (LENGTH    Y02072 13727402
*  OF AN INDEX).                                                 Y02072 13734002
*                                                                       13740602
MSG124   EQU   11*2                     MESSAGE NO IN MSG CSECT  Y02072 13747202
MSG125   EQU   9*2                      MESSAGE NO IN MSG CSECT  Y02072 13753802
MSG127   EQU   12*2                     MESSAGE NO IN MSG CSECT  Y02072 13760402
FCBIMLNG EQU   4                        LENGTH OF FCB IMAGE NAME Y02072 13767002
OABD101  EQU   101                      PROB DETERMINE CODE      YM3213 13773602
OABD102  EQU   102                      PROB DETERMINE CODE      YM3213 13780202
OABD103  EQU   103                      PROB DETERMINE CODE      YM3213 13786802
*                                                                       13793402
         EJECT                                                          13800002
         BALR  RBASE,0                  INITIALIZE BASE REGISTER        14000020
         USING *,RBASE                                                  14100037
         USING FORCORE,RCORE                                            14200020
         USING UCBOB,RUCB                                               14300020
         USING IHADCB,RDCB                                              14400020
         USING DEB,RDEB                                                 14500020
*                                                                       14700020
*                                                                       15100020
*********************************************************************** 15200020
*                                                                       15300020
*   INITIALIZE REGISTERS                                                15400020
*                                                                       15500020
*********************************************************************** 15600020
*                                                                       15700020
         B     AROUND                   BR AROUND CONSTANTS      Y02072 15750002
         DC    C'IGG0197E'              MODULE NAME              Y02072 15760002
         DC    C'@ZA32079'              LAST SHIP CODE         @ZA32079 15770037
         DC    C'04/26/78'              LAST DATE MODIFIED     @ZA32079 15776037
AROUND   DC    0H'0'                                             Y02072 15790037
*                                                                       15792002
         L     RDCB,0(RPARC)            LOAD  CURRENT DCB ADDRESS       15800020
         L     RCORE,4(RWTGC)           LOAD  CURRENT WORK AREA ADDRESS 15900020
         L     RDEB,DCBDEBAD            LOAD  DEB ADDRESS FROM DCB      16000020
         L     RUCB,DEBUCBAD            LOAD UCB ADDRESS FROM DEB       16100020
         DROP  RDEB                                              Y02072 16200002
*                                                                       16220020
*                                                                       16300020
*********************************************************************** 16400020
*                                                                       16500020
*   TEST THE ENTRY SWITCH TO DETERMINE REQUIRED OPERATION               16600020
*    (DXFCBSW1)       X'02' ENTRY FROM WTOR                             16900002
*                                                                       17000020
*********************************************************************** 17100020
*                                                                       17200020
         TM    DXFCBSW1,IEC129RQ        WAS MSG IEC129 ISSUED BY Y02072 17250002
*                                         AN EARLIER LOAD        Y02072 17300002
         BO    FCB1100                  YES, GO WAIT ON REPLY    Y02072 17350002
*                                                                       17400002
**********************************************************************  17800020
*                                                                       17900020
*   CORE TRANSFER ROUTINE FOR FCB IMAGES                                18000020
*   * CK IF THE FCB IMAGE TO BE LOADED IS SPECIFIED IN THE DCBEXLST     18100020
*     YES-GO LOAD THE FCB IMAGE FROM THE DCBEXLST ADDRESS               18200020
*     NO -GO TO BLDL ROUTINE TO LOCATE IMAGE IN SYS1.IMAGELIB           18300020
*                                                                       18400020
**********************************************************************  18500020
*                                                                       18600020
FCB1030  EQU   *                                                        18700020
*                                                                       18800020
         L     RB,DCBRECFM              GET ADDR OF DCBEXLST            18900020
         LA    RB,NULL(RB)              CLEAR ZERO BYTE                 19000020
         LTR   RB,RB                    TEST IF DCBEXLST PRESENT        19100020
         BZ    FCB1060                  NO GO TO BLDL ROUTINE           19200020
         MODESET  KEYADDR=DXUKEY,WORKREG=15  GET INTO USER KEY   Y02072 19250002
*                                                                       19300020
*   YES CHECK IF FCB ENTRY IN DCB EXIT LIST                             19400020
*                                                                       19500020
FCB1040  EQU   *                                                        19600020
*                                                                       19700020
         CLI   NULL(RB),FCBMASK         CK IF ENTRY SPECIFIES FCB ADDR  19800020
         BE    FCB1050                  YES CK IF FCB IMAGE ID=FCB IM   19900020
*                                       SPECIFIED IN DD STATEMENT       20000020
         CLI   NULL(RB),FCBENDMK        FCB MASK AT END OF DCB EXLST    20050020
         BE    FCB1050                  IF SO GO CK IF IM=IMIN DD STS   20100020
*                                                                       20150020
         TM    NULL(RB),EXLSTEND        CK FOR END OF DCB EXLIST        20200020
         BO    FCB1055                  IF SO GO TO BLDL ROUTINE Y02072 20250002
*                                                                       20300020
FCB1045  EQU   *                                                        20400020
*                                                                       20420020
         TM    NULL(RB),EXLSTEND        CK FOR END OF DCB EXIT LIST     20440020
         BO    FCB1055                 IF SO GO TO BLDL ROUTINE  Y02072 20460002
*                                                                       20500020
         LA    RB,FOUR(RB)              INCREMENT TO NEXT EXLST ENTRY   20600020
         B     FCB1040                  GO CK NXT EXLST ENTRY           20700020
*                                                                       20800020
*   CK IF FCB SPECIFIED IN DD STATEMENT CORRESPONDS TO IMAGE IN CORE    20900020
*                                                                       21000020
FCB1050  EQU   *                                                        21100020
*                                                                       21200020
         L     RD,NULL(RB)              GET FCB IMAGE ADDR FROM EXLST   21300020
         LA    RD,NULL(RD)              CLEAR HIGH ORDER BYTE           21400020
         CLC   DXFCBID,0(RD)            CK IF FCB ID'S ARE EQ    Y02072 21450002
         BNE   FCB1045                  NO GO BACK TO EXLST             21600020
         LA    RB,FOUR(RD)              YES PUT ADDR OF FCB IMAGE IN    21700020
*                                         REGISTER                      21702002
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 21710002
         SPACE                                                          21720002
         OI    DXFCBSW1,CORTRANS        INDIC USER SUPPLIED IM   Y02072 21730002
         B     FCB1070                  GO LOAD IMAGE INTO FCB BUFFER   21900020
*********************************************************************** 22000020
*                                                                       22100020
*   BLDL ROUTINE TO LOCATE FCB IMAGE IN SYS1.IMAGELIB                   22150037
*                                                                       22200020
*********************************************************************** 22250020
*                                                                       22300020
FCB1055  EQU   *                       GET INTO DATA MANAG KEY   Y02072 22350002
         MODESET  EXTKEY=DATAMGT                                 Y02072 22360002
FCB1060  EQU   *                                                        22400020
*                                                                       22500020
         MVC   DXBLDL,BLDLCNST          MOVE BLDL LEN TO LIST    Y02072 23350002
         MVC   DXBLDLIM,FCBCONST        MOVE 'FCB2' INTO NAME    Y02072 23360002
         CLI   UCBTBYT4,PRT2245        CHECK FOR 2245 PRINTER    S21092 23508021
         BNE   FCB1067                 NO, SKIP NEXT INSTRUCTION S21092 23516021
         MVI   DXBLDLIM+3,F2245ID       MOVE 'K' IN 4TH BYTE OF  Y02072 23518002
*                                      IMAGE ID (FCBK)           M0191  23532021
*                                                                       23540021
*********************************************************************** 23548021
*                                                                       23556021
FCB1067  EQU   *                                                 S21092 23564021
*                                                                       23572021
*********************************************************************** 23580021
*                                                                       23588021
         MVC   DXIMGNAM,DXFCBID         MOVE FCB NAME FROM JFCB  Y02072 23598002
*                                         TO BLDL LIST           Y02072 23598402
*                                                                       23700020
*   GET ADDRESS OF SYS1.IMAGELIB AND LOAD IT INTO REGISTER 1            23800037
*                                                                       23900020
         L     RF,DXIMGDCB              GET ADDR OF IMGLIB DCB   Y02072 23950002
         LA    RE,DXBLDL                GET ADDR OF BLDL LIST    Y02072 23960002
*                                                                       24200020
         BLDL  (1),(0)                  BLDL THE FCB DATA INTO CORE     24300020
*                                                                       24400020
*    TEST RETURN CODES FROM THE BLDL WHICH ARE FOUND IN REG.15 (RJ)     24500020
*        X'00' - IMAGE FOUND                                            24600020
*        X'04' - IMAGE NOT FOUND                                        24700020
*        X'08' - PERMANENT I/O ERROR                                    24800020
*                                                                       24900020
         LA    RD,FOUR                  SET  X'04' TO TEST RETURN CODE  25000020
         CLR   RD,RJ                    TEST RETURN CODE                25100020
         BE    FCB1080                  IMAGE NOT FOUND GO ISSUE IEC127 25200020
         BL    FCB1230                  PERMANENT I/O ERROR GO TO ABEND 25300020
*                                       IMAGE FOUND LOAD FCB IMAGE      25400020
*                                                                       25500020
*********************************************************************** 25600020
*                                                                       25700020
*   LOAD FCB IMAGE FROM SYS1.IMAGELIB                                   25800037
*                                                                       25900020
*********************************************************************** 26000020
*                                                                       26100020
         LA    RE,DXBLDLIM              LOAD ADDR OF BLDL LIST   Y02072 26150002
         L     RF,DXIMGDCB              GET ADDR OF IMAGELIB DCB Y02072 26160037
*                                                                       26400020
         LOAD  DE=(0),DCB=(1)           LOAD FCB FROM SYS1.IMAGELIB     26500020
*                                                                       26600020
         LR    RB,RE                    SAVE ADDRESS OF FCB IMAGE       26700020
         MVC   DXSAVFCB,DXBLDLIM        SAVE FCB ID FOR DELETE   Y02072 26750002
         OI    FCAOPEN2,FCAOFCBL        INDIC FCB IMAGE LOADED   YM4697 26752002
*                                                                       27100020
*********************************************************************** 27200020
*                                                                       27300020
*   ISSUE EXCP TO LOAD BUFFER                                           27400002
*                                                                       27500020
*********************************************************************** 27600020
*                                                                       27700020
FCB1070  EQU   *                                                        27800020
*                                                                       27900020
         L     RC,UCBXTADR             LOAD UCB EXTEN ADDRESS  @ZAXXXXX 27950037
         TM    5(RC),X'01'             FCB PARITY ERROR        @ZA20901 28000037
         BO    FCB1071                 YES- RELOAD FCB IMAGE   @ZA20901 28050037
         USING UCBUCS,RWK6                                     @ZA20901 28100037
         CLC   DXFCBID,UCBFCBID        FCBIMAGE ALREADY LOADED @ZA20901 28110037
         DROP  RWK6                                            @ZA20901 28120037
         BE    FCB1191                 YES-GO TEST FOR VERIFY  @ZA20901 28150037
FCB1071  EQU   *                                               @ZA20901 28200037
         MODESET EXTKEY=SUPR           GET INTO SUPERVISOR KEY @ZA28402 28250037
         NI    5(RC),X'FE'             TURN OFF FCB PARITY ERR @ZA20901 28280037
         MODESET EXTKEY=DATAMGT        BACK TO DATA MGT KEY 5  @ZA28402 28310037
         LA    RC,NRETRYS               SET TO RETRY FCB LOAD ONCE      28400020
         XC    DXCCW1(8),DXCCW1         RESET CCW TO ZEROS              28700037
         MVI   IOBFLAG1,UNRLBMSK        SET IOB FLAG UNRELATED BIT ON   28800020
         LA    RE,BSTFCBIM(RB)          GET ADDRESS OF FCB IMAGE TO LD  28900020
         ST    RE,DXCCW1                STORE ADDR OF FCB IMAGE IN CCW  29000020
*                                                                       29002002
*  GET INTO KEY 0 AS WE COULD BE MOVING FROM USER KEY TO DATA    Y02072 29012002
*  MANAGEMENT KEY                                                Y02072 29014002
*                                                                       29030002
         MODESET  EXTKEY=SUPR                                    Y02072 29050002
         MVC   DXCCW1+7(1),FCBLTHOS(RB) STORE LNGTH OF FCB IMAGE IN CCW 29100020
         MVI   DXCCW1,FCBLDCC           MOVE COMMAND CODE=LOAD FCB INTO 29200020
*                                       CCW                             29300020
         MVI   DXCCW1+4,SILION          SET SILI ON            @ZA32079 29350037
*                                                                       29400020
*   ISSUE EXCP AND WAIT FOR COMPLETION OF FCB LOAD                      29500020
*                                                                       29600020
FCB1073  EQU   *                                                        29700020
         L     RF,UCBXTADR              LOAD UCB EXTENSION ADDR  M0092  29720021
         MVC   8(4,RF),DXFCBID          PUT FCB IMAGE ID INTO    Y02072 29730002
*                                       UCB EXTENSION AREA            * 29760021
         MVC   5(1,RF),0(RB)            PUT FCB OPT INTO UCB   @ZA25670 29770037
*                                       EXTENSION              @ZA25670 29780037
         MVI   DXECB,NULL               CLEAR REPLY ECB                 29800020
         LA    RF,DXIOB                 LOAD IOB ADDRESS IN REGISTER 1  29900020
*                                                                       30000020
         EXCP  (1)                      ISSUE EXCP                      30100020
*                                                                       30200020
         LA    RF,DXECB                 LOAD ECB ADDRESS IN REG 1       30300020
*                                                                       30400020
         WAIT  ECB=(1)                  ISSUE WAIT                      30500020
*                                                                       30600020
         CLI   DXECB,SUCCFLCC           CK IF FCB LOAD SUCCESSFUL       30700020
         BE    FCB1191                  YES GO CK OPTION BITS    Y02072 30800002
*                                       NO ERROR CONDITION EXIST        30900020
*                                                                       31000020
*********************************************************************** 31100020
*                                                                       31200020
*   IF ERROR CONDITIONS EXIST, RETRY FCB LOAD ONE TIME                  31300002
*                                                                       31400020
*********************************************************************** 31500020
*                                                                       31600020
         BCT   RC,FCB1073               GO RETRY EXCP ONCE              31700020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 31750002
*                                                                       31800020
*********************************************************************** 31900020
*                                                                       32000020
*   IF A PERMANENT I/O ERROR OCCURED DURING AN FCB LOAD THE UCB IS      32100020
*   UP DATED WITH X'00' TO SHOW FCB NOT USABLE.                         32200020
*                                                                       32600020
*                                                                       32700020
*********************************************************************** 32800020
         LA    RWK5,MSG124              MESSAGE NO FOR MSG RTN   Y02072 32850002
         BAL   RWK6,GETMSG              GET MESSAGE              Y02072 32900002
         USING MSGENTRY,RWK2                                     Y02072 32950002
         IC    RWK7,MSGOFF1             OFFSET TO FIRST VAR FLD  Y02072 33000002
         LA    RWK3,8(RWK7,RCORE)       ADDRESS OF VAR FLD       Y02072 33050002
         MVC   0(L'UCBNAME,RWK3),UCBNAME  DEV NAME TO MSG        Y02072 33100002
         DROP  RWK2                                              Y02072 33150002
         LA    RF,MSGLSTSZ              LOAD ADDRESS FOR WTO            33400020
*                                                                       33500020
         SVC   35                       ISSUE WTO SVC                   33600020
*                                                                       33700020
         MVI   DXFCBOPT,OABD102         INTERNAL CODE 102        Y02072 33750002
*                                                                       33900020
FCB1075  EQU   *                                                        34000020
*                                                                       34100020
         MVI   DXSTAGE2,ABEND           SET ABEND SW             Y02072 34150002
         B     FCB1198                  GO LOAD ADDR IGG0197F           34400020
*                                                                       34500020
FCB1080  EQU   *                                                        34600020
*********************************************************************** 34700020
*                                                                       34800020
*   WTOR SEQUENCE FOR FCB IMAGE NOT FOUND REQUESTING OPERATOR REPLY     34900020
*   'IEC127D XXX,IMAGE ID FCB IMAGE NOT FOUND'                          35000020
*   OPERATOR REPLYS:                                                    35100020
*   'REPLY XX,'TEXT'' WHERE THIS IS AN ALTERNATIVE FCB IMAGE ID         35200020
*   'REPLY XX,'U'     USE CURRENT FCB IMAGE                             35300020
*   'REPLY XX,'C'     CANCEL.                                           35400020
*                                                                       35500020
*********************************************************************** 35600020
         LA    RWK5,MSG127              MESSAGE NO FOR MSG RTN   Y02072 35610002
         BAL   RWK6,GETMSG              GO GET MSG               Y02072 35620002
         USING MSGENTRY,RWK2                                     Y02072 35670002
WTO127   EQU   *                                                 Y02072 36282002
         IC    RWK7,MSGOFF1             OFFSET TO FIRST VAR FLD  Y02072 36286002
         LA    RWK3,MSGAREA(RWK7)       ADDRESS OF FIRST VAR FLD Y02072 36288402
         MVC   0(L'UCBNAME,RWK3),UCBNAME  MOVE DEV NAME TO MSG   Y02072 36288802
         IC    RWK7,MSGOFF2             OFFSET TO SECOND VAR FLD Y02072 36289202
         LA    RWK3,MSGAREA(RWK7)       ADDRESS OF SEC VAR FLD   Y02072 36289602
         MVC   0(FCBIMLNG,RWK3),DXCCW10+4  FCB IMAGE TO MSG      Y02072 36289702
         DROP  RWK2                                              Y02072 36290002
*********************************************************************** 36300020
*                                                                       36400020
*   WTOR ROUTINE                                                        36500020
*                                                                       36600020
***                                                                   * 36700020
*                                                                       36800020
FCB1090  EQU   *                                                        36900020
*                                                                       37000020
         XC    RPLY(24),RPLY            ZERO OUT REPLY AREA AND ECB     37200020
*                                                                       37400020
         LA    RF,REPLYLTH              LOAD WTOR ADDRESS FOR SVC.      37500020
         SVC   35                       ISSUE WTOR SVC                  37600020
FCB1100  EQU   *                                                        37700020
         LA    RF,RPLYECB               GET ADDRESS OF REPLY ECB        37800020
*                                                                       37900020
         WAIT  ECB=(1),LONG=YES         WAIT ON REPLY            Y02072 38000002
*                                                                       38100020
*********************************************************************** 38200020
*                                                                       38300020
*   REPLY ANALYSIS                                                      38400020
*   (1) 'U' - USE CURRENT FCB IMAGE                                     38500020
*   (2) 'CANCEL'/'C' - FCB IMAGE NOT AVAILABLE                          38600037
*   (3) 'FCB ID' - FCB ID WITH OPTIONS                                  38700020
*                                                                       38800020
*********************************************************************** 38900020
         OC    RPLY(8),LOMASK           OR TO ALLOW LOWER CASE REPLY    39000020
         CLC   RPLY(2),RPLYEQU          CK IF REPLY = 'U '              39100020
         BE    FCB1125                  GO SET UP FOR LOAD       Y02072 39400002
         CLC   RPLY(4),REPLYUSE         OPERATOR REPLIED 'USE '         39430020
         BE    FCB1125                  GO SET UP FOR LOAD       Y02072 39460002
         CLC   RPLY(6),RPYEQCAN         CHECK IF REPLY V'CANCEL '       39530020
         BE    FCB1120                  GO SET CANCEL RET CODE & ABEND  39600020
         CLC   RPLY(2),RPLYEQC          CK IF REPLY = 'C '              39700020
         BNE   FCB1130                  GO TEST FCB PARAMETERS          39800020
*                                                                       39900020
FCB1120  EQU   *                                                        40000020
*                                                                       40100020
*********************************************************************** 40200020
*                                                                       40300020
*   SPECIFIED FCB IMAGE NOT FOUND IN SYS1.IMAGELIB,JOB STEP CANCELED    40400020
*   BY OPERATOR.                                                        40500001
*                                                                       40600020
*********************************************************************** 40700020
*                                                                       40800020
         MVI   DXFCBOPT,OABD103         INTERNAL CODE 103        Y02072 40850002
         B     FCB1075                  GO TO SETUP ABEND        M0084  41000021
*                                                                       41050002
*********************************************************************** 41060002
*                                                                       41060402
*   OPERATOR REPLIED 'U' TO MESSAGE IEC127 - GET IMAGE ID        Y02072 41062002
*   FROM THE UCB AND SET UP TO RELOAD FCB                        Y02072 41064002
*                                                                       41066002
*********************************************************************** 41070002
*                                                                       41080002
FCB1125  EQU   *                                                 Y02072 41082002
         L     RWK7,UCBXTADR            ADDR OF UCB UCS/FCB SECT Y02072 41090002
         USING UCBUCS,RWK7                                       Y02072 41092002
         MVC   DXFCBID,UCBFCBID         FCB ID TO WORKAREA       Y02072 41094002
         MVI   DXFCBOPT,0               CLEAR USER OPTIONS       Y02072 41096002
         DROP  RWK7                                              Y02072 41098002
         B     FCB1030                  GO FIND FCB IMAGE        Y02072 41098402
*                                                                       41100020
*********************************************************************** 41200020
*                                                                       41300020
*   ANALYZE FCB PARAMETERS IN OPERATOR'S REPLY                          41400020
*                                                                       41500020
*********************************************************************** 41600020
*                                                                       41700020
FCB1130  EQU   *                                                        41800020
*                                                                       41900020
         LA    RD,RPLY                  GET ADDRESS OF REPLY AREA       42000020
         LA    RJ,NOREPETS              LOAD NUMBER OF REPITIONS        42100020
         CLI   0(RD),COMMA              CK IF 1ST CHARACTER IS A COMMA  42200020
         BE    FCB1150                  YES GO TO ERROR ROUTINE         42300020
         CLI   0(RD),BLANK              CK IF 1ST CHARACTER IS A BLANK  42400020
         BE    FCB1150                  YES GO TO ERROR ROUTINE         42500020
*                                                                       42600020
         MVC   UCSID(4),LOMASK         BLANK OUT UCS ID BYTE            42630020
         MVI   MCSMASK,NULL             ZERO OUT LOAD MODE BYTE         42660020
FCB1140  EQU   *                                                        42700020
*                                                                       42800020
         CLI   0(RD),BLANK              CK IF THIS CHARACTER IS A BLANK 42900020
         BE    FCB1190                  GO SET UP TO FIND IMAGE  Y02072 43000002
         CLI   0(RD),COMMA              CK IF CHARACTER IS A COMMA      43100020
         BE    FCB1160                  GO CK FOR FCB OPTIONS           43200020
         MVC   UCSID-RPLY(1,RD),NULL(RD) MOVE IN ONE BYTE OF FCB ID IMG 43300020
         LA    RD,1(RD)                 INCREMENT PTR TO NXT CHAR IN    43400020
*                                       REPLY                           43500020
         BCT   RJ,FCB1140               GO EXAMINE NEXT CHAR OF REPLY   43600020
*                                                                       43700020
*********************************************************************** 43800020
*                                                                       43900020
*   ERROR ROUTINE FOR INCORRECT OPERATOR REPLY                          44000020
*                                                                       44100020
*********************************************************************** 44200020
*                                                                       44300020
FCB1150  EQU   *                                                        44400020
         LA    RWK5,MSG125              MESSAGE NO FOR MSG CSECT Y02072 44450002
         LA    RWK6,FCB1090             RETURN ADDRESS           Y02072 44500002
         B     GETMSG                   GO GET MSG               Y02072 44550002
*********************************************************************** 44800020
*                                                                       44900020
*   CHECK FCB OPTIONS MUST BE EITHER 'VERIFY'/'V' OR 'ALIGN'/'A'        45000020
*                                                                       45100020
*********************************************************************** 45200020
*                                                                       45300020
FCB1160  EQU   *                                                        45400020
*                                                                       45500020
         XC    DXFCBP,DXFCBP            CLEAR FCB PARM WORK AREA Y02072 45550002
         CLC   1(6,RD),VERFYCN1         CK IF FCB VERIFY SPECIFIED      45700020
         BE    FCB1180                  GO SET OPTION BITS FOR VERIFY   45800020
         CLI   1(RD),VERFYCN2           CK IF FCB VERIFY SPECIFIED      45900020
         BE    FCB1180                  GO SET OPTION BITS FOR VERIFY   46000020
         CLC   1(4,RD),ALIGNCN1         CK IF ALIGN FORMS SPECIFIED     46100020
         BE    FCB1170                  GO SET OPTION BITS FOR ALIGN    46200020
         CLI   1(RD),ALIGNCN2           CK IF ALIGN FORMS SPECIFIED     46300020
         BNE   FCB1150                  NO GO TO REPEAT REPLY ROUTINE   46400020
*                                       YES FALL THROUGH TO SET ALIGN   46500020
*                                                                       46600020
FCB1170  EQU   *                                                        46700020
         MVI   MCSMASK,ALIGNMSK         SET OPTION BIT TO ALIGN FORMS   46800020
         B     FCB1190                  GO CK FCB NAME                  46900020
*                                                                       47000020
FCB1180  EQU   *                                                        47100020
         MVI   MCSMASK,VERFYMSK         SET OPTION BIT FOR VERIFY       47200020
*                                       GO CK FCB NAME                  47300020
FCB1190  EQU   *                                                        47400020
*                                                                       47500020
         MVC   DXFCBOPT,MCSMASK         MOVE REPLY FCB OPTION    Y02072 47550002
         MVC   DXFCBID,UCSID            MOVE REPLY FCB ID TO     Y02072 47560002
*                                         WORKAREA               Y02072 47570002
         B     FCB1030                  GO FIND FCB IMAGE        Y02072 47620002
FCB1191  EQU   *                        BACK TO DATA MANAG KEY   Y02072 49350002
         MODESET  EXTKEY=DATAMGT                                 Y02072 49360002
FCB1192  EQU   *                                                        49400020
         CLI   DXFCBOPT,VERFYMSK        CK IF VERIFY SPEC        Y02072 49450002
         BNE   FCB1194                  NO, CHECK ALIGN OPTION @ZA12979 49510037
*                                                                       49520020
*                                                                       49530020
*   SET UP TRANSLATION TABLE FOR USE BY IGG0197F TO VERIFY FCB IMAGE    49540020
*                                                                       49550020
*                                                                       49560020
         MVC   DXCCW3(TWENTY6),TRANSTAB MOVE IN TRANSLATION TABLE       49570020
*                                                                       49570102
*  GET INTO KEY 0 AS WE ARE MOVING FROM USER KEY TO DATA MANAG   Y02072 49570402
*  KEY.                                                          Y02072 49570802
*                                                                       49571202
         MODESET  EXTKEY=SUPR                                    Y02072 49572002
         MVC   DXCCW7+4(1),TWO(RB)      MOVE IN LINE/INCH INDICATOR     49575020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 49577002
*                                                                       49580020
*                                                                       49590020
         B     FCB1198                  GO LOAD ADDRESS OF MODULE 7F    49600020
*                                                                       49610020
*                                                                       49700020
*********************************************************************** 50700020
*                                                                       50800020
FCB1194  EQU  *                                                         50900020
         CLI   DXFCBOPT,ALIGNMSK        ALIGN SPEC FOR THIS FCB  Y02072 50950002
         BNE   FCB1250                IF NOT GOTONEXT EXECUTOR          51100020
FCB1198  EQU   *                                                        51300020
         LA    RF,MODNM7F             LOAD ADDRESS OF MODULE IGG0197F   51400020
         B     FCB1290                GO XCTL TO IGG0197F               51500020
FCB1230  EQU   *                                                        51600020
         MVI   DXFCBOPT,OABD101         INTERNAL CODE 101        Y02072 51850002
         B     FCB1075                 GO SET ABEND SWITCH              52000020
FCB1250  EQU   *                                                        54500020
         MVI   DXSTAGE2,STGETWO         SET SW FOR 197F          Y02072 54850002
         LA    RF,MODNM7F               GET ADDRESS OF IGG0197F         55400020
*                                                                       56200020
*********************************************************************** 56300020
*                                                                       56400020
*   MOVE IDTTR TO XCTL WTG TABLE                                        56500020
*                                                                       56600020
*********************************************************************** 56700020
*                                                                       56800020
FCB1290  EQU   *                                                        56900003
*                                                                       57000020
         USING WTGENTRY,RWTGC                                    Y02072 57050002
         MVC   WTGIDTTR,0(RF)           ID TO WTG TABLE        @Z30TSCF 57060003
*                                                                       57200020
*********************************************************************** 57300020
*                                                                       57400020
*   UPDATE WTG TABLE AND XCTL TO NEXT MODULE                            57500020
*                                                                       57600020
*********************************************************************** 57700020
*                                                                       57800020
FCB1300  EQU   *                                                        57900020
*                                                                       58000020
         LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURRENT WTG ENTRY     58100020
         LA    RPARC,PLOFF(0,RPARC)     INCREMENT CURRENT DCB ADDRESS   58200020
         CLC   0(2,RWTGC),AMIDCNST      IS ROUTINE NEEDED AGAIN         58300020
         BCR   8,RBASE                  IF YES,RETURN TO PROCESS        58400020
*                                                                       58500020
         CLC   0(2,RWTGC),OPIDCNST      TEST END OF WTG TABLE           58600020
         BNE   FCB1300                  NO GO CK NEXT ENTRY             58700020
*                                                                       58800020
         LR    RPARC,RPAR               RESET REG TO '0'                58900020
         LA    RWTGC,WAOFF(0,RWTG)      RESET WTG REG TO PT WTG +32     59000020
FCB1310  CLI   0(RWTGC),NULL            CK IF THIS ENTRY COMPLETE       59100020
         BNE   FCB1320                  IF NOT GO XCTL                  59200020
*                                                                       59300020
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY OF WTG TABLE     59400020
         LA    RPARC,PLOFF(0,RPARC)     GET NEXT ENTRY OF DCB           59500020
         B     FCB1310                  GO TO TEST COMPLETION           59600020
*                                                                       59700020
FCB1320  EQU   *                                                        59800020
*                                                                       59900020
         USING WTG,RWTG                                                 59950003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*60000003
               MODID=WTGENTRY                                  @Z30TSCF 60050003
         DROP  RWTGC,RWTG                                      @Z30TSCF 60100003
*                                                                       60700020
*********************************************************************** 60800020
*                                                                       60900020
*   CONSTANTS                                                           61000020
*                                                                       61100020
*********************************************************************** 61200020
*                                                                       61300020
*   FOR WTG TABLE                                                       61400020
OPIDCNST DC    C'0S'                                                    61500020
AMIDCNST DC    C'7E'                                                    61600020
MODNM7F  DC    C'7F',VL3(IGG0197F)      NEXT MOD'S ID          @Z30TSCF 61650003
*                                                                       62800020
*   MISC CONSTANTS                                                      62900020
*                                                                       63000020
TRANSTAB DC    C'00010203040506070809101112' CHANNEL CODE TABLE         63010020
*   USED BY IGG0197F TO VERIFY AN FCB IMAGE                             63020037
*                                                                       63030020
REPLYUSE DC    C'USE '                  REPLY = USE CURRENT FCB IMAGE   63060020
RPLYEQU  DC    C'U '                    REPLY='U',USE CURRENT IMAGE     63120020
RPYEQCAN DC    C'CANCEL'                REPLY='CANCEL' FOR FCB LOAD     63200020
RPLYEQC  DC    C'C '                    REPLY='C',CANCEL FCB LOAD       63300020
VERFYCN1 DC    C'VERIFY'                                                63400020
ALIGNCN1 DC    C'ALIGN'                                                 63500020
*   THE FIRST TWO BYTES OF A BLDL PARAMETER LIST IS THE NUMBER OF       63550037
*   ENTRIES THAT FOLLOW AND THE NEXT TWO BYTES SHOW THE LENGTH OF       63560037
*   EACH ENTRY.   IT MUST BE LONG ENOUGH FOR A 'LOAD' MACRO,  BUT       63570037
*   NOT LONG ENOUGH TO OVERLAY OUR IMAGELIB DCB ADDRESS.                63580037
BLDLCNST DC    0CL4' ',YL2(1),YL2(DXIMGDCB-(DXBLDL+4))         @ZA01357 63600037
FCBCONST DC    C'FCB2'                  PREFIX FOR FCB IMAGE NAMES      63700020
         EJECT                                                          63750002
*********************************************************************** 63760002
*  'GETMSG' SUBROUTINE                                           Y02072 63770002
*  THIS SUBROUTINE EXTRACTS THE REQUIRED MESSAGE FROM THE MSG    Y02072 63780002
*  CSECT AND MOVES IT TO THE WTO/WTOR AREA.                      Y02072 63790002
*                                                                       63792002
*    INPUT TO THIS ROUTINE:                                      Y02072 63794002
*      REG 11 - MESSAGE NUMBER IN MSG CSECT                      Y02072 63796002
*      REG 13 - RETURN ADDRESS                                   Y02072 63798002
*                                                                       63798402
*    OUTPUT FROM THIS ROUTINE:                                   Y02072 63798802
*      MESSAGE TEXT IN WTO/WTOR AREA                             Y02072 63799202
*      REG 1 - POINTER TO MESSAGE ENTRY IN THE MESSAGE CSECT     Y02072 63799602
*********************************************************************** 63799702
GETMSG   DS    0H                       ENTRY POINT, MSG ROUTINE Y02072 63799802
         L     RWK7,DXMSGADR            GET ADDR OF MSG CSECT    Y02072 63799902
         LH    RWK2,0(RWK7,RWK5)        GET INDEX TO MESSAGE     Y02072 63833202
         LA    RWK2,0(RWK7,RWK2)        ADDR OF MESSAGE ENTRY    Y02072 63843202
         USING MSGENTRY,RWK2                                     Y02072 63853202
         SR    RWK3,RWK3                PREPARE REGISTER         Y02072 63863202
         IC    RWK3,MSGOFF              GET OFFSET TO TEXT IN    Y02072 63865202
*                                         ENTRY                  Y02072 63865602
         LA    RWK3,0(RWK2,RWK3)        ADDR OF MESSAGE TEXT     Y02072 63866002
         SR    RWK7,RWK7                PREPARE REGISTER FOR RET Y02072 63866402
         USING MSGTXTD,RWK3                                      Y02072 63866502
         IC    RWK7,MSGLNG              GET LEN OF MSG - 1       Y02072 63866602
         EX    RWK7,MVCINST             MOVE MESSAGE             Y02072 63877702
         BR    RWK6                     RETURN                   Y02072 63887702
MVCINST  MVC   MSGAREA(0),MSGTXT        EXECUTED BY EX INST      Y02072 63888102
         SPACE                                                          63898102
PATCH    DC    0H'0',50X'00'            PATCH AREA               Y02072 63900102
END      EQU   *                        END OF THIS MODULE       Y02072 64088102
*********************************************************************** 65600020
*                                                                       65700020
*   DSECT                                                               65800020
*                                                                       65900020
*********************************************************************** 66000020
*                                                                       66100020
         EJECT                                                          66150002
         IGGMSG                                                  Y02072 66160002
         EJECT                                                          66170002
         DCBD  DSORG=PS                                                 66200020
*                                                                       66300020
*********************************************************************** 66600020
*                                                                       66700020
         IECDSECS  MAIN,WTG,PREFX,EXPAND=YES                   @Z30TSCF 66750003
         ORG   WTGIDTTR                                          Y02072 66800002
WTGID    DS    CL2                      NEXT MODS ID             Y02072 66850002
FORCORE  DSECT                                                   Y02072 66900002
         ORG   REPLYLTH+52                                       S21092 66910021
RPLY     DS    20C                      MSG REPLY AREA           M0191  66920021
RPLYECB  DS    F                        ECB FOR WTOR EXCP        M0191  66930021
MCSMASK  DS    H                        MASK FOR MCS             M0191  66940021
LOMASK   DS    8C                       MASK FOR LOWER CASE RPLY M0191  66950021
UCSID    DS    4C                       ID OF UCS IMAGE          M0191  66960021
         ORG   MSGLSTSZ                                          Y02072 66970002
MSGAREA  DS    0CL64                    AREA TO MOVE 64 BYTES    Y02072 66980002
*                                         TO FOR WTO/WTOR'S      Y02072 66990002
         IGGSCW                                                  Y02072 66992002
         EJECT                                                          66994002
         IHAFCAUD  ORG=YES                                       YM4697 66996002
         EJECT                                                          66998002
*                                                                       67000020
*********************************************************************** 67100020
*                                                                       67200020
SRT      DSECT                                                          67300020
         IEFUCBOB                                                       67400020
*                                                                       67500020
*********************************************************************** 67600020
*                                                                       67700020
CVT      DSECT                                                          67800020
         CVT                                                            67900020
*                                                                       68000020
***                                                                     68100020
*                                                                       68200020
*   DSECT FOR DEB                                                       68204020
*                                                                       68208020
*********************************************************************** 68212020
*                                                                       68216020
*   DATA EXTENT BLOCK  (UNTIL PROTIOS CHANGES)                          68220020
DEB      DSECT                                                          68224020
DEBNMSUB DS    0CL1                                                     68228020
DEBTCBAD DS    CL4                                                      68232020
DEBAMLNG DS    0CL1                                                     68236020
DEBDEBAD DS    CL4                                                      68240020
DEBOFLGS DS    0CL1                                                     68244020
DEBIRBAD DS    CL4                                                      68248020
DEBOPATB DS    0CL1                                                     68252020
DEBSYSPG DS    CL4                                                      68256020
DEBNMEXT DS    0CL1                                                     68260020
DEBUSRPG DS    CL4                                                      68264020
DEBPRIOR DS    0CL1                                                     68268020
DEBECBAD DS    CL4                                                      68272020
DEBPROTG DS    0CL1                                                     68276020
DEBDEBID DS    0CL1                                                     68280020
DEBDCBAD DS    CL4                                                      68284020
DEBEXSCL DS    0CL1                                                     68288020
DEBAPPAD DS    CL4                                                      68292020
DEBDVMOD DS    0CL1                                                     68296020
DEBUCBAD DS    CL4                                                      68300020
DEBTVLSQ DS    0CL2                VOL SEQ FOR TAPE                     68304020
DEBBINUM DS    CL2                                                      68308020
DEBTVLNM DS    0CL2                NO OF VOL FOR TAPE                   68312020
DEBSTRCC DS    CL2                                                      68316020
DEBSTRHH DS    CL2                                                      68320020
DEBENDCC DS    CL2                                                      68324020
DEBENDHH DS    CL2                                                      68328020
DEBNMTRK DS    CL2                                                      68332020
*  FOR ADDITIONAL EXTENT ON DIRECT ACCESS THE FOLLOWING FIELDS          68336020
*  WILL HAVE TO BE OFFSET ANOTHER 16 BYTES                              68340020
DEBVOLSQ DS    H                                                        68344020
DEBVOLNM DS    H                                                        68348020
*  FOR EACH SUBROUTINE LOADED BUMP THIS OFFSET BY 2                     68352020
DEBSUBID DS    H                                                        68356020
*                                                                       68360020
         END                                                            68364020
*                                                                       68400020
DEB      DSECT                                                          68500020
DEBUCBAD DS    CL4                      ONLY PARAMETER NED FROM DEB     68600020
         END                                                            68700020
