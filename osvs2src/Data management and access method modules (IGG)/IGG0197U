197U   TITLE 'IGG0197U - CONTINUATION OF IGG0191V, VERIFY UCS IMAGE'    00100003
IGG0197U CSECT                                                          00200020
*                                                                       00210002
*MODULE NAME - IGG0197U                                          Y02072 00220002
*                                                                       00222002
*DESCRIPTIVE NAME - VERIFY UCSB IMAGE                            Y02072 00224002
*                                                                       00226002
*COPYRIGHT - NONE                                                Y02072 00228002
*                                                                       00228402
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00228802
*                                                                       00229202
*0000365000-366000,370000,375000-377000,379000,383000,386000,    M5143  00230020
*0000389000,392000,593000-595000                                 M5143  00260020
*          RELEASE 21 DELETIONS                                         00300020
*0791115000,607000,621000                                        M1803  00310021
*0791106000-107000,451000,466000,521000-525000,747000,795000-    M0099  00330021
*0791804000,820000-821000                                        M0099  00360021
*                                                                       00370002
*        VS 2 RELEASE 02 DELETIONS                                      00380002
*001000-001800,008000,037000,042000,058000,108200-108600,        Y02072 00390002
*172000-177000,201500,202500-202800,218000-219000,221000,        Y02072 00392002
*226000-227000,253000-254000,262000,318000,348000-362000,        Y02072 00394002
*406000-409000,422000-424000,426000,591000,592000,592800-593600, Y02072 00396002
*648000,675050-777000,794500-802000,245000-246000,251000-252000, Y02072 00398002
*003984-007000,242000,710000,745000,749000,649000,761500-761940, Y02072 00398102
*762000                                                          Y02072 00448102
*                                                                YM2424 00498102
*                                                                YM4697 00548102
*                                                                       00598103
*        VS2 RELEASE 3 ADDITIONS                                        00648103
*                                                              @Z30TSCF 00698103
*        VS2 RELEASE 4.0 CHANGES                                        00698403
*A217500,319500                 ABEND 0C4 IF UCS NOT REENTRANT @ZA02191 00698603
*A520500-522000                        ABEND 0C4 IN IMGLIB SVC @ZA05553 00698803
*                                                                       00750002
*STATUS - SEE BEGINNING OF OBJECT CODE                                  00800003
*                                                                       00850002
*FUNCTION/OPERATION - WHEN VERIFICATION IS REQUIRED DISPLAY THE IMAGE   00900020
*                     RETRIEVED FOR VISUAL VERIFICATION                 01000020
*                   - DISPLAY MESSAGE IEC121 TO REQUEST OPERATOR VERIFY 01100020
*                     THE IMAGE PRINTED                                 01200020
*                   - ANALIZE REPLY MADE BY AN OPERATOR                 01300020
*                   - UPDATE UCB TO REFLECT THE STATUS OF UCS IMAGE IN  01400002
*                     THE BUFFER.                                       01500020
*                   - CLOSE SYS1.IMAGELIB DCB IF PRINTER IS 1403        01600003
*                   - RESET AUDIT TRAIL BITS INDICATING TO FORCE YM4697 01650002
*                     CLOSE THAT UCS IMAGE HAS BEEN DELETED AND  YM4697 01660002
*                     THAT SYS1.IMAGELIB HAS BEEN CLOSED         YM4697 01670002
*                   - DETERMINE NEXT OPEN EXECUTOR TO XCTL TO AND       01700020
*                     IF NECESSARY ISSUE IEC129 MESSAGE TO OPERATOR     01800020
*                                                                       01900020
*ENTRY POINT -ENTERED FROM IGG0191V BY USE OF XCTL MACRO                02000020
*                                                                       02100020
*INPUT - DCB ADDRESS                                                    02200020
*      - OPEN WORK AREA ADDRESS                                         02300020
*      - WHERE-TO-GO TABLE                                              02400020
*      - PARAMETER LIST                                                 02500020
*      - CURRENT ENTRY IN W-T-G TABLE                                   02600020
*      - CURRENT PARAMETER(DCB)                                         02700020
*      - THE ADDRESS OF UCS IMAGE RETRIEVED                             02800020
*                                                                       02900020
*OUTPUT - PRINT OUT UCS IMAGE WHEN VERIFY IS SPECIFIED                  03000020
*       - TO REQUEST AN OPERATOR VERIFY THE IMAGE ,                     03100020
*         'IEC121D V XXX,YYYY' MESSAGE IS DISPLAYED                     03200020
*       - UPDATED UCB TO REFRECT THE STATUS OF UCS BUFFER               03300020
*       - ISSUE REQUEST FOR OPERATOR TO SPECIFY FCB IMAGE               03400020
*         'IEC129D XXX,SPECIFY FCB PARAMETERS' MESSAGE                  03500020
*       - ISSUE MESSAGE 'IEC125I - ERROR - REPEAT REPLY' WHEN    Y02072 03550002
*         OPERATOR REPLY IS INVALID                              Y02072 03560002
*                                                                       03600020
*EXTERNAL REFERENCS - MESSAGE CSECT                              Y02072 03700002
*                                                                       03800020
*EXIT - NORMAL - XCTL TO ONE OF THE FOLLOWING:                          03900002
*               *IGG0197E TO LOAD AN FCB IMAGE                   Y02072 04000002
*               *IGG01911 IF THE DCB IS EXCP.                    Y02072 04200002
*               *IGG0191I IF BUFFER CNTRL BLOCK IS SPECIFIED.           04300020
*               *IGG0191G IF NORMAL SCHEDULING IS SPECIFIED.            04400020
*               *IGG0191Q IF CHAINED SCHEDULING IS SPECIFIED.           04500020
*                                                                       04600020
*EXIT - ERROR - XCTL TO PROBLEM DETERMINATION FOR THE FOLLOWING  Y02072 04650002
*              *PERMANENT I/O ERROR OCCURED DURING VERIFICATION         04900020
*              *OPERATOR ISSUED CANCEL FOR MESSAGE IEC121.              05100020
*                                                                       05300020
*TABLES/WORK AREAS - WHERE-TO-GO TABLE (SEE LISTING OF EXECUTOR         05400020
*                                       IGG0191B)                       05500020
*                  - OPEN WORK AREA (SEE IECDSECT IN THIS LISTING)      05600020
*                                                                       05650002
*MACROS-ACTION:MODESET, EXCP, WAIT, DELETE, DMABCOND, XCTL,      Y02072 05660002
*              XCTLTABL                                          Y02072 05670002
*                                                                       05680002
*MACROS-MAPPING:IGGMSG,IECDSECS(MAIN,WTG),IKJTCB,IEFUCBOB,DCBD,  Y02072 05690002
*               IGGSCW, IHAFCAUD                                 Y02072 05700002
*                                                                       05750002
*ATTRIBUTES - REENTRANT, REFRESHABLE, RUNS IN DATA MANAGEMENT KEYY02072 05800003
*             UNLESS OTHERWISE SPECIFIED, SUPER STATE            Y02072 05850002
*                                                                       05900020
*NOTES - EXCP/WAIT SVCS ARE USED TO WRITE IMAGES ON PRINTER FOR VERFY   06000020
*      - DELETE SVC IS USED TO DELETE THE RETRIEVED IMAGE.              06100020
*      - WTOR SVC IS USED TO REQUEST OPERATOR REPLY                     06200020
*      - IOB/ECB IN OPEN WORK AREA IS USED FOR EXCP                     06300020
*      - THE REPLY IS ORED TO ALLOW LOWER CASE ALPHA                    06400020
*      - BEFORE ISSUING A WTO/WTOR, THE MESSAGE TEXT MUST FIRST  Y02072 06460002
*        BE EXTRACTED FROM A MESSAGE CSECT.                      Y02072 06470002
*                                                                       06500020
*********************************************************************** 06600020
*                                                                       06700020
         EJECT                                                          06800020
*                                                                       06900020
*********************************************************************** 07000020
*                                                                       07100020
*   REGISTER CONVENTIONS USED THROUGH OUT ALL OPEN PASSES               07200020
*                                                                       07300020
*********************************************************************** 07400020
*                                                                       07500020
*                                                                       07600020
RE       EQU   0                        WORK/PARAMETER REGISTER         07700020
RF       EQU   1                        WORK/PARAMETER REGISTER         07800020
RWK2     EQU   RF                       WORK REGISTER            Y02072 07850002
RDCB     EQU   2                        ADDR OF USER'S DCB              07900020
RBASE    EQU   3                        BASE REGISTER                   08000020
RCORE    EQU   4                        ADDR OF OPEN WORK AREA          08100020
RPAR     EQU   5                        PARAMETER LIST                  08200020
RWTG     EQU   6                        START OF WTG                    08300020
RPARC    EQU   7                        CURRENT ENTRY IN PARAMETER LIST 08400020
RWK1     EQU   RPARC                    WORK REGISTER            Y02072 08450002
RWTGC    EQU   8                        CURRENT ENTRY IN WTG TABLE      08500020
RTIOT    EQU   9                        TIOT ADDR/WORK REGISTER         08600020
RWK3     EQU   RTIOT                    WORK REGISTER            Y02072 08650002
RUCB     EQU   10                       UCB ADDR/WORK REGISTER          08700020
RDEB     EQU   11                       DEB ADDR                        08800020
RB       EQU   12                       WORK REGISTER/BREG FOR DSECT    08900020
RWK6     EQU   RB                       WORK REGISTER            Y02072 08950002
RC       EQU   13                       WORK REGISTER                   09000020
RD       EQU   14                       WORK/PARAMETER REGISTER         09100020
RJ       EQU   15                       WORK/PARAMETER REGISTER         09200020
RWK7     EQU   RJ                       WORK REGISTER            Y02072 09250002
*                                                                       09300020
*********************************************************************** 09400020
*                                                                       09500020
*                                                                       09600020
*   EQUATE WTG OFFSET                                                   09700020
*                                                                       09800020
WGOFF    EQU   8                        OFFSET OF CURRENT WTG ENTRIES   09900020
PLOFF    EQU   4                        OFFSET OF CURRENT DCB ENTRIES   10000020
WAOFF    EQU   32                       OFFSET OF 1ST ENTRY IN WTG TBL  10100020
*                                                                       10200020
*   EQUATE ABEND CODE AND RETURN CODE                                   10300020
*                                                                       10400020
OABD067  EQU   67                       OPEN INTERNAL CODE 67    M0099  10600021
OABD068  EQU   68                       OPEN INTERNAL CODE 68    M0099  10700021
BFCNTRL  EQU   X'01'                    BUFFER CNTRL BLOCK SPECIFIED    11000020
EXCPMASK EQU   X'80'                   OPEN FOR EXCP MASK               11100020
NULL     EQU   X'00'                    X'00'                           11200020
SILIMASK EQU   X'60'                    C.C. AND SILI ON                11300020
ONEMASK  EQU   X'01'                    X'01'                           11400020
PRTM3211 EQU   X'09'                    MASK FOR 3211 PRINTER           11600020
IEC129RQ EQU   X'80'                    IF ON, MUST WAIT FOR     Y02072 11650002
*                                         OPER REPLY TO IEC129   Y02072 11660002
UCSOPOFS EQU   X'04'                    UCS OPTIONS OFFSET              11900020
RETRYMSK EQU   X'80'                   MASK FOR COMMAND RETRY ON        12200020
BUFPARMK EQU   X'04'                    BUFFER PARITY ERROR MASK        12300020
BUFPARER EQU   X'01'                    UCS OPTION BIT FOR PARITY ERR   12600020
CMDSKP0  EQU   X'83'                    SKIP TO CH 0 COMMAND CODE       12700020
TWOMASK  EQU   X'02'                    X'02'                           12800020
FOLDMASK EQU   X'40'                    LOAD MODE = FOLD                12900020
RESETMSK EQU   X'CF'                    RESET VERIFY                    13000020
SKIPCCW  EQU   X'8B'                    CCW = SKIP TO CH 1              13100020
SILLCCW  EQU   X'20'                    SILI BIT ON                     13300020
WRITECCW EQU   X'11'                    CCW = WRITE 2 SPACE             13400020
UNRLBMSK EQU   X'02'                    IOB IS UNRELATED                13500020
ABENDBIT EQU   X'80'                    ABEND ROUTINE IN PROCESS        14000020
IMCLOSED EQU   X'FF'                    FLAG SET FOR IMAGELIB NOT OPEN  14100020
*                                                                  DM0Q 14200020
*    EQUATES FOR CONSTANTS                                         DM0Q 14300020
*                                                                  DM0Q 14400020
X7F      EQU   X'7F'                    COMPLETION CODE FLAG            14500020
K0       EQU   0                        CONSTANT EQUATED TO 0           14600020
K2       EQU   2                        CONSTANT EQUATED TO 2           14800020
K4       EQU   4                        CONSTANT EQUATED TO 4           15000020
K7       EQU   7                        CONSTANT EQUATED TO 7           15300020
K8       EQU   8                        CONSTANT EQUATED TO 8           15400020
IOBUNCHK EQU   X'02'                    UNIT CHECK CONDITION     Y02072 17150002
*  THE FOLLOWING MESSAGE NUMBERS ARE EQUAL TO THEIR POSITION     Y02072 17160002
*  IN THE MESSAGE CSECT (RELATIVE TO ZERO), MULT BY 2 (LENGTH    Y02072 17170002
*  OF AN INDEX).                                                 Y02072 17180002
HEADING1 EQU   14*2                     MESSAGE NO IN MSG CSECT  Y02072 17200002
HEADING2 EQU   19*2                     MESSAGE NO IN MSG CSECT  Y02072 17250002
MSG125   EQU   9*2                      MESSAGE NO IM MSG CSECT  Y02072 17260002
MSG121D1 EQU   13*2                     MESSAGE NO IN MSG CSECT  Y02072 17300002
MSG121D2 EQU   17*2                     MESSAGE NO IN MSG CSECT  Y02072 17350002
MSG129   EQU   3*2                      MESSAGE NO IN MSG CSECT  Y02072 17400002
UCSIMLNG EQU   4                        LENGTH OF UCS IMAGE NAME Y02072 17450002
*                                                                       17800020
*   HOUSE KEEPING                                                       17900020
*                                                                       18000020
*********************************************************************** 18100020
*                                                                       18200020
         BALR  RBASE,0                  SET UP BASE REGISTER            18300003
         USING *,RBASE                                                  18400003
         USING IHADCB,RDCB                                              18500020
         USING FORCORE,RCORE                                            18600020
         USING DEB,RDEB                                                 18700020
         USING UCBOB,RUCB                                               18800020
*                                                                       18900020
*                                                                       19300020
*********************************************************************** 19400020
*                                                                       19500020
*   INITIALIZE REGISTERS                                                19600020
*                                                                       19700020
*********************************************************************** 19800020
*                                                                       19900020
         B     AROUND                   BR AROUND CONSTANTS      Y02072 19950002
         DC    C'IGG0197U'              MODULE NAME              Y02072 19960002
         DC    C' ZA02191'              LAST SHIP CODE                  19970003
         DC    C' 7/29/75'              LAST DATE MODIFIED              19980003
AROUND   DS    0H                                                Y02072 19990002
*                                                                       19992002
         L     RDCB,0(RPARC)            LOAD CURRENT DCB ADDR           20000003
         L     RCORE,4(RWTGC)           LOAD CURRENT WORK AREA ADDR     20100003
         L     RDEB,DCBDEBAD            LOAD DEB ADDR                   20200020
         L     RUCB,DEBUCBAD            LOAD UCB ADDR                   20300020
         ST    RWK1,DXREGSV+4           SAVE REGISTER            Y02072 20350002
*                                                                       20400020
*                                                                       20500020
*                                                                       20600020
*                                                                       20700020
*********************************************************************** 20800020
*                                                                       20900020
VRFYUCS  EQU   *                                                        21000020
*                                                                       21100020
*********************************************************************** 21200020
*                                                                       21300020
*      INITIALIZE REGISTERS FOR VERIFICATION.  WE MUST GET INTO         21400003
* PROTECTION KEY ZERO WHENEVER THE UCS IMAGE IS REFERENCED, BECAUSE     21450003
* IT MAY HAVE BEEN LINK EDITED WITHOUT THE RENT ATTRIBUTE, CAUSING      21460003
* IT TO BE LOADED INTO FETCH-PROTECTED USER-KEY STORAGE.  THE IBM-      21470003
* DISTRIBUTED UCS IMAGES ARE LINK EDITED REENTRANT.                     21480003
*                                                                       21500020
*********************************************************************** 21600020
*                                                                       21700020
         MODESET EXTKEY=SUPR            GET INTO KEY ZERO      @ZA02191 21750003
         SR    RWK1,RWK1                RESET REGISTER           Y02072 21800002
         IC    RWK1,1(RB)               INSERT NO. OF LINES      Y02072 21900002
*                                                                       22000020
         LTR   RWK1,RWK1                TEST IF NO VERIFICATION  Y02072 22100002
         BC    K8,UPDTUCB               IF NOT,GOTO UPDATE UCB ROUTINE  22200020
*                                                                       22300020
         LA    RC,TWOMASK(RB)           OBTAIN 1ST NO. OF CHAR/LINE     22400020
         ST    RB,DXREGSV               SAVE IMAGE ADDR          Y02072 22450002
         LR    RD,RC                    OBTAIN UCS IMAGE ADDR           22500020
         AR    RD,RWK1                  ADD NO. OF LINES TO GET  Y02072 22600002
*                                          IMAGE                 Y02072 22700002
*********************************************************************** 22800020
*                                                                       22900020
*   EXCP TO DISPLAY HEADING 'UCS IMAGE VERIFICATION - YYYY'             23000020
*                                                                       23100020
*********************************************************************** 23200020
*                                                                       23300020
*   CONSTRUCT CCW  TO SKIP TO NEW LINE                                  23400020
*                                                                       23500020
         MVI   DXCCW1+K7,ONEMASK        MOVE LENGTH=1                   23600020
         MVI   DXCCW1+K4,SILIMASK       SET SILI AND CC ON              23700020
         MVI   DXCCW1,SKIPCCW           SET COMMAND CODE=SKIP TO CH 1   23800020
*                                                                       23900020
*   CONSTRUCT CCW TO PRINT HEADING                                      24000020
*                                                                       24100020
         MVI   DXCCW2+K4,SILLCCW        SET SILI FLAG ON                24300020
*                                                                       24400020
         LA    RWK6,MSGAREA             LOAD PRINT AREA ADDR     Y02072 24500002
         ST    RWK6,DXCCW2              STORE DATA ADDR=MESSAGE  Y02072 24600002
         MVI   DXCCW2,WRITECCW          PRINT A LINE - 2 SPACES AFTER   24700020
*                                                                       24800020
*   MOVE UCS NAME TO BE PRINTED                                         24900020
*                                                                       25000020
         LA    RWK6,FILLINHD            RETURN ADDRESS           Y02072 25202002
         LA    RWK3,HEADING2            MESSAGE NO FOR MSG RTN   Y02072 25210002
         TM    DXUCSOPT,FOLDMASK        FOLD SPECIFIED           Y02072 25212002
         BO    GETMSG                   YES, GO GET HEADING      Y02072 25222002
         LA    RWK3,HEADING1            NO, GET OTHER HEADING    Y02072 25224002
         B     GETMSG                   GO GET HEADING           Y02072 25226002
         USING MSGENTRY,RWK2                                     Y02072 25276002
FILLINHD EQU   *                        FILL IN HEADING          Y02072 25499302
         IC    RWK7,MSGOFF1             OFFSET TO FIRST VAR FLD  Y02072 25499402
         LA    RWK3,MSGAREA(RWK7)       ADDRESS OF FIRST VAR FLD Y02072 25499502
         MVC   0(UCSIMLNG,RWK3),DXUCSID  UCS IMAGE ID TO MSG     Y02072 25503702
         IC    RWK7,MSGLNG              LENGTH OF MESSAGE - 1    Y02072 25512202
         LA    RWK7,1(RWK7)             GET TRUE LENGTH OF MSG   Y02072 25522202
         STC   RWK7,DXCCW2+7            LENGTH TO CCW BYTE CNT   Y02072 25524202
         DROP  RWK2                                              Y02072 25524802
         LA    RDEB,PRTEXCP1            GET ADDRESS OF PRTEXCP1         25537402
         DROP  RDEB                                                     25550001
*                                                                       26300020
*                                                                       26400020
WRITEGO  EQU   *                                                        26500020
*                                                                       26600020
*                                                                       26700020
*   EXCP/WAIT                                                           26800020
*                                                                       26900020
         LA    RF,DXIOB                 LOAD IOB ADDR                   27000020
         EXCP  (1)                      EXCP ON PRINT HEADING           27100020
*                                                                       27200020
         WAIT  ECB=DXECB                WAIT ON ABOVE EXCP              27400003
*                                                                       27500020
*   TEST COMP.CODE.IF THERE IS I/O ERROR GOTO ABEND.                    27600020
*                                                                       27700020
         TM    DXECB,X7F                TEST IF COMP.CODE=X7F           27800020
         BNO   CKRTYERR                 IF NOT GO CK FOR RETRYABLE ERR  27900020
*                                                                       28000020
*                                                                       28100020
         BR    RDEB                     BRANCH TO ADDRESS IN REG 11     28200020
*                                                                       28300020
*********************************************************************** 28400020
*                                                                       28500020
PRTEXCP1 EQU   *                                                        28600020
*                                                                       28700020
*********************************************************************** 28800020
*                                                                       28900020
*   EXCP ON PRINTER TO PRINT UCS SET                                    29000020
*                                                                       29100020
*********************************************************************** 29200020
*                                                                       29300020
*   CONSTRUCT CCW TO EXCP                                               29400020
*                                                                       29500020
         MVI   IOBFLAG1,UNRLBMSK        SET UNRELATED BIT ON            29600020
         SR    RDEB,RDEB                ZERO OUT REG 11                 29700020
         IC    RDEB,NULL(RC)            INSERT # CHARACTER PER LINE     29800020
*                                                                       29900020
WRITEUCS EQU   *                                                        30000020
*                                                                       30100020
         ST    RD,DXCCW1                STORE UCS WORK AREA ADDR IN CCW 30200020
         ST    RDEB,DXCCW1+K4           STORE RECORD LENGTH IN CCW      30300020
         MVI   DXCCW1+K4,SILLCCW        SET SILI ON                     30400020
         MVI   DXCCW1,WRITECCW          SET COMMAND CODE=PRINT/2 SPACE  30500020
*                                                                       30600020
*   GO ISSUE EXCP TO WRITE A LINE                                       30700020
*                                                                       30800020
         BAL   RDEB,WRITEGO             GO ISSUE EXCP                   30900020
*                                                                       31000020
         SR    RDEB,RDEB               ZERO OUT REG FOR CHARS THIS LINE 31100003
         IC    RDEB,NULL(RC)            INSERT = CHARACTERS/LINE        31200020
*                                                                       31300020
         AR    RD,RDEB                  MODIFY UCSWORK AREA             31400020
         LA    RC,ONEMASK(RC)           INCREMENT REG. BY 1             31500020
         IC    RDEB,NULL(RC)            INSERT NO. OF CHAR/LINE         31600020
*                                                                       31700020
         BCT   RWK1,WRITEUCS            REPEAT N=RWK1  TIMES.    Y02072 31800002
*                                                                       31900020
         MODESET EXTKEY=DATAMGT         GET BACK IN OUR KEY    @ZA02191 31950003
*                                                                       32000020
*********************************************************************** 32100020
*                                                                       32200020
*   SKIP TO NEW PAGE                                                    32300020
*                                                                       32400020
*********************************************************************** 32500020
*                                                                       32600020
         MVI   DXCCW1+K7,ONEMASK        MOVE LENGTH = 1                 32700020
         MVI   DXCCW1,SKIPCCW           SET COMMAND CODE  = SKIP        32800020
*                                                                       32900020
*   GO ISSUE EXCP TO SKIP TO CHANNEL 1                                  33000020
*                                                                       33100020
         BAL   RDEB,WRITEGO             GO ISSUE SKIP TO CH 1 CCW       33200020
*                                                                       33300020
*********************************************************************** 33900020
*                                                                       34100020
*   WTOR 'IEC121D V XXX,YYYY' TO REQUEST OPERATOR REPLY                 34200020
*                                                                       34300020
*********************************************************************** 34400020
*                                                                       34500020
*                                                                       34600020
*                                                                       34700020
         LA    RWK6,MSG121              RETURN ADDRESS           Y02072 34750002
         TM    DXUCSOPT,FOLDMASK        TEST IF LOAD MODE FOLD   Y02072 34800002
         LA    RWK3,MSG121D2            MESSAGE NO FOR MSG RTN   Y02072 35250002
         BNO   GETMSG                   YES, GO GET MESSAGE      Y02072 35300002
         LA    RWK3,MSG121D1            MESSAGE NO FOR MSG RTN   Y02072 35350002
         B     GETMSG                   NO, GO GET MESSAGE       Y02072 35400002
MSG121   EQU   *                        FILL IN VARIABLE FIELDS  Y02072 35450002
         USING MSGENTRY,RWK2                                     Y02072 35460002
         IC    RWK7,MSGOFF1             OFFSET TO VAR FLD ONE    Y02072 35500002
         LA    RWK3,MSGAREA(RWK7)       ADDRESS OF VAR FLD ONE   Y02072 35550002
         MVC   0(L'UCBNAME,RWK3),UCBNAME DEV NAME TO MESSAGE     Y02072 35600002
         IC    RWK7,MSGOFF2             OFFSET TO VAR FLD TWO    Y02072 35650002
         DROP  RWK2                                              Y02072 35660002
         LA    RWK3,MSGAREA(RWK7)       ADDRESS OF VAR FLD TWO   Y02072 35700002
         MVC   0(UCSIMLNG,RWK3),DXUCSID  UCS IMAGE TO MSG        Y02072 35710002
MESSAGO  EQU   *                                                   DM0Q 36300020
         XC    RPLY(24),RPLY            CLEAR REPLY AREA AND ECB M5143  36500020
*                                                                       36700020
         WTOR  MF=(E,REPLYLTH)          ISSUE WTOR SVC                  36800003
*                                                                       36900020
         WAIT  ECB=RPLYECB,LONG=YES         WAIT FOR WTOR        Y02072 37100003
*                                                                       37200020
*   REPLY ANALYSIS                                                      37300020
*                                                                       37400020
         OC    RPLY(K8),LOMASK          OR TO ALLOW LOWER CASE   M5143  37500020
*                                       ALPHA                    M5143  37600020
         L     RB,DXREGSV               REINIT POINTER TO IMAGE  Y02072 37650002
*                                         IN CASE WE MUST RETRY  Y02072 37660002
         CLC   RPLY(L'RETRYCN),RETRYCN  TEST IF REPLY='RETRY'    M5143  37700003
         BC    K8,VRFYUCS               IF YES GO BACK TO RE-VERIFY     37800020
         CLC   RPLY(L'CANCELCN),CANCELCN  TEST IF REPLY='CANCEL' M5143  37900003
         BC    K8,ABEND04               IF YES,GO ABEND                 38000020
*                                                                       38100020
*                                                                       38200020
         CLC   RPLY(L'OKCN),OKCN        TEST IF REPLY='VERIFIED' M5143  38260003
         BC    K8,UPDTUCB               IF YES GO UPDATE UCB            38400020
*                                                                       38500020
         CLC   RPLY(K2),RBLANK          TEST IF REPLY='R '       M5143  38600020
         BC    K8,VRFYUCS               IF YES GO VERIFY UCS IMAGE      38700020
*                                                                       38800020
         CLC   RPLY(K2),CBLANK          TEST IF REPLY='C '       M5143  38900020
         BC    K8,ABEND04               IF YES GOTO ABEND ROUTINE       39000020
*                                                                       39100020
         CLC   RPLY(K2),VBLANK          TEST IF REPLY='V '       M5143  39200020
         BC    K8,UPDTUCB               IF YES GO UPDATE UCB            39300020
*                                                                       39400020
*********************************************************************** 40000020
*                                                                       40100020
*   WTO 'IEC125I ERROR - REPEAT REPLY'                                  40200002
*                                                                       40300020
*********************************************************************** 40400020
*                                                                       40500020
         LA    RWK6,MESSAGO             RETURN ADDRESS           Y02072 40550002
         LA    RWK3,MSG125              MESSAGE NO FOR MSG CSECT Y02072 40600002
         B     GETMSG                   GO GET MESSAGE           Y02072 40650002
*                                                                       41000020
*********************************************************************   41100020
*                                                                       41200020
*   ROUTINE TO CHECK FOR RETRYABLE ERROR AND SKIP TO 0 TO RESET         41300020
*   THE CONTROL UNIT 2811                                               41400020
*                                                                       41500020
*********************************************************************   41600020
*                                                                       41700020
CKRTYERR EQU   *                                                        41800020
*                                                                       41900020
         CLI   UCBTBYT4,PRTM3211        CK IF DCB BEING OPENED FOR 3211 42000020
         BNE   ABEND10                  NO GO SET RC=10 AND ABEND       42100020
         TM    IOBCSW+4,IOBUNCHK        UNIT CHECK CONDITION     Y02072 42150002
         BZ    ABEND10                  NO, DON'T TEST SENSE     Y02072 42170002
         TM    IOBSENS1,RETRYMSK        CK FOR RETRYABLE ERROR   Y02072 42180002
         BNO   ABEND10                  NO GO SET RC=10 AND ABEND       42500020
         TM    IOBSENS0,BUFPARMK        CK FOR BUFFER PARITY ERR Y02072 42550002
         BNO   SKIPCH0                  NO GO SKIP CH 0                 42700020
         L     RJ,UCBXTADR              YES GET ADDR OF UCB EXTENTION   42800020
         MODESET  EXTKEY=SUPR           GET INTO SUPER KEY       Y02072 42850002
         OI    UCSOPOFS(RJ),BUFPARER    SET UCS BUF PARITY ERR BIT      42900020
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 42950002
*                                                                       43000020
SKIPCH0 EQU    *                                                        43100020
*                                                                       43200020
         MVI   DXCCW1+K7,ONEMASK        SET LENGTH FIELD TO 1           43300020
         MVI   DXCCW1+K4,SILLCCW        SET SILI                        43400020
         MVI   DXCCW1,CMDSKP0           MOVE IN SKIP TO 0 COMMAND CODE  43500020
         LA    RF,DXIOB                 GET ADDR FOR EXCP               43600020
         EXCP  (1)                      ISSUE EXCP TO SKIP TO CH 0      43700020
*                                                                       43800020
*********************************************************************** 43900020
*                                                                       44000020
ABEND10  EQU   *                                                        44100020
*                                                                       44200020
*********************************************************************** 44300020
*                                                                       44400020
*   PERMANENT I/O ERROR DURING PRINTING VERIFICATION LINES.             44500020
*   RETURN CODE = X'10' IN REG. 15                                      44600020
*   IF THE I/O ERROR PERSISTS,RUN C.E. DIAGNOSTICS ON THE PRINTER       44700020
*                                                                       44800020
*********************************************************************** 44900020
*                                                                       45000020
         LA    RB,OABD067               LOAD INTERNAL CODE 67    M0099  45100021
         B     UPUCBEND                 GO TO UPDATE UCB AND EXIT       45200003
*                                                                       45300020
*********************************************************************** 45400020
*                                                                       45500020
ABEND04  EQU   *                                                        45600020
*                                                                       45700020
*********************************************************************** 45800020
*                                                                       45900020
*   REQUESTED CHAIN SET WAS NOT AVAILABLE. JOB STEP WAS CANCELLED BY    46000020
*   AN OPERATOR. RETURN CODE = X'14' IN REG.15                          46100020
*   RERUN THE JOB WITH THE CORRECT CHAIN/TRAIN                          46200020
*                                                                       46300020
*********************************************************************** 46400020
*                                                                       46500020
         LA    RB,OABD068               LOAD INTERNAL CODE 68    M0099  46600021
*                                                                       46700020
*********************************************************************** 46800020
*                                                                       46900020
UPUCBEND EQU   *                                                        47000020
*                                                                       47100020
*********************************************************************** 47200020
*                                                                       47300020
*   UPDATE THE UCB WITH X'00' TO INDICATE THAT THE IMAGE IN THE BUFFER  47400020
*   IS NOT USABLE                                                       47500020
*                                                                       47600020
*********************************************************************** 47700020
*                                                                       47800020
         L     RJ,UCBXTADR              GET ADDRESS OF UCB EXTENTION    47900020
         MODESET  EXTKEY=SUPR           GET INTO SUPER KEY       Y02072 47950002
         SPACE                                                          47960003
         XC    0(L'UCBUCSID+L'UCBUCSOP,RJ),0(RJ)  RESET UCS ID/OPT      48000003
         SPACE                                                          48010003
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 48050002
         SPACE                                                          48100002
*                                                                       49800020
*********************************************************************** 49900020
*                                                                       50000020
*   DELETE THE UCS IMAGE LOADED                                         50100020
*                                                                       50200020
*********************************************************************** 50300020
*                                                                       50400020
         LA    RE,DXSAVUCS              LOAD ADDR OF IMAGE ID    Y02072 50450002
*                                         LOADED                 Y02072 50460002
         DELETE EPLOC=(0)                                               50600020
         NI    FCAOPEN2,X'FF'-FCAOUCSL  INDIC UCS IMAGE DELETED  YM4697 50650002
*                                                                       51100020
*********************************************************************** 51200020
*                                                                       51300020
*   ABEND ROUTINE.COMPLETION CODE=B13.RETURN CODE IS IN REG15.          51400020
*                                                                       51500020
*********************************************************************** 51600020
*                                                                       51700020
         TM    DXCCW11+K2,ABENDBIT      TEST IF ABEND IS IN PROCESS     51800020
         BO    UCSEXIT                  IF YES,GOTO EXIT ROUTINE        51900003
         L     RPARC,DXREGSV+4          RELOAD REG FOR PROB DET  YM2424 51950002
*                                                                       52000020
*   WE DO NOT WANT TO SAVE REGISTER 9 AT DXREG9, WHERE PROBLEM          52050003
*   DETERMINATION ROUTINES ARE EXPECTING IT, BECAUSE THE ADDRESS        52100003
*   OF THE SYS1.IMAGELIB DCB IS ALREADY THERE.                          52150003
         STM   RUCB,RD,DXREGA           SAVE REGS 10 TO 14     @ZA05553 52160003
*                                                                       52170003
         DMABCOND (RB),PDLOAD,RETURN=NONE,RES=NO,REGSAVE=NO    @ZA05553 52200003
         B     TCTLRTN                                           M0099  52400021
*                                                                       52600020
*********************************************************************** 52700020
*                                                                       52800020
*********************************************************************** 52900020
*                                                                       53000020
UPDTUCB  EQU   *                                                        53100020
*                                                                       53200020
*********************************************************************** 53300020
*                                                                       53400020
*   UPDATE UCB - UCS FIELDS                                             53500020
*                                                                       53600020
*********************************************************************** 53700020
*                                                                       53800020
         L     RWK7,UCBXTADR            GET ADDRESS OF UCB EXT   Y02072 53900002
         MODESET  EXTKEY=SUPR           GET INTO SUPER KEY       Y02072 53950002
         SPACE                                                          53960002
         USING UCBUCS,RWK7                                       Y02072 53962002
         MVC   UCBUCSID,DXUCSID         MOVE UCS IM ID TO UCB    Y02072 53964002
         MVC   UCBUCSOP,DXUCSOPT        MOVE UCS OPT BITS TO UCB Y02072 53966002
         OC    UCBUCSOP,0(RB)           SET DEBAULT BIT IF ANY   Y02072 53968002
         NI    UCBUCSOP,RESETMSK        RESET VERIFY IF ANY      Y02072 53968402
         DROP  RWK7                                              Y02072 54018402
         MODESET  EXTKEY=DATAMGT        BACK TO DATA MANAG KEY   Y02072 54350002
         SPACE                                                          54400002
*                                                                       55800020
*********************************************************************** 55900020
*                                                                       56000020
*   DELETE UCS IMAGE                                                    56100020
*                                                                       56200020
*********************************************************************** 56300020
*                                                                       56400020
         LA    RE,DXSAVUCS              LOAD ADDR OF ENTRY PT    Y02072 56550002
*                                                                       56600020
         DELETE EPLOC=(0)               DELETE UCS IMAGE                56700020
         NI    FCAOPEN2,X'FF'-FCAOUCSL  INDIC UCS IMAGE DELETED  YM4697 56750002
*                                                                       56800020
*********************************************************************** 56900020
*                                                                       57000020
*********************************************************************** 57100020
*                                                                       57200020
UCSEXIT  EQU   *                                                        57300020
*                                                                       57400020
         CLI   UCBTBYT4,PRTM3211        IF 1403, NO FCB          Y02072 57450002
         BNE   RESTERPT                 EXIT FOR 1403            Y02072 57500002
         TM    DXFCBSW1,IEC129RQ        CK IF IEC129 MSG REQ     Y02072 57650002
         BZ    XCTL197E                 NO GO LOAD FCB IN 197E   Y02072 58100002
*                                                                       58200020
**********************************************************************  58300020
*                                                                       58400020
*        ISSUE MESSAGE IEC129 AND XCTL TO IGG0197E                      58500002
*                                                                       58600020
**********************************************************************  58700020
*                                                                       59000020
         LA    RWK3,MSG129              MESSAGE NO FOR MSG RTN   Y02072 59050002
         BAL   RWK6,GETMSG              GO GET MESSAGE           Y02072 59060002
         USING MSGENTRY,RWK2                                     Y02072 59070002
         IC    RWK7,MSGOFF1             OFFSET TO VAR FLD ONE    Y02072 59110002
         DROP  RWK2                                              Y02072 59120002
         LA    RWK3,MSGAREA(RWK7)       ADDRESS OF VAR FLD ONE   Y02072 59160002
         MVC   0(L'UCBNAME,RWK3),UCBNAME DEV NAME TO MSG         Y02072 59210002
         XC    RPLY(24),RPLY            ZERO OUT REPLY AREA AND  M5143  59440020
*                                       ECB                      M5143  59520020
         WTOR  MF=(E,REPLYLTH)          GET ADDR FOR WTOR               59600003
*                                                                       59800020
XCTL197E EQU   *                                                        59900020
*                                                                       60000020
         LA    RF,MODNM7E               GET IDTTR ADDR OF IGG3197E      60100020
         B     MVEIDTTR                 GO TO WTG SEQ                   60200020
*********************************************************************** 61200020
*                                                                       61300020
*   RESTORE DCB EROPT                                                   61400020
*                                                                       61500020
*********************************************************************** 61600020
*                                                                       61700020
RESTERPT EQU   *                                                        61800020
*                                                                       61900020
         MVC   DXCCW6(1),DXEROPT        RESTORE EROPT            Y02072 62150002
*                                                                       62300020
*   SEE IF SYS1.IMAGELIB HAS BEEN OPENED IF YES CLOSE IT                62400020
*                                                                       62450002
         CLI   DXIMGDCB,IMCLOSED        CK IF IMGLIB CLOSED      Y02072 62460002
         BE    TSTEXCP                  IF NOT GO TEST IF EXCP SPECIFED 62600020
         L     RF,DXIMGDCB              GET ADDR OF IMGLIB DCB   Y02072 62650002
         SVC   105                      ISSUE SVC TO CLOSE SYS1.IMAGELI 62800020
*                                                                       62900020
         NI    FCAOPEN2,X'FF'-FCAOIMGL  INDIC IMAGELIB CLOSED    YM4697 62950002
*                                                                       63000020
*********************************************************************** 63100020
*                                                                       63200020
*   DETERMINE THE NEXT STAGE 2 EXECUTOR TO BE XCTLED                    63300020
*                                                                       63400020
*********************************************************************** 63500020
*                                                                       63600020
TSTEXCP  EQU   *                                                        63700020
*                                                                       63800020
*********************************************************************** 63900020
*                                                                       64000020
*   TEST IF EXCP IS SPECIFIED.IF YES,XCTL TO THE LAST OPEN EXECUTOR     64100020
*                                                                       64200020
*********************************************************************** 64300020
*                                                                       64400020
         LA    RF,MODNM11               GO DO DCB COPY BACK      Y02072 64450003
         TM    DCBMACRF,EXCPMASK        TEST IF EXCP IS SPECIFIED       64500020
         BO    MVEIDTTR                 GOTO WTG TABLE UPDATE   Y02072  64900003
*                                                                       65400020
*********************************************************************** 65500020
*                                                                       65600020
*   TEST IS BUFFER CONTROL BLOCK IS SPECIFIED.IF YES,XCTL TO IGG0911I   65700020
*                                                                       65800020
*********************************************************************** 65900020
*                                                                       66000020
         TM    DCBBUFNO+3,BFCNTRL       BUFFER CONTROL BLOCK SPECIFIED  66100003
         BZ    TSTCHAIN                 IF YES,GOTO TEST PCI ROUTINE    66200003
*                                                                       66300020
         CLI   DCBBUFNO,0               SEE IF BUFFERS REQUESTED        66500003
         BE    TSTCHAIN                 IF YES, GO TEST CHAINED SCHED.  66700003
*                                                                       66800020
         LA    RF,MODNM1I               LOAD ADDR OF IDTTR OF IGG0191I  66900020
         B     MVEIDTTR                 GO TO MOVE IDTTR ROUTINE        67000003
*                                                                       67100020
*********************************************************************** 67200020
*                                                                       67300020
TSTCHAIN EQU   *                                                        67400003
*                                                                       67500020
*********************************************************************** 67600020
*                                                                       67700020
*   TEST IF CHAINED SCHEDULING IS REQUESTED.  IF YES, XCTL TO IGG0191Q. 67800003
*                                                                       67900020
*********************************************************************** 68000020
*                                                                       68100020
         LA    RF,MODNM1Q               LOAD ADDR OF IDTTR OF IGG0191Q  68150003
         TM    DCBOPTCD,DCBOPTC         TEST IF CHAINED SCHED REQUESTED 68200003
         BO    MVEIDTTR                 GO TO MOVE IDTTR ROUTINE        68600003
*                                                                       69100020
*********************************************************************** 69200020
*                                                                       69300020
*   BSAM/QSAM EXIT.XCTL TO IGG0191G                                     69400020
*                                                                       69500020
*********************************************************************** 69600020
*                                                                       69700020
         LA    RF,MODNM1G               LOAD ADDR OF IDTTR IF IGG0191G  69800020
*                                                                       69900020
*********************************************************************** 70000020
*                                                                       70100020
MVEIDTTR EQU   *                                                        70200020
*                                                                       70300020
*********************************************************************** 70400020
*                                                                       70500020
*   MOVE IDTTR TO XCTL WTG TABLE                                        70600020
*                                                                       70700020
*********************************************************************** 70800020
*                                                                       70900020
         USING WTGENTRY,RWTGC                                    Y02072 70950002
         MVC   WTGIDTTR,0(RF)           ST NEXT MOD ID IN WTG  @Z30TSCF 70960003
         L     RWK1,DXREGSV+4           RESTORE REGISTER         Y02072 71050002
*                                                                       71100020
*********************************************************************** 71200020
*                                                                       71300020
RELOOP   EQU   *                                                        71400020
*                                                                       71500020
*********************************************************************** 71600020
*                                                                       71700020
*   UPDATE WTG TABLE AND XCTL TO NEXT MODULE                            71800020
*                                                                       71900020
*********************************************************************** 72000020
*                                                                       72100020
         LA    RWTGC,WGOFF(K0,RWTGC)    INCREMENT CURRENT WTG ENTRY     72200020
         LA    RPARC,PLOFF(K0,RPARC)    INCREMENT CURRENT DCB ENTRY     72300020
         CLC   K0(K2,RWTGC),AMIDCNST    IS THE RTN NEEDED AGAIN         72400020
         BCR   K8,RBASE                 IF YES,RETURN TO PROCESS        72500020
*                                                                       72600020
         CLC   K0(K2,RWTGC),OPIDCNST    TEST END OF WTG TABLE           72700020
         BC    K7,RELOOP                IF NOT,CHECK NEXT ENTRY         72800020
*                                                                       72900020
         LR    RPARC,RPAR               RESET REG TO '0'                73000020
         LA    RWTGC,WAOFF(K0,RWTG)     RESET WTG REG TO POINT +32(WTG) 73100020
*                                                                       73200020
ZCHECK   EQU   *                                                        73300020
*                                                                       73400020
         CLI   K0(RWTGC),K0             TEST IF THIS ENTRY COMPLETE     73500020
         BC    K7,TCTLRTN               IF NOT,XCTL                     73600020
*                                                                       73700020
         LA    RWTGC,WGOFF(K0,RWTGC)    GET NEXT ENTRY OF WTG TABLE     73800020
         LA    RPARC,PLOFF(K0,RPARC)    GET NEXT ENTRY OF DCB           73900020
         B     ZCHECK                   GO TO TEST COMPLETION           74000003
*                                                                       74100020
TCTLRTN  EQU   *                                                        74200020
*                                                                       74300020
         USING WTG,RWTG                                                 74350003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*74400003
               MODID=WTGENTRY                                  @Z30TSCF 74450003
         DROP  RWTGC,RWTG                                      @Z30TSCF 74500003
         EJECT                                                          74950002
*********************************************************************** 74960002
*  'GETMSG' SUBROUTINE                                           Y02072 74970002
*  THIS SUBROUTINE EXTRACTS THE REQUIRED MESSAGE FROM THE MSG    Y02072 74980002
*  CSECT AND MOVES IT TO THE WTO/WTOR AREA.                      Y02072 74990002
*                                                                       74992002
*    INPUT TO THIS ROUTINE:                                      Y02072 74994002
*      REG 9 - MESSAGE NUMBER IN CSECT                           Y02072 74996002
*      REG 12 - RETURN ADDRESS                                   Y02072 74998002
*                                                                       74998402
*    OUTPUT FROM THIS ROUTINE:                                   Y02072 74998802
*      REG 1 - POINTER TO MESSAGE ENTRY IN THE MESSAGE CSECT     Y02072 74999202
*      MESSAGE TEXT IN WTO/WTOR AREA                             Y02072 74999602
*********************************************************************** 74999702
GETMSG   EQU   *                        ENTRY POINT, MSG RTN     Y02072 74999802
         L     RWK7,DXMSGADR            GET ADDR OF MSG CSECT    Y02072 74999902
         LH    RWK2,0(RWK7,RWK3)        GET INDEX TO MESSAGE     Y02072 75033202
         LA    RWK2,0(RWK7,RWK2)        ADDR OF MESSAGE ENTRY    Y02072 75043202
         USING MSGENTRY,RWK2                                     Y02072 75053202
         SR    RWK3,RWK3                PREPARE REGISTER         Y02072 75063202
         IC    RWK3,MSGOFF              GET OFFSET TO TEXT IN    Y02072 75065202
*                                         ENTRY                  Y02072 75065602
         LA    RWK3,0(RWK2,RWK3)        ADDR OF MESSAGE TEXT     Y02072 75066002
         USING MSGTXTD,RWK3                                      Y02072 75066402
         SR    RWK7,RWK7                PREPARE REG FOR RETURN   Y02072 75066502
         IC    RWK7,MSGLNG              LEN OF MSG - 1           Y02072 75066602
         EX    RWK7,MVCINST             MOVE MESSAGE TO AREA     Y02072 75077702
         BR    RWK6                     RETURN                   Y02072 75087702
MVCINST  MVC   MSGAREA(0),MSGTXT        EXECUTED BY A EX INST    Y02072 75088102
         EJECT                                                          75088502
*                                                                       75088902
*********************************************************************** 75100020
*                                                                       75200020
*********************************************************************** 75300020
*                                                                       75400020
*   CONSTANTS                                                           75500020
*                                                                       75600020
*********************************************************************** 75700020
*                                                                       75800020
*   FOR WTG TABLE                                                       75900020
*                                                                       76000020
OPIDCNST DC    C'0S'                    END OF WTG TABLE ID             76100020
AMIDCNST DC    C'7U'                    MODUE ID                        76200020
*                                                                       77800020
*   REPLY CONSTANT                                                      77900020
*                                                                       78000020
RETRYCN  DC    C'RETRY'                REPLY = 'RETRY'                  78100003
CANCELCN DC    C'CANCEL'               REPLY = 'CANCEL'                 78200003
OKCN     DC    C'VERIFIED'             REPLY = 'VERIFIED'               78300003
CBLANK   DC    C'C '                    REPLY = 'C'                     78400020
RBLANK   DC    C'R '                    REPLY = 'R'                     78500020
VBLANK   DC    C'V '                    REPLY = 'V'                     78600020
*                                                                       78800020
*********************************************************************** 78900020
*                                                                       79000020
*   XCTL TABLE                                                          79100020
*                                                                       79200020
*********************************************************************** 79300020
*                                                                       79400020
MODNM11  DC    C'11',VL3(IGG01911)      MODULE IGG01911        @Z30TSCF 79402003
MODNM1G  DC    C'1G',VL3(IGG0191G)      MODULE IGG0191G        @Z30TSCF 79404003
MODNM1I  DC    C'1I',VL3(IGG0191I)      MODULE IGG0191I        @Z30TSCF 79406003
MODNM1Q  DC    C'1Q',VL3(IGG0191Q)      MODULE IGG0191Q        @Z30TSCF 79408003
MODNM7E  DC    C'7E',VL3(IGG0197E)      MODULE IGG0197E        @Z30TSCF 79408403
PDLOAD   DC    C'6M',VL3(IGG0196M)      MODULE IGG0196M        @Z30TSCF 79409203
         SPACE                                                          79409602
PATCH    DC    0H'0',50X'00'            PATCH AREA               Y02072 79459602
END      EQU   *                        END OF THIS MODULE       Y02072 79559602
*                                                                       81000020
*   DSECTS                                                              81100003
*                                                                       81200020
*********************************************************************** 81300020
*                                                                       81400020
*                                                                       81500020
         DCBD  DSORG=PS,DEVD=PR                                         81600003
*                                                                       81700020
*********************************************************************** 81800020
*                                                                       81900020
         EJECT                                                          81950002
         IGGMSG                                                  Y02072 81960002
         EJECT                                                          81970002
CVT      DSECT                                                 @Z30TSCF 81972003
         CVT                                                   @Z30TSCF 81974003
         EJECT                                                          81976003
         IECDSECS  WTG,PREFX,EXPAND=YES                        @Z30TSCF 81980003
         ORG   WTGIDTTR                                          Y02072 81982002
WTGID    DS    CL2                      NEXT MOD ID              Y02072 81984002
         EJECT                                                          81990002
         IECDSECS MAIN,EXPAND=YES                                M0099  82000021
         ORG   REPLYLTH+52                                       M5143  82110020
RPLY     DS    20C                                               M5143  82120020
RPLYECB  DS    F                                                 M5143  82130020
MCSMASK  DS    H                                                 M5143  82140020
LOMASK   DS    8C                                                M5143  82150020
UCSID    DS    4C                                                M5143  82160020
         ORG   MSGLSTSZ                                          Y02072 82170002
MSGAREA  DS    0CL64                    AREA TO MOVE 64 BYTES    Y02072 82180002
*                                         TO FOR WTO/WTOR'S      Y02072 82190002
DXREGSV  EQU   DXXCTL                   WORD TO SAVE REGISTER    Y02072 82192002
         EJECT                                                          82194002
         IGGSCW                                                  Y02072 82196002
         EJECT                                                          82198002
         IHAFCAUD  ORG=YES                                       YM4697 82198402
         EJECT                                                          82198802
*                                                                       82200020
*********************************************************************** 82300020
*                                                                       82400020
SRT      DSECT                                                          82500020
         IEFUCBOB                                                       82600020
*                                                                       82700020
*********************************************************************** 82800020
*                                                                       82900020
*   DATA EXTENT BLOCK  (UNTIL PROTIOS CHANGES)                          83000020
DEB      DSECT                                                          83100020
DEBNMSUB DS    0CL1                                                     83200020
DEBTCBAD DS    CL4                                                      83300020
DEBAMLNG DS    0CL1                                                     83400020
DEBDEBAD DS    CL4                                                      83500020
DEBOFLGS DS    0CL1                                                     83600020
DEBIRBAD DS    CL4                                                      83700020
DEBOPATB DS    0CL1                                                     83800020
DEBSYSPG DS    CL4                                                      83900020
DEBNMEXT DS    0CL1                                                     84000020
DEBUSRPG DS    CL4                                                      84100020
DEBPRIOR DS    0CL1                                                     84200020
DEBECBAD DS    CL4                                                      84300020
DEBPROTG DS    0CL1                                                     84400020
DEBDEBID DS    0CL1                                                     84500020
DEBDCBAD DS    CL4                                                      84600020
DEBEXSCL DS    0CL1                                                     84700020
DEBAPPAD DS    CL4                                                      84800020
DEBDVMOD DS    0CL1                                                     84900020
DEBUCBAD DS    CL4                                                      85000020
DEBTVLSQ DS    0CL2                VOL SEQ FOR TAPE                     85100020
DEBBINUM DS    CL2                                                      85200020
DEBTVLNM DS    0CL2                NO OF VOL FOR TAPE                   85300020
DEBSTRCC DS    CL2                                                      85400020
DEBSTRHH DS    CL2                                                      85500020
DEBENDCC DS    CL2                                                      85600020
DEBENDHH DS    CL2                                                      85700020
DEBNMTRK DS    CL2                                                      85800020
*  FOR ADDITIONAL EXTENT ON DIRECT ACCESS THE FOLLOWING FIELDS          85900020
*  WILL HAVE TO BE OFFSET ANOTHER 16 BYTES                              86000020
DEBVOLSQ DS    H                                                        86100020
DEBVOLNM DS    H                                                        86200020
*  FOR EACH SUBROUTINE LOADED BUMP THIS OFFSET BY 2                     86300020
DEBSUBID DS    H                                                        86400020
*                                                                       86500020
*********************************************************************** 86600020
*                                                                       86700020
         END                                                            86800020
