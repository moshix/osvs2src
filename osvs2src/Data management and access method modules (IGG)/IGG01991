 TITLE 'IGG01991 - SAM STG 3 OPEN EXEC FOR VARIABLE LNGTH/SPANNED RECS' 00100018
IGG01991 CSECT                                                          00200018
*MODULE NAME - IGG01991                                          Y02072 00250002
*                                                                       00300002
*DESCRIPTIVE NAME - LOAD ACCESS METHOD ROUTINES                  Y02072 00350002
*                                                                       00360002
*COPYRIGHT - NONE                                                Y02072 00370002
*                                                                       00380002
*CHANGE ACTIVITY - AS FOLLOWS:                                   Y02072 00390002
*          RELEASE 20 DELETIONS                                       * 00500018
*1262351400                                                      M5860  00520020
*1262                                                            S20038 00550020
*1262134600,192300-192420                                        A32160 00570020
*1262112000,321000,323000,330000,347000,353780,374000-434000,    S20201 00580020
*1262436500,533000,535000,623000,625600                          S20201 00590020
*1262506000-525000,604000-622700                                 M4028  00595020
*          RELEASE 21 DELETIONS                                       * 00600018
*1202134200-134800,192060-192840,258000-306000,348000-353000,    S21040 00630021
*1202357000,528380-530460,533000,592000,625600-626200            S21040 00660021
*1202346300                                                      A49371 00670021
*                                                                       00680002
*        VS 2 RELEASE 02 DELETIONS                                      00690002
*001500,011500,013600,014100,175600-175900,190600,191500-192600, Y02072 00692002
*320300-320440,320950-321090,331530-331980,347000,355000,        Y02072 00694002
*371800-371920,501050-501900,606880-615880,623300,403000,463000  Y02072 00696002
*458000-459000,485000-497000,528160-528300                       Y02072 00696402
*                                                                YM1141 00696602
*                                                                YM1140 00697002
*                                                                YM5922 00697402
*                                                                       00697803
*          VS2 RELEASE 3 DELETIONS                                      00697903
*                                                              @Z30TSCF 00714603
*                                                                       00731303
*          VS2037 CHANGES                                               00736337
*C187700,187800,346000-346360                                  @ZA28034 00741337
*STATUS CHANGE LEVEL 005                                                00748002
*                                                                       00798002
*FUNCTION/OPERATION - THIS MODULE IS A CONTINUATION OF MODULE           01210018
*    IGG01915 AND LOADS THE END-OF-BLOCK ROUTINES AND ANY SIO           01220018
*    APPENDAGES REQUIRED.  WHICH SUBROUTINES ARE LOADED WAS             01230018
*    DETERMINED BY PREVIOUS OPEN EXECUTORS.  THE ADDRESSES OF THE       01240018
*    LOADED MODULES ARE PLACED IN THE DCB AND THE ID IN THE             01250018
*    SUBROUTINE ID SECTION OF THE DEB.                                  01260018
*                                                                       01270018
*ENTRY POINTS - THE MODULE IS ENTERED BY MEANS OF AN XCTL FROM          01280018
*    IGG01915.                                                          01290018
*                                                                       01300018
*INPUT - SEE DESCRIPTION OF REGISTER CONTENTS.                          01310018
*                                                                       01320018
*OUTPUT - SUBROUTINES LOADED, ADDRESSES IN DCB, ID'S IN DEB             01330018
*                                                                       01340018
*EXTERNAL ROUTINES - NONE                                               01350018
*EXITS - NORMAL - XCTL TO IGG01911                               Y02072 01360002
*      - ERROR - NONE                                                   01370018
*                                                                       01380018
*TABLES/WORKAREAS - DESCRIBED BY DSECTS AT END OF MODULE LISTING        01390018
*                                                                       01400018
*ATTRIBUTES - REENTRANT, REUSABLE, SUPERVISOR STATE,             Y02072 01410002
*             RUNS IN DATA MANAGEMENT KEY                        Y02072 01412002
*                                                                       01420018
*                                                                       01430018
*                                                                       01440018
* REGISTER CONVENTIONS                                                  01450018
*                                                                       01460018
RE       EQU   0                        WORK REG5                       01510002
RWK1     EQU   RE                       WORK REGISTER            Y02072 01560002
RF       EQU   1                        WORK REG6                       01610002
R1       EQU   RF                       PARM REG                 YM1140 01660002
RDCB     EQU   2                        DCB                             01700018
RBASE    EQU   3                        BASE                            01800018
RCORE    EQU   4                        WORE AREA                       01900018
RPAR     EQU   5                        TOP OF PARAMETER                02000018
RWTG     EQU   6                        TOP OF WTG TABLE                02100018
RPARC    EQU   7                        CURRENT PARAMETER               02200018
RWTGC    EQU   8                        CURRENT TRANS LOAD              02300018
RTIOT    EQU   9                        TIOT                            02400018
RUCB     EQU   10                       UCB                             02500018
RDEB     EQU   11                       DEB                             02600018
RB       EQU   12                       WORK REG1                       02700018
RC       EQU   13                       WORK REG2                       02800018
RBRANCH  EQU   RC                       BRANCH REGISTER          Y02072 02850002
RD       EQU   14                       WORK REG3                       02900018
RJ       EQU   15                       WORK REG4                       03000018
*                                                                       03300018
*                                                                       03400018
PARAR    EQU   RPARC                                                    03500018
*                                                                       03600018
*********************************************************************** 03700018
*                                                                       03800018
*********************************************************************** 03900018
*                                                                       04000018
* MASK'S TO TEST PARAMETER LIST WITH                                    04100018
*                                                                       04200018
*********************************************************************   04300018
INP      EQU   X'0F'                    MASK                            04400018
OUTP     EQU   X'0F'                    MASK                            04500018
UPDATE   EQU   X'04'                    MASK                            04600018
INOUT    EQU   X'03'                    MASK                            04700018
OUTIN    EQU   X'07'                    MASK                            04800018
RDBACK   EQU   X'01'                    MASK                            04900018
INPRDBK  EQU   X'0E'               MASK TO CK INPUT OR RDBACK      UT18 04950018
*                                                                       05000018
*                                                                       05100018
*********************************************************************   05200018
*                                                                       05300018
*                                                                       05400018
* OFFSET FOR PARAMETER TESTS                                            05500018
*                                                                       05600018
FRTYATE  EQU   48                       MASK                            05700018
DISPSN   EQU   X'0'                     MASK                            05800018
*                                                                       05900018
RCDRYOF  EQU   6                        OFFSET IN JFCBMASK TO    S20201 05905020
*                                       RCD                      S20201 05910020
*                                       READY MASK                      05915020
THREE    EQU   3                        CONSTANT OF THREE        S20201 05920020
FIVE     EQU   5                        FIVE BYTE QUANTITY       S20201 05925020
D0       EQU   0                        DISPLACEMENT OF 0        S20201 05930020
D1       EQU   1                        DISPLACEMENT OF 1        S20201 05935020
D5       EQU   5                        DISPLACEMENT OF 5        S20201 05940020
D6       EQU   6                        DISPLACEMENT OF 6        S20201 05945020
D12      EQU   12                       DISPLACEMENT OF TWELVE   S20201 05950020
D13      EQU   13                       DISPLACEMENT OF 13       S20201 05955020
D17      EQU   17                       DISPLACEMENT OF 17       S20201 05960020
D25      EQU   25                       DISPLACEMENT OF 25       S20201 05965020
*                                                                       05970020
*                                                                       05975020
*                                                                       05980020
*                                                                       06000018
*********************************************************************   06100018
*                                                                       06200018
* OFFSETS FOR DEB REFERENCE                                             06300018
*                                                                       06400018
*                                                                       06500018
BIN      EQU   36                                                       06600018
BEXT     EQU   38                                                       06700018
*                                                                       06800018
*                                                                       06900018
*                                                                       07000018
*********************************************************************   07100018
*                                                                       07200018
* MASK'S USED TO TEST OPTION FIELDS IN DCB                              07300018
*                                                                       07400018
*                                                                       07500018
*                                                                       07600018
DOUBLE   EQU   X'01'                    MASK                            07700018
*                                                                       07800018
*                                                                       07900018
STOWB    EQU   X'80'                    MASK                            08000018
WRTCK    EQU   X'80'                    MASK                            08100018
OVRFLO   EQU   X'20'                    MASK                            08200018
PCI      EQU   X'20'                    MASK                            08300018
MINKEY   EQU   X'01'                    MASK                            08400018
CONCAT   EQU   X'FF'                    MASK                            08500018
UTFMASK  EQU   X'02'               MASK FOR TOTALING FACILITY      UT18 08550018
UPDATEB  EQU   X'80'                    MASK                     S19015 08570019
BYPASS   EQU   X'10'               BYPASS DOS EMBEDDED CHKPT     S21040 08580021
*                                  RCDS IN TAPE DATA SETS               08590021
*                                                                       08600018
*********************************************************************   08700018
*                                                                       08800018
* MASKS FOR ACCESS METHODS IN SAM                                       08900018
*                                                                       09000018
QSAMB    EQU   X'01'                    MASK                            09100018
BSAMBIT  EQU   X'00'                    MASK                            09200018
PAM      EQU   X'02'                    MASK                            09300018
*                                                                       09400018
******************************************************************      09406019
ASISVLN  EQU   9                        DBLWRDS FOR IRB WKA      YM1141 09456002
ADLEN    EQU   3                        LENGTH OF AN ADDR        S19015 09466019
TWOBYTES EQU   16                       NO OF BITS IN 2 BYTES    S19015 09472019
NOID     EQU   X'00'                    INDICATE NO MORE MODULES S19015 09478019
BFTEKR   EQU   X'20'                    BDAM VS                  S19015 09484019
*                                                                       09490019
*                                                                       09500018
* MASKS FOR MACRO'S TO BE USED                                          09600018
*                                                                       09700018
GETB     EQU   X'40'                    MASK                            09800018
PUTB     EQU   X'40'                    MASK                            09900018
READB    EQU   X'20'                    MASK                            10000018
WRITEB   EQU   X'20'                    MASK                            10100018
POINTB   EQU   X'04'                    MASK                            10200018
CNTRLB   EQU   X'02'                    MASK                            10300018
*                                                                       10400018
*                                                                       10500018
*********************************************************************   10600018
* MASKS FOR DEVICES TO BE SUPPORTED                                     10700018
*                                                                       10800018
*                                                                       10900018
*********************************************************************   11000018
*                                                                       11100018
NORCDRY  EQU   X'20'                    RCD READY MASK           S20201 11150020
SDINDIC  EQU   X'08'                    SEARCH DIRECT INDICATOR  S20201 11200020
TRKOVFL  EQU   X'20'                    TRK OVERFLOW MASK        S20201 11250020
*                                                                       11300018
*                                                                       11400018
*********************************************************************   11500018
*                                                                       11600018
* MASKS FOR STATUS BITS TO BE TESTED                                    11700018
*                                                                       11800018
*                                                                       11900018
EXCPN    EQU   X'30'                    MASK                            12000018
COMPLETE EQU   X'80'                    MASK                            12100018
FIRSTIOB EQU   X'01'                    MASK                            12200018
*                                                                       12300018
*                                                                       12400018
*                                                                       12500018
*********************************************************************   12600018
*                                                                       12700018
* MASKS FOR BUFFER TECHNIQUE'S                                          12800018
*                                                                       12900018
CYCLICB  EQU   X'20'                                                    13000018
EXCHANGB EQU   X'10'                                                    13100018
SIMPLEB  EQU   X'40'                                                    13200018
EXCHCYCL EQU   X'30'                                                    13300018
*                                                                       13400018
*                                                                       13500018
* MODES  OPERATION FOR QSAM                                             13600018
LOCATEB  EQU   X'08'                                                    13700018
MOVEB    EQU   X'10'                                                    13800018
SUBSTUTB EQU   X'04'                                                    13900018
DATAMODE EQU   X'01'                                                    14000018
* COMMAN YTES FOR THE 2841                                              14100018
SRCHE    EQU   X'31'                                                    14200018
WRTCKD   EQU   X'1D'                                                    14300018
RDC      EQU   X'92'                                                    14400018
RDKD     EQU   X'8E'                                                    14500018
RDD      EQU   X'86'                                                    14600018
TIC      EQU   X'08'                                                    14700018
* MASKS   RECORD FORMATS                                                14800018
STANDRDF EQU   X'08'                                                    14900018
FORMATU  EQU   X'C0'                                                    15000018
FORMATF  EQU   X'80'                                                    15100018
FORMATV  EQU   X'40'                                                    15200018
FORMATD  EQU   X'20'                    D FORMAT RECORDS         S20038 15250020
SPANNED  EQU   X'08'                                                    15300018
BLOCKED  EQU   X'10'                                                    15400018
FIXEDBLK EQU   X'90'                                                    15500018
*   CHAN  CONTROL WORD FLAGS                                            15600018
SKIP     EQU   X'10'                                                    15700018
SLI      EQU   X'20'                                                    15800018
CC       EQU   X'40'                                                    15900018
DATACH   EQU   X'A0'                                                    16000018
SLICC    EQU   X'60'                                                    16100018
SLICCSK  EQU   X'70'                                                    16200018
KEYS     EQU   X'01'                                                    16300018
QSAM     EQU   X'01'                                                    16400018
ASA      EQU   X'04'                                                    16800018
BKREAD   EQU   X'01'                                                    16900018
URBITS   EQU   X'40'                                                    17000018
TAPEB    EQU   X'80'                                                    17100018
DABIT    EQU   X'20'                                                    17200018
R25      EQU   25                       CONSTANT                        17300018
R3       EQU   3                        CONSTANT                        17400018
R5       EQU   5                        CONSTANT                        17500018
OFF      EQU   X'7F'                    MASK TO TURN OFF UPDATE  S19015 17510019
*                                           BIT                         17520019
BYTE     EQU   1                        ONE CONSTANT             S19015 17530019
ABENDISP EQU   17                       ABEND DISPLACEMENT              17540001
IRBDISP  EQU   24                       IRB DISPLACEMENT         S19015 17550019
ADDISP   EQU   25                       ADDRESS DISPLACEMENT     S19015 17560019
*                                                                       17600018
*                                                                       17700018
         BALR  RBASE,RE                 SET BASE                        17800018
         USING SLDA,RBASE                                               17900018
         USING IHADCB,RDCB                                              18000018
         USING BLDEB,RDEB                                               18100018
         USING FORCORE,RCORE                                            18200018
*                                                                       18400018
*                                                                       18500018
SLDA     EQU   *                                                        18600018
*                                                                       18700018
         B     BEGIN                    BR AROUND CONSTANTS      Y02072 18750002
         DC    C'IGG01991'              MODULE NAME              Y02072 18760002
         DC    C'@ZA28034'              LAST SHIP CODE         @ZA28034 18770037
         DC    C'02/02/78'              LAST DATE MODIFIED     @ZA28034 18776037
BEGIN    DS    0H                                                Y02072 18790002
*                                                                       18800018
         L     RDCB,0(RPARC)            GET DCB ADDRESS                 18900018
         LA    RDCB,0(RDCB)             CLEAR HI BYTE                   19000018
         L     RCORE,4(RWTGC)           GET WORK AREA                   19050000
         L     RDEB,DCBDEBAD            GET DEB ADDRESS                 19100018
         MVI   22(RWTG),X'CB'          CHANGE DE ATTR.TO ONLY LOADABLE  19300018
*                                                                       19400018
         L     RTIOT,DEBAPPAD           GET APPENDAGE ADDRESS           19500018
         USING AVT,RTIOT                                                19550001
         SR    RUCB,RUCB                CLEAR REG                       19600018
         SR    RF,RF                    CLEAR RER                       19700018
         SR    RD,RD                                                    19800018
         IC    RD,DEBNMSUB              GET NBR OF MODULES LOADED       19850018
         IC    RUCB,DEBNMEXT            GET NUMBER OF EXTENTS           19900018
         IC    RF,DEBEXSCL              GET SCALING FACTOR              20000018
         SLL   RUCB,0(RF)               SHIFT ACCORDING TO EXTENT SIZE  20100018
         IC    RF,DEBAMLNG              GET ACCESS METHOD LENGTH        20200018
         LA    RUCB,0(RF,RUCB)          ADD TO POINT TO SUBRT ID FLD    20300018
         LA    RUCB,32(RUCB,RDEB)       ADD BASIC DEB SZ TO DEB AD      20400018
*                                                                       20500018
*  RUCB NOW POINTS TO THE SUBROUTINE ID FIELD IN THE DEB                20600018
*  BUT MUST BE INCREMENTED TO POINT BEYOND THE LAST ENTRY          UT18 21000018
*                                                                       21400018
SLDAA    EQU   *                                                   UT18 21800018
         CLI   0(RUCB),X'00'            IS RUCB BEYOND LAST ENTRY  UT18 22200018
         BE    SLDAB                    BR IF YES                  UT18 22600018
         LA    RUCB,2(RUCB)             INCREMENT TO NEXT ID FIELD UT18 23000018
         B     SLDAA                    TEST NEXT FIELD            UT18 23400018
*                                                                       23800018
*                                                                       24200018
*  RUCB NOW POINTS TO NEXT AVAILABLE SUBROUTINE ID FIELD IN THE    UT18 24600018
*  DEB.                                                            UT18 25000018
*                                                                       25400018
SLDAB    EQU   *                                                 S21040 28400021
*                                                                       31700018
*      GET THE EOB MODULES NEEDED FOR THIS FILE                         31800018
*                                                                       31900018
SLDAPP00 EQU   *                                                        32000018
         TM    JFCBMASK+D6,SDINDIC      SEARCH DIRECT USED       S20201 32005020
         BNO   NOSDOPT                  BRANCH NO                S20201 32010020
         LA    RB,CEAFP                 GET SEARCH DIRECT CE     S20201 32015020
         BAL   RC,SLDROUT               LOAD ROUTINE             S20201 32020020
         ST    RE,AVTCE                 APPENDAGE TABLE ENTRY FOR CE    32025001
         LA    RB,AEOESF                GET END FO EXTENT APPEN  S20201 32045020
         BAL   RC,SLDROUT               LOAD IT IN AND PUT       S20201 32050020
         ST    RE,AVTEOE                APPENDAGE TABLE ENTRY FOR EOE   32055001
         B     SLDAPP19                 GET READY TO XCTL        S20201 32065020
*                                                                       32070020
NOSDOPT  EQU   *                                                 S20201 32075020
         TM    JFCBMASK+RCDRYOF,NORCDRY ANY DEVICES W/O RCD      S20201 32080020
*                                       READY                    S20201 32085020
         BO    LAB001                  NO,BRANCH                 S20201 32090020
         LA    RB,AEOESF                GET READY TO LOAD IN     S20201 32110020
*                                        END OF EXT APPEN.              32115020
*                                         IGG019C4                      32120020
LAB001   EQU   *                                                 S20201 32125020
         TM    DCBCIND2,UPDATEB         IS IT UPDATE             S19015 32130019
         BO    SLDAPP02                 YES, BRANCH              S19015 32160019
         TM    0(RPARC),OUTP            DCB FOR OUTPUT ONLY             32200018
         BO    SLDAPP10                 YES, BRANCH              S20201 32300020
*                                                                       32400018
*  END OF EXTENT  APPENDAGE NEEDED FOR DISK INPUT                       32500018
*                                                                       32600018
         TM    DCBDEVT,X'20'           D.A. DEVICE                      32700018
         BZ    SLDAPP10                NO BRANCH                 Y02072 32800002
         TM    DCBCIND1,X'40'          SEARCH DIRECT INPUT              32900018
         BNO   LAB01                    NO, LOAD CH              S20201 32960020
         B     SLDAPP03                 BRANCH                   S20201 33020020
*                                                                       33100018
LAB01    EQU   *                                                 S20201 33150020
         LA    RB,AEOE                 GET END OF EXTENT ID             33200018
         B     SLDAPP03                 LOAD                     S19015 33210019
*                                                                       33220019
SLDAPP02 EQU   *                                                 S19015 33230019
*                                                                       33240019
         LA    RB,QUEOE                 GET END-OF-EXTENT ID     S19015 33250019
*                                                                       33260019
SLDAPP03 EQU   *                                                 S19015 33270019
*                                                                       33280019
         BAL   RC,SLDROUT              LOAD ROUTINE                     33300018
         ST    RE,AVTEOE                APPENDAGE TABLE ENTRY FOR EOE   33400001
*                                                                       33500018
*        LENGTH CHECKING IS REQUIRED FOR DCB                            33600018
*                                                                       33700018
SLDAPP10 EQU   *                                                        34600018
         TM    0(RPARC),OUTP            DCB FOR OUTPUT ONLY?  @ZA28034  34610037
         BO    SLDAPP14                 YES-NO LENGTH CHECK   @ZA28034  34614037
*                                       APPEN NEEDED.         @ZA28034  34618037
         TM    JFCBMASK+RCDRYOF,NORCDRY ANY DEVICES W/O RCD      S20201 34622037
*                                       READY                    S20201 34626037
         BZ    LAB002                   BRANCH IF NO             A49371 34630037
         B     AROUND                   ELSE CHECK FOR C.E. APD  A49371 34638021
LAB002   EQU   *                                                 S20201 34640020
         TM    DCBRECFM,FORMATU         U FORMAT W/RCD READY     S20201 34650020
         BM    AROUND                   NO BRANCH                Y02072 34660002
         TM    DCBRECFM,TRKOVFL         TRACK OVERFLOW USED      S20201 34670020
         BO    AROUND                   BRANCH IF YES            S20201 34680020
         LA    RB,ACEU                  GET RCD READY U FORM CE  S20201 34690020
         B     SLDAPP08                 GO LOAD ROUTINE          Y02072 34700002
AROUND   EQU   *                                                 S20201 34740020
*                                                                       34750020
*                                                                       34760020
         TM    DCBOPTCD,BYPASS          BYPASS DOS CHKPT RCD     S21040 34860021
         BO    SLDAPP11                 BRANCH IF YES            S21040 34960021
SALADS   EQU   *                                                 S20038 35303020
         TM    DCBCIND2,QSAMB           QSAM BEING USED          S19015 35306019
         BO    SLDAPP06                 YES--BRANCH              S19015 35312019
         TM    DCBBFTEK,BFTEKR          VS BDAM SUPPORT NEEDED   S19015 35318019
         BZ    SLDAPP06                 NO--CONTINUE             S19015 35324019
         LA    RB,CEAOFRD               OFFSET READ CHANNEL END  S19015 35330019
         BAL   RC,SLDROUT               GO LOAD ROUTINE          S19015 35336019
         ST    RE,AVTCE                 APPENDAGE TABLE ENTRY FOR CE    35342001
         ST    RE,AVTABNE               APPENDAGE TABLE ENTRY FOR       35348001
*                                       ABNORMAL END APPENDAGE          35354001
         L     RJ,DCBCNTRL              NO EOB MODULES NEEDED    S19015 35360019
         SRL   RJ,TWOBYTES              SHIFT OUT EOB ID BYTES   S19015 35366019
         ST    RJ,DCBCNTRL                                       S19015 35372019
         B     SLDAPP19                 GET READY TO XCTL        S20201 35378020
*                                                                       35384019
SLDAPP06 EQU   *                                                 S19015 35390019
         LA    RB,ACEV                  GET V LN CKNG APPN.             35400018
SLDAPP08 EQU   *                                                 Y02072 35450002
*                                                                       35458002
         BAL   RBRANCH,SLDROUT          GO LOAD ROUTINE          Y02072 35460002
         ST    RWK1,AVTCE               ST CE APPENDAGE          Y02072 35470002
         TM    DCBDEVT,DABIT            IS THIS DA               YM5922 35480002
         BZ    SLDAPP14                 NO, BYPASS ABN END APP   Y02072 35490002
         TM    DCBRECFM,DCBRECTO        TRACK OVERFLO            Y02072 35492002
         BO    SLDAPP17                 YES, GO GET 19C3         Y02072 35494002
         AH    RWK1,SECENTRY            ABN END ENTRY PT ADDR    Y02072 35496002
         ST    RWK1,AVTABNE             ST ADDRESS               Y02072 35498002
         B     SLDAPP17                 GO AROUND                Y02072 35498402
SLDAPP11 EQU   *                                                        35600018
         LA    RB,DACEV                 GET V APPEND. FOR BYPASS S21040 35660021
*                                       DOS EMBEDDED CHKPT RCDS         35720021
SLDAPP12 BAL   RC,SLDROUT               LOAD ROUTINE                    35800018
         ST    RE,AVTCE                 APPENDAGE TABLE ENTRY FOR CE    35900001
         MVC   ABENDISP(ADLEN,RTIOT),ADDISP(RWTG) APPENDAGE ADDR S21040 35960021
*                                    TO ABNORMAL END FIELD IN DEB       35980021
SLDAPP14 EQU   *                                                        36000018
         TM    DCBDEVT,X'48'            PRINTER USED                    36100018
         BC    14,SLDAPP17              NO BRANCH                       36200018
         LA    RB,PSIO                  GET SIO APPNDAGE                36300018
*                                                                       36320019
SLDAPP15 EQU   *                                                 S19015 36340019
*                                                                       36360019
         BAL   RC,SLDROUT               LOAD ROUTINE                    36400018
         ST    RE,AVTSIO                APPENDAGE TABLE ENTRY FOR SIO   36500001
         B     SLDAPP19                 SKIP TO NEXT                    36600018
*                                                                       36700018
SLDAPP17 EQU   *                                                        36800018
*                                                                       36803019
         TM    DCBCIND2,UPDATEB         IS IT UPDATE             S19015 36806019
         BNO   SLDAPP19                 NO BRANCH                S19015 36809019
*                                                                       36812019
         NI    DCBCIND2,OFF             TURN OFF UPDATE BIT      S19015 36815019
*                                                                       36818019
         TM    DCBRECFM,OVRFLO          ARE TRACK OVERFLOW       S19015 36821019
*                                       MODULES                  S19015 36824019
*                                           REQUIRED                    36827019
         BZ    SLDAPP18                 NO BRANCH                S19015 36830019
*                                                                       36833019
         LA    RB,TOABNE                GET ADDRESS OF ABNORMAL  S19015 36836019
*                                           END APPEND. FOR TRACK       36839019
*                                            OVERFLOW INPUT             36842019
         BAL   RC,SLDROUT               LOAD ROUTINE             S19015 36845019
         ST    RE,AVTABNE               APPENDAGE TABLE ENTRY FOR       36846401
*                                       ABNORMAL END APPENDAGE          36848401
*                                                                       36854019
         LA    RB,ASYNCH                GET ID OF ASYNCHRONOUS   S19015 36857019
*                                       RTN                      S19015 36860019
         BAL   RC,SLDROUT               LOAD ROUTINE             S19015 36863019
*                                                                       36866019
******************************************************************      36869019
*                                                                       36872019
*        BUILD IRB FOR IGG019C1 - WORKAREA IS USED IN 19C3              36873002
*                                                                       36874002
         CIRB  EP=(0),KEY=PP,MODE=PP,STAB=(RE),WKAREA=ASISVLN    YM1141 36875002
*                                                                       36878019
         ST    RF,IRBDISP(RWTG)         STORE ADDRESS OF IRB     S19015 36881019
         MVC   DEBIRBAD+BYTE(ADLEN),ADDISP(RWTG) PUT IRB ADDR    S19015 36884019
*                                           IN DEB                      36887019
*                                                                       36900018
SLDAPP18 EQU   *                                                        37000018
*                                                                       37100018
         LA    RB,USIO                  GET SIO APPENDAGE ID     S19015 37130019
         BAL   RC,SLDROUT               GO LOAD MODULE                  37160001
         ST    RE,AVTSIO                APPENDAGE TABLE ENTRY FOR SIO   37170001
*                                                                       37200018
SLDAPP19 EQU   *                                                        37300018
         USING WTGENTRY,RWTGC                                    Y02072 37350002
         MVC   WTGIDTTR,SOP9            ID OF NEXT EXEC        @Z30TSCF 37400003
*                                                                       43500018
         STC   RD,DEBNMSUB              STORE NO. SUB RTS LOADED        43600018
*                                                                       43700018
*********************************************************************** 43800018
*                                                                       43900018
RELOOP   LA    RWTGC,WGOFF(0,RWTGC)     INCREMENT CURR WTG ENTRY        44000018
         LA    RPARC,PLOFF(0,RPARC)     INCR CURRENT DCB ENTRY PRTR     44100018
         CLC   0(2,RWTGC),AMIDCNST      THIS RT NEEDED AGAIN            44200018
         BCR   8,RBASE                  BACK TO OPEN CONTROL            44300018
*                                                                       44400018
         CLC   0(2,RWTGC),OPIDCNST      END OF TABLE                    44500018
         BC    7,RELOOP                 NO,CHECK NEXT ENTRY             44600018
*                                                                       44700018
         LR    RPARC,RPAR                                               44800018
         LA    RWTGC,WAOFF(0,RWTG)      REINITIALIZE WTG LIST PTR       44900018
ZCHEK    CLI   0(RWTGC),X'00'          IS THIS ENTRY COMPLETE           45000018
         BC    7,TCTLRTN                IF NOT TRANSFER CONTROL         45100018
*                                                                       45200018
         LA    RWTGC,WGOFF(0,RWTGC)     GET NEXT ENTRY                  45300018
         LA    RPARC,PLOFF(0,RPARC)                                     45400018
         B     ZCHEK                    COMPLETE                        45500018
*                                                                       45600018
TCTLRTN  EQU   *                                                        45700018
         USING WTG,RWTG                                                 45750003
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSCF*45800003
               MODID=WTGENTRY                                  @Z30TSCF 45850003
         DROP  RWTGC,RWTG                                      @Z30TSCF 45950003
*                                                                       46400018
*                                                                       46500018
*                                                                       46600018
SLDROUT  EQU   *                                                        48400018
         USING WTGMODNM,RWTG                                     Y02072 48450002
         MVC   WTGMODID,0(RB)           ID TO MOD NAME           Y02072 48500002
         DROP  RWTG                                              Y02072 48550002
         L     R1,CVTPTR                LOAD CVT ADDRESS         YM1140 48600002
         USING CVT,R1                   CVT ADDRESSABILITY       YM1140 48650002
         L     R1,CVTLINK               GET LPALIB DCB ADDRESS   YM1140 48700002
         DROP  R1                       DROP CVT BASE            YM1140 48750002
*                                                                       48800002
         LOAD  EPLOC=(RWTG),DCB=(1)                              YM1140 49700002
*                                                                       49800018
*                                                                       49900018
*                                                                       50000018
         ST    RE,24(RWTG)             TEMP STORE OF ROUTINE ADDR,      50100018
SLDROUT1 MVC   0(2,RUCB),0(RB)          STORE ROUTINES ID IN DEB        50200018
         LA    RUCB,2(RUCB)             UPDATE SUBRT PNTR               50300018
         LA    RD,1(RD)                 ONE MORE SUB RT LOADED          50400018
         BR    RC                      RETURN                           50500018
*                                                                       52600018
*********************************************************************** 52700018
*                                                                       52800018
*                                                                       52802018
*                                                                       52804018
*                                                                       52806018
WAOFF    EQU   32                                                       52808018
PLOFF    EQU   4                        OFFSET OF DCB ENTRIES           52810018
WGOFF    EQU   8                        OFFSET OF WTG ENTRIES           52812018
FOUR     DC    H'4'                     4                        M4567  52813019
SECENTRY EQU   FOUR                     ADDITIONAL ENTRY POINT   Y02072 52813402
*                                         IN APPENDAGE           Y02072 52813802
OPIDCNST DC    C'0S'                    ID                              52814018
AMIDCNST DC    C'91'                    MODULE ID                  UT18 52832018
SOP9     DC    C'93',VL3(IGG01993)      NEXT EXEC              @Z30TSCF 52832503
*                                                                       53700018
*        BELOW ARE THE SHARABLE ROUTINES USED BY BSAM / QSAM            58200018
*                                                                       58500018
*        APPENDAGES USED BY BSAM AND QSAM   ---------------------       58600018
*                                                                       58800018
AEOE     DC    C'CH'                    END OF EXTENT APPNDG NON-SF-INP 58900018
QUEOE    DC    C'AW'                    END OF EXTENT FOR UPDATE S19015 59120019
DACEV    DC    C'EJ'                    CHAN/ABNORM END APPNDG   S21040 59200021
*                                       FOR BYPASS OF DOS CHKPT RCDS    59240021
ACEV     DC    C'CJ'                    CHANNEL END APPNDG LEN CHK VREC 59500018
CEAOFRD  DC    C'BV'                    OFFSET READ CEA          S19015 59740019
PSIO     DC    C'CL'                    APPENDAGE FOR PRINTERS SIO      60100018
USIO     DC    C'CG'                    SIO FOR UPDATE           S19015 60308019
TOABNE   DC    C'C3'                    ABNORMAL END APPENDAGE   S19015 60332019
*                                       FOR OVERFLOW             S19015 60340002
ASYNCH   DC    C'C1'                    T.O. ASYNCHRONOUS ERR    S19015 60364019
ACEU     DC    C'C0'                    RCD READY U FORMT CHAN   S20201 62280002
*                                       END                      S20201 62290020
AEOESF   DC    C'C4'                    S.D.END OF EXT APPEN     S20201 62300002
CEAFP    DC    C'FP'                    SEARCH DIRECT CHANNEL    S20201 62310002
         SPACE                                                          62320002
PATCH    DC    25H'0'                   PATCH AREA               Y02072 62330002
END      EQU   *                        END OF MODULE            Y02072 62700002
 TITLE 'IGG01991 - FORMAT OF GOTTEN COrE'                               62800018
         IECDSECS  MAIN,WTG,PREFX,EXPAND=YES                   @Z30TSCF 62850003
         ORG   WTGIDTTR                                          Y02072 62900002
WTGID    DS    CL2                      NEXT MOD ID              Y02072 62950002
*                                                                       63100018
AVT      DSECT                          APPENDAGE VECTOR TABLE          63106001
AVTEOEPG DS    0CL1                     NO.PAGES MODULE REQUIRES        63112001
AVTEOE   DS    A                        ADDR OF END OF EXTENT           63118001
*                                       APPENDAGE                       63124001
AVTSIOPG DS    0CL1                     NO.PAGES MODULE REQUIRES        63130001
AVTSIO   DS    A                        ADDR OF START I/O               63136001
*                                       APPENDAGE                       63142001
AVTPCIPG DS    0CL1                     NO.PAGES MODULE REQUIRES        63148001
AVTPCI   DS    A                        ADDR OF PCI APPENDAGE           63154001
AVTCEPG  DS    0CL1                     NO.PAGES MODULE REQUIRES        63160001
AVTCE    DS    A                        ADDR OF CHANNEL END             63166001
*                                       APPENDAGE                       63172001
AVTABNPG DS    0CL1                     NO.PAGES MODULE REQUIRES        63178001
AVTABNE  DS    A                        ADDR OF ABNORMAL END            63184001
*                                       APPENDAGE                       63194001
*                                                                       63200018
CVT      DSECT                                                          63300018
         CVT                                                            63400018
*                                                                       63500018
*                                                                       63600018
BLDEB    DSECT                                                          63700018
DEB      DS    0F                       ALIGN                           63800018
DEBNMSUB DS    0CL1                     NO. OF SUB.                     63900018
DEBTCBAD DS    CL4                      TCB ADDR.                       64000018
DEBAMLNG DS    0CL1                     ACCESS METHOD LEN.              64100018
DEBDEBAD DS    CL4                      DEB ADDR.                       64200018
DEBOGLGS DS    0CL1                     OPTION                          64300018
DEBIRBAD DS    CL4                      IRB ADDRESS                     64400018
DEBOPATB DS    0CL1                     OPTION                          64500018
DEBSYSPG DS    CL4                      SYS ABEND                       64600018
DEBNMEXT DS    0CL1                     NO. OF EXTENT                   64700018
DEBUSRPG DS    CL4                      USER PROG.                      64800018
DEBPRIOR DS    0CL1                     PRIORITY                        64900018
DEBECBAD DS    CL4                      ECB ADDRESS.                    65000018
DEBPROTG DS    0CL1                     PROTECTION KEY                  65100018
DEBDEBID DS    0CL1                     DEB ID                          65200018
DEBDCBAD DS    CL4                      DCB ADDRESS                     65300018
DEBEXSCL DS    0CL1                     EXCEPTION                       65400018
DEBAPPAD DS    CL4                      APPENDAGE ADDRESS               65500018
DEBDVMOD DS    0CL1                     DEVICE                          65600018
DEBUCBAD DS    CL4                      UCB ADDRESS                     65700018
DEBBINUM DS    CL2                      BIN NUMBER                      65800018
DEBSTRCC DS    CL2                      START CYC.                      65900018
DEBSTRHH DS    CL2                      START TRACK                     66000018
DEBENDCC DS    CL2                      END CYCLINDER                   66100018
DEBENDHH DS    CL2                      END TRACK                       66200018
DEBNMTRK DS    CL2                      NO. OF TRACKS                   66300018
*                                                                       66400018
           DCBD  DSORG=PS                                               66500018
DCBECC   EQU   DCBCHECK+1               DCB FIELD                       66600018
         IKJTCB                                                         66610001
         END                                                            66700018
