         TITLE 'CREATE BDAM(SPANNED RECORD) - IGG0199L'                 00100019
IGG0199L CSECT                                                          00200019
*                                                                     * 00300002
*MODULE NAME - IGG0199L                                               * 00302002
*                                                                     * 00304002
*DESCRIPTIVE NAME - BDAM CREATE OPEN EXECUTOR FOR SPANNED RECORDS     * 00306002
*                                                                     * 00306402
*COPYRIGHT - NONE                                                     * 00306802
*                                                                     * 00306902
*CHANGE ACTIVITY                                                      * 00309502
*                                                                     * 00315002
*          RELEASE 20 CHANGES/DELETIONS                                 00317602
*0150472000                                                      A37858 00320202
*0150                                                            M1157  00322802
*0150199000,240000-243000                                        S20201 00325402
*          RELEASE 21 CHANGES/DELETIONS                                 00328002
*          RELEASE VS2-2 CHANGES/DELETIONS                              00378002
*192800,265600-265800,415700-419900,421300                       Y02072 00380002
*          RELEASE VS2-3 CHANGES/DELETIONS                              00382003
*                                                              @Z30TSMI 00382403
*                                                                       00384019
*STATUS CHANGE LEVEL 004                                                00434002
*                                                                       00500019
*   THIS MODULE IS ADDED AT RELEASE 19 BY SPLIT OF IGG0191L             00600019
*                                                                       00700019
*FUNCTION - THIS ROUTINE IS GIVEN CONTROL AFTER THE DEB AND IOB HAVE    00800019
*           BEEN CONSTRUCTED.                                           00900019
*           1. IT CONSTRUCT CHANNEL PROGRAMS                            01000019
*           2. FOR RECFM=VS AND BFTEK=R,IT OBTAINS SEGMENT WORK AREA    01100019
*              IF NECESSARY AND CREATES RB FOR ASYNCHRONOUS EXIT RTN.   01200002
*              (AN AUDIT TRAIL BIT IS SET TO INDICATE CORE WAS          01350002
*              OBTAINED FOR A SWA. THIS BIT WILL BE INTERROGATED        01360002
*              BY THE FORCE CLOSE EXECUTOR, SHOULD AN ABEND OCCUR       01370002
*              DURING OPEN PROCESSING.  ANOTHER BIT WILL BE SET         01380002
*              AFTER THE DCB HAS BEEN COPIED BACK INTO USER CORE.       01390002
*              IF THIS BIT IS ON THE FORCE CLOSE EXECUTOR WILL GIVE     01392002
*              CONTROL TO THE NORMAL CLOSE EXECUTORS.)                  01394002
*                                                                       01400019
*ENTRY POINT - ENTERED FROM IGG0191L WHEN MACRF=WL AND NO TRACK OVER-   01500019
*              FLOW IS SPECIFIED.                                       01600019
*                                                                       01700019
*INPUT - REGISTERS 5,6,7,8 HAVE BEEN POSITIONED AS FOLLOWS,             01800019
*           5 - BEGINNING OF THE OPEN PARM LIST                         01900019
*           6 - BEGINNING OF THE WTG                                    02000002
*           7 - CURRENT ENTRY IN THE PARM LIST                          02100019
*           8 - CURRENT ENTRY IN THE WTG TABLE                          02200019
*                                                                       02300019
*OUTPUT - THE CHANNEL PROGRAMS WILL BE CONSTRUCTED.                     02400019
*         FOR THE DCB WITH RECFM=VS AND BFTEK=R,RB FOR ASYNCHRONOUS     02500019
*         EXIT ROUTINE IS CREATED.                                      02600019
*                                                                       02700019
*EXTERNAL ROUTINES - NONE                                               02800019
*                                                                       02900019
*EXIT - TO THE LAST LOAD OF COMMON OPEN, IGG0190S.                      03000002
*                                                                       03100019
*TABLES/WORK AREA - 1. OPEN WORK AREA (SEE EXPANSION OF IECDSECT MACRO  03200019
*                      EXPANSION)                                       03300019
*                   2. DIRECT ACCESS DEVICE TABLE                       03400019
*                                                                       03500019
*ATTRIBUTES - THIS ROUTINE RESIDES IN LPALIB. IT IS REENTRANT,          03600002
*             ENABLED, AND RUNS IN SUPERVISOR MODE. IT RUNS IN          03700002
*             DATA MANAGEMENT KEY DURING ALL EXECUTION BUT THE          03800002
*             FURTHER INITIALIZATION OF IOBS AND CHANNEL PROGRAMS AND   03810002
*             GETMAIN AND INITIALIZATION OF SWAS, WHERE A MODESET IS    03850002
*             ISSUED TO PROCESS IN USER KEY.                            03860002
*                                                                       03900019
*NOTES -                                                                04000019
*                                                                       04100019
*                                                                       04200019
*********************************************************************** 04300019
         EJECT                                                          04400019
*********************************************************************** 04500019
*                                                                       04600019
*   REGISTER CONVENTION                                                 04700019
*                                                                       04800019
*********************************************************************** 04900019
*                                                                       05000019
RE       EQU   0                   WORK/PARAMETER REGISTER              05100019
R0       EQU   0                   SAVE REG FOR IECRES           Y02072 05150002
RF       EQU   1                   WORK/PARAMETER REGISTER              05200019
RDCB     EQU   2                   DCB ADDRESS                          05300019
RBASE    EQU   3                   BASE FOR THIS MODULE                 05400019
RCORE    EQU   4                   WORK AREA ADDRESS                    05500019
RPAR     EQU   5                   POINTER TO THE PARAMETER LIST        05600019
RWTG     EQU   6                   POINTER TO W-T-G TABLE               05700019
RPARC    EQU   7                   CURRENT ENTRY IN PARAMETER LIST      05800019
RWTGC    EQU   8                   CURRENT ENTRY IN W-T-G TABLE         05900019
RTIOT    EQU   9                   TIOT ADDRESS                         06000019
RIOB     EQU   9                   IOB REGISTER                         06100019
RUCB     EQU   10                  UCB ADDRESS                          06200019
RDEB     EQU   11                  DEB ADDRESS                          06300019
RB       EQU   12                  WORK REGISTER                        06400019
RC       EQU   13                  WORK REGISTER                        06500019
RD       EQU   14                  WORK REGISTER                        06600019
R14      EQU   14                  SAVE REG FOR IECRES           Y02072 06650002
RJ       EQU   15                  WORK/PARAMETER REGISTER              06700019
*                                                                       06800019
*                                                                       06900019
*********************************************************************** 07000019
*                                                                       07100019
*   EQUATES                                                             07200019
*                                                                       07300019
*********************************************************************** 07400019
*                                                                       07500019
NULL     EQU   0                   CONSTANT '0'                         07600019
ONE      EQU   1                   CONSTANT '1'                         07700019
FIRST    EQU   1                   CONSTANT '1'                         07800019
TWO      EQU   2                   CONSTANT '2'                         07900019
THREE    EQU   3                   CONSTANT '3'                         08000019
FOUR     EQU   4                   CONSTANT '4'                         08100019
FIVE     EQU   5                   CONSTANT '5'                         08200019
SIX      EQU   6                   CONSTANT '6'                         08300019
SEVEN    EQU   7                   CONSTANT '7'                         08400019
EIGHT    EQU   8                   CONSTANT '8'                         08500019
NINE     EQU   9                   CONSTANT '9'                         08600019
TEN      EQU   10                  CONSTANT '10'                        08700019
MSK14    EQU   14                  CONSTANT '14'                        08800019
MSK16    EQU   16                  CONSTANT '16'                        08900019
MSK20    EQU   20                  CONSTANT '20'                        09000019
MSK22    EQU   22                  CONSTANT '22'                        09200019
MSK23    EQU   23                  CONSTANT '23'                        09300019
MSK24    EQU   24                  CONSTANT '24'                        09400019
MSK32    EQU   32                  CONSTANT '32'                        09600019
WRITOFFS EQU   96                  OFFSET TO WRITE CCW                  09800002
*                                                                       09900019
WGOFF    EQU   8                   OFFSET OF ENTRIES IN WTG TABLE       09950002
PAROFF   EQU   4                   OFFSET OF ENTRIES IN PARM LIST       09960002
ASYNCAD  EQU   8                   OFFSET IN 19BR TO ADDR        Y02072 09970002
*                                  OF ASI ROUTINE                Y02072 09980002
ERSOP    EQU   X'11'               ERASE OP-CODE                        10000019
ERSFLG   EQU   X'20'               SUPPRESS INCORRECT LENGTH            10100019
ERSCNT   EQU   X'08'               COUNT OF 8                           10200019
*                                                                       10300019
YES      EQU   8                   CONDITION CODE FOR  'BCR 8,X'        10400019
*                                                                       10500019
*                                                                       10600019
SCHIDEQ  EQU   X'31'               CCW=SRCH ID EQ                       10700019
WRTCKD   EQU   X'1D'               CCW=WRITE C/K/D                      10800019
DCHN     EQU   X'80'               DATA CHAIN FLAG                      10900019
RDKD     EQU   X'0E'               CCW=READ K/D                         11000019
CCHN     EQU   X'40'               COMMAND CHAIN FLAG                   11100019
WRTD     EQU   X'05'               CCW=WRITE DATA                       11200019
READD    EQU   X'06'               CCW=READ DATA                        11300019
SILI     EQU   X'20'               SILI FLAG                            11400019
SKIP     EQU   X'10'               SKIP FLAG                            11500019
*                                                                       11600019
WRTBIT   EQU   X'40'               WRITE TYPE OPERATION                 11700019
*                                                                       11800019
VORU     EQU   X'40'               DCBRECFM=V/U                         11900019
FORU     EQU   X'80'               RECFM=F/U                            12000019
SPANNING EQU   X'08'               RECFM=S                              12100019
SOFTTRK  EQU   X'20'               BFTEK=R                              12200019
WRTCHK   EQU   X'80'               DCBOPTCD=WRITE CHECK                 12300019
SAMEREC  EQU   X'01'               COBOL HAS PROVIDED WITH S-W-A        12400019
HIARCHY  EQU   X'80'               DCBBFTEK=HIARCHY                     12500019
MSKCB    EQU   12                  LENGTH OF SWA C.B.                   12600019
*                                                                       12700019
*                                                                       12800019
*********************************************************************** 12900019
*                                                                       13000019
*   REGISTER INITIALIZATION                                             13100019
*                                                                       13200019
*********************************************************************** 13300019
*                                                                       13400019
         USING GOGOGO,RBASE        ESTABLISH BASE REGISTER              13500019
         USING DEBBASIC,RDEB       ESTABLISH DEB REGISTER        Y02072 13600002
         USING IHADCB,RDCB         ESTABLISH DCB REGISTER               13700019
         USING IOBBSAMN,RIOB       ESTABLISH IOB BASE            Y02072 13800002
         USING FORCORE,RCORE                                     Y01021 13850000
         USING WTG,RWTG                                                 13860003
         USING WTGENTRY,RWTGC                                           13870003
*                                                                       13900019
         BALR  RBASE,RE            ESTABLISH BASE REGISTER              14000019
*                                                                       14100019
GOGOGO   EQU   *                                                        14200019
*                                                                       14300019
         L     RDCB,NULL(RPARC)    LOAD DCB ADDRESS                     14400019
         L     RCORE,FOUR(RWTGC)   LOAD WORK AREA ADDRESS               14500019
         L     RDEB,DCBDEBAD       LOAD DEB ADDRESS                     14600019
*                                                                       14700019
         L     RIOB,DCBIOBA        LOAD IOB ADDRESS                     14800019
*                                                                       14800102
         MODESET   KEYADDR=DXUKEY,WORKREG=13 CHANGE TO USER KEY  Y02072 14800402
*                                                                       14800802
         L     RC,IOBSTART         GET SECTOR ADDRESS            Y02072 14802002
*                                                                       14900019
*********************************************************************** 15000019
*                                                                       15100019
*   THE FOLLOWING ROUTINE WILL CONSTRUCT CHANNEL PROGRAMS               15200019
*                                                                       15300019
*********************************************************************** 15400019
*                                                                       15500019
         OI    IOBNFLG1,IOBFIRST       MARK FIRST IOB FOR CLOSE  Y02072 15600002
*                                                                       15700019
FILLIOB  EQU   *                                                        15800019
         SR    RD,RD                   CLEAR WORK REG            M1157  15850020
*                                                                       15900019
         IC    RD,DCBKEYLE         INSERT KEY LENGTH AND                16000019
         STC   RD,IOBDNRCF+FIVE    STORE IT IN NEW REORD COUNT FIELD    16100019
         LH    RJ,DCBBLKSI         LOAD BLOCK SIZE AND                  16200019
         STH   RJ,IOBDNRCF+SIX     NEW RECORD COUNT FIELD               16300019
         OI    IOBNFLG1,IOBWRITE   MARK IOB AS A WRITE TYPE      Y02072 16400002
         AR    RJ,RD               ADD KL+BLKSIZE AND                   16600019
         STH   RJ,IOBCCW4+SIX      STORE IT INTO COUNT OF WRITE         16700019
         LA    RJ,EIGHT            SET FOR LENGTH 8 FOR R0 AND          16800019
         ST    RJ,IOBR0CNT+FOUR    STORE IT IN R0 COUNT                 16900019
*                                                                       17000019
         L     RJ,DXUDCBAD              GET USERS DCB PTR IN WKA Y02072 17250002
         LA    RJ,0(RJ)                 ZERO TOP BYTE            Y02072 17260002
         ST    RJ,IOBDCBPT              STORE ADDRESS IN IOB     Y02072 17270002
*                                                                       17300019
         LA    RJ,IOBCC            LOAD  ADDRESS OF CCHHR AND           17400002
         ST    RJ,IOBCCW1          STORE IT AS SRCH ID ARGUMENT         17500019
         MVI   IOBCCW1,SCHIDEQ     SET C.C.=SRCH ID EQ                  17600019
         LA    RJ,IOBCCW1          LOAD ADDRESS OF CCW1 AND             17700019
         ST    RJ,IOBCCW2          STORE IT IN TIC CCW                  17800019
*                                                                       17900019
         ST    RJ,IOBSTART         START OF CHANNEL PROGRAM             18000002
*                                                                       18100019
         MVC   IOBCCW1+FOUR(FIVE),CCHN5TIC   SET CHN,CNT=5 AND TIC C.C. 18200019
*                                                                       18300019
         SR    RJ,RJ               CLEAR REG                            18320019
         IC    RJ,DCBKEYLE         INSERT KEYLENGTH                     18330019
         AH    RJ,DCBBLKSI         ADD BLOCKSIZE                        18340019
         STH   RJ,IOBCCW2+SIX      SAVE KEYLENGTH +                     18350019
*                                  BLKSIZE IN TIC                       18360019
         LA    RJ,IOBDNRCF         LOAD ADDR OF NEW COUNT FIELD AND     18400019
         ST    RJ,IOBCCW3          STORE IT IN WRITE CCW                18500019
         MVI   IOBCCW3,WRTCKD      SET C.C.=WRITE C/K/D                 18600019
         MVI   IOBCCW4,WRTCKD      SET C.C.=WRITE C/K/D                 18700019
         MVI   IOBCCW3+FOUR,DCHN   SET DATA CHAIN FLAG                  18800019
         MVI   IOBCCW3+SEVEN,EIGHT SET COUNT=8                          18900019
*                                                                       18950002
         MODESET  EXTKEY=DATAMGT        CHANGE TO DATA MGT KEY   Y02072 18960002
*                                                                       18970002
         MVI   DCBOFFSW,WRITOFFS        OFFSET TO WRITE CCW             19000019
*                                                                       19100019
         LA    RB,IOBCCW5               SET UP INDEX FOR REMAINING CCWS 19200002
         MVI   DCBOFFSR,NCCWAOFF        ST NON REC REDY, NO      S20201 19202020
*                                       WRTCHK                   S20201 19204020
*                                       OFFSET POINTER TO CCW10         19206020
         MVI   DCBWCPO,NCCW5OFF         PUT NON REC REDY OFFSET  S20201 19208020
*                                       PT TO                    S20201 19210020
*                                           CCW5 INTO DCBWCPO OF DCB    19212020
         TM    JFCBMASK+D6,NONCARN      DO THE STARS INDICATE    S20201 19214020
*                                       RPS                      S20201 19216020
         BNO   RPS                      YES, GO SET UP PTRS      Y02072 19218002
*                                                                       19218402
         TM    DCBOPTCD,WRTCHK          IS WRT CHK REQUESTED     Y02072 19218802
         BO    WTCKCCW2                 BUILD WRT CHK CP         Y02072 19219202
*                                                                       19219602
         MODESET  KEYADDR=DXUKEY,WORKREG=15  CHANGE TO USER KEY  Y02072 19220002
*                                                                       19220102
         B     BLDWRTR0                 GO CONSTRUCT R0          Y02072 19220802
*                                                                       19220902
RPS      EQU   *                        SET UP RPS POINTERS      Y02072 19221202
         MVI   DCBOFFSW,CCCW5OFF        PUT REC REDY OFFSET PT   S20201 19222020
*                                       TO CCW5                  S20201 19224020
*                                       INTO DCBOFFSW AREA OF DCB       19226002
         MVI   DCBWCPO,CCCW7OFF         PUT OFFSET PT TO CCW7    S20201 19228020
*                                       INTO                     S20201 19230020
*                                       DCBWCPO IF REC REDY DEVICE      19232020
         MVI   DCBOFFSR,CCCWEOFF        ST NO WRTCHK WITH RPS    S20201 19234020
*                                         OFFSET POINTER TO CCW14       19236020
*                                          POINTER IN DCBOFFSR          19238020
*                                                                       19238402
         MODESET   KEYADDR=DXUKEY,WORKREG=15  CHANGE TO USER KEY Y02072 19238802
*                                                                       19239602
         MVI   IOBCCW4+HALFCCW,CCHN     MOVE IN CHAIN COMMAND    S20201 19240020
         MVC   IOBCCW5(CARSHIFT),IOBCCW1 SHIFT FOUR CCWS DOWN 32 S20201 19244020
*                                         BYTES AND THEN BRING THEM     19246020
         MVC   IOBCCW2(CARSHIFT),IOBCCW5  BACK TO CCW2. THIS     S20201 19248020
*                                       AVOIDS                   S20201 19250020
*                                         PROPAGATION.                  19252020
         XC    IOBCCW6(CARN24),IOBCCW6  ZERO OUT TEMP MOVE       S20201 19254020
*                                       LOCATION                 S20201 19256020
         ST    RC,IOBCCW1               PUT SECTOR PT IN VACANT  S20201 19258020
*                                       DW                       S20201 19260020
         LA    RJ,IOBCCW2               GET CORRECT ADDR IF      S20201 19262020
*                                       CARNIVAL                 S20201 19264020
         ST    RJ,IOBCCW3                 AND ST IT IN THE TIC   S20201 19266020
         MVI   IOBCCW3,TICCODE          PUT IN THE TIC OP CODE   S20201 19268020
         MVI   IOBCCW1,SETSECT          PUT IN SET SECTOR        S20201 19270020
*                                       COMMAND CODE             S20201 19272020
         MVC   IOBCCW1+HALFCCW(HALFCCW),CCHNCARN  MOVE STD LAST  S20201 19274020
*                                       HALF                     S20201 19276020
*                                            OF REC REDY   CCW IN CCW   19278020
         ST    RC,CARN8(RE,RB)          PUT POINTER IN RD SECT   S20201 19282020
*                                       SET SECT & READ SECT USE Y02072 19282402
*                                       SAME ADDRESS             Y02072 19282802
         MVI   CARN8(RB),RDSECT         PUT IN READ SECTOR       S20201 19284020
*                                       COMMAND                  S20201 19286020
         LA    RB,CARN8(RE,RB)          PT TO RD SECT CCW        S20201 19288020
         MVI   CNTOFF(RB),ONE           SET COUNT TO ONE         S20201 19290020
         LA    RB,CARN8(RE,RB)          SET CCW PTR TO CCW7 IF   S20201 19292020
*                                              RPS FEATURE IS PRESENT   19294020
WTCKTEST EQU   *                                                 S20201 19296020
*                                                                       19300019
         TM    DCBOPTCD,WRTCHK     TEST IF DCBOPTCD=WRITE CHECK         19400019
         BNO   BLDWRTR0            NO,SKIP TO CONSTRUCT WRITE R0        19500019
*                                                                       19600019
*   YES - CONSTRUCT WRITE CHECK CCWS                                    19700019
*                                                                       19800019
         TM    JFCBMASK+D6,NONCARN      CHECK IF RPS             S20201 19806020
         BO    WTCKCCW1                 NO, THEN CONSTRUCT       S20201 19812020
*                                       WRTCHK CCWS              S20201 19818020
         OI    IOBCCW6+FOUR,CCHN        SET CHAIN TO WRT CHK     S20201 19824020
*                                                                       19826002
         MODESET  EXTKEY=DATAMGT        CHANGE TO DATAMGT KEY    Y02072 19828002
*                                                                       19828402
         MVI   DCBOFFSR,CCCWXOFF        PUT 18TH CCW OFFSET PT   S20201 19830020
*                                       INTO                     S20201 19836020
*                                         DCBOFFSR IF RPS               19842020
         MVI   DCBWCPO,CCCWBOFF         STORE OFFSET TO          S20201 19848020
*                                       SCH-ID-EQ                S20201 19854020
*                                       IF WRT CHK AND RPS              19860020
*                                                                       19862002
         MODESET  KEYADDR=DXUKEY,WORKREG=15   CHANGE TO USER KEY Y02072 19864002
*                                                                       19864402
         ST    RC,NULL(RE,RB)           PUT IN SECT2 ADDR        S20201 19866020
         MVI   NULL(RB),SETSECT         PUT IN SET SECTOR        S20201 19872020
*                                       COMMAND                  S20201 19878020
         MVC   HALFCCW(HALFCCW,RB),CCHNCARN  PUT IN FLAG/COUNT   S20201 19884020
*                                       FIELD                    S20201 19890020
         LA    RB,CARN8(RE,RB)          PT TO CCW8               S20201 19896020
         B     WRTCCCWS                 BR AROUND NON RPS        S20201 19902020
*                                         CODING                        19908020
WTCKCCW1 EQU   *                                                 S20201 19914020
*                                                                       19916002
         MODESET  EXTKEY=DATAMGT        CHANGE TO DATAMGT KEY    Y02072 19918002
*                                                                       19918402
WTCKCCW2 EQU   *                        BUILD WRT CHK CHN PGM    Y02072 19918802
         MVI   DCBOFFSR,NCCWDOFF        PUT 13TH CCW OFFSET PT   S20201 19920020
*                                       INTO                     S20201 19926020
*                                       DCBOFFSR OF DCB IF NON-CARNIVAL 19932020
         MVI   DCBWCPO,CCCW8OFF         STORE OFFSET TO          S20201 19938020
*                                       SCH-ID-EQ IF             S20201 19944020
*                                       NO WRT CHK AND RPS              19950020
*                                                                       19952002
         MODESET  KEYADDR=DXUKEY,WORKREG=15   CHANGE TO USER KEY Y02072 19954002
*                                                                       19954402
         OI    IOBCCW4+FOUR,CCHN        SET COMMAND CHAIN TO WRT S20201 19956020
*                                       CHK                      S20201 19962020
*                                       NON RPS                         19968020
WRTCCCWS EQU   *                                                 S20201 19974020
         LA    RJ,IOBDNRCF              LOAD ADDR OF NEW COUNT   S20201 19980020
*                                       FIELD                    S20201 19986020
         ST    RJ,NULL(RB)         STORE IOBDNRCF AS SRCH ARGUMENT      20000019
         MVI   NULL(RB),SCHIDEQ    SET C.C.=SRCH ID EQ                  20100019
         ST    RB,EIGHT(RB)        STORE CCW5 AS TIC ADDR               20200019
*                                                                       20300019
         MVC   FOUR(FIVE,RB),CCHN5TIC   MOVE CHN,CNT AND TIC OP         20400019
         MVI   MSK16(RB),RDKD      SET C.C.=READ K/D                    20500019
         MVI   MSK20(RB),SILI+SKIP SET SILI AND SKIP FLAGS              20600019
         MVI   MSK22(RB),FIRST     SET COUNT=1                          20700019
         LA    RB,MSK24(RB)        INCREMENT INDEX TO NEXT CCW          20800019
*                                                                       20900019
BLDWRTR0 EQU   *                                                        21000019
*                                                                       21100019
*   THIS ROUTINE CONSTRUCT WRITE-R0 CCWS                                21200019
*                                                                       21300019
         TM    JFCBMASK+D6,NONCARN      IS IT RPS (REC READY)    S20201 21308020
         BO    WRTR0                    NO, THEN GO TO WRITE OUT S20201 21316020
*                                       R0                       S20201 21324020
         LA    RC,ONE(RE,RC)            PT TO 2ND SECT BYTE      Y02072 21332002
*                                       2ND BYTE IS 0 -WRTCHK    Y02072 21334002
         ST    RC,NULL(RE,RB)           PUT IN SETSECT COMMAND   S20201 21340020
         MVI   NULL(RB),SETSECT         PUT IN SET SECTOR        S20201 21348020
*                                       COMMAND                  S20201 21356020
         MVC   HALFCCW(HALFCCW,RB),CCHNCARN  PUT IN FLAG/COUNT   S20201 21364020
*                                       FIELD                    S20201 21372020
         LA    RB,CARN8(RE,RB)          PT TO CCW12 IF RPS       S20201 21380020
WRTR0    EQU   *                                                 S20201 21388020
         LA    RJ,IOBR0CNT         AD ADDR OF R0 CNT AND                21400019
         ST    RJ,NULL(RB)         STORE IT AS SRCH ARGUMENT            21500019
         MVI   NULL(RB),SCHIDEQ    SET C.C.=SRCH ID EQ                  21600019
         ST    RB,EIGHT(RB)        STORE SRCH CCW AS TIC ADDR           21700019
         MVC   FOUR(FIVE,RB),CCHN5TIC  MOVE CHN,CNT AND TIC C.C.        21800019
*                                                                       21900019
         LA    RJ,IOBR0DAT         LOAD ADDR OF R0 DATA AND             22000019
         ST    RJ,MSK16(RB)        STORE IT AS WRITE R0 DATA            22100019
         MVI   MSK16(RB),WRTD      SET C.C.=WRITE DATA                  22200019
         MVI   MSK23(RB),EIGHT     SET COUNT=8                          22300019
*                                                                       22400019
         TM    DCBOPTCD,WRTCHK     TEST IF DCBOPTCD=WRITE CHECK         22500019
         BO    BLDCHKR0            YES,GOTO CONSTRUCT WRITE CHECK       22600019
*                                                                       22700019
*   NO - THEN TEST RECFM=F OR RECFM=V/U                                 22800019
*        F - SKIP WRITE CHECK R0                                        22900019
*        V/U - CONSTRUCT WRITE CHECK R0                                 23000019
*                                                                       23100019
         TM    DCBRECFM,VORU       TEST IF RECFM=V/U                    23200019
         BNO   TSTLOOP             NO, GOTO NEXT IOB CHECK              23300019
*                                                                       23400019
BLDCHKR0 EQU   *                                                        23500019
*                                                                       23600019
*   THIS ROUTINE CONSTRUCTS CHANNEL PROGRAM FOR WRITE CHECK R0          23700019
*                                                                       23800019
         MVI   MSK20(RB),CCHN      SET CCHN FOR WRITE R0                23900019
         LR    RJ,RB                    SAVE POINTER TO SCH CCW  S20201 23920020
         TM    JFCBMASK+D6,NONCARN      IS IT THE CREEPING RPS   S20201 23940020
         BO    WRTCHKR0                 NO, THEN GO TO WRTCH R0  S20201 23960020
*                                       RTN                      S20201 23980020
         ST    RC,CARN24(RE,RB)         ST SECT1 ADDR IN RPS     Y02072 24000002
*                                       RD & SET SECT USE 1 BYTE Y02072 24020002
         MVI   CARN24(RB),SETSECT       PUT IN COMMAND CODE      S20201 24040020
         MVC   CARN28(HALFCCW,RB),CCHNCARN  PUT IN FLAG/COUNT    S20201 24060020
*                                       WORD                     S20201 24080020
         LA    RB,CARN8(RE,RB)          UPDATE CCW PTR           S20201 24100020
WRTCHKR0 EQU   *                                                 S20201 24120020
         LA    RE,MSK24(RB)             LOAD ADDR OF SCH CCW AND S20201 24140020
         ST    RE,MSK32(RB)             STORE IT AS TIC ADDRESS  S20201 24160020
         MVC   MSK24(NINE,RB),NULL(RJ)  MOVE SCH R0 CCW AND TIC  S20201 24180020
*                                       C.C.                     S20201 24200020
         LR    RB,RE                    INCREMENT INDEX BY THREE S20201 24220020
*                                       CCWS                     S20201 24240020
         MVI   MSK16(RB),READD     GET C.C.=READ DATA                   24400019
         MVI   MSK20(RB),SILI+SKIP SET SILI AND SKIP FLAGS              24500019
         MVI   MSK23(RB),FIRST     SET LENGTH=1                         24600019
         LA    RB,MSK24(RB)        INCREMENT INDEX TO LAST CCW          24700019
*                                                                       24800019
         TM    DCBRECFM,VORU       IF RECM=V/U                          24900019
         BNO   TSTLOOP             NO,GOTO TEST NEXT IOB                25000019
*                                                                       25100019
*   THIS ROUTINE CONSTRUCTS ERASE CHANNEL PROGRAM                       25200019
*                                                                       25300019
         ST    RB,NULL(RB)         STORE DUMMY ADDRESS IN ERASE CCW     25400019
         MVI   NULL(RB),ERSOP      SET C.C.=ERASE                       25500019
         MVI   FOUR(RB),ERSFLG     SET SILI FLAG                        25600019
         MVI   SEVEN(RB),ERSCNT    SET COUNT OF '8'                     25700019
*                                                                       25800019
TSTLOOP  EQU   *                                                        25900019
*                                                                       26000019
*   IF THERE IS ANY IOB LEFT, REPEAT,ELSE CHECK IF RECFM=V AND BFTEK=R  26100019
*      YES - GOTO VS ROUTINE                                            26200019
*      NO  - XCTL TO THE LAST LOAD OF OPEN                              26300019
*                                                                       26400019
         L     RIOB,IOBNIOBA            LOAD NEXT IOB ADDRESS    Y02072 26500002
         BCTR  RC,NULL                  PT BACK TO ORIGINAL      S20201 26520020
*                                       SECTOR (RD AND SET)      Y02072 26540002
         TM    IOBNFLG1,IOBFIRST        IS NEXT IOB THE FIRST    Y02072 26600002
         BNO   FILLIOB             NO,REPEAT TO CONSTRUCT ANOTHER CCWS  26700019
*                                                                       27400019
         TM    DCBBFTEK,SOFTTRK         TEST IF BFTEK=R                 27500002
         BO    VSPAN                    YES, BR TO SET UP SWA    Y02072 27550002
*                                                                       27560002
         MODESET  EXTKEY=DATAMGT        CHANGE TO DATAMGT KEY    Y02072 27600002
*                                                                       27650002
         B     SCAN                     NO, GO TO XCTL RTN       Y02072 27660002
*                                                                       27700019
*********************************************************************** 27800019
*                                                                       27900019
*   WHEN BFTEK=R IS SPECIFIED,                                          28000019
*       1. OBTAIN SEGMENT WORK AREA                                     28100019
*       2. CREATE IRB FOR ASYNCHRONOUS EXIT ROUTINE                     28200019
*                                                                       28300019
*********************************************************************** 28400019
*                                                                       28500019
*   1. CONSTRUCTION OF SEGMENT WORK AREA POOL.                          28600019
*                                                                       28700019
*      THE SEGMENT WORK AREA IS CONSTRUCTED IF BIT 7 OF DCBMACRF IS NOT 28800019
*      SPECIFIED. THE ADDRESS OF SEGMENT WORK AREA CONTROL BLOCK WILL   28900019
*      BE PLACED IN DCBEOBW.THE FORMATS OF THE SEGMENT WORK AREA        29000019
*      CONTROL BLOCK AND A SEGMENT WORK AREA ARE SHOWN AS DSECTS.       29100019
*      THE NO. OF SEGMENT WORK AREA IS DETERMINED BY DCBNCP AND ITS     29200019
*      LENGTH IS DETERMINED BY SMALLER OF THE TRACK SIZE OR BLKSIZE     29300019
*      THIS ROUTINE IS ENTERED IN USER KEY.                             29350002
*                                                                       29400019
*********************************************************************** 29500019
*                                                                       29600019
VSPAN    EQU   *                        SET UP SEG WORK AREAS    Y02072 29650002
         TM    DCBMACRF+ONE,SAMEREC  TEST IF SEG WORK AREA BEEN GIVEN   29700019
         BO    CHAINSWA            YES,SKIP S.W.A. CONSTRUCTION         29800019
*                                                                       29900019
*   NO - OBTAIN NCP                                                     30000019
*                                                                       30100019
         SR    RJ,RJ               RESET REGISTER                       30200019
         IC    RJ,DCBNCP           INSERT NCP FROM DCB                  30300019
*                                                                       30400019
         L     RD,DCBDVTBL         LOAD DEVICE CHARACTERISTIC TABLE     30500019
         USING DVCT,RD             ESTABLISH BASE FOR DEVICE TAB Y02072 30600002
*                                                                       30700019
         LH    RD,DVCTRKLN         LOAD TRACK LENGTH                    30800002
         DROP  RD                  DROP DASD BASE                       30900019
*                                                                       31000019
         SR    RE,RE               RESET REGISTER                       31100019
         IC    RE,DCBKEYLE         INSERT KEYLENGTH                     31200019
         AH    RE,DCBBLKSI         LENGTH=KEYLEN+BLKSIZE                31300019
*                                                                       31400019
         CR    RD,RE               TEST IF TRACK SIZE EXCEEDS BLKSIZE   31500019
         BNH   CALCORE             NO,GOTO CALCULATE SEG WORK AREA SIZE 31600019
*                                                                       31700019
         LR    RD,RE               LOAD BLKSIZE                         31800019
*                                                                       31900019
CALCORE  EQU   *                                                        32000019
*                                                                       32100019
*   CALCULATE SEGMENT WORK AREA SIZE                                    32200019
*      NCP * SMALLER OF (BLKSIZE OR TRACK SIZE + 10) + 8                32300019
*                                                                       32400019
         AH    RD,CONST10          ADD '10' FOR CONTROL INFORMATION     32500019
*                                                                       32600019
         LA    RD,THREE(RD)        ADJUST TO FULL WORD                  32700019
         SRL   RD,TWO              THEN ROUND IT TO FULL WORD           32800019
         SLL   RD,TWO              BACK TO FULL WORD MULTIPLE           32900019
*                                                                       33000019
         STH   RD,IOBFLAG3         STORE LENGTH INTO IOB FOR     Y02072 33100002
         MH    RJ,IOBFLAG3         TEMPORARY MULTIPLY            Y02072 33200002
         LA    RJ,MSKCB(RJ)        ADD LENGTH OF CONTROL BLOCK          33300019
*                                                                       33700019
         GETMAIN R,LV=(15),SP=0         GET CORE FROM SP0        Y02072 33800002
*                                                                       33900019
*                                                                       34700019
*   INITIALIZE SEG. WORK AREA                                           34800019
*                                                                       34900019
         USING SWACB,RF            ESTABLISH BASE FOR SWA CONTROL BLOCK 35000019
*                                                                       35100019
         XC    SWACBPTR(MSKCB),SWACBPTR  CLEAR SWA CONTROL BLOCK        35200019
         MVC   SWACBNO+ONE(ONE),DCBNCP  MOVE NO. OF SWA                 35300019
         MVC   SWACBLNG,IOBFLAG3        MOVE LENGTH OF SWA       Y02072 35400002
*                                                                       35450002
         MODESET  EXTKEY=DATAMGT        CHANGE TO DATAMGT KEY    Y02072 35460002
*                                                                       35470002
         ST    RF,DCBEOBW               STORE ADDR OF SWA IN DCBEOBW    35500002
         OI    DXATEXC1,FCAOSWA         SET AUDIT TRAIL BIT      Y02072 35550002
*                                       FOR FORCE CLOSE CLEANUP  Y02072 35560002
*                                       INDICATING SWA GOTTEN    Y02072 35570002
*                                                                       35600019
*                                                                       35650002
         MODESET  KEYADDR=DXUKEY,WORKREG=15  CHANGE TO USER KEY  Y02072 35660002
*                                                                       35670002
         LA    RD,MSKCB(RF)             OBTAIN 1ST SWA ADDR             35700002
         ST    RD,SWACBPTR              SET 1ST SWA ADDR PTR            35800002
*                                                                       35900019
         LH    RJ,SWACBNO          INSERT NO. OF SWA                    36000019
         LH    RF,SWACBLNG         LOAD SEG WORK AREA LENGTH            36100019
         B     LASTSWA             GOTO CHECK SEGMENT WORK AREA         36200019
*                                                                       36300019
         USING SWA,RD              ESTABLISH BASE FOR S.W.A.     Y02072 36400002
*                                                                       36500019
REPEAT   EQU   *                                                        36600019
*                                                                       36700019
*   LINK ALL SEGMENT WORK AREA                                          36800019
*                                                                       36900019
         LA    RE,NULL(RF,RD)      LOAD NEXT SWA ADDR                   37000019
         ST    RE,SWANXTPT         STORE NEXT SWA ADDR IN SWA    Y02072 37100002
         XC    SWARCDPT,SWARCDPT   CLEAR THE CONTROL FIELD       Y02072 37200002
         LR    RD,RE               POINT TO NEXT SWA                    37300019
*                                                                       37400019
*                                                                       37500019
LASTSWA  EQU   *                                                        37600019
*                                                                       37700019
         BCT   RJ,REPEAT           GOTO LINK NEXT SEG. WORK AREA        37800019
*                                                                       37900019
         XC    SWA(SWACSLNG),SWA     RESET POINTER TO '0'        Y02072 38000002
*                                                                       38100019
CHAINSWA EQU   *                                                        38200019
*                                                                       38300019
*   TIE S.W.A. TO I/O AREA OF IOBS                                      38400019
*                                                                       38500019
         L     RD,DCBEOBW          LOAD S.W.A.CB ADDR                   38600019
         XC    EIGHT(FOUR,RD),EIGHT(RD) CLEAR TT FIELDS                 38650019
         L     RD,NULL(RD)         LOAD FIRST SWA ADDR                  38700019
*                                                                       38800019
LOOPSWA  EQU   *                                                        38900019
*                                                                       39000019
         LA    RC,SWASEGMT         GET ADDR OF DATA PART OF SWA  Y02072 39100002
         TM    JFCBMASK+D6,NONCARN      IS IT THE RPS MONSTER    S20201 39110020
         BO    NOCARN1                  IF NOT BRANCH OUT        S20201 39120020
         ST    RC,IOBCCW5               SET DATA ADDR TO SWA FOR S20201 39130020
*                                       CARN                     S20201 39140020
         MVI   IOBCCW5,WRTCKD           IMPLACE THE OF CODE      S20201 39150020
         B     NEXTIOB                  LOOK FOR NEXT IOB        S20201 39160020
NOCARN1  EQU   *                                                 S20201 39170020
         ST    RC,IOBCCW4          SET DATA ADDR TO S.W.A.              39200019
         MVI   IOBCCW4,WRTCKD      SET C.C.=WRITE-C/K/D                 39300019
NEXTIOB EQU *                                                    S20201 39350020
*                                                                       39400019
         L     RIOB,IOBNIOBA       LINK TO THE NEXT IOB          Y02072 39500002
         L     RD,SWANXTPT         LOAD NEXT S.W.A. ADDR         Y02072 39600002
*                                                                       39700019
         TM    IOBNFLG1,IOBFIRST   TEST IF THIS IS THE FIRST IOB Y02072 39800002
         BO    CRIRB               YES,END LOOP AND GOTO CRIRB ROUTINE  39900019
*                                                                       40000019
         B     LOOPSWA             GOTO TIE NEXT SWA AND CCW            40100019
*                                                                       40200019
*********************************************************************** 40300019
*                                                                       40400019
CRIRB    EQU   *                                                        40500019
*                                                                       40600019
*********************************************************************** 40700019
*                                                                       40800019
*   CREATE IRB FOR ASYNCHRONOUS EXIT ROUTINE                            40900019
*        THE ROUTINE IS A PART OF WRITE AND IT'S ADDRESS IS             41000019
*        STORED IN THE +8 OF WRITE ROUTINE                              41100019
*                                                                       41200019
*********************************************************************** 41300019
*                                                                       41400019
CIRB     EQU   *                                                 M4893  42060019
         L     RJ,DCBWRITE              LOAD ADDR OF VS WR(19BR) Y02072 42110002
         L     RE,ASYNCAD(RJ)           LOAD ADDR OF ASI IN 19BR Y02072 42160002
*                                                                       42170002
         CIRB  EP=(0),KEY=PP,MODE=PP,STAB=(RE)                   Y02072 42200002
*                                                                       42300019
*                                                                       42350002
         MODESET  EXTKEY=DATAMGT       CHANGE TO DATAMGT KEY     Y02072 42360002
*                                                                       42370002
         IC    RJ,DEBOFLGS         SAVE DEBOFLGS                        42400019
         ST    RF,DEBIRBAD         STORE IRB ADDR IN DEB                42500019
         STC   RJ,DEBIRBAD         RESTORE DEBOFLGS INTO                42600019
*                                                                       43200019
*********************************************************************** 43300019
*                                                                       43400019
*   THIS ROUTINE DETERMINES DCB PARM LIST AND WHERE-TO-GO NEXT.         43500019
*   THE NEXT ROUTINE FOR THIS DCB IS ALWAYS THE COMMON OPEN             43600002
*   MODULE, IGG0190S                                                    43650002
*                                                                       43700019
*********************************************************************** 43800019
SCAN     EQU   *                                                        43850002
         MVC   DEBDCBB,DXUDCBAD+1       REPLACE DCB COPY ADDR    Y02072 43860002
*                                       WITH USER DCB IN DEB     Y02072 43870002
*                                                                       43900019
*  ISSUE A MACRO WHICH CALLS AN EXTERNAL ROUTINE TO COPY THE            43950002
*  PROTECTED DCB INTO THE USER'S DCB CORE.                              43960002
*                                                                       43970002
*                                                                       43974002
*                                                                       43978002
         IECRES  INIT,DCBCOPY=FRWKAR,STM=(R0,R14,WTGPREFX)       Y02072 43980002
*                                                                       43990002
         OI    DXATEXC1,FCAOCOPY        SET AUDIT TRAIL BIT      Y02072 43994002
*                                       FOR FORCE CLOSE CLEANUP  Y02072 43996002
*                                       INDICATING DCB COPIED    Y02072 43998002
         MVI   NULL(RWTGC),NULL         SET THIS DCB COMPLETE    Y02072 44000002
*                                                                       44100019
SCAN4EQ  EQU   *                                                        44500019
*                                                                       44600019
         LA    RWTGC,WGOFF(RWTGC)  INCREMENT W-T-G INDEX AND            44700019
         LA    RPARC,PAROFF(RPARC) PARAMETER LIST INDEX                 44800019
         CLC   NULL(TWO,RWTGC),AMIDCNST IS THIS EXECUTOR NEEDED AGAIN   44900019
         BCR   YES,RBASE           YES,RETURN TO STARTING POINT         45000019
         CLC   NULL(TWO,RWTGC),OPIDCNST IS THIS END OF W-T-G TABLE      45100019
         BNE   SCAN4EQ             NO,CONTINUE SCAN                     45200019
*                                                                       45300019
*   YES - DETERMINE ANY MORE DCB                                        45400019
*                                                                       45500019
         LR    RPARC,RPAR          RESET PARM LIST INDEX AND            45600019
         LA    RWTGC,MSK32(RWTG)   W-T-G INDEX TO ENTRY ONE             45700019
*                                                                       45800019
SCAN4ANY EQU   *                                                        45900019
*                                                                       46000019
         CLI   NULL(RWTGC),NULL    IS THIS DCB COMPLETE                 46100019
         BNE   XCTLRTN             NO,XCTL TO NAMED EXECUTOR            46200019
*                                                                       46300019
         LA    RWTGC,WGOFF(RWTGC)  YES,INCREMENT CURRENT ENTRY REG.     46400019
         LA    RPARC,PAROFF(RPARC) INCREMENT CURRENT PARM LIST REG.     46500019
         B     SCAN4ANY            REPEAT SCAN                          46600019
*                                                                       46700019
XCTLRTN  EQU   *                                                        46800019
*                                                                       46900019
*   XCTL TO NEXT EXECUTOR                                               47000019
*                                                                       47100019
         IECRES LOAD,PREFIX=WTGPREFX,BRANCH=DIRECT,            @Z30TSMI*47160003
               MODID=WTGENTRY           GO TO NEXT MODULE      @Z30TSMI 47210003
*                                                                       47700019
*                                                                       47800019
*                                                                       47802020
* ROTATIONAL POSITION SENSING EQUATES                                   47804002
*                                                                       47806020
*                                                                       47810020
HALFCCW  EQU   4                        SIZE OF A HALF CCW       S20201 47812020
D6       EQU   6                        OFFSET IN JFCB FOR RPS   S20201 47814020
CNTOFF   EQU   7                        OFFSET TO COUNT IN CCW   S20201 47816020
CARN8    EQU   8                        FOR UPDATING CCW         S20201 47818020
*                                       POINTERS                 S20201 47820020
CARN24   EQU   24                       TO POINT ACROSS THREE    S20201 47822020
*                                       CCWS                     S20201 47824020
CARN28   EQU   28                       TO POINT ACROSS 3.5 CCWS S20201 47826020
CARN80   EQU   80                       IOB OFFSET WITH SECTOR   S20201 47828020
*                                       ADDR                     S20201 47830020
NCCW5OFF EQU   104                      NON REC REDY OFFSET PT   S20201 47832020
*                                       TO CCW5                  S20201 47834020
CCCW5OFF EQU   104                      REC REDY                 S20201 47836020
CCCW7OFF EQU   120                      REC REDY OFFSET PT TO    S20201 47838020
*                                       CCW7                     S20201 47840020
CCCW8OFF EQU   128                      OFFSET TO CCW8           S20201 47842020
NCCWAOFF EQU   144                      OFFSET TO CCW10          S20201 47844020
CCCWBOFF EQU   152                      OFFSET TO CCW11          S20201 47846020
NCCWDOFF EQU   168                      NON REC REDY OFFSET PT   S20201 47848020
*                                       TO CCW1                  S20201 47850020
CCCWEOFF EQU   176                      REC REDY OFFSET TO CCW14 S20201 47852020
CCCWXOFF EQU   208                      REC REDY OFFSET PT TO    S20201 47854020
*                                       CCW18                    S20201 47856020
*                                                                       47858020
*                                                                       47860020
TICCODE  EQU   X'08'                    TIC OP CODE              S20201 47862020
NONCARN  EQU   X'20'                    NON REC REDY CHECK       S20201 47864020
SETSECT  EQU   X'23'                    SET SECTOR COMMAND CODE  S20201 47866020
RDSECT   EQU   X'22'                    READ SECTOR COMMAND CODE S20201 47868020
*                                                                       47870020
CARSHIFT EQU   32                       FIRST FOUR CCWS -NO      S20201 47872020
*                                       CARNIVAL                 S20201 47874020
*                                                                       47876020
*                                                                       47878020
*                                                                       47880020
*                                                                       47882020
*         CONSTANTS                                                     47884002
*                                                                       47886020
*********************************************************************** 47900019
*                                                                       48000019
CCHNCARN DC    X'40000001'              FLAG/COUNT FIELD         S20201 48050002
CCHN5TIC DC    X'4000000508'       COMMAND CHAIN,CNT=5,TIC COM.CODE     48100019
*                                                                       48200019
CONST8   DC    H'8'                CONSTANT = '8'                       48300019
CONST10  DC    H'10'               CONSTANT = '10'                      48400019
*                                                                       48500019
MODID    DC    CL6'IGG019'              MODULE ID                Y02072 48550002
AMIDCNST DC    C'9L'                    THIS EXECUTOR'S ID              48600002
OPIDCNST DC    C'0S'                    LAST LOAD OF OPEN'S ID          48700002
IDNEXT   DC    C'0S'                    NEXT LOAD OF OPEN-ID     Y02072 48750002
PATCH    DC    XL((*-IGG0199L)/20)'0'   5% PATCH AREA            Y02072 48800002
         EJECT                                                          50400019
*                                                                       50500019
*************** CONTROL BLOCK DEFINITIONS                               50600019
*                                                                       50700019
*********************************************************************** 50800019
         CVT    DSECT=YES                                        Y02072 51100002
*                                                                       51200019
         SPACE 2                                                        51300019
*********************************************************************** 51400019
*                                                                       51500019
         DCBD  DSORG=(PS),DEVD=(DA)                                     51600019
*                                                                       51700019
*********************************************************************** 51900019
         EJECT                                                          51950002
         IECDSECS (MAIN,(IOB,NO)),PREFX,WTG,EXPAND=YES           Y02072 52050402
FORCORE  DSECT                     WORKAREA DSECT CONTINUED      Y02072 52050502
*****    THE FOLLOWING ARE AUDIT TRAIL BITS SET FOR FORCE CLOSE   ***** 52052902
         IHAFCAUD  ORG=YES                                       Y02072 52053302
         EJECT                                                          52060402
         IEZIOB                                                  Y02072 52062802
*********************************************************************** 52065202
*   THE FOLLOWING DSECT FORMATS THE BDAM CREATE EXTENSION TO THE IOB  * 52067602
*********************************************************************** 52070002
         ORG   IOBSEEK+8                                         Y02072 52100002
IOBDNRCF DS    D         NEW RECORD COUNT FIELD                         53600019
IOBR0CNT DS    D         COUNT FIELD OF R0                              53700019
IOBR0DAT DS    D         DATA FIELD OF R0                               53800019
IOBCCW1  DS    D         FIRST CCW OF CHANNEL PROGRAM                   53900019
IOBCCW2  DS    D         2ND CCW OF CHANNEL PROGRAM                     54000019
IOBCCW3  DS    D         3RD CCW OF CHANNEL PROGRAM                     54100019
IOBCCW4  DS    D         4TH CCW OF CHANNEL PROGRAM                     54200019
IOBCCW5  DS    D         5TH CCW OF CHANNEL PROGRAM                     54300019
IOBCCW6  DS    D         6TH CCW OF CHANNEL PROGRAM                     54400019
IOBCCW7  DS    D         7TH CCW OF CHANNEL PROGRAM                     54500019
IOBCCW8  DS    D         8TH CCW OF CHANNEL PROGRAM                     54600019
IOBCCW9  DS    D         9TH CCW OF CHANNEL PROGRAM                     54700019
IOBCCW10 DS    D         10TH CCW OF CHANNEL PROGRAM                    54800019
IOBCCW11 DS    D         11TH CCW OF CHANNEL PROGRAM                    54900019
IOBCCW12 DS    D         12TH CCW OF CHANNEL PROGRAM                    55000019
IOBCCW13 DS    D         13TH CCW OF CHANNEL PROGRAM                    55100019
IOBCCW14 DS    D         LAST CCW OF LONGEST CHANNEL PROGRAM            55200019
*                                                                       55300019
*********************************************************************** 55500019
         EJECT                                                          55550002
         IEZDEB                                                  Y02072 55650002
         EJECT                                                          55700002
         IGGSWA                                                  Y02072 60150002
         IHADVCT                                                 Y02072 60200002
         END                                                            64900019
